if(typeof (microstrategy)=="undefined"){self.microstrategy=new function(){};}microstrategy.prototype={};microstrategy.OBJTYPE_ATTRIBUTE="ATTR";microstrategy.OBJTYPE_METRIC="MV";microstrategy.OBJTYPE_OBJBROWSER="obbr";microstrategy.OBJTYPE_EDITOR="edt";microstrategy.OBJTYPE_GRAPH_ZONES="gzn";microstrategy.OBJTYPE_RW_PAGE="RWPA";microstrategy.OBJTYPE_RW_TEXTFIELD="TEXT";microstrategy.OBJTYPE_DOC="docu";microstrategy.OBJTYPE_DOC_OBJECT="obj";microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER="subscon";microstrategy.OBJTYPE_DOC_SUBSECTION="4";microstrategy.OBJTYPE_DOC_SECTION="dsec";microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER="hcont";microstrategy.OBJTYPE_DOC_PARENT_HORIZONTAL_CONTAINER="parenthcont";microstrategy.OBJTYPE_DOC_SELECTION="dsel";microstrategy.OBJTYPE_RW_HILITES="RWHI";microstrategy.OBJTYPE_RW_HANDLES="RWHA";microstrategy.OBJTYPE_RW_LASSO="RWLA";microstrategy.OBJTYPE_DOCKZONE="dock";microstrategy.OBJTYPE_TOOLBAR="tool";microstrategy.OBJTYPE_FOLDER="f";microstrategy.OBJTYPE_ATTRIBUTE="a";microstrategy.OBJTYPE_ELEMENT="e";microstrategy.OBJTYPE_GRID="g";microstrategy.OBJTYPE_GRAPH="gp";microstrategy.OBJTYPE_BTN_GROUP="btng";microstrategy.OBJTYPE_PAGE_BY="pgby";microstrategy.OBJTYPE_PAGE_BY_ELEM="pbel";microstrategy.OBJTYPE_FAKED_PAGE_BY_ELEM="fkpbel";microstrategy.OBJTYPE_FILTER_EDITOR="filt";microstrategy.OBJTYPE_RULER="rul";microstrategy.OBJTYPE_MASK="mask";microstrategy.OBJTYPE_MASK_MAP="mama";microstrategy.OBJTYPE_MASK_MAP_AREA="mmar";microstrategy.OBJTYPE_ANY="*";microstrategy.OBJTYPE_FORMULA_BAR="fmla";microstrategy.OBJTYPE_TAB="tab";microstrategy.OBJTYPE_TAB_SET="tset";microstrategy.OBJTYPE_INC_FETCH_PANE="incf";microstrategy.OBJTYPE_INC_FETCH="if";microstrategy.OBJTYPE_OBJECT_COUNT="objCount";microstrategy.OBJTYPE_EDITOR="edt";microstrategy.OBJTYPE_CONTEXT_MENU="cxt";microstrategy.OBJTYPE_MESSAGE_BOX="mbx";microstrategy.OBJTYPE_DSEL_MOVE_RECS="mrec";microstrategy.OBJTYPE_FLOATING_TOOLBAR="ftb";microstrategy.OBJTYPE_SECURITY_FILTER="sf";microstrategy.OBJTYPE_FIRST_CLASS_OBJECT="fco";microstrategy.OBJTYPE_XDA_DATA_ELEMENT="xdae";microstrategy.OBJTYPE_PANEL_STACK="pnls";microstrategy.OBJTYPE_SCROLLER_HANDLE="schn";microstrategy.OBJTYPE_SCROLLER_CONTAINER="sctb";microstrategy.OBJTYPE_SCROLLER_CONTAINER_GHOST="sctbgh";microstrategy.OBJTYPE_SCROLLER_TRACK="sctrk";microstrategy.OBJTYPE_RW_CONTROL="RWCTL";microstrategy.ORIENTATION_HORIZONTAL=0;microstrategy.ORIENTATION_VERTICAL=1;microstrategy.GRIDCELL_ORIENTATION_VERTICAL="V";microstrategy.GRIDCELL_ORIENTATION_HORIZONTAL="H";microstrategy.GRIDCELL_AXIS_METRICS=-1;microstrategy.GRIDCELL_AXIS_ATT_FORMS=0;microstrategy.GRIDCELL_AXIS_ROWS=1;microstrategy.GRIDCELL_AXIS_COLUMNS=2;microstrategy.GRIDCELL_AXIS_PAGE_BY=3;microstrategy.GRID_EFFECTIVE_VIEW_GRID=0;microstrategy.GRID_EFFECTIVE_VIEW_GRAPH=1;microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH=2;microstrategy.SUBOBJTYPE_TITLEBAR="titl";microstrategy.SUBOBJTYPE_STATUSBAR="stat";microstrategy.SUBOBJTYPE_TOOLBAR="tool";microstrategy.SUBOBJTYPE_TOOLBAR_HANDLE="toha";microstrategy.SUBOBJTYPE_GRID_TABLE="tabl";microstrategy.SUBOBJTYPE_TREE="tree";microstrategy.SUBOBJTYPE_TREE_VIEW="treeView";microstrategy.SUBOBJTYPE_BODY="body";microstrategy.SUBOBJTYPE_SECTION_HANDLE="shan";microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE="sshan";microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER="107";microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR="ctitl";microstrategy.SUBOBJTYPE_DOC_TEXT="106";microstrategy.SUBOBJTYPE_DOC_IMAGE="102";microstrategy.SUBOBJTYPE_DOC_LINE="105";microstrategy.SUBOBJTYPE_DOC_SHAPE="101";microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND="112";microstrategy.SUBOBJTYPE_DOC_TEMPLATE="52";microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|R";microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRID;microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRAPH;microstrategy.SUBOBJTYPE_DOC_GRID_GRAPH_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH;microstrategy.GRAPH_CTL="52G";microstrategy.SUBOBJTYPE_DOC_PANEL_STACK="8";microstrategy.SUBOBJTYPE_DOC_PANEL="9";microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL="111";microstrategy.SUBOBJTYPE_DOC_WIDGET="113";microstrategy.SUBOBJTYPE_SEL_HANDLE="shan";microstrategy.SUBOBJTYPE_FOLDER_LIST="folderList";microstrategy.SUBOBJTYPE_FOLDER_UP="folderUp";microstrategy.SUBOBJTYPE_FILE_SEARCH="fileSearch";microstrategy.SUBOBJTYPE_FILE_LIST="fileList";microstrategy.SUBOBJTYPE_BTN="btn";microstrategy.SUBOBJTYPE_BTN_HANDLE="btnh";microstrategy.SUBOBJTYPE_VRULER="vRul";microstrategy.SUBOBJTYPE_VRULER_SHADE="vRulS";microstrategy.SUBOBJTYPE_HRULER="hRul";microstrategy.SUBOBJTYPE_HRULER_SHADE="hRulS";microstrategy.SUBOBJTYPE_TAB_CONTAINER="tabCont";microstrategy.SUBOBJTYPE_TAB_SAMPLE="sample";microstrategy.SUBOBJTYPE_TAB_SECTION="tabSection";microstrategy.SUBOBJTYPE_FORMULA_BAR_AREA="fmlaArea";microstrategy.SUBOBJTYPE_FORMULA_BAR_TEXT_AREA="fmlaTextArea";microstrategy.SUBOBJTYPE_RESIZE_VLINE="vline";microstrategy.SUBOBJTYPE_RESIZE_HLINE="hline";microstrategy.SUBOBJTYPE_ATTRIBUTE="ATT";microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM="ATTFORM";microstrategy.SUBOBJTYPE_METRIC="MV";microstrategy.SUBOBJTYPE_IMG="cimg";microstrategy.SUBOBJTYPE_PREVIEW_PANE="prv";microstrategy.SUBOBJTYPE_OUTLINE_MODE_IMG="outimg";microstrategy.SUBOBJTYPE_PANEL_CONTAINER="pc";microstrategy.SUBOBJTYPE_WINDOW_BUTTON="wBtn";microstrategy.SUBOBJTYPE_SLIDER="slider";microstrategy.SUBOBJTYPE_ESRIMAP="esrimap";microstrategy.SUBOBJTYPE_GMAP="gmap";microstrategy.DSSTYPE_TEMPLATE="2";microstrategy.DSSTYPE_RPT_DEFINITION="3";microstrategy.DSSTYPE_DOC_DEFINITION="55";microstrategy.DSSTYPE_FOLDER="8";microstrategy.DSSTYPE_CONSOLIDATION_ELEMENT="48";microstrategy.DSSTYPE_METRIC="4";microstrategy.DSSTYPE_USER_METRIC="100";microstrategy.DSSTYPE_USER_SUMMARY_METRIC="101";microstrategy.DSSTYPE_ATTRIBUTE="12";microstrategy.DSSTYPE_ATTRIBUTE_FORM="21";microstrategy.DSSTYPE_FILTER="1";microstrategy.DSSTYPE_PROMPT="10";microstrategy.DSSTYPE_CONSOLIDATION="47";microstrategy.DSSTYPE_CUSTOM_GROUP="257";microstrategy.DSSTYPE_DIMENSION="14";microstrategy.DSSTYPE_GRID="768";microstrategy.DSSTYPE_GRAPH="769";microstrategy.DSSTYPE_GRID_AND_GRAPH="774";microstrategy.DSSTYPE_REPORT_CUBE="776";microstrategy.DSSTYPE_HIERARCHY="14";microstrategy.DSSTYPE_SHORTCUT="18";microstrategy.DISPUNITTYPE_ELEMENT="1048576";microstrategy.DSSSUB_TYPE_FILTER="256";microstrategy.DSSSUB_TYPE_RW="14081";microstrategy.DSSSUB_TYPE_PROMPT=2560;microstrategy.DSSSUB_TYPE_PROMPT_BOOLEAN=2561;microstrategy.DSSSUB_TYPE_PROMPT_LONG=2562;microstrategy.DSSSUB_TYPE_PROMPT_STRING=2563;microstrategy.DSSSUB_TYPE_PROMPT_DOUBLE=2564;microstrategy.DSSSUB_TYPE_PROMPT_DATE=2565;microstrategy.DSSSUB_TYPE_PROMPT_BIG_DECIMAL=2571;microstrategy.DSSSUB_TYPE_PROMPT_OBJECTS=2566;microstrategy.DSSSUB_TYPE_PROMPT_ELEMENTS=2567;microstrategy.DSSSUB_TYPE_PROMPT_EXPRESSION=2568;microstrategy.DSSSUB_TYPE_PROMPT_DIMPTY=2570;microstrategy.HTMLATTR_SCRIPTCLASS="scriptclass";microstrategy.HTMLATTR_ID="id";microstrategy.HTMLATTR_OBJTYPE="ty";microstrategy.HTMLATTR_DSSTYPE="dss_ty";microstrategy.HTMLATTR_DISPLAY_NAME="ds";microstrategy.HTMLATTR_SUBOBJTYPE="sty";microstrategy.HTMLATTR_STYLE="styst";microstrategy.HTMLATTR_OBJINDEX="ind";microstrategy.HTMLATTR_DISPUNITTYPE="dty";microstrategy.HTMLATTR_DISPLAY_NAME="ds";microstrategy.HTMLATTR_ORIENTATION="or";microstrategy.HTMLATTR_ORIENTATIONS_SUPPORTED="ors";microstrategy.HTMLATTR_GRIDCELL_AXIS="ax";microstrategy.HTMLATTR_GRIDCELL_DEPTH="dpt";microstrategy.HTMLATTR_GRIDCELL_ID="i";microstrategy.HTMLATTR_GRIDCELL_ORDINAL="o";microstrategy.HTMLATTR_GRIDROW_ORDINAL="o";microstrategy.HTMLATTR_GRIDROW_MAX_DEPTH="mx";microstrategy.HTMLATTR_GRIDROW_LEVEL="level";microstrategy.HTMLATTR_GRIDCELL_ATTR_COL_TITLE_MISSING="ctm";microstrategy.HTMLATTR_CMD_ID="cmdid";microstrategy.HTMLATTR_CMD_TYPE="cmdtp";microstrategy.HTMLATTR_CMD_VALUE="cmdvl";microstrategy.HTMLATTR_CMD_FORMAT_TYPE="cmdft";microstrategy.HTMLATTR_CMD_PICKER="cmdpk";microstrategy.HTMLATTR_CMD_PROP="cmdprop";microstrategy.HTMLATTR_CMD_LEVEL="cmdlvl";microstrategy.HTMLATTR_DYN_TITLE="dynTT";microstrategy.HTMLATTR_COLOR="color";microstrategy.HTMLATTR_FILTER_VALUE="ftv";microstrategy.HTMLATTR_FILTER_TYPE="ftt";microstrategy.HTMLATTR_FILTER_COMPARISON="ftc";microstrategy.HTMLATTR_FILTER_COMPARISON_DEFAULT="0";microstrategy.HTMLATTR_FILTER_COMPARISON_BINARY="1";microstrategy.HTMLATTR_DSS_ID="oid";microstrategy.HTMLATTR_DSS_FORMULA="frma";microstrategy.HTMLATTR_DSS_TYPE="oty";microstrategy.HTMLATTR_DERIVED_METRIC="dr";microstrategy.HTMLATTR_HAS_DERIVED_ELEMENTS="hde";microstrategy.HTMLATTR_DSS_SUBTYPE="ost";microstrategy.HTMLATTR_DSS_SET="ods";microstrategy.HTMLATTR_DSS_DESCRIPTION="otd";microstrategy.HTMLATTR_POINTS_TO="pt";microstrategy.HTMLATTR_TARGET="tg";microstrategy.HTMLATTR_DND_SOURCE="dg";microstrategy.HTMLATTR_DO_COND_FORMAT="cf";microstrategy.HTMLATTR_HEIGHT_MODE="hm";microstrategy.HTMLATTR_HEIGHT="ht";microstrategy.HTMLATTR_WIDTH_MODE="wm";microstrategy.HTMLATTR_WIDTH="wd";microstrategy.HTMLATTR_VISIBLE="visible";microstrategy.HTMLATTR_OLD_HEIGHT="oldht";microstrategy.HTMLATTR_OLD_WIDTH="oldwd";microstrategy.HTMLATTR_OLD_TOP="oldtop";microstrategy.HTMLATTR_OLD_LEFT="oldleft";microstrategy.HTMLATTR_HAS_CONDITIONAL_FORMATTING="hcf";microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE="shvm";microstrategy.HTMLATTR_CAN_GROW="cg";microstrategy.HTMLATTR_CAN_SHRINK="cs";microstrategy.HTMLATTR_MAX_HEIGHT="mh";microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL="cgh";microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL="csh";microstrategy.HTMLATTR_MAX_WIDTH="mw";microstrategy.HTMLATTR_IS_HORIZONTAL="hz";microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL="bhz";microstrategy.HTMLATTR_IS_END_HORIZONTAL="ehz";microstrategy.HTMLATTR_HIDE_IF_EMPTY="he";microstrategy.HTMLATTR_REPEAT_SECTION="rpts";microstrategy.HTMLATTR_FIT_EXCEL_ROW_HEIGHT="ferh";microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER="kst";microstrategy.HTMLATTR_REPEAT_HORIZONTALLY="rpth";microstrategy.HTMLATTR_FORCE_NEW_PAGE="fnp";microstrategy.HTMLATTR_AUTO_RESIZE_IN_DESIGNMODE="ard";microstrategy.HTMLATTR_HTML_TYPE="htype";microstrategy.HTMLATTR_HTML_SOURCE="hsrc";microstrategy.HTMLATTR_HTML_TEXT="htxt";microstrategy.HTMLATTR_IS_LINK="isl";microstrategy.HTMLATTR_ROUNDED_CORNERS="rc";microstrategy.HTMLATTR_DROP_SHADOW="dsw";microstrategy.HTMLATTR_DROP_SHADOW_EFFECT="dse";microstrategy.HTMLATTR_RADIUS="rd";microstrategy.HTMLATTR_TOP_CORNERS_ONLY="tco";microstrategy.HTMLATTR_BOTTOMLEFT_CORNER_RADIUS="blcr";microstrategy.HTMLATTR_TOPLEFT_CORNER_RADIUS="tlcr";microstrategy.HTMLATTR_ALPHA="alpo";microstrategy.HTMLATTR_ALPHA_EFFECT="alpe";microstrategy.HTMLATTR_LOCK_ASPECT_RATIO="lar";microstrategy.HTMLATTR_NEW_WINDOW="nw";microstrategy.HTMLATTR_IMAGE_SOURCE="imgsrc";microstrategy.HTMLATTR_LINK_HREF="href";microstrategy.HTMLATTR_LINK_HREFVALUE="hv";microstrategy.HTMLATTR_APPLIES_TO="at";microstrategy.HTMLATTR_GRID_AREA_PCT="gap";microstrategy.HTMLATTR_DISPLAY_MODE="dm";microstrategy.HTMLATTR_GRID_POS="gpos";microstrategy.HTMLATTR_RESIZE="rsz";microstrategy.HTMLATTR_PRIMEDATAID="pDataId";microstrategy.HTMLATTR_DETAILS_SECTION="dt";microstrategy.HTMLATTR_NUMBER_FORMAT_DECIMAL_PLACES="ndp";microstrategy.HTMLATTR_NUMBER_FORMAT_CATEGORY="nct";microstrategy.HTMLATTR_NUMBER_FORMAT_NEGATIVE_NUMBERS="nnn";microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_SYMBOL="ncs";microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_POSITION="ncp";microstrategy.HTMLATTR_NUMBER_FORMAT_THOUSAND_SEPARATOR="nth";microstrategy.HTMLATTR_NUMBER_FORMAT_STRING="nfs";microstrategy.HTMLATTR_FORM_POS="FRMPOS";microstrategy.HTMLATTR_FORM_ID="FRMID";microstrategy.HTMLATTR_FORM_NAME="FRMNAME";microstrategy.HTMLATTR_FORM_LIST="FRMLIST";microstrategy.HTMLATTR_SECTION_ID="sct";microstrategy.HTMLATTR_DTOP="dtp";microstrategy.HTMLATTR_DWIDTH="dwh";microstrategy.HTMLATTR_DHEIGHT="dht";microstrategy.HTMLATTR_DLEFT="dlf";microstrategy.HTMLATTR_ATTRIBUTE_ID="atid";microstrategy.HTMLATTR_PARENT_ID="pid";microstrategy.HTMLATTR_DESCRIPTION="ds";microstrategy.HTMLATTR_NAME="nm";microstrategy.HTMLATTR_ACL="acl";microstrategy.HTMLATTR_BORDER="br";microstrategy.HTMLATTR_PAGE_BREAK="pbs";microstrategy.HTMLATTR_SHOW_REPEAT_SECTION="rps";microstrategy.HTMLATTR_IS_LOCKED="ilk";microstrategy.HTMLATTR_TOOLTIP_FORMULA="tt";microstrategy.HTMLATTR_SHOW_WINDOW_TITLE="swt";microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE="swwt";microstrategy.HTMLATTR_WINDOW_STATE="ws";microstrategy.HTMLATTR_WINDOW_LAST_STATE="wls";microstrategy.HTMLATTR_WINDOW_TITLE="wt";microstrategy.HTMLATTR_TITLE_BAR_DISPLAY="tbd";microstrategy.HTMLATTR_SECTION_NAME="sn";microstrategy.HTMLATTR_QUICK_SWITCH="qs";microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW="uaiw";microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED="rtfp";microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE="ehstc";microstrategy.HTMLATTR_USE_AS_FILTER_PANEL="uafp";microstrategy.HTMLATTR_USE_AS_MASTER_PANEL="uamp";microstrategy.HTMLATTR_CTL_AUTO_SUBMIT="cas";microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER="sos";microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT="sec";microstrategy.HTMLATTR_LINK_TO="lnk";microstrategy.HTMLATTR_INFO_WIN_PLACEMENT="iwpl";microstrategy.HTMLATTR_EXPORT_OPTION="seo";microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD="sbtvof";microstrategy.HTMLATTR_INFO_WIN_MODE="iwm";microstrategy.HTMLATTR_INFO_WIN_POSITION="iwp";microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN="tctdiw";microstrategy.HTMLATTR_IOS_COPY_MODE="mcm";microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL="uatc";microstrategy.HTMLATTR_TABLE_CONTROL_DEFINITION="tcd";microstrategy.FORMAT_TYPE_TABLE_BASE=2;microstrategy.FORMAT_TYPE_TABLE_GROUP=microstrategy.FORMAT_TYPE_TABLE_BASE;microstrategy.FORMAT_TYPE_TABLE_CELL=microstrategy.FORMAT_TYPE_TABLE_BASE+1;microstrategy.BUTTON_CTL="106B";microstrategy.HTMLATTR_DISPLAY_STYLE="dpst";microstrategy.HTMLATTR_NORMAL_URL="nmurl";microstrategy.HTMLATTR_HIGHLIGHT_URL="hlurl";microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR="fhlc";microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR="bhlc";microstrategy.HTMLATTR_FILL_EFFECT="fe";microstrategy.BUTTON_STYLE_NOT_BUTTON=0;microstrategy.BUTTON_STYLE_CAPTION_ONLY=1;microstrategy.BUTTON_STYLE_ICON_ONLY=2;microstrategy.BUTTON_STYLE_ICON_LEFT=3;microstrategy.BUTTON_STYLE_ICON_RIGHT=4;microstrategy.BUTTON_STYLE_ICON_TOP=5;microstrategy.BUTTON_STYLE_CUSTOM=6;microstrategy.HTMLATTR_EFFECT_FLAT=0;microstrategy.HTMLATTR_EFFECT_GLOSSY=1;microstrategy.BUTTON_STYLE_CSS_SUFFIXES=[,"captionOnly","iconOnly","iconLeft","iconRight","iconTop","custom"];microstrategy.PROPERTIES_EDITOR_BUTTON_TAB=8;microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR="uanb";microstrategy.CONTROLSUBTYPE_NAVIGATION_BAR="NB";microstrategy.HTMLATTR_BORDER_3D_STYLE="b3dstyle";microstrategy.HTMLATTR_BORDER_3D_WEIGHT="b3dweight";microstrategy.HTMLATTR_BORDER_3D_TOP_COLOR="b3dtc";microstrategy.HTMLATTR_BORDER_3D_LEFT_COLOR="b3dlc";microstrategy.HTMLATTR_BORDER_3D_RIGHT_COLOR="b3drc";microstrategy.HTMLATTR_BORDER_3D_LEFT_COLOR="b3dlc";microstrategy.HTMLATTR_BORDER_TOP_COLOR="btc";microstrategy.HTMLATTR_BORDER_LEFT_COLOR="blc";microstrategy.HTMLATTR_BORDER_RIGHT_COLOR="brc";microstrategy.HTMLATTR_BORDER_BOTTOM_COLOR="bbc";microstrategy.HTMLATTR_BORDER_TOP_STYLE="bts";microstrategy.HTMLATTR_BORDER_LEFT_STYLE="bls";microstrategy.HTMLATTR_BORDER_RIGHT_STYLE="brs";microstrategy.HTMLATTR_BORDER_BOTTOM_STYLE="bbs";microstrategy.HTMLATTR_LINE_COLOR="lc";microstrategy.HTMLATTR_LINE_STYLE="ls";microstrategy.HTMLATTR_LINE_WEIGHT="lw";microstrategy.HTMLATTR_GRID_CELL_TYPE="cty";microstrategy.HTMLATTR_GRID_UNIT_POS="UPT";microstrategy.HTMLATTR_IS_DATASET_JOIN_PRIMARY="ijp";microstrategy.HTMLATTR_GRID_OVERFLOW="ovf";microstrategy.HTMLATTR_TEXT_OVERFLOW="tovf";microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW="xovf";microstrategy.HTMLATTR_GRAPH_EXPORT_OVERFLOW="xgovf";microstrategy.HTMLATTR_PS_TRANSPARENCY="trpr";microstrategy.HTMLATTR_PS_BLUR="blur";microstrategy.HTMLATTR_WIDGET_CLASS="twc";microstrategy.HTMLATTR_WIDGET_RSL_PATH="rsl";microstrategy.HTMLATTR_WIDGET_IS_APP="iap";microstrategy.HTMLATTR_NON_FLASH_RENDER="nfr";microstrategy.HTMLATTR_PDF_RENDER="pr";microstrategy.HTMLATTR_EXCEL_RENDER="er";microstrategy.HTMLATTR_DHTML_RENDER="dr";microstrategy.HTMLATTR_SEC_DATA_PROVIDERS="sdp";microstrategy.HTMLATTR_TRANSITION="ttr";microstrategy.HTMLATTR_TRANS_DURATION="tdr";microstrategy.HTMLATTR_LOCKED="lck";microstrategy.HTMLATTR_IS_VIS_GRID_BONE="ivgb";microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR="ssc";microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE="sstyle";microstrategy.HTMLATTR_IPHONE_VIS="iphv";microstrategy.HTMLATTR_IPAD_VIS="ipadv";microstrategy.HTMLATTR_WIDGET_PROPS="wp";microstrategy.HTMLATTR_ANDROID_VIS="aphv";microstrategy.HTMLATTR_ANDROID_TABLET_VIS="atv";microstrategy.HTMLATTR_SHOW_IN_RPT_COPY="sirc";microstrategy.GRIDCELLTYPE_UNIT_HEADER="1";microstrategy.GRIDCELLTYPE_UNIT_VALUE="2";microstrategy.GRIDCELLTYPE_SUBTOTAL_HEADER="3";microstrategy.GRIDCELLTYPE_SUBTOTAL_VALUE="4";microstrategy.GRIDCELLTYPE_LEVEL_ALL="5";microstrategy.GRIDCELLTYPE_LEVEL_NONE="0";microstrategy.GRIDCELLTYPE_LEVEL_MULTIPLE="-1";microstrategy.GRID_TARGET_NONE="0";microstrategy.GRID_TARGET_MULTIPLE="-1";microstrategy.FORMAT_LEVEL_FLAG_VIEWER=0;microstrategy.FORMAT_LEVEL_FLAG_DOC=1;microstrategy.FORMAT_LEVEL_FLAG_DOC_SELECTIONS=2;microstrategy.GRIDCELLTYPE_METRIC_DATA="data";microstrategy.TRUE="-1";microstrategy.FALSE="0";microstrategy.ACL_EXECUTE=128;microstrategy.ACL_USE=64;microstrategy.COPY_ITEM_SEPERATOR=";";microstrategy.OBJ_PREFIX="W";microstrategy.VISIBLE_ELEMS_NAME="visElem";microstrategy.VISIBLE_ELEMS_RULERS=1;microstrategy.VISIBLE_ELEMS_GRID=2;microstrategy.VISIBLE_ELEMS_DIVIDER=4;microstrategy.OK_BUTTON=1;microstrategy.CANCEL_BUTTON=2;microstrategy.APPLY_BUTTON=4;microstrategy.DESIGN_MODE=1;microstrategy.VIEW_MODE=2;microstrategy.RW_VIEW_MODE_STATIC=1;microstrategy.RW_VIEW_MODE_INTERACTIVE=2;microstrategy.RW_VIEW_MODE_EDITABLE=4;microstrategy.RW_VIEW_MODE_FLASH=8;microstrategy.RW_VIEW_MODE_VIEWANALYSIS=2048;microstrategy.IN_OUTLINE_MODE=false;microstrategy.IS_RELOAD=false;microstrategy.ALLOW_EDIT_MODE=1;microstrategy.NOT_ALLOW_EDIT_MODE=2;microstrategy.HTML_CONTAINER_TYPE_IFRAME="0";microstrategy.HTML_CONTAINER_TYPE_HTML="1";microstrategy.WINDOW_TITLE_HEIGHT="20";microstrategy.WINDOW_STATE_NORMAL="0";microstrategy.WINDOW_STATE_MINIMIZED="1";microstrategy.WINDOW_STATE_MAXIMIXED="2";microstrategy.MARQUEE_STYLE=microstrategy.MARQUEE_STYLE_PARTIAL;microstrategy.MARQUEE_STYLE_PARTIAL=0;microstrategy.MARQUEE_STYLE_FULL=1;microstrategy.DPI_CONVERSION=96;microstrategy.BASE_DPI=96;microstrategy.ZOOM_FACTOR=100;microstrategy.ZOOM_STATIC="0";microstrategy.ZOOM_FIT_WIDTH="1";microstrategy.ZOOM_FIT_PAGE="2";microstrategy.GRID_IMAGE="grid96MediumInch.gif";microstrategy.SNAP_SIZE=12;microstrategy.CURSOR_OFFSET=5;microstrategy.DND_HILITE_WIDTH=3;microstrategy.SNAP_OFF=false;microstrategy.SNAP_DIRET_POS=1;microstrategy.SNAP_DIRET_NEG=-1;microstrategy.DISPLAY_MODE_GRID=1;microstrategy.DISPLAY_MODE_GRAPH=2;microstrategy.DISPLAY_MODE_GRID_AND_GRAPH=3;microstrategy.FIRST_VISUALIZATION_VIEW_MODE=50;microstrategy.RWD_EXECUTION_MODE_DATA=1;microstrategy.RWD_EASE_CREATION_ANALYSIS=16;microstrategy.APP_BEAN_VIEW_EXECUTION=0;microstrategy.REPORT_EXECUTION=1;microstrategy.RWD_EXECUTION=2;microstrategy.FORM_LIST_NAME=0;microstrategy.FORM_LIST_ID=1;microstrategy.FORM_LIST_STATUS=2;microstrategy.FORM_ON_VIEW=1;microstrategy.FORM_ON_WS=2;microstrategy.FORM_NOT_ON_WS=3;microstrategy.DESIGNMODE_NOBORDER_STYLE="#999999 1px dashed";microstrategy.HAS_BORDER=1;microstrategy.NO_BORDER=0;microstrategy.RESIZE_VERTICAL=1;microstrategy.RESIZE_HORIZONTAL=2;microstrategy.WIDTH_UPDATE=1;microstrategy.HEIGHT_UPDATE=2;microstrategy.WIDTH_AND_HEIGHT_UPDATE=3;microstrategy.FIX_MODE=0;microstrategy.HUNDRED_PERCENT_MODE=1;microstrategy.AUTO_MODE=2;microstrategy.IS_RWD_DIRTY=microstrategy.FALSE;microstrategy.IS_OFFICE_EXPORT=microstrategy.FALSE;microstrategy.OPEN_EDITOR_ACTION_ADD=1;microstrategy.OPEN_EDITOR_ACTION_EDIT=0;microstrategy.PAGE_FULL_SCREEN_MODE=2;microstrategy.PAGE_NORMAL_SCREEN_MODE=1;microstrategy.FORMATTING_PROP_THRESHOLD="t";microstrategy.FORMATTING_PROP_TOC_FONT="df";microstrategy.FORMATTING_PROP_DERIVED_ELEMENT="de";microstrategy.TAB_SWITCH_MODE="switchMode";microstrategy.TAB_SWITCH_MODE_CACHED=0;microstrategy.TAB_SWITCH_MODE_FETCH=1;microstrategy.bones={};microstrategy.zones=new Array;microstrategy.observerItems=null;microstrategy.updateManager=null;microstrategy.number=null;microstrategy.descriptors=null;microstrategy.styleObj=null;microstrategy.controlVariables={};microstrategy.formatObj=null;microstrategy.mstrwid="";microstrategy.bonesToRegister=[];microstrategy.zoomType=microstrategy.ZOOM_TYPE_STATIC;microstrategy.viewerBoneId="";microstrategy.displayLocaleID=null;microstrategy.prototype.DISPLAY_MODE=microstrategy.DESIGN_MODE;microstrategy.prototype.EDIT_MODE=microstrategy.ALLOW_EDIT_MODE;microstrategy.prototype.activeCXMenu=null;microstrategy.prototype.activeCXBone=null;microstrategy.prototype.RMCTarget=null;microstrategy.prototype.isCXMenuOpen=false;microstrategy.prototype.isJLSCXMenuOpen=false;microstrategy.primeDataSetId=null;microstrategy.sortDefinedOnDefault=false;microstrategy.waitPageDelay="0";microstrategy.showWaitPopup=true;microstrategy.IGNORE_RESIZE=1;microstrategy.RESIZE_TO_FIRST_SUBSECTION=2;microstrategy.RESIZE_EACH_SUBSECTION=3;microstrategy.REPORT_FMT_TOOLBAR="";microstrategy.FORMAT_TYPE_MAIN="1";microstrategy.FORMAT_TYPE_TITLE="2";microstrategy.FORMAT_TYPE_CONTROL_TITLE="5";microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;microstrategy.RESTORE_LEFT=0;microstrategy.RESTORE_TOP=1;microstrategy.RESTORE_BOTH=2;microstrategy.ACCORDION_REPORT_RP_OBJECT_PANEL="workingSet";microstrategy.ACCORDION_REPORT_ALL_OBJECT_PANEL="objectBrowser";microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL="relatedReports";microstrategy.ACCORDION_REPORT_NOTES_PANEL="notes";microstrategy.ACCORDION_RW_DATASET_PANEL="workingSet";microstrategy.ACCORDION_RW_RELATED_RP_PANEL="relatedReports";microstrategy.ACCORDION_RW_NOTES_PANEL="notes";microstrategy.ACCORDION_RW_OUTLINE_PANEL="outlineView";microstrategy.DHTML_RENDERER_SAME_AS_WIDGET="1";microstrategy.DHTML_RENDERER_SAME_AS_PDF_AND_EXCEL="0";microstrategy.GRID_UNIT_CONTAINER=0;microstrategy.GRID_BORDERS=1;microstrategy.GRID_OTHER=2;microstrategy.HTML_ELEMENT_NODE_TYPE=1;microstrategy.HTML_TEXT_NODE_TYPE=3;microstrategy.gridFormatCache={};microstrategy.graphPropertyCache={};microstrategy.WEB_API_ERROR_CODES={MSI_SERVER_NAME_NOT_INITIALIZED:2147760371,MSI_INVALID_SESSION_ID:2147760372,E_MSI_USERMGR_USER_NOTFOUND:2147758245,E_MSI_CONNECT_FAILED:2147759877};document.onmousedown=new Function("e","return microstrategy.onMouseDownHandler(e)");microstrategy.EXEC_MODE_EXCEL="4";microstrategy.EXEC_MODE_PDF="3";microstrategy.EXEC_MODE_FLASH="7";microstrategy.FILTER_BOX_NAME="drillFilterElementList";microstrategy.DRILL_BOX_NAME="deDrillElementList";microstrategy.VIS_EDITOR_SCOPE_REPORT=1;microstrategy.VIS_EDITOR_SCOPE_RW_GRID=2;microstrategy.VIS_EDITOR_SCOPE_RW=4;microstrategy.VIS_EDITOR_SCOPE_RW_LAYOUT=8;microstrategy.ENCODED_AMPERSAND="%26",microstrategy.ENCODED_EQUALS="%3D",microstrategy.SAVE_AS_SHARE_EDITOR=11;microstrategy.onMouseDownHandler=function(e){try{if(microstrategy.eventManager){microstrategy.eventManager.notifyOrphanBones("ondocumentclick",e);}microstrategy.hidePopups();return true;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.hidePopups=function(force){if(typeof (hidePopupMenus)!="undefined"){hidePopupMenus(force);}if(typeof (hideIncFetchGoToDialog)!="undefined"){hideIncFetchGoToDialog();}};microstrategy.doLayout=function(forceUpdate){var top=microstrategy.headerHeight,bottom=microstrategy.footerHeight,contentNode=microstrategy.contentNode;if(contentNode){microstrategy.updateContentNodeHeight();contentNode.style.marginTop=top+"px";if(mstr.utils.ISWK||mstr.utils.ISIE8){contentNode.style.paddingBottom=bottom+"px";}else{contentNode.style.marginBottom=bottom+"px";}}document.body.style.height="auto";var headerWidth=microstrategy.headerNode.scrollWidth,browserWidth=mstr.utils.BoxModel.getBrowserWindowWidth(document);document.body.style.minWidth=(headerWidth>browserWidth)?headerWidth+"px":"";};microstrategy.syncLayout=function(resizing){try{var headerNode=microstrategy.headerNode,headerWidth=headerNode.scrollWidth,browserWidth=mstr.utils.BoxModel.getBrowserWindowWidth(document),browserScrollLeft=document.documentElement.scrollLeft||document.body.scrollLeft||0,left=parseInt(headerNode.style.left)||0;if(resizing!==true){if(browserWidth<headerWidth-left){headerNode.style.left=-Math.min(headerWidth-browserWidth,browserScrollLeft)+"px";}}else{if(resizing===true){var pos=mstr.utils.BoxModel.position(headerNode),visibleWidth=pos.left+pos.width,rightDiff=browserWidth-visibleWidth;if(rightDiff>=0){headerNode.style.left=(left+rightDiff)+"px";}}}}catch(err){microstrategy.errors.log(err);}};microstrategy.initLayoutProps=function(h){try{var contentNode=document.getElementById("mstrWebContents"),toolbarWrapperNode=microstrategy.findChildWithCssClass(document.body,"table","mstrToolbarWrapper"),pos=mstr.utils.BoxModel.position(toolbarWrapperNode),top=pos.top+pos.height,footerNode=document.getElementById("mstrWeb_footer"),bottom=footerNode?footerNode.offsetHeight:0;if(mstr.utils.ISIE7&&footerNode&&footerNode.children.length==0){footerNode.style.display="none";bottom=0;}microstrategy.contentNode=contentNode;microstrategy.headerNode=toolbarWrapperNode;microstrategy.footerNode=footerNode;microstrategy.headerHeight=top;microstrategy.footerHeight=bottom;microstrategy.contentHeight=Math.max(0,getClientHeight()-top-bottom);var el=mstr.utils.ISW3C?window:document.body;el.onscroll=mstr.utils.Objects.compositeFunc(el.onscroll,microstrategy.syncLayout);el.onmouseup=mstr.utils.Objects.compositeFunc(el.onmouseup,microstrategy.syncLayout);}catch(err){microstrategy.errors.log(err);}};microstrategy.updateContentNodeHeight=function(h){var contentNode=microstrategy.contentNode;if(contentNode){if(!mstr.utils.ISIE7&&!mstr.utils.ISIE8){contentNode.style.minHeight=microstrategy.getContentHeight()+"px";}}};microstrategy.updateLayoutProps=function(){microstrategy.headerHeight=microstrategy.headerNode&&microstrategy.headerNode.offsetHeight||0;microstrategy.footerHeight=microstrategy.footerNode&&microstrategy.footerNode.offsetHeight||0;microstrategy.contentHeight=microstrategy.getContentHeight();microstrategy.updateContentNodeHeight();};microstrategy.redoLayout=function(){microstrategy.updateLayoutProps();microstrategy.doLayout();microstrategy.syncLayout(true);};microstrategy.getContentHeight=function(){return(microstrategy.eventManager&&microstrategy.eventManager.browserHeight||getClientHeight())-microstrategy.headerHeight-microstrategy.footerHeight;};microstrategy.showShortcutsList=function(){var mi=microstrategy,data=mi.shortcutsData;var loaderId="mstrSCListLoader",showLoader=function(){var elLoader=document.getElementById(loaderId);if(!elLoader){elLoader=document.createElement("div");elLoader.id=loaderId;elLoader.innerHTML='<div class="mstrSCListLoaderIcon"></div>';document.body.appendChild(elLoader);mi[loaderId]=elLoader;var pathNode=document.getElementById("mstrWeb_path");elLoader.style.top=(pathNode.offsetHeight+pathNode.offsetTop)+"px";}elLoader.className="open";},hideLoader=function(){var elLoader=mi[loaderId];if(elLoader){elLoader.className="";}};showLoader();function showSCList(){var $M=mstrmojo,popup=$M.all.mstrSCList;if(!popup){$M.requiresCls("mstrmojo.css");var popup=$M.insert({id:"mstrSCList",scriptClass:"mstrmojo.Popup",autoCloses:true,locksHover:true,markupMethods:{onvisibleChange:function(){if(this.isOpen){mstrmojo.css.toggleClass(this.domNode,"open",this.visible);}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},onOpen:function onOpen(){var $this=this,dn=$this.domNode,pathNode=document.getElementById("mstrWeb_path"),pos=mstr.utils.BoxModel.position(pathNode),offset=pos.top+pos.height;dn.style.top=offset+"px";$this.set("visible",false);$this.isOpen=true;window.setTimeout(function(){$this.set("visible",true);},100);document.getElementById("mstrStarburst").className="opened";microstrategy.toggleCurtain(true);},onClose:function onClose(){var $this=this;window.setTimeout(function(){delete $this.isOpen;},500);document.getElementById("mstrStarburst").className="";microstrategy.toggleCurtain();},cssClass:"mstrShortcutsListPopup",children:[{scriptClass:"mstrmojo.ListBase",onclick:function(){this.parent.close();},items:mi.shortcutsData.sl,getItemMarkup:function(item){return'<a class="item {@name} {@cls} {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="{@href}" target="{@target}"><span class="icon"></span><span>{@n}</span></a>';},getItemProps:function getItemProps(item,idx){var isSelected=!!item.selected;return{sel:isSelected,cls:(isSelected)?"selected":"",newGroup:!!item.grp?"grp":"",n:item.n,idx:idx,href:item.href,name:item.name,onclick:item.onclick||(item.appendState&&"return submitLink(this, event);")||"return true;",target:item.target||"_self"};},itemRenderer:{render:function(item,idx,widget){item._renderIdx=idx;return mstrmojo.string.apply(widget.getItemMarkup(item),widget.getItemProps(item,idx));},select:function(el,item,idx,widget){delegateSelect("select",el,item,idx,widget);},unselect:function(el,item,idx,widget){delegateSelect("unselect",el,item,idx,widget);}}}]});popup.render();}if(!popup.isOpen){popup.open();}else{if(!microstrategy.menuHover){popup.close();}}hideLoader();}if(!data){mstr.$XHR.request(mstrConfig.taskURL,{taskId:"getShortcutsList",pageName:mi.pageName},{success:function(res){mi.shortcutsData=res;if(res&&res.sl.length>0){if(typeof mstrmojo=="undefined"){mi.jsLoader.get("mojo-bootstrap.js",true,showSCList,true);}else{showSCList();}}else{window.location.href=document.getElementById("mstrStarburst").getAttribute("_href");}}});}else{showSCList();}};microstrategy.createIVE=function(){microstrategy.showWait();var folder=this,$M=window.mstrmojo,id="mstrIVE",openIVE=function(c){$M=mstrmojo;var cfg={scriptClass:"mstrmojo.IVEDatasetPicker",id:id,startingFolder:folder.folderId,onRender:function onRender(){var visible=microstrategy.isFeatureAvailable("web-import-data");this.btnImport.set("visible",visible);this.newLabel.set("visible",visible);},onClose:function(config){if(!config||!(config.item||config.action)){return ;}var updateManager=microstrategy.updateManager,actionCollection=[],item=config.item,evt=item?mstrUpdateManager.CONVERT_TO_DOCUMENT:(config.action?mstrUpdateManager.OPEN_IMPORT_ENTRY:null),param_values,param_ids;if(!evt){return true;}if(item){param_ids=mstrUpdateManager.actions[evt].paramID;param_values=[item.did,"",0,1,3,2048,16];}else{param_ids=["3168","3170"];param_values=[false,true];}actionCollection.push(updateManager.createActionObject(null,evt,microstrategy.servletName,param_ids,param_values));updateManager.add(actionCollection);updateManager.useIframe=false;updateManager.flushAndSubmitChanges();}};var d=$M.insert(cfg);d.render();d.open();microstrategy.showWait(false);};var editor=$M&&$M.all&&$M.all[id];if(editor){editor.set("startingFolder",this.folderId);editor.open();microstrategy.showWait(false);}else{microstrategy.mojoLoader.loadWidget({scriptClass:"IVEDatasetPicker",bundle:"mojo-ive-picker.js",callback:openIVE});}};microstrategy.toggleCurtain=function toggleCurtain(show){var mstr=microstrategy;if(!mstr.curtainNode){mstr.curtainNode=document.createElement("div");document.body.appendChild(mstr.curtainNode);}var cn=mstr.curtainNode,cns=cn.style;cns.position="absolute";cns.top="0px";cns.left="0px";cns.height="100%";cns.width="100%";cns.zIndex="100";if(bIsIE4){cns.background="#eee";if(bIsDXIE){cns.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0))";}else{cns.opacity=0;}}cns.display=show?"block":"none";};microstrategy.updateActiveCXProps=function(oTarget,e){microstrategy.activeCXMenu=oTarget;microstrategy.RMCTarget=getEventTarget(e);microstrategy.activeCXBone=null;};microstrategy.setContextMenuStatus=function(isOpen){microstrategy.isCXMenuOpen=isOpen;};microstrategy.setJLSCXMenuOpen=function(isOpen){microstrategy.isJLSCXMenuOpen=isOpen;};microstrategy.isContextMenuOpen=function(){return microstrategy.isCXMenuOpen||microstrategy.isJLSCXMenuOpen;};microstrategy.getActiveCXBone=function(){try{if(!microstrategy.activeCXBone){microstrategy.activeCXBone=microstrategy.findBone(microstrategy.activeCXMenu);}return microstrategy.activeCXBone;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.updateBone=function(propsObj){try{if(microstrategy.bone(propsObj.id)){microstrategy.bone(propsObj.id).absorbObject(propsObj.properties);}else{microstrategy.bonesToRegister.push({id:propsObj.id,loadCondition:propsObj.loadCondition,properties:propsObj.properties});}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.registerBone=function(id,loadCondition,propsObj){try{var elem=getElementById(id);if(!elem){return null;}microstrategy.controlVariables[id]=false;var scriptClass=elem.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);var conditionStatus=false;try{conditionStatus=checkJSExists(scriptClass)&&eval(loadCondition);}catch(e){conditionStatus=false;}if(conditionStatus){var bone=this.callConstructor([id],scriptClass);if(bone){if(this.bones[bone.id]&&this.bones[bone.id].unloadBone){this.bones[bone.id].onunload();}this.bones[bone.id]=bone;microstrategy.controlVariables[id]=true;if(bone.viewerBone){this.viewerBoneId=id;}if(propsObj){if(typeof (propsObj)=="string"){microstrategy.errors.log("Unexpected properties object type at microstrategy.registerBone.");eval("propsObj = "+propsObj);}for(var p in propsObj){bone[p]=propsObj[p];}}return bone;}}else{window.setTimeout(function registerBoneTimeout(){microstrategy.registerBone(id,loadCondition,propsObj);},250);}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.unRegisterBone=function(id){try{if(typeof (this.bones[id])!="undefined"){this.bones[id].onunload();delete this.bones[id];}return true;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.callConstructor=function(aArgs,scriptClass){try{if(!scriptClass){elem=getElementById(aArgs[0]);scriptClass=elem&&elem.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);if(!scriptClass){return null;}}var obj=null;if(aArgs){obj=new window[scriptClass](aArgs[0]);if(aArgs.length>1){window[scriptClass].apply(obj,aArgs);}}else{obj=new window[scriptClass]();}return obj;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.bone=function(id){try{return(typeof (this.bones[id])!="undefined")?this.bones[id]:null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getViewerBone=function(){try{return this.bone(this.viewerBoneId);}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.findBone=function(elem){try{if(elem==null){return null;}var obj=findTarget(elem,microstrategy.HTMLATTR_SCRIPTCLASS);if(obj==null||obj.getAttribute("id")==null){return null;}var bone=this.bone(obj.getAttribute("id"));if(bone){return bone;}else{if(obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_TREE_VIEW){return microstrategy.findBone(obj.parentNode);}}if(elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){if(elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var tab=elem.getElementsByTagName("table");for(var j=0;j<tab.length;j++){var tabParent=tab[j].parentNode;if(tabParent&&tabParent.id.toLowerCase().indexOf("divlock")>0){tabParent=tabParent.parentNode;}if(tabParent&&tabParent.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)&&(tabParent.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_GRID_TABLE||tabParent.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE)){var boneGrid=this.bone(tabParent.getAttribute("id"));if(boneGrid&&(!boneGrid.quickSwitch||boneGrid.quickSwitchCurrent)){return boneGrid;}}}var img=elem.getElementsByTagName("img");for(var j=0;j<img.length;j++){if(img[j].parentNode&&img[j].parentNode.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){var boneGraph=this.bone(img[j].parentNode.getAttribute("id"));if(boneGraph&&(!boneGraph.quickSwitch||boneGraph.quickSwitchCurrent)){return boneGraph;}}}var obj=elem.getElementsByTagName("object");if(obj==null||obj.length==0){obj=elem.getElementsByTagName("embed");}for(var j=0;j<obj.length;j++){if(obj[j].parentNode&&obj[j].parentNode.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){var boneFlash=this.bone(obj[j].parentNode.getAttribute("id"));if(boneFlash&&boneFlash.getGridContainerSpan){return boneFlash;}}}var div=elem.getElementsByTagName("div");for(var j=0;j<div.length;j++){if(div[j]&&div[j].getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){if(div[j].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE){var boneFailed=this.bone(div[j].getAttribute("id"));if(boneFailed&&(!boneFailed.quickSwitch||boneFailed.quickSwitchCurrent)){return boneFailed;}}else{if(div[j].getAttribute(microstrategy.HTMLATTR_IS_VIS_GRID_BONE)=="1"){var boneVis=this.bone(div[j].getAttribute("id"));if(boneVis){return boneVis;}}}}}}else{if(elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){var div=microstrategy.findChildWithAtt(elem,"DIV","scriptClass","mstrRWControlImpl");if(div){return this.bone(div.getAttribute("id"));}else{return this.findBone(elem.parentNode);}}else{return this.findBone(elem.parentNode);}}}else{switch(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)){case microstrategy.OBJTYPE_DOC_SUBSECTION:if(obj.parentNode.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_PANEL_CONTAINER){var bb=this.findBone(obj.parentNode.parentNode);if(bb!=null&&bb.isLoaded){return bb.getPanel(obj.getAttribute("id"));}else{return null;}}case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:case microstrategy.OBJTYPE_DOC:return(this.bone("rwb_viewer")!=null)?this.bone("rwb_viewer").getChildBone(obj):null;break;}}return null;}catch(err){microstrategy.errors.log(err);return(null);}};microstrategy.objectType=function(elem){try{var obj=this.findAncestor(elem);if(obj){return elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.subObjectType=function(elem){try{return elem&&elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getRegisteredAncestor=function(elem){if(!elem){return null;}var src=findTarget(elem,microstrategy.HTMLATTR_SCRIPTCLASS);if(src){var bone=microstrategy.bone(src.getAttribute("id"));if(bone){return bone;}return microstrategy.getRegisteredAncestor(src.parentNode);}return null;};microstrategy.findAncestor=function(elem){if(elem){return(findTarget(elem,microstrategy.HTMLATTR_OBJTYPE));}else{return null;}};microstrategy.findAncestorBone=function(bone,scriptClass){try{var obj=microstrategy.findAncestorWithAtt(bone.elem,"scriptclass",scriptClass);if(obj){return microstrategy.bone(obj.id);}else{return null;}}catch(err){return null;}};microstrategy.findAncestorWithAtt=function(oTarget,sAtt,sAttValue){try{var fn=(sAttValue)?function(t,a,v){return !!(t.getAttribute&&t.getAttribute(a)==v);}:function(t,a){return !!(t.getAttribute&&t.getAttribute(a)!=null);};while(oTarget){if(fn(oTarget,sAtt,sAttValue)){return oTarget;}oTarget=oTarget.parentNode;}return null;}catch(err){return null;}};microstrategy.findAncestorWithTag=function(oTarget,tagName){try{while(oTarget){if(oTarget.tagName==tagName){return oTarget;}oTarget=oTarget.parentNode;}return null;}catch(err){return null;}};microstrategy.findChildrenWithAtt=function(elem,tagName,sAtt,sAttValue){try{if(!elem){return null;}if(typeof (tagName)!="object"){tagName=[tagName];}var result=new Array;var resultCount=0;if(sAttValue){for(var j=0;j<tagName.length;j++){if((elem.tagName==tagName[j])&&(elem.getAttribute(sAtt)==sAttValue)){return elem;}var objs=elem.getElementsByTagName(tagName[j]);if(objs&&objs.length){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(sAtt)==sAttValue){result[resultCount++]=objs[i];}}}}}else{for(var j=0;j<tagName.length;j++){var objs=elem.getElementsByTagName(tagName[j]);if(objs&&objs.length){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(sAtt)!=null){result[resultCount++]=objs[i];}}}}}return result;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findRegisteredChildBone=function(elem,tagName,scriptClass){try{if(!elem){return null;}if((elem.tagName.toLowerCase()==tagName)&&(isAttributePresent(elem,"scriptclass",scriptClass))){return microstrategy.bone(elem.id);}var objs=elem.getElementsByTagName(tagName);for(var i=0;objs&&i<objs.length;i++){if(isAttributePresent(objs[i],"scriptclass",scriptClass)){return microstrategy.bone(objs[i].id);}}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findRWObjectBone=function(target,scriptClass){try{if(microstrategy.objectType(target)||target.getAttribute("scriptclass")){var ancestor=microstrategy.findAncestor(target);if(microstrategy.subObjectType(ancestor)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return microstrategy.findRegisteredChildBone(target,"span");}else{return microstrategy.findRegisteredChildBone(target,"div",scriptClass);}}else{return microstrategy.findBone(target);}}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findChildWithAtt=function(elem,tagName,sAtt,sAttValue){try{if(!elem){return null;}if(typeof (tagName)!="object"){tagName=[tagName];}for(var j=0;j<tagName.length;j++){if((elem.tagName!=null&&tagName[j]!=null&&elem.tagName.toLowerCase()==tagName[j].toLowerCase())&&(elem.getAttribute(sAtt)==sAttValue)){return elem;}var objs=elem.getElementsByTagName(tagName[j]);if(objs&&objs.length){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(sAtt)!=null&&(objs[i].getAttribute(sAtt).toString()).toLowerCase()==sAttValue.toLowerCase()){return objs[i];}}}}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findChildWithCssClass=function(elem,tagName,className){try{if(!elem){return null;}if(typeof (tagName)!="object"){tagName=[tagName];}for(var j=0;j<tagName.length;j++){var pattern=new RegExp("(^|\\s)"+className+"(\\s|$)","i");if((elem.tagName!=null&&tagName[j]!=null&&elem.tagName.toLowerCase()==tagName[j].toLowerCase())&&pattern.test(elem.className)){return elem;}if(elem.getElementsByClassName){var objs=elem.getElementsByClassName(className);for(var obj,i=0;obj=objs[i];i++){if(tagName[j].toLowerCase()==obj.tagName.toLowerCase()){return obj;}}}else{var objs=elem.getElementsByTagName(tagName[j]);for(var obj,i=0;obj=objs[i];i++){if(pattern.test(obj.className)){return obj;}}}}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findParentWithTag=function(elem,tagName){try{var parent=elem.parentNode;while(parent!=null){if(parent.tagName&&parent.tagName.toLowerCase()==tagName){return parent;}parent=parent.parentNode;}}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.objectFind=function(elem,tagName,objtype){try{return microstrategy.findChildWithAtt(elem,tagName,microstrategy.HTMLATTR_OBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.objectListFind=function(elem,tagName,objtype){try{return microstrategy.findChildrenWithAtt(elem,tagName,microstrategy.HTMLATTR_OBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.subObjectFind=function(elem,tagName,objtype){try{return microstrategy.findChildWithAtt(elem,tagName,microstrategy.HTMLATTR_SUBOBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.subObjectListFind=function(elem,tagName,objtype){try{return microstrategy.findChildrenWithAtt(elem,tagName,microstrategy.HTMLATTR_SUBOBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getRect=function(obj){try{if(obj){var oRect=new Object;oRect.left=getObjSumLeft(obj);oRect.top=getObjSumTop(obj);oRect.right=oRect.left+getObjWidth(obj);oRect.bottom=oRect.top+getObjHeight(obj);return oRect;}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.doRectsIntersect=function(r1,r2){try{return(r2.left<r1.right&&r2.right>r1.left&&r2.top<r1.bottom&&r2.bottom>r1.top);}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.isRectInRect=function(r1,r2){try{return(r1.left>r2.left&&r1.right<r2.right&&r1.top>r2.top&&r1.bottom<r2.bottom);}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.relativeSnapCoordinate=function(x,parentNode,isVertical,useSnap,direction){try{var offset=(isVertical)?getObjSumTop(parentNode):getObjSumLeft(parentNode);if(!useSnap){return x;}return this.snapCoordinate(x,offset,useSnap,direction);}catch(err){microstrategy.errors.log(err);return x;}};microstrategy.isSnapped=function(x,parentNode,isVertical){try{var offset=0;if(parentNode!=null){offset=(isVertical)?getObjSumTop(parentNode):getObjSumLeft(parentNode);}return(((x-offset)%microstrategy.SNAP_SIZE)==0);}catch(err){microstrategy.errors.log(err);return x;}};microstrategy.snapCoordinate=function(x,offset,useSnap,direction){try{var relative=x-offset;if(useSnap!=null&&useSnap==false){return relative;}var moveDistance=0;var rtn=x;if(relative%microstrategy.SNAP_SIZE!=0){if(direction!=null){moveDistance=(direction==microstrategy.SNAP_DIRET_POS)?(microstrategy.SNAP_SIZE-relative%microstrategy.SNAP_SIZE):(relative%microstrategy.SNAP_SIZE)*microstrategy.SNAP_DIRET_NEG;rtn+=moveDistance;}else{moveDistance=relative%microstrategy.SNAP_SIZE;if(moveDistance>microstrategy.SNAP_SIZE/2){moveDistance=moveDistance-microstrategy.SNAP_SIZE;}rtn-=moveDistance;}}return rtn;}catch(err){microstrategy.errors.log(err);return x;}};microstrategy.createAssociativeArray=function(elem){try{if(elem==null){return null;}var items={};if(!elem.length){items.item=elem;}else{for(var i=0;i<elem.length;i++){items[i]=elem[i];}}return items;}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.boneForMask=function(src){if(!src){return null;}var type=src.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var bone=null;if(type==microstrategy.OBJTYPE_MASK||type==microstrategy.OBJTYPE_MASK_MAP){bone=microstrategy.bone(src.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT));if(bone==null){bone=microstrategy.findBone(document.getElementById(src.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT)));}}else{if(type==microstrategy.OBJTYPE_MASK_MAP_AREA){bone=microstrategy.bone(src.parentNode.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT));}}return bone;};microstrategy.updatePreference=function(name,value){try{if(typeof (mstrUpdateManager)!="undefined"&&mstrUpdateManager.SET_PREFERENCE){this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,["5003","5004"],[name,value],[])],true);}}catch(err){microstrategy.errors.log(err);}};microstrategy.updateBrowserSetting=function(name,value,isSessionSetting){try{var evt=isSessionSetting?mstrUpdateManager.SET_SESSION_BROWSER_SETTING:mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING;if(typeof (mstrUpdateManager)!="undefined"&&evt){this.updateManager.add([this.updateManager.createActionObject(null,evt,microstrategy.servletName+"."+microstrategy.pageName,["5005","5007"],[name,value],[])],true);}}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.updateCookieSetting=function(name,value){try{var toUpdate=name+microstrategy.ENCODED_EQUALS,existingValue=microstrategy.getCookieSetting(name),oldValue=toUpdate+(existingValue||0),newValue=toUpdate+value;if(existingValue===undefined){var cookieName="bSet=",cookieExists=document.cookie.indexOf(cookieName)!==-1;if(cookieExists){document.cookie=document.cookie.replace(cookieName,cookieName+newValue+microstrategy.ENCODED_AMPERSAND);}else{document.cookie=cookieName+newValue;}}else{document.cookie=document.cookie.replace(oldValue,newValue);}}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.getCookieSetting=function(name){try{return microstrategy.getCookieList()[name];}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.getCookieList=function(){try{var cookie=document.cookie,cookieList={},s=null;if(!cookie||!(typeof cookie==="string")||cookie.indexOf("bSet")<0){return cookieList;}cookie=cookie.split(";");for(s in cookie){if(cookie[s].indexOf("bSet")>=0){cookie=trim(cookie[s]);break;}}cookie=cookie.replace("bSet=","").split(microstrategy.ENCODED_AMPERSAND);for(s in cookie){s=cookie[s].split(microstrategy.ENCODED_EQUALS);cookieList[s[0]]=s[1];}return cookieList;}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.isValueInFilter=function(currentValue,filterValue,filterComparison){var toReturn=true;try{if(currentValue!=null&&filterValue!=null){toReturn=false;if(!filterComparison||(filterComparison==microstrategy.HTMLATTR_FILTER_COMPARISON_DEFAULT)){var values=filterValue.split(",");var index=0;while(index<values.length&&!toReturn){toReturn=(values[index]==currentValue);index++;}}else{toReturn=parseInt(currentValue)&parseInt(filterValue);}}}catch(err){microstrategy.errors.log(err);}return toReturn;};microstrategy.adjustUserPalette=function(newColor){try{var updated=false;var colors=this.userPalette;if(colors.length==0){colors=newColor;updated=true;}else{if(colors.indexOf(newColor)<0){var tempColors=colors.split(",");if(tempColors.length==8){colors=colors.substr(8,colors.length);}colors+=","+newColor;updated=true;}}if(updated){this.userPalette=colors;}return(updated)?colors:null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getFormatObject=function(){try{if(this.formatObj==null){this.formatObj=mstrFormatObject;}return this.formatObj;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.setSingleFormat=function(formatId,formatValue){try{var toReturn=[];var prop=formatId;var value=formatValue;var formatObj=mstrFormatObject;switch(formatId){case"Bold":prop="fontWeight";value=(formatValue)?"bold":"normal";break;case"Italic":prop="fontStyle";value=(formatValue)?"italic":"normal";break;case"Underline":prop="textDecoration";value=(formatValue)?4:-4;break;case"StrikeOut":prop="textDecoration";value=(formatValue)?8:-8;break;case"fstyle":if(parseInt(formatValue)&1){return microstrategy.setSingleFormat("Bold",formatValue);}else{if(parseInt(formatValue)&2){return microstrategy.setSingleFormat("Italic",formatValue);}else{return microstrategy.setSingleFormat("Underline",formatValue);}}break;case"TextAlign":case"align":prop="textAlign";value=formatObj.decodeValue(prop,formatValue);break;case"Horizontal":prop="textAlign";value=formatObj.decodeValue(prop,formatValue);break;case"GridHorizontal":prop="textAlign2";value=formatObj.decodeValue(prop,formatValue);break;case"Vertical2":prop="verticalAlign2";value=formatObj.decodeValue(prop,formatValue);break;case"Vertical":prop="verticalAlign";value=formatObj.decodeValue(prop,formatValue);break;case"FontFamily":case"font":case"Name":prop="fontFamily";break;case"FontSize":case"fsize":case"Size":prop="fontSize";value=formatObj.decodeValue(prop,formatValue);break;case"bgcolor":case"FillColor":if(formatValue==null||formatValue.length==0){prop="backgroundColor";value="transparent";}else{if(formatValue.indexOf(",")>=0){prop="Gradient";}else{prop="backgroundColor";}}break;case"FillStyle":prop="backgroundStyle";if(formatValue==null||formatValue.length==0){value="transparent";}if(formatValue&&formatValue.indexOf(",")>0){value="Gradient";}break;case"LineSpacing":prop="lineHeight";if(formatValue=="0"){formatValue="normal";}if(formatValue!="normal"){formatValue+="in";}value=formatValue;break;case"selectionColor":prop="selectionColor";value=(formatValue=="automatic")?"#60b1f6":formatValue;break;case"selectionStyle":prop="selectionStyle";value=(formatValue=="automatic")?"0":"1";break;case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":prop="paddingLeft";if(formatId=="RightPadding"){prop="paddingRight";}if(formatId=="BottomPadding"){prop="paddingBottom";}if(formatId=="TopPadding"){prop="paddingTop";}value=formatValue+"pt";break;case"TextWrap":prop="whiteSpace";value=(formatValue>0)?"normal":"nowrap";break;case"color":case"Color":case"FontColor":prop="color";break;case"TopColor":case"LeftColor":case"RightColor":case"BottomColor":prop="borderTopColor";if(formatId=="LeftColor"){prop="borderLeftColor";}if(formatId=="RightColor"){prop="borderRightColor";}if(formatId=="BottomColor"){prop="borderBottomColor";}break;case"TopStyle":case"LeftStyle":case"RightStyle":case"BottomStyle":prop="borderTopStyle";if(formatId=="LeftStyle"){prop="borderLeftStyle";}if(formatId=="RightStyle"){prop="borderRightStyle";}if(formatId=="BottomStyle"){prop="borderBottomStyle";}switch(formatValue){case"0":case"5":case"1":case"7":value="solid";break;case"3":value="dashed";break;case"4":value="dotted";break;case"6":value="double";break;}break;case"topWidth":case"leftWidth":case"rightWidth":case"bottomWidth":prop="borderTopWidth";if(formatId=="leftWidth"){prop="borderLeftWidth";}if(formatId=="rightWidth"){prop="borderRightWidth";}if(formatId=="bottomWidth"){prop="borderBottomWidth";}switch(formatValue){case"0":value="0pt";break;case"3":case"4":case"1":case"7":value="1pt";break;case"5":value="1.5pt";break;case"6":value="2.5pt";break;}break;case"HasDropShadow":prop="dropShadowEffect";value=(value)?"1":"0";break;case"HasRoundedCorners":prop="hasRoundedCorners";value=(value)?"-1":"0";break;case"DropShadow":prop="dropShadowDepth";break;case"TopCornersOnly":prop="topCornersOnly";break;}toReturn[0]=prop;toReturn[1]=value;return toReturn;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.checkACL=function(elem,aclList){try{if(elem&&aclList){var acl=elem.getAttribute(microstrategy.HTMLATTR_ACL);if(acl&&acl.length>0){var iAcl=parseInt(acl);for(var i=0;i<aclList.length;i++){if((parseInt(aclList[i])&iAcl)==0){return false;}}}}return true;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.isValidGroupByType=function(dssType){try{if(dssType==microstrategy.DSSTYPE_CONSOLIDATION||dssType==microstrategy.DSSTYPE_FILTER||dssType==microstrategy.DSSTYPE_ATTRIBUTE){return true;}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleEditor=function(boneId,beanName,doNotSubmit){try{var b=this.bone(boneId);if(b){b.closeEditor();}else{var updateManager=this.updateManager;var actionCollection=[];actionCollection.push(updateManager.createActionObject(this,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,beanName],[]));updateManager.add(actionCollection);if(!doNotSubmit){updateManager.flushAndSubmitChanges();}}return true;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.showAccordionWhileWaiting=function(cellId,containerId){try{if(!cellId){cellId="td_mstrWeb_dockLeft";}if(!containerId){containerId="mstrWeb_dockLeft";}var accordion=document.getElementById("accordion_AccordionTabManagerStyle");if(accordion&&accordion.getAttribute(mstrHTMLAttributes.ATTR_HIDDEN)!="true"){var leftCell=document.getElementById(cellId);if(leftCell){leftCell.style.display="block";leftCell.style.width="220px";leftCell.style.border="none";}var leftDiv=document.getElementById(containerId);if(leftDiv){leftDiv.style.display="block";}var closeBtn=microstrategy.findChildWithAtt(accordion,"IMG",(bIsW3C)?"class":"className","mstrIcon-btn mstrIcon-btnClose");if(closeBtn){closeBtn.style.display="none";}accordion.style.width="220px";if(bIsIE6){accordion.style.position="relative";var relatedReportsDiv=document.getElementById("relatedReportsId");if(relatedReportsDiv){relatedReportsDiv.style.width="210px";}}}}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleAccordion=function(curTab,canTurnOff){try{var b=this.bone("accordion_AccordionTabManagerStyle");var cookieName="lTbar";canTurnOff=(typeof (canTurnOff)!="undefined"&&!canTurnOff)?false:true;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){cookieName=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"obDesign":"obView";}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){cookieName="accordionReportView";}}if(b&&(b.currentTabName==curTab||typeof (curTab)=="undefined")&&canTurnOff){if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION||microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.updateBrowserSetting(cookieName,"0");b.closeEditor(false);var notesIconModel=mstr.$obj("NotesIconModel_model");if(notesIconModel){if(notesIconModel.get("objectID")&&notesIconModel.get("objectType")){notesIconModel.execCheck();}else{var notesIconView=mstr.$obj("NotesIconView_view");if(notesIconView){notesIconView.set("visible",false);}}}}}else{if(b){b.setCurTab(curTab);}else{this.updateBrowserSetting(cookieName,"1");if(typeof (curTab)!="undefined"){this.updateBrowserSetting((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)?"accordionRWTab":"accordionReportTab",curTab);}toggleShowBean("accordion",true,(typeof (curTab)!="undefined")?"currentTabName="+curTab:"");var notesPanelName=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.ACCORDION_REPORT_NOTES_PANEL:microstrategy.ACCORDION_RW_NOTES_PANEL;if(curTab==notesPanelName){var notesIconView=mstr.$obj("NotesIconView_view");if(notesIconView){notesIconView.set("visible",false);}}else{var notesIconModel=mstr.$obj("NotesIconModel_model");if(notesIconModel){if(notesIconModel.get("objectID")&&notesIconModel.get("objectType")){notesIconModel.execCheck();}}}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.needSaveBeforeNotes=function(){try{var bone=((microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.bone("UniqueReportID"):microstrategy.getViewerBone());return(bone&&bone.needSaveBeforeNotes);}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.performSave=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){var rb=microstrategy.bone("UniqueReportID");return(rb&&rb.commands.exec("save"));}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var rwbv=microstrategy.bone("rwb_viewer");return(rwbv&&rwbv.doc.commands.exec("save"));}}}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleRelatedReports=function(){try{var b=this.bones.relatedReports;if(b){this.updateBrowserSetting("lTbar","0");}else{this.updateBrowserSetting("lTbar","1");}this.updateManager.useIframe=false;this.updateManager.flushAndSubmitChanges();return true;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleLeftToolbar=function(){try{var b=this.bone("leftToolbar");if(b){b.close();}else{this.updateBrowserSetting("lTbar","1");this.updateManager.useIframe=false;this.updateManager.flushAndSubmitChanges();}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.disableTextSelection=function(target){try{if(!target){return ;}if(typeof target.onselectstart!="undefined"){target.onselectstart=function(){return false;};}else{if(typeof target.style.MozUserSelect!="undefined"){target.style.MozUserSelect="none";}}}catch(err){microstrategy.errors.log(err);}};mstrAreaObjectImpl.prototype={};function mstrAreaObjectImpl(){this.shape="rect";this.coords="0,0,0,0";this.pointsTo=null;this.onmouseovercoords=null;this.onmouseout=null;this.moveHilite=true;}mstrObjectInfoImpl.prototype={};mstrObjectInfoImpl.prototype.src=null;mstrObjectInfoImpl.prototype.left=0;mstrObjectInfoImpl.prototype.top=0;mstrObjectInfoImpl.prototype.height=0;mstrObjectInfoImpl.prototype.width=0;mstrObjectInfoImpl.prototype.alias="";mstrObjectInfoImpl.prototype.dssId="";mstrObjectInfoImpl.prototype.dssFrmId="";mstrObjectInfoImpl.prototype.dssType=0;mstrObjectInfoImpl.prototype.dssSubType=0;mstrObjectInfoImpl.prototype.dSetId=null;mstrObjectInfoImpl.prototype.dSetName="";mstrObjectInfoImpl.prototype.isUnique=true;function mstrObjectInfoImpl(elem){try{if(elem){this.src=elem;this.alias=elem.getAttribute("ds");var bone=microstrategy.findBone(elem);if(!bone){var subtype=elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE||subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM||subtype==microstrategy.SUBOBJTYPE_METRIC){this.dssId=elem.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.dssType=elem.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}}else{this.dssType=elem.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);this.dssSubType=elem.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);if(this.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){if(bone.type==microstrategy.OBJTYPE_OBJBROWSER){this.dssFrmId=elem.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.dssId=elem.getAttribute(microstrategy.HTMLATTR_ATTRIBUTE_ID);}}else{this.dssId=elem.getAttribute(microstrategy.HTMLATTR_DSS_ID);}switch(bone.type){case microstrategy.OBJTYPE_OBJBROWSER:this.dSetId=microstrategy.primeDataSetId;if(bone.isRWTab){this.dSetId=elem.getAttribute("id").slice(0,32);this.dSetName=bone.getDatasetName(this.dSetId);if(this.dssType==microstrategy.DSSTYPE_METRIC){this.isUnique=bone.isMetricUnique(this.alias);}}break;case microstrategy.OBJTYPE_PAGE_BY_ELEM:this.dSetId=microstrategy.primeDataSetId;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_OBJECT:this.dSetId=elem.getAttribute(microstrategy.HTMLATTR_DSS_SET);break;}}}return this;}catch(err){microstrategy.errors.log(err);return null;}}microstrategy.isEnabled=function(items,prop){try{var format=this.getFormatObject();if(items&&format[prop]){if(format[prop][mstrFormatObject.APPLIES_TO]=="all"){return true;}for(var item in items){if(this.isEnabledForItem(items[item],prop)){return true;}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.isEnabledForItem=function(item,prop){try{if(prop=="Gradient"){return true;}var f=this.getFormatObject();if(f[prop][mstrFormatObject.APPLIES_TO]=="all"){return true;}var at=f[prop][mstrFormatObject.APPLIES_TO];var type=item.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var subType=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(at.contains(type,",")||at.contains(subType,",")){if(subType!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||prop!="textAlign"){return true;}else{if(item.lastChild){var ctlBone=microstrategy.bone(item.lastChild.id);if(ctlBone){switch(ctlBone.ctlStyle){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:case mstrRWControlImpl.CTL_STYLE_SCROLLER:case mstrRWControlImpl.CTL_STYLE_LIST_BOX:return ctlBone.docViewer.commands.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE;default:return true;break;}}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.setPrimeDataSetId=function(id){microstrategy.primeDataSetId=id;};microstrategy.getEventHandlerString=function(path){try{if(typeof (path)!="string"||path.length==0){return"if (true)";}var components=path.split(".");for(var i=1;i<components.length;i++){components[i]=components[i-1]+"."+components[i];}var delimiter="";var s="";for(var i=0;i<components.length;i++){s+=delimiter+"(typeof("+components[i]+") != 'undefined' && "+components[i]+" != null)";delimiter=" && ";}return"if ("+s+")";}catch(err){microstrategy.errors.log(err);return"if (true)";}};microstrategy.isObjectBrowserOpen=function(){try{for(var id in this.bones){if(this.bones[id].type==microstrategy.OBJTYPE_OBJBROWSER){return true;}}}catch(err){microstrategy.errors.log(err);}return false;};microstrategy.getObjectBrowser=function(){try{for(var id in this.bones){if(this.bones[id].type==microstrategy.OBJTYPE_OBJBROWSER){return this.bones[id];}}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.retrievePaddingAndBorders=function(item,styleProp,defFmt){try{var values=[];var props=[];if(item!=null){if(styleProp=="height"){props=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];}else{props=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];}var styleObj=this.styleObj;for(var i=0;i<4;i++){var p=props[i],v;if(p.indexOf("border")>-1){var hasStyle=styleObj.getValue(item,p.replace("Width","Style"))!="none";v=hasStyle?styleObj.getValue(item,props[i]):0;}else{v=styleObj.getValue(item,props[i]);}values.push(v);}return values;}var fmtInfo=this.getFormatObject();var obj={ts:"0",bs:"0",tp:"0",bp:"0",ls:"0",rs:"0",lp:"0",rp:"0"};props=[{ps:"FormattingBorder",p:"Style",a:["Top","Bottom","Left","Right"]},{ps:"FormattingPadding",p:"Padding",a:["Top","Bottom","Left","Right"]},{ps:"FormattingLine",p:"LineWeight"}];var pv,ipv;for(var i=0;i<3;i++){var ps=defFmt[props[i].ps];var is=fmtInfo[props[i].ps];if(!ps||!is){continue;}var p=props[i].p;var a=props[i].a;if(a){for(var j=0;j<4;j++){pv=ps[a[j]+p];ipv=is[a[j]+p];if(!pv||!ipv){continue;}var pn=ipv[mstrFormatObject.HTML_PROP_NAME];var dv=fmtInfo.decodeValue(pn,pv.defaultValue||"0");obj[a[j].substr(0,1).toLowerCase()+p.substr(0,1).toLowerCase()]=dv;}}else{pv=ps[p];ipv=is[p];if(!pv||!ipv){continue;}var pn=ipv[mstrFormatObject.HTML_PROP_NAME];var dv=fmtInfo.decodeValue(pn,pv.defaultValue||"0");obj.ts=dv;obj.bs=dv;obj.ls=dv;obj.rs=dv;}}if(styleProp=="height"){values=[obj.ts,obj.bs,obj.tp,obj.bp];}else{values=[obj.ls,obj.rs,obj.lp,obj.rp];}return values;}catch(err){microstrategy.errors.log(err);return[];}};microstrategy.getPaddingAndBorderPixels=function(item,styleProp,defFmt){try{var values=this.retrievePaddingAndBorders(item,styleProp,defFmt);var pxs=0;var pts=0;for(var i=0;i<values.length;i++){if(values[i]!=null&&values[i].length>0&&!isNaN(parseFloat(values[i]))){if(bIsIE6){pxs+=Math.round(this.getFormatObject().getPxFromPt(values[i]));}else{pts+=parseFloat(values[i]);}}}return pxs+this.getFormatObject().getPxFromPt(pts);}catch(err){microstrategy.errors.log(err);return 0;}};microstrategy.getMaxZIndex=function(pos){try{var maxRWZIndex=0;if(this.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var docViewer=this.bone("rwb_viewer");if(docViewer!=null){if(docViewer.commands&&docViewer.commands.exec){maxRWZIndex=docViewer.commands.exec("maxZIndex");}}}var currentCount=(!isNaN(pos)&&pos>-1?pos:currentModalEditor.length)+mstr.controllers.ModalEditors.size();return maxRWZIndex+currentCount*2+100;}catch(err){microstrategy.errors.log(err);return 0;}};microstrategy.setCursorToEnd=function(field){if(field.createTextRange){var range=field.createTextRange();range.moveStart("character",field.value.length);range.collapse();range.select();}else{field.focus();}};microstrategy.openDialog=function(dialogName,url,actionCollection,beanPath,propsObject){try{var passOut=(actionCollection!=null);if(!passOut){var actionCollection=[];}var ids=new Array("5018","5017");var values=new Array(dialogName,true);if(propsObject){var sm=new mstrSerializer();for(var p in propsObject){var pm=new mstrSerializer();pm.addStr(p);pm.addStr(propsObject[p]);sm.addStr(pm.getState());}ids.push("5024");values.push(sm.getState());}actionCollection.push(this.updateManager.createActionObject(this,mstrUpdateManager.SHOW_BEAN,beanPath,ids,values,[]));if(!passOut){this.updateManager.add(actionCollection);}this.updateManager.addURL(url);return(passOut)?actionCollection:null;}catch(err){microstrategy.errors.log(err);return(actionCollection!=null)?actionCollection:false;}};microstrategy.getBonesByType=function(types){try{var __result=[];var parameterType=typeof (types);var typesTestStr=(parameterType.toLowerCase()=="string")?"~"+types+"~":"~"+types.join("~")+"~";for(var b in this.bones){if(typesTestStr.search("~"+this.bones[b].type+"~")>-1){__result.push(this.bones[b]);}}}catch(err){microstrategy.errors.log(err);}return __result;};microstrategy.unregisterGridBones=function(type){try{for(var id in this.bones){var obone=this.bones[id];if(obone&&obone.elem){var obj=obone.elem;var otype=obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(otype==microstrategy.SUBOBJTYPE_GRID_TABLE){microstrategy.unRegisterBone(id);}}}}catch(err){microstrategy.errors.log(err);}};microstrategy.adjustSelectedVisualization=function(bone,newViewMode){try{var currVisViewMode;for(var i=0;i<bone.visualizationList.length;i++){var name=bone.visualizationList[i].name;if(name==bone.selectedVisualization){currVisViewMode=bone.visualizationList[i].vm;break;}}if(currVisViewMode==newViewMode){return ;}var firstVisWithViewMode;for(var j=0;j<bone.visualizationList.length;j++){var vm=bone.visualizationList[j].vm;if(vm==newViewMode){firstVisWithViewMode=bone.visualizationList[j].name;break;}}if(firstVisWithViewMode){var actionCollection=[];if(bone.setVisualizationSettings){bone.setVisualizationSettings(null,firstVisWithViewMode,null,-1,actionCollection);}else{if(bone.doc&&bone.doc.setVisualizationSettings){bone.doc.setVisualizationSettings(null,firstVisWithViewMode,null,-1,actionCollection);}}this.updateManager.add(actionCollection);}}catch(err){microstrategy.errors.log(err);}};microstrategy.updateVisProps=function(enabled,selectedVisualization,visualizationList,viewMode,bone){try{if(enabled){bone.visualizationsEnabled=enabled;}if(selectedVisualization!=null){bone.selectedVisualization=selectedVisualization;}if(visualizationList!=null){var selList=visualizationList.split(",");var allVis=bone.getAllVisList();if(allVis&&selList.length>0){bone.visualizationList=[];for(var i=0;i<selList.length;i++){var curVisName=selList[i];var curVis=allVis[curVisName];if(curVis){bone.visualizationList.push({name:curVisName,desc:curVis.d,vm:curVis.vm});}}}}if(viewMode&&viewMode!=bone.visualizationMode){bone.visualizationMode=viewMode;bone.isVisualization=(viewMode>=50);}}catch(err){microstrategy.errors.log(err);}};microstrategy.repaintContent=function(gridId){try{function repaintCells(table){var rows=table&&table.rows,rows_len=rows&&rows.length||0;for(var i=0;i<rows_len;i++){var cells=rows[i].cells,cells_len=cells.length;for(var j=0;j<cells_len;j++){var s=cells[j].style;s.height="0px";s.height="auto";}}}var gridTable=microstrategy.findAncestorWithAtt(document.getElementById(gridId),(bIsW3C)?"class":"className","repLayout");if(gridTable){repaintCells(gridTable);}var contentTable=document.getElementById("mstrWebContentTable");repaintCells(contentTable);}catch(err){microstrategy.errors.log(err);}};microstrategy.resolveBorderFlags=function(flags,includeSides){var borders=[];try{if(flags==0){borders=[0];}else{if(flags==31){borders=[16];if(includeSides){borders=borders.concat(1,2,4,8);}}else{var test=[1,2,4,8];for(i=0;i<4;i++){if((flags&test[i])>0){borders.push(test[i]);}}}}}catch(err){microstrategy.errors.log(err);}return borders;};microstrategy.overwriteRequestParameters=function(req,modelProps,viewProps){try{var params=req.params||{};mstr.utils.Hash.overwrite(params,modelProps);mstr.utils.Hash.overwrite(params,viewProps);req.params=params;}catch(err){microstrategy.errors.log(err);}};microstrategy.openDataBasedBlockEditor=function(editorId,editorStyle,beanPath,modelProps,viewProps,boneCaller,callbackInfo,parentNode){try{var e=this.getBlockEditorFromCache(editorId,modelProps,viewProps,boneCaller,parentNode);if(e){return ;}var beanPathTokens=beanPath.split(".");var req;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){req=new mstr.http.RwBlockLoaderInput(editorStyle,beanPathTokens[beanPathTokens.length-1]);}else{req=new mstr.http.ReportBlockLoaderInput(editorStyle,beanPathTokens[beanPathTokens.length-2]);}microstrategy.overwriteRequestParameters(req,modelProps,viewProps);this.openBlockEditor(editorId,req,boneCaller,callbackInfo,parentNode);}catch(err){microstrategy.errors.log(err);}};microstrategy.openFolderBasedBlockEditor=function(editorId,editorStyle,folderProps,modelProps,viewProps,boneCaller,callbackInfo,parentNode){try{var e=this.getBlockEditorFromCache(editorId,modelProps,viewProps,boneCaller,parentNode);if(e){return ;}var req=new mstr.http.FolderBlockLoaderInput(editorStyle,folderProps);microstrategy.overwriteRequestParameters(req,modelProps,viewProps);this.openBlockEditor(editorId,req,boneCaller,callbackInfo,parentNode);}catch(err){microstrategy.errors.log(err);}};microstrategy.openBlockLoaderEditor=function(editorId,editorStyle,modelProps,viewProps,boneCaller,callbackInfo,parentNode){try{var e=this.getBlockEditorFromCache(editorId,modelProps,viewProps,boneCaller,parentNode);if(e){return ;}var req=new mstr.http.BlockLoaderInput(editorStyle);microstrategy.overwriteRequestParameters(req,modelProps,viewProps);this.openBlockEditor(editorId,req,boneCaller,callbackInfo,parentNode);}catch(err){microstrategy.errors.log(err);}};microstrategy.getBlockEditorFromCache=function(editorId,modelProps,viewProps,boneCaller,parentNode){try{var editor=mstr.bones.editors.Map[this.id]&&mstr.bones.editors.Map[this.id][editorId];if(editor&&!editor.get("avoidCache")&&editor.get("element").innerHTML){var p;var m=editor.getModel();for(p in modelProps){m.setPropertyByPath(p,modelProps[p]);}if(m&&boneCaller){m.set("opener",boneCaller);}for(p in viewProps){editor.setPropertyByPath(p,viewProps[p]);}if(boneCaller){editor.set("opener",boneCaller);}var el=editor.get("element");if(parentNode&&!mstr.utils.Dom.containsElement(parentNode,el,false)){parentNode.appendChild(el);}editor.set("visible",true);return editor;}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.openBlockEditor=function(editorId,req,boneCaller,callbackInfo,parentNode){try{if(mstr.utils.ISIE4){self.supressWaitPage=true;}var ta=document.createElement("textarea");ta.setAttribute("id",editorId+"_ta");ta.className="mstrJSON";if(parentNode){parentNode.appendChild(ta);}else{document.body.appendChild(ta);}if(!this.taskModel){this.taskModel=new mstr.models.TaskModel({parent:this});mstr.controllers.Factory.add(this.taskModel);var zz=this.taskModel&&this.taskModel.init&&this.taskModel.init();if(!("id" in this)){mstr.controllers.Factory.add(this);}this.taskModel.attachEventListener(this,"set_readyState","handleTaskModelReadyStateChange");}this.taskModel.execFetchBlock(req,ta,{editorId:editorId,opener:boneCaller,callback:callbackInfo});}catch(err){microstrategy.errors.log(err);}};microstrategy.handleTaskModelError=function(evt){if(mstr.utils.ISIE4){self.supressWaitPage=false;}rc=evt.src.get("requestContext");var err=microstrategy.descriptors.getDescriptor(7484);if(rc&&rc.response){if(rc.response.taskErrorCode){switch(rc.response.taskErrorCode){case microstrategy.WEB_API_ERROR_CODES.MSI_SERVER_NAME_NOT_INITIALIZED:case microstrategy.WEB_API_ERROR_CODES.MSI_INVALID_SESSION_ID:case microstrategy.WEB_API_ERROR_CODES.E_MSI_USERMGR_USER_NOTFOUND:case microstrategy.WEB_API_ERROR_CODES.E_MSI_CONNECT_FAILED:this.updateManager.refreshPage();return ;default:err=err+microstrategy.descriptors.getDescriptor(7485)+rc.response.taskErrorCode;break;}}if(rc.response.data){err=err+"\n"+rc.response.data;}else{if(rc.response.status&&rc.response.statusText){err=err+"\n"+rc.response.status+": "+rc.response.statusText;}}}showMessage({contents:err,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});};microstrategy.handleTaskModelReadyStateChange=function(evt){try{var rc=evt.src.get("requestContext");var callbackFn=function(){if(mstr.utils.ISIE4){self.supressWaitPage=false;}var cb=rc&&rc.memo&&rc.memo.callback;if(cb){if(cb.scope){cb.method.apply(cb.scope,[evt]);}else{if(cb.method){cb.method(evt);}}}};switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.ERROR:microstrategy.handleTaskModelError(evt);callbackFn();return ;case mstr.Enum.Widget.READYSTATE.IDLE:var map=mstr.bones.editors.Map[this.id]||{};var v=evt.src.get("views");var o=rc&&rc.memo&&rc.memo.opener;if(o){var i;for(i=0;v&&i<v.length;i++){v[i].set("opener",o);}var m=evt.src.get("models");for(i=0;m&&i<m.length;i++){m[i].set("opener",o);}}var editor=map[rc.memo.editorId]=v[0];editor.render();callbackFn();mstr.bones.editors.Map[this.id]=map;break;case mstr.Enum.Widget.READYSTATE.CANCELLED:callbackFn();break;}}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype={};mstrDNDHelperImpl.prototype.helperImg=null;mstrDNDHelperImpl.prototype.parentBone=null;mstrDNDHelperImpl.prototype.onmouseup=function(path){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener(path,"mousemove");this.parentBone.detachWinListener(path,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}this.parkHelperImage();}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.parkObject=function(obj){try{obj.style.top="-10000px";obj.style.left="-10000px";}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.parkHelperImage=function(){try{if(this.helperImg){this.parkObject(this.helperImg);}}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.moveHelperImage=function(e){try{if(!this.helperImg){this.initElement();}getMouse(e);this.helperImg.style.left=(lMouseX+10)+"px";this.helperImg.style.top=(lMouseY-20)+"px";var mask=microstrategy.findAncestor(getEventTarget(e));if(mask!=null){var bone=this.getMaskedBone(mask);if(bone!=null&&bone.getDNDHelperImage){var imageSrc=bone.getDNDHelperImage(this.parentBone,mask.getAttribute(microstrategy.HTMLATTR_POINTS_TO));if(imageSrc!=null&&this.helperImg.src.search(new RegExp(imageSrc))==-1){this.helperImg.src=imageSrc;}return ;}}this.parkHelperImage();}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.getMaskedBone=function(mask){try{var bone=microstrategy.boneForMask(mask);return(bone!=null&&bone.ondrop)?bone:null;}catch(err){microstrategy.errors.log(err);return null;}};mstrDNDHelperImpl.prototype.initElement=function(){try{var img=document.createElement("img");img.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";img.style.position="absolute";img.style.top=img.style.left="-10000px";img.style.zIndex=1000;if(bIsIE6){img.style.height="auto";img.style.width="auto";}this.helperImg=document.body.appendChild(img);}catch(err){microstrategy.errors.log(err);}};function mstrDNDHelperImpl(obj){this.parentBone=obj;return this;}microstrategy.registerNewBones=function(){for(var i=0,len=microstrategy.bonesToRegister.length;i<len;i++){var boneProp=microstrategy.bonesToRegister[i];microstrategy.registerBone(boneProp.id,boneProp.loadCondition,boneProp.properties);}microstrategy.bonesToRegister.length=0;};microstrategy.addXmlAttr=function(name,value){try{return" "+name+'="'+value+'"';}catch(err){microstrategy.errors.log(err);return 0;}};microstrategy.addXmlAttrEncoded=function(name,value){if(!value){return"";}var buf=[];var len=value.length;var ch;for(var i=0;i<len;i++){ch=value.charAt(i);switch(ch){case">":buf.push("&gt;");break;case"<":buf.push("&lt;");break;case"&":buf.push("&amp;");break;case"\u0009":buf.push("&#x09;");break;case"\n":buf.push("&#x0A;");break;case"\r":buf.push("&#x0D;");break;case'"':buf.push("&quot;");break;default:buf.push(ch);break;}}return" "+name+'="'+buf.join("")+'"';};microstrategy.getPopupMask=function(elem){var __result=elem&&elem.popupMask;if(!__result){if(!document.popupMasks){document.popupMasks=[];var popupMasks=document.getElementsByName("popupMask");if(popupMasks){for(var i=0,len=popupMasks.length;i<len;i++){popupMasks[i].setAttribute("free",true);document.popupMasks.push(popupMasks[i]);}}}var availableMasks=document.popupMasks;for(var i=0;i<availableMasks.length;i++){if(availableMasks[i].getAttribute("free")==true){__result=availableMasks[i];break;}}if(!__result){var popupMask=document.getElementById("popupMask1");var newBackground;if(popupMask){newBackground=popupMask.cloneNode(false);}else{newBackground=document.createElement("iframe");}document.body.appendChild(newBackground);newBackground.style.position="absolute";newBackground.style.visibility="hidden";newBackground.style.display="none";newBackground.setAttribute("border","0");newBackground.id="popupMask"+availableMasks.length;availableMasks.push(newBackground);__result=newBackground;}}if(__result){__result.setAttribute("free",false);__result.style.display="block";if(elem){elem.popupMask=__result;__result.elem=elem;elem.insertAdjacentElement("beforeBegin",__result);__result.style.visibility="visible";__result.className="popupmask";}}return __result;};microstrategy.releasePopupMask=function(elem){if(elem){var popupMask=elem.popupMask;if(popupMask){popupMask.style.display="none";popupMask.style.visibility="hidden";popupMask.style.zIndex=0;popupMask.setAttribute("free",true);popupMask.elem=null;}elem.popupMask=null;}else{var availableBackgrounds=document.popupMasks;if(availableBackgrounds){for(var i=0;i<availableBackgrounds.length;i++){availableBackgrounds[i].style.display="none";availableBackgrounds[i].style.visibility="hidden";availableBackgrounds[i].style.zIndex=0;availableBackgrounds[i].setAttribute("free",true);var associatedElem=availableBackgrounds[i].elem;if(associatedElem){associatedElem.popupMask=null;}availableBackgrounds[i].elem=null;}}}};microstrategy.execDynamiclLink=function(linkInfo,xml,onw){try{window.mstrSubmitLink=true;var argNames=null;var argValues=[linkInfo.tid];var event=null;var tvm=null;if(linkInfo.tty==microstrategy.DSSTYPE_RPT_DEFINITION){event=mstrUpdateManager.RUN_REPORT;argNames=["1001"];if(xml){argNames.push("4222");argValues.push(xml);}argNames.push("4115");argValues.push(microstrategy.getReportViewMode(linkInfo.tstp));}else{if(linkInfo.tty==microstrategy.DSSTYPE_DOC_DEFINITION){if(linkInfo.tstp==microstrategy.DSSSUB_TYPE_RW){event=mstrUpdateManager.RUN_RW_DOCUMENT;argNames=["2048001"];if(xml){argNames.push("2048140");argValues.push(xml);}if(linkInfo.so>0){argNames.push("2048087");argValues.push(this.bone("rwb_viewer").messageID);if(!xml){argNames.push("2048201");argValues.push("0");}argNames.push("2048261");argValues.push(linkInfo.so);}}else{event=mstrUpdateManager.RUN_DOCUMENT;argNames=["1001"];if(xml){argNames.push("32351");argValues.push(xml);}}}}var um=microstrategy.updateManager;var oldUseIframeSetting=um.useIframe;var oldNWSetting=um.newWindow;um.useIframe=false;um.newWindow=onw;if(um.hasChangesToSubmit()){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}um.add([um.createActionObject(this.elem,event,"",argNames,argValues,[])]);um.flushAndSubmitChanges();um.acknowledgeRequest();um.newWindow=oldNWSetting;um.useIframe=oldUseIframeSetting;}catch(err){microstrategy.errors.log(err);}};microstrategy.getReportViewMode=function(subType){switch(subType.toString()){case microstrategy.DSSTYPE_GRAPH:return microstrategy.DISPLAY_MODE_GRAPH;break;case microstrategy.DSSTYPE_GRID_AND_GRAPH:return microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;break;case microstrategy.DSSTYPE_GRID:default:return microstrategy.DISPLAY_MODE_GRID;break;}};microstrategy.isDoubleByte=function(){var localeID=microstrategy.displayLocaleID;if(localeID!=null&&(localeID==1041||localeID==1042||localeID==2052||localeID==1028)){return true;}return false;};microstrategy.loadAdditionalFiles=function(s){microstrategy.delayOnload();var head=document.getElementsByTagName("head")[0];for(var i=0,l=s.length;i<l;++i){var sc="script",tp="text/javascript";if(bIsFirefox){var t=document.createElement(sc),sa="setAttribute";t[sa]("src",s[i]);t[sa]("type",tp);if(mstr.utils.ISFF4PLUS){t.async=false;}head.appendChild(t);}else{document.writeln("<"+sc+' type="'+tp+'" src="'+s[i]+'" defer></'+sc+">");}}};microstrategy.mstrOnLoadFn=null;microstrategy.delayOnload=function(){if(typeof (window.onload)=="function"){microstrategy.mstrOnLoadFn=window.onload;window.onload=null;if(mstr.utils.ISFF3_0){document.body.removeAttribute("onload");}}};microstrategy.getZoomFactor=function(){return microstrategy.ZOOM_FACTOR;};microstrategy.getPersistParams=function(){return microstrategy.persistParams;};microstrategy.useQuickSearch=function(){try{var qse=(microstrategy.enableQuickSearch=="1");var isv=microstrategy.IServerVesion.split("."),minimum="9.2.400.013".split(".");for(var i=0,len=isv.length;i<len;i++){if(isv[i]>minimum[i]){break;}else{if(isv[i]==minimum[i]){continue;}else{qse==false;break;}}}qse=qse&&(microstrategy.isQuickSearchEnabled);return qse;}catch(err){microstrategy.errors.log(err);}};microstrategy.dynamicJS=[];microstrategy.insertScriptTag=function(jsfile,e,notify){var script=document.createElement("script");var sa="setAttribute";script[sa]("src",jsfile);script[sa]("type","text/javascript");script[sa]("defer","defer");document.getElementsByTagName("head")[0].appendChild(script);if(bIsIE4){script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;microstrategy.loadDynamicJS(e,notify);}};}else{if(mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE){script.onload=function(){script.onload=null;microstrategy.loadDynamicJS(e,notify);};}}};microstrategy.loadDynamicJS=function(e,notify){if((bIsIE4||mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE)&&microstrategy.dynamicJS.length>0){if(!checkJSExists(microstrategy.dynamicJS[0]["key"])){microstrategy.insertScriptTag(microstrategy.dynamicJS[0]["file"],e,notify);microstrategy.dynamicJS.shift();}else{microstrategy.dynamicJS.shift();microstrategy.loadDynamicJS(e,notify);}}else{if(notify){microstrategy.eventManager.initializeBones(e);}}};microstrategy.jsLoader={LOADING:1,LOADED:2,status:{},_get:function(file,isBundle,callback){if(!file){if(callback){callback();}return ;}if(isBundle){file="../javascript/bundles/"+file;}var st=this.status,s=st[file];if(!s){st[file]={state:this.LOADING,callback:callback};this.insertScript(file);}else{if(s.state===this.LOADING){if(callback){var earlierCB=s.callback;s.callback=function(){if(earlierCB){earlierCB();}callback();};}}else{if(s.state===this.LOADED){if(callback){callback();}}}}},get:function(file,isBundle,callback,noBootstrap){if(!file){if(callback){callback();}return ;}if(isBundle){if(typeof mstrmojo=="undefined"&&!noBootstrap){var me=this;this._get("mojo-bootstrap.js",isBundle,function(){mstrmojo.locales.load(function(){me._get(file,isBundle,callback);});});return ;}}this._get(file,isBundle,callback);},insertScript:function(file){var el=document.createElement("script"),sa="setAttribute",that=this;el[sa]("src",file);el[sa]("type","text/javascript");el[sa]("defer","defer");el.onload=function(){el.onload=null;if(that){that.onFileLoad(file);that=null;el.onreadystatechange=null;}};el.onreadystatechange=function(){var rs=el.readyState;if(rs==="loaded"||rs==="complete"){el.onreadystatechange=null;if(that){that.onFileLoad(file);that=null;el.onload=null;}}};document.getElementsByTagName("head")[0].appendChild(el);},onFileLoad:function(file){var st=this.status[file]||{},f=st.callback;st.state=this.LOADED;if(f){f();}}};microstrategy.mojoLoader={loadWidget:function(config){var me=this,loadBundle=function(){microstrategy.jsLoader.get(config.bundle,true,function(){me.onload(config);me=null;});};if(typeof mstrmojo=="undefined"&&!config.noBootstrap){microstrategy.jsLoader.get("mojo-bootstrap.js",true,function(){mstrmojo.locales.load(function(){loadBundle();});});}else{loadBundle();}},onload:function(config){var w=mstrmojo.all[config.id];if(!w&&config.scriptClass){var sc=config.scriptClass,json=mstrmojo[sc];if(!json){mstrmojo.requiresCls("mstrmojo."+sc);json=mstrmojo[sc];if(!json){return ;}}w=mstrmojo.insert(json);if(!w){return ;}var p=config.placeholder;if(p){w.placeholder=p;}}if(config.callback){config.callback();}}};microstrategy.showWait=function(show){var div=microstrategy.waitIcon;if(!div){div=document.createElement("div");div.className="mstrIcon-wait-container";div.style.cssText="position:fixed;left:0; top:0; right:0; bottom:0; z-index:9;";div.innerHTML='<div class="mstrIcon-wait" style="position:absolute;top:48%;left:48%;z-index:10;"></div><div class="mstrCurtain"></div>';microstrategy.waitIcon=document.body.appendChild(div);}div.style.display=show===false?"none":"block";};microstrategy.openCustomGroupEditor=function(customGroupId){if((bIsIE6&&!bIsIE7)||bIsIEQuirks){showMessage({contents:microstrategy.descriptors.getDescriptor("7914"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_INFO});return ;}microstrategy.showWait();var id="mstrCGE",_openCGE=function(c){c.scriptClass="mstrmojo.Obj";var m=mstrmojo.insert(c),w2=mstrmojo.all[id];if(!w2){return ;}w2.set("model",m);w2.open();microstrategy.showWait(false);},reqModel=function(){var cfg={success:function(res){if(!res){mstrmojo.alert("Error retrieving the Custom Group definition!");return ;}_openCGE(res);},failure:function(res){microstrategy.showWait(false);mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("GET",mstrConfig.taskURL,cfg,{taskId:"getCustomGroup",customGroupId:customGroupId,styleName:"MojoCustomGroupStyle"});},newModel=function(){_openCGE({cgp:{agg:1,flat:false,pf:true,rfi:-1,ce:true,isp:true}});},m=window.mstrmojo,w=m&&m.all[id],getModel=customGroupId?reqModel:newModel;if(!w){microstrategy.mojoLoader.loadWidget({scriptClass:"CustomGroupEditor",id:id,bundle:"mojo-cge.js",callback:getModel});}else{getModel();}};microstrategy.openMetricEditor=function(metricId,type){microstrategy.showWait();var id=type||"mstrFSE",fcts=null,openME=function(oi){microstrategy.showWait(false);id={65536:"mstrME",131072:"mstrSME",196608:"mstrFE"}[oi.tks.met]||id;var ae=mstrmojo.all[id];if(!ae){var c={id:id,oi:oi,functions:fcts,scriptClass:"mstrmojo.ME."+{mstrFSE:"FunctionSelector",mstrFE:"FunctionWizard",mstrSME:"SimpleMetricEditor",mstrME:"MetricEditor"}[id]};ae=mstrmojo.insert(c);}else{ae.set("oi",oi);}ae.open();},failure=function(res){microstrategy.showWait(false);mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},fsuccess=function(res){try{fcts=res;if(metricId){mstrmojo.ME.MetricDataService.getMetricDefintion({id:metricId},{success:function(res){openME(res);},failure:failure});}else{openME({did:"",n:microstrategy.descriptors.getDescriptor("2213"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}});}}catch(ex){}};var getFuncs=function(){mstrmojo.ME.MetricDataService.getFunctions({success:fsuccess,failure:failure});};var m=window.mstrmojo,w=m&&m.all[id];if(!w){microstrategy.mojoLoader.loadWidget({bundle:"mojo-metric.js",id:id,callback:getFuncs});}else{getFuncs();}};microstrategy.showSharingEditor=function(href,objInfo,isLinkDirty){var $ID="sharingEditor",defaultOi=mstrApp.oi,objectID=(objInfo&&objInfo.objId)||defaultOi.objId,objectType=(objInfo&&objInfo.objType)||defaultOi.objType,messageId=(objInfo&&objInfo.mid)||defaultOi.mid,openSharingEditor=function(oi){var sharingEditor=mstrmojo.all[$ID];if(!sharingEditor){sharingEditor=mstrmojo.insert({scriptClass:"mstrmojo.SharingEditor",guestModeEnabled:microstrategy.guestModeEnabled,mid:messageId,id:$ID,oi:oi,href:href,isLinkDirty:isLinkDirty,viewMode:objInfo?objInfo.viewMode:1,lastState:objInfo?objInfo.lastState:0,showWait:function(){iframe.showWaitPage();},hideWait:function hideWait(){iframe.hideWaitPage();}});}else{sharingEditor.set("oi",oi);sharingEditor.href=href;sharingEditor.mid=messageId;sharingEditor.isLinkDirty=isLinkDirty;sharingEditor.viewMode=objInfo?objInfo.viewMode:1;sharingEditor.lastState=objInfo?objInfo.lastState:0;}sharingEditor.open();},requestSharingEditor=function(){var cb={success:function(res){openSharingEditor(res.objects[0]);},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){microstrategy.showWait(false);}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,{taskId:"getObjectInfo",objectIDs:objectID,objectTypes:objectType,includeACL:microstrategy.isFeatureAvailable("web-use-sharing-editor"),sessionState:mstrApp.sessionState});};microstrategy.showWait();var sharingEditor=window.mstrmojo&&mstrmojo.all[$ID];if(sharingEditor){requestSharingEditor();}else{microstrategy.jsLoader.get("mojo-sharing.js",true,requestSharingEditor);}};microstrategy.isFeatureAvailable=function(name){try{var __result=true;return((microstrategy.features!=null)&&typeof (microstrategy.features[name])!="undefined");}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.setupPageMessageDisplay=function(){try{var el=document.getElementById("message-before-grid");if(el){var fnClose=function(){el.style.display="none";microstrategy.eventManager.notifyOrphanBones("onwinresize");};var x=document.createElement("img");x.src="../images/1ptrans.gif";x.title=microstrategy.descriptors.getDescriptor(2102);x.className="mstrIcon-btn mstrIcon-btnClose";x.style.cssText="position:absolute; right:1px; top:0; height:20px;width:20px;";x.onclick=fnClose;el.appendChild(x);var delay=3000,t=el.getAttribute("ty");switch(t){case"err":delay=3600*1000;break;case"sub":case"hl":delay=8000;}window.setTimeout(fnClose,delay);}}catch(err){microstrategy.errors.log(err);}};microstrategy.uploadDashboardFile=function(formId){var form=document.getElementById(formId),myFileInput=microstrategy.findChildWithAtt(form,"input","name","myFile"),file=myFileInput.value,resetFileInput=function(){if(mstr.utils.ISIE4){var fm=document.createElement("form");myFileInput.parentNode.insertBefore(fm,myFileInput);fm.appendChild(myFileInput);fm.reset();fm.removeNode(false);}};if(file==""){return ;}else{if(/\.mstr$/.test(file.toLowerCase())){microstrategy.showWait(true);addURLAsHiddenInputsToForm(form,microstrategy.addCSRFTokenToURL(microstrategy.servletName));form.submit();}else{mstr_descs=microstrategy.descriptors;showMessage({title:mstr_descs.getDescriptor(11226),contents:mstr_descs.getDescriptor(11227),type:mstrMsgBoxImpl.MSG_ERROR,elements:microstrategy.OK_BUTTON});}}resetFileInput();};microstrategy.uploadCallback=function(res){var success=res.status==200,msgBoxID="msgBox",mstr_descs=microstrategy.descriptors,cssClass="importRWDResult",sn=microstrategy.servletName,myUrl=microstrategy.addCSRFTokenToURL(sn+"?evt=2001&src="+sn+".2001&systemFolder=20"),msgInfo={title:mstr_descs.getDescriptor(8118),messageBoxID:msgBoxID,elements:microstrategy.APPLY_BUTTON,buttonLabels:{Apply:mstr_descs.getDescriptor(1442)},applyEval:success?"location.href = '"+myUrl+"'":"",type:cssClass+(success?"Success":"Failure"),contents:success?mstr_descs.getDescriptor(11221):mstr_descs.getDescriptor(11222)},appendExtraMsg=function(msgNodeId,tbody,message){var msgNode=document.getElementById(msgNodeId);if(!msgNode){var tr=document.createElement("tr"),td=document.createElement("td"),msgNode=document.createElement("span");tbody.appendChild(tr);tr.appendChild(td);td.appendChild(msgNode);msgNode.id=msgNodeId;td.className=msgNodeId+"Container";}msgNode.innerHTML=message;return msgNode;};if(success){var dashUrl=microstrategy.addCSRFTokenToURL(sn+"?evt=2048001&src="+sn+".2048001&visMode=0&documentID="+res.content.did);msgInfo.elements+=microstrategy.OK_BUTTON;msgInfo.buttonLabels["Ok"]=mstr_descs.getDescriptor(11223);msgInfo.okEval="location.href = '"+dashUrl+"'";}showMessage(msgInfo);var msgBoxNode=document.getElementById(msgBoxID),centerAlignElement=function(elem){var center_x=Math.max(Math.floor(((getClientWidth()-getObjWidth(elem))/2+getDocumentScrollLeft())));var center_y=Math.max(Math.floor(((getClientHeight()-getObjHeight(elem))/2)+getDocumentScrollTop()));moveObjTo(elem,center_x,center_y);};addCssClass(msgBoxNode,[cssClass,(success?"success":"failure")]);var detailMsg=success?mstr_descs.getDescriptor(11224).replace("##",res.content.n):(mstr_descs.getDescriptor(11225)+" <a onclick=\"addCssClass(document.getElementById('"+msgBoxID+"'), 'showErrorDetail');\">"+mstr_descs.getDescriptor(5811)+"</a>"),detailMsgNode=appendExtraMsg("msgContentImportDetail",microstrategy.findAncestorWithTag(document.getElementById("msgContent"),"TBODY"),detailMsg);detailMsgNode.parentNode.colSpan=2;if(!success){appendExtraMsg("msgContentImportErrorDetail",microstrategy.findAncestorWithTag(document.getElementById("msgTable"),"TBODY"),res.errorMsg);}centerAlignElement(msgBoxNode);microstrategy.showWait(false);};microstrategy.addCSRFTokenToURL=function(url){if(!url){return"";}var vrn=(window.microstrategy&&microstrategy.validateRandNum)||(window.mstrConfig&&mstrConfig.validateRandNum)||(window.mstrApp&&mstrApp.validateRandNum);if(vrn&&vrn.length>0){if(url.indexOf("validateRandNum")==-1){try{if(!microstrategy.isUrlExternal(url)){if(url.indexOf("?")>0){url+="&";}else{url+="?";}url+="validateRandNum="+vrn;}}catch(err){}}}return url;};microstrategy.submitHyperlink=function submitHyperlink(oAnchor){var sURL=oAnchor.getAttribute("hv")||oAnchor.href,sTarget=oAnchor.target;if(microstrategy.isUrlExternal(sURL)){return true;}var oForm=document.createElement("FORM");oForm.name="dynamic_form";oForm.method="POST";var hasParameters=sURL.indexOf("?")>0,formAction=((hasParameters)?sURL.substring(0,sURL.indexOf("?")):sURL);oForm.action=formAction;if(hasParameters){addURLAsHiddenInputsToForm(oForm,sURL);}document.body.insertAdjacentElement("beforeEnd",oForm);if(sTarget){oForm.target=sTarget;}oForm.submit();if(window.event){window.event.cancelBubble=true;}return false;};microstrategy.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var isSameWebApp=(url.indexOf(microstrategy.servletName)==0||url.indexOf("./"+microstrategy.servletName)==0||url.indexOf(mstrConfig.taskURL)===0||url.indexOf("./"+mstrConfig.taskURL)===0||url.indexOf(curURL)==0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))==0)));return !isSameWebApp;};microstrategy.scrollPageHorizontally=function(mouseX){try{var threshold=30,diff=lMouseX-getClientWidth(),scrollLeft=document.documentElement.scrollLeft||document.body.scrollLeft,delta=lMouseX-scrollLeft<threshold?-threshold:(diff>-threshold?threshold:0);document.documentElement.scrollLeft+=delta;document.body.scrollLeft+=delta;}catch(err){microstrategy.errors.log(err);}};