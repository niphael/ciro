var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},now:function now(){return new Date().getTime();},usesFrames:false};mstrmojo.gmaps={};(function(){var F=mstrmojo;F.global=(function(){var G=function(){return this;};return G.call(null);}());F.dbg=F.emptyFn;F.dbg_stack=F.emptyFn;F.dbg_xhr=F.emptyFn;F.dbg_profile=F.emptyFn;F.platform={};F.prompt={};F.settings={};F.ui={};F.ACL={};F.storage={};F.utils={};F.maps={};F.maps.androidmap={};F.maps.jsmap={};F.graph={};F.IPA={};F.ME={};F.Architect={};F.plugins={};F.gmaps={};F.DI={};F.qb={};F.WH={};F.txEditor={};F.express={ui:{}};F.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{}},selectors:{},ui:{}};F.iphone={};F.winphone={};F.mstr={};F.err=function E(I){var H=I.name+': "'+I.message+'"';if(F.debug){if(I.fileName){H+=" at\n    "+I.fileName;}if(I.hasOwnProperty("lineNumber")){H+=": "+I.lineNumber;}else{if(I.hasOwnProperty("line")&&I.sourceURL){var G=I.sourceURL.split("/");H+="("+G[G.length>1?G.length-1:0]+":"+I.line+")";}}}this.dbg(H);if(F.Dialog){F.alert(I.message,null,I.name);}else{window.alert(H);}};F.confirm=function B(G){return window.confirm(G);};F.alert=function D(G){window.alert(G);};var C=!!(/return true/.test(function(){return true;}));F.mixin=function A(K,I){if(K){I=I||{};var J=/this\.\_super/;var H=function(O,N){return function M(){var Q=this._super;this._super=N;var P=O.apply(this,arguments||[]);this._super=Q;return P;};};var G=K.__onmixin__;if(G){delete K.__onmixin__;}var L;for(L in K){if((typeof K[L]==="function")&&(!C||J.test(K[L]))){I[L]=H(K[L],I[L]);}else{I[L]=K[L];}}if(G){K.__onmixin__=G;}}return I;};}());(function(){var _xhr;var _missing={};var _G=mstrmojo.global,_app=_G.mstrApp||{},_jsRoot=_app.jsRoot||"../javascript/",_jsMojoRoot=_app.jsMojoRoot||"../javascript/mojo/js/source/",_isIE=!!document.all;function _fqcn2File(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17));fqcn="../plugins/"+pluginName+"/javascript/"+_jsMojoRoot+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");}else{if(fqcn.match(/^mstrmojo\./)){fqcn=_jsMojoRoot+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=_jsRoot+fqcn.replace(/\./gm,"/");}}return fqcn+".js";}function _getXHR(){_xhr=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function _syncGet(file){var result=null;if(!_xhr){_getXHR();}if(_xhr){try{_xhr.open("GET",file,false);_xhr.send(null);result=_xhr.responseText||null;}catch(localerr){}if(!_isIE&&_xhr.abort){_xhr.abort();}}return result;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function _syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!_xhr){_getXHR();}if(_xhr){try{var config=mstrConfig,m=null;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(config&&config.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}_xhr.open(method,appendUrlParams(method,baseUrl,params),false);if(method!=="POST"){params=null;}else{params=encodeParams(params);_xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");}_xhr.send(params);result=_xhr.responseText||null;}catch(localerr){window.console.log(localerr);}}return result;}function _jsGet(file,nullCheck){var js=_syncGet(file);if(js){try{eval(js);return nullCheck?!!eval(nullCheck):true;}catch(localerr){window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var o;try{o=eval(fqcn);}catch(localerr){}if(o){this.loaded[fqcn]=true;}return !!o;},load:function ld(fqcn){if(_missing[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(_fqcn2File(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}_missing[fqcn]=true;return false;}};var _L=mstrmojo.loader,_LL=_L.loaded;var _reqCache={};mstrmojo.requiresCls=function reqCls(){var as=arguments,ns=[],len=as.length,i;for(i=0;i<len;i++){var n=as[i];if(!n||_LL[n]||_reqCache[n]||_missing[n]){continue;}if(!n.match(/^mstrmojo\.plugins\./)){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!_reqCache[s]){ns.push(s);_reqCache[s]=true;}}}ns.push(n);_reqCache[n]=true;}var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!_L.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}return true;};var _D=mstrmojo.descriptors,_dPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];_D[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;}if(typeof mstrApp!="undefined"){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}if(typeof mstrApp!="undefined"){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var _reqDesc=function(prefix,ids){var as=ids,ns=[],len=as.length,i;for(i=0;i<len;i++){var k=as[i];if(k&&!(_D.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=_syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=eval("("+response+")");populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var p=prefix,args=[].slice.call(arguments);args[0]=null;_reqDesc(p,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){_reqDesc(_dPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if(_D.hasOwnProperty(_dPrefix+descID)){return _D[_dPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";_D[_dPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if(_D.hasOwnProperty(prefix+descID)){return _D[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";_D[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){_LL[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){_reqCache[fqcn]=false;_LL[fqcn]=false;eval(fqcn+" = null");};var mx=mstrmojo.mixin;mstrmojo.declare=function dcl(SuperCls,mixins,config){function constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){constr.prototype=new SuperCls({dontInit:true});constr.prototype.constructor=constr;}var proto=constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){_LL[config.scriptClass]=true;}}return constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getVRN(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));if(!isSameWebApp){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>0){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};}());mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30};(function(){function B(N,H,M){if(!M&&N===!!this._inFullScreen){return ;}delete this._inFlash;var L=this.domNode;if(!L){return ;}var I=L.style,Q=!!this.controller,P=this,K=(this.fullscreenDirection==="up")?"top":"bottom",O=function(){I.position=N?"absolute":"static";if(Q){mstrApp.rootView.doLayout();}},J=function(){if(Q){mstrMobileApp[(N?"enter":"exit")+"FullScreen"]();}};if(!M){this._inFullScreen=N;if(N||!H){O();}}if(!N){if(parseInt(I[K],10)===0){O();J();return ;}if(M){this._inFlash=true;}}if(H){mstrmojo.dom.attachOneTimeEvent(L,"webkitTransitionEnd",function(){if(!N){if(!M){O();}else{P._flashHandle=window.setTimeout(function(){delete P._flashHandle;B.call(P,true,true,true);},3000);}}else{if(P.onEnterFullScreenEnd){P.onEnterFullScreenEnd();}}if(!M){J();}});}else{J();}this["on"+(N?"Enter":"Exit")+"FullScreen"]();I.webkitTransitionDuration=H?"":0;I[K]=N?-L.offsetHeight+"px":0;}function D(){var H=this._flashHandle;if(H){window.clearTimeout(H);delete this._flashHandle;}}mstrmojo.android.ui._CanBeFullScreen=mstrmojo.provide("mstrmojo.android.ui._CanBeFullScreen",{fullscreenDirection:"up",onEnterFullScreen:mstrmojo.emptyFn,onExitFullScreen:mstrmojo.emptyFn,resetFullScreen:function F(){if(this._inFullScreen){delete this._inFullScreen;B.call(this,true,false);}},enterFullScreen:function C(){B.call(this,true,true);},flashFullScreen:function G(){if(this._inFullScreen&&!this._inFlash){B.call(this,false,true,true);}},exitFullScreen:function A(H){D.call(this);B.call(this,false,H);},cancelFlashFullScreen:function E(){if(this._inFullScreen&&this._inFlash){D.call(this);B.call(this,true,false,true);}}});}());mstrmojo.mstr.EnumNodeType={NodeReserved:0,NodeFormShortcut:1,NodeElementsObject:2,NodeConstant:3,NodeOperator:4,NodeShortcut:5,NodeTime:6,NodeRelationship:7,NodeResidue:8,NodeMe:9,NodeBigDecimal:10,NodeGroup:14,NodeRef:15};(function(){mstrmojo._HasDrillLinks=mstrmojo.provide("mstrmojo._HasDrillLinks",{_mixinName:"mstrmojo._HasDrillLinks",update:function A(E){this._super(E);var B=E.defn.dl,F=E.data.dl,D=this.drillLinkItems=((B&&B.items)||[]).concat((F&&F.items)||[]).sort(function(H,G){return H.index-G.index;}),C;for(C=D.length-1;C>=0;C--){if(C&&D[C].index===D[C-1].index){D.splice(C,1);}}if(B&&B.target){for(C=0;C<D.length;C++){D[C].target=B.target;}}}});}());mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){function G(S,V,U){var W=this._layoutWidgets[V],Z=S.slot,X=W.f,Y=W.p,T=(X&&X[Z]!==undefined),R=(Y&&Y[Z]!==undefined);if(Z&&((!U&&T)||R)){return T?X[Z]:(W.x*parseInt(Y[Z],10)/100)+"px";}return S[(V==="h")?"height":"width"];}function Q(T,S,R){if(T.ignoreLayout){return ;}if(T.setDimensions){T.setDimensions(S,R);}else{if(T.set){T.set("height",S);T.set("width",R);}}}function I(U){var S=this.children,W,Y;for(W=0,Y=(S&&S.length)||0;W<Y;W++){var T=S[W],Z=T.slot;if(Z){var X=G.call(this,T,"h",U),a=G.call(this,T,"w",U);this.setSlotDimensions(Z,X,a);Q(T,X,a);var R=G.call(this,T,"h",U),V=G.call(this,T,"w",U);if(R!==X||V!==a){Q(T,R,V);}this.setSlotDimensions(Z,R,V);}}this.afterLayout();}function F(X,T,V){var W=X.slot,U=T&&T.a;if(!U||U[W]===undefined){return ;}var R=this[W]["offset"+V],S=U[W];if(R===S){return ;}T.x-=(R-S);U[W]=R;}function N(R){this.beforeLayout();var S=this._layoutWidgets,T=R.src;F.call(this,T,S.h,"Height");F.call(this,T,S.w,"Width");I.call(this,true);}function E(T,W){if(!T){return null;}var R=this.children,f=W.toLowerCase(),X=parseInt(this[f],10),a,b,V,S,Y,Z,U,g,d;for(d in T){g=T[d];if(g.match(/px$/)){X-=parseInt(g,10);a=a||{};a[d]=g;}else{if(g.match(/\%$/)){b=b||{};b[d]=g;}else{V=V||{};V[d]=g;}}}if(V&&b){for(Y=0,Z=(R&&R.length)||0;Y<Z;Y++){U=R[Y];d=U.slot;if(U.slot&&V[d]&&!U.ignoreLayout){S=S||{};if(U.hasRendered){S[d]=this[U.slot]["offset"+W];X-=S[d];}else{S[d]=0;U.attachEventListener((U instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,N);}}}}return{f:a,p:b,a:S,x:X};}mstrmojo._HasLayout={_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function O(R){this._super(R);this.layoutConfig=mstrmojo.hash.clone(this.layoutConfig);},preBuildRendering:function M(){var T=this.cssText||"";var R=this.height;if(R&&R!=="auto"){T+="height:"+this.height+";";}var S=this.width;if(S&&S!=="auto"){T+="width:"+this.width+";";}this.cssText=T;return(this._super)?this._super():true;},postBuildRendering:function B(){this.doLayout();return this._super();},doLayout:function A(){var R=this.layoutConfig;if(!R){return ;}this.beforeLayout();this._layoutWidgets={h:E.call(this,R.h,"Height"),w:E.call(this,R.w,"Width")};I.call(this,false);},browserResized:function L(R){this.setDimensions(R.h,R.w);return true;},onwidthChange:function P(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.width=this.width;this.doLayout();},onheightChange:function D(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.height=this.height;this.doLayout();},adjustParentDimensions:function C(){var S=this.parent,R=S&&S._layoutWidgets;if(R){F.call(S,this,R.h,"Height");F.call(S,this,R.w,"Width");}},setDimensions:function K(T,S){if(this.height!==T||this.width!==S){this.height=T;this.width=S;var R=this.domNode;if(R){R.style.height=T;R.style.width=S;this.doLayout();}return true;}return false;},setSlotDimensions:function H(U,T,S){var R=this[U]&&this[U].style;if(!R){return ;}if(T!==undefined&&R.height!==T){R.height=T;}if(S!==undefined&&R.width!==S){R.width=S;}}};mstrmojo._HasLayout.getSlotSize=function J(U,V){var S=U&&U.prototype.layoutConfig;if(S){var T=S.h,R=S.w;return{h:(T&&T[V])||undefined,w:(R&&R[V])||undefined};}return null;};}());(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function B(){return this.items==null?0:this.items.length;},totalSize:function A(){return this.totalSize;},next:function(C){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,C);}},previous:function(C){if(this.hasPrevious()){var D=this.blockBegin-this.blockCount;D=D<0?0:D;this.getItems(D,C);}},getItems:function(H,F){F=F||{};var E=this,D=mstrmojo.emptyFn,C=F.success||D,G=F.failure||D;this._retrieveItems(H,{success:function(I){E.blockBegin=H;E.set("items",(E.concat?(E.items||[]).concat(I.items):I.items));if(I.totalSize){E.totalSize=I.totalSize;}C(E,I.items);},failure:function(I){G(I);}});},_retrieveItems:function(){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+(this.items&&this.items.length||0))<(this.totalSize+1));},hasPrevious:function(){return this.blockBegin>1;}});})();(function(){function E(N,M){var O=N.st;if(!O||O===2048||O==="Project"){this.openFolder(N);}else{if(M||!mstrApp.isTablet()||this.orientation){this.openItem(N);}else{this.rootCtrl.updateItemProperties("",N,this.id,this.isItemAvail(N));}}}mstrmojo.android.controllers._HasFolderView=mstrmojo.provide("mstrmojo.android.controllers._HasFolderView",{_mixinName:"mstrmojo.android.controllers._HasFolderView",start:function B(N){this._super(N);var M=mstrmojo.publisher,O=this.id;mstrmojo.array.forEach([M.CONNECTIVITY_CHANGED_EVENT,M.RECONCILE_END_EVENT],function(P){M.subscribe(M.NO_SRC,P,function(){var Q=this.view;if(Q.hasRendered){Q.refresh();}},O);});},initFolderView:function I(){var M=this.view=this.newView("Folder",{cssClass:"folder-browser",multiSelect:false,hasEvenRows:!mstrApp.isTablet()||!this.orientation,postselectionChange:function(N){var O=N.added;if(O){E.call(this.controller,this.items[O[0]]);}}});return M;},executeItem:function D(M){var N=this.nextController;if(N){N.destroy();this.rootCtrl.updateFolder(this.view);}if(mstrApp.isTablet()&&!this.orientation){E.call(this,M,true);}else{this.view.singleSelect(M._renderIdx);}},onorientationChange:function L(){this._super();var N=this.view;if(N&&mstrApp.isTablet()){N.set("hasEvenRows",!this.orientation);if(N.hasRendered&&N.domNode&&N.domNode.parentNode){var M=N.scrollerConfig;if(M&&M.origin){M.offsetIdx=N.getOffsetIndex();M.origin.y=0;N.updateScroller();}this.syncItemProperties();}}},syncItemProperties:function K(){if(mstrApp.isTablet()&&!this.orientation){var M=this.view,N=M&&M.getSelectedItems&&M.getSelectedItems()[0];if(N){this.rootCtrl.updateItemProperties("",N,this.id,this.isItemAvail(N));}else{this.updatePropertiesMsg();}}},getDefaultMessage:function A(){return"";},updatePropertiesMsg:function H(){var M=this.view;this.rootCtrl.updateItemProperties(this.getDefaultMessage(M&&M.items));},canItemLinger:function J(M){if(!mstrApp.isTablet()){return true;}var N=M.st;if(N===2048||N==="Project"||this.orientation){return true;}return false;},itemLongPressed:function G(M){var N=this.id;if(!mstrApp.isTablet()||this.orientation){this.rootCtrl.updateItemProperties("",M,N,this.isItemAvail(M));return true;}return false;},isItemAvail:function C(N,M){if(mstrMobileApp.isOnline()||N.act===5||N.act===3){return true;}if(N.t===8&&(N.st==="Project"||N.systemFolder)){var O=mstrApp.getConfiguration().getProject(N.did);return !!(O&&O.realPid);}return M?false:this.isItemCached(N);},isItemCached:function F(N){var Q=N.t,M=N.st;if(!(Q===3||Q===55||M===2048||M==="Project")){return false;}if(M===2048&&mstrMobileApp.isOnline()){return true;}var O=N.pid||N.projectID;if(!O){var P=mstrApp.getConfiguration().getProject(mstrApp.getCurrentProjectId());O=P&&P.realPid;}return !!(O&&mstrMobileApp.isCached(O,N.sub_id||N.did,(N.sub_id)?-1:M));}});}());(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};})();(function(){var R=Math;function AF(G,b){return b||(G||window).event;}var Ag=!!document.all,x=navigator.userAgent,h=!Ag&&!!x.match(/Firefox/),p=0,z=!!x.match(/Android/),Aa=!!x.match(/iPad/),AU=!!document.createTouch||z,t=!!x.match(/PlayBook/),S=!!x.match(/Windows Phone/),V=Ag&&!!x.match(/MSIE 10/),Ah=!Ag&&!!x.match(/Trident.*rv/),AA=Ag&&!V,g=h?"-moz-":Ag?"":"-webkit-",AL=h?"Moz":V?"":Ag?"ms":"webkit",AS=(V?"t":"T"),AO=AL+AS+"ransition",Ae=Ab(),AX=AI(),AE=W(),A=Q(),q=j();function Ab(){return AL+AS+"ransform";}function AI(){return AO+"Property";}function W(){return AO+"Duration";}function Q(){return(V||h)?"transitionend":"webkitTransitionEnd";}function j(){return AL+"BoxShadow";}function AR(){if(!p&&h){var G=x.match(/.*Firefox\/([\d|\.]*).*/);if(G){p=parseFloat(G[1],10);}}return p;}function Af(){var Aj=0,An=0,Ak=window,Al=document,G=Al.body,Am=Al.documentElement;if(typeof Ak.pageYOffset=="number"){An=Ak.pageYOffset;Aj=Ak.pageXOffset;}else{if(G&&(G.scrollLeft||G.scrollTop)){An=G.scrollTop;Aj=G.scrollLeft;}else{if(Am&&(Am.scrollLeft||Am.scrollTop)){An=Am.scrollTop;Aj=Am.scrollLeft;}}}return{x:Aj,y:An};}function AJ(G){G=G||0;G=String(G);return((G.indexOf("%",0))!=-1)?G:(G+"px");}function AP(d,Al,Ak,Aj,w){if(!mstrmojo.dom.isWinPhone){Aj=(Aj||false||this.isHWAccelerated);}else{Aj=false;}var b=w+(Aj?"3d":"")+"(",G=Aj?(","+Ak+")"):")";return b+d+","+Al+G;}var L=1,AY=2,Y=3,D=4,K=5;function AC(Al,Ak,Ao){var An=Al.style,b=An.display,Aj=this.windowDim(),w=Af();An.display="block";var Am=Aj.w-Al.clientWidth,Ap=Aj.h-Al.clientHeight,G={4:0,5:Am,3:Am/2},d={1:0,3:Ap/2,2:Ap};An.left=G[Ak]+w.x+"px";An.top=d[Ao]+w.y+"px";An.display=b;}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:x,isIE:Ag,isIE6:Ag&&!!x.match(/MSIE 6/),isIE7:Ag&&!!x.match(/MSIE 7/),isIE8:Ag&&!!x.match(/MSIE 8/),isIE9:Ag&&!!x.match(/MSIE 9/),isIE10:V,isIEW3C:Ah,isNSIE:Ag&&!V,isDXIE:AA,isFF:h,isWK:!!x.match(/AppleWebKit/),isSafari:!!x.match(/Safari/)&&!x.match(/Chrome/),isHWAccelerated:!z,isAndroid:z,isIPad:Aa,isPlayBook:t,isWinPhone:S,supportsTouches:AU,TOUCHSTART:AU?"touchstart":"mousedown",TOUCHMOVE:AU?"touchmove":"mousemove",TOUCHEND:AU?"touchend":"mouseup",TOUCHCANCEL:AU?"touchcancel":"",RESIZE:AU?"orientationchange":"resize",CSS3_PREFIX:g,CSS3_BOXSHADOW:q,CSS3_TRANSFORM:Ae,CSS3_TRANSITION:AO,CSS3_TRANSITION_PROPERTY:AX,CSS3_TRANSITION_DURATION:AE,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},supports:function B(b){var G=this.isFF&&AR();switch(b){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||G>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||G>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);}return false;},replace:function F(d,G){if(!d||!G){return ;}var b=d.parentNode;if(b){b.replaceChild(G,d);}},attachEvent:function AB(d,b,w,G){if(d.addEventListener){return d.addEventListener(b,w,!!G);}else{return d.attachEvent("on"+b,w);}},detachEvent:function AV(d,b,w,G){if(!d){return ;}if(d.removeEventListener){d.removeEventListener(b,w,!!G);}else{d.detachEvent("on"+b,w);}},attachOneTimeEvent:function Z(w,b,Aj,G){var d=function(Ak){Aj(Ak);mstrmojo.dom.detachEvent(this,b,d,G);};this.attachEvent(w,b,d,G);w=null;return d;},captureDomEvent:function AN(Ak,w,b,Aj,d){var G=mstrmojo.all[Ak];if(G){G.captureDomEvent(w,b,Aj,d);}},translate:function O(d,b,Ak,Aj,G,w){G=(G&&" "+G)||"";d.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(b,Ak,Aj,w)+G;},createTranslateString:function T(G,w,d,b){G=AJ(G);w=AJ(w);d=AJ(d);return AP(G,w,d,b,"translate");},createScaleString:function AD(G,w,d,b){G=G||0;w=w||0;d=d||0;return AP(G,w,d,b,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function E(d,G,w,Ak){var b=d.id+"-"+G,Aj=this._bufferConnects[b];if(!Aj){Aj=this._bufferConnects[b]={elId:d.id,eventName:G,timer:null,bufferSize:Ak,listeners:[],callback:function(Al){mstrmojo.dom._callback(Al,mstrmojo.global,b);return true;}};this.attachEvent(d,G,Aj.callback);}Aj.listeners.push(w);},_callback:function N(Aj,G,d){if(!Aj){Aj=G.event;}var w=this._bufferConnects[d],Ak=w&&w.timer;if(w&&!Ak){var b=(w.bufferSize===null)?this._bufferSize:w.bufferSize;if(w.bufferSize){w.timer=G.setTimeout(function(){mstrmojo.dom.updateBuffers(d);},b);}else{mstrmojo.dom.updateBuffers(d);}}},updateBuffers:function AZ(w){var Aj=this._bufferConnects[w],b=Aj&&Aj.listeners;for(var d=0,G=b&&b.length||0;d<G;d++){b[d]();}if(Aj&&Aj.timer){delete Aj.timer;}},detachBufferedEvent:function a(Ak,d,Al){if(!Ak){return ;}var Aj=Ak.id+"-"+d,Am=this._bufferConnects[Aj],b=Am&&Am.listeners,G=(b&&b.length)||0;if(G){for(var w=G-1;w>-1;w--){if(b[w]==Al){b.splice(w,1);}}if(!b.length){this.detachEvent(Ak,d,Am.callback);delete this._bufferConnects[Aj];if(Am.timer){mstrmojo.global.clearTimeout(Am.timer);}}}},eventTarget:function AG(G,b){b=AF(G,b);return b.target||b.srcElement;},ctrlKey:function Ac(G,b){return AF(G,b).ctrlKey;},shiftKey:function AH(G,b){return AF(G,b).shiftKey;},getButton:function AT(G,b){return((AF(G,b)).button==2)?2:1;},getMousePosition:function k(Ak,Aj){Aj=Aj||window;var w,An;if(mstrmojo.dom.isIE){Ak=Ak||Aj.event;var Al=document,G=Al.body,Am=Al.documentElement;w=Ak.clientX+G.scrollLeft+(Am.scrollLeft||0);An=Ak.clientY+G.scrollTop+(Am.scrollTop||0);}else{w=Ak.pageX;An=Ak.pageY;}return{x:w,y:An};},position:function(b,d){var Ak={x:0,y:0};if(b&&b.getBoundingClientRect){try{Ak=b.getBoundingClientRect();}catch(Aj){Ak={left:0,top:0,right:0,bottom:0,height:0,width:0};}Ak={x:Ak.left,y:Ak.top,w:Ak.right-Ak.left,h:Ak.bottom-Ak.top};if(this.isIE6||this.isIE7){var G=b.ownerDocument;if(G){var Am=G.documentElement,Al=Am.getBoundingClientRect();Ak.x-=Al.left;Ak.y-=Al.top;}}}if(d){var w=Af();Ak.x+=w.x;Ak.y+=w.y;}return Ak;},delta:function J(d,G){G=G||document.body;var b=this.position(d),w=this.position(G);return{x:Math.round(b.x-w.x),y:Math.round(b.y-w.y)};},windowDim:function Ai(){var G=0,Aj=0,Ak=window,Al=document,Am=Al.documentElement,b=Al.body;if(typeof (Ak.innerWidth)=="number"){G=Ak.innerWidth;Aj=Ak.innerHeight;}else{if(Am&&(Am.clientWidth||Am.clientHeight)){G=Am.clientWidth;Aj=Am.clientHeight;}else{if(b&&(b.clientWidth||b.clientHeight)){G=b.clientWidth;Aj=b.clientHeight;}}}return{w:G,h:Aj};},center:function AM(G){AC.call(this,G,Y,Y);},bottomCenter:function H(G){AC.call(this,G,Y,AY);},clearBrowserHighlights:function P(G){G=G||self;if(Ag){var Al=G.document,Ak=Al&&Al.selection,w=Ak&&Ak.empty;if(w){try{Ak.empty();}catch(d){}}}else{var b=G.getSelection,Aj=b&&G.getSelection();if(Aj&&!Aj.isCollapsed){if(Aj.empty){Aj.empty();}else{if(Aj.removeAllRanges){Aj.removeAllRanges();}}}}},findAncestorByAttr:function AQ(Aj,d,b,G){var Ak=b?Aj:Aj&&Aj.parentNode;while(Ak&&(Ak!=G)){var w=Ak.getAttribute&&Ak.getAttribute(d);if(w!=null){return{node:Ak,value:w};}Ak=Ak.parentNode;}return null;},findAncestorByName:function Ad(d,Ak,b,G){Ak=Ak&&Ak.toLowerCase();var w=b?d:d&&d.parentNode;while(w&&(w!=G)){var Aj=w.nodeName;if(Aj&&(Aj.toLowerCase()==Ak)){return w;}w=w.parentNode;}return null;},contains:function M(w,Aj,b,G){var d=Aj;if(!b){d=d.parentNode;}while(d){if(d==w){return true;}if(d===G){break;}d=d.parentNode;}return false;},preventDefault:function AW(G,b){if(!b){b=G.event;}if(b.preventDefault){b.preventDefault();}else{b.returnValue=false;}},stopPropogation:function l(G,b){if(!b){b=G.event;}if(b.stopPropogation){b.stopPropogation();}else{b.cancelBubble=true;}},firstTouch:function C(G,b){return b&&b.touches&&b.touches.length?b.touches[0]:(b||G.event);},firstChangedTouch:function I(G,b){return b&&b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:(b||G.event);},isLandscape:function X(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function(G){while(G){var b=G.mstrmojoId;if(b!=null){return mstrmojo.all[b];}G=G.parentNode;}return null;},setCaret:function(G,d){if(G.setSelectionRange){G.focus();G.setSelectionRange(d,d);}else{if(G.createTextRange){var b=G.createTextRange();b.move("character",d);b.select();}}}});var AK=mstrmojo.dom,f=window,o=document,U=o&&o.documentElement,s=o&&o.body;if(f.innerWidth){AK.getHorizontalScroll=function(){return f.pageXOffset;};AK.getVerticalScroll=function(){return f.pageYOffset;};}else{if(U&&U.clientWidth){AK.getHorizontalScroll=function(){return U.scrollLeft;};AK.getVerticalScroll=function(){return U.scrollTop;};}else{if(s.clientWidth){AK.getHorizontalScroll=function(){return s.scrollLeft;};AK.getVerticalScroll=function(){return s.scrollTop;};}}}})();mstrmojo.mstr.EnumWebAPIErrorCodes={MSI_INBOX_MSG_NOT_FOUND:-2147468986,E_MSI_USERMGR_USER_NOTFOUND:-2147209051,AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:-2147216963,AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:-2147216960,AUTHEN_E_LOGIN_FAIL:-2147216959,E_UNUSED:4294967295};mstrmojo.DynamicClassFactory={newComponent:function(B,A,F){var C=B.prototype.scriptClass.replace(/^mstrmojo./,"");for(var E=0,D=A&&A.length||0;E<D;E++){if(!A[E]._mixinName){alert("Need mixin have '_mixinName' to be used in DynamicClassFactory");return null;}C+="_"+A[E]._mixinName.replace(/^mstrmojo./,"");}var G=mstrmojo[C];if(!G){G=mstrmojo.declare(B,A,F);mstrmojo[C]=G;}return G;}};mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function rqMth(B){if(!B){return ;}if(typeof (this[B])==="function"){return true;}else{var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof (A)==="string"){this.requiresCls(A);return typeof (this[B])==="function";}return false;}},requiresCls:function req(mixins,callback){if(mixins){if(typeof (mixins)=="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin;for(var i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof (A)=="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresES(E,F,B){if(E&&E instanceof Array){if(E.length==0){F&&F.call(B);return ;}if(E[0].forceReload&&E[0].forceReload==false&&mstrmojo.LoadedExternalJSURLs[E[0].url]){E.splice(0,1);return this.requiresExternalScripts(E,F,B);}var A=document.createElement("script"),C=!!document.all;A.type="text/javascript";A.src=E[0].url;if(!E[0].callbackParamName){if(C){A.onreadystatechange=function(){if(A.readyState=="loaded"||A.readyState=="complete"){A.onreadystatechange=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}}};}else{A.onload=function(){A.onload=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}};}}else{if(E[0].callbackParamName.length!=0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy==true){var D=this;window.setTimeout(function(){D.requiresExternalScripts(E,F,B);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+E[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=E;mstrmojo._LoadsScript.callback=F;mstrmojo._LoadsScript.esScritsContext=B;}}document.getElementsByTagName("head")[0].appendChild(A);}}});mstrmojo.mstr.EnumExpressionType={ExpressionReserved:0,ExpressionGeneric:1,FilterSingleBaseFormQual:2,FilterMultiBaseFormQual:3,FilterJointFormQual:4,FilterListQual:5,FilterListFormQual:6,FilterJointListQual:7,FilterJointListFormQual:8,FilterSingleBaseFormExpression:9,FilterSingleMetricQual:10,FilterMultiMetricQual:11,FilterMetricExpression:12,FilterEmbedQual:13,FilterBranchQual:14,FilterRelationshipQual:15,FilterAllAttributeQual:16,FilterAttributeIDQual:17,FilterAttributeDESCQual:18,ExpressionAggMetric:19,ExpressionBanding:20,FilterReportQual:21,ExpressionMDXSAPVariable:22,ExpressionSQLQueryQual:23,ExpressionCanceledPrompt:24,ExpressionElementList:25,ExpressionElementSingle:26};(function(){var F="#000000";mstrmojo.color=mstrmojo.provide("mstrmojo.color",{hexChars:"0123456789ABCDEF",toHex:function J(L){L=L||0;L=Math.max(Math.min(isNaN(L)?0:parseInt(L,10),255),0);return this.hexChars.charAt((L-L%16)/16)+this.hexChars.charAt(L%16);},toDec:function K(L){return this.hexChars.indexOf(L.toUpperCase());},rgbStr2rgb:function G(L){var M=[0,0,0];L=L.replace(/ /g,"");var N=L.indexOf("rgb");if(N>=0){L=L.substring(N+4,L.length-1);M=L.split(",");}return M;},rgbStr2hex:function B(L){if(L.indexOf("rgb")>=0){var M=this.rgbStr2rgb(L);return"#"+this.rgb2hex(M[0],M[1],M[2]);}return L;},rgb2hex:function C(N,M,L){return this.toHex(N)+this.toHex(M)+this.toHex(L);},rgb2hsv:function E(L,Q,U){var S=[L,Q,U];S.sort(function(Z,Y){return Z-Y;});var P,X,W=0;var O=S[0];var T=S[2];W=T/255;X=(T!=0)?(parseFloat(T)-parseFloat(O))/parseFloat(T):0;if(X==0){P=0;}else{var R=T-O;var M=(T-L)/R;var N=(T-Q)/R;var V=(T-U)/R;if(L==T){P=V-N;}else{if(Q==T){P=2+M-V;}else{P=4+N-M;}}P=P/6;if(P<0){P=P+1;}}return[Math.round(P*360),Math.round(X*100),Math.round(W*100)];},hex2rgb:function H(O){var M=(O.charAt(0)=="#")?O.substr(1):O;var L=M.length!==3;var N=[0,0,0];if(L){N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(1,1)));N[1]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(3,1)));N[2]=(this.toDec(M.substr(4,1))*16)+(this.toDec(M.substr(5,1)));}else{N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(0,1)));N[1]=(this.toDec(M.substr(1,1))*16)+(this.toDec(M.substr(1,1)));N[2]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(2,1)));}return N;},hex2hsv:function(M){var L=this.hex2rgb(M);return this.rgb2hsv(L[0],L[1],L[2]);},hsv2rgb:function(S,Y,W){S=S/360;Y=Y/100;W=W/100;var L,T,V;if(Y==0){L=W*255;T=W*255;V=W*255;}else{var O=S*6;if(O==6){O=0;}var R=Math.floor(O);var N=W*(1-Y);var M=W*(1-Y*(O-R));var X=W*(1-Y*(1-(O-R)));var U,P,Q;switch(R){case 0:U=W;P=X;Q=N;break;case 1:U=M;P=W;Q=N;break;case 2:U=N;P=W;Q=X;break;case 3:U=N;P=M;Q=W;break;case 4:U=X;P=N;Q=W;break;default:U=W;P=N;Q=M;break;}L=U*255;T=P*255;V=Q*255;}return[Math.round(L),Math.round(T),Math.round(V)];},hsv2hex:function(O,N,L){var M=this.hsv2rgb(O,N,L);return this.rgb2hex(M[0],M[1],M[2]);},getContrastingColor:function A(N,L){var M=this.hex2rgb(N);return(((M[0]*299)+(M[1]*587)+(M[2]*114))/1000<125)?L[0]:L[1];},getHighlightColor:function D(S,Q){var L,R,T,U,V=this.hex2rgb(!Q?"#FFCE7F":"#EFE6D8"),P=parseInt(S[0],10),N=parseInt(S[1],10),X=parseInt(S[2],10),O=parseInt(V[0],10),M=parseInt(V[1],10),W=parseInt(V[2],10);L=(P*O)/255;R=(N*M)/255;T=(X*W)/255;U=P*0.3+N*0.59+X*0.11;if(U<85){L=L+(63*(85-U)/85);L=L>255?255:L;R=R+(63*(85-U)/85);R=R>255?255:R;T=T+(63*(85-U)/85);T=T>255?255:T;}return"#"+this.rgb2hex(Math.round(L),Math.round(R),Math.round(T));},get3DBorderColor:function I(N,Q){var M=parseInt(N[0],10)*0.3+parseInt(N[1],10)*0.59+parseInt(N[2],10)*0.11;var P=parseInt(N[0],10);var O=parseInt(N[1],10);var L=parseInt(N[2],10);switch(Q){case"light":if(M>150){P=P*0.9;O=O*0.9;L=L*0.9;}else{P=P*0.6+102;O=O*0.6+102;L=L*0.6+102;}break;case"dark":if(M>10){P=P*0.4;O=O*0.4;L=L*0.4;}else{P=P*0.8+30;O=O*0.8+30;L=L*0.8+30;}}return"#"+this.rgb2hex(Math.round(P),Math.round(O),Math.round(L));},encodeColor:function(L,M){if(M!=undefined&&(L==null||L.length==0||L=="undefined")){L=M;}if(L=="transparent"){return -1;}else{if(L==-2){return -2;}else{if(L.substring(0,1)=="#"){L=L.substring(1);}return parseInt(L.substring(4)+L.substring(2,4)+L.substring(0,2),16);}}},decodeColor:function(N){var L=parseInt(N,10);if(L==0){return F;}var M=16777216+(L&255)*65536+(L&65280)+(L&16711680)/65536;return"#"+M.toString(16).substring(1).toUpperCase();}});})();mstrmojo.android.EnumMenuOptions=mstrmojo.provide("mstrmojo.android.EnumMenuOptions",{HOME:1,SETTINGS:2,HELP:4,LEARN:8,ALL:255,REFRESH:256,FULL_SCREEN:512,GROUP_BY:768,PAGE_BY:1024,REPROMPT:1280,DELETE:1536,SEARCH:1792,SCAN:2048,MAP_ROADMAP:2304,MAP_SAT:2560,MAP_HYBRID:2816,MAP_TERRAIN:3072,DOC_LAYOUTS:3328,TRANSACTIONS_QUEUE:3584,ADD_SERVER:3840,ADD_PROJECT:4096,ABOUT:4352,SHARE:4608,ABOUT_RESULTSET:4864,ANNOTATION:5120});mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionReservedLastOne:138,FunctionTuple:1000};(function(){mstrmojo.boxmodel={rangeIntersect:function C(H,F,G,E){if(H<G){return G<=F;}else{if(H>G){return H<=E;}else{return true;}}},px2Inches:function A(F,E){E=parseInt(E,10);return parseFloat((E/F.zf/F.dpi).toFixed(4),10);},offset:function D(G,F){var I=G,E=0,H=0;while(G){E+=G.offsetLeft;H+=G.offsetTop;G=G.offsetParent;if(G===F){break;}}for(e=I&&I.parentNode;e&&e!=F;e=e.parentNode){if(e.scrollTop){H-=e.scrollTop;}if(e.scrollLeft){E-=e.scrollLeft;}}return{left:E,top:H};},convert2px:function B(H,F){if(!/px$/.test(F)){var E=document.createElement("img"),G;E.style.zIndex=-1;E.style.left=F;H.appendChild(E);G=E.style.pixelLeft;H.removeChild(E);return G+"px";}else{return F;}}};})();mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,tooltipNode:null,postBuildRendering:function(){var B;if(this._super){B=this._super();}if(this.useRichTooltip){var D=this.tooltipNode||this.domNode,C=mstrmojo.dom,A=D&&D.getAttribute("title");if(A){D.setAttribute("title","");}if(!this._ontooltipover){var E=this.id;this._ontooltipover=function(G){var F=mstrmojo.all[E];F.showTooltip(G,self);};this._ontooltipout=function(G){var F=mstrmojo.all[E];F.hideTooltip(G,self);};}C.attachEvent(D,"mouseover",this._ontooltipover);C.attachEvent(D,"mouseout",this._ontooltipout);}return B;},showTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.open(this,B,A);},hideTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.close();},unrender:function(A){var C=this.tooltipNode||this.domNode,B=mstrmojo.dom;if(C&&this._ontooltipover){B.detachEvent(C,"mouseover",this._ontooltipover);}if(C&&this._ontooltipout){B.detachEvent(C,"mouseout",this._ontooltipout);}if(this._super){this._super(A);}}});})();(function(){mstrmojo.android._HasLingeringListSelections=mstrmojo.provide("mstrmojo.android._HasLingeringListSelections",{_mixinName:"mstrmojo.android._HasLingeringListSelections",selectionPolicy:"reselect",noLinger:false,canItemLinger:function D(E){return true;},setClearHandler:function C(F){if(this.noLinger){return ;}var E=this.selectedIndex,G=this.id;if(E>-1&&this.canItemLinger(this.items[E])){this._clearHandler=window.setTimeout(function(){var H=mstrmojo.all[G];if(H){if(H.selectedIndex===E){H.clearSelect();}delete H._clearHandler;}},F);}},postBuildRendering:function A(){this._super();this.setClearHandler(800);},preselectionChange:function B(E){var F=this._clearHandler;if(F){window.clearTimeout(F);delete this._clearHandler;}}});}());(function(){mstrmojo._IsSelectorTarget={_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(B){var C=((B)?"add":"remove")+"DirtyKey";if(this.parent&&this.parent[C]){this.parent[C](this.k);}}};})();(function(){mstrmojo._HasRelativeUrls={_mixinName:"mstrmojo._HasRelativeUrls",relativeUrls:[],update:function A(C){this._super(C);var B=this,D=B.builder.parent,E=mstrApp.getConfiguration().getHostUrlByProject(mstrApp.getCurrentProjectId());mstrmojo.array.forEach(this.relativeUrls,function(G){var F=B[G];if(F&&(F.indexOf("://")===-1&&F.indexOf("data:")!==0)){B[G]=E+F;}});}};})();(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function A(N,M){if(N){M=M||{};for(var O in N){M[O]=N[O];}}return M;},copyProps:function C(P,Q,N){N=N||{};if(Q){for(var O=0,M=(P&&P.length)||0;O<M;O++){var R=P[O];if(R in Q){N[R]=Q[R];}}}return N;},forEach:function F(P,O,N){if(P){for(var M in P){if(N){if(O.call(N,P[M],M,P)===false){break;}}else{if(O(P[M],M,P)===false){break;}}}}},walk:function J(Q,O){if(!O){O=mstrmojo.global;}var P=Q.split(".");if(P.length==1){return O[Q];}for(var N=0,M=P&&P.length||0;N<M;N++){O=O[P[N]];if(!O){break;}}return O;},isEmpty:function(N){if(!N){return true;}for(var M in N){if(N[M]!=null){return false;}}return true;},clear:function L(N){if(N){for(var M in N){delete N[M];}}return N;},any:function(N,O){if(N){for(var M in N){return O?M:N[M];}}return undefined;},clone:function B(Q){if(!Q){return null;}var S;if(Q.constructor===Array){S=Q.concat();var R=S[0];if(R&&typeof (R)==="object"){for(var P=0,M=S.length;P<M;P++){S[P]=this.clone(Q[P]);}}}else{S={};for(var O in Q){var N=Q[O];if(N&&typeof (N)=="object"){S[O]=this.clone(N);}else{S[O]=N;}}}return S;},cloneArray:function I(N){var O=[];for(var P=0,M=(N&&N.length)||0;P<M;P++){O[P]=this.clone(N[P]);}return O;},keyarray:function G(O,P){var M=[];if(O){for(var N in O){M.push(P?Number(N):N);}}return M;},valarray:function H(O){var M=[];if(O){for(var N in O){M.push(O[N]);}}return M;},equals:function K(S,R){var T=mstrmojo.hash,N=S&&R||(!S&&!R&&(S===R));if(N&&S){N=(S.constructor===R.constructor);if(N){if(S.constructor===Array){var Q=S.length;N=(Q===R.length);if(N&&Q){for(var O=0;O<Q;O++){N=N&&T.equals(S[O],R[O]);}}}else{if(typeof (S)==="object"){var U=T.keyarray(S),P=T.keyarray(R);N=U.length===P.length;if(N){for(var M in S){N=N&&(T.equals(S[M],R[M]));}}}else{N=(S===R);}}}}return N;},obj2array:function(Q){for(var R in Q){var P=Q[R];if(P&&typeof (P)=="object"){Q[R]=this.obj2array(P);}}if("isArray" in Q&&(Q.isArray===true)){var O=[];for(var N=0,M=Q.length;N<M;N++){O.push(Q[N]);}return O;}else{return Q;}},min:function D(P,Q,R){var M;if(P){for(var O in P){var N=Q?P[O]:O;if(R){N=Number(N);}if((M==null)||(N<M)){M=N;}}}return M;},make:function E(N,O,M){if(!N||!O){return null;}if(N.attachEventListener){return N;}if(O.makeObservable){N=O.makeObservable(N,M)||N;}else{this.copy(O.prototype,N);if(N.init){N=N.init(M)||N;}}return N;}});})();(function(){mstrmojo._ReportDataService=mstrmojo.provide("mstrmojo._ReportDataService",{_mixinName:"mstrmojo._ReportDataService",getPageByTree:function A(C){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},C);},pageByUnitsToKeys:function B(F){var C=[],D;for(D=0;D<F.length;D++){var E=F[D];if(mstrApp.useBinaryFormat){C.push(E.v);}else{C=C.concat([E.id,E.tp,E.v]);}}return C.join("\u001F");}});}());(function(){mstrmojo.all={};var _A=mstrmojo.all;var _freeIdCounter=0;function _freeId(){for(;_freeIdCounter++;){if(!_A["mstr"+_freeIdCounter]){break;}}return"mstr"+_freeIdCounter;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function add(obj){if(!obj){return ;}var id=obj.id;if(id==null){id=_freeId();obj.id=id;}else{if(_A[id]){throw new Error("Tried to register 2 objects with same id: "+id);}}_A[id]=obj;},remove:function rmv(obj){if(obj&&obj.id!=null){delete _A[obj.id];}},dumpAll:function(){for(var o in _A){if(_A[o].id!=null){mstrmojo.dbg(_A[o].id+"("+(_A[o].scriptClass||"[unknown class]")+")");}}},ref:function ref(config,flags){if(!config){return null;}if(!flags){flags={};}var C=config;while(C){switch(typeof (C)){case"string":if(flags.skipLoadChecks!==true){mstrmojo.requiresCls(config);}C=eval(C);break;case"function":return(flags.dontInst!==true)?new C():C;case"object":if(C.constructor===Object){var sc=C.scriptClass;if(sc){if(flags.skipLoadChecks!==true){mstrmojo.requiresCls(sc);}var cls=eval(sc);if(cls){return new cls((flags.clone===true)?mstrmojo.hash.clone(C):C);}return null;}else{return C;}}else{return C;}break;default:return null;}}}});mstrmojo.insert=mstrmojo.registry.ref;})();mstrmojo.android.EnumOrientationTypes={PORTRAIT:1,LANDSCAPE:2};(function(){function B(I,J,H){var F=0,G=0,E=(H&&H.length)||0;if(!I||!H){return F;}for(;G<E;G++){F+=H[G][J]();}return F;}function D(E,F){if(F===undefined||isNaN(F)){return E;}return(E&&[E[F-1]]);}mstrmojo._CanMeasureChildren={height:function A(E){return B(this.domNode,"height",D(this.children,E));},width:function C(E){return B(this.domNode,"width",D(this.children,E));}};}());(function(){mstrmojo._IsPopup={visible:false,opener:null,onOpen:null,onClose:null,open:function B(E,D){if(this.updatePopupConfig){this.updatePopupConfig(D,E);}else{if(D){for(var C in D){this.set(C,D[C]);}}}this.set("opener",E);if(!this.hasRendered){this.render();}if(this.nudge){this.domNode.style.top="-10000px";}this.set("visible",true);if(this.nudge){this.nudge();}if(this.onOpen){this.onOpen();}},close:function A(C){if(this.onClose){this.onClose(C);}this.set("visible",false);this.set("opener",null);}};})();(function(){function L(N,T,S,P,R,O,Q){if(T>O){return false;}return(!Q)||(N===0)||((N<P)&&(T>=R-(O-R)));}function H(Q,N,U,T,P,S,O,R){if(U>O){return false;}return(!R)||((N<P)&&(U>=S-Q.height()));}function F(N,P,O){N.renderMode="scroll";N.render();N.numChildrenRendered=0;P.numChildrenRendered++;if(O&&!N.builtChildren){N.buildChildren();}}function E(){return this.useScrollBuffer?this.scrollBuffer:0;}mstrmojo._CanRenderDocOnScroll=mstrmojo.provide("mstrmojo._CanRenderDocOnScroll",{_mixinName:"mstrmojo._CanRenderDocOnScroll",renderMode:"scroll",scrollBuffer:0,postBuildRendering:function B(){if(this.renderMode===null){return this._super();}else{this.renderChildren();return true;}},childRenderOnAddCheck:function(N){if(this.renderMode===null){return this._super(N);}else{return false;}},renderChildren:function M(){var O;if(this.renderMode==="scroll"){var P=this;while(P){if(P.scrollboxNode&&(P.scrollboxWidthFixed||P.scrollboxHeightFixed)&&P.connectScrollbox){O=P;break;}P=P.parent;}}if((this.renderMode!=="scroll")||!O){this._super();return ;}if(this.containerNode){this.scrollboxOwner=O;O.connectScrollbox(this);this.numChildrenRendered=0;var N=this.numChildren;if(N===undefined){this.numChildren=N=this._getModelChildNodes(this.node,false,0,0,true).total;}this.sectionsToRender=N;this.subsectionsToRender=0;if(N){this._startSubsectionThread(false);}}if(this.resizeOrReposition){this.resizeOrReposition();}},onscroll:function J(){if(!this.renderingSubsections){this.useScrollBuffer=true;this._startSubsectionThread(true);}},_startSubsectionThread:function A(Q){var O=this;var P=function(S,R){if(O[S]){if(R){self.clearTimeout(O[S]);}else{self.clearInterval(O[S]);}delete O[S];}};var N=function(S){O.renderingSubsections=false;var R=function(){P("renderCtlsTimer");O.showRenderStatus(false);O.renderCtrlsInViewport();O.raiseEvent({name:"afterScroll"});O=null;};if(S){O.renderCtlsTimer=self.setTimeout(R,O.scrollboxOwner.scrollInterval+1);}else{R();}};P("renderSubsTimer");P("renderCtlsTimer",true);this.renderingSubsections=true;if((this.sectionsToRender||this.subsectionsToRender)&&!this._renderSubsectionsToScroll()){this.showRenderStatus(true);this.renderSubsTimer=self.setInterval(function(){if(O._renderSubsectionsToScroll()){P("renderSubsTimer");N(Q);}else{O.showRenderStatus(true);}},this.scrollboxOwner.scrollInterval);}else{N(Q);}},showRenderStatus:function G(O,T){var S=this.parent;if(!S||!S.showStatus){return ;}var N=T,P;if(O){var Q=this.numChildrenRendered,R=this.numChildren;P=R&&parseInt(100*Q/R,10);N="*Rendering section "+Q+" of "+R+".*";}S.showStatus(O,N,P);},_renderSubsectionsToScroll:function K(){var Y=this.scrollboxOwner,Z=Y.scrollboxTop,Q=Y.scrollboxLeft,T=Y.scrollboxBottom+E.call(this),o=Y.scrollboxRight,a=T-Z,W=0,V=0,U=null,b=null,X,j;function p(){U=V;b=U+a;}var N=this.numChildren,S=this.children||[],P=this.model,g=this.node,f=false;for(j=0;j<N;j++){var l=S[j];if(!l){l=this.addChildren(this.builder.build(this._getModelChildNodes(g,false,j,1,true).nodes,P))[0];S=this.children||[];}var O=f;f=!!l.defn.horiz;X=(j>0&&l.node.data.bh);if((!f&&O)||(X&&O)){W=0;V+=S[j-1].height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}if(!l.hasRendered){if(!L(W,V,Q,o,Z,T,f)){if(f){continue;}else{return true;}}this._renderSection(l,j);this.sectionsToRender--;this.subsectionsToRender+=(l.children&&l.children.length)||0;if(U===null){p();}}var R=l.children||[],h=null,d,k;for(d=0,k=R.length;d<k;d++){h=R[d];if(!h.hasRendered){if(!H(h,W,V,Q,o,Z,T,f)){if(f){break;}else{return true;}}F(h,l);this.subsectionsToRender--;if(U===null){p();}}if(f){W+=h.width();if(W>o){break;}}else{V+=h.height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}}}return true;},_renderSection:function I(N,O){F(N,this,true);},_getModelChildNodes:function(P,O,R,N,Q){return this.model.getChildren(P,O,R,N,Q);},renderCtrlsInViewport:function D(){var W=this.scrollboxOwner,Y=W.scrollboxTop,O=W.scrollboxLeft,R=W.scrollboxBottom+E.call(this),p=W.scrollboxRight,T=0,S=0,d=false,Q=this.children||[],N,U,h,X;var b=function(t){if(d){T+=t.width();}else{S+=t.height();}};var l=function(z,t,x,AA,w){t=parseInt(t,10)||0;x=parseInt(x,10);return(isNaN(x))?(z+t<=w):mstrmojo.boxmodel.rangeIntersect(z+t,z+t+x,AA,w);};for(h=0,X=(Q&&Q.length)||0;h<X;h++){var q=Q[h];N=d;d=!!q.defn.horiz;U=(h>0&&q.node.data.bh);if((!d&&N)||(U&&N)){T=0;S+=Q[h-1].height();if(S>R){return ;}}if(!q.hasRendered){if(!d){return ;}else{continue;}}var k=q.children,P=(k&&k.length)||0,a,g;for(a=0;a<P;a++){g=k[a];if(!g.hasRendered){break;}if(g.builtChildren&&(g.numChildrenRendered===((g.children&&g.children.length)||0))){b(g);}else{if((S+g.height()>=Y)&&(!d||(T+g.width()>=O))){var s=g.children,Z=(s&&s.length)||0;if(!Z&&!g.builtChildren){g.buildChildren();s=g.children;Z=(s&&s.length)||0;}var f=[],j;for(j=0;j<Z;j++){var o=s[j];if(o.hasRendered){continue;}var V=o.getFormats()||{};if(l(S,V.top,V.height,Y,R)&&l(T,V.left,V.width,O,p)){o.render();f.push(o);}}g.performCanGrowCanShrink(f,true);}b(g);}if((d&&T>p)||(!d&&S>R)){break;}}}},unrender:function C(O){var N=this.scrollboxOwner;if(N){N.disconnectScrollbox(this);}this._super(O);}});}());(function(){var E=[];function H(L,K){E.push({n:L,args:K});}function I(N,M,K){var L=false;switch(N._loadingStatus){case 0:if(google&&google.maps&&google.maps.Geocoder){N._loadingStatus=2;L=true;}else{H(M,K);N._loadScript();}break;case 1:H(M,K);break;case 2:L=true;break;}return L;}mstrmojo.GeoLocation=mstrmojo.provide("mstrmojo.GeoLocation",{_altitude:null,_latitude:null,_longitude:null,_callbacks:[],_getPos:function(){if(mstrMobileApp&&mstrMobileApp.getGeoLocation){mstrmojo.GeoLocation._getPos=function(){mstrMobileApp.getGeoLocation("mstrmojo.GeoLocation.updateLocation");};}else{if(navigator&&navigator.geolocation){mstrmojo.GeoLocation._getPos=function(){navigator.geolocation.getCurrentPosition(function(K){mstrmojo.GeoLocation.updateLocation(K);},function(K){switch(K.code){case K.TIMEOUT:alert("Retrieve Geo Position: Timeout, please try it again ");break;case K.PERMISSION_DENIED:alert("Retrieve Geo Position: Permission to use location service has been denied ");break;case K.POSITION_UNAVAILABLE:alert("Retrieve Geo Position: Position unavaiable ");break;}mstrmojo.GeoLocation.updateLocation(K);},{maximumAge:10000,timeout:10000});};}else{mstrmojo.GeoLocation._getPos=function(){alert("no available Geo Location service");};}}mstrmojo.GeoLocation._getPos();},getCurrentLocation:function(K){this._callbacks.push(K);if(!this._pending){this._pending=true;this._getPos();}},updateLocation:function(P){var M=mstrmojo.GeoLocation;var L,K;var O=P&&P.coords;var N=P&&P.err;if(O){M._latitude=O.latitude;M._longitude=O.longitude;K=M._callbacks;for(L=0;L<K.length;L++){K[L].success(O.latitude,O.longitude);}}else{if(N){K=M._callbacks;for(L=0;L<K.length;L++){K[L].failure("Error in updating geo location information."+N);}}else{K=M._callbacks;for(L=0;L<K.length;L++){K[L].failure("Error in updating geo location information.");}}}M._callbacks=[];M._pending=false;},getCurrentAddress:function(K){this.getCurrentLocation({success:function(N,L,M){mstrmojo.GeoLocation.findAddress({lat:N,lng:L},{success:K.success&&K.success||mstrmojo.emptyFn,failure:K.failure&&K.failure||mstrmojo.emptyFn});},failure:K.failure&&K.failure||mstrmojo.emptyFn});},count:null,cbs:null,getUniqId:function D(){var K;if(!this.count){K=this.count=1;}else{K=this.count++;}return"fa"+K;},findAddress:function F(L,K){if(!mstrMobileApp||!mstrMobileApp.useNativeMap||!mstrMobileApp.useNativeMap()){this.findAddressUsingJsAPI(L,K);}else{this.findAddressUsingNativeAPI(L,K);}},findAddressUsingJsAPI:function J(M,K){if(I(this,"findAddress",[M,K])){var L=new google.maps.Geocoder();L.geocode({location:new google.maps.LatLng(M.lat,M.lng)},function(O,N){if(N==google.maps.GeocoderStatus.OK&&O[0]){K.success(O);}else{K.failure(O,N);}});}},findAddressUsingNativeAPI:function G(M,K){var L=this.getUniqId();if(this.cbs==null){this.cbs={};}this.cbs[L]=function(N){if(N.status=="OK"){K.success(N.results);}else{K.failure(N.results,N.status);}};mstrMobileApp.findAddress(M.lat,M.lng,"mstrmojo.GeoLocation.findAddressCallback",L);},findAddressCallback:function B(L,K,M){this.cbs[M].apply(mstrmojo.GeoLocation,[L]);},_loadingStatus:0,_loadScriptCallBack:function A(){this._loadingStatus=2;for(var K=0;K<E.length;K++){var L=E[K];mstrmojo.GeoLocation[L.n].apply(mstrmojo.GeoLocation,L.args);}},_loadScript:function C(){this._loadingStatus=1;var K=document.createElement("script");K.type="text/javascript";K.src="http://maps.google.com/maps/api/js?sensor=false&callback=mstrmojo.GeoLocation._loadScriptCallBack";document.body.appendChild(K);}});})();(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats();var I=J.toLowerCase();if(H&&I in H){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects={height:function A(){return B("Height",this);},width:function D(){return B("Width",this);},getMaxZIndex:function C(){var E=0;mstrmojo.array.forEach(this.children,function(F){E=Math.max(E,F.getFormats()["z-index"]);});return E;}};})();(function(){mstrmojo.url=mstrmojo.provide("mstrmojo.url",{isAbsoluteURL:function(A){return/^(http|https|ftp|file):\/\//i.test(A);},getAbsoluteURL:function(A,B){if(this.isAbsoluteURL(A)){return A;}else{if(B){return B+(/\/$/.test(B)?"":"/")+A;}else{return"http://"+A;}}}});})();(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){mstrmojo.BarcodeReader=mstrmojo.provide("mstrmojo.BarcodeReader",{_callback:null,_callbackId:0,readBarcodes:function B(G,I,C,F,D){this._callbackId++;var H=""+this._callbackId;this._callback=I;var E="mstrmojo.BarcodeReader.onBarcodeResult";if(G){G.blockBegin=0;G.blockCount=-1;G.serverUrl=mstrApp.getConfiguration().getTaskUrlByProject(mstrApp.getCurrentProjectId());G.sessionState=mstrApp.getSessionState();}mstrMobileApp.readBarcodes(H,C,(G&&JSON.stringify(G))||null,(F&&JSON.stringify(F))||null,D||null,E);},onBarcodeResult:function A(F,C,D){var E=this._callback;if(F!=this._callbackId||(!E)){return ;}delete this._callback;if(C==-1){E.success(D);}else{if(C!=0){E.failure(D||"Error reading bare code.");}}}});})();(function(){var L=/\{\@([^\}]+)\}/gm,H=/\</gm,P=/\>/gm,D=/\S/,O=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],E=new RegExp("(\\"+O.join("|\\")+")","g"),Q={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'};var J=function(S){if(S==null){return"null";}var T=typeof (S);if(T!="object"){return T;}else{if(S.length===undefined){return"object";}else{return"array";}}};var R={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function F(T,V){if(!T){return"";}var U=[];for(var S in V){U.push(S.k||S);}return T.replace(new RegExp(U.join("|"),"g"),function(W){var X=V[W];return X.v||X;});},trim:function N(S){return(S&&S.replace)?S.replace(/^\s+/,"").replace(/\s+$/,""):S;},ellipsize:function A(U,T){var S=this.trim(U.substr(0,(T||1)-1));if(S!==U){S+="&hellip;";}return S;},isEmpty:function I(S){return(S==null)||!(D.test(S));},regEscape:function M(S){return S.replace(E,"\\$1");},encodeXMLAttribute:function(S){return mstrmojo.string.multiReplace(S,Q);},encodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,C);},decodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,K);},htmlAngles:function(S){S=String(S);if(S!=null){return S.replace(H,"&lt;").replace(P,"&gt;");}return S;},apply:function G(S,T){if(!S){return"";}return S.replace(L,function U(V,W){return(W in T&&T[W]!==null)?T[W]:"";});},json2xml:function(g,b,V){if(!(b instanceof Array)){b=[b];}var T=V&&V.isSerializable,Z=(V.convertBoolean===false)?false:true;var d=[],S=[],U,h,l;for(var Y=0,j=b.length;Y<j;Y++){var k=b[Y];for(U in k){if(T){var a=T(U,b,Y);if(a!==true){if(a===false){continue;}else{if(a.att){d.push(a.att);}if(a.child){S.push(a.child);}continue;}}}h=k[U];l=J(h);switch(l){case"array":S.push("<"+U+">");for(var W=0,X=h.length;W<X;W++){var f=V.getArrItemName(U,h,W)||W;S.push(this.json2xml(f,h[W],V));}S.push("</"+U+">");break;case"object":S.push(this.json2xml(U,h,V));break;case"string":d.push(U+'="'+mstrmojo.string.encodeXMLAttribute(h)+'"');break;case"boolean":d.push(U+'="'+((Z)?(h?"-1":"0"):h)+'"');break;case"null":if(!V.skipNull){d.push(U+'="'+V.nullValue+'"');}break;default:d.push(U+'="'+h+'"');break;}}}return"<"+g+" "+d.join(" ")+">"+S.join("")+"</"+g+">";},escape4HTMLText:function B(Z){if(!Z||!Z.replace){return Z;}var W=/\"/gm;var U="&quot;";var a=/\&/gm;var Y="&amp;";var X=/\</gm;var S="&lt;";var V=/\>/gm;var T="&gt;";return Z.replace(a,Y).replace(W,U).replace(X,S).replace(V,T);},parseUri:function(W,T){T=T||R;var S=T.parser[((T.strictMode)?"strict":"loose")].exec(W),V={},U=14;while(U--){V[T.key[U]]=S[U]||"";}V[T.q.name]={};V[T.key[12]].replace(T.q.parser,function(Y,X,Z){if(X){V[T.q.name][X]=Z;}});return V;}});})();(function(){mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function C(D){if(!D||!D.length){return function(){};}return function(){for(var F=0,E=D.length;F<E;F++){D[F].apply(this,arguments);}};},wrapMethods:function B(E,D){D=D||{};mstrmojo.hash.forEach(E,function(F,G){D[G]=(G in D&&typeof (F)=="function")?mstrmojo.func.composite([F,D[G]]):F;});return D;},addMethods:function A(E,D){D=D||{};mstrmojo.hash.forEach(E,function(F,G){if(!(G in D)&&typeof (F)=="function"){D[G]=F;}});return D;}});})();(function(){var N={Min:15872549,Max:1489202,Invalid:0,NoColorMetric:16119287};var G={LeftToRight:0,RightToLeft:1,Center:2,None:3};function K(T,f,X){if(T<0||T>1){return 0;}var U=256,W=T*U,P,V,Y,S=f>>16,R=X>>16,a=(f&65280)>>8,Z=(X&65280)>>8,Q=(f&255),d=(X&255);P=S+Math.floor((W*(R-S)/U));V=a+Math.floor((W*(Z-a)/U));Y=Q+Math.floor((W*(d-Q)/U));return Y+(V<<8)+(P<<16);}function F(Q,T){var S=Q>>16,R=(Q&65280)>>8,P=(Q&255);S=Math.floor((1-T)*S);R=Math.floor((1-T)*R);P=Math.floor((1-T)*P);return P+(R<<8)+(S<<16);}function J(P){var W=[],U,Q,S=P.dp,R=S.length,X,Y;if(P==null||P.length==0){return[];}for(var T=0;T<R;T++){Q={};var X,V;if(T>0){X=U;U=Y;}else{U=S[T];}if(T<R-1){Y=S[T+1];}Q.sv=(T==0)?U.v:(X.v+U.v)/2;Q.ev=(T==R-1)?U.v:(Y.v+U.v)/2;Q.c=U.c;Q.d=(T==0)?G.LeftToRight:(T==R-1?G.RightToLeft:G.Center);W[T]=Q;}return W;}function E(X){var P=[],T,Q,S=X.dp,R=S.length;if(X==null||X.length==0){return[];}for(var U=0;U<R;U++){T={};Q=S[U];var Y=Q.s,W=Q.e;T.c=Q.c;switch(Q.d){case G.LeftToRight:T.v=Q.s;break;case G.RightToLeft:T.v=Q.e;case G.Center:case G.None:default:var V=(Q.s+Q.e)/2;T.v=V;break;}P[U]=T;}return P;}function D(T,Y){var P=[],Q=[],V=[];if(this.min==this.max||isNaN(T)||isNaN(Y)||T==Y){P[0]=L.call(this,T);P[1]=L.call(this,Y);Q[0]=1;Q[1]=1;V[0]=0;V[1]=1;}else{if(this.min<this.max){var X,S=this.blend.dp,R=S.length,W=0;P[W]=L.call(this,T);Q[W]=1;V[W]=0;W++;for(var U=0;U<R;U++){X=S[U];if(X.v>=T&&X.v<=Y){P[W]=X.c;Q[W]=1;V[W]=(X.v-T)/(Y-T);W++;}}P[W]=L.call(this,Y);Q[W]=1;V[W]=1;}}return{c:P,a:Q,r:V};}function A(T,d){var P=[],Q=[],V=[];if(this.min==this.max||isNaN(T)||isNaN(d)||T==d){P[0]=B.call(this,T);P[1]=B.call(this,d);Q[0]=1;Q[1]=1;V[0]=0;V[1]=1;}else{if(this.min<this.max){var S=this.band.dp,R=S.length,f=0.4,Y,b,h,X=0;if(T<0){P[X]=B(T);Q[X]=1;V[X]=0;X++;if(d<1){P[X]=B(d);Q[X]=1;V[X]=1;X++;}}for(var U=0;U<R;U++){Y=S[U];if(Y.s>d||Y.e<T){continue;}b=Y.c;h=F(b,f);var g=Math.max(Y.s,T),Z=Math.min(Y.e,d);if(Z!=g){switch(Y.d){case G.LeftToRight:case G.RightToLeft:case G.Center:if(g==Y.s){P[X]=(Y.d!=G.LeftToRight)?h:b;}else{P[X]=B.call(this,g);}V[X]=(g-T)/(d-T);Q[X]=1;X++;if(Y.d==G.Center){var W=(Y.s+Y.e)/2;if(W>g&&W<Z){P[X]=b;V[X]=(W-T)/(d-T);Q[X]=1;X++;}}if(Z==Y.e){P[X]=(Y.d!=G.RightToLeft)?h:b;}else{P[X]=B.call(this,Z);}V[X]=(Z-T)/(d-T);Q[X]=1;X++;break;case G.None:default:P[X]=b;V[X]=(g-T)/(d-T);Q[X]=1;X++;P[X]=b;V[X]=(Z-T)/(d-T);Q[X]=1;X++;break;}}}if(d>1){if(T>1){P[X]=B.call(this,T);V[X]=0;Q[X]=1;X++;}P[X]=B.call(this,d);V[X]=1;Q[X]=1;}}}return{c:P,a:Q,r:V};}function I(R,U){var S=0.4,Q=F(U.c,S),P,T;switch(U.d){case G.LeftToRight:if(R<U.s){return U.c;}if(R>U.e){return Q;}if(U.s==U.e){return K(0.5,U.c,Q);}T=(R-U.s)/(U.e-U.s);return K(T,U.c,Q);case G.RightToLeft:if(R<U.s){return Q;}if(R>U.e){return U.c;}if(U.s==U.e){return K(0.5,Q,U.c);}T=(R-U.s)/(U.e-U.s);return K(T,Q,U.c);case G.Center:P=(U.s+U.e)/2;if(R<U.s||R>U.e){return Q;}if(U.s==U.e){return Q;}if(R<=P){T=(R-U.s)/(P-U.s);return K(T,Q,U.c);}T=(R-P)/(U.e-P);return K(T,U.c,Q);case G.None:default:return U.c;}}function L(Y){if(isNaN(Y)){return N.Invalid;}if(this.max==this.min){return this.blendEqualColor;}var R=this.blend.dp,Q=R.length;if(!this.valid){var a=R[0],U=R[Q-1];if(Y<this.min){return a.c;}return U.c;}var S,W=R[0],Z=W.v,V=W.c,X,T;for(S=1;S<Q;S++){W=R[S];if(W.v>=Y){break;}Z=W.v;V=W.c;}S=Math.min(S,Q-1);W=R[S];X=W.v;T=W.c;if(Y<Z){return V;}if(Y>X){return T;}if(Z==X){return K(0.5,V,T);}var P=(Y-Z)/(X-Z);return K(P,V,T);}function B(Q){if(isNaN(Q)){return N.Invalid;}if(this.min==this.max){return this.bandEqualColor;}var U=this.band.dp,P=U.length;if(!this.valid){var S=U[0],T=U[P-1];if(Q<this.min){return I(T.s,S);}else{return I(T.e,T);}}for(var R=0;R<P;R++){c=U[R];if(c.s===c.e){continue;}if(c.s<=Q&&Q<=c.e){return I(Q,c);}}}function O(Q,P){this.blend.dp=[];var S=this.blend.dp,R;R={};R.c=Q;R.v=0;S[0]=R;R={};R.c=P;R.v=1;S[1]=R;}function M(Q,P){this.band.dp=[];var S=this.band.dp,R;R={};R.d=G.LeftToRight;R.s=0;R.e=0.5;R.c=Q;S[0]=R;R={};R.d=G.LeftToRight;R.s=0.5;R.e=1;R.c=P;S[1]=R;}function C(s,S,q){var U=[],T=0,X,o,a=this.min,g=this.max,R=q.legendTickCount,Q={},P,W=!isNaN(this.min)&&!isNaN(this.max);if(this.min>=this.max||this.blend.dp.length<=2){var j=(g-a)/R;for(var h=0;h<s;h++){Q={x:T,w:Math.floor(S/R)};T+=Q.w;if(W){X=a+h*j;o=X+j;P=this.getColor((X+o)/2);}else{X="Null";o="Null";P=0;}U.push({r:Q,c:P,sv:X,ev:o});}}else{var Z=this.blend.dp,b=Z.length;for(var h=0;h<b;h++){var k=Z[h],V,Y;if(h==0){X=a;}else{V=Z[h-1];X=a+(g-a)*(k.v+V.v)/2;}if(h==b-1){o=g;}else{Y=Z[h+1];o=a+(g-a)*(k.v+Y.v)/2;}Q={x:T,w:Math.floor(S*(o-X)/(g-a))};T+=Q.w;if(W){P=this.getColor((X+o)/2);}else{X="Null";o="Null";P=0;}U.push({r:Q,c:P,sv:X,ev:o});}}this.tooltipInfo=U;}function H(s,U,q){var W=[],V=0,Y,p,g=this.min,h=this.max,S=q.legendTickCount,R={},Q,a,X=!isNaN(this.min)&&!isNaN(this.max);if(this.min>=this.max){for(var j=0;j<s;j++){R={x:V,w:Math.floor(U/S)};a+=R.w;if(X){a=Y+" < "+ms+" < "+p;Q=this.getColor(g);}else{Y="Null";p="Null";Q=0;}W.push({r:R,c:Q,sv:Y,ev:p});}}else{var T,P;if(this.isFixedColorBanding){T=this.initMax;P=this.initMin;}else{T=h;P=g;}var Z=this.band.dp,f=Z.length;if(f<=2){for(var j=0;j<f;j++){var o=Z[j];if(j==0){Y=P;}else{Y=P+(T-P)*o.s;}if(j==f-1){p=T;}else{p=P+(T-P)*o.e;}if(Y<g){Y=g;}if(p>h){p=h;}if(Y>p&&p>=h){Y=h;p=h;}else{if(p<Y&&Y<=g){Y=g;p=g;}}R={x:V,w:Math.floor(U*(p-Y)/(h-g)/2)};V+=R.w;if(X){p=(Y+p)/2;Q=this.getColor((Y+p)/2);}else{Y="Null";p="Null";Q=0;}W.push({r:R,c:Q,sv:Y,ev:p});V+=R.w;var k=U*(p-Y)/(h-g)/2;R={x:V,w:Math.ceil(k)};if(j>0){var b=W[W.length-1].r;if(R.x<b.x+b.w+1){b.w=R.x-b.x;}}V+=Math.floor(k);if(X){Y=(Y+p)/2;Q=this.getColor((Y+p)/2);}else{Y="Null";p="Null";Q=0;}W.push({r:R,c:Q,sv:Y,ev:p});}}else{for(var j=0;j<f;j++){var o=Z[j];if(j==0){Y=q.props.legendAsc?P:T;}else{Y=q.props.legendAsc?P+(T-P)*o.s:T+(P-T)*o.s;}if(j==f-1){p=q.props.legendAsc?T:P;}else{p=q.props.legendAsc?P+(T-P)*o.e:T+(P-T)*o.e;}if(Y<g){Y=g;}if(p>h){p=h;}if(Y>p&&p>=h){Y=h;p=h;}else{if(p<Y&&Y<=g){Y=g;p=g;}}var k=U*(p-Y)/(h-g);R={x:V,w:Math.ceil(k)};if(j>0){var b=W[W.length-1].r;if(R.x<b.x+b.w+1){b.w=R.x-b.x;}}if(j==f-1){R.w=U-V;}V+=Math.floor(k);var t=q.props.legendAsc?" < ":" > ";if(X){Q=this.getColor((Y+p)/2);}else{Y="Null";p="Null";Q=0;}if(t){W.push({r:R,c:Q,sv:Y,ev:p});}else{W.push({r:R,c:Q,sv:Y,ev:p,sign:">"});}}}}this.tooltipInfo=W;}mstrmojo.VisHeatMapColorTheme={newInstance:function(){return{initialize:function T(){this.blend={};this.band={};this.valid=true;this.blendEqualColor=0;this.bandEqualColor=0;this.isBlend=true;this.setDefaultDataProvider();this.checkMinMax();},getGradientFillInfo:function W(b,Z){var f,a;if(isNaN(b)||isNaN(Z)){if(this.isBlend){return D.call(this,b,Z);}else{return A.call(this,b,Z);}}if(this.min==this.max){if(b<this.min){f=0;}else{f=1;}if(Z<this.max){a=0;}else{a=1;}}else{if(this.isFixedColorBanding){var g=this.initMax-this.initMin;f=(b-this.initMin)/g;a=(Z-this.initMin)/g;}else{var g=this.max-this.min;f=(b-this.min)/g;a=(Z-this.min)/g;}}if(this.isBlend){return D.call(this,f,a);}else{return A.call(this,f,a);}},checkMinMax:function U(){var g=this.min,Z=this.max;if(g>Z){this.valid=false;}else{if(g==Z){g=Z=1;var j=this.blend.dp,a=j.length,h,d;for(var f=a-1;f>=0;f--){h=j[f];if(f==a-1&&h.v<=g){this.blendEqualColor=h.c;break;}if(f==0&&h.c>=g){this.blendEqualColor=h.c;break;}if(f>0&&h.c>=g){var b=j[f-1];if(b.c<g){d=(g-b.v)/(h.v-b.v);this.blendEqualColor=K(d,b.c,h.c);break;}}}j=this.band.dp;a=j.length;for(var f=0;f<a;f++){h=j[f];if((f==0&&h.s>=g)||(f==a-1&&h.e<=g)||(h.s<=g&&h.e>=g)){this.bandEqualColor=h.c;break;}}}}},setDefaultDataProvider:function Y(){O.call(this,N.Min,N.Max);M.call(this,N.Min,N.Max);this.useDefault=true;},getColor:function Q(Z){if(this.hasNoColorMetric){return N.NoColorMetric;}var a=NaN;if(isNaN(Z)){a==0;}else{if(this.min==this.max){a=Z<this.min?0:1;}else{if(this.isFixedColorBanding){a=(Z-this.initMin)/(this.initMax-this.initMin);}else{a=(Z-this.min)/(this.max-this.min);}}}if(this.isBlend){return L.call(this,a);}else{return B.call(this,a);}},isBrightColor:function X(h){var d=h>>16,a=(h&65280)>>8,Z=(h&255),f=(d*299+a*587+Z*114)/1000;if(f>150){return true;}return false;},getContrastColor:function P(Z){if(this.isBrightColor(Z)){return 0;}return 16777215;},createTooltipInfo:function S(b,a,g){var f=0;if(this.min>=this.max){f=1;}else{var Z;if(this.isBlend){Z=this.blend.dp.length;f=(Z<=2)?5:Z;}else{Z=this.band.dp.length;f=(Z<=2)?4:Z;}}if(this.isBlend){C.call(this,f,a,g);}else{H.call(this,f,a,g);}},getTooltipInfo:function R(Z){var b=this.tooltipInfo;for(var a=0;a<b.length;a++){var f=b[a],d=f.r;if(Z>=d.x&&Z<d.x+d.w){return a;}}return a-1;},getMaxMinByMetricID:function(h,a){var b=h.gts.col,l=b.length,g=0,k=null;range={min:null,max:null};for(g=0;g<l&&k==null;g++){var p=b[g].es,Z=p.length,f;for(f=0;f<Z;f++){if(p[f].oid==a){k=f;break;}}}if(k==null){return range;}var d=h.gvs.items,l=d.length;for(g=0;g<l;g++){var o=parseFloat(d[g].items[k].rv);if(range.min==null){range.min=o;}if(range.max==null){range.max=o;}if(range.min>o){range.min=o;}if(range.max<o){range.max=o;}}return range;},convertFixedValueToBlendString:function(f,d){var l="";if(f.length%2==0){var Z=f.length,a=d.min,g=d.max,b=0;var k=g-a;l="0,"+f[1];for(b=2;b<Z-2;b+=2){var j=parseInt(f[b]);if(j<a||j>g){continue;}else{var h=(j-a)/k;l+=","+h+","+f[b+1];}}l+=",1,"+f[Z-1];}return l;},convertFixedValueToBandString:function(g,f){var p=g.split(","),h=p.length,b,l=f.max-f.min;var k="";if(h%4===0){for(b=0;b<h;b+=4){var Z=0;for(Z=0;Z<2;Z++){var q,o=p[b+Z];if(o==="min"){q=f.min;}else{if(o==="max"){q=f.max;}else{q=parseFloat(p[b+Z]);}}if(!isNaN(q)){p[b+Z]=String((q-f.min)/l);}else{console.log("warning: invalid band string. In heatmap color theme");}}}for(b=0;b<h;b++){k+=(p[b]+",");}k=k.substring(0,k.length-1);}else{console.log("warning: Invalid band color string. In heatmap color theme");}return k;},convertAbsoluteToBlend:function(b,f){this.useDefault=false;this.isColorBanding=true;var Z=f.abs.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");Z=(new window.DOMParser()).parseFromString(Z,"text/xml");var d=Z.getElementsByTagName("m")[0];b.absoluteColorID=d.getAttribute("id");this.isFixedColorBanding=true;this.fixedBandingArray=d.getAttribute("bl").split(",");var a;if(!isNaN(this.min)&&!isNaN(this.max)){a={max:this.max,min:this.min};}else{a=this.getMaxMinByMetricID(b.model,b.absoluteColorID);this.max=a.max;this.min=a.min;}if(isNaN(this.initMax)||isNaN(this.initMin)){a=this.getMaxMinByMetricID(b.model,b.absoluteColorID);this.max=a.max;this.min=a.min;this.initMax=a.max;this.initMin=a.min;}f.bandColors=this.convertFixedValueToBandString(d.getAttribute("ba"),a);f.gradientColors=this.convertFixedValueToBlendString(this.fixedBandingArray,a);},createDataProviderFromString:function V(h,g){var Z=h.split(","),a=0,f;this.blend.dp=[];this.useDefault=false;f=this.blend.dp;if(Z.length%2==0){while(a<Z.length){var d={};d.v=parseFloat(Z[a]);a++;d.c=parseInt(Z[a]);a++;f[f.length]=d;}}a=0;Z=g.split(",");this.band.dp=[];f=this.band.dp;if(Z.length%4==0){while(a<Z.length){var d={};d.s=parseFloat(Z[a]);a++;d.e=parseFloat(Z[a]);a++;d.c=parseInt(Z[a]);a++;var b=Z[a];switch(b){case"leftToRight":d.d=G.LeftToRight;break;case"rightToLeft":d.d=G.RightToLeft;break;case"center":d.d=G.Center;break;default:d.d=G.None;}a++;f[f.length]=d;}}}};}};})();mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function shwSts(C,B,D){var E=this._STATUS;if(!this.hasRendered||!E){return ;}if(!C){if(this.showingStatus){E.style.display="none";}}else{if(E){var A=this._STATUS_TXT&&(this._STATUS_TXT.innerHTML=B||"");A=this._STATUS_BAR&&(this._STATUS_BAR.style.width=(D||0)+"%");if(!this.isStatusBarPositioned){E.style.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.style.display="block";}}}this.showingStatus=C;},updateStatus:function updSts(A,B){this.showStatus(this.showingStatus,A,B);}});(function(){mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function K(R,T){var S=0,Q=(R&&R.length)||0;for(;S<Q;S++){if(R[S]==T){return S;}}return -1;},indexOfMulti:function N(U,X){if(!X){return{indices:null,map:{},count:0};}var V=X.length,W=new Array(V),Q={},Y=0;for(var T=0,S=(U&&U.length)||0;T<S;T++){var Z=U[T];for(var R=0;R<V;R++){if(X[R]===Z){W[R]=T;Q[R]=T;Y++;break;}}}return{indices:W,map:Q,count:Y};},forEach:function G(R,U,T){for(var S=0,Q=(R&&R.length)||0;S<Q;S++){if(T){if(U.call(T,R[S],S,R)===false){break;}}else{if(U(R[S],S,R)===false){break;}}}},filter:function B(S,V,T){var R=[],W=0;for(var U=0,Q=S&&S.length||0;U<Q;U++){if(V(S[U])){R[W]=S[U];W++;if(T&&T.max&&(W>=T.max)){break;}}}return R;},find:function H(R,V,S){for(var T=0,Q=R&&R.length||0;T<Q;T++){var U=R[T];if(U&&U[V]==S){return T;}}return -1;},findBin:function E(S,W,X,R){var V=R?R:S.length,T=-1,Q,U=W[X];while(V-T>1){if(S[Q=V+T>>1][X]<U){T=Q;}else{V=Q;}}return S[V][X]===U?V:-1;},search:function P(X,T,V){var U=X.length,S=-1,R,W=T.toUpperCase(),Q=T.length;while(U-S>1){if(X[R=U+S>>1][V].substr(0,Q).toUpperCase()<W){S=R;}else{U=R;}}return U;},findMulti:function N(V,R,Y){if(!Y){return{indices:null,map:{},count:0};}var W=Y.length,X=[],Q={},Z=0;for(var U=0,T=(V&&V.length)||0;U<T;U++){var b=V[U][R];for(var S=0;S<W;S++){if(Y[S][R]===b){X[S]=U;Q[S]=U;Z++;break;}}}return{indices:X,map:Q,count:Z};},removeItem:function I(Q,S){var R=this.indexOf(Q,S);if(R>-1){this.removeIndices(Q,R,1);}return R;},removeItems:function C(Q,V,R){var T=this.findMulti(Q,V,R);if(T.count){var S=T.indices.concat().sort(this.numSorter).slice(0,T.count);for(var U=S.length-1;U>-1;U--){Q.splice(S[U],1);}}},numSorter:function J(R,Q){return Number(R)-Number(Q);},stringSorter:function O(S,R){var Q=S.toLowerCase();var T=R.toLowerCase();if(Q<T){return -1;}else{if(Q>T){return 1;}else{return 0;}}},removeIndices:function M(Q,S,R){Q.splice(S,R);},insert:function F(R,Q,S){if(!R){R=[];}if(Q==null){Q=R.length;}Array.prototype.splice.apply(R,[Q,0].concat(S));return R;},hash:function L(R){var T={};for(var S=0,Q=(R&&R.length)||0;S<Q;S++){T[R[S]]=true;}return T;},get:function A(R,T){if(!T){return null;}var S=[];for(var U=0,Q=T.length;U<Q;U++){S[U]=R[T[U]];}return S;},deepSortArr:function D(R,T,Q,S){return R.sort(function(V,U){return(!S?(V[Q][T]<=U[Q][T]):(V[Q][T]>U[Q][T]))?-1:1;});}});})();(function(){var B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var D=String.fromCharCode;function A(F){F=F.replace(/\r\n/g,"\n");var E="";for(var H=0;H<F.length;H++){var G=F.charCodeAt(H);if(G<128){E+=D(G);}else{if((G>127)&&(G<2048)){E+=D((G>>6)|192);E+=D((G&63)|128);}else{E+=D((G>>12)|224);E+=D(((G>>6)&63)|128);E+=D((G&63)|128);}}}return E;}function C(E){var F="",H=0,J=0,I=0,G=0;while(H<E.length){J=E.charCodeAt(H);if(J<128){F+=D(J);H++;}else{if((J>191)&&(J<224)){I=E.charCodeAt(H+1);F+=D(((J&31)<<6)|(I&63));H+=2;}else{I=E.charCodeAt(H+1);G=E.charCodeAt(H+2);F+=D(((J&15)<<12)|((I&63)<<6)|(G&63));H+=3;}}}return F;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function(H){var F=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(H&&H.indexOf("=?UTF-8?B?")===0){var G="",E;while((E=F.exec(H))!==null){G+=mstrmojo.base64.decode(E[1]);}return G;}return H;},encode:function(G){var E="";var N,L,J,M,K,I,H;var F=0;G=A(G);while(F<G.length){N=G.charCodeAt(F++);L=G.charCodeAt(F++);J=G.charCodeAt(F++);M=N>>2;K=((N&3)<<4)|(L>>4);I=((L&15)<<2)|(J>>6);H=J&63;if(isNaN(L)){I=H=64;}else{if(isNaN(J)){H=64;}}E+=B.charAt(M)+B.charAt(K)+B.charAt(I)+B.charAt(H);}return E;},decode:function(G){var E="",F=0;var N,L,J,M,K,I,H;G=G.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(F<G.length){M=B.indexOf(G.charAt(F++));K=B.indexOf(G.charAt(F++));I=B.indexOf(G.charAt(F++));H=B.indexOf(G.charAt(F++));N=(M<<2)|(K>>4);L=((K&15)<<4)|(I>>2);J=((I&3)<<6)|H;E+=D(N);if(I!=64){E+=D(L);}if(H!=64){E+=D(J);}}E=C(E);return E;}});})();mstrmojo.mstr.EnumWebFunctionType={WebFunctionTypeReserved:0,WebFunctionTypeGeneric:1,WebFunctionTypeRankQual:2,WebFunctionTypePercentQual:3};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var F=mstrmojo.dom,L=mstrmojo.string;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:F.isNSIE?"block":"table",DISPLAY_CELL:F.isNSIE?"block":"table-cell",MINHEIGHT:F.isIE6?"height":"minHeight",addClass:function H(V,U){if(!V){return ;}if(U.constructor!==Array){U=[U];}var R=V.className||"",X=" "+R+" ",S=false;for(var T=0,Q=U.length;T<Q;T++){var W=U[T];if(!X.match(new RegExp("\\s"+W+"\\s"))){R+=" "+W;S=true;}}if(S){V.className=L.trim(R);}},removeClass:function M(U,T){if(!U){return ;}if(T.constructor!==Array){T=[T];}var R=" "+(U.className||"")+" ";for(var S=0,Q=T.length;S<Q;S++){R=R.replace(new RegExp("\\s"+T[S]+"\\s","g")," ");}U.className=L.trim(R);},addWidgetCssClass:function G(T,R){var Q=T.cssClass,S=(Q&&Q.split(" "))||[];if(R.constructor!==Array){R=[R];}T.cssClass=S.concat(R).join(" ");},toggleClass:function N(S,R,Q){if(Q){this.addClass(S,R);}else{this.removeClass(S,R);}},applyShadow:function D(U,V,T,S,Q){var R=U.style;if(F.isDXIE){R.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+V+"px, OffY="+T+"px, Color='"+Q+"')";}else{if(F.isFF||F.isWK||F.isIE10){R[F.CSS3_BOXSHADOW]=V+"px "+T+"px "+S+"px "+Q;}}},removeShadow:function O(R){var Q=R.style;if(F.isDXIE){}else{if(F.isFF||F.isWK||F.isIE10){Q[F.CSS3_BOXSHADOW]="";}}},setOpacity:function A(R,T){if(F.isDXIE&&!F.isIE9){var U=R.currentStyle.filter;var Q=null;if(U.length>0){Q=R.filters["DXImageTransform.Microsoft.Alpha"];}if(Q){Q.opacity=T;Q.enabled=(T!=100);}else{if(T<100){var S="progid:DXImageTransform.Microsoft.Alpha(Opacity="+T+")";R.style.filter=(U?U:"")+" "+S;}}}else{R.style.opacity=T/100-(F.isIE9?0.00001:0);}},buildGradient:function C(R,T,Q){if(F.supports(F.cssFeatures.GRADIENTS)){var S={};if(F.isDXIE){S.n="filter";S.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+R+",StartColorStr='"+T+"',EndColorStr='"+Q+"')";}else{if(F.isFF){S.n="background-image";S.v="-moz-linear-gradient("+((R===0)?"top":"left")+","+T+","+Q+")";}else{if(F.isWK){S.n="background";S.v="-webkit-gradient(linear,"+((R===0)?"left top, left bottom":"left top, right top")+",from("+T+"),to("+Q+"))";}else{if(F.isIE10||F.isIEW3C){S.n="background";S.v="linear-gradient("+((R===0)?"to bottom":"to right")+","+T+","+Q+")";}}}}return S;}return null;},buildRoundCorners:function K(V,U){if(F.supports(F.cssFeatures.ROUND_CORNERS)){var R=V+"px";var X=R+((U)?" "+R+" 0 0":"")+";";if(F.isFF){return"-moz-border-radius:"+X;}else{if(F.isWinPhone||F.isIE10){return"border-radius:"+X;}else{if(F.isWK){if(!U){return"-webkit-border-radius:"+R+";";}else{var W=["left","right"],T=[],Q=-1;for(var S=0;S<2;S++){T[++Q]="-webkit-border-top-"+W[S]+"-radius:"+R;T[++Q]="-webkit-border-bottom-"+W[S]+"-radius:0";}return T.join(";");}}}}}return"";},getBorderWidthsOrPaddings:function E(R,U){var V={t:0,r:0,b:0,l:0,h:0,w:0};if(!R){return V;}var S=R.split(" "),Q=S.length;for(var T=0;T<Q;T++){S[T]=Math.round(U*parseFloat(S[T],10)/72);}if(Q<4){if(Q===1){S[1]=S[2]=S[3]=S[0];}else{S[3]=S[1];if(Q===2){S[2]=S[0];}}}V.t=S[0];V.r=S[1];V.b=S[2];V.l=S[3];V.h=V.t+V.b;V.w=V.l+V.r;return V;},getBorderWidths:function I(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},getPaddings:function J(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},parkAfterFade:function P(Q){var R=Q.target.style;if(R.opacity==0){R.left="-10000px";window.setTimeout(function(){R.opacity=0.99;},0);return true;}return false;},getStyleValue:function B(Q,S){if(Q.currentStyle){S=S=="float"?"styleFloat":S;value=Q.currentStyle[S];}else{if(document.defaultView&&document.defaultView.getComputedStyle){S=S=="float"?"cssFloat":S;var R=document.defaultView.getComputedStyle(Q,null);value=R?R[S]:null;}}return value;},getComputedStyle:function(Q,S){var R=(window.getComputedStyle)?function(T,U){return window.getComputedStyle(T,U||null);}:function(T){return T.currentStyle||{};};mstrmojo.css.getComputedStyle=R;return R(Q,S);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo.requiresDescs(4891);var D=mstrmojo.array,C="u;",A="-1";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function E(F,I,K){var H;for(var G in F){H=F[G];if(H.v){var J=H.v.split(";");if(J&&J.length>1){J[1]=I;if(K&&J.length>2){J.pop();}H.v=J.join(";");}}}return F;},buildElemsCountStr:function B(I,G){if(!I||!I.length||!G||!G.length){return"";}var H=I.length,F=G.length;if(D.find(G,"v",C)>-1){F-=1;}if(D.find(G,"v",A)>-1){F-=1;}if(D.find(I,"v",C)>-1||D.indexOf(I,C)>-1){H=F;}if(H>=F){return"("+F+")";}else{return mstrmojo.desc("4891").replace("##",H).replace("###",F);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo._HasBuilder={postBuildRendering:function B(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function C(){return this.model.getChildren(this.node,false);},buildChildren:function A(E){if(!this.builder||!this.model){return false;}if(this.children&&this.children.length){this.set("children",[]);}var D=this.model,F=this.builder.build(this.getChildren(),D,this.buildConfig);if(!E){this.addChildren(F);}this.builtChildren=true;return(E)?F:true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer");var Q=mstrmojo.dom,O=mstrmojo.hash,T=mstrmojo.array;function U(){O.forEach(this.ifwMap,function(X){X.destroy();});this.ifwMap={};}function A(){var X=[],Z=null,Y=null;O.forEach(this.ifwMap,function(a){if(a.visible){X.push({psId:a.psId,psKey:a.psKey,anchorPos:a.anchorPosition||Q.position(a.anchor,true),anchorOrn:a.anchorOrientation});}});if(X.length>0){Z=this.getSelectedLayoutWidget();Y=Z&&Z.getScrollPos();}return{ifwRecords:X,docScrollRecord:Y};}function L(b){var X=(b&&b.ifwRecords)||[],Y=b&&b.docScrollRecord,Z=this.getSelectedLayoutWidget(),a=this,d={};if(X.length>0){if(Y&&Z){Z.scrollTo(Y);}T.forEach(X,function(f){a.showInfoWindow(f.psId,f.psKey,d,null,f.anchorOrn,f.anchorPos);});}}function I(){mstrmojo.DICPopup&&mstrmojo.DICPopup.cancel&&mstrmojo.DICPopup.cancel();}function N(){if(this.xtabStyleSheets){var Z,Y,X;for(Y=0;Z=this.xtabStyleSheets[Y];Y++){X=Z.parentNode;if(X){X.removeChild(Z);}}}}function W(Y,b){var Z=this.getLayout(Y),X=Z.docGroupBy,a=this.controller;if(X){X.set("data",b.groupbys);Z.gb=b;}if(a.getPageByTree){a.getPageByTree(true);}}mstrmojo._IsRwDocument={_mixinName:"mstrmojo._IsRwDocument",updateXtabStyles:function K(f,Z){var o=this.xtabStyleSheets&&this.xtabStyleSheets[0],l=this.styleList||{},Y=function(w,s){var t;for(t in s){var q=s[t].css||"";if(s[t].app){q=(w[t]||"")+q;}w[t]=q;}return w;},p=document;if(!l[f]){l[f]=Y({},this.model.getSelectedXtabStyles(f));}Y(l[f],Z);if(!o){this.xtabStyleSheets=[];o=this.xtabStyleSheets[0]=p.getElementsByTagName("head")[0].appendChild(p.createElement("style"));}var a=new mstrmojo.StringBuffer(),b,d;for(b in l){for(d in l[b]){a.append(l[b][d]);}a.append("\n");}a=a.toString();if(o&&a){o=o.styleSheet||o;if(Q.isWK){var k=o.firstChild;if(k){k.nodeValue=a;}else{o.appendChild(p.createTextNode(a));}}else{if(Q.isIE){o.cssText=a;var j,h,X,g;for(j=1;o.rules.length===4095&&p.styleSheets.length<31;j++){h=o.rules[4094];X=new RegExp(h.selectorText,"i");g=a.search(X);if(g===-1){break;}g=a.indexOf("}",g+1);a=a.slice(g+1);if(!this.xtabStyleSheets[j]){this.xtabStyleSheets[j]=p.getElementsByTagName("head")[0].appendChild(p.createElement("style"));}o=this.xtabStyleSheets[j].styleSheet;o.cssText=a;}}else{o.innerHTML=a;}}}this.styleList=l;},postBuildRendering:function S(){if(this.xtabStyleSheets){for(var Y,X=0;Y=this.xtabStyleSheets[X];X++){if(!Y.parentNode){document.getElementsByTagName("head")[0].appendChild(Y);}}}return this._super();},buildChildren:function B(b){var h;try{var d=this.model;if(d){var f=this.buildSubs||{},p=d.id+"-partialUpdate",Y=d.id+"-rebuildLayout",k=d.id+"-updateStyles",a=d.id+"-showInfoWin",Z=this.id;var j=this,o=function(){T.forEach(j.getLayouts(),function(q){if(q.k!==d.currlaykey){q.defn.loaded=false;}});};if(f[p]===undefined){var l=function X(AB){var t=this.model,s=t&&t.getLayoutDataCache(t.getCurrentLayoutKey()),q=AB&&AB.ids;if(O.isEmpty(s)||!q){return ;}T.forEach(AB.tree.layouts,function(AD){if(AD.k===t.currlaykey){this.updateXtabStyles(AD.k,AD.xtabStyles);if(AD.gbys){W.call(this,AD.k,AD.gbys);}return false;}},this);var x=O.forEach,AC=false,z={update:q.upd,refresh:q.tgts,adjustSectionSize:q.secs};x(q.ifws,function(AF,AE){var AD=mstrmojo.all[AF+"_ifw"];if(AD&&AD.visible){this.updateInfoWindowPS(AF,AE);}},this);x(z,function(AE,AD){x(AE,function(AG,AI){var AF=mstrmojo.all[AI],AH;if(AF&&AF[AD]!==undefined){AH=AF[AD](AD==="update"?s[AI]:null);if(AD==="adjustSectionSize"&&AH){AC=AC||(!!AH.heightReduced);}}},this);},this);var w=this.getSelectedLayoutWidget();if(AC){w.notifyScrollListeners();}var AA=w.docLayout;if(AA){AA.resizeOrReposition();}if(AB&&AB.unloadCache){o();}};f[p]=d.attachEventListener("partialUpdate",Z,l);}f[Y]=f[Y]||d.attachEventListener("rebuildLayout",Z,function(q){var t=q&&q.restoreIW,s;if(t){s=A.call(this);this.model.aws=null;}this.onLayoutRebuilt(this.rebuildLayout(q.src.currlaykey,this.getLayouts()));if(q&&q.unloadCache){o();}if(t){L.call(this,s);}});f[k]=f[k]||d.attachEventListener("updateStyles",Z,function(q){this.updateXtabStyles(q.key,q.updatedStyles);});f[a]=f[a]||d.attachEventListener("showInfoWin",Z,function(q){this.showInfoWindow(q.psId,q.psKey,q.anchor,q.invalidate,q.anchorOrientation,q.anchorPosition);});this.updateXtabStyles(d.getCurrentLayoutKey());d.attachEventListener("refresh",this.id,function(){this.refresh();});}h=this._super(b);}catch(g){mstrmojo.err(g);}return h;},updateInfoWindowPS:mstrmojo.emptyFn,showInfoWindow:function H(Y,w,j,l,q,s){var a=this.model,f=a.getLayoutDataCache(a.getCurrentLayoutKey()),AA=this.builder,X=f[Y]&&f[Y].defn,d=X&&X.iwpl,z=Y+"_ifw",AE=mstrmojo.all[z],AB=this.domNode,Z=mstrmojo.DocInfoWindow.PLACEMENT.FIXED,AC=function(AF,AG,AH,AJ,AI){if(d===Z){if(AG){var AK=Q.delta(AG,AB);AF.popPosition={left:(AK&&AK.x)?AJ+AK.x:AJ,top:(AK&&AK.y)?AI+AK.y:AI};}else{if(AH){AF.popPosition={left:(AH.scrollboxLeft)?AJ-AH.scrollboxLeft:AJ,top:(AH.scrollboxTop)?AI-AH.scrollboxTop:AI};}else{AF.popPosition={left:AJ,top:AI};}}}};var p=this.getLayout(a.getCurrentLayoutKey());if(AE){if(l){AE.refresh();}AE.anchorOrientation=q;AE.anchorPosition=s;AC(AE,AE._ifwpdn,p,AE._ifwfl,AE._ifwft);AE.open(this,{anchor:j,boundary:AB});}else{var g={opener:this,anchor:j,anchorOrientation:q,boundary:AB,parent:this,builder:AA,model:this.model,psKey:w,psId:Y,id:z,autoCloses:true,locksHover:true,closeOnClick:false,anchorPosition:s};if(d){d=parseInt(d,10);g.placement=d;if(d===Z){var h=X.fmts,b=g._ifwfl=h&&h.left&&parseInt(h.left.replace("px",""),10),x=g._ifwft=h&&h.top&&parseInt(h.top.replace("px",""),10),k=f[Y]&&f[Y].p,t=k&&a.getUnitInstance(k.k,k.wid),o=g._ifwpdn=t&&t.domNode;AC(g,o,p,b,x);}}AE=AA.newInfoWindow(g);this.renderInfoWindow(AE);var AD=this.ifwMap=(this.ifwMap||{});AD[Y]=AE;}},renderInfoWindow:function J(X){X.render();},_lockInfoWinContainer:function G(Y){var b=this.ifwMap,X;for(X in b){var Z=b[X],a=Y.xtab;if(Z&&a&&Q.contains(Z.infoNode,a.domNode,true,document.body)){Z.autoCloseLocked=true;Y.onClose=function(){Z.autoCloseLocked=false;};break;}}},unrender:function R(X){U.call(this);this._super(X);N.call(this);},getLayouts:function M(){return this._layouts;},getLayout:function P(X){X=X||this.model.getCurrentLayoutKey();var Y=this.getLayouts();return Y[T.find(Y,"k",X)];},getNewLayout:function E(Y,f,X,j){var b=this,Z=b.model,d=Z.getDataService(),h=Y.layoutKey,a=f[T.find(f,"k",h)];if(a.defn&&(Y.reload||a.defn.loaded===false||(Z.zt&&(window.mstrMobileApp!==undefined)&&(a.defn.lastOrientation!==mstrMobileApp.getOrientation())))){var g=j.success;j.success=function(k){Z.replaceLayout(h,k);Z.currlaykey=h;if(X){a.zf=k.zf;b.selectLayout(a,false);}var l=b.rebuildLayout(h,f);if(b.controller.getPageByTree){b.controller.getPageByTree(true);}g(l);};d.loadDocLayout(Y,j);}else{j.success(a);if(X){this.selectLayout(a,true,{success:function(k){O.copyProps(["bs"],k,Z);}});}}},selectLayout:function D(a,b,d){var X=this.model,Y=a.k,Z=(Y!==X.currlaykey);X.currlaykey=Y;this.restoreLayoutState(a);if(b&&Z){X.getDataService().setCurrentDocLayout(Y,d);}else{if(d&&d.complete){d.complete();}}return a;},rebuildLayout:function C(Y,f){var a=this.model,Z=T.find,b=f[Z(f,"k",Y)],X=a.getChildren(this.node,false);var d=X[Z(X,"k",Y)];if(window.mstrMobileApp!==undefined){d.defn.lastOrientation=mstrMobileApp.getOrientation();}var g=this.replaceLayout(b,d);this.updateXtabStyles(Y,a.getSelectedXtabStyles(Y));U.call(this);I();return g;},destroy:function V(){U.call(this);if(this._super){this._super();}N.call(this);},replaceLayout:mstrmojo.emptyFn,restoreLayoutState:mstrmojo.emptyFn,onLayoutRebuilt:mstrmojo.emptyFn,unloadGbLayuts:function F(Z){var g=this.getLayouts(),b=this.model.getCurrentLayoutKey(),f,d,h,Y,a,X;f=this.getLayout();Y=f.gb&&f.gb.groupbys;for(a=0;a<Y.length;a++){h=Y[a];if(h.k===Z){X=h.unit.target.did;break;}}for(d=0;d<g.length;d++){f=g[d];if(f.k===b){continue;}Y=f.gb&&f.gb.groupbys;if(Y&&Y.length){for(a=0;a<Y.length;a++){h=Y[a];if(h.unit.target.did===X){f.defn.loaded=false;break;}}}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,D=mstrmojo.hash;function C(X,V){if(!V){return ;}var Y=[],O=X.selectedIndices,N=X.allIdx,T=X.noneIdx,P=X.parent&&X.parent.include;if(X.multiSelect&&(T>-1)&&(G.indexOf(V,T)>-1)){return Y;}var R,S,W=X.items,U=X.itemIdField,Q=X.selectedItems,a;if(X.multiSelect&&(N>-1)&&(G.indexOf(V,X.allIdx)>-1)){for(R=0,S=W.length;R<S;R++){if(!O[R]){Y.push(R);O[R]=true;X.selectedIndex=R;X.selectedItem=W[R];}}}else{for(R=0,S=V.length;R<S;R++){var Z=V[R];if(!O[Z]){O[Z]=true;Y.push(Z);X.selectedIndex=Z;a=X.selectedItem=W[Z];if(Q){Q[a[U]]=a;}}}}return Y;}function A(P){var O=[],Q=P.selectedIndices,R=P.selectedItems;for(var N in Q){delete Q[N];O.push(parseInt(N,10));}P.selectedIndex=-1;P.selectedItem=null;if(R){P.selectedItems={};}return O;}function L(W,V){if(!V){return ;}var S=[],O=W.selectedIndices,Y=G.indexOf,N=W.allIdx,T=W.noneIdx,U=W.itemIdField,P=W.selectedItems;if(W.multiSelect&&(((N>-1)&&(Y(V,N)>-1))||((T>-1)&&(Y(V,T)>-1)))){return A(W);}if(V.length>0&&O[N]){if(Y(V,N)<0){V.push(N);}}for(var Q=0,R=V.length;Q<R;Q++){var X=V[Q];if(O[X]){delete O[X];S.push(X);if(P){delete P[W.items[X][U]];}if(W.selectedIndex==X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function F(Q,P,R,N){if(Q.raiseEvent){Q.raiseEvent({name:"select",idxs:N||[]});if((P&&P.length)||(R&&R.length)){try{Q.raiseEvent({name:"selectionChange",added:P,removed:R});}catch(O){L(Q,P);C(Q,R);throw O;}}}}function I(P,O){if(O==null){return -1;}var N=typeof (O)=="object",Q=P.itemIdField;if(N&&Q!=null){return G.find(P.items,Q,O[Q]);}else{return G.indexOf(P.items,O);}}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(N){this._super(N);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function M(W){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this.items,N=this.items.length,Q=this.selectedItems,S=[],P;U=this.items=U.concat(W);P=U.length;if(Q){var O=this.selectedIndices,T=this.itemIdField,R,V;for(R=N;R<U.length;R++){V=U[R];if(Q[V[T]]){S.push(R);}}}if(S&&S.length){C(this,S);}if(P>N){this.itemsContainerNode.innerHTML+=this._buildItemsMarkup(N,P-1).join("");}},addSelectedItems:function H(N){this.selectItems(N,false);},setSelectedItems:function K(N){this.selectItems(N,true);},selectItems:function J(W,Y){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this;if(Y&&U.selectedItems){U.selectedItems={};}var P=U.selectedItems,T=U.itemIdField,X,V,Q,N=[],S=U.items.length,R=[],O=U.allowUnlistedValues;for(Q=0;Q<W.length;Q++){X=W[Q];V=I(this,X);if(V===-1){if(P===null){if(O){N.push(v);V=S++;}}else{P[X[T]]=X;}}if(V!==-1){R.push(V);}}if(N.length>0){U.addItems(N);}if(R.length>0){if(Y){U.select(R);}else{U.addSelect(R);}}},unselectItems:function J(O){if(!O){return ;}if(O.constructor!=Array){O=[O];}var S=this,U=S.selectedItems,P=[],T=S.itemIdField,R,N,Q;if(U===null){return ;}for(Q=0;Q<O.length;Q++){R=O[Q];if(U){delete U[R[T]];}N=I(this,R);if(N!==-1){P.push(N);}}if(P.length>0){S.removeSelect(P);}},getSelectedItems:function B(){if(this.selectedItems!=null){return D.valarray(this.selectedItems);}else{return G.get(this.items,D.keyarray(this.selectedIndices,true));}},singleSelect:function(N,O){if(N!==-1){this.select([N],O);}},singleSelectByField:function E(O,P,N){this.singleSelect(G.find(this.items,P,O),N);},toggleSelect:function(N){var P,O;if(this.selectedIndices[N]){O=L(this,[N]);}else{P=C(this,[N]);}F(this,P,O,[N]);},rangeSelect:function(N){},select:function(O,N){if(O==null){return ;}if(O.constructor!=Array){O=[O];}var Q=A(this),S=C(this,O),P=Q.length-1;if(this.selectionPolicy!=="reselect"){for(;P>=0;P--){var R=G.indexOf(S,Q[P]);if(R>-1){Q.splice(P,1);S.splice(R,1);}}}if(!N){F(this,S,Q,O);}},clearSelect:function(N){var O=A(this);if(N!==true){F(this,null,O,[]);}},addSelect:function(P,N){if(P==null){return ;}if(P.constructor!=Array){P=[P];}var O=C(this,P);var R=null,Q=this.noneIdx;if(this.multiSelect&&(Q>-1&&G.indexOf(P,Q)>-1)){R=L(this,P);}if(N!==true){F(this,O,R,P);}},removeSelect:function(N){if(N==null){return ;}if(N.constructor!=Array){N=[N];}F(this,null,L(this,N),N);},_set_selectedIndices:function(P,W,N){var S=this,O=S.selectedIndices;if(S.selectedItems){S.selectedItems={};}var O=S.selectedIndices;if(O==W){return false;}if(!O){O={};S.selectedIndices=O;}if(!W){W={};}var U=S.selectedIndex,T=[],V;for(V in O){if(!W[V]){V=parseInt(V,10);delete O[V];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var Z=[],X=S.items,R=S.itemIdField,Y;for(V in W){if(!O[V]){V=parseInt(V,10);O[V]=true;Z.push(V);S.selectedIndex=V;Y=S.selectedItem=X[V];if(S.selectedItems){S.selectedItems[Y[R]]=Y;}}}if(N!==true){var Q=[];for(V in W){if(O[V]){V=parseInt(V,10);Q.push(V);}}F(S,Z,T,Q);}return(Z.length||T.length);},_set_selectedIndex:function(Q,O,N){var P={};if(O>-1){P[O]=true;}return this._set_selectedIndices("selectedIndices",P,N);},_set_selectedItem:function(Q,P,O){var N=I(this,P);if((N===-1)&&(P!=null)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(P));N=this.items.length-1;}return this._set_selectedIndex("selectedIndex",N,O);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var L=10,C=20,a=false,o=false,W=L,b=[],V=mstrmojo.array,J=false,P,h;var B=6,X=7,A=100,k=101,O=102,F=103;function D(s,x,t){var q=x[0],p=x[1],w;s.beginPath();s.moveTo(q,p);for(w=2;w<x.length-1;w=w+2){s.lineTo(x[w],x[w+1]);}s.lineTo(q,p);s.fillStyle=t;s.stroke();s.fill();}function j(s,z,t){var q=z[0],AA=z[1],w=z[2]-q,p=z[3]-AA;s.fillStyle=t;s.strokeRect(q,AA,w,p);s.fillRect(q,AA,w,p);}function Z(AA,w,AB){var s=w[0],q=w[1],z=w[2],t=w[3],x=w[4],p=w[5];AA.beginPath();AA.arc(s,q,t,x,p,false);AA.lineTo(s+z*Math.cos(p),q+z*Math.sin(p));AA.arc(s,q,z,p,x,true);AA.closePath();AA.fillStyle=AB;AA.stroke();AA.fill();}function M(AA,w,AB){var t=w[0],s=w[1],x=w[2],z=w[3],p=w[4],q=w[5];AA.scale(1,q);AA.beginPath();AA.arc(t,s,x,z,p,false);AA.lineTo(t,s);AA.arc(t,s,0,p,z,true);AA.closePath();AA.fillStyle=AB;AA.stroke();AA.fill();AA.scale(1,1/q);}function N(AB,x,AC){var t=x[0],s=x[1],z=x[2],AA=x[3],p=x[4],w=x[5],q=x[6];AB.scale(1,q);AB.beginPath();AB.arc(t,s,z,AA,p,false);AB.lineTo(t+z*Math.cos(p),s+z*Math.sin(p)-w);AB.arc(t,s-w,z,p,AA,true);AB.closePath();AB.fillStyle=AC;AB.stroke();AB.fill();AB.scale(1,1/q);}function E(p,s,q){p.fillStyle=q;p.beginPath();p.arc(s[0],s[1],s[2],0,Math.PI*2,true);p.stroke();p.fill();}function T(q,p){return q.Point.X-p.Point.X;}function I(q,AI,AD){var AH=this.tooltipArr[AD],t=q.Text,z=q.SC,p=AH.style,AG=(this.model.zf||1),AA=mstrMobileApp.getDeviceDPI()/160,AE=2*AA,AF=mstrApp.getScreenDimensions().w-(P*2);if(mstrApp.isTablet()){AG=(AG*AA)+"em";}else{if(mstrMobileApp.getDeviceDPI()>240){AG=(AG*1.5)+"em";}else{AG+="em";}}var x="font-size:"+AG+";";x+="padding:"+AE+"px;";x+="maxWidth:"+AF+"px;";if(z){x+="border-color:#"+z;}AH.innerHTML=t;p.cssText=x;p.display="block";var AC=0,w=0;var s=AH.offsetHeight,AB=AH.offsetWidth;AC=AI.y-s-6;w=AI.x-AB-6;b.push({x:q.Point.X,y:q.Point.Y,clr:z||"#000000",top:AC,left:w,width:AB,height:s});}function Q(s,q,p){var w=p.left,t=Math.max(p.top,h+C);width=p.width,style=q.style,newLeft=w+width+12;if(newLeft+width<=mstrApp.getScreenDimensions().w){w=newLeft;}else{if(w<0){w=P;}}style.left=w+"px";style.top=t+"px";s.showAreaMarker(p.x,p.y,p.clr);}function g(p,AL){var AG=b[AL],AI=p.tooltipArr,AF=AI[AL].style,s=AG.left,x=AG.top,AC=AG.width,z=AG.height,AD=mstrApp.getScreenDimensions().w,AE,AB;if(AL>0){var AA=b[AL-1],w=AA.top,q=AA.left,AK=q+AA.width,t=q+AC,AJ;s=q;if(t>AK){s-=(t-AK);}else{if(t<AK){s+=(AK-t);}}if(s<0){if((AC*2)+12>AD){a=false;J=true;s=P;for(AE=0;AE<AL;AE++){AJ=AI[AE];AA=b[AE];AB=s+AC-AA.width;AA.left=AB;AJ.style.left=s+AC-AA.width+"px";}}else{a=true;}}x=w-C-z;if(x<h){var AH=Math.abs(x)+h+C;for(AE=0;AE<AL;AE++){AJ=AI[AE];AA=b[AE];w=AA.top+AH;AA.top=w;AJ.style.top=w+"px";}x+=AH;}}else{if(s<0){if((AC*2)+12>AD){J=true;s=P;}else{a=true;}}if(x<h){x=h+C;}}if(!a){AF.left=s+"px";AG.left=s;}AF.top=x+"px";AG.top=x;p.showAreaMarker(AG.x,AG.y,AG.clr);}function U(x,p,t,AA){var s=x.tooltipArr[p].style,w=b[p],z=b[p-t].top,q=w.width;if(AA+q>mstrApp.getScreenDimensions().w){o=true;s.display="none";return ;}s.left=AA+"px";s.top=z+"px";x.showAreaMarker(w.x,w.y,w.clr);}function d(AG){var AH=b.length,q=AG.tooltipArr,w=Math.ceil(AH/2),z=0,AF=1,AD=Math.min(AH,L/2),p=mstrApp.getScreenDimensions().w,t,s,AC;for(z=0;z<w;z++){g(AG,z);}if(a||J){for(z;z<AD;z++){g(AG,z);}if(!J){var x=z-1,AE=0,AB=0,AA,AI;t=b[x];s=t.left+t.width+12;for(x=z-1;x>=0;x--){AC=q[x];AI=b[x].width;if(s+AI>p){AB=P+AI;if(AB>AE){rightMostPositon=AB;AA=b[x];}}AC.style.left=s+"px";}if(AE>0){for(x=0;x<z;x++){AC=q[x];AC.style.left=(P+AA.width-b[x].width)+"px";}}}}else{t=b[AH-1];s=t.left+t.width+12;for(z;z<AH;z++){U(AG,z,AF,s);AF+=2;if(o){break;}}if(o&&z<=AD){for(z=w;z<AH;z++){g(AG,z);q[z].style.display="block";}}}}function S(){var p=this,q=b.length;if(q===0){return ;}h=mstrApp.rootView.getTitleHeight();if(q===1){Q(p,p.tooltipArr[0],b[0]);}else{d(p);}}function K(s,p,t,q){switch(s){case X:j(p,t,q);break;case A:E(p,t,q);break;case k:Z(p,t,q);break;case O:M(p,t,q);break;case F:N(p,t,q);break;default:D(p,t,q);}}mstrmojo.graph._MobileGraphAreaHelper=mstrmojo.provide("mstrmojo.graph._MobileGraphAreaHelper",{highlightArea:function l(w,s){var t=this,p=w.getContext("2d"),q="rgba(255, 255, 255, 0.5)";t.clearHighlightArea(w);p.strokeStyle="#FFFFFF";V.forEach(s,function(x){K(x.Shape,p,x.Coords,q);});},highlightAreaInInit:function G(AD,AA){var AF=AD.getContext("2d"),p=this.graphData.Areas,w="rgba(255, 255, 255, 0.5)";AF.clearRect(0,0,AD.width,AD.height);AF.strokeStyle="#FFFFFF";var q=p.length,AG=286,z=259,AE=341;var AC=AA.length/2,x,AB;for(AB=0;AB<q;AB++){var s=p[AB],t=parseInt(s.OID,10);if(t!==AG&&t!==z&&t!==AE){continue;}if(s.SID<0||s.GID<0){continue;}for(x=0;x<AC;x++){if(s.SID!==AA[2*x]||s.GID!==AA[2*x+1]){continue;}K(s.Shape,AF,s.Coords,w);}}},clearHighlightArea:function R(q){if(q){var p=q.getContext("2d");p.clearRect(0,0,q.width,q.height);q.width=q.width;}},showAreaMarker:function H(p,t,s){if(p>=0&&t>=0){var q=this.highlightNode.getContext("2d");q.save();q.fillStyle="#FFFFFF";q.strokeStyle=s||"#000000";q.lineWidth=2;q.beginPath();q.arc(p,t,5,0,Math.PI*2,true);q.stroke();q.fill();q.fillStyle=s||"#000000";q.beginPath();q.arc(p,t,2,0,Math.PI*2,true);q.stroke();q.fill();q.restore();}},displayTooltips:function f(p,x,w){p.sort(T);var t=this.tooltipArr,z;a=false;o=false;b=[];this.clearHighlightArea(this.highlightNode);if(!t){P=8*(mstrMobileApp.getDeviceDPI()/160);t=[];for(z=0;z<L;z++){var AB=document.createElement("div");AB.id="mstrmojo-mobileGraph-tooltip";AB.className=mstrmojo.GraphBase.tooltipCLS;document.body.appendChild(AB);t[z]=AB;}this.tooltipArr=t;}W=Math.min(p.length,L);var AA=mstrmojo.touchManager;if(W===0&&this._touchListener){AA.detachEventListener(this._touchListener);delete this._touchListener;}else{if(W>0&&!this._touchListener){this._touchListener=AA.attachEventListener("touchesBegin",this.id,function(AD){var AE=mstrmojo.all[AD.srcId];if(!(AE instanceof mstrmojo.android.ui.ActionToolbarButtons||AE instanceof mstrmojo.android.ui.Menu)){this.displayTooltips([],0,0);}});}}var s=null,AC={},q;J=false;for(z=0;z<L;z++){q=t[z].style;q.left=-9999;q.display="none";}for(z=0;z<W;z++){s=p[z];AC.x=s.Point.X+x;AC.y=s.Point.Y+w;I.call(this,s,AC,z);}S.call(this);window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},destroy:function Y(p){V.forEach(this.tooltipArr,function(q){document.body.removeChild(q);});delete this.tooltipArr;if(this._super){this._super(p);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._IsPanelStack=mstrmojo.provide("mstrmojo._IsPanelStack",{_mixinName:"mstrmojo._IsPanelStack",TTL_SRC_PANEL:0,init:function J(N){this._super(N);var M=this.defn;if(!M){M=this.defn=this.node&&this.node.defn;this.titleSrc=this.titleSrc||M.ttlSrc;}var L=this.selectedKey=this.defn.selKey=this.node.data.selKey;this.set("selectedIdx",E.find(this.node.data.panels,"k",L));M.attachEventListener("selKeyChange",this.id,function(O){this.set("selectedKey",O.value);});},addChildren:function K(O,L,N){var M=this.getFormats(),P=M&&M.overflow;if(P){E.forEach(O,function(Q){var R=Q.getFormats();if(R){R.overflow=P;}});}return this._super(O,L,N);},refresh:function F(){if(this.hasRendered){var L=this.defn.newSelKey||this.selectedKey;E.forEach(this.children,function(M){M._delayRefresh=(M.k!==L);if(!M._delayRefresh){M.refresh();}});}delete this.defn.newSelKey;},selectPanel:function B(L,M){if(L!==this.selectedKey){this.defn.set("selKeyChange",L);this.model.slice({type:3,tks:this.k,eid:L,sid:this.node.data.wid,ck:this.k,hasLoader:M});}},onselectedKeyChange:function G(M){var O,L,N;E.forEach(this.children,function(Q,P){var R=Q.k;if(M.value===R){L=Q;N=P;Q.set("selected",true);}else{if(M.valueWas===R){O=Q;Q.set("selected",false);}}if(L&&O){return false;}});if(this.titleSrc===this.TTL_SRC_PANEL&&this.title){this.set("title",L.title);this.defn.ttl=L.title;}this.prevSelectIdx=this.selectedIdx;this.set("selectedIdx",N);this.raiseEvent({name:"panelSelected",key:L.k});return{on:L,off:O};},setDirty:function D(L){if(L){this.setDirtyChildren(true);}this._super(L);},setDirtyChildren:function H(L){var M=this.selectedKey;E.forEach(this.children,function(O){var N=O.k;O[((L||N!==M)?"add":"remove")+"DirtyKey"](N);});},clearDirtyChild:function I(N){var M=this.children,L=M[E.find(M,"k",N)];if(L){L.removeDirtyKey(L.k);}},isPanelStack:true,checkRequiredObjects:function C(){var L=this.txWidgets||{},O,N,M=true;for(O in L){M&=!!L[O].checkRequiredObjects();}return M;},updateSelectedIdx:mstrmojo.emptyFn,switchToPanel:function A(L,M){if(M!==undefined){this.set("selectedIdx",M);}else{this.updateSelectedIdx(L);}this.children[this.selectedIdx]&&this.selectPanel(this.children[this.selectedIdx].k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var B=mstrmojo.func.wrapMethods,C=mstrmojo.hash;function L(M){return function(){var O=this,N=[].slice.call(arguments),P=N.pop();N.push(mstrmojo.func.wrapMethods({success:function(Q){O.setData(Q);},prompts:function(Q){O.setPrompts(O.getDataService().getPrompts());}},P));this.submitToDataService(M,N);};}function A(M,N){if(N){M.data=N;}M.setPrompts(M.getDataService().getPrompts());}mstrmojo._IsRptModel={_mixinName:"mstrmojo._IsRptModel",setPrompts:function D(M){this.prompts=M;if(M){M.host=this;}},getDataService:function H(){return this.dataService;},execute:function I(O,P){var M=this,N=C.copy(O,{dssId:O.did});if(O.forceExec){N.execFlags=1;N.doNotUpdateCaches=true;}this.getDataService().execute(N,B({success:function(Q){A(M,Q);},prompts:function(){A(M);}},P));},refresh:function F(N,O){var M=this;this.getDataService().getResults(null,B({success:function(P){A(M,P);}},O));},answerPrompts:function E(N){var M=this;this.getDataService().answerPrompts(this.prompts,B({success:function(O){M.data=O;}},N));},submitToDataService:function G(M,N){var O=this.getDataService();O[M].apply(O,N);},getPageByTree:function J(M){this.submitToDataService.call(this,"getPageByTree",[M]);},sort:L("sort"),pivot:L("pivot"),drillGrid:L("drillGrid"),drill2Grid:L("drill2Grid"),linkToObject:L("linkToObject"),pageBy:L("pageBy"),setData:function K(M){this.data=M;if(!this.prompts){this.setPrompts(this.dataService.getPrompts());}}};}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom");var M=mstrmojo.string,T=mstrmojo.dom;var N=mstrmojo.useFrames?null:document.createElement("span");var B=/\mstrAttach\:([\w\,]+)/g;var R;function O(X){if(R===undefined){R=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return X.replace(B,function W(d,g){var Z=g.split(","),a=[],Y=Z.length,b;for(b=0;b<Y;b++){var f=Z[b];if(f){if(R){if(f.indexOf("mouse")>-1){continue;}else{if(f==="click"){f="touchend";}}}a.push("on"+f+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+f+"', self, event)\"");}}return a.join(" ");});}var P="preBuildRendering",D="buildRendering",A="postBuildRendering";function E(Y){var X=Y.markupString;if(X.match(/mstrAttach:/)){X=O(X);if(Y.markupString===Y.constructor.prototype.markupString){Y.constructor.prototype.markupString=X;}}var W=M.apply(X,Y);if(W){if(mstrmojo.useFrames){var Z=(Y.domNode&&Y.domNode.ownerDocument)||self.document;if(!N||N.ownerDocument!==Z){N=Z.createElement("span");}}N.innerHTML=W;var a=N.firstChild;a.mstrmojoId=Y.id;return a;}return null;}function J(Y){var X=Y.markupSlots,W,Z;if(X){W={};for(Z in X){W[Z]=X[Z].apply(Y,[]);}}return W;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function G(){if((this[P]&&this[P]()===false)||(this[D]()===false)||(this[A]&&this[A]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var W="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,W)){this.raiseEvent({name:W});}return true;},buildDom:function S(){return E(this);},preBuildRendering:mstrmojo.emptyFn,buildRendering:function C(){var W=this.domNode,X=this.buildDom();this.domNode=X;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(J(this));this.paint();if(X){var a=W;if(!a){a=this.placeholder;if(a){if(typeof a==="string"){a=document.getElementById(a);}delete this.placeholder;}}if(a){T.replace(a,X);}}var Y="onchildRenderingChange",Z=this.parent;if(Z&&Z[Y]){Z[Y](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function Q(Y){if(this.hasRendered){if(!Y){try{var W=this.domNode;if(W.parentNode){W.parentNode.removeChild(W);}if(mstrmojo.dom.isIE&&W.outerHTML!=="undefined"){W.outerHTML="";}}catch(X){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function V(){var X=this.markupMethods;if(!X){return ;}var a=this,b=function(j){var g=X[j];if(g){try{g.apply(a,[true]);}catch(h){throw new Error(["Error in markup method.","Widget id: "+a.id,"Method name: "+j,"Err: "+h.message].join("\n\n"));}}};var Z=X.sequence,W,Y,d;if(Z){W=Z.length||0;for(Y=0;Y<W;Y++){b(Z[Y]);}}else{for(d in X){b(d);}}},refresh:function F(W){if(this.hasRendered){var X=this.domNode;this.unrender(true);this.placeholder=X;if(W){W();}this.render();}},set:function L(Z,W){this._super(Z,W);if(this.domNode){var X=this.markupMethods,Y=X&&X["on"+Z+"Change"];if(Y){Y.apply(this);}}return this;},slotNames:null,addSlots:function I(X){var W=this.slotNames,Y;if(!W){W={};this.slotNames=W;}for(Y in X){this[Y]=X[Y];W[Y]=true;}},removeSlots:function K(W){if(W){var X=this.slotNames,Y;for(Y in W){delete this[Y];if(X){delete X[Y];}}}},captureDomEvent:function H(Y,W,Z,X){if(this.enabled!==false){this.raiseEvent({name:Y,hWin:W,e:Z||W.event,config:X});}},playEffect:function U(X){var W=this[X];if(W&&W.constructor===Object){W=mstrmojo.insert(mstrmojo.hash.clone(W));W.widget=this;this[X]=W;}if(W){W.play();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.string","mstrmojo.StringBuffer");mstrmojo._XMLNode=mstrmojo.declare(null,null,{nodeName:null,init:function N(O){mstrmojo.hash.copy(O,this);},addChild:function F(P){var O=new mstrmojo._XMLNode({nodeName:P});return this.appendNode(O);},appendNode:function J(O){if(O){if(!this.children){this.children=[];}this.children.push(O);O.parent=this;}return O;},addAttribute:function L(O,P){if(O!=null){if(!this.attributes){this.attributes={};}this.attributes[O]=P;}return this;},addText:function M(O){this._addToStringMember("text",O);return this;},addRawXML:function K(O){this._addToStringMember("rawXML",O);return this;},getXMLString:function I(){var O=new mstrmojo.StringBuffer();this.buildXMLString(O);return O.toString();},buildXMLString:function E(O){O=O||new mstrmojo.StringBuffer();O.append("<").append(this.nodeName).append(" ");this._buildAttributesXMLString(O).append(">").append(((this.text!=null)?this._escapeString(this.text):"")).append(((this.rawXML!=null)?this.rawXML:""));this._buildChildrenXMLString(O).append("</").append(this.nodeName).append(">");return O;},_buildAttributesXMLString:function D(O){var Q=this.attributes;if(Q){for(var R in Q){if(Q[R]!=null){var P=String(Q[R]);switch(R){case"et":case"nt":case"dmt":case"ddt":case"fnt":case"tp":case"stp":break;default:P=this._escapeString(P);}O.append(R+'="'+P+'" ');}}}return O;},_escapeString:function C(O){return mstrmojo.string.escape4HTMLText(O);},_buildChildrenXMLString:function H(P){var R=this.children;var O=R&&R.length;if(O){for(var Q=0;Q<O;Q++){if(R[Q]&&R[Q].buildXMLString){R[Q].buildXMLString(P);}}}return P;},_addToStringMember:function A(O,Q){var P=this[O];if(P==null){this[O]=Q;}else{this[O]=P+Q;}}});mstrmojo.XMLBuilder=mstrmojo.declare(null,null,{root:null,curNode:null,addChild:function F(O){if(!this.root){this.currentNode=this.root=new mstrmojo._XMLNode({nodeName:O});}else{this.currentNode=this.currentNode.addChild(O);}return this;},appendNode:function J(O){if(!this.root){this.currentNode=this.root=O;}else{this.currentNode=this.currentNode.appendNode(O);}return this;},addAttribute:function L(O,P){if(this.currentNode){this.currentNode.addAttribute(O,P);}else{alert("no root node");}return this;},addText:function M(O){if(this.currentNode){this.currentNode.addText(O);}else{alert("no root node");}return this;},addRawXML:function K(O){if(this.currentNode){this.currentNode.addRawXML(O);}else{alert("no root node");}return this;},closeElement:function G(){this.currentNode=this.currentNode.parent;},toString:function B(){if(this.root){return this.root.getXMLString();}else{return"";}}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasDrillLinks","mstrmojo.registry","mstrmojo.hash","mstrmojo.dom");var B=mstrmojo.dom;function D(F){var E=F;while(E){if(E.openDrillLinkMenu){return E;}E=E.parent;}return null;}mstrmojo._HasHoverButton=mstrmojo.provide("mstrmojo._HasHoverButton",mstrmojo.hash.copy(mstrmojo._HasDrillLinks,{_mixinName:"mstrmojo._HasHoverButton",buttonNodeMarkup:'<div class="mstrmojo-LinkInfo-buttonNode"></div>',init:function C(E){this._super(E);this.markupSlots.buttonNode=function(){return this.domNode.lastChild;};},postBuildRendering:function A(){if(!this.hoverBtn){this.addChildren(mstrmojo.registry.ref({scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"hoverBtn",onclick:function H(){this.openPopup();},openPopup:function E(){var J=D(this);if(J){J.openDrillLinkMenu({openerButton:this,drillLinkItems:this.parent.drillLinkItems,cmPos:this.cmPos});}},closePopup:function F(){var J=D(this);if(J){J.closeDrillLinkMenu();}}}));}var G=this._super();var I=this.id;B.attachEvent(this.domNode,"contextmenu",function(J){mstrmojo.all[I].oncontextmenu(J,self);});return G;},oncontextmenu:function(G,E){var F=this.hoverBtn;F.cmPos=B.getMousePosition(G,E);F.openPopup();F.cmPos=null;B.preventDefault(E,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var B=false,D="mstrmojo.Binding",A="bindings",C=mstrmojo.registry;function E(K){for(var L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function F(K,M){if(!B){mstrmojo.requiresCls(D);B=true;}for(var N in K){var J=K[N];if(J==null){continue;}var L=typeof (J);if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=C.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function G(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[A]);if(K){delete this[A];this._set_bindings(A,K,true);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children;if(M){for(var L=0,J=M.length;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function I(){var J=this.bindings;if(J){E(J);delete this.bindings;}},_set_bindings:function H(L,J){var K=this[A];if(J!==K){if(K){E(K);}this[A]=J;if(J){F(J,this);}return true;}return false;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash;mstrmojo._CanSupportTransaction={_mixinName:"mstrmojo._CanSupportTransaction",updatedCellsMap:null,getUpdates:mstrmojo.emptyFn,getUpdateObject:mstrmojo.emptyFn,getKeyContext:mstrmojo.emptyFn,autoRefresh:mstrmojo.emptyFn,editNext:mstrmojo.emptyFn,dataChanged:function A(F,G,E,H){var D=this.updateValue(F,E);this.updatedCellsMap[F]={r:G,v:E};this.controller.onTransactionUpdates(this,this.getUpdateObject(),D);},postBuildRendering:function B(){if(this._super){this._super();}if(!this.txModel){this.txModel=this.model.docModel||this.model;}this.updatedCellsMap=this.updatedCellsMap||{};},updateValue:function(E,D){if(this.txModel.deltaUpdate){this.txModel.deltaUpdate(this);}return false;},getUpdatedValues:function(){var E=this.updatedCellsMap,F,D,G=[];for(F in E){if(E.hasOwnProperty(F)){D={};D.v=E[F].v.v;G.push(C.copy(this.getKeyContext(F),D));}}return G;},clear:function(){this.updatedCellsMap={};},registerTxWidget:function(){function E(F,H){var G=F.node.data.k;H.txWidgets=H.txWidgets||{};H.txWidgets[G]=F;return false;}var D=this.parent;while(D){if(D.isPanelStack===true){E(this,D);}D=D.parent;}}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.mstr.ElementDataService=mstrmojo.provide("mstrmojo.mstr.ElementDataService",{getElements:function A(C,D){var B=mstrmojo.hash.copy(C,{});B.taskId=B.taskId||"browseElements";mstrApp.serverRequest(B,D,{showWait:true,hideWait:true,delay:true});}});}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash");var B="AndroidServerTransport";mstrmojo.android.AndroidServerTransport={serverRequest:function A(I,H,F){var E=new mstrmojo.StringBuffer(),G,D;mstrmojo.hash.forEach(F.params,function(J,K){E.append(K+"="+encodeURIComponent(J));});G=F.taskURL+"?"+E.toString("&");F.params.hostUrl=F.taskURL;if(mstrApp.useBinaryFormat){D=JSON.stringify({params:F.params,url:G});}else{D=G;}$MAPF(true,B,"transportRequest");mstrMobileTransport.serverRequest(I,H,D,"response","progress");},cancelRequest:function C(D){$MAPF(false,B,"transportRequest");return mstrMobileTransport.cancelRequest(D);}};})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo._HasPopup={openPopup:function B(G,D){var C=!!G&&(typeof (G)==="string")&&!G.match(/\./)&&!!this[G],I=mstrmojo.registry.ref(C?this[G]:G,true);if(I&&I.open){if(C){this[G]=I;}this.disposables.push(I);var F=I.slot&&this[I.slot];if(F){if(I.parent!==this){if(this.addChildren){this.addChildren(I);}else{var H=false,E=I.domNode||I.placeholder;if(E&&typeof (E)==="string"){E=document.getElementById(E);}if(!E){H=true;E=document.createElement("span");I.placeholder=E;}if(H||(E.parentNode!==F)){F.appendChild(E);}}}}I.open(this,D);this._lastOpened=I;}},closePopup:function A(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}};})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,9379,9380,9381,9382,9383,9384,9385,6078,7899,7900,7901,6079,6081,6080,6082,7902,7902,6076,6077,7903);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(B){var A=this;if(this.isLoaded){B();}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(C){mstrmojo.hash.copy(mstrmojo.hash.obj2array(C),A);B();if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(C){alert(C.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"getLocaleInfo"});}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:["S","M","T","W","T","F","S"],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:"Include"},{did:"2",n:"Exclude"}],BranchQual:[{did:"19",n:"AND"},{did:"20",n:"OR"},{did:"21",n:"NOT"},{did:"19_21",n:"AND NOT"},{did:"20_21",n:"OR NOT"}],RootOperator:[{did:"19",n:"All selections"},{did:"20",n:"Any selection"}],ExprType:[{did:"2",n:"Qualify"},{did:"5",n:"Select"}],DimtyLevels:[{did:"1",n:"Default"},{did:"2",n:"Metric"},{did:"3",n:"Report"}],Attribute:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1},{did:"1,44",n:"Not between",t:1},{did:"1,76",n:"Contains",t:1},{did:"1,79",n:"Does not contain",t:1},{did:"1,77",n:"Begins with",t:1},{did:"1,80",n:"Does not begin with",t:1},{did:"1,78",n:"Ends with",t:1},{did:"1,81",n:"Does not end with",t:1},{did:"1,18",n:"Like",t:1},{did:"1,43",n:"Not Like",t:1},{did:"1,54",n:"Is Null",t:1},{did:"1,55",n:"Is Not Null",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1}],Metric:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1},{did:"1,44",n:"Not between",t:1},{did:"1,54",n:"Is Null",t:1},{did:"1,55",n:"Is Not Null",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1},{did:"2,1",n:"Highest",t:2},{did:"2,2",n:"Lowest",t:2},{did:"3,1",n:"Highest%",t:3},{did:"3,2",n:"Lowest%",t:3}],MDXAttribute:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1},{did:"1,44",n:"Not between",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1}],MDXMetric:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1}],SAPAttribute:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1}],Element:[{did:"1,22",n:"In List",t:1},{did:"1,57",n:"Not In List",t:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash,A=null;function B(D){return mstrmojo.DICFactory.createDIC(C.copy({dic:this.dic,owner:this.owner,group:this},D));}mstrmojo.DICFactory=mstrmojo.provide("mstrmojo.DICFactory",{createDIC:function(G){var E=G.dic,F=mstrmojo.DICConfig.getDICClass(E),D;if(F){if(G.k===undefined){G.k=G.opener&&G.opener.id;}G.showByDefault=mstrmojo.DICConfig.showDICByDefault(G.dic,G.openerType);G.hasPreview=mstrmojo.DICConfig.hasDICPreview(G.dic,G.openerType);D=new F(G);}return D;},createDICPopup:function(D,E){return mstrmojo.DICPopup.getInstance(D,E);},createDICGroup:function(F){var I=C.copy(F,{scriptClass:"mstrmojo.Widget",widgetsMap:{},dic:null,owner:null,groupMembers:{},postCreate:function(){var L=this.dic,K=this.openerType,J=mstrmojo.DICConfig;this.showByDefault=J.showDICByDefault(L,K);this.hasPreview=J.hasDICPreview(L,K);},addDIC:function D(J,K){this.groupMembers[J]=K;},showPopupDIC:function H(K){if(!this.showByDefault){var J=this.widgetsMap[K],L=this.groupMembers[K];if(!L){return ;}if(!J){J=this.widgetsMap[K]=B.call(this,L);}J.showInPopup();}},render:function G(){if(this.showByDefault||this.hasPreview){var L=this.groupMembers,K=this,J;C.forEach(L,function(N,M){if(!N.hasRendered){K.widgetsMap[M]=J=B.call(K,N);if(K.showByDefault){J.render();}else{if(K.hasPreview){J.renderPreview();}}N.hasRendered=true;}});}},destroy:function E(){C.forEach(this.widgetsMap,function(J){J.destroy();});this.widgetsMap={};}});return mstrmojo.insert(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var E=mstrmojo.hash;var B=function(G){return(mstrmojo.now()-G.getTime());};mstrmojo.storage.DOMStorage=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.storage.DOMStorage",mIsSupported:false,mStorageObj:null,itemTimeToLive:3600,init:function F(G){E.copy(G,this);return this;},isSupported:function C(){return this.mIsSupported;},checkVersion:function A(G){var H=this.getItem("__version__");if(H&&H<G){mstrmojo.dbg("DOMStorage data is old - clearing, v="+H);this.clear();}this.setItem("__version__",G,-1);return this;},length:function(){return(this.mIsSupported?this.mStorageObj.length:0);},_keyExpired:function D(G){return(G&&(G.ts>0)&&(mstrmojo.now()>G.ts));},key:function(G){return(this.mIsSupported?this.mStorageObj.key(G):null);},getItemAsString:function(H){var G=this.getItem(H);if(G){if(typeof G=="object"){G=JSON.stringify(G);}else{G=G+"";}}return G;},getItem:function(H){var G=null;if(this.mIsSupported){var J=this.mStorageObj.getItem(H);if(J){try{J=JSON.parse(J);}catch(I){}if(this._keyExpired(J)){this.removeItem(H);}else{G=J.data;}}}return G;},setItem:function(H,J,G){G=G||this.itemTimeToLive;try{if(this.mIsSupported){this.mStorageObj.removeItem(H);var L=(G>0)?(mstrmojo.now()+(G*1000)):-1;var I={ts:L,data:J};this.mStorageObj.setItem(H,JSON.stringify(I));}}catch(K){if(K!==QUOTA_EXCEEDED_ERR){throw K;}}finally{}return this;},removeItem:function(G){if(this.mIsSupported){this.mStorageObj.removeItem(G);}return this;},clear:function(){if(this.mIsSupported){this.mStorageObj.clear();}return this;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,g,V,X){var W=b,Z;while(Z=W.match(g)){var d=Z[0],a=d.length,f=true;d=d.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===d){f=false;break;}else{if(d.indexOf(Y)===0){delete U[Y];}}}if(f){U[d]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var f=S.evt2idx,j=S.idx2evt,Z=S.parts;var g=(U>=0)?U:0,b=this.id,W=mstrmojo.all,d=(U>0)?W[j[g-1].context][Z[g-1]]:(S.host?W[S.host]:this.parent),T=Z[g];var V=mstrmojo.array;while(d&&T){if(d.attachEventListener){var h=d[T+"_bindEvents"]||(T+"Change");if(typeof (h)=="string"){h=[h];}var Y=[];for(var a=0,X=h.length;a<X;a++){Y[a]=d.attachEventListener(h[a],b,"_callback");}for(var a=0;a<h.length;a++){f[d.id+"_"+h[a]]=g;}j[g]={context:d.id,evts:h,subs:Y};}d=d[T];T=S.parts[++g];}},_detachChain:function G(S,T){var U=mstrmojo.all,l=S.idx2evt,f=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=l.length;if(Y<b){for(;Y<b;Y++){var Z=l[Y];if(!Z){break;}var W=Z.context,d=U[W],k=Z.evts;if(d&&d.detachEventListener){var o=Z.subs;for(var h=0,V=o.length;h<V;h++){d.detachEventListener(o[h]);}}l[Y]=null;for(var X=0,g=k.length;X<g;X++){delete f[W+"_"+k[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.android.EnumMenuOptions");var C=mstrmojo.android.EnumMenuOptions,D=C.TRANSACTIONS_QUEUE;function B(){return mstrApp.getTransactionNotificationController();}function A(){return(!this.hsc&&(this.st===14081));}mstrmojo.android.controllers._SupportsQueuedTransactions=mstrmojo.provide("mstrmojo.android.controllers._SupportsQueuedTransactions",{_mixinName:"mstrmojo.android.controllers._SupportsQueuedTransactions",getTxnToolbarButton:function F(G){var H=B();if(H&&H.hasTransactionQueue((A.call(this))?this.did:null)){G.addToolbarBtn(D,mstrmojo.desc(9262,"Transactions Queue"),D,true,18);}return G;},handleMenuItem:function E(I,G){if(I===D){var H,J;if(A.call(this)){H=this.did;J=this.ttl;}B().showNotificationBoard(this,H,J);}else{this._super(I,G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=(F)?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var B=mstrmojo.EnumReadystate;function D(F){return(F.getKey&&F.getKey())||F.k;}mstrmojo._IsDocController={_mixinName:"mstrmojo._IsDocController",_getXtabCallback:function(J){var F={},H=F[D(J)]=J.defn,I=this,G=I.model;return G.newCallback({submission:function(){if(H.set){H.set("readyState",B.WAITING);}},success:function(K){if(K.pukeys){F=G.getUnitDefinitions(K.pukeys);}G.partialUpdate(K.data,F);},failure:function(K){mstrmojo.alert(K.code+": "+K.message);},complete:function(){if(H.set){H.set("readyState",B.IDLE);}I.docRequestComplete();}});},_addNodeKeyToAction:function(F,G){G.nodeKey=D(F);return G;},onGridSelector:function(G,J){var F=this.model,I=F.getTargetInfoWin(J.tks);if(I&&I.length){for(var H=0;H<I.length;H++){F.showInfoWin(I[H],J.anchor,"h",true);}}J.sid=G.sid;F.slice(J);},onVisSelector:function(G,I){if(I.anchor){var F=this.model,H=F.getTargetInfoWin(I.tks);if(H&&H.length){F.showInfoWin(H[0],I.anchor,"h",true);}}if(G.xtabModel&&G.xtabModel.docModel&&G.xtabModel.docModel.slice){G.xtabModel.docModel.slice(I);}},isInRequest:function C(){var F=!!this._inProcess;if(!F){this._inProcess=true;}return F;},docRequestComplete:function E(){this._inProcess=false;},nudgeWidget:mstrmojo.emptyFn,getGroupByElements:function A(H){var L=[],K;while(H){var K=H.node&&H.node.data&&H.node.data.pbes;if(K){break;}H=H.parent;}if(K){var I=this.model.data.elems;for(var J=0,G=K.length;J<G;J++){var F=K[J];L.push(isNaN(F)?F:I&&I[F]);}}return L;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function A(){var I=this.getFormats(),G="",H=function H(J){if(I[J]){var K=this[J]||I[J];this[J]=K;if(this.isFullScreenWidget){I[J]=K;}this[J+"Limit"]=parseInt(K,10);}};H.call(this,"height");H.call(this,"width");var F=function(M,L){var J=I[M];if(J&&J.charAt(J.length-1)!=="%"){var K=parseInt(J,10);if(!isNaN(K)){if(L){K-=L;}G+=M+":"+K+"px;";}}return null;};F("height",0);F("width",0);this.scrollboxNodeCssText=G;return this._super();},resize:function(){this.clearCache();var I=this.getFormats(),G=parseInt(I.height,10),F=parseInt(I.width,10);if(F>0&&G>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}mstrmojo.array.forEach([this.scrollboxNode,this.viewport],function(K){var J=K.style;J.height=G+"px";J.width=F+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=G&&(G!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(G,10);this.scrollboxBottom=this.scrollboxTop+G;}if(this.lockHeadersCase){this.resizeScrollBox(B.isIE);}}var H=this.zones;if(H){if(H._BL){H._BL.onscroll();}if(H._BR){H._BR.onscroll();}}if(!(this.gridData&&this.gridData.eg)){this.onGridWidthChanged();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function D(){this.clearCache();this.unrender();this.render();},unrender:function E(){this.clearCache();if(this._super){this._super();}},defaultAction:function C(J,H){if(this._super(J,H)){var F=this.model.sti,G=F&&F.titleId,L=F&&F.deselectCurrent,M;this._currentSelectedTD=L?undefined:J;if(G){for(M in this.zones){var N=this.zones[M],K=N.domNode,I=K&&K.firstChild;if(I&&(J.offsetParent===I||J.offsetParent===K)){N.clearHilites(G);if(!L){N.setHilites(G,J);}N.hiliteKey=G;this.model.sti=null;return true;}}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox={_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount==1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L!=null&&J in L){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners;for(var O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},scrollTo:function F(K){var J=this.scrollboxNode;if(J&&K){J.scrollLeft=K.x;J.scrollTop=K.y;}},scrollInterval:50,_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=(L)?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=(L)?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var G=mstrmojo.dom,H=Math;var D=1,F=2,I=3,K=4,E=5,A=6;function B(){var N=this.anchor;if(!N){return false;}var W=this.baseTipClass,X=this[this.tipNodeName];X.className=W+" top";var l=this[this.boundaryNodeName],AC=this[this.popupNodeName],j=this.anchorOffset,AA=this.anchorOrientation,x=this.hasScrollbars(),f=mstrmojo.hash.copy(this.anchorPosition||G.position(N,true)),Q=G.position(l,true),AG=Q.w,O=Q.h,o=AC.offsetWidth,S=AC.offsetHeight,a=o/2,L=S/2,d=G.position(X),t=H.min(d.h,d.w),U=H.max(d.h,d.w)/2,q=this.placement;if(x){AG-=15;O-=15;}var g=G.contains(l,AC),w=g?0:Q.y,AF=AG/2-a,V=O/2-L+w,AB=-1000,AH=-1000,P,s=["borderBottomColor","borderTopColor","borderRightColor","borderLeftColor"],AI=0;if(g){f.x=f.x-Q.x;f.y=f.y-Q.y;}var p=f.y+f.h,R=f.x+f.w,AD=((R+o)<AG),Y=f.y>S,z=((p+S)<O),b=function(AJ,AL,AK){return H.min(H.max(AJ,AK),H.max(AL,0));},T=function(){if((f.x<AG)&&(z||Y)){var AJ=f.x+(f.w/2),AK=(q==K&&z)||!Y;if(AK){P="top";AH=p;AI=0;V=p+t-j;}else{P="bottom";AH=f.y-t;AI=1;V=AH-S+j;}AF=b(0,AG-o,AJ-a);AB=b(f.x,R,AJ)-U;return true;}return false;},k=function(){if((f.y<O)&&(AD||f.x>o)){var AJ=f.y+(f.h/2),AK=!(q==E&&f.x>o)&&AD;if(AK){P="left";AB=R;AI=2;AF=R+t-j;}else{P="right";AB=f.x-t;AI=3;AF=AB-o+j;}V=b(w,O-S,AJ-L);AH=b(f.y,p,AJ)-U;return true;}return false;},Z=[T,k],AE=0;if(q==F){V=this.popPosition.top;AF=this.popPosition.left;AH=-1000;AB=-1000;P=null;}else{if(q==E||q==A||(q==D&&AA==="h")){Z.reverse();}for(;AE<2;AE++){if(Z[AE]()){break;}}V=H.round(V);AF=H.round(AF);AH=H.round(AH);AB=H.round(AB);}X.className=W+" "+(P||"hidden");var h=X.style,M=AC.style;h.top=AH+"px";h.left=AB+"px";if(this.tipNodeColor){mstrmojo.array.forEach(s,function(AJ){h[AJ]="";});h[s[AI]]=this.tipNodeColor;}M.top=V+"px";M.left=AF+"px";return true;}mstrmojo._IsAnchorable={anchor:null,anchorPosition:null,boundaryNodeName:"curtainNode",popupNodeName:"editorNode",tipNodeName:"tipNode",baseTipClass:"mstrmojo-Editor-tip",anchorOffset:25,anchorOrientation:"v",placement:D,popPosition:null,hasScrollbars:function C(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},prepareAnchor:mstrmojo.emptyFn,positionDialog:function J(){this.prepareAnchor();if(!B.apply(this,[])){if(typeof this._super==="function"){this._super();}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof (W)=="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget.apply(this,[]);}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children;for(var Y=0,W=(X&&X.length)||0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);for(var X=0,W=(Y&&Y.length)||0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props;for(var Z in Y){var X=Y[Z],W=X.ease;if(typeof (W)=="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props;for(var a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}else{return parseInt(W*Y,10)/W;}}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}else{if(X===0){return W;}else{return W+Z*I(X,Y);}}},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}else{return W+Z*Math.sin((Math.PI/2)*X/Y);}},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}else{return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}else{if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}else{if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}else{return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;}}}},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}else{return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,E=false;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function(){var F=C.windowDim(),J=(C.isFF||C.isWK)?0:2;var G=F.w,I=F.h;if(E){var H=I;I=G;G=H;}return{w:Math.max(G,0)+"px",h:Math.max(I-J,0)+"px"};},simulateOrientationChange:function A(){E=!E;this.monitorWindow();},preBuildRendering:function B(){var G=true;if(this._super){G=this._super();}var H=this.getBrowserDimensions();if(!("browserResized" in this)||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return G;},destroy:function D(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function(F){var H=F.currentTarget,I=this.getBrowserDimensions(),G={w:(H?H.innerWidth+"px":I.w),h:(H?H.innerHeight+"px":I.h)};if(G.h===this.height&&G.w===this.width){return ;}if(!("browserResized" in this)||this.browserResized(G)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var I=1,C=2;function E(P){var Q=this.defn,R=Q.vc,S=Q.hc;if(!P||P.length===0||(!R&&!S)){return{};}return{v:!!R,h:!!S};}function B(P){return parseInt(this.getFormats()[(P===I)?"height":"width"],10);}function H(Q){var P=this.getFormats()["max-"+((Q===I)?"height":"width")];return P&&parseInt(P,10);}function G(T,S){var Q=this.defn,R=T&&(T.dimNode||T.domNode),P=Q.ck&&Q.ck[T&&(T.k||T.content.k)];if(R&&P&&(P&S)){return R;}return null;}function F(Q,T,S,Y){var P=parseInt(S.style[(T===I)?"top":"left"],10);if(!!Y){return P+Y;}var R=(Q.fmts&&Q.fmts.fx)||{},U=(!J.isIE7&&(R.rt===1||R.rt===3))?((T===I)?C:I):T,W=(U===I)?"Height":"Width";Y=S["offset"+W]+(R.ds||0);var V=P+Y;if(J.isIE7&&W==="Width"&&Q instanceof mstrmojo.XtabBase){var X=Q.contentNode.offsetWidth;if(V<X){V+=X;}}return V;}function L(P,Q,R){if(P>Q){if(R){P=Math.min(P,R);}return P;}return Q;}function D(V,T,U){var P=this.getCanGrowShrinkNode(),R=(V===I)?"Height":"Width",Q=R.toLowerCase(),S=parseInt(P.style[Q],10);if(T&&T!==S&&!(T<S&&!!U)){S=T;P.style[Q]=S+"px";this.afterCanGrowShrink();}this["_fixed"+R]=S;}function A(Q,T,V){var W=H.call(this,T),X=B.call(this,T),U=Q.length,R;for(R=0;R<U;R++){var P=Q[R],S=G.call(this,P,T);if(!S){continue;}X=L(F.call(this,P,T,S),X,W);if(X===W){break;}}D.call(this,T,X,V);}function O(U,T,Q,S){var R=G.call(this,U,T);if(!R){return ;}var P=F.call(this,U,T,R,Q);D.call(this,T,L(P,B.call(this,T),H.call(this,T)),S);}mstrmojo._CanGrowOrShrink=mstrmojo.provide("mstrmojo._CanGrowOrShrink",{getCanGrowShrinkNode:function N(){return this.domNode;},performCanGrowCanShrink:function M(Q,R){var P=E.call(this,Q);if(P.v){A.call(this,Q,I,R);}if(P.h){A.call(this,Q,C,R);}},fixedSizeCanGrowShrink:function K(T,P,R,S){var Q=E.call(this,T&&[T]);P=parseInt(P,10);R=parseInt(R,10);if(Q.v&&!isNaN(P)){O.call(this,T,I,P,S);}if(Q.h&&!isNaN(R)){O.call(this,T,C,R,S);}},afterCanGrowShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var I=mstrmojo.dom;var L="mousedown";function P(S){var R=S[S.hotSlot||"domNode"];if(R){if(!S._closeCallback){var U=S.id,T=function(V){return function(X){var W=mstrmojo.all[U];if(W&&!W.ignoreHover){W["auto"+V](X,self);}};};S._uncloseCallback=T("Unclose");S._closeCallback=T("Close");}I.attachEvent(R,"mouseover",S._uncloseCallback);I.attachEvent(R,"mouseout",S._closeCallback);}}function C(S){if(S._closeCallback){var R=S[S.hotSlot||"domNode"];if(R){I.detachEvent(R,"mouseover",S._uncloseCallback);I.detachEvent(R,"mouseout",S._closeCallback);}}}function N(T,S){var R=T;while(R){if(R.open||R.openPopup){if(R.set){R.set("ignoreHover",S);}else{R.ignoreHover=S;}}R=R.opener||R.parent;}}function A(){var R=this._lockHoverCallback;if(R){I.detachEvent(document.body,L,R,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose={autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function B(){this._super();if(this.autoCloses){P(this);}this.oncloseOnClickChange();},onautoClosesChange:function D(){var R=(this.autoCloses)?P:C;R(this);},oncloseOnClickChange:function O(){if(!this.curtainNode){return ;}var T=this,S="click",R=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(R){S="touchstart";}I.attachEvent(T.curtainNode,S,function(){T.close();if(R){mstrmojo.touchManager.notify([]);}});},autoUnclose:function H(){var R=this._autoCloseTimer;if(R){self.clearTimeout(R);delete this._autoCloseTimer;}},autoClose:function F(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var R=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[R].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function M(R){A.call(this);this._super(R);},lockHover:function K(){N(this,true);if(!this._lockHoverCallback){var S=this.id,R=this._lockHoverCallback=function(T){mstrmojo.all[S]._unlockHoverCheck(T,self);};if((I.isIE7||I.isIE8)&&window.event&&(window.event.type==L)&&this.opener){this.opener._ignoreMousedown=true;}I.attachEvent(document.body,L,R,true);}},unlockHover:function E(){N(this,false);A.call(this);},_unlockHoverCheck:function J(T,R){var S=this.opener;if(S&&S._ignoreMousedown){delete S._ignoreMousedown;return ;}if(!I.contains(this.domNode,I.eventTarget(R,T),true,document.body)){this.close();}},open:function G(S,R){if(this.autoCloses){this.autoUnclose();}this._super(S,R);if(this.locksHover){this.lockHover();}},close:function Q(R){if(this.locksHover){this.unlockHover();}this._super(R);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var Y=5;var l=1;var V=2;var N=4;var k=0;var O=true;var I=0;var F=86400000;mstrmojo.VisChartUtils=mstrmojo.provide("mstrmojo.VisChartUtils",{getScreenZoomFactor:function Z(){if(I==0){if(mstrMobileApp){var s=mstrMobileApp.getDeviceDPI();console.log("dpi:"+s);I=s/160;}else{I=1;}}return I;},changeElementSize:function a(x,AC,AB){if(AC=="fontSize"||AC=="height"||AC=="line-height"){var AA=mstrmojo.css.getStyleValue(x,AC);var w=Math.round(AB*parseInt(AA));x.style[AC]=w+"px";}else{if(AC=="font"){var z=mstrmojo.css.getStyleValue(x,"fontSize");var w=Math.round(AB*parseInt(z));var t=mstrmojo.css.getStyleValue(x,"fontWeight");var s=mstrmojo.css.getStyleValue(x,"fontFamily");x.style.font=t+" "+w+"px "+s;}}},rgbaStr2rgba:function L(s){var w=null;s=s.replace(/ /g,"");var t=s.indexOf("rgba");if(t>=0){s=s.substring(t+5,s.length-1);w=s.split(",");}return w;},fillBackground:function b(AA,t,AI,w,AC){var AB=w||AA.context,z=t||AA.canvas.width,AF=AI||AA.canvas.height,AG=AA.themeColor||"#000000",AE=null,AH=AC||1;if(!AB){AB=AA.canvas.getContext("2d");if(!AB){return ;}}AB.save();if(AA.noBackground){}else{if(!AA.isAndroid&&!AA.isTimeSeries){AE=AB.createLinearGradient(0,0,0,AF/2);AB.fillStyle=AG;AB.fillRect(0,0,z,AF);AB.globalAlpha=0.4;AE.addColorStop(0,"#fff");AE.addColorStop(0.1,"#fff");AE.addColorStop(1,AG);AB.fillStyle=AE;AB.rect(0,0,z,AF/2);AB.fill();AB.globalAlpha=0.1;AB.fillStyle="#fff";AB.fillRect(0,0,z,AF/2);}else{if(AA.isTimeSeries){var AD=AA.formatProp;AE=AB.createLinearGradient(0,0,0,AF);AB.globalAlpha=AD.backgroundAlpha;var s=this.rgb2rgbStr(AD.backgroundClr,0.83)||"#2c2c2c";var x=this.rgb2rgbStr(AD.backgroundClr)||"#000000";AE.addColorStop(0,s);AE.addColorStop(1,x);AB.fillStyle=AE;AB.rect(0,0,z,AF);AB.fill();}else{AB.globalAlpha=AH;AB.fillStyle=AG;AB.fillRect(0,0,z,AF);}}}AB.restore();},rgb2rgbStr:function W(t,w){var s="";if(!t||t.length!=3){return s;}if(w||w==0){s="rgba("+t[0]+","+t[1]+","+t[2]+","+w+")";}else{s="rgb("+t[0]+","+t[1]+","+t[2]+")";}return s;},getRGBWithOpacity:function R(t,s,w){if(isNaN(s)){return ;}if(!w){w=[255,255,255];}var x=[];for(color in t){x[color]=parseInt(t[color]*(1-s)+w[color]*s);}return x;},fillMasterChartBackground:function S(AE,w,s,z,AK,AD,AA){var AF=AA||AE.context,AC=z||AE.canvas.width,AI=AK||AE.canvas.height,AJ=AE.themeColor,AH=null;var AG=AE.formatProp;AF.save();AF.globalAlpha=AG.backgroundAlpha;AF.fillStyle=this.rgb2rgbStr(AG.backgroundClr)||"#000000";AF.fillRect(0,0,AC,s);AH=AF.createLinearGradient(0,0,0,AI/2);var t=this.rgb2rgbStr(this.getRGBWithOpacity(AG.backgroundClr,0.45))||"#737373";var AB=this.rgb2rgbStr(this.getRGBWithOpacity(AG.backgroundClr,0.13))||"#222222";AH.addColorStop(0,t);AH.addColorStop(1,AB);AF.fillStyle=AH;AF.fillRect(w,s,AC,AI/2);AF.fillStyle=this.rgb2rgbStr(AG.backgroundClr)||"#000000";AF.fillRect(w,s+AI/2,AC,AI/2+AD);AF.globalAlpha=1;AF.strokeStyle=this.rgb2rgbStr(AE.formatProp.textClr,0.5);AF.lineWidth=1;var x=s+0.5;this.drawLineSet(this,[{x:w,y:x},{x:w+AC,y:x}],false,AF);x=s+AI-0.5;this.drawLineSet(this,[{x:w,y:x},{x:w+AC,y:x}],false,AF);AF.restore();},drawLineSetWithSplit:function(AA,AE,AD,t,AB){var w=AE.length,AC=Math.ceil(w/AB),s,x;for(var z=0;z<AC;z++){s=z*AB;x=Math.min(s+AB+1,w);this.drawLineSet(AA,AE.slice(s,x),AD,t);}},drawLineSet:function M(z,AF,AE,s){var AA=null,w=AF.length,AD=null;if(s){AA=s;}else{AA=z.context;}var AB=null,t=false;AA.beginPath();var x=0;while(x<w){if(AF[x]){AA.moveTo(AF[x].x,AF[x].y);AB=AF[x];t=true;x++;break;}x++;}var AC=false;for(;x<w;x++){AD=AF[x];if(AD){if(!AC){AA.lineTo(AD.x,AD.y);t=false;}else{AA.moveTo(AD.x,AD.y);t=true;AB=AD;AC=false;}}else{if(!AC){AC=true;if(t){AA.arc(AB.x,AB.y,1,0,Math.PI*2,false);}}}}if(AE){AA.closePath();AA.fill();}else{AA.stroke();}},getMinYPosition:function H(t,z,s){var x=z,w;while(x<=s){if(t[x]){w=t[x].y;break;}x++;}for(x=z;x<=s;x++){if(t[x]){w=Math.min(w,t[x].y);}}return w;},drawLineAreaWithSplit:function(AB,AH,s,z,x,AC,t,AD){var w=z-s+1,AF=Math.ceil(w/AD),AG,AE;for(var AA=0;AA<AF;AA++){AG=s+AA*AD;AE=Math.min(AG+AD,s+w-1);this.drawLineArea(AB,AH,AG,AE,x,AC,t);}},drawLineArea:function M(AA,s,AD,z,AC,AH,w){var AG=null,AK=s.length,AF=null,AL=0,AE=0;if(w){AG=w;}else{AG=AA.context;}var x=null,AJ=false;AG.save();AG.lineWidth=0;AG.beginPath();var AN=AD,AB;while(AN<=z){if(s[AN]){AL=s[AN].x;AG.moveTo(AL,AC);x=s[AN];AJ=true;break;}AN++;}AB=AN;var AI=false;for(;AN<=z;AN++){AF=s[AN];if(AF){if(!AI){AG.lineTo(AF.x,AF.y);AJ=false;AE=AF.x;}else{AL=AF.x;AG.moveTo(AL,AC);if(AN+1<=z&&s[AN+1]){AG.lineTo(AF.x,AF.y);}x=AF;AI=false;AB=AN;}}else{if(!AI){AI=true;if(!AJ){AG.lineTo(AE,AC);AG.lineTo(AL,AC);var t=this.getMinYPosition(s,AB,AN)||0;var AM=AG.createLinearGradient(0,t,0,AC);AM.addColorStop(1,this.rgb2rgbStr(AH,0));AM.addColorStop(0,this.rgb2rgbStr(AH,1));AG.fillStyle=AM;AG.globalAlpha=0.8;AG.fill();}}}}if(!AJ){AG.lineTo(AE,AC);AG.lineTo(AL,AC);var t=this.getMinYPosition(s,AB,z)||0;AG.closePath();var AM=AG.createLinearGradient(0,t,0,AC);AM.addColorStop(1,this.rgb2rgbStr(AH,0));AM.addColorStop(0,this.rgb2rgbStr(AH,1));AG.fillStyle=AM;AG.globalAlpha=0.8;AG.fill();}AG.restore();},drawRectangle:function o(AC,s,AE,z,AB,AD,AA){var t=null;if(AA){t=AA;}else{t=AC.context;}if(AD){t.fillRect(s,AE,z,AB);}else{t.strokeRect(s,AE,z,AB);}},drawArc:function Q(z,AE,AD,AB,AC,t,w,AF,s){var AA=null;if(s){AA=s;}else{AA=z.context;}AA.beginPath();AA.arc(AE,AD,AB,AC,t,w);if(AF){AA.fill();}else{AA.stroke();}},drawRoundRect:function K(z,s,AD,t,AA,AB,AC){AB=Math.min(t/2,AA/2,AB);z.beginPath();z.moveTo(s+AB,AD);z.arcTo(s+t,AD,s+t,AD+AA,AB);z.arcTo(s+t,AD+AA,s,AD+AA,AB);z.arcTo(s,AD+AA,s,AD,AB);z.arcTo(s,AD,s+t,AD,AB);z.closePath();if(AC){z.fill();}else{z.stroke();}},drawHalfRoundedRectangle:function q(z,AD,AC,AE,AA,s,AF,t){var AB=null;if(t){AB=t;}else{AB=z.context;}AB.beginPath();AB.moveTo(AD+AE,AC);AB.lineTo(AD+s,AC);AB.arcTo(AD,AC,AD,AC+s,s);AB.lineTo(AD,AC+AA-s);AB.arcTo(AD,AC+AA,AD+s,AC+AA,s);AB.lineTo(AD+AE,AC+AA);if(AF){AB.fill();}else{AB.stroke();}},drawStartEndPoints:function X(AC,AI,w,z){var x=AI.length;var AD=null,t=AC.startEndPointRadius;if(w){AD=w;}else{AD=AC.context;}AD.save();var AF="#f0f43e",AE="#f0f43e",AG="#663300";if(AC.startPointColor){AF=AC.startPointColor;}if(AC.endPointColor){AE=AC.endPointColor;}else{var AH=AI[0].y,AB=AI[x-1].y;if(AH>AB){AE="#008000";}else{if(AH<AB){AE="#8d1616";}else{AE=AF;}}}if(AC.otherPointColor){AG=AC.otherPointColor;}if(z&l&&AI[0]){AD.strokeStyle=AF;AD.fillStyle=AF;this.drawArc(this,AI[0].x,AI[0].y,t,0,Math.PI*2,true,true,AD);}if(z&V&&AI[x-1]){AD.strokeStyle=AE;AD.fillStyle=AE;this.drawArc(this,AI[x-1].x,AI[x-1].y,t,0,Math.PI*2,true,true,AD);}if(z&N){AD.strokeStyle=AG;AD.fillStyle=AG;for(var AA=1;AA<x-1;AA++){if(AI[AA]){this.drawArc(this,AI[AA].x,AI[AA].y,t,0,Math.PI*2,true,true,AD);}}}AD.restore();},getColor:function T(s){return(parseInt(s.themeColor.substr(1),16)>8388607)?"#000000":"#ffffff";},drawHighlightLine:function d(t,AB){var s=t.context,AA=t.margin,z=AA.l,x=t.isTimeSeries?t.chartWidth+AA.l:t.getWidth()-AA.r;s.save();s.globalAlpha=1;s.strokeStyle=this.rgb2rgbStr(t.formatProp.textClr,0.35);s.lineWidth=1;s.lineCap="round";while(z<x){s.beginPath();s.moveTo(z,AB);z+=2;s.lineTo(z,AB);s.stroke();z+=3;}s.restore();},addLabel:function p(AL,AM,AK,AI,t,AE,AF){var AH=document.createElement("div");AH.className="mstrmojo-Chart-lbl";AH.style.color=this.rgb2rgbStr(AL.formatProp.textClr,0.8);AH.innerHTML=AM;if(t){AH.style.width=t+"px";}var AB=null;var AG=0;if(AL.isTimeSeries){if(AF.w>=0){AB=AL.xdiv;AG=AL.animationCanvas.width;}else{AB=AL.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(!AB){AB=document.createElement("div");AB.id="mstrmojo-chart-ylbl-div";AB.className="mstrmojo-chart-ylbl-div";AL.domNode.appendChild(AB);}AB.style.width=AL.margin.l-1+"px";}}else{AB=AL.domNode;AG=AL.getWidth();}AB.appendChild(AH);var AA=AH.offsetWidth||(AL.getTextWidth&&AL.getTextWidthByElem(AM,AH));var AJ=AH.offsetHeight||22*(I||1);var z=t||AA||100;var AD=AL.xLabelPadding/2;var AC=AL.yLabelPadding/2;if(AF.w>=0&&AL.isTimeSeries&&AL._scroller.origin){var AN=AK-AL._scroller.origin.x;if(AN<=0&&(AN+AA/2>-AL.maxYLblWidth)){AL.needRedrawVerticalLine=true;AB.removeChild(AH);return null;}var s=AN-AL.getChartWidthOnScreen();if((s-AA/2)<=0&&s>=0){AL.needRedrawVerticalLine=true;AB.removeChild(AH);return null;}}if(AF.w>=0){AK=AK-z/2;}if(AF.h>=0&&((AI>=AF.y-AC&&AI<=AF.y+AF.h)||(AI+AJ>=AF.y-AC&&AI+AJ<=AF.y+AF.h)||(AI+AJ>=AL.canvas.height-AL.margin.b))){AB.removeChild(AH);return null;}if(AF.w>=0&&(((AK>=AF.x&&AK<AF.x+AF.w+AD))||AK<AF.x||AK<AL.margin.l||AK+z>AG)){AB.removeChild(AH);return null;}if(AL.isTimeSeries&&AF.h>=0){AB.style.top=(AL.margin.t-AJ/2)+"px";AB.style.height=(AL.canvas.height-AL.margin.t-AL.margin.b-1+AJ/2)+"px";this.translateCSS(AK,(AI-AL.margin.t)+AJ/2,AE,AH);}else{this.translateCSS(AK,AI,AE,AH);AH.style.maxHeight=AJ+"px";}AF.x=AK;AF.y=AI;if(AF.h>=0){AF.h=AJ;}if(AF.w>=0){AF.w=z;AH.style.textAlign="center";}return AH;},addDataLabel:function p(t,z,AB,x){var s=(t.margin.l>t.margin.r)?Y:t.getWidth()-t.margin.r+Y,AA=(t.margin.l>t.margin.r)?t.margin.l:t.margin.r;return this.addLabel(t,z,s,AB-10,AA-Y*2,false,x);},translateCSS:function g(s,AA,t,z){var w="translate("+s+"px,"+AA+"px)";if(t){w+=" rotate(45deg)";}z.style[J.CSS3_TRANSFORM]=w;},getTouchXYOnWidget:function B(t,s,z){var x=mstrmojo.TouchScroller,w=(x&&z.parent&&x.getScrollPositionTotals(z.parent))||{x:0,y:0};t=t-z.offsetLeft+w.x;s=s-z.offsetTop+w.y;return{touchX:t,touchY:s};},getYValue:function A(z,t){var s=z.canvas.height,x=z.margin,w=z.model.mvalues;return s-x.b-4-((parseFloat(t)-w[0])*z.RTY);},getMasterYValue:function f(x,t,z){var s=x.masterCanvas.height,w=x.model.mvalues;return s-z.b-3-((parseFloat(t)-w[0])*x.MRTY);},getSeriesIndexAndYValue:function C(AE,t,AF){var AG=AE.model.series,AA=AG.length,AC=0;y=this.getYValue(AE,AG[AC].rv[t])||0;var AD=AF-y<0?-(AF-y):AF-y,x=AD;for(var AB=1;AB<AA;AB++){var z=this.getYValue(AE,AG[AB].rv[t])||0;AD=AF-z<0?-(AF-z):AF-z;if(AD<x){y=z;x=AD;AC=AB;}}return{y:y,si:AC};},getLabelWidthForMargin:function j(s,z){var x=document.createElement("div");x.className="mstrmojo-Chart-lbl";x.innerHTML=z;s.domNode.appendChild(x);var t=x.offsetWidth||60;s.domNode.removeChild(x);return t+Y*2;},animateLineSet:function U(AG,z,AE,AC){var AH=[],AF=AG.animationContext,AA=AE.length;AF.clearRect(0,0,AG.getWidth(),AG.canvas.height);if(!AC.index){AC.index=0;}else{if(AC.index>=AC.rate){this.drawLineSet(AG,AE,false,AF);AG.drawLabels();if(AG.isFillLinesArea){this.fillLinesArea(AG,AE.slice(0));}if(AG.isDrawStartEndPoints){this.drawStartEndPoints(AG,AE,AF,AG.isDrawStartEndPoints);}return ;}}for(var AB=0;AB<AA;AB++){var t=AE[AB],s=z[AB];AH[AB]={x:(AC.index*(t.x-s.x)/AC.rate)+s.x,y:(AC.index*(t.y-s.y)/AC.rate)+s.y};}this.drawLineSet(AG,AH,false,AF);var AD=this;AC.index++;window.setTimeout(function(){AD.animateLineSet(AG,z,AE,AC);},40);},fillLinesArea:function G(t,AA){var x=t.canvas.height;AA.push({x:t.getWidth()-t.margin.r,y:x-t.margin.b});AA.push({x:t.margin.l,y:x-t.margin.b});var AB=new Array();if(t.fillinColor){mstrmojo.requiresCls("mstrmojo.color");var z=mstrmojo.color.hex2rgb(t.fillinColor).join(",");AB[0]="rgba("+z+", 0.8)";AB[1]="rgba("+z+", 0.2)";}else{AB=["rgba(255,128,0,0.8)","rgba(255,128,0,0.2)"];}var s=t.animationContext;var z=s.createLinearGradient(0,0,0,x);z.addColorStop(0,AB[0]);z.addColorStop(0.75,AB[1]);s.fillStyle=z;this.drawLineSet(t,AA,true,s);},convertRawValueToMilliseconds:function h(w){var x=Number(w),s=x-((new Date("1/1/1970").getTime()-new Date("12/30/1899").getTime())/F)-k,t=new Date(s*F);return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()).getTime();},getAncestorBgColor:function D(w){var AC=null,AB=w,x=AB.model,AF=null;if(AB.hasOwnProperty("xtabModel")&&AB.xtabModel.hasOwnProperty("docModel")){AF=AB.xtabModel.docModel;}if(AF&&AF.defn&&AF.defn.layouts&&AF.defn.layouts.length>0){var AE=AF.defn.layouts,z;var t;for(t in AE){if(AE[t].loaded){z=AE[t];}}if(z&&z.hasOwnProperty("units")){var AA=z.units;var AD=x.parent;while(AD){var s=AD.k||null;if(AA[s]&&AA[s].fmts&&AA[s].fmts["background-color"]){AC=AA[s].fmts["background-color"];break;}else{AD=AD.parent||null;}}if(!AC){if(z.fmts&&z.fmts["background-color"]){AC=z.fmts["background-color"];}}}}return AC;},getPointDistanceSquare:function E(t,s){return(t.x-s.x)*(t.x-s.x)+(t.y-s.y)*(t.y-s.y);},truncateTextToLine:function(t,AG,AK){AG.className=t.className;AG.style.whiteSpace="nowrap";var AB=AG.innerHTML=t.innerHTML;var x=parseInt(t.offsetWidth)-parseInt(t.style.width);var AI=AK*parseInt(t.style.width)+x;var z=AB;if(AG.offsetWidth>AI){var AC=0,w=AB.length-1;while(AC<=w){var AF=Math.round((AC+w)/2);var AJ=AB.substr(0,AF+1);var AH=AB.substr(0,AF+2);AG.innerHTML=AJ;var AE=AG.offsetWidth;AG.innerHTML=AH;var AA=AG.offsetWidth;if(AE<=AI&&AA>AI){break;}else{if(AE>AI){w=AF-1;}else{if(AA<=AI){AC=AF+1;}}}}z=AB.substr(0,AF+1);if(z.length<AB.length){if(z.charAt(z.length-1)===" "){z=z.substr(0,z.length-1);}var AD=z.lastIndexOf(" ");var s=z.length-1-AD;if(s>=2&&s<=8){z=z.substr(0,z.length-s-1)+"...";}else{z=z.substr(0,z.length-3)+"...";}}}t.innerHTML=z;},getLen:function(x,w,t,s){w.innerHTML=x;var z=w.offsetWidth+t-s;return z;},splitWordIfTooLong:function(z,AJ,AG,AC,AE){var AI=z.split(" ");var AD=[];var AF=AI.length;var AA=0;var x=0;for(AA=0;AA<AF;AA++){var t=AI[AA];while(true){var AK=this.getLen(t,AJ,AE,AC);if(AK>AG){var AH=(AG/AK)*t.length;var s=Math.round(AH);while(s>0){var AB=t.substr(0,s);var w=this.getLen(AB,AJ,AE,AC);if(w<=AG){AD.push(AB);break;}else{s--;}}t=t.substr(s,t.length-s);}else{AD.push(t);break;}}}return AD.join(" ");},truncateTextToLineWithWordWrap:function(AT,AP,AM){AP.className=AT.className;AP.style.whiteSpace="nowrap";var AL=7;var AD=-1;if(AT.style&&AT.style.width&&AT.style.width.length>0){AD=parseFloat(AT.style.width);}if(AD<0){AD=parseFloat(mstrmojo.css.getComputedStyle(AT).width);}var AN=AT.innerHTML;var AS=parseFloat(AT.offsetWidth)-AD;AN=this.splitWordIfTooLong(AN,AP,AD,AS,AL);var AF=AN.split(" ");var z=[];var AI=[];var AR=0;var s=0;var AK=AF.length;AP.innerHTML="&nbsp;";var AU=AP.offsetWidth-AS;AI.push(0);for(AR=0;AR<AK;AR++){var t=this.getLen(AF[AR],AP,AL,AS);if(t>AD){var AE=AF[AR];var AQ=(AD/t)*AE.length;AF[AR]=AE.substr(0,parseInt(AQ));t=AD;}z.push(t);s+=t;AI.push(s);if(AR!==AK-1){s+=AU;}}var AH=0,AO=0;var AG=AM;for(;AO<AI.length;){var AC=AI[AO]-AI[AH];if(AH>0&&AO!=AH){AC-=AU;}var AB=AI[AO+1]-AI[AH];if(AH>0&&AO+1!=AH){AB-=AU;}if(AC<=AD&&((AO+1==AI.length)||(AB>AD))){AG--;if(AG==0||AO===AK){break;}else{AH=AO;AO++;}}else{AO++;}}if(AO>AK){AO=AK;}var AJ=AI[AO]-AI[AH];if(AH>0&&AO!=AH){AJ-=AU;}var AV;if(AO>=AK&&AJ<AD){AV=AF.join(" ");}else{AV=AF.slice(0,AO).join(" ");var x=this.getLen("...",AP,AL,AS);if(AJ+x<=AD){AV+="...";}else{if(AV.charAt(AV.length-1)===" "){AV=AV.substr(0,AV.length-1);}var AA=AV.lastIndexOf(" ");var w=AV.length-1-AA;if(w===3){AV=AV.substr(0,AV.length-3)+" ...";}else{AV=AV.substr(0,AV.length-3)+"...";}}}AT.innerHTML=AV;},getLen2:function(AB,t,s){var w=s;var x=w.getContext("2d");x.font=t;x.textAlign="center";x.fillStyle="blue";var AA=x.measureText(AB);var z=AA.width;return z;},splitWordIfTooLong2:function(AA,AG,z,AB){var AI=AA.split(" ");var AE=[];var AF=AI.length;var AC=0;var x=0;for(AC=0;AC<AF;AC++){var t=AI[AC];while(true){var AJ=this.getLen2(t,z,AB);if(AJ>AG){var AH=(AG/AJ)*t.length;var s=Math.max(Math.round(AH),1);while(s>0){var AD=t.substr(0,s);var w=this.getLen2(AD,z,AB);if(w<=AG||s==1){AE.push(AD);break;}else{s--;}}t=t.substr(s,t.length-s);}else{AE.push(t);break;}}}return AE.join(" ");},getComputedFontStyle:function P(s){var t=s.fontStyle+" "+s.fontWeight+" "+s.fontSize+"/"+s.fontVariant+" "+s.fontFamily;return t;},truncateTextToLineWithWordWrap2:function(AW,AG,AO){var AF=-1;if(AW.style&&AW.style.width&&AW.style.width.length>0){var AT=0;var AV=mstrmojo.css.getComputedStyle(AW);if(AV.paddingLeft){AT+=parseFloat(AV.paddingLeft);}if(AV.paddingRight){AT+=parseFloat(AV.paddingRight);}var AU=AW.offsetWidth;AF=AU?AU-AT:parseInt(AW.style.width);}if(AF<0){AW.innerHTML="...";return ;}var AP=AW.innerHTML;var AC=mstrmojo.css.getComputedStyle(AW);var w=this.getComputedFontStyle(AC);AP=this.splitWordIfTooLong2(AP,AF,w,AG);var AI=AP.split(" ");var AA=[];var AL=[];var AS=0;var s=0;var AN=AI.length;var AX=this.getLen2(" ",w,AG);AL.push(0);for(AS=0;AS<AN;AS++){var t=this.getLen2(AI[AS],w,AG);if(t>AF){var AH=AI[AS];var AR=(AF/t)*AH.length;AI[AS]=AH.substr(0,parseInt(AR));t=AF;}AA.push(t);s+=t;AL.push(s);if(AS!==AN-1){s+=AX;}}var AK=0,AQ=0;var AJ=AO;for(;AQ<AL.length;){var AE=AL[AQ]-AL[AK];if(AK>0&&AQ!=AK){AE-=AX;}var AD=AL[AQ+1]-AL[AK];if(AK>0&&AQ+1!=AK){AD-=AX;}if(AE<=AF&&((AQ+1==AL.length)||(AD>AF))){AJ--;if(AJ==0||AQ===AN){break;}else{AK=AQ;AQ++;}}else{AQ++;}}if(AQ>AN){AQ=AN;}var AM=AL[AQ]-AL[AK];if(AK>0&&AQ!=AK){AM-=AX;}var AY;if(AQ>=AN&&AM<AF){AY=AI.join(" ");}else{AY=AI.slice(0,AQ).join(" ");var z=this.getLen2("...",w,AG);if(AM+z<=AF){AY+="...";}else{if(AY.charAt(AY.length-1)===" "){AY=AY.substr(0,AY.length-1);}var AB=AY.lastIndexOf(" ");var x=AY.length-1-AB;if(x===3){AY=AY.substr(0,AY.length-3)+" ...";}else{AY=AY.substr(0,AY.length-3)+"...";}}}AW.innerHTML=AY;return AY.indexOf("...")>-1;},truncateDivContent:function(AA,AE,w){AE.innerHTML=AA;if(AE.offsetHeight>w){var AB=0,t=AA.length-1;while(AB<=t){var AF=Math.round((AB+t)/2);var AH=AA.substr(0,AF+1);var AG=AA.substr(0,AF+2);AE.innerHTML=AH;var AD=AE.offsetHeight;AE.innerHTML=AG;var z=AE.offsetHeight;if(AD<=w&&z>w){break;}else{if(AD>w){t=AF-1;}else{if(z<=w){AB=AF+1;}}}}var x=AA.substr(0,AF+1);if(x.length<AA.length){if(x.charAt(x.length-1)===" "){x=x.substr(0,x.length-1);}var AC=x.lastIndexOf(" ");var s=x.length-1-AC;if(s>=2&&s<=8){x=x.substr(0,x.length-s-1)+"...";}else{x=x.substr(0,x.length-3)+"...";}}return x;}else{return AA;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var B="mstrmojo-floating-toolbar-lightbox";var G="mstrmojo-floating-toolbar";var M="mstrmojo-floating-toolbar-cell";var I="mstrmojo-fixed-toolbar-lightbox";var A="mstrmojo-fixed-toolbar";var N="mstrmojo-fixed-toolbar-cell";var H=" hasToolBar";var E="mstrmojo-Button mstrmojo-InteractiveButton mstrmojo-oivmSprite ";var D="mstrmojo-Button-text";var L=27;mstrmojo._HasToolbar={_mixinName:"mstrmojo._HasToolbar",postBuildRendering:function C(){this._super();var O=this.getToolbarCfg();if(!O||this.defn.ttl){return ;}var S=this.containerNode;if(S){var Q=this._createToolbar(G,M);Q.className=B;S.className+=H;S.insertBefore(Q,S.firstChild);var P=this.domNode,R=mstrmojo.boxmodel.offset(P,this.parent&&this.parent.domNode);if(R.top<L){Q.style.top=(L-R.top)+"px";}}},_createToolbar:function F(V,Z){var S=this.getToolbarCfg(),Y=this,W=document,P=W.createElement("div"),U=W.createElement("table"),X=W.createElement("tr"),R=W.createElement("td");P.appendChild(U);U.className=V;R.className=Z;X.appendChild(R);U.appendChild(X);for(var T in S){var O=W.createElement("div");O.className=E+S[T].css[0];var Q=W.createElement("div");Q.className=D;Q.nodeValue="&nbsp;";Q.setAttribute("ix",T);Q.setAttribute("cix",0);O.appendChild(Q);R.appendChild(O);O.onclick=function(a){Y.onClick(a);};}return P;},renderToolbar:function K(Q){if(!this.getToolbarCfg()){return ;}var P=Q.firstChild,O=this._createToolbar(A,N);O.className=I;if(P){Q.insertBefore(O,P);}else{Q.appendChild(O);}},onClick:function J(U,P){var V=mstrmojo.dom,O=V.eventTarget(P,U),S=O.getAttribute("cix"),R=O.getAttribute("ix");var Q=this.toolbarCfg[R],T=Q.callback;if(T&&this[T]&&this[T]()){S=++S%Q.css.length;O.parentNode.className=E+Q.css[S];O.setAttribute("cix",S);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.storage.DOMStorage");var A=4;mstrmojo.storage.DOMLocalStorage=mstrmojo.declare(mstrmojo.storage.DOMStorage,null,{scriptClass:"mstrmojo.storage.DOMLocalStorage",init:function(B){this._super(B);try{this.mIsSupported=("localStorage" in window)&&(window.localStorage!==null);this.mStorageObj=this.mIsSupported?window.localStorage:null;this.checkVersion(A);}catch(C){this.mIsSupported=false;}}});$LS=mstrmojo.global.localStore=new mstrmojo.storage.DOMLocalStorage({itemTimeToLive:(3600*24)});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.DICFactory");var L=3,R=2,T=2,P=mstrmojo.css,A="********",O=mstrmojo.hash;var H=null;function F(X,W){if(X){var U=this.dicWidget;if(U&&U.setDirtyFlag){U.setDirtyFlag(X,W);}else{if(X.className!=="flag-container"){var V=document.createElement("div");V.className="flag-container";V.style.right="10px";V.innerHTML='<div class="dirty-cell"/>';W.insertBefore(V,X);}}}}mstrmojo._IsEditableTextfield={_mixinName:"mstrmojo._IsEditableTextfield",preBuildRendering:function Q(){if(!this.edb){var W=this.node.data,U=this.node.defn,V=W.dic||U.txi.dic,X=(this.rv==="")?this.value:this.rv;if(V.psw){this.v=A;X=this.rv="";}if(V.ipt===T){V.vls=this.vls||[];this.dk=V.k;}this.req=V.req;this.dt=V.dt;this.dicWidget=mstrmojo.DICFactory.createDIC({dic:V,owner:this,k:0,dv:this.value,value:X,openerType:R,popupTitle:U.n});if(this.shouldReplaceValueNode()){if(!H){H=O.clone(this.formatHandlers);}this.formatHandlers.domNode=["T","z-index","D","B","F","P","text-align","background-color","fx","white-space","overflow"];delete this.formatHandlers.valueNode;}}this.set("cssClass",this.edb?"":"editable-field");this._super();},shouldReplaceValueNode:function N(){return this.dicWidget.showByDefault||this.dicWidget.hasPreview;},postBuildRendering:function J(){this._super();if(this.edb){return ;}var U=this.dicWidget,W=this.valueNode.innerHTML;if(mstrmojo.string.isEmpty(W)){this.valueNode.innerHTML=W+"1";this.valueNode.style.height=this.valueNode.clientHeight+"px";this.valueNode.innerHTML=W;}if(U.showByDefault){U.render();}else{if(U.hasPreview){U.openerNode=this.domNode;U.renderPreview(this.value);}else{U.openerNode=this.valueNode;}mstrmojo.dom.attachEvent(U.openerNode,mstrApp.isMobile?mstrmojo.dom.TOUCHEND:"click",function(){U.showInPopup();});}if(this.shouldReplaceValueNode()){O.copy(H,this.formatHandlers);}this.registerTxWidget();this.addToTraversalList();if(this.mdf&&this.sci){var V=this.domNode;F.call(this,V.firstChild,V);}},getKeyContext:function D(){return{dt:this.dt||0,k:this.dk||undefined};},getUpdates:function C(){var V=this.getUpdatedValues()[0],U=V.k?('rw_control_key="'+V.k+'" element_id="'+this.vls[mstrmojo.array.find(this.vls,"v",V.v)].eid+'" '):"";return'<rwf rw_tree_type="'+this.tt+'" rw_node_key="'+this.fgk+'" rw_field_key="'+this.k+'" key="'+this.key+'" columns="'+this.cls+'" types="'+L+'" '+U+'value="'+mstrmojo.string.encodeXMLAttribute(String(V.v))+'" dt="'+V.dt+'" />';},updateValue:function K(U,X){if(this._super){this._super(U,X);}var Z=this.valueNode,a=this.domNode,V=this.dicWidget,W=X.v,Y=X.dv;if(this.rv!==W){if(this.req){P.removeClass(a,"required");}this.rv=W;this.v=Y;this.mdf=1;if(!V.showByDefault){if(V.hasPreview){V.renderPreview();}else{Z[Z.innerText!==undefined?"innerText":"textContent"]=this.psw?A:Y;}}if(this.req){P.removeClass(a,"required");}if(this.sci){F.call(this,a.firstChild,a);}}return false;},applyPasswordMask:function M(){this.psw=true;this.v=A;this.rv="";},getUpdateObject:function G(){var V={fieldKey:this.k,wid:this.wid,newValue:mstrmojo.string.encodeXMLAttribute(String(this.rv)),dataType:this.dt},U=this.getUpdatedValues()[0];if(U.k!==undefined){V.controlKey=U.k;V.elementId=this.vls[mstrmojo.array.find(this.vls,"v",U.v)].eid;}return{nodeKey:this.fgk,cells:[V],retrieveData:false,autoRefresh:false};},update:function I(U){if(this._super){this._super(U);}var W=U.data,V=U.defn;if(W.vls){this.vls=W.vls;}else{delete this.vls;}this.cell=U.data;this.value=W.v||"";this.rv=(W.rv===undefined)?this.value:W.rv;this.tca=W.tca||0;this.dt=W.dt;this.key=W.key||"";this.cls=W.cls||"";this.wid=W.wid;this.edb=W.edb;this.mdf=W.mdf;this.req=W.req;this.sci=V.txi.sci;this.tt=V.tt;this.fgk=V.fgk;},addToTraversalList:function S(){if(mstrmojo.DICConfig.isKeyNavigable(this.dicWidget.dic)){var U=this.parent.traversalList,V=this.domNode;if(!U){U=this.parent.traversalList=[];}U.push({x:V.offsetLeft,y:V.offsetTop,h:V.offsetHeight,refField:this});}},editNext:function E(){var Z=this.parent.traversalList,X,U,W,Y=0;if(!Z){return false;}if(!Z.isSorted){for(X=0,U=Z.length;X<U;X++){Y+=Z[X].h;}W=Y/U;Z.sort(function(g,d){var h=Math.floor(g.y/W),f=Math.floor(d.y/W);if(h<f){return -1;}if(h>f){return 1;}if(g.x<d.x){return -1;}if(g.x>d.x){return 1;}return(g.y<d.y)?-1:1;});Z.isSorted=true;}for(X=0,U=Z.length;X<U;X++){if(Z[X].refField.k===this.k){break;}}if(X<U){do{X++;if(X>=U){X%=U;}if(X===parseInt(this.k,10)){return false;}var V=Z[X].refField.dicWidget;if(V){if(!V.showByDefault){V.showInPopup();}else{V.focus();}return true;}}while(true);}},checkRequiredObjects:function B(){if(this.req&&!this.mdf&&!this.edb){P.addClass(this.domNode,"required");return false;}return true;}};}());(function(){mstrmojo.requiresCls("mstrmojo.locales");var V=function(){return mstrmojo.locales.datetime;},J=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},isDate:function W(Z,f,Y){var b=this.parseDate(Z,Y);var d=!!(b&&this.doesDateExist(b.month,b.day,b.year));if(f){if(d){var a=this.formatDateInfo(b,V().DATEOUTPUTFORMAT);if(Y){return{match:b.match,formatted:a};}else{return a;}}else{return null;}}else{return !!d;}},formatDateInfo:function P(b,f){if(!f){return"";}var Y=b.day,d=b.month,a=b.year;var Z=f.replace(/dd/g,this.formatInteger(Y,2)).replace(/d/g,Number(Y)).replace(/yyyy/g,Number(a)).replace(/yy/g,this.formatInteger(Number(a)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,V().MONTHNAME_FULL[Number(d)-1]).replace(/\~\~\~\~/g,V().MONTHNAME_SHORT[Number(d)-1]).replace(/\@\@/g,this.formatInteger(d,2)).replace(/\^/g,Number(b.month));return Z;},parseDate:function X(l,f,j){if(l==null){return false;}if(typeof (l)!="string"){l=String(l);}l=J.trim(l);var Y=this.CACHE.PARSEDATE[f?"CONTAINS":"EQUALS"],a=Y[l];if(a||(a===null)){return a;}var Z=null;var h;if(j){h=[j];}else{h=[].concat(V().DATEINPUTFORMATS);h.unshift(V().DATEOUTPUTFORMAT);}for(var b=0,d=h.length;b<d;b++){var g=this._buildRegExp4DateFormat(h[b]),k=g&&l.match(f?g.reContains:g.reEquals);if(k){Z={match:k[0],year:g.yearIndex&&this.fourDigitYear(k[g.yearIndex]),day:g.dayIndex&&parseInt(Number(k[g.dayIndex])),month:g.monthIndex&&this.numericMonth(k[g.monthIndex])};break;}}Y[l]=Z;return Z;},isTime:function H(Z,d,Y){var f=this.parseTime(Z,Y);var b=!!(f&&this.doesTimeExist(f.hour,f.min,f.sec));if(d){if(b){var a=this.formatTimeInfo(f,V().TIMEOUTPUTFORMAT);if(Y){return{match:f.match,formatted:a};}else{return a;}}else{return null;}}else{return !!b;}},parseTime:function I(o,f,k){if(o==null){return false;}if(typeof (o)!="string"){o=String(o);}o=J.trim(o);var Y=this.CACHE.PARSETIME[f?"CONTAINS":"EQUALS"],a=Y[o];if(a||(a===null)){return a;}var Z=null;var j;if(k){j=[k];}else{j=[].concat(V().TIMEINPUTFORMATS);j.unshift(V().TIMEOUTPUTFORMAT);}for(var b=0,d=j.length;b<d;b++){var h=this._buildRegExp4TimeFormat(j[b]),l=h&&o.match(f?h.reContains:h.reEquals);if(l){var g=h.ampmIndex&&l[h.ampmIndex];Z={match:l[0],hour:h.hourIndex&&this.capitalHour(l[h.hourIndex],g),min:h.minIndex&&parseInt(Number(l[h.minIndex])),sec:h.secIndex&&parseInt(Number(l[h.secIndex]))};break;}}Y[o]=Z;return Z;},formatTimeInfo:function Q(b,Z){if(!Z){return"";}var a=!(Number(b.hour)%12)?12:(Number(b.hour)%12),Y=Z.replace(/HH/g,this.formatInteger(b.hour,2)).replace(/H/g,Number(b.hour)).replace(/hh/g,this.formatInteger(a,2)).replace(/h/g,a).replace(/mm/g,this.formatInteger(Number(b.min)||0,2)).replace(/m/g,Number(b.min)||0).replace(/ss/g,this.formatInteger(Number(b.sec)||0,2)).replace(/s/g,Number(b.sec)||0).replace(/a/g,(Number(b.hour)<12)?V().AM_NAME:V().PM_NAME);return Y;},doesTimeExist:function F(f,Z,d){var b=parseInt(f);if(b>=0&&b<=23){var Y=parseInt(Z);if(Y>=0&&Y<=59){if(!d){return true;}var a=parseInt(d);if(a>=0&&a<=59){return true;}}}return false;},capitalHour:function C(Y,Z){Y=parseInt(Number(Y));if(Z&&(Z.match(V().AM_NAME)||Z.match(/AM/i))){return Y%12;}else{if(Z&&(Z.match(V().PM_NAME)||Z.match(/PM/i))){return 12+(Y%12);}else{return Y;}}},isDateAndOrTime:function T(Y,Z){return this.isDateTime(Y,Z)||this.isDate(Y,Z)||this.isTime(Y,Z);},isDateTime:function B(k,Y){var d=this.parseDateAndOrTime(k),h=d&&d.date,b=d&&d.time,g=!!h&&!!b&&this.doesDateExist(h.month,h.day,h.year)&&this.doesTimeExist(b.hour,b.min,b.sec);if(Y){if(g){var Z=this.formatDateInfo(h,V().DATEOUTPUTFORMAT),a=this.formatTimeInfo(b,V().TIMEOUTPUTFORMAT),j=k.indexOf(h.match),f=k.indexOf(b.match);return(f<j)?a+" "+Z:Z+" "+a;}else{return null;}}else{return !!g;}},parseDateAndOrTime:function O(Z,Y,f){var a=this.parseDate(Z,true,Y);var b=J.trim((a&&a.match)?Z.replace(a.match,""):Z),d=this.parseTime(b,false,f);if(!a&&!d){return null;}else{return{date:a,time:d};}},inDateTimeRange:function N(a,d,h){var Z=this.parseDateAndOrTime(a),f=Z&&Z.date,j=Z&&Z.time;if(!f&&!j){return 0;}if(d!=null){var b=this.parseDateAndOrTime(d);if(f&&b&&b.date){var k=this.compareDate(f,b.date);if(k<0){return -1;}else{if(k==0){if(j&&b.time&&(this.compareTime(j,b.time)<0)){return -1;}}}}}if(h!=null){var Y=this.parseDateAndOrTime(h);if(f&&Y&&Y.date){var g=this.compareDate(f,Y.date);if(g>0){return 1;}else{if(g==0){if(j&&Y.time&&(this.compareTime(j,Y.time)>0)){return 1;}}}}}return 0;},compareDate:function A(a,Y){if(a==Y){return 0;}var b=typeof (a)=="string"?this.parseDate(a):a,Z=typeof (Y)=="string"?this.parseDate(Y):Y;if(!b){return -1;}if(!Z){return 1;}return(b.year-Z.year)||(b.month-Z.month)||(b.day-Z.day)||0;},compareTime:function K(Z,Y){if(Z==Y){return 0;}var b=typeof (Z)=="string"?this.parseTime(Z):Z,a=typeof (Y)=="string"?this.parseTime(Y):Y;if(!b){return -1;}if(!a){return 1;}return(b.hour-a.hour)||(b.min-a.min)||(b.sec-a.sec)||0;},compareDateTime:function S(Z,Y){return this.compareDate(Z,Y)||this.compareTime(Z,Y);},compareDateAndOrTime:function D(h,f){if(h==f){return 0;}var Z=typeof (h)=="string"?this.parseDateAndOrTime(h):h,Y=typeof (f)=="string"?this.parseDateAndOrTime(f):f;if(!Z){return -1;}if(!Y){return 1;}var g=Z.date,d=Y.date,b=Z.time,a=Y.time;return this.compareDate(g,d)||this.compareTime(b,a);},_buildRegExp4DateFormat:function M(a){if(!a){return null;}var d=this.REGEXPS.DATES[a];if(!d){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=V().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=V().MONTHNAME_SHORT.join("|");}d=this.REGEXPS.DATES[a]={};d.formatStr=a;var Z=d.reStr=a.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");d.reEquals=new RegExp("^"+Z+"$");d.reContains=new RegExp("^"+Z+"\\b");var f=[{key:"monthIndex",index:a.indexOf("M")},{key:"dayIndex",index:a.indexOf("d")},{key:"yearIndex",index:a.indexOf("y")}];f.sort(function(h,g){return h.index-g.index;});var Y=1;for(var b=0;b<3;b++){d[f[b].key]=f[b].index>-1?Y++:null;}}return d;},_buildRegExp4TimeFormat:function E(b){if(!b){return null;}var f=this.REGEXPS.TIMES[b];if(!f){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[V().AM_NAME,V().PM_NAME,String(V().AM_NAME).toLowerCase(),String(V().PM_NAME).toLowerCase()].join("|");}f=this.REGEXPS.TIMES[b]={};f.formatStr=b;var a=b.replace(/\'\'/g,'"');var g=a.match(/\'(.+?)\'/g);a.replace(/\'(.+?)\'/g,"*");a=a.replace(/([^H|h|m|s|z|Z|a|\s])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/gi,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");for(var d=1,Y=g&&g.length||0;d<Y;d++){a=a.replace(/\*/,g[d]);}a=a.replace(/\"/g,"'");f.reEquals=new RegExp("^"+a+"$");f.reContains=new RegExp(a);var h=[{key:"hourIndex",index:b.search(/h|H/)},{key:"minIndex",index:b.indexOf("m")},{key:"secIndex",index:b.indexOf("s")},{key:"ampmIndex",index:b.indexOf("a")},{key:"zoneIndex",index:b.search(/z|Z/)}];h.sort(function(k,j){return k.index-j.index;});var Z=1;for(var d=0;d<5;d++){f[h[d].key]=h[d].index>-1?Z++:null;}}return f;},doesDateExist:function L(b,Y,Z){var a=new Date(Z,b-1,Y);return Z==a.getFullYear()&&b==a.getMonth()+1&&Y==a.getDate();},fourDigitYear:function R(Z){Z=parseInt(Number(Z));if(!isNaN(Z)){var Y=(V().TWODIGITYEARSTART%100)||0;if(Z>=0&&Z<=Y){Z=2000+Z;}else{if(Z>Y&&Z<100){Z=1900+Z;}}}return Z;},numericMonth:function U(d){var b=parseInt(Number(d)),a=mstrmojo.array;if(!isNaN(b)){return b;}var Y=d&&d.length||0,Z=-1;if(Y){if(Y<=3){Z=a.indexOf(V().MONTHNAME_SHORT,d);}if(Z==-1){Z=a.indexOf(V().MONTHNAME_FULL,d);}}return Z+1;},formatInteger:function G(a,Z){var f=String(a),d=Math.max(Z-f.length,0);if(d>0){var Y=[f];for(var b=1;b<=d;b++){Y.push("0");}f=Y.reverse().join("");}return f;},getFirstDateOfMonth:function(Z,Y){return new Date(Z,Y-1,1);},getDateObject:function(g,Y,f,a,b,Z){g=g||0;Y=Y||1;f=f||1;a=a||0;b=b||0;Z=Z||0;return new Date(g,Y-1,f,a,b,Z);},getDateFromDateInfo:function(Y){return this.getDateObject(Y.date&&Y.date.year,Y.date&&Y.date.month,Y.date&&Y.date.day,Y.time&&Y.time.hour,Y.time&&Y.time.min,Y.time&&Y.time.sec);},getDateJson:function(Y){return{year:Y.getFullYear(),month:Y.getMonth()+1,day:Y.getDate(),hour:Y.getHours(),min:Y.getMinutes(),sec:Y.getSeconds()};},isLeapYear:function(Y){return !(Y%400)||(!(Y%4)&&!!(Y%100));},getDaysOfMonth:function(a,Y){var Z=[31,28,31,30,31,30,31,31,30,31,30,31];if(Y==2&&this.isLeapYear(a)){return 29;}return Z[Y-1];},getPreMonth:function(Z,Y){if(Y===1){return{y:Z-1,m:12};}return{y:Z,m:Y-1};},getNextMonth:function(Z,Y){if(Y===12){return{y:Z+1,m:1};}return{y:Z,m:Y+1};}});})();(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string");var K=mstrmojo.locales,D=mstrmojo.string,M=window.mstrConfig,E=function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},F=function(){return mstrmojo.locales.number.DECIMALSEPARATOR;},I=M.units,L={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},C={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var N=96;String.prototype.reverse=function(){var P="";for(var O=this.length;O>0;--O){P+=this.charAt(O-1);}return P;};mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function G(O){var R=E(),Q=new RegExp("^(-)?[0-9]{1,3}(\\"+R+"[0-9]{3})*$"),P=new RegExp("^(-)?[0-9]+$");return(String(O).indexOf(R)&&Q.test(O))||P.test(O);},isNumeric:function A(R,S){var Q=F(),T=E(),P=new RegExp("^(-)?[0-9]{1,3}(\\"+T+"[0-9]{3})*(\\"+Q+"[0-9]+)?$"),O=new RegExp("^(-)?[0-9]*(\\"+Q+")?[0-9]+$");return(String(R).indexOf(T)&&P.test(R))||O.test(R);},parseInteger:function B(O,P){if(!this.isInt(O)){return Number.NaN;}return parseInt(String(O).replace(E(),""),P);},parseNumeric:function J(O){if(!this.isNumeric(O)){return Number.NaN;}return parseFloat(String(O).replace(E(),"").replace(F(),"."));},inNumericRange:function H(P,Q,O){P=this.parseNumeric(P);O=(O!=null)?this.parseNumeric(String(O)):Number.NaN;Q=(Q!=null)?this.parseNumeric(String(Q)):Number.NaN;if(O!=Number.NaN&&(P>O||isNaN(P))){return 1;}if(Q!=Number.NaN&&(P<Q||isNaN(P))){return -1;}return 0;},convertToUSUnits:function(R,Q,P){var O=R;Q=Q||I;switch(parseInt(Q,10)){case L.CM:O=parseFloat(this.toString(R))/2.54+"";break;case L.MM:O=parseFloat(this.toString(R))/25.4+"";break;case L.PT:O=parseFloat(this.toString(R))/72+"";break;case L.PC:O=parseFloat(this.toString(R))/6+"";break;case L.PX:O=parseFloat(this.toString(R))/N+"";break;}return P?O:this.toLocaleString(O);},convertToLocalUnits:function(R,Q,P){var O;Q=Q||I;switch(parseInt(Q,10)){case L.CM:O=(parseFloat(this.toString(R))*2.54).toFixed(4)+"";break;case L.MM:O=(parseFloat(this.toString(R))*25.4).toFixed(4)+"";break;case L.PT:O=(parseFloat(this.toString(R))*72).toFixed(4)+"";break;case L.PC:O=(parseFloat(this.toString(R))*6).toFixed(4)+"";break;case L.PX:O=(parseFloat(this.toString(R))*N)+"";break;default:O=parseFloat(this.toString(R)).toFixed(4)+"";}return P?O:this.toLocaleString(O);},convertUnits:function(P,Q,O){return this.convertToLocalUnits(Q,this.convertToUSUnits(P,O,true),true);},toLocaleString:function(O){return(O+"").replace(".",F());},toString:function(Q,O){if(O===true){var P=this.getThousandSepRegex();if(P){Q=String(Q).replace(P,"");}}return String(Q).replace(F(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(E().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(Q,P){var O=P;if(P=="."||P=="*"||P=="\\"){O="\\"+P;}return Q.reverse().replace(/(\d{3})/g,"$1"+P).reverse().replace(new RegExp("^(-)?"+O),"$1");},format:function(S,R,V,O){var U="",T=(R>0)?".":"",P=[];V=(V)?V:"";for(var Q=0;Q<R;Q++){P.push("0");}P=P.join("");switch(S){case C.PERCENT:U="0"+T+P+"%";break;case C.SCIENTIFIC:U="0"+T+P+"E+00";break;default:U='"'+V+'"#,##0'+T+P;}return this.formatByMask(U,O);},formatByMask:function(q,AF){var f=String(q).split(";"),Z="",Q=f[0],X="\u00A4";if(isNaN(AF)){return AF;}var w=Q.indexOf("E+"),W=Q.indexOf("%"),h=Q.match(/\".*\"/),k=Q.indexOf("?/?")>-1,o=(w!=-1)?C.SCIENTIFIC:((W!=-1)?C.PERCENT:((h)?C.CURR:k?C.FRACTION:C.FIXED)),d="",AC="",a=false,O=new String(AF),V=parseFloat(AF);if(h){d=Q.replace(/\".*\"/,h[0].substring(1,h[0].length-1)).replace(Q.replace(h[0],""),X);}if(V<0){O=O.substring(1,O.length);V=-V,a=true;if(f.length>1){var T=f[1].replace(/\[.*\]/,"");AC=T.replace(f[0],X);}}var U=function(AJ,j){return(j)?j.replace(X,AJ):"-"+AJ;};if(o==C.FRACTION){var AA,z,AE,b=10,l,g=0,s,AB,R,P=false,p;if(q.indexOf("# ")>-1){P=true;}for(AA=5;AA>0;AA--){p="/";for(z=0;z<AA;z++){p+="?";}if(q.indexOf(p)>-1){for(z=1;z<AA;z++){b*=10;}break;}}if(P){g=Number(Number(V).toFixed(0));V-=g;}AB=b/2;AE=-1;s=V*b;for(AA=b;AA>=2;AA--){R=(s*AA)/b;R=R-Math.floor(R);R=R*b;if(Math.abs(R-b)<R){R=Math.abs(R-b);}R=R/AA;if(R<AB){AB=R;AE=AA;}else{if((R==AB)&&(R==0)){AB=R;AE=AA;}}}l=Math.round(AE*s/b);for(AA=AE;AA>=2;AA--){if((l%AA==0)&&(AE%AA==0)){l=l/AA;AE=AE/AA;break;}}if(AE==b){AE=1;l=0;}if(l==0){AE=1;}if(l==AE){if(P){Z=""+(g+1);}else{Z="1";}}else{if(P&&g>0){Z=g+" "+l+"/"+AE;}else{Z=l+"/"+AE;}}}else{if(o==C.SCIENTIFIC){var AG=Math.floor(Math.log(V)/Math.LN10),x=V/Math.pow(10,AG),AH=Q.substring(0,w),Y=AH.indexOf(".");Z+=Number(x).toFixed((Y!=-1)?AH.length-Y-1:0);Z=((a)?U(Z,AC):Z)+"E"+((AG>0)?"+":"")+AG;}else{if(o==C.PERCENT){Q=Q.substring(0,Q.length-1);O=String(V*100);}var Y=Q.indexOf("."),S=0;if(Y!=-1){var AI=Q.substr(Y+1,Q.length).match(/\d+/);if(AI&&AI.length>0){S=AI[0].length;}}Z=String(Number(parseFloat(O).toFixed(S)));var AD=Z.split(".");var t=Q.match(/#.+##/);if(t!==null){AD[0]=this.addSeparators(AD[0],E());}Z=AD.join(F());if(o==C.CURR){Z=d.replace(X,Z);}if(o==C.PERCENT){Z+="%";}if(a){Z=U(Z,AC);}}}return Z;},generateUniqueID:function(O){var Q="0123456789ABCDEF".split(""),R=[];for(var P=0;P<O;P++){R[P]=Q[0|Math.random()*16];}return R.join("");},countOfDecimals:function(P,Q){var O=String(P);return O.length-(O.indexOf(Q!==undefined?Q:F())+1);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.locales");var X=mstrmojo.array,M=mstrmojo.meta.TP,L=mstrmojo.hash,D={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1},B={};for(var R in D){B[D[R]]=true;}var V={};V[D.AQ]="a";V[D.AL]="a";V[D.AC]="a";V[D.AE]="a";V[D.MQ]="m";V[D.MC]="m";V[D.F]="f";V[D.R]="r";V[D.XML]="p";var G={};G[D.MQ]=["not","m","fn","fnt","cs","dmy"];G[D.MC]=["not","m","fn","fnt","m2","m3","p","dmy"];G[D.AE]=["not","a","fn","es","a2","fm2","p"];G[D.AQ]=["not","a","fm","fn","cs"];G[D.AL]=["not","a","fm","fn","cs"];G[D.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];G[D.R]=["not","r"];G[D.F]=["not","f"];G[D.XML]=["not","n","p"];var J={};J[D.MQ]="METRIC_FNS";J[D.MC]="METRIC_FNS";J[D.AQ]="FORM_FNS";J[D.AL]="FORM_FNS";J[D.AC]="FORM_FNS";J[D.AE]="ELEM_FNS";var K={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43},W={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776},P={a:K.ATTR,a2:K.ATTR,m:K.METRIC,m2:K.METRIC,r:K.REPORT,f:K.FILTER,p:K.PROMPT};var Q={};Q[D.MQ]=K.METRIC;Q[D.MC]=K.METRIC;Q[D.AQ]=K.ATTR;Q[D.AL]=K.ATTR;Q[D.AC]=K.ATTR;Q[D.AE]=K.ATTR;Q[D.F]=K.FILTER;Q[D.R]=K.REPORT;var F=function(Y){var H=Y.length,a={};for(var Z=0;Z<H;Z++){var b=Y[Z];a[b.did]=b.n;}return a;},C=function(Z){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){Y.t=Y.tp;}}return Z;},S=function(Z,b){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){if(b){Y.t=b;}else{delete Y.t;}}}return Z;},U=function(Y,a){if(!a){a=[];}a.length=0;for(var Z=0,H=Y.length;Z<H;Z++){a[Z]=Y[Z];}return a;},I={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};METRIC_PROHIBITED={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:D,ETs:B,ET2TGT:V,ET2COND:G,ET2TP:Q,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:K,STP:W,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":W.PROMPT,1:W.PROMPT_LONG,2:W.PROMPT_LONG,3:W.PROMPT_LONG,4:W.PROMPT_DOUBLE,5:W.PROMPT_DOUBLE,6:W.PROMPT_DOUBLE,7:W.PROMPT_DOUBLE,8:W.PROMPT_STRING,9:W.PROMPT_STRING,10:W.PROMPT_STRING,14:W.PROMPT_DATE,15:W.PROMPT_DATE,16:W.PROMPT_DATE,21:W.PROMPT_LONG,22:W.PROMPT_LONG,23:W.PROMPT_STRING,24:W.PROMPT_BOOLEAN,30:W.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0},fnCstCount:function A(Y,H){var Z=this.FN;switch(Y){case Z.BETWEEN:case Z.NOT_BETWEEN:return 2;case Z.IS_NULL:case Z.IS_NOT_NULL:return 0;default:return 1;}},fn_List:function O(Y,H){var Z=this.FN;return Y==Z.IN_LIST||Y==Z.NOT_IN_LIST;},fn_AC_MC:function T(Y,H){var Z=this.FN;return(Y==Z.EQUAL)||(Y==Z.NOT_EQUAL)||(Y==Z.GREATER)||(Y==Z.LESS)||(Y==Z.GREATER_EQUAL)||(Y==Z.LESS_EQUAL);},fnName:function N(d,b,Y,a){var H=this[J[d]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[a]]||H["*"];}var Z=X.find(H,"did",(Y||1)+this.FN_SEP+b);if(Z>-1){return H[Z].n;}return"";},findTargets:function E(j,a,o){if(!o){o={};}if(j){for(var g in P){var z=j[g];if(z){if(!z[M]){z[M]=P[g];}o[z[a]]=z;}}if(j.dmy){var d=this.TP.ATTR,p=this.DMY_TP.ATTR,Z=j.dmy.uts;for(var x=0,Y=(Z&&Z.length)||0;x<Y;x++){var f=Z[x];if(f&&f.utp===p){var b=f.utgt;if(!b.t){b.t=d;}o[b[a]]=b;}}}var H=j.nds,l,s;for(l=0,s=(H&&H.length)||0;l<s;l++){this.findTargets(H[l],a,o);}var q=j.cs,w=q&&q.length;if(w){for(l=0;l<w;l++){this.findTargets(q[l],a,o);}}}return o;},onLocaleUpdated:function(){var Y=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=L.copy(F(Y.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=U(S(Y.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":S(X.filter(Y.Metric,function(Z){return Z.did&&(X.find(METRIC_PROHIBITED["0"],"did",Z.did)<0);}))};H.FORM_FNS={0:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0);})),1:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["1"],"did",Z.did)<0);})),2:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0)&&(X.find(I["1"],"did",Z.did)<0);}))};H.DIMTYLEVELS=U(S(Y.DimtyLevels),H.DIMTYLEVELS);}});mstrmojo.expr.onLocaleUpdated();})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var H=mstrmojo.registry,C=mstrmojo.array,K=mstrmojo.publisher;function M(O,P){if(P){P.parent=O;return H.ref(P);}return null;}function J(O,P){if(P&&P.alias!=null){O[P.alias]=P;}}function D(P,Q){var O=Q.alias;if(Q.parent===P){delete Q.parent;}if((O!=null)&&(P[O]===Q)){delete P[O];}}function E(S,P){var O=P&&P.length,R,Q;if(O){R=[];for(Q=0;Q<O;Q++){var T=M(S,P[Q]);if(!T){continue;}R.push(T);J(S,T);}}return R;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,initChildren:function I(){var O="children",P=this[O];if(!P){return ;}this[O]=null;this._set_children(O,P,true);if(this.postCreateChildren){this.postCreateChildren();}},_set_children:function A(R,P,O){var Q=this.children;if(P!==Q){if(Q){this.removeChildren(null,O);}this.addChildren(P,0,O);}return false;},destroyChildren:function N(R){var Q=this.children,O=(Q&&Q.length)||0,P;if(O){for(P=O-1;P>-1;P--){var S=Q[P];if(S&&S.destroy){S.destroy(R);if(!R){D(this,S);}}}if(!R){Q.length=0;}}},invalidateChildren:function F(){mstrmojo.array.forEach(this.children,function(O){O.invalidate();});},invalidate:function L(){this.invalidateChildren();},addChildren:function G(T,P,Q){if(!T){return T;}var S=T.constructor===Array,O=E(this,S?T:[T]);if(O&&O.length){var R=this.children||[];if(P==null){P=R.length;}this.children=C.insert(R,P,O);if(!Q&&(this.onaddChild||K.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:O,index:P});}}return S?O:(O&&O[0]);},removeChildren:function B(U,Q){var S=this.children,T=U?[U]:(this.children||[]).concat(),P=T.length,O=-1,R;if(P){for(R=P-1;R>-1;R--){D(this,T[R]);}if(U){O=C.removeItem(S,U);}else{if(S){S.length=0;O=0;}}if(!Q&&(this.onremoveChild||K.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:T,index:O});}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;if(this.preHandleEvent){this.preHandleEvent(H);}var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){if(this.postHandleEvent){this.postHandleEvent(H);}C.publish(this.id,M,H);}return H;},attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"]};J.RW=["z-index"].concat(J.T.concat(J.D));var E=mstrmojo.dom;function D(N,P,M){var O=N[P]||[];O.push(M);N[P]=O;}mstrmojo._Formattable={_mixinName:"mstrmojo._Formattable",formatHandlers:null,getCacheKey:function B(M){return"csscache"+(M.thresholdId||"");},update:function C(M){this.invisible=!!(M&&M.data&&M.data.invisible);if(this._super){this._super(M);}},preBuildRendering:function K(){if(this._super){this._super();}var M=this.defn;if(!M){M=this.defn={};}var Q=this.getCacheKey(this),Z=M[Q];if(!Z){Z=M[Q]={};var Y=this.getFormats();if(Y){var U=this.formatHandlers;for(var P in U){var h=U[P];var S=h.src?Y[h.src]:Y;if(!S){return ;}var X=[];var W=-1;var R=P+"CssText";var O=h.props||h;if(!O){continue;}for(var j=O.length-1;j>=0;j--){var a=O[j];var g=J[a]||[a];for(var V=g.length-1;V>=0;V--){a=g[V];if(a in S){if(a==="fx"){var d=S[a],N={};if("gd" in d){this.formatGradient(d.gd,N);}if("rt" in d){if(d.rt==1||d.rt==3){this.formatTextRotation(d.rt,N);}}if("ds" in d){this.formatDropShadow(d,N);}for(var T in N){X[++W]=T+":"+N[T].join(" ");}}else{X[++W]=a+":"+S[a];}}}}if(this.invisible){X.push("visibility:hidden");}this[R]=Z[R]=X.join(";")+";";}}}else{for(var b in Z){this[b]=Z[b];}}return true;},formatGradient:function G(M,O){var N=mstrmojo.css.buildGradient(M.t,M.sc,M.ec);if(N){D(O,N.n,N.v);}},formatDropShadow:function L(P,N){if(E.supports(E.cssFeatures.DROP_SHADOW)){var O=P.ds;if(E.isDXIE){D(N,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+O+",OffY="+O+")");}else{var M=[O,O];if(P.rt==1||P.rt==3){M[((P.rt===1)?1:0)]=-O;}D(N,(E.isWK?"-webkit-":"")+"box-shadow",M.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function A(N,M){if(E.supports(E.cssFeatures.TEXT_ROTATION)){if(E.isDXIE){D(M,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+N+")");}else{var O=(N===1)?90:-90;D(M,E.CSS3_PREFIX+"transform-origin","top left");D(M,E.CSS3_PREFIX+"transform","rotate("+O+"deg)");}}},getFormats:function I(){if(!this.fmts){this.fmts=this.formatResolver.getFormat(this.defn,this.thresholdId);}return this.fmts;},clearCache:function F(){delete this.defn[this.getCacheKey(this)];},unrender:function H(M){if(this.thresholdId){this.fmts=null;}this._super(M);}};mstrmojo._Formattable.getBorderWidths=function(N){var P=N.getFormats(),M=("border" in P)?P.border.match(/(\d*|\d*\.\d*)pt/)[0]:P["border-width"],O=N.model.docModel?N.model.docModel.dpi:N.model.dpi;return mstrmojo.css.getBorderWidths(M,O);};})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");mstrmojo._HasDocLink=mstrmojo.provide("mstrmojo._HasDocLink",{_mixinName:"mstrmojo._HasDocLink",url:"",target:"",linkEnabled:true,ifw:"",update:function C(D){var E=D.defn;this.url=D.data.url||E.url;if(E.target){this.target=E.target;}if(E.ifw){this.ifw=E.ifw;}this._super(D);},postBuildRendering:function A(){if(this.url||this.ifw){mstrmojo.css.addClass(this.domNode,"hasLink");}var E=this.controller.view,D=E&&E.getCurrentLayout();if(D&&D.addLinkInfo){D.addLinkInfo(this.id,{url:this.url,target:this.target,src:this});}return this._super();},setLinkEnabled:function B(H){this.linkEnabled=H;var G=this.domNode;if(!G){return ;}var I=G.childNodes,F=I[I.length-1],D=this.id+"_mask",E=(F.id===D)?F:null;if(H){if(E){G.removeChild(E);delete this._mask;}}else{if(!E){E=document.createElement("div");E.className="mstrmojo-DocLinkMask";E.id=D;E.innerHTML="&nbsp;";G.appendChild(E);}}},onclick:function(){if(this.linkEnabled){var E=this.drillLinkItems,D=E&&E[0];url=this.url||(D&&D.url);if(this.ifw){this.model.showInfoWin(this.ifw,(this.getAnchor&&this.getAnchor())||this.domNode,"v",true);}else{if(url){this.model.executeLink(url,this.target,this);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.android.selectors._SupportsHoriz=mstrmojo.provide("mstrmojo.android.selectors._SupportsHoriz",{_mixinName:"mstrmojo.android.selectors._SupportsHoriz",scrollerConfig:{bounces:false,showScrollbars:false},minItemHeight:25,getItemProps:function A(H,D){var G=this._super(H,D),F=this.height,I=this.items.length,E;G.tag="label";G.n=G.n||"&nbsp";if(this.isHoriz){if(F){E=F;}if(this.itemWidthMode===0){G.style+="width:"+Math.floor(100/I)+"%;";}}else{if(F){E=Math.round(parseInt(F,10)/I);E=Math.max(E,this.minItemHeight);E+="px";}}if(E){G.style+="line-height:"+E+";";}return G;},init:function C(E){this._super(E);if(this.isHoriz){this.cssDisplay="table";var D=["horiz"];if(this.itemWidthMode===0){D.push("fixedWidth");}mstrmojo.css.addWidgetCssClass(this,D);}},updateScrollerConfig:function B(){var G=this._super(),K=this.itemsContainerNode,F="Height",D="y",J="v",E={};if(this.isHoriz){F="Width";D="x";J="h";}G.scrollEl=K;var L=this[F.toLowerCase()];if(L){L=parseInt(L,10);var I=Math.max(K["offset"+F]-L,0),H=G[J+"Scroll"]=(I!==0);if(H){E[D]={start:0,end:I};}}G.offset=E;G.origin=G.origin||{x:0,y:0};return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,B=mstrmojo.css,D="selected";function G(I,J,K,H,M){var L=M.listHooks[I];if(L&&L.call(M,J,K,H)){return ;}B[((I==="select")?"add":"remove")+"Class"](J,D);}function E(K,J,I){var L=this[K],H=(L)?L.split(J):[];H=H.concat(I.split(J));this[K]=H.join(J);return H.length-1;}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},getItemMarkup:function(I,H){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}">{@n}</{@tag}>';},getItemProps:function C(J,H){var I=!!this.selectedIndices[H];return{tag:"div",sel:I,cls:(I)?D:"",n:J.n||"",style:"",idx:H,addCls:function(K){E.call(this,"cls"," ",K);},addStyle:function(K){E.call(this,"style",";",K);}};},itemRenderer:{render:function(I,H,J){I._renderIdx=H;return mstrmojo.string.apply(J.getItemMarkup(I,H),J.getItemProps(I,H));},select:function(I,J,H,K){G("select",I,J,H,K);},unselect:function(I,J,H,K){G("unselect",I,J,H,K);}},onclick:function A(J){try{var M=J.target||F.eventTarget(J.hWin,J.e),L=F.findAncestorByAttr(M,"idx",true,this.domNode),I=L&&parseInt(L.value,10);if(I!==null&&!isNaN(I)){if(!this.multiSelect){this.singleSelect(I);}else{var H=(this.selectedIndices[I])?"remove":"add";this[H+"Select"](I);}}}catch(K){mstrApp.onerror(K);}}});mstrmojo._IsList.SELECTED_CLS=D;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array");var H=1,B=2;function J(M,L){return D(M,L)&&M.o===L.o;}function D(M,L){return M&&L&&M.ui===L.ui&&M.axis===L.axis&&M.mix===L.mix;}function A(P,M,N){var O=N.getCellTitleId(M),L=N.getCellUnitIndex(M);N.selections[O]=N.selections[O]||{};N.selections[O][L]=N.selections[O][L]||[];N.selections[O][L].push(P);C(P);}function K(M){var Q=M.selections;for(var P in Q){for(var O in Q[P]){for(var N=0,L=Q[P][O].length;N<L;N++){G(Q[P][O][N]);}}}M.selections={};}function C(L){mstrmojo.css.setOpacity(L,50);}function G(L){mstrmojo.css.setOpacity(L,100);}function F(N,O){if(N.mix===undefined){var R=O.gridData.gts[N.axis===H?"row":"col"],M=R[N.tui||N.ui],Q=0;for(var P=0,L=R.length;P<L;P++){if(R[P].id===M.id){Q++;}}return Q;}return 0;}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelect:function E(M,U){var S=this.getCellForNode(M),b=M.parentNode;if(U){var R=this.getCellTitleId(S),X=this.getCellUnitIndex(S);selectedTitle=this.selections[R];selectedUnit=selectedTitle&&selectedTitle[X];if(selectedUnit){for(var T=0,V=selectedUnit.length;T<V;T++){G(selectedUnit[T]);}delete selectedTitle[X];return ;}}var Q=F(S,this);if(S.axis===H){for(var T=0,L=0,V=b.cells.length;T<V&&L<Q;T++){var O=b.cells[T],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;}}}else{if(S.axis===B){var Z=mstrmojo.dom.findAncestorByName(M,"table",false),a=Z.rows;for(var T=0,L=0,V=a.length;T<V&&L<Q;T++){var Y=a[T].cells;for(var P=0,N=Y.length;P<N;P++){var O=Y[P],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;break;}}}}else{A(M,S,this);}}},rangeSelect:function I(f,g){var a=this.getCellForNode(f),L=this.getCellForNode(g);if(D(a,L)){if(a.o>L.o||a._ei>L._ei){var l=f;f=g;a=this.getCellForNode(f);g=l;L=this.getCellForNode(g);}var W=F(a,this),M=a.axis,h=mstrmojo.dom.findAncestorByName(f,"table",false),T=h.rows,b=f.parentNode,o=b.rowIndex,V=b.cells,Y=g.parentNode.rowIndex;if(M===H){for(var Z=o;Z<=Y;Z++){var N=T[Z].cells,O=false;for(var X=0,d=N.length,P=0;X<d&&P<W;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);P++;}}}}else{if(M===B){for(var Z=0,d=T.length,k=0;Z<d&&k<W;Z++){var N=T[Z].cells,S=false;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(J(U,a)){S=true;}if(S){A(R,U,this);}if(J(U,L)){break;}}if(S){k++;}}}else{if(o==Y){for(var Z=f.cellIndex,d=g.cellIndex;Z<=d;Z++){var R=V[Z],U=this.getCellForNode(R);A(R,U,this);}}else{for(var Z=o,d=Y;Z<=d;Z++){var N=T[Z].cells;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);break;}}}}}}}},doSelection:function(S,R,P){var T=mstrmojo.dom,L=T.ctrlKey(R,S),M=T.shiftKey(R,S);if(!L){K(this);}var Q=this.getCellForNode(P);var N=Q&&(Q.mix===undefined&&Q.o!==undefined),O=Q&&(Q.mix!==undefined&&(Q._lp||Q._tp));if(N||O){if(M){this.rangeSelect(this.lastSelectedTD,P);}else{this.singleSelect(P,L);this.lastSelectedTD=P;}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");var B="tx-touch",E=100,D='<div class="mstrmojo-dicPreview dicx{@t} {@x}" ontouchstart="mstrmojo.all[\'{@id}\'].previewTouchStart()";><div><div>{@v}</div></div></div>';mstrmojo.android._HasPreviewButton=mstrmojo.provide("mstrmojo.android._HasPreviewButton",{_mixinName:"mstrmojo.android._HasPreviewButton",renderPreview:function F(){var I=this.openerNode,J=this.group||this,H=(J.openerType===2)||!!this.dic.dm||this.dicChanged;this.renderPreviewButton(I,H?this.dv:I.innerHTML);},renderPreviewButton:function A(K,N){var Q=this.dic,O=Q.t,P=this.group||this,M=false,J=true,I=mstrmojo.DICConfig.TYPES,R=[];switch(O){case I.SLIDER:case I.TEXTAREA:J=!Q.dm;break;case I.SWITCH:case I.TOGGLE:case I.RATING:case I.STEPPER:case I.LIKERTSCALE:J=false;break;}if(P.openerType===2){M=J;}if(J){var L=K.style;L.border="";L.padding="";R.push("arw");if(M){R.push("prv");}}var H=this.id;K.innerHTML=mstrmojo.string.apply(D,{t:O,v:N||"&nbsp;",id:H,x:R.join(" ")});this._previewNode=K.firstChild;if(this.inlineExtraCssText){this._previewNode.style.cssText+=" "+this.inlineExtraCssText;}},setDirtyFlag:function C(K,J){var H=this._previewNode,I=H&&H.firstChild;mstrmojo.css.addClass(I||J,"tx-active");},previewTouchStart:function G(){var H=this;mstrmojo.css.addClass(H._previewNode,B);if(this._holderTimer){clearTimeout(this._holderTimer);}this._holdTimer=setTimeout(function(){delete H._holdTimer;mstrmojo.css.removeClass(H._previewNode,B);},E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom");var E=mstrmojo.dom,H=E.position,G=Math;function A(T,O,M){var N=this._ellTestNodes||{},J=N[T],L=mstrmojo.css.getComputedStyle(O),I=["width","height"];if(M){I.reverse();}var R=I[0],P=I[1];if(!J||!E.contains(this.domNode,J.n,true,document.body)){var K=O.cloneNode(true);K.removeAttribute("id");K.removeAttribute("onclick");var S=K.style;S.position="absolute";S.top="-10000px";S.maxHeight=S.maxWidth="none";S[R]="auto";O.parentNode.appendChild(K);var Q=parseInt(L["max-"+R],10);if(isNaN(Q)){Q=parseInt(L[R],10);}J=N[T]={n:K,m:Q,d:R.substr(0,1)};this._ellTestNodes=N;}else{J.n.innerHTML=O.innerHTML;}J.n.style[P]=L[P];return J;}function D(J,K){var L=this.ellipsisText;switch(this.ellipsisPosition){case"middle":var I=G.floor(K/2);return J.slice(0,I).join("")+L+J.slice(-I).join("");case"end":return J.slice(0,K).join("")+L;default:return J.join("");}}var B=4;mstrmojo._SupportsEllipsisText=mstrmojo.provide("mstrmojo._SupportsEllipsisText",{_mixinName:"mstrmojo._SupportsEllipsisText",ellipsisText:"&hellip;",ellipsisPosition:"end",ellipsize:function F(T,O,N){var U=O.innerHTML;if(!U){return false;}var J=A.call(this,T,O,N),L=function(){var V=H(J.n)[J.d];return(V<=J.m);};if(L()){return false;}var K=J.n,I=U.split(""),Q=0,M=I.length,P,R;while(Q<M){var S=G.floor((Q+M)/2);U=K.innerHTML=D.call(this,I,S);if(L()){Q=S+1;}else{M=S-1;}if(M-Q<B){for(R=Q-1;R<M+1;R++){U=K.innerHTML=D.call(this,I,R);if(!L()){break;}P=U;}}if(P){O.innerHTML=P;break;}}return true;},unrender:function C(I){delete this._ellTestNodes;this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsList","mstrmojo.dom");var F=mstrmojo.android._IsList=mstrmojo.provide("mstrmojo.android._IsList",mstrmojo.hash.copy(mstrmojo._IsList,{_mixinName:"mstrmojo.android._IsList",getItemIdxTouch:function A(I){var H=mstrmojo.dom.findAncestorByAttr(I.target,"idx",true,this.domNode),G=H&&parseInt(H.value,10);return(G!==null&&!isNaN(G))?G:-1;},resetListState:function B(){this.clearSelect(true);var G=this.scrollerConfig;if(G){delete this.scrollerConfig.origin;}},restoreListState:function C(G,I){var J={};J[G]=true;this.selectedIndices=J;this.selectedIndex=G;var H=this.scrollerConfig;if(H){H.origin=I;}},touchSelectEnd:function E(G){this.touchTap(G);}}));var D=F.onclick;F.onclick=mstrmojo.emptyFn;F.touchTap=function(G){this._listTarget=G.target;D.call(this,G);};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var G=mstrmojo.hash,A=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",init:function E(H){this.disposables=[];G.copy(H,this);if(this.postApplyProperties){this.postApplyProperties();}A.add(this);if(this.postCreate){this.postCreate();}},destroy:function B(H){this._super(H);F.forEach(this.disposables,function(I){if(I.destroy){I.destroy(H);}else{if(I.clear){I.clear();}}});this.disposables=[];A.remove(this);}});var C=mstrmojo.Obj;C.free=function D(H){if(H instanceof C){H.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9\_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')},VALIDATOR:{DEMO:function L(d){var b=parseInt(d,10),f=mstrmojo.validation.STATUSCODE;if(b===0||b===1||b>10){return{code:f.VALID};}return{code:f.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function H(b){var f=this.dtp,d=String(b).replace(/[^\d]/g,"");if(d.length<10){return{code:E.INVALID,msg:mstrmojo.desc(9203)};}if(!J.REGEXP.PHONE_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9204)};}return{code:E.VALID};},VALIDATE_ZIPCODE:function G(b){var f="",d=this.dtp;if(!J.REGEXP.US_ZIP.test(b)){if(J.isNumeric(d)||J.isInt(d)){f=mstrmojo.desc(9208);}else{if(J.isString(d)){f=mstrmojo.desc(9206);}}return{code:E.INVALID,msg:f};}return{code:E.VALID};},VALIDATE_EMAIL:function P(b){var d=b.indexOf("@");if(d===-1){return{code:E.INVALID,msg:mstrmojo.desc(9197)};}if(b.substring(d).indexOf(".")===-1){return{code:E.INVALID,msg:mstrmojo.desc(9198)};}return J.REGEXP.EMAIL_ADDRESS.test(b)?{code:E.VALID}:{code:E.INVALID,msg:mstrmojo.desc(9207)};},VALIDATE_SSN:function O(b){var f=this.dtp,d;if(J.isNumeric(f)||J.isInt(f)){d=String(b).replace(/[^\d]/g,"");if(d.length!=9){return{code:E.INVALID,msg:mstrmojo.desc(9209)};}}if(!J.REGEXP.SOCIAL_SECURITY_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9210)};}return{code:E.VALID};}},isInt:function(b){return B[b]==1;},isNumeric:function(b){return B[b]==2||B[b]==5;},isString:function(b){return B[b]==3;}};var V=window.mstrConfig,I=V.listSep,W=mstrmojo.expr,K=W.DTP,J=mstrmojo.validation,F=J.TRIGGER,E=J.STATUSCODE,X=mstrmojo.css,Q=mstrmojo.num,N=mstrmojo.string,a=mstrmojo.date,B={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,21:2,22:2,23:3,24:4,25:3,30:5};function D(l,o){var h=l.dtp,k=l.constraints,q=k.allowedFormatChars?k.allowedFormatChars:"",g=(B[h]==1),b=(B[h]==2),d=(B[h]==6),p=mstrmojo.locales.number.THOUSANDSEPARATOR,f=mstrmojo.locales.number.DECIMALSEPARATOR,j;if(g){if(!l._intRegExp){q+="0-9-"+(l.isList?I:"")+p;l._intRegExp=new RegExp("[^"+q+"]");}j=l._intRegExp;}if(b){if(!l._numericRegExp){q+="0-9-"+(l.isList?I:"")+f+p;l._numericRegExp=new RegExp("[^"+q+"]");}j=l._numericRegExp;}if(d){}return !!j&&j.test(o);}function Y(l,p){var h=l.dtp,k=l.constraints,g=(B[h]==1),b=(B[h]==2),d=(B[h]==6),f=k.min,o=k.max,j;if(f==undefined&&o==undefined){return false;}if(g||b){return Q.inNumericRange(p,f,o)!==0;}if(d){return a.inDateTimeRange(p,f,o)!==0;}return false;}function Z(d,b){return !Q.isNumeric(b);}function A(g,d){var f=(g.dtp===K.DATE),b=(g.dtp===K.TIME);return(f?!a.isDate(d):(b?!a.isTime(d):!a.isDateAndOrTime(d)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:K.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function S(b){this._super(b);if(!this.constraints){this.constraints={};}var d=this.constraints;if(!("trigger" in d)){d.trigger=F.NONE;}},_set_value:function(j,f){var g=this.value,d=(g!==f);if(d){this.value=f;var h=this.constraints.trigger,b=(h&F.VALUESET)>0;if(b){this.validate(f);}}return d;},validate:function M(){var f=(this.value!==null&&this.value!==undefined)?this.value:"",j=this.isList?f.split(I):[f],h,d,k;for(var g=0,b=j.length;g<b;g++){h=this.doValidation(j[g]);d=(h.code>E.VALID);if(d){if(b>1){h.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",j[g]?j[g]:" ");}break;}}k=d?"onInvalid":"onValid";if(!d&&this.autoFormat){this.format();}this.set("validationStatus",h);if(this[k]){this[k](h);}},format:function T(){var j=this.dtp,f=(B[j]==6);if(!f){return ;}var l=mstrConfig.listSep,q=this.value||"",d=this.isList?q.split(l):[q],p=j===14,o=[],b,g=mstrmojo.locales.datetime;for(var h=0,k=d.length;h<k;h++){q=d[h];b=a.parseDateAndOrTime(q);if(b){if(p&&b.date){o.push(a.formatDateInfo(b.date,g.DATEOUTPUTFORMAT));}else{o.push((b.date?a.formatDateInfo(b.date,g.DATEOUTPUTFORMAT):"")+" "+(b.time?a.formatTimeInfo(b.time,g.TIMEOUTPUTFORMAT):""));}}}this.set("value",o.join(l));},isValid:function R(){var b=this.validationStatus;if(!b){this.validate();}return this.validationStatus.code===E.VALID;},clearValidation:function U(){this.set("validationStatus",{code:E.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function C(s){var o=this.constraints,p=o.regExp,f=o.validator,b={id:this.id,code:E.VALID,msg:""},l=this.dtp,k=(B[l]==1),d=(B[l]==2||B[l]==5),g=(B[l]==3),h=(B[l]==6),j=N.isEmpty(s),q=String(s).length;err="",_VAL=mstrmojo.locales.validation;if(this.required&&j){b.code=E.INVALID_EMPTY;b.msg=_VAL.requiredFieldError;return b;}s=N.trim(s);if(!j&&D(this,s)){if(k){err=_VAL.integerDataType;}if(d){err=_VAL.numericDataType;}if(h){err=_VAL.dateDataType;}b.code=E.INVALID_CHAR;b.msg=_VAL.invalidCharError.replace("#",err);return b;}if(!j&&h&&A(this,s)){b.code=E.INVALID_BAD_DATESTRING;b.msg=_VAL.invalidDateStringError;return b;}if(!j&&(d||k)&&Z(this,s)){b.code=E.INVALID_BAD_NUMERICFORMAT;b.msg=_VAL.invalidNumericFormatError;return b;}if(!j&&(k||d||h)&&Y(this,s)){b.code=E.INVALID_OUTOFRANGE;if(o.min!=null&&o.max!=null){err=_VAL.outofRangeError.replace("#","").replace("##",o.min).replace("###",o.max);}else{if(o.min!=null){err=_VAL.noLessMinError.replace("##",o.min).replace("#","");}else{if(o.max!=null){err=_VAL.noGreaterMaxError.replace("###",o.max).replace("#","");}}}b.msg=err;return b;}if(g&&o.minLen!=null&&o.maxLen!=null){if(q<o.minLen||q>o.maxLen){b.code=E.INVALID;b.msg=mstrmojo.desc(9211).replace(/#/,o.minLen).replace(/##/,o.maxLen);return b;}}if(p&&!p.test(s)){b.code=E.INVALID_REGEX;b.msg=mstrmojo.desc(9205);return b;}var t=f&&f.apply(this,[s]);if(t){b.code=t.code;b.msg=t.msg;return b;}return b;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.num","mstrmojo.array","mstrmojo.DICFactory");var F=1,J=0,L=1,N=2,G=".",I=mstrmojo.dom,K=mstrmojo.css,E=mstrmojo.hash,D=mstrmojo.Enum_Keys.TAB,H=function(Q){return(Q>=1&&Q<=7)||Q==21||Q==22||Q==30;},C=function(T,R){if(I.isIE&&!/px$/.test(R)){var Q=document.createElement("img"),S;Q.style.zIndex=-1;Q.style.left=R;T.appendChild(Q);S=Q.style.pixelLeft;T.removeChild(Q);return S+"px";}return R;},B=function(Q,R){return parseInt(C(Q,K.getStyleValue(Q,R)),10)||0;},M=function(Q){return{lp:B(Q,"paddingLeft"),rp:B(Q,"paddingRight"),tp:B(Q,"paddingTop"),bp:B(Q,"paddingBottom")};},P=function(R){var Q=R.currentStyle;if(!Q){Q=document.defaultView.getComputedStyle(R,null);}return{fontFamily:Q.fontFamily,fontSize:C(R,Q.fontSize),fontStyle:Q.fontStyle,fontVariant:Q.fontVariant,fontWeight:Q.fontWeight,textAlign:Q.textAlign};},O=function(S,Q){var R=mstrmojo.findAncestor(S,"scriptClass","mstrmojo.DocInfoWindow");if(!!R){R.autoCloseLocked=Q;}};mstrmojo._IsInputControl={_mixinName:"_IsInputControl",dic:null,owner:null,openerNode:null,popupStyle:J,items:null,applyOnEnter:true,lv:null,init:function(T){if(this._super){this._super(T);}var V=this.dic,U=V.dt,S=mstrmojo.expr.DTP,R,Q=[];if(mstrApp.useBinaryFormat){if(U==S.DATE||U==S.TIME||U==S.TIMESTAMP){R=mstrmojo.date.parseDateAndOrTime(this.value);if(R){if(U!=S.TIME){Q.push(mstrmojo.date.formatDateInfo(R.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}if(U!=S.DATE){Q.push(mstrmojo.date.formatTimeInfo(R.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}this.value=Q.join(" ");}}}this.lv=this.value;if(V.wm&&V.w===undefined){V.wm=0;}},showByDefault:false,hasPreview:false,getItems:function(){var X=this.dic,R=[],V,T,Q=0,U=String(X.itv),S=U&&U.indexOf(G),W=H(X.dt);if(S>=0){Q=U.substring(S+1).length;}if(parseInt(X.ipt,10)===0){for(V=0,T=X.min;T<X.max+0.00001;V++,T+=X.itv){R[V]={n:mstrmojo.num.toLocaleString(Q>0?T.toFixed(Q):T),v:T};}}else{R=X.vls;mstrmojo.array.forEach(R,function(Y){if(Y.n===undefined){Y.n=W?mstrmojo.num.toLocaleString(Y.v):Y.v;}});}return R;},font:null,onfontChange:function(){if(this.getInputNode){var Q=this.getInputNode(),R=this.font;E.forEach(R,function(T,S){Q.style[S]=T;});}},getOpenerNodeStyle:function(){var Q=this.group&&this.group.ons,R=this.openerNode;if(!Q){Q=M(R);Q.hp=Q.lp+Q.rp;Q.vp=Q.tp+Q.bp;Q.iw=Math.max(0,R.clientWidth-Q.hp);Q.ih=Math.max(0,R.clientHeight-Q.vp);if(this.group){this.group.ons=Q;}}return Q;},onvalueChange:function(){if(this._super){this._super();}this.dicChanged=true;if(this.showByDefault){this.applyChanges();}else{if(this.popupStyle!==J&&this.popup&&this.popup.enableApply){this.popup.enableApply();}}},preBuildRendering:function(){if(this._super){this._super();}this.openerNode=this.openerNode||this.owner.domNode;if(this.showByDefault){this.openerStyle=this.getOpenerNodeStyle();if(this.inlineExtraCssText){this.cssText+=" "+this.inlineExtraCssText;}}if(!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}},postBuildRendering:function(){var Q=this.openerNode;if(this._super){this._super();}if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault){Q.replaceChild(this.domNode,Q.lastChild);}else{this.set("font",P(Q));}}if(mstrmojo.DICConfig.isKeyNavigable(this.dic)){this.registerKeyEvents(this.domNode);}},applyChanges:function(){var W=this.lv,Q=this.getCurValue?this.getCurValue():this.value,V=this.openerNode,S=this.getDisplayValue?this.getDisplayValue():Q,U=this.dic.dt,R=mstrmojo.expr.DTP,T=mstrmojo.locales.datetime;if(String(Q)!==String(W)){if(mstrApp.useBinaryFormat){if(U==R.TIME||U==R.TIMESTAMP){Q=Q.replace(new RegExp(T.AM_NAME),"AM").replace(new RegExp(T.PM_NAME),"PM");}}this.lv=Q;this.dv=S;if(this.owner&&this.owner.dataChanged){this.owner.dataChanged(this.k,W,{dv:S,v:Q},V);}}return true;},cancelChanges:function A(){this.value=this.lv;},showInPopup:function(){this.popup=mstrmojo.DICFactory.createDICPopup(this.owner,this);if(this.focus){this.focus();}this.setInfoWindowLock(true);},lockPopup:function(){this.setInfoWindowLock(false);},renderPreview:null,onTabDown:function(Q){mstrmojo.dom.preventDefault(window,Q);if(this.applyChanges()!==false){if(this.popup){this.popup.close();}this.owner.editNext(this.k);this.cleanup();}},cleanup:mstrmojo.emptyFn,registerKeyEvents:function(R){var Q=this;I.attachEvent(R,"keydown",function(S){var T=S||window.event;if(T.keyCode===D){Q.onTabDown(S);}});if(I.isIE){I.attachEvent(R,"keyup",function(S){var T=S||window.event;if(T.keyCode===D){Q.focus();}});}},setInfoWindowLock:function(Q){O(this.owner,Q);}};}());(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.VisChartUtils");var L=0;var N=mstrmojo.num;var F=[{n:1,s:""},{n:1000,s:"K"},{n:1000000,s:"M"},{n:1000000000,s:"B"},{n:1000000000000,s:"T"},{n:1000000000000000,s:"Q"}];var M=3;var K=5;function D(T,P,S){var R=function(V,U){return U?Math.floor(V):Math.ceil(V);};var Q=R(T/P,S)*P;if(Q.toString().indexOf(".")>=0&&P<1&&Q>1){Q=parseFloat(Q.toFixed(2));}if(Q>0&&Q<1&&P>1/1000){Q=parseInt(R(Q*100,S))/100;}return Q;}function H(U,V){if(!V){V=",";}var P=U.length;for(var S=0;S<P;S++){var T=U[S].rv,Q=T.length;for(var R=0;R<Q;R++){if(Number(T[R])){break;}T[R]=T[R].replace(V,".");}}}mstrmojo.VisChartData=mstrmojo.provide("mstrmojo.VisChartData",{process:function B(T){if((!T.baseModel&&T.model)||T.model.vp){this.setDerivedModel(T);var P=T.baseModel,V=P.colHeaders,h=V.length,Y=V[h-1].items[0].ds;if(Y&&Y!=="."){H(P.series,Y);}else{if(!Y){H(P.series);}}}var R=T.model;var Q=R.series,a=Q.length;if(a<=0){return ;}var W=!T.isLinearChart&&T.isDrawAxis&&T.drawYAxisLabels,Z="";L=0;var U=new Array();if(Q&&Q[0]&&Q[0].rv.length){for(var d=0;d<a;d++){var X=Q[d].rv,g=X.length,b=U.length;for(var f=0;f<g;f++){var o=X[f];if(!o||o.length==0){continue;}if(L===0){L=Q[d].v[f].indexOf("%")>=0?100:1;}U[b]=parseFloat(o);if(W&&U[b].toString().length>Z.length){Z=U[b].toString();}b++;}}U=U.sort(function S(k,j){return k-j;});}R.mvalues=U;if(W){R.mls=Z;R.ylbls=U;}},setDerivedModel:function I(Z){var R=Z.model,b=R.series,S=b.length,Y=R.ri,a=R.rowHeaders,X=R.colHeaders;var W=typeof (R.vp)!=="undefined"&&R.vp.rl&&R.vp.rl.length>0?R.vp.rl:null;Z.baseModel=R;var Q=b[0].rv.length,V=0;if(W&&Z.isTimeSeries){var T=parseInt(W[0].rs),P=W[0].sr;for(var U=0;U<a.length;U++){if(a[U].id==P){V=Q-(a[U].l*T)>=0?Q-(a[U].l*T):0;break;}}}Z.model={categories:R.categories,mtrcs:R.mtrcs,series:b,colHeaders:X,rowHeaders:a,rne:Q,rns:V,ri:Y};},processLinearData:function G(b){this.process(b);var T=b.model;var a=T.mvalues,d=b.getMaxValue(),U=b.getMinValue();var V=this.generateAxisLabels(b,d,U);T.mvalues=V;var f=b.isDrawAxis&&b.drawYAxisLabels;var Q=b.isTimeSeries?b.formatProp.condenseLabels:true;if(f){var X=this.condenseLabels(V,M);if(Q){var R=this.checkDuplicatedCondensed(X.condensedLabels);if(R){for(S=M+1;S<K;++S){X=this.condenseLabels(V,S);R=this.checkDuplicatedCondensed(X.condensedLabels);if(!R){break;}}if(R){Q=false;}}T.mls=X.maxLabel;T.ylbls=X.condensedLabels;}if(!Q){var Z=[];var P="";var W=T.colHeaders[T.colHeaders.length-1].items;var Y=W&&W[0]&&W[0].f||"";for(var S=0;S<V.length;S++){Z[S]=N.formatByMask(Y,V[S]);if(Z[S].toString().length>P.length){P=Z[S].toString();}}T.mls=P;T.ylbls=Z;}}},checkDuplicatedCondensed:function E(P){var Q=false;for(var R=1;R<P.length;R++){if(P[R]==P[R-1]){Q=true;break;}}return Q;},condenseLabels:function J(Q,P){var U=Q.length;var R="";var T=new Array();for(var S=0;S<U;S++){T[S]=this.formatNumber(Q[S],P);if(T[S].toString().length>R.length){R=T[S].toString();}}return{condensedLabels:T,maxLabel:R};},generateAxisLabels:function A(T,W,R,X){var S=new Array();if(W==R){if(R<0){S.push(R);}S.push(0);if(R>0){S.push(R);}return S;}var P=this.calInterval(W,R,X);if(T.isTimeSeries&&T.formatProp.useCustomAxisScale){var Q=W;var V=R;}else{var Q=D(W,P,false);var V=D(R,P,true);}if((R-V)>0.9*P){V=D(R,P,false);}if((Q-W)>0.9*P){Q=D(W,P,true);}S=new Array();if(P<((Q-V)/30)){S.push(V);S.push(Q);}else{var U=V;while(U<=Q){S.push(U);if(U==V){U=Math.ceil((V+P/100)/P)*P;}else{U=Math.ceil((U+P)*1000)/1000;}}if(S[S.length-1]<Q){S.push(Q);}}return S;},formatNumber:function C(T,Q){var U="",a=1,S=T*L;if(S<0){S=-T*L;a=-1;U="-";}if(S<=1+0.000001){a*=S;if(S.toString().length<=Q){U+=S;}else{var W=2;U+=S.toFixed(W);for(var V=U.length-1;V>=0;--V){if(U.charAt(V)=="."){break;}else{if(U.charAt(V)!="0"){++V;break;}}}if(V<U.length){U=U.substr(0,V);}}}else{var P=Math.log(S)/Math.LN10+0.000001;var R=parseInt(P/3);if(R>=F.length){R=F.length-1;}var d=S/F[R].n;var Y=d.toString();if(Y.length>Q){var X=Y.indexOf(".");var Z=X<0?0:Y.length-X+1,f=X<0?Y.length:X;var b=Q-f-1;Y=d.toFixed(b<0?0:b);}a*=parseFloat(Y)*F[R].n;U+=Y+F[R].s;}return U;},calInterval:function O(P,R,S){var Q,T=(P-R);if(T==0){if(P==0){P=1;R=-1;}else{P=P*2;R=R/2;}T=P-R;}Q=1;if(T<1){while(T<1){T*=10;Q/=10;}}else{if(T>=10){while(T>=10){T/=10;Q*=10;}}}if(T<1.8){Q*=0.2;}else{if(T<3.1){Q*=0.4;}else{if(T<4.6){Q*=0.5;}else{if(T>=8.1){Q*=2;}}}}if(S){Q=Math.round(Q);if(Q<1){Q=1;}}else{if((Q>0&&Q<1)&&(parseInt(Q.toFixed(2)*100)/100)>0){Q=parseInt(Q.toFixed(2)*100)/100;}}return Q;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.date","mstrmojo.string");var G=mstrmojo.hash,F=mstrmojo.string,A='<div class="clearingDiv"></div>',E="<div {@attr}>",D="</div>";function C(I){var J=[],H=-1;G.forEach(I,function(L,K){J[++H]=K+'="'+L+'"';});return J.join(" ");}mstrmojo.android.ui.CalendarMarkupBuilder={getHeaderHTML:mstrmojo.emptyFn,getContentHTML:mstrmojo.emptyFn,getSingleMonthHelper:function B(R,S,L){var P=[],Q=-1,T=L.mkp||(E+"{@d}"+D),K=new Date(S,R),J=-1,N=L.incl,I=L.showAddlWeek,H=0;K.setDate(1-K.getDay());J=K.getMonth()-R;while(!((J===1||J===-11)&&K.getDay()===0)||(I&&H<6)){var M=K.getDate(),O=(N||J===0)?{d:M,attr:C({d:M})}:{};if(O.attr&&L.cls){O.attr["class"]=L.cls;}P[++Q]=F.apply(T,O);K.setDate(M+1);J=K.getMonth()-R;if(K.getDay()===0){H++;}}P[++Q]=A;return P.join("");}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.locales","mstrmojo.array","mstrmojo.date","mstrmojo.string","mstrmojo.android.ui.CalendarMarkupBuilder");var H=mstrmojo.array,E=mstrmojo.hash,L=mstrmojo.locales.datetime,I=L.dayNames_FULL,K=mstrmojo.string,G='<div class="clearingDiv"></div>',J="<div {@attr}>",C="</div>",F="mstrmojo-CalendarMV-";function A(N){var O=[],M=-1;E.forEach(N,function(Q,P){O[++M]=P+'="'+Q+'"';});return O.join(" ");}mstrmojo.android.medium.ui.CalendarMarkupBuilder=E.copy({getHeaderHTML:function B(Q,P){var O=[],N=-1,M=new Date(P,Q-1);O[++N]=K.apply(J,{attr:A({"class":F+"MonthLabel"})});O[++N]=mstrmojo.locales.datetime.MONTHNAME_SHORT[M.getMonth()]+" "+M.getFullYear()+C;H.forEach(I,function(R,S){O[++N]=K.apply(J,{})+R.substring(0,3)+C;});O[++N]=G;return O.join("");},getContentHTML:function D(S,O,P){var Q=[],N=-1,M=new Date(S.y,S.m),R=(new Date(O.y,O.m));P.showAddlWeek=true;while(M<=R){Q[++N]=K.apply(J,{attr:A({m:M.getMonth()+1,y:M.getFullYear(),"class":F+"Container"})});Q[++N]=K.apply(J,{attr:A({"class":F+"DatesList"})});Q[++N]=this.getSingleMonthHelper(M.getMonth(),M.getFullYear(),P);Q[++N]=C;Q[++N]=G;Q[++N]=C;M.setMonth(M.getMonth()+1);}Q[++N]=G;return Q.join("");}},E.copy(mstrmojo.android.ui.CalendarMarkupBuilder));}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var G=mstrmojo.hash,N="pending",E="failed";function M(P){if(mstrApp.isHosted()){P.success({});}else{mstrApp.serverRequest({taskId:"getOfflineTransaction"},P,{noTaskURL:true,skipLogin:true});}}function C(P){var Q=true;G.forEach(P,function(R){if(R.pending&&R.pending.length>0){Q=false;}});return Q;}function J(){var P=this;M({success:function(S){var Q=false,R,U,T;P.emptyTransactionQueue=G.isEmpty(S);G.forEach(P.prjModel,function(W,V){if(!S[V]){R=P.prjModel[V];if(R&&R.list){delete P.prjModel[V];Q=true;}}});G.forEach(S,function(W,V){var X=mstrApp.getConfiguration().getProjectByRealPid(V);if(!X){return ;}R=P.prjModel[V];if(!R){R=P.prjModel[V]={pid:X.pid,realPid:V,pn:X.pn,list:W};Q=true;}else{if(!G.equals(R.list,W)){R.list=W;Q=true;}}});if(Q){T={};G.forEach(P.prjModel,function(V){if(V){U=G.clone(V.list);G.copy(U,T);G.forEach(U,function(W){W.p=V;});}});P.ntfBoardModel.docsTx=T;P.ntfBoardModel.raiseEvent({name:"recordChanged",data:P.ntfBoardModel.docsTx});}}});}var D=mstrmojo.OfflineTransactionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.OfflineTransactionModel",lastSubmission:false,emptyTransactionQueue:true,ntfBoardModel:null,prjModel:null,init:function O(P){this._super(P);this.prjModel={};this.ntfBoardModel=new mstrmojo.Obj({docsTx:{},getOfflineRecords:function Q(R){return R?this.docsTx[R]:this.docsTx;}});J.call(this);},getBoardModel:function A(){return this.ntfBoardModel;},hasOfflineTransactions:function L(){return !this.emptyTransactionQueue;},editTransactionRecord:function H(R,Q,P,V){var U=this.ntfBoardModel,T=U.docsTx[R].p,S=mstrApp.getContentDimensions();mstrApp.serverRequest({taskId:"editOfflineTransaction",projectId:T.realPid,documentId:R,isPending:Q,timeStamp:P,availableWidth:S.w,availableHeight:S.h},V,{projectId:T.pid,skipLogin:true});},deleteTransactionRecord:function F(R,V,U,Z){var Q=this.ntfBoardModel,S=Q.docsTx[R],P=S.p,W=S[V?N:E],Y,T,X=this;mstrApp.serverRequest({taskId:"deleteOfflineTransaction",projectId:P.realPid,documentId:R,isPending:V,timeStamp:U},{success:function(){Y=mstrmojo.array.find(W,"timestamp",U);if(Y!==-1){W.splice(Y,1);}if(S.pending.length===0&&S.failed.length===0){delete Q.docsTx[R];if(G.isEmpty(Q.docsTx)){X.emptyTransactionQueue=true;}T=X.prjModel[P.realPid];if(T){delete T.list[R];if(G.isEmpty(T.list)){delete X.prjModel[P.realPid];}}Q.raiseEvent({name:"recordChanged",data:Q.docsTx});}if(Z.success){Z.success(W);}}},{noTaskURL:true,skipLogin:true});},submitOfflineTransaction:function B(){if(!this.lastSubmission||!this.emptyTransactionQueue){G.forEach(this.prjModel,function(Q,P){if(Q&&Q.list&&!G.isEmpty(Q.list)&&!C(Q.list)){mstrApp.submitTransactionQueue(P,"submitOfflineTransaction");}});}},onSubmitDone:function I(P){this.lastSubmission=P;this.refresh();},refresh:function K(){J.call(this);}});D.PENDING=N;D.FAILED=E;}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._IsRptModel");mstrmojo.GraphModel=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsRptModel],{scriptClass:"mstrmojo.GraphModel"});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip");var B=mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",init:function A(D){this._super(D);var E=this.parent;if(!E||E.hasInitBindings){this.initBindings();}},destroy:function C(D){if(this.hasRendered){this.unrender(D);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn});B.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};B.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};B.heightMarkupMethod=function(){this.domNode.style.height=this.height||"";};B.widthMarkupMethod=function(){this.domNode.style.width=this.width||"";};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var D=mstrmojo.hash;var E=0;var M=[];var P={};var B=false;function H(R){var S=R.callback;if(S.submission){S.submission(this.userInteractionRequired(R));}this.submitRequest(R);}function K(){if(M.length&&!B){H.call(this,M.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function I(b,Y,S,T){if(S){this.cancelRequests();}var V=this.id,W=this.transport,R=mstrmojo.now()+Y.taskId+E++,U=b.canceled||mstrmojo.emptyFn;b.canceled=function(d){U();b.complete(true);return W.cancelRequest(d);};b=mstrmojo.func.wrapMethods(b,{complete:function(d){mstrmojo.all[V].deleteRequest(d);}});var X=!D.isEmpty(this._requests),Z=this.createRequest(R,b,Y,T),a=(B||X)&&!T.doNotHold;if(a){M.push(Z);}else{H.call(this,Z);}},createRequest:function C(U,W,V,R){var S=this._requests;if(!S){S=this._requests={};}var T=S[U]={id:U,callback:W,params:V,config:R};return T;},submitRequest:function F(R){this.transport.serverRequest(this.id,R.id,R);},cancelRequests:function O(){var R=false;D.forEach(this._requests,function(S){if(typeof S.gotResponse==="undefined"){R|=S.callback.canceled(S.id);}});this._requests={};M=[];return R;},response:function G(V,R,T){$MAPF(false,"AndroidServerTransport","transportRequest");var U=this.getRequest(V);if(U){U.gotResponse=true;var W=U.callback,S=(R&&!T.mstrerr)?"success":"failure";try{if(W[S]){W[S](T,U);}}finally{W.complete(V);}}K.call(this);},deleteRequest:function Q(S){var R=this._requests;delete R[S];},getRequest:function A(S){var R=this._requests;return R&&R[S];},userInteractionRequired:function L(R){return false;},addLoadingGraph:function J(R){P[R]=true;B=true;},removeLoadingGraph:function N(R){delete P[R];if(D.isEmpty(P)){B=false;K.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresDescs(8409);mstrmojo.prompt.WebPrompt=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.prompt.WebPrompt",promptType:0,prs:null,pt:0,pin:0,loc:null,title:"",mn:"",req:false,min:null,max:null,dataSourcesXML:"",getStyle:mstrmojo.emptyFn,getDisplayValue:mstrmojo.emptyFn,validate:function F(K){if(this.isAnswerEmpty(K)&&this.req){throw new Error(mstrmojo.desc(8409,"This prompt (#) requires an answer.").replace("#",this.title));}},prepareAnswer:function E(L){var K=L&&L.success;if(K){K();}},getAnswerXML:function C(){var K=new mstrmojo.XMLBuilder();this.buildShortPa(K);return K.toString();},buildShortAnswerXML:function I(K){return K;},buildShortPa:function G(K){K.addChild("pa");K.addAttribute("pt",this.pt);var L=this.loc;if(L){K.addAttribute("pin",L.pin);K.addAttribute("did",L.did);K.addAttribute("tp",L.t);}this.buildShortAnswerXML(K);K.closeElement();},populateAnswer:function H(K){},setAnswerValue:mstrmojo.emptyFn,isAnswerEmpty:function J(K){return false;},populate:function D(L){this.promptType=L.ptp;this.pt=L.dptp;this.mn=L.mn;this.pin=L.pin;this.title=L.ttl;this.loc=L.loc;this.min=L.min||"";this.max=L.max||"";this.req=L.reqd;this.dataSourcesXML=L.dsrcs;var K=this.prs={};mstrmojo.array.forEach(L.prs,function(M){K[M.n]=M.v;});this.hasAnswer=L.hasAns;},buildAnswerObject:function B(){return{};},supported:function A(){return true;}});mstrmojo.prompt.WebPrompt.TYPES={CONSTANT_PROMPT:1,CONSTANT_GEO_PROMPT:1.5,ELEMENTS_PROMPT:2};mstrmojo.prompt.WebPrompt.STYLES={TEXT:1,LIST:2,STEPPER:3,SWITCH:4,SLIDER:5,CALENDAR:6,TIME:7,GEO:8,BARCODE:9};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.maps.AndroidMapModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.AndroidMapModel",getVisProps:function(){return this.data.vp;},setPrompts:function E(M){},getDataService:function G(){},execute:function H(M,N){},answerPrompts:function F(M){},getPageByTree:function J(M){},sort:function D(M,N){},pivot:function K(M,N){},drillGrid:function L(M,N){},drill2Grid:function C(M,N){},linkToObject:function A(M,N){},pageBy:function I(M,N){},saveRWProps:function B(N,P,O,M,Q){}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");mstrmojo.touchManager=new mstrmojo.Obj({notify:function(z,AA){return this.raiseEvent({name:"touchesBegin",srcId:z,touch:AA});}});var V=mstrmojo.dom,t=V.attachEvent,w=V.detachEvent,B=Math,W=window.mstrConfig,Q=false,J=null,k=W&&W.allowDefaultTouches;var j=10,D=250,F=400,Y=100;var h="Begin",N="End",d="Move",S="Cancel";var p=1,q=2,C=3,P=4;var K={};K[p]="Select";K[q]="Swipe";K[C]="Multi";K[P]="Tap";t(document.body,V.TOUCHMOVE,function(z){if(!W||!W.allowDefaultTouches){if(z.preventDefault){z.preventDefault();return false;}}return true;});function X(z){var AA=z.identifier;return(AA===undefined)?1:AA;}function l(AC,AD,AB,AA){if(Q){var z=(AA)?X(AA)+" ":"";window.console.log(AC+":"+((AB)?" "+AB.scriptClass+" "+AB.id:"")+" "+z+(AD||""));}}function o(z){return(J===z);}function T(z){if(!o(z)){return ;}l("detachWinEvts","",z);w(window,V.TOUCHMOVE,z._tmCallback,true);w(window,V.TOUCHEND,z._teCallback,true);w(window,V.TOUCHCANCEL,z._teCallback,true);J=null;}function U(z){if(o(z)){return ;}var AA=J;if(AA){l("forced deactivation","",AA);T(AA);}l("attachWinEvts","",z);t(window,V.TOUCHMOVE,z._tmCallback,true);t(window,V.TOUCHEND,z._teCallback,true);t(window,V.TOUCHCANCEL,z._teCallback,true);J=z;}function M(AA,z){return"touch"+((z&&K[z])||"")+(AA||"");}function Z(AB,AC,AA){var z=M(AC,AA);return(AB[z]!==undefined)?z:"";}function s(AC,AE,AF,AB,AA){AA=AA||AC.gestures[AF.id];var AD=(AA&&AA.bubbleTarget)||AC,z=Z(AD,AE,AB);if(z){l("fire",z,AD);AF.methodName=z;return AD[z](AF);}l("no handler",M(AE,AB),AD);return true;}function f(AH,AI,z,AD){var AE=z.pageX,AC=z.pageY,AF=AH.timeStamp,AA=X(z),AM={x:B.round(AE-AI.pageX),y:B.round(AC-AI.pageY)};var AL={id:AA,evt:AH,pageX:AE,pageY:AC,clientX:z.clientX,clientY:z.clientY,target:z.target,delta:AM,date:AF,stop:function(){l("event stopped",AA);AH.stopPropagation();AH.cancelBubble=true;}};if(AD){var AB=AF-AD.date,AK=AD.delta,AG={x:B.abs(AM.x-AK.x),y:B.abs(AM.y-AK.y)};AL.velocity={x:AG.x/AB,y:AG.y/AB};AL.isVertical=(AG.y>AG.x);AL.accelDelta=AG;var AJ=AL.direction={};if(AE!==AD.pageX){AJ.x=(AE<AD.pageX);}else{if(AE!==AI.pageX){AJ.x=(AE<AI.pageX);}}if(AC!==AD.pageY){AJ.y=(AC<AD.pageY);}else{if(AE!==AI.pageX){AJ.y=(AC<AI.pageY);}}}return AL;}function I(AC,z,AB,AA){return{s:AC,p1:z,p2:AB,evt:AA,target:AA.target};}function L(AA,z){if(AA){AA.gestures[z]=null;}}function a(AA,z){T(AA);s(AA,N,z);}function G(z){if(z._selectHandle){window.clearTimeout(z._selectHandle);delete z._selectHandle;l("cancelSelect","",z);}}function H(AF,AH){var AD=AH.which;if(AD&&AD===3){l("ignore","right mouse click",AF);return ;}var AG=AF.gestures,AE=AH.touches||[AH],z=(AH.changedTouches&&AH.changedTouches[0])||AH,AK=o(AF),AL=f(AH,z,z),AJ=I(AL,AL,AL,AH);l("touchBegin","",AF,z);if(AE.length>1){if(!AK){AL.stop();l("ignore","cross widget multitouch",AF,z);var AC=J;if(AC&&AC.onCrossWidgetMultitouch!==undefined){l("call onCrossWidgetMultitouch for","",AC);AC.onCrossWidgetMultitouch();}return false;}}else{if(AK){l("forced deactivation","",AF,z);T(AF);AK=false;}}if(AF.singleNode&&z.target!==AF._tn){l("ignore","target is not touch node",AF,z);return ;}if(mstrmojo.touchManager.notify(AF.id,AL).ignore){AL.stop();return ;}if(!AK){var AB=AL.target.tagName;AB=AB&&AB.toLowerCase();if(AB==="select"||AB==="input"){l("ignore","target is input or select",AF,z);if(AF.monitorInputs){s(AF,null,AL,P);}return ;}}AG[AL.id]=AJ;if(AK){if(!AF.multiTouch){G(AF);var AA=AE[AE.length-2],AI=AG[X(AA)];s(AF,S,AA,AI.action,AI);}else{AJ.action=C;if(AF._singleTouch){G(AF);AF._singleTouch.action=C;delete AF._singleTouch.bubbleTarget;delete AF._singleTouch;s(AF,h,AL,C);}}AL.stop();return ;}if(!V.contains(AF._tn,AH.target,true,AF.domNode)){delete AG[AL.id];return ;}AF._singleTouch=AJ;if(s(AF,h,AL)===false){return ;}AL.stop();if(Z(AF,h,p)){AF._selectHandle=window.setTimeout(function(){AJ.action=p;if(s(AF,h,AL,p)===false){a(AF,AL);}delete AF._selectHandle;},F);}U(AF);}function x(AD,AE){var AG=(AE.changedTouches&&AE.changedTouches[0])||AE,AA=AD.gestures[X(AG)];if(!AA){return ;}var AB=f(AE,AA.s,AG,AA.p2),AC=AA.action;AA.p2=AA.p1;AA.p1=AB;if(!AC&&(B.abs(AB.delta.x)>j||B.abs(AB.delta.y)>j)){AC=AA.action=q;G(AD);if(!Z(AD,h,AC)&&!Z(AD,d,AC)){AB.methodName=M(h,AC);return AD.bubbleTouchEvent(AB);}if(s(AD,h,AB,AC)===false){a(AD,AB);return ;}}if(AC){var z=AA.lastMove||AA.s.date,AF=AB.date-z;if(!mstrApp.isTouchApp()||AF>=Y){AA.lastMove=AB.date;s(AD,d,AB,AC);}}}function E(AD,AF){var z=(AF.changedTouches&&AF.changedTouches[0])||AF,AG=(AF.touches&&AF.touches.length)||0,AE=AD.gestures,AJ=X(z),AI=AE[AJ];if(!AI){l("No gesture",AJ,AD,z);return ;}var AC=AI.action,AK=f(AF,AI.s,z,AI.p2);if(!AC){G(AD);if(!AI.wasMulti){AC=P;}}if(AG===0){T(AD);AD.gestures=[];l("gestures","clear all",AD,z);}else{AE[AJ]=null;l("gestures","clear single",AD,z);}L(AI.bubbleTarget,AJ);switch(AC){case q:case p:AK.stop();s(AD,N,AK,AC,AI);break;case C:if(AG<2){s(AD,N,AK,AC,AI);if(AG===1){var AB=AF.touches[0],AH=f(AF,AB,AB),AA=I(AH,AH,AH,AF);AA.wasMulti=true;AE[X(AB)]=AA;AD._singleTouch=AA;}}if(AG>0){return ;}break;case P:if(!Z(AD,null,AC)){break;}var AL=AD._tapHandler;if(AL){window.clearTimeout(AL.h);}if(AK.date-AI.s.date<F){if(s(AD,"Before",AK,AC,AI)===false){break;}if(!AD.multiTap){AK.count=1;s(AD,null,AK,AC,AI);}else{if(AL){AL.count++;}else{AL=AD._tapHandler={count:1};}AL.h=window.setTimeout(function(){AK.count=AL.count;s(AD,null,AK,AC,AI);delete AD._tapHandler;},D);}}else{delete AD._tapHandler;}break;}s(AD,N,AK,undefined,AI);}function b(AA){var z=AA._tn;if(!z){return ;}if(!AA._tmCallback){AA._tsCallback=function(AB){H(AA,AB);};AA._tmCallback=function(AB){x(AA,AB);};AA._teCallback=function(AB){E(AA,AB);};}t(z,V.TOUCHSTART,AA._tsCallback);}mstrmojo._TouchGestures=mstrmojo.provide("mstrmojo._TouchGestures",{_mixinName:"mstrmojo._TouchGestures",singleNode:false,multiTouch:false,touchNode:null,multiTap:false,monitorInputs:false,postBuildRendering:function O(){if(this._super){this._super();}this._tn=this.touchNode||this.domNode;this.gestures=[];b(this);},bubbleTouchEvent:function g(AF){var AC=AF.methodName,z=AF.id,AA=this.gestures[z],AB=this.parent;while(AB){var AE=AB[AC],AD=AB.touchBegin;if(AE&&(!AD||s(AB,h,AF)!==false)){AF.methodName=AC;L(AA.bubbleTarget,z);AA.bubbleTarget=AB;AB.gestures[z]=AA;l("bubble",((this.k)?" "+this.k:"")+"] bubbled "+AC+" to ["+AB.scriptClass+((AB.k)?" "+AB.k:"")+"]",this,AF);return AE.call(AB,AF);}AB=AB.parent;}return false;},unrender:function A(AA){if(o(this)){T(this);}var z=this._tn;if(z){V.detachEvent(z,V.TOUCHSTART,this._tsCallback);}this._super(AA);},restoreDefaultTouches:function R(z){if(W){W.allowDefaultTouches=z&&k;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.color","mstrmojo.hash","mstrmojo.num","mstrmojo.storage.DOMLocalStorage","mstrmojo.StringBuffer","mstrmojo.android.EnumMenuOptions");mstrmojo.requiresDescs(1089,1143,7830,7831,7832,7859,7860,7861,7862,8621);var $A=mstrmojo.array,$AFE=$A.forEach,$HASH=mstrmojo.hash,$MENUS=mstrmojo.android.EnumMenuOptions,_cacheKey="CacheEnabled",_verifyJsonKey="VerifyJson",_diagnosticModeKey="DiagnosticMode",EnumHSButtonType={FOLDER:1,RESULTSET:2,REPORTS:3,SETTINGS:4,SHAREDLIBRARY:5,SUBSCRIPTIONS:8,HELP:6};function isObject(o){return(typeof o==="object");}function getColor(clr){if(isObject(clr)){if(clr.tp){return"transparent";}clr=clr.clr;}return mstrmojo.color.decodeColor(clr);}function findServer(project){var servers=this.getWebServersList(),res=null;$AFE(servers,function(server){$AFE(server.pl,function(proj){if(proj===project){res=server;return false;}});return !res;});return res;}function iterateProjects(searchConfig,serversNode,projectCache){var serverCache=projectCache?projectCache.servers:[],projectFound=false;$AFE(serversNode,function(server){$AFE(server.pl,function(project){var id=project.pid;if(id!==undefined){if(projectCache){projectCache[id]=project;serverCache[id]=server;}if(project[searchConfig.n]===searchConfig.v){projectFound=true;return false;}}});if(projectFound){return false;}});return projectFound;}function reconcileHSType(hsType){var projectID=getHSProjectID.call(this,hsType),hscNode=this._cfg.hsc,projectExists;if(!projectID){return ;}projectExists=iterateProjects({n:"pid",v:projectID},this.getWebServersList());if(!projectExists){hscNode.tp=1;switch(hsType){case 3:delete hscNode.rs;break;case 4:delete hscNode.fd;break;}}}function getHSProjectID(hsType){var projectID,hscNode=this._cfg.hsc;switch(hsType){case 3:projectID=hscNode.rs.oi.pid;break;case 4:projectID=hscNode.fd.oi.pid;break;}return projectID;}function buildCustomHomeScreen(hsc,asFolder){var ths=this,cst=hsc.cst,btns=[],hscType=ths.getHomeScreenType(),devType=ths.getDeviceType();if(hscType===1&&devType!==4){var addSubsButton=true;$AFE(cst.btns,function(btn){if((btn.act===EnumHSButtonType.SUBSCRIPTIONS)||(btn.act===EnumHSButtonType.REPORTS)){addSubsButton=false;return false;}});if(addSubsButton&&(hscType===1||(devType===4&&hscType===2&&cst.fmt.vw.rpt))){btns.push({act:EnumHSButtonType.SUBSCRIPTIONS,txt:mstrmojo.desc(1089,"Subscriptions"),dsc:""});}}$AFE(cst.btns,function(btn){var xlt=ths.xlat[$A.find(ths.xlat,"act",btn.act)],txt=xlt?(btn.cap===xlt.dcp?xlt.cap:btn.cap):btn.cap,dsc=xlt?xlt.dsc:btn.dsc,b={};if(asFolder){b.n=txt;b.desc=dsc;}else{b.txt=txt;b.dsc=dsc;}var icon=btn.icn;if(isObject(icon)){b.icn=icon.img;}var action=btn.act;if(isObject(action)){var objInfo=(action.fd&&action.fd.oi)||(action.rs&&action.rs.oi)||action.rs;b.did=objInfo.did;b.t=objInfo.t;b.st=objInfo.st;b.pid=objInfo.pid;b.ab=objInfo.ab;b.csp=!!(action.fd&&action.fd.csp);}else{b.act=action;if(b.act===EnumHSButtonType.SETTINGS&&!ths.getGeneralSettings().uas){b=null;}}if(b){btns.push(b);}});var config={btns:btns,fmt:{},ttl:""},fmt=cst.btns?cst.fmt:cst;if(fmt){var bgFmt=fmt.bkg,btnFmt=fmt.btn;config.fmt={bg:{tp:bgFmt.tp,v:(bgFmt.tp===1)?getColor(bgFmt.fll.clr):bgFmt.img},btn:{bc:getColor(btnFmt.brd),bg:getColor(btnFmt.fll),c:getColor(btnFmt.fnt),sty:btnFmt.stl}};config.ttl=fmt.ttl.cap;}if(devType===4){config.hlp=fmt.vw.hlp;}return config;}function _loadConfiguration(){var cfg=mstrMobileApp.getConfiguration();return eval("("+cfg+")");}function _initializePrjCache(cfg){cfg._hostUrls={};cfg._projects={servers:{}};}function _clearCachedValues(){delete this._hsType;delete this._hsCfg;delete this._wsl;delete this._gnl;}mstrmojo.MobileConfiguration=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.MobileConfiguration",_cfg:null,xlat:null,init:function init(props){var xl=this.xlat=[],md=mstrmojo.desc;xl.push({act:5,cap:md(7832),dsc:md(7859),dcp:"Shared Library"});xl.push({act:4,cap:md(7831),dsc:md(7861),dcp:"Settings"});xl.push({act:6,cap:md(1143),dsc:md(7862),dcp:"Help"});xl.push({act:3,cap:md(7830),dsc:md(7860),dcp:"Reports"});xl.push({act:EnumHSButtonType.SUBSCRIPTIONS,cap:md(1089),dsc:md(7860),dcp:"Subscriptions"});this._super(props);this._cfg=this._cfg||_loadConfiguration();_initializePrjCache(this);this.cacheEnabled=$LS.getItem(_cacheKey)||false;this.binaryMode=mstrMobileApp.useBinaryFormat();this.verifyJson=$LS.getItem(_verifyJsonKey)===true;this.diagnosticMode=mstrMobileApp.getDiagnosticMode();},getConfiguration:function(){return this._cfg;},saveConfiguration:function(silently){_clearCachedValues.call(this);_initializePrjCache(this);mstrMobileApp.saveConfiguration(JSON.stringify(this._cfg),!!silently);},reloadDefaultConfiguration:function(){mstrMobileApp.reloadDefaultConfiguration();this._cfg=_loadConfiguration();_clearCachedValues.call(this);_initializePrjCache(this);},setWebServerList:function(wsl){this._wsl=this._cfg.cty.wsl=wsl;_initializePrjCache(this);return this;},getWebServersList:function(){if(!this._wsl){this._wsl=this._cfg.cty.wsl||[];}return this._wsl;},getGeneralSettings:function(){if(!this._gnl){this._gnl=this._cfg.gnl;}return this._gnl;},getDefaultServerCreds:function(){var cty=this._cfg.cty;cty.wsdc=cty.wsdc||{am:1,lo:"",ps:""};return cty.wsdc;},getBackgroundSyncSettings:function(){var gnl=this.getGeneralSettings();gnl.bss=gnl.bss||{ebs:false,ui:4,tod:0,wo:false,co:false};gnl.bss.wo=gnl.bss.wo||false;gnl.bss.co=gnl.bss.co||false;return gnl.bss;},setDefaultServerCreds:function(sd){var cty=this._cfg.cty;$HASH.copy(sd,cty.wsdc);return this;},getCacheEnabled:function(){return false;},setCacheEnabled:function(c){this.cacheEnabled=c;$LS.setItem(_cacheKey,c,-1);},getBinaryMode:function(){return this.binaryMode;},setBinaryMode:function(v){if(this.binaryMode!==v){this.binaryMode=v;mstrApp.serverProxy.closeAllSessions();mstrApp.useBinaryFormat=v;mstrMobileApp.setBinaryFormat(v);}},getDeviceType:function(){return this._cfg.dt;},isSubscriptionEnabled:function(){return this.getHomeScreenType()!=2?true:!!this._cfg.hsc.cst.fmt.vw.rpt;},getVerifyJson:function(){return this.verifyJson;},getDiagnosticMode:function(){return this.diagnosticMode;},setDiagnosticMode:function(v){if(this.diagnosticMode!==v){this.diagnosticMode=v;$LS.setItem(_diagnosticModeKey,v,-1);mstrApp.diagnosticMode=v;mstrMobileApp.setDiagnosticMode(v);}},getSettingsAllowed:function getSettingsAllowed(){return this.getGeneralSettings().uas;},isMenuAllowed:function isMenuAllowed(menuItem,menuMask){if((menuMask&menuItem)>0){var generalSettings=this.getGeneralSettings(),vw=this._cfg.hsc.cst?this._cfg.hsc.cst.fmt.vw:{stg:true,hlp:true};switch(menuItem){case $MENUS.SETTINGS:return !!generalSettings.uas&&!!vw.stg;case $MENUS.HELP:return !!vw.hlp;case $MENUS.SHARE:var project=this.getProject(mstrApp.getCurrentProjectId());return(!!generalSettings.es&&project&&!!project.es);case $MENUS.LEARN:return !!generalSettings.slml;default:return true;}}return false;},reconcileHomescreen:function reconcileHomescreen(){var ths=this,hsType=ths.getHomeScreenType(),hs=this._cfg.hsc;switch(hsType){case 1:break;case 2:var btns=[];$AFE(hs.cst.btns,function(btn){var action=btn.act;if(isObject(action)){var objInfo=(action.fd&&action.fd.oi)||(action.rs&&action.rs.oi)||action.rs;if(ths.getProject(objInfo.pid)!==undefined){btns.push(btn);}}else{btns.push(btn);}});if(!btns.length){btns.push({act:5,cap:mstrmojo.desc(7832),icn:1});}hs.cst.btns=btns;break;case 3:case 4:reconcileHSType.call(this,hsType);break;}},getHomeScreenType:function(){if(!this._hsType){var hscNode=this._cfg.hsc;if(hscNode){this._hsType=(typeof hscNode==="number")?hscNode:hscNode.tp;}}return this._hsType;},getHomeScreen:function(asFolder){if(!this._hsCfg){var type=this.getHomeScreenType(),hsc=this._cfg.hsc,cfg;switch(type){case 1:case 2:cfg=buildCustomHomeScreen.call(this,hsc,asFolder);break;case 3:cfg=hsc.rs;if(cfg.oi){cfg=cfg.oi;}break;case 4:cfg=hsc.fd;cfg.hlp=true;break;}this._hsCfg=cfg;}return this._hsCfg;},getProjectByRealPid:function getProjectByRealPid(realPid){var proj;$AFE(this.getWebServersList(),function(server){$AFE(server.pl,function(project){if(realPid===project.realPid){proj=project;return false;}});if(proj){return false;}});return proj;},getProjectByServerAndProjectName:function getProjectByServerAndProjectName(serverName,port,projName){var proj;$AFE(this.getWebServersList(),function(server){$AFE(server.pl,function(project){if((serverName===project.sn)&&(projName===project.pn)){if((port===undefined)||(!!port&&parseInt(port,10)===project.sp)){proj=project;return false;}}});if(proj){return false;}});return proj;},getHostUrlByRealPid:function getHostUrlByRealPid(realPid){var proj=this.getProjectByRealPid(realPid);return this.getHostUrlByProject((proj&&proj.pid)||realPid);},getWebServerUrlByProject:function getWebServerUrlByProject(projectId){var servUrl=this.getHostUrlByProject(projectId);return servUrl.replace(/(servlet\/|asp\/)$/,"");},getCurrentProjectWebServerUrl:function getCurrentProjectWebServerUrl(){return this.getWebServerUrlByProject(mstrApp.getCurrentProjectId());},getHostUrlByProject:function getHostUrlByProject(projectId){var urls=this._hostUrls;if(!urls[projectId]){var server=this.getServerByProjectId(projectId);if(server===undefined){throw new Error("Could not find server for project, pid="+projectId);}var hostUrl=new mstrmojo.StringBuffer();hostUrl.append("http");if(server.rt){hostUrl.append("s");}hostUrl.append("://"+server.nm);var port=server.po;if(port){hostUrl.append(":"+port);}hostUrl.append("/"+server.pt+"/");hostUrl.append(((server.ty===0)?"servlet":"asp")+"/");urls[projectId]=hostUrl.toString();}return urls[projectId];},getTaskUrlByProject:function getTaskUrlByProject(projectId){var server=this.getServerByProjectId(projectId);if(server===undefined){throw new Error("Could not find server for project, pid="+projectId);}return this.getHostUrlByProject(projectId)+mstrConfig.taskURL+((server.ty===1)?".aspx":"");},getProject:function getProject(projectId){var projects=this._projects;if(!projects[projectId]){iterateProjects({n:"pid",v:projectId},this.getWebServersList(),projects);}return projects[projectId];},getProjectHash:function getProjectHash(){var _result={},serverList=this.getWebServersList();if(serverList.length<1){return _result;}var projects=this._projects,dummyProjectID=mstrmojo.num.generateUniqueID(64);iterateProjects({n:"pid",v:dummyProjectID},serverList,projects);_result=$HASH.clone(projects);delete _result.servers;return _result;},getProjectList:function getProjectList(){var projectList=[];$HASH.forEach(this.getProjectHash(),function(project){projectList.push({did:project.pid,n:project.pn,desc:project.sn,st:"Project",t:8,rtf:project.rtf});});return projectList;},clearLoginInfoForProject:function clearLoginInfoForProject(pid){var cfg=this.getConfiguration(),server=this.getServerByProjectId(pid),project=this.getProject(pid),creds=project.udc?server.pdc:project.pc;creds.lo=creds.ps="";},getLoginInfo:function(projectId){var cfg=this.getConfiguration(),server=this.getServerByProjectId(projectId),serverCreds=server.wsc,wsuid=serverCreds.lo||"",wspwd=serverCreds.ps||"",wsam=serverCreds.am,project=this.getProject(projectId),projectCreds=project.pc,uid=projectCreds.lo||"",pwd=projectCreds.ps||"",am=projectCreds.am;if(server.udc){var wsdc=cfg.cty.wsdc;wsam=wsdc.am;wsuid=wsdc.lo||"";wspwd=wsdc.ps||"";}if(project.udc){var pdc=server.pdc;uid=pdc.lo;pwd=pdc.ps;am=pdc.am;}return{wsuid:wsuid,wspwd:wspwd,wsam:wsam,uid:uid,pwd:pwd,am:am};},updateLoginInfo:function updateLoginInfo(projectId,loginInfo){var server=this.getServerByProjectId(projectId),project=this.getProject(projectId),creds=project.udc?server.pdc:project.pc,serverCreds=server.udc?this.getDefaultServerCreds():server.wsc;if(loginInfo.updateCfgAfterLogin&1){serverCreds.lo=loginInfo.wsuid;serverCreds.ps=loginInfo.wspwd;}if(loginInfo.updateCfgAfterLogin&2){creds.lo=loginInfo.uid;creds.ps=loginInfo.pwd;}this.saveConfiguration(false);},getProjectCount:function(){var wsl=this.getWebServersList(),count=0,i=0;for(i=0;i<wsl.length;i++){if(wsl[i].pl){count+=wsl[i].pl.length;}}return count;},getServerByProjectId:function(projectId){var projects=this._projects,servers=projects.servers;if(!servers[projectId]){iterateProjects({n:"pid",v:projectId},this.getWebServersList(),projects);}return servers[projectId];},setPid:function setPid(project){var oldPid=project.pid,oldRealPid=project.realPid,projCache=this._projects,serverCache=projCache.servers,pid=mstrmojo.num.generateUniqueID(32),server=findServer.call(this,project);if(oldPid){delete projCache[oldPid];delete serverCache[oldPid];}if(oldRealPid){delete projCache[oldRealPid];delete serverCache[oldRealPid];}project.pid=pid;delete project.realPid;projCache[pid]=project;serverCache[pid]=server;},setRealPid:function setRealPid(project,value){if(typeof project==="string"){project=this.getProject(project);if(!project){return ;}}var oldRealPid=project.realPid,projCache=this._projects,serverCache=projCache.servers,server=findServer.call(this,project);if(oldRealPid&&oldRealPid!==project.pid){delete projCache[oldRealPid];delete serverCache[oldRealPid];}project.realPid=value;projCache[value]=project;serverCache[value]=server;this.saveConfiguration(true);}});}());(function(){mstrmojo.requiresCls("mstrmojo._Fetchable","mstrmojo.hash");var E=mstrmojo.hash;function A(){var F=mstrApp.modelFactory;if(F){return F.newDataService("Element");}else{return mstrApp.viewFactory.newElementDataService();}}function D(F){var I,H,G;I=-1;G=0;while(G>=0){I++;G=F.indexOf(":",G);if(G>=0){G++;}}H=-1;G=0;while(G>=0){H++;G=F.indexOf("*:",G);if(G>=0){G++;}}if(I<H+1){alert("Unexpected format for element ID "+F);}return I-H;}mstrmojo.requiresCls("mstrmojo.XMLBuilder","mstrmojo.Obj");mstrmojo.mstr.WebElements=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.WebElements",source:null,items:null,duplicate:function(){return new mstrmojo.mstr.WebElements({source:E.copy(this.source),browseConfig:E.copy(this.browseConfig)});},browseConfig:null,init:function(F){var G=F&&F.browseConfig;if(G){this.blockBegin=G.blockBegin||1;this.blockCount=G.blockCount||15;}if(this._super){this._super(F);}},getBrowseConfig:function(G){var F=this.browseConfig;return{attributeID:this.source&&this.source.did||0,blockBegin:G||1,blockCount:this.blockCount||-1,filterXML:F.filter&&F.filter.getXML()||"",shortFilterXML:F.shortFilterXML||"",searchPattern:F.searchPattern||"",matchCase:!!F.matchCase,dataSourcesXML:F.dataSources||"",targetAttributeID:F.searchTarget&&F.searchTarget.did||"",searchForms:F.searchForms||""};},_retrieveItems:function(H,G){var F=this;A().getElements(this.getBrowseConfig(H),{success:function(I){if(G&&G.success){G.success({items:F.convertElems(I.items),totalSize:I.totalSize});}},failure:function(I){if(G&&G.failure){G.failure(I);}}});},convertElems:function C(G){var F=[],G=G||[];for(var H=0;H<G.length;H++){var I=G[H];F[H]={vi:H,v:I.dssid,n:I.n,t:I.emt};}return F;},buildShortXML:function B(F){F.addChild("mi");F.addChild("es");if(this.source!=null){this.source.buildShortObjectElt(F);}var I=[].concat(this.items);I.sort(function(N,M){var L=N.n,K=M.n,J;if(L===K){J=0;}else{if(L<K){J=-1;}else{J=1;}}return J;});for(var H=0;H<I.length;H++){var G=I[H];F.addChild("e");F.addAttribute("ei",G.v);F.addAttribute("emt",G.t);F.addAttribute("art",D(G.v));F.addAttribute("disp_n",G.n);F.closeElement();}F.closeElement();F.closeElement();}});})();(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,toXml:function A(){var J=this,D=function(P,Q){return" "+P+'="'+Q+'"';},C=function(P,Q){return D(P,mstrmojo.string.encodeXMLAttribute(Q));},F=new mstrmojo.StringBuffer();var H=this.prms,B=H&&H.length;if(B||J.aopam!=J.DO_NOT_ANSWER){F.append("<hl"+D("mid",J.mid)+D("srct",J.srct)+D("aopam",J.aopam)+">");if(B){F.append("<prms>");for(var E=0;E<B;E++){var O=H[E];F.append("<prm"+D("id",O.id)+D("am",O.am)+D("pt",O.pt));if(O.orid){F.append(D("orid",O.orid)+D("ortp",O.ortp));}F.append(">");switch(O.am){case J.DO_NOT_ANSWER:case J.CLOSE:case J.USE_DEFAULT_ANSWER:case J.SAME_PROMPT:break;case J.STATIC:F.append('<pa ia="1"><es>');var N=O.pa.es,M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es></pa>");break;case J.DYNAMIC:case J.ALL_VALID_UNITS:case J.CURRENT_UNIT:var L=O.pa;if(L){F.append('<pa ia="1">');var K=L.a;if(K){F.append("<a"+D("id",K.id)+C("n",K.n)+">");}if(O.pt===1){F.append(mstrmojo.string.encodeXMLAttribute(L.v));}else{F.append("<es"+D("dispForms",K&&K.dispForms>=0?K.dispForms:"")+">");var N=L.es;M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es>");if(K){F.append("</a>");}}F.append("</pa>");}break;}F.append("</prm>");}F.append("</prms>");}F.append("</hl>");}return F.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var B="FolderDataService";mstrmojo.FolderDataService=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.FolderDataService",getData:function A(F,G,E){$MAPF(true,B);try{var C=(F&&F.did)||this.did,D=F.rtf;F=mstrmojo.hash.copy(F,{taskId:"folderBrowse",styleName:"MojoFolderStyle",includeObjectDesc:true,objectType:"8,3,55",useEncoding:true,dereferenceShortcuts:false});if(D){F.did=D.did;F.folderID=D.did;}else{if(F&&!F.systemFolder){F.folderID=C;}}if(E){F.refresh=true;}mstrApp.serverRequest(F,G,{src:B+"::getData",showWait:true,hideWait:true,delay:false});return false;}finally{$MAPF(false,B);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func");mstrmojo.requiresDescs(8445);var O=mstrmojo.hash;var J=mstrmojo.dom;var Q=[mstrmojo.desc(8445,"Loading")];var G=0;function j(AA,AB,w){var x=G++,z=this.getTxUpdates(x);w=w||{};w.src=arguments.callee.caller.name;if(!mstrmojo.string.isEmpty(z)){AA.updateChanges=z;}mstrApp.serverRequest(AA,this.wrapCallback(AB,x),w);}function H(w){var x=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(x){w.styleName="RWDocumentMobileStyle";w.availableWidth=x.w;w.availableHeight=x.h;}}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService],{scriptClass:"mstrmojo.DocDataService",wrapCallback:function t(z,w){var x=this;return mstrmojo.func.wrapMethods({success:function(AA){if(AA){x.rwb=AA.bs||x.rwb;x.msgId=AA.mid||x.msgId;}x.clearTxUpdates(w);},failure:function(AA){x.resetTxUpdates(w);}},z);},refresh:function s(z,AA){var x=!!z.useRefreshProgress,w=x?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:Q;delete z.useRefreshProgress;j.call(this,O.copy(z,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false}),AA,{showProgress:true,hideProgress:true,progressStateText:w,useRefreshProgress:x});},getTxUpdates:function Z(x){var w=this.model;return w&&w.getTransactionUpdates&&w.getTransactionUpdates(x);},clearTxUpdates:function M(x){var w=this.model;if(w&&w.clearTransactionUpdates){w.clearTransactionUpdates(x);}},resetTxUpdates:function D(x){var w=this.model;if(w&&w.resetTransactionUpdates){w.resetTransactionUpdates(x);}},loadDocLayout:function V(x,z){var w=O.copy(x,{taskId:"loadDocLayout",rwb:this.rwb});H.call(this,w);j.call(this,w,z,{showProgress:true,hideProgress:true,progressStateText:Q});},setCurrentDocLayout:function T(w,x){x=x||null;j.call(this,{taskId:"setDocLayout",rwb:this.rwb,layoutKey:w},x,{silent:(x===null)});if(typeof mstrMobileApp!=="undefined"){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function b(w,x){j.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:w},x);},setCurrentPanel:function h(AA,z,w,x){j.call(this,{taskId:"setCurrentPanel",rwb:this.rwb,key:AA,panelStackKey:z,selectorKeyContext:w},x,{silent:true});},requestNewPanel:function k(AC,AB,z,w,x,AA){j.call(this,{taskId:"requestNewPanel",rwb:this.rwb,key:AC,panelStackKey:AB,selectorKeyContext:z,dirtyKeys:w},AA,{showProgress:x,hideProgress:x,progressStateText:Q});},applyGraphSelectorAction:function E(AC,AB,AA,w,AE,AD,z){j.call(this,{taskId:"applyGraphSelectorAction",rwb:this.rwb,selectorKeyContext:AC,ctrlKeys:AB,sliceID:AA,x:w,y:AE,zoomFactor:z},AD);},setDocSelectorElements:function L(AC,AE,AH,AD,AF,z,w,AB,AG,x){var AA={taskId:"setDocSelectorElements",rwb:this.rwb,selectorKeyContext:AC,elemList:AE,ctlKey:AH,zoomFactor:z};if(J.isAndroid||w){AA.taskId="androidSetDocSelectorElements";}if(AD!==null&&AD!==undefined){AA.include=AD;}if(AB){AA.sdpKeys=AB;}if(AG){AA.tks=AG;}if(x){AA.usePartialUpdate="0";}j.call(this,AA,AF,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setDocVisSelectorElements:function q(AB,AD,AG,AC,AE,x,w,AA,AF){var z={taskId:"setDocVisSelectorElements",rwb:this.rwb,selectorKeyContext:AB,elemList:AD,ctlKey:AG,zoomFactor:x};if(J.isAndroid||w){z.taskId="androidSetDocSelectorElements";}if(AC!==null&&AC!==undefined){z.include=AC;}if(AA){z.sdpKeys=AA;}if(AF){z.tks=AF;}j.call(this,z,AE,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setMultiDocSelectorElements:function W(w,z,AB,x){var AA={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:z,selectorObjects:w,zoomFactor:x};j.call(this,AA,AB,{showWait:true,hideWait:true,delay:true});},setDocSelectorExpression:function X(z,AJ,AD,w,AH,AC,AB,AF,AE,AG,x,AI){var AA={taskId:"setDocSelectorExpression"+(AI?"Unset":""),rwb:this.rwb,unitKeyContext:z,ctlKey:AJ,objectId:AD,objType:w,expFunction:AH,expFunctionType:AC,zoomFactor:x};if(AB!==null&&AB!==undefined){AA.include=AB;}if(AF!==null&&AF!==undefined){AA.expConstants=AF;}if(AE!==null&&AE!==undefined){AA.dataType=AE;}j.call(this,AA,AG);},setDocSelectorInclude:function N(z,x,AD,AC,w,AA){var AB={taskId:"setDocSelectorInclude",rwb:this.rwb,include:x,ctlKey:z,zoomFactor:AA};if(AC){AB.objectID=AC;}if(w){AB.objType=w;}j.call(this,AB,AD);},setDocUnsetSelector:function S(x,w,AA,z){j.call(this,{taskId:"unsetSelector",rwb:this.rwb,unitKeyContext:x,ctlKey:w,zoomFactor:z},AA);},getRWGraphImage:function g(AC,AE){var AB=mstrApp,AD=this.id,AA={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:AC.k,sliceID:parseInt(AC.sid,10),width:parseInt(AC.w,10),height:parseInt(AC.h,10)};if(AB.onMobileDevice()&&AB.useBinaryFormat){window.setTimeout(function(){j.call(mstrmojo.all[AD],AA,AE);},0);}else{if(AC.encodeImage){AA.taskContentEncoding="base64";delete AA.taskEnv;j.call(this,AA,{success:function(AF){AE.success("data:image/png;base64,"+AF);},failure:function(AF){(AE.failure||AB.onerror)(AF);}});}else{var w=AB.getConfiguration(),z=AB.getCurrentProjectId(),x=new mstrmojo.StringBuffer();AA.__ts__=new Date().getTime();AA.sessionState=AB.getSessionState(z);O.forEach(AA,function(AF,AG){x.append(AG+"="+encodeURIComponent(AF));});AE.success(w.getTaskUrlByProject(z)+"?"+x.toString("&"));}}},getImage:function A(x){var z=mstrApp,w=z.getConfiguration();if(w&&x&&x.indexOf("://")===-1){x=w.getHostUrlByProject(z.getCurrentProjectId())+x;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(x)):x;},getDocImage:function o(w){return this.getImage(w);},setQuickSwitchViewMode:function C(w,x){j.call(this,{taskId:"setDisplayMode",gridKeyContext:w,messageID:this.msgId,displayMode:x},null,{silent:true});},setRWUnitProperties:function a(w,z,AA,x,AB){j.call(this,{taskId:"setRWUnitProperties",rwb:this.rwb,nodeKey:w,props:z,formatType:AA,returnData:x},AB,{silent:true});},setDocZoom:function B(w,x){j.call(this,{taskId:"setDocZoom",rwb:this.rwb,zoomType:w.zoomType,zoomFactor:w.zoomFactor},x);},sort:function l(w,x){j.call(this,O.copy(w,{taskId:"DocSort",rwb:this.rwb}),x);},pivot:function K(x,z){var w=O.copy(x,{messageID:this.msgId,rwb:this.rwb});w.key=x.nodeKey;delete w.nodeKey;w.taskId=x.formID?"docPivotForm":"docPivot";j.call(this,w,z);},drillGrid:function U(w,x){j.call(this,{taskId:"DocDrill",messageID:this.msgId,nodeKey:w.nodeKey,drillPathIndex:w.drillPathIndex,drillPathKey:w.drillPathKey,elementList:w.drillElements},x,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},changeDocGroupBy:function F(z,AA,w){var x={taskId:"changeDocGroupBy",rwb:this.rwb,messageID:this.msgId,treesToRender:3};if(z.flags){x.flags=z.flags;}if(z.groupbyKey){x.groupByKey=z.groupbyKey;x.elementID=z.elementId;}else{x.gbUnits=z.gbUnits;}H.call(this,x);j.call(this,x,AA,w);},downloadGridData:function d(w,x){j.call(this,{taskId:"DocXtabIncrementalFetch",rwb:this.rwb,nodeKey:w.nodeKey,rowPosition:w.rowPosition,maxRows:w.maxRows,colPosition:w.colPosition,sliceId:w.sliceId,maxColumns:w.maxColumns},x);},txMarkRows:function f(w,x){j.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:w.nodeKey,sliceId:w.sliceId,rowOrdinal:w.rowOrdinal,actionType:w.actionType},x);},txChangeData:function I(w,x){j.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:w.nodeKey,sliceId:w.sliceId,cells:w.cells,autoRefresh:w.autoRefresh},x);},sendTransactionActions:function R(x,z){var w={taskId:"DocTransaction",rwb:this.rwb,keyContext:x.keyContext,actions:x.actions,messageID:this.msgId};if(x.txrcd){w.isPending=x.txrcd.pending;w.timestamp=x.txrcd.timestamp;}j.call(this,w,z,{silent:!!z});},RWEventsTask:function p(w,x){j.call(this,{taskId:"RWEventsTask",rwb:this.rwb,messageID:w.messageID,styleName:w.styleName,events:w.events},x);},getPageByTree:function Y(w){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},w);},resetSelections:function P(x,w,z){j.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:x||"",usePartDisplay:w?"0":"1"},z);}});}());(function(){var B={1:"f",2:"tm",3:"rd",4:"mt",7:"amt",8:"fd",10:"p",11:"fun",12:"at",21:"fm"};function A(C){return B[C]||"resv";}mstrmojo.mstr.WebOI=mstrmojo.declare(mstrmojo.Obj,null,{did:"",t:0,st:0,n:"",desc:"",ab:"",icp:"",xml:"",getXML:function(){return this.xml||this.buildShortXML().toString();},buildShortXML:function(C){C=C||new mstrmojo.XMLBuilder();C.addChild(A(this.t));this.buildShortObjectAttributes(C);this.buildTypeSpecificShortXML(C);C.closeElement();return C;},buildShortObjectAttributes:function(C){C.addAttribute("did",this.did);C.addAttribute("tp",this.t);C.addAttribute("stp",this.st);C.addAttribute("n",this.n);},buildTypeSpecificBody:function(C){},buildShortObjectElt:function(C){C.addChild(A(this.t));this.buildShortObjectAttributes(C);C.closeElement();}});})();(function(){var I=mstrmojo.array,B=function(L,M){var O=-1;if(L==null||M==null){}else{var N=this.childNodes,O=I.indexOf(N,M);if(O<0){}}return O;},A=function(L){if(L.parentNode!=null){L.parentNode.removeChild(L);}L.parentNode=this;};mstrmojo.mstr.WebNode=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.mstr.WebNode",exprType:0,nodeType:0,dataType:-1,dimType:1,childNodes:null,parentNode:null,getChildCount:function K(){return this.childNodes&&this.childNodes.length||0;},insertBefore:function H(L,M){var N=this.childNodes,O=B.call(this,L,M);if(O<0){A.call(this,L);I.insert(N,O,L);}},insertAfter:function F(L,M){var N=this.childNodes,O=B.call(this,L,M);if(O<0){A.call(this,L);I.insert(N,O+1,L);}},replaceChild:function G(L,M){var N=this.childNodes,O=B.call(this,L,refNode);if(O<0){A.call(this,L);M.parentNode=null;N[O]=L;}},removeChild:function J(L){L.parentNode=null;I.removeItem(this.childNodes,L);},appendChild:function C(L){if(L){A.call(this,L);if(!this.childNodes){this.childNodes=[];}this.childNodes.push(L);}},buildShortXML:function E(L){L.addChild("nd").addAttribute("et",this.exprType).addAttribute("nt",this.nodeType).addAttribute("dmt",this.dimType).addAttribute("ddt",this.dataType);var N=this.childNodes;if(N&&N.length){for(var M=0;M<N.length;M++){N[M].buildShortXML(L);}}this.buildTypeSpecificShortXML(L);L.closeElement();},buildTypeSpecificShortXML:function D(L){}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array");var Q=Math,V=mstrmojo.publisher.hasSubs,P=mstrmojo.hash,U=P.forEach,b=mstrmojo.dom;var S=0.15;var g=1,T=2;var B={y:{edge:["top","bottom"],size:0},x:{edge:["left","right"],size:0},clsName:"mstrmojo-touch-scroll-indicator",init:function Z(){var l=this.y,k=this.x;if(!l.i){var o=l.i=document.createElement("div");o.className=this.clsName;var p=k.i=o.cloneNode();document.body.appendChild(o);document.body.appendChild(p);}},setGradient:function a(w,o,x,q){var t=w.i,l=w.edge[(o)?1:0];var s=Q.min(Q.round(Q.min(Q.abs(x)/200,1)*100),q/2),k="left top",p="left bottom";if(o){p=k;if(l==="bottom"){k="left bottom";}else{k="right top";}}else{if(l==="left"){p="right top";}}if(s!==w.size){t.style.background="-webkit-gradient(linear, "+k+", "+p+", from(rgba(39, 104, 162, .4)), to(rgba(39, 104, 162, 0)), color-stop("+(s/100)+", rgba(39, 104, 162, 0)))";w.size=s;}},scrollAxis:function D(p,AC,s,AA,o){var AH=AC-s,l=o[p]=(AH!==0);if(!l){this.hide(p);return ;}var t=this[p],z=t.i,k=z.style,w=(p==="y"),x=(AH>0),AB=this.clsName+" "+t.edge[(x)?1:0];if(!t.size||z.className!==AB){z.className=AB;var AD="px",AI=3,AE=AA.y,q=AA.x,AF=100,AG=AA.w;if(w){if(x){AE+=AA.h-AF-AI;}}else{AG=AF;AF=AA.h;if(x){q+=AA.w-AG-AI;}}k.top=AE+AD;k.left=q+AD;k.width=AG+AD;k.height=AF+AD;k.display="block";}this.setGradient(t,x,AH,(w)?AA.h:AA.w);},scroll:function D(p,o,t,s,AA){var z=o.x,w=o.y;if(z!==t||w!==s){this.init();var q=this._widgetPosition;if(!q){var k=p.indicatorEl||AA;q=mstrmojo.dom.position(k.parentNode);}var l=p._outOfBounds||{};this.scrollAxis("y",w,s,q,l);this.scrollAxis("x",z,t,q,l);this._widgetPosition=q;p._outOfBounds=l;}else{this.hideAll();delete p._outOfBounds;}},hide:function L(l){var k=this[l];if(k.size!==undefined){k.i.style.display="none";k.i.className=this.clsName;k.size=0;}},hideAll:function d(){this.hide("y");this.hide("x");delete this._widgetPosition;}};function X(k,l){return(l)?Q.max(Q.min(Q.round(k),l.end),l.start):k;}function N(k,o,l){l.name=o;l.id=k.identifier;k.raiseEvent(l);}function F(){var l="scrollDone",k=this.origin;if(V(this.id,l)&&k){N(this,l,{x:k.x,y:k.y});}this.stopDeceleration();}function H(o,l,s){var q=o.scrollEl;if(!q){F.call(o);return ;}var p={x:l.x||0,y:l.y||0};U(o._scrollBarEls,function(AG,AB){var AL=(AB==="x"),AF=p[AB],t=AG.length,AH=AG.ratio,AD=AG.viewportSize,AA=6/t,z=AG["base"+((AL)?"Left":"Top")],AE=z+AD-t,x=Q.round(z+(AH*AF));if(x<z){x=z-AF;t+=AF;}else{if(x>AE){var AK=(AF-o.offset[AB].end)*AH;x=Q.min(AE+AK,AD+z-6)-1;t-=AK;}}var AJ=0,w=[AJ,AJ,AJ],AC=[1,1,1],AI=(AL)?0:1;w[AI]=(x-z);AC[AI]=Q.min(Q.max(t/AG.length,AA),1);b.translate(AG,w[0],w[1],w[2]," scale3d("+AC.join(",")+")");});if(s){s+="ms";}if(o._isHosted){var k=q.parentNode;k.scrollTop=p.y;k.scrollLeft=p.x;}else{q.style[b.CSS3_TRANSITION_DURATION]=s||"0";b.translate(q,-p.x,-p.y,0,o.transform,o.useTranslate3d);}if(V(o.id,"scrollMoved")){N(o,"scrollMoved",{x:l.x,y:l.y});}}function I(k,l,o){return Q.ceil(1+Q.log(k/Q.abs(l))/Q.log(1-o));}function E(k,q,o,l,p){return k+(q*(o*(1-Q.pow(1-p,l))/p));}function M(AM,AW,s,AS,AE,AR,AA){var z=AM.offset[s];if(!z){return AW;}var q=AM._outOfBounds,l=q&&q[s],AC=z.incFetch,AD=AM.friction,x=z.start,w=z.end,AN=(AS)?w:x;AE=Q.abs(AE);if(l){AS=(AW<x);AN=(AS)?x:w;}var AV=(AS)?1:-1;if(l&&(AS||!AC)){var AB=S*3,AU=1/(1-AD),p=AB/Q.pow((1-AD),(Q.log(1-Q.abs(AW-AN)*(1-AU)/AB)/Q.log(AU))-1);var AK=Q.round(E(AW,AV,p,AR,AD));if(AS?(AK>=AN):(AK<=AN)){F.call(AM);return AN;}return AK;}var AQ=z.pageSize,AP=z.supportedEdges;var t=E(AW,AV,AE,AR,AD),AF=(t<=x),o=(t>=w);if(AF||o){if(AC&&((AF&&((AP&g)>0))||(o&&((AP&T)>0)))){if(t-w>=AQ){t=w+AQ;AN=t;}if(!AM.STATUS_INC_FETCH){AM.STATUS_INC_FETCH=true;N(AM,"incFetch",{edge:o?T:g});}}else{if(AM.bounces){var AT=AD*2,AG=AM.bounceVelocity,k=AM.bounceTime,AO=AM.bounceDistance;if(!AM.hasBounced){AG[s]=Q.abs(S/Q.pow(1-AD,AA-AR-1));k[s]=I(S,AG[s],AT);AO[s]=Q.abs(E(t,AV,AG[s],k[s],AT)-t);AM.raiseEvent({name:"bounceOut",id:AM.identifier,axis:s,direction:AS,value:Q.round(t)});AM.hasBounced=true;}var AJ=Math.floor(AO[s]/2);var AI=E(AN,AV,AG[s],AR,AT),AL=Q.abs(AI-AN);if(Q.abs(AL)<AJ){return AI;}if(Q.abs(AL)>=AO[s]){F.call(AM);return AN;}var AH=AJ-(AL-AJ);return Q.round(AN-((AS)?-AH:AH));}t=AN;}}return Q.round(t);}function O(l){var k=this._scrollListener;if(k){if(!l||l!==k.el){b.detachEvent(k.el,"scroll",k.fn);delete this._scrollListener;return true;}return false;}return true;}var R=mstrmojo.TouchScroller=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.TouchScroller",scrollEl:null,identifier:"",hScroll:false,vScroll:false,offset:null,origin:null,transform:"",friction:0.0015,frameRate:60,bounces:true,hasBounced:false,bounceDistance:{},bounceTime:{},bounceVelocity:{},showScrollbars:false,showIndicators:true,useTranslate3d:true,STATUS_INC_FETCH:false,init:function Z(k){this._super(k);B.init();},initScroller:function Y(l){P.copy(l,this);var q=this.scrollEl;if(q){var p=this._isHosted=false;if(p){var k=q.parentNode;if(O.call(this,k)){k.style.overflow="auto";var s=this.id,o=this._scrollListener={el:k,fn:function(t){var w=mstrmojo.all[s].origin,x=t.target;w.x=x.scrollLeft;w.y=x.scrollTop;}};b.attachEvent(k,"scroll",o.fn);}this.showScrollbars=false;}}},canScroll:function K(){return this.vScroll||this.hScroll;},updateScrollBars:function G(w,p){var s=this.scrollEl;if(!this.showScrollbars||!s){return ;}var l=this._scrollBarEls;if(!l){var q=this;l=this._scrollBarEls={x:"hScroll",y:"vScroll"};U(l,function(x,z){if(q[x]){var AA=document.createElement("div");AA.className="mstrmojo-touch-scrollBar "+z+"Axis";(p||s.parentNode).appendChild(AA);l[z]=AA;}else{delete l[z];}});}if(!w){var k=this.scrollEl.parentNode;w={top:0,right:k.clientWidth,bottom:k.clientHeight,left:0};}var t=9,o={x:{left:w.left,top:w.bottom-t,x:w.right-w.left,d:"Width"},y:{left:w.right-t,top:w.top,x:w.bottom-w.top,d:"Height"}};U(l,function(AE,AB){var AJ=AE.style,AH=o[AB],AC=AH.d,AD=AE.parentNode,AI=AH.x;var AA=AH.left,AG=AH.top,AF=AI/s["offset"+AC],z=Math.min(Math.round(AI*AF),AI);AE.baseLeft=AA;AE.baseTop=AG;AE.ratio=AF;AE.viewportSize=AI;AE.length=z;AJ.left=AA+"px";AJ.top=AG+"px";AJ[AC.toLowerCase()]=z+"px";});},toggleScrollBars:function C(k){U(this._scrollBarEls,function(l){l.style.opacity=(k)?1:0;});},scrollTo:function(l,s,p){if(!this.canScroll()&&!(l===0&&s===0)){H(this,{x:0,y:0});return ;}var q=this.offset,o=this.origin,k={x:(this.hScroll)?X(l,q.x):0,y:(this.vScroll)?X(s,q.y):0};H(this,k,p);o.x=k.x;o.y=k.y;},scrollToEnd:function(l,s,p){var o=this.origin,q=this.offset,k={x:0,y:0};if(o&&q){mstrmojo.array.forEach([l,s],function(w,t){var z=(t)?"y":"x",x=q[z];k[z]=(w)?(x&&x.end)||0:o[z];});}this.scrollTo(k.x,k.y,p);},scroll:function D(s){if(this._isHosted){return ;}var p=this.offset,AC=this.scrollEl,AE=s.delta,AF=AE.x,AD=AE.y;if(!AC){return ;}if(!p&&this.showIndicators){B.scroll(this,{x:(this.noHScroll)?0:-AF,y:(this.noVScroll)?0:-AD},0,0,AC);return ;}var AB=this.origin,t={x:(this.hScroll)?Q.round(AB.x-AF):0,y:(this.vScroll)?Q.round(AB.y-AD):0},z=X(t.x,p.x),x=X(t.y,p.y);if(!p.scrollPast){if(this.showIndicators){B.scroll(this,t,z,x,AC);}t.x=z;t.y=x;}else{var q=(z!==t.x),w=(x!==t.y),k=(q||w),o=this._outOfBounds,l="";if(o){if(q!==(o.x===true)||w!==(o.y===true)){l="scrollIn";}}else{if(k){l="scrollOut";}}if(l){if(V(this.id,l)){var AA=s.direction;N(this,l,{x:{position:t.x,direction:AA.x},y:{position:t.y,direction:AA.y}});}if(k){this._outOfBounds={x:q,y:w};}else{delete this._outOfBounds;}}}H(this,t);},scrollEnd:function W(AD){B.hideAll();if(!this.canScroll()||this._isHosted){return ;}var AL=this.id,AE=this.friction,AT=1/(1-AE),AM=this.origin,p=AD.velocity,AR=AD.direction,AK=new Date(),q=this._outOfBounds,AA=this.offset,AS={x:this.hScroll,y:this.vScroll},AF={},AV={},AU={},AB={},t={},AC={},x={},w={},AO={},AQ=function(AY){AC[AY]=S;var AX=AA[AY],AW=(q&&q[AY]),AZ=(AW&&(!AX||!AA.scrollPast));AV[AY]=(AS[AY]&&!AZ)?AM[AY]-AD.delta[AY]:AM[AY];if(AX){x[AY]=AX.start;w[AY]=AX.end;if(AW){if(!AZ){AR[AY]=(AV[AY]<x[AY]);AO[AY]=(AR[AY])?x[AY]:w[AY];if(AR[AY]||!AX.incFetch){AC[AY]=S*3;p[AY]=AC[AY]/Q.pow((1-AE),(Q.log(1-Q.abs(AV[AY]-AO[AY])*(1-AT)/AC[AY])/Q.log(AT))-1);}}else{AV[AY]=X(AM[AY]-AD.delta[AY],AX);}}}AF[AY]=(AS[AY]&&!AZ)?Q.abs(p[AY]):0;AU[AY]=(AR[AY]||false)?1:-1;AB[AY]=I(AC[AY],AF[AY],AE);t[AY]=E(AV[AY],AU[AY],AF[AY],AB[AY],AE);};AQ("x");AQ("y");AM.x=AV.x;AM.y=AV.y;var AI=(AF.x>0),AH=(AF.y>0);if(!AA.scrollPast&&!AI&&!AH){F.call(this);var s,AN,AG,o,AP;for(s in AA){AN=AA[s];AP=AN.supportedEdges;AG=((AN.start===AV[s])&&((AP&g)>0));o=((AN.end===AV[s])&&((AP&T)>0));if(AN.incFetch&&(AG||o)){this.STATUS_INC_FETCH=true;N(this,"incFetch",{edge:(o)?T:g});}}return ;}this.hasBounced=false;this.bounceDistance={};this.bounceTime={};this.bounceVelocity={};this.decelerating=true;var l=Math.round(1000/this.frameRate),z=AK,AJ,k={x:AI,y:AH};this.decelerationTimer=window.setTimeout(function(){var AW=mstrmojo.all[AL],AX=AW.origin,Ab=new Date(),Ac=(Ab-AK),Aa;if(AW._halt){F.call(AW);return ;}AJ=Ab-z;z=Ab;if(AJ>(l+5)){l=l+Q.round((AJ-l)/2);}for(Aa in k){if(k[Aa]){var AZ=M(AW,AV[Aa],Aa,AR[Aa],AF[Aa],Ac,AB[Aa]);if(!isNaN(AZ)){AX[Aa]=AZ;}}}H(AW,AX);var AY=(Ac>AB.x&&Ac>AB.y);if(!AY&&!AW.bounces){AY=true;mstrmojo.hash.forEach(AA,function(Af,Ae){var Ad=AX[Ae];if(Ad!==Af.end&&Ad!==Af.start){AY=false;return false;}});}if(AY){F.call(AW);}else{if(AW.decelerating){AW.decelerationTimer=window.setTimeout(arguments.callee,l);}}},l);},stopDeceleration:function A(){var k=!!this.decelerating;if(k){if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}delete this.decelerating;this.toggleScrollBars(false);}delete this._outOfBounds;delete this.hasBounced;delete this.bounceDistance;delete this.bounceTime;delete this.bounceVelocity;delete this._halt;return k;},haltScroller:function J(){this._halt=!!this.decelerating;},unrender:function f(){delete this.scrollEl;},destroy:function h(){this.stopDeceleration();O.call(this);this._super();}});mstrmojo.TouchScroller.getScrollPositionTotals=function j(q){var o=q.parent,k=q._scroller,l=mstrmojo.hash.copy((k&&k.origin)||{x:0,y:0});if(o){var p=mstrmojo.TouchScroller.getScrollPositionTotals(o);l.x+=p.x;l.y+=p.y;}return l;};mstrmojo.TouchScroller.ScrollIndicators=B;R.EnumIncFetchEdges={start:g,end:T};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var A="SubscriptionsDataService";mstrmojo.SubscriptionsDataService=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.SubscriptionsDataService",getSubscriptions:function B(D,C){$MAPF(true,A);try{mstrApp.serverRequest({taskId:"getSubscriptions"},D,{src:A+"::getSubscriptions",override:true,showWait:!C,hideWait:!C,delay:false,skipLogin:true,noTaskURL:true});return false;}finally{$MAPF(false,A);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller","mstrmojo.dom");var I=0,L=1,K=2,T=3,J="CellInfo",V="Drill",S="Link",D=25,B=40,H=55,E=6,C=4,O=false,N="InfoViewer-Tab",G="InfoViewer-TabWrapper",U="InfoViewer-nTab",P="showAll",F="drillTo",M="linkTo",R="glow",Q=mstrmojo.css,A=[];A[N]=A[U]=function(Z){var X=Z.className;if(X==N){X=Z.parentNode.className;}for(var Y=0,W=this.tabs.length;Y<W;Y++){if(X.indexOf(this.tabs[Y].name)>-1){this.setCurrentTab(Y);break;}}this.xtab.magnifier.resizeAndPosition();};A[F]=function(){mstrApp.closeDialog();this.xtab.controller.onDrill(this.xtab,this.drillPaths[0].act);};A[M]=function(W){mstrApp.closeDialog();this.xtab.controller.onLink(this.xtab,this.linkPaths[W.getAttribute("lnk")].act);};A[P]=function(W){this.tabs[this.currentTabIndex].expanded=true;Q.removeClass(this.xtab.magnifier.containerNode,"hideMore");this.xtab.magnifier.resizeAndPosition();};mstrmojo.XtabMagnifierHelper=mstrmojo.declare(mstrmojo.Obj,null,{xtab:null,cellInfo:null,selectedCell:null,drillPaths:null,linkPaths:null,tabs:[],currentTabIndex:0,init:function(X){this._super(X);O=mstrApp.isTablet();var W=mstrMobileApp.getDeviceDPI();if(W<=120){B=26;H=35;D=15;}else{if(W<=160){B=35;H=46;D=20;}else{if(W<=213){B=46;H=61;D=26;}else{if(W<=240){B=53;H=69;D=30;}else{B=70;H=92;D=40;}}}}if(!O){C=3;}this.titleHeight=H;},glowOnTap:function(a){var Y=[G,P,F,M],X=a.className;if(X==N){a=a.parentNode;X=a.className;}for(var Z=0,W=Y.length;Z<W;Z++){if(X.indexOf(Y[Z])>-1){Q.addClass(a,R);setTimeout(function(){Q.removeClass(a,R);},200);break;}}},handleTouchTap:function(W){this.glowOnTap(W);for(n in A){if(W.className.indexOf(n)>-1){A[n].call(this,W);}}},handleTouchSwipe:function(d){if(!O){var Y=d.direction.x,b=d.delta,X=this.currentTabIndex,Z=this.tabs.length,W=parseInt(this.xtab.magnifier.width,10),a=isNaN(W)?50:W*0.2;if(Math.abs(b.x)>a){if(b.x>0){X=(X+Z-1)%Z;}else{X=(X+Z+1)%Z;}if(X!=this.currentTabIndex){this.setCurrentTab(X);this.xtab.magnifier.resizeAndPosition();}}}},resolveTouchEvent:function(a){var g=a.pageX,f=a.pageY,Y=document.elementFromPoint(g,f),h=this.xtab,W=h.zones,X,d;while(Y){var b=Y.className;if(!X&&Y.tagName==="TD"&&b&&b.toLowerCase().indexOf("xtab-td")>=0){X=Y;}if(/mstrmojo-XtabZone/.test(b)){for(var Z in W){if(Y==W[Z].domNode){d=W[Z];}}break;}Y=Y.parentNode;}if(X&&d){return{cell:X,zone:d,pos:{x:g-D,y:f-D,w:D*2,h:D*2}};}return null;},resolveInfoToDisplay:function(q){var h=q.cell,AF=q.zone,AJ=this.xtab,b=AJ.lockHeadersCase,w=parseInt(h.getAttribute("r"),10),Y,d,g,AC,f,AH,l,s,AG,a,AC,z,AB,AE,x,W,X=[],AI=this,t=function(AK,k,j){if(j){AI.selectedCell=k;X.unshift({title:AK,value:k});}else{X.push({title:AK,value:k});}};delete this.selectedCell;if(b==I||b==L){w=w-(Math.max(AJ.titlesCP.rc,AJ.chsCP.rc)||0);}else{if(AF.slot=="_TR"||AF.slot=="_TL"){w=-1;}}if(w<0){Y=AJ.getCellForNode(h);if(Y&&Y.o!==undefined){t(AJ.model.getCellTitleInfo(Y).title,Y,true);}else{return null;}}else{d=AJ.rhsCP.getUnmergedCells(w)||[];g={rh:d.concat(AJ.rhsCP.getRowCells(w)),vs:AJ.valuesCP.getRowCells(w),ch:[]};for(AC=0,z=AJ.chsCP.rc;AC<z;AC++){g.ch.push(AJ.chsCP.getRowCells(AC));}f=h.cellIndex;if(b==I||b==K||AF.slot=="_BL"){if(h.parentNode.sectionRowIndex===0){AH=f;}else{AH=f+d.length;}}else{AH=f+g.rh.length;}l=g&&g.rh.length;if(AH>=l){AH-=l;for(AB=0,AE=g.ch.length;AB<AE;AB++){s=0;for(x=0,W=g.ch[AB].length;x<W;x++){AG=g.ch[AB][x];a=(AG&&AG.cs)||1;if((AH>=s)&&(AH<s+a)){if(AG.mix!==undefined){t(AG,g.vs[AH],true);}else{if(AG.ui!=null||AG.tui!=null){t(AJ.model.getCellTitleInfo(AG).title,AG);}}break;}s+=a;}}if(!this.selectedCell){t(null,g.vs[AH],true);}AH=-1;}for(AC=0,z=l;AC<z;AC++){AG=g.rh[AC];t(AJ.model.getCellTitleInfo(AG).title,AG,AC==AH);if(AC==AH){break;}}}this.cellInfo=X;if(this.cellInfo){this.tabs=[];this.tabs.push({name:J,label:mstrmojo.desc(10638,"Info"),expanded:false,content:this.cellInfo});var Z=this.selectedCell,o=(Z.v!==undefined)&&!!(Z.at&1),p=!!(Z.at&4);if(o){this.drillPaths=[];this.drillPaths.push({n:AJ.model.getCellDrillsInfo(Z).n,act:AJ.model.getDrillAction([Z])});this.tabs.push({name:V,label:mstrmojo.desc(145,"Drill"),expanded:false,content:this.drillPaths});}else{this.drillPaths=null;}if(p){this.linkPaths=[];var AA=AJ.model.getCellLinksInfo(Z);for(var AC=0,AD=AA.links.length;AC<AD;AC++){this.linkPaths.push({n:AA.links[AC].n,act:AJ.model.getLinkAction(Z,AC)});}this.tabs.push({name:S,label:mstrmojo.desc(8149,"Link"),expanded:false,content:this.linkPaths});}else{this.linkPaths=null;}}return this.cellInfo;},createTitle:function(Y){var Z=[],b=0,a=this.tabs,X=a.length,d,W;for(;b<X;b++){d=a[b];if(O){Z.push('<div class="',G," ",d.name,'" style="height:'+(H-E)+'px;" >');Z.push('<div class="',N,'">',d.label,"</div>");Z.push("</div>");}else{Z.push('<div class="',U," ",d.name,'" >',d.label,"</div>");}}Y.style.lineHeight=Y.style.height=H+"px";Y.innerHTML=Z.join("");this.setCurrentTab();},createContent:function(d){var Y=this.cellInfo,W=this.drillPaths,X=this.linkPaths,b=[],h=[],g=this.xtab,Z=function(j,o,k){function p(x,t){var q=[],s=(t==="value"&&!O)?B/2:B;q.push('<td><div class="',t,'" style="line-height:',s,"px;max-height:",B,'px;" >');if(x){if(x.ts==4){var l=(x.n||x.v),w=g.controller&&g.controller.model&&g.controller.model.dataService;if(w&&w.getImage){l=w.getImage(l);}q.push('<img src="'+l+'"/>');}else{q.push(x.n||x.v||"&nbsp;");}}q.push("</div></td>");return q.join("");}h.push('<tr style="height:',B,'px">',p(j,"title"),p(o,"value"),"</tr>");},a,f;if(Y==null){return ;}for(a=0,f=Y.length;a<f;a++){Z(Y[a].title,Y[a].value);}b.push('<table class="content">');b.push(h.join(""));b.push("</table>");if(W){b.push('<div class="actionMenu hide">');for(var a=0,f=W.length;a<f;a++){b.push('<div class="drillTo" style="line-height:',B,'px">',W[a].n,"</div>");}b.push("</div>");}if(X){b.push('<div class="actionMenu hide">');for(var a=0,f=X.length;a<f;a++){b.push('<div class="linkTo" style="line-height:',B,'px" lnk="',a,'">',X[a].n,"</div>");}b.push("</div>");}b.push('<div class="',P,'" style="line-height:',B,'px" >'+mstrmojo.desc(8995,"See all...")+"</div>");d.innerHTML=b.join("");},setCurrentTab:function(h){var X=h||0,g=this.tabs,Y=g[X],W=g.length,d=this.xtab.magnifier,g=d.titleNode.children,Z=d.containerNode.children,b,f,a;this.currentTabIndex=X;for(b=0;b<W;b++){Q.toggleClass(g[b],"selected",b==X);if(!O){if(W<=2){Q.toggleClass(g[b],"left",b!=X);}else{Q.toggleClass(g[b],"left",b==(X+W-1)%W);}Q.toggleClass(g[b],"right",b==(X+W+1)%W);}}for(b=0,f=Z.length-1;b<f;b++){Q.toggleClass(Z[b],"hide",b!=X);if(b==X){this.contentNode=Z[b];}}Q.toggleClass(d.containerNode,"hideMore",!Y.expanded&&Y.content.length>C);},getContentHeight:function(){function a(d){var f=d.content,g=f.length,b=d.expanded;return(!b&&g>C)?(B+1)*(C+1):(B+1)*g;}var Z=this.tabs;if(O){return a(Z[this.currentTabIndex]);}else{var X=0;for(var Y=0,W=Z.length;Y<W;Y++){X=Math.max(a(Z[Y]),X);}return X;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.TouchScroller");var d=mstrmojo.array.forEach,S=mstrmojo.hash.forEach,Y=mstrmojo.dom;function M(g,h){var f;for(f in g){Y.translate(g[f],h[0],h[1],h[2]);}}function P(g){var f=Math.abs;return{x:(f(g.accelDelta.x)<f(g.accelDelta.y)),y:(f(g.accelDelta.y)<f(g.accelDelta.x))};}function I(f,g){f.raiseEvent({name:"scrolledOut",value:g.value,axis:g.axis,direction:g.direction});}function O(g,l,q,o,s,f,k,j){var p=new mstrmojo.TouchScroller({scrollEl:g,vScroll:q,hScroll:o,frameRate:s,showScrollbars:f,offset:l,origin:{x:0,y:0},bounces:false,useTranslate3d:false,indicatorEl:j});if(k){p.friction=k;}return p;}function B(f){var g;for(g in f){if(f[g].decelerating){f[g].stopDeceleration();}}}var Q={x:false,y:false};function T(){var f=Q;if(!f.x){return"x";}if(!f.y){return"y";}return null;}var N={x:false,y:false};function L(j,k){var g=T(),h=j.scrollerConfig.scrollPast;if(!g||!h){return !!g&&!h;}function f(p){var l=j.viewport,o=j._TSN[p],w=j._scroller[p],x=j.tPos[p],q=k[p],z=N[p],s=(p==="x")?"y":"x",AB=j._scroller[s],AA=N[s],t;if(!AB[0].decelerating&&AA){f(s);}if(x<=0&&q>0){if(!z){if(AA){return false;}M(o,[0,0,0]);for(t in w){w[t].scrollEl=l;}N[p]=true;}}else{if(z){M([l],[0,0,0]);for(t in w){w[t].scrollEl=o[t];}N[p]=false;}}return true;}return f(g);}function E(p,f){var k=f.axis,j=p.scrollboxHeightFixed,o=f.name;if(p.ss){var l=p.zones._BR.getRowInfoByPosition(f[k]);l.position=f[k];p.ss.onMove(l);}p.tPos[k]=f[k];if(o==="scrollDone"){S(p._scroller,function(q){d(q,function(s){s.toggleScrollBars(false);});});if(!L(p,f)){return true;}}if(k==="y"){var h=function(q){if(!p._isDownloading&&(-q<=p._TMAX[k])){if(p.onScrolledToLastRow){p.onScrolledToLastRow();}}};if(o==="scrollDone"){delete p._isDecelerating;if(p._cachedDownload){p.dataDownloaded();}else{h(f.y);}if(j){var g=f.y;p.notifyScrollListeners({x:f.x,y:Math.max(g,0)});}}else{if(o==="scrollDecel"){p._isDecelerating=true;h(f.fY);if(j){p.notifyScrollListeners({x:f.fX,y:f.fY});}}else{if(o==="scrollOut"){p._isDecelerating=true;h(f.y.position);}}}}}function H(j,h){var f=Math.abs,k={};var g=k[h]={start:j._TMIN[h],end:f(j._TMAX[h])};k.scrollPast=j.scrollerConfig.scrollPast;if(h==="y"){if(j.useSeamlessIncFetch){g.incFetch=!j.endFetching;g.pageSize=j.scrollboxHeight-((parseInt(j.gridData.rh,10)||25)*4);}}return k;}function V(f){f._scroller={x:[],y:[]};var g=f._viewportCoords;S(f._TSN,function(k,l){var q=H(f,l),o=(l==="y"),p=(l==="x"),h=k.length;d(k,function(x,w){var t=O(x,q,o,p,f.frameRate,(w===h-1)&&f.scrollerConfig.showScrollbars,f.scrollerFriction,f.domNode);t.updateScrollBars(g,f.domNode);f._scroller[l][w]=t;});var s=f._scroller[l][0],j=["scrollDone","scrollMoved"];if(s){if(o){j=j.concat(["scrollDecel","scrollOut"]);}d(j,function(t){s.attachEventListener(t,f.id,function(w){w.axis=l;E(f,w);});});}});}function A(g){if(this.hasRendered){this[g+"Limit"]=parseInt(this[g],10);if(this.zones){var f=this;window.setTimeout(function(){if(f.hasRendered){f.setOffsets();f.setupScrollers();}},0);}}}mstrmojo._HasXtabTouchScroll=mstrmojo.provide("mstrmojo._HasXtabTouchScroll",{noScrolling:false,useTouchScrolling:true,scrollerConfig:{showScrollbars:false,scrollPast:false},_TSN:null,tPos:{x:0,y:0},_TMIN:{x:0,y:0},setupTNs:function R(){this._TSN.x=this._TSN.y=[this.domNode];},touchBegin:function W(k){if(!this.noScrolling){k.stop();if(!this._isDownloading){if(this.toolbarMgr){this.toolbarMgr.closeToolbar();}var j=this._scroller,g=this._TMIN,f=this._TMAX;S(this.tPos,function(l,o){if(l>=g[o]&&l<=Math.abs(f[o])){B(j[o]);}});}var h=this._scroller.x;S(h,function(l){l.origin.x=h[0].origin.x;});}return true;},touchSwipeBegin:function U(o){if(this.noScrolling){return this.bubbleTouchEvent(o);}if(this._isDownloading){return false;}Q=P(o);var h=Q.y?"x":"y",f=this._scroller[h][0],k=f.offset,j=k[h][o.direction[h]?"end":"start"];if(!k.scrollPast&&j===f.origin[h]){var l=this.bubbleTouchEvent(o);if(l!==undefined){return l;}}var g=this._scroller;if(!L(this,o.delta)){return true;}if(!Q.x){B(g.x);}if(!Q.y){B(g.y);}S(this._scroller,function(q,p){if(!Q[p]){d(q,function(s){s.toggleScrollBars(true);});}});return true;},touchSwipeMove:function D(g){if(!L(this,g.delta)){return true;}var f=this._scroller;d(["x","y"],function(h){if(!Q[h]){S(f[h],function(j){j.scroll(g);});}});},touchSwipeEnd:function X(o){var g=Q,j=null,l=o.delta,k=o.direction;if(!g.x&&l.x!==0){j="x";k=k.x?"left":"right";}if(!g.y&&l.y!==0){j="y";k=k.y?"up":"down";}if(j){I(this,{axis:j,value:this.tPos[j],direction:k});var f=this._scroller[j],h;if(!g[j]){for(h in f){f[h].scrollEnd(o);}}}},gridPagesRendered:function C(){if(this._super){this._super();}this.setOffsets();},renderEmptyGrid:function F(){if(this._super){this._super();}this.noScrolling=true;},postBuildRendering:function a(){if(this._super){this._super();}if(this.zones&&!this.gridData.eg){var f=this;window.setTimeout(function(){if(f.hasRendered){f._TSN={x:[],y:[]};f.setupTNs();f.setupScrollers();}},0);}},setOffsets:function b(){var j=this,h=this.domNode,g=this.zones,l=g._TR,f=g._BL,k=(!this.isFullScreenWidget&&this.isDocXtab),o=this._viewportCoords={top:l?l.cp.rc*parseInt(this.gridData.rh,10):0,right:k?this.widthLimit:parseInt(this.width,10),bottom:k?this.heightLimit:parseInt(this.height,10),left:f?f.totalColWidth:0};S(this._scroller,function(q,p){d(q,function(s){s.offset=H(j,p);s.updateScrollBars(o,h);var t=s.origin;if(t){s.scrollTo(t.x,t.y);}});});},setupScrollers:function G(){var h=this.gridData,g=this._TMAX,f=this.noScrolling=((h&&h.co)||(!this.scrollerConfig.scrollPast&&g.x===0&&g.y===0));if(!f&&!this._scroller){N={x:false,y:false};M(this._TSN.x,[0,0,0]);M(this._TSN.y,[0,0,0]);V(this);}},onwidthChange:function K(){A.call(this,"width");if(this._super){this._super();}},onheightChange:function J(){A.call(this,"height");if(this._super){this._super();}},unrender:function Z(f){S(this._scroller,function(g){d(g,function(h){h.destroy();});});delete this._scroller;if(this._super){this._super(f);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller");var C={v:{axis:"y",dimension:"height"},h:{axis:"x",dimension:"width"}};mstrmojo.android._IsIncFetchList=mstrmojo.provide("mstrmojo.android._IsIncFetchList",{_mixinName:"mstrmojo.android._IsIncFetchList",supportsIncFetch:true,ifDataHelper:null,ifDirection:"v",supportedEdges:mstrmojo.TouchScroller.EnumIncFetchEdges.end,initScroller:function B(E){this._super(E);var F=this.ifDataHelper;if(F){E.attachEventListener("incFetch",this.id,function(G){if(!this.supportsIncFetch){return ;}var H=this;F.next({success:function(J,I){H.addItems(I||J.items);H._scroller.STATUS_INC_FETCH=false;},failure:function(I){mstrmojo.alert("Error in fetching next: "+I);}},G.edge);});}},updateScrollerConfig:function D(){var E=this._super(),I=this.supportsIncFetch,F=this.ifDirection,H=C[F];if(E[F+"Scroll"]){var G=E.offset[H.axis];G.incFetch=I;G.supportedEdges=this.supportedEdges;G.pageSize=I?(parseInt(this[H.dimension],10)-100):0;this.scrollerConfig=E;}return E;},addItems:function A(E){this._super(E);this.supportsIncFetch=((this.ifDataHelper.totalSize===-1)||(this.items.length<this.ifDataHelper.totalSize));if(this.updateScroller){this.updateScroller();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.TouchScroller");var E=mstrmojo.dom,A=Math;function F(K,L){return(L)?A.max(A.min(A.round(K),L.end),L.start):K;}mstrmojo._NeedSyncScroller=mstrmojo.provide("mstrmojo._NeedSyncScroller",{init:function J(K){if(this._super){this._super(K);}if(!this.lisenters){this.lisenters=[];}},initScroller:function H(K){if(this._super){this._super(K);}this._scrollMovedListener=this._scroller.attachEventListener("scrollMoved",this.id,function(L){this.onScrollMoved(L);});this._scrollDoneListener=this._scroller.attachEventListener("scrollDone",this.id,function(L){this.onScrollDone(L);});},onScrollMoved:function B(K){if(this._super){this._super(K);}this.syncScroller(K,true);},onScrollDone:function G(K){if(this._super){this._super(K);}this.syncScroller(K,false);},syncScroller:function C(O,N){if(!O||O.x==undefined||O.y==undefined){return ;}var M=this.lisenters,L=this.lisenters.length;for(var P=0;P<L;P++){var K=M[P]._scroller,Q=K.offset;K.origin={x:K.hScroll?O.x:0,y:K.vScroll?O.y:0};E.translate(K.scrollEl,-K.origin.x,-K.origin.y,0,K.transform,K.useTranslate3d);K.toggleScrollBars(N);mstrmojo.hash.forEach(K._scrollBarEls,function(b,W){var j=(W==="x"),a=O[W],R=b.length,d=b.ratio,Y=b.viewportSize,V=6/R,U=b["base"+((j)?"Left":"Top")],Z=U+Y-R,T=A.round(U+(d*a));if(T<U){T=U-a;R+=a;}else{if(T>Z){var h=(a-K.offset[W].end)*d;T=A.min(Z+h,Y+U-6)-1;R-=h;}}var g=0,S=[g,g,g],X=[1,1,1],f=(j)?0:1;S[f]=(T-U);X[f]=A.min(A.max(R/b.length,V),1);E.translate(b,S[0],S[1],S[2]," scale3d("+X.join(",")+")");});}},addSyncScroller:function D(K){this.lisenters.push(K);},destroy:function I(){this.lisenters=null;if(this._scrollDoneListener){this._scroller.detachEventListener(this._scrollDoneListener);delete this._scrollDoneListener;}if(this._scrollMovedListener){this._scroller.detachEventListener(this._scrollMovedListener);delete this._scrollMovedListener;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller","mstrmojo.hash");var H=mstrmojo.hash;mstrmojo._HasTouchScroller=mstrmojo.provide("mstrmojo._HasTouchScroller",{_meta_usesSuper:true,scrollerConfig:{},allowTouchBubble:true,scrollerSetupDelay:undefined,init:function M(S){this._super(S);this.scrollerConfig=H.clone(this.scrollerConfig);},updateScrollerConfig:function P(){return this.scrollerConfig;},updateScroller:function F(V,W){var S=this._scroller;if(S){var T=this.updateScrollerConfig();S.initScroller(T);if(!V){var U=T.origin;if(U){S.scrollTo(U.x,U.y,W);}}S.updateScrollBars();}},initScroller:mstrmojo.emptyFn,useSelectScroll:false,postBuildRendering:function Q(){var S=this._scroller;if(!S){S=this._scroller=new mstrmojo.TouchScroller();this.initScroller(S);}else{S.haltScroller();}if(!this.layoutConfig){var U=this,T=this.scrollerSetupDelay;if(!isNaN(T)){window.setTimeout(function(){U.updateScroller();},T);}else{this.updateScroller();}}if(this._super){this._super();}},afterLayout:function G(){this._super();this.updateScroller();},getScrollPos:function A(){return H.copy(this._scroller.origin||{x:0,y:0});},shouldTouchBubble:function I(V){if(!this.allowTouchBubble){return false;}var S=this._scroller,U=V.isVertical,T=(U)?"y":"x";return(!S[((U)?"v":"h")+"Scroll"]||S.offset[T][V.direction[T]?"end":"start"]===S.origin[T]);},touchBegin:function L(S){this._scroller.haltScroller();return(this._super&&this._super(S))||true;},touchSwipeBegin:function J(S){if(this.shouldTouchBubble(S)){if(this.bubbleTouchEvent(S)===false){this._touchCanceled=true;}return ;}if(this._super){this._super(S);}this._scroller.toggleScrollBars(true);},touchSelectBegin:function B(S){if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeBegin(S);}},touchSwipeMove:function C(S){if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scroll(S);},touchSelectMove:function E(S){if(!this._touchCanceled){if(this._super){this._super(S);}}if(this.useSelectScroll){this.touchSwipeMove(S);}},touchSwipeEnd:function N(S){S.evt.handled=true;if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scrollEnd(S);},touchSelectEnd:function K(S){if(this._touchCanceled){return ;}if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeEnd(S);}},touchEnd:function D(S){if(this._touchCanceled){delete this._touchCanceled;return ;}if(this._super){this._super(S);}},unrender:function O(T){var S=this._scroller;if(S){S.unrender();}delete this.scrollerConfig.scrollEl;this._super(T);},destroy:function R(){if(this._scroller){this._scroller.destroy();delete this._scroller;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.mstr.EnumDataType","mstrmojo.mstr.EnumNodeType","mstrmojo.mstr.WebNode");var B=mstrmojo.mstr.EnumNodeType,A=mstrmojo.mstr.EnumDataType;mstrmojo.mstr.WebConstantNode=mstrmojo.declare(mstrmojo.mstr.WebNode,null,{scriptClass:"mstrmojo.mstr.WebTimeNode",nodeType:B.NodeConstant,value:"",type:A.DataTypeUnknown,buildTypeSpecificShortXML:function C(D){D.addChild("cst").addAttribute("ddt",this.type).addText(this.value).closeElement();}});})();(function(){mstrmojo.requiresCls("mstrmojo.mstr.EnumNodeType","mstrmojo.mstr.WebNode");var A=mstrmojo.mstr.EnumNodeType;mstrmojo.mstr.WebTimeNode=mstrmojo.declare(mstrmojo.mstr.WebNode,null,{scriptClass:"mstrmojo.mstr.WebTimeNode",nodeType:A.NodeTime,value:"",time:null,buildTypeSpecificShortXML:function B(C){C.addText(this.value);}});})();(function(){mstrmojo.requiresCls("mstrmojo.mstr.EnumExpressionType","mstrmojo.mstr.EnumNodeDimty","mstrmojo.mstr.EnumFunction","mstrmojo.mstr.EnumNodeType","mstrmojo.mstr.EnumWebFunctionType","mstrmojo.mstr.WebNode");var E=mstrmojo.mstr.ExpressionType,F=mstrmojo.mstr.EnumNodeDimty,B=mstrmojo.mstr.EnumFunction,C=mstrmojo.mstr.EnumNodeType,G=mstrmojo.mstr.EnumWebFunctionType;var A=function(H){return H==E.FilterSingleMetricQual||H==E.FilterMetricExpression||H==E.FilterMultiMetricQual;};mstrmojo.mstr.WebOperatorNode=mstrmojo.declare(mstrmojo.mstr.WebNode,null,{scriptClass:"mstrmojo.mstr.WebOperatorNode",nodeType:C.NodeOperator,func:B.FunctionReserved,funcType:G.WebFunctionTypeGeneric,property:"",onExprTypeChange:function(){if(A(this.exprType)){this.dimType=F.NodeDimtyUnspecified;}},on_set_func:function(L,H){var J=false;if(this.funcType==G.WebFunctionTypePercentQual||this.funcType==G.WebFunctionTypeRankQual){var K=H;switch(K){case EnumWebMRPFunction.WebMRPFunctionTop:this.func=B.FunctionLessEqual;this.property='<pr ix="4" v="0"/>';break;case EnumWebMRPFunction.WebMRPFunctionBottom:this.func=B.FunctionLessEqual;this.property='<pr ix="4" v="-1"/>';break;case EnumWebMRPFunction.WebMRPFunctionBetween:this.func=B.FunctionBetween;if(J){this.property="";}else{this.property='<pr ix="4" v="0"/>';}break;case EnumWebMRPFunction.WebMRPFunctionExcludeTop:this.func=B.FunctionGreater;this.property='<pr ix="4" v="0"/>';break;case EnumWebMRPFunction.WebMRPFunctionExcludeBottom:this.func=B.FunctionGreater;this.property='<pr ix="4" v="-1"/>';break;case EnumWebMRPFunction.WebMRPFunctionNotBetween:this.func=B.FunctionNotBetween;if(J){this.property="";}else{this.property='<pr ix="4" v="0"/>';}break;case EnumWebMRPFunction.WebMRPFunctionEquals:this.func=B.FunctionEquals;this.property="";break;case EnumWebMRPFunction.WebMRPFunctionDifferentFrom:this.func=B.FunctionNotEqual;this.property="";break;case EnumWebMRPFunction.WebMRPFunctionBanding:this.func=B.FunctionBanding;this.property='<pr ix="4" v="0"/>';break;case EnumWebMRPFunction.WebMRPFunctionBandingC:this.func=B.FunctionBandingC;this.property='<pr ix="4" v="0"/>';break;case EnumWebMRPFunction.WebMRPFunctionBandingP:this.func=B.FunctionBandingP;this.property='<pr ix="4" v="0"/>';break;case EnumWebMRPFunction.WebMRPFunctionBandingM:this.func=B.FunctionBandingM;this.property='<pr ix="4" v="0"/>';break;default:}if(this.funcType==G.WebFunctionTypePercentQual){this.property+='<pr ix="5" v="0"/>';}else{this.property+='<pr ix="5" v="-1"/>';}var I=null;if(this.childNodes&&this.childNodes.length>0){I=this.childNodes[0];}if(I!=null){I.setPropertyStr(property);}}else{this.func=H;}},buildTypeSpecificShortXML:function D(I){I.addChild("op").addAttribute("fnt",this.func).closeElement();var H=this.property;if(H){I.addChild("prs").addRawXML(H).closeElement();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.mstr.EnumNodeType","mstrmojo.mstr.WebNode");var A=mstrmojo.mstr.EnumNodeType;mstrmojo.mstr.WebFormShortcutNode=mstrmojo.declare(mstrmojo.mstr.WebNode,null,{scriptClass:"mstrmojo.mstr.WebFormShortcutNode",nodeType:A.NodeFormShortcut,attribute:null,form:null,buildTypeSpecificShortXML:function B(C){if(this.attribute){this.attribute.buildShortObjectElt(C);}if(this.form){this.form.buildShortObjectElt(C);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.mstr.WebOI","mstrmojo.mstr.WebElements");mstrmojo.mstr.WebAttribute=mstrmojo.declare(mstrmojo.mstr.WebOI,null,{scriptClass:"mstrmojo.mstr.WebAttribute",t:12,elemTotalSize:0,browseConfig:null,init:function(A){var B=this.browseConfig={};if(A){if(A.bb){B.blockBegin=A.bb;delete A.bb;}if(A.bc){B.blockCount=A.bc;delete A.bc;}if(A.sz){this.totalSize=A.sz;delete A.sz;}}this.browseConfig={};if(this._super){this._super(A);}},getElements:function(A){A=mstrmojo.hash.copy((this.browseConfig||{}),(A||{}));return new mstrmojo.mstr.WebElements({source:this,totalSize:this.totalSize||0,browseConfig:A});}});})();(function(){mstrmojo.requiresCls("mstrmojo.mstr.WebOI");mstrmojo.mstr.WebFilter=mstrmojo.declare(mstrmojo.mstr.WebOI,null,{scriptClass:"mstrmojo.mstr.WebFilter",t:1,expression:null,buildTypeSpecificShortXML:function A(B){if(this.expression){this.expression.buildShortXML(B);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.mstr.WebOI");mstrmojo.mstr.WebAttributeForm=mstrmojo.declare(mstrmojo.mstr.WebOI,null,{scriptClass:"mstrmojo.mstr.WebAttributeForm",t:21});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Model","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.StringBuffer","mstrmojo.EnumReadystate");var q=mstrmojo.EnumRWUnitType,J=mstrmojo.EnumReadystate,w=mstrmojo.hash.forEach,O=mstrmojo.func.wrapMethods,a=mstrmojo.array;var AF={isObservable:function(AL){var AK=AL&&AL.t;if(!AK||!(AK in this)||AL.scriptClass){return false;}return(AK!==q.SUBSECTION||!AL.dt);},makeObservable:function(AK){AK.audibles=this[AK.t]||{};if("readyState" in AK.audibles){AK.readyState=J.IDLE;}return new mstrmojo.Model(AK);}};AF[q.PANELSTACK]={"*":false,selKey:true,readyState:true};AF[q.GRID]={"*":false,readyState:true,ds:true};AF[q.GRAPH]={"*":false,readyState:true,ds:true};AF[q.GRIDGRAPH]={"*":false,qsm:true,ds:true};AF[q.SUBSECTION]={"*":false,resize:true,adjustSize:true};AF[q.VISUALIZATION]={"*":false,ds:true};AF[q.SELECTOR]={"*":false,cek:true,ds:true};AF[q.MOJOVISUALIZATION]={"*":false,ds:true};function G(AO,AP){var AL=AO.layoutMap&&AO.layoutMap[AP];if(AL){return AL;}var AK=AO.layouts,AN=(AK&&AK.length)||0,AM=0;for(AM=0;AM<AN;AM++){if(AK[AM].k==AP){return AK[AM];}}return null;}function H(AM,AO,AL){var AK=G(AM,AO);if(AL==AO){AK._lkz=AO;return AK;}else{if(AK){var AN=AK.units[AL];if(AN){if(AN.t==q.GRIDGRAPH){if(!AK.units[AL+"_0"]){AK.units[AL+"_0"]={ck:AN.ck,fmts:AN.fmts.gd,txi:AN.txi,t:q.GRID};AK.units[AL+"_1"]={ck:AN.ck,fmts:AN.fmts.gp,t:q.GRAPH};}}if(AF.isObservable(AN)){AN=AK.units[AL]=AF.makeObservable(AN);}AN._lkz=AO;}}}return AK&&AK.units[AL];}function AJ(AO,AN,AM,AK){var AL=this.getChildren(AO,AN,0);return(mstrApp.isMobile?(mstrmojo.array.filter(AL,function(AR){var AP=AM&&AM.indexOf(AR.defn.t),AQ=AR.defn.dk;return AK?(AP>-1&&AQ===-1):(AP<0||AQ!==-1);})):(AK?[]:AL));}var l=function(AK,AL){var AM=new mstrmojo.StringBuffer();if(AL){AM.append("*l"+AL);}AM.append("*k"+AK.k);if("wid" in AK){AM.append("*x"+AK.wid);}AM.append("*t"+this.buildTime);return AM.toString();};function h(AM){var AL,AK,AP=this.delta,AN=this.pendingUpdate,AO=[];if(!AN){AN=this.pendingUpdate={};}if(!mstrmojo.hash.isEmpty(AP)){AO.push("<updates>");for(AL in AP){if(AP.hasOwnProperty(AL)){AK=AP[AL];AO.push(AK.getUpdates());}}AN[AM]=AP;this.delta={};AO.push("</updates>");}return AO.join("");}function d(AN,AO){var AK;if(AN){AN=AN.split(AO||"\u001E");for(var AM=0,AL=AN.length;AM<AL;AM++){AK=AK||{};AK[AN[AM]]=H.call(this,this.defn,this.currlaykey,AN[AM]);}}return AK;}function A(AM,AN){var AK=AN.ulkeys,AL=AM.controller.view;if(AL&&AL.unloadLayouts&&AK&&AK.length){AL.unloadLayouts(AK);}}function P(AL,AK){var AM=this.getLayoutUnitDefn(AL,AK);return(AM&&AM.t===q.PANELSTACK&&AM.ifw);}function o(AL,AK){return !AK||(AL.wid==AK);}function K(){var AL=this.data&&this.data.layouts,AK=AL[a.find(AL,"k",this.getCurrentLayoutKey())],AN=AK&&AK.gbys&&AK.gbys.groupbys,AM=false;a.forEach(AN,function(AO){if(AO.unit&&AO.unit.elms&&AO.unit.elms[AO.unit.idx].v==="u;"){AM=true;return false;}});return AM;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true},features:null,dataCache:null,controller:null,sdp:null,init:function z(AK){this._super(AK);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();this.buildTime=mstrmojo.now();},makeObservable:function U(AK){return AF.makeObservable(AK);},getTargetDefn:function(AK){return d.call(this,AK);},getTargetInfoWin:function(AL){var AK=[],AM=d.call(this,AL);if(AM){var AN;for(AN in AM){if(AM[AN]&&AM[AN].ifw){AK.push(AN);}}}return AK;},getUnitDefinitions:function(AK,AL){return d.call(this,AK,AL);},hasFeatures:function t(AO){var AM=this.features;if(!AM){return false;}var AL=AO.split(",");for(var AN=0,AK=AL.length;AN<AK;AN++){var AP=AL[AN],AQ=AP.match(/^\!/);if(AQ){AP=AP.replace("!","");}if(AQ?this.features[AP]:!this.features[AP]){return false;}}return true;},ondefnChange:function j(){var AP=this.defn,AM=AP&&AP.layouts,AL={};if(AP){AP.layoutMap=AL;for(var AO=0,AN=AM&&AM.length||0;AO<AN;AO++){var AK=AM[AO];AL[AK.k]=AK;}}},formatResolver:{getFormat:function L(AO,AN){var AM=((AO&&AO.fmts)||null);if(AN){var AQ=AO.thresholds,AL=AQ&&AQ[AN];if(AL){var AP={},AR;for(AR in AM){AP[AR]=AL[AR]||AM[AR];}for(AR in AL){var AK=AL[AR];AP[AR]=(typeof (AK)==="string")?(AK+" !important"):AK;}AM=AP;}}return AM;}},getSelectedXtabStyles:function W(AM){var AL=AM||this.currlaykey;var AO={};var AK=this.data&&this.data.layouts;for(var AN in AK){if(AK[AN].k===AL){AO=AK[AN].xtabStyles;break;}}return AO;},getChildren:function AA(Aa,AK,AR,AS,AQ){var AV=this.currlaykey;if(Aa){var AN=Aa.defn;AV=(AN&&AN._lkz)||Aa.k;}var Al=this.getLayoutDataCache(AV),Ab=(!AK&&!mstrmojo.hash.isEmpty(Al)),Ah;if(!Aa){Ah=this.data;}else{var AT=Aa.data||Aa;if(Ab){Ah=Al[l.call(this,AT,AV)];Ah=(Ah&&Ah.data)||Ah||AT;}else{Ah=AT;}}var AL=Ah?(Ah.sections||Ah.subsections||Ah.objects||Ah.panels||Ah.layouts||Ah.children):[],AW=[];var Ae=(AL&&AL.length)||0;if(Ae){var AN=this.defn,AY=!Aa,AU=Aa?AV:null,AP=(Aa&&((Aa.defn)?Aa.defn.t:H.call(this,AN,AU,Aa.k).t));var AM=(AP===q.GRIDGRAPH),Af=(AP===q.DETAILS);for(var Ad=AR||0,Ac=(isNaN(AS))?Ae:Ad+AS;Ad<Ac;Ad++){var Aj=AL[Ad];if(AM){Aj.k=Aa.k;Aj.wid=Aa.data.wid;}var Am=Aj.k,AZ=l.call(this,Aj,AU),Ai;if(!AY&&!AK&&P.call(this,Am,AU)){var Ag=this.getLayoutUnitDefn(Am),AX={data:Aj,defn:Ag,id:AZ,k:Am,p:Ah};Al[AZ]=AX;if(!this.infoWinByKey||!this.infoWinByKey[Am]){var AO=this.infoWindows=this.infoWindows||{};var Ak=this.infoWinByKey=this.infoWinByKey||{};AO[Ag.n]=Ak[Am]=AX;}continue;}if(AM){AZ+="_"+Ad;Ai=H.call(this,AN,AU,Aj.k+"_"+Ad);}else{Ai=H.call(this,AN,AU||Aj.k,Aj.k);}if(Af){Ai.dt=true;}AW.push({k:Aj.k,id:AZ,defn:Ai,data:Ab?(Al[AZ]&&Al[AZ].data)||Aj:Aj});}}return AQ?{nodes:AW,total:Ae}:AW;},getInfoWindow:function s(AL){var AK=this.infoWindows;return AK&&AK[AL];},getFixedHeaders:function(AL,AK){return AJ.call(this,AL,AK,[q.PAGEHEADER],true);},getFixedFooters:function(AL,AK){return AJ.call(this,AL,AK,[q.PAGEFOOTER],true);},getNonFixedSections:function(AL,AK){return AJ.call(this,AL,AK,[q.PAGEHEADER,q.PAGEFOOTER],false);},getLayoutUnitDefn:function E(AL,AK){return H.call(this,this.defn,AK||this.currlaykey,AL);},getUnitInstance:function S(AK,AL){return mstrmojo.all[l.call(this,{k:AK,wid:AL},this.currlaykey)];},getFirstUnitInstanceByName:function p(AM){var AK=G(this.defn,this.currlaykey);if(AK){var AL=AK.units;for(u in AL){var AN=AL[u];if(AN.n===AM){return this.getUnitInstance(u,1);}}}return null;},getSelectedKey:function AG(AK){return(!AK&&this.currlaykey)||null;},getCurrentLayoutKey:function AB(){return this.currlaykey;},getCurrentLayoutDef:function AD(){var AK=this.defn&&this.defn.layouts;return AK&&AK[a.find(AK,"k",this.currlaykey)];},replaceLayout:function C(AN,AO){var AL=this.dataCache;if(AL&&AL[AN]){AL[AN]={};}var AK=(this.data&&this.data.layouts)||(this.defn&&this.defn.layouts);for(var AM=(AK&&AK.length-1)||0;AM>=0;AM--){if(AK[AM].k===AN){break;}}this.bs=AO.bs;this.zf=AO.zf;if(AO.data){this.data.layouts[AM]=AO.data.layouts[AM];this.data.elems=AO.data.elems;}if(AO.defn){this.defn.layouts[AM]=AO.defn.layouts[AM];this.ondefnChange();}},loadLayout:function g(AK,AM,AL){this.replaceLayout(AK.currlaykey,AK);this.raiseEvent({name:"rebuildLayout",unloadCache:!!AM,restoreIW:!!AL});},getTransactionUpdates:function AI(AK){return this.txDiscardTargets?"":h.call(this,AK);},clearTransactionUpdates:function AC(AK){this.clearTxDeltaUpdate(AK);},resetTransactionUpdates:function B(AK){var AL=this.pendingUpdate,AM=this.delta;if(AL&&AL[AK]){w(AL[AK],function(AN,AO){if(AM&&!AM[AO]){AM[AO]=AN;}});delete AL[AK];}},getDataService:function N(){var AM=this.dataService,AK=this;if(!AM){var AL={rwb:this.bs,msgId:this.mid,model:this};if(mstrApp.modelFactory){AM=mstrApp.modelFactory.newDataService("Document",AL);}else{AM=mstrApp.viewFactory.newDocDataService(AL);}this.dataService=AM;this.disposables.push(AM);}return AM;},partialUpdate:function T(AM,AK){var AL=this.updateDataCache(AM,AK);this.raiseEvent({name:"partialUpdate",tree:AM,ids:AL});return AL;},transactionUpdate:function(AM,AL){if(!AM.data){return ;}var AO=this,AP;if(AL&&AL.tks){AP=d.call(this,AL.tks);}if(AM.pukeys){AP=d.call(this,AM.pukeys);var AQ;for(AQ in AP){if(AP[AQ]&&AP[AQ].cek){AP[AQ].cek=null;}}}if(AM.txrcd){this.txrcd=AM.txrcd;}else{delete this.txrcd;}var AN=this.updateDataCache(AM.data,AP,AL&&AL.sid),AK={name:"partialUpdate",tree:AM.data,ids:AN};if(!mstrmojo.hash.isEmpty(AN.ifws)){if(AL&&AL.type===q.GRID){AK.anchor=AL.anchor;}else{AN.ifws={};}}this.raiseEvent(AK);return AN;},deltaUpdate:function AH(AK){var AL=this.delta;if(!AL){AL=this.delta={};}AL[AK.id]=AK;},clearTxDeltaUpdate:function V(AL){var AO=this.txDiscardTargets,AK=!AO,AN=this.pendingUpdate,AM=this,AP;if(!AK){w(AO,function(AQ,AR){if(AM.delta&&AM.delta[AR]){AM.delta[AR].clear();delete AM.delta[AR];}});}if(AN&&AN[AL]){w(AN[AL],function(AQ){AQ.clear();});delete this.pendingUpdate[AL];}},sendTransactionActions:function x(AL,AK,AN){var AM=this,AO;if(!AN){AN={success:function(AP){AM.transactionUpdate(AP);}};}AM.getDataService().sendTransactionActions({keyContext:AL,actions:AK,txrcd:this.txrcd},AN);},addSDP:function D(AL,AK){if(!AL||!AK){return ;}if(!this.sdp){this.sdp={};}this.sdp[AL]={k:AK.k,visName:AK.visName};},removeSDP:function Z(AK){if(!AK||!this.sdp[AK]){return ;}delete this.sdp[AK];},slice:function R(AX){try{if(!AX||(!mstrmojo.dom.isAndroid&&!AX.tks&&!AX.multiSelect&&(AX.type===3||(AX.type===q.GRAPH&&AX.tty!=1)))){return ;}var AM=null,Af=this,Aa=this.getDataService(),Ag=AX.tks?d.call(this,AX.tks):null,AZ=Ag,Ae=function(Ah){w(AZ,function(Ai,Aj){if(Ai&&Ai.set){Ai.set("readyState",Ah);}});},Ad=function(Ah,Ai){return mstrmojo.all[l.call(Af,{k:Ah,wid:Ai},Af.currlaykey)];},AQ=this.newCallback({method:"slice",submission:function(){Ae(J.WAITING);},success:function(Ai){if(AX.disablePU){Af.loadLayout(Ai,AX.isUConDS,AX.restoreIW);return ;}if(Ai.pukeys){Ag=d.call(Af,Ai.pukeys);}A(Af,Ai);AM=Af.updateDataCache(Ai.data,Ag,AX&&AX.sid);if(typeof (Ai)=="object"){mstrmojo.hash.copyProps(["bs","exopt","dty"],Ai,Af);}var Ah={name:"partialUpdate",tree:Ai.data,ids:AM};if(!mstrmojo.hash.isEmpty(Ah.ids.ifws)){if(AX&&!AX.suppressIW&&(AX.type===q.GRID||AX.type===q.GRAPH)){Ah.anchor=AX.anchor;}else{Ah.ids.ifws={};}}Af.raiseEvent(Ah);},complete:function(){Ae(J.IDLE);}});if(AX.type==3){var AY=AX.tks,AS=AX.eid;if(!AY){return ;}var AW=H(this.defn,this.currlaykey,AS);if(!AW){return ;}var AT=AS,AK=Ag[AY],AP=function(){AK.set("selKey",AS);},AO;AK.newSelKey=AS;if(AW.l){var Ab=AW.dirtyKeys;if(!!Ab){AT=mstrmojo.hash.keyarray(Ab).join(",");AZ=Ag=d.call(this,AT,",");AO=function(){AP();w(AM.upd,function(Ah,Ai){var Aj=mstrmojo.all[Ai];if(Aj&&Aj.setDirty){Aj.setDirty(false);}});};}else{Aa.setCurrentPanel(AS,AX.tks,AX.ck,this.newCallback({method:"slice",success:AP}));return ;}}else{AO=function(){AP();AW.l=true;};}var AU=AQ.success;AQ.success=function(Al){var Aj=G(Al.defn,Af.currlaykey),Ap=G(Af.defn,Af.currlaykey),Am=function(Aq,Ar){for(var As in Ar){if(Aq[As]===undefined){Aq[As]=Ar[As];}}},Ao=Aj&&Aj.units,An=Ap&&Ap.units,Ai=Aj&&Aj.cgbMap,Ah=Ap&&Ap.cgbMap;if(Ao){Am(An,Ao);}if(Ai){Am(Ah,Ai);Af.raiseEvent({name:"CGBMapChange",cgbMap:Ah});}AU(Al);AO();var Ak=Ad(AX.tks,0);if(Ak){Ak.clearDirtyChild(AS);}};Aa.requestNewPanel(AS,AX.tks,AX.ck,AT,!AX.hasLoader,AQ);}else{AQ=O(AQ,{success:function(Ah){w(AZ,function(Al,Aj){var Ak=Ad(Aj,1);if(!Ak){if(!!Af.sdp&&!!Af.sdp[Aj]){var Ai=Af.getLayoutDataCache(Af.getCurrentLayoutKey());var Am=l.call(Af,{k:Aj,wid:1},Af.currlaykey);Af.raiseEvent({name:"secondaryDataSliced",key:Aj,data:Ai[Am].data});}return ;}if(AM&&!(Aj in AM.def)){if(Ak.setDirty){Ak.setDirty(true);}}else{if(Al.t==q.PANELSTACK){Ak.setDirtyChildren();}}});}});var AN,AV;if(AX.type==q.GRAPH){AV="applyGraphSelectorAction";AN=[AX.ck,AX.cks,AX.sid,AX.x,AX.y,AQ,Af.zf];}else{if(AX.isMultipleEvents){AV="RWEventsTask";params={messageID:this.mid,styleName:"RWDocumentMojoStyle",events:AX.events};AN=[params,AQ];}else{if("eid" in AX){AV=AX.isDocVis?"setDocVisSelectorElements":"setDocSelectorElements";AN=[AX.ck,AX.eid,AX.ctlKey,AX.include,AQ,Af.zf];var AR=K.call(this);if(AX.isUConDS||AR){AX.disablePU=true;AN=AN.concat([null,0,null,true]);}if(AR){AX.restoreIW=true;}if(Af.sdp){var AL={};w(Af.sdp,function(Ai,Ah){if(Af.sdp[Ah]){AL[Ah]=Ai.visName;}});AN[7]=JSON.stringify(AL);}AN[8]=AX.tks;}else{if(AX.multiSelect){if(AX.selectorObjects.length>0){AV="setMultiDocSelectorElements";AN=[AX.selectorObjects,AX.multiSelect,AQ,Af.zf];}}else{if("srct" in AX&&AX.srct==4){if(AX.onlyInclude){AV="setDocSelectorInclude";AN=[AX.ckey,AX.include,AQ,AX.srcid,AX.srct,Af.zf];}else{AV="setDocSelectorExpression";AN=[AX.ck,AX.ckey,AX.srcid,AX.srct,AX.f,AX.ft,AX.include,AX.cs,5,AQ,Af.zf];if(!AX.cs){AN[7]=null;AN[8]=null;if(AX.changeQual){Aa.setRWUnitProperties(AX.ckey,AX.ckey+"\u001FFormattingSelector\u001FMetricConditionType\u001F"+AX.qt,1,false,null);AN.push(AX.unset);}}}}else{if(AX.unset){AV="setDocUnsetSelector";AN=[AX.ck,AX.ckey,AQ,Af.zf];}else{AV="setDocSelectorInclude";AN=[AX.ckey,AX.include,AQ,null,null,Af.zf];}}}}}}if(AV){Aa[AV].apply(Aa,AN);}}}catch(Ac){mstrmojo.err(Ac);}},getLayoutDataCache:function F(AL){if(!AL){return null;}var AK=this.dataCache;if(!AK){AK=this.dataCache={};}if(!AK[AL]){AK[AL]={};}return AK[AL];},updateDataCache:function X(AL,AQ,AN){var AP=this,AM=this.getLayoutDataCache(this.getCurrentLayoutKey()),AO={ifws:{},upd:{},tgts:{},def:{},secs:{}};function AK(AY,AV,Ad){var AS=false,Ae=AP.getChildren(AY,true),Af;if(!Ae.length){return ;}if(AV){Af=mstrmojo.all[AY.id];AS=!AY.id||!!Af;}var AZ=AY.defn,AU=AY.data,Ac;if(AZ&&AZ.t===q.PANELSTACK&&AZ.od){Ac=AU.selKey;}for(var AX in Ae){var AR=Ae[AX],AW=AR.k,AT=AR.id,Ab=null;if(mstrmojo.all[AT]){AS=true;}if(AW in AQ){if(P.call(AP,AW)&&o(AR.data,AN)){AM[AT]=AR;if(!Ad){AO.ifws[AW]=AP.infoWinByKey[AW].id;}}Ab=AW;if(AS){if(Ac&&Ac!==AW){continue;}if(!Ad){AO.tgts[AT]=true;}var Ag=Af&&Af.defn,Aa=Ag&&Ag.t,Ah=Ag&&Ag.ck;if(Aa===q.SUBSECTION&&(Ah&&(AW in Ah))){AO.secs[Af.id]=true;}}}if((Ad||Ab)&&(!Ac||Ac===AW)){AM[AT]=AR;AO.def[AW]=true;if(AS){AO.upd[AT]=true;}}AK(AR,AS,Ad||Ab);}}if(AL&&AL.layouts&&AQ){AK(mstrmojo.array.filter(AL.layouts,function(AR){return(AR.loaded);},{max:1})[0],true);}return AO;},getCGBMap:function b(){var AK=G(this.defn,this.currlaykey);return AK&&AK.cgbMap;},executeLink:function Q(AK,AM,AN){if(AK.indexOf("prevMsgID")>0){var AL="prevMsgID="+this.mid;AK=AK.replace(/prevMsgID=0($|&)/g,function(AO,AP){if(AP=="&"){return AL+="&";}else{return AL;}});if(mstrmojo.dom.isIE){AK+="&cb"+mstrmojo.now()+"=1";}}AK=mstrmojo.addCSRFTokenToURL(AK);this.controller.onLink(this,{url:AK,target:AM,src:AN||null});},showInfoWin:function Y(AN,AM,AK,AO,AP){var AL=this.infoWinByKey&&this.infoWinByKey[AN];if(AL===undefined){return ;}this.raiseEvent({name:"showInfoWin",psId:AL.id,psKey:AL.k,anchor:AM,anchorOrientation:AK,anchorPosition:AP,invalidate:AO});},downloadGridData:function k(AP){var AN=this,AM=AP.xtabId,AL=AP.memo,AK=mstrmojo.all[AM],AO=this.getDataService();var AQ=this.newCallback({success:function(AU){function AY(Ad,Ae){var Ab=AN.getChildren(Ad,true);for(var Aa in Ab){var Ac=Ab[Aa];if(Ae==Ac.id){return Ac;}var AZ=AY(Ac,Ae);if(AZ){return AZ;}}return null;}var AR=AU.data,AX=null,AW,AS=AR&&G(AR,AN.currlaykey);if(AS){AX=AY(AS,AM);}if(AX&&AK){AK.dataDownloaded(AX,AL);}if(AS&&AS.xtabStyles){AN.raiseEvent({name:"updateStyles",key:AS.k,updatedStyles:AS.xtabStyles});}AW=H.call(AN,AN.defn,AN.currlaykey,AP.nodeKey);if(AW&&AW.t===q.GRIDGRAPH&&AL.recalculating){var AT=AK.parent,AV=AT&&AT.getGraphWidget();if(AT&&AV&&AT.updateGraph){AT.updateGraph(AY(AS,AV.id));}}},failure:function(){if(AK.dataDownloadErr){AK.dataDownloadErr();}}});AO.downloadGridData(AP,AQ);},saveRWProps:function AE(AL,AP,AQ,AN,AS){var AK=[],AO="\u001F";w(AP,function(AU,AT){w(AU,function(AV,AW){AK.push(AT+AO+AW+AO+AV);});});if(!AK.length){return ;}if(AN){var AM=H.call(this,this.defn,this.currlaykey,AL),AR=function(AT){AM.set("readyState",AT);};AS=O(AS,{submission:function(){AR(J.WAITING);},complete:function(){AR(J.IDLE);}});}this.getDataService().setRWUnitProperties(AL,AK.join("\u001E"),AQ||1,AN,AS);},loadPartialData:function I(AP,AL){var AN={};AN[AL]=H.call(this,this.defn,this.currlaykey,AL);var AM=this.updateDataCache(AP,AN),AK=this.getLayoutDataCache(this.getCurrentLayoutKey()),AO=this;mstrmojo.array.forEach(AP.layouts,function(AQ){if(AQ&&AQ.xtabStyles){AO.raiseEvent({name:"updateStyles",key:AQ.k,updatedStyles:AQ.xtabStyles});}});w(AM,function(AR,AQ){if(AQ==="upd"){w(AR,function(AT,AU){var AS=mstrmojo.all[AU];if(AS&&AS.update){AS.update(AK[AU]);}});}});},addAutoWidthID:function f(AM){var AL=this.aws||{},AK=AL[this.currlaykey]||[];AK.push(AM);AL[this.currlaykey]=AK;this.aws=AL;},getAutoWidthIDs:function M(){var AM=this.aws,AK=this.currlaykey;var AL=AM&&AM[AK];if(AL){delete AM[AK];}return AL;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var a=1,P=2;var C=2,H=4;var S=1,K=4;function F(b,d){return b[((d===a)?"row":"col")];}function A(b,f){var d=f.lm;return d&&d[b.mix||0];}function G(b,f){var d=f.dp;return d&&d[b.mix||0];}function V(x,o,d){var q=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:o.daMode});var k=o.ans,j=k&&k.length;if(j){var t=q.prms=[],AG=0;for(AG=0;AG<j;AG++){var AE=k[AG];var AD=AE.pid,AF=parseInt(AE.m,10),AA={id:AD,am:AF,pt:AE.pt};t.push(AA);if(AE.po){AA.orid=AE.po.did;AA.ortp=AE.po.t;}switch(AF){case q.DO_NOT_ANSWER:case q.CLOSE:case q.USE_DEFAULT_ANSWER:case q.SAME_PROMPT:break;case q.STATIC:var AH=AE.es,p=(AH&&AH.length)||0,s;AA.pa={es:[]};for(s=p-1;s>=0;--s){var AB=AH[s];AA.pa.es.push({ei:AB.id,disp_n:AB.n,emt:1});}break;case q.DYNAMIC:case q.ALL_VALID_UNITS:case q.CURRENT_UNIT:var f=AE.dunits;if(f&&f.length&&d){var b=AA.pa={};var w=d,l=(d.mix!==undefined)&&(d._lp||d._tp);if(l){w=d._lp||d._tp;}var h=parseInt(w.axis,10);while(w){var AI=this.getPTitle(w,h);if(AI&&mstrmojo.array.find(f,"id",AI.id)>=0){if(AF!==q.DYNAMIC){b.a={id:AI.id,n:AI.n,dispForms:AI.dfi};}if(AE.pt===1){b.v=w.v;break;}else{var AC=w._e.id,g=w._e.n;b.es=[];b.es.push({ei:AC,emt:1,disp_n:g});}if(AF===q.CURRENT_UNIT){break;}}w=this.getPCellParentNode(w,h);if(l&&!w&&h===a){h=P;w=d._tp;}}}break;}}}return q;}function N(f){var d=this.getCellTitleInfo(f[0]),h=[],k=function(l){if(l){if(mstrApp.useBinaryFormat){if(l._e){h.push(l.axis+"A"+(l.ui+1)+"A"+l._e.id);}k(l._p);}else{h.push(l.axis+"A"+(l.ui+1)+"A"+l.o);}}},g,b;if(!d.isSrcTitle){for(g=0,b=f.length;g<b;g++){var j=f[g];if(j.mix!==undefined&&(j._lp||j._tp)){k(j._lp);k(j._tp);}else{k(j);}}}return(mstrApp.useBinaryFormat)?h:h.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function O(){return this.data.mid;},getCellTitleInfo:function W(d,h){var f=h?h.gts:this.data.gts;var g=null;if(d.mix===undefined){g=F(f,d.axis)[d.tui||d.ui];}else{var b=function(l){var j=(l&&l.length)||0,k;for(k=j-1;k>=0;--k){if(parseInt(l[k].otp,10)===-1){return l[k];}}return null;};g=b(f.col)||b(f.row);}return{isSrcTitle:(d.o===undefined),title:g};},getCellLinksInfo:function Y(d,f){if(!f){var b=this.getCellTitleInfo(d);f=b&&b.title;}return A(d,f);},getCellDrillsInfo:function E(d,f){if(!f){var b=this.getCellTitleInfo(d);f=b&&b.title;}return G(d,f);},getLinkDrillAction:function L(b){return this.getActionObject(b);},getAction:function R(b){return this.getActionObject(b);},getActionObject:function I(d){var b=d[0]&&d[0].at,f=null;if(b){if(b&K){f={h:"onLink",a:this.getLinkAction(d[0])};}else{if(b&S){f={h:"onDrill",a:this.getDrillAction(d)};}}}return f;},getSortAction:function D(w,l){var g=this.getCellTitleInfo(w),q=g.title,t=this.data.gts[((w.axis===a)?"row":"col")+"SubPos"],b=[],f=q.axis,j,p,o,s;l=(l===null||l===undefined)?!(w&&w.so):l;if(g.isSrcTitle){j=C;p=q.id;o=q.otp;s=q.fid;}else{j=H;o=4;f=a;t=this.data.gts.rowSubPos;do{var k=w._e;if(k){if(k.oid){p=k.oid;}else{b.push(k.id);}}w=w._p;}while(w);}var h={sortType:j,axis:f,isAsc:l,unitID:p,unitType:o,elementList:b.join("\u001E"),subTotalsPos:t};if(p){h.unitID=p;}if(s){h.formId=s;}var d;if(j===H){d=["","",h.elementList||"",h.axis];}else{d=[h.formId,"21"];}d=[h.unitType,h.unitID].concat(d);h.sortKey=d.join("!");return h;},getPivotAction:function J(w,f){var s=false,x=w.hasOwnProperty("mix"),b=(x)?null:w.axis,t=((x)?w.mix:w.ui)+1,d=(w.otp===-1);if(!isNaN(f)){b=f;t=1;if(x){x=false;d=true;}}else{var k=(f==="u"||f==="l");if(!x){var j=F(this.data.gts,b),h=0,g={},o=false;mstrmojo.array.forEach(j,function(z){if(g[z.id]){g[z.id].frm++;}else{h++;g[z.id]={pos:h,frm:1};if(z.id===w.id){o=true;}else{if(o){return false;}}}});t=g[w.id].pos;var p=w.fix;if(p){if(!k||p>1){if(k||p!==g[w.id].frm){t=p;s=true;}}}}t=t+((k)?-1:1);}var l={pos:t};if(s){l.formID=w.fid;}else{if(!x){l.axis=b;}}if(!d){var q=(x)?w._e:w;if(!s){l.objectType=q.otp;}l.objectId=(x)?q.oid:w.id;}return l;},isPvtButtonVisible:function X(l,f){var h=l.axis,g=F(this.data.gts,h),d=l.hasOwnProperty("mix");if(!isNaN(f)){if(parseInt(f,10)===h){return false;}if(d){return !!g[l.ui]._hid;}return true;}var j=g[l.ui].es,k=l.ui,b=(d)?j.length:g.length;if(b===1){return false;}if(h===((d)?P:a)){if(f==="u"||f==="d"){return false;}}else{if(f==="l"||f==="r"){return false;}}if((d)?l._e===j[0]:k===0){if(f==="l"||f==="u"){return false;}}if(d?l._e===j[b-1]:k===b-1){if(f==="r"||f==="d"){return false;}}return true;},getDrillAction:function B(d){var b=this.getCellTitleInfo(d[0]),g=b.title,f=g.dp[d[0].mix||0];return{srcMsgId:this.data.mid,isWithin:f.within,drillPathKey:f.k,drillPathIndex:f.dpi,drillElements:N.call(this,d)};},getPTitle:function Z(f,d){var b=this.data.gts;return F(b,d)[f.tui];},getPCellParentNode:function M(d,b){return d._p;},getLinkAction:function Q(f,d){var b=this.getCellTitleInfo(f),g=b.title;return this.getLinkActionImpl(f,g,d);},getLinkActionImpl:function U(t,o,q){var f=A(t,o),p=f&&f.links,w=(f.onw)?"_blank":"";if(q===null||q===undefined){q=(f&&f.di)||0;}var j=p&&p[q];if(!j){return null;}var g={linkInfo:j,linkTarget:w};var b=j.url;if(b){var h="&CurrentElement";if(t&&o&&b.indexOf(h)>-1){b=b.replace(h,t._e.id);}g.url=b;}else{var k=j.target,s,d;switch(parseInt(k&&k.t,10)){case 55:if(parseInt(k.st,10)===14081){s=2048001;d="objectID";}else{s=32001;d="documentID";}break;case 3:s=4001;d="reportID";g.reportViewMode=((parseInt(k.st,10)===769)?2:1);break;default:return null;}g.evt=s;g[d]=k.did;g.srcMsgId=this.getMessageId();var l=V.call(this,f,j,t);if(l){g.link=l;}return g;}},getDownloadAction:function T(g,d,j,f,h,b){return{xtabId:h,rowPosition:g,maxRows:d,colPosition:j,maxColumns:f,memo:b};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.dom","mstrmojo.num","mstrmojo._TouchGestures");var O=mstrmojo.dom,S=mstrmojo.css,D=Math.min,E=Math.max,Q=Math.round,N=mstrmojo.num,F=N.countOfDecimals;function B(){var a=document.defaultView.getComputedStyle,Z=[this.leftNode,this.rightNode],f=["border-left-width","padding-left","margin-left","border-right-width","padding-right","margin-right"],d=[0,0],Y,X;for(Y=0;Y<Z.length;Y++){var b=a(Z[Y]);for(X=0;X<f.length;X++){d[Y]+=parseInt(b.getPropertyValue(f[X]),10)||0;}}this._lnExt=d[0];this._rnExt=d[1];if(!this._thumbLen){this._thumbLen=parseInt(this.thumbNode.offsetWidth,10);}this._length=this.domNode.clientWidth;this._effLen=Q(this._length-this._thumbLen);this._unitLen=this._effLen/(this.max-this.min);}function V(Y){var b=this.min,a=this._unitLen,Z=this._thumbLen/2,X=Q((Y-b)*a);this.leftNode.style.width=(X+Z-this._lnExt)+"px";this.rightNode.style.width=(this._effLen-X+Z-this._rnExt)+"px";O.translate(this.thumbNode,E(D(X,(this.max-b)*a),0),0);}function T(Y,Z){var X=this.interval;return D(E(this.min,parseFloat(Y,10)+Q(Z/this._unitLen/X)*X),this.max).toFixed(this._intervalDecimals);}function H(X){return T.call(this,this.min,X-O.position(this.domNode,true).x-this._thumbLen/2);}function J(X){return function(Y){return this["touchSelect"+X](Y);};}mstrmojo.ui.MobileSlider=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures],{markupString:'<div class="mstrmojo-MobileSlider" style="visibility:hidden;"><div class="v"></div><div class="bk"></div><div class="th"><div></div></div><div class="min">{@minText}</div><div class="max">{@maxText}</div></div>',markupSlots:{leftNode:function(){return this.domNode.childNodes[0];},rightNode:function(){return this.domNode.childNodes[1];},thumbNode:function(){return this.domNode.childNodes[2];},minNode:function(){return this.domNode.childNodes[3];},maxNode:function(){return this.domNode.childNodes[4];}},markupMethods:{onvalueChange:function(){if(this.hasRendered){V.apply(this,[this.value]);}if(this.slidingValue!==this.value){this.set("slidingValue",this.value);}},onslidingValueChange:function(){if(this.hasRendered){V.apply(this,[this.slidingValue]);}}},value:0,slidingValue:0,max:10,min:0,interval:1,_intervalDecimals:0,init:function M(X){this._super(X);this._intervalDecimals=F(this.interval,".");},onintervalChange:function K(Y,X){this._intervalDecimals=F(X,".");},preBuildRendering:function C(){this.minText=N.toLocaleString(this.min);this.maxText=N.toLocaleString(this.max);this._super();},postBuildRendering:function R(){this._super();B.call(this);V.call(this,this.value);this.domNode.style.visibility="visible";},resize:function U(){B.call(this);V.call(this,this.value);},touchBegin:function L(X){X.stop();},touchSelectBegin:function A(Y){var X=Y.target;if(!X||X!==this.thumbNode){return this.bubbleTouchEvent(Y);}S.addClass(this.domNode,"active");this.slidingValue=this.value;},touchSelectMove:function G(X){this.set("slidingValue",T.apply(this,[this.value,X.delta.x||0]));},touchSelectEnd:function I(X){S.removeClass(this.domNode,"active");this.set("slidingValue",T.apply(this,[this.value,X.delta.x||0]));this.set("value",this.slidingValue);},touchSwipeBegin:J("Begin"),touchSwipeMove:J("Move"),touchSwipeEnd:J("End"),onclick:function W(Y,X){this.touchTap({clientX:O.getMousePosition(Y.e,X).x});},touchTap:function P(X){this.set("value",H.call(this,X.clientX));}});}());(function(){mstrmojo.requiresCls("mstrmojo._TouchGestures","mstrmojo.css","mstrmojo.dom","mstrmojo.hash");mstrmojo.android.ui._IsTouchLink=mstrmojo.provide("mstrmojo.android.ui._IsTouchLink",mstrmojo.hash.copy(mstrmojo._TouchGestures,{_mixinName:"mstrmojo.android.ui._IsTouchLink",ontouchend:function(B){if(!this.linkEnabled){return ;}if(!B.e.handled){var C=this.domNode,A=document.createElement("div"),D=this.id;A.className="activeLink on";C.appendChild(A);window.setTimeout(function(){var E=mstrmojo.all[D];if(E&&E.hasRendered){mstrmojo.dom.attachOneTimeEvent(A,"webkitTransitionEnd",function(){C.removeChild(A);});mstrmojo.css.removeClass(A,"on");}},200);this.onclick();}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._TouchGestures","mstrmojo.array","mstrmojo.dom","mstrmojo.css");var X=mstrmojo.css,b=mstrmojo.emptyFn,T=mstrmojo.dom,G=32,d=mstrmojo.css,J={SINGLE:1,INCLUDE:2,EXCLUDE:3},Y={CONTINUOUS_STEPS:-1,UNSET:-4641},Z={},E=function(f){if(!Z[f.id+"cw"]){var h=parseInt(X.getComputedStyle(f.sliderContainer).width,10);if(isNaN(h)){h=parseInt(X.getComputedStyle(f.domNode.parentNode).width,10);}Z[f.id+"cw"]=h;}return Z[f.id+"cw"];},D=function(s,h,o){var k=s.type!==J.SINGLE,p=G,j=!!h?(h-(p/2)):parseInt(o.style.left,10),w=s.steps,x=E(s)-p,q=Math.round(x/(w-(!k?1:0))),f=k?s.rightStep:w-1;return Math.min(f,Math.round(j/q));},C=function(h){var k=h.rangeContainer.style,j=parseInt(k.width,10)-G,l=parseInt(k.left,10),f=h.steps,p=E(h)-G,o=Math.round(p/f);return Math.max(0,Math.min(Math.round((l+j)/o),f));},M=function(k,l){var h=k.steps,f=E(k),j=G;return Math.min(f-j,Math.max(0,((f/(h-1)*l)-j/2)))+"px";},B=function(j,k){var h=j.steps,f=E(j)-G;return((f/h)*k)+"px";},g=function(k,o,h){var j=k.steps,f=E(k)-G,l=h-o;return((l*f)/j)+G+"px";},W=function(h,j){var f=h.singleHandle;if(f){f.style.left=M(h,j);}},P=function(l,o,j){var f=l.rangeContainer,k,h=(l.rangeLHandle.clientWidth||G)+5;if(f){var p=l.innerRangeContainer.style;k=f.style;k.left=B(l,o);k.width=g(l,o,j);p.left=parseInt(k.left,10)+h+"px";p.width=Math.max(parseInt(k.width,10)-(2*h),0)+"px";}},A=function(j,f,p){var h=j.type!==J.SINGLE,o=D(j,f,p),q=h?"leftStep":"singleStep",k;if(o!==j[q]){j.set(q,o);this.step=o;}else{k=h?P:W;k(j,o,j.rightStep);}},H=function(h,o,l){var f=h.rangeContainer,j,k=h.leftStep,p=(l===f||l===h.innerRangeContainer);if(l===h.rangeRHandle||p){j=C(h);k+=p?j-h.rightStep:0;P(h,k,j);if(h.rightStep!==j){h.set("rightStep",j);if(p){h.set("leftStep",k);}}}else{if(l===h.rangeLHandle){A(h,o,f);}}},R=function(f,h){switch(f.type){case J.SINGLE:A(f,null,f.singleHandle);break;case J.EXCLUDE:case J.INCLUDE:H(f,null,h);break;}},I=function(w,l){var q=w.rangeContainer,h=q.style,j=parseInt(h.width,10),o=parseInt(h.left,10),f=w.leftStep,s=w.rightStep,k=s,p=f;if(l>0&&l<o&&f>0){k--;p--;}else{if(l>(o+j)&&l<E(w)){k++;p++;}}P(w,p,k);w.set("leftStep",p);w.set("rightStep",k);},Q=function(l,k,o,f,h){var j=o.style.width;if(j===""){j=X.getComputedStyle(o).width;}f=Math.min(Math.max(0,f+(h||0)),E(l)-parseInt(j,10));k.style.left=f+"px";return f;},V=function(s,p,h,l){var k=s.rangeContainer,j=s.rangeLHandle,w=E(s)-G,q=Math.round(w/s.steps),o=h-l,f;if(o>=(q+G)){f=Q(s,k,j,p,l);if((p+l)>0){k.style.width=o+"px";}return f;}},a=function(s,o,h,k){var j=s.rangeContainer,p=E(s)-parseInt(j.style.left,10),l=h+k,w=E(s)-G,q=Math.round(w/s.steps),f;if(l>=(q+G)){f=Math.min(p,l);j.style.width=f+"px";return f;}},O=function(j){var k,l,f,h;switch(j.type){case J.SINGLE:k=parseInt(this.step,10)===Y.UNSET?D(j,null,j.singleHandle):this.step;h=j.buildSummary(k);this.step=Y.UNSET;break;case J.EXCLUDE:case J.INCLUDE:l=D(j,null,j.rangeContainer);f=C(j);h=j.buildSummary(null,l,f);break;}return h;};mstrmojo.android.selectors.MobileSliderSelector=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures,mstrmojo._ListSelections],{width:0,type:Y.UNSET,value:Y.UNSET,steps:Y.UNSET,include:Y.UNSET,initState:b,buildSummary:b,updateMinMaxLabels:b,flushSelections:b,step:Y.UNSET,singleStep:Y.UNSET,leftStep:Y.UNSET,rightStep:Y.UNSET,cssDisplay:"block",scriptClass:"mstrmojo.android.selectors.MobileSliderSelector",useRichTooltip:true,markupString:'<div class="mstrmojo-sliderSel" id="{@id}"><div></div><div class="mstrmojo-sliderSelSummary">&nbsp;</div><div class="mstrmojo-sliderSelScrollerContainer"><div class="mstrmojo-sliderSelScrollerHandle" style="display:none;"><div class="mstrmojo-sliderSelScrollerHandle1 leftHandle"><div></div></div><div class="mstrmojo-sliderSelScrollerHandle1 rightHandle"><div></div></div></div><div class="mstrmojo-sliderSelScrollerHandle2" style="display:none;"><div></div></div><div class="mstrmojo-sliderSelScrollerHandleArea" style="display:none;position:absolute"></div></div><div class="mstrmojo-sliderSelLabels"><label class="mstrmojo-sliderSelLL">&nbsp;</label><label class="mstrmojo-sliderSelLR">&nbsp;</label></div></div>',markupSlots:{editor:function(){return this.domNode.childNodes[0];},summary:function(){return this.domNode.childNodes[1];},sliderContainer:function(){return this.domNode.childNodes[2];},innerRangeContainer:function(){return this.domNode.childNodes[2].childNodes[2];},rangeContainer:function(){return this.domNode.childNodes[2].childNodes[0];},rangeLHandle:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0];},rangeRHandle:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1];},singleHandle:function(){return this.domNode.childNodes[2].childNodes[1];},minLabel:function(){return this.domNode.childNodes[3].childNodes[0];},maxLabel:function(){return this.domNode.childNodes[3].childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},ontypeChange:function(){var j,h="none",k="mstrmojo-sliderSelScrollerContainer",f="Handle1";switch(this.type){case J.SINGLE:j="block";break;case J.EXCLUDE:k="mstrmojo-sliderSelScrollerContainerExcl";f="Handle2";h="block";break;case J.INCLUDE:h="block";break;}this.rangeContainer.style.display=h;this.innerRangeContainer.style.display=h;this.sliderContainer.className=k;this.rangeLHandle.className="mstrmojo-sliderSelScrollerHandleX leftHandle".replace("HandleX",f);this.rangeRHandle.className="mstrmojo-sliderSelScrollerHandleX rightHandle".replace("HandleX",f);this.singleHandle.style.display=j;},onconstantsChange:function(){this.updateMinMaxLabels();},onvalueChange:function(){O(this);}},postBuildRendering:function U(){var f=this._super();this.initState();var h=this.tooltipNode||this.domNode;T.detachEvent(h,"mouseover",this._ontooltipover);T.detachEvent(h,"mouseout",this._ontooltipout);return f;},onsingleStepChange:function(){W(this,this.singleStep);},onleftStepChange:function(){P(this,this.leftStep,this.rightStep);},onrightStepChange:function(){P(this,this.leftStep,this.rightStep);},touchSwipeBegin:function(p){var o=p.target;if(!o){return false;}this.touchTap(p);var f=this._glowing=[];d.addClass(o,"glow");f.push(o);this._sliderTarget=o;var h=this.singleHandle,j=this.rangeContainer,l,k;switch(o){case h:l=h.style.left;Z.shl=parseInt(!!l?l:0,10);break;case j:case this.innerRangeContainer:case this.rangeLHandle:case this.rangeRHandle:k=j.style;l=k.left;Z.icl=parseInt(!!l?l:0,10);Z.icw=parseInt(k.width,10);break;case this.sliderContainer:d.addClass(h,"glow");f.push(h);break;default:this.bubbleTouchEvent(p);}this._initTooltip();if(this.type===J.SINGLE){this.touchSelectMove(p,true);}},touchSwipeMove:function(q,l){var s=q.target;if(!s){return false;}s=this._sliderTarget;var h=this.singleHandle,k=this.rangeContainer,f=this.rangeLHandle,j=this.rangeRHandle,p=q.delta.x,o;switch(s){case h:o=Q(this,h,h,Z.shl,p);break;case j:o=a(this,Z.icl,Z.icw,p);break;case f:o=V(this,Z.icl,Z.icw,p);break;case k:case this.innerRangeContainer:if(this.type===J.INCLUDE){o=Q(this,k,k,Z.icl,p);}break;case this.sliderContainer:o=Q(this,h,h,q.clientX-T.position(this.sliderContainer,true).x);break;}this._updateTooltip(q.evt,s,o,l);},touchSwipeEnd:function(o){var k=(o.target===this.sliderContainer)?this.singleHandle:this._sliderTarget,f=this.leftStep,j=this.rightStep,h=this.singleStep;mstrmojo.array.forEach(this._glowing,function(l){d.removeClass(l,"glow");});R(this,k);if(f!==this.leftStep||j!==this.rightStep||h!==this.singleStep){this.flushSelections();}this.hideTooltip(o.evt,this);},touchTap:function(o){var p=o.target;if(!p){return false;}var q=this.sliderContainer,h=o.clientX,t=(q===p),j=h-T.position(q,true).x,k=this.leftStep,f=this.rightStep,w=this.singleStep;switch(this.type){case J.SINGLE:if(t){A(this,j,this.singleHandle);}break;case J.INCLUDE:if(t){I(this,j);}break;}if(k!==this.leftStep||f!==this.rightStep||w!==this.singleStep){O(this);this.flushSelections();}},touchSelectBegin:function(f){this.touchSwipeBegin(f);},touchSelectMove:function(f){this.touchSwipeMove(f,true);},touchSelectEnd:function(f){this.touchSwipeEnd(f);},touchEnd:function F(f){this.hideTooltip(f.evt,this);},_initTooltip:function S(){this.set("richTooltip",{refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMCENTER,contentNodeCssClass:"mstrmojo-sliderTip"});},_updateTooltip:function N(f,t,o,k){this.showTooltip(f,this);var l=T.position(this.sliderContainer,false),j=T.position(this.domNode,false),h=mstrmojo.boxmodel.offset(this.sliderContainer),p=(l.y<90),q=this.richTooltip,s=O(this),w;if(k){w=(G/2);}else{w=t.style.width;if(w===""){w=X.getComputedStyle(t).width;}w=parseInt(w,10)/2;}q.content='<div class="mstrmojo-sliderTip-top">'+s+'</div><div class="mstrmojo-sliderTip-bottom'+(p?" down":"")+'"></div>';q.top=j.y-h.top-20+(p?100:0);q.left=o+w+(j.x-h.left);this.richTooltip=null;this.set("richTooltip",q);},onselectionChange:function L(){if(this.onchange){this.onchange();}if(this.makeSelection){this.makeSelection({selItem:this.type===J.SINGLE?this.singleHandle:this.rangeContainer});}},slideHosted:function(j,h,f){if(j!==null&&j!==undefined){this.set("singleStep",j);}if(h!==null&&h!==undefined){this.set("leftStep",h);}if(f!==null&&f!==undefined){this.set("rightStep",f);}this.flushSelections();O(this);}});var K=mstrmojo.android.selectors.MobileSliderSelector;K.TYPES=J;K.FLAGS=Y;}());(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompt");mstrmojo.prompt.WebUnsupportedPrompt=mstrmojo.declare(mstrmojo.prompt.WebPrompt,null,{scriptClass:"mstrmojo.prompt.WebUnsupportedPrompt",answerXml:"",populate:function C(F){this._super(F);if(F.ans&&F.ans.xml){this.answerXml=F.ans.xml;}},getAnswerXML:function E(){return this.answerXml;},buildShortPa:function D(F){F.addRawXML(this.answerXml);},buildAnswerObject:function B(){var F=this._super();if(this.answerXml){F.ans={xml:this.answerXml};}return F;},supported:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompt","mstrmojo.array");var E=mstrmojo.array;mstrmojo.prompt.WebGeoConstantPrompt=mstrmojo.declare(mstrmojo.prompt.WebPrompt,null,{scriptClass:"mstrmojo.prompt.WebGeoConstantPrompt",promptType:1.5,geos:null,getStyle:function F(){return mstrmojo.prompt.WebPrompt.STYLES.GEO;},getDisplayValue:function D(){var L=this._isErr;if(L){return"Error while updating location: "+L;}var K=this,J="";E.forEach(this.geos,function(M){var N=M.answer;if(N===""){J="&lt;Update Current Location&gt;";return false;}else{var O=M.prs.GeographicCoordinate;if(typeof (O)=="undefined"||O!="1"){K.la=N;}else{K.lo=N;}}});if(K.displayLoc){J=K.displayLoc;}else{K.mn="Searching...";if(typeof (K.la)=="undefined"){K.la="";}if(typeof (K.lo)=="undefined"){K.lo="";}if(!(K.la==""&&K.lo=="")){J="("+K.la+","+K.lo+")";}}return J;},getDisplayLocation:function(L){var K=this,M=this.la,J=this.lo;if(M!=""&&J!=""){mstrmojo.GeoLocation.findAddress({lat:M,lng:J},{success:function(N){K.mn="";K.displayLoc=N[0].formatted_address;L.updateItem(K._renderIdx);},failure:function(O,N){K.mn="";}});}},validate:function G(K,J){return true;},buildShortPa:function H(J){E.forEach(this.geos,function(K){K.buildShortPa(J);});},add:function I(K){var J=this.geos=this.geos||[];J.push(K);},setAnswerValue:function C(L,K){try{delete this.displayLoc;this.validate(L,K);this.setLocation(L,K);}catch(J){this.setError(J);return false;}return true;},setError:function B(J){this._isErr=J;},setLocation:function A(K,J){E.forEach(this.geos,function(L){switch((L.prs&&L.prs.GeographicCoordinate)||"0"){case"0":L.set("answer",String(K));break;case"1":L.set("answer",String(J));break;}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompt","mstrmojo.locales","mstrmojo.num","mstrmojo.date","mstrmojo.mstr.EnumDataType");mstrmojo.requiresDescs(8398,8399,8400,8401,8402,8403,8404,8405,8406);var X=mstrmojo.prompt.WebPrompt.STYLES,a=function(){return mstrmojo.locales.datetime;},L=mstrmojo.mstr.EnumDataType,Y=mstrmojo.num,R=mstrmojo.date,W=Math;function B(d){var g=parseFloat(this.min,10),b=parseFloat(this.max,10),f=!isNaN(g),h=!isNaN(b);if(f&&d<g){return -1;}else{if(h&&d>b){return 1;}else{return 0;}}}var Z={};Z[L.DataTypeBool]=function(b){if("0"!==b||"1"!==b){throw new Error(mstrmojo.desc(8398,"Invalid answer: #. Boolean values required.").replace("#",b));}};Z[L.DataTypeBigDecimal]=Z[L.DataTypeLong]=Z[L.DataTypeDouble]=Z[L.DataTypeDecimal]=Z[L.DataTypeReal]=Z[L.DataTypeInteger]=Z[L.DataTypeFloat]=Z[L.DataTypeNumeric]=function(b){if(!isNaN(b)){var d=parseFloat(b,10);switch(B.call(this,d)){case -1:throw new Error(mstrmojo.desc(8399,"Invalid answer: #. Answer is smaller than the minimum limit: ##.").replace("##",this.min).replace("#",Y.toLocaleString(b)));case 1:throw new Error(mstrmojo.desc(8400,"Invalid answer: #. Answer is bigger than the maximum limit: ##.").replace("##",this.max).replace("#",Y.toLocaleString(b)));}}else{if(b){throw new Error(mstrmojo.desc(8401,"Not a number"));}}};Z[L.DataTypeChar]=function(b){if(b){switch(B.call(this,(b&&b.length)||0)){case -1:throw new Error(mstrmojo.desc(8402,"Invalid answer: #. The length of the answer is smaller than the minimum limit: ##.").replace("##",this.min).replace("#",b));case 1:throw new Error(mstrmojo.desc(8403,"Invalid answer: #. The length of the answer is bigger than the maximum limit: ##.").replace("##",this.max).replace("#",b));}}};Z[L.DataTypeDate]=function(b){switch(mstrmojo.date.inDateTimeRange(b,this.min,this.max)){case -1:throw new Error(mstrmojo.desc(8404,"Invalid answer: #. The date/time is earlier than the earliest limit: ##.").replace("##",this.min).replace("#",b));case 1:throw new Error(mstrmojo.desc(8405,"Invalid answer: #. The date/time is later than the latest limit: ##.").replace("##",this.max).replace("#",b));}};function J(d){d=String(d);var b=d.indexOf(".");return(b==-1)?0:d.length-b-1;}function Q(l){var g=this.prs.Interval||1;if(!l){g=-g;}var k=parseFloat(this.getDisplayValue(true,true),10),j=parseFloat(g,10),f=W.pow(10,W.max(J(k),J(j)));var d=parseInt((W.round(k*f)+W.round(j*f)),10)/f,b={v:d,s:true};try{this.validate(d);}catch(h){b.s=false;}return b;}function O(d){var b=Q.call(this,d);if(b.s){this.answer=String(b.v);}}mstrmojo.prompt.WebConstantPrompt=mstrmojo.declare(mstrmojo.prompt.WebPrompt,null,{scriptClass:"mstrmojo.prompt.WebConstantPrompt",answer:"",preAnswer:"",defAnswer:"",dataType:8,isNumericDataType:function D(){switch(this.dataType){case L.DataTypeInteger:case L.DataTypeUnsigned:case L.DataTypeNumeric:case L.DataTypeDecimal:case L.DataTypeReal:case L.DataTypeDouble:case L.DataTypeFloat:case L.DataTypeShort:case L.DataTypeLong:case L.DataTypeBigDecimal:return true;default:return false;}},getStyle:function G(){var b=this._style;if(!this._style){var d=this.prs;switch(d.DisplayStyle){case"Stepper":b=X.STEPPER;break;case"Switch":b=X.SWITCH;break;case"Slider":b=X.SLIDER;break;case"Text box":if(this.dataType===14){b=X[(d.ShowTime==="-1")?"TIME":"CALENDAR"];break;}b=X.TEXT;break;case"Barcode":b=X.BARCODE;break;}if(!b){throw new Error(mstrmojo.desc(8406,"WebConstantPrompt::getStyle - Unknown prompt style."));}this._style=b;}return b;},getDisplayValue:function K(p,f){var k=this.answer||this.defAnswer,h=(k===undefined||k===null),b=this.getStyle();switch(b){case X.STEPPER:if(p&&(h||(this.dataType===6&&isNaN(parseFloat(k,10))))){var g=parseFloat(this.min,10),o=parseFloat(this.max,10);if(isNaN(g)||isNaN(o)){k=0;}else{if(0>g&&o>0){k=0;}else{k=(Math.abs(g-0)>Math.abs(o-0))?o:g;}}if(f){this.setAnswerValue(String(k));}}break;case X.SWITCH:var l=this.prs,j=l.OnValue,d=l.OffValue;if(p&&(k!==j&&k!==d)){k=d;if(f){this.answer=d;}}k=(k===j);break;case X.SLIDER:if(p&&(h||k==="")){k=this.min;if(f){this.setAnswerValue(String(k));}}break;}return(b==X.SWITCH)?k:this.isNumericDataType()?mstrmojo.num.toLocaleString(String(k)):k;},validate:function T(b){b=(b===undefined||b===null)?this.answer:b;this._super(b);this._validateFn(b);},isAnswerEmpty:function F(b){b=(b===undefined||b===null)?this.answer:b;return(b===undefined||b===null||b==="");},populate:function M(h){this.answer=h&&h.ans&&h.ans.text;this.dataType=h&&h.datatp;this._validateFn=Z[this.dataType];this._super(h);var g=this.prs;if(g.DisplayStyle==="Wheel"){g.DisplayStyle="Stepper";}switch(g.DisplayStyle){case"Switch":if(g.OnValue===undefined||g.OnValue===null){g.OnValue="1";}if(g.OffValue===undefined||g.OffValue===null){g.OffValue="0";}break;case"Slider":case"Stepper":this.interval=parseFloat(this.prs.Interval)||1;this.min=Y.parseNumeric(this.min);this.max=Y.parseNumeric(this.max);if(!this.min){this.min=0;}if(this.answer===undefined||this.answer===null||this.answer<this.min){this.answer=this.min;}if(this.answer>this.max){this.answer=this.max;}break;case"Text box":if(this.dataType===14&&g.ShowTime==="-1"){this.interval=parseFloat(this.prs.Interval)||1;var j=R.parseDateAndOrTime((this.answer||""));var f=R.parseDateAndOrTime((this.min||""));var b=R.parseDateAndOrTime((this.max||""));defaultTimeInfo={match:"12:00:00 AM",hour:0,min:0,sec:0};var d=R.formatTimeInfo(defaultTimeInfo,a().TIMEOUTPUTFORMAT);if(j&&!j.time){this.answer=this.answer+" "+d;}if(f&&!f.time){this.min=this.min+" "+d;}if(b&&!b.time){this.max=this.max+" "+d;}}break;}},populateAnswer:function P(b){if(b&&b.text){this.answer=b.text;}},buildAnswerObject:function S(){var b=this._super();b.ans={text:this.answer};return b;},setAnswerValue:function C(b){if(this.isNumericDataType()){b=mstrmojo.num.toString(b,false);}this.validate(b);this.answer=b;},getAnswerXML:function V(){return this.answer;},buildShortAnswerXML:function I(b){b.addText(this.isNumericDataType()?mstrmojo.num.toLocaleString(this.answer||""):(this.answer||""));},stepUp:function H(){if(this.getStyle()===X.STEPPER){O.call(this,true);}},canStepUp:function U(){return(this.getStyle()===X.STEPPER&&Q.call(this,true).s);},stepDown:function E(){if(this.getStyle()===X.STEPPER){O.call(this,false);}},canStepDown:function N(){return(this.getStyle()===X.STEPPER&&Q.call(this,false).s);},toggleSwitch:function A(){if(this.getStyle()===X.SWITCH){var d=this.prs,b=(this.getDisplayValue(true,false))?d.OffValue:d.OnValue;this.set("answer",b);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider");function C(H,G){var I=G?H.max:H.min,E=G?H.min:H.max,F=H.getVal(G?1:-1);return(I===null||(G?(F<=I):(F>=I))||(E!==null&&H.canLoop));}function D(K,J){var H=K.min,E=K.max,L=J?1:-1,G=K.getVal(L),F=K.canLoop,I=J?(E!==null&&G>E):(H!==null&&(G<H));if(I){if(F){G=((G-H)%(E-H+1))+H;G=(G>=H)?G:G+(E-H+1);}else{return ;}}K.curVal=G;K.item[K.valField]=K.curVal;if(K.onTraverse){K.onTraverse();}}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);this.initProps(E);},initProps:function B(){var E=this.isInfinite(this.minField)?null:this.item[this.minField],F=this.isInfinite(this.maxField)?null:this.item[this.maxField];intVal=this.item[this.intField];if(E!==null&&typeof E!==undefined){this.min=E;}if(F!==null&&typeof F!==undefined){this.max=F;}if(intVal!==null&&typeof intVal!==undefined){this.interval=intVal;}this.curVal=this.item[this.valField];if(this.curVal===null||typeof this.curVal==="undefined"){this.curVal=(this.min!==null)?this.min:0;}},isInfinite:function A(E){return(typeof E==="undefined"||E===null||this.item[E]===null||typeof this.item[E]==="undefined");},next:function(){D(this,true);},prev:function(){D(this,false);},hasPrev:function(){return C(this,false);},hasNext:function(){return C(this,true);},renderItemAt:function(F){var E=this.getVal(F);return(this.renderer)?this.renderer.render(E,this):E;},getVal:function(E){E=(E)?E:0;return this.curVal+this.interval*E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRectangle" title="{@tooltip}" style="{@domNodeCssText}"></div>',markupMethods:{onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width+"px";}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["RW","B","background-color","fx"]},preBuildRendering:function A(){var D=this._super(),C=this.defn;if(C.r){this.domNodeCssText+=mstrmojo.css.buildRoundCorners(C.r,C.topc);}return D;},postBuildRendering:function(){var E=this._super();var D=this.fmts;if(D){var C=D.border||D["border-width"],F=C&&(parseInt(C,10)/72*this.model.dpi);if(F){if(D.height=="100%"){this.set("height",this.domNode.clientHeight-2*F);}if(D.width=="100%"){this.set("width",this.domNode.clientWidth-2*F);}}}return E;},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl");mstrmojo.DefaultDIC=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DefaultDIC",isDummy:true,showInPopup:function(){mstrmojo.alert("The control style has not been supported yet.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo._IsAnchorable");var B=1,H=2,E=3,G=4;var F="title",D="content";mstrmojo.VisTextTooltip=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.VisTextTooltip",left:0,top:0,zIndex:10,boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:"mstrmojo-vis-tip",anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,tipNodeColor:"#ffffff",utils:mstrmojo.VisChartUtils,touchAreaType:D,markupString:'<div id="{@id}" class="{@cssClass}" style="top:{@top}px;left:{@left}px;z-index:{@zIndex};position:absolute;{@cssText};"><div class="timeseries-slider-tooltip" style="display: block"></div><div class="mstrmojo-vis-tip" style="display: block"></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];}},toggle:function A(I){if(I){this.domNode.style.display="block";}else{this.domNode.style.display="none";}},updateContent:function(I,K,J){this.fillContent(I,K,J);this.positionDialog();},fillContent:function C(I,K,J){this.anchor=I;this.touchAreaType=K;this.domNode.firstChild.innerHTML=J||this.anchor.innerText;this.toggle(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.BarcodeReader","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton");var A=mstrmojo.array;mstrmojo.android.inputControls.BarcodeDIC=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.BarcodeDIC",markupString:"<div></div>",showInPopup:function(){var C=this;var E={success:function(F){if(F!==""){if(!!C.dic.em){C.value=C.dic.vls[parseInt(F,10)].v;}else{C.value=F;}C.applyChanges();}},failure:function(F){}};var D={barcodeDIC:true};if(!!C.dic.em){var B=[];A.forEach(C.dic.vls,function(G,F){B[F]=G.m||G.v;});D.vls=B;}mstrmojo.BarcodeReader.readBarcodes(D,E,this.popupTitle);}});})();(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.css");var o=function(){return mstrmojo.locales.datetime;},W=mstrmojo.dom,U=mstrmojo.expr,k=U.DTP,P=mstrmojo.date,G=mstrmojo.publisher,R=mstrmojo.hash,Y=mstrmojo.array,J=Y.removeIndices,X=mstrmojo.css;var E='<table border="0" cellpadding="0" cellspacing="0">',g="</table>";function K(q){return'<table border="0" cellpadding="0" cellspacing="0" style="'+q+'">';}function F(w,q,s){var t=P.getFirstDateOfMonth(w,q);return(t.getDay()-s+8)%7;}function Z(x){var w=P.parseDateAndOrTime(x),z,q,s;if(w){s={};z=w.date;q=w.time;if(z){R.copy(z,s);}if(q){R.copy(q,s);}}return s;}function D(s,x,w,t,q){var z=P.formatDateInfo({day:s,month:x,year:w},o().DATEOUTPUTFORMAT);return P.inDateTimeRange(z,t,q)==0;}function N(x,w,t){var s=x.decreaseButton,q=x.increaseButton,AA="mstrmojo-Calendar",z=function(AE,AD,AB){var AC=!D(AB.d,AB.m,AB.y,x.min,x.max);AE.className=(AA+AD)+(AC?" disabled":"");AE.disabled=AC;};z(s,"-decrease",w);z(q,"-increase",t);}function O(x,s,AA,w){var t=0,q=x.length,z;for(t=0;t<q;t++){z=x[t];if(z&&z.day===s&&z.month===AA&&z.year===w){return t;}}return -1;}function b(q,t,s){var w=new Date();return(w.getFullYear()==s)&&((w.getMonth()+1)==t)&&(w.getDate()==q);}function f(AB,AC){var AG=AB.dayView.getElementsByTagName("div"),AE=AB.selectedDates,t=AE[AC],AF=AB.browseYear,s=AB.browseMonth,x=P.getDaysOfMonth(AF,s),w=P.getPreMonth(AF,s),AA=P.getDaysOfMonth(w.y,w.m),q=F(AF,s,AB.firstDayOfWeek),z=((t.month==s)?t.day+q-1:(t.month>s?t.day+q+x-1:q-AA+t.day-1)),AD=AG[z];if(AD){Q(AD,AB,false);}J(AE,AC,1);}function A(q){var s=q.selectedDates;while(s.length){f(q,0);}}function p(t,q){var s=H(t,q),w=t.selectedDates;w.push({day:s.d,month:s.m,year:s.y});Q(q,t,true);}function a(t,w){if(!w||!w.length){return null;}var z=t.selectedDates;for(var s=0,q=w.length;s<q;s++){var x=w[s],AA=d(t,x);z.push({day:x.d,month:x.m,year:x.y});if(AA){Q(AA,t,true);}}}function d(AC,AE){var AG=AC.dayView.getElementsByTagName("div"),w=AG.length,AF=AC.browseYear,s=AC.browseMonth,x=P.getPreMonth(AF,s),z=P.getDaysOfMonth(x.y,x.m),AK=P.getNextMonth(AF,s),t=P.getDaysOfMonth(AF,s),q=F(AF,s,AC.firstDayOfWeek);var AA=q>0?{y:x.y,m:x.m,d:AG[0].innerHTML}:{y:AF,m:s,d:AG[0].innerHTML},AI=(AG.length-t-q)>0?{y:AK.y,m:AK.m,d:AG[w-1].innerHTML}:{y:AF,m:s,d:AG[w-1].innerHTML},AJ=M(AA,AE),AB=M(AE,AI),AD=null;if(AJ>=0&&AB>=0){var AH=0;if(AJ<q){AH=-1;}if(AB<(AG.length-q-t)){AH=1;}AD=((AH==0)?AE.d+q-1:(AH==1?AE.d+q+t-1:q-z+AE.d-1));return AG[AD];}else{return null;}}function T(AC,q){var AE=AC.selectedDates,t=AE.length;if(!t){return null;}var s=AE[t-1],w=H(AC,q),AH=M({y:s.year,m:s.month,d:s.day},w),AI=[],z=AH>0,AF=Math.abs(AH);for(var AB=0;AB<=AF;AB++){var AA=new Date(w.y,w.m-1,w.d);AA.setDate(AA.getDate()+(z?-AB:AB));var AG=AA.getFullYear(),x=AA.getMonth()+1,AD=AA.getDate();if(AC.isDateDisabled(AD,x,AG,AC.min,AC.max)){continue;}AI.push({y:AG,m:x,d:AD});}return AI;}function M(w,t){var q=new Date(w.y,w.m-1,w.d),s=new Date(t.y,t.m-1,t.d);return(s-q)/1000/3600/24;}function H(s,q){var t=s.browseYear,x=s.browseMonth,w=parseInt(q.innerHTML,10),z=parseInt(q.getAttribute("m"),10);ymd=null;ymd=(z===0)?{y:t,m:x}:(z===1?P.getNextMonth(t,x):P.getPreMonth(t,x));ymd.d=w;return ymd;}function V(q){var t=q.selectedDates,s=t.length;return(s===0)?null:t[s-1];}function Q(s,t,q){var w=t.selectedColor;X.toggleClass(s,["selected",t.selectedCssStyle],q);s.parentNode.style.backgroundColor=q?w:"";s.style.backgroundColor=q?w:"";}function j(q){return q.selectedColor?('style="background-color:'+q.selectedColor+';"'):"";}function L(q){return(q.tagName.toLowerCase()=="td")?q.firstChild:q;}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:"day",duration:600,timeDelimiter:":",dtp:k.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,okLabel:mstrmojo.desc(1442,"OK"),monthNames:function(q){return o().MONTHNAME_SHORT[q];},dayNames:function(q){return o().dayShortNames[q];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-comma">,</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span></div><div class="mstrmojo-Calendar-tools"><div class="mstrmojo-Calendar-ok"> {@okLabel} </div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===k.TIMESTAMP||this.dtp===k.TIME)?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:function(){this.tools.style.display=(this.changeValueOnOK?"block":"none");}},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].childNodes[1];},yearView:function(){return this.domNode.childNodes[1].lastChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},tools:function(){return this.domNode.childNodes[3];},okButton:function(){return this.domNode.childNodes[3].firstChild;}},init:function l(q){if(this._super){this._super(q);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};},getSelectedDatesAsString:function C(s){var q=[];Y.forEach(this.selectedDates,function(t){q.push(P.formatDateInfo(t,s||o().DATEOUTPUTFORMAT));});return q;},updateSelectedDate:function I(){var q=this.value,s=this.timeVal,w=this.selectedDates,t,x=function(AA,z){AA.set("browseYear",z.year);AA.set("browseMonth",z.month);AA.updateTimePart();AA.updateView(AA.currentView);};if(w.length===0){if(q){t=Z(q);if(t&&t.hour!==undefined){s.hour=t.hour;s.min=t.min;s.sec=t.sec;}}if(!t){t=P.getDateJson(new Date());}if(this.isDateDisabled(t.day,t.month,t.year,this.min,this.max)){if(this.min&&P.compareDate(t,this.min)<0){t=Z(this.min);}else{if(this.max&&P.compareDate(t,this.max)>0){t=Z(this.max);}}}w.push(t);x(this,t);}else{t=w[0];if(this.value!=null){x(this,t);}}},updateValue:function S(){var s=V(this),q="";if(s){q=P.formatDateInfo(s,o().DATEOUTPUTFORMAT);if(this.dtp!==k.DATE){q+=" "+P.formatTimeInfo(this.timeVal,o().TIMEOUTPUTFORMAT);}}this.lastValue=q;this.set("value",q);if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function h(){var s=this.timeVal,q=s.hour||0,t=(q%12===0)?12:(q%12);this.hourLabel.innerHTML=q<12?t+o().AM_NAME:t+o().PM_NAME;this.minuteLabel.innerHTML=P.formatInteger(s.min||0,2);this.secondLabel.innerHTML=P.formatInteger(s.sec||0,2);},premousedown:function(q){var w=q.e,s=W.eventTarget(q.hWin,w);if(s===this.decreaseButton||s===this.increaseButton){if(W.isFF){W.stopPropogation(window,w);}return true;}else{return this.processEvent(s,w);}},premouseup:function(q){var w=q.e;if(w.ctrlKey||w.shiftKey){W.clearBrowserHighlights();}var s=W.eventTarget(q.hWin,w);if(s===this.decreaseButton&&!s.disabled){this.decrease();return true;}if(s===this.increaseButton&&!s.disabled){this.increase();return true;}},processEvent:function(AH,AO){var z=this.currentView,AA=this.selectedDates,q=V(this),AE,AJ,AP,s,AG;if(AH===this.okButton&&this.changeValueOnOK){this.updateValue();}if(AH===this.monthLabel){if(z!=="month"){this.switchViewTo("month");}return true;}if(AH===this.yearLabel){if(z!=="year"){this.adjustYearStart();this.switchViewTo("year");return true;}}if(AH===this.hourLabel){if(z!=="hour"){this.switchViewTo("hour");}return true;}if(AH===this.minuteLabel){if(z!=="minute"){this.switchViewTo("minute");}return true;}if(AH===this.secondLabel){if(z!=="second"){this.switchViewTo("second");}return true;}if(W.contains(this.hourView,AH,false,this.domNode)){var AC=AH.getAttribute("h");AG=parseInt(AH.innerHTML,10);if(!isNaN(AC)&&!isNaN(AG)){AC=parseInt(AC,10);this.timeVal.hour=AG%12+AC*12;this.updateTimePart();this.switchViewTo("day");if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.minuteView,AH,false,this.domNode)){AG=parseInt(AH.innerHTML,10);if(!isNaN(AG)){this.timeVal.min=AG;this.updateTimePart();this.switchViewTo("day");if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.secondView,AH,false,this.domNode)){AG=parseInt(AH.innerHTML,10);if(!isNaN(AG)){this.timeVal.sec=AG;this.updateTimePart();this.switchViewTo("day");if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.dayView,AH,false,this.domNode)){var AN=this.browseYear,w=this.browseMonth,x;AH=L(AH);AP=parseInt(AH.innerHTML,10);s=parseInt(AH.getAttribute("m"),10);if(!isNaN(AP)&&!isNaN(s)){x=(s===0)?{y:AN,m:w}:(s===1?P.getNextMonth(AN,w):P.getPreMonth(AN,w));if(this.isDateDisabled(AP,x.m,x.y,this.min,this.max)||AO.button==2){return true;}var AK=O(AA,AP,w,AN),AI=AA.length>1,AF=this.forceNonEmptySelection,AL=this.isMultiSelect,AD=AL&&AO.ctrlKey,AM=AL&&AO.shiftKey,AB=null;if(AM){AB=T(this,AH);A(this);a(this,AB);}else{if(AD){if(AK===-1){p(this,AH);}else{if(!AF||AI){f(this,AK);}}}else{A(this);if(AI||AK===-1||AF){p(this,AH);}}}if(this.onselect||G.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(s===1){this.increase();}else{if(s===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.monthView,AH,false,this.domNode)){AH=L(AH);AJ=parseInt(AH.getAttribute("m"),10);if(!isNaN(AJ)){this.set("browseMonth",AJ+1);this.switchViewTo("day");}return true;}if(W.contains(this.yearView,AH,false,this.domNode)){AH=L(AH);AE=parseInt(AH.innerHTML,10);if(!isNaN(AE)){this.set("browseYear",AE);this.switchViewTo("day");}return true;}return true;},decrease:function(){var t=this.currentView,z=t,x=this.browseYear,q=this.browseMonth,s=this.yearRangStart,w;switch(t){case"day":w=P.getPreMonth(x,q);this.set("browseMonth",w.m);this.set("browseYear",w.y);break;case"month":this.set("browseYear",x-1);break;case"year":this.yearRangStart=s-this.yearViewSize*this.yearViewSize;break;case"hour":z="second";break;case"minute":z="hour";break;case"second":z="minute";break;}this.switchViewTo(z,"right");},increase:function(){var t=this.currentView,z=t,x=this.browseYear,q=this.browseMonth,s=this.yearRangStart,w;switch(t){case"day":w=P.getNextMonth(x,q);this.set("browseMonth",w.m);this.set("browseYear",w.y);break;case"month":this.set("browseYear",x+1);break;case"year":this.yearRangStart=s+this.yearViewSize*this.yearViewSize;break;case"hour":z="minute";break;case"minute":z="second";break;case"second":z="hour";break;}this.switchViewTo(z,"left");},updateView:function(q){var s=this[q+"ViewHTML"]();this[q+"View"].innerHTML=s;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(s,w){var AB="mstrmojo-Calendar-"+s+"View",AA=document.createElement("div"),q=this[this.currentView+"View"],x=s+"ViewHTML",z=this[this.currentView+"Label"],t=this[s+"Label"];if(!this.supportedViews[s]){return ;}if(!w){w=this.sDirMatrix[this.currentView][s];}AA.className=AB;AA.innerHTML=this[x]();this.currentView=s;if(z){mstrmojo.css.removeClass(z,["highlight"]);}if(t){mstrmojo.css.addClass(t,["highlight"]);}this[s+"View"]=AA;this._slideIntoView(q,AA,w);},_slideIntoView:function(z,AD,w){var q=this.bodyContainer,AB=(w==="left"||w==="right")?z.offsetWidth:z.offsetHeight,s=(w==="left"||w==="right")?"left":"top",AC=(w==="left"||w==="up")?AB:-AB,AA=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:z,onEnd:function(){q.removeChild(z);}}),x=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AD});AD.style[s]=AC+"px";q.appendChild(AD);AA.props[s]={start:0,stop:-AC,suffix:"px"};x.props[s]={start:AC,stop:0,suffix:"px"};AA.play();x.play();},dayViewHTML:function(){var z=this.browseYear,AC=this.browseMonth,AH=P.getDaysOfMonth(z,AC),AL=P.getPreMonth(z,AC),t=P.getDaysOfMonth(AL.y,AL.m),s=P.getNextMonth(z,AC),AD=F(z,AC,this.firstDayOfWeek),AA=[],w=j(this),AN=0,q=this.selectedDates,AF=this.min,AJ=this.max,AO,AG,AK,AI,AM=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";N(this,{d:t,m:AL.m,y:AL.y},{d:1,m:s.m,y:s.y});AA.push(K(this.cssTextDay));AA.push(this._dayViewTHead());AA.push("<tr>");for(AK=0;AK<AD;AK++){AO=t-AD+AK+1;AG=this.isDateDisabled(AO,AL.m,AL.y,AF,AJ)?"disabled":"";AA.push("<td "+AM+'><div class="mstrmojo-Calendar-day-pre '+AG+'" m="-1">');AA.push(AO);AA.push("</div></td>");AN++;}for(AK=0;AK<AH;AK++){AO=AK+1;AG=this.isDateDisabled(AO,AC,z,AF,AJ)?" disabled":"";var x=b(AO,AC,z),AB=x?" today":"",AE=O(q,AO,AC,z)!==-1;AB=(this.hilightToday&&x)?" hilightToday":AB;AA.push("<td "+(x?('class="'+AB+'" '):" ")+(AE?w:"")+'><div class="mstrmojo-Calendar-day-cur'+(AE?(" selected "):"")+AG+'" m="0"'+(AE?w:"")+">");AA.push(AK+1);AA.push("</div></td>");if((++AN)%7===0){AA.push("</tr><tr>");}}for(AI=AN;AI<42;AI++){AO=AN-AH-AD+1;AG=this.isDateDisabled(AO,s.m,s.y,AF,AJ)?"disabled":"";AA.push("<td "+AM+'><div class="mstrmojo-Calendar-day-next '+AG+'" m="1">');AA.push(AO);AA.push("</div></td>");if((++AN)%7===0&&AN!==42){AA.push("</tr><tr>");}}AA.push("</tr>");AA.push(g);return AA.join("");},_dayViewTHead:function(){var w=[],x='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',t="</tr></thead>",s=this.firstDayOfWeek-1,z=this.dayNames,q;w.push(x);for(q=s;q<s+7;q++){w.push("<td>");w.push(z(q%7));w.push("</td>");}w.push(t);return w.join("");},monthViewHTML:function(){var s=[],w=this.browseMonth-1,t=this.browseYear,q;N(this,{d:31,m:12,y:t-1},{d:1,m:1,y:t+1});s.push(K(this.cssTextMonth));s.push("<tr>");for(q=0;q<12;q++){s.push("<td "+((q===w)?j(this):"")+'><div class="mstrmojo-Calendar-month'+((q===w)?" selected":"")+'" m="');s.push(String(q));s.push('">');s.push(this.monthNames(q));s.push("</div></td>");if(q%3===2){s.push("</tr><tr>");}}s.pop();s.push("</tr>");s.push(g);return s.join("");},yearViewHTML:function(){var z=this.yearRangStart,s=[],w=this.browseYear,x,q,t=this.yearViewSize;N(this,{d:31,m:12,y:z-1},{d:1,m:1,y:z+t*t});s.push(K(this.cssTextYear));s.push("<tr>");for(q=0;q<t*t;q++){x=z+q;s.push("<td "+((w===x)?j(this):"")+'><div class="mstrmojo-Calendar-year'+((w===x)?" selected":"")+'">');s.push(x);s.push("</div></td>");if(q%t===(t-1)){s.push("</tr><tr>");}}s.pop();s.push("</tr>");s.push(g);return s.join("");},hourViewHTML:function(){var t=[],s=this.timeVal.hour,q;t.push(E);t.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');t.push(o().AM_NAME);t.push("</div></td></tr>");for(q=0;q<12;q++){t.push('<td><div class="mstrmojo-Calendar-hour'+((q===s)?" selected":"")+'" h="0">');t.push((q===0)?12:q);t.push("</div></td>");if(q===5){t.push("</tr><tr>");}}t.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');t.push(o().PM_NAME);t.push("</div></td></tr>");for(q=0;q<12;q++){t.push('<td><div class="mstrmojo-Calendar-hour'+(((12+q)===s)?" selected":"")+'" h="1">');t.push((q===0)?12:q);t.push("</div></td>");if(q===5){t.push("</tr><tr>");}}t.push("</tr>");t.push(g);return t.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(w,x){var t=[],q;t.push(E);t.push("<tr>");for(q=0;q<60;q++){t.push('<td><div class="');t.push(x);t.push((q===w)?' selected">':'">');t.push(q);t.push("</div></td>");if(q%10===9){t.push("</tr><tr>");}}t.pop();t.push("</tr>");t.push(g);return t.join("");},isDateDisabled:function(q,t,s){var w=P.formatDateInfo({day:q,month:t,year:s},o().DATEOUTPUTFORMAT);return !D(q,t,s,this.min,this.max);},unrender:function B(q){delete this.lastValue;this._super(q);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var D=mstrmojo.dom,E=mstrmojo.hash,B=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){B[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){B[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.textNode.innerHTML=this.text;},onwidthChange:function(){var F=this.width;if(F){this.domNode.style.width=F;}}},oniconClassChange:function C(G){if(this.hasRendered&&this.domNode){var F=G.valueWas,H=G.value;this.domNode.className=this.domNode.className.replace(F,"")+" "+H;}},onclick:mstrmojo.emptyFn,ontouchend:function A(F){this.onclick(F);}});mstrmojo.Button.newIconButton=function(H,K,I,F,J){var G={scriptClass:"mstrmojo.Button",title:H,cssClass:K,text:"",onclick:I};if(F){G.bindings=F;}E.copy(J,G);return G;};mstrmojo.Button.newInteractiveButton=function(G,H,J,I){var F={scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",text:G,glowClass:"glow"};if(H){F.onclick=H;}if(J&&(D.isFF||D.isWK)){E.copy({onmousedown:function(){B.applyShadow(this.domNode,0,0,10,J);},onmouseup:function(){B.removeShadow(this.domNode);}},F);}E.copy(I,F);return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRoundRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRoundRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRoundRectangle" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocRoundRectangle-l1" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div style="{@rectNodeCssText}{@rectNodeGradCssText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l1" style="{@bCornersCssText}{@bCornersCssGradText}"></div></div>',markupSlots:{rectNode:function(){return this.domNode.childNodes[3];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["top","left","width","z-index","fx"],rectNode:["height","background-color"],tCorners:["background-color"],bCorners:["background-color"]},update:function C(D){if(this.thresholdId||D.data.tid){delete this.fmts;}this.thresholdId=D.data.tid;this.set("visible",!D.data.hidden);},preBuildRendering:function B(){var F=this._super();var G=this.getFormats(),D=!!this.defn.topc,I=(D)?4:8,H="(\\d*px)",E=Math.max(parseInt(G.height,10)-I,0);if(G.height==="100%"){H="(100%)";E=this.parent.height()-I;}this.rectNodeCssText=this.rectNodeCssText.replace(new RegExp("(.*height:)"+H+"(.*)"),"$1"+E+"px$3");if(D){this.bCornersCssText="display:none;";}return F;},formatGradient:function A(E,H){var F=mstrmojo.css.buildGradient(E.t,E.sc,E.ec);if(!F){return ;}var D=F.n+":"+F.v+";",G="background-color:";this.rectNodeGradCssText=D;if(E.t===0){this.tCornersCssGradText=G+E.sc+";";this.bCornersCssGradText=G+E.ec+";";}else{this.tCornersCssGradText=this.bCornersCssGradText=D;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},preBuildRendering:function I(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(L){if(L===this.textNode||L===this.titleNode){return ;}var N=this.provider,M=((L===this.nextNode)?"Next":"Prev");if(N["has"+M]()){N[M.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(L,M){var N=this;this._holdTimer=setInterval(function(){N[M](L);},C);},stopStepperInterval:function G(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function K(L){this.processEvent(L.e.target);},onmousedown:function D(L){if(!this._holdTimer&&!this._startHoldTimer){var M=this;this._startHoldTimer=setTimeout(function(){delete M._startHoldTimer;M.startStepperInterval(L,"onclick");},B);}},onmouseup:function H(){if(this._startHoldTimer){clearTimeout(this._startHoldTimer);delete this._startHoldTimer;}this.stopStepperInterval(this);},onselectstart:function J(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocLine=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocLine",markupString:'<div id="{@id}" class="mstrmojo-DocLine" title="{@tooltip}" style="{@domNodeCssText}"></div>',formatHandlers:{domNode:["RW","border-top","border-left","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}},getFormats:function A(){var C=this._super();if(C&&parseInt(C.height,10)===0){C.height="1px";}return C;}});})();(function(){var Q="<tr>";var Y=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var T="&nbsp;";var I="fsbp_1 ";var X="fsbp_2 ";var B="fsbp_3 ";var V=1,W=2,F=3,K=4,A=5,S={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" no-stack",5:" stack-full"};var Z=mstrmojo.css;var L=4;function E(g,f){for(var h=0,b=g.length;h<b;h++){var k=g[h];var j=f.rows[k.rows].cells[k.cells];if(j){mstrmojo.css.addClass(j,I);}}}mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function J(b){this._super(b);},numColumnCanMerge:0,preBuildRendering:function D(b){var d=this.cp;if(!d){return ;}d.initContent();this.rc=d.rc||0;this.cws=d.colWidths||[];this.cc=this.cws.length;this.tdWidths=d.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=d.getNumAutoHeightRows&&d.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function H(d){var b=this._super(d);this.renderGrid();return b;},renderGrid:function R(d){var b=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(b,d);this.postBuildGridTable();},getGridContainer:function a(){return this.gridContainerNode;},buildGridTable:function G(f,b){var d=this.getTableStartMarkup();var o=this.getTableEndMarkup();if(b){this.mergeHdrsAcrossBlks=true;}var k=this.buildTableRowsMarkup(this.start,this.end,d,o).join("");if(b){var h=document.createElement("div");h.innerHTML=k;var l=f.firstChild,p=l&&l.tBodies,g=h.firstChild.tBodies[0],j=this.matchedHdrsAcrossBlks;l.appendChild(g);if(j&&j.length>0){E(j,p[p.length-2]);}}else{f.innerHTML=k;}},getTableStartMarkup:function O(){var d=this._getGridWidths(),b=Y;b[1]=d.tableLayout;b[3]=d.totalColWidths;b[5]=this.tableCssClass?"class="+this.tableCssClass:"";b[7]="<colgroup>"+d.colgroup+"</colgroup>";if(this.tbodyStyle){b[8]='<tbody style="'+this.tbodyStyle+'">';}return b.join("");},getTableEndMarkup:function N(){return"</tbody></table>";},_getGridWidths:function U(){var o={};var h="",f=[],l="fixed",d=this.cws,j=d.length;if(j){h=0;f=[];for(var g=0;g<j;g++){if(d[g].w!==""){h+=parseInt(d[g].w,10);}}for(g=0;g<j;g++){var b=d[g];if(b.w!==""){var k=parseInt(b.w,10);if(mstrmojo.dom.isIE7){if(k===0){f.push('<col style="width:0%;display:none"></col>');}else{f.push('<col style="width:'+(k/h*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&k===0){f.push('<col style="width:-1px"></col>');}else{f.push('<col style="width:'+b.w+'"></col>');}}}else{f.push("<col />");l="auto";}}this.totalColWidth=h;}o.colgroup=f.join("");l=this.tableLayout||l;if(this.autoFitWindow){l=this.tableLayout||l||"fixed";h="100%";}else{if(l=="fixed"){h+="px";}else{h="auto";}}o.totalColWidths=h;o.tableLayout=l;return o;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function P(z,h,AX,d){var AL=[],AV=0;AL[AV++]=AX||"<table><tbody>";var AA=this.cp,AF=AA.getRowHeight(),AT=this._CELL_MARKUP,AK=AF?'<tr style="height:'+(AF?AF+"px":"")+'">':Q;var g=true,w=true,AR=[],AN;this.matchedHdrsAcrossBlks=[];for(var AO=z;AO<=h;AO++){AN=AV++;AL[AN]=AO<this.numAutoHeightRows?Q:AK;var o=AA.getRowCells(AO);var AJ=h+1-AO;var AI=0;if(!this.mergeHdrsAcrossBlks){if(g&&z>0&&o.length<AA.colWidths.length){var AH=AA.getUnmergedCells(z);if(AH){AI=AH.length;}for(var AU in AH){var AQ=AH[AU];if(AQ.rs>AJ){AT[1]=AJ;AT[5]=X+AQ.css;}else{AT[1]=AQ.rs||1;AT[5]=B+AQ.css;}if(AQ.cet){AT[5]+=" mstrmojo-selected-cell";this.addHilitePosition(AQ.cet,AO,AU);}if(AQ._ei){this.addExtraInfoMap(AQ._ei,AO,AU);AT[5]+=" pt";}AT[9]="";AT[13]=T;AT[3]=AQ.cs;AT[7]=AQ._ei!==undefined?AQ._ei:"";AL[AV++]=AT.join("");}g=false;}}for(var AW=0,k=o.length;AW<k;AW++){var AD=o[AW],AE;if(AD.rs&&AD.rs>AJ){AT[1]=AJ;AT[5]=I+AD.css;if(AD._ei){this.addExtraInfoMap(AD._ei,AO,AW);}}else{AT[1]=AD.rs||1;AT[5]=AD.css;}if(AD.rowType!==V){AT[5]+=" xtab-td ";}if(AD.cet){AT[5]+="sc_"+this.parent.k;this.addHilitePosition(AD.cet,AO,AW);}AE=AD.rowType;if(AE){AT[5]+=S[AE]||"";var l=AA.getRowHeight(AE);if(l){AL[AN]='<tr style="height:'+(l?l+"px":"")+'">';}}AT[3]=AD.cs||1;AT[7]=AD._ei!==undefined?AD._ei:"";if(AD.fs||AD._e){this.addTitleHeaderPositionMap(AO,AW+AI,AD);}if(AD._ei!=null){this.addPositionMap(AD._ei,AO,AW+AI);}AT[11]=AO;if(AD.ts===L){var s=AD.v;if(this.imgCacheMap){var AS=this.imgCacheMap,AM=s&&s.replace(/\\/g,"/");if(AS.cachedImg[AM]){AD.v=s=AS.baseURL+AS.cachedImg[AM];}else{if(AM&&!AS.unCachedImg[AM]){AS.unCachedImg[AM]=AM;}}}else{var f=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(f&&f.getImage){s=f.getImage(s);}}if(AD.rowType){var b=(AA.getRowHeight(AD.rowType)||AA.rh||AF),AP=b,x=this.tdWidths,AG=AD.colIdx,AB=0;if(AG!=="undefined"&&AG>-1&&x&&x.length>AG){var q=x[AG]&&x[AG].w;if(q!=="undefined"){AB=parseInt(q,10);}}var t=AB>30?(AB-30):0;AT[13]='<div><div style="top:'+(-parseInt(AP/2,10))+"px;height:"+b+"px;line-height:"+b+'px !important;">&nbsp;<img style="max-height:'+b+"px; max-width: "+t+'px;" src="'+s+'"></img></div></div>';}else{if(this.parent.gridData.lhv){AT[9]="background-image:url('"+s+"');background-repeat:no-repeat;background-position:center "+(AD.rs>1?"top":"center")+";";AT[13]=T;}else{AT[9]="";AT[13]='<img src="'+s+'"></img>';if(AD.css&&AD.css.indexOf("hl")>-1){AT[13]="<span>"+AT[13]+"</span>";}}}}else{AT[9]="";AT[13]=AD.v||AD.n||T;if(AD.css&&AD.css.indexOf("hl")>-1){AT[13]="<span>"+AT[13]+"</span>";}}if(AW<this.numColumnCanMerge){if(AO===z&&this.mergeHdrsAcrossBlks){var AC=this.rowHdsAcrossBlks;if(w&&AD.v&&AC&&AC[AW]){if(AD.v===AC[AW].v){AT[1]=AD.rs||1;AT[5]=B+AD.css;AT[13]="";this.matchedHdrsAcrossBlks.push(AC[AW]);}else{w=false;}}}if(AT[1]>=AJ&&AD.v){AR.push({rows:AO-z,cells:AW,v:AD.v});}}AL[AV++]=AT.join("");}AL[AV++]="</tr>";}AL[AV++]=d||"</tbody></table>";this.rowHdsAcrossBlks=AR;return AL;},addHilitePosition:function(d,f,b){var g=this.hiliteCellsMap[d];if(!g){this.hiliteCellsMap[d]={pos:[],nodes:[]};}this.hiliteCellsMap[d].pos.push({row:f,cell:b,page:0});},addExtraInfoMap:function(d,b,f){if(!this.eiMap[d]){this.eiMap[d]=[];}this.eiMap[d].push({row:b,cell:f,page:0});},addPositionMap:function(d,b,f){if(!this.posMap[d]){this.posMap[d]={row:b,cell:f,page:0};}},addTitleHeaderPositionMap:function(b,f,d){this.thPosMap.push({row:b,cell:f,page:0,obj:d});},clearHilites:function(o){var g=this.hiliteCellsMap[o],h=g&&g.nodes,k=this.parent;if(h){if(h.length==0&&g.pos){h=this.getNodesByPositions(g.pos);}for(var f=0,b=h.length;f<b;f++){var d=h[f],j=d.className,l=k.getCellForNode(d);if(l){delete l.cet;}Z.removeClass(d,"sc_"+k.k);}this.hiliteCellsMap[o].nodes=[];}},setHilites:function(d,f){Z.addClass(f,"sc_"+this.parent.k);if(!this.hiliteCellsMap[d]){this.hiliteCellsMap[d]={pos:[],nodes:[]};}this.hiliteCellsMap[d].nodes.push(f);var b=this.parent.getCellForNode(f);if(b){b.cet=d;}},getNodesByPositions:function(h){var g=this.tableNode,b=[];for(var f in h){var d=h[f];b.push(g.tBodies[0].rows[d.row].cells[d.cell]);}return b;},preBuildGridTable:function C(){},postBuildGridTable:function M(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._ListSelections");mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onheightChange:function(){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width;}}},buildRendering:function E(){this.itemsHtml="";var F=this.items&&this.items.length;if(F){this.itemsHtml=this._buildItemsMarkup(0,F-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,_buildItemsMarkup:function(F,I,R,G,U,H){var V=[],N=0;V[N++]=R||"";var L=this.itemRenderer,Q=L&&L.render;if(Q&&typeof (Q)=="function"){var T=U||"",S=H||"",K=this.items,M=(K&&K.length)||0,O=this;for(var J=F,P=Math.min(I+1,M);J<P;J++){V[N++]=T;V[N++]=Q(K[J],J,O);V[N++]=S;}}V[N++]=G||"";return V;},onselectionChange:function A(P){if(!P){return ;}var M=this.itemRenderer;if(!M){return ;}var I=M.unselect,L=this.items||[],Q=P.removed,H,G;if(I&&Q){for(var J=0,R=Q.length;J<R;J++){H=Q[J];G=this._getItemNode(H);if(G){I(G,L[H],H,this);}}}var F=M.select,O=P.added;if(F&&O){for(var K=0,N=O.length;K<N;K++){H=O[K];G=this._getItemNode(H);if(G){F(G,L[H],H,this);}}}if(this.onchange){this.onchange();}},onselect:function B(F){if(this.makeSelection&&F.idxs&&F.idxs.length){var G=this._getItemNode(F.idxs[0]);this.makeSelection({selIdx:F.idxs[0],selItem:G});}},autoHide:false,init:function D(F){this._super(F);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},_getItemNode:function(F){var G=this.itemsContainerNode;return(G&&G.childNodes[F])||null;},_set_items:function C(I,F){if(this.autoHide){this.set("visible",!!(F&&F.length));}var H=this.items;this.items=F;if(H!=F){var G=this.hasRendered;if(G){this.unrender();}this.clearSelect();if(G){this.render();}return true;}else{return false;}return H!=F;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var F=mstrmojo.array,C=mstrmojo.css,G=mstrmojo.string,B=mstrmojo.dom,A="unselected",D="inline-block";mstrmojo.ImageToggle=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ImageToggle",unset:null,useAnimation:true,markupString:'<div class="mstrmojo-ImageToggle {@cssClass}" style="{@cssText}" tabindex="{@tabIndex}"  mstrAttach:click,blur,keydown ></div>',tabIndex:0,markupMethods:{onimageListChange:function(){var O=this.imageList&&this.imageList.slice(),L=this,M=this.unset,K,N,J;if(!G.isEmpty(M)&&O){O.push({n:M,v:M,_ust:true});}if(this.domNode&&O){L.domNode.innerHTML="";L.domNode.style.minHeight=Math.min(20,L.height)+"px";L.domNode.style.minWidth=Math.min(20,L.width)+"px";L._loadedImgs=O.length;mstrmojo.array.forEach(O,function(Q,P){N=document.createElement("div");N.style.cssText="display:none;font-size:0px !important;line-height:"+L.height+"px !important;";J=document.createElement("img");J.alt=J.title=Q.v;J.style.verticalAlign="middle";J.style.maxHeight=L.height+"px";J.style.maxWidth=(L.width-1)+"px";if(!mstrmojo.dom.isIE){J.onerror=function(){this.src="../images/image_not_found.jpg";};}N.appendChild(J);L.domNode.appendChild(N);J.src=Q.n||"../images/image_not_found.jpg";if(Q._ust){L.ustImgIdx=P;}L._imgs[P]=N;});this._setSelectedValue();}},onvalueChange:function(){this._setSelectedValue();}},imageList:null,value:null,selectedIndex:-1,preBuildRendering:function E(){if(this._super){this._super();}this._imgs=[];},_setSelectedValue:function H(){var L=this,K=this.selectedIndex,N=this.imageList;if(N){if(N[K]){L._imgs[K].style.display="none";}F.forEach(this.imageList,function(O,P){if(O.v==L.value){C.removeClass(L.domNode,A);L.selectedIndex=P;L._imgs[P].style.display=D;return ;}});if(this.selectedIndex===-1){if(!this.unset){C.addClass(this.domNode,A);}else{var M=this._imgs[this.ustImgIdx],J=M.lastChild;J.alt=J.title=this.value;M.style.display=D;}}}},onclick:function I(){var L=this.imageList,M=L&&L.length,N=300,T=this.selectedIndex,K=T,J=this.domNode,R,Q,P,S,O=this;P=(T===-1&&this.ustImgIdx!==null)?this._imgs[this.ustImgIdx]:this._imgs[T];T=(T+1)%M;S=this._imgs[T];C.removeClass(J,A);this.selectedIndex=T;if(this.useAnimation){Q=new mstrmojo.fx.FadeIn({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:S,preStart:function(){this.target.style.display=D;}});R=new mstrmojo.fx.FadeOut({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:P,onEnd:function(){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}Q.play();}});if(P){R.play();}else{Q.play();}}else{if(P){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}}S.style.display=D;}this.value=this.imageList[T].v;},onkeydown:function(K){var J=K.hWin,L=K.e||J.event;if(L.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(J,L);this.onclick();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo._HasChildren");var F=mstrmojo.publisher;mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",init:function I(L){this._super(L);if(this.children){this.initChildren();}var M=this.parent;if(!M||M.hasInitBindings){this.initBindings();}},destroy:function G(L){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(L);},unrender:function J(N){var O=this.children,L=(O&&O.length)||0,M;for(M=L-1;M>-1;M--){O[M].unrender(true);}this._super(N);},postBuildRendering:function K(){var L=this._super?this._super():undefined;if(L!==false){this.renderChildren();L=true;}return L;},renderChildren:function C(){var N=this.children,L=(N&&N.length)||0,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render(null);}}},childRenderCheck:function H(M){if(M&&!M.hasRendered){var L=M.slot||this.defaultChildSlot;return !!this[L];}return false;},addChildren:function E(O,M,N){var L=this._super(O,M,N);if(L){this.childRenderOnAddCheck(L);}return L;},removeChildren:function A(S,O){var R=S?[S]:(this.children||[]),L=R.length,P;for(P=L-1;P>-1;P--){var N=R[P],M=N&&N.domNode;if(M){var Q=this[(N.slot||this.defaultChildSlot)];if(M.parentNode===Q){Q.removeChild(M);}}}return this._super(S,O);},childRenderOnAddCheck:function B(N){if(this.hasRendered&&N){var L=N.length,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render();}else{if(O&&O.hasRendered){this.onchildRenderingChange(O);}}}}},preserveChildDomOrder:true,onchildRenderingChange:function D(M){var T=M&&M.domNode;if(!T){return ;}var N=this.defaultChildSlot,W=M.slot||N,O=this[W],L=this.children;if(!O){if(T.parentNode){T.parentNode.removeChild(T);}}else{if(T.parentNode===O){return ;}if(!this.preserveChildDomOrder){O.appendChild(T);}else{var P,R;for(R=L.length-1;R>=0;R--){var U=L[R];if(U===M){break;}if(W===(U.slot||N)){var V=U.domNode;if(V&&V.parentNode===O){P=V;}}}if(P){O.insertBefore(T,P);}else{O.appendChild(T);}}}if(F.hasSubs(this.id,"childrenRendered")){var S=L.length,Q;for(Q=0;Q<S;Q++){if(!L[Q].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}}});}());(function(){var regExH=/"height", "[0-9.]+"/g;var regExW=/"width", "[0-9.]+"/g;var regExH1=/height="?[0-9.]+"?/g;var regExW1=/width="?[0-9.]+"?/g;mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._IsSelectorTarget");mstrmojo.DocVisualization=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocVisualization",markupString:'<div id={@id} class="mstrmojo-docvisualization" title="{@tooltip}" style="{@domNodeCssText}">{@htmlText}</div>',formatHandlers:{domNode:["RW","T","B","fx"]},update:function update(node){if(this._super){this._super(node);}var d=node.data;this.htmlText=d.htmlText;this.jsText=d.jsText;this.selData=d.selData;this.ctrLink=d.ctrLink;this.vp=d.vp;this.eg=d.eg;if(this.eg){this.htmlText=this.eg;}},preBuildRendering:function(){if(this._super){this._super();}var fmts=this.getFormats();if(!fmts){return ;}var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(this.jsText){this.jsText=this.jsText.replace(regExH,'"height", "'+h+'"').replace(regExW,'"width", "'+w+'"');}},postBuildRendering:function pstBldRnd(){if(this._super){this._super();}eval(this.jsText);},resize:function(){if(this.eg){return ;}var embedNode=this.domNode.firstChild.firstChild.firstChild;if(!embedNode){return ;}var fmts=this.getFormats();var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(mstrmojo.dom.isIE){embedNode.firstChild.setAttribute("height",h);embedNode.firstChild.setAttribute("width",w);}else{embedNode.innerHTML=embedNode.innerHTML.replace(regExH1,'height="'+h+'"').replace(regExW1,'width="'+w+'"');}},makeSelections:function(selections){var shuffledData={},i,j,attId,e;for(i=0;i<selections.length;i++){var attIdI=selections[i].attId;if(!shuffledData[attIdI]){shuffledData[attIdI]=[];}shuffledData[attIdI]=shuffledData[attIdI].concat(selections[i].values);}var sep="\u001E",sep1="\u001F";var ckJoined="",eidJoined="",cklJoined="";var tksArray=[];for(attId in shuffledData){var sd=this.getSelectionData(attId);if(!sd){continue;}var ctrLink=this.ctrLink[attId];var values=shuffledData[attId];if(sd&&values&&values.length>0){sd.sel=values;sd.ias=false;for(e in values){if(e==="u;"){sd.ias=true;break;}}}if(ctrLink.gbTargets){var t=ctrLink.targets=[],gbt=ctrLink.gbTargets,cgbmap=this.model.getCGBMap();for(j=0;j<gbt.length;j++){var targetKey=cgbmap[gbt[j]];if(targetKey){t.push(targetKey);}}delete ctrLink.gbTargets;}ckJoined+=ctrLink.ctxt+sep1;eidJoined+=values.join(sep)+sep1;cklJoined+=ctrLink.ck+sep1;tksArray=tksArray.concat(ctrLink.targets);}ckJoined=ckJoined.substring(0,ckJoined.length-1);eidJoined=eidJoined.substring(0,eidJoined.length-1);cklJoined=cklJoined.substring(0,cklJoined.length-1);if(tksArray.length==0){return ;}var evt={ck:ckJoined,eid:eidJoined,src:this.k,tks:tksArray.join(sep),type:this.defn.t,ctlKey:cklJoined,include:true,isDocVis:true};this.model.slice(evt);},getAllSelectionData:function(){return this.selData;},getSelectionData:function(attId){var selData=this.selData,k;if(selData&&selData.attl){var attl=selData.attl;if(attId){return attl[attId];}else{for(k in attl){return attl[k];}}}},saveVisProps:function(widgetPropsXml){var props={};props[this.k]={FormattingWidget:"WidgetProps\u001F"+widgetPropsXml};mstrApp.docModel.saveRWProps(this.k,props,1,false,{success:function(){}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",text:null,markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" mstrAttach:click></div>',cssDisplay:"block",markupMethods:{ontextChange:function(){this.domNode.innerHTML=(this.text!=null)?this.text:"";},oncssTextChange:function(){this.domNode.style.cssText=(this.cssText!=null)?this.cssText:"";},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},autoHide:false,_set_text:function A(D,B){if(this.autoHide){this.set("visible",(B!=null)&&(B!==""));}var C=this.text;this.text=B;return C!=B;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocHTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocHTMLContainer",scrolling:"auto",markupString:'<iframe id="{@id}" class="mstrmojo-DocHTMLContainer" title="{@tooltip}" style="{@domNodeCssText}" src="{@v}" scrolling="{@scrolling}"></iframe>',formatHandlers:{domNode:["RW","B","F","background-color","text-align","white-space","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function A(B){this.v=B.data.v;if(mstrApp&&mstrApp.isTouchApp()){this.scrolling="no";}if(this.thresholdId||B.data.tid){delete this.fmts;}this.thresholdId=B.data.tid;this.set("visible",!B.data.hidden);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget");mstrmojo.StickySections=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.StickySections",markupString:'<div id="{@id}" style="{@cssText};overflow:hidden"><div class="mstrmojo-StickySections {@cssClass}">{@currentSectionTitle}</div></div>',oncurrentSectionTitleChange:function B(C){this.domNode.lastChild.innerHTML=this.currentSectionTitle;},onMove:function A(G){var F=0;if(G.isNextRowNewSection){var C=G.position,D=G.rowStart,E=(D>C)?(this.domNode.offsetHeight+1):0;F=(D-C)-E;}mstrmojo.dom.translate(this.domNode.lastChild,0,F,0,"",true);if(G.sectionName&&G.sectionName!==this.currentSectionTitle){this.set("currentSectionTitle",G.sectionName);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Widget");var C=mstrmojo.css;mstrmojo.VisTooltip=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.VisTooltip",cssClass:"vis-tooltip",markupString:'<div class="{@cssClass}"><div class="vis-tooltip-container"><table class="vis-tooltip-table"></table></div></div>',markupSlots:{domContainer:function(){return this.domNode.firstChild;},domTable:function(){return this.domNode.firstChild.firstChild;}},toggle:function A(F){if(F){this.domNode.style.display="block";}else{this.domNode.style.display="none";}},displayInfo:function E(I,P){var K,F,U,L,O,J,H,G,R=document,T=this.domTable;T.innerHTML="";F=I.length;for(K=0;K<F;K++){U=I[K];L=R.createElement("tbody");O=R.createElement("tr");J=R.createElement("td");H=R.createElement("td");G=R.createElement("td");J.setAttribute("class","vis-tooltip-name");H.setAttribute("class","vis-tooltip-space");G.setAttribute("class","vis-tooltip-value");if(U===null){O.setAttribute("class","vis-tooltip-tr separator");}else{O.setAttribute("class","vis-tooltip-tr");J.innerHTML=U.n+":";G.innerHTML=U.v;}O.appendChild(J);O.appendChild(H);O.appendChild(G);L.appendChild(O);this.domTable.appendChild(L);}if(P){var N=mstrmojo.dom.position(R.body),Q=this.domNode.offsetWidth,M=this.domNode.offsetHeight,V=P.x+Q-N.x-N.w,S=P.y+M-N.y-N.h;if(V>0){P.x-=V;}if(S>0){P.y-=S;}this.domNode.style.left=P.x+"px";this.domNode.style.top=P.y+"px";}},doLayout:function D(F){var J=this.domTable,L=C.getComputedStyle(this.domNode),H=J.firstChild.firstChild.childNodes,K=J.getElementsByClassName("vis-tooltip-value"),G;var I=F-parseInt(L.paddingLeft)-parseInt(L.paddingRight);I-=H[0].offsetWidth;I-=10;for(G=0;G<K.length;G++){K[G].style.maxWidth=I+"px";}},posTo:function B(F){this.domNode.style.left=F.x+"px";this.domNode.style.top=F.y+"px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._TouchGestures");mstrmojo.android.ui.Label=mstrmojo.declare(mstrmojo.Label,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Label",touchTap:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasTouchScroller","mstrmojo._TouchGestures");mstrmojo.android.TextArea=mstrmojo.declare(mstrmojo.Label,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.TextArea",markupString:'<div id="{@id}" class="mstrmojo-TextArea {@cssClass}" style="{@cssText}"><div>{@text}</div></div>',markupMethods:{ontextChange:function(){this.domNode.firstChild.innerHTML=this.text||"";},oncssTextChange:function(){this.domNode.style.cssText=this.cssText||"";},onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onheightChange:function(){this.domNode.style.height=this.height||"auto";}},allowTouchBubble:false,updateScrollerConfig:function A(){var B=this._super(),E=this.domNode,F=E.firstChild,D=parseInt(this.height,10);if(isNaN(D)){D=E.clientHeight;}B.bounces=false;B.scrollEl=F;B.origin=B.origin||{x:0,y:0};var G=Math.max(F.offsetHeight-D,0);var C=B.vScroll=(G!==0);if(C){B.offset={y:{start:0,end:G}};}return B;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.array");var I=mstrmojo.array,J={containerNode:"100%",node1:"100%",node2:"100%"};mstrmojo.android.ui.ViewSwitcher=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.ViewSwitcher",markupString:'<div id="{@id}" class="mstrmojo-AndroidSwitcher {@cssClass}" style="{@cssText}"><div class="switch-slider"><div class="switch-page"></div><div class="switch-page"></div></div><div class="overlay"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},sliderNode:function(){return this.domNode.firstChild;},node1:function(){return this.domNode.firstChild.firstChild;},node2:function(){return this.domNode.firstChild.lastChild;},overlayNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:J,w:J},getSlots:function E(){var M=this._curSlot||"node1",N=(M==="node1")?"node2":"node1";return{current:this[M],next:this[N],slot:N};},addChildren:function L(O,M,N){I.forEach(O,function(P){if(P.slot==="overlayNode"){P.ignoreLayout=true;}});this._super(O,M,N);},prepareNewView:function H(M,N){M.height=this.height;M.width=this.width;M.visible=true;M.slot=N;},switchView:function D(M,O){var Q=this.getCurrentView();if(M===Q){return ;}var P=this.getSlots(),N=this.getViewController(M),R=this.getViewController(Q);if(Q){if(R&&R.beforeViewHidden){R.beforeViewHidden(O);}}this.prepareNewView(M,P.slot);if(N&&N.beforeViewVisible){N.beforeViewVisible(O);}this.addChildren([M]);if(Q){this.removeChildren(Q);Q.unrender();if(R&&R.afterViewHidden){R.afterViewHidden(O);}}if(N&&N.afterViewVisible){N.afterViewVisible(O);}this.stackViews(P.slot);this.afterSwitch(M);},replaceView:function B(N,O,P){var M=I.indexOf(this.children,O);if(M===-1){return ;}var Q=O.slot;I.forEach([N,O],function(R){if(R.parent===this){this.removeChildren(R,true);R.unrender();if(!P){R.destroy();}}},this);this.prepareNewView(N,Q);this.addChildren([N]);return N;},stackViews:function C(M){I.forEach([1,2],function(N){var O="node"+N,P=this["node"+N];if(P){P.style.zIndex=(O===M)?3:1;}},this);},getCurrentView:function G(){var N=this._curSlot||"node2",M;I.forEach(this.children,function(O){if(O.slot===N){M=O;return false;}});return M;},getViewController:function K(M){return M?M.controller||M:null;},afterSwitch:function F(M){this._curSlot=M.slot;},doLayout:function A(){var N=this.node1.style,M=this.node2.style;N.height=M.height=this.height;N.width=M.width=this.width;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Container","mstrmojo._Formattable","mstrmojo.EnumRWUnitType");var HTML_CONTAINER=mstrmojo.EnumRWUnitType.HTMLCONTAINER;mstrmojo.DocTextfield=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocTextfield",markupString:'<div id="{@id}" class="mstrmojo-DocTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@v}</div>{@buttonNodeMarkup}</div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","P","background-color","fx","text-align","white-space","overflow"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function update(node){var d=node.data,v=d.v||"";if(node.defn.t===HTML_CONTAINER){var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value;div=null;}this.v=v;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.set("visible",!node.data.hidden);if(this._super){this._super(node);}},postBuildRendering:function postBuildRendering(){var $D=mstrmojo.dom,f=this.getFormats(),rotateValue=f.fx&&f.fx.rt,i,len;if(rotateValue&&!$D.isIE&&$D.supports($D.cssFeatures.TEXT_ROTATION)){var dn=this.domNode;switch(rotateValue){case 1:dn.style.left=(parseInt(f.left,10)+dn.offsetHeight)+"px";break;case 3:dn.style.top=(parseInt(f.top,10)+dn.offsetWidth)+"px";break;}}if(this.defn.t===HTML_CONTAINER){var scripts=this.domNode.getElementsByTagName("script");for(i=0,len=scripts.length;i<len;i++){eval(scripts[i].innerHTML);}}return this._super();},getAnchor:function getAnchor(){return this.valueNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K[I].slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.css");var A=mstrmojo.boxmodel,J=mstrmojo.dom,G=20;function F(M,K){var L=M&&M.parent;while(L){if(L.connectScrollbox){L.connectScrollbox(K);}L=L.parent;}}function I(M,K){var L=M&&M.parent;while(L){if(L.disconnectScrollbox){L.disconnectScrollbox(K);}L=L.parent;}}var D=function(V){if(V.visible){var M=V.refNode,S=M?A.offset(M,document.body):{left:J.getHorizontalScroll(),top:J.getVerticalScroll()},Y=V.domNode.style,U=V.containerNode,O=V.left,X=V.top,L=V.posType,R=mstrmojo.tooltip,Q=(L===R.POS_TOPRIGHT)||(L===R.POS_BOTTOMRIGHT),K=(L===R.POS_BOTTOMLEFT)||(L===R.POS_BOTTOMRIGHT)||(L===R.POS_BOTTOMCENTER),N=S.left,P=S.top,W=U.offsetWidth;if(O!==null){Y.left=Math.max(parseInt(O,10)+N-(Q?(W):((L===R.POS_BOTTOMCENTER)?(W/2):0)),0)+"px";}if(X!==null){Y.top=Math.max(parseInt(X,10)+P-((K)?(U.offsetHeight):0),0)+"px";}}};var C=function(K){K.containerNode.className=("mstrmojo-Tooltip-content "+K.contentNodeCssClass);K.containerNode.style.cssText=K.contentNodeCssText;K.containerNode.innerHTML=K.content;if(!K.content){K.set("_tempVis",false);}else{K.set("_tempVis",true);}D(K);if(K.optimizePos){K.optimizePos();}};function B(K){if(!K._dp){K._dp=window.setTimeout(function(){K._dp=null;C(K);},50);}}var H=function(Q,R,O,N){var K=R&&(R.richTooltip||R.tooltip),L=O?J.getMousePosition(O,N||self):null,P=K&&(typeof (K)==="string"),M=P?null:(K&&K.left||0),S=P?null:(K&&K.top||0);Q.set("contentNodeCssClass",P?"":(K&&K.contentNodeCssClass||""));Q.set("contentNodeCssText",P?"":(K&&K.contentNodeCssText||""));Q.set("content",(P)?K:(K&&K.content||""));Q.set("refNode",P?null:K&&K.refNode||null);Q.set("posType",P?1:K&&K.posType||1);Q.set("left",(P||M===undefined||M===null)?(L&&L.x||Q.left):M);Q.set("top",(P||K===undefined||K===null)?(L&&(L.y+G)||Q.top):S);};mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,posType:1,markupString:'<div id="{@id}" class="mstrmojo-Tooltip {@cssClass}" style="{@cssText}"><div class="mstrmojo-Tooltip-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Tooltip-content {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){if(this.visible){var K=this.domNode.style;K.visibility="hidden";K.display="block";D(this);K.visibility=this.content?"visible":"hidden";}else{this.domNode.style.display="none";}},on_tempVisChange:function(){this.domNode.style.visibility=this._tempVis?"visible":"hidden";},onleftChange:function(){B(this);},ontopChange:function(){B(this);},onrefNodeChange:function(){B(this);},onposTypeChange:function(){B(this);},oncontentNodeCssClassChange:function(){B(this);},oncontentNodeCssTextChange:function(){B(this);},oncontentChange:function(){B(this);}},preBuildRendering:function(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}if(this._super){this._super();}},_on_tooltip_change:function(K){H(this,K&&K.src);},_set_opener:function(M,K){var L=this.opener;if((K!==L)){if(K){F(K,this);}if(L){I(L,this);}if(L&&L.detachEventListener){L.detachEventListener(this._richSubs);L.detachEventListener(this._ttpSubs);}if(K&&K.attachEventListener){this._richSubs=K.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=K.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=K;return true;}return false;},updatePopupConfig:function(K,L){H(this,L,K&&K.e,K&&K.win);},onscroll:function(){if(this.visible&&this.nudge){this.nudge();}}});var E=null;mstrmojo.tooltip={POS_TOPLEFT:1,POS_BOTTOMLEFT:2,POS_TOPRIGHT:3,POS_BOTTOMRIGHT:4,POS_BOTTOMCENTER:5,open:function(L,N,M,K){if(!E||!mstrmojo.all[E.id]){E=new mstrmojo.Tooltip();}if(!K){K={};}K.e=N;K.win=M;E.open(L,K);},close:function(){if(E){E.close();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable");mstrmojo.DocImage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocImage",markupString:'<div id="{@id}" class="mstrmojo-DocImage" title="{@tooltip}" style="{@domNodeCssText}"><div style="{@shadowNodeCssText}"><img src="{@v}" style="{@imgNodeCssText}" mstrAttach:click></div>{@buttonNodeMarkup}</div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function C(E){var F=this.model.getDataService(),D=E.data.v;this.v=(F&&F.getDocImage&&F.getDocImage(D))||D;if(this.thresholdId||E.data.tid){delete this.fmts;}this.thresholdId=E.data.tid;this.set("visible",!E.data.hidden);if(this._super){this._super(E);}},formatHandlers:{domNode:["left","top","z-index"],shadowNode:["width","height","B","fx"],imgNode:["height","width"]},preBuildRendering:function B(){if(this._super){this._super();}if(!mstrmojo.dom.isIE7){var D=this.getFormats(),F=(D.fx&&D.fx.ds)||0,E=mstrmojo._Formattable.getBorderWidths(this);this.domNodeCssText+="width:"+((parseInt(D.width,10)||0)+F+E.w)+"px; height: "+((parseInt(D.height,10)||0)+F+E.h)+"px;";}},getAnchor:function A(){return this.imgNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo._HasLayout","mstrmojo._ShowsStatus");function E(J){var I=this.domNode,H=parseInt(this[J.toLowerCase()],10);return(isNaN(H))?I["offset"+J]:H;}mstrmojo.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasScrollbox,mstrmojo._HasLayout,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-DocLayoutViewer {@cssClass}" style="{@domNodeCssText}"><div></div><div><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_fh"></div><div id="{@id}_scrollboxNode" class="mstrmojo-DocLayoutViewer-layout" style="{@_scrollCssText}"></div><div id="{@id}_ff"></div></div><div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}}},markupSlots:{groupBy:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.childNodes[1].childNodes[2];},scrollboxNode:function(){return this.domNode.childNodes[1].childNodes[2];},containerNode:function(){return this.domNode.childNodes[1].childNodes[2];},incFetchNode:function(){return this.domNode.lastChild;},fixedHeaderNode:function(){return this.domNode.childNodes[1].childNodes[1];},fixedFooterNode:function(){return this.domNode.childNodes[1].childNodes[3];},_STATUS:function(){return this.domNode.childNodes[1].firstChild;},_STATUS_TXT:function(){return this.domNode.childNodes[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;}},layoutConfig:{h:{groupBy:"auto",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"auto"},w:{layout:"100%"}},scrollboxHeightFixed:true,scrollboxWidthFixed:true,getHeight:function G(){return E.call(this,"Height");},getWidth:function B(){return E.call(this,"Width");},afterLayout:function A(){this._super();this.notifyScrollListeners();},preBuildRendering:function D(){if(this.parent){var J=this.parent[this.slot].style,I=this.height,H=this.width;this.height=(I!=="auto")?I:J.height;this.width=(H!=="auto")?H:J.width;}this.zf=this.model.zf;this.bs=this.model.bs;return this._super?this._super():true;},setSlotDimensions:function F(J,I,H){if(J==="layout"){this.scrollboxHeight=parseInt(I,10);this.scrollboxWidth=parseInt(H,10);}this._super(J,I,H);},onaddChild:function C(H){if(!isNaN(H.index)){var I=this.children[H.index];if(I&&I.slot==="groupBy"){this.docGroupBy=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}" ><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},buildRendering:function A(){var C=this.placeholder;if(this._super()){if(!this.parent&&!C){var B=this.placeNode||document.body;B.appendChild(this.domNode);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.ListBase","mstrmojo.android._IsList","mstrmojo.android._IsIncFetchList","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller");var H=mstrmojo.array,J=mstrmojo.hash.copy,G=mstrmojo.TouchScroller.EnumIncFetchEdges,D=G.start,C=50,F=20,B=false;function L(Q,M){if(this.end===null||isNaN(this.end)||this.start===null||isNaN(this.start)){this.ifDirection="h";this.supportedEdges=0;H.forEach(["start","end"],function(R){this.supportedEdges+=isNaN(this[R])?G[R]:0;},this);var P=this,N;this.ifDataHelper=new mstrmojo.Obj({totalSize:-1,next:function O(U,T){var S=[],R=-1;S=S.concat(P.items);if(T===D){for(N=0;N<C;N++){S.splice(0,0,{n:--Q});}S=S.splice(0,C+F);M=Q+C+F-1;R=C;}else{for(N=0;N<C;N++){S.push({n:++M});}S=S.splice(S.length-C-F);Q=M-C-F;R=F-3;}P.set("items",S);window.setTimeout(function(){B=true;P.singleSelect(R);},0);U.success({items:undefined});}});}}mstrmojo.android.ui.CalendarYearList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo.android._IsIncFetchList],{scriptClass:"mstrmojo.android.ui.CalendarYearList",years:undefined,scrollerConfig:{bounces:false,showScrollbars:false,scrollPast:true},getItemMarkup:function(N,M){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}"><span>{@n}</span><div class="marker"></div></{@tag}>';},postCreate:function K(O){if(this._super){this._super();}var Q=(this.start)||(new Date(0)).getFullYear(),M=(this.end)||((new Date()).getFullYear()+5),P=Q,N=this.items=this.items||[];while(M>=P){N.push({n:P++});}L.call(this,Q,M);},postBuildRendering:function A(){this._super();var M=this.ITEMS_NODE_WIDTH=this.itemsNode.clientWidth;this.updateScroller();this.singleSelectByField(this.initialYear,"n");this._scroller.attachEventListener("scrollDone",this.id,function(N){var Q=(N.x+(parseInt(this.width,10)-M)/2)/M,P=Math.floor(Q),O=P;O+=((Q-P)>0.3)?1:0;if(O!==this.selectedIndex){this.singleSelect(O);}else{this.onchange();}});},onchange:function(){var M=this.selectedIndex;if(M>=0){var O=this.ITEMS_NODE_WIDTH,N=(M*O)-(parseInt(this.width,10)-O)/2;this._scroller.scrollTo(N,undefined,B?0:200);this.raiseEvent({name:"yearChanged",value:this.selectedItem.n});B=false;}},updateScrollerConfig:function E(){var N=this._super(),P=this.itemsContainerNode,M=parseInt(this.width,10);if(isNaN(M)){M=this.domNode.clientWidth;}N.scrollEl=P;N.noVScroll=true;N.origin=N.origin||{x:0,y:0};var Q=Math.max(P.clientWidth-M,0),O=N.hScroll=(Q!==0);if(O){N.offset={x:J({start:0,end:Q},N.offset&&N.offset.x)};}else{N.offset=undefined;}return N;},destroy:function I(){if(this.ifDataHelper){this.ifDataHelper.destroy();delete this.ifDataHelper;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.requiresDescs(9936,9937);var B=25,D=mstrmojo.desc;mstrmojo.android.ui.NoProjectsView=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.android.ui.NoProjectsView",markupString:'<div id="{@id}" class="mstrmojo-NoProjectsView"><div><div class="mstrmojo-NoProjectsViewImage"></div><div class="mstrmojo-NoProjectsViewMsg1">{@msg1}</div><div class="mstrmojo-NoProjectsViewMsg2">{@msg2}</div></div></div>',markupSlots:{wrapperNode:function(){return this.domNode.firstChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},preBuildRendering:function A(){this.msg1=D(9936,"No projects have been configured.");this.msg2=D(9937,"Contact your administrator");},postBuildRendering:function C(){this._super();var E=this.wrapperNode;E.style.marginTop=(-(E.clientHeight/2)-B)+"px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren","mstrmojo._CanRenderDocOnScroll","mstrmojo.dom");mstrmojo.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren,mstrmojo._CanRenderDocOnScroll],{scriptClass:"mstrmojo.DocLayout",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},popupNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["B","background-color","D","min-height","width"]},alias:"docLayout",markupMethods:{onminHeightChange:function(){var N=this.minHeight;if(!N){var M=this.getFormats();N=M&&M["min-height"];}if(N){this.containerNode.style[mstrmojo.css.MINHEIGHT]=N;}}},getHeight:function E(){var M=0;mstrmojo.array.forEach(this.children,function(N){M+=N.height();});return M||this.containerNode.offsetHeight;},getWidth:function I(){var M=this.children;return(M&&M.length)?M[0].width():this.containerNode.offsetWidth;},preBuildRendering:function K(){var M=this.getFormats();if(M&&M["min-width"]!==undefined){M.width=M["min-width"];}this._super();},renderChildren:function L(){this._super();this.resizeOrReposition();},resizeOrReposition:function D(){var O=this.containerNode;if(!!this.defn.aw){var U=this.model.getAutoWidthIDs(),S=(U&&U.length)||0,Y=0,X=mstrmojo.all,P;if(!S){return ;}for(P=0;P<S;P++){Y=Math.max(this._getWidgetRightMostPosition(X[U[P]]),Y);}Y=Math.max(this.getLayoutMinWidth(),Y);if(Y>parseInt(this.getFormats().width,10)){O.style.width=Y+"px";}}var W=this.model.zt;if(mstrApp.isMobile&&W){var M=this.parent.domNode;if(M){var Q=this.model.controller,N=!!Q.orientation,Z=0,V=this.parent,R=V.getHeight()-V.fixedHeaderNode.clientHeight-V.fixedFooterNode.clientHeight;if(W===2){if(!Q.toolBarDelegated){R-=Q.getBottomToolBarHeight();}Z=Math.round(N?Math.max((R-this.getHeight()),0)/2:0)+"px";}O.style.margin=Z+" auto";var T=this;window.setTimeout(function(){Q.nudgeWidget(T.id,{left:O.offsetLeft,top:O.offsetTop});},0);}}},getLayoutMinWidth:function F(){return 0;},_getWidgetRightMostPosition:function F(M){return parseInt(M.getFormats().left,10)+(M.getDim&&M.getDim().w||M.domNode.offsetWidth);},renderCtrlsInViewport:function C(){this._super();this.resizeOrReposition();},adjustAutoWidth:function H(M){if(!this.defn.aw||!M){return ;}var O=this.containerNode.style,N=parseInt(O.width,10)||0;var P=this;window.setTimeout(function(){var Q=P._getWidgetRightMostPosition(M);if(Q>N){O.width=Q+"px";}},1);},_getModelChildNodes:function B(P,O,S,N,R){var Q=this.model.getNonFixedSections(P,O);var M=Q.length;N=isNaN(N)?M:N;S=S||0;if(S>0||N<M){Q=Q.slice(S,S+N);}return R?{nodes:Q,total:M}:Q;},getChildren:function G(O,N,Q,M,P){return this._getModelChildNodes(O||this.node,N||false,Q,M,P);},getCaptureDimensions:function J(){var N=this.domNode,M={};if(!this.domNode){return ;}M=mstrmojo.dom.position(N);M.w=Math.min(N.offsetWidth,M.w);M.h=Math.min(N.offsetHeight,M.h);return M;},preserveChildDomOrder:false,postBuildRendering:function A(){if(window.mstrMobileApp!==undefined){this.defn.lastOrientation=mstrMobileApp.getOrientation();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._IsPanelStack","mstrmojo._IsSelectorTarget","mstrmojo._HasBuilder","mstrmojo._HasTouchScroller","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo.css");var T=mstrmojo.css,E=mstrmojo.dom,K=Math,A=700;function G(){var U=this._animHandle;if(U){window.clearTimeout(U);delete this._animHandle;}}function D(){delete this._animHandle;this._isAnimating=false;}function J(Z,Y,X,W){var V=this._translateX;if(X||Y!==V){this._translateX=Y;G.call(this);if(Z){this._isAnimating=true;}var U=this.containerNode.style;U[E.CSS3_TRANSITION_DURATION]=Z+"ms";U[E.CSS3_TRANSFORM]=E.createTranslateString(-Y);if(W){var a=this.id;this._animHandle=window.setTimeout(function(){var b=mstrmojo.all[a];if(mstrmojo.all[a]._isAnimating){D.call(b);}},Z*3);}if(this._scroller){this._scroller.raiseEvent({name:"transformAnim",x:Y,y:0});}}}function C(){if(!this.defn.dk){return ;}var b=this.children,Z=0,U=b.length,Y=this.selectedIdx,a=[];for(Z=0;Z<U;Z++){a.push('<div idx="'+Z+'" class="');if(Z===Y){a.push("on");}a.push('"><div></div></div>');}var W=this.selectorBtns,V=mstrMobileApp.getDeviceDPI();var X={160:26,213:26,240:38,320:57},d=X[V]||(X[160]*V/160);W.style.width=(U*d)+"px";W.innerHTML=a.join("");this.selector.style.display="block";}mstrmojo.android.DocPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._HasBuilder,mstrmojo._HasTouchScroller,mstrmojo._IsPanelStack,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.DocPanelStack",btnMarkup:"",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocPanelStack {@cssClass}" style="{@domNodeCssText}"><div></div><div class="mstrmojo-PanelSelector"><div class="mstrmojo-SelectorBtns"></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},selector:function(){return this.domNode.lastChild;},selectorBtns:function(){return this.domNode.lastChild.firstChild;}},formatHandlers:{domNode:["RW","B"]},scrollerConfig:{bounces:false,showScrollbars:false,vScroll:false,hScroll:true},addChildren:function I(b,g,d){this._super(b,g,d);var a=this.containerNode.style,f=this.getFormats(),V=this._pnlWidth=parseInt(f.width,10),h=parseInt(f.height,10),Y=this.selectedIdx;var X=this.selectedIdx*V;a.width=(V*b.length)+"px";if(!E.isWinPhone){J.call(this,0,X);}else{a.msTransform=X;}var Z=0,W=b.length;for(Z=0;Z<W;Z++){var U=b[Z];U.visible=true;U.selected=(Z===Y);U.updatePanelDimensions(Z*V,h,V);}C.call(this);this.updateScroller();return true;},postBuildRendering:function R(){this._super();C.call(this);var U=this.id;mstrmojo.dom.attachEvent(this.containerNode,E.CSS3_TRANSITION_END,function(V){var W=mstrmojo.all[U];if(V.target!==W.containerNode){return true;}G.call(W);V.stopPropagation();D.call(W);return false;});return true;},setInfoWindowDimensions:function S(Z){var a=this.parent;if(a.scriptClass==="mstrmojo.DocPortlet"){a.setInfoWindowDimensions(Z);}var W=Z.h,f=Z.w,U=this.domNode.style,Y=this.children,X=Y.length,b="px",V;U.height=W+b;U.width=f+b;this.containerNode.style.width=(f*X)+b;this._pnlWidth=f;this._translateX=(this.selectedIdx||0)*f;for(V=0;V<X;V++){Y[V].updatePanelDimensions(V*f,W,f,true);}this.updateScroller();},getTitle:function H(){return this.title;},initScroller:function M(U){U.attachEventListener("scrollDone",this.id,function(V){this._translateX=V.x;});},updateScrollerConfig:function Q(){var W=this.children,Y=W&&W.length,V=this._super();V.noVScroll=true;if(Y){var U=this._translateX||0,X=this._pnlWidth,Z;Z={start:K.max(U-X,0),end:K.min(U+X,Y*X-X)};mstrmojo.hash.copy({scrollEl:this.containerNode,offset:{x:Z,scrollPast:false},origin:{x:U,y:0}},V);}return V;},onselectedIdxChange:function B(V){var U=this.selectorBtns,W=U&&U.childNodes;if(W){T.addClass(W[V.value],"on");T.removeClass(W[V.valueWas],"on");}},onselectedKeyChange:function F(W){this._super(W);var X=this._pnlWidth,V=this.selectedIdx*X;if(E.isWinPhone){var U=this.containerNode;U.style.position="relative";(new mstrmojo.fx.AnimateProp({props:{left:{isStyle:true,start:V,stop:this.prevSelectIdx*X,suffix:"px",ease:mstrmojo.ease.linear}},duration:0,target:U})).play();}else{J.call(this,0,V);}this.updateScroller(true);},touchBegin:function N(U){if(this._isAnimating){U.stop();return false;}if(!this.defn.sw&&!E.contains(this.selector,U.target,true,this.domNode)){return false;}return this._super(U);},touchTap:function P(a){var Y=a.target,V=this.domNode;if(E.contains(this.selector,Y,true,V)){var Z=this.selectorBtns,W=-1;if(E.contains(Z,Y,true,V)){W=E.findAncestorByAttr(Y,"idx",true,Z).value;}else{W=this.selectedIdx+((a.clientX-V.offsetLeft<(this._pnlWidth/2))?-1:1);}if(W>-1){var U=this.children[W];if(U){this.selectPanel(U.k);}}}else{var X=this.controller;if(X&&X.viewTap){X.viewTap();}}},touchSwipeBegin:function L(U){if(this.defn.sw||E.contains(this.selector,U.target,true,this.domNode)){return this._super(U);}return this.bubbleTouchEvent(U);},touchSwipeEnd:function O(X){X.evt.handled=true;mstrmojo.TouchScroller.ScrollIndicators.hideAll();var a=this._translateX||0,U=this._pnlWidth,W=this._scroller.offset.x,Y=K.max(K.min(a-X.delta.x,W.end),W.start),d=a-Y,Z=K.abs(d),V=A,b=(Z<U*0.2);if(b){Y=a;V*=Z/U;}else{Y=a+((d<0)?U:-U);V*=(U-Z)/U;}J.call(this,K.round(V),Y,true,b);this.selectPanel(this.children[Y/U].k,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._CanGrowOrShrink","mstrmojo.boxmodel");mstrmojo.DocSubsection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._CanGrowOrShrink],{scriptClass:"mstrmojo.DocSubsection",markupString:'<div id="{@id}" class="mstrmojo-DocSubsection" style="{@domNodeCssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},formatHandlers:{domNode:["D","B","background-color","fx"]},update:function G(H){if(this.thresholdId||H.data.tid){delete this.fmts;}this.thresholdId=H.data.tid;if(this._super){this._super(H);}},postBuildRendering:function E(){var L=this.defn;if(L.hc||L.vc){var H=this.domNode,K=this.getFormats(),M=this.id,J=K.height,I=K.width;L.attachEventListener("resized",M,function(){if("height" in K){H.style.height=K.height;}if("width" in K){H.style.width=K.width;}});L.attachEventListener("adjustSize",M,function(P){var O=H.style,N=O.height;if(L.hc&&O.width!==I){O.width=I;}if(L.vc&&O.height!==J){O.height=J;}this.performCanGrowCanShrink(this.children);P.heightReduced=(parseInt(N,10)>parseInt(O.height,10));});}return(this.renderMode!=="scroll")?this._super():true;},childRenderOnAddCheck:function C(H){return(this.renderMode!=="scroll")?this._super(H):false;},onchildRenderingChange:function B(J){this._super(J);if(this.renderMode!=="scroll"){var H=this.parent.slot,I=H==="fixedHeaderNode"||H==="fixedFooterNode";this.performCanGrowCanShrink([(J&&J.src)||J],I);}},portalMaximized:function D(){var K=this.defn,L=K.vc,I=K.hc;if(!I&&!L){return{};}delete K.vc;delete K.hc;delete K.ck;var J=this.getFormats(),H=this.model,P=this.domNode,M=this;var N={HideIfEmpty:-1};var O=function(T,R,S){var U=T.toLowerCase(),Q=parseInt(P.style[U],10);R=((R===undefined)?Q:Math.max(parseInt(R,10),Q))+"px";if(J[U]!==R){J[U]=R;N[T]=mstrmojo.boxmodel.px2Inches(H,R);delete M["_fixed"+T];}S=S||"";N["Max"+T]=0;N["CanGrow"+S]=0;N["CanShrink"+S]=0;};if(L){O("Height",J.normHeight);}if(I){O("Width",J.normWidth,"Horizontal");}K.raiseEvent({name:"resized"});return N;},adjustSectionSize:function A(){var H=this.defn;if(H.vc||H.hc){return H.raiseEvent({name:"adjustSize"});}return null;},refresh:function F(){if(!this.hasRendered){return ;}var I=this.children||[];for(var H=I.length-1;H>=0;H--){I[H].refresh&&I[H].refresh();}},preserveChildDomOrder:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.css;function I(R){var Q=R.inputNode;var P=(R.value!=null)?String(R.value):"";if(P!==Q.value){Q.value=P;}if(Q.mstrmojoEmpty){C.removeClass(Q,[R.emptyClass]);Q.mstrmojoEmpty=null;}}function E(Q){var P=Q.inputNode;P.value=Q.emptyText||"";C.addClass(P,[Q.emptyClass]);P.mstrmojoEmpty=true;}function G(Q){var P=Q.inputNode;if(P){Q.readingDom=true;Q.set("value",P.value);Q.readingDom=false;}}var M={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",autoComplete:true,autoCorrect:true,autoCapitalize:true,placeholderText:"",markupString:'<input id="{@id}" placeholder="{@placeholderText}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css.toggleClass(this.inputNode,"disabled",!this.enabled);},onvalueChange:function(){var P=this.value,Q=(P===null)||(P==="");if(Q){if(!this.hasFocus){E(this);}else{this.inputNode.value="";}}else{I(this);}},ontooltipChange:function(){this.domNode.title=this.tooltip;},onreadOnlyChange:function(){this.inputNode.readOnly=this.readOnly;}},emptyText:"",emptyClass:"mstrmojo-empty",postBuildRendering:function B(){this._super();var P=this.inputNode;P.setAttribute("autocomplete",this.autoComplete?"on":"off");P.setAttribute("autocorrect",this.autoCorrect?"on":"off");P.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function O(){this.inputNode.focus();},prefocus:function J(){this.hasFocus=true;I(this);},preblur:function D(){window.setTimeout(function(){},200);this.hasFocus=false;G(this);var P=this.value;if((P===null||P==="")&&this.emptyText){E(this);}},prekeyup:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);var S=M[R.keyCode];if(this["on"+S]){this["on"+S](Q);}},preinput:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);},prepaste:function N(){this.delaySetValue(this);},precut:function L(){this.delaySetValue(this);},delaySetValue:function K(P){window.setTimeout(function(){G(P);},100);},setInvalidState:function H(P){mstrmojo.css.addClass(this.inputNode,["err"]);if(P){this.domNode.setAttribute("title",P);}},cleanUp:function F(){this.inputNode.value="";mstrmojo.css.removeClass(this.domNode,["err"]);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo.Container");var A=1;mstrmojo.maps.androidmap.AndroidDocMapInfoWindow=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._HasLayout],{scriptClass:"mstrmojo.maps.androidmap.AndroidDocMapInfoWindow",markupString:'<div class="mstrmojo-androidmap-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-androidmap-DocInfoWindow"></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild;}},getChildren:function B(){var C=this.model,E=C.getLayoutDataCache(C.getCurrentLayoutKey())[this.psId],D=E.defn.fmts;D.left=A+"px";D.top=A+"px";return[E];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._Formattable","mstrmojo._HasToolbar");var B="\u001E";var F=1;var H=2;var I={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3,vert:["height","width","top"],horiz:["width","height","left"],updateStyle:function(K){var N=K.defn.qsm;if(!N){return ;}if(K.getFormats().width){return ;}var O=null;if(N==F){O=K.containerNode.firstChild;}else{O=K.containerNode.lastChild;}if(!O){return ;}var L=O.clientHeight+"px";var J=O.clientWidth+"px";var M=K.domNode.style;M.height=L;M.width=J;if(K.parent.updateStyle){K.parent.updateStyle(L,J);}},repositionChildren:function(P){var O=P.getFormats(),N=parseInt(O.height,10),S=parseInt(O.width,10);var J=P.children,M=J[0].getFormats(),U=J[1].getFormats();var K=(P.defn.gp<this.LEFT),R=(K)?N:S,Q=(K)?S:N,T=this[((K)?"vert":"horiz")];var L=Math.round(R*(P.defn.ga/100));M[T[0]]=L+"px";M[T[1]]=Q+"px";U[T[0]]=(R-L)+"px";U[T[1]]=Q+"px";if((P.defn.gp%2)===0){U[T[2]]=L+"px";}else{M[T[2]]=(R-L)+"px";}this.resizeChildren(J[0],J[1]);},stackChildren:function(J){var M=J.children,N=J.getFormats(),L;for(var K=M.length-1;K>=0;K--){L=M[K].getFormats();L.width=N.width;L.height=N.height;}this.resizeChildren(M[0],M[1]);},resizeChildren:function(L,J){L.renderPortalState();var K=J.getFormats();J.resizeForDisplayState(parseInt(K.height,10),parseInt(K.width,10),true);},changeVisibility:function(L,J){var O=L.children,N=L.defn.qsm,K=J&&(!N||L.viewMode===F),M=J&&(!N||L.viewMode===H);if(O&&O.length>0){if(O[0].visible!==K){O[0].set("visible",K);}if(O[1].visible!==M){O[1].set("visible",M);}}L.visible=J;},setViewMode:function G(K){var L=K.children,M=K.visible;if(K.defn.qsm&&L&&L.length>0){var J=K.viewMode;L[0].set("visible",(J==F)&&M);L[1].set("visible",(J==H)&&M);}},clearFormatCache:function C(K){var M=K.children;for(var L=0,J=M&&M.length||0;L<J;L++){M[L].clearCache();}}};mstrmojo.DocGridGraph=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocGridGraph",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocGridGraph" style="{@domNodeCssText}"><div class="mstrmojo-DocGridGraph-msg"></div><div class="mstrmojo-DocGridGraph-container"></div></div>',markupSlots:{msgNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW","B","background-color","fx","font"]},viewMode:null,visible:true,resize:function D(){this.clearCache();I.clearFormatCache(this);var L=this.getFormats(),J=parseInt(L.width,10),K=parseInt(L.height,10);if(J>0&&K>0){I.changeVisibility(this,true);if(!this.defn.qsm){I.repositionChildren(this);}else{I.stackChildren(this);}}else{I.changeVisibility(this,false);}},postBuildRendering:function A(){this._super();var L=this.node.data.eg;if(L===undefined){this.msgNode.style.display="none";this.containerNode.style.display="block";}else{this.msgNode.innerHTML=L;this.msgNode.style.display="block";this.containerNode.style.display="none";}var K=this.defn.qsm;if(!this.viewMode&&K){this.viewMode=K;}var J=this.node.defn;J.attachEventListener("qsmChange",this.id,function(M){this.viewMode=M.value;I.setViewMode(this);this.model.getDataService().setQuickSwitchViewMode(this.defn.tt+B+this.k,this.viewMode);I.updateStyle(this);});I.setViewMode(this);I.updateStyle(this);if(!K){this.resize();}},getGridWidget:function(){return this.children[0];},getGraphWidget:function(){return this.children[1];},updateGraph:function(K){var J=this.getGraphWidget();if(J){J.update(K);J.refresh();}},quickSwitch:function E(){var J=this.viewMode!=H;this.defn.set("qsm",(J?H:F));return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo.Container");var A=1;mstrmojo.maps.jsmap.AndroidDocMapInfoWindow=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._HasLayout],{scriptClass:"mstrmojo.maps.jsmap.AndroidDocMapInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild;}},getChildren:function B(){var C=this.model,E=C.getLayoutDataCache(C.getCurrentLayoutKey())[this.psId],D=E.defn.fmts;D.left=A+"px";D.top=A+"px";return[E];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo.css","mstrmojo.array");var K=mstrmojo.css;var C=2;function N(Q,O,P){var R=Q.parent.parent;if(R&&R instanceof mstrmojo.DocPanel){R[O+"DirtyKey"](P);}}function E(P,O,Q){if(P===O.k){mstrmojo.array.forEach(O.children,function(R){if(R.setDirtyChildren){R.setDirtyChildren(Q);}});}}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,cssDisplay:"block",topStart:C,contentWidth:0,markupString:'<div id="{@id}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="height:100%;width:100%;position:absolute;{@containerNodeCssText}"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx"]},title:"",init:function M(O){this._super(O);if(!this.title){this.title=this.node.defn.ttl||"";}},childRenderCheck:function D(O){return(this._super(O)&&this.selected);},postBuildRendering:function A(){var O=K.addClass;if(!this.defn.l&&!this._forceRender){O(this.domNode,"placeholder");}return this._super();},onselectedChange:function F(O){this.set("visible",!!O.value);if(O.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!O.value});},refresh:function J(){if(!this.hasRendered){return ;}if(!this.selected){if(!this.children){this.builtChildren=false;}this._forceRender=true;this._super();delete this._forceRender;}else{var P=this.children||[],O;for(O=P.length-1;O>=0;O--){P[O].refresh();}if(this._isFP()){this.refreshFP();}}},setDirty:function H(O){var P=((O)?"add":"remove")+"DirtyKey";this[P](this.k);},addDirtyKey:function L(O){var Q=this.defn,P=Q.dirtyKeys||{};P[O]=true;Q.dirtyKeys=P;E(O,this,true);N(this,"add",O);},removeDirtyKey:function G(P){N(this,"remove",P);E(P,this,false);var Q=this.defn,O=Q.dirtyKeys;if(!O){return ;}delete O[P];if(!mstrmojo.hash.isEmpty(O)){return ;}delete Q.dirtyKeys;},renderChildren:function B(){var T=this.children;if(T&&(this._isFP()||this._isFSP())){for(var S=0,O=T&&T.length||0;S<O;S++){T[S].orgPos=S;}T.sort(function(W,Z){var X=(W.getFormats()&&W.getFormats()["z-index"])||0,Y=(Z.getFormats()&&Z.getFormats()["z-index"])||0;return X-Y||W.orgPos-Z.orgPos;});}if(this._isFP()){if(T){var U=this.domNode.clientWidth-2*C;this.topStart=C+1;for(var S=0,O=T&&T.length||0;S<O;S++){var Q=this.domNode.clientWidth-2*C;this.contentWidth=(Q>0)?Q:0;if(Q!=U){this.topStart=C;for(var R=0;R<S;R++){var P=T[R];P.refresh();if(P.getContainerHeight){this.topStart+=P.getContainerHeight()+C;}}}var V=T[S];if(this.childRenderCheck(V)){V.render(null);if(V.getContainerHeight){this.topStart+=V.getContainerHeight()+C;}}}}}else{this._super();}},refreshFP:function(){if(!this.hasRendered){return ;}var R=this.children;this.topStart=C;var P=this.domNode.clientWidth-2*C;this.contentWidth=(P>0)?P:0;for(var Q=0,O=R&&R.length||0;Q<O;Q++){var S=R[Q];if(S.relocate){S.relocate(this.topStart,this.contentWidth);}if(S.getContainerHeight){this.topStart+=S.getContainerHeight()+C;}}},getChildren:function I(){var Q=this.model.getChildren(this.node,false);if(this._isFP()||this._isFSP()){for(var P=0,O=Q&&Q.length||0;P<O;P++){var R=Q[P];if(this._isFP()&&!R.defn.iifp){R.defn.iifp=true;}if(this._isFSP()&&!R.defn.iifs){R.defn.iifs=true;}}}return Q;},_isFP:function(){return this.parent.defn.ifp;},_isFSP:function(){return this.parent.defn.ifsp;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.ImageToggle","mstrmojo._IsInputControl");mstrmojo.ToggleDIC=mstrmojo.declare(mstrmojo.ImageToggle,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ToggleDIC",init:function(A){this._super(A);this.unset=this.dic.ust;},focus:function(){this.domNode.focus();},onvalueChange:function(){},onblur:function(B){var A=B.e||B,C=this.domNode,D=mstrmojo.boxmodel.offset(C,document.body);if(A.clientX>D.left&&A.clientX<D.left+C.offsetWidth&&A.clientY>D.top&&A.clientY<D.top+C.offsetHeight){this.domNode.focus();}else{this.applyChanges();}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var A=this.openerStyle;this.width=A.iw;this.height=A.ih;this.set("imageList",this.dic.vls);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo._HasTouchScroller","mstrmojo.android.selectors._SupportsHoriz","mstrmojo.css");mstrmojo.android.selectors.CheckList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList,mstrmojo._HasTouchScroller,mstrmojo.android.selectors._SupportsHoriz],{scriptClass:"mstrmojo.android.selectors.CheckList",hasEvenRows:true,init:function A(C){this._super(C);var B=["selector-checklist"];if(this.multiSelect){B.push("multi");}mstrmojo.css.addWidgetCssClass(this,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.android._IsList","mstrmojo.android._HasLingeringListSelections","mstrmojo._TouchGestures","mstrmojo.css");var A,C=mstrmojo.dom,B=C.CSS3_TRANSITION_DURATION;mstrmojo.android.ui.ActionToolbarButtons=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo.android._HasLingeringListSelections,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.ActionToolbarButtons",init:function G(H){this._super(H);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ActionToolbar-buttons");},cssDisplay:"table",icnCssText:"display:table-row",getItemMarkup:function F(H){if(!A){A=this._super(H).replace(">{@n}",' title="{@n}"><div></div>');}return A;},getItemProps:function D(J,H){var I=this._super(J,H);I.addCls(J.cls);return I;},listHooks:{select:function(H){H.style[B]=0;this.setClearHandler(200);},unselect:function(H){H.style[B]="300ms";}},preselectionChange:function E(H){if(H.added){return !!this.parent.active;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo._HasTouchScroller","mstrmojo.android.selectors._SupportsHoriz","mstrmojo.color","mstrmojo.css");function E(F){return function(K,L,G,N){var J=K.style,I="remove",M="transparent",H="inherit";if(F){I="add";M=N.selColor;H=N._txtColor;}J.backgroundColor=M;J.color=H;mstrmojo.css[I+"Class"](K,mstrmojo.android._IsList.SELECTED_CLS);};}mstrmojo.android.selectors.LinkBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList,mstrmojo._HasTouchScroller,mstrmojo.android.selectors._SupportsHoriz],{scriptClass:"mstrmojo.android.selectors.LinkBar",selColor:"#60b1f6",minItemHeight:29,getItemMarkup:function(G){var F=this._itemMarkup;if(!F){this._itemMarkup=F=this._super(G).replace("{@n}",'<div>{@n}<div style="background-color:'+(this.parent.getFormats().color||"#000")+';"></div></div>');}return F;},getItemProps:function C(H,F){var G=this._super(H,F);if(G.sel){G.style+="color:"+this._txtColor+";background-color:"+this.selColor+";";}return G;},preBuildRendering:function B(){this.cssClass+=" selector-linkbar";this._txtColor=mstrmojo.color.getContrastingColor(this.selColor,["#ffffff","#000000"]);return this._super();}});var D=mstrmojo.android.selectors.LinkBar.prototype,A=D.itemRenderer;D.itemRenderer={render:A.render,select:E(true),unselect:E(false)};}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change >{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo.array","mstrmojo.css");var G=mstrmojo.array,H=mstrmojo.css,E=Math,A="fixed";function F(R,S){var O=this.domNode,N=O.clientWidth,Q=this._itemSizeMap,M=R-1,P=R+1;S=S||0;G.forEach(this.itemsContainerNode.childNodes,function(V,T){var W=0;if(T===R){W=(N/2)-(Q[T]/2);}else{if(T===P){W=N-Q[T];}else{if(T!==M){W=-(N/2);if(T>P){W=N+(-1*W);}}}}var U=E.round(W+S/2)+"px";if(V.style.left!==U){V.style.left=U;}V.style.left=(W+S/2)+"px";});}mstrmojo.android.ui.ScrollableTabs=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList],{scriptClass:"mstrmojo.android.ui.ScrollableTabs",multiSelect:false,init:function L(M){this._super(M);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ScrollableTabs");},setCurrentTab:function K(M){this.clearSelect();this.singleSelect(M,true);this.itemRenderer.select(this._getItemNode(M),this.items[M],M,this);F.call(this,M);},tabSelected:mstrmojo.emptyFn,postitemsChange:function B(){var O=this._itemSizeMap=[],M=this.items,N=this.domNode;if(M&&M.length){G.forEach(this.itemsContainerNode.childNodes,function(Q,P){O[P]=Q.offsetWidth;});}else{this.set("visible",false);}H.addClass(N,A);F.call(this,E.max(this.selectedIndex||0,0));window.setTimeout(function(){H.removeClass(N,A);},0);},postselectionChange:function C(M){var N=M.added;if(N){this.tabSelected(this.items[N[0]]);}},enterScroll:function I(){H.addClass(this.domNode,A);},scroll:function J(M){F.call(this,this.selectedIndex,M);},exitScroll:function D(M){H.removeClass(this.domNode,A);this.setCurrentTab(M);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(E,D){if(!A){var F=this.itemField;A=this._super(E).replace(">{@n}<",' title="{@'+F+'}">{@'+F+"}<");}return A;},getItemProps:function C(F,D){var E=this._super(F,D),G=this.itemField;E[G]=F[G];return E;},onclick:function B(D){this._super(D);var E=this.parent,G=E.opener;G.suggestionShown=false;var F=this.selectedItem;if(F){G.handleSuggestionItemSelect(F);}E.close();},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems"}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.android._IsList","mstrmojo._TouchGestures","mstrmojo.dom","mstrmojo.css");function C(){var E=this._tchHandler;if(E){E.clear();delete this._tchHandler;}this.clearSelect();mstrApp.setMenuStatus(this.id,false);}mstrmojo.android.ui.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Menu",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ActionMenu");this._lastVisible=this.visible;},setMaxWidth:false,markupMethods:{onvisibleChange:function(){var E=!!this.visible,G=this.domNode,F=G.style;F.display=(E)?this.cssDisplay:"none";if(this.parent&&this.parent.propogateMenuVisibleChange&&E!=this._lastVisible){this._lastVisible=E;this.parent.propogateMenuVisibleChange(E);}if(E&&this.setMaxWidth){F.maxWidth=(Math.round(mstrApp.getScreenDimensions().w*0.98)-mstrmojo.dom.position(G).x)+"px";}}},onvisibleChange:function B(E){if(E.value){var F=this.id;this._tchHandler=mstrmojo.touchManager.attachEventListener("touchesBegin",F,function(G){if(G.srcId!==F){this.set("visible",false);G.ignore=true;}});mstrApp.setMenuStatus(F,true);}else{C.call(this);}},onUnRender:function A(){C.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.android._IsList","mstrmojo.css","mstrmojo.dom","mstrmojo.array");var K=mstrmojo.dom,L=mstrmojo.css;function F(T,Q){var R=K.findAncestorByAttr(T.target,"idx",true,this.domNode);if(R){var P=R.value,S=this.itemRenderer;S[Q](R.node,this.items[P],P,this);}}mstrmojo.android.SimpleList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.SimpleList",scrollerConfig:{bounces:false,showScrollbars:false},highlightOnSelect:false,hasEvenRows:false,rowHeight:-1,itemsFloat:false,init:function O(P){this._super(P);if(!mstrApp.isTouchApp()){L.addWidgetCssClass(this,["hosted"]);}},updateItem:function C(P){var T=document.createElement("div"),R=this.items[P],Q=this;T.innerHTML=this.itemRenderer.render(this.items[P],P,this);var S=T.firstChild;this.itemsContainerNode.replaceChild(S,this._getItemNode(P));mstrmojo.array.forEach(R.dependents,function(U){Q.updateItem(U._renderIdx);});return S;},setDimensions:function N(R,Q){if(this.height!==R||this.width!==Q){this.height=R;this.width=Q;var P=this.domNode;if(P){P.style.height=R;P.style.width=Q;this.updateScroller();}}},buildRendering:function H(){var P=this._super();if(this.itemsFloat){var Q=document.createElement("div");Q.className="clear-me";this.itemsContainerNode.appendChild(Q);}return P;},updateScrollerConfig:function J(){var P=this._super(),T=this.itemsContainerNode,R=parseInt(this.height,10);if(isNaN(R)){R=this.domNode.clientHeight;}P.scrollEl=T;P.noHScroll=true;P.origin=P.origin||{x:0,y:0};var S=P.offsetIdx;if(S){delete P.offsetIdx;P.origin.y=this.getItemOffset(S);}var U=Math.max(this.getItemsContainerHeight()-R,0);var Q=P.vScroll=(U!==0&&P.noVScroll!==true);if(Q){P.offset={y:{start:0,end:U}};}else{P.offset=null;}return P;},getItemOffset:function E(P){var Q=this._getItemNode(P);return Math.max(Q.offsetTop-parseInt(L.getStyleValue(Q,"marginTop"),10),0);},getOffsetIndex:function B(){var T=this.scrollerConfig,Y=T&&T.origin,U=Y&&Y.y;if(U){var P=this.rowHeight;if(this.hasEvenRows&&P!==-1){return Math.round(U/P);}var Q=this.itemsContainerNode.childNodes,S=0,V=Q.length-1;while(V>=S){var X=S+V>>1,W=Q[X],R=W.offsetTop,Z=W.offsetHeight;if(U<R-Z){V=X-1;}else{if(U>R+(Z*2)){S=X+1;}else{return X;}}}}return 0;},scrollToItem:function D(Q,R){var P=this._scroller;if(P){P.scrollTo(0,this.getItemOffset(Q),R||0);}},getItemsContainerHeight:function G(){var S=this.hasEvenRows,Q;if(!S||this.rowHeight===-1){if(S){var R=this._getItemNode(0);if(R){this.rowHeight=R.offsetHeight;}}else{this.rowHeight=-1;}Q=this.itemsContainerNode.offsetHeight;}else{var P=this.items;Q=(this.rowHeight*((P&&P.length)||0));}return Q;},touchSelectBegin:function I(P){if(this.highlightOnSelect){F.call(this,P,"select");}this._super(P);},touchSelectMove:function M(P){this._selectMove=true;this._super(P);},touchSelectEnd:function A(Q){var P=this._selectMove;delete this._selectMove;if(!P){this.touchTap(Q);}else{if(this.highlightOnSelect){F.call(this,Q,"unselect");}}},touchend:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo._HasTouchScroller","mstrmojo.android.selectors._SupportsHoriz","mstrmojo.css");var B,A=/line-height:(\d*)px/,C=mstrmojo.css;function G(I){if(this.parent.defn.ct!=="4"){return ;}mstrmojo.css[((I)?"add":"remove")+"Class"](this.domNode,"glow");}mstrmojo.android.selectors.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList,mstrmojo._HasTouchScroller,mstrmojo.android.selectors._SupportsHoriz],{scriptClass:"mstrmojo.android.selectors.ButtonBar",cssClass:"selector-btnbar",getItemMarkup:function F(I){if(!B){B=this._super(I).replace("{@n}","<div>{@n}</div>");}return B;},getItemProps:function D(M,I){var L=this._super(M,I),K=L.style,J=K.match(A);if(J){L.style=K.replace(A,"line-height:"+(parseInt(J[1],10)-2)+"px");}return L;},touchBegin:function H(){G.call(this,true);},touchEnd:function E(){G.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.GridBase");var V=mstrmojo.css,M=mstrmojo.color;function C(b,d){var f=b&&b.parent;while(f&&f.scriptClass.indexOf("DocPanelStack")===-1){if(d in f){return f;}f=f.parent;}return null;}function B(d){var b=document.createElement("img");d.appendChild(b);d.removeChild(b);}function E(b,d){var f=Math.floor(b/d.rowsPerPage),h=b%d.rowsPerPage,g=d.tableNode.tBodies[f];r=g.rows[h].cells;return r;}function H(){var b=this._renderTimer;if(b){self.clearInterval(b);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:15,defaultRowsPerPage:100,minRowsPerPage:50,init:function G(b){this._super(b);this.forceFixedSizes=true;},initPageSettings:function N(){var d=this.parent,b=this.defaultRowsPerPage;this.effectiveRh=this.rh||this.rhMin||1;if(d&&d.numRowFixed){b=this.cp.getAvailableRowsCount();}else{if(d&&d.scrollboxHeightFixed){b=Math.ceil(d.scrollboxHeight/this.effectiveRh);b=Math.max(b,this.minRowsPerPage);}}this.pageStatus=[];this.rowsPerPage=b;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function X(h){var g=this.rowsPerPage;this.totalPages=g&&Math.ceil(this.cp.rc/g)||0;h=h||this.pageStatus;for(var d=0;d<this.totalPages;++d){var j=d*g,f=j+g-1,b=this.cp.isDataAvailable(j,f);if(!h[d]){h[d]={};}h[d].onDemand=!b;}},buildRendering:function F(j){if(this.renderMode=="vscroll"){this.initPageSettings();var h=this.pageStatus[0],b=h&&h.onDemand;this.start=0;this.end=-1;if(!b){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!b);}this._super();if(this.renderMode=="vscroll"){var g=this.parent,f=this,k=function(){f.gridContainerNode.style[mstrmojo.css.MINHEIGHT]=(f.cp.rc*f.effectiveRh)+"px";};if(mstrmojo.dom.isIE7){this.gridContainerNode.style.zoom="1";window.setTimeout(k,10);}else{k();}if(!this.connectedScrollbox){if(g&&g.connectScrollbox){g.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!b);this.postRenderPages();var d=g&&!g.scrollboxHeightFixed&&!g.numRowFixed;if(d&&this.numPagesRendered>=this.totalPages&&!b){this.postRenderingCleanup();}else{if(b||d){this.onscroll();}}}else{this.configureActions();}},preRenderPages:function Q(){},postRenderPages:function Z(){this.configureActions();},configureActions:function L(){var b=this.parent;if(b&&b.configureActions){b.configureActions();}},preRenderPage:function O(b,d){this.pageNum=b;},postRenderPage:function J(d,g,h){if(d+1>this.numPagesRendered){this.numPagesRendered=d+1;}var b=this.pageStatus,f=b[d];if(!f){f=b[d]={};}if(g){f.filled=true;f.dirty=false;}var j=this.gridContainerNode.style;if(d==this.totalPages-1&&j){j[mstrmojo.css.MINHEIGHT]="";}},invalidAllPages:function(){for(var b=0;b<this.totalPages;++b){var d=this.pageStatus[b];if(d.filled){d.dirty=true;}d.onDemand=true;d.filled=false;d.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function a(){var b=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var g=mstrmojo.all[b];if(!g){return ;}var d=g.getPagesToRender();if(d.length>0){g.preRenderPages();g.renderPages(d);g.postRenderPages();g._postPagesClearup=true;}else{if(g._postPagesClearup){g.postRenderPagesCleanup();g._postPagesClearup=false;}H.call(g);if(g.isRenderingComplete()){g.postRenderingCleanup();}}}catch(f){H.call(mstrmojo.all[b]);throw f;}},this.renderPause);},onscroll:function Y(b){if(!this.renderingRows){if(b===true){var d=this.parent;if(d&&d.maskNode){V.addClass(d.maskNode,"wait");}}this._startPageRenderThread();}},isRenderingComplete:function P(){if(this.end>=this.cp.rc-1){for(var b=this.pageStatus,d=this.totalPages-1;d>-1;d--){if(!b[d]||!b[d].filled){return false;}}return true;}return false;},renderPages:function D(d){for(var f=0,b=d.length;f<b;++f){this.renderPage(d[f].idx,d[f].fill);}},renderPage:function W(k,d){var p=this.pageStatus,g=(this.numPagesRendered>=k+1);if(g){if(!d||(p[k]&&p[k].filled)){return ;}}var o=this.rowsPerPage,h=this.domNode;this.start=k*o;this.end=Math.min(this.start+o,this.cp.rc)-1;this.preRenderPage(k,d);var b=this.tempTable;if(!b){b=this.tempTable=h.ownerDocument.createElement("div");}var j=d?this.buildTableRowsMarkup(this.start,this.end,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>").join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(this.effectiveRh*(this.end-this.start+1))+'px">&nbsp;</td></tr></tbody></table>';b.innerHTML=j;var f=b.firstChild.tBodies[0],l=this.tableNode;if(!g){l.appendChild(f);}else{l.replaceChild(f,l.tBodies[k]);}this.postRenderPage(k,d,f);},getPagesToRender:function S(){var s=[],x=this.parent,AI=this._defaultPageHeight,h=null,AJ=this.pageStatus,AK=this;function o(j){var p=AJ[j];if(p&&(p.filled||p.dirty)){if(!p.height){if(!h){h=AK.tableNode.tBodies;}p.height=h[j].offsetHeight;}return p.height;}else{return AI;}}var l=0,k=null,t=null,d=x.scrollboxTop;for(var AE=0,AF=this.totalPages,b=this.pageStatus;AE<AF;AE++){l+=o(AE);if(l>=d){k=AE;break;}}if(k===null){k=t=AF-1;}else{var w=x.scrollboxBottom;if(isNaN(w)&&x.numRowFixed){w=d;}for(var AC=k+1;AC<AF;AC++){if(l>w){t=AC-1;break;}l+=o(AC);}}if(t===null){t=AF-1;}for(var z=this.numPagesRendered;z<k;++z){s.push({idx:z,fill:false});}var AD=this.pageStatus,AB=0,AG=this.rowsPerPage,q=false;for(var AA=k;AA<=t;++AA){var AH=AJ[AA];if(!AH||!AH.filled){if(AH&&AH.onDemand){q=true;if(!AH.isDownloading&&!this.isDownloading){AB+=AG;AH.isDownloading=true;this.isDownloading=true;var g=AA*AG,f=g+AG-1;this.cp.download(g,f);}s.push({idx:AA,fill:false});}else{s.push({idx:AA,fill:true});}}}if(q){this.parent.showDownloadStatus(AB);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return s;},addHilitePosition:function(d,g,b){var h=this.hiliteCellsMap[d];if(!h){this.hiliteCellsMap[d]={pos:[],nodes:[]};}var f=g-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[d].pos.push({row:f,cell:b,page:this.pageNum});},setHilites:function(g,h){var j=h.getAttribute("ei"),k=this.eiMap[j],b=this.getNodesByPositions(k);if(!b.length){this._super(g,h);return ;}for(var f=0,d=b.length;f<d;f++){this._super(g,b[f]);}},addExtraInfoMap:function(d,f,b){if(!this.eiMap[d]){this.eiMap[d]=[];}this.eiMap[d].push(this.getPosObj(f,b));},addPositionMap:function(d,f,b){if(!this.posMap[d]){this.posMap[d]=this.getPosObj(f,b);}},addTitleHeaderPositionMap:function(f,b,d){var g=this.getPosObj(f,b);g.obj=d;this.thPosMap.push(g);},getPosObj:function(b,d){return{row:b-this.pageNum*this.rowsPerPage,cell:d,page:this.pageNum};},getNodeByPosition:function(b){return this.tableNode.tBodies[b.page].rows[b.row].cells[b.cell];},getRowIdxByCell:function(b){var d=this.posMap[b._ei];return d.page*this.rowsPerPage+d.row;},getNodesByPositions:function(k){var b=[];for(var f in k){var d=k[f],h=(d&&d.page)||0,g=d&&d.row,j=d&&d.cell;b.push(this.tableNode.tBodies[h].rows[g].cells[j]);}return b;},getPageHeight:function R(b){var d=this.tableNode.tBodies;return(d&&d[b]&&d[b].offsetHeight)||0;},getTargetCell:function(o,l){var g=0,d=0;for(var k=this.totalPages;d<k;d++){g+=this.getPageHeight(d);if(l<=g){break;}}var f=this.tableNode.tBodies[d];if(f){for(var d=0,k=f.rows.length;d<k;d++){var s=f.rows[d];for(var b=0,q=s.cells.length;b<q;b++){var p=s.cells[b];if(p.offsetTop+p.offsetHeight>=l){if(o>=p.offsetLeft&&o<=p.offsetLeft+p.offsetWidth){return p;}}else{break;}}}}},postRenderPagesCleanup:function I(){var f=this.parent;if(f&&f.gridData&&f.gridData.afc){var d=this.tableNode;if(d&&(this.lastWidth!=d.offsetWidth)){if(f.onGridWidthChanged){f.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(g){delete g.height;});this.lastWidth=d.offsetWidth;}var b=C(f,"adjustAutoWidth");if(b){b.adjustAutoWidth(f);}}if(f.gridPagesRendered){f.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(f&&f.maskNode){V.removeClass(f.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function K(){var o=this.cp.getUpdatedRows(),h=this,l,b,k,p,f,g,j,d=[];if(o){mstrmojo.hash.forEach(o,function(s,q){j=parseInt(q,10);l=h.cp.getRowCells(j);b=E(j,h);k=b.length;p=l.length-1;if(p>=0){for(f=k-1;f>=0;f--){g=b[f];if(p<0){break;}if(l[f]._d){var w=g.style.backgroundColor,t=g.style.color;d.push({dom:g,bgcolor:w,ftcolor:t});g.style.backgroundColor=M.getHighlightColor(M.rgbStr2rgb(mstrmojo.css.getStyleValue(g,"backgroundColor"),true));g.style.color=M.getContrastingColor(M.rgbStr2hex(mstrmojo.css.getStyleValue(g,"backgroundColor")),["#ffffff","#000000"]);delete l[f]._d;}p--;}}});if(d.length>0){window.setTimeout(function(){mstrmojo.array.forEach(d,function(q){q.dom.style.backgroundColor=q.bgcolor;q.dom.style.color=q.ftcolor;});},300);}}},getRowInfoByPosition:function(b){return this.cp.getRowCellInfo(b);},postRenderingCleanup:function A(){var b=this.parent;if(b&&this.connectedScrollbox){b.disconnectScrollbox(this);}this.connectedScrollbox=false;if(b&&!b.scrollboxHeightFixed){var d=C(b,"performCanGrowCanShrink");if(d){d.performCanGrowCanShrink([b],true);}}},unrender:function U(b){H.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this._super(b);},dataDownloaded:function T(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._TouchGestures");mstrmojo.ui.MobileStepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.ui.MobileStepper",onclick:function D(I){if(!mstrApp.isTouchApp()){this._super(I);}return false;},onmousedown:function A(I){if(!mstrApp.isTouchApp()){this._super(I);}return false;},onmouseup:function C(I){if(!mstrApp.isTouchApp()){this._super(I);}return false;},touchSelectBegin:function B(I){this.startStepperInterval(I,"touchTap");},touchSelectEnd:function G(I){this.stopStepperInterval();},touchTap:function F(I){this.processEvent(I.target);},touchBegin:function H(J){var I=J.target;if(I==this.nextNode||I==this.prevNode){mstrmojo.css.addClass(I,"glow");}},touchEnd:function E(J){var I=J.target;if(I==this.nextNode||I==this.prevNode){mstrmojo.css.removeClass(I,"glow");}}});mstrmojo.ui.MobileStepper.prototype.markupString=mstrmojo.ui.MobileStepper.prototype.markupString.replace(",mousedown,mouseup","");}());(function(){mstrmojo.requiresCls("mstrmojo.OfflineTransactionModel","mstrmojo.Button");mstrmojo._CanSupportOfflineTransactions=mstrmojo.provide("mstrmojo._CanSupportOfflineTransactions",{_mixinName:"mstrmojo._CanSupportOfflineTransactions",getTransactionNotificationController:function A(){var E=this.txNtfCtlr;if(this.oflnTxModel&&(!E||!mstrmojo.all[E.id])){E=this.txNtfCtlr=mstrApp.controllerFactory.newController("Transactions",{model:this.oflnTxModel,rootCtrl:mstrApp.rootController});}return E;},submitTransactionQueue:function C(E,F){mstrMobileApp.submitOfflineTransactions(E,F,"mstrApp.onSubmitTransactionQueueDone");},onSubmitTransactionQueueDone:function B(E,F){if(this.oflnTxModel){this.oflnTxModel.onSubmitDone(E);}if(E){mstrApp.rootController.generateActionToolbar();mstrmojo.toast(mstrmojo.desc(9724,"All pending transactions have been successfully submitted"));}else{mstrmojo.toast(mstrmojo.desc(9261,"A background transaction submission failed"));}},submitOfflineTransaction:function D(){if(this.oflnTxModel){this.oflnTxModel.submitOfflineTransaction();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.Button","mstrmojo.url");mstrmojo.requiresDescs(1442,2140);var A=mstrmojo.Button.newInteractiveButton;mstrmojo.android.inputControls.SignatureDIC=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.SignatureDIC",markupString:"<div></div>",hasSignature:false,showInPopup:function C(){var F=this.ownerCell||this.owner;if(F.mdf){var G=this;mstrmojo.confirm("Continuing will erase the existing signature. Do you want to proceed?",[A(mstrmojo.desc(2140,"Cancel"),null,null),A(mstrmojo.desc(1442,"Ok"),function(){G.captureSignature();},null)]);}else{this.captureSignature();}},captureSignature:function B(){mstrMobileApp.captureSignature(JSON.stringify({serverURL:mstrApp.getConfiguration().getTaskUrlByProject(mstrApp.getCurrentProjectId()),sessionState:mstrApp.getSessionState(),showGuideLine:this.dic.sgl}),'mstrmojo.all["'+this.id+'"].signatureCaptured');},signatureCaptured:function D(F){this.value=mstrmojo.url.getAbsoluteURL(F,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());this.applyChanges();},renderPreview:function E(){var I="",G=this.ownerCell||this.owner,H=this.openerNode,F=this.value;if(G.mdf&&/^(http|https).+(png|jpg)$/.test(F)){I='<img src="'+this.value+'" style="max-height:'+H.clientHeight+"px;max-width:"+(H.clientWidth-30)+'px;"></img>\u00a0';}this.renderPreviewButton(H,I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.css","mstrmojo.hash");var H=mstrmojo.css,D=mstrmojo.hash,B="glow";var F=mstrmojo.android.ui.Button=mstrmojo.declare(mstrmojo.Button,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Button",onclick:mstrmojo.emptyFn,touchBegin:function E(){if(this.enabled){H.addClass(this.domNode,B);}},touchTap:function C(J){if(this.enabled){this.onclick({e:J.evt});}},touchSelectBegin:mstrmojo.emptyFn,touchSelectEnd:function A(J){if(this.enabled){this.onclick({e:J.evt});}},touchEnd:function I(){H.removeClass(this.domNode,B);}});F.prototype.markupString=F.prototype.markupString.replace(new RegExp(" mstrAttach:[a-zA-Z,]*"),"");F.newButton=function G(M,L,K){var J={scriptClass:"mstrmojo.android.ui.Button",text:M};if(L){J.onclick=L;}D.copy(K,J);return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.Calendar","mstrmojo._TouchGestures");mstrmojo.MobileCalendar=mstrmojo.declare(mstrmojo.Calendar,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.MobileCalendar",cssPrefix:"mobile-calendar",monthNames:function(C){return mstrmojo.locales.datetime.MONTHNAME_FULL[C];},supportedViews:{day:true,month:true,year:true},premousedown:function A(C){if(!mstrApp.isTouchApp()){return this._super(C);}},touchTap:function B(C){this.processEvent(document.elementFromPoint(C.pageX,C.pageY));return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Image","mstrmojo._TouchGestures");mstrmojo.android.ui.Image=mstrmojo.declare(mstrmojo.Image,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Image",touchTap:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.date");var A=mstrmojo.date;mstrmojo.DateStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.DateStepperContentProvider",curVal:null,init:function(F){this._super(F);var G=this.item,E=G[this.intField],I=G[this.valField],H=this.minField,D=this.maxField,C=G[H],B=G[D];this.min=C&&A.getDateFromDateInfo(C);this.max=B&&A.getDateFromDateInfo(B);this.curVal=I?A.getDateFromDateInfo(I):(this.min?new Date(this.min):new Date());this.createChildProviders();},createChildProviders:function(){var B=this;mstrmojo.array.forEach(["year","month","day"],function(C){B[C+"CP"]=new mstrmojo.NumStepperContentProvider({item:{interval:1},canLoop:true,updateConfig:function(E,D,F){this.curVal=E;this.max=D;this.min=F;},onTraverse:function(){B.traverse(C,this.curVal);}});});this.updateChildProviders();},updateChildProviders:function(){var I=this.max,D=this.min,G=this.curVal.getFullYear(),F=this.curVal.getMonth(),H=this.curVal.getDate(),C=I&&(G===I.getFullYear()),E=D&&(G===D.getFullYear()),J=C&&(F===I.getMonth()),B=E&&(F===D.getMonth());this.yearCP.updateConfig(G,I?I.getFullYear():null,D?D.getFullYear():null);this.monthCP.updateConfig(F+1,C?I.getMonth()+1:12,E?D.getMonth()+1:1);this.dayCP.updateConfig(H,J?I.getDate():mstrmojo.date.getDaysOfMonth(G,F+1),B?D.getDate():1);},traverse:function(E,D){var C=this.curVal,G=(E==="year")?D:this.curVal.getFullYear(),B=(E==="month")?D:this.curVal.getMonth()+1,F=(E==="day")?D:this.curVal.getDate();F=Math.min(mstrmojo.date.getDaysOfMonth(G,B),F);C.setFullYear(G,B-1,F);if(this.max){C=Math.min(this.max,C);}if(this.min){C=Math.max(this.min,C);}this.curVal=new Date(C);this.updateChildProviders();if(this.onTraverse){this.onTraverse();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.selectors.MobileSliderSelector","mstrmojo.hash");var D=mstrmojo.android.selectors.MobileSliderSelector,A=D.FLAGS,F=D.TYPES;mstrmojo.android.selectors.Slider=mstrmojo.declare(mstrmojo.android.selectors.MobileSliderSelector,null,{scriptClass:"mstrmojo.android.selectors.Slider",items:A.UNSET,initState:function C(){if(!!this.items){this.leftStep=this.rightStep=this.singleStep=null;this.set("type",(!this.multiSelect)?F.SINGLE:(this.include)?F.INCLUDE:F.EXCLUDE);this.set("steps",this.items.length);this.value=null;this.set("value",this.selectedIndices);}},onvalueChange:function G(){var H=this.value,J=mstrmojo.hash.any(H,true),K=J;if(this.type===F.SINGLE){this.set("singleStep",parseInt(J)||0);}else{var I;for(I in H){J=Math.min(I,J);K=Math.max(I,K);}J=J||"0";if(K===undefined||K===null){K=String(this.steps-1);}this.set("leftStep",parseInt(J,10));this.set("rightStep",parseInt(K,10)+1);}},flushSelections:function B(){if(this.type===F.SINGLE){this.select([this.singleStep]);}else{var I=[],H=this.leftStep;for(;H<this.rightStep;H++){I.push(H);}this.select(I);}},buildSummary:function E(L,M,H){var I=this.items,K=(L!==null)?L:M;if(K===undefined||K===null||isNaN(K)||!I.length){return ;}var J=(L===null&&M!==H-1)?I[M].n+" - "+I[H-1].n:(I[K]&&I[K].n)||"";this.summary.innerHTML=J;return J;}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo._IsRptModel","mstrmojo.func");mstrmojo.RptXtabModel=mstrmojo.declare(mstrmojo.XtabModel,[mstrmojo._IsRptModel],{scriptClass:"mstrmojo.RptXtabModel",init:function D(E){this._super(E);this.dataService=(mstrApp.modelFactory&&mstrApp.modelFactory.newDataService("Xtab",E))||mstrApp.viewFactory.newXtabDataService(E);},getPageByTree:function A(E){if((!this.data.ghs||!this.data.ghs.phs)&&!this.data.phs){return ;}this._super(E);},downloadGridData:function C(I){var G=I.xtabId,F=I.memo,E=mstrmojo.all[G],H=this.getDataService();var J={success:function(K){if(K&&E){E.dataDownloaded({data:K},F);E.updateXtabStyles(K.cssString);}},failure:function(){if(E.dataDownloadErr){E.dataDownloadErr();}}};H.downloadGridData(I,J);},destroy:function B(){if(this.dataService){this.dataService.destroy();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func");var F="Metrics",D=2;function B(a){if(!a){return ;}var Y=this.scm,T="\u001E",V=0,S=null,W=null,U=null,X=null,R=null,Z=false;for(S in Y){W=Y[S];U=W.cgb;for(V in U){cgKey=U[V];R=a[cgKey];if(R){if(!W.tks){W.tks=R;Z=true;}else{if(W.tks&&(W.tks.indexOf(R)<0)){W.tks+=T+R;Z=true;}}}}}return Z;}function Q(){var S=this.data,R=S.gts;if(!R){return ;}var T;mstrmojo.array.forEach([R.row,R.col],function(W){for(var V=0,U=W.length;V<U;V++){var X=W[V];if(X.sc){T=T||{};T[X.id||F]=X.sc;if(X.fid){T[X.id+"_"+X.fid]=X.sc;}}}});this.scm=T;B.call(this,this.docModel.getCGBMap());}function I(R,S){var T=this.getDataService();T[R].apply(T,S);}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function P(R){this._super(R);this.docModel.attachEventListener("CGBMapChange",this.id,function(S){});},ondataChange:function E(R){Q.call(this);},getMessageId:function C(){return this.docModel.mid;},getDataService:function H(){return this.docModel.getDataService();},getAction:function M(g,V,Z){var d=g[0],S=d&&d.at;var U;if(S){if(S&D){var T=this.getCellTitleInfo(d),a=T&&T.title,R=a&&a.id,b=this.scm;this.sti={titleId:R||F};var Y=(R&&b[R])||b[F];if(Y){var f=this.xtab,W=(f.allowToggleSelections&&Y.all&&Z),X=(T.isSrcTitle||W);this.sti.deselectCurrent=W;U={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:V,ck:Y.ck,tks:Y.tks,eid:X?"OA:(All)":d._e.id,ctlKey:Y.ckey,sliceId:f.sid,isUConDS:Y.isUConDS}};}}}if(!U){var U=this._super(g);}if(U&&U.a){U.a.sliceId=this.xtab.sid;}return U;},getDownloadAction:function A(U,S,W,T,V,R){var X=this._super(U,S,W,T,V,R);X.sliceId=this.xtab.sid;return X;},getDrillAction:function K(R){var S=this._super(R);S.srcMsgId=this.docModel.mid;return S;},sort:function G(R,S){I.call(this,"sort",arguments);},pivot:function L(R,S){I.call(this,"pivot",arguments);},drillGrid:function O(R,S){I.call(this,"drillGrid",arguments);},downloadGridData:function N(R,S){I.call(this,"downloadGridData",arguments);},loadLayout:function J(R){this.docModel.loadLayout(R);}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocModel","mstrmojo.func","mstrmojo.hash");var B=mstrmojo.func.wrapMethods,C=mstrmojo.hash;function G(M){var L=this;return B({success:function(N){mstrmojo.hash.copy(N,L);}},M);}function I(L,M){var N=this.getDataService();N[L].apply(N,M);}function D(){var L=this;return function(M){L.setPrompts(L.getDataService().getPrompts());};}mstrmojo.ResultSetDocumentModel=mstrmojo.declare(mstrmojo.DocModel,null,{scriptClass:"mstrmojo.ResultSetDocumentModel",setPrompts:function E(L){this.prompts=L;if(L){L.host=this;}},execute:function J(P,Q,N){var M=this,O=C.copy(P,{dssId:P.did}),L;O.objType=P.objType||P.t;if(P.forceExec){O.freshExec=true;O.doNotUpdateCaches=true;}L=B({success:function(R){C.copy(R,M);M.setPrompts(M.getDataService().getPrompts());},prompts:D.call(M)},Q);I.call(this,"execute",[O,M.newCallback(C.copy({method:"execute"},L)),N]);},open:function F(M,N){var L=this;if(M.data){C.copy(M.data,L);}if(N.success){N.success(L);}if(N.complete){N.complete(L);}},answerPrompts:function H(L){I.call(this,"answerPrompts",[this.prompts,G.call(this,L)]);},linkToObject:function A(O,P){var M=this,L=B({prompts:D.call(this)},P),N=L.success;L.success=function(Q){C.copy(Q,M);M.setPrompts(M.getDataService().getPrompts());M.gbElements=O.groupByElements;N(Q);delete M.gbElements;};I.call(this,"linkToObject",[O,L]);},getPageByTree:function K(L){this.getDataService().getPageByTree(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.mstr.EnumFunction","mstrmojo.mstr.EnumWebFunctionType","mstrmojo.mstr.EnumExpressionType","mstrmojo.mstr.EnumNodeType","mstrmojo.mstr.EnumDataType","mstrmojo.mstr.WebOperatorNode","mstrmojo.mstr.WebFormShortcutNode","mstrmojo.mstr.WebConstantNode","mstrmojo.mstr.WebTimeNode");var D=mstrmojo.mstr.EnumFunction,F=mstrmojo.mstr.EnumWebFunctionType,J=mstrmojo.mstr.EnumExpressionType,H=mstrmojo.mstr.EnumNodeType,G=mstrmojo.mstr.EnumDataType;mstrmojo.mstr.WebExpression=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.mstr.WebExpression",rottNode:null,init:function(K){if(!K){K={};}if(!K.rootNode){K.rootNode=new mstrmojo.mstr.WebOperatorNode({exprType:J.FilterBranchQual,funcType:F.WebFunctionTypeGeneric,func:D.FunctionAnd});}if(this._super){this._super(K);}},createOperatorNode:function C(K,N,L){if(!L){L=this.rootNode;}var M=new mstrmojo.mstr.WebOperatorNode({exprType:K});M.set("func",N);L.appendChild(M);return M;},createFormShortcutNode:function A(K,N,L){if(!L){L=this.rootNode;}var M=new mstrmojo.mstr.WebFormShortcutNode({attribute:K,form:N});L.appendChild(M);return M;},createValueNode:function B(N,K,L){var M=null;switch(K){case G.DataTypeDate:case G.DataTypeTime:case G.DataTypeTimeStamp:return this.createTimeNode(N,L);default:return this.createConstantNode(N,K,L);}},createConstantNode:function I(N,K,L){if(!L){L=this.rootNode;}var M=new mstrmojo.mstr.WebConstantNode({value:N,type:K});L.appendChild(M);return M;},createTimeNode:function(M,K){var L=new mstrmojo.mstr.WebTimeNode({value:M});if(!K){K=this.rootNode;}K.appendChild(L);return L;},newAQSubExpression:function(K,O,N,M,Q){if(N<0){N=D.FunctionEquals;}var L=this.createOperatorNode(J.FilterSingleBaseFormQual,N),P=this.createFormShortcutNode(K,O,L),R=this.createValueNode(Q,M,L);return L;},buildShortXML:function E(L){L.addChild("exp");var K=this.rootNode;if(K){if(K.exprType==J.FilterBranchQual&&K.nodeType==H.NodeOperator){if(!K.childNodes||!K.childNodes.length){}else{if(K.childNodes.length==1){if(K.func==D.FunctionAnd||K.func==D.FunctionOr){K.childNodes[0].buildShortXML(L);}else{K.buildShortXML(L);}}else{K.buildShortXML(L);}}}else{K.buildShortXML(L);}}L.closeElement();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.array","mstrmojo.dom","mstrmojo.css");var R=mstrmojo.array,U=mstrmojo.css,M=mstrmojo.dom,O=1,J="selected",H="d",L="m",E="y";function V(a,f,W,g){var Z,b=this.selected=this.selected||[],X;for(Z=0;Z<b.length;Z++){X=b[Z];if(X.day===f&&X.month===W&&X.year===g){b.splice(Z,1);return false;}}var Y={node:a,day:f,month:W,year:g};Y.n=mstrmojo.date.formatDateInfo(Y,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);b.push(Y);return true;}function I(W){this.contentNode.innerHTML=this.markupBuilder.getContentHTML({m:0,y:W},{m:11,y:W},{incl:false});}function F(W,Z){var X=this.contentNode.children,Y;R.forEach(W||this.selected,function(a){if(a&&a.year===this.current.y){var b=new Date(a.year,a.month-O,1);R.forEach(X,function(d){if(parseInt(d.getAttribute(L),10)===a.month){U.toggleClass(d.getElementsByClassName("mstrmojo-CalendarMV-DatesList")[0].children[a.day+(b.getDay())-1],J,Z);return false;}});}Y=undefined;},this);}function G(W,Z){var b=this.MONTH_CACHE,a=b[parseInt(W,10)],Y=b[parseInt(Z,10)],X="selectedMonth";if(Z!==undefined){U.toggleClass(Y.node,X,false);}U.toggleClass(a.node,X,true);if(this._scroller){this._scroller.scrollTo(0,a.top,200);}if(!(mstrApp.isTablet()&&mstrApp.isLandscape())){this.headerNode.innerHTML=this.markupBuilder.getHeaderHTML(W,this.current.y);}}function K(k,j){I.call(this,this.current.y);this.updateScroller();var b=0,f=parseInt(this.height,10)-this.headerNode.clientHeight,d=this.contentNode,g=d.offsetTop,X=d.children,Z=this.selected,o=R.find(Z,"year",k),a=o!==-1,l=this.MONTH_CACHE=[{}];for(b=0;b<X.length-1;b++){var Y=X[b],W=Y.clientHeight;l.push({node:Y,top:Y.offsetTop-g-(f-W)/2,height:W});}this._scroller.scrollTo(0,0);G.call(this,j||(a&&Z[o].month)||O);this.selectItems();}mstrmojo.android.ui.CalendarMonthView=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.ui.CalendarMonthView",config:undefined,markupString:'<div id="{@id}" class="mstrmojo-Calendar-MonthView"><div class="mstrmojo-CalendarMV-Header"></div><div class="mstrmojo-CalendarMV-Content"><div></div></div></div>',markupSlots:{headerNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild.lastChild;}},range:undefined,selected:undefined,multiSelect:true,current:undefined,scrollerConfig:{bounces:false,showScrollbars:false,showIndicators:false},postCreate:function B(){if(this._super){this._super();}var X=this,a=this.initialYear,W=this.initialMonth;if(isNaN(W)||isNaN(a)){throw new Error(mstrmojo.desc(96,"Error"));}this.current=new mstrmojo.Obj({m:W,y:a,onyChange:function Z(){K.call(X,this.y);},_set_m:function Y(f,d){var b=this.m;this.m=d;G.call(X,this.m,b);}});},postBuildRendering:function Q(){var W=this.markupBuilder,X=this.current;this._super();this.headerNode.innerHTML=W.getHeaderHTML(X.m,X.y);K.call(this,X.y,X.m);this._scroller.attachEventListener("scrollDone",this.id,function(Z){var h=this.MONTH_CACHE,Y=Math.abs,f=Z.y,g,d,b,a;for(a=1;a<h.length-1;a++){g=h[a].top;d=h[a+1].top;if((g<=f)&&(f<=d)){b=a+((Y(d-f)<Y(g-f))?1:0);break;}}this.current.set("m",b);});},touchTap:function P(b){var X=M.findAncestorByAttr(b.target,L,true,this.domNode);if(X){var Y=b.target,Z=parseInt(Y.getAttribute(H),10),W=parseInt(X.value,10),a=parseInt(X.node.getAttribute(E),10);if(!isNaN(Z)){if(this.singleSelect){R.forEach(this.selected,function(d){U.toggleClass(d.node,J,false);});this.selected=[];}U.toggleClass(Y,J,V.call(this,Y,Z,W,a));this.raiseEvent({name:"selectionChanged",items:this.selected});}if(!isNaN(W)){this.current.set("m",W);}}return false;},selectItems:function T(W){F.call(this,W,true);},unselectItems:function C(W){F.call(this,W,false);},touchSelectBegin:function A(W){},touchSelectMove:function D(W){},touchSelectEnd:function P(W){},updateScrollerConfig:function N(){var W=this._super(),a=this.contentNode,Y=parseInt(this.height,10);if(isNaN(Y)){Y=this.domNode.clientHeight;}W.scrollEl=a;W.noHScroll=true;W.origin=W.origin||{x:0,y:0};var Z=W.offsetIdx;if(Z){delete W.offsetIdx;W.origin.y=this.getItemOffset(Z);}var b=Math.max(a.clientHeight+this.headerNode.clientHeight-Y,0);var X=W.vScroll=b!==0;if(X){W.offset={y:{start:0,end:b}};}else{W.offset=null;}return W;},destroy:function S(){if(this.current){this.current.destroy();delete this.current;}delete this.MONTH_CACHE;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._HasTouchScroller","mstrmojo._TouchGestures","mstrmojo.hash");mstrmojo.android.HTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._HasTouchScroller,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.HTMLContainer",markupString:'<div id="{@id}" class="mstrmojo-HTMLContainer {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div>{@v}</div></div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","F","P","background-color","fx","text-align","white-space"]},update:function update(node){var d=node.data,v=d.v||"";var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value+"&nbsp;";div=null;this.v=v;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.scrollerConfig={bounces:false,showScrollbars:false};},postBuildRendering:function postBuildRendering(){var scripts=this.domNode.getElementsByTagName("script"),len=scripts.length,i;for(i=0;i<len;i++){eval(scripts[i].innerHTML);}return this._super();},updateScrollerConfig:function updateScrollerConfig(){var cfg=this._super(),scrollEl=this.valueNode,domNode=this.domNode,fmts=this.getFormats(),iterator={Height:{a:"y",s:"v"},Width:{a:"x",s:"h"}},offset={};cfg.scrollEl=scrollEl;mstrmojo.hash.forEach(iterator,function(info,dimension){if(cfg["no"+info.s.toUpperCase()+"Scroll"]){return ;}var widgetSize=parseInt(fmts[dimension.toLowerCase()],10);if(isNaN(widgetSize)){widgetSize=domNode["client"+dimension];}var offsetEnd=Math.max(scrollEl["offset"+dimension]-widgetSize,0),enableDimensionScroll=cfg[info.s+"Scroll"]=(offsetEnd!==0);if(enableDimensionScroll){offset[info.a]={start:0,end:offsetEnd};}});cfg.offset=offset;cfg.origin=cfg.origin||{x:0,y:0};return cfg;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.VisHeatMapColorTheme","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.dom","mstrmojo.css");var STEP_X=1200,STEP_Y=800;var LABEL={ON:0,OFF:1,PROPORTIONAL:2};var FMT={LABEL_CTNR_THRES:6,LABEL_CTNR_WIDTH_THRES:32,LGD_GUTTER:5,LABEL_PADDING:2};var CSSATTR={"heatmap-one-level-1":{},"heatmap-two-level-2":{},"heatmap-multi-level-1":{},"heatmap-multi-level-2":{},"heatmap-multi-level-3":{},init:false};function getCSSColor(rgb){var c=16777216+rgb;var str="#"+c.toString(16).substring(1).toUpperCase();return str;}function wfs(root,f){var arr=[root];while(arr.length!==0){var node=arr.shift();if(node===undefined||node.deleted){continue;}f(node);var children=node.entityChildren;if(children!==undefined){var l=children.length;for(var i=0;i<l;i++){arr.push(children[i]);}}}}function dfs(root,f,indexString){if(root.deleted){return ;}if(indexString===undefined){f(root);}else{f(root,indexString);}if(root.entityChildren===undefined){return ;}var arr=root.entityChildren,l=arr.length;for(var i=0;i<l;i++){var e=arr[i];if(indexString===undefined){dfs(e,f);}else{var param=indexString;if(!param){param=i.toString();}else{param=param+":"+i;}dfs(e,f,param);}}}function getLabelCSS(l,n){var css;if(n===1){if(l===0){css="heatmap-one-level-1";}}else{if(n===2){if(l===0){css="heatmap-multi-level-1";}else{if(l===1){css="heatmap-two-level-2";}}}else{if(n>=3){if(l===0){css="heatmap-multi-level-1";}else{if(l===1){css="heatmap-multi-level-2";}else{if(l===2){css="heatmap-multi-level-3";}}}}}}return css;}function intersect(lhs,rhs){if(!lhs||!rhs){return false;}if(rhs.x>=lhs.x+lhs.w||rhs.y>=lhs.y+lhs.h||rhs.x+rhs.w<=lhs.x||rhs.y+rhs.h<=lhs.y){return false;}else{return true;}}function rectIntersection(a,b){var x=Math.max(a.x,b.x);var y=Math.max(a.y,b.y);var w=Math.min(a.x+a.w,b.x+b.w)-x;var h=Math.min(a.y+a.h,b.y+b.h)-y;if(w<0||h<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:x,y:y,w:w,h:h};}mstrmojo.VisHeatMapCanvas=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.VisHeatMapCanvas",parent:null,root:null,colorTheme:null,attributes:[],scale:1,labelSetting:0,showMetric:false,bgColor:"#333333",numImages:0,offsetX:0,offsetY:0,markupString:'<div style="position:absolute; width:{@width}px; height:{@height}px"><canvas width={@width} height={@height} style="visibility: hidden; z-index:0"></canvas><span></span></div>',markupSlots:{domCanvas:function(){return this.domNode.firstChild;},domSpan:function(){return this.domNode.childNodes[1];},domImage:function(){return this.domNode.childNodes[2];}},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res=eval(s);return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},postBuildRendering:function(){this.initCSSATTR();this.draw();if(this._super){this._super();}},removeImageAndLabels:function(){var dom=this.domNode,labels=dom.childNodes,n=labels.length;for(var i=n-1;i>1;i--){var node=labels[i];dom.removeChild(node);}this.numImages=0;},removeLabels:function(){var dom=this.domNode,labels=dom.childNodes,n=labels.length,stop=1+this.numImages;for(var i=n-1;i>stop;i--){var node=labels[i];dom.removeChild(node);}},updateOffsets:function(x,y){this.offsetX=x;this.offsetY=y;this.removeLabels();this.drawLabels();},draw:function(x,y){if(x!==undefined){this.offsetX=x;}if(y!==undefined){this.offsetY=y;}this.removeImageAndLabels();this.drawRects();this.drawLabels();},drawRects:function(){var w=this.width,h=this.height,k=this.scale,cw=Math.ceil(w*k),ch=Math.ceil(h*k),cvs=this.domCanvas,dom=this.domNode,fragment=document.createDocumentFragment(),row=Math.ceil(ch/STEP_Y),col=Math.ceil(cw/STEP_X),count=0;for(var i=0;i<row;i++){for(var j=0;j<col;j++){var window={x:j*STEP_X,y:i*STEP_Y,w:STEP_X,h:STEP_Y};if(i+1===row){window.h=ch-window.y;}if(j+1===col){window.w=cw-window.x;}cvs.setAttribute("width",window.w);cvs.setAttribute("height",window.h);var cxt=cvs.getContext("2d");cxt.fillStyle=this.bgColor;cxt.fillRect(0,0,window.w,window.h);var drawPiece=function(e,idx){var rect=e.size;if(e.entityChildren===undefined&&!e.deleted&&intersect(window,rect)){var x1=Math.max(rect.x-window.x,0),y1=Math.max(rect.y-window.y,0),x2=Math.min(rect.x+rect.w-window.x,window.w),y2=Math.min(rect.y+rect.h-window.y,window.h);cxt.fillStyle=e.color;cxt.fillRect(x1,y1,x2-x1,y2-y1);}e.idx=idx;};dfs(this.root,drawPiece,"");var res=cvs.toDataURL();var img=document.createElement("img");img.src=res;img.style.position="absolute";img.style.left=window.x+"px";img.style.top=window.y+"px";img.setAttribute("draggable","false");img.setAttribute("orgx",window.x);img.setAttribute("orgy",window.y);fragment.appendChild(img);count++;}}cvs.setAttribute("width",0);cvs.setAttribute("height",0);dom.style.width=cw+"px";dom.style.height=ch+"px";dom.appendChild(fragment);this.numImages=count;},drawLabels:function(){var l=this.attributes.length,that=this,dom=this.domNode,gut=FMT.LGD_GUTTER,padding=FMT.LABEL_PADDING,window={x:this.offsetX,y:this.offsetY,w:this.width,h:this.height};var caches=[],layout=[{},{},{}];var ext=Math.floor(Math.log(this.scale)/Math.log(2));ext=Math.min(ext,l-3);ext=Math.max(ext,0);this._ext=ext;var drawText=function(e){if(e===that.root||e.deleted){return ;}var rect=e.size,w=rect&&rect.w,h=rect&&rect.h;if(!intersect(window,rect)){return ;}if(w<FMT.LABEL_CTNR_WIDTH_THRES+2*FMT.LABEL_PADDING||h<FMT.LABEL_CTNR_THRES){return ;}var str=e.text,idx=e.idx,level=e.level-ext;if(level>=0&&level<3){var tw,th,labelCSS=getLabelCSS(level,l),font=CSSATTR[labelCSS].font,fontSize=CSSATTR[labelCSS].fontSize,o={s:{},e:e,m:0,css:labelCSS};if(that.showMetric===true&&e.entityChildren===undefined){var loc={};mstrmojo.hash.copy(rect,loc);if(l>1&&level===0){loc.w-=2*gut;loc.h-=gut;}else{loc.w-=2*padding;}var lh,txtS;if(that.labelSetting===LABEL.PROPORTIONAL){lh=9;var step=8,shrink=false,txtS=that.getTextSize(str,font,lh,true,false,loc.w);while(step>=1){if(txtS.h<loc.h){lh+=step;}else{if(lh===9){break;}if(lh>=loc.w){break;}if(!shrink){step/=2;}shrink=true;lh-=step;}txtS=that.getTextSize(str,font,lh,true,false,loc.w);if(shrink){step=step>>1;}}if(txtS.h>loc.h&&lh>9){lh--;}if(lh>loc.w){lh=loc.w;}o.fs=lh;}else{lh=fontSize;}o.lh=lh;txtS=that.getTextSize(str,font,lh,true,false,loc.w);tw=Math.min(txtS.w,loc.w);th=txtS.h;if(th>loc.h){th=Math.floor(loc.h/lh)*lh;}}else{if(caches[level]===undefined){caches[level]={};}var cache=caches[level];if(cache[str]===undefined){var txtS=that.getTextSize(str,font,fontSize,true),tw=txtS.w,th=txtS.h;if(l>1&&level===0){tw+=2*gut;th+=gut;}cache[str]={w:tw,h:th};}else{tw=cache[str].w;th=cache[str].h;}if(th>h){return ;}o.lh=th;var p;if(l>1&&level===0){p=2*gut;}else{p=2*padding;}if(tw>w-p){var trunw=tw>>1,lineCount=Math.floor(h/o.lh);if(trunw>(w-p)*lineCount){return ;}tw=w-p;if((l==1&&level==0)||(l==2&&level==1)||(l>2&&level==2)){var ts=that.getTextSize(str,font,fontSize,true,false,w-p,true);th*=Math.floor(Math.min(ts.h,h)/o.lh);o.isLowestLevel=true;}}}var x=rect.x+((w-tw)>>1),y=rect.y+((h-th)>>1);o.s={x:x,y:y,w:tw,h:th};layout[level][idx]=o;}};if(that.labelSetting!==LABEL.OFF){wfs(this.root,drawText);this.layoutLabels(layout);}},layoutLabels:function(layout){var that=this,doc=document,fragment=doc.createDocumentFragment();function generateLabel(o){var s=o.s,e=o.e,css=o.css,color=that.getLabelColor(s,e),hasM=o.fs!==undefined;var div=doc.createElement("div");if(hasM){div.setAttribute("style","font-size: "+o.fs+"px !important");div.className=css+" heatmap-showMetric-text";}else{div.className=css+" heatmap-trun-text";}div.style.position="absolute";div.style.color=color;div.style.backgroundColor="rgba(255, 255, 255, 0)";div.style.zIndex="1";div.style.left=s.x+"px";div.style.top=s.y+"px";div.style.width=s.w+"px";div.style.height=s.h+"px";div.style.lineHeight=o.lh+"px";if(o.isLowestLevel){div.style.textOverflow="ellipsis";div.style.wordBreak="normal";}div.setAttribute("idx",e.idx);div.innerHTML=e.text;fragment.appendChild(div);}var L0=layout[0],L1=layout[1],L2=layout[2],idx;for(idx in L1){var info=L1[idx],bbox=info.s,node=info.e,prt=node.parentEntity,pinfo=L0[prt.idx];if(pinfo===undefined){generateLabel(info);continue;}var pbox=pinfo.s,inter=rectIntersection(bbox,pbox);var rmIt=false;if(inter.w>5||inter.h>5){if(pbox.y<=bbox.y){var delta=((pbox.y+pbox.h-bbox.y)>>1)+1;if(pinfo.m!==2&&(pbox.y-delta>=prt.size.y)&&(bbox.y+bbox.h+delta<=node.size.y+node.size.h)){pbox.y-=delta;bbox.y+=delta;pinfo.m=1;}else{rmIt=true;}}else{var delta=((bbox.y+bbox.h-pbox.y)>>1)+1;if(pinfo.m!==1&&(pbox.y+pbox.h+delta<=prt.size.y+prt.size.h)&&(bbox.y-delta>=node.size.y)){pbox.y+=delta;bbox.y-=delta;pinfo.m=2;}else{rmIt=true;}}}if(rmIt!==true){generateLabel(info);}}for(idx in L0){generateLabel(L0[idx]);}for(idx in L2){rmIt=false;var info2=L2[idx],node2=info2.e,node1=node2.parentEntity,node0=node1.parentEntity,idx1=node1.idx,idx0=node0.idx,info1=L1[idx1],info0=L0[idx0];if(info1!==undefined){var inter12=rectIntersection(info1.s,info2.s);if(!isNaN(inter12.w)){rmIt=true;}}if(rmIt===false&&info0!==undefined){var inter02=rectIntersection(info0.s,info2.s);if(!isNaN(inter02.w)){rmIt=true;}}if(rmIt!==true){generateLabel(info2);}}this.domNode.appendChild(fragment);},getLabelColor:function(s,e){var level=e.level-this._ext;if(level===0){return"#FFFFFF";}var ct=this.colorTheme;if(e.entityChildren===undefined){return getCSSColor(ct.getContrastColor(parseInt(e.color.substring(1,e.color.length),16)));}var stack=[e],ls=0,ds=0;while(stack.length!==0){var node=stack.shift(),ch=node.entityChildren,n=node.entityChildren.length;for(var i=0;i<n;i++){var child=ch[i];if(child.deleted){continue;}var rect=rectIntersection(s,child.size);if(child.entityChildren===undefined){if(!isNaN(rect.w)){if(ct.isBrightColor(parseInt(child.color.substring(1,child.color.length),16))){ls+=rect.w*rect.h;}else{ds+=rect.w*rect.h;}}}else{if(!isNaN(rect.w)){stack.push(child);}}}}if(ls>ds){return"#000000";}else{if(level===1){return"#e6e7e8";}else{return"#d1d3d4";}}},getEntity:function(pos){var ox=pos.x,oy=pos.y,target;var hitTest=function(node){if(node.entityChildren===undefined&&!node.deleted&&node.size){var size=node.size,x1=size.x,y1=size.y,x2=x1+size.w,y2=y1+size.h;if(ox>=x1&&ox<=x2&&oy>=y1&&oy<=y2){target=node;}}};var dfsReturnOnFound=function(root,f){if(root.deleted){return ;}f(root);var arr=root.entityChildren;if(arr!==undefined){var l=arr.length;for(var i=0;i<l;i++){var e=arr[i];dfsReturnOnFound(e,f);if(target!==undefined){return ;}}}};dfsReturnOnFound(this.root,hitTest);return target;},initCSSATTR:function(){if(CSSATTR.init===false){var dom=this.domSpan;for(var css in CSSATTR){if(css==="init"){continue;}dom.setAttribute("class",css);var res=document.defaultView.getComputedStyle(dom);CSSATTR[css].fontSize=parseInt(res.fontSize);CSSATTR[css].font=res.fontFamily;}}},getTextSize:function(str,fontName,fontSize,isBold,isItalic,width,normalBreak){var dom=this.domSpan,breakMethod="break-all";if(normalBreak){breakMethod="normal";}dom.className="";dom.innerHTML=str;dom.style.cssText="position:absolute; visibility:hidden; z-index:-1; font-family:"+fontName+"; font-size:"+fontSize+"px; font-weight:"+(isBold?"bold":"normal")+"; font-style:"+(isItalic?"italic":"normal")+"; line-height:"+fontSize+"px;";var w=dom.offsetWidth;if(width!==undefined&&w>width){dom.style.cssText+="overflow:hidden; word-break:"+breakMethod+"; width:"+width+"px;";w=dom.offsetWidth;}return{w:w,h:dom.offsetHeight};}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasTouchScroller","mstrmojo.dom");var B=mstrmojo.dom;function A(G,E){var D=Math.max(G.x,E.x);var I=Math.max(G.y,E.y);var F=Math.min(G.x+G.w,E.x+E.w)-D;var H=Math.min(G.y+G.h,E.y+E.h)-I;if(F<0||H<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:D,y:I,w:F,h:H};}function C(D){return{x:D.x,y:D.y,w:D.w,h:D.h};}mstrmojo.SmoothScroll=mstrmojo.provide("mstrmojo.SmoothScroll",{viewRect:null,scrollerRect:null,unitRect:null,cachedUnits:[],demarcationUnits:{left:null,right:null,top:null,bottom:null},viewCutX:function(){},storeUnits:function(){this.cachedUnits=[];var G=C(this.unitRect),D=Math.ceil(this.scrollRect.h/G.h),E;for(E=0;E<D;E++,G.y+=G.h){var F=this.getUnitFromPoint(G.x+G.w/2,G.y+G.h/2);if(!F){continue;}this.cachedUnits.push(F);}},appendUnits:function(G,E){var I=this.cachedUnits,D;for(D=G;D<=E;D++){var F=I[D];if(!F){return ;}if(F.outside==true){F.outside=false;var H=F._parentNode,J=H.children;H.insertBefore(F,J[F._oldIndex]);H.style.paddingTop="";delete F._parentNode;delete F._oldIndex;}}console.log(E-G+1+" units added.");},removeUnits:function(G,E){var I=this.cachedUnits,D;for(D=G;D<=E;D++){var F=I[D];if(!F){return ;}if(F.outside!=true){var H=F.parentNode,J=H.children;F._parentNode=H;F._oldIndex=0;H.removeChild(F);H.style.paddingTop=this.unitRect.h+"px";F.outside=true;}}console.log(E-G+1+" units removed.");},viewCutY:function(K){if(!this.viewRect||!this.scrollRect||!this.unitRect){return ;}var G=K?K.y:this._scroller.origin.y,E=G+this.viewRect.h;if(!this._scroller||!this._scroller.scrollEl){console.log("no scrollEl.");return ;}var J=this._scroller.scrollEl;var H=Math.floor(G/this.unitRect.h),F=Math.floor(E/this.unitRect.h),I=this.cachedUnits,D=I.length;delta=0;this.removeUnits(0,H-1);this.appendUnits(H,F);this.removeUnits(F+1,D);delta=H;console.log("do viewCut.");},updateScroller:function(G,F){if(this._super){this._super(G,F);}var E=mstrmojo.dom.position;if(!this.unitRect||!this.unitRect.w||!this.unitRect.h){var D=this.cachedUnits[0];if(!D){return ;}this.unitRect=E(D);}if(this.viewNode){this.viewRect=E(this.viewNode);}this.scrollRect={x:this.unitRect.x,y:this.unitRect.y,w:this.unitRect.w,h:this.unitRect.h*this.cachedUnits.length};if(!this.viewRect||!this.scrollRect||!this.unitRect){return ;}this.viewCutY(this._scroller.origin);},getUnitFromPoint:function(D,J){var E=[],H=false;do{var I=document.elementFromPoint(D,J);if(I==G){break;}if(I.offsetHeight==this.unitRect.h&&I.offsetWidth==this.unitRect.w){H=true;}else{I.__metaDisplay=I.style.display;E.push(I);I.style.display="none";}var G=I;}while(!H&&I!=document.body);var F=I;while(E.length){var I=E.pop();I.style.display=I.__metaDisplay;delete I.__metaDisplay;}if(H){return F;}else{return null;}},postBuildRendering:function(D){if(this._super){this._super(D);}console.log("event binded!");this.smoothSwipeListener=this._scroller.attachEventListener("scrollMoved",this.id,this.viewCutY);},unrender:function(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.SmoothScroll","mstrmojo._HasTouchScroller");var C=16;var A={0:"&#9654;",1:"&#9660;",2:"&nbsp;"};var B=["heatmap-tree-state-text collapsed","heatmap-tree-state-text expanded","heatmap-tree-state-text leaf"];var D={NO:0,YES:1,PART:2};mstrmojo.VisHeatMapTreeItem=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VisHeatMapTreeItem",isRoot:false,showRoot:false,rootText:"",idx:0,buttonNodeCss:"heatmap-tree-checkbox",buttonNodeWidget:null,markupString:'<div id="{@id}" class="heatmap-tree" style="{@cssText}"><div class="heatmap-tree-div" idx="{@idx}"><div class="heatmap-tree-state"><div class="heatmap-tree-state space">&nbsp;</div><div class="heatmap-tree-state-text"></div></div><div class="heatmap-tree-text"></div><div class="{@buttonNodeCss}">&nbsp;</div></div><div class="heatmap-tree-container"></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild;},stateNode:function(){return this.domNode.firstChild.firstChild;},stateSpaceNode:function(){return this.domNode.firstChild.firstChild.firstChild;},stateTextNode:function(){return this.domNode.firstChild.firstChild.lastChild;},textNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];},containerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=this.text;},onstateChange:function(){this.stateTextNode.className=B[this.state];if(!this.isRoot){this.containerNode.style.display=(this.state===1)?"block":"none";if(this.state!=2){this.tree.resized();}}}},level:-1,tree:null,itemDisplayField:"n",itemChildrenField:"items",isSelectable:true,itemFunctionField:"itemFunction",itemIncludeFunction:function(){return true;},dataProvider:null,owner:null,fillData:function(){var M=this.tree||this;if(this.dataProvider){this.items=this.dataProvider[this.itemChildrenField];}var J=this.items;if(this.items&&this.items.length){this.childTree=[];var F=0;for(var G=0;G<J.length;G++){var L=J[G];if(this.itemIncludeFunction(L)){var K;if(M.owner){K=L.label;}else{K=L[this.itemDisplayField];}var I=new Date();var H=(new Date()).getTime();var E={idx:F,isRoot:false,text:K,itemFunction:L[this.itemFunctionField],buttonNodeWidget:L.buttonNodeWidget,tree:M,level:(this.level+1),itemDisplayField:this.itemDisplayField,itemChildrenField:this.itemChildrenField,parent:this,parentTree:this,state:0,isSelectable:this.isSelectable,itemIncludeFunction:this.itemIncludeFunction,buttonNodeCss:this.buttonNodeCss,fillData:this.fillData,buildTree:this.buildTree,setChildStatus:this.setChildStatus,updateSelection:this.updateSelection};if(this.dataProvider){E.dataProvider=L;}else{E.items=L[this.itemChildrenField];}this.childTree[F]=E;F++;}}}},renderChildrenList:function(){if(!this.childTree){return ;}var J=this.childTree.length,M,L;if(this.tree){L=this.tree.cachedUnits;M=L.indexOf(this.contentNode)+1;if(M==0){M=L.length;}}if(this.isRoot&&this.showScrollbars){M=0;L=this.cachedUnits;}for(var H=0;H<J;H++){if(this.childTree[H].domNode){this.tree.cachedUnits.splice(M,0,this.childTree[H].contentNode);M++;continue;}var E=document.createElement("div");this.containerNode.appendChild(E);this.childTree[H].placeholder=E;var I=new mstrmojo.VisHeatMapTreeItem(this.childTree[H]);if(!I){alert("new failed!");}I.childTree=this.childTree[H].childTree;if(I.childTree){var F=I.childTree,K=F.length;for(var G=0;G<K;G++){F[G].parent=I;F[G].parentTree=I;}}this.childTree[H]=I;this.childTree[H].render();if(!isNaN(M)){L.splice(M,0,this.childTree[H].contentNode);M++;}}},postBuildRendering:function(){if(this._super){this._super();}this.domNode.style.display="none";var E=this.tree||this;if(this.dataProvider){this.items=this.dataProvider[this.itemChildrenField];}if(this.isRoot){if(!this.showRoot){this.contentNode.style.display="none";}else{this.stateNode.style.display="none";this.textNode.innerHTML=this.rootText;}this.containerNode.className="heatmap-tree-container root";}else{if(this.buttonNodeWidget){this.buttonNodeWidget.placeholder=this.buttonNode;var G=mstrmojo.insert(this.buttonNodeWidget);G.render();this.buttonNode=G.domNode;}this.textNode.innerHTML=this.text;var F=(this.level+1)*C;this.stateSpaceNode.style.width=(F>=0?F:0)+"px";this.textNode.style.width=this.domNode.offsetWidth-this.stateNode.offsetWidth-this.buttonNode.offsetWidth-10+"px";}if(!(this.items&&this.items.length)){this.set("state",2);this.tree.sampleUnit=this.domNode;}else{this.set("state",0);}this.domNode.style.display="block";},buildTree:function(){this.fillData();if(this.childTree){var E=this.childTree.length;}for(var F=0;F<E;F++){this.childTree[F].buildTree();}},clickHandler:function(F){var H=F.target;if(this.state!==2&&mstrmojo.dom.contains(this.stateNode,H,true,this.domNode)){this.set("state",this.state===0?1:0);if(this.state==1){this.renderChildrenList();this.updateChildrenSelection();}else{var G=this.tree.cachedUnits.indexOf(this.contentNode);if(G!=-1){G++;var E=this.childTree.length;this.tree.cachedUnits.splice(G,E);}}this.tree.resized();this.tree.updateScroller();return ;}if(this.itemFunction){this.itemFunction(F);}if(!this.isSelectable){return ;}mstrmojo.VisHeatMapAnimation.animate(this.contentNode,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});if(this.selectionStatus===D.YES){this.selectionStatus=D.NO;}else{this.selectionStatus=D.YES;}this.setChildStatus(this.selectionStatus);this.updateSelection(false,true);},setChildStatus:function(E){if(this.childTree){for(var F=0;F<this.childTree.length;F++){var G=this.childTree[F];if(!G){continue;}G.selectionStatus=E;G.setChildStatus(E);G.updateSelection(false,false);}}},updateChildrenSelection:function(){if(!this.childTree){return ;}var E=this.childTree.length;for(var F=0;F<E;F++){if(this.childTree[F]){this.childTree[F].updateSelection(false,false);}}},updateSelection:function(K,J){if(K&&this.childTree){var G=true;var L=true;var F=false;for(var H=0;H<this.childTree.length;H++){var I=this.childTree[H];if(G&&I.selectionStatus!==D.YES){G=false;}if(L&&I.selectionStatus!==D.NO){L=false;}if(!G&&!L){F=true;break;}}this.selectionStatus=G?D.YES:(L?D.NO:D.PART);}var E="heatmap-tree-div";switch(this.selectionStatus){case D.YES:E+=" selected";break;case D.PART:E+=" partSelected";break;case D.NO:default:break;}this.cssName=E;if(this.contentNode){this.contentNode.className=E;}if(J&&this.parentTree){this.parentTree.updateSelection(true,true);}if(this.isRoot){this.notifyAll();}},resized:function(){if(this.parent.resized){this.parent.resized(this.domNode.offsetHeight);}},selectionStatus:D.NO});mstrmojo.VisHeatMapTree=mstrmojo.declare(mstrmojo.VisHeatMapTreeItem,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo.SmoothScroll],{scriptClass:"mstrmojo.VisHeatMapTree",isRoot:true,showRoot:false,rootText:"",heightLimit:0,defaultSelectionStatus:D.NO,markupString:'<div id="{@id}" class="heatmap-tree root {@cssClass}" style="{@cssText} mstrAttach:mousedown,mousemove,mouseup,click"><div class="heatmap-tree-div" style="line-height:40px;" idx="{@idx}"><div class="heatmap-tree-state" style="display:none;"><div class="heatmap-tree-state space">&nbsp;</div><div class="heatmap-tree-state-text"></div></div><div class="heatmap-tree-text"></div><div class="{@buttonNodeCss}">&nbsp;</div></div><div style="overflow:hidden; position:relative"><div class="heatmap-tree-container"></div></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild;},stateNode:function(){return this.domNode.firstChild.firstChild;},stateSpaceNode:function(){return this.domNode.firstChild.firstChild.firstChild;},stateTextNode:function(){return this.domNode.firstChild.firstChild.lastChild;},textNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];},scrollboxNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild.firstChild;}},initialized:false,dirty:false,showIndicators:false,showScrollbars:false,cachedUnits:[],init:function(E){this._super(E);this.observer=[];},register:function(E){this.observer.push(E);this.notifyAll();},notifyAll:function(){var F=false;if(this.childTree&&this.childTree.length>0){F=true;}if(F){mstrmojo.css.removeClass(this.contentNode,"disabled");}else{mstrmojo.css.addClass(this.contentNode,"disabled");}if(this.selectionStatus===D.NO){F=false;}for(var E in this.observer){this.observer[E].notify(F);}},buildRendering:function(){if(this.isRoot){this.cachedParent=this.parent;delete this.parent;}if(this._super){this._super();}},postBuildRendering:function(){var F=(new Date()).getTime();if(this.isRoot){this.scrollerConfig={bounces:false,showIndicators:this.showIndicators,showScrollbars:this.showScrollbars,useTranslate3d:true,vScroll:true,hScroll:false,offset:{y:{start:0,end:0},x:{start:0,end:0}},origin:{x:0,y:0},scrollEl:this.containerNode};}this._super();this.buildTree();this.renderChildrenList();if(this.isRoot){this.parent=this.cachedParent;this.parent.containerNode.appendChild(this.domNode);}if(this.heightLimit>0){var E=this.heightLimit-this.contentNode.offsetHeight-2;if(E>=0){this.scrollboxNode.style.maxHeight=E+"px";}}this.selectionStatus=this.defaultSelectionStatus;this.setChildStatus(this.selectionStatus);this.updateSelection(false,true);this.viewNode=this.scrollboxNode;this.notifyAll();this.resized();this.updateScroller();},touchTap:function(F){var G=mstrmojo.dom.findAncestorByAttr(F.target,"id",true,this.domNode);if(!G){this.clickHandler(F);return ;}var E=mstrmojo.all[G.value];if(E&&E.clickHandler){E.clickHandler(F);}},resized:function(E){var F=mstrmojo.dom.position;if(!this.viewRect){this.viewRect=F(this.scrollboxNode,true);}if(!(this.heightLimit>0)){return ;}if(!this._scroller.offset){return ;}E=E||this.containerNode.offsetHeight;if(E>this.scrollboxNode.clientHeight){this._scroller.offset.y.end=E-this.scrollboxNode.clientHeight;}else{this._scroller.offset.y.end=0;this._scroller.scrollTo(0,0,0);}},refresh:function(){if(this.needRefresh){this.containerNode.innerHTML="";this.postBuildRendering();this.resized();this.updateScroller();this.needRefresh=false;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._TouchGestures","mstrmojo.android.ui.CalendarMonthView","mstrmojo.android.ui.CalendarYearList");var H=mstrmojo.hash,E=mstrmojo.array,C=mstrmojo.desc(2827,"Clear"),A=mstrmojo.desc(221,"Cancel");mstrmojo.android.ui.Calendar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._TouchGestures,mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.Calendar",config:undefined,markupString:'<div id="{@id}" class="mstrmojo-android-Calendar"><div class="mstrmojo-Calendar-Year"></div><hr class="mstrmojo-Calendar-Sep"/><div class="mstrmojo-Calendar-Month"></div></div>',markupSlots:{yearNode:function(){return this.domNode.firstChild;},monthNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},cssDisplay:"",isMultiSelect:false,selectedDates:undefined,min:undefined,max:undefined,init:function G(O){var J=new Date(),M=this.children[0],R=this.children[1],L=O.min=O.min||{},P=O.max=O.max||{},K=O.selectedDates=O.selectedDates||[],Q=K[0]||{},N,I;E.forEach([Q,L],function(S){if(!isNaN(S.year)&&!isNaN(S.month)){N=S.year;I=S.month;return false;}});I=!isNaN(I)?I:(J.getMonth()+1);N=!isNaN(N)?N:J.getFullYear();H.copy({initialYear:N,initialMonth:I,multiSelect:!!this.isMultiSelect,selected:K,range:{start:L,end:P}},R);H.copy({initialYear:N,start:L.year,end:P.year},M);this._super(O);},postBuildRendering:function D(){this.monthWidget.markupBuilder=this.markupBuilder;this._super();var I=this.target;I.set("items",this.selectedDates);I.selectItems(I.items);this.yearWidget.attachEventListener("yearChanged",this.monthWidget.id,function(J){this.current.set("y",J.value);});this.monthWidget.attachEventListener("selectionChanged",this.id,function(J){this.syncListItemsWithSelections([].concat(J.items));});this.target.attachEventListener("selectionChange",this.id,function(K){var P=this.target,J=P.items,N=this.monthWidget,M=E.get(J,K.added),O=E.get(J,K.removed);if(M&&M.length>0){N.selectItems(M);}else{var L;if((O&&O.length>0)&&(J&&J.length>0)){L=O;}N.unselectItems(L);}if(P.parent){P.parent.btnHbox.children[0].set("text",((P.getSelectedItems().length>0)?C:A));}N.selected=P.getSelectedItems();});},syncListItemsWithSelections:function F(I){var J=this.target;J.glow=false;J.set("items",I);J.selectItems(I);if(J.parent){J.parent.btnHbox.children[0].set("text",((J.getSelectedItems().length>0)?C:A));J.parent.resizeDialog();}J.glow=true;},getSelectedDates:function B(J){var I=[];E.forEach(this.target.getSelectedItems(),function(K){I.push(K.n);});return I;},children:[{scriptClass:"mstrmojo.android.ui.CalendarYearList",alias:"yearWidget",slot:"yearNode"},{scriptClass:"mstrmojo.android.ui.CalendarMonthView",alias:"monthWidget",slot:"monthNode"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompt","mstrmojo.array","mstrmojo.mstr.EnumDataType","mstrmojo.mstr.WebAttribute","mstrmojo.mstr.WebElements","mstrmojo.mstr.WebAttributeForm","mstrmojo.mstr.WebExpression","mstrmojo.mstr.WebFilter");mstrmojo.requiresDescs(8407,8408,8759);var R=mstrmojo.array.forEach;var P=mstrmojo.prompt.WebPrompt.STYLES;var O={0:"country",1:"administrative_area_level_1",2:"locality",3:"postal_code"};function J(Y,b){Y=Y||[];var X=(b&&b.prs&&b.prs.GeographicMapping)||0,Z=O[X],a=false,W="";R(Y,function(d){R(d.address_components,function(f){R(f.types,function(g){if(g===Z){W=f.short_name;a=true;return false;}});if(a){return false;}});if(a){return false;}});return W;}var T=mstrmojo.mstr.EnumFunction,L=mstrmojo.mstr.EnumDataType;function S(f){var X=this.dateAnswer,d=X&&X.length,b=1;if(d){var Y=new mstrmojo.mstr.WebAttributeForm({did:this.origin.dateFormID}),h=new mstrmojo.mstr.WebExpression(),Z=new mstrmojo.mstr.WebFilter({expression:h}),a=h.newAQSubExpression(this.origin,Y,T.FunctionIn,L.DataTypeDate,X[0]);for(;b<d;b++){h.createTimeNode(X[b],a);}var W=this.origin.getElements({shortFilterXML:Z.getXML(),blockBegin:1,blockCount:-1});var g=this,j=f.success;f.success=function(){g.dateAnswer=null;g.answer.set("items",W.items);if(!W.items.length&&f.failure){f.failure(mstrmojo.desc(8759,"No data found for the selected date(s)."));}else{j();}};W.getItems(0,f);}else{this.answer.set("items",[]);this.dateAnswer=null;f.success();}}mstrmojo.prompt.WebElementsPrompt=mstrmojo.declare(mstrmojo.prompt.WebPrompt,null,{scriptClass:"mstrmojo.prompt.WebElementsPrompt",answer:"",preAnswer:"",defAnswer:"",suggestion:null,origin:null,filter:null,dateAnswer:null,getStyle:function D(){var W=this._style;if(!W){var X=this.prs;if(X.DisplayStyle==="Calendar"&&!!this.origin.dateFormID){W=P.CALENDAR;}else{W=P.LIST;}this._style=W;}return W;},syncDateAnswer:function B(W){if(this.dateAnswer){S.call(this,W);}else{W.success();}},validate:function N(X){this._super(X);X=(X===undefined||X===null)?(this.answer&&this.answer.items):X;var Z=(X&&X.length)||0,Y=parseInt(this.min,10),W=parseInt(this.max,10),a="";if(!isNaN(Y)&&Z<Y){a=mstrmojo.desc(8407,"You have made (#) selections, which is fewer selections than the required (##) for this prompt. Please make more selections.").replace("##",Y).replace("#",Z);}else{if(!isNaN(W)&&Z>W){a=mstrmojo.desc(8408,"You have made (#) selections, which is more selections than are allowed (##) for this prompt. Please remove some selections.").replace("##",W).replace("#",Z);}}if(a){throw new Error(a);}},isAnswerEmpty:function C(W){W=(W===undefined||W===null)?(this.answer&&this.answer.items):W;return(!W)||(W.length==0);},getAvailable:function V(){var W;if(this.suggestion&&this.suggestion.items.length>0){W=this.suggestion;}else{W=this.origin.getElements();}return W;},canSearch:function U(){return !(this.suggestion&&this.suggestion.items.length>0);},getDisplayValue:function F(){if(this.getStyle()==mstrmojo.prompt.WebPrompt.STYLES.CALENDAR&&this.dateAnswer){return this.dateAnswer.join(",");}else{var a=this.answer,X=(a&&a.items)||[],Y=0,W=X.length,Z=[];for(;Y<W;Y++){Z.push(X[Y].n);}return Z.join(", ");}},getAnswerAsDateArray:function(){var W=mstrmojo.date,a=[],Y,X,b=this.dateAnswer,Z=this.answer&&this.answer.items;if(this.getStyle()==mstrmojo.prompt.WebPrompt.STYLES.CALENDAR){if(b){for(Y=0;Y<b.length;Y++){X=W.parseDate(b[Y]);X.n=X.match;a.push(X);}}else{if(Z){for(Y=0;Y<Z.length;Y++){X=W.parseDate(Z[Y].n);X.n=X.match;a.push(X);}}}}return a;},getSearch:function K(Z,Y,W){var X={searchPattern:Z,matchCase:Y};if(W){X.searchTarget=this.searchTarget;}return this.origin.getElements(X);},populate:function G(b){this._super(b);var Z=(b&&b.ans&&b.ans.elms)||[];this.answer=new mstrmojo.mstr.WebElements({items:Z,totalSize:Z.length,blockBegin:1,blockCount:-1});var f=b&&b.orgn;if(f){this.origin=new mstrmojo.mstr.WebAttribute(f);if(this.dataSourcesXML){this.origin.browseConfig.dataSources=this.dataSourcesXML;}var a=this.prs;if(a&&a.DisplayStyle==="GeoLocation"&&a.LookupForm){var Y=a.LookupForm.split("~");this.searchTarget=new mstrmojo.mstr.WebAttribute({did:Y[0],t:Y[1],st:Y[3],n:Y[2]});}this.answer.source=this.origin;}var d=b&&b.suggest;if(d){var X=this.suggestion=new mstrmojo.mstr.WebElements({items:d});}var W=b&&b.fres;if(W){this.filter=new mstrmojo.mstr.WebOI(W);if(f){this.origin.browseConfig.filter=this.filter;}}},populateAnswer:function(W){this.answer.items=mstrmojo.hash.cloneArray(W.ans.elms);},buildAnswerObject:function M(){var W=this._super();W.ans={elms:mstrmojo.hash.cloneArray(this.answer.items)};return W;},prepareAnswer:function I(W){this.syncDateAnswer(W);},setAnswerValue:function A(W){this.validate(W);if(this.getStyle()==mstrmojo.prompt.WebPrompt.STYLES.CALENDAR){this.set("dateAnswer",W);}else{this.answer.set("items",W);}},getAnswersCount:function H(){if(this.dateAnswer){return this.dateAnswer.length;}else{if(this.answer){return this.answer.items.length;}}return 0;},buildShortAnswerXML:function E(W){if(this.dateAnswer){alert("need to sync date answers first.");}else{if(this.answer){this.answer.buildShortXML(W);}}},getGeoTargetValue:function Q(X){var W=this;mstrmojo.GeoLocation.getCurrentAddress({success:function(Y){var Z=J(Y,W);if(X&&X.success){X.success(Z);}},failure:function(Y){if(X&&X.failure){X.failure(Y);}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.array","mstrmojo.func");var H=2;var G=1,B=2;mstrmojo.DocVisModel=mstrmojo.declare(mstrmojo.DocXtabModel,null,{scriptClass:"mstrmojo.DocVisModel",getAction:function F(K){var I=K[0],J=I&&I.at;var L;if(J){if(J&H){L={h:"onVisSelector",a:this.getSelectAction(I)};}}if(!L){L=this.getActionObject(K);}return L;},getSelectAction:function D(N){var Q=N.scObjList,P=Q.length,J=null;if(P>1){J={multiSelect:true,type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,anchor:N.anchor,selectorObjects:[]};var I={};var M="";for(var L=0;L<P;L++){var R=Q[L];var S=R.sc.tks.split("\x1E");for(var K=0;K<S.length;K++){var O=S[K];if(!I[O]){I[O]=true;if(M.length>0){M=M+"\x1E"+O;}else{M=O;}}}}for(var L=0;L<P;L++){var R=Q[L];J.selectorObjects.push({ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid});}if(!J.tks){J.tks=M;}}else{if(P==1){var R=Q[0];J={type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid,anchor:N.anchor};}}return J;},getLinkAction:function E(J,I){var K=J.node,L=K&&K.titleInfo;return this.getLinkActionImpl(K,L,I);},getPCellParentNode:function A(J,I){return(I==G)?J._lp:J._tp;},getPTitle:function C(J,I){return J.titleInfo;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.array","mstrmojo.date","mstrmojo.Stepper","mstrmojo.android.ui.Button","mstrmojo.DateStepperContentProvider","mstrmojo.NumStepperContentProvider");var U=mstrmojo.array,Q=mstrmojo.date,L=mstrmojo.hash,R=mstrmojo.android.ui.Button.newButton,I=mstrmojo.expr.DTP,D={interval:1},G={min:1,max:12,interval:1,value:12},N={min:0,max:23,interval:1,value:0},E={min:0,max:59,interval:1};function C(){var W=this.dtp,Z=this.stepperClass,X=this[this.valueField],M=[],Y,H;if(this._hasDate){M.push({scriptClass:Z,slot:"monthNode",alias:"monthStepper",title:mstrmojo.desc(871),provider:this.dateProvider.monthCP},{scriptClass:Z,slot:"dayNode",alias:"dayStepper",title:mstrmojo.desc(872),provider:this.dateProvider.dayCP},{scriptClass:Z,slot:"yearNode",alias:"yearStepper",title:mstrmojo.desc(873),provider:this.dateProvider.yearCP});}if(this._hasTime){M.push({scriptClass:Z,slot:"hourNode",alias:"hourStepper",provider:this.hourProvider},{scriptClass:Z,slot:"minNode",alias:"minStepper",provider:this.minProvider});}if(!this.hideSwitchers){if(W!==I.TIME){Y=(X&&X.date)?Q.formatDateInfo(X.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT):mstrmojo.desc(2052);M.push(R(Y,function(){this.parent.toDateView();},{alias:"dateToggle",slot:"switcherNode",cssClass:"",selected:true}));}if(W!==I.DATE){H=(X&&X.time)?Q.formatTimeInfo(X.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT):mstrmojo.desc(2170);M.push(R(H,function(){this.parent.toTimeView();},{alias:"timeToggle",slot:"switcherNode",cssClass:"",selected:W==I.TIME}));}}if(this._hasDate){this.viewCssClass="dateView";}else{if(this._hasTime){this.viewCssClass="timeView";}}this.addChildren(M);}function P(){var a=[this.valueField,"min","max"],M=L.copy(D),Z=this.is24HourMode?L.copy(N):L.copy(G),Y=L.copy(E),X=this[this.valueField],H=X&&X.time,W=this;U.forEach(a,function(b){M[b]=L.copy(W[b]);});if(this._hasDate){this.dateProvider=new mstrmojo.DateStepperContentProvider({item:M,valField:this.valueField,canLoop:true,onTraverse:function(){W.updateDate();}});}if(this._hasTime){if(this.minuteInterval!==undefined){Y.interval=this.minuteInterval;}delete this.minuteInterval;if(H){if(!this.is24HourMode){Z.value=H.hour%12||12;this.set("meridiem",(H.hour<12));}else{Z.value=H.hour;}Y.value=H.min;}this.hourProvider=new mstrmojo.NumStepperContentProvider({item:Z,valField:"value",canLoop:true,onTraverse:function(){W.updateTime();}});this.minProvider=new mstrmojo.NumStepperContentProvider({item:Y,valField:"value",canLoop:true,renderer:{render:function(b){return String(b).length==1?("0"+b):b;}},onTraverse:function(){W.updateTime();}});}}mstrmojo.DateTimePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DateTimePicker",value:null,min:null,max:null,meridiem:true,hideSwitchers:false,minuteInterval:null,is24HourMode:false,dtp:mstrmojo.expr.DTP.TIMESTAMP,viewCssClass:"",valueField:"value",stepperClass:"mstrmojo.Stepper",markupString:"<div id='{@id}' class='mstrmojo-DateTimePicker' style='{@cssText}'><div class='switcher'></div><div class='{@viewCssClass}'><span class='stepNode month'></span><span class='stepNode day'></span><span class='stepNode year'></span><span class='stepNode hour'></span><span class='stepNode min'></span><span class='meridiem' mstrAttach:click></div></div></div>",markupSlots:{switcherNode:function(){return this.domNode.firstChild;},viewNode:function(){return this.domNode.children[1];},monthNode:function(){return this.domNode.children[1].children[0];},dayNode:function(){return this.domNode.children[1].children[1];},yearNode:function(){return this.domNode.children[1].children[2];},hourNode:function(){return this.domNode.children[1].children[3];},minNode:function(){return this.domNode.children[1].children[4];},meridiemNode:function(){return this.domNode.children[1].children[5];}},markupMethods:{onmeridiemChange:function(){if(this.is24HourMode){this.meridiemNode.display="none";}else{this.meridiemNode.innerHTML=this.meridiem?mstrmojo.locales.datetime.AM_NAME:mstrmojo.locales.datetime.PM_NAME;}},onviewCssClassChange:function(){this.viewNode.className=this.viewCssClass;}},init:function O(M){this._super(M);var H=this.dtp;this._hasDate=(H===I.DATE||H===I.TIMESTAMP);this._hasTime=(H===I.TIME||H===I.TIMESTAMP);P.call(this);C.call(this);},getDateTime:function B(){return{date:this.getDate(),time:this.getTime()};},getDate:function F(){if(this._hasDate){var H=this.dateProvider.curVal;return{year:H.getFullYear(),month:H.getMonth()+1,day:H.getDate()};}return null;},getTime:function S(){if(this._hasTime){return{hour:!this.is24HourMode?Q.capitalHour(this.hourProvider.curVal,this.meridiem?" AM":" PM"):this.hourProvider.curVal,min:this.minProvider.curVal};}return null;},getDateTimeString:function K(){var H="";if(this._hasDate){H+=Q.formatDateInfo(this.getDate(),mstrmojo.locales.datetime.DATEOUTPUTFORMAT);}if(this._hasDate&&this._hasTime){H+=" ";}if(this._hasTime){H+=Q.formatTimeInfo(this.getTime(),mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return H;},updateDate:function A(){if(this.hasRendered){var H=this;U.forEach(["year","month","day"],function(M){H[M+"Stepper"].updateDisplayText();});}if(this.dateToggle){this.dateToggle.set("text",Q.formatDateInfo(this.getDate(),mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}},updateTime:function J(){if(this.timeToggle){this.timeToggle.set("text",Q.formatTimeInfo(this.getTime(),mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}},toDateView:function T(){this.set("viewCssClass","dateView");this.dateToggle.set("selected",true);var H=this.timeToggle;if(H){H.set("selected",false);}},toTimeView:function V(){this.set("viewCssClass","timeView");var H=this.dateToggle;if(H){H.set("selected",false);}this.timeToggle.set("selected",true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo._TouchGestures","mstrmojo.android.ui.Image","mstrmojo.dom","mstrmojo.css");var F={containerNode:"100%"};mstrmojo.android.ui.ResultSetView=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.ResultSetView",layoutConfig:{h:F,w:F},init:function G(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ResultSetView");},rootOrientationChange:mstrmojo.emptyFn,addChildren:function A(K,I,J){if(!this.btnFullScreen){K=K.concat([{scriptClass:"mstrmojo.android.ui.Image",alias:"btnFullScreen",cssClass:"btnFullScreen",ignoreLayout:true,visible:false,touchTap:function(){this.parent.controller.viewTap();}}]);}this._super(K,I,J);},delegateToolbar:function H(I){return false;},setActionToolbarStatus:mstrmojo.emptyFn,getMaskNode:mstrmojo.emptyFn,touchTap:function E(){this.controller.viewTap();},enterFullScreen:function D(){this.btnFullScreen.set("visible",true);},exitFullScreen:function B(){this.btnFullScreen.set("visible",false);},flashFullScreen:mstrmojo.emptyFn,cancelFlashFullScreen:mstrmojo.emptyFn,getPosition:function C(){var I=this.domNode;return I?mstrmojo.dom.position(I):undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileCalendar","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton");mstrmojo.android.inputControls.CalendarDIC=mstrmojo.declare(mstrmojo.MobileCalendar,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.CalendarDIC",onpopupResized:function A(C){var B=this.domNode;if(B){B.style.zoom=parseInt((95*C.width/B.offsetWidth),10)+"%";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._TouchGestures","mstrmojo.android.ui.Button","mstrmojo.array","mstrmojo.dom","mstrmojo.css");mstrmojo.requiresDescs(221);var D=mstrmojo.css,C=mstrmojo.android.ui.Button.newButton;mstrmojo.android.DropDownList=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.DropDownList",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-AndroidDropDownList {@cssClass}" mstrAttach:click><div>{@value}</div></div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onvalueChange:function(){var K=this.value,I=this.options;if(I){var H=mstrmojo.array.find(I,"v",K),J=I[H];this.valueNode.innerHTML=J.n;if(K!=="-1"&&I[0].v==="-1"){I.shift();H--;}this.idx=H;}}},options:null,value:"",name:"",idx:0,singleSelectByField:function G(H){this.set("value",H);},touchTap:function F(){var J=this.id,H=this.domNode,I=mstrApp;I.showDialog({autoClose:true,title:this.name,fadeOnClose:false,cssClass:"dropDownList",onClose:function(){D.removeClass(H,"down");},children:[{scriptClass:"mstrmojo.ui.MobileCheckList",items:this.options,multiSelect:false,isElastic:true,selectedIndex:this.idx,hasEvenRows:true,postselectionChange:function(K){mstrApp.closeDialog();mstrmojo.all[J].set("idx",K.added[0]);}}],buttons:[C(mstrmojo.desc(221,"Cancel"),function(){mstrApp.closeDialog();})]});D.addClass(H,"down");},touchSelect:function A(){this.touchTap();},onidxChange:function E(){var H=this.options;if(H){this.set("value",H[this.idx].v);}},preBuildRendering:function B(){this._super();var H=this.options;if(H){this.value=H[this.idx].v;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.Button");var B=mstrmojo.android.ui.Button.newButton;mstrmojo._CanMakeServerProxyRequests=mstrmojo.provide("mstrmojo._CanMakeServerProxyRequests",{_mixinName:"mstrmojo._CanMakeServerProxyRequests",cancelRequests:function A(){return this.serverProxy.cancelRequests();},serverRequest:function C(J,K,E){var I=this;try{K=K||{};E=E||{};E.projectId=E.projectId||this._currentProjId;E.mobileConfig=this.getConfiguration();var F=E.src||(arguments.callee&&arguments.callee.caller.name);var D=function(L){if(E[L+"Wait"]){I.hideMessage();}if(E[L+"Progress"]){mstrMobileApp.hideProgress();}};if(!E.silent){K=mstrmojo.func.wrapMethods(K,{submission:function(L){if(!L){if(E.showWait){I.showMessage();}if(E.showProgress){mstrMobileApp.showProgress(E.progressStateText,!!E.useRefreshProgress);}}},failure:function(L){D("show");if(L&&L.requireDeviceCertificate){var M=function(){try{mstrApp.rootController.spawn(mstrApp.controllerFactory.newController("Settings",{}),{viewFn:"getCertificateAuthenticationFieldsView"});}catch(N){L.method=F;mstrApp.handleError(N,I);}};mstrmojo.confirm("Missing/invalid/expired device certificate detected. Would you like to get a new one?",[B(mstrmojo.desc(1442,"OK"),M),B(mstrmojo.desc(221,"Cancel"))]);return ;}if(!(E.noErrorMessage||L.noErrorMessage)){L.method=F;mstrApp.handleError(L,I);}},complete:function(){D("hide");},canceled:function(){D("show");}});}try{I.serverProxy.request(K,J,!!E.override,E);}catch(H){K.failure(H);}}catch(G){mstrApp.handleError(G,this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.Image","mstrmojo.Label","mstrmojo.Box","mstrmojo.Button","mstrmojo.android.ui.Button","mstrmojo.android.ui.Label","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.Image.baseCssClass+" prv",J=mstrmojo.dom,M=mstrmojo.css;function F(S,Q){var R=S.imgNode;if(R){var T=S.imgNode.style;T[J.CSS3_TRANSITION_DURATION]=Q?"300ms":0;T.opacity=Q;}}function B(){var R=this.imgPreview.params,Q=R&&R.item;if(Q){this.onOpenItem();mstrmojo.all[R.ctrlId].executeItem(Q);}}function D(){if(mstrApp.isTablet()){this.updateScroller();return ;}var g=this._scrollStyle,U=this.scrollNode,b=U.parentNode,Q=b.parentNode;if(!g){var W=M.getComputedStyle(Q),l=M.getComputedStyle(U);this._scrollStyle=g={p:parseInt(W.paddingLeft,10)+parseInt(W.paddingRight,10),b:0,sp:parseInt(l.paddingLeft,10)+parseInt(l.paddingRight,10)};}var a="px",S=g.p,R=g.b,V=g.sp,o=parseInt(this.height,10),j=parseInt(this.width,10),T=this.staticNode,X=T.offsetHeight,f=T.offsetWidth,d=0,Y=(j-S),h=(o-X-S);if(!this.controller.orientation){d=f;Y=(j-f-S);h=o-S;}var Z=Q.style;Z.left=d+a;Z.width=Y+a;Z.height=h+a;var k=b.style;k.width=(Y-R)+a;k.height=(h-R)+a;U.style.width=(Y-R-V)+a;this.updateScroller();}var C=mstrmojo.android.ui.PropertiesView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.ui.PropertiesView",markupString:'<div id="{@id}" class="mstrmojo-PropertiesView {@cssClass}" style="{@cssText}"><div class="mstrmojo-PropertiesViewStatic"></div><div class="mstrmojo-PropertiesViewScroll"><div><div></div></div></div></div>',markupSlots:{staticNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.lastChild.firstChild.firstChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},children:[{scriptClass:"mstrmojo.Image",slot:"staticNode",alias:"imgPreview",cssClass:"prv",visible:false,onload:function(){F(this,1);}},{scriptClass:"mstrmojo.Box",slot:"staticNode",cssClass:"btns",alias:"btns",children:[mstrmojo.android.ui.Button.newButton(mstrmojo.desc(1900,"View"),function(){B.call(this.parent.parent);},{alias:"btnView",cssClass:"mstrmojo-GlowButton",visible:false}),{scriptClass:"mstrmojo.android.ui.Label",alias:"txView",cssClass:"txOffline",visible:false,txData:{},ontxDataChange:function H(){if(!this.txData){this.set("visible",false);this.txData={};}},touchTap:function(){var Q=mstrApp.getTransactionNotificationController(),R=Q&&Q.rootCtrl.getCurrent();if(R){if(R.ctrlType!==2048){R=R.getController("ctrlType",2048);}Q.showNotificationBoard(R||Q.rootCtrl,this.did,this.n);}}}]},{scriptClass:"mstrmojo.Label",slot:"scrollNode",alias:"lblName",cssClass:"nm",visible:false},{scriptClass:"mstrmojo.Label",slot:"scrollNode",alias:"lblDesc",cssClass:"ds"},{scriptClass:"mstrmojo.Label",slot:"scrollNode",alias:"lblCachedOn",cssClass:"ch",text:""}],afterViewVisible:function A(){D.call(this);},rootOrientationChange:function O(){D.call(this);},updateScrollerConfig:function I(){var Q=this._super(),S=this.scrollNode;Q.scrollEl=S;Q.noHScroll=true;Q.origin={x:0,y:0};var T=Math.max(S.offsetHeight-S.parentNode.clientHeight,0);var R=Q.vScroll=(T!==0);if(R){Q.offset={y:{start:0,end:T}};}else{Q.offset=null;}M.toggleClass(this.domNode,"can-scroll",R);return Q;},onOpenItem:mstrmojo.emptyFn,updateView:function P(g){var k=this.imgPreview,f=this.lblName,T=this.lblDesc,W=this.lblCachedOn,R=this.btns.btnView,V=this.btns.txView,d=g.item,S="visible",U="text";var a=g.desc||g.defaultMsg;T.set(U,a);T.set(S,!!a);if(!d){k.set(S,false);f.set(S,false);W.set(S,false);R.set(S,false);V.set(S,false);delete k.params;}else{var Q=mstrmojo.android.ui.PropertiesView.getPreviewSizes();if(mstrApp.isTablet()&&this.controller.orientation){Q.reverse();}mstrMobileApp.getScreenShot(this.id,d.pid||mstrApp.getCurrentProjectId(),d.did,Q[0].h,Q[0].w);var Z=k.params;if(!Z||Z.did!==g.did){k.set("cssClass",G+" i"+g.st);k.set("src","");}k.params=g;k.set(S,true);var Y=g.ttl;f.set(U,Y);f.set(S,!!Y);var j=g.cached;W.set(U,j);W.set(S,(j!==undefined));if(g.avail){R.set(S,true);var h=g.did;if(h){var b=mstrApp.getTransactionNotificationController(),X=(b&&b.hasTransactionQueue(h));V.set("did",h);V.set("n",g.ttl);V.set("visible",X);if(X){b.addWidgetListener(h,V);}}}else{R.set(S,false);V.set(S,false);}}D.call(this);},onPreviewReady:function E(R){if(R){var Q=this.imgPreview;if(Q.src!==R){F(Q,0);Q.domNode.className=G;Q.set("src",R);}}}});var N={160:{h:150,w:200},213:{h:150,w:200},240:{h:225,w:300},320:{h:300,w:400},480:{h:300,w:400}},L={160:{h:334,w:400},213:{h:334,w:400},240:{h:501,w:600},320:{h:668,w:800}},K={160:{h:337,w:400},213:{h:337,w:400},240:{h:506,w:930},320:{h:674,w:1240}};C.getPreviewSizes=function(){var R=[],Q=mstrMobileApp.getDeviceDPI();if(mstrApp.isTablet()){R.push(K[Q]);R.push(L[Q]);}else{R.push(N[Q]);}return R;};}());(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function I(J){mstrmojo.hash.copy(J,this);},initContent:function D(L){this.startIndexInContainer=L||this.startIndexInContainer||0;var K=this.base.show,J=this.base.items;this.rc=K&&J?J.length:0;this.colWidths=K&&this.base.cws||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function B(K,J){return !this.invalidData;},download:function A(K,J){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function C(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function H(){return this.rc;},getUpdatedRows:function G(){return this.updatedRows;},getRowCells:function(U){var N=this.base.items,V=N[U],O=V.items,X=this.lookupBase,Q=this.interactiveCellsArray,W=this.gridData.css,a=null,Z=false,g,P,S,M;if(this.oldGridData){g=this.oldGridData;P=this.oldBase;S=P&&P.items;M=S[U]&&S[U].items;}for(var R=0,Y=O&&O.length||0;R<Y;R++){var L=O[R];if(L){L.v=L.v||L.n;if(X&&!L._e){var T=X[L.tui];a=T&&T.es[L.idx];if(a){L.v=L.v||a.n;if(a.rv){L.rv=a.rv;}L._e=a;}}if(!L.css){L.css=W[L.cni].n;}if(!L._d&&M&&this.preServeUpdatedRows){var K=M[R];if(!K||(K.rs!==L.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((K.v&&L.v!==K.v)){data={};if(L.v!==K.v){data.v=K.v;}if(L.css!==K.css){data.css=K.css;}L._d=data;this.updatedRows[this.startIndexInContainer+U]=true;}}}L._gd=this.gridData._bidx||0;if(L.at>0&&Q){if(L._ei===undefined||Q[L._ei]!==L){L._ei=Q.push(L)-1;}}if(this.axis){L.axis=this.axis;}var b=L.pi;if(b){if(b.ri!==undefined&&b.ci!==undefined){L._p=N[b.ri].items[b.ci];}else{var f=this.gridData.ghs,d=b.left,J=b.top;if(d){L._lp=f.rhs.items[d.ri].items[d.ci];}if(J){L._tp=f.chs.items[J.ri].items[J.ci];}}}}}return O;},getUnmergedCells:function F(O){var Q=[],R=this.base.items,L=this.gridData.css,P=R[O].items[0],K=P&&P.pi,J=K&&K.ri,N=K&&K.ci;while(K&&J>-1&&N>-1){P=P._p||R[J].items[N];var M={};mstrmojo.hash.copy(P,M);if(!M.css){M.css=L[M.cni].n;}M.rs=P.rs-O+J;Q.splice(0,0,M);K=P&&P.pi;J=K&&K.ri;N=K&&K.ci;}return Q;}});})();(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];for(var J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getRowCells(I);},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K);for(var I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0;for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){for(var I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={};for(var J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(K.getUpdatedRows(),I);}}this.updatedRows=I;return I;},download:function B(M,L){var K=this._getCPs(M,L);for(var I=0;I<K.length;++I){var J=K[I];J.download(M,L);}}});})();(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];for(var I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowCells:function(I){var M=this.cps,J=[];for(var L=0,H=M.length;L<H;L++){if(M[L].getAvailableRowsCount()>0&&M[L].rc>I){var K=M[L].getRowCells(I);if(K){J=J.concat(K);}}}return J;},getRowHeight:function C(){return this.cps[0].getRowHeight();},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={};for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(J.getUpdatedRows(),H);}}this.updatedRows=H;return H;},download:function B(J,H){var I=this.cps[1];I.download(J,H);}});})();(function(){mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function E(G){this._super(G);},download:function A(H,G){},initContent:function D(N){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var H=this.gridData.gts,X=(this.gridData.lhv!==0),J=H.row||[],G=H.col||[],P=H.show,M=H.rec,V=this.cts||[],U=J.length,O=V.length,R=this.gridData.css;this.base={items:[]};this.rc=P&&V.length||0;if(this.rc===0&&P){this.rc=U>0?1:0;}this.colWidths=P&&H.cws||[];if(!this.rc){return ;}var L={items:[]},I=1,Q,T;for(T=0;T<U;++T){J[T].axis=1;J[T].ui=T;L.items.push(J[T]);}if(O>0){V[0].axis=2;V[0].ui=0;G[0].axis=2;G[0].ui=0;I=V[0].rs||1;if(X&&I>1){V[0].rs=1;Q=mstrmojo.hash.clone(V[0],{});Q.n="&nbsp;";V[0].cni=R.push({n:(R[V[0].cni].n||"")+" fsbp_1"})-1;}L.items.push(V[0]);}var K=this.base.items;K.push(L);for(T=1;T<O;++T){if(I>1){var S=I;while(S-->1){if(X){var W=mstrmojo.hash.clone(Q,{});W.cni=R.push({n:(R[W.cni].n||"")+" fsbp_"+((S==1)?"3":"2")})-1;K.push({items:[W]});}else{K.push({items:[]});}}}V[T].axis=2;V[T].ui=T;G[T].axis=2;G[T].ui=T;I=V[T].rs||1;if(X&&I>1){V[T].rs=1;Q=mstrmojo.hash.clone(V[T],{});Q.n="&nbsp;";V[T].cni=R.push({n:(R[V[T].cni].n||"")+" fsbp_1"})-1;}K.push({items:[V[T]]});}this.rc=K.length;if(M){this._removeExtraColumn(J,V);}},getAvailableRowsCount:function C(){return this.rc;},isDataAvailable:function B(H,G){return true;},_removeExtraColumn:function F(J,Z){var X=J&&J.length,O=Z&&Z.length,G=this.gridData.gts,R=G.row||[],M=G.col||[],H=R.length,V=M.length;if(!X||!O){if(O===1){var a=Z[O-1];if(a.otp==-1){if(V>0){M[V-1]._hid=true;}this.base.items=[];this.rc=0;}}return ;}var I=J[X-1],S=this.rc,K=this.base.items;if(I){if(I.otp==-1){if(H>0){R[H-1]._hid=true;}K[0].items.splice(X-1,1);}else{var P=S>1?S-1:0,Q=K[P],Y=Q.items.length;if(Y>0&&V>0){M[V-1]._hid=true;}var L=I.fix;if(L){for(var W=0;W<L;W++){Q.items[Y-1+W]=J[X-L+W];}}else{Q.items[Y-1]=I;}for(var U=0,T=O-1;U<T;U++){Z[U].cs=L?L:I.cs;}var N=L?L:1;K[0].items.splice(X-N,N);}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var Y=1,b=2,p=4,U=8,f=1,g=2,F=3,o=4,S=5,K=6,j=7,D={},X={120:0.75,240:1,320:1.5},l={1:30,2:26,3:20,4:70,5:40,6:34,7:40},H=4,P=1,I={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},R=mstrmojo.hash,T=mstrmojo.array;function W(x,t){var w=x[0],q=t.gts,s=q.cws.length;return(t.vp.gr==="1"&&(s>1));}function h(s,AA){var x=function(AB,AC){if(AC&&AB&&AB.css&&AB.css.indexOf(AC)<0){AB.css+=" "+AC;}};var w=AA.type,t=AA.col,z=(t&&t.cl)||0,q=(w===b||w===Y);if(w===b||w===U){x(s,I.RIGHT_ALIGN);}else{if(w===Y||w===p){x(s,I.LEFT_ALIGN);}}if(q){if(t&&t.tg&&z>1){if(!s._v){s._v=s.v;s.v="<span class='toggleHeader'>"+s.v+"</span>";}}x(s,I.TITLE);}T.forEach(AA.extraCss,function(AB){x(s,AB);});}function A(q){return 0;}function k(x){var t,w=x.cg,q=w&&w.cgc,s=1;for(t=0;t<q;t++){if(w&&w[t]&&!w[t].tg&&w[t].cl>s){s=w[t].cl;}}return s;}function L(s,q){var t=o;if(q>1){if(s===0){t=f;}else{if(s===q-1){t=F;}else{t=g;}}}return t;}function J(q,x,t,s){var AA=s&&s.cols&&s.cols.cg,w,AB=0,z=0;if(AA){for(w=0;w<x;w++){if(q[w]){AB+=q[w].length;}}AB+=(t+1);for(w=0;w<AA.cgc;w++){z+=AA[w].cl;if(z>=AB){return w;}}}return -1;}function N(AB,w,s,q){var AA=[],z,t,x,AC;for(t=0,x=AB.length;t<x;t++){if(AB[t].length===1){z=AB[t][0];z.rowType=(z.rowType!==j)?L(w,s):j;z.singleStack=(s>1);z=R.copy(z);if(z.ts===H){if(s===1){z.rowType=o;z.colIdx=J(AB,t,w,q);}else{if(!w){z.colIdx=J(AB,t,w,q);}else{delete z.ts;z.v="";}}}else{if(w){z.v="";}}}else{z=AB[t][w];if(!z){AC=AB[t].length;z=R.copy(AB[t][AC-1],{});z.v="";if(z.hasOwnProperty("ts")){delete z.ts;}}else{if(z.ts===H){z.colIdx=J(AB,t,w,q);}}z.rowType=(z.rowType!==j)?L(w,s):j;}AA.push(z);}return AA;}function O(q){if(q===0){return 0;}var s=this.sectionMap[q-1]||0;return Math.floor((q-s)/this.stackLevels);}function C(AB){var z,AA,x=this.sectionInfo,q=x.length,w=this.srh,t=this.lastSectionIndex;AA=x[t];if(AB>=AA.rs&&AB<(AA.rs+w)){return AA;}if(AB<AA.rs){z=t-1;if(z<=0){this.lastSectionIndex=0;return null;}do{AA=x[z];if(AB>AA.rs&&AB<=(AA.rs+w)){this.lastSectionIndex=z;return AA;}}while(AB<AA.rs&&--z>0);this.lastSectionIndex=z;return AA;}else{z=t+1;if(z>=q){this.lastSectionIndex=q-1;return null;}do{AA=x[z];if(AB>AA.rs&&AB<=(AA.rs+w)){this.lastSectionIndex=z;return AA;}}while(AB>(AA.rs+w)&&++z<q);this.lastSectionIndex=z-1;return null;}}function a(AC,t,q,AB){var AA=AC[0],x,z=AC.length,s=AA&&AA.rowType,w={v:"",css:"empty-igcell",rowType:s};if(q!==undefined&&AA&&(s===f||s===o||s===S)){w={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+AB+"px;top:-"+(0.5*D[s])+'px;"></div></div>',css:"IG-ActionArrow",_ei:q};}for(x=z-1;x>=z-t;x--){AA=AC&&AC[x];if(AA){AA.css+=" IG-lastdatacolumn";}}AC.push(w);}function Q(AP,AK,t){var AG=AP.cols,AH=AG.cg,q=[{w:"0px"}];if(AG&&AK){var AQ=AG.cws,s=[],AO=AQ.length,AS=0,AC=(parseInt(AP.ar,10)===1)?(AK/AO):-1,AF,x,AE=false,z=0,AI=AK,AJ=0,AN;for(AN=0;AN<AO;AN++){x=s[AN]=AQ[AN];AF=x.w;if(AF===""){AE=true;}else{if(x.xc){AS+=parseInt(AF);AI-=AS;z++;}else{AJ+=parseFloat(AF,10);}}}if(AE||AJ<100){AC=AI/(AO-z);}for(AN=0;AN<AO;AN++){x=AQ[AN];if(x.xc){continue;}else{if(AC===-1){AF=parseInt(x.w,10)*AI/100;if(!AF&&AF!==0){AF=parseInt(AI/AH.cgc,10);}}else{AF=(parseInt(x.w,10)<0)?0:AC;}}s[AN]={w:AF+"px"};}if(t){return s;}var AD=[],AM=0;for(AN=0;AN<AO;AN++){var AR=AH[AN],AB=AR.tg?AR.cl:1,AL=0;for(AL=0;AL<AB;AL++){var AA="0px";if(AL===AR.cc){AA=s[AN].w;}AD[AM+AL]={w:AA};}AM+=AB;}return AD.concat(q);}else{if(t){return null;}else{return cp.cws.concat(q);}}}function B(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function M(){var AD=this.cps,AC=this.cps[0],AI=Math.max(AD[0].rc,AD[1].rc);if(AC.type!==Y){var AN=this.gridData,AH=function(AQ,AT){var AP=AQ.base.items,AR=AQ.lookupBase[0].es,AS=AP[AT].items[0],AO=AR&&AR[AS.idx];return(AO&&AO.n)||((AS.pi&&AR[AS.pi.ri||0])||"");},AL,AK,q=1,AA,s,AF,w=0,t=-1,AG,AM,AJ=0,AE=this.groupEnabled;for(AG=0,AL=0,AM=AC.cps?AC.cps.length:1;AG<AM;AG++){var z=AC.cps?AC.cps[AG]:AC,AB=z.rc;w=t+1;t=w+AB-1;if(z.isDataAvailable(w,t)){if(z.lastRow){AJ=z.lastRow;s=z.lastSection;}else{AL=AJ||0;for(AK=0,q=this.sectionMap[AL-1]||0;AK<AB;AK++){var x=this.stackLevels;AF=AH(z,AK);if(AE&&AF!==s){s=AF;this.sectionInfo.push({sn:AF,rs:this.srh*q+this.stackedRh*Math.floor((AL-q)/this.stackLevels)});this.sectionMap[AL]=++q;AL++;}while(x){this.sectionMap[AL]=q;x--;AL++;}}AJ=z.lastRow=AL;z.lastSection=AF;}}else{break;}}this.rc=(this.stackLevels>1?AI*this.stackLevels:AI)+(AE?q:0);}},onDemandDataReady:function Z(){this.adjustCPMaps();},initContent:function V(AD){var AC=this.cps,AO=this.gridData=AC[0].gridData||AC[0].cps[0].gridData,AK=AO.vp=this.gridVp=this.gridVp||AO.vp,t=AK.daf&&AK.daf.split(":"),AE=AK.cols,AF=AE.cg,AL=AE.cws,AB=AC[A(AF)],AI=AO.gts.row,s=AO.gts,AM=W(AC,AO),AA=AB.type!==Y,AH,AJ,x,q,AG,z,AN,w=mstrApp.isTablet()?240:mstrMobileApp.getDeviceDPI();R.forEach(l,function(AQ,AP){D[AP]=AQ*X[w];});if(AA){if(AK.dafIdx===undefined&&t){for(AH=0;AH<AI.length;AH++){if(AI[AH].id===t[0]&&AI[AH].fid===t[1]){AK.dafIdx=AH;break;}}}}for(AH=0;AH<AF.cgc;AH++){if(AF[AH]&&AF[AH].tg){break;}}if(AH===AF.cgc){AO.gts.show=false;AO.ghs.chs.show=false;}this._super(AD);this.colWidths=Q(AK,this.gridWidth);this.tdWidths=Q(AK,this.gridWidth,true);if(AA){this.stackLevels=k(AE);if(this.stackLevels>1){this.srh=D[K];this.rh=D[o];this.mrh=D[F];this.stackedRh=D[f]+(this.stackLevels-2)*D[g]+D[F];}else{this.srh=D[K];this.rh=this.stackedRh=this.mrh=D[o];}if(AM||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AM;this.adjustCPMaps();q=this.cps[0].cps;if(q){AN=this;for(AH=0,AJ=q.length;AH<AJ;AH++){z=q[AH];if(z&&z.addCPListener){z.addCPListener(AN);}}}}}},getUnmergedCells:function(q){return ;},getResolvedGroupHeader:function(t,x){var s=this.gridData,w=s.gts.row[x].es,q=s.ghs.rhs.items[t].items[x];if(q){if(!q.css){q.css=s.css[q.cni].n+" iggroup";q.n=w[q.idx].n;}}else{return{css:" iggroup",n:""};}return q;},getRowCells:function(AL){var AG=this.cps,z=[],AZ=this.gridData,AV=AZ.vp,AJ=AV.cols.cg,AE=AG[A(AJ)],AI=this.groupEnabled,s=AV.bn==="1",AW=[],AK=O.call(this,AL),AA,t,AM=1,AF,q,AC,AS,AR,AU,AY,AD;if(AI&&(this.sectionMap[AL]!==this.sectionMap[AL-1])){var w=R.copy(AE.getRowCells(AK)[0],{});w.cs=this.colWidths.length;w.rowType=K;h(w,{col:null,type:AE.type,extraCss:[I.GROUPING]});return[w];}if(!AL){B.call(this);}this.lastAttRow=this.lastAttRow||(AG[0].rc?AG[0].getRowCells(AK):[]);this.lastMtxRow=this.lastMtxRow||(AG[1].rc?AG[1].getRowCells(AK):[]);AC=this.lastAttRow;AU=AC.length;if(AU>0&&AC[0].stt){AF=true;for(AS=0;AS<AU;AS++){AY=AC[AS];if(AY.stt===P){q=AY;break;}}}if(!this.lastStackCols){T.forEach([this.lastAttRow,this.lastMtxRow],function(Aa){for(AS=0;AS<Aa.length;AS++){if(Aa[AS]._ei!==undefined){if(AV.dafIdx>=0){AD=AE.getRowCells(AK)[AV.dafIdx];}AA=(AV.dafIdx>=0)?(AD&&AD._ei):"";return false;}}},this);var AQ=function(Aa,Ab){if(Aa&&(Ab.type===Y||Ab.type===b)){if(AO.tg===false){Aa.n=Aa.v="";}Aa.rowType=j;}h(Aa,{col:AO,type:Ab.type,extraCss:[((Ab.type===U||Ab.type===p)&&s&&(AK%2===1))?I.BANDING:null,AF?I.TOTAL_ROW:null]});if(Aa){Aa.cs=1;if(Aa._ei===undefined&&AV.dafIdx!==undefined){Aa._ei=AA;}}};this.lastRowIndex=0;for(AR=0;AR<AJ.cgc;AR++){var AO=AJ[AR],AT=AO["mix"+AO.cc],x=AT!==undefined,AB=AG[x?1:0],AP,AN,AH,AX={n:"",stt:P,css:"xtab-td"};arr=[];if(AO.tg){for(var AS=0;AS<AO.cl;AS++){arr=[];AH=x?AO["mix"+AS]:AO.attForms[AS].idx;var AC=x?this.lastMtxRow:this.lastAttRow;AY=AC[AH];if(AF){if(!AY){AY=AX;}else{if(AY&&AY.stt===P){AY=R.copy(q,AX);}else{AY=R.copy(AY,{});}}}else{AY=R.copy(AY,{});}AQ(AY,AB);arr.push(AY);AW.push(arr);}if(AR+1===AJ.cgc){AM=AO.cl;}}else{for(AP=0,AU=AO.cl;AP<AU;AP++){if(x){AN=AO["mix"+AP];if(AN!==undefined){AY=this.lastMtxRow[AN];}}else{AN=AO.attForms[AP];if(AN){AY=this.lastAttRow[AN.idx];}if(AF&&!AY){AY=AX;}}AQ(AY,AB);arr.push(AY);}AW.push(arr);}}this.lastStackCols=AW;}z=N(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AV);if(this.lastRowIndex>=this.stackLevels){B.call(this);}return z;},getRowHeight:function E(s){var q=D[o];return D[s]||q;},isDataAvailable:function d(t,q){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var x=this.sectionMap.length,w;if(!x){return this.cps[1].isDataAvailable(t,q);}if(q>x){if(t<x){w=O.call(this,t);return this.cps[1].isDataAvailable(w,w+(q-t));}else{return false;}}else{return this.cps[1].isDataAvailable(O.call(this,t),O.call(this,q));}}},download:function G(AB,x){var q=O.call(this,AB),AA=q+Math.ceil((x-AB)/this.stackLevels),z=this.cps[0],s,t,w=!z.cps?[z]:this.cps[0]._getCPs(q,AA);for(s=0;s<w.length;++s){t=w[s];t.download(q,AA);}},getRowCellInfo:function(w){var t=C.call(this,w+this.srh),q,s=this.lastSectionIndex;if(t){q=this.sectionInfo[s-1];return{rowStart:t.rs,isNextRowNewSection:true,sectionName:q&&q.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[s].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.css");var E=mstrmojo.css,B="glow",F=mstrmojo.dom,D=F.$TRANS_DURATION,A;function C(I){var H=I.style;H[D]=0;E.addClass(I,B);window.setTimeout(function(){H[D]="300ms";E.removeClass(I,B);},100);}mstrmojo.ui.MobileCheckList=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.ui.MobileCheckList",multiSelect:true,hasEvenRows:true,glow:true,allowTouchBubble:false,listHooks:{select:function(I,J,H){if(this.glow&&!this.skipEvent){C.call(this,I);}},unselect:function(I,J,H){if(this.glow&&this.multiSelect&&!this.skipEvent){C.call(this,I);}}},getItemMarkup:function(H){if(!A){A=this._super(H).replace("{@n}","<div><h3>{@n}</h3></div>");}return A;},init:function G(I){this._super(I);var H=["mobile-checklist"];if(this.multiSelect){H.push("multi");}mstrmojo.css.addWidgetCssClass(this,H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList");mstrmojo.android.selectors.ListBox=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.selectors.ListBox",init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,["selector-listbox"]);},postBuildRendering:function A(){var H=parseInt(this.height,10);if(H){var F=this.itemsContainerNode,C=F.offsetHeight;if(C<H){var E=this.items.length,G=Math.round(H/this.items.length)+"px",D=0;for(D=0;D<E;D++){F.childNodes[D].style.lineHeight=G;}}}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.android._HasLingeringListSelections");var A=[],F=mstrmojo.dom,E=mstrmojo.string;mstrmojo.android.ui.FolderView=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo.android._HasLingeringListSelections],{scriptClass:"mstrmojo.android.ui.FolderView",allowTouchBubble:false,useSelectScroll:true,highlightOnSelect:true,hasEvenRows:true,listHooks:{select:function(I){I.style[F.CSS3_TRANSITION_DURATION]=0;},unselect:function(I){I.style[F.CSS3_TRANSITION_DURATION]="300ms";}},getItemMarkup:function(K){var M=K.desc,L=K.isc,J=((M)?1:0)+((L)?2:0);if(!A[J]){var I="<h3>{@n}</h3>";if(M){I+="<h4>{@desc}</h4>";}I+="<div><div><div></div></div></div>";A[J]=this._super(K).replace("{@n}",I);}return A[J];},getItemProps:function C(M,I){var L=this._super(M,I),N=M.desc||"",K=this.controller.isItemCached(M),J=!(K||this.controller.isItemAvail(M,true));L.addCls("ty"+(M.st||2048));if(L.n){L.n=E.htmlAngles(L.n);}if(N){L.desc=E.htmlAngles(N);L.addCls("desc");}if(K&&M.st!==2048){L.addCls("cached");}else{if(M.isc){L.addCls("isc");}}if(M.unread){L.addCls("new");}if(J){L.addCls("disabled");}return L;},canItemLinger:function H(I){return this.controller.canItemLinger(I);},buildRendering:function G(){var I=this._super();var J=document.createElement("div");J.className="clear-me";this.itemsContainerNode.appendChild(J);return I;},preselectionChange:function D(I){var J=I.added,L=I.removed;if(J){var K=this.items[J[0]];if(!this.controller.isItemAvail(K)){if(L&&L.length){this.select(L,true);}return false;}}return true;},touchSelectBegin:function B(K){var I=this.getItemIdxTouch(K);if(I>-1){var J=this.controller;if(!J.itemLongPressed||!J.itemLongPressed(this.items[I])){this._super(K);}else{return false;}}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList");var A;mstrmojo.android.ui.TxDocList=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.ui.TxtDocList",scrollerConfig:{bounces:false,showScrollbars:false},highlightOnSelect:true,getItemMarkup:function C(D){if(!A){A=this._super(D).replace("{@n}","<h3>{@n}</h3><h4>{@desc}</h4><em>{@cnt}</em>");}return A;},getItemProps:function B(F,D){var E=this._super(F,D);E.desc=F.desc;E.cnt=F.c;return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.css","mstrmojo.array");function A(){var E=this.items.length;if(E){var F=Math.floor(parseInt(this.width,10)/E),D=parseInt(mstrmojo.css.getStyleValue(this._getItemNode(E-1),"borderLeftWidth"),10);mstrmojo.array.forEach(this.itemsContainerNode.childNodes,function(H,G){if(G<E){H.style.width=(F-((G)?D:0))+"px";}});}}mstrmojo.android.medium.ui.TxButtons=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.medium.ui.TxButtons",itemsFloat:true,onRender:function C(){A.call(this);},setDimensions:function B(E,D){this._super(E,D);if(this.hasRendered){A.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo._SupportsEllipsisText","mstrmojo.css");var C;mstrmojo.android.medium.ui.HomeScreenView=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo._SupportsEllipsisText],{scriptClass:"mstrmojo.android.medium.ui.HomeScreenView",selectionPolicy:"reselect",itemsFloat:true,getItemMarkup:function E(){if(!C){var J=this.hsFmt.btn,L="",I=["btn"],M='<div class="ttl" style="color:'+J.c+';">{@txt}</div>',H="</div>",K=[],G=-1;if(J.sty>1){L="border-color:"+J.bc+";background-color:"+J.bg+";";}K[++G]='<div class="btnC" idx="{@idx}">';K[++G]='<div class="'+I.join(" ")+'" style="'+L+'">';K[++G]='<div class="{@iconClass}" style="{@iconStyle}">';if(this.items.length<=4){K[++G]=M;K[++G]=H;K[++G]=H;}else{K[++G]=H;K[++G]=H;K[++G]=M;}K[++G]=H;C=K.join("");}return C;},getItemProps:function D(I,H){var J="",G="";if(I.icn){J="background-image: url("+I.icn+");";}else{G=" ic"+(I.act||I.st);}return{idx:H,txt:I.txt,iconStyle:J,iconClass:G};},preBuildRendering:function B(){mstrmojo.css.addWidgetCssClass(this,(this.items.length>4)?"multiCol":"singleCol");return this._super();},onRender:function F(){var L=this.itemsContainerNode,G=L.childNodes,K=G.length-1,J;if(K>4){for(J=0;J<K;J++){this.ellipsize("ttl",G[J].lastChild,true);}}var I=this.hsFmt.bg;if(I){var H=I.v,M=this.domNode.style;if(I.tp!==1){H="transparent url("+H+") no-repeat 0 0";M.backgroundSize="100%";}M.background=H;}},afterViewVisible:function A(){var H=document.createElement("table"),G=this.domNode;G.appendChild(H);window.setTimeout(function(){G.removeChild(H);},100);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.android.SimpleList","mstrmojo.OfflineTransactionModel");var F=mstrmojo.OfflineTransactionModel,H=F.PENDING,C=F.FAILED;mstrmojo.android.ui.TxEditDoc=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.TxEditDoc",markupString:'<div id="{@id}" class="mstrmojo-TxEditDoc {@cssClass}" style="{@cssText}"><div></div><div></div><div></div></div>',markupSlots:{typeNode:function(){return this.domNode.firstChild;},txNode:function(){return this.domNode.childNodes[1];},btmNode:function(){return this.domNode.lastChild;}},model:null,docDid:null,children:[{scriptClass:"mstrmojo.android.SimpleList",alias:"txList",slot:"txNode",cssClass:"txList",postselectionChange:function(K){var M=K.added,J=M&&M[0],L=this.parent.parent;if(L){L.enableButtons(J!==null);}}}],addChildren:function I(L,J,K){L=L.concat([mstrApp.viewFactory.newView("TransactionsTypeList",{alias:"typeList",slot:"typeNode",cssClass:"txTypeList",selectionPolicy:"reselect",postselectionChange:function(N){var P=N.added,M=P&&P[0];if(M!==null){var Q=[],O=this.parent;mstrmojo.array.forEach(this.parent._tx[M?C:H],function(S,R){Q.push({n:S.n,v:S.timestamp,idx:R});});O.txList.set("items",Q);O.typeSelected(M);}}})]);this._super(L,J,K);},getType:function G(){return this.typeList.selectedIndex;},setType:function D(J){this.typeList.singleSelect(J);},getSelectedTx:function B(){return this.txList.getSelectedItems()[0];},typeSelected:mstrmojo.emptyFn,generateTypeList:function A(S){var R=this.docID;if(!R){return ;}var P=this.model,Q=(P&&P.docsTx)||[],K=Q[R],J=[],L=[];if(K){J=K[H];L=K[C];}var O=this._tx={};O[H]=J;O[C]=L;var M=this.typeList,N=Math.max(M.selectedIndex,0);M.set("items",[{n:mstrmojo.desc(9250,"Pending"),v:J.length},{n:mstrmojo.desc(9251,"Failed"),v:L.length}]);if(S){N=(L.length)?1:0;}M.singleSelect(N);},ondocIDChange:function E(){this.generateTypeList(true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.android.ui._CanBeFullScreen","mstrmojo.array","mstrmojo.css","mstrmojo.android.ui.ActionToolbarButtons","mstrmojo.android.ui.Menu","mstrmojo.android.EnumMenuOptions","mstrmojo._TouchGestures");var N=mstrmojo.array,T=mstrmojo.css,M=1,F=2,E=mstrmojo.android.EnumMenuOptions,K=E.SHARE,J=E.ANNOTATION;function R(){return false;}function S(V){if(!this.active){return ;}var W=V.added,Z=V.src,X=W&&Z.items[W[0]],Y=this.menu;if(!X){return ;}if(X.isMenu){if(mstrMobileApp&&mstrMobileApp.genMapPreview){mstrMobileApp.genMapPreview();}Y.set("visible",!Y.visible);}else{if(X.grp!==K&&X.grp!==J){mstrApp.closeAllDialogs();}if(Z===Y){Y.set("visible",false);if(mstrMobileApp&&mstrMobileApp.showMapView){mstrMobileApp.showMapView(0);}}mstrmojo.all[this._actController].handleMenuItem(X.grp,X.act);}}function G(){var X=[],W=this.icons,V=this.groups,Y=this.actions;N.forEach(this.labels,function(a,Z){X.push({cls:"ic"+W[Z],grp:parseInt(V[Z],10),act:parseInt(Y[Z],10),n:a});});return X;}function Q(f){var a=[],d=this.icons,V=this.groups,W=this.actions,Z=this.labels;N.forEach(this.types,function(h,g){if(h===F){a.push({cls:"ic"+d[g],act:parseInt(W[g],10),grp:parseInt(V[g],10),idx:g,n:Z[g]});if(a.length===f){return false;}}});var X;for(X=a.length-1;X>=0;X--){var Y=a[X],b=Y.idx;delete Y.idx;this.types.splice(b,1);this.groups.splice(b,1);this.labels.splice(b,1);this.actions.splice(b,1);this.checked.splice(b,1);this.icons.splice(b,1);}return a;}var A=mstrmojo.android.ui.ActionToolbar=mstrmojo.declare(mstrmojo.Box,[mstrmojo.android.ui._CanBeFullScreen],{scriptClass:"mstrmojo.android.ui.ActionToolbar",active:true,init:function P(V){this._super(V);T.addWidgetCssClass(this,"mstrmojo-ActionToolbar");},children:[{scriptClass:"mstrmojo.android.ui.ActionToolbarButtons",alias:"buttons"},{scriptClass:"mstrmojo.android.ui.Menu",alias:"menu",visible:false}],addChildren:function L(X,V,W){this._super(X,V,W);N.forEach(this.children,function(Y){Y.attachEventListener("selectionChange",this.id,S);},this);},setActions:function B(Z,W){var Y=[],V=R();var X=W.getBtnCount(W.minBtnCount,W.maxBtnCount);if(X){Y=Q.call(W,X);}if(W.size()){if(V){mstrMobileApp.setSysMenu(Z,W.groups,W.labels,W.actions,W.checked,W.icons);}else{Y.push({cls:"menu",isMenu:true,n:"Menu"});this.menu.set("items",G.call(W));}}this.buttons.set("items",Y);this._actController=Z;this.raiseEvent("renderComplete");this.resetFullScreen();},onactiveChange:function I(){T.toggleClass(this.domNode,"inactive",!this.active);},reset:function U(){this.menu.set("visible",false);},onEnterFullScreen:function D(){this.reset();},propogateMenuVisibleChange:function C(V){mstrmojo.touchManager.raiseEvent({name:"actionBarMenuStateChange",value:V});}});function O(Y,W,V,a,Z,X){this.types.push(Y);this.groups.push(String(W));this.labels.push(String(V));this.actions.push(String(a));this.checked.push(String(!!Z));this.icons.push(X||-1);}A.newToolbarConfig=function H(){var W={addMenuItem:function Y(d,b,h,g,f){O.call(this,M,d,b,h,g,f);this.mnuCount++;},addToolbarBtn:function a(d,b,h,g,f){O.call(this,F,d,b,h,g,f);this.btnCount++;},getBtnCount:function X(g,d){var f=this.btnCount;if(this.mnuCount){f++;}var b=Math.min(f,d);if(b<g){return 0;}if(b===d){if(!R()&&(this.mnuCount||(f>b))){b--;}}return b;},clear:function V(){this.btnCount=0;this.mnuCount=0;this.maxBtnCount=5;this.minBtnCount=1;this.types=[];this.groups=[];this.labels=[];this.actions=[];this.checked=[];this.icons=[];},size:function Z(){return this.labels.length;}};W.clear();return W;};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._SupportsEllipsisText","mstrmojo.android.ui.Label","mstrmojo.android.ui.Menu","mstrmojo.css");var I=mstrmojo.css,B="oversize",E="multiline",K=[B,E];mstrmojo.android.ui.TitleLabel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._SupportsEllipsisText],{scriptClass:"mstrmojo.android.ui.TitleLabel",markupString:'<div id="{@id}" class="mstrmojo-AndroidTitleLabel {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},children:[{scriptClass:"mstrmojo.android.ui.Label",alias:"lbl",touchTap:function(){mstrApp.closeAllDialogs();var P=this.parent,O=P.list,M=O.items,N=M&&M.length;if(!O.visible&&N){if(P._isDropDown&&N===2){O.singleSelect((!O.selectedIndex)?1:0);}else{O.set("visible",true);if(mstrMobileApp&&mstrMobileApp.genMapPreview){mstrMobileApp.genMapPreview();}}}}},{scriptClass:"mstrmojo.android.ui.Menu",alias:"list",selectionPolicy:"reselect",visible:false,setMaxWidth:true}],addChildren:function L(O,M,N){this._super(O,M,N);this.list.attachEventListener("selectionChange",this.id,function(P){var Q=P.added,S=this.list;S.set("visible",false);if(mstrMobileApp&&mstrMobileApp.showMapView){mstrMobileApp.showMapView(0);}if(!Q){return ;}var R=S.items[Q[0]];if(R.isTitle){return ;}if(this._isDropDown){this.setText(R.n);}this.raiseEvent({name:"listSelectionMade",item:R});});},onRender:function J(){var M=this._testLbl=this.lbl.domNode.cloneNode(false),N=this.domNode;mstrmojo.css.addClass(M,"test");M.removeAttribute("onclick");M.removeAttribute("id");N.insertBefore(M,N.lastChild);},unrender:function H(M){delete this.testLbl;this._super(M);},setText:function D(M){this.checkTextFit(M);},checkTextFit:function A(R){var M=this.lbl,T=M.domNode,P=this._testLbl,Q=this._compOffset;R=(R===undefined)?M.text:R;if(Q===undefined){var N=I.getComputedStyle(T);Q=parseInt(N.paddingLeft,10)+parseInt(N.paddingRight,10);this._compOffset=Q;}P.style.width=(T.parentNode.offsetWidth-Q)+"px";P.innerHTML=R;var O=T.offsetHeight,S=(P.offsetHeight>O);I.toggleClass(T,K,S);M.set("text",R);if(S){if(!this.ellipsize("ttl",T,true)){I.addClass(P,B);P.innerHTML=T.innerHTML;if(P.offsetHeight===O){I.removeClass(T,E);}I.removeClass(P,K);}}},setListItems:function G(M,P){var Q=(M&&M.length),N=(P!==undefined),O=this.list;I.toggleClass(this.domNode,"has-items",Q);this._isDropDown=!!N;if(Q){if(!N){M=[{n:mstrmojo.desc(9850,"RECENTLY OPENED"),isTitle:true}].concat(M);}else{this.setText(M[P].n);}}O.set("items",M);if(N){O.singleSelect(P,true);}},clearListItems:function C(){var N=this.list,M={items:[].concat(N.items),idx:N.selectedIndex};mstrmojo.css.removeClass(this.domNode,"has-items");N.set("items",[]);return(M.idx>-1)?M:null;},reset:function F(){this.list.set("visible",false);this.checkTextFit();}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ScrollableTabs","mstrmojo.css","mstrmojo.dom","mstrmojo.hash");var A=mstrmojo.css,D=mstrmojo.dom,F=mstrmojo.hash;mstrmojo.android.ui.LayoutSelector=mstrmojo.declare(mstrmojo.android.ui.ScrollableTabs,null,{scriptClass:"mstrmojo.android.ui.LayoutSelector",init:function E(H){this._super(H);var G=this.markupMethods=F.copy(this.markupMethods);G.onvisibleChange=function(){var L=this._hFade;if(L){window.clearTimeout(L);delete this._hFade;}var J=this.items;if(!J||J.length<=1){return ;}var I=!!this.visible,K=this.domNode;if(I){K.style.marginTop=0;}A.toggleClass(K,"open",I);};},initiateFade:function C(G){var H=this.id;this._hFade=window.setTimeout(function(){var I=mstrmojo.all[H];if(I){I.set("visible",false);}},G||2000);},postBuildRendering:function B(){var G=this.id;D.attachEvent(this.domNode,"webkitTransitionEnd",function(){var H=mstrmojo.all[G];if(!H.visible){H.domNode.style.marginTop="-10000px";}});return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate");mstrmojo.MCSUtil=mstrmojo.provide("mstrmojo.MCSUtil",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],getQuaByFunc:function(U,V){var R=this.F,Q=this.Q,T=mstrmojo.array;var S=function(W){if(T.indexOf(R[1],W)!==-1){return true;}else{return false;}};if(V===undefined||V==this._GENERIC){return Q._G;}else{if(S(U)){return(V==this._RANK)?Q._RT:Q._PT;}else{return(V==this._RANK)?Q._RB:Q._PB;}}},getFuncInfo:function(Q,R){var T,S;switch(R){case this.Q._G:T=this._GENERIC;S=0;break;case this.Q._RT:T=this._RANK;S=1;break;case this.Q._RB:T=this._RANK;S=2;break;case this.Q._PT:T=this._PERCENT;S=1;break;case this.Q._PB:T=this._PERCENT;S=2;break;default:return{};}return{ft:T,f:this.F[S][Q]};},getOpIdxByfunc:function(U,V){if(!U||!V){return -1;}var R=this.F,Q=this.Q,T=mstrmojo.array,S=-1;switch(V){case this._GENERIC:S=T.indexOf(R[0],U);break;case this._RANK:case this._PERCENT:S=T.indexOf(R[1],U);if(S==-1){S=T.indexOf(R[2],U);}break;}return S;},getIncludeByOp:function(R){var Q=this.OP;switch(R){case Q._EQUALS:case Q._GREATER_EQUAL:case Q._LESS_EQUAL:case Q._BETWEEN:case Q._IN:return true;}return false;},formatNumber:function(T,R,Q){if(T==B.Q._G){var S=mstrmojo.num;return(Q.fm)?S.formatByMask(Q.fm,R):S.format(Q.cat,Q.dp,Q.curr,R);}else{if(T==B.Q._RB||T==B.Q._RT){return parseInt(R);}else{if(T==B.Q._PB||T==B.Q._PT){return parseFloat(R)+"%";}}}}});var B=mstrmojo.MCSUtil,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,F=[{n:mstrmojo.desc(2795,"Equals"),v:B.OP._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:B.OP._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:B.OP._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:B.OP._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:B.OP._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:B.OP._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:B.OP._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:B.OP._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:B.OP._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:B.OP._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:B.OP._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:B.OP._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var D=function(Y,Q,S,U,T){if(T==2){return Q;}var Z=String(Y).split(";"),W=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(U&&Z&&Z.length>1){Q.code=W;}else{for(var V=0;V<Z.length;V++){var X=parseFloat(Z[V],10);if(isNaN(X)||(S&&((Z[V].match(/^\d+(\.\d+)?%$/)==null&&Z[V].match(/^\d+(\.\d+)?$/)==null)||X<0||X>100))||(!S&&Z[V].match(/\d+$/)==null)){Q.code=W;}if(Q.code!=R){break;}}}if(Q.code!=R){Q.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return Q;};var M=function(Q){Q=parseFloat(Q);if(isNaN(Q)){return"54px";}else{return(Q*72/16)+"pt;";}},P=function(S){if(S.hasRendered){var R=S.domNode.style;R.font=S.font;R.width=M(R.fontSize);}else{var Q=S.font.match(/[^\s]*?pt/)||[];S.cssText=S.cssText+" font:"+S.font+"; width:"+M(Q[0]);}},I=function(Q){if((Q>=8&&Q<=16)||(Q>=23&&Q<=25)||Q==30){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function O(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(Q){if(this._super){this._super(Q);}this._init();},_init:function(T){switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(T){this.cs=[];this.f=this.ft=null;}var U=B.getOpIdxByfunc(this.f,this.ft),Q;if(this.qua==0||this.dt==30){Q=(U==B.OP._IS_NOT_NULL||I(this.dt))?(U==-1)?B.OP._GREATER_EQUAL:U:B.OP._IS_NULL;}else{Q=(U==-1)?B.OP._GREATER_EQUAL:U;}this.set("opId",Q);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId==B.OP._IN||this.opId==B.OP._NOT_IN){for(var S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function C(Q,R){this.da=Q;this.updateExpr(R);},updateExpr:function A(Q){if(Q){this.cs=Q.cs;this.f=Q.f;this.ft=Q.ft;this.qua=Q.qua;}this._init();},onquaChange:function N(Q){this._init(true);this.func.items=(this.qua!=0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!=0)?L:I(this.parent.dt)?F:H;},onchange:function(){var Q=this.parent,R=this.selectedItem;if(R&&R.v!==null&&R.v!==undefined){Q.set("opId",R.v);}if(mstrApp.isMobile&&(R.v===B.OP._IS_NULL||R.v==B.OP._IS_NOT_NULL)){if(Q.onchange){Q.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){var R=this.parent,Q=this.domNode;R.set("cs1",this.value);if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(R){var Q=R.hWin,U=R.e||Q.event,T=this.parent,S=R.src.domNode;if(U.keyCode===13&&T.apply&&T.apply.enabled){T.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){this.parent.set("cs2",this.value);var Q=this.domNode;if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(R){var Q=R.hWin,T=R.e||Q.event,S=this.parent;if(T.keyCode===13&&S.apply&&S.apply.enabled){S.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var S=this.parent,V=(S.qua==B.Q._PT||S.qua==B.Q._PB);S.cs=[];var T=function(W){return W+((V&&!String(W).match(/^\d+%$/))?"%":"");};var R=function(W,X){return((W==2||W==3)&&X==0)?14:5;};if(S.opId==B.OP._IN||S.opId==B.OP._NOT_IN){var U=String(S.cs1).split(";");for(var Q=0;Q<U.length;Q++){if(!mstrmojo.string.isEmpty(U[Q])){S.cs.push({dtp:5,v:T(U[Q])});}}}else{if(S.vldTbL.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs1)});}if(S.vldTbH.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs2)});}}if(S.onchange){S.onchange();}if(S.makeSelection){S.makeSelection();}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.ToggleDIC","mstrmojo._TouchGestures","mstrmojo.android._HasPreviewButton","mstrmojo.url","mstrmojo.array");mstrmojo.android.inputControls.ToggleDIC=mstrmojo.declare(mstrmojo.ToggleDIC,[mstrmojo._TouchGestures,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.ToggleDIC",useAnimation:false,init:function C(D){this._super(D);mstrmojo.array.forEach(this.dic.vls,function(E){E.n=mstrmojo.url.getAbsoluteURL(E.n,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());});},touchTap:function B(){this.onclick();},onclick:function A(){this._super();this.applyChanges();},onblur:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo._CanGrowOrShrink","mstrmojo.hash");function G(){var M=this.containerNode;if(M){var O=this.getFormats(),R=this._parentSize,P=Math.max((parseInt(O.height,10)||0),R.height),N=Math.max((parseInt(O.width,10)||0),R.width),Q=M.style;Q.width=N+"px";Q.height=P+"px";}}var L=mstrmojo.android.AndroidDocPanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo._CanGrowOrShrink,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.AndroidDocPanel",scrollerSetupDelay:0,postBuildRendering:function A(){if(this._isInfWin){G.call(this);}return this._super();},updatePanelDimensions:function D(Q,M,P,N){this._parentSize={height:M,width:P};var O="px";if(N){this._isInfWin=true;G.call(this);}this.cssText="left:"+Q+"px;top:0;height:"+M+O+";width:"+P+O+";";if(this.hasRendered){var R=this.domNode.style;R.left=Q+O;R.height=M+O;R.width=P+O;this.updateScroller();}},update:function E(M){this.scrollerConfig={bounces:false,showScrollbars:false};},onchildRenderingChange:function I(M){this._super(M);if(this.getFormats().overflow==="auto"){this.performCanGrowCanShrink([(M&&M.src)||M],(!!this._isInfWin&&!mstrApp.isTablet()));}},touchTap:function B(){var M=this.controller;if(M&&M.viewTap){M.viewTap();}},getCanGrowShrinkNode:function K(){return this.containerNode;},afterCanGrowShrink:function C(){this.updateScroller();},updateScrollerConfig:function F(){var M=this._super();if(this.getFormats().overflow==="auto"){var P=this.containerNode,O=this._parentSize,N={Height:{a:"y",s:"v"},Width:{a:"x",s:"h"}},Q={};M.scrollEl=P;mstrmojo.hash.forEach(N,function(U,T){var R=O[T.toLowerCase()];var V=Math.max(P["offset"+T]-R,0),S=M[U.s+"Scroll"]=(V!==0);if(S){Q[U.a]={start:0,end:V};}});M.offset=Q;M.origin=M.origin||{x:0,y:0};}return M;}});var J=L.prototype.formatHandlers,H="containerNode";J[H]=J[H].concat("D");}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate");var A=mstrmojo.css,D=mstrmojo.validation,H=D.TRIGGER,G=D.STATUSCODE,E=mstrmojo.TextBox.prototype.markupMethods;mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,markupMethods:{onvisibleChange:E.onvisibleChange,onvalueChange:E.onvalueChange,onenabledChange:E.onenabledChange,onreadOnlyChange:E.onreadOnlyChange,ontooltipChange:E.ontooltipChange,onvalidationStatusChange:function(){var M=this.validationStatus;if(!M){return ;}var L=this.inputNode,J=(M.code>G.VALID),K=this.constraints.invalidCssClass;A.toggleClass(L,K?K:["mstrmojo-TextBox-ErrValidation"],J);if(J){L.setAttribute("title",M.msg);}else{if(this._original_tooltip!==undefined&&this._original_tooltip!==null){L.setAttribute("title",this._original_tooltip);}}}},postBuildRendering:function I(){if(this._super){this._super();}this._original_tooltip=this.inputNode.title;},prekeyup:function B(J){if(this._super){this._super(J);}var L=(this.constraints.trigger&H.ONKEYUP)>0;if(L){if(this.validationDelay>0){if(this._valDelayTimer){window.clearTimeout(this._valDelayTimer);}if(!this._validateHandler){var K=this;this._validateHandler=function(){K.validate();if(K._valDelayTimer){window.clearTimeout(K._valDelayTimer);delete K._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(this._validateHandler,this.validationDelay);}else{this.validate();}}},preinput:function(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONKEYUP)>0;if(K){this.validate();}},preblur:function F(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONBLUR)>0;if(K){this.validate();}},clearValidation:function C(){if(this._super){this._super();}var K=this.inputNode,J=this.constraints.invalidCssClass;A.removeClass(K,J?J:["mstrmojo-TextBox-ErrValidation"]);K.title=this._original_tooltip;}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._TouchGestures","mstrmojo.css","mstrmojo.dom");var E=500,B=mstrmojo.css;var C={onkeyup:function(H,I){var J=H._searchTimer;if(J){window.clearTimeout(J);}H._searchTimer=window.setTimeout(function(){H.searchFunc(I);delete H._searchTimer;},E);},onEnter:function(H,I){H.searchFunc(I);}};mstrmojo.android.ui.SearchBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._TouchGestures],{searchResult:null,searchStrategy:C,searchFunc:mstrmojo.emptyFn,clearFunc:mstrmojo.emptyFn,monitorInputs:true,clearSearch:function G(){this.clearFunc();},onkeyup:function D(){},onEnter:function A(){this.searchStrategy.onEnter(this,this.searchValue||this.value);delete this.searchValue;},onvalueChange:function F(){B.toggleClass(this.domNode,"clear",!!this.value.length);},touchTap:function(H){var I=this.domNode,J=H.evt;if(H.pageX-mstrmojo.dom.position(J.target).x>(I.offsetWidth-parseInt(B.getStyleValue(I,"paddingRight"),10))){this.set("value","");this.clearSearch();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox");mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur ></textarea>',maxLength:256,markupSlots:{inputNode:function(){return this.domNode;}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncssClassChange=function(){this.domNode.className="mstrmojo-TextArea "+(this.cssClass||"");};},onkeydown:function(D){var C=(this.value&&this.value.length)||0;if(this.maxLength<=C){this.isDeleteKeys=D.e.keyCode===8||D.e.keyCode===46;this.isArrowKeys=D.e.keyCode===37||D.e.keyCode===38||D.e.keyCode===39||D.e.keyCode===40;var B=(this.domNode.selectionEnd!==undefined)?(this.domNode.selectionEnd-this.domNode.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!B){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var A=this.domNode;A.blur();window.setTimeout(function(){A.focus();},1);}mstrmojo.dom.preventDefault(window,D.e);return false;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.css","mstrmojo.array");mstrmojo.android.ui.TextInput=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.android.ui.TextInput",markupString:'<div id="{@id}" class="mstrmojo-AndroidTextInput {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onlabelTxtChange:function(){var D=this.lbl,E=this.labelTxt;D.set("visible",!!E);D.set("text",E||"");},ontextValueChange:function(){this.txt.set("value",this.textValue||"");},ontextTypeChange:function(){this.txt.set("type",this.textType||"text");}},labelTxt:"",textValue:"",textType:"text",init:function C(E){this._super(E);this.parent.attachEventListener("widthChange",this.id,function(G){var H=parseInt(G.value,10),F=this.txt.domNode,I=mstrmojo.css.getComputedStyle(F);mstrmojo.array.forEach(["padding","margin"],function(J){H-=parseInt(I[J+"Left"],10);H-=parseInt(I[J+"Right"],10);});F.style.width=H+"px";});var D=this.getTextCfg();D.alias="txt";D.cssDisplay="block";this.addChildren([D,{scriptClass:"mstrmojo.Label",cssClass:"lblErr",alias:"lblErr",visible:false}]);},getTextCfg:function B(){return{scriptClass:"mstrmojo.TextBox",onEnter:function(){var D=this.parent,E=D.onEnter;if(E){E.call(D,this.value);}}};},getValue:function A(){return this.txt.value;},children:[{scriptClass:"mstrmojo.Label",alias:"lbl"}],onRender:function(){this._super();this.txt.focus();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.TextBox");mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="mstrmojo-TextBoxWithLabel {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;}},preBuildRendering:function(){this.markupMethods=mstrmojo.hash.copy({onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.domNode.className="mstrmojo-TextBoxWithLabel "+(this.cssClass||"");}},mstrmojo.hash.copy(this.markupMethods));}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocLayout");function F(P){var N=-1,O=P.children,M,L,K,I,J=[],H=function(){var R;for(R in J){var Q=J[R];if(Q._fixedHeight!==N){Q._fixedHeight=N;if(Q.domNode){Q.domNode.style.height=N+"px";}}}N=-1;J=[];};for(L in O){M=O[L];if(M.node.data.bh&&N>-1){H();}if(M.defn.horiz){for(K in M.children){I=M.children[K];N=Math.max(I._fixedHeight||0,N);J[J.length]=I;}}}H();}mstrmojo.DocLayoutHoriz=mstrmojo.declare(mstrmojo.DocLayout,null,{scriptClass:"mstrmojo.DocLayoutHoriz",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},getWidth:function A(){return this.containerNode.offsetWidth;},getHeight:function G(){return this.containerNode.offsetHeight;},_renderSection:function C(L,I){if(L.node.data.bh){var M=document.createElement("div");M.className="mstrmojo-DocLayout-HBox";var J=document.createElement("table");J.className="mstrmojo-DocLayout-HBox-HorizContainerTable";this._hRow=J.insertRow(-1);M.appendChild(J);this.containerNode.appendChild(M);}if(L.defn.horiz){var H="hi"+I;L.slot=H;var N=this._hRow.insertCell(-1);N.vAlign="top";var K={};K[H]=N;this.addSlots(K);}this._super(L,I);},getLayoutMinWidth:function B(){var I=0,Q=0,J=this.children,P=J.length,N,M;for(N=0;N<P;N++){var O=J[N],L=O&&O.node,H=L&&L.data,K=H&&(String(H.bh)==="true"||String(H.bv)==="true");if(K){I=Math.max(I,Q);Q=0;}if(O.children){for(M in O.children){Q+=O.children[M].width();}}else{Q+=10;break;}}return Math.max(I,Q);},resizeOrReposition:function E(){if(this._super){this._super();}F(this);},renderCtrlsInViewport:function D(){this._super();F(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var H=mstrmojo.func.composite,F=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(O){if(O){return ;}var M=this.visible,N=M?"block":"none";this.editorNode.style.display=N;if(this.modal){this.curtainNode.style.display=N;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function I(){var M;var N=this.buttons;if(N&&!this.btnHbox){for(M in N){N[M].cssClass="mstrmojo-Editor-button";}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:N},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function D(){var M=this.placeholder;if(this._super()){if(!this.parent&&!M){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function G(){var M=this.id;return function(){var N=mstrmojo.all[M];N.resizeDialog();N.positionDialog();};},postBuildRendering:function B(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var M=this._resizeHandler=this.getResizeHandler();F.attachEvent(window,"resize",M);}this.resizeDialog();this.positionDialog();this.domNode.focus();return true;},resizeDialog:function J(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function E(){var N=this,R=N.curtainNode,M=document.body,P=document.documentElement,Q=R.style,O=N.curtainPosition;Q.width=Math.max(M.clientWidth,P.scrollWidth)+"px";if(O&&O.h){Q.height=O.h+"px";}else{Q.height=Math.max(M.clientHeight,P.scrollHeight)+"px";}if(O&&O.y){Q.top=O.y+"px";}N.raiseEvent({name:"resizeCurtain"});},positionDialog:function K(){if(!this.left||!this.top){var M=this.editorNode;F.center(M);if(this.alignment==="top"){M.style.top="10px";}}},destroy:function(N){var M=this._resizeHandler;if(M){F.detachEvent(window,"resize",M);}this._super(N);}});if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.confirm=function A(P,N,O){var Q="mojoConfirmx9",M=function(){mstrmojo.all[Q].destroy();};mstrmojo.array.forEach(N,function(R){var S=R.onclick;R.onclick=S?H([M,S]):M;});mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:N,children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.alert=function C(P,M,O){var Q="mojoAlertx9";try{mstrmojo.all[Q].destroy();}catch(N){}mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),function(){mstrmojo.all.mojoAlertx9.destroy();if(M){M();}},"#666666")],children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.toast=function L(Q,O){var R="mojoToast9",P,N=O||3000;try{mstrmojo.all[R].destroy();}catch(M){}mstrmojo.insert({id:R,scriptClass:"mstrmojo.Label",cssClass:"toastCss",text:Q}).render();P=mstrmojo.all[R].domNode;document.body.appendChild(P);F.bottomCenter(P);window.setTimeout(function(){mstrmojo.all[R].destroy();},N);};mstrmojo.mask={};mstrmojo.mask.show=function(){mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});mstrmojo.mask.win.render();document.body.appendChild(mstrmojo.mask.win.domNode);};mstrmojo.mask.hide=function(){mstrmojo.mask.win.destroy();};}}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo._TouchGestures","mstrmojo.Box","mstrmojo.Label","mstrmojo.dom","mstrmojo.css");var Z=mstrmojo.css;mstrmojo.requiresDescs(2901,8445);function U(){var l="rootPortrait",j="rootLandscape",k=this.domNode;if(mstrApp.isLandscape()){var h=l;l=j;j=h;}Z.removeClass(k,j);Z.addClass(k,l);}mstrmojo.android.ui.RootView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.RootView",markupString:'<div id="{@id}" class="mstrmojo-RootView {@cssClass}" style="{@cssText}" ><div class="mstrmojo-RootView-title"></div><div class="mstrmojo-RootView-content"></div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{titleNode:"auto",containerNode:"100%"},w:{titleNode:"100%",containerNode:"100%"}},preBuildRendering:function D(){Z.addClass(document.body,"dpi"+mstrMobileApp.getDeviceDPI());if(!this.msgBox){var j=this.msgBox=new mstrmojo.Box({placeholder:"mainAppMsg",cssClass:"mstrmojo-RootViewMessage",cssText:"left:-10000px;",children:[{scriptClass:"mstrmojo.Label",alias:"lbl",text:mstrmojo.desc(2901,"Loading...")}]});j.render();}var h=mstrApp.viewFactory;this.addChildren([h.newView("ActionBar",{slot:"titleNode",alias:"actionBar",controller:mstrmojo.all[this.controllerId]}),h.newView("Switcher",{slot:"containerNode",alias:"switcher"})]);return this._super();},postBuildRendering:function Y(){U.call(this);var h=this.titleNode;if(!this._tchHandler){this._tchHandler=mstrmojo.touchManager.attachEventListener("actionBarMenuStateChange",this.id,function(j){if(j.value){Z.addClass(h,"top");}else{Z.removeClass(h,"top");}});}return this._super();},unrender:function W(h){if(this._tchHandler){mstrmojo.touchManager.detachEventListener(this._tchHandler);delete this._tchHandler;}this._super(h);},setNavigation:function d(j,h){this.actionBar.setNavigation(j,h);},getTitleHeight:function B(){return this.titleNode.offsetHeight;},clearNavigation:function O(){this.actionBar.clearNavigation();},restoreNavigation:function X(){this.actionBar.restoreNavigation();},selectNavigationItem:function G(h){return this.actionBar.selectNavigationItem(h);},hasNavigationItems:function Q(){return this.actionBar.getNavList().items.length>0;},reset:function a(){this.actionBar.reset();},setContent:function J(h,j){this.reset();this.switcher.switchView(h,j);},contentUpdated:function N(){this.reset();},setTitle:function M(h){this.actionBar.updateTitle(h);},setActionToolbar:function P(j,h){this.actionBar.updateToolbar(j,h);},setActionToolbarStatus:function I(h){this.actionBar.setActionToolbarStatus(h);},setUpStatus:function f(h){this.actionBar.setUpStatus(h);},updateLastOpened:function S(h){this.actionBar.setLastOpened(h);},monitorWindow:function F(){var h=mstrApp.getScreenDimensions();this._super({currentTarget:{innerWidth:h.w,innerHeight:h.h}});U.call(this);mstrmojo.all[this.controllerId].set("orientation",(mstrMobileApp.getOrientation()===mstrmojo.android.EnumOrientationTypes.PORTRAIT)?1:0);window.setTimeout(function(){mstrMobileApp.setWaitScreenVisibility(false);},0);},setDimensions:function T(l,k){this._super(l,k);var j=this.msgBox;j.set("height",this.height);j.set("width",this.width);},getBrowserDimensions:function(){var j=mstrApp.getScreenDimensions(),h="px";return{h:j.h+h,w:j.w+h};},getContentDimensions:function b(){var h=this.containerNode;return{h:h.clientHeight,w:h.clientWidth};},showMessage:function L(h){mstrMobileApp.showProgress([h||mstrmojo.desc(8445,"Loading")],false);},showHTMLProgress:function K(p){var l=this.msgBox,o=l.domNode.style,k=l.lbl,j=k.domNode,h=j.style;k.set("text",p||mstrmojo.desc(2901,"Loading..."));h.left=Math.round(parseInt(this.width,10)/2-j.offsetWidth/2)+"px";h.top=Math.round(parseInt(this.height,10)/2-j.offsetHeight/2)+"px";o.left=0;o.top=0;Z.addClass(l.domNode,"active");o.opacity=1;},hideMessage:function R(){mstrMobileApp.hideProgress();},hideHTMLProgress:function H(){var h=this.msgBox.domNode,j=h.style;j.opacity=0;j.left="-10000px";Z.removeClass(h,"active");},enterFullScreen:function V(){this.actionBar.enterFullScreen();},flashFullScreen:function g(){this.actionBar.flashFullScreen();},exitFullScreen:function E(h){this.actionBar.exitFullScreen(h);},cancelFlashFullScreen:function A(){return this.actionBar.cancelFlashFullScreen();},propogateMenuVisibleChange:function C(h){this.actionBar.propogateMenuVisibleChange(h);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout");mstrmojo.Overlay=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height?this.height:"";},onwidthChange:function(){this.domNode.style.width=this.width?this.width:"";}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},scriptClass:"mstrmojo.Overlay"});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ListBase","mstrmojo._IsList");var F=",";mstrmojo.TableLayoutList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.TableLayoutList",cssClass:"mstrmojo-TableLayoutList",styleCssClass:"",itemIdField:"v",allowUnlistedValues:false,tableLayoutCssStyle:"auto",multiSelect:false,titleItems:null,items:null,itemsPerRow:0,getLeftEndTitle:function E(G){return"";},getRightEndTitle:function D(G){return"";},getTitleRowMarkup:function A(){var K=this.titleItems;if(K){var H='<tr><td class="left_text">'+this.getLeftEndTitle(-1)+"</td>",G=K.length,J=0,I;for(;J<G;J++){I=K[J];H+='<td class="item_title" title="'+I+'">'+I+"</td>";}H+='<td class="left_text">'+this.getRightEndTitle(-1)+"</td></tr>";return H;}return"";},_markupPrefix:function(){return'<table class="tableLayoutList" style="table-layout:'+this.tableLayoutCssStyle+'" cellspacing="0" cellpadding="0"><tbody>'+this.getTitleRowMarkup();},_markupSuffix:function(){return"</tbody></table>";},getItemMarkup:function(K,H){var J='<{@tag} class="item {@cls}" idx="{@idx}" title="{@n}" style="{@style}">{@n}</{@tag}>',G=this.getLeftEndTitle(H),I=this.getRightEndTitle(H),L=this.itemsPerRow;G='<td class="left_text" title="'+G+'">'+G+"</id>",I='<td class="right_text" title="'+I+'">'+I+"</id>",L=this.itemsPerRow;if(L>0){J=(H%L===0?"<tr>"+G:"")+"<td>"+J+"</td>"+((H+1)%L===0?I+"</tr>":"");}else{J='<td><div class="item_wrapper" idx="'+H+'">'+J+"</div></td>";if(!H){J="<tr>"+G+J;}else{if(H===this.items.length-1){J=J+I+"</tr>";}}}return J;},_getItemNode:function(G){var H=this.itemsNode,J=this.itemsPerRow,I=(this.titleItems?1:0)+((J>0)?parseInt(G/J,10):0),K=1+((J>0)?(G%J):G);return H.rows[I].cells[K].firstChild;},init:function(G){this._super(G);mstrmojo.css.addWidgetCssClass(this,this.styleCssClass);},onchange:function B(){var I,H=[];if(!this.multiSelect){I=this.selectedItem.v;}else{for(var G in this.selectedIndices){H.push(this.items[G].v);}I=H.join(this.delim||F);}this.set("value",I);},postBuildRendering:function C(){this._super();var G=[];if(this.multiSelect){var I=this.value.split(F);for(var H=0;H<I.length;H++){G.push({v:I[H]});}}else{G.push({v:this.value});}this.setSelectedItems(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo._HasBuilder","mstrmojo._IsAnchorable","mstrmojo.dom");var P="mstrmojo-DocInfoWindow-tip",O=1,G=mstrmojo.dom;function C(S,T){var R=G.findWidget(S)||(S&&S.w);while(R){if(R.autoCloseLocked!==undefined){R.autoCloseLocked=T;}R=R.parent;}}function H(S){var R=S.model;return R.getLayoutDataCache(R.getCurrentLayoutKey())[S.psId];}mstrmojo.DocInfoWindow=mstrmojo.declare(mstrmojo.Popup,[mstrmojo._HasBuilder,mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.DocInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div><div class="'+P+' top"></div><div class="mstrmojo-DocInfoWindow-curtain" mstrAttach:click></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.firstChild;}},boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:P,anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,closeOnClick:true,autoCloseLocked:false,tipNodeColor:"",ontouchstart:function J(){this.close();},close:function N(){if(this.autoCloseLocked){return ;}this.model.raiseEvent({name:"infoWindowClosed",psKey:this.psKey});var R=this;window.setTimeout(function(){if(R.anchor){C(R.anchor,false);}},0);if(this._super){this._super();}this.clearAnchorHilites();G.detachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",this.mw);G.attachEvent(document,"scroll",R.mw);},clearAnchorHilites:function B(){var R=mstrmojo.dom.findWidget(this.anchor);if(R&&R.clearHilites){R.clearHilites(R.hiliteKey);delete R.hiliteKey;}},prepareAnchor:function M(){if(this.children&&this.children[0]){var S=this.infoNode.style,T=this.children[0],U=T.dimNode||T.domNode,V=U.offsetWidth,R=U.offsetHeight;S.width=(V+2*O)+"px";S.height=(R+2*O)+"px";}},nudge:function E(){this.positionDialog();this.model.raiseEvent({name:"infoWindowRendered",id:this.id});},onRender:function Q(){this.open(this.opener);},open:function F(X,T){var R=mstrmojo.all[this.psId];if(R){var U=R.defn.sfp,Z=R.selectedIdx;if(U&&Z!==0){R.switchToPanel(0,0);R.children[Z].set("selected",false);}}if(this._super){this._super(X,T);}if(this.anchor){C(this.anchor,true);}if(mstrApp.isTablet&&mstrApp.isTablet()){var Y=mstrmojo.touchManager,S=this.id,W=this.domNode;this._tchHandler=Y.attachEventListener("touchesBegin",S,function(d){if(this.autoCloseLocked){return ;}var b=mstrmojo.dom.contains(W,d.touch.target,true);var g=document.getElementsByClassName("heatmap-infobox"),a=(g&&g.length)||0,f,j=d.touch.target,h=false;for(f=0;f<a;f++){if(mstrmojo.dom.contains(g[f],j,true)){h=true;break;}}if(!b&&!mstrApp.hasOpenDialog()&&!h){this.closeOnTablet();}});}var V=this;V.mw=V.mw||function(a){if(V.autoCloses&&!G.contains(V.domNode,G.eventTarget(self,a),true,document.body)){V.close();}};G.attachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",V.mw);G.attachEvent(document,"scroll",V.mw);},getChildren:function I(){return[H(this)];},preBuildRendering:function K(){var T=H(this),S=T.defn.fmts;S.left=O+"px";S.top=O+"px";if(S.border){var R=S.border.split(" ");if(R.length>=3){this.tipNodeColor=R[2];}}if(this._super){this._super();}},postBuildRendering:function A(){this.set("visible",true);if(this._super){this._super();}if(!this.closeOnClick){this.curtainNode.style.display="none";}},closeOnTablet:function L(){this.close();if(this._tchHandler){this._tchHandler.clear();}}});var D=mstrmojo.DocInfoWindow;D.PLACEMENT={AUTO:1,FIXED:2,ABOVE:3,BELOW:4,LEFT:5,RIGHT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayoutViewer","mstrmojo._Formattable","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.dom");function J(g){var h,V=this._newLinks,f=mstrmojo.hash.copy(V,this._allLinks),h=g?f:V;this._newLinks={};if(mstrMobileApp.isOnline()){return ;}var X=this.controller,W,a,Y=[],j=[],b;for(W in h){a=h[W];b=X.getLinkRequest(a);if(b){Y.push(b);j.push(a);}}var Z=Y.length;if(Z){var d=function(k){for(W=0;W<Z;W++){a=j[W];a.src.setLinkEnabled(k[W]);}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(Y,{success:d,failure:mstrmojo.emptyFn});}}}function D(){var X=this.children,W,V;for(W=0,V=(X&&X.length)||0;W<V;W++){var Z=X[W],Y=Z.slot;if(Y){this.setSlotDimensions(Y,Z.height,Z.width);}}}mstrmojo.MobileDocLayoutViewer=mstrmojo.declare(mstrmojo.DocLayoutViewer,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.MobileDocLayoutViewer",layoutConfig:{h:{groupBy:"0",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"0"},w:{layout:"100%"}},formatHandlers:{domNode:["background-color"]},scrollerConfig:{vScroll:false,hScroll:false,bounces:false,showScrollbars:false},usesTouches:true,init:function O(V){this._super(V);this._newLinks={};this._allLinks={};},postBuildRendering:function T(){this._super();if(this.fixedFooterNode.clientHeight>0){D.call(this);}},preBuildRendering:function B(){this._super();this._scrollCssText="overflow:"+((!mstrmojo.dom.isWinPhone)?"hidden":"auto");var W=this.id,V=this.updateScroller;if(!this.afterScrollSubscr){this.afterScrollSubscr=this.docLayout.attachEventListener("afterScroll",W,function(){this.updateScroller();J.call(this);});this.model.attachEventListener("partialUpdate",W,V);}},mapID:null,setMapID:function I(V){this.mapID=V;},beforeViewHidden:function E(V){if(!this.mapID){return ;}var W=mstrmojo.all[this.mapID];if(W&&W.beforeViewHidden){W.beforeViewHidden(V);}this.mapID=null;},updateScrollerConfig:function R(){var W=this.scrollerConfig,Y=this.docLayout.containerNode;if(Y){var a=this.docLayout,X={start:0,end:Math.max(a.getWidth()-this.scrollboxWidth,0)},d={start:0,end:Math.max(a.getHeight()-this.scrollboxHeight,0)},V=(d.start!==d.end),Z=(X.start!==X.end),b;if(V||Z){b={x:X,y:d};}else{W.origin={x:0,y:0};}mstrmojo.hash.copy({scrollEl:this.scrollboxNode.firstChild,offset:b,vScroll:V,hScroll:Z,showScrollbars:false},W);if(!W.origin){W.origin=this._origin={x:0,y:0};}a.scrollBuffer=parseInt(mstrApp.rootView.getContentDimensions().h,10);}return this._super();},initScroller:function M(V){this._super(V);V.attachEventListener("scrollDone",this.id,function(W){this._origin={x:W.x,y:W.y};this.notifyScrollListeners(W);});},touchBegin:function N(W){var V=this.parent;if(V&&V.isAnimating&&V.isAnimating()){W.stop();return false;}return this._super(W);},shouldTouchBubble:function K(V){if(mstrmojo.dom.contains(this.scrollboxNode,V.target,true,this.domNode)){return this._super(V);}return true;},touchSwipeBegin:function L(X){if(this.shouldTouchBubble(X)){var W=this.parent,V=W.canScroll&&W.canScroll(X);if(V){this._parentScrolling=true;W.beginScroll(X);}return V;}this._super(X);},touchSwipeMove:function A(V){if(this._parentScrolling){this.parent.scroll(V);return ;}this._super(V);},touchSwipeEnd:function P(V){V.evt.handled=true;if(this._parentScrolling){delete this._parentScrolling;this.parent.endScroll(V);return ;}this._super(V);},touchTap:function S(){var V=this.controller;if(V&&V.viewTap){V.viewTap();}},renderChildren:function F(){this._super();this.updateScroller();},unrender:function Q(){delete this.scrollerConfig.origin;var V=this._scroller;if(V){delete V.origin;}if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}if(this.afterScrollSubscr){mstrmojo.publisher.unsubscribe(this.afterScrollSubscr);delete this.afterScrollSubscr;}this._super();},addLinkInfo:function H(W,V){this._newLinks[W]=V;},onRender:function C(){this._super();if(!this.subscr){var W=mstrmojo.publisher;this.subscr=W.subscribe(W.NO_SRC,W.CONNECTIVITY_CHANGED_EVENT,function(a){if(a){var X=this._allLinks,Y,Z;for(Y in X){Z=X[Y].src;if(!Z.linkEnabled){Z.setLinkEnabled(true);}}}else{J.call(this,true);}},this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var V=this;window.setTimeout(function(){J.call(V);},100);}},setSlotDimensions:function U(d,b,Y){if(d==="layout"){var X=parseInt(this.height,10),W=this.fixedHeaderNode.clientHeight,a=this.fixedFooterNode.clientHeight,V=parseInt(b,10),Z=X-W-a;if(W+a>=X){b=0;}else{if(V!=Z){b=Z+"px";}}}this._super(d,b,Y);},getCaptureDimensions:function G(){return this.docLayout.getCaptureDimensions();}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip","mstrmojo.HBox");var B=mstrmojo.dom,C=mstrmojo.css,A=1,G=2,F=3,E=function(I){var H=C.getStyleValue(I,"verticalAlign");return{top:A,bottom:F,middle:G}[H]||A;};mstrmojo.SliderBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SliderBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table></div>',markupSlots:{valuePartNode:function(){return this.domNode.firstChild;},valueLabelNode:function(){return this.domNode.firstChild.firstChild;},valueTextNode:function(){return this.domNode.firstChild.lastChild;},sliderPartNode:function(){return this.domNode.lastChild;},minTextNode:function(){return this.domNode.lastChild.rows[0].cells[0];},maxTextNode:function(){return this.domNode.lastChild.rows[0].cells[2];},sliderNode:function(){return this.domNode.lastChild.rows[0].cells[1];}},markupMethods:{onmaxChange:function(){this.maxTextNode.innerHTML=this.max;},onminChange:function(){this.minTextNode.innerHTML=this.min;},onvalueTextChange:function(){this.valueTextNode.innerHTML=this.valueText;},onunsetChange:function(){var H=this.sliderBar.domNode;if(H){mstrmojo.css.toggleClass(H,"unset",this.unset);}}},tabIndex:-1,sliderRef:null,valueLabel:mstrmojo.desc(4104,"Value:"),valueText:"",min:"",max:"",interval:0,isSequential:false,unset:false,cssClass:"mstrmojo-SliderGroup",postCreate:function D(){if(!this.sliderRef){this.sliderRef={scriptClass:"mstrmojo.Slider",isHoriz:true,ontitleChange:function(){if(this.domNode&&this.title){this.domNode.setAttribute("title",this.title);}},onselectionChange:function(){if(!this.hasRendered){return ;}var I=this.items[this.selectedIndex]&&this.items[this.selectedIndex].n,H=this.parent;if(H.unset){H.unset=false;C.removeClass(this.domNode,"unset");}H.set("valueText",I);H.set("value",I);this.typeHelper.updateThumb();}};}this.sliderRef.slot="sliderNode";this.sliderRef.alias="sliderBar";this.addChildren(this.sliderRef);},preBuildRendering:function(){this._super();var M=this.min,I=this.max,K=mstrmojo.num.parseNumeric(this.value),J=this.items,H,L=this.sliderBar;if(this.isSequential){H=Math.floor((Math.max(Math.min(K,I),M)-M)/this.interval);if(isNaN(K)||K<M||K>I){this.unset=true;}}else{H=mstrmojo.array.find(J,"v",String(K));if(H==-1){this.unset=true;H=0;}}L.set("items",J);L.select(H||0);},postBuildRendering:function(){this._super();if(this.unset){C.addClass(this.sliderBar.domNode,"unset");}},alignSlider:function(K,H){var J=E(K),I,L;if(!this.valuePartNode){L=this.valueCssText||"";I=this.sliderCssText||"";if(J===A){this.valueCssText="top:0;"+L;this.sliderCssText="top:0;"+I;}else{if(J===F){this.valueCssText="bottom:0;"+L;this.sliderCssText="bottom:0;"+I;}else{this.valueCssText="height: 100%; line-height: "+H+"px;"+L;this.sliderCssText="height: 100%;"+I;}}}else{I=this.sliderPartNode.style;L=this.valuePartNode.style;if(J){if(J===A){I.top=L.top="0";}else{if(J===F){I.bottom=L.bottom="0";}else{L.height=I.height="100%";L.lineHeight=inlineHeight+"px";}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo.tooltip","mstrmojo.string","mstrmojo.array");var J=0,H=mstrmojo.array,M=mstrmojo.string;function C(){var Q=this.textNode,S=this.imgNode;if(this.eg!=null){S.style.display="none";Q.innerHTML=this.eg||"";Q.style.display="block";}else{Q.style.display="none";S.style.display="block";if(this.tooltip){S.setAttribute("ttl",this.tooltip);}var R=this.getFormats();this.retrieveGraphSrc(R.height,R.width);}}var N={6:"poly",7:"rect",100:"circle"};function I(){var Z=this.as,V=Z&&Z.length;if(!V){return ;}var U=this.id,Y=U+"_map"+J++,S=[],X=-1,T;for(T=0;T<V;T++){var R=Z[T];R.id=U;R.aid=T;R.tooltip=M.multiReplace(R.tooltip||"",{"&#13":"<br />","&#32":" "});if(!isNaN(R.shape)){R.shape=this.getAreaShapeName(R.shape);}if(R.tks||R.tks===""||R.tty===1){R.extra=' href="#" ';}S[++X]=M.apply(this.areaMarkup,R);}var W='<map id="'+Y+'" name="'+Y+'">'+S.join("")+"</map>";if(!this.domNode){this.att='usemap="#'+Y+'" ';this.map=W;}else{var Q=document.createElement("div");Q.innerHTML=W;if(this.mapNode){Q=Q.firstChild;this.mapNode.innerHTML=Q.innerHTML;}else{this.imgNode.setAttribute("usemap","#"+Y);this.mapNode=this.domNode.appendChild(Q.firstChild);}}}var D=mstrmojo.GraphBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GraphBase",cssClassPrefix:"mstrmojo-GraphBase",markupString:'<div id="{@id}" class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><img {@att}src="../images/1ptrans.gif" class="{@cssClassPrefix} {@cssImageClass}"/>{@map}</div>',att:"",map:"",cAreaIdx:-1,useRichTooltip:true,markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},preBuildRendering:function K(){I.call(this);return this._super();},postBuildRendering:function A(){C.call(this);return this._super();},setModel:function P(Q){this.model=Q;},updatingTooltipHelper:function B(U,d,X){var R=U&&U.getAttribute("aid"),Q=U&&U.getAttribute("ttl"),T=U.getAttribute("SC"),W={refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,contentNodeCssClass:"gp-tooltip"},b=(this.model.zf||1)+"em";if(R==this.cAreaIdx){return ;}this.cAreaIdx=R;W.content=Q;var S="font-size:"+b+";";if(T){S+="border-color:#"+T;}W.contentNodeCssText=S;var Y=U.getAttribute("coords"),a=99999,Z=99999;if(!X){if(Y&&Y.length>0){Y=Y.split(",");var V=0;while(V+1<Y.length){a=Math.min(a,parseInt(Y[V++],10));Z=Math.min(Z,parseInt(Y[V++],10));}}}if(a===99999){a=d.x;}if(Z===99999){Z=d.y;}W.top=Z;W.left=a;this.richTooltip=null;this.set("richTooltip",W);},refresh:function G(){if(!this.hasRendered){return ;}C.call(this);var Q=this.getFormats();if(Q.height&&Q.width){this.refreshMap();}},refreshMap:function O(){I.call(this);},getAreaShapeName:function F(Q){return N[parseInt(Q,10)]||"default";}});var E=D.tooltipCLS="mstrmojo-mobileGraph-Tooltip-content",L=D.canvasCLS="mobile-graph-highlight-canvas";D.hideTooltips=function(){H.forEach(document.getElementsByClassName(E),function(Q){Q.style.display="none";});H.forEach(document.getElementsByClassName(L),function(Q){Q.getContext("2d").clearRect(0,0,Q.width,Q.height);Q.width=Q.width;});};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip");var T=mstrmojo.dom;var K=mstrmojo.all;mstrmojo._HasDnD={postBuildRendering:function V(){if(this._super){this._super();}var Y=this.id;this.dnd=new mstrmojo._DnDComponent({target:this});this.__mouseDownEvt=function(Z){K[Y].dnd.onmousedown(Z);return true;};T.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);},unrender:function U(){if(this.__mouseDownEvt&&this.dndNode){T.detachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);}this.min=0;this.max=(this.items&&this.items.length-1)||0;this.dnd&&this.dnd.clearListeners();this._super();}};mstrmojo._DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo._DnDComponent",isDragging:null,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,_mousemoveCounter:0,init:function J(Y){mstrmojo.hash.copy(Y,this);},onmousedown:function X(Y){if(Y&&Y.preventDefault){Y.preventDefault();}if(this.dragging){return true;}var Z=this.target.id;if(!this._mousemoveCallback){this._mousemoveCallback=function(a){K[Z].dnd.onmousemove(a);return true;};}this._mousemoveCounter=0;this.startE=mstrmojo.hash.copy(Y);T.attachEvent(document.body,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(a){K[Z].dnd.ondragcancel(a);return true;};}T.attachEvent(document.body,"mouseup",this._cancelCallback);},ondragcancel:function H(Y){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);if(this.afterDragCancel){this.afterDragCancel.apply(this.target,[Y]);}},onmousemove:function D(Y){if(this.dragging){return ;}this._mousemoveCounter++;if(this._mousemoveCounter>this.mousemoveBuffer){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);this.initDrag(Y);}},initDrag:function S(Y){this.dragging=true;var Z=this.target.id;if(!this._dragCallback){this._dragCallback=function(a){K[Z].dnd.ondrag(a);return true;};}T.attachEvent(document.body,"mousemove",this._dragCallback);if(!this._dragEndCallback){this._dragEndCallback=function(a){K[Z].dnd.ondragend(a);return true;};}T.attachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragStart){this.afterDragStart.apply(this.target,[Y]);}this._dragCallback(Y);},ondrag:function F(Y){if(this.duringDrag){this.duringDrag.apply(this.target,[Y]);}},ondragend:function E(Y){this.dragging=false;T.detachEvent(document.body,"mousemove",this._dragCallback);T.detachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragEnd){this.afterDragEnd.apply(this.target,[Y]);}},clearListeners:function I(){if(this._mousemoveCallback){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._cancelCallback){T.detachEvent(document.body,"mouseup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){T.detachEvent(document.body,"mousemove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){T.detachEvent(document.body,"mouseup",this._dragEndCallback);delete this._dragEndCallback;}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasDnD","mstrmojo._ListSelections");function B(Y){this.getUnit=function Z(){return Y._effLen/(Y.items.length-1)||1;};this.calcMinMax=function(b,a){var d=Math.round((b/Y.unit+a/Y.unit)/2);return{min:d,max:d};};this.preUpdateThumb=function(){Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";";};this.updateThumb=function(){Y.containerNode.style[Y.orCfg.posCssP]=Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";};}function P(Y){this.getUnit=function(){return Y._effLen/Y.items.length;};this.calcMinMax=function(a,Z){return{min:Math.floor(a/Y.unit+0.5),max:Math.floor(Z/Y.unit-0.5)};};this.preUpdateThumb=function(){Y.start=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),0)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";"+Y.orCfg.lenCssP+":"+Y.length+";";};this.updateThumb=function(){Y.start=Y.min*Y.unit+"px";Y.containerNode.style[Y.orCfg.posCssP]=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),1)+"px";Y.containerNode.style[Y.orCfg.lenCssP]=Y.length;};}var L="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasDnD,mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:0,useRichTooltip:true,init:function R(Y){this._super(Y);if(Y.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(Y.multiSelect){this.typeHelper=new P(this);}else{this.clsType="sc1";this.typeHelper=new B(this);}},markupSlots:{dndNode:function(){return this.domNode.childNodes[0];},bgNode:function(){return this.domNode.childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0];},frontNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[0];},thumbNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[1];},endNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[2];},tooltipNode:function(){return this.domNode.childNodes[0].childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,preBuildRendering:function A(){var f=this.orCfg.lenCssP,a=this[f],Z=parseInt(a);this._effLen=isNaN(Z)?0:(Z-this._exRoom);if(a){this.bkCssText=f+":"+Math.max(parseInt(a,10)-(2*this.cssBkBW),0)+"px;";this.sdcCssText=f+":"+this._effLen+";"+this.orCfg.posCssP+":"+this._exRoom/2+"px;"+this.orCfg.opPosCssP+":0px;";}var Y=this.selectedIndices;if(!mstrmojo.hash.isEmpty(Y)){this.min=this.items.length-1;this.max=0;for(var b in Y){if(Y[b]){this.min=Math.min(this.min,b);this.max=Math.max(this.max,b);}}}this.unit=this.typeHelper.getUnit();this.typeHelper.preUpdateThumb();},postBuildRendering:function V(){if(this._super){this._super();}if(this.items.length>1&&this.dnd){this.dnd.afterDragStart=this.initDrag;this.dnd.duringDrag=this.ondrag;this.dnd.afterDragEnd=this.ondrop;this.dnd.afterDragCancel=this.cancelDrag;}},_initGhost:function O(){if(!this.ghost){var b=this.containerNode.cloneNode(true);mstrmojo.css.addClass(b,["gh"]);this.ghost={containerNode:b,frontNode:b.childNodes[0],thumbNode:b.childNodes[1],endNode:b.childNodes[2]};this.sdcNode.appendChild(b);}var Z=this.ghost.containerNode.style,a=this.containerNode.style,Y=this.orCfg;Z[Y.posCssP]=a[Y.posCssP];Z[Y.lenCssP]=a[Y.lenCssP];Z.display="block";return this.ghost;},initDrag:function S(b,Y){Y=Y||window;var a=this._initGhost(),Z=this.orCfg;this.dnd.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:a.containerNode[Z.lenP],offset:T.getMousePosition(this.dnd.startE,Y)[Z.offsetP]};this.dnd.initD.td=T.eventTarget(Y,this.dnd.startE);},ondrag:function F(j,f){f=f||window;var k=this.dnd.initD,h=this.ghost,o=h.containerNode,q,a,Z,d=this.min,l=this.max,Y=this.orCfg;var p=T.getMousePosition(j,f)[Y.offsetP]-k.offset;switch(k.td){case this.thumbNode:q=Math.max(Math.min(k.tP+p,k.sL-k.contL),0);a=q+k.contL;o.style[Y.posCssP]=q+"px";var b=this.typeHelper.calcMinMax(q,a);d=b.min;l=b.max;break;case this.frontNode:q=Math.max(Math.min(k.tP+p,k.tP+k.contL),0);Z=Math.max(Math.min(k.contL-p,k.tP+k.contL),0);o.style[Y.posCssP]=q+"px";o.style[Y.lenCssP]=Z+"px";d=Math.min(Math.floor(q/this.unit+0.5),this.max);break;case this.endNode:Z=Math.max(Math.min(k.contL+p,k.sL-k.tP),0);a=k.tP+Z;o.style[Y.lenCssP]=Z+"px";l=Math.max(Math.floor(a/this.unit-0.5),this.min);break;default:return ;}if(d!==this.min||l!==this.max){this.min=d;this.max=l;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function W(a){this.typeHelper.updateThumb();if(this.ghost){this.ghost.containerNode.style.display="none";}this.hideTooltip();if(this.items&&this.items.length){var Z=[];for(var Y=this.min;Y<=this.max;Y++){Z.push(Y);}this.select(Z);}this.dnd.initD=null;},cancelDrag:function Q(Z,Y){if(this.makeSelection){Y=Y||window;var a=T.eventTarget(Y,this.dnd.startE);this.makeSelection({selItem:a});}},showTooltip:function C(Z,Y){this._updateTooltip();this._super(Z,Y);},hideTooltip:function G(Z,Y){if(this.dnd&&this.dnd.dragging){return ;}this._super(Z,Y);},_updateTooltip:function N(){var Z=this.orCfg,b={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},d=(this.ghost)?this.ghost.containerNode:this.containerNode;b[Z.opPosCssP]=0;b[Z.posCssP]=d.style[Z.posCssP];if(this.items&&this.items.length){var a=this.getItemTooltip(this.items[this.min]);var Y;if(this.min===this.max){Y=a;}else{Y=mstrmojo.desc(146,"From:")+" '"+a+"' "+mstrmojo.desc(147,"To:")+" '"+this.getItemTooltip(this.items[this.max])+"'";}b.content=L.replace(/\{@content\}/g,Y);}else{b.content="";}this.set("richTooltip",b);},getItemTooltip:function(Y){return"'"+(Y?Y.n:"")+"'";},unrender:function U(Y){this.ghost=null;this.dnd&&(this.dnd.dragging=false);this.hideTooltip();this._super(Y);},onselectionChange:function M(Y){if(this.onchange){this.onchange();}if(this.makeSelection&&this.dnd&&this.dnd.initD){this.makeSelection({selItem:this.dnd.initD.td});}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo.num","mstrmojo.HBox","mstrmojo._IsInputControl","mstrmojo._TouchGestures");var W=mstrmojo.dom,O=W.attachEvent,P=W.detachEvent,a=mstrmojo.css,Q=mstrmojo.expr.DTP,M="mstrmojo.Button",R=mstrmojo.num,I=mstrmojo.validation.TRIGGER,b=50,L=500,A=10;function S(){var j=this;O(window,W.TOUCHSTART,j._evtHandler,true);j.isActive=true;}function V(){var j=this;P(window,W.TOUCHSTART,j._evtHandler,true);j.isActive=false;}function G(j){return j?parseFloat(j.toFixed(A)):j;}function d(){var l=this.numericValue,j=this.max,o=this.min,k=this.itv;if(!isNaN(l)){if(j!==undefined&&l-k>j){this.set("numericValue",j);}else{if(o===undefined||l-k>=o){this.set("numericValue",G(l-k));}else{if(l>o&&l-k<o){this.set("numericValue",o);}}}}}function K(){var l=this.numericValue,j=this.max,o=this.min,k=this.itv;if(!isNaN(l)){if(o!==undefined&&l+k<o){this.set("numericValue",o);}else{if(j===undefined||l+k<=j){this.set("numericValue",G(l+k));}else{if(l<j&&l+k>j){this.set("numericValue",j);}}}}}function D(j){if(j){K.call(this);}else{d.call(this);}}function g(j){var k=this;this._holdTimer=setInterval(function(){D.call(k,j);},b);}function B(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}}function h(j){var k=this;if(!this._holdTimer&&!this._startHoldTimer){this._startHoldTimer=setTimeout(function(){delete k._startHoldTimer;g.call(k,j);},L);}}function f(){if(this._startHoldTimer){clearTimeout(this._startHoldTimer);delete this._startHoldTimer;}B.call(this);}function F(j){var k=j.target;return(this.plusNode&&this.plusNode==k);}function E(j){var k=j.target;return(this.minusNode&&this.minusNode==k);}function J(){var j=this.numericValue;if(!isNaN(j)&&j>=this.min&&j<=this.max&&j!=this.value){this.set("value",j);}}function Z(j){a.addClass(j,"touched");}function N(o){var j=o.max,l=o.min,k=o.itv;return{scriptClass:"mstrmojo.HBox",alias:"hBox",cssText:"margin:auto",children:[{scriptClass:M,alias:"minus",cssClass:"mstrmojo-StepperDIC-Operator minus",bindings:{enabled:function(){return this.parent.parent.numericValue>l;}}},{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-DataInputControl",dtp:Q.DOUBLE,required:true,alias:"textInput",constraints:{trigger:I.ONKEYUP|I.ONBLUR,max:j,min:l},bindings:{value:"this.parent.parent.numericValue"},onblur:function p(q){var s=this.parent.parent,t=R.parseNumeric(this.value);if(!s.isActive){J.call(this.parent.parent);}this._super&&this._super(q);},onValid:function(){this.parent.parent.set("numericValue",parseFloat(this.value));}},{scriptClass:M,alias:"plus",cssClass:"mstrmojo-StepperDIC-Operator plus",bindings:{enabled:function(){return this.parent.parent.numericValue<j;}}}]};}mstrmojo.android.inputControls.StepperDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.inputControls.StepperDIC",cssClass:"mstrmojo-StepperDIC",isActive:false,markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},init:function U(k){this._super&&this._super(k);this.max=this.dic.max;this.min=this.dic.min;this.itv=this.dic.itv;var j=parseFloat(this.value);this.set("numericValue",isNaN(j)?(this.min||0):j);this.set("children",N(this.dic));this.plus=this.hBox&&this.hBox.plus;this.minus=this.hBox&&this.hBox.minus;var l=this;this._evtHandler=this._evtHandler||function(o){var p=o.target;if(!W.contains(l.domNode,p)){W.stopPropogation(o.view,o);V.call(l);J.call(l);}};},postBuildRendering:function Y(){this._super();this.plusNode=this.plus&&this.plus.domNode;this.minusNode=this.minus&&this.minus.domNode;},touchTap:function(j){if(!this.isActive){S.call(this);}if(F.call(this,j)){Z(this.plusNode);D.call(this,true);}else{if(E.call(this,j)){Z(this.minusNode);D.call(this,false);}}},touchBegin:function T(j){if(!this.isActive){S.call(this);}if(F.call(this,j)){Z(this.plusNode);h.call(this,true);}else{if(E.call(this,j)){Z(this.minusNode);h.call(this,false);}}},touchEnd:function C(j){f.call(this);},unrender:function X(j){if(this.isActive){V.call(this);}f.call(this);this._super(j);},setDirtyFlag:function H(k,j){mstrmojo.css.addClass(this.domNode.firstChild||j,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.HBox","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren");var F={postBuildRendering:function C(){return(this.renderMode!="scroll")?this._super():true;},childRenderOnAddCheck:function(G){return(this.renderMode!="scroll")?this._super(G):false;},preserveChildDomOrder:false};function B(H){if(!H.hasRendered){return ;}var I=H.children||[];for(var G=I.length-1;G>=0;G--){I[G].refresh&&I[G].refresh();}}mstrmojo.DocSection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSection",markupString:'<div id="{@id}" class="mstrmojo-DocSection"></div>',markupSlots:{containerNode:function(){return this.domNode;}},width:function E(G){return this._super(1);},refresh:function D(){B(this);}});mstrmojo.DocSectionHoriz=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSectionHoriz",height:function A(G){return this._super(1);},refresh:function D(){B(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.DocTextfield");var I=mstrmojo.dom,K=mstrmojo.css,L=1,Q=2,A=3,N=4,P=5,E=6,B=1,D=["","CaptionOnly","IconOnly","IconLeft","IconRight","IconTop","Custom"];var M=[];M[L]=M[Q]=M[E]={minsp:0,mincs:0};M[A]=M[N]={minsp:10,mincs:5};M[P]={minsp:4,mincs:5};function F(V,S,X,R,T){var Y=I.position(V),U=I.position(V.parentElement),W=V.style;R=R||{};R={t:R.t||0,r:R.r||0,b:R.b||0,l:R.l||0};R.h=U.h-R.t-R.b;R.w=U.w-R.l-R.r;if(T){if(Y.h>R.h){W.height=R.h+"px";}if(Y.w>R.w){W.width=R.w+"px";}Y=I.position(V);}if(S){W.top=((R.h-Y.h)/2+R.t)+"px";}if(X){W.left=((R.w-Y.w)/2+R.l)+"px";}}function J(U,V,T){var S=document.createElement("img"),R=S.style;U.appendChild(S);I.attachEvent(S,"load",function(){var W=R.display;R.display="block";F(S,true,true);R.display=W;},true);S.className=T;S.src=V;}mstrmojo.DocButton=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocButton",pressed:false,markupString:'<div id="{@id}" class="mstrmojo-DocButton {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocButton-Container" mstrAttach:click,mousedown><div class="mstrmojo-DocButton-IconNode"></div><div class="mstrmojo-DocButton-ValueNode" style="{@valueNodeCssText}">{@v}</div></div><div class="mstrmojo-DocButton-EffectOverlay"></div>{@buttonNodeMarkup}</div>',markupSlots:{iconNode:function(){return this.domNode.firstChild.firstChild;},valueNode:function(){return this.domNode.firstChild.lastChild;},buttonContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{onpressedChange:function(){var R=!!this.pressed,U=this.defn,T=this.domNode,S=this.fmts;K.toggleClass(T,"pressed",R);this.setBackgroundColor();this.valueNode.style.color=R?U.fhlc:(S.color||"");},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["T","z-index","D","B","P","background-color"],valueNode:["font","fx","color","white-space","overflow"]},setBackgroundColor:function H(){this.domNode.style.backgroundColor=(!!this.pressed)?this.defn.bhlc:(this.fmts["background-color"]||"");},getAnchor:function O(){return this.domNode;},getDPI:function C(){return this.model.dpi;},buildRendering:function G(){this._super();var S=this.defn,l=this.domNode,V=this.buttonContainerNode,k=this.iconNode,q=this.valueNode,f=parseInt((S&&S.dpst)||1,10),g="px";K.toggleClass(l,D[f],true);l.onselectstart=l.ondragstart=function(){return false;};var b=this.getFormats(),X=parseInt(K.getComputedStyle(V).borderWidth,10)*2;if(isNaN(X)){X=0;}var Z=parseFloat(b.width)-X,o=parseFloat(b.height)-X,W=M[f],a=W.minsp,t=W.mincs,d,Y=k.style,j=q.style;function U(h){Y.height=Y.width=h+g;}var s=V.style;s.height=o+g;s.width=Z+g;switch(f){case P:var T=this.getDPI(),R=o+K.getBorderWidths(b["border-width"],T).h+K.getPaddings(b.padding,T).h;d=Math.max(0,Math.min(Z,o-a-t,R*0.6));U(d);F(k,false,true);F(q,true,false,{t:d+a},true);break;case A:case N:d=Math.max(0,Math.min(o,Z-a-t));U(d);F(k,true,false);j[(f===A)?"left":"right"]=(d+a)+g;F(q,true,false);break;case L:F(q,true,false);break;case Q:case E:break;}if(B===parseInt(S.fe,10)){K.addClass(l,"gloss");}J(k,S.nmurl,"normal");J(k,S.hlurl||S.nmurl,"hilight");var p=document.createElement("div");K.addClass(p,"mstrmojo-DocButton-IconMaskNode");k.appendChild(p);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ViewSwitcher","mstrmojo.dom","mstrmojo.array");var I=Math,H=mstrmojo.dom,J=mstrmojo.array;function F(O,N,Q,R){if(isNaN(N)){N=parseInt(N,10);}var P=O.style;P[H.CSS3_TRANSITION]=H.CSS3_PREFIX+"transform "+(Q||0)+"ms "+(R||"ease");P[H.CSS3_TRANSFORM]="translateX("+N+"px)";}function G(T,U,W){var P=this.getSlots(),S=P.current,V=P.next,R=P.slot,O=0;J.forEach(J.filter(this.children,function(X){return(X.slot===R);}),function(X){this.removeChildren(X);X.unrender();},this);this.prepareNewView(T,R);try{var N=this.id;window.setTimeout(function(){mstrmojo.all[N].addChildren([T]);},0);if(V&&S){O=W?parseInt(this.width,10):0;if(W){V.style.zIndex=3;S.style.zIndex=1;}}}catch(Q){mstrmojo.Obj.free(T);throw Q;}return{start:U,target:O,newView:T,oldView:this.getCurrentView(),isForward:W};}function B(O,U,W,R,Q){var N=this.sliderNode,P=0,S="",T=function(){F(N,-O,P,S);if(W){if(P){window.setTimeout(W,P+100);}else{W();}}};if(R){var V=I.abs((O||0)-(U||0));P=I.round(V/parseInt(this.width,10)*700);S="ease";if(Q){P=I.min(P,I.round(V/Q));S+="-out";}this._animating=true;window.setTimeout(T,20);}else{T();}}function M(O,N){this.removeChildren(N);N.unrender();this._curSlot=O.slot;delete this._animating;}mstrmojo.android.ui.ViewSlider=mstrmojo.declare(mstrmojo.android.ui.ViewSwitcher,null,{scriptClass:"mstrmojo.android.ui.ViewSlider",switchView:function E(N,O){var P=this.getSlots();F(this.sliderNode,0);F(P.current,0);F(P.next,0);this._super(N,O);},isAnimating:function A(){return !!this._animating;},resetSliderNodes:function(Q){var P=this.getSlots(),O=parseInt(this.width,10),S=-O,N=O,R=0;if(Q){S=0;N=0;R=O;}F(this.sliderNode,S);F(P.current,N);F(P.next,R);return{sliderX:S,currentX:N,nextX:R};},beginScroll:function(R,O){if(this.isAnimating()){return false;}var P=R.delta.x<0,N=this.resetSliderNodes(P);var Q=this._scrollInfo=G.call(this,O,N.sliderX,P);this.scrollStarted(Q);this.scroll(R);},scroll:function L(P){var O=this._scrollInfo,N=P.delta.x;if(O){if(O.isForward!==(N<0)){B.call(this,0);this.beginScroll(P);}else{B.call(this,-(O.start+N));this.scrollProgress(O,N);}}},endScroll:function D(T){var P=this._scrollInfo;if(!P){return ;}var S=T.delta.x,N=-P.start,R=false,O=0,Q=this.id;if(I.abs(S)/parseInt(this.width,10)>0.25){N=P.target;R=true;O=T.velocity.x;}this.scrollStopped(P,R);B.call(this,N,N-S,function(){mstrmojo.all[Q]["scroll"+(R?"Complete":"Canceled")](P);},true,O);delete this._scrollInfo;},scrollStarted:mstrmojo.emptyFn,scrollProgress:mstrmojo.emptyFn,scrollStopped:mstrmojo.emptyFn,scrollCanceled:function C(N){M.call(this,N.oldView,N.newView);},scrollComplete:function K(N){M.call(this,N.newView,N.oldView);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TristateCheckBox","mstrmojo._IsInputControl");mstrmojo.CheckBoxDIC=mstrmojo.declare(mstrmojo.TristateCheckBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CheckBoxDIC",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" tabindex="1" mstrAttach:click,keydown></div>',cssText:"width: 0; margin:0 auto; max-height: 18px; cursor: pointer;",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);this.set("checked",true);}else{this.set("checked",!this.checked);}},oncheckedChange:function(A){this.set("value",this[this.checked?"onValue":"offValue"]);},preBuildRendering:function(){this._super();var A=this.dic.vls;this.offValue=A[0].v;this.onValue=A[1].v;this.grayed=(this.onValue!==this.value)&&(this.offValue!==this.value);this.checked=(this.onValue===this.value);},postBuildRendering:function(){this._super();this.domNode.style.height=this.openerStyle.ih+"px";},onkeydown:function(B){var A=B.hWin,C=B.e||A.event;if(C.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(A,C);this.onclick();}},focus:function(){this.domNode.focus();}});})();(function(){mstrmojo.requiresCls("mstrmojo.CheckBoxDIC","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.android._HasPreviewButton","mstrmojo.dom","mstrmojo.css");var K=24,T=36,D=48,A={160:K,213:K,240:T,320:D},U={160:48,213:48,240:73,320:98},B=300,R=mstrmojo.css,O=mstrmojo.dom;function I(V){this.btnNode.innerHTML=V?this.onText:this.offText;R.toggleClass(this.btnNode,"on",V);R.toggleClass(this.btnNode,"off",!V);}function E(){if(this._animHandle){window.clearTimeout(this._animHandle);delete this._animHandle;}}function J(Y,X){this._scroller.origin.x=X;if(!Y){return ;}var V=this.scrollNode.style,W=this;this._isAnimating=true;V[O.CSS3_TRANSITION_DURATION]=Y+"ms";V[O.CSS3_TRANSFORM]=O.createTranslateString(-X);this._animHandle=window.setTimeout(function(){if(W._isAnimating){W._isAnimating=false;}E.call(W);},Y*3);}mstrmojo.android.inputControls.CheckBoxDIC=mstrmojo.declare(mstrmojo.CheckBoxDIC,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.CheckBoxDIC",cssText:"cursor:pointer;",cssDisplay:"inline-block",onText:"ON",offText:"OFF",isSwitchStyle:false,markupString:'<div id="{@id}" class="mstrmojo-Label mstrmojo-CheckBoxDIC {@cssClass}" style="{@cssText}" mstrAttach:click,keydown><div class="checkBox-android-wrapper"><div class="checkBox-android-scrollable"><div class="checkBox-androidMobile-button off"></div><div class="checkBox-label-text"></div></div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.firstChild.lastChild;},btnNode:function(){return this.domNode.firstChild.firstChild.firstChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.textNode.innerHTML=(this.text!=null)?this.text:"";}},mstrmojo.hash.copy(mstrmojo.CheckBoxDIC.prototype.markupMethods)),init:function N(W){this._super&&this._super(W);if(this.dic.stl==0){this.isSwitchStyle=true;var V=mstrMobileApp.getDeviceDPI();this.maxOffsetX=U[V];this.scrollerConfig={showScrollbars:false,showIndicators:false,vScroll:false,hScroll:true,bounces:false,useTranslate3d:false,offset:{x:{end:this.maxOffsetX,start:0},scrollPast:false}};this.minHeight=A[V]||K;}},updateScrollerConfig:function S(){if(!this.isSwitchStyle){return ;}var V=this._super(),W=this.checked?0:(this.maxOffsetX||0);mstrmojo.hash.copy({scrollEl:this.scrollNode,origin:{x:W,y:0}},V);return V;},updateScroller:function G(V,W){if(!this.isSwitchStyle){return ;}this._super(V,W);},initScroller:function M(V){if(!this.isSwitchStyle){return ;}this._super(V);var W=this;V.attachEventListener("scrollMoved",this.id,function(X){this._translateX=X.x;I.call(W,(X.x<W.maxOffsetX/2));});},oncheckedChange:function H(V){if(this.isSwitchStyle){if(this.checked&&this._scroller.origin.x!==0){J.call(this,B,0);}else{if(!this.checked&&this._scroller.origin.x!==this.maxOffsetX){J.call(this,B,this.maxOffsetX);}}I.call(this,this.checked);}this._super&&this._super(V);},preBuildRendering:function C(){this.cssClass=this.isSwitchStyle?"Android-tristate-mobile":"Android-tristate";var V;switch(this.owner.getFormats()["text-align"]){case"center":V="50%";break;case"right":V="100%";break;}if(V){this.cssText+="background-position:"+V+" 50%;";}return this._super();},postBuildRendering:function Q(){this._super();if(this.isSwitchStyle){I.call(this,this.checked);this.domNode.style.height=(this.openerStyle.ih>this.minHeight?this.openerStyle.ih:this.minHeight)+"px";}},touchTap:function P(V){this.onclick();},touchBegin:function L(V){if(!this.isSwitchStyle){return ;}if(this._isAnimating){V.stop();return false;}return this._super(V);},touchSwipeEnd:function(Z){if(!this.isSwitchStyle){return ;}Z.evt.handle=true;var Y=this._translateX,X=(Y<this.maxOffsetX/2),V=X?Y:(this.maxOffsetX-Y),W=V*B/this.maxOffsetX;J.call(this,W,X?0:this.maxOffsetX);this.set("checked",X);},setDirtyFlag:function F(W,V){if(this.isSwitchStyle){mstrmojo.css.addClass(this.domNode.firstChild||V,"tx-active");}else{this._super(W,V);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ViewSlider","mstrmojo._HasBuilder","mstrmojo._IsRwDocument","mstrmojo.android.ui.LayoutSelector","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.func","mstrmojo.android.EnumOrientationTypes");mstrmojo.requiresDescs(4174);var j=mstrmojo.array,o=j.forEach,S=mstrmojo.hash,Q=mstrmojo.android.EnumOrientationTypes,K=Q.PORTRAIT,P=Q.LANDSCAPE;function g(AC){return(AC.defn.iw!==undefined&&AC.defn.iw);}function R(AC){return new mstrmojo.Label({cssClass:"pre-loader",n:AC.n,k:AC.k,isPreloader:true});}function h(AE,AC){var AD=this.layoutSelector,AF=this.getSupportedLayouts();if(!AC){AD.set("items",AF);}AD.setCurrentTab(j.find(AF,"k",AE.k));AD.set("visible",!!AC);if(AC){AD.initiateFade();}}function z(AD,AJ){var AF=this._layouts,AC=mstrMobileApp.getOrientation(),AE=AF.length-1-AD,AI=false,AG;var AH=AF.slice(AD+1);if(AD){AH=AH.concat(AF.slice(0,AD));}if(!AJ){AH.reverse();AE=AD;}o(AH,function(AL,AK){AI=(AK>=AE);if(((AL.defn.or&AC)>0)&&!g(AL)){AG=AL;return false;}});if(!AG){return null;}return{wrap:AI,layout:AG};}function t(){var AD=this.model.defn.views,AC=(AD&&AD.length)||0,AF;if(AC){var AE=AD[0].orientation;for(AF=1;AF<AC;AF++){if(AE!==AD[AF].orientation){return true;}}}return false;}function f(AM){var AJ=this._layouts,AI=this._orientationInfo;if(!AI){AI=this._orientationInfo={};var AN=AI[K]={lyts:[]};var AK=AI[P]={lyts:[]};j.forEach(AJ,function(AP){var AR=AP.defn.or,AQ=AI[AR];if(!g(AP)&&AQ!==undefined){AQ.lyts.push(AP.k);}});if(AN.lyts.length||AK.lyts.length){AI.specific=true;}}var AD=AJ[j.find(AJ,"k",AM)],AF=AD.defn.or,AG=AI[AF],AE=mstrMobileApp.getOrientation(),AH={isSupported:true,currentLayout:AD,specific:!!AI.specific};if(g(AD)||((AF&AE)===0)){AH.isSupported=false;var AL=AI[AE];if(AG===undefined||AL===undefined){return AH;}var AO=AL.lyts[j.indexOf(AG.lyts,AM)];if(AO){AH.newLayout=AJ[j.find(AJ,"k",AO)];}else{var AC=AL.last;if(AC){AH.newLayout=AC;}else{j.forEach(AJ,function(AP){if(!g(AP)&&(AP.defn.or&AE)>0){AH.newLayout=AP;return false;}});}}AG.last=AD;if(!AH.newLayout){AH.isStale=true;}}else{AH.needNewLayout=t.call(this);}return AH;}function AB(AD){var AC=z.call(this,j.find(this._layouts,"k",this.model.getCurrentLayoutKey()),(AD.delta.x<0));return(AC&&!AC.wrap)?AC:null;}function F(){var AD=this.model,AC=AD&&AD.wm;if(AC&&AC.tp===3&&AC.imgSrc){return AC;}return null;}function Y(AG){var AC=document.createElement("img"),AD=AC.style;this.watermarkNode=AC;AD.position="absolute";AD.top=0;AD.left=0;AD.visibility="hidden";var AE=this;AC.onload=function(){var AJ=AC.width,AL=AC.height;if(AG.imgScale<=0){var AI=AE.domNode;if(AI){AC.width=AI.clientWidth;AC.height=AI.clientHeight;}}else{var AK=AG.imgScale/100;AC.width=AJ*AK;AC.height=AL*AK;}AC.style.visibility="visible";};this.domNode.insertBefore(AC,this.domNode.firstChild);var AF=this.model.getDataService();var AH=AG&&AG.imgSrc;AC.src=(AH&&AF&&AF.getDocImage&&AF.getDocImage(AH))||AH;}mstrmojo.android.ui.DocumentView=mstrmojo.declare(mstrmojo.android.ui.ViewSlider,[mstrmojo._HasBuilder,mstrmojo._IsRwDocument],{scriptClass:"mstrmojo.android.ui.DocumentView",postBuildRendering:function X(){var AD=this._super(),AC=F.call(this);if(AC){Y.call(this,AC);}return AD;},buildChildren:function d(AC){this._layouts=this._super(true);},beforeViewHidden:function M(AD){this._stale=true;var AC=this.getCurrentLayout();if(AC&&AC.beforeViewHidden){AC.beforeViewHidden(AD);}},getViewController:function H(AC){return null;},unrender:function A(AC){delete this._stale;this._super(AC);},reloadLayout:function I(){var AC=this.getCurrentView(),AE=this.id,AD={layoutKey:AC.k,reload:true,executionOrientation:mstrMobileApp.getOrientation()};this.getNewLayout(AD,this._layouts,true,{success:function(AF){var AG=mstrmojo.all[AE];AG.replaceView(AF,AC,true);AG.resetSliderNodes();}});},rootOrientationChange:function L(){if(this._stale){return ;}var AF=F.call(this);if(AF&&AF.imgScale<=0){var AH=this.watermarkNode;AH.width=parseInt(this.width,10);AH.height=parseInt(this.height,10);}var AO=this.getCurrentView();if(AO.isPreloader){return ;}var AM=this._layouts,AI=AO.k,AE=f.call(this,AI),AJ=AE.newLayout;if(AE.isStale){return ;}if(AE.specific){h.call(this,AO);}var AK=!!AE.needNewLayout,AL=!AK&&(!AE.isSupported&&AJ),AD=!AL&&(this.model.zt&&!AO.isFullScreenWidget);if(AK||AL||AD){mstrApp.closeAllDialogs();var AC=this.id,AN=this,AG={layoutKey:AI,reload:true,executionOrientation:mstrMobileApp.getOrientation()},AP=function(AQ){mstrmojo.all[AC].replaceView(AQ,AN.getCurrentView());AN.resetSliderNodes();};if(AL){AO=this.replaceView(R(AJ),AO,true);AG.layoutKey=AJ.k;delete AG.reload;AP=mstrmojo.func.composite([function(AQ){h.call(mstrmojo.all[AC],AQ);},AP]);}this.getNewLayout(AG,AM,true,{success:AP});}this.controller.generateActionToolbar();},onRender:function C(){if(!this.layoutSelector){this.addChildren([{scriptClass:"mstrmojo.android.ui.LayoutSelector",slot:"overlayNode",alias:"layoutSelector",visible:false,tabSelected:function(AJ){this.parent.showLayout(AJ);}}]);}var AC=this.getCurrentLayout();var AH=f.call(this,this.model.getCurrentLayoutKey()),AD=AH.currentLayout,AF=this,AG=function(AJ){if(AJ&&!AJ.domNode){AF.switchView(AJ);}else{AF.stackViews(AJ.slot);}return AJ;};if(AH.needNewLayout&&this.controller.isBack){AG(AD);var AI={layoutKey:AD.k,reload:true,executionOrientation:mstrMobileApp.getOrientation()};this.getNewLayout(AI,this._layouts,true,{success:function(AJ){AF.replaceView(AJ,AD);}});}else{if(AH.isSupported){AG(AD);h.call(this,AD);}else{var AE=AH.newLayout;if(AE){AD.defn.loaded=false;AE=AG(this.selectLayout(R(AE),false));this.getNewLayout({layoutKey:AE.k},this._layouts,true,{success:function(AJ){h.call(AF,AJ);AF.replaceView(AJ,AE);}});}else{this._ignoreOrientation=true;AG(AD);}}}},showLayout:function O(AD){var AC=AD.k,AE=this;if(AC!==this.model.getCurrentLayoutKey()){var AF={layoutKey:AC};if(t.call(this)){AF.executionOrientation=mstrMobileApp.getOrientation();AF.reload=true;}this.getNewLayout(AF,this._layouts,true,{success:function(AG){AE.switchView(AG);}});return true;}return false;},afterSwitch:function p(AC){this._super(AC);this.selectLayout(AC,(AC.k!==this.model.getCurrentLayoutKey()));},selectLayout:function l(AC,AD,AF){var AE=this._super(AC,AD,AF);this.controller.getPageByTree(true);if(!AC.defn||!AC.defn.iw){h.call(this,AE,true);}return AE;},replaceLayout:function D(AE,AD){var AF=this._layouts||[],AC=j.find(AF,"k",AE.k);if(AC>=0){AE.unrender();AE.destroy();}var AG=this.builder.build([AD],this.model)[0];if(AC>=0){AF[AC]=AG;}else{AF.push(AG);}this._layouts=AF;return AG;},onLayoutRebuilt:function W(AC){this.replaceView(AC,this.getCurrentView());},canScroll:function T(AC){return !!AB.call(this,AC);},beginScroll:function Z(AF,AI){if(this.isAnimating()){return false;}delete this._scrollInfo;if(!AI){var AJ=this._layouts,AK=AB.call(this,AF),AC=this.id;if(!AK){return ;}AI=AK.layout;var AD=mstrMobileApp.getOrientation(),AH=AI.docLayout,AG=t.call(this)||(this.model.zt&&AH&&AD!==AH.defn.lastOrientation);if(!AI.defn.loaded||AG){AI=R(AI);var AE={layoutKey:AI.k};if(AG){AE.executionOrientation=AD;AE.reload=true;}this.getNewLayout(AE,AJ,false,{success:function(AM){var AL=mstrmojo.all[AC],AN=AL._scrollInfo;if(AN){AN.view=AM;}AL.replaceView(AM,AI);}});}}if(AI){this._super(AF,AI);}},scrollStarted:function G(){var AC=this.layoutSelector;AC.set("visible",true);AC.enterScroll();},scrollProgress:function k(AC,AD){this.layoutSelector.scroll(AD);},scrollStopped:function AA(AE,AF){var AD=this.layoutSelector,AC=AD.selectedIndex;if(AF){AC+=(AE.isForward?1:-1);}AD.exitScroll(AC);},scrollCanceled:function q(AD){this._super(AD);var AC=AD.oldView;this.model.getDataService().setCurrentDocLayout(AC.k);this.selectLayout(AC,false);this.layoutSelector.initiateFade();},scrollComplete:function a(AD){this._super(AD);var AC=AD.newView;this.selectLayout(AC,(AC.k!==this.model.getCurrentLayoutKey()));this.controller.generateActionToolbar();},renderInfoWindow:function V(AD){AD.autoCloses=AD.locksHover=false;if(mstrApp.isTablet()){this._super(AD);return ;}var AE=this.controller,AL=AE.rootCtrl,AK=AL.getTitle(),AH=function(AM){AL.updateContent(null,AM);},AF=false;this.fullScreenInfoWindow=true;AE.generateActionToolbar();var AC=this.id;mstrApp.showDialog({cssClass:"FSInfoWindow",children:AD,resizeDialog:function AJ(){var AR=mstrApp.rootView,AQ=AR.getContentDimensions(),AP=this.editorNode&&this.editorNode.style,AN=this.children[0],AM=AN&&AN.infoNode;if(AP){AP.top=(parseInt(AR.getBrowserDimensions().h,10)-AQ.h+3)+"px";AP.left="5px";}if(AM){var AO=AM.style;AO.height=AQ.h+"px";AO.width=AQ.w+"px";mstrmojo.all[AN.psId].setInfoWindowDimensions(AQ);}},onClose:function AI(){AH(AK);delete mstrmojo.all[AC].fullScreenInfoWindow;AE.generateActionToolbar();if(AF){mstrMobileApp.releaseOrientation();}var AM=this.children[0];if(AM&&AM.clearAnchorHilites){AM.clearAnchorHilites();}},positionDialog:mstrmojo.emptyFn});var AG=AD.children[0];AH(AG.getTitle());if(mstrMobileApp.getLockedOrientation()===0){mstrMobileApp.lockOrientation(mstrMobileApp.getOrientation());AF=true;}AG.attachEventListener("titleChange",this.id,function(AM){AH(AM.value);});},updateInfoWindowPS:function b(AC,AD){if(!mstrApp.isTablet()){mstrmojo.all[AC].setInfoWindowDimensions(mstrApp.getContentDimensions());}},destroy:function w(AC){o(this._layouts,function(AD){AD.destroy(AC);});this.builder.destroy();this._super(AC);},getLayouts:function(){return this._layouts;},getSelectedLayoutWidget:function B(){return this.getCurrentView();},getNewLayout:function J(AG,AF,AD,AH){var AC=this.controller,AE;if(AC&&AC.getDesiredElements){AE=AC.getDesiredElements();if(AE){AG.desiredElements=AE;}}AH.success=mstrmojo.func.composite([AH.success,function(){AC.generateActionToolbar();}]);S.forEach(this.ifwMap,function(AI){if(AI.visible){AI.close();}});return this._super(AG,AF,AD,AH);},unloadLayouts:function s(AL,AC){var AK=this._layouts,AG=this.model.getCurrentLayoutKey(),AH,AD=(AK&&AK.length)||0,AF,AE,AJ,AI;for(AH=0;AH<AD;AH++){AF=AK[AH];AJ=AF.defn;if(AF.k!==AG&&AJ&&AJ.loaded){if(AC){AE=(AF.gb&&AF.gb.groupbys);if(AE&&AE.length){AJ.loaded=false;}}else{if(AL){for(AI=0;AI<AL.length;AI++){if(AF.k===AL[AI]){AJ.loaded=false;break;}}}else{AJ.loaded=false;}}}}},getSupportedLayouts:function N(){var AD=[],AC=mstrMobileApp.getOrientation();o(this._layouts,function(AE){if(((AE.defn.or&AC)>0)&&(!g(AE))){AD.push(AE);}});return AD;},getCurrentLayout:function x(){var AC=this._layouts;return AC[j.find(AC,"k",this.model.getCurrentLayoutKey())];},getCaptureDimensions:function U(){var AC=this.getCurrentLayout();return AC.getCaptureDimensions&&AC.getCaptureDimensions();},closeInfoWindowsOnTablet:function E(){if(mstrApp.isTablet()){S.forEach(this.ifwMap,function(AC){if(AC.visible){AC.closeOnTablet();}});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocButton","mstrmojo._HasDrillLinks","mstrmojo.ui.MobileCheckList","mstrmojo.android.ui.Button","mstrmojo.dom","mstrmojo.array");function A(L){this.set("pressed",L);}function J(M,N){var L=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(M);return L?"rgba("+parseInt(L[1],16)+","+parseInt(L[2],16)+","+parseInt(L[3],16)+","+N+")":"";}function B(L){this.model.executeLink(L,this.target,this);}function G(){var L=this.drillLinkItems,M=this.id;if(L.length===1){A.call(this,false);B.call(this,L[0].url);return ;}this._linksOpen=true;mstrApp.showDialog({title:this.defn.n,children:[{scriptClass:"mstrmojo.ui.MobileCheckList",items:L,multiSelect:false,isElastic:true,hasEvenRows:true,postselectionChange:function(N){mstrApp.closeDialog();B.call(mstrmojo.all[M],L[N.added[0]].url);}}],onClose:function(){var N=mstrmojo.all[M];A.call(N,false);delete N._linksOpen;},buttons:[mstrmojo.android.ui.Button.newButton(mstrmojo.desc(221,"Cancel"))]});}var F=mstrmojo.android.ui.DocButton=mstrmojo.declare(mstrmojo.DocButton,[mstrmojo._HasDrillLinks],{scriptClass:"mstrmojo.android.ui.DocButton",touchBegin:function E(){if(!this.linkEnabled){return false;}A.call(this,true);return true;},touchTap:function C(){if(this.ifw){this.model.showInfoWin(this.ifw,(this.getAnchor&&this.getAnchor())||this.domNode,"v");return ;}var L=this.drillLinkItems,M=(L&&L.length)||0;if(M>0){G.call(this);}},touchSelectBegin:function H(){this.touchTap();},touchEnd:function K(){if(!this._linksOpen){A.call(this,false);}},setBackgroundColor:function I(){var L=!!this.pressed,R=this.defn,Q=this.domNode,N=this.fmts,S=this.buttonContainerNode.style,O=this.domNode.style,P=L?R.bhlc:(N["background-color"]||""),M=L?J(R.bhlc,0.4):"";S.backgroundColor=P;S.borderColor=P;O.borderColor=M;O.backgroundColor=M;},getDPI:function D(){return mstrMobileApp.getDeviceDPI();}});F.prototype.markupString=F.prototype.markupString.replace(new RegExp(" mstrAttach:[a-zA-Z,]*"),"");F.prototype.formatHandlers.domNode=mstrmojo.array.filter([].concat(F.prototype.formatHandlers.domNode),function(L){return(L!=="P"&&L!=="B");});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var O=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],V=["width","height"],o="p_fmts";var k="px";var h={getContentHeight:function(s,w){var t=w.ttl&&w.ttl.height;if(s&&t&&!this.floatingToolbar){return Math.max(parseInt(s,10)-parseInt(t,10),0)+k;}return"";},getPortletMinHeight:function(s){return s.ttl.height;},adjustTitleCss:function(s){return ;}};var f={getContentHeight:function(s,t){return s;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(s){s.titlebarNodeClass+=" floating";return ;}};function A(x,t){var w=this.parent,s=x+"DirtyKey";if(w[s]){w[s](t);}}function N(){var s=this.title;if(this.count){s+=" "+this.count;}this.toolbarTitleTextNode.innerHTML=s;}function g(){var t=this.parent,x=t&&t.defn;if(x&&parseInt(x.t,10)===mstrmojo.EnumRWUnitType.PANEL){var s=t.parent,w=s.defn;if(w&&w.ifp){return s;}}return null;}var P=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;">{@title} {@count}</div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){N.call(this);},oncountChange:function(){N.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B"],shadowNode:["RW","B","fx","background-color"],titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]},buttonbarNode:{src:"ttl",props:["background-color"]}},fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:h,getCacheKey:function F(s){return this._super(s)+"-portlet";},getFormats:function L(){var t=this.content,s=t&&t.getFormats();return s&&s[o];},updateContentHeight:function b(z){var s=this.getFormats(),t=this.content,x=t.dimNode||t.domNode,w=((s.ttl&&parseInt(s.ttl.height,10))||0);if(x){if(!z){w+=((this.fc||this.isInFilterPanel())?x.offsetHeight:(s.height?parseInt(s.height,10):0));}this.containerNode.style.height=w+k;this.shadowNode.style.height=w+k;}},init:function p(s){this._super(s);var t=this.content;if(t&&t.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var t=this._ts=(this.floatingTitle)?f:h;this._super();t.adjustTitleCss(this);var s="display:none;";if(this.isInFilterPanel()){var w=P.clone(this.formatHandlers);w.portletContainerNode=["z-index","height","B","backgroud-color"];w.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=w;}if(!this.leftToolbar){this.leftToolbarNodeCssText+=s;}if(!this.toolbar){this.toolbarNodeCssText+=s;}var x=mstrmojo._Formattable.getBorderWidths(this);if(x.l||x.t||x.r){this.borderCss="has-border";}},postBuildRendering:function W(){var x=mstrmojo.dom,z=mstrmojo.css,AB=this.contentNode,AE=this.titleNode,AC=this;if(this.titleNode){if(this.floatingTitle){document.body.appendChild(this.titleNode);if(!this._onhover){this._onhovertt=function(){z.addClass(AC.titleNode,["visible"]);AC._onflt=true;return true;};this._onhoverofftt=function(){z.removeClass(AC.titleNode,["visible"]);AC._onflt=false;return true;};this._onhover=function(){var AF=AC.titleNode;z.addClass(AF,["visible"]);var AG=x.position(AC.contentNode,true);AF.style.top=(AG.y-AF.clientHeight+2)+k;AF.style.left=AG.x+k;return true;};this._onhoveroff=function(){z.removeClass(AC.titleNode,["visible"]);return true;};}x.attachEvent(AB,"mouseover",this._onhover);x.attachEvent(AB,"mouseout",this._onhoveroff);x.attachEvent(AE,"mouseover",this._onhovertt);x.attachEvent(AE,"mouseout",this._onhoverofftt);}if(this.attachContextMenuEvent){this._oncontextmenu=function(AG,t){var AF=AC.rightToolbar&&AC.rightToolbar.btnMenu;if(AF){AF.cmPos=x.getMousePosition(AG,t);AF.openPopupMenu();AF.cmPos=null;x.preventDefault(t,AG);}};x.attachEvent(AE,"contextmenu",this._oncontextmenu);}}if(this._super){this._super();}var AA=this.getFormats();this.set("fc",AA&&!AA.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var s=this.portletContainerNode.style,w=this.shadowNode.style,AD=this.parent;s.width=w.width="99%";s.top=w.top=AD.topStart+k;s.left=w.left=G+k;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(AA.left)+G*this.orgPos+k;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}},adjustFPHeight2Fit:function(){var w=mstrmojo.dom,s=w.position(this.titleNode),t=w.position(this.contentNode).y-s.y-s.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height)-t+"px";},unrender:function E(w){if(this.floatingTitle&&this.titleNode){var z=this.domNode,s=this.titleNode,x=mstrmojo.dom;if(z&&this._onhover){x.detachEvent(z,"mouseover",this._onhover);}if(z&&this._onhoveroff){x.detachEvent(z,"mouseout",this._onhoveroff);}if(s&&this._onhovertt){x.detachEvent(s,"mouseover",this._onhovertt);}if(s&&this._onhoverofftt){x.detachEvent(s,"mouseout",this._onhoverofftt);}if(s&&this._oncontextmenu){x.detachEvent(s,"contextmenu",this._oncontextmenu);}if(s){document.body.removeChild(s);}}if(this._super){this._super(w);}},updateStyle:function(t,s){var z=this.shadowNode.style,x=this.containerNode.style;z.height=x.height=t;z.width=x.width=s;},_createFormats:function T(){var x=this.content&&this.content.getFormats(),t;t=x.p_fmts={};var s,w;for(s in O){w=O[s];if(w in x){t[w]=x[w];delete x[w];}}for(s in V){w=V[s];if(w in x){t[w]=x[w];}}x.height=this._ts.getContentHeight(x.height,t);if(mstrmojo.dom.isIE&&t.fx&&t.fx.ds&&!t["background-color"]){t["background-color"]="#ffffff";}},refresh:function q(){if(!this.hasRendered){return ;}var t=this.children,s;for(s=t.length-1;s>=0;s--){t[s].refresh();}},isInFilterPanel:function K(){return(g.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var s=this.getFilterPanel();return s&&s.defn&&s.defn.fds==2;}else{return false;}},getFilterPanel:function H(){return g.call(this);},getContainerHeight:function a(){return this.containerNode.clientHeight;},relocate:function C(t,s){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=t+k;}},setInfoWindowDimensions:function l(z){var t=this.domNode.style,s=this.shadowNode.style,w=this.portletContainerNode.style,x=mstrmojo._Formattable.getBorderWidths(this);z.h-=x.h;z.w-=x.w;s.height=w.height=t.height=z.h+k;s.width=w.width=t.width=z.w+k;z.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function J(s){A.call(this,"add",s);},removeDirtyKey:function I(s){A.call(this,"remove",s);},setDirtyChildren:function X(){var s=this.content;if(s&&s.setDirtyChildren){s.setDirtyChildren.apply(s,arguments);}}});var U=0,M=1,j=2;function Y(AH,AF,s,AI){var AE=this.content,AG=AE.k,AD=mstrmojo.boxmodel.px2Inches,x=AE.model.docModel||AE.model,z=this.getFormats(),AJ={},AC=this,AA=function(){var w=AC.content&&AC.content.defn;if(w){w.set("ds",AH);}},t={ZIndex:z["z-index"],WindowState:AH},AB={};AB[AG]=t;if(AF!==undefined&&s!==undefined){P.copy({OldHeight:AD(x,AF),OldWidth:AD(x,s),Height:AD(x,parseInt(z.height,10)),Width:AD(x,parseInt(z.width,10))},t);AJ.success=function(w){var AK=w&&w.data;if(AK){AE.model.loadPartialData(AK,AG);}AA();var AL=AC.parent;if("adjustSectionSize" in AL){AL.adjustSectionSize();}};x.saveRWProps(AG,AB,1,this.loadDataOnResize,AJ,true);}else{AA();if(!(AI&&AI.all)){x.saveRWProps(AG,AB,1,this.loadDataOnResize,AJ,true);}}return AB;}function R(){var AB=this.content;if(!AB){return ;}var z=function(AF){mstrmojo.array.forEach(AF,function(AG){if("ds" in AG){AG.set("visible",(AG.ds!==AB.defn.ds));}});},AC;if(this.isInFilterPanel()){var w=(parseInt(this.defn.ds,10)===U);AB.set("visible",w);this.updateContentHeight(!w);AC=this.leftToolbar;z(AC&&AC.children);var x=this.parent;if(x.refreshFP){x.refreshFP();}}else{var s=AB.getFormats(),AD=this.getFormats(),t=this.portletContainerNode.style,AE=this.shadowNode.style,AA=this.contentNode.firstChild.style;AA.height=s.height;AA.width=s.width;AE.height=t.height=AD.height;AE.width=t.width=AD.width;AE.top=t.top=AD.top;AE.left=t.left=AD.left;if("z-index" in AD){AE.zIndex=t.zIndex=AD["z-index"];}AC=this.rightToolbar;z(AC&&AC.children);if(AB.resize){AB.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function T(){this._super();var t=this.getFormats();var s=parseInt(this.defn.ds,10);if(s===U){t.normHeight=t.height;t.normWidth=t.width;if(t["z-index"]!==null&&t["z-index"]!==undefined){t.normZIndex=t["z-index"];}}if(s!==j){t.normTop=t.top;t.normLeft=t.left;}},onmaximize:function d(){var x=this.parent,AB=this.content,AA=AB&&AB.getFormats(),w=this.getFormats(),t=w.height,s=w.width,z=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();AB.clearCache();w.height=(parseInt(x.height(),10)-z.h)+k;AA.height=this._ts.getContentHeight(w.height,w);w.width=AA.width=(x.width()-z.w)+k;w.top=w.left=0;w["z-index"]=x.getMaxZIndex()+1;Y.call(this,j,t,s);},onminimize:function Z(){var AA=this.content,t=AA.dimNode||AA.domNode,z=AA&&AA.getFormats(),x=this.getFormats(),w=x.height||t.offsetHeight,s=x.width;this.clearCache();AA.clearCache();x.width=z.width=x.normWidth;x.top=x.normTop;x.left=x.normLeft;if(x.normZIndex!==null&&x.normZIndex!==undefined){x["z-index"]=x.normZIndex;}z.height=0;x.height=this._ts.getPortletMinHeight(x);Y.call(this,M,w,s);},onrestore:function Q(){var z=this.content,x=z&&z.getFormats(),w=this.getFormats(),t=w.height,s=w.width;this.clearCache();z.clearCache();w.height=w.normHeight;x.height=this._ts.getContentHeight(w.height,w);w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}Y.call(this,U,t,s);},oncollapse:function S(s){return Y.call(this,M,undefined,undefined,s);},onexpand:function D(s){return Y.call(this,U,undefined,undefined,s);},postBuildRendering:function W(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,R);}this._super();if(this.isInFilterPanel()){var s=(parseInt(this.defn.ds,10)===U);this.updateContentHeight(!s);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricQualification","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var a=mstrmojo.dom,R=mstrmojo.hash,S=mstrmojo.MCSUtil,K=mstrmojo.desc,d=mstrmojo.css,f=mstrmojo.num,U=Math,E=U.max,C=U.min,B=U.floor,H=U.round;function M(o,AA,AE,AB){var AH="px",s=o._length,AF=o.handleSize,q=o.orCfg,w=q.posCssP,p=q.lenCssP;AE=E(AE,-1);AB=C(AB,s);var t=C(AE,AB),z=E(AE,AB),AD=z-t,AG=E(parseInt(o[p],10)-(2*o.cssBkBW)-(z+AF),0);if(o.hasRendered){AA.handle1Node.style[w]=AE+AH;AA.handle2Node.style[w]=AB+AH;var x=AA.lowerRange.style,AC=AA.thumbNode.style,l=AA.upperRange.style;x[w]=0;AC[w]=(t+AF)+AH;l[w]=(z+AF)+AH;x[p]=E(t,0)+AH;AC[p]=AD+AH;l[p]=AG+AH;}else{AH+=";";w+=":";p+=":";o.handle1CssText=w+AE+AH;o.handel2CssText=w+AB+AH;o.lowerRangeCssText=p+E(t,0)+AH;o.thumbCssText=w+(t+AF)+AH+p+AD+AH;o.upperRangeCssText=w+(z+AF)+AH+p+AG+AH;}return{handle1:AE,handle2:AB};}function Y(l){this.getUnit=function(){return l._length/E((l.items.length-1),1);};this.calcMinMax=function(q,p){var s=l.unit;return{min:B(q/s+0.5),max:B(p/s+0.5)};};this.calcPxIdx=function(p){return B(p/l.unit+0.5);};this.getStep=function(){var q=l.high-l.low,p=parseInt(l.numFmts.cat,10),s=(p===4)?2:(p===5)?4:0;q=(q===0)?1:q;if(q>1){return(q>(l._length-2))?Number(Number(q/(l._length-2)).toFixed(l.numFmts.dp+s)):1;}return q/(l._length-2);};this.getIdx=function(p){return C(E(H((p-l.low)/l.step),0),l.items.length-1);};this.initialMetricSlider=function o(){var w=function(AJ){return AJ!==undefined&&AJ!==null;},s=function(AJ){return(w(AJ.da)&&w(AJ.da.low)&&w(AJ.da.high)&&w(AJ.da.cnt)&&w(AJ.f)&&w(AJ.ft)&&w(AJ.qua));},q=function(AJ){var AL=true,AK=true;if(AJ.ft==S._GENERIC){AL=AJ.f!=S.FN.ISNULL&&AJ.f!=S.FN.ISNOTNULL&&AJ.f!=S.FN.NOTIN&&AJ.f!=S.FN.IN;}else{if(AJ.ft==S._PERCENT||AJ.ft==S._RANK){AK=AJ.f!=S.MRPFN.INASCENDING&&AJ.f!=S.MRPFN.INDESCENDING&&AJ.f!=S.MRPFN.NOTINDESCENDING&&AJ.f!=S.MRPFN.NOTINASCENDING;}}return !AL||!AK;},AG=0;l.include=l.parent.include;l.clsType="scm ";l.staticStatus=!(w(l.da)&&w(l.da.low)&&w(l.da.high)&&w(l.da.cnt)&&w(l.qua));if(l.staticStatus){l.da.low=1;l.da.high=7;l.ft=S._GENERIC;l.f=S.FN.BETWEEN;l.qua=S.Q._G;l.cs=[{n:"",v:1},{n:"",v:7}];l.numFmts={cat:9,dp:0,fm:""};}switch(l.qua){case 0:var AF=l.numFmts.cat;AG=AF==4?2:AF==5?4:0;l.low=Number(Number(l.da.low).toFixed(l.numFmts.dp+AG));l.high=Number(Number(l.da.high).toFixed(l.numFmts.dp+AG));break;case 1:case 2:l.low=1;l.high=l.da.cnt;break;case 3:case 4:l.low=0;l.high=100;break;}var AI=!l.staticStatus&&!l.da.nov&&l.dt!=30;l.set("lowText",AI?S.formatNumber(l.qua,l.low,l.numFmts):"");l.set("highText",AI?S.formatNumber(l.qua,l.high,l.numFmts):"");l.step=(l.qua==1||l.qua==2)?1:this.getStep();l.low-=l.step;l.high+=l.step;l.cs1Vl=l.low;l.cs2Vl=l.high;var t=l.low,AC=l.high,AH=[],AE=0;if(w(t)&&w(AC)&&l.dt!=30){for(var AB=0,z=t;z<=AC;AB++,z+=l.step){AH[AB]={n:S.formatNumber(l.qua,z,l.numFmts),v:Number(Number(z).toFixed(l.numFmts.dp+AG))};}AE=AH.length;if(AE>0&&AH[AE-1].v!=AC){AH[AE-1]={n:S.formatNumber(l.qua,AC,l.numFmts),v:AC};}}AE=AH.length;if(AE>=2){AH[0].n=AH[AE-1].n=K(7622);}l.items=AH;var p=S.OP,AD=l.cs,AA=(AD&&AD.length>0)?f.parseNumeric(String(AD[0].v).replace("%","")):t,x=(AD&&AD.length>1)?f.parseNumeric(String(AD[1].v).replace("%","")):AC;if(AA<l.low){l.frtUst=true;}if(x>l.high){l.ndUst=true;}l.opId=(l.f!=null&&l.ft!=null)?S.getOpIdxByfunc(l.f,l.ft):p._BETWEEN;switch(l.opId){case p._EQUALS:case p._NOT_EQUALS:l.cs1Vl=l.cs2Vl=AA;break;case p._LESS_EQUAL:case p._GREATER:l.cs1Vl=t;l.cs2Vl=AA;break;case p._GREATER_EQUAL:case p._LESS:l.cs1Vl=AA;l.cs2Vl=AC;break;case p._IN:case p._NOT_IN:case p._IS_NULL:case p._IS_NOT_NULL:break;default:l.cs1Vl=AA;l.cs2Vl=x;break;}l.cs1Idx=this.getIdx(l.cs1Vl);l.cs2Idx=this.getIdx(l.cs2Vl);if(l.dt!=30){l.cs1Nm=w(l.cs1Vl)?S.formatNumber(l.qua,l.cs1Vl,l.numFmts):l.items[l.cs1Idx].n;l.cs2Nm=w(l.cs2Vl)?S.formatNumber(l.qua,l.cs2Vl,l.numFmts):l.items[l.cs2Idx].n;}l.unit=this.getUnit();l.set("unSet",(l.dt==30||!s(l)||q(l)||(!l.cs||l.cs.length==0))&&!l.staticStatus);};this.updateOpCs=function(){var t=(l.cs1Vl>l.cs2Vl)?l.cs2Vl:l.cs1Vl,AA=(l.cs1Vl>l.cs2Vl)?l.cs1Vl:l.cs2Vl,s=l.low,w=l.high,z=l.include,p=S.OP,q=(l.qua==S.Q._PT||l.qua==S.Q._PB),AB,x=[];if((t>=s&&AA<=w)||t<s||AA>w){l.opId=(z)?p._BETWEEN:p._NOT_BETWEEN;}if(t==AA){l.opId=(z)?p._EQUALS:p._NOT_EQUALS;}if(t==s&&AA<w){l.opId=(z)?p._LESS_EQUAL:p._GREATER;}if(t>s&&AA==w){l.opId=(z)?p._GREATER_EQUAL:p._LESS;}AB=s==t&&AA==w;if(!AB){switch(l.opId){case p._BETWEEN:case p._NOT_BETWEEN:x.push({dtp:5,v:f.toLocaleString(t)+(q?"%":"")});case p._EQUALS:case p._NOT_EQUALS:x.push({dtp:5,v:f.toLocaleString(AA)+(q?"%":"")});break;default:if(t>s){x.push({dtp:5,v:f.toLocaleString(t)+(q?"%":"")});}if(AA<w){x.push({dtp:5,v:f.toLocaleString(AA)+(q?"%":"")});}}}l.cs=x;l.parent.node.data.cs=x;l.set("unSet",AB);};this.updateThumb=function(){var p=l.cs1Idx,t=l.cs2Idx;if(p!==undefined&&t!==undefined){var q=l.unit,s=l.gap;R.copy(M(l,l,H(p*q-s),H(t*q-s)),l);}};this.joinConst=function(){var s=l.cs;if(s){var p=[],q;for(q in s){p.push(s[q].v);}return p.join(",");}};}var h="<span {@ttpCssText}>{@content}</span>";function Z(){if(this.staticStatus){return null;}var q=this.ghost;if(!q){var w=this.containerNode.cloneNode(true),t=w.childNodes;d.addClass(w,["gh"]);q=this.ghost={containerNode:w,lowerRange:t[0],handle1Node:t[1],thumbNode:t[2],handle2Node:t[3],upperRange:t[4]};this.sdcNode.appendChild(w);}var o=this.orCfg,l=o.posCssP,p=o.lenCssP,s=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(AC,x){var AB=mstrmojo.all[s],AA=AB[AC].style,z=q[AC].style;if(x){z[l]=AA[l];}z[p]=AA[p];});q.containerNode.style.display="block";return q;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style="position:absolute;"><div class="bk" style="margin-top: 2px;{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:5px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:5px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},bgNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[3];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);},onunSetChange:function(){d.toggleClass(this.domNode.childNodes[1],"invalid",this.unSet);}},init:function X(l){this._super(l);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new Y(this);this.useRichTooltip=false;},unSet:false,preBuildRendering:function D(){var q=this.orCfg,p=this.isHoriz;q.cPosCssP=(p)?"right":"bottom";q.cLenCssP=(p)?"height":"width";var w=q.lenCssP,t=this[w],s=parseInt(t,10),o=this.handleSize;var l=this._length=(isNaN(s))?0:(s-o);if(l<=0){l=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-o;}if(t){this.bkCssText=w+":"+E(s-(2*this.cssBkBW),0)+"px;";this.sdcCssText=q.posCssP+":0px;"+w+":"+l+"px;"+q.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function b(){this._super();if(!this.staticStatus&&!this.da.nov){var o=this.lowNode,l=parseInt(o.style.fontSize,10);o.style.fontSize=this.highNode.style.fontSize=H((isNaN(l)?8:l)*this.parent.model.zf)+"pt";this.updateSummary();}},onmouseover:function J(l){this.showTooltip(l.e,self);},onmouseout:function G(l){this.hideTooltip(l.e,self);},summaryLabels:{db:K(8153,"Between ## and ###"),dnb:K(8154,"Not between ## and ###"),din:K(587,"In"),dnin:K(2204,"Not in"),dnull:K(2202,"Is Null"),dnnull:K(2203,"Is not Null"),req:K(8155,"Rank ="),rneq:K(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:K(8157,"Rank exclude bottom"),rext:K(8158,"Rank exclude top"),rb:K(8159,"Rank bottom"),rt:K(8160,"Rank top"),rbt:K(8161,"Rank between ## and ###"),rnbt:K(8162,"Rank not between ## and ###"),rin:K(8163,"Rank in"),rnin:K(8164,"Rank not in"),peq:K(8165,"Percent ="),pneq:K(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:K(8167,"Exclude bottom"),pext:K(8168,"Exclude top"),pb:K(7576,"Bottom"),pt:K(7575,"Top"),pbt:K(8153,"Between ## and ###"),pnbt:K(8154,"Not between ## and ###"),pin:K(8169,"Percent in"),pnin:K(8170,"Percent not in")},updateSummary:function A(){if(this.summaryNode&&!this.staticStatus){var AC=this.f,AB=this.ft,z=S,q=S.FN,p=S.MRPFN,AA="",AE=(this.cs1Vl<this.cs2Vl)?this.cs1Nm:this.cs2Nm,AD=(this.cs1Vl>this.cs2Vl)?this.cs1Nm:this.cs2Nm,o=this.typeHelper,AF=this.summaryLabels,x=(AB==z._GENERIC&&(AC==q.ISNULL||AC==q.ISNOTNULL||AC==q.NOTIN||AC==q.IN))||((AB==z._PERCENT||AB==z._RANK)&&(AC==p.INASCENDING||AC==p.INDESCENDING||AC==p.NOTINDESCENDING||AC==p.NOTINASCENDING));if(!this.unSet||x){switch(AB){case z._GENERIC:switch(AC){case q.EQUALS:AA="= "+AE;break;case q.NOTEQUALS:AA=String.fromCharCode(8800)+" "+AE;break;case q.GREATERTHAN:AA="> "+AD;break;case q.GREATERTHANEQUALS:AA=String.fromCharCode(8805)+" "+AE;break;case q.LESSTHAN:AA="< "+AE;break;case q.LESSTHANEQUALS:AA=String.fromCharCode(8804)+" "+AD;break;case q.BETWEEN:AA=AF.db.replace("##",AE).replace("###",AD);break;case q.NOTBETWEEN:AA=AF.dnb.replace("##",AE).replace("###",AD);break;case q.ISNULL:AA=AF.dnull;break;case q.ISNOTNULL:AA=AF.dnnull;break;case q.IN:AA=AF.din+" "+o.joinConst();break;case q.NOTIN:AA=AF.dnin+" "+o.joinConst();break;}break;case z._PERCENT:case z._RANK:var l="r";if(AB==z._PERCENT){l="p";}switch(AC){case p.EQUALSDESCENDING:case p.EQUALSASCENDING:AA=AF[l+"eq"]+" "+AE;break;case p.NOTEQUALSDESCENDING:case p.NOTEQUALSASCENDING:AA=AF[l+"neq"]+" "+AE;break;case p.GREATERTHANEQUALSASCENDING:AA=AF[l+"exb"]+" "+AE;break;case p.GREATERTHANASCENDING:AA=AF[l+"exb"]+" "+AD;break;case p.GREATERTHANEQUALSDESCENDING:AA=AF[l+"ext"]+" "+AE;break;case p.GREATERTHANDESCENDING:AA=AF[l+"ext"]+" "+AD;break;case p.LESSTHANASCENDING:AA=AF[l+"b"]+" "+AE;break;case p.LESSTHANEQUALSASCENDING:AA=AF[l+"b"]+" "+AD;break;case p.LESSTHANDESCENDING:AA=AF[l+"t"]+" "+AE;break;case p.LESSTHANEQUALSDESCENDING:AA=AF[l+"t"]+" "+AD;break;case p.BETWEENDESCENDING:case p.BETWEENASCENDING:AA=AF[l+"bt"].replace("##",AE).replace("###",AD);break;case p.NOTBETWEENASCENDING:case p.NOTBETWEENDESCENDING:AA=AF[l+"nbt"].replace("##",AE).replace("###",AD);break;case p.INASCENDING:case p.INDESCENDING:AA=AF[l+"in"]+" "+o.joinConst();break;case p.NOTINDESCENDING:case p.NOTINASCENDING:AA="";AA=AF[l+"nin"]+" "+o.joinConst();break;}break;}}var t=this.summaryNode,w=(AA!=="")?"":0;t.innerHTML=AA;t.style.margin=w;if(this.hasRendered&&this.height==null){this.parent.updateHeight();}}},getClientHeight:function W(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function V(s,l){if(!this.staticStatus&&!this.da.nov){l=l||window;var t=a.eventTarget(l,this.dnd.startE);if(t===this.handle1Node||t===this.handle2Node){var q=Z.call(this),o=this.orCfg,p=this.dnd;p.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10),length:this._length,contL:q.containerNode[o.lenP],offset:a.getMousePosition(this.dnd.startE,l)[o.offsetP]};p.initD.td=t;d.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function I(x,w){if(!this.staticStatus){w=w||window;var AA=this.dnd.initD;if(AA){var AF=this.ghost,AG=AA.handle1,q=AA.handle2,t=this.cs1Idx,p=this.cs2Idx,AE=this.unit,AC=this.gap,o=AA.length;var AD=a.getMousePosition(x,w)[this.orCfg.offsetP]-AA.offset;switch(AA.td){case this.handle1Node:AG=E(C(E(AA.handle1+AD,0),o)-AC,-1);t=E(B(AG/AE+0.5),0);break;case this.handle2Node:q=E(C(E(AA.handle2+AD,0),o)-AC,-1);p=E(U.ceil(q/AE+0.5),0);break;default:return ;}M(this,AF,AG,q);var z=this.items,l=(z&&z.length)||0;if(l&&t>=0&&t<l&&p>=0&&p<l){var s=false;if(t!==this.cs1Idx){this.cs1Idx=t;var AB=this.items[t];this.cs1Vl=AB.v;this.cs1Nm=AB.n;s=true;}if(p!==this.cs2Idx){this.cs2Idx=p;var AB=this.items[p];this.cs2Vl=AB.v;this.cs2Nm=AB.n;s=true;}if(s){this.typeHelper.updateThumb();this._updateTooltip(AA.td);}}}}},ondrop:function g(o){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var l=this.ghost;if(l){l.containerNode.style.display="none";}this.hideTooltip(o,self);if(this.items&&this.items.length){this[(a.eventTarget(self,o)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function O(l,AA,AB){var s=this.typeHelper,w=this.cs1Vl,t=this.cs2Vl,o=this.qua,p=this.numFmts;this.cs1Idx=s.getIdx(w);this.cs2Idx=s.getIdx(t);var z=function(q,AD){var AC=AD||[];return q==0||q==AC.length-1;},x=K(7622);this.cs1Nm=z(this.cs1Idx,this.items)&&!this.frtUst?x:S.formatNumber(o,w,p);this.cs2Nm=z(this.cs2Idx,this.items)&&!this.ndUst?x:S.formatNumber(o,t,p);s.updateOpCs();this.onlyInclude=!!l;this.changeQual=!!AA;this.unSet=!!AB||this.unSet;this.updateSummary();this.onselectionChange();},onincludeChange:function N(){if(!this.staticStatus){this.selectRange(true);}},showTooltip:function F(o,l){var p=a.eventTarget(l,o);this._updateTooltip(p);mstrmojo.tooltip.open(this,o,l);},_updateTooltip:function T(s){var o=this.orCfg,q=o.posCssP,l,p={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};p[o.opPosCssP]=-parseInt(this.font)/2;p[q]=s.style[q];if(this.unSet){l=K(7622);}else{l=String((s===this.handle1Node)?this.cs1Nm:this.cs2Nm);}p.content=h.replace(/\{@content\}/g,l);this.set("richTooltip",p);},onclick:function k(l){if(!this.staticStatus&&!this.da.nov){var o=a.eventTarget(l.hWin||window,l.e);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((o===this.handle1Node)?this.handle1Node:((o===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(o===this.handle1Node),tgt:o});if(this._onThumb){this._onThumb(l);}}},onselectionChange:function Q(l){this._super(l);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function P(l){var p=mstrmojo.MCSUtil.getFuncInfo(this.opId,l.valueWas),q=mstrmojo.MCSUtil.getFuncInfo(this.opId,l.value),o;if(p.ft!=q.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();o=true;}}else{this.f=mstrmojo.MCSUtil.getFuncInfo(this.opId,l.value).f;o=false;}this.selectRange(false,true,o);},updateData:function j(l,o){this.da=l;this.updateExpr(o);},updateExpr:function L(l){if(l){this.cs=l.cs;this.f=l.f;this.ft=l.ft;this.qua=l.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",C(E(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var p=this.opener,o=this.children[0];if(p){var l=this.isfrt?p.cs1Vl:p.cs2Vl;if(this.isfrt){if((p.cs1Vl<=p.low||p.cs1Vl>=p.high)&&!p.frtUst){l="";}}else{if((p.cs2Vl<=p.low||p.cs2Vl>=p.high)&&!p.ndUst){l="";}}o.edt.set("value",f.toLocaleString(l));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!=0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(o){if(this.parent.apply.enabled){var l=o.hWin,p=o.e||l.event;if(p.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var o=this.parent.parent,q=o.opener,l=this.parent.edt.value;if(o&&q&&String(l).length>0){q[o.isfrt?"cs1Nm":"cs2Nm"]=l;l=f.parseNumeric(l);q[o.isfrt?"cs1Vl":"cs2Vl"]=l;}q[o.isfrt?"frtUst":"ndUst"]=true;q.selectRange();q.typeHelper.updateThumb();o.close();}}]}]},openEditValue:function(l){this.openPopup("editValueRef",l);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.graph._MobileGraphAreaHelper","mstrmojo.GraphBase","mstrmojo.dom");var AG=0,Av=0,BF=0,Af=1,g=2,Y=11,W=12,AW=13,BL=101,o=102,A2=111,Ad=112,BG=113,l=121,A7=122,Ag=131,z=132,AJ=201,H=301,F=302,AD=303,t=311,h=321,BB=322,B=401,A5=402,Am=501,J=502,AR=503,AP=511,s=512,M=513,BJ=514,Au=515,BM=521,AV=522,Q=601,N=701,AY=801;var Al=0,I=9,AL=10,Z=14;var AB=0,AN=1,G=2,Ak=3,Ah=4;var p=0,A4=1,Aj=2;var U=2,d=3;var A1=0,AQ=3,BE=4,AA=6,E=13,A=14,D=101;var BA=0,A0=1,Ap=2;var Ai=3.14159265;var f,a;var Ay=0,A8=1,As=2,R=3,AH=4,BK=5,AF=6,Aa=7,AX=8,Ac=9;var A9=100;var BC=[[-100,-100,100,-100,100,100,-100,100],[-80,-100,0,-20,80,-100,100,-80,20,0,100,80,80,100,0,20,-80,100,-100,80,-20,0,-100,-80],[-33,-100,33,-100,33,-33,100,-33,100,33,33,33,33,100,-33,100,-33,33,-100,33,-100,-33,-33,-33],[-50,-100,50,-100,50,-50,100,-50,100,50,50,50,50,100,-50,100,-50,50,-100,50,-100,-50,-50,-50],[],[0,-100,100,0,0,100,-100,0],[0,-100,100,100,-100,100],[-100,-100,100,-100,100,100,-100,100],[0,-100,23,-31,95,-31,36,12,59,81,0,38,-59,81,-36,12,-95,-31,-23,-31],[0,-60,100,-100,100,100,-100,100,-100,-100,0,-60,0,100]];function At(Ce,B2,Cw,B0){var Bj=Cw.InstructionList,B8=Bj.length,Bp,CD,Bz,By,CG,B1,Bi,Bm,BS,BW,CF,B7,Ba,Cq,CM,CH,Cu;for(CD=0;CD<B8;CD++){Bp=Bj[CD];if(typeof (Bp)==="undefined"){continue;}switch(Bp.Ins){case BF:break;case Af:Ce.save();break;case g:Ce.restore();break;case Y:Ce.clip();break;case W:Ce.scale(Bp.X,Bp.Y);break;case AW:if(Bp.Radian!==0){Ce.translate(Bp.Anchor.X,Bp.Anchor.Y);Ce.rotate(Bp.Radian);Ce.translate(-Bp.Anchor.X,-Bp.Anchor.Y);}break;case BL:Ce.beginPath();break;case o:Ce.closePath();break;case A2:if(Cw.IsAnimated===0){Ce.moveTo(Bp.X,Bp.Y);}else{if(Bp.CA[0]==0){Bz=Bp.X[0]*(1-B2)+Bp.X[1]*B2;By=Bp.Y[0]*(1-B2)+Bp.Y[1]*B2;Ce.moveTo(Bz,By);}else{var Bo=Math.sqrt((Bp.X[0]-Bp.BPX[0])*(Bp.X[0]-Bp.BPX[0])+(Bp.Y[0]-Bp.BPY[0])*(Bp.Y[0]-Bp.BPY[0]));var Bl=Math.sqrt((Bp.X[1]-Bp.BPX[0])*(Bp.X[1]-Bp.BPX[0])+(Bp.Y[1]-Bp.BPY[0])*(Bp.Y[1]-Bp.BPY[0]));var CJ=Math.sqrt((Bp.X[0]-Bp.X[1])*(Bp.X[0]-Bp.X[1])+(Bp.Y[0]-Bp.Y[1])*(Bp.Y[0]-Bp.Y[1]));var Bn=Math.acos((Bo*Bo+Bl*Bl-CJ*CJ)/(2*Bo*Bl));var Cz=(Bp.X[0]-Bp.BPX[0])*Math.cos(Bn)-(Bp.Y[0]-Bp.BPY[0])*Math.sin(Bn)+Bp.BPX[0]-Bp.X[1];if(Cz<-0.01||Cz>0.01){Bn=2*Ai-Bn;}Bz=(Bp.X[0]-Bp.BPX[0])*Math.cos(B2*Bn)-(Bp.Y[0]-Bp.BPY[0])*Math.sin(B2*Bn)+Bp.BPX[0];By=(Bp.Y[0]-Bp.BPY[0])*Math.cos(B2*Bn)+(Bp.X[0]-Bp.BPX[0])*Math.sin(B2*Bn)+Bp.BPY[0];Ce.moveTo(Bz,By);}}break;case Ad:if(Cw.IsAnimated===0){Ce.lineTo(Bp.X,Bp.Y);}else{if(Bp.CA[0]==0){Bz=Bp.X[0]*(1-B2)+Bp.X[1]*B2;By=Bp.Y[0]*(1-B2)+Bp.Y[1]*B2;Ce.lineTo(Bz,By);}else{var Bo=Math.sqrt((Bp.X[0]-Bp.BPX[0])*(Bp.X[0]-Bp.BPX[0])+(Bp.Y[0]-Bp.BPY[0])*(Bp.Y[0]-Bp.BPY[0]));var Bl=Math.sqrt((Bp.X[1]-Bp.BPX[0])*(Bp.X[1]-Bp.BPX[0])+(Bp.Y[1]-Bp.BPY[0])*(Bp.Y[1]-Bp.BPY[0]));var CJ=Math.sqrt((Bp.X[0]-Bp.X[1])*(Bp.X[0]-Bp.X[1])+(Bp.Y[0]-Bp.Y[1])*(Bp.Y[0]-Bp.Y[1]));var Bn=Math.acos((Bo*Bo+Bl*Bl-CJ*CJ)/(2*Bo*Bl));var Cz=(Bp.X[0]-Bp.BPX[0])*Math.cos(Bn)-(Bp.Y[0]-Bp.BPY[0])*Math.sin(Bn)+Bp.BPX[0]-Bp.X[1];if(Cz<-0.02||Cz>0.02){Bn=2*Ai-Bn;}Bz=(Bp.X[0]-Bp.BPX[0])*Math.cos(B2*Bn)-(Bp.Y[0]-Bp.BPY[0])*Math.sin(B2*Bn)+Bp.BPX[0];By=(Bp.Y[0]-Bp.BPY[0])*Math.cos(B2*Bn)+(Bp.X[0]-Bp.BPX[0])*Math.sin(B2*Bn)+Bp.BPY[0];Ce.lineTo(Bz,By);}}break;case BG:if(Cw.IsAnimated===0){Ce.bezierCurveTo(Bp.CP1X,Bp.CP1Y,Bp.CP2X,Bp.CP2Y,Bp.X,Bp.Y);}else{cp1x=Bp.CP1X[0]*(1-B2)+Bp.CP1X[1]*B2;cp1y=Bp.CP1Y[0]*(1-B2)+Bp.CP1Y[1]*B2;cp2x=Bp.CP2X[0]*(1-B2)+Bp.CP2X[1]*B2;cp2y=Bp.CP2Y[0]*(1-B2)+Bp.CP2Y[1]*B2;Bz=Bp.X[0]*(1-B2)+Bp.X[1]*B2;By=Bp.Y[0]*(1-B2)+Bp.Y[1]*B2;Ce.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,Bz,By);}break;case l:if(Cw.IsAnimated===0){Ce.rect(Bp.X,Bp.Y,Bp.W,Bp.H);}else{Bz=Bp.X[0]*(1-B2)+Bp.X[1]*B2;By=Bp.Y[0]*(1-B2)+Bp.Y[1]*B2;B1=Bp.W[0]*(1-B2)+Bp.W[1]*B2;CG=Bp.H[0]*(1-B2)+Bp.H[1]*B2;Ce.rect(Bz,By,B1,CG);}break;case A7:if(Cw.IsAnimated===0){if(Bp.EndAngle==6.283){Bp.EndAngle=2*Ai;}Ce.arc(Bp.X,Bp.Y,Bp.Radius,Bp.StartAngle,Bp.EndAngle,Bp.AntiClockwise);}else{if(Bp.EndAngle[0]==6.283){Bp.EndAngle[0]=2*Ai;}if(Bp.EndAngle[1]==6.283){Bp.EndAngle[1]=2*Ai;}Ce.arc(Bp.X[0]*(1-B2)+Bp.X[1]*B2,Bp.Y[0]*(1-B2)+Bp.Y[1]*B2,Bp.Radius[0]*(1-B2)+Bp.Radius[1]*B2,Bp.StartAngle[0]*(1-B2)+Bp.StartAngle[1]*B2,Bp.EndAngle[0]*(1-B2)+Bp.EndAngle[1]*B2,Bp.AntiClockwise[0]);}break;case z:if(Cw.IsAnimated==1){var Bv=Bp.Angle[0]*(1-B2)+Bp.Angle[1]*B2;var Bh=Bp.NeedleSize[0];var CK=Bp.BPX[0];var CI=Bp.BPY[0];var BT=Bp.MarkSize[0];var Cj=Bp.MarkShape[0];var CV={X:Bh*Math.cos(Bv)+CK,Y:Bh*Math.sin(Bv)*-1+CI};var B5=AS(Cj,CV,BT);C(Ce,B5,false,false);}break;case AJ:case H:break;case F:Ce.lineWidth=Bp.LineWidth;break;case AD:switch(Bp.Type){case BA:Ce.lineJoin="miter";break;case A0:Ce.lineJoin="bevel";break;case Ap:Ce.lineJoin="round";break;}break;case t:case h:case BB:break;case B:Ce.fill();break;case A5:Ce.stroke();break;case Am:BS=Bp.Format;Bi=B0[BS];if(Bp.HEP==1){Bm=Bp.FC;}else{Bm=Bi.SimpleColor;}Ce.fillStyle="RGBA("+Math.round(Bm.R*Bp.DarkerFactor)+", "+Math.round(Bm.G*Bp.DarkerFactor)+", "+Math.round(Bm.B*Bp.DarkerFactor)+", "+Bi.Alpha/255+");";Ce.fill();break;case J:break;case AR:if(Cw.IsAnimated===0){Ba=Bp.BoundingRect;Cu=Bp.DarkerFactor;}else{Ba=Bp.BoundingRect[0];Cu=Bp.DarkerFactor[0];var Cx=Bp.BoundingRect[1];Ba.X=Ba.X*(1-B2)+Cx.X*B2;Ba.Y=Ba.Y*(1-B2)+Cx.Y*B2;Ba.Width=Ba.Width*(1-B2)+Cx.Width*B2;Ba.Height=Ba.Height*(1-B2)+Cx.Height*B2;}if(Ba.Width<1||Ba.Height<1){continue;}Ba.Width=Math.floor(Ba.Width);Ba.Height=Math.floor(Ba.Height);var Bi=B0[Bp.Format];if(Bi.Bevel.FillBevelType!=Ah||B2<1){Az(Ce,Bi,Ba,Cu);}else{Aq(Ce,Bi);Az(Ce,Bi,Ba,Cu);}break;case AP:Bi=B0[Bp.Format];CM=Bi.Bevel;B5=AI(Bp.Polygon);var Bu=B5.length;var BZ=[];for(var CE=0;CE<Bu;CE++){BZ.push(B5[CE]);}while(true){Bu=BZ.length;if(Bu<3){break;}var Bf=[];var B6=[];var BU=false;if(Bu>3){var Cp={X:0,Y:0};for(var CE=0;((CE<(Bu-2))&&(!BU));++CE){for(var CB=CE+2;CB<(Bu-1);++CB){var Cs=b(BZ[CE],BZ[CE+1],BZ[CB],BZ[CB+1],Cp,false);Cp=Cs.interSection;if(Cs.val==1){BU=true;for(m=0;m<=CE;++m){if(!AZ(BZ[m],Cp)){Bf.push(BZ[m]);}}Bf.push(Cp);for(m=CB+1;m<Bu;++m){if(!AZ(BZ[m],Cp)){Bf.push(BZ[m]);}}B6.push(Cp);for(m=CB;m>CE;--m){if(!AZ(BZ[m],Cp)){B6.push(BZ[m]);}}break;}}if((CE!=0)&&(!BU)){var Cs=b(BZ[CE],BZ[CE+1],BZ[0],BZ[Bu-1],Cp,false);Cp=Cs.interSection;if(Cs.val==1){for(m=0;m<=CE;++m){Bf.push(BZ[m]);}Bf.push(Cp);B6.push(Cp);for(m=Bu-1;m>CE;--m){B6.push(BZ[m]);}BU=true;}}}}if(!BU){Bf=BZ;}var Co=0;var Cf=BO(Bf,Co);Co=Cf.depth;if(!Cf.mark){break;}Co*=CM.Depth*0.01;var Bx=[];var BY=[];var B3=Bf.length;for(var CE=0;CE<B3;++CE){var Ca;var Bs;var Cf=Ax(Bf[(CE+B3-1)%B3],Bf[CE],Bf[(CE+1)%B3],Co);Ca=Cf.start;Bs=Cf.end;Bx.push(Ca);BY.push(Bs);}for(var CE=0;CE<B3;++CE){var CS={X:BY[CE].X-Bx[CE].X,Y:BY[CE].Y-Bx[CE].Y};var BV=Math.sqrt(Aw(CS));var CZ={X:CS.X/BV,Y:CS.Y/BV};var BQ=AC((540-CM.LightAngle)%360);var Bb={X:Math.cos(BQ),Y:Math.sin(BQ)};var B4=AO(CZ,Bb);var CT=0;var CA=0;var Ch=0.1;var Cr=0.2;if(B4<-0.01){CT=(1+B4)*Ch;CA=(1+Math.abs(B4))*Cr*CM.Intensity*0.01;}else{CT=(1-Ch)+B4*Ch;CA=((1-Cr)+B4*Cr)*CM.Intensity*0.01;}var B9=CE+1;if(B9==B3){B9-=B3;}Ce.beginPath();Ce.moveTo(Bf[CE].X,Bf[CE].Y);Ce.lineTo(Bf[B9].X,Bf[B9].Y);Ce.lineTo(Bx[B9].X,Bx[B9].Y);Ce.lineTo(Bx[CE].X,Bx[CE].Y);Ce.closePath();var CR=Math.round(CT*255);if(isNaN(CR)){continue;}if(CM.FillBevelType==AN){Ce.save();Ce.clip();var BR=Ce.createLinearGradient(BY[CE].X,BY[CE].Y,Bx[CE].X,Bx[CE].Y);BR.addColorStop(0,"rgba("+CR+","+CR+","+CR+","+CA+")");BR.addColorStop(1,"rgba("+CR+","+CR+","+CR+","+0+")");Ce.fillStyle=BR;Ce.fill();Ce.restore();}else{Ce.fillStyle="RGBA("+CR+", "+CR+", "+CR+", "+CA+");";Ce.fill();}}if(BU){BZ=B6;}else{break;}}if(B5.length!=0){Ce.beginPath();Ce.moveTo(B5[0].X,B5[0].Y);for(var CE=1;CE<B5.length;++CE){Ce.lineTo(B5[CE].X,B5[CE].Y);}Ce.closePath();}break;case s:Bi=B0[Bp.Format];CM=Bi.Bevel;if(Cw.IsAnimated===0){Ba=Bp.BoundingRect;CH=Bp.IsCircularShape;}else{var Cy=Bp.BoundingRect[0];var Cx=Bp.BoundingRect[1];Ba={X:0,Y:0,Width:0,Height:0};Ba.X=Cy.X*(1-B2)+Cx.X*B2;Ba.Y=Cy.Y*(1-B2)+Cx.Y*B2;Ba.Width=Cy.Width*(1-B2)+Cx.Width*B2;Ba.Height=Cy.Height*(1-B2)+Cx.Height*B2;}if(CM.FillBevelType===Ak){var Cv=0.2;var CO=CM.Intensity*0.01*Bi.Alpha/255;var CQ=1-CM.Depth*0.01;Cq=Ce.createLinearGradient(Ba.X,Ba.Y,Ba.X+Ba.Width,Ba.Y);CF="RGBA(0,0,0,"+CO+");";B7="RGBA(255,255,255,"+CO+");";Cq.addColorStop(0,CF);Cq.addColorStop(CQ*Cv,CF);Cq.addColorStop(CQ,B7);Cq.addColorStop(1,CF);}else{CF=Bi.SimpleColor;var Bc={x:Ba.X+Ba.Width/2,y:Ba.Y+Ba.Height/2};f={x:0,y:0};a={x:0,y:0};AE(Ba,CM.LightAngle,Bc);var Bg=Bi.Alpha/255;var Br=Bg;if(Bi.FillType!=A1){Bg*=0.8;Br*=0.5;CF={R:128,G:128,B:128};}var BR=Ce.createLinearGradient(f.x,f.y,a.x,a.y);BR.addColorStop(0,"rgba(255,255,255,"+Bg+")");BR.addColorStop(0.05+CM.Intensity*0.001,"rgba(255,255,255,"+9*Bg/(10-Bg)+")");BR.addColorStop(0.5,"rgba("+CF.R+","+CF.G+","+CF.B+","+Br+")");BR.addColorStop(0.85+(1-CM.Intensity*0.01)*0.05,"rgba(0,0,0,"+9*Bg/(10-Bg)+")");BR.addColorStop(1,"rgba(0,0,0,"+Bg+")");Ce.fillStyle=BR;Ce.fill();if(Bi.FillType!=A1){continue;}var BP=Math.max(Ba.Width,Ba.Height)*0.5*(2-CM.Intensity*0.01);BP*=CH?0.75:2;Cq=Ce.createRadialGradient(Bc.x,Bc.y,0,Bc.x,Bc.y,BP);Cq.addColorStop(0,"rgba("+CF.R+","+CF.G+","+CF.B+","+Bg+")");Cq.addColorStop(0.5,"rgba("+CF.R+","+CF.G+","+CF.B+","+Bg/2+")");Cq.addColorStop(0.8,"rgba("+CF.R+","+CF.G+","+CF.B+","+Bg/10+")");Cq.addColorStop(1,"rgba("+CF.R+","+CF.G+","+CF.B+",0)");}Ce.fillStyle=Cq;Ce.fill();break;case Au:Bi=B0[Bp.Format];CM=Bi.Bevel;var Cd=Bp.CX;var Cc=Bp.CY;var Cl=Bp.Radius;var BP;var CO;switch(Bp.BorderUse){case U:CO=0.4;f={x:Cd+Cl*Math.cos(Ai*1.25),y:Cc+Cl*Math.sin(Ai*1.25)};a={x:Cd+Cl*Math.cos(Ai*0.25),y:Cc+Cl*Math.sin(Ai*0.25)};Ce.save();Ce.clip();var BR=Ce.createLinearGradient(f.x,f.y,a.x,a.y);BR.addColorStop(0,"rgba(0,0,0,"+CO+")");BR.addColorStop(1,"rgba(255,255,255,"+CO+")");Ce.fillStyle=BR;Ce.fill();Ce.restore();CO=0.4;BP=Cl*0.3;Bm=Bi.SimpleColor;f={x:Cd+BP*Math.cos(Ai*0.75),y:Cc+BP*Math.sin(Ai*0.75)};a={x:Cd+BP*Math.cos(Ai*1.75),y:Cc+BP*Math.sin(Ai*1.75)};Ce.save();Ce.clip();var BR=Ce.createLinearGradient(f.x,f.y,a.x,a.y);BR.addColorStop(0,"rgba("+Bm.R+","+Bm.G+","+Bm.B+","+0+")");BR.addColorStop(0.2,"rgba("+Bm.R+","+Bm.G+","+Bm.B+","+1+")");BR.addColorStop(0.8,"rgba("+Bm.R+","+Bm.G+","+Bm.B+","+1+")");BR.addColorStop(1,"rgba("+Bm.R+","+Bm.G+","+Bm.B+","+0+")");Ce.fillStyle=BR;Ce.fill();Ce.restore();break;case d:CO=0.6;BP=Cl*0.2;var CQ=0.3;f={x:Cd+BP*Math.cos(Ai*1.25),y:Cc+BP*Math.sin(Ai*1.25)};a={x:Cd+Cl*Math.cos(Ai*0.25),y:Cc+Cl*Math.sin(Ai*0.25)};Ce.save();Ce.clip();var BR=Ce.createLinearGradient(f.x,f.y,a.x,a.y);BR.addColorStop(0,"rgba(255,255,255,"+CO+")");BR.addColorStop(CQ,"rgba(0,0,0,"+CO+")");BR.addColorStop(1,"rgba(255,255,255,"+CO+")");Ce.fillStyle=BR;Ce.fill();Ce.restore();break;default:CO=0.4;BP=Cl-Bp.Thickness;f={x:Cd+BP*Math.cos(Ai*1.25),y:Cc+BP*Math.sin(Ai*1.25)};a={x:Cd+BP*Math.cos(Ai*0.25),y:Cc+BP*Math.sin(Ai*0.25)};Ce.save();Ce.clip();var BR=Ce.createLinearGradient(f.x,f.y,a.x,a.y);BR.addColorStop(0,"rgba(0,0,0,"+CO+")");BR.addColorStop(1,"rgba(255,255,255,"+CO+")");Ce.fillStyle=BR;Ce.fill();Ce.restore();break;}break;case M:Bi=B0[Bp.Format];CM=Bi.Bevel;var CO;var CQ;var Cd;var Cc;var Bq;var Be;var CP;var Bw;var Bt;var Cg;if(Cw.IsAnimated===0){Cd=Bp.CX;Cc=Bp.CY;Bq=Bp.InnerRadius;Be=Bp.OuterRadius;CP=Bp.RGUsage;Bw=Bp.HEP;if(Bw==1){Bt=Bp.ExtraDepth;Cg=Bp.ExtraIntensity;}}else{Cd=Bp.CX[0]*(1-B2)+Bp.CX[1]*B2;Cc=Bp.CY[0]*(1-B2)+Bp.CY[1]*B2;Bq=Bp.InnerRadius[0];Be=Bp.OuterRadius[0];CP=Bp.RGUsage[0];Bw=Bp.HEP[0];if(Bw==1){Bt=Bp.ExtraDepth[0];Cg=Bp.ExtraIntensity[0];}}switch(CP){case p:CO=CM.Intensity*0.01*Bi.Alpha/255;CQ=1-CM.Depth*0.01;Cq=Ce.createRadialGradient(Cd,Cc,Bq,Cd,Cc,Be);CF="RGBA(0,0,0,"+CO+");";B7="RGBA(255,255,255,"+CO+");";Cq.addColorStop(0,CF);Cq.addColorStop(CQ,B7);Cq.addColorStop(1,CF);Ce.fillStyle=Cq;Ce.fill();break;case A4:CO=CM.Intensity*0.01*Bi.Alpha/255;Cq=Ce.createRadialGradient(Cd,Cc,Bq,Cd,Cc,Be);CF="RGBA(0,0,0,"+CO+");";B7="RGBA(255,255,255,"+CO+");";Cq.addColorStop(0,CF);Cq.addColorStop(1,B7);Ce.fillStyle=Cq;Ce.fill();break;case Aj:if(Bw==0){CO=CM.Intensity*0.01*Bi.Alpha/255;CQ=CM.Depth*0.01;}else{CO=Cg*0.01*Bi.Alpha/255;CQ=Bt*0.01;}Cq=Ce.createRadialGradient(Cd,Cc,Bq,Cd,Cc,Be);CF="RGBA(0,0,0,"+CO+");";B7="RGBA(255,255,255,"+CO+");";Cq.addColorStop(0,CF);Cq.addColorStop(CQ,B7);Cq.addColorStop(1,CF);Ce.fillStyle=Cq;Ce.fill();break;}break;case BJ:Bi=B0[Bp.Format];CM=Bi.Bevel;CO=CM.Intensity*0.01*Bi.Alpha/255;CQ=1-CM.Depth*0.01;CF="RGBA(0,0,0,"+CO+");";B7="RGBA(255,255,255,"+CO+");";Cq=Ce.createLinearGradient(Bp.StartPoint.X,Bp.StartPoint.Y,Bp.EndPoint.X,Bp.EndPoint.Y);Cq.addColorStop(0,CF);Cq.addColorStop(CQ,B7);Cq.addColorStop(1,CF);Ce.save();Ce.clip();Ce.fillStyle=Cq;Ce.fill();Ce.restore();break;case BM:case AV:break;case Q:BS=Bp.Format;Bi=B0[BS];Bm=Bi.Color;Ce.strokeStyle="RGBA("+Bm.R+", "+Bm.G+", "+Bm.B+", "+Bi.Alpha/255+");";Ce.stroke();break;case N:BS=Bp.Format;Bi=B0[BS];Bm=Bi.Color;Ce.font=Bi.Size+"px "+Bi.Name;if(Bi.Style&2){Ce.font="italic "+Ce.font;}if(Bi.Style&1){Ce.font="bold "+Ce.font;}Ce.fillStyle="RGBA("+Bm.R+", "+Bm.G+", "+Bm.B+", "+Bi.Alpha/255+");";Ce.fillText(Bp.Text,Bp.StartPoint.X,Bp.StartPoint.Y);if(Bi.Style&12){Ce.beginPath();var CN=Ce.measureText(Bp.Text);if(Bi.Style&4){Ce.moveTo(Math.round(Bp.StartPoint.X),Math.round(Bp.StartPoint.Y));Ce.lineTo(Math.round(Bp.StartPoint.X+CN.width),Math.round(Bp.StartPoint.Y));}if(Bi.Style&8){Ce.moveTo(Math.round(Bp.StartPoint.X),Math.round(Bp.StartPoint.Y-Bi.Size*0.5));Ce.lineTo(Math.round(Bp.StartPoint.X+CN.width),Math.round(Bp.StartPoint.Y-Bi.Size*0.5));}Ce.strokeStyle="RGBA("+Bm.R+", "+Bm.G+", "+Bm.B+", "+Bi.Alpha/255+");";Ce.lineWidth=Math.round(Math.max(1,Bi.Size*3/40));Ce.stroke();}break;case AY:var Ct;if(Cw.IsAnimated===0){Ct=Bp.Rect;}else{Ct=Bp.Rect[0];var Cx=Bp.Rect[1];Ct.X=Ct.X*(1-B2)+Cx.X*B2;Ct.Y=Ct.Y*(1-B2)+Cx.Y*B2;Ct.Width=Ct.Width*(1-B2)+Cx.Width*B2;Ct.Height=Ct.Height*(1-B2)+Cx.Height*B2;}var CC=Bp.RotationAngle;var CL=Bp.BevelDepth;var CW=Bp.LTColor;var CU=Bp.LTAlpha;var Cn=Bp.RBColor;var Ck=Bp.RBAlpha;var Cm={X:Ct.X+Ct.Width/2,Y:Ct.Y+Ct.Height/2};var Cb={X:0,Y:0,Width:0,Height:0};Cb.X=Ct.X;Cb.Y=Ct.Y;Cb.Width=Ct.Width;Cb.Height=Ct.Height;BI(Cb,CL,CL);var Bk=[];Bk.push(A6({X:Ct.X,Y:Ct.Y},Cm,CC));Bk.push(A6({X:Ct.X+Ct.Width,Y:Ct.Y},Cm,CC));Bk.push(A6({X:Ct.X+Ct.Width,Y:Ct.Y+Ct.Height},Cm,CC));Bk.push(A6({X:Ct.X,Y:Ct.Y+Ct.Height},Cm,CC));var Ci=[];Ci.push(A6({X:Cb.X,Y:Cb.Y},Cm,CC));Ci.push(A6({X:Cb.X+Cb.Width,Y:Cb.Y},Cm,CC));Ci.push(A6({X:Cb.X+Cb.Width,Y:Cb.Y+Cb.Height},Cm,CC));Ci.push(A6({X:Cb.X,Y:Cb.Y+Cb.Height},Cm,CC));var Bd=[];Bd.push(A6({X:Ct.X,Y:Ct.Y+Ct.Height},Cm,CC));Bd.push(A6({X:Cb.X,Y:Cb.Y+Cb.Height},Cm,CC));Bd.push(A6({X:Cb.X,Y:Cb.Y},Cm,CC));Bd.push(A6({X:Cb.X+Cb.Width,Y:Cb.Y},Cm,CC));Bd.push(A6({X:Ct.X+Ct.Width,Y:Ct.Y},Cm,CC));Bd.push(A6({X:Ct.X,Y:Ct.Y},Cm,CC));C(Ce,Bd,false,false);Ce.fillStyle="RGBA("+CW.R+", "+CW.G+", "+CW.B+", "+CU/255+");";Ce.fill();var BX=[];BX.push(A6({X:Ct.X,Y:Ct.Y+Ct.Height},Cm,CC));BX.push(A6({X:Cb.X,Y:Cb.Y+Cb.Height},Cm,CC));BX.push(A6({X:Cb.X+Cb.Width,Y:Cb.Y+Cb.Height},Cm,CC));BX.push(A6({X:Cb.X+Cb.Width,Y:Cb.Y},Cm,CC));BX.push(A6({X:Ct.X+Ct.Width,Y:Ct.Y},Cm,CC));BX.push(A6({X:Ct.X+Ct.Width,Y:Ct.Y+Ct.Height},Cm,CC));C(Ce,BX,false,false);Ce.fillStyle="RGBA("+Cn.R+", "+Cn.G+", "+Cn.B+", "+Ck/255+");";Ce.fill();Ce.strokeStyle="RGBA(230, 230, 230, "+CU*0.5/255+");";Ce.lineWidth=1;C(Ce,Bk,true,true);Ce.stroke();C(Ce,Ci,true,true);Ce.stroke();break;}}}function A3(BP,BQ){return 1-(Math.sqrt((BQ-256)*(BQ-256)+(BP-256)*(BP-256))/(1.5*256));}function V(BT,BP,BU,BR,BQ){var BS=(BR&&BQ)?0.5:0;BT.moveTo(BP+BS,BU+BS);}function BN(BT,BP,BU,BR,BQ){var BS=(BR&&BQ)?0.5:0;BT.lineTo(BP+BS,BU+BS);}function k(BS,BP,BR,BQ){var BU=BP.length;if(BU<=0){return ;}BS.beginPath();V(BS,BP[0].X,BP[0].Y,BR,BQ);var BT=0;for(i=1;i<BU;++i){BN(BS,BP[i].X,BP[i].Y,BR,BQ);BT=i;}}function X(BR){var BQ=BC[BR];var BP=BQ.length/2;return{number:BP,points:BQ};}function AS(BY,BT,BQ){var BP=[];if(BY==AH){BP.push({X:BT.X-BQ,Y:BT.Y-BQ});BP.push({X:BT.X+BQ,Y:BT.Y-BQ});BP.push({X:BT.X+BQ,Y:BT.Y+BQ});BP.push({X:BT.X-BQ,Y:BT.Y+BQ});return BP;}var BV;var BX;var BU=X(BY);BV=BU.number;BX=BU.points;for(var BW=0;BW<BV;BW++){var BS=(BX[2*BW])*BQ/A9+BT.X;var BR=(BX[2*BW+1])*BQ/A9+BT.Y;BP.push({X:BS,Y:BR});}return BP;}function C(BU,BQ,BS,BR){var BW=BQ.length;if(BW<3){return ;}BU.beginPath();if(BS&&BR){var BP=[];for(var BT=0;BT<BW;++BT){BP.push(BQ[BT]);}var BV=BW-1;for(var BT=0;BT<BW;++BT){lNextIndex=(BT+1==BW)?0:BT+1;if(BQ[BT].X==BQ[BV].X||BQ[BT].X==BQ[lNextIndex].X){BP[BT].X+=0.5;}if(BQ[BT].Y==BQ[BV].Y||BQ[BT].Y==BQ[lNextIndex].Y){BP[BT].Y+=0.5;}BV=BT;}k(BU,BP,false,BR);}else{k(BU,BQ,false,BR);}BU.closePath();}function BD(BP,BS,BR){var BT=BP.X-BS.X;var BQ=BP.Y-BS.Y;BP.X=BS.X+Math.cos(BR)*BT-Math.sin(BR)*BQ;BP.Y=BS.Y+Math.sin(BR)*BT+Math.cos(BR)*BQ;return BP;}function A6(BP,BR,BQ){return BD(BP,BR,BQ);}function BI(BQ,BR,BP){if(BR*2>BQ.Width){BR=BQ.Width/2;}if(BP*2>BQ.Height){BP=BQ.Height/2;}return AK(BQ,-BR,-BP);}function AK(BQ,BR,BP){BQ.X-=BR;BQ.Y-=BP;BQ.Width+=(BR*2);BQ.Height+=(BP*2);return BQ;}function x(BQ,BP,BR){return S(BQ,BP)+S(BP,BR)+S(BR,BQ);}function q(BQ,BP){return Math.sqrt((BQ.X-BP.X)*(BQ.X-BP.X)+(BQ.Y-BP.Y)*(BQ.Y-BP.Y));}function P(BS,BW,Bf){var Bb=Bf;var BR=BS.length;var Ba=BW;var Bc=BS[(Ba+BR-1)%BR];var BZ=BS[(Ba+1)%BR];var BU=0;var Be={X:0,Y:0};var Bd={X:BS[BW].X-BS[(BW+BR-1)%BR].X,Y:BS[BW].Y-BS[(BW+BR-1)%BR].Y};for(var BX=(Ba+2)%BR;BX!=Ba;BX=(BX+1)%BR){var BY=BX-1;if(BY<0){BY+=BR;}var Bh={X:BS[BY].X-BS[Ba].X,Y:BS[BY].Y-BS[Ba].Y};var Bg={X:BS[BX].X-BS[Ba].X,Y:BS[BX].Y-BS[Ba].Y};if(S(Bd,Bh)<0.01&&S(Bd,Bg)>0.01){var BQ=b(Bc,BS[Ba],BS[BY],BS[BX],Be,false);Be=BQ.interSection;BU=BX;break;}}var BP=0;var BV={X:0,Y:0};var BT={X:BS[BW].X-BS[(BW+1)%BR].X,Y:BS[BW].Y-BS[(BW+1)%BR].Y};for(var BX=(Ba+BR-2)%BR;BX!=Ba;BX=(BX-1+BR)%BR){var BY=BX+1;if(BY>=BR){BY-=BR;}var Bh={X:BS[BY].X-BS[Ba].X,Y:BS[BY].Y-BS[Ba].Y};var Bg={X:BS[BX].X-BS[Ba].X,Y:BS[BX].Y-BS[Ba].Y};if(S(BT,Bh)>-0.01&&S(BT,Bg)<-0.01){var BQ=b(BZ,BS[Ba],BS[BY],BS[BX],BV,false);BV=BQ.interSection;BP=BX;break;}}Bb.push(BS[Ba]);Bb.push(Be);for(m=BU;;m=(m+1)%BR){Bb.push(BS[m]);if(m==BP){break;}}Bb.push(BV);return Bb;}function j(Ba,BX){var BY=Ba.length;if(BY==3){var BQ=BO(Ba,BX);return BQ;}else{var Bh=Ba[BY-1];var BP={X:Ba[1].X-Ba[0].X,Y:Ba[1].Y-Ba[0].Y};var Bb={X:-BP.X,Y:-BP.Y};var BS={X:Bh.X-Ba[0].X,Y:Bh.Y-Ba[0].Y};var Bi={X:-BS.X,Y:-BS.Y};var BU=false;var BZ=10000000000;for(var Bg=2;Bg<BY;++Bg){var Be=Bg-1;var Bf={X:Ba[Bg].X-Ba[Be].X,Y:Ba[Bg].Y-Ba[Be].Y};if(S(Bb,Bf)<-0.01){var BR={X:0,Y:0};var BV=b(Ba[0],Ba[1],Ba[Be],Ba[Bg],BR,false);BR=BV.interSection;if(BV.val>0){var BW={X:BR.X-Ba[0].X,Y:BR.Y-Ba[0].Y};if(AO(BP,BW)>0.01){var BT={X:BR.X+Bf.X,Y:BR.Y+Bf.Y};var Bc={X:0,Y:0};var Bd;var BQ=T(Bh,Ba[0],BR,BT,Bc,Bd);Bc=BQ.point;Bd=BQ.val;if(BQ.mark){BU=true;if((Bd<BZ)&&Ar(Bc,Ba[Be-1],Ba[Be],Ba[Bg],Ba[(Bg+1)%BY])){BZ=Bd;}}}}}else{if(S(Bi,Bf)<-0.01){var BR={X:0,Y:0};var BV=b(Ba[0],Bh,Ba[Be],Ba[Bg],BR,false);BR=BV.interSection;if(BV.val>0){var BW={X:BR.X-Ba[0].X,Y:BR.Y-Ba[0].Y};if(AO(BS,BW)>0.01){var BT={X:BR.x-Bf.x,Y:BR.y-Bf.y};var Bc={X:0,Y:0};var Bd;var BQ=T(BT,BR,Ba[0],Ba[1],Bc,Bd);Bc=BQ.point;Bd=BQ.val;if(BQ.mark){BU=true;if((Bd<BZ)&&Ar(Bc,Ba[Be-1],Ba[Be],Ba[Bg],Ba[(Bg+1)%BY])){BZ=Bd;}}}}}}}return{mark:BU,depth:BZ};}}function Aw(BP){return BP.X*BP.X+BP.Y*BP.Y;}function Ax(Bb,BZ,BY,BT){var BU={X:Bb.X-BZ.X,Y:Bb.Y-BZ.Y};var BS={X:BY.X-BZ.X,Y:BY.Y-BZ.Y};var BR=Math.sqrt(Aw(BU));var BQ=Math.sqrt(Aw(BS));var BX={X:BU.X/BR,Y:BU.Y/BR};var BW={X:BS.X/BQ,Y:BS.Y/BQ};var Ba=0;if(Math.abs(BX.X-BW.X)<0.01){Ba=BT*(BW.X+BX.X)/(BX.Y-BW.Y);}else{Ba=BT*(BW.Y+BX.Y)/(BW.X-BX.X);}var BV={X:0,Y:0};var BP={X:0,Y:0};BV.X=BZ.X+Ba*BW.X;BV.Y=BZ.Y+Ba*BW.Y;BP.X=BV.X+BT*(-BW.Y);BP.Y=BV.Y+BT*BW.X;return{start:BP,end:BV};}function Ao(BQ,BP){var BR=AO(BQ,BP)/(Math.sqrt(Aw(BQ)*Aw(BP)));BR=(BR>1)?1:BR;BR=(BR<-1)?-1:BR;return Math.acos(BR);}function Ar(BV,Bd,Bc,Ba,BZ){var BX={X:Bd.X-Bc.X,Y:Bd.Y-Bc.Y};var BU={X:Ba.X-Bc.X,Y:Ba.Y-Bc.Y};var Bb=w(Ao(BX,BU));if(S(BU,BX)<-0.01){Bb=360-Bb;}var BR={X:BV.X-Bc.X,Y:BV.Y-Bc.Y};var BW=w(Ao(BR,BU));if(S(BU,BR)<-0.01){BW=360-BW;}if(2*BW>Bb){return false;}var BQ={X:-BU.X,Y:-BU.Y};var BP={X:BZ.X-Ba.X,Y:BZ.Y-Ba.Y};var BY=w(Ao(BQ,BP));if(S(BP,BQ)<-0.01){BY=360-BY;}var BT={X:BV.X-Ba.X,Y:BV.Y-Ba.Y};var BS=w(Ao(BQ,BT));if(S(BT,BQ)<-0.01){BS=360-BS;}if(2*BS>BY){return false;}return true;}function AT(BP){return Math.sqrt(Aw(BP));}function T(Bd,Bc,Ba,BY,BT,Bg){var Bo;var Bf;var Bm={X:Bc.X-Bd.X,Y:Bc.Y-Bd.Y};var Bi={X:BY.X-Ba.X,Y:BY.Y-Ba.Y};var BW={X:Ba.X-Bc.X,Y:Ba.Y-Bc.Y};var Bl=Math.sqrt(Aw(BW));var Bj=S(Bm,Bi);if(Bj>0.01||Bj<-0.01){var BX={X:0,Y:0};var BZ=b(Bd,Bc,Ba,BY,BX,false);BX=BZ.interSection;var Bk=q(Bc,BX);var BQ=q(Ba,BX);if(Bj<-0.01){var BS=Bl+Bk+BQ;BT.X=(BQ*Bc.X+Bk*Ba.X+Bl*BX.X)/BS;BT.Y=(BQ*Bc.Y+Bk*Ba.Y+Bl*BX.Y)/BS;Bo=x(Bc,Ba,BX)/BS;Bf=true;}else{var BS=Bk+BQ-Bl;if(BS<0.01){var Bh=0;if(Math.abs(S(Bm,BW))<0.01){var Bn={X:-BW.X/Bl,Y:-BW.Y/Bl};var BR=Math.sqrt(Aw(Bi));var BU={X:Bi.X/BR,Y:Bi.Y/BR};Bh=(Bn.Y-BU.Y)*Bl/(Bn.X+BU.X);BT.X=Bc.X+Bh*Bn.Y;BT.Y=Bc.Y+Bh*(-Bn.X);}else{var Bb={X:BW.X/Bl,Y:BW.Y/Bl};var Be=AT(Bm);var BV={X:-Bm.X/Be,Y:-Bm.Y/Be};Bh=(BV.Y-Bb.Y)*Bl/(BV.X+Bb.X);BT.X=Ba.X+Bh*(-Bb.Y);BT.Y=Ba.Y+Bh*Bb.X;}Bo=Bh;Bf=true;return{val:Bo,mark:Bf,point:BT};}BT.X=(BQ*Bc.X+Bk*Ba.X-Bl*BX.X)/BS;BT.Y=(BQ*Bc.Y+Bk*Ba.Y-Bl*BX.Y)/BS;Bo=x(Bc,BX,Ba)/BS;Bf=true;}}else{if(Math.abs(S(Bm,BW))<0.01){Bf=false;return{val:Bo,mark:Bf,point:BT};}var Be=Math.sqrt(Aw(Bm));var BP={X:-Bm.X/Be,Y:-Bm.Y/Be};BT.X=(Bc.X+Ba.X+Bl*BP.X)/2;BT.Y=(Bc.Y+Ba.Y+Bl*BP.Y)/2;Bo=S(BW,BP)/2;Bf=true;}return{val:Bo,mark:Bf,point:BT};}function BO(Bd,Ba){var Bm=false;var BQ=Bd.length;if(BQ==3){var BY=q(Bd[0],Bd[1]);var BX=q(Bd[1],Bd[2]);var BW=q(Bd[2],Bd[0]);var BP=BY+BX+BW;Ba=x(Bd[0],Bd[1],Bd[2])/BP;Bm=true;}else{var BV=false;var Bc=10000000000;for(var Bi=0;Bi<BQ;++Bi){var Bj=Bd[Bi];var Bk=Bd[(Bi+BQ-1)%BQ];var Bh=Bd[(Bi+1)%BQ];var Bg=Bd[(Bi+2)%BQ];var BT={X:Bk.X-Bj.X,Y:Bk.Y-Bj.Y};var BR={X:Bh.X-Bj.X,Y:Bh.Y-Bj.Y};var Be={X:-BR.X,Y:-BR.Y};var Bb={X:Bg.X-Bh.X,Y:Bg.Y-Bh.Y};var BZ=S(BT,BR);if(BZ<0.01){if(S(Be,Bb)<0.01){var BU={X:0,Y:0};var Bf=0;var BS=T(Bk,Bj,Bh,Bg,BU,Bf);BU=BS.point;Bf=BS.val;if(BS.mark){BV=true;Bc=(Bc>Bf)?Bf:Bc;}}}else{if(BZ>0.01){var Bl=[];Bl=P(Bd,Bi,Bl);var BS=j(Bl,Bf);var Bf=BS.depth;if(BS.mark){BV=true;Bc=(Bc>Bf)?Bf:Bc;}}}}Ba=Bc;Bm=BV;}return{mark:Bm,depth:Ba};}function AZ(BQ,BP){return(Math.abs(BQ.X-BP.X)<0.01&&Math.abs(BQ.Y-BP.Y)<0.01);}function AI(BQ){var BR=[];BR.push(BQ[0]);pcount=BQ.length;for(var BP=1;BP<pcount;BP++){if(BQ[BP-1].X==BQ[BP].X&&BQ[BP-1].Y==BQ[BP].Y){continue;}BR.push(BQ[BP]);}var BS=new Array();pcount=BR.length;for(var BP=0;BP<pcount;BP++){if(BP===pcount-1){if(BR[BP].X==BR[0].X&&BR[BP].Y==BR[0].Y){continue;}}BS.push(BR[BP]);}return BS;}function Ab(BQ,BP,BT,BS){var BR=0.01;if(BS===false){BR=-0.01;}if(Math.abs(BP.X-BT.X)<0.01){if(BQ.Y-BP.Y>BR&&BT.Y-BQ.Y>BR){return true;}if(BQ.Y-BT.Y>BR&&BP.Y-BQ.Y>BR){return true;}}else{if(BQ.X-BP.X>BR&&BT.X-BQ.X>BR){return true;}if(BQ.X-BT.X>BR&&BP.X-BQ.X>BR){return true;}}return false;}function b(BZ,BY,BW,BV,BU,BQ){var BR={X:BY.X-BZ.X,Y:BY.Y-BZ.Y};var BS={X:BV.X-BW.X,Y:BV.Y-BW.Y};if(Math.abs(S(BR,BS))<0.01){var BP={X:BW.X-BZ.X,Y:BW.Y-BZ.Y};if(Math.abs(S(BR,BP))<0.01){return{val:-1,interSection:BU};}else{return{val:0,interSection:BU};}}else{var BT={X:BZ.X-BW.X,Y:BZ.Y-BW.Y};var BX=S(BS,BT)/S(BR,BS);BU.X=BZ.X+BX*BR.X;BU.Y=BZ.Y+BX*BR.Y;if(Ab(BU,BZ,BY,BQ)&&Ab(BU,BW,BV,BQ)){return{val:1,interSection:BU};}else{return{val:2,interSection:BU};}}}function AE(BY,BR,BT){var BQ=BR;while(BQ<0){BQ+=360;}while(BQ>=360){BQ-=360;}var Bb=BY.X+BY.Width-BT.x;var BW=BT.y-BY.Y;var Bd=BT.x-BY.X;var BU=BY.Y+BY.Height-BT.y;var BZ=AC(BQ);var BS={x:Math.cos(BZ),y:-Math.sin(BZ)};var BV;var BP;if(BQ>=0&&BQ<90){var Be={x:Bb,y:-BW};var Ba={x:-Bd,y:BU};BV=O(Be,BS);BP=O(Ba,BS);}else{if(BQ>=90&&BQ<180){var Bf={x:-Bd,y:-BW};var Bc={x:Bb,y:BU};BV=O(Bf,BS);BP=O(Bc,BS);}else{if(BQ>=180&&BQ<270){var Be={x:Bb,y:-BW};var Ba={x:-Bd,y:BU};BV=O(Ba,BS);BP=O(Be,BS);}else{var Bf={x:-Bd,y:-BW};var Bc={x:Bb,y:BU};BV=O(Bc,BS);BP=O(Bf,BS);}}}a.x=BT.x+BV*BS.x;a.y=BT.y+BV*BS.y;f.x=BT.x+BP*BS.x;f.y=BT.y+BP*BS.y;var BX=-BP/(BV-BP);if(BX<0){BX=0;}else{if(BX>1){BX=1;}}return BX;}function AC(BP){return BP*Ai/180;}function w(BP){return BP*180/Ai;}function O(BQ,BP){return(BQ.x*BP.x+BQ.y*BP.y);}function AO(BQ,BP){return(BQ.X*BP.X+BQ.Y*BP.Y);}function S(BQ,BP){return(BQ.X*BP.Y-BQ.Y*BP.X);}function Az(BR,Bd,Bb,Be){var Bc=Bd.Gradient;var BY="RGBA("+Math.round(Be*Bc.StartGraphColor.R)+", "+Math.round(Be*Bc.StartGraphColor.G)+", "+Math.round(Be*Bc.StartGraphColor.B)+", "+Bd.Alpha/255+");";var BW="RGBA("+Math.round(Be*Bc.EndGraphColor.R)+", "+Math.round(Be*Bc.EndGraphColor.G)+", "+Math.round(Be*Bc.EndGraphColor.B)+", "+Bc.EndAlpha/255+");";var BX;switch(Bc.GradientType){case Z:var BV=Bc.HorizontalOffset;if((Bc.Angle>90&&Bc.Angle<180)||Bc.Angle>270){BV=100-BV;}var Ba={x:Bb.X+Bb.Width*BV/100,y:Bb.Y+Bb.Height*Bc.VerticalOffset/100};f={x:0,y:0};a={x:0,y:0};var BZ=AE(Bb,Bc.Angle,Ba);BX=BR.createLinearGradient(f.x,f.y,a.x,a.y);BX.addColorStop(0,BW);BX.addColorStop(BZ,BY);BX.addColorStop(1,BW);BR.fillStyle=BX;BR.fill();break;case I:var Ba={x:Bb.X+Bb.Width*Bc.HorizontalOffset/100,y:Bb.Y+Bb.Height*Bc.VerticalOffset/100};var BU=Bb.Width*1/Bb.Height;Ba.y*=BU;BX=BR.createRadialGradient(Ba.x,Ba.y,0,Ba.x,Ba.y,Bb.Width*2);BX.addColorStop(0,BY);BX.addColorStop(0.5,BW);BX.addColorStop(1,BW);BR.fillStyle=BX;BR.save();BR.scale(1,1/BU);BR.fill();BR.restore();break;case AL:var Ba={x:Bb.X+Bb.Width*Bc.HorizontalOffset/100,y:Bb.Y+Bb.Height*Bc.VerticalOffset/100};var BT=Bc.Angle%90;var BQ=w(Math.atan(Bb.Height/Bb.Width));var BP=2*BT-BQ*BT/45+90+BQ;f={x:0,y:0};a={x:0,y:0};var BZ=AE(Bb,BP,Ba);var BS=BR.createLinearGradient(f.x,f.y,a.x,a.y);BY="RGBA("+Math.round(Be*Bc.StartGraphColor.R)+", "+Math.round(Be*Bc.StartGraphColor.G)+", "+Math.round(Be*Bc.StartGraphColor.B)+", "+Bd.Alpha/(255*2-Bd.Alpha)+");";BW="RGBA("+Math.round(Be*Bc.EndGraphColor.R)+", "+Math.round(Be*Bc.EndGraphColor.G)+", "+Math.round(Be*Bc.EndGraphColor.B)+", "+Bc.EndAlpha/(255*2-Bc.EndAlpha)+");";BS.addColorStop(0,BW);BS.addColorStop(BZ,BY);BS.addColorStop(1,BW);BR.fillStyle=BS;BR.fill();BP=BQ*BT/45+90-BQ;BZ=AE(Bb,BP,Ba);BX=BR.createLinearGradient(f.x,f.y,a.x,a.y);BY="RGBA("+Math.round(Be*Bc.StartGraphColor.R)+", "+Math.round(Be*Bc.StartGraphColor.G)+", "+Math.round(Be*Bc.StartGraphColor.B)+", "+Bd.Alpha/(255*2)+");";BW="RGBA("+Math.round(Be*Bc.EndGraphColor.R)+", "+Math.round(Be*Bc.EndGraphColor.G)+", "+Math.round(Be*Bc.EndGraphColor.B)+", "+Bc.EndAlpha/(255*2)+");";BX.addColorStop(0,BW);BX.addColorStop(BZ,BY);BX.addColorStop(1,BW);BR.fillStyle=BX;BR.fill();break;}}function Aq(BP,BR){var BQ=BR.Alpha/255;BP.fillStyle="rgba(255,255,255,"+BR.Alpha/255+")";BP.fill();}function AM(BQ){var BP=BQ.canvas;BQ.clearRect(0,0,BP.width,BP.height);}function An(BP){Av=(new Date()).getTime();L(BP);}function L(BY){var BX=BY.graphData,BZ=BX.UnitList,Ba=BZ.length,BS=BX.FormatList,Bd=BY.graphNode,BV=BY.highlightNode,BT=BV.getContext("2d"),Bc=BY.selectionNode,BU=Bc.getContext("2d"),BR=Bd.getContext("2d");AM(BR);AM(BT);AM(BU);var Be=Math.min(((new Date()).getTime()-Av)/AG,1),Bb=(1-Be),BW;var BP=0.3*Be*Bb*Bb+2.7*Bb*Be*Be+Be*Be*Be;var BQ=0;for(BW=0;BW<Ba;BW++){At(BR,BP,BZ[BW],BS);if(BZ[BW].IsAnimated!==0){BQ=1;}}if(Be<1&&BQ===1){setTimeout(function(){L(BY);},20);}}mstrmojo.graph._CanvasGraph=mstrmojo.provide("mstrmojo.graph._CanvasGraph",{markupString:'<div class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><canvas id="{@id}" height="{@height}" width="{@width}">{@unsupportedError}</canvas>{@map}<canvas id="{@id}-highlight" class="mobile-graph-selection-canvas" height="{@height}" width="{@width}" style="position:absolute;top:0;left:0"></canvas><canvas id="{@id}-highlight" class="'+mstrmojo.GraphBase.canvasCLS+'" height="{@height}" width="{@width}" style="position:relative;top:0;left:0"></canvas></div>',unsupportedError:"This text is displayed if your browser does not support HTML5 Canvas element.",markupSlots:{graphNode:function(){return this.domNode.childNodes[1];},imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return null;},textNode:function(){return this.domNode.firstChild;},selectionNode:function(){return this.domNode.lastChild.previousSibling;},highlightNode:function(){return this.domNode.lastChild;}},graphData:null,retrieveGraphSrc:function BH(BS,BW){var BU=this.graphNode,BX=this.highlightNode,BT=this.selectionNode,BV=this.graphData,BR=(BV&&BV.data);if(BR&&BR.eg){var BY=this.textNode,BQ=this.imgNode;BQ.style.display="none";BX.style.display="none";BT.style.display="none";BY.innerHTML=BR.eg||"";BY.style.display="block";BY.className="mstrmojo-message";}else{var BZ=BV.GH||parseInt(BS,10),BP=BV.GW||parseInt(BW,10);BU.setAttribute("height",BZ);BU.setAttribute("width",BP);BX.style.display="block";BX.setAttribute("height",BZ);BX.setAttribute("width",BP);BX.style.top=-BZ+"px";BT.style.display="block";BT.setAttribute("height",BZ);BT.setAttribute("width",BP);this.displayTooltips([],0,0);An(this);if(BV.Selected){this.highlightAreaInInit(BT,BV.Selected);}}},unrender:function AU(BP){this._super(false);},invalidate:function K(){var BP=this.graphNode;if(BP){AM(BP.getContext("2d"));}},getCaptureDimensions:function Ae(){var BQ=this.graphNode,BP=mstrmojo.dom.position(this.domNode,true);BP.w=BQ.width;BP.h=BQ.height;return BP;}});}());(function(){mstrmojo.requiresCls("mstrmojo.GraphBase","mstrmojo._TouchGestures","mstrmojo.graph._MobileGraphAreaHelper");mstrmojo.MobileGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._TouchGestures,mstrmojo.graph._MobileGraphAreaHelper],{scriptClass:"mstrmojo.MobileGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" {@extra}/>',cssImageClass:"mstrmojo-ReportGraph",setDimensions:function I(M,L){if(this.height===M&&this.width===L){return ;}this.height=M;this.width=L;if(this.hasRendered){this.controller.refresh(this);}},preBuildRendering:function J(){var L=this.graphData.gd.g;this.as=L&&L.as;return this._super?this._super():true;},refresh:function F(){this.graphData=this.model.data;this._super();},retrieveGraphSrc:function E(M,L){var O="data:image/png;base64,"+this.graphData.ib.eb,N=this.imgNode;if(N.src!==O){N.src=O;}},getFormats:function G(){return{height:this.height,width:this.width,top:0,left:0};},touchTap:function B(){this.displayTooltips([],0,0);var L=this.controller;if(L&&L.viewTap){L.viewTap();}},touchSelectBegin:function D(L){this.syncTooltips(L.pageX,L.pageY);},touchSelectMove:function H(L){this.syncTooltips(L.pageX,L.pageY);},setModel:function K(L){this._super(L);this.setGraphData(L.data);},syncTooltips:function C(L,O){var M=this,N=mstrmojo.dom.position(M.domNode,true);L-=N.x;O-=N.y;M.model.getDataService().handleUserSingleTap(-1,"",L,O,false,{success:function(P){M.displayTooltips(P.Areas,N.x,N.y);}});},setGraphData:function A(L){this.graphData=L;this.controller.getPageByTree(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.GraphBase","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo.tooltip");var F=mstrmojo.dom;function M(P){var Q=P.getFormats();if(!Q.width&&"gp" in Q){Q=Q.gp;}P.resizeForDisplayState(parseInt(Q.height,10),parseInt(Q.width,10),false);}function A(Q){var P=F.position(this.domNode),R=F.getMousePosition(Q);return{x:parseInt(R.x-P.x,10),y:parseInt(R.y-P.y,10)};}function O(V,U){var R=F.eventTarget(U,V),T=R&&R.parentNode,W=T&&T.children,P=[],S=R.getAttribute("coords");if(W&&!!S){for(var Q=0;Q<W.length;++Q){if(W[Q]&&W[Q].getAttribute&&W[Q].getAttribute("coords")==S){P.push(W[Q]);}}}return P;}mstrmojo.DocXtabGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocXtabGraph",cssClassPrefix:"mstrmojo-DocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" onclick="mstrmojo.all[\'{@id}\'].onClickArea(this, event);" onmousemove="mstrmojo.all[\'{@id}\']._updateTooltip(event, self);" {@extra}/>',_att:"",markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","background-color","fx"]},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},onClickArea:function B(R,T){T=T||window.event;var Y=A.apply(this,[T]),U=this.defn,P=F.position(this.domNode),Q=this.as[R.getAttribute("aid")],X=this.k,W=Y.x,V=Y.y,S={getBoundingClientRect:function(){var a=P.x+W,Z=P.y+V;return{left:a,top:Z,right:a+1,bottom:Z+1};},w:this};this.showInfoWin(Q.tks,S);this.model.slice({type:parseInt(U.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:X,ck:U.ck,gk:X,tks:Q.tks,cks:Q.cks,sid:this.node.data.sid,x:W,y:V,anchor:S,tty:Q.tty});},showInfoWin:function G(T,Q){var P=this.model,S=T&&P.getTargetInfoWin(T);if(S&&S.length){for(var R=0;R<S.length;R++){P.showInfoWin(S[R],Q,"h");}}},showTooltip:function N(R,Q){this._updateTooltip(R,Q);var P=O(R,Q);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.open(this,R,Q,P);}else{this._super(R,Q);}},_updateTooltip:function L(P,Q){this.updatingTooltipHelper(F.eventTarget(Q,P),A.apply(this,[P]));},hideTooltip:function J(S,R){var Q=F.eventTarget(R,S);if(Q.getAttribute("aid")===this.cAreaIdx){this.cAreaIdx=-1;var P=O(S,R);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.close(this,S,R,P);}else{this._super(S,R);}}},update:function D(P){this.node.data=P.data;this.as=P.data.as;var b="\u001E",R=this.model,X=R.getCGBMap&&R.getCGBMap(),Q=this.as||[],V,T;for(V=0;V<Q.length;V++){var Y=Q[V],U=Y&&Y.tgbs;if(U){var W=U.split(b);var Z={};for(T=0;T<W.length;T++){var S=X&&X[W[T]];if(S){Z[S]=true;}else{Z[W[T]]=true;}}Y.tks=mstrmojo.hash.keyarray(Z).join(b);}}this.eg=P.data.eg;},retrieveGraphSrc:function I(Q,P){var S=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(P,10)+"&height="+parseInt(Q,10)+"&sessionState="+mstrApp.sessionState,R=this.imgNode;if(R.src!==S){R.src=S;}},resize:function(){M(this);},resizeForDisplayState:function E(R,Q,U){var T=this.getFormats(),S=this.imgNode;if(U){var P=this.domNode.style;P.top=T.top;P.left=T.left;P.height=T.height;P.width=T.width;}if(S){S.style.height=R+"px";}if(!this.eg){this.retrieveGraphSrc(R,Q);if(R){this.refreshMap();}}}});function H(P){if(P&&P.getAttribute){var Q=P.getAttribute("coords");Q=Q&&Q.split(",");if(Q&&Q.length>=3){return Q[2]-Q[0];}}return 0;}function C(R){var Q=[],V=document.body.offsetWidth,P=document.body.offsetHeight,W=0,T=0,Y=K[0]&&K[0].domNode?K[0].domNode.offsetLeft:0,X=K[0]&&K[0].domNode?K[0].domNode.offsetTop:0,b=Math.ceil(K.length/2),S=5,a=function(f,d){if(f+R+d+S>V){return V-R-d-S;}else{if(K.length>1&&f-d-S<0){return d+S;}}return f;},Z=function(h,f,d){h+=f;var g=d==1?f:(d*f+(d-1)*S)/2;if(g>h){return 0;}else{if(g+h>P){return P-g*2;}else{return h-g;}}};for(var U=0;U<K.length;++U){W=Math.max(W,K[U].containerNode.offsetWidth);T=Math.max(T,K[U].containerNode.offsetHeight);}Y=a(Y,W);X=Z(X,T,b);for(var U=0;U<K.length;++U){if(U%2==0){Q.push({l:Y+R+S,t:X});}else{Q.push({l:Y-K[U].containerNode.offsetWidth-S,t:X});X+=T+S;}}return Q;}var K=[];mstrmojo.DocXtabGraph.multiTooltip={_posMultiTp:function(Q){for(var P=0;P<K.length;++P){K[P].domNode.style.left=Q[P].l+"px";K[P].domNode.style.top=Q[P].t+"px";}},open:function(Y,V,U,Q,P){if(!P){P={};}P.e=V;P.win=U;var S=0;if(Q&&Q.length){S=H(Q[0]);}for(var R=0;R<Q.length;++R){var X=K[R];if(!X||!mstrmojo.all[X.id]){X=new mstrmojo.Tooltip();var T=0,W=this;X.optimizePos=function(){T++;if(T>=K.length){T=0;W._posMultiTp(C(S));}};K.push(X);}Y.richTooltip.content=Q[R]&&Q[R].getAttribute("ttl");X.open(Y,P);}},close:function(){for(var P=K.length-1;P>=0;--P){K[P].close();}K=[];}};}());(function(){mstrmojo.requiresCls("mstrmojo.SliderBox","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.ui.MobileSlider","mstrmojo.num");var C=1,B=mstrmojo.num;mstrmojo.android.inputControls.SliderDIC=mstrmojo.declare(mstrmojo.SliderBox,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.SliderDIC",popupStyle:1,init:function F(H){var G,I,J,K;this._super(H);this.items=this.getItems();this.cssClass=this.showByDefault?"mstrmojo-SliderGroup":"mstrmojo-PopupSlider";if(this.dic.ipt!==C){this.isSequential=true;I=this.max=this.dic.max;G=this.min=this.dic.min;J=this.interval=this.dic.itv;}else{G=1;I=this.items.length;J=1;}K=this.sliderBar;if(K){K.min=G;K.max=I;K.interval=J;}},preBuildRendering:function E(){var I=this.dic,G=(I.ldw!=null)?I.ldw/100:0.4,H;this.valueText=this.dv;this._super();if(this.showByDefault){H=this.openerStyle;this.valueCssText="left:-"+H.iw*G+"px;width:"+H.iw*G+"px";this.cssText="width:"+H.iw*(1-G)+"px";this.alignSlider(this.openerNode,H.ih);}},onpopupResized:function D(){var G=this.sliderBar;if(G){G.refresh();}},sliderRef:{scriptClass:"mstrmojo.ui.MobileSlider",onslidingValueChange:function(){if(this.hasRendered){this.selectedIdx=parseInt((this.slidingValue-this.min)/this.interval,10)||0;this.parent.selectedIdxChanged(this.selectedIdx);}},selectedIdx:0,select:function(G){this.selectedIdx=G||0;this.slidingValue=this.value=this.min+G*this.interval;}},selectedIdxChanged:function A(H){var I=this.items[H],G=I&&I.n;this.set("value",B.toLocaleString(G));this.set("valueText",B.toLocaleString(G));}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileDocLayoutViewer");var B=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.maps.MobileMapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MobileMapInfoWindowLayoutViewer",preBuildRendering:function A(){this.setDimensions(this.height,this.width);this.set("visible",true);return this._super?this._super():true;}});mstrmojo.maps.MapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MapInfoWindowLayoutViewer",preBuildRendering:function A(){this.set("visible",true);return this._super?this._super():true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList");mstrmojo._IsTableLayoutListDIC=mstrmojo.provide("mstrmojo._IsTableLayoutListDIC",{_mixinName:"mstrmojo._IsTableLayoutListDIC",icnCss:"dicContainer",tableLayoutCssStyle:"fixed",setDirtyFlag:function(D,C){if(D.className!=="flag-container"){var B=document.createElement("div"),A=this.itemsNode&&this.itemsNode.clientWidth-8;B.className="flag-container";B.style.left=(A>0?A:0)+"px";B.innerHTML='<div class="dirty-cell"/>';C.insertBefore(B,D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo._IsAnchorable");var A=mstrmojo.dom,C=mstrmojo.array;mstrmojo.android.Popup=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.android.Popup",fadeOnClose:false,autoClose:true,init:function E(J){this._super(J);if(this.anchor){mstrmojo.css.addWidgetCssClass(this,"anchor");}},addChildren:function I(L,J,K){this._super(L,J,K);C.forEach(this.children,function(M){if(M.isElastic){this._elasticChild=M;return false;}},this);},resizeDialog:function D(){var Q=this.editorNode,M=mstrApp,J=M.getScreenDimensions(),P=Math.round(J.h*0.9),T=J.w,R;T=T*0.85;if(M.isTablet()){var N=this.popDimensions||{},S=mstrApp.getScreenDimensions();P=N.h||Math.min(Math.round(S.h*0.6),P);T=N.w||Math.min(Math.round(S.w*(mstrApp.isLandscape()?0.43:0.65)),T);}T+="px";var K=this._elasticChild;if(K){var L=K.elasticHeight;if(L){R=L;}else{if(K.getItemsContainerHeight){R=K.getItemsContainerHeight();}}}if(R===undefined){R=this.getAvailableContentSpace();P=Math.max(P,R+(this.titleNode.offsetHeight+this.buttonNode.offsetHeight));}else{R=Math.min(R,P-(this.titleNode.offsetHeight+this.buttonNode.offsetHeight));}if(Q){Q.style.maxHeight=P+"px";this.set("width",T);}else{this.width=T;this.cssText=(this.cssText||"")+"max-height:"+P+"px;";}this.raiseEvent({name:"popupResized",maxheight:P,height:R,width:parseInt(T,10)});if(K){var O=K.height;if(O!==undefined&&O!=="auto"){K.set("height","auto");}K.set("height",R+"px");if(K.updateScroller){K.updateScroller();}}this._super();},getAvailableContentSpace:function B(){return Math.max(this.containerNode.offsetHeight,this.editorNode.clientHeight-this.titleNode.offsetHeight-this.buttonNode.offsetHeight);},close:function F(){if(this.onClose){this.onClose();}if(this.fadeOnClose){var J=this.domNode;if(J){var K=this.id;if(!A.isWinPhone){A.attachOneTimeEvent(J,A.CSS3_TRANSITION_END,function(){mstrmojo.all[K].destroy();});J.style.opacity=0;}else{(new mstrmojo.fx.FadeOut({onEnd:function(){mstrmojo.all[K].destroy();},target:J,duration:400})).play();}}}else{this.destroy();}},onclick:function G(J){if(this.autoClose&&J.e.target===this.curtainNode){this.close();}},ontouchend:function H(J){this.onclick(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo._IsAnchorable");var A=mstrmojo.dom,B=mstrmojo.array;mstrmojo.VisHeatMapPopupPanel=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VisHeatMapPopupPanel",title:"",markupString:'<div id="{@id}" class="heatmap-popup-panel" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},initialized:false,naviAction:null});mstrmojo.VisHeatMapAnimation=(function(){var C=[];return{animate:function(H,L,J,P,I,Q){var G;var M=C.length;for(var K=0,O=C.length;K<O;K++){if(!C[K]){M=K;continue;}if(C[K].node===H&&C[K].propName===L){(C[K].finalize(false));G=C[K];break;}}if(!G){G={};G.node=H;G.index=M;G.propName=L;C[M]=G;}var F=(new Date()).getTime();var I=I||500;var E=20;var D=null;G.finalize=function(R){clearInterval(D);D=null;if(P.r!==undefined){P.a=P.a||1;H.style[L]="";}else{if(P.px!==undefined){H.style[L]=P.px+"px";}}if(R){delete C[this.index];}if(Q){Q();}};function N(){var R={};var S=(new Date()).getTime();var U=S-F;if(U>=I){G.finalize(true);return ;}for(var T in J){R[T]=(P[T]-J[T])*U/I+J[T];if(T!=="a"){R[T]=Math.round(R[T]);}}if(R.r){R.a=R.a||1;H.style[L]="rgba("+R.r+","+R.g+","+R.b+","+R.a+")";}else{if(R.px){H.style[L]=R.px+"px";}}}D=setInterval(N,E);}};})();mstrmojo.VisHeatMapPopup=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VisHeatMapPopup",fadeOnClose:false,autoClose:true,markupString:'<div style="display: -webkit-box; -webkit-box-align: start; -webkit-box-pack: center;position:absolute; left:0px; top:0px; z-index:100000; width: 100%; height:100%;"  id={@id} mstrAttach:mouseup,touchend><div id={@id} style=" position:relative; left: 0px; top: 0px; width:{@width}; background-color:#F5F5F5;z-index:100001;border:2px solid rgba(0, 0, 0, 0.1);-webkit-box-shadow:rgba(0, 0, 0, 0.45) 2px 2px 8px;"><div  class="heatmap-popup-panel-title" style="display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: center;position:relative; -webkit-box-sizing: border-box; margin-bottom:6px; padding-right: 25%; height:65px; width:100%; line-height:65px;vertical-align:bottom;color:#33b5e5;"></div><div style="height: 2px;width:100%;background-color:#33b5e5"></div><div style="width:100%; height:auto; position:relative;overflow:hidden; display: -webkit-box; -webkit-box-orient: horizontal"></div></div><div style="position:absolute;z-index:100000;top:0px;left:0px;width:100%;height:100%;background: rgba(0, 0, 0, 0.5);"></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.lastChild;},curtainNode:function(){return this.domNode.lastChild;}},baseTipClass:"heatmap-editor-tip",anchorOffset:42,hasCloseButton:true,goBack:function(){return this.close();},close:function(){this.domNode.style.webkitTransform="translate(-100000px,0px)";this.destroy();return true;},destroy:function(){this.onClose();if(this._super){this._super();}},postBuildRendering:function(){this._super();for(var D=0,C=this.panels.length;D<C;D++){if(D!==0){var F=document.createElement("div");F.style.cssText="position:relative;width:1px;color:grey;height:35px;text-align:center;background-color:grey;";this.titleNode.appendChild(F);}var F=document.createElement("div");F.style.cssText="-webkit-box-flex:1; line-height:65px;text-align:center; display: -webkit-box; -webkit-box-align: center; -webkit-box-pack: center; height:100%;";if(D==0){F.style.cssText+="margin-left:16px;";}else{F.style.cssText+="margin-right:16px;";}F.setAttribute("panel",D);F.innerText=this.panels[D].title;this.titleNode.appendChild(F);}var E=this;document.body.appendChild(this.domNode);this.panelStack=0;this.navigateTo(0);this.contentNode.style.marginTop=parseInt((document.body.offsetHeight-this.contentMaxHeight-this.titleNode.offsetHeight)/2)+"px";},onmouseup:function(D){if(D.e.target===this.curtainNode){this.close();return ;}var E=mstrmojo.dom.findAncestorByAttr(D.e.target,"panel",true,this.domNode);if(!E){return ;}E.node.style.backgroundColor="rgba(51, 181, 229, 0.6)";var F=function(){mstrmojo.VisHeatMapAnimation.animate(E.node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};var C=this;setTimeout(function(){setTimeout(function(){C.navigateTo(E.value);F();},0);},0);},ontouchend:function(C){this.onmouseup(C);},highlightTitle:function(E){E=2*parseInt(E);if(isNaN(E)){return ;}var F=this.titleNode.childNodes,C=F.length;for(var D=0;D<C;D+=2){if(D!=E){F[D].style.borderBottom="";}else{F[D].style.borderBottom="solid 6px #33b5e5";}}},panelStack:0,navigateTo:function(I){this.highlightTitle(I);var E=this.panels[I];var J=this.panelStack;var C=this.panels[J];if(I!=J){if(C.hasRendered){C.domNode.style.display="none";}}if(!E.hasRendered){this.panels[I]=new mstrmojo.VisHeatMapPopupPanel(this.panels[I]);var E=this.panels[I];this.addChildren(E);this.renderChildren();}E.domNode.style.display="block";if(E.naviAction){E.naviAction();}if(J===I){delete E.domNode.style.webkitTransform;}else{var F=C.domNode.offsetWidth+"px";var H=E.domNode.offsetWidth+"px";var K=Math.max(parseInt(F),parseInt(H));delete E.domNode.style.webkitTransition;var G="";var D="";if(J<I){G="translate(-"+K+"px,0px)";D="translate(-"+K+"px,0px)";}else{G="translate("+K+"px,0px)";D="translate("+K+"px,0px)";}this.panelStack=I;}},animation:function(D,E,C){E.domNode.style.webkitTransform=C;D.domNode.style.webkitTransform=C;},dummy:true});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo._IsAnchorable","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller");var B=mstrmojo.dom;function A(){mstrApp.closeDialog();}mstrmojo.Magnifier=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsAnchorable,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.Magnifier",cssClass:"mstrmojo-magnifier anchor",markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}"><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-InfoViewer-Title"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-InfoViewer-Content"></div><div class="mstrmojo-InfoViewer-Buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',anchorOrientation:"h",anchorOffset:0,baseTipClass:"",screenDim:null,width:"auto",close:function G(){if(this.onClose){this.onClose();}B.detachEvent(window,"resize",A);this.destroy();},touchBegin:function H(I){this.helper.glowOnTap(I.target);},touchTap:function D(J){var I=J.target;if(I===this.curtainNode){mstrApp.closeDialog();}else{this.helper.handleTouchTap(I);}},touchSwipeEnd:function C(I){this.helper.handleTouchSwipe(I);this._super(I);},preBuildRendering:function E(){this._super();var K=this.screenDim=mstrApp.getScreenDimensions(),I=K.w,J=K.h;if(mstrApp.isTablet()){this.width="auto";}else{this.width=(I>J?(I*0.4):(I*0.6))+"px";}},postBuildRendering:function(){this._super();B.attachEvent(window,"resize",A);},updateContent:function(){var I=this.helper;I.createTitle(this.titleNode);I.createContent(this.containerNode);},resizeAndPosition:function(I){var K=this.helper.getContentHeight(),M=this.helper.titleHeight,L=this.screenDim,J=L.h-30,N;this.height=Math.min(K,J-M);this.containerNode.style.height=this.height+"px";this.updateScroller();if(I){this.moveTo(I);}else{N=B.position(this.editorNode);if(!(N.x>0&&N.x+N.w<L.w&&N.y>0&&N.y+N.h<L.h)){this.positionDialog();}}window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},moveTo:function(I){this.anchorPosition=I;this.positionDialog();},updateScrollerConfig:function F(){var J=this._super(),I=this.helper.currentTabIndex,L=this.containerNode.children[I];J.bounces=false;if(L){J.scrollEl=L;J.origin=J.origin||{x:0,y:0};J.noVScroll=J.noHScroll=true;var M=Math.max(this.helper.getContentHeight()-this.height,0);var K=J.vScroll=(M!==0);if(K){J.offset={y:{start:0,end:M}};}}return J;}});})();(function(){mstrmojo.requiresCls("mstrmojo.ServerProxy","mstrmojo.android.ui.Button","mstrmojo.Box","mstrmojo.TextBoxWithLabel","mstrmojo.Label","mstrmojo.hash","mstrmojo.mstr.EnumWebAPIErrorCodes");mstrmojo.requiresDescs(11,17,18,26,7904,5088,9935,10672);var D="mobileLogin",Z="changePassword",a=mstrmojo.android.ui.Button.newButton,N=mstrmojo.desc,W=mstrmojo.hash,j=mstrmojo.mstr.EnumWebAPIErrorCodes,C={},d={},A={ANDROID_PHONE:3,ANDROID_TAB:4},H={OLD_PASSWORD:0,NEW_PASSWORD:1,CONFIRM_NEW_PASSWORD:2},P={};function V(q){var p=this,k=q.pid,o=q.params.projectID,s=q.id,l=C[k],o=q.params.projectID,t={taskId:"getProjectSettings"};if(l){t.sessionState=l;}else{t.projectID=o;}mstrApp.serverRequest(t,{success:function(w){P[k]=true;p.transport.serverRequest(p.id,s,q);},failure:function(w){var x=q.callback;if(x.failure!==undefined){x.failure(w);}x.complete(s);}},{skipLogin:true,doNotHold:true});}function M(q){var o=String(mstrMobileApp.getLocaleInfo());if(o){var p=o.split(",");for(var l=0;l<p.length;l++){var k=p[l].split(":");q[k[0]]=k[1];}}return q;}function h(t,k){var q,o=[],p={id:"new_pwd_reqd",title:N(5088),cssClass:"mstrmojo-CredentialsDialog",loginInfo:t.loginInfo},l=t.loginInfo,s=function(w,x){return function(){x(w);};}(t,k);o.push({scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-PasswordDialog-Label",text:"You must supply a new password."});p.children=o;p.buttons=[a(N(221,"Cancel"),function(){q.manualClose=true;mstrApp.cancelPending();}),a(N(1442,"OK"),s,{enabled:true})];q=mstrApp.showDialog(p);}function f(w,k){var s,q,o=[],p={id:"password_prompt"+mstrmojo.now(),title:w.title,cssClass:"mstrmojo-CredentialsDialog",loginInfo:w.loginInfo},l=w.loginInfo,t=function(x,z){return function(){var AB=s.children,AA=AB[0].children[0];switch(x.dlgType){case H.OLD_PASSWORD:l.pwd=AA.value;break;case H.NEW_PASSWORD:l.npwd=AA.value;break;}z(x);};}(w,k);q=mstrmojo.getInstance(a(N(1442,"OK"),t,{enabled:w.enableOK}));o.push({scriptClass:"mstrmojo.Box",cssDisplay:"table",children:[{scriptClass:"mstrmojo.TextBoxWithLabel",label:N(18)+":",value:"",type:"password",cssDisplay:"table-row",onvalueChange:function(){if(w.dlgType==H.CONFIRM_NEW_PASSWORD){q.set("enabled",this.value==l.npwd);}}}]});p.children=o;p.buttons=[a(N(221,"Cancel"),function(){mstrApp.cancelPending();}),q];s=mstrApp.showDialog(p);}function L(p){var k=this._mobileCfg,l=p.pid,s=k.getProject(l),q={cfg:k,projectId:l,project:s,transport:this.transport,loginInfo:k.getLoginInfo(l)},o=this;mstrApp.hideMessage();q.loginInfo.uid=p.params.userid;h(q,function(t){f(W.copy({title:"Enter your old password",dlgType:H.OLD_PASSWORD,enableOK:true},t),function(w){f(W.copy({title:"Enter your new password",dlgType:H.NEW_PASSWORD,enableOK:true},w),function(x){f(W.copy({title:"Confirm your new password",dlgType:H.CONFIRM_NEW_PASSWORD,enableOK:(x.loginInfo.npwd=="")},x),function(AA){var z=function(AC){return function(AF){var AD=AC.loginInfo,AH=AD.npwd,AE=AD.uid;if(s.udc){var AG=k.getServerByProjectId(l);AG.pdc.ps=AH;AG.pdc.lo=AE;}else{s.pc.ps=AH;s.pc.lo=AE;}k.saveConfiguration();p.params.password=AH;R.call(o,p);};}(AA),AB=function(AC){var AD=p.callback;if(AD.failure!==undefined){AD.failure(AC);}AD.complete(p.id);};o.request({success:z,failure:AB},{taskId:Z,server:AA.project.sn,userid:AA.loginInfo.uid,oldPassword:AA.loginInfo.pwd,newPassword:AA.loginInfo.npwd},false,{projectId:l,mobileConfig:k,doNotHold:true});});});});});}function G(w,t,s){var p,x,l=mstrmojo.getInstance,k=function(AC,z,AB,AA){return l(W.copy(AA,{scriptClass:"mstrmojo.TextBoxWithLabel",cssDisplay:"table-row",label:N(AC)+":",value:w[z],type:AB||"text",onEnter:function(){if(x.enabled){x.onclick({e:{stopPropagation:mstrmojo.emptyFn}});}}}));},o=k(17,"uid",null,{onRender:function(){this.focus();},onvalueChange:function(){x.set("enabled",!!this.value.length);}}),q=k(18,"pwd","password");x=l(a(N(9935,"Log In"),function(){var z=w.uid=o.value;w.pwd=q.value;if(z.length){window.setTimeout(function(){s();},100);}},{enabled:false}));p=mstrApp.showDialog({id:"user_creds_prompt",title:(t?N(7904):N(11))+" "+N(26),cssClass:"mstrmojo-CredentialsDialog",loginInfo:w,children:[{scriptClass:"mstrmojo.Box",cssDisplay:"table",children:[o,q]}],buttons:[a(N(221,"Cancel"),function(){p.manualClose=true;mstrApp.cancelPending();}),x]});}function K(k){return((k.wsam>1)&&!k.wsuid);}function J(k){return(!k.uid&&k.am!=2);}function T(k,t){var l=k,q=false;var p=function(w){var x={uid:l.wsuid,pwd:l.wspwd},z=function(){l.wsuid=x.uid;l.wspwd=x.pwd;l.updateCfgAfterLogin|=1;w();};G.call(this,x,true,z);};var s=function(w){var x={uid:l.uid,pwd:l.pwd},z=function(){l.uid=x.uid;l.pwd=x.pwd;l.updateCfgAfterLogin|=2;w();};G.call(this,x,false,z);};if(K(l)&&J(l)){var o=this;p.call(this,function(){s.call(o,t);});}else{if(K(l)){p.call(this,t);}else{if(J(l)){s.call(this,t);}else{t();}}}}function b(q){var l=this._mobileCfg,o=q.pid,s=l.getProject(o),p=s.realPid,k=l.getLoginInfo(o);if(mstrApp.useBinaryFormat&&p&&k.uid){q.params.projectID=p;return true;}return false;}function g(q){var w=this,t=w._mobileCfg,s=q.pid,x=q.params.projectID,o=w.transport,k=w.id,z={success:function(AB){var AA=d[s]=mstrmojo.hash.obj2array(AB);mstrmojo.hash.copy(AA,mstrmojo.locales);if(mstrApp.useBinaryFormat){V.call(w,q);}else{P[s]=true;o.serverRequest(k,q.id,q);}},failure:function(AB){var AA=q.callback;if(AA.failure!==undefined){AA.failure(AB);}AA.complete(q.id);}},p={taskId:"getLocaleInfo"},l={projectId:s,mobileConfig:t,skipLogin:true,doNotHold:true};if(x){p.projectID=x;}w.request(z,p,false,l);}function R(q){var w=this,t=w._mobileCfg,s=q.pid,AA=t.getProject(s),p=w.transport,k=w.id,AB=t.getLoginInfo(s),o=false,l,z=function(AD){AA.posLoginFlag=false;var AF={success:function(AI){clearInterval(l);AA.es=AI.hasEmailScreenPriv;if(AB.updateCfgAfterLogin){t.updateLoginInfo(s,AB);}t.setRealPid(AA,AI.projectID);var AH=C[s]=AI.sessionState;mstrMobileApp.putSession(s,AH);q.params.sessionState=AH;if(AI.isCompatible===false){mstrApp.handleCompatibilityError(q);}g.call(w,q);},failure:function(AL){var AO=q.callback,AQ=b.call(w,q),AH=(AL.status==401),AP=(AL.code==j.AUTHEN_E_LOGIN_FAIL)||(AL.status==401),AK=mstrmojo.emptyFn,AN=t.getLoginInfo(s),AI=AH||AP||(K(AN)||J(AN));if((AO.failure!==undefined)&&!AH){AL.noErrorMessage=AQ||AI||AL.requireDeviceCertificate;AL.handledError=AI||AL.requireDeviceCertificate;AO.failure(AL);}if(!AI){AO.complete(q.id);}if(AQ&&!mstrMobileApp.isOnline()){g.call(w,q);}else{AL.method="login";if(AI){if(AP){t.clearLoginInfoForProject(s);}if(AH){var AJ=t.getServerByProjectId(s),AM;if(AJ.udc){AM=t.getDefaultServerCreds();}else{AM=AJ.wsc;}delete AM.lo;delete AM.ps;t.saveConfiguration();AL.message=N(10672,"The username or password you entered is incorrect.");}AL.handledError=false;AK=function(){o=true;};}mstrApp.onerror(AL,AK);}}},AG=A,AE=M({taskId:D,server:AA.sn,project:AA.pn,userid:AB.uid,password:AB.pwd,wsSize:10,authMode:AB.am,wsuid:AB.wsuid,wspwd:AB.wspwd,wsam:AB.wsam,clientVersion:mstrMobileApp.getAppVersion(),clientType:mstrMobileApp.isTablet()?AG.ANDROID_TAB:AG.ANDROID_PHONE}),AC={projectId:s,mobileConfig:t,doNotHold:true};w.request(AF,AE,false,AC);},x=z;T.call(this,AB,z);l=setInterval(function(){if(o){o=false;AB=t.getLoginInfo(s);T.call(w,AB,z);}},500);}mstrmojo.MobileServerProxy=mstrmojo.declare(mstrmojo.ServerProxy,null,{scriptClass:"mstrmojo.MobileServerProxy",getSessions:function(){return C;},request:function I(p,o,l,k){this._projectId=k.projectId;this._mobileCfg=k.mobileConfig;this._super(p,o,l,k);},createRequest:function Y(q,t,s,l){var p;try{p=this._super(q,t,s,l);var k=this._projectId;p.pid=k;if(!l.noTaskURL){p.taskURL=this._mobileCfg.getTaskUrlByProject(k);}p.isLogin=(s.taskId===D);p.isPwdChange=(s.taskId==Z);}catch(o){this.deleteRequest(q);throw o;}return p;},userInteractionRequired:function E(p){var k=false;if(p.pid&&!C[p.pid]){var o=p.config.mobileConfig.getLoginInfo(p.pid),q=((o.wsam>1)&&!o.wsuid),l=(!o.uid&&o.am!=2);return q||l;}return k;},submitRequest:function U(l){if(l.isLogin||l.isPwdChange){this._super(l);return ;}var o=C[l.pid],k=d[l.pid];if(o){l.params.sessionState=o;if(k){mstrmojo.hash.copy(k,mstrmojo.locales);}this._super(l);}else{if(l.config.skipLogin){this._super(l);return ;}if(mstrMobileApp.isOnline()){R.call(this,l);}else{if(b.call(this,l)){if(!P[l.pid]){g.call(this,l);}else{this._super(l);}}else{R.call(this,l);}}}},response:function B(p,k,l){var o=this.getRequest(p);if(!o){return ;}if(!k&&mstrMobileApp.isOnline()){switch(parseInt(l.code,10)){case j.AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:case j.AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:L.call(this,o);return ;break;case j.MSI_INBOX_MSG_NOT_FOUND:break;case j.E_MSI_USERMGR_USER_NOTFOUND:if(!o.isLogin){delete o.params.sessionState;R.call(this,o);return ;}break;}}this._super(p,k,l);},getSession:function X(k){return C[k];},closeSession:function Q(k){},closeAllSessions:function S(){C={};},getLocaleInfo:function F(k){return d[k];},hasEmailScreenPrivilege:function O(k){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TextInput","mstrmojo.ValidationTextBox","mstrmojo.hash");mstrmojo.android.ui.ValidationTextInput=mstrmojo.declare(mstrmojo.android.ui.TextInput,null,{scriptClass:"mstrmojo.android.ui.ValidationTextInput",valProps:null,getTextCfg:function A(){return mstrmojo.hash.copy(this.valProps,{scriptClass:"mstrmojo.ValidationTextBox",onEnter:function(){var D=this.parent,E=D.onEnter;if(E){if(this.isValid()){E.call(D,this.value);}}},onvalidationStatusChange:function(){var D=this.validationStatus,E=D&&D.code,F=this.parent.lblErr,G=E?D.msg:"";F.set("text",G);F.set("visible",!!G);}});},validate:function C(){return this.txt.validate();},isValid:function B(){return this.txt.isValid();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.dom","mstrmojo.css");var C=mstrmojo.dom,O=mstrmojo.css,D=5,I=6,P=1,G=7,L=30;function A(T){if(T.style){var S=mstrmojo.css.getStyleValue(T,C.CSS3_TRANSFORM);if(S!=="none"){T.style[C.CSS3_TRANSFORM]=S;}}}function H(U){var T,S=U.childNodes.length;for(T=0;T<S;T++){var V=U.childNodes[T];H(V);A(V);}}mstrmojo.android.inputControls.TextAreaDIC=mstrmojo.declare(mstrmojo.TextArea,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.TextAreaDIC",cssDisplay:"block",init:function M(S){this._super(S);this.maxLength=this.dic.ml;if(!this.showByDefault){this.cssClass="mstrmojo-TextAreaDIC-Popup";this.rows=7;}},focus:function K(){C.setCaret(this.domNode,(this.value!=null&&String(this.value).length)||0);},onfocus:function R(){window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},onvalueChange:function J(){if(!this.showByDefault){this._super();}},onblur:function B(){if(this.showByDefault){this.applyChanges();}},applyChanges:function E(){this.domNode.blur();var S=parseInt(this.dic.dt,10);if((S>=P&&S<=G)||S===L){this.value=parseFloat(this.value);}this._super();},cancelChanges:function F(){this.domNode.blur();this._super();},postBuildRendering:function Q(){this._super();if(this.showByDefault){this.domNode.style.width="100%";this.domNode.style.height="100%";if(!mstrApp.isTablet()){C.attachEvent(this.domNode,"click",function(){H(document.body);},false);}var S=this;C.attachEvent(this.domNode,"blur",function(){var T=S.domNode;while(T!=null){if(T.scrollTop>0){T.scrollTop=0;break;}T=T.parentNode;}},false);}},renderPreview:function N(){var W=this.dic,S=this.value,U=(this.dv==null)?"":String(this.dv),V="",T=/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i;if(!U||!W.sp){this.dv=W.siwc?"&nbsp;":(U||"&nbsp;");}else{S=(S.length>W.pl)?(S.substring(0,W.pl)+"&hellip;"):S;switch(this.ts){case I:V="mailto:";case D:if(!U){U='<a href="mailto:"></a>';}U=U.replace(T,"$1"+V+this.value.replace(/\$/g,"$$$$")+"$3"+S.replace(/\$/g,"$$$$")+"$5");break;default:U=(U.length>W.pl)?(U.substring(0,W.pl)+"&hellip;"):U;}this.dv=U;}this.renderPreviewButton(this.openerNode,this.dv);O.toggleClass(this.openerNode.firstChild,"filled",!this.dicChanged&&this.value!=null&&String(this.value).length>0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.android.ui.Label","mstrmojo.android.ui.Menu","mstrmojo.android.ui.SearchBox","mstrmojo.android.ui.Image","mstrmojo.mstr.WebElements","mstrmojo.dom","mstrmojo.css");mstrmojo.requiresDescs(10,9462,9463);var D=mstrmojo.dom,F=mstrmojo.css,E=D.CSS3_TRANSITION_END;var B=[{n:mstrmojo.desc(9462,"View All"),idx:1,v:true},{n:mstrmojo.desc(9463,"View Selected"),idx:0,v:false}];function C(){if(this.searchRequired){if(!this.target.getSelectedItems().length){return false;}}return true;}function A(){var S=this.lbl,V=S.domNode,L=V.style,N=this.searchNode.style,M=this.search.box,K=M.inputNode,T=K.style,Q=this.target,R="visible";var P=this._isSearch=!!S.visible;if(P){Q.enterSearchMode();var O=F.getComputedStyle(M.inputNode),J=this.domNode.offsetWidth-(2*parseInt(O.marginRight,10))-parseInt(O.paddingLeft,10)-parseInt(O.paddingRight,10)-this.search.slot0.offsetWidth,U=this.browseElements;D.attachOneTimeEvent(V,E,function(){S.set(R,false);N.width="100%";M.set("hint",(U&&U.source.n)||mstrmojo.desc(10,"Search"));M.set(R,true);window.setTimeout(function(){T.width=J+"px";},0);});L.opacity=0;}else{if(!C.call(this)){return ;}Q.exitSearchMode(!this.searchRequired);D.attachOneTimeEvent(K,E,function(){M.set(R,false);M.set("value","");N.width="";S.set(R,true);window.setTimeout(function(){L.opacity=1;},0);});M.inputNode.style.width=0;}}mstrmojo.android.ui.ElementsSearchBar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.android.ui.ElementsSearchBar",markupString:'<div id="{@id}" class="mstrmojo-ElementSearchBar {@cssClass}" style="{@cssText}" ><div><div class="mstrmojo-ElementSearchBar-switch"></div><div class="mstrmojo-ElementSearchBar-search"></div></div></div>',markupSlots:{switchNode:function(){return this.domNode.firstChild.firstChild;},searchNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{oncanSearchChange:function(){this.search.btn.set("visible",!!this.canSearch);}},target:null,browseElements:null,searchRequired:false,children:[{scriptClass:"mstrmojo.android.ui.Menu",slot:"switchNode",alias:"menu",visible:false,items:[B[1]],postselectionChange:function(J){var L=J.added,M=L&&this.items[L[0]];if(M){var K=this.parent;K.lbl.set("text",M.n);this.set("visible",false);this.set("items",[B[M.idx]]);K.target.set("viewAll",M.v);}}},{scriptClass:"mstrmojo.HBox",alias:"search",slot:"searchNode",children:[{scriptClass:"mstrmojo.android.ui.Image",alias:"btn",touchTap:function(){A.call(this.parent.parent);}},{scriptClass:"mstrmojo.android.ui.SearchBox",alias:"box",hint:mstrmojo.desc(10,"Search"),cssDisplay:"block",cssText:"width:0;",visible:false,searchFunc:function(M){if(M){var O=this.parent.parent,L=O.browseElements,K=(L&&L.duplicate())||new mstrmojo.mstr.WebElements(),J=K.browseConfig||{},N=this.id;J.searchPattern=M;J.blockBegin=1;J.searchForms=this.searchForms;if(O.searchTarget){J.searchTarget=O.searchTarget;delete O.searchTarget;}K.browseConfig=J;K.getItems(0,{success:function(){mstrmojo.all[N].set("searchResult",K);}});}else{this.clearSearch();}},clearFunc:function(){this.parent.parent.target.clearSearch();},onsearchResultChange:function(){this.parent.parent.target.search(this.searchResult);}}]}],init:function H(J){this._super(J);var K={scriptClass:"mstrmojo.android.ui.Label",slot:"switchNode",alias:"lbl"};if(J.searchRequired){K.text=J.title;K.cssClass="mstrmojo-no-Image";}else{K.text=mstrmojo.desc(9462,"View All");K.touchTap=function(){var M=this.parent.menu,L=!M.visible;if(L){M.set("width",this.domNode.offsetWidth+"px");}M.set("visible",L);};}this.addChildren(K);},onRender:function I(){var J=this.initSearchValue,K=this.id;if(J||this.searchRequired){delete this.initSearchValue;window.setTimeout(function(){var M=mstrmojo.all[K];A.call(M);var L=M.search.box;L.set("value",J||"");if(J){L.onEnter();}},0);}return this._super();},goBack:function G(){if(this._isSearch){if(C.call(this)){A.call(this);return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo._IsInputControl","mstrmojo.dom","mstrmojo.num");var J=mstrmojo.validation,C=J.STATUSCODE,F=J.VALIDATOR,D=mstrmojo.expr.DTP,B=0,A=1,I=2,H=3,G=4,E=5;mstrmojo.TextFieldDIC=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",dtp:D.VARCHAR,validationDelay:0,getInputNode:function(){return this.inputNode;},focus:function(){this.validate();mstrmojo.dom.setCaret(this.domNode,(this.value&&this.value.length||0));},init:function(K){if(this._super){this._super(K);}this.constraints=mstrmojo.hash.copy();var M=K.dic,N=this.constraints={trigger:mstrmojo.validation.TRIGGER.ONKEYUP},L=M.dt;if(M.ml){this.maxLength=M.ml;}if(M.psw){this.type="password";this.value=this.lv="";this.owner.applyPasswordMask&&this.owner.applyPasswordMask();}if(J.isNumeric(L)||J.isInt(L)||J.isString(L)){this.dtp=L;}switch(M.vm){case A:N.validator=F.VALIDATE_PHONENO;break;case I:N.validator=F.VALIDATE_EMAIL;break;case H:N.validator=F.VALIDATE_ZIPCODE;break;case G:N.validator=F.VALIDATE_SSN;break;case E:N.regExp=new RegExp("^"+M.rgx+"$");break;}N.min=M.emin?M.min:null;N.max=M.emax?M.max:null;N.maxLen=(M.ml!==undefined)?M.ml:null;N.minLen=(M.mnl!==undefined)?M.mnl:null;if(M.req||M.emin){this.required=true;}},onInvalid:function(){if(this.popup){this.popup.set("hasInvalidData",true);}},onValid:function(){if(this.popup){this.popup.set("hasInvalidData",false);}},applyChanges:function(){this.validate();if(this.isValid()){this._super();}else{this.handleInvalid();return false;}return true;},handleInvalid:function(){if(mstrmojo.all.mojoConfirmx9){return ;}var K=this;mstrmojo.confirm(this.validationStatus.msg+"<br>("+mstrmojo.desc(9199)+")",[{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1442),onclick:function(){K.focus();}},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(221),onclick:function(){K.popup.onCancel();}}],mstrmojo.desc(7548));},cancelChanges:function(){this.inputNode.blur();this.value=this.lv;this.clearValidation();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.android.ui._CanBeFullScreen","mstrmojo.android.ui.ActionToolbar","mstrmojo.android.ui.TitleLabel","mstrmojo.android.ui.Image","mstrmojo.hash","mstrmojo.array","mstrmojo.css");var C=mstrmojo.hash,I=mstrmojo.array,K=mstrmojo.css;var E=mstrmojo.android.ui.ActionBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.android.ui._CanBeFullScreen],{scriptClass:"mstrmojo.android.ui.ActionBar",markupString:'<div id="{@id}" class="mstrmojo-ActionBar {@cssClass}" style="{@cssText}" ><div><div class="mstrmojo-ActionBar-logo"></div><div><div class="mstrmojo-ActionBar-contents"></div></div><div class="mstrmojo-ActionBar-toolbar"></div></div></div>',markupSlots:{logoNode:function(){return this.domNode.firstChild.firstChild;},containerNodeWrapper:function(){return this.domNode.firstChild.childNodes[1];},containerNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},toolbarNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{logoNode:"56px",containerNodeWrapper:"56px",containerNode:"56px",toolbarNode:"56px"},w:{logoNode:"66px",containerNodeWrapper:"100%",containerNode:"100%",toolbarNode:"auto"}},children:[{scriptClass:"mstrmojo.android.ui.Image",slot:"logoNode",alias:"logo",onactiveChange:function(){K.toggleClass(this.domNode,"active",this.active);},touchTap:function(){mstrApp.closeAllDialogs();if(this.active){var N=this.domNode,M="selected";K.addClass(N,M);this.parent.controller.goUp();window.setTimeout(function(){K.removeClass(N,M);},500);}}},{scriptClass:"mstrmojo.android.ui.TitleLabel",slot:"containerNode",alias:"title",onlistSelectionMade:function(M){this.parent.controller.jumpTo(M.item);}},{scriptClass:"mstrmojo.android.ui.ActionToolbar",slot:"toolbarNode",alias:"toolbar"}],reset:function G(){this.title.reset();this.toolbar.reset();},setUpStatus:function J(M){this.logo.set("active",M);},setNavigation:mstrmojo.emptyFn,clearNavigation:mstrmojo.emptyFn,restoreNavigation:mstrmojo.emptyFn,selectNavigationItem:function D(N){var O=this.getNavList(),M=false;I.forEach(O&&O.items,function(Q,P){if(N.act===Q.act){O.singleSelect(P);M=true;return false;}});return M;},getNavList:mstrmojo.emptyFn,setLastOpened:function B(M){this.title.setListItems(M);},updateTitle:function H(M){this.title.setText(M);},updateToolbar:function L(N,M){this.toolbar.setActions(N,M);this.title.checkTextFit();},setActionToolbarStatus:function A(M){this.toolbar.set("active",M);},onEnterFullScreen:function F(){this.reset();}});E.adjustLayoutConfig=function(O,M){var N=mstrmojo.DPIManager;C.forEach(E.prototype.layoutConfig.h,function(Q,R){N.registerClass(E,"h",R,O);});var P=C.copy(O);if(M){C.forEach(P,function(R,Q){P[Q]=Math.ceil(R*1.333);});}N.registerClass(E,"w","logoNode",P);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.array","mstrmojo.android.EnumMenuOptions","mstrmojo.android.ui.ActionToolbar");mstrmojo.requiresDescs(1,1143,7831);var X=mstrmojo.android.EnumMenuOptions,I=mstrmojo.hash,a=mstrmojo.array.forEach,j=X.SETTINGS,J=X.HELP,Y=X.LEARN,F=-1;var f={currentViewMedia:0,documentID:"objectID",elementsPromptAnswers:0,link:0,linkAnswers:0,objectID:0,objectsPromptAnswers:0,promptsAnswerXML:0,reportID:0,reportViewMode:0,valuePromptAnswers:0,visMode:0,desiredElements:0,desiredUnits:0,projectID:0,Project:"projectID",groupByElements:0,pageByElements:0,layoutIndex:0,originMessageID:"originMessageID",promptAnswerMode:0,selectorMode:"selectorMode"};mstrmojo.android.controllers.ViewController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.android.controllers.ViewController",supportsFullScreen:false,start:function P(q){this.set("orientation",mstrApp.isLandscape()?0:1);this.pid=mstrApp.getCurrentProjectId();},detach:function p(){var t=this,w=t.nextController,s=t.prevController;if(s){delete s.nextController;}if(w){w.destroy();}this.nextController=this.prevController=null;var q=this.view;if(q){q.destroy();}},destroy:function k(){this.detach();this._super();},canDetach:function O(q){return q.hsc||!this.hsc;},getUpStatus:function L(){return !this.hsc;},spawn:function G(s,q){var t=this.nextController;if(t){if(!t.canDetach(s)){t.spawn(s,q);return ;}t.destroy();}this.nextController=s;s.prevController=this;s.rootCtrl=this.rootCtrl||this;s.start(q||{});},spawnFailed:function T(q){this.makeCurrent();mstrApp.onerror(q);},viewFailed:function U(s){if(s){mstrmojo.dbg("details: "+JSON.stringify(s));}mstrApp.hideMessage();if(this.view){if(this.rootCtrl.getCurrent()!==this){this.makeCurrent(true);}}else{var q=this.prevController;if(q){q.spawnFailed(s);}}mstrApp.onerror(s);},makeCurrent:function W(AE){var q=this.nextController,AC=true;if(q){AC=!q.doNotRefresh;q.destroy();}if(!this.supportsFullScreen){this.rootCtrl.exitFullScreen();}var z=this.pid;if(z){mstrApp.setCurrentProjectId(z);}if(AE){if(mstrApp.useBinaryFormat&&mstrApp.getCurrentProjectId()){var AB=this.ctrlType;if(AB){var x=this.model,w=mstrmojo.emptyFn,AD=w,AA=this;if(this.checkCache&&AC){AD=function(){setTimeout(function(){AA.checkCache(null,null,null,1);},100);};}var s={taskId:"setCurrentView",st:AB,did:this.did||"",mid:(x&&x.dataService&&x.dataService.msgId)||""},t=x&&x.currlaykey;if(t){s.layoutKey=t;}mstrApp.serverRequest(s,{success:AD,failure:w},{silent:true});}}}},makeHome:function M(){this.makeCurrent(true);},jumpTo:function o(q){var s=this.nextController;if(s){s.jumpTo(q);return ;}this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(q.st),q),q);},getPath:function H(){var q=this.nextController;if(q){return q.getPath();}return[];},updateItemProperties:function A(x,s,q,w){var t=this.nextController;if(t){t.updateItemProperties(x,s,q,w);}},onorientationChange:function N(){var s=this.orientation,q=this.view;if(q&&q.hasRendered&&q.rootOrientationChange){q.rootOrientationChange({isLandscape:!s});}var t=this.nextController;if(t){t.set("orientation",s);}},getCurrent:function l(){var q=this.nextController;if(q){return q.getCurrent();}return this;},goBack:function E(){var q=this.nextController;if(q){if(!q.goBack()){if(!this.rootCtrl){return false;}this.makeCurrent(true);}return true;}return false;},goUp:function S(){var q=this.nextController;if(q){return q.goUp();}return false;},getController:function Q(t,w,s){var q=this[(s?"next":"prev")+"Controller"];if(q){if(q[t]===w){return q;}return q.getController(t,w,s);}return null;},newView:function d(q,s){return mstrApp.viewFactory.newView(q,mstrmojo.hash.copy(s,{controller:this}));},getViewKey:function C(q){return{1:"Projects",2:"Home",3:"Subscriptions",4:"Settings",5:"Projects",6:"Help",8:"Subscriptions",768:"Xtab",769:"Graph",774:"Xtab",2048:"Folder",14081:"Document"}[q];},getDefaultMenus:function h(){return F;},generateActionToolbar:function K(){var q=this.rootCtrl||this,s=q.getCurrent();q.setActionToolbar(s.id,s.updateActionToolbar(mstrmojo.android.ui.ActionToolbar.newToolbarConfig()));},updateActionToolbar:function g(s){var t=this.getDefaultMenus(),q=mstrApp.getConfiguration();if(q.isMenuAllowed(Y,t)){s.addMenuItem(Y,mstrmojo.desc(9849,"Learn More"),Y,true,6);}if(q.isMenuAllowed(j,t)){s.addMenuItem(j,mstrmojo.desc(7831,"Settings"),j,true,6);}if(q.isMenuAllowed(J,t)){s.addMenuItem(J,mstrmojo.desc(1143,"Help"),J,false,9);}if(!mstrApp.isTablet()){s.maxBtnCount=(mstrApp.isLandscape())?Math.round(mstrMobileApp.getDeviceDPI()/105)+1:2;}return s;},handleMenuItem:function b(s,q){switch(s){case j:this.spawn(mstrApp.controllerFactory.newController("Settings"));break;case Y:mstrMobileApp.displayLearnMore();break;case J:mstrApp.displayHelp();break;}return false;},beforeViewVisible:mstrmojo.emptyFn,afterViewVisible:function R(){var q=this;window.setTimeout(function(){q.generateActionToolbar();},100);},beforeViewHidden:mstrmojo.emptyFn,afterViewHidden:mstrmojo.emptyFn,handleSpecialLink:function V(t){var s=t.queryKey.evt,q;if(s==="3999"){this.spawn(mstrApp.controllerFactory.newController("Settings",{}),{});}else{if(s==="3124"){mstrApp.goBack();q=true;}else{if(s==="3994"){mstrApp.displayHelp();}else{if(s==="3997"){mstrApp.rootController.jumpTo({act:8});}else{if(s==="3995"){mstrApp.rootController.goHome();q=true;}else{if(s==="3996"){mstrApp.rootController.jumpTo({act:5});q=true;}}}}}}if(q){window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);}},getDepth:function B(){var q=this.prevController;return(q&&(q.getDepth()+1))||1;},onLink:function D(t,w){var x=this.buildLinkParams(w);x.action="linkToObject";var s=false,q=768;switch(parseInt(w.evt,10)){case 4001:if(parseInt(w.reportViewMode,10)===2){q=769;}x.styleName="AndroidMessageResultStyle";break;case 32001:s=true;break;case 2048001:q=14081;break;}x.st=q;this.spawn(mstrApp.controllerFactory.newController(s?"HTMLDoc":this.getViewKey(q),{st:q}),x);},buildLinkParams:function Z(s){var t={};I.forEach(s,function(x,AC){var AA=f[AC];if(AC==="Project"){var z=mstrApp.getConfiguration(),AE=s.Server,w=s.port||s.Port,AD;if(AE===undefined){var AB=z.getServerByProjectId(mstrApp.getCurrentProjectId());if(AB!==undefined){a(AB.pl,function(AF){if(x===AF.pn){if((w===undefined)||(!!w&&parseInt(w,10)===AF.sp)){AD=AF;return false;}}});}}else{AD=z.getProjectByServerAndProjectName(AE,w,x);}if(AD!==undefined){t[AA]=AD.pid;}}else{if(AA!==undefined){t[AA||AC]=x;}}});if(mstrApp.useBinaryFormat){t.srcMsgId=s.srcMsgId;}var q=s.linkInfo;if(q&&q.so>0){t.selectorMode=q.so;t.originMessageID=s.srcMsgId;if(!s.linkAnswers){t.promptAnswerMode="0";}}return t;},exitFullScreen:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TxEditDoc");mstrmojo.android.large.ui.TxEditDoc=mstrmojo.declare(mstrmojo.android.ui.TxEditDoc,null,{scriptClass:"mstrmojo.android.large.ui.TxEditDoc",layoutConfig:{h:{typeNode:"100%",txNode:"100%"},w:{typeNode:"42%",txNode:"58%"}},typeSelected:function A(B){if(this.hasRendered){var D=this.btmNode,C=D.style;C.left=(this.typeNode.offsetWidth-D.offsetWidth+1)+"px";C.top=this.typeList.getItemOffset(B)+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.medium.ui.TxButtons","mstrmojo.css");mstrmojo.android.medium.ui.TxActionButtons=mstrmojo.declare(mstrmojo.android.medium.ui.TxButtons,null,{scriptClass:"mstrmojo.android.medium.ui.TxActionButtons",selectionPolicy:"reselect",enabled:false,items:[{n:mstrmojo.desc(9252,"Delete"),v:0},{n:mstrmojo.desc(9253,"Edit"),v:1}],postselectionChange:function(A){var B=A.added;if(B&&this.enabled){this.parent.parent[((B[0])?"edit":"delete")+"Record"]();}},onenabledChange:function(A){mstrmojo.css.toggleClass(this.domNode,"enabled",A.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.medium.ui.TxButtons","mstrmojo.css","mstrmojo.array");var A;mstrmojo.android.medium.ui.TxTypeList=mstrmojo.declare(mstrmojo.android.medium.ui.TxButtons,null,{scriptClass:"mstrmojo.android.medium.ui.TxTypeList",getItemMarkup:function(){if(!A){A='<div class="item {@cls}" idx="{@idx}" style="{@style}">{@n} ({@cnt})</div>';}return A;},getItemProps:function B(E,C){var D=this._super(E,C);D.cnt=E.v;return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileCheckList","mstrmojo.android._IsIncFetchList","mstrmojo.mstr.WebElements","mstrmojo.array");var D=mstrmojo.array,G=new mstrmojo.mstr.WebElements();function H(M){this.supportsIncFetch=false;delete this.ifDataHelper;if(M){if(M.items.length<M.totalSize){this.ifDataHelper=M;this.supportsIncFetch=true;}}}function C(){var M=this.height;if(!this.elasticHeight&&M){this.elasticHeight=parseInt(M,10);}}mstrmojo.android.ui.ElementsPicker=mstrmojo.declare(mstrmojo.ui.MobileCheckList,[mstrmojo.android._IsIncFetchList],{scriptClass:"mstrmojo.android.ui.ElementsPicker",browseElements:null,viewAll:true,glow:true,onbrowseElementsChange:function A(){H.call(this);this._ignoreSelection=true;var M=this.browseElements;if(M){var O=M.items=(M.items||[]),N=this._searchConfig;if((!N||N.exit)&&!this.viewAll){O=this.getSelectedItems();}this.set("items",O);if(N){this.glow=false;this.selectItems(N.selected,true);this.glow=true;}H.call(this,M);}else{this.set("items",[]);}this.updateScroller();this._ignoreSelection=false;},syncSelection:function F(){var M=this._searchConfig;if(M){this.selectItems(M.selected,false);}},enterSearchMode:function E(){var M=this.getSelectedItems();this._searchConfig={elements:this.browseElements,selected:M,clone:[].concat(M)};C.call(this);this.set("browseElements",G);},search:function L(M){this.set("browseElements",M);},exitSearchMode:function K(N){var M=this._searchConfig;M.exit=true;this.set("browseElements",N?M.elements:{items:M.selected});delete this._searchConfig;},clearSearch:function J(){var M=this._searchConfig;M.selected=[].concat(M.clone);this.set("browseElements",G);},postselectionChange:function B(N){var M=this._searchConfig;if(!M||this._ignoreSelection){return ;}var Q=M.selected,O=this.items,P=N.added;if(this.multiSelect){D.forEach(P,function(R){Q.push(O[R]);});D.forEach(N.removed,function(R){D.removeItems(Q,"v",[O[R]]);});}else{if(P){Q.splice(0);Q.push(O[P[0]]);}}},onviewAllChange:function I(){var N=this.getSelectedItems(),M;if(this.viewAll){M=this.browseElements;N=M.items;}else{C.call(this);}this.glow=false;var O=this.getSelectedItems();this.set("items",N);this.selectItems(O,true);this.glow=true;H.call(this,M);this.updateScroller();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileCheckList","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.android._IsIncFetchList","mstrmojo.array");var D=50;function F(){return{next:function(H){var I=Math.min(this.blockEnd+D,this.totalSize);H.success(null,this.items.slice(this.blockEnd,I));this.blockEnd=I;},init:function(J,H,I){this.blockBegin=J;this.blockEnd=H;this.totalSize=I.length;this.items=I;}};}mstrmojo.android.inputControls.PullDownDIC=mstrmojo.declare(mstrmojo.ui.MobileCheckList,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton,mstrmojo.android._IsIncFetchList],{scriptClass:"mstrmojo.android.inputControls.PullDownDIC",multiSelect:false,isElastic:true,supportsIncFetch:false,init:function G(H){this._super(H);this._items=this.getItems();if(this._items.length>D){this.ifDataHelper=F();this.supportsIncFetch=true;}},postselectionChange:function C(I){var H=I.added[0];if(H<this.items.length){this.set("value",this.items[H].v);}},preBuildRendering:function A(){this._super();var J=this.value,K=this.dic.ust||"",I=this._items,H=mstrmojo.array.find(I,"v",J);if(H===-1){I=[{n:K,v:J}].concat(I);H=0;}if(this.supportsIncFetch){this.ifDataHelper.init(0,D,I);I=I.slice(0,D);}this.items=I;this.set("selectedIndex",H);},postBuildRendering:function B(){this._super();this._scroller.scrollTo(0,0);},renderPreview:function E(){var H=mstrmojo.array.find(this._items,"v",this.value),I=(H>=0)?this._items[H].n:(this.dic.ust!==undefined?this.dic.ust:this.dv);this.renderPreviewButton(this.openerNode,this.dicChanged?I:this.dv);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileCheckList","mstrmojo.css");var B=mstrmojo.css,C="selected";function E(){var G=this.getSelectedItems().length,I=this.items.length,H="btnCheckSemi";if(G===0){H="btnCheckNone";}else{if(G===I){H="btnCheckFull";}}this.parent.updateTitleBarButtonClass(H);}mstrmojo.ui.MobileReviewList=mstrmojo.declare(mstrmojo.ui.MobileCheckList,null,{scriptClass:"mstrmojo.ui.MobileReviewList",listHooks:{select:function(H,I,G){mstrmojo.ui.MobileCheckList.prototype.listHooks.select(H,I,G);if(this.parent.selectionHidden){this.selectedIndices={};return true;}E.call(this);},unselect:function(H,I,G){mstrmojo.ui.MobileCheckList.prototype.listHooks.unselect(H,I,G);E.call(this);return this.selectionHidden;}},init:function F(G){this._super(G);if(this.multiSelect){B.addWidgetCssClass(this,"hidden");}},selectAll:function D(){var G="addClass",J=this.domNode.childNodes[0],I=J.childElementCount,H=0,K=true;if(this.getSelectedItems().length>0){G=("removeClass");this.selectedIndices={};K=false;}for(H=0;H<I;H++){B[G](J.childNodes[H],C);if(K){this.selectedIndices[H]=true;}}E.call(this);},touchSelectBegin:function A(G){if(this.parent.selectionHidden){this.parent.setDeleteActions("delete");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.ui.MobileCheckList","mstrmojo.array");var A='<div class="mstrmojo-SelectBoxList-item" idx="{@idx}"><h2>{@n}</h2><h4>{@v}</h4></div>';mstrmojo.android.ui.SelectBoxList=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.ui.SelectBoxList",selectionPolicy:"reselect",getItemMarkup:function(){return A;},getItemProps:function B(F,D){var E=this._super(F,D);E.v=F.v;return E;},postselectionChange:function C(E){var G=E.added;if(!G){return ;}var D=G[0],H=this.items[D],F=H.items,I=this.id;mstrApp.showDialog({title:H.n,children:[{scriptClass:"mstrmojo.ui.MobileCheckList",items:F,multiSelect:false,isElastic:true,selectedIndex:mstrmojo.array.find(F,"on",true),postselectionChange:function(J){mstrApp.closeDialog();mstrmojo.all[I].selectListChange(D,F[J.added[0]]);}}]});},selectListChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.XtabZone","mstrmojo.DICFactory","mstrmojo.DynamicClassFactory");var AJ=102,Q=1,J=2,p=mstrmojo.css,o=mstrmojo.dom,j=mstrmojo.hash,d=mstrmojo.DynamicClassFactory.newComponent,K=1,AL=2,H=4,f=2,V=1,B=2,AH=1,G=2,z=1,w=2,b=2,k=1,I=function(AO){if(AO){return AO.tui>=0?("h_"+AO.tui+"_"+AO.fi+"_"+AO.axis):("m_"+AO.mix);}return"";};function x(AU,AQ,AR){var AT=this.nm[AQ],AP=AR.v,AS=AR.dv;AU.rv=AP;AU.v=AS;AU.mdf=1;if(AU._src){AU._src.rv=AP;AU._src.v=AS;AU._src.mdf=1;}var AO=this.dicGroupMap[I(AU)].widgetsMap[AU._ei];if(!AO.showByDefault){if(AO.hasPreview){AO.renderPreview();}else{if(o.isIE7&&mstrmojo.string.isEmpty(AP)){AP=" ";}AT[AT.innerText!==undefined?"innerText":"textContent"]=AP;}}return AT;}function Y(AR,AS,AO){if(AO[AS]===0){return true;}if(AR&&AO[AS]===undefined){try{var AP=AR.getRowCells(AS),AT=AP&&AP[0];if(AT&&AT.o===AS){if(AT.sst){AO[AS]=0;}return !!AT.stt;}if(AT&&AT.o){return Y(AR,AS+AS-AT.o,AO);}return false;}catch(AQ){return false;}}else{return false;}}function L(AP,AO){mstrmojo.array.forEach(AP,function(AQ){AO[AQ.o]=1;});}function AK(AO){if(AO.mgh&&(AO.mgh&Q)){this.mghMarks={};}}function AA(AQ,AS){var AP=AS.bb-1,AO=Math.min(AP+AS.bc,AS.tc),AR;j.forEach(AQ,function(AU,AT){AR=Number(AT);if(AR!==NaN&&AR>=AP&&AR<AO){delete AQ[AT];}});}function AE(AR,AQ){var AO=this.editing?1:(AR.rs||1),AP;for(AP=0;AP<AO;AP++){this.dirtyRows[AQ+AP]=1;}}function AN(AO){return AO&&parseInt(AO.ipt,10)===b;}function AI(AO){var AQ=this.zones._BR,AP=this.zones._BL;if(!AP){return AQ.getRowIdxByCell(AO);}else{if(AQ.posMap&&AQ.posMap[AO._ei]){return AQ.getRowIdxByCell(AO);}else{return AP.getRowIdxByCell(AO);}}}mstrmojo._IsEditableGridCP={_mixinName:"mstrmojo._IsEditableGridCP",initContent:function AF(AR){this._super(AR);var AX=this.gridData,AP=AX&&AX.vp,AV,AU,AW,AZ,AO,AY,AQ,AT;if(((this.type===K)||(this.type===H))&&AP&&AP.cols&&!AP._adjusted){AO=AP.cols.cg;AQ=AP.cols.cws;if(AO&&AO.cgc>0){for(AV=AO.cgc;AV>0;AV--){AO[AV]=j.copy(AO[AV-1],{});AY=AO[AV];var AS=AY.attForms;if(AS){for(AU=0,AZ=AS.length;AU<AZ;AU++){AW=AS[AU];AW.idx+=1;}}}AO[0]={tg:false,cc:0,cl:1,attForms:[{n:"",idx:0}]};AO.cgc+=1;}if(AQ){AQ.splice(0,0,{w:"60px",xc:true});}if(AP.dafIdx!==undefined){AP.dafIdx+=1;}AT=AX.gts.row;for(AV=0,AZ=AT.length;AV<AZ;AV++){AT[AV].ci=AV+1;}AP._adjusted=true;}this.colWidths=[{w:""}].concat(this.colWidths);this.unmergedCells=[];},getUnmergedCells:function Z(){return null;},getRowCells:function AC(AY){var AQ=this._super(AY),AO=AQ[0],Ac=(AO&&AO.o)||0,AZ=(this.tp===K),AT=this.interactiveCellsArray,Ab={css:"",v:""},Af=[],AP=[],Ag,Ah;if(!AZ){var AV=this.base.items,Ae=this.lookupBase,Ad=this.gridData.css,Ak=AO&&AO.pi,Aa=Ak&&Ak.ri,Aj=Ak&&Ak.ci,AW=AO.stt>0;while(Ak&&Aa>-1&&Aj>-1){AO=AO._p||AV[Aa].items[Aj];var AR=j.copy(AO,{});AR._src=AO;if(!AR.css){AR.css=Ad[AR.cni].n;}var AX=Ae[AO.tui],Ai=AX&&AX.es[AO.idx];if(Ai){AR.v=AO.v||Ai.n;AR._e=Ai;}AR.rs=1;if(AW){AR.at&=~32;}if(Ac>-1){AR.o=Ac;}if(!AR.axis&&this.axis){AR.axis=this.axis;}AR._ei=AT.push(AR)-1;Af.splice(0,0,AR);Ak=AO&&AO.pi;Aa=Ak&&Ak.ri;Aj=Ak&&Ak.ci;}for(Ag=0,Ah=AQ.length;Ag<Ah;Ag++){var AS=AQ[Ag];if(AS.rs>1){var AU=j.copy(AS,{});AU.rs=1;AS=AU;}AP.push(AS);}}else{AP=AQ;if(AY>0){return AQ;}}if(AP[0]){Ab=j.copy(AP[0],{});Ab.rv=Ab.v="";if(this.tp===K){Ab.n=Ab.v="";Ab.markAll=true;}else{Ab.n="";}Ab._ei=AT.push(Ab)-1;Ab.at=32;Ab.cs=1;Ab.mark=true;Ab.mix="x";Ab.css=(Af[0]&&Af[0].css)||Ab.css;delete Ab.ui;delete Ab.tui;delete Ab.fs;delete Ab.mdf;}return[Ab].concat(Af.concat(AP));}};mstrmojo._IsEditableXtab={_mixinName:"mstrmojo._IsEditableXtab",update:function AB(AQ){var AO,AP=AQ.data;if(this._super){this._super(AQ);}this.kc={};this.rs={};this.rsDelta={};AK.call(this,AP);if(AP.eg!==undefined){return ;}AO=AQ.data.marked;if(AO){L(AO,this.rs);}if(!AP.rw){var AR=AP.gvs.items.length;AP.rw={row:{bb:1,bc:AR,tc:AR},col:{bb:-1,bc:-1,tc:0}};}},initCP:function E(AQ,AP,AV,AS,AU,AR,AT){var AO={gridData:AQ,type:AV,interactiveCellsArray:AP};AO.base=AS||AO.base;AO.lookupBase=AU||AO.lookupBase;AO.axis=AR||AO.axis;AO.dataSource=this;if(!AT){if(this.tca===J&&this.editing){if(AV===K){mstrmojo.EditableXtabTitlesCP=d(mstrmojo.XtabTitlesCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabTitlesCP",tp:K});AT=new mstrmojo.EditableXtabTitlesCP(AO);}else{if(AV===H){mstrmojo.EditableXtabCP=d(mstrmojo.XtabCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabCP"});AT=new mstrmojo.EditableXtabCP(AO);}else{AT=new mstrmojo.XtabCP(AO);}}}else{if(AV===K){AT=new mstrmojo.XtabTitlesCP(AO);}else{AT=new mstrmojo.XtabCP(AO);}}}else{j.copy(AO,AT);}return AT;},createOnDemandCP:function q(AP,AQ,AO){var AR;if(this.tca===J&&this.editing&&AO===H){mstrmojo.EditableXtabOnDemandCP=d(mstrmojo.XtabOnDemandCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabOnDemandCP"});AR=new mstrmojo.EditableXtabOnDemandCP();}else{AR=new mstrmojo.XtabOnDemandCP();}AR.dataSource=this;AR.blockNum=AP;AR.rc=AQ;return AR;},preBuildRendering:function C(){var AO=this.defn.txi;if(this._super){this._super();}this.txar=AO.txar;this.sci=AO.sci;this.tca=AO.tca;if(this.tca!==J){this.editing=false;}else{if(mstrApp.isMobile){this.editing=this.alwaysEditing=true;}}this.nm={};this.ko={};this.dirtyRows={};this.requiredCellsMap={};this.dicGroupMap={};this.lastIndex=0;this.lastHeaderIndex=0;this.columnNames={};},postBuildRendering:function X(){if(this._super){this._super();}if(this.tca===J&&this.gridData.eg===undefined){var AQ=Math.max(-16,-this.domNode.offsetTop),AR=this;if(!this.alwaysEditing){var AO=mstrmojo.Button.newIconButton(mstrmojo.desc(8324,"Mark rows"),"mstrmojo-EditButton",function(){if(!AR.recalculating){AR.editing=!AR.editing;AR.refresh();}}),AP=new mstrmojo.Button(mstrmojo.hash.copy({cssText:"top:"+AQ+"px;"},AO));AP.render();this.domNode.appendChild(AP.domNode);if(this.editing){this.domNode.style.zIndex=1000;p.addClass(AP.domNode,"close");}else{p.removeClass(AP.domNode,"close");}}}},dataDownloadErr:function M(){if(this.txar&&this.recalculating){var AO=this.zones;if(AO._BL){AO._BL.isDownloading=false;}AO._BR.isDownloading=false;this.rhsCP.initContent();this.valuesCP.initContent();p.removeClass(this.maskNode,"wait");this.recalculating=false;}},dataDownloaded:function T(AS,AQ){var AR=AS.data;if(this.txar){var AO=AQ.blockNum,AP=this.zones,AT;if(this.recalculating){AQ.recalculating=true;this.interactiveCellsArray=[];this.requiredCellsMap={};this.dirtyRows={};this.lastIndex=0;this.lastHeaderIndex=0;this.kc={};this.nm={};this.updatedCellsMap={};this.recalculating=false;this.destroyDICs();}else{AQ.recalculating=false;}if(AO===0){this.gridData=AR;}if(AR.eg){this.refresh();return ;}AT=this.interactiveCellsArray;this.initCP(AR,AT,K,null,null,null,this.titlesCP);this.initCP(AR,AT,AL,AR.ghs.chs,AR.gts.col,f,this.chsCP);this.titlesCP.initContent();this.chsCP.initContent();if(AT&&AT.length===0){if(AP._TR){AP._TR.refresh();}if(AP._TL){AP._TL.refresh();}}}if(this._super){this._super(AS,AQ);}AK.call(this,AR);AA(this.rs,AR.rw.row);if(AR.marked){L(AR.marked,this.rs);this.rsDelta={};}},closeDownloadStatus:function W(){if(this._super){this._super();}mstrmojo.css.removeClass(this._STATUS,"recalculate");},kc:null,ko:null,nm:null,rs:null,dicGroupMap:null,lastIndex:0,lastHeaderIndex:0,columnNames:null,getDataInputInfo:function h(Ac,Aa){var AR=Ac._ei,AP,AU=this.node.defn,AS=this.gridData;if(Ac.mark){AP=Ac.o;if(Ac.stt){this.rs[AP]=0;return ;}this.ko[AP]=AR;Ac.rv=Ac.v=this.rs[AP]||-1;this.kc[AR]={rowop:true};return{key:AR,t:AJ,vls:[{v:-1},{v:1}],wm:1,w:22,hm:1,h:16,dm:1};}var AQ=this.model.getCellTitleInfo(Ac,this.dataBlocks[Ac._gd]),AZ=AQ&&AQ.title,Ab=AZ&&AZ.es,AY=(Ac.mti!==undefined)?Ac.mti:Ac.mix,AO=(Ac.mix!==undefined),Ad=AU.txi.dic,AV;AV=!AO?Ad.att&&AZ&&Ad.att[AZ.id]&&Ad.att[AZ.id][AZ.fs[Ac.fi].id]:Ad.mtx&&Ad.mtx[Ab[AY].oid];if(!AV){return null;}if(this.columnNames[Aa]===undefined){this.columnNames[Aa]=!AO?AZ.n:Ab[AY].n;}if(AN(AV)){AV.vls=(AS.dcv&&AS.dcv[AV.k])||[];}if(AR>=0&&!this.kc[AR]){var AW=!Ac.axis,Ae={isMv:AW};if(AW){var AT=Ac.pi,AX=AT&&AT.top;Ae.co=(AX&&AX.ci)||0;Ae.metric_id=Ab[AY].oid;Ac.o=Ae.o=(Ac._lp&&Ac._lp.o)||0;Ae.tp=B;}else{Ae.ax=Ac.axis;Ae.atid=AZ.id;Ae.form_id=AZ.fs[Ac.fi].id;Ae.o=Ac.o;Ae.tp=V;Ae.fi=Ac.fi;Ae.ui=Ac.ui;Ae.tui=Ac.tui;Ae.rs=Ac.rs;}Ae.dt=AV.dt;if(AN(AV)){Ae.vls=AV.vls;Ae.k=AV.k;}this.kc[AR]=Ae;}AV.key=AR;if(AV.dm){AV.dm=parseInt(AV.dm,10);}return AV;},isEditableHeader:function F(AO){var AP=this.node.defn,AQ=AP.txi.dic;if(AO.sst||!AQ){return false;}if(AO.id!==undefined&&AQ.att){return !!(AQ.att[AO.id]&&(AO.fix?AQ.att[AO.id][AO.fid]:AQ.att[AO.id]));}if(AO.tui!==undefined&&AO.mix!==undefined&&AQ.mtx){return !!(AQ.mtx[AO._e.oid]);}return false;},dataChanged:function P(AP,AQ,AO,AR){if(!this.recalculating){if(AR){this.nm[AP]=AR;}if(this._super){this._super(AP,AQ,AO,AR);}}},updateValue:function g(AR,AP){if(this._super){this._super(AR,AP);}var AV=this.interactiveCellsArray[AR],AZ=AP.v,Aa,AO=AI.call(this,AV);this.lmr=null;Aa=x.call(this,AV,AR,AP);if(AV.r!==AZ){if(!AV.mark){AV.mdf=1;mstrmojo.css.removeClass(Aa,"required");AE.apply(this,[AV,AO]);this.flagDirtyUnit(Aa);}}else{this.clearDirtyUnit(Aa);}if(this.tca===J){if(AV.mark){var AT=AV.markAll?-1:AV.o,AX=this.rsDelta;this.rs[AT]=AZ;this.lmr={r:AT,v:AZ};if(AV.markAll){AX=this.rsDelta={};AX[AT]=AZ;this.mghMarks={};}else{if(AX[AT]&&AX[AT]!==AZ){delete AX[AT];}else{if(AX[-1]!==AZ){AX[AT]=AZ;}}}}else{if(this.rs[AV.o]!==0){this.rs[AV.o]=1;}if(!this.editing&&this.mghMarks&&(AV.mix===undefined)){if(!this.mghMarks[AV.o]||this.mghMarks[AV.o].rs<AV.rs){this.mghMarks[AV.o]={o:AV.o,rs:AV.rs,k:AR};}var AS,AW,AU=this;j.forEach(this.rsDelta,function(Ab,Ac){AS=parseInt(Ac,10);AW=parseInt(AV.o,10);if(AS>=AW&&AS<=(AW+AV.rs)){delete AU.rsDelta[Ac];}});}else{this.rsDelta[AV.o]=1;}if(!this.editing&&AV.rs>1){var AQ=AV.o+1;while(AQ-AV.o<AV.rs){if(!Y(this.rhsCP,AQ,this.rs)){this.rs[AQ]=1;}AQ+=1;}}if(this.editing){var AY=this.dicGroupMap.m_x.widgetsMap[this.ko[AV.o]];if(AY){AY.set("checked",true);}}}}if(this.txar&&!AV.mark){return true;}return false;},autoRefresh:function AD(){var AO=this.zones;if(AO._BL){AO._BL.invalidAllPages();}AO._BR.invalidAllPages();this.rhsCP.invalid();this.valuesCP.invalid();p.addClass(this._STATUS,"recalculate");AO._BR.onscroll(true);this.recalculating=true;},getKeyContext:function O(AO){return this.kc[AO];},getUpdateObject:function R(){var AS=[],AQ,AT,AU,AO=this.lmr,AP,AR={};if(AO){this.lmr=null;return{manipulation:AH,actionType:(AO.v===-1)?z:w,rowOrdinal:AO.r,nodeKey:this.k,sliceId:this.sid};}AT=this.getUpdatedValues();for(AQ=0;AQ<(AT&&AT.length);AQ++){if(!AT[AQ].rowop){AU=AT[AQ];break;}}if(AU){AP=mstrmojo.string.encodeXMLAttribute(String(AU.v));if(AU.k!==undefined&&AU.vls){AR={controlKey:AU.k,elementId:AU.vls[mstrmojo.array.find(AU.vls,"v",AU.v)].eid};}if(!!AU.isMv){AS.push(j.copy(AR,{rowOrdinal:AU.o,colOrdinal:AU.co,newValue:AP,dataType:AU.dt}));}else{AS.push(j.copy(AR,{rowOrdinal:AU.o,attId:AU.atid,formId:AU.form_id,unitIndex:AU.tui||AU.ui,newValue:AP,dataType:AU.dt}));}}return{manipulation:G,nodeKey:this.k,sliceId:this.sid,cells:AS,autoRefresh:this.txar};},getUpdates:function S(){var AY=this,AT,AU,AO=AY.getUpdatedValues(),AR=this.rsDelta,AS=[],AX=[],AV=false,AQ="";AS.push('<gr rw_tree_type="'+AY.treeType+'" rw_node_key="'+AY.k+'" slice_id="'+AY.sid+'">');for(AT in AO){if(AO.hasOwnProperty(AT)){AU=AO[AT];if(!AU.rowop){var AZ=mstrmojo.string.encodeXMLAttribute(String(AU.v));if(AU.k&&AU.vls){var AP=mstrmojo.array.find(AU.vls,"v",AU.v);AQ='rw_control_key="'+AU.k+'" element_id="'+AU.vls[AP].eid+'" ';}if(!!AU.isMv){AX.push('<cli cordinal="'+AU.co+'" metric_id="'+AU.metric_id+'"><updt types="'+AU.tp+'" rordinal="'+AU.o+'" '+AQ+'value="'+AZ+'" dt="'+AU.dt+'"/></cli>');}else{AX.push('<cli ax="'+AU.ax+'" attribute_id="'+AU.atid+'" form_id="'+AU.form_id+'"><updt types="'+AU.tp+'" ordinal="'+AU.o+'" '+AQ+'value="'+AZ+'" dt="'+AU.dt+'"'+(this.mghMarks?' flags="1"':"")+"/></cli>");}AV=true;}}}if(!j.isEmpty(this.mghMarks)){var AW=this;j.forEach(this.mghMarks,function(Aa,Ab){AQ=AW.getKeyContext(Aa.k);AX.push('<mark rordinal="'+Ab+'" types="4" flags="1" attribute_id="'+AQ.atid+'" form_id="'+AQ.form_id+'"/>');});}if(AR&&!j.isEmpty(AR)){AV=true;j.forEach(AR,function(Aa,Ab){if(Aa===1){AX.push('<mark rordinal="'+Ab+'" types="4"/>');}else{AX.push('<mark rordinal="'+Ab+'" types="5"/>');}});}AS.push(AX.join(""));AS.push("</gr>");if(!AV){AS=[];}return AS.join("");},flagDirtyUnit:function a(AP){if(AP&&this.sci){if(this._super){this._super(AP);return ;}var AO=document.createElement("div"),AT,AQ=false,AS=p.getStyleValue(this.domNode,o.CSS3_TRANSFORM),AR;AO.className="flag-container";AO.innerHTML='<div class="dirty-cell"/>';if(AP.insertBefore){AP.insertBefore(AO,AP.firstChild);AR=(AO.offsetParent===AP);}AQ=mstrmojo.string.isEmpty(AS)||AS==="none";AT=AO.firstChild;AT.style.top=((!AQ||AR)?(-AO.offsetTop):(AP.offsetTop-AO.offsetTop))+"px";AT.style.left=(AP.clientWidth+((!AQ||AR)?(-AO.offsetLeft):(AP.offsetLeft-AO.offsetLeft))-8)+"px";}},clearDirtyUnit:function AM(AO){if(this._super){this._super(AO);return ;}var AP=AO.firstChild;if(AO){if(AP&&AP.className&&AP.className==="flag-container"){AO.removeChild(AP);}}},onvisibleChange:function s(){if(this.visible===true){var AO=this;setTimeout(function(){AO.configureActions();},10);}},configureActions:function U(){if(this.visible===false){return ;}var Ai="_BR",AO=this.zones[Ai],AX=!!this.zones._BL,Aa=AO.posMap,AT=AO.thPosMap,AW=this.interactiveCellsArray,Ac=this.dicGroupMap,Ab=[],AR,Ah,Ag,Af,AP,AV,Ad,AU,AQ,Am,Ak,Aj,Al=this,AY=function(An){var Ap=An.length,Ao;for(Ao=0;Ao<Ap;Ao++){Al.flagDirtyUnit(An[Ao]);}};for(AR=this.lastIndex,Ah=AW.length;AW[AR]&&AR<Ah;AR++){AP=AW[AR];AV=Aa&&Aa[AR];if(!AV&&AX){Ai=(Ai==="_BR")?"_BL":"_BR";AO=this.zones[Ai];Aa=AO&&AO.posMap;AT=AO&&AO.thPosMap;AV=Aa&&Aa[AR];}if(AV&&((AP.at&32)>0)){Ad=AO.getNodeByPosition(AV);AP.at=32;if(AP.rv==null){AP.rv=isNaN(AP.mix)?AP._e.n:AP.v;}AU=I(AP);Ak=this.getDataInputInfo(AP,AU);Aj=this.dicGroupMap[AU];if(Ak){if(!Aj){Aj=Ac[AU]=mstrmojo.DICFactory.createDICGroup({gk:AU,dic:Ak,owner:this,openerType:k});}var Ae={value:(AP.rv===undefined)?(AP.v||AP.n):(typeof AP.rv==="string"?mstrmojo.string.decodeHtmlString(AP.rv):AP.rv),dv:AP.v||AP.n,ts:AP.ts,markAll:AP.markAll,openerNode:Ad,k:AP._ei,ownerCell:AP,popupTitle:this.columnNames[AU]},AS=AO.cp.stackedRh;if(AS&&AP.singleStack&&(mstrmojo.DICConfig.showDICByDefault(Ak,1)||mstrmojo.DICConfig.hasDICPreview(Ak,1))){var AZ=Ad.offsetHeight;Ad.className+=" igDIC";Ad.style.cssText="height:"+AZ+"px;";mstrmojo.hash.copy({inlineExtraCssText:"position:absolute;top:"+parseInt(AS/2-AZ/2+1,10)+"px;"},Ae);}Aj.addDIC(AP._ei,Ae);AQ=AV.page*AO.rowsPerPage+AV.row;if(Ak.req){for(Af=0;Af<(this.editing?1:(AP.rs||1));Af++){Am=this.requiredCellsMap[AQ+Af];if(!Am){this.requiredCellsMap[AQ+Af]=Am=[];}Am.push(AP);}}if(AP.mdf){Ab.push(Ad);AE.apply(this,[AP,AQ]);}}}}this.lastIndex=AR;for(AU in Ac){Ac[AU].render();}setTimeout(function(){AY(Ab);},25);for(Ag=this.lastHeaderIndex,Ah=AT.length;Ag<Ah;Ag++){AV=AT[Ag];Ad=AO.getNodeByPosition(AV);AP=AV.obj;if(this.isEditableHeader(AP)){Ad.innerHTML='<div class="editable-column">'+Ad.innerHTML+"</div>";}}this.lastHeaderIndex=Ag;this.registerTxWidget();if(this._super){this._super();}},showPopupDIC:function A(AR){var AP=AR&&o.findAncestorByAttr(AR,"ei",true,this.viewport);if(AP){var AS=AP.node,AO=this.getCellForNode(AS),AQ=this.dicGroupMap[I(AO)];if(AQ){AQ.showPopupDIC(AO._ei);return true;}}return false;},onclick:function AG(AP){var AO=mstrmojo.dom.eventTarget(window,AP.e);if(!this.showPopupDIC(AO)&&this._super){this._super(AP);}},unrender:function D(){if(this._super){this._super();}this.destroyDICs();},destroyDICs:function t(){var AO=this.dicGroupMap;this.dicGroupMap={};setTimeout(function(){var AP;for(AP in AO){AO[AP].destroy();}},10);},checkRequiredObjects:function N(){if(this.hasRendered&&!(this.isInteractiveGrid&&this.isInteractiveGrid())&&!this.gridData.eg){var AQ=this.zones._BR,AS=AQ.posMap,AU,AR=this,AP=this.rs,AO=true,AT=function(Aa,AW){var AZ=true,AX=AR.requiredCellsMap[Aa],AV=(AX&&AX.length)||0,AY;for(AY=0;AY<AV;AY++){if(!AX[AY].mdf){p.toggleClass(AQ.getNodeByPosition(AS[AX[AY]._ei]),"required",AW);AZ=!AW;}}return AZ;};if(this.tca===J){for(AU in AP){AO=AT(parseInt(AU,10)+1,AP[AU]>0)&&AO;}}else{for(AU in this.dirtyRows){AO=AT(AU,true)&&AO;}}return AO;}return true;},editNext:function l(AQ){if(this.recalculating){return false;}var AR=this.interactiveCellsArray,AO=AR.length,AS=AQ+1,AT,AP;do{if(AS>=AO){AS%=AO;}if(AS===AQ){return false;}AT=AR[AS];var AU=this.dicGroupMap[I(AT)];if(AU){if(mstrmojo.DICConfig.isKeyNavigable(AU.dic)){if(!AU.showByDefault){AU.showPopupDIC(AS);}else{AP=AU.widgetsMap[AS];AP.focus();}return true;}}AS++;}while(true);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StickySections","mstrmojo.VisTextTooltip");var X=mstrmojo.dom,T=mstrmojo.hash,a=mstrmojo.array,I=["white","black","transparent","gray"],M="ig-selected-row";function G(){return(this.isFullScreenWidget||!this.isDocXtab);}function Z(){var AB=this.gridData,p=AB.ghs.chs;if(p.items&&p.items.length){var AC=AB.ghs.chs.items[0].items,h=AB.vp,AA=h.cols,g=AA.cg,k=AA.cws,s=g.cgc,w,q,z=false,t=[];for(w=0;w<s;w++){var l=g[w],o=-1;T.forEach(l,function(AD,j){if(/[mMiIxX]([0-9])+$/.test(j)){for(q=0;q<AC.length;q++){if(AC[q].mix==AD){l[j]=q;o++;break;}}if(AC[l[j]]===undefined||q===AC.length){delete l[j];return ;}z=true;}});if(z){var x=[];for(q=0;q<l.cl;q++){if(l["mix"+q]===undefined){x.push(q);}else{if(x.length>0){l["mix"+x.splice(0,1)]=l["mix"+q];delete l["mix"+q];}}}l.cl=++o;if(l.cl===0){t.push(w);}}else{if(!l.attForms){t.push(w);}}z=false;}for(w=t.length-1;w>=0;w--){delete g[t[w]];for(q=t[w];q<s;q++){g[q]=g[q+1];}delete g[q-1];k.splice(t[w],1);g.cgc--;}}}function C(){var z=":",x=this.gridData,g=x.gts,o=x.ghs.chs,AA=g.row,l=AA[0],p=g.col&&g.col.length>0,h={bn:"0",gr:"0",ar:"1",ct:"1",daf:l.id+z+l.fid,cols:{cws:[{w:"100"}],cg:{cgc:1}}},s=["row"],k=[g.row],w,t;if(p){s=["row","col"];k=[g.row,o.items[0].items];h.cols={cws:[{w:"50"},{w:"50"}],cg:{cgc:2}};}cg=h.cols.cg;for(w=0,t=cg.cgc;w<t;w++){var j=s[w],q;cg[w]={tg:true,cl:k[w].length,cc:0,sh:true};if(j==="col"){for(q=0;q<k[w].length;q++){cg[w]["mix"+q]=k[w][q].mix;}}else{cg[w].attForms=[];for(q=0;q<k[w].length;q++){cg[w].attForms[q]={idx:q,n:""};}}}this.gridData.vp=h;}function E(l,h){var p,j,g,o,k=function(x,AA,z){var s,w,t=AA[x+"Sibling"],q;if(t){for(s=0,w=t.cells.length;s<w;s++){q=t.cells[s];if((x==="next"&&/stack-bottom/.test(q.className))||(x==="previous"&&/stack-top/.test(q.className))){z.push(t);return ;}}z.push(t);k(x,t,z);}};h.push(l);for(j=0,g=l.cells.length;j<g;j++){p=l.cells[j];o=p.className;if(/stack/.test(o)){if(/stack-top/.test(o)){k("next",l,h);break;}else{if(/stack-bottom/.test(o)){k("previous",l,h);break;}else{if(/stack-middle/.test(o)){k("next",l,h);k("previous",l,h);break;}}}}}return h;}function f(g){a.forEach(g,function(h){mstrmojo.css.addClass(h,M);});}function F(){var g=T.copy(document.getElementsByClassName(M));a.forEach(g,function(h){mstrmojo.css.removeClass(h,M);});}function W(j){var l=X.findAncestorByAttr(j,"ei",true,this.domNode),h=l&&l.node,g=this.getCellForNode(h);if(h&&h.className.indexOf("iggroup")>0){return true;}if(this.isInteractiveGrid()&&this.igToggle(g)){return true;}if(!g){return true;}if(X.contains(this._BR,j)){F();var k=X.findAncestorByName(j,"tr",true);if(X.contains(this._BR,k)){f(E(k,[]));}}return false;}mstrmojo._IsInteractiveGrid=mstrmojo.provide("mstrmojo._IsInteractiveGrid",{_mixinName:"mstrmojo._IsInteractiveGrid",cssClass:"mstrmojo-InteractiveGrid",enableMagnifier:false,scrollerConfig:{scrollPast:false},isInteractiveGrid:function(){return(this.gridData.vp&&this.gridData.vp.cols)?true:false;},preBuildRendering:function D(){if(this.gridData.eg){return this._super();}if(!this.isInteractiveGrid()){C.call(this);}Z.call(this);var k=this,j=this.parent,g=function(o){k[o]=k[o]||((j&&j[o])?j[o]:480);};g("height");g("width");var l=isNaN(this.gridData.vp.ct)?1:parseInt(this.gridData.vp.ct,10);this.cssClass="mstrmojo-InteractiveGrid "+I[l];this.scrollboxNodeOverflow="overflow:hidden;";var h=(this._super?this._super():true);this.cssDefault=(this.cssDefault==="")?"r-cssDefault":"";return h;},getKey:function O(){return this.gridData.k;},renderChildren:function S(){this.prepareCWSCalculation();if(this._super){this._super();}this.createStickySections();var j=this.zones._BR,h=j.hiliteCellsMap,k={},g=[];T.forEach(h,function(l,o){a.forEach(l.pos,function(p){j.clearHilites(o);k[p.row]=p.row;});});if(!T.isEmpty(k)){T.forEach(k,function(l){g.push(j.domNode.firstChild.rows[l]);});f(E(g[0],[]));}},useDomToCalculateOffsets:function Q(){var g=this.zones._BR.cp;if(g&&(g.groupEnabled||g.stackLevels>1)){return true;}else{return(this._super||this._super())||false;}},prepareCWSCalculation:function U(){var g=this.getFormats&&this.getFormats(),h=(!G.call(this))?parseInt(g.width,10):parseInt(this.width,10);this.zones._BR.cp.gridWidth=h;this.zones._TR.cp.gridWidth=h;},createStickySections:function J(){var q=this.gridData,p=this.getFormats&&this.getFormats();if(this.isInteractiveGrid()&&(q.vp.gr==="1"&&q.gts.cws.length>1)){mstrmojo.requiresCls("mstrmojo.StickySections");var j=this._TR,k="stickySections";this.addSlots({stickySections:j});if(!this.ss){var s=this.zones._BR.cp.getResolvedGroupHeader(0,0),t="iggroup xtab-td",o={320:-52},l=o[mstrMobileApp.getDeviceDPI()]||-33,g=(!G.call(this))?(parseInt(p.width,10)+"px"):"100%",h="width: "+g+";z-index: 2; position: relative;margin-bottom:"+l+"px;";this.ss=new mstrmojo.StickySections({currentSectionTitle:s.n||s.v,cssClass:t,slot:k,cssText:h});this.addChildren(this.ss);}}},performAction:function V(g){return W.call(this,g&&g.target)||(this._super&&this._super(g));},igToggle:function L(AA){if(!this.isInteractiveGrid()||!AA){return false;}var s=AA&&AA._e,AB=(AA&&AA.otp)||(s&&s.otp);if(AB){var p,k,x=this.gridData.vp.cols,h=x.cg,AC=AA.mix,z=4,o=12,w=function(j,AF){var AI=false;if(j.tg&&j.cl>1){var AE=j.cc,AK=j.cc,AD=0,AG=j.cl,AJ=j.cc=(++AK>=(AG+AD))?AD:AK,AH=[this._TR.getElementsByTagName("COLGROUP")[0],this._BR.getElementsByTagName("COLGROUP")[0]];a.forEach(AH,function(AM){var AL=AM.childNodes[AF+AE].style.width;AM.childNodes[AF+AE].style.width="0";AM.childNodes[AF+AJ].style.width=AL;});AI=true;}return AI;},g,l,q=0,t=false;if(AA&&AA.otp===o){for(p=0;p<h.cgc;p++){g=h[p];l=g.attForms;if(l){for(k=0;k<g.cl;k++){if(l[k]&&(l[k].idx===(AA.ci||AA.ui))){t=w.call(this,g,q);}}}q+=g.tg?g.cl:1;}}else{if(s&&s.otp===z){for(p=0;p<h.cgc;p++){g=h[p];if(g["mix"+g.cc]===AC){t=w.call(this,g,q);}q+=g.tg?g.cl:1;}}}return t;}return false;},getHACP:function B(){var g=(this.isInteractiveGrid())?new mstrmojo.InteractiveGridHACP():this._super();g.onDemandIF=!!(this.onDemandIF&&this.gridData.rw);return g;},onheightChange:function K(){if(G.call(this)&&this.scrollboxNode){this.scrollboxNode.style.height=(parseInt(this.height,10)-this._TR.clientHeight)+"px";}if(this._super){this._super();}},onwidthChange:function N(){if(G.call(this)){var g=this.width;if(this.hasRendered){this.unrender();this.width=g;this.render();}}else{if(this._super){this._super();}}},defaultAction:function H(j,g){var h=false;if(this._super){h=this._super(j,g);}this.model.sti=null;return h;},onclick:function d(g){if(!mstrApp.isTouchApp()){var h=g.e;return W.call(this,X.findAncestorByName(h.target,"td",true))||(this._super&&this._super(g));}},touchSelectBegin:function A(p){var k=p;var g=mstrmojo.dom.findAncestorByName(p.target,"td",true,this.domNode);var h=this.hasImgTag(g);var j=mstrmojo.dom.findAncestorByAttr(p.target,"trType",true,this.domNode);if(g&&j&&!h){var o=this.getTextWidth(g,g.className);if(o>g.offsetWidth-30){if(!this.visTextTooltip){var l=document.createElement("div");this.domNode.appendChild(l);this.visTextTooltip=new mstrmojo.VisTextTooltip({placeholder:l,targetDiv:g,boundary:this.domNode,touchAreaType:j.value});this.visTextTooltip.render();this.visTextTooltip.updateContent(g,j.value,g.innerText);}else{this.visTextTooltip.targetDiv=g;this.visTextTooltip.touchAreaType=j.value;this.visTextTooltip.updateContent(g,j.value,g.innerText);}}}},touchSelectEnd:function R(h){var g=h;if(this.visTextTooltip&&this.visTextTooltip.domNode){this.visTextTooltip.toggle(false);}},hasImgTag:function P(g){var k=g&&g.childNodes.length>0&&g.childNodes[0];if(k&&k.nodeName.toLowerCase()==="div"){var h=k.childNodes.length>0&&k.childNodes[0];if(h&&h.nodeName.toLowerCase()==="div"){var j=h.childNodes.length>1&&h.childNodes[1];if(j&&j.nodeName.toLowerCase()==="img"){return true;}}}return false;},getTextWidth:function b(j,p,h,w,k,q){var s=j.childNodes;var t=null,g=null;if(s.length>0&&s[0].nodeName.toLowerCase()==="#text"){t=document.createElement("table");g=document.createElement("td");t.appendChild(g);}else{if(s.length>0&&s[0].nodeName.toLowerCase()==="span"){g=document.createElement("span");g.style="z-index:-10;visibility:hidden;-webkit-text-size-adjust: none;";}else{return -1;}}if(g.className!==p||""){g.className=p||"";}if(g.style.fontFamily!==h||""){g.style.fontFamily=h||"";}var l=k||"pt";if(w){g.style.fontSize=w+l;}else{g.style.fontSize="";}if(q){if(g.style.fontWeight!=="bold"){g.style.fontWeight="bold";}}else{if(g.style.fontWeight!==""){g.style.fontWeight="";}}g.innerHTML=j.innerText;var o=-1;if(t){this.domNode.appendChild(t);o=g.offsetWidth-30;this.domNode.removeChild(t);}else{this.domNode.appendChild(g);o=g.offsetWidth;this.domNode.removeChild(g);}return o;},unrender:function Y(g){if(this.visTextTooltip&&this.visTextTooltip.destroy){this.visTextTooltip.destroy();delete this.visTextTooltip;}var h=this.ss;if(h){this.removeChildren(h,true);h.destroy();delete this.ss;}this._super(g);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo.dom");var Q=1;var W=2;var X=0;var A=1;var AD=2;var M=3;var L=1;var AF=2;var G=4;var g=8;var b=mstrmojo.dom,w;function AJ(AK){var AL=null;if(AK&&AK.length>1){AL=new mstrmojo.XtabVACP();AL.cps=AK;}return AL;}function P(AL){var AK=document.createElement("img");AL.appendChild(AK);AL.removeChild(AK);}function I(AL,AK){if(b.isIE){return mstrmojo.boxmodel.convert2px(AL,AK);}return AK;}function H(AL){if(!AL||this._onDemandCP){return ;}var AS=AL.bc,AQ=AL.tc,AM=AQ-AS,AR=Math.ceil(AM/AS),AN=[],AP=[],AO;for(AO=0;AO<AR;++AO){var AK=Math.min(AM,AS);AN.push(this.createOnDemandCP(AO+1,AK,G));AP.push(this.createOnDemandCP(AO+1,AK,g));AM-=AS;}this._onDemandCP={rhs:AN,vls:AP};return this._onDemandCP;}mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasScrollbox,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",handleClicks:function F(){return true;},markupString:'<div id="{@id}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div>&nbsp;</div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart><table cellspacing="0" cellpadding="0"><tr trType="title"><td style="vertical-align:top;padding:0px"></td><td class="xtab-tr" style="vertical-align:top;padding:0px;"></td></tr><tr trType="content"><td class="xtab-bl" style="vertical-align:top;padding:0px;"></td><td class="xtab-br" style="vertical-align:top;padding:0px"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_TL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];},_TR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[1];},_BL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[0];},_BR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_T_ROW:function(){return this.domNode.lastChild.firstChild.rows[0];},_B_ROW:function(){return this.domNode.lastChild.firstChild.rows[1];},_BR_CELL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1];},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.firstChild.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zones:null,lockHeadersCase:M,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function q(AK){return(AK.o!==undefined)?AK.o:AK._ei;},getCellTitleId:function d(AK){var AL="";if(AK.axis&&AK.ui!==undefined){AL=AK.axis+"A"+(AK.ui+1);}else{if(AK.mix!==undefined){AL="0A"+AK.mix;}}return AL;},update:function l(AL){if(this._super){this._super(AL);}this.set("gridData",AL.data[0]||AL.data);var AK=this.defn||AL.defn;this.sid=this.gridData.sid;this.treeType=(AK&&AK.tt)||1;this.interactiveCellsArray=[];},initCP:function D(AM,AL,AR,AO,AQ,AN,AP){var AK={gridData:AM,type:AR,interactiveCellsArray:AL};AK.base=AO||AK.base;AK.lookupBase=AQ||AK.lookupBase;AK.axis=AN||AK.axis;if(!AP){if(AR===L){AP=new mstrmojo.XtabTitlesCP(AK);}else{AP=new mstrmojo.XtabCP(AK);}}else{mstrmojo.hash.copy(AK,AP);}return AP;},preBuildRendering:function B(){var AK=this.gridData;this.lockHeadersCase=parseInt(AK.lhv,10);this.selections={};this.cssDefault=(this.lockHeadersCase===X||!this.k)?"":"r-cssDefault"+(this.k?"_"+this.k:"");this.numRowFixed=!!(!this.height&&AK.rw&&AK.rw.row&&(AK.rw.row.bc<AK.rw.row.tc));this.rw=AK.rw;this._onDemandCP=null;if(this.width){this.widthLimit=parseInt(this.width,10);}if(this.height){this.heightLimit=parseInt(this.height,10);}return(this._super)?this._super():true;},renderEmptyGrid:function x(){var AM=this.gridData,AL=this.msgNode,AK=this.viewport;AL.firstChild.innerHTML=AM.eg;AL.style.display="block";AL.style.overflow="hidden";AL.className="mstrmojo-message";AK.style.display="none";return(this._super)?this._super():true;},postBuildRendering:function s(){var AS=this.gridData,AO=!!this._BR&&AS,AK=this.msgNode,AP=this.viewport,AQ;if(AS.eg===undefined){if(AK.style.display==="block"){AK.style.display="none";AP.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AO){this._setupZones(AS);this._setupCPs(AS);var AN=this.zones,AL;for(AL in AN){var AR=AN[AL];if(AR.parent!==this){this.addChildren(this.zones[AL]);}}if(this.scrollboxNode){var AM=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AM)&&(AM>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AM;}this.scrollboxLeft=this.scrollboxTop=0;if(this.lockHeadersCase){this.connectScrollbox(this);}}}this.renderChildren();AQ=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zones._BR.getPageHeight(0)+(this._TR?this._TR.offsetHeight:0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if((this.lockHeadersCase&&AO&&this.scrollboxNode)||this.numRowFixed){this.resizeScrollBox(b.isIE);}this.onGridWidthChanged(true);if(b.isIE7&&!this.scrollboxHeightFixed&&this.scrollboxNode&&this.scrollboxNode.scrollWidth>this.scrollboxNode.offsetWidth){this.scrollboxNode.style.height=this.scrollboxNode.offsetHeight+17+"px";}return AQ;},onclick:function t(AO,AL){if(!this.interactiveCellsArray.length){this.isSelectingText=false;return ;}AO=AO.e||AO;var AM=mstrmojo.dom,AP=AM.eventTarget(AL,AO),AN=AP&&AM.findAncestorByName(AP,"td",true,this.viewport);if(AP.nodeName.toLowerCase()==="a"&&AN.getAttribute("ei")){try{var AQ=this.interactiveCellsArray[parseInt(AN.getAttribute("ei"),10)];var AK=7;if(AQ&&AQ.ts===AK){AP.href=mstrmojo.addCSRFTokenToURL(AP.href);}}catch(AS){}}if(AN){var AR=AM.findAncestorByName(AP,"span",true,AN);if(AR&&!AM.shiftKey(AL,AO)&&!AM.ctrlKey(AL,AO)){this.defaultAction(AN);}else{this.doSelection(AO,AL,AN);if(!this.isSelectingText){AM.clearBrowserHighlights();}}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function h(AL,AK){this.onclick(AL,AK);},onselectstart:function z(){this.isSelectingText=true;return false;},onscroll:function AA(){this._alignHeaders();},resizeScrollBox:function J(AM){var AK=this.scrollboxNode,AV=AK&&AK.style,Ab=this._B_ROW,Aa=this._BR_CELL;if(!AV||!Ab||!Aa){return ;}var AU=this.widthLimit,AT=this.heightLimit;if(!AU||!AT){if(!AU){AV.width="auto";}if(!AT){AV.height="auto";this.scrollboxHeightFixed=false;}}if(AT){var AS=(this.zones._TR&&this.zones._TR.cp.rc)?Ab.offsetTop:0,AX=AT-AS;if(AX>0){AV.height=AX+"px";this.scrollboxHeight=AX;this.scrollboxHeightFixed=true;if((this.lockHeadersCase!==X)&&this.numRowFixed){this.viewport.style.height=this.overlayNode.style.height=(AX+AS)+"px";}}}if(!this.useTouchScrolling){var AL=(this.zones._BL&&this.zones._BL.cp.rc)?Aa.offsetLeft:0;var AZ=0;if(this.lockHeadersCase!==X){var AY=this.viewport,AN=mstrmojo.css.getComputedStyle(AY),AW=["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"];if(AN){mstrmojo.array.forEach(AW,function(Ac){AZ+=parseFloat(I(AY,AN[Ac]));});}if(this.width){this.viewport.style.width=(parseFloat(this.width)-(AZ||0))+"px";}}var AO=(this.widthLimit&&(this.widthLimit-AL))||(mstrmojo.dom.isIE7?Aa.scrollWidth+1:(Aa.scrollWidth+(AK.offsetWidth-AK.clientWidth)));if(AO&&(AO>0)){AO-=AZ;AV.width=AO+"px";}this._alignHeaders(AM);}var AR=AV.height,AQ=AV.width;if(AR||AQ){var AP=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection);if(AP){AP.fixedSizeCanGrowShrink(this,AR,AQ);}}},_resizeScrollBoxWidth:function U(){var AP=this.scrollboxNode,AM=AP&&AP.style,AL=this._B_ROW,AK=this._BR_CELL;if(this.useTouchScrolling||!AM||!AL||!AK){return ;}var AN=this.widthLimit;if(!AN){AM.width="auto";}var AO=function(){var AQ=(mstrmojo.dom.isIE7?AK.scrollWidth+1:(AK.scrollWidth+(AP.offsetWidth-AP.clientWidth)));if((AQ&&(AQ>0))&&(!AN||(AN&&(AQ<AN)))&&(AP.firstChild.firstChild.offsetWidth>=AP.clientWidth)){AM.width=AQ+"px";}};if(mstrmojo.dom.isIE7){window.setTimeout(function(){AO();},1);}else{AO();}},onGridWidthChanged:function Z(AM){if(this.lockHeadersCase===X&&!AM){this._resizeScrollBoxWidth();}var AL=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AK=this.widthLimit;if(!AK){this.width=w;if(AL){AL.performCanGrowCanShrink([this],true);}}else{if(AL){AL.fixedSizeCanGrowShrink(this,null,AK);}}},getGridDimension:function R(AN){var AL=1,AM=AN===AL?"Height":"Width",AO=AM.toLowerCase(),AK=this[AO+"Limit"];if(!AK&&(this[AO]===w||this[AO]===0)){AK=this.viewport["offset"+AM];this[AO]=AK+"px";return AK;}return AK||parseInt(this[AO],10);},_alignHeaders:function p(AL){if(this.lockHeadersCase===X||this.useTouchScrolling){return ;}var AO=this.scrollboxLeft,AN=this.scrollboxTop,AM=this.zones,AK=AM._TR,AP=AM._BL;function AQ(AR,AV,AS){var AU=AR&&AR.domNode,AT=AU&&AU.style;if(!AT){return ;}AT[AV]=-AS+"px";}if(AK&&AK.rc){AQ(AK,"left",AO);}if(AP&&AP.rc){AQ(AP,"top",AN);}if(AL){P(this._BL);}},defaultAction:function S(AP,AL){var AK=AL||this.getCellForNode(AP),AO=AP&&AP.className.indexOf("sc_")>0,AN=this.model.getAction(this.getActionCells(AK),AP,AO),AM=AN&&AN.h;this._currentSelectedTD=AP;if(AM&&this.controller[AM]){this.controller[AM](this,AN.a);return true;}return false;},createZone:function o(AK){return new mstrmojo.XtabZone(AK||{});},_setupZones:function k(AN){var AL=this.zones;this.zones={};var AP=this.zones,AK=this.lockHeadersCase,AR="z-index:";var AM=this;function AQ(AV,AU,AW,AT){var AS=(AT&&AT[AW])||AM.createZone({renderMode:AV,cssText:AU,slot:AW});AP[AW]=AS;AS.rh=AN.rh;}AQ(this.dataRenderMode,AR+"1;","_BR",AL);if(AK&A){AQ(this.dataRenderMode,AR+"3;","_BL",AL);}if(AK&AD){AQ(null,AR+"3;","_TR",AL);}if(AK===M){AQ(null,AR+"4;","_TL",AL);}if(AK===X){this.zones._BR.autoFitWindow=!!AN.afw;this.zones._BR.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}if(mstrmojo.dom.isIE7){if(AK&A||AK&AD||AK===M){this._T_ROW.style.display="block";}else{if(AK===X){this._T_ROW.style.display="none";}}}var AO=AP._BL||AP._BR;if(AO){AO.numColumnCanMerge=AN.gts.cws.length-1;}},getHACP:function AI(){return(this._super&&this._super())||new mstrmojo.XtabHACP();},_setupCPs:function V(AS){var AN=this.titlesCP=this.getTitleCP(AS),AP=this.chsCP=this.getColumnHeadersCP(AS),AL=this.rhsCP=this.getRowHeadersCP(AS),AM=this.valuesCP=this.getValuesCP(AS);AN.forceAutoRowHeight=AP.forceAutoRowHeight=AS.rh;var AQ=this.zones;switch(this.lockHeadersCase){case X:var AW=new mstrmojo.XtabVACP();var AK=this.getHACP();AK.cps=[AN,AP];AW.cps=[AK];var AU=this.getHACP();AU.cps=[AL,AM];AW.cps.push(AU);AQ._BR.cp=AW;break;case A:var AT=new mstrmojo.XtabVACP();var AO=new mstrmojo.XtabVACP();AT.cps=[AN,AL];AO.cps=[AP,AM];AQ._BL.cp=AT;AQ._BR.cp=AO;break;case AD:var AR=this.getHACP();var AV=this.getHACP();AR.cps=[AN,AP];AV.cps=[AL,AM];AQ._TR.cp=AR;AQ._BR.cp=AV;break;case M:AQ._TL.cp=AN;AQ._TR.cp=AP;AQ._BL.cp=AL;AQ._BR.cp=AM;break;}},ongridDataChange:function Y(){var AK=this.model;if(AK){AK.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:mstrmojo.emptyFn,getTitleCP:function E(AK){return this.initCP(AK,this.interactiveCellsArray,L);},getColumnHeadersCP:function AE(AK){return this.initCP(AK,this.interactiveCellsArray,AF,AK.ghs.chs,AK.gts.col,W);},getRowHeadersCP:function AG(AK){var AL=this.initCP(AK,this.interactiveCellsArray,G,AK.ghs.rhs,AK.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AL].concat(this._onDemandCP.rhs);return AJ(this.rhsCPList)||AL;}return AL;},getValuesCP:function a(AL){var AK=this.initCP(AL,this.interactiveCellsArray,g,AL.gvs);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AK].concat(this._onDemandCP.vls);return AJ(this.valuesCPList)||AK;}return AK;},createOnDemandCP:function f(AL,AM,AK){var AN=new mstrmojo.XtabOnDemandCP();AN.dataSource=this;AN.blockNum=AL;AN.rc=AM;return AN;},dataDownloaded:function T(AM,AP){var AR=AP.blockNum,AK=this.rhsCPList[AR],AN=this.valuesCPList[AR],AQ=AM.data;AQ._bidx=AR;this.dataBlocks[AR]=AQ;if(!AK||!AN){return ;}this.initCP(AQ,this.interactiveCellsArray,G,AQ.ghs.rhs,AQ.gts.row,Q,AK);this.initCP(AQ,this.interactiveCellsArray,g,AQ.gvs,null,null,AN);AK.initContent();AN.initContent();this.numRowsDownloaded+=parseInt(AK.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AO=this.zones,AL=AO&&AO._BL,AS=AO&&AO._BR;if(AL){AL.dataDownloaded();}if(AS){AS.dataDownloaded();}},showDownloadStatus:function O(AK){if(!AK){return ;}if(this.showingStatus){this.numRowsToDownload+=AK;}else{this.numRowsToDownload=AK;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function j(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function K(AM){var AO=this.gridData.rw,AL=AO.row,AN=AO.col,AK=AL.bc;this.rhsCPList[AM].isDownloading=this.valuesCPList[AM].isDownloading=true;if(AK){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AM*AK+1,AK,AN.bb,AN.bc,this.id,{blockNum:AM}));}},unrender:function C(AK){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AK);},getCellForNode:function AC(AM){var AK=AM&&AM.getAttribute("ei");if(isNaN(AK)){return null;}var AL=this.interactiveCellsArray[parseInt(AK,10)];return AL;},getActionCells:function N(AK){var AL=[],AN=this.selections;var AO=AK.axis+"A"+(AK.ui+1),AP=AN[AO],AM;if(AP&&AP[AK.o]){for(AM in AP){var AQ=this.getCellForNode(AP[AM][0]);AL.push(AQ);}}else{AL.push(AK);}return AL;},setModel:function AH(AK){this.model=AK;if(AK.data){this.set("gridData",AK.data);}},destroy:function AB(){var AK=this.model;if(AK&&AK.destroy){AK.destroy();}this._super();}});}());(function(){var E=1;var B=2;var J=4;var F=8;function D(L,K){var M=L.rw;if(!M){return false;}return K?(M.row.bb+M.row.bc<M.row.tc):(M.wsr+M.wmr<M.tr);}mstrmojo._XtabSeamlessIncrementalFetch=mstrmojo.provide("mstrmojo._XtabSeamlessIncrementalFetch",{_mixinName:"mstrmojo._XtabSeamlessIncrementalFetch",useSeamlessIncFetch:true,preBuildRendering:function G(){var K=true;if(this._super){K=this._super();}if(this.useSeamlessIncFetch){this.currentPageNum=0;this.currentPageNum=this.loadingPageNum=0;this.endFetching=!D(this.gridData,this.isDocXtab);}},aggregateCP:function H(N,M,K){var O=(M===J)?this.rhsCP:this.valuesCP;if(O.scriptClass!=="mstrmojo.XtabVACP"){O=mstrmojo.hash.clone(O);var L=new mstrmojo.XtabVACP();L.cps=[O,N];mstrmojo.hash.copy(L,(M===J)?this.rhsCP:this.valuesCP);}else{O.cps.push(N);}if(K){K.cp.initContent();}},onScrolledToLastRow:function C(){if(this.useSeamlessIncFetch){var L=this.currentPageNum,K=this.loadingPageNum;if(K<=L&&!this.endFetching){this.loadingPageNum=L+1;this.download(1+L);}}},download:function A(N){var P=this.gridData.rw,M=P.row,O=P.col,L=M.bc;this._isDownloading=this.rhsCP.isDownloading=this.valuesCP.isDownloading=true;if(L){var K={blockNum:N};this.controller.onDownloadGridData(this,this.model.getDownloadAction(N*L+1,L,O.bb,O.bc,this.id,K));}},dataDownloaded:function I(N,T){if(this._isDecelerating){this._cachedDownload={node:N,memo:T};return ;}var P=this._cachedDownload;if(P){if(N){alert("Missed download");}N=P.node;T=P.memo;delete this._cachedDownload;}var U=N.data,S=this.zones;this._firstRowHeight=this._firstRowHeight||this.contentNode.rows[0].offsetHeight;var M=this.initCP(U,this.interactiveCellsArray,J,U.ghs.rhs,U.gts.row,E),O=this.initCP(U,this.interactiveCellsArray,F,U.gvs);this.aggregateCP(M,J,S._BL);this.aggregateCP(O,F,S._BR);var L=M.startIndexInContainer,Q=L+M.rc-1;var R=function(V){if(V){V.start=L;V.end=Q;V.renderGrid(true);}};var K=this.id;window.setTimeout(function(){var V=mstrmojo.all[K];R(S._BL);R(S._BR);if(!D(U,V.isDocXtab)){V.endFetching=true;}V.setOffsets();V.currentPageNum++;V._isDownloading=false;},0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._CanSupportOfflineTransactions","mstrmojo._CanMakeServerProxyRequests","mstrmojo.MobileConfiguration","mstrmojo.OfflineTransactionModel","mstrmojo.dom","mstrmojo.hash","mstrmojo.android.EnumOrientationTypes");mstrmojo.requiresDescs(6828,9419);var M=mstrmojo.dom,N=mstrmojo.hash;var X=[],s={},V={},S;function AF(AH,AK,AL){if(!AH||AH.handledError){return ;}var AJ=[],AI={title:"",message:mstrmojo.desc(6828)+" ",sourceURL:"Source URL: ",fileName:"File: ",lineNumber:"Line: ",line:"Line: "};N.forEach(AI,function(AM,AN){if(AH[AN]!==undefined){AJ.push(AM+AH[AN]);if(AN==="title"){AJ.push("");}}});if(AH.getResponseHeader){AJ.push("XHR: "+AH.getResponseHeader("X-MSTR-TaskFailureMsg"));}AJ=AJ.join("\n");if(AK){AK.hideMessage();}if(AJ.length){mstrmojo.alert(AJ,AL);AH.handledError=true;mstrmojo.dbg(AH.stack||AJ);}}function a(AH,AI,AJ){if(AH instanceof String){AF({message:AH,fileName:AI,lineNumber:AJ});}}var L=mstrmojo.android.AndroidApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._CanMakeServerProxyRequests,mstrmojo._CanSupportOfflineTransactions],{scriptClass:"mstrmojo.android.AndroidApp",serverProxy:null,isMobile:true,handledCompatibilityError:false,init:function AA(AI){this._super(AI);var AH=window.onerror;window.onerror=AH?mstrmojo.func.composite([a,AH]):a;this.handleError=AF;},start:function U(){this.started=true;var AL=mstrMobileApp;AL.setTaskServletName(mstrConfig.taskURL);var AJ=this.getConfiguration(),AK=AJ.getDiagnosticMode();AL.setDiagnosticMode(AK);this.diagnosticMode=AK;this.useBinaryFormat=AJ.getBinaryMode();mstrmojo.DPIManager.setDPI();mstrApp.oflnTxModel=new mstrmojo.OfflineTransactionModel();var AI=this.rootView=this.viewFactory.newView("Root",{id:"rootView",placeholder:this.placeholder});var AH=this.rootController=this.controllerFactory.newController("Root",{id:"rootController",rootView:AI});AI.controllerId=AH.id;AI.render();AH.start();window.setTimeout(function(){mstrMobileApp.getTitleBarHeight(mstrApp.rootView.getTitleHeight());},0);},restart:function AD(){var AH=this.rootController;if(AH){AH.restart();}else{this.start();}},onMobileDevice:function F(){return mstrConfig.onMobileDevice;},isTouchApp:function R(){return(M.isIPad||M.isAndroid||mstrApp.onMobileDevice())&&!M.isWinPhone;},isLandscape:function AE(){return(mstrMobileApp.getOrientation()===mstrmojo.android.EnumOrientationTypes.LANDSCAPE);},getConfiguration:function q(){if(!this._cfg){this._cfg=new mstrmojo.MobileConfiguration();}return this._cfg;},isTablet:function t(){return mstrMobileApp.isTablet();},isMicroTablet:function l(){if(S===undefined){S=false;if(this.isTablet()){var AI=this.getScreenDimensions(),AH=700;S=(AI.h<AH||AI.w<AH);}}return S;},goBack:function I(){if(this.cancelPending(true)){return true;}var AI=false;N.forEach(V,function(AK,AM){var AL=mstrmojo.all[AM];if(AL){AL.set("visible",false);AI=true;}});V={};if(AI){return true;}var AH=X.length;if(AH){var AJ=X[AH-1];if(AJ.goBack){if(AJ.goBack()){return true;}}if(this.closeDialog()){return true;}}return(this.rootController&&this.rootController.goBack())||mstrMobileApp.goBack();},doSearch:function W(){},menuShown:function D(){},registerListener:function(AH,AK,AJ){var AI=s[AH]||[];AI.push({t:AK,f:AJ});s[AH]=AI;},unregisterListener:function(AI,AK){var AJ=s[AI],AH=AJ&&AJ.pop();if(!AH||AH.t!==AK){window.alert("Unregister Search listener out of order.");if(AJ&&AH){AJ.push(AH);}}},getListener:function(AI,AK){var AJ=s[AI],AH=AJ&&((AJ.length)?AJ[AJ.length-1]:null);return((AH&&AH.t===AK)?AH:null);},cancelPending:function x(AH){this.hideMessage();var AI=this.serverProxy;if(AI){if(AI.cancelRequests()){return true;}}return AH?false:this.closeDialog();},onerror:function f(AH,AI){AF(AH,this,AI);},showMessage:function b(AH){if(this.rootView){this.rootView.showMessage(AH);}},showHTMLProgress:function O(AH){if(this.rootView){this.rootView.showHTMLProgress(AH);}},hideMessage:function AB(){if(this.rootView){this.rootView.hideMessage();}},hideHTMLProgress:function o(){if(this.rootView){this.rootView.hideHTMLProgress();}},showToastNotification:function T(AI,AH){mstrMobileApp.toast(AI,AH);},displayHelp:function z(){var AH=mstrMobileApp.displayHelp();if(AH){mstrApp.onerror({message:AH});}},isDialogUp:function g(){return(X.length>0);},showDialog:function Y(AI,AK){mstrMobileApp.showPopupDialog();AI.scriptClass=AI.scriptClass||"mstrmojo.android.Dialog";var AH=mstrmojo.func.wrapMethods(AI,{onClose:function(){mstrMobileApp.closePopupDialog();X.pop();}});var AJ=AK?this.viewFactory.newView(AK,AH):mstrmojo.insert(AH);X.push(AJ);AJ.render();window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);return AJ;},showPopup:function G(AH,AI){AH.scriptClass=AH.scriptClass||"mstrmojo.android.Popup";if(AI){AH.anchor=AI;}return this.showDialog(AH);},closeDialog:function Z(){if(X.length){X[X.length-1].close();return true;}return false;},closeAllDialogs:function h(){var AI=X.slice(0),AH=AI.pop();while(AH){AH.close();AH=AI.pop();}X=[];},setMenuStatus:function k(AI,AH){if(AH){V[AI]=true;}else{delete V[AI];}},setCurrentProjectId:function K(AH){this._currentProjId=AH;},getCurrentProjectId:function P(){return this._currentProjId;},getSessionState:function j(AH){return this.serverProxy.getSession(AH||this._currentProjId);},getContentDimensions:function p(AH){return this.rootView.getContentDimensions(AH);},getContentPosition:function Q(){var AH=this.getContentDimensions();return{x:0,y:this.rootView.getTitleHeight(),w:AH.w,h:AH.h};},getScreenDimensions:function AC(){var AH=String(mstrMobileApp.getScreenDimensions()).split("|");return{h:parseInt(AH[0],10),w:parseInt(AH[1],10)};},getResSetStore:function d(){return mstrMobileApp.getResSetStore(this.getCurrentProjectId());},getResSetStoreMgr:function A(){return mstrMobileApp.getResSetStoreMgr();},removeProjectCaches:function AG(AH){if(this.getConfiguration().getCacheEnabled()){this.getResSetStoreMgr().removeProjectCaches(AH);}},getLocaleInfo:function H(AH){AH=AH||this._currentProjId;return this.serverProxy.getLocaleInfo(AH);},onConnectivityChanged:function E(AI){var AH=mstrmojo.publisher;AH.publish(AH.NO_SRC,AH.CONNECTIVITY_CHANGED_EVENT,AI);if(AI){this.submitOfflineTransaction();}this.rootController.generateActionToolbar();},onReconcileEnd:function J(){var AH=mstrmojo.publisher;AH.publish(AH.NO_SRC,AH.RECONCILE_END_EVENT,null);if(mstrMobileApp.isOnline()){this.submitOfflineTransaction();}},handleCompatibilityError:function w(){if(!this.handledCompatibilityError){this.handledCompatibilityError=true;if(!this.isHosted()){mstrmojo.toast(mstrmojo.desc(9419,"The version of this app is incompatible with one or more of the MicroStrategy Mobile Server(s). Please update the app to a more recent version."));}}},hasOpenDialog:function C(){return X.length>0;},isHosted:function B(){return mstrMobileApp.isProxy;}});L.$PF=function(AJ,AI,AH){mstrMobileApp[(AJ?"enter":"exit")+"JavaScriptMethod"](new Date().getTime(),AH||arguments.callee.caller.name,AI);};window.$MAPF=L.$PF;}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ResultSetView","mstrmojo.dom");var F="100%";mstrmojo.android.medium.ui.ResultSetView=mstrmojo.declare(mstrmojo.android.ui.ResultSetView,null,{scriptClass:"mstrmojo.android.medium.ui.ResultSetView",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"><div class="mstrmojo-ResultSetView-content"></div><div class="mstrmojo-ResultSetView-toolbar"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},toolbarNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{containerNode:F,toolbarNode:"auto"},w:{containerNode:F,toolbarNode:F}},children:[{scriptClass:"mstrmojo.android.ui.ActionToolbar",slot:"toolbarNode",alias:"toolbar",fullscreenDirection:"down"}],rootOrientationChange:function H(){this.controller.generateActionToolbar();},delegateToolbar:function C(M){var O=mstrmojo.android.ui.ActionToolbar.newToolbarConfig(),L=1,K=Math.round(mstrMobileApp.getDeviceDPI()/63)+1,N=false,J=this.controller;if(!mstrApp.isLandscape()&&this.controller.canDelegateToolBar()){M.minBtnCount=L;M.maxBtnCount=K;O=M;J.toolBarDelegated=true;N=true;}else{J.toolBarDelegated=false;}this.toolbar.setActions(this.controller.id,O);this.doLayout();return N;},setActionToolbarStatus:function B(J){this.toolbar.set("active",J);},enterFullScreen:function A(){this.toolbar.enterFullScreen();this._super();},exitFullScreen:function E(J){if(this.domNode){this.toolbar.exitFullScreen(J);this._super(J);}},flashFullScreen:function G(){this.toolbar.flashFullScreen();},cancelFlashFullScreen:function D(){this.toolbar.cancelFlashFullScreen();},getPosition:function I(){var J;if(this.containerNode){J=mstrmojo.dom.position(this.containerNode);}return J;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DateTimePicker","mstrmojo.ui.MobileStepper","mstrmojo._TouchGestures");var A="mstrmojo.ui.MobileStepper";mstrmojo.ui.MobileDateTimePicker=mstrmojo.declare(mstrmojo.DateTimePicker,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.ui.MobileDateTimePicker",stepperClass:"mstrmojo.ui.MobileStepper",onclick:function(B){this.touchTap(B.e);},touchTap:function(B){if(B.target===this.meridiemNode){this.set("meridiem",!this.meridiem);this.updateTime();}},touchBegin:function(B){if(B.target==this.meridiemNode){mstrmojo.css.addClass(B.target,"glow");}},touchEnd:function(B){if(B.target==this.meridiemNode){mstrmojo.css.removeClass(B.target,"glow");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebConstantPrompt","mstrmojo.prompt.WebGeoConstantPrompt","mstrmojo.prompt.WebElementsPrompt","mstrmojo.prompt.WebUnsupportedPrompt","mstrmojo.XMLBuilder");mstrmojo.prompt.WebPrompts=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.prompt.WebPrompts",lcl:1033,host:null,mergeGeoPrompts:true,init:function I(K){var L=K.rsl;delete K.rsl;this._super(K);this.populate(L);},get:function(K){var L=this.prompts;if(L&&K<L.length){return L[K];}else{alert("index is out of boundary.");}},size:function J(){var K=this.prompts;return K&&K.length||0;},isEmpty:function E(){return !this.prompts||!!this.prompts.length;},validate:function G(){var L=this.prompts;for(var K=0;K<L.length;K++){L[K].validate();}return true;},populate:function F(N){var K=N&&N.prompts,R=mstrmojo.prompt.PromptTypes,Q=this.mergeGeoPrompts,P;this.lcl=N&&N.lcl||this.lcl;this.prompts=[];if(K){for(var M=0;M<K.length;M++){var O=K[M];switch(O.ptp){case R.CONSTANT_PROMPT:var L=new mstrmojo.prompt.WebConstantPrompt();L.populate(O);if(Q&&L.prs&&L.prs.DisplayStyle=="GeoLocation"){if(!P){P=new mstrmojo.prompt.WebGeoConstantPrompt();P.title="Current Location";P.add(L);L=P;}else{P.add(L);continue;}}break;case R.ELEMENTS_PROMPT:var L=new mstrmojo.prompt.WebElementsPrompt();L.populate(O);break;default:var L=new mstrmojo.prompt.WebUnsupportedPrompt();L.populate(O);}this.prompts.push(L);}}},populateAnswers:function A(M){var K=this.prompts,L;for(L=0;L<M.length;L++){K[L].populateAnswer(M[L]);}},buildAnswerObject:function B(){var K=[];for(var L=0;L<this.size();L++){var M=this.prompts[L];K.push(M.buildAnswerObject());}return K;},prepareAnswer:function(L){var M=this.prompts,K=function(Q,O,P){var N=Q.length;Q[O].prepareAnswer({success:function(){if(O<N-1){K(Q,O+1,P);}else{if(P&&P.success){P.success();}}},failure:function(){if(P&&P.failure){P.failure();}}});};if(M&&M.length>0){K(this.prompts,0,L);}},getAnswerXML:function C(){var K=new mstrmojo.XMLBuilder();this.buildShortAnswerXML(K);return K.toString();},buildShortAnswerXML:function H(K){K=K||new mstrmojo.XMLBuilder();K.addChild("rsl");K.addAttribute("lcl",this.lcl);for(var L=0;L<this.size();L++){var M=this.prompts[L];M.buildShortPa(K);}K.closeElement();},hasSupported:function D(){for(var K=0;K<this.size();K++){var L=this.prompts[K];if(L.supported()){return true;}}return false;}});mstrmojo.prompt.PromptTypes={CONSTANT_PROMPT:1,CONSTANT_GEO_PROMPT:1.5,ELEMENTS_PROMPT:2,OBJECT_PROMPT:4};mstrmojo.Enum={};mstrmojo.Enum.Validation={};mstrmojo.Enum.Validation.STATUSCODE={VALID:0,INVALID_DATATYPE:1,EXCEEDS_MIN_VALUE:2,EXCEEDS_MAX_VALUE:3,EXCEEDS_MIN_LENGTH:4,EXCEEDS_MAX_LENGTH:5,EXCEEDS_MIN_COUNT:6,EXCEEDS_MAX_COUNT:7,INVALID_ANSWERS:8,NO_INPUT:9,NO_PERSONAL_ANSWER_NAME:10,INCOMPLETE_CONDITION:11,TRUNCATED:12,INCOMPLETE_CONDITION_ON_AUTO_NODE:13,INVALID_PERSONAL_ANSWER_NAME:14,DUPLICATED:15,INVALID:999};})();(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompts");var D="mstrmojo._ResultSetXt",G=0,Q=1,F=2,N=3,H=4;var U=["promptsAnswerXML","elementsPromptAnswers","valuePromptAnswers","objectsPromptAnswers"];function A(X){if(X.linkAnswers){return true;}var V=U.length,W;for(W=0;W<V;W++){if(X[U[W]]){return true;}}return false;}function C(V){if((!V)||(V.status===undefined)||(isNaN(V.status))){return G;}switch(parseInt(V.status,10)){case 0:case 1:return Q;case 2:return N;case 3:return F;default:return H;}}function L(Z,V,d){var X=d.success;delete d.success;var b=mstrApp,a=!!Z.useRefreshProgress,Y=a?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:[],W;delete Z.useRefreshProgress;d.success=function(f,g){switch(C(f)){case Q:case N:case G:X(f,g);break;case F:d.failure(f);break;case H:var h;d.success=function(k,l){var j=C(k);switch(j){case Q:case N:X(k,l);break;case G:case H:W();break;default:k.message="Error checking the status of running report/document.";d.failure(k);break;}};W=function(){b.serverRequest({taskId:"pollStatus",msgID:f.id},d,{src:D+"::pollForResult"});};W();break;}};b.serverRequest(Z,d,{src:D+"::pollForResult",showProgress:V,hideProgress:!V,hideWait:!V,useRefreshProgress:a,progressStateText:Y});}function I(X,Z,V,Y){var W=this;L.call(this,X,V,{success:function(a){W.msgId=a.id;if(a.visName){W.visName=a.visName;}var b=C(a);if(b===N){if(Z.prompts){W.loadPrompts({success:Z.prompts,failure:Z.failure});}else{Z.failure({message:"Wrong status. Received Prompts while expected Result."});}}else{if(Z.execSuccess){Z.execSuccess(a);}if(Y&&Y.statusOnly){Z.success(a);}else{if(W.visName&&W.visName!==""){if(!Y){Y={};}Y.colsPerPage=-1;Y.rowsPerPage=-1;}W.getResults(Y,{success:Z.success,failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn,canceled:Z.canceled||mstrmojo.emptyFn});}}},failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn,canceled:Z.canceled||mstrmojo.emptyFn});}function B(W,X){var V=mstrApp.modelFactory;if(V){return V.newPromptsModel(W,X);}return mstrApp.viewFactory.newPrompts(W,X);}mstrmojo._ResultSetXt=mstrmojo.provide("mstrmojo._ResultSetXt",{_mixinName:"mstrmojo._ResultSetXt",msgId:null,execute:function J(X,Z,Y){if(X.link){X.linkAnswers=X.link.toXml();delete X.link;}var W=this,V=mstrmojo.func.addMethods(Z,{prompts:function(a){W.prompts=a;Z.prompts(a);},success:function(a){if(a.prompt){W.prompts=a.prompt;}Z.success(a);}});if(!W.prompts&&A(X)){V.success=function(a,b){delete b.config.hideWait;delete b.config.hideProgress;W.loadPrompts({success:function(d){if(d.prompts){W.prompts=d;W.answers=B(d).buildAnswerObject();}Z.success(a,b);},failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn},{includeClosed:true});};}else{if(X.promptsAnswerXML){V.success=function(a,b){W.prompts=null;W.answers=null;W.loadPrompts({success:function(d){if(d.prompts){W.prompts=d;W.answers=B(d).buildAnswerObject();}Z.success(a,b);},failure:mstrmojo.emptyFn});};}}I.call(this,X,V,true,Y);},answerPrompts:function P(V,Y,X){if(mstrApp.useBinaryFormat){X.objectType=55;}X.taskId="answerPrompts";X.msgID=X.msgId||this.msgId;X.promptAnswerXML=V.getAnswerXML();var W=this;I.call(this,X,{success:function(Z){W.answers=V.buildAnswerObject();Y.success(Z);},prompts:Y.prompts,failure:Y.failure},true);},getResults:function R(V,W){V.messageID=V.msgId||this.msgId;L.apply(this,[V,false,W]);},loadPrompts:function O(W,V){V.taskId="getPrompts";V.msgID=V.msgID||this.msgId;L.apply(this,[V,false,W]);},linkToObject:function K(V,W){this.execute(V,W);},getPrompts:function E(){var V=this.prompts;if(V){return B(this.prompts,this.answers);}return undefined;},checkCache:function T(X,Y,W){var V=mstrmojo.hash.copy(W,{src:D+"::checkCache",override:false,silent:true});X.taskId="checkCache";mstrApp.serverRequest(X,Y,V);},checkCachedLinkTargets:function S(V,X){var W={taskId:"checkCachedLinkTargets",items:V};mstrApp.serverRequest(W,X,{src:D+"::checkCachedLinkTargets",override:false,silent:true});},urlLinkParams:function M(){return U;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo._HasLayout","mstrmojo._SupportsEllipsisText","mstrmojo.date","mstrmojo.string","mstrmojo.num","mstrmojo.hash","mstrmojo.expr","mstrmojo.StringBuffer","mstrmojo.android.ui.ElementsSearchBar","mstrmojo.GeoLocation","mstrmojo.android.ui.Button","mstrmojo.android.ui.TextInput","mstrmojo.ui.MobileSlider","mstrmojo.MobileCalendar","mstrmojo.android.ui.Calendar","mstrmojo.android.ui.ElementsPicker","mstrmojo.android._HasLingeringListSelections","mstrmojo.locales.datetime","mstrmojo.prompt.WebPrompt","mstrmojo.ui.MobileDateTimePicker","mstrmojo.ui.MobileReviewList","mstrmojo.array","mstrmojo.BarcodeReader","mstrmojo.string");mstrmojo.requiresDescs(189,221,1442,6149,8382,8383,8384,8397,8761);var d=mstrmojo.date,O=mstrmojo.desc,P=mstrmojo.prompt.WebPrompt.STYLES,Y=mstrmojo.prompt.WebPrompt.TYPES,H=mstrmojo.num,AB=mstrmojo.android.ui.Button.newButton,R=mstrmojo.hash,j=mstrmojo.array,B=mstrmojo.dom.CSS3_TRANSITION_DURATION,Q=mstrmojo.expr,U={160:10,213:10,240:15,320:20};var a="<em>*</em>",L="item-icon",N="main-btn",q="item-btn",AF="Barcode",T="GeoLocation";var G={};var V=' onclick="mstrmojo.all.{@wid}.clickStepper({@idx}, false);"',z=V.replace("false","true");function AD(AH,AG,AI){try{AH.setAnswerValue.apply(AH,AI);}catch(AJ){mstrmojo.alert(AJ.message||AJ);return false;}this.updateItem(AG);return true;}function Z(AI,AH){var AG=[],AJ=[];j.forEach(AI,function(AK){AG[AK.v]=AK;AJ.push(AK);});j.forEach(AH,function(AK){if(AG[AK.v]){return ;}AJ.push(AK);});return AJ;}function S(AI,AM){var AH=[],AG=AM.length,AL=0,AK=0,AN=0,AJ=AI.length;for(AL=0;AL<AJ;AL++){for(AK=AN;AK<AG;AK++){if(AI[AL].v===AM[AK].dssid){AH.push(AM[AK]);AN=AK+1;break;}}}return AH;}function AE(AL,AO,AT,AR,AM,AQ,AU,AH){var AS=this,AP={title:O(9755,"Prompt Values")},AJ=[],AI,AK,AN,AV,AG=function(){AP.children=AJ;AI=function(){if(AN.deleteAction){var Aa,AY=0,AX;var AZ=[].concat(AO);for(AX in AV.selectedIndices){Aa=parseInt(AX,10)-AY++;AT.splice(Aa,1);AZ.splice(Aa,1);}AV.set("items",AZ);AO=AZ;AV.set("height","auto");AN.resizeDialog();AN.setDeleteActions("done");return false;}AD.call(AM,AU,AQ,[Z.call(this,AU.answer.items||[],AV.items)]);AN.close();};AK=function(){AN.close();mstrmojo.BarcodeReader.readBarcodes({attributeID:AL.browseElements.source.did,searchForms:AU.prs.LookupForm,multiSelect:AH},AS,null,S(AV.items,AT),AR);};var AW=AB(O(8473,"Done"),AI);AW.alias="deleteBtn";AP.buttons=[AB(O(221,"Cancel"),AK),AW];AN=mstrApp.showDialog(AP);AN.setDeleteActions=function(AX){if(AX==="delete"){this.selectionHidden=false;this.deleteAction=true;this.titleNode.lastChild.style.display="block";this.btnHbox.deleteBtn.set("text",O(629,"Delete"));mstrmojo.css.removeClass(AV.domNode,"hidden");}else{this.selectionHidden=true;this.deleteAction=false;this.titleNode.lastChild.style.display="none";this.btnHbox.deleteBtn.set("text",O(8473,"Done"));}};AN.updateTitleBarButtonClass=function(AX){AN.titleNode.lastChild.className="mstrmojo-Editor-titlebar-button "+AX;};AN.createTitleBarButton("mstrmojo-Editor-titlebar-button btnCheckSemi",function(){AV.selectAll();});AN.setDeleteActions("done");return AN;};AV=new mstrmojo.ui.MobileReviewList({controller:this.controller,isElastic:true,multiSelect:true,itemIdField:"v"});AP.useMenu=false;AJ.push(AV);AV.set("items",AO);AG();}function D(){return(this._clkTarget.className===L);}function I(AJ,AI,AG){var AH=AJ.prs;return(AJ.getStyle()===AI||(AH&&AH.DisplayStyle===AG));}function h(AG){if(I(AG,P.BARCODE,AF)||I(AG,P.GEO,T)){return(D.call(this))?q:N;}return"";}function g(AG){if(parseInt(AG.promptType,10)===Y.ELEMENTS_PROMPT&&AG.answer){return" ("+AG.getAnswersCount()+")";}return"";}function l(AI,AP){var AR=this.items[AP];if(AR.isTtl){return ;}var AQ=AI.firstChild.childNodes,AH=AQ[0],AG=AQ[1],AJ=!!AR.req,AO=g(AR),AN=this.ellipsisText,AM;if(AJ){AH.innerHTML=a+AH.innerHTML.replace(a,"");}var AL=this.ellipsize("h3",AH,false);if(AJ){AM=AH.innerHTML.replace(a,"");AH.innerHTML=AL?AM.replace(AM.slice(-1),a+AN):AM+a;}var AK=this.ellipsize("h4",AG,true);if(AK&&AO){AG.innerHTML=mstrmojo.string.trim(AG.innerHTML.slice(0,-(AO.length+3)))+AN+AO;}}function o(AG){var AH=["prompts-dialog"];if(mstrApp.isTablet()&&mstrApp.isLandscape()){AH.push("prompts-landscape");}if(AG){AH.push(AG);}return AH.join(" ");}function AA(AG){var AH=this.id;return R.copy(AG,{cssClass:o(),onClose:function(){var AI=mstrmojo.all[AH];AI.parent.closePrompt();AI.clearSelect();}});}function f(AI,AJ,AH,AL,AG,AM){AI.children=AJ;var AK=[];if(!AG){AK.push(AB(O(221,"Cancel")));}if(AL){AK.push(AB(O(1442,"OK"),AL));}AI.buttons=AK;if(mstrApp.isTablet()){AI.anchor=this._getItemNode(AH);AI.anchorOrientation="h";AI.autoClose=true;AI.anchorOffset=U[mstrMobileApp.getDeviceDPI()];}this.parent.openPrompt(function(){mstrApp.showDialog(AI,AM);});}function x(AH,AG){var AI=this.id;mstrmojo.BarcodeReader.readBarcodes(null,{success:function(AK){if(AH.promptType===Y.CONSTANT_PROMPT&&AH.dataType===mstrmojo.mstr.EnumDataType.DataTypeBigDecimal){var AJ=mstrApp.getLocaleInfo();AK=AK.substr(0,1)+((AJ&&AJ.number.DECIMALSEPARATOR)||".")+AK.substr(1);}if(!AD.call(mstrmojo.all[AI],AH,AG,[AK])){return false;}},failure:function(AJ){AH.setError(AJ);mstrmojo.all[AI].updateItem(AG);}});}function M(AI,AG){var AJ=this.id,AH="plTxtInputxz";f.call(this,AA.call(this,{title:AI.title}),[{scriptClass:"mstrmojo.android.ui.TextInput",id:AH,alias:"textInput",textValue:AI.getDisplayValue(false,false)||"",onEnter:function(AK){if(!AD.call(mstrmojo.all[AJ],AI,AG,[AK])){return ;}mstrApp.closeDialog();}}],AG,function(){if(!AD.call(mstrmojo.all[AJ],AI,AG,[mstrmojo.all[AH].getValue()])){return false;}});}function X(AR,AO){var AJ=this.id,AK=AR.answer.items||[],AL=AR.getAvailable(),AP=I(AR,P.BARCODE,AF),AI=D.call(this),AM=AR.prs,AH=(AR.max===""||parseInt(AR.max,10)>1)&&AM.DisplayStyle!=="Option button",AG=AM.SearchRequired,AN=AG&&AG!=="0";AL.concat=true;var AQ=function(){var AU=mstrmojo.all[AJ];if(AP&&AI){mstrmojo.BarcodeReader.readBarcodes({attributeID:AL.source.did,searchForms:AR.prs.LookupForm,multiSelect:AH},{success:function(AZ){var AY=JSON.parse(AZ),AW=AL.convertElems(AY.items);if(AY.review){var AX=new mstrmojo.android.ui.ElementsPicker({isElastic:true,itemIdField:"v",multiSelect:true});AX.set("browseElements",AL);AX.addSelectedItems(AW);AE.call(this,AX,AW,AY.items,AY.displayKeypadView,AU,AO,AR,AH);}else{AD.call(AU,AR,AO,[Z.call(this,AK,AL.convertElems(JSON.parse(AZ).items))]);}}});}else{var AT=new mstrmojo.android.ui.ElementsPicker({isElastic:true,itemIdField:"v",multiSelect:AH});AT.set("browseElements",AL);AT.addSelectedItems(AK);var AV=new mstrmojo.android.ui.ElementsSearchBar({slot:"titleNode",target:AT,browseElements:AL,searchForms:AP?AR.prs.LookupForm:undefined,searchRequired:AN,canSearch:AR.canSearch(),title:AR.title});var AS=function(){var AX;if(AH){AX=function(){AT.syncSelection();return AD.call(AU,AR,AO,[AT.getSelectedItems()]);};}else{var AW=AT.singleSelect;AT.singleSelect=function(AY,AZ){AW.call(this,AY,AZ);if(AY!=-1&&!AZ){AD.call(AU,AR,AO,[AT.getSelectedItems()]);this.parent.close();return true;}};}f.call(AU,AA.call(AU,{title:O(6149,"Select Elements"),cssClass:o("edtElementPicker"),goBack:function(){return AV.goBack();}}),[AV,AT],AO,AX,false);};if(I(AR,P.GEO,T)&&AI){AR.getGeoTargetValue({success:function(AW){var AX=AR.searchTarget,AY=AV.search.box;AV.initSearchValue=AW;AV.canSearch=true;if(AX){AV.initSearchValue='in "'+AW+'"';AV.searchTarget=AX;AY.searchValue=AW;}AS();}});}else{AS();}}};if(AL.browseConfig){AL.getItems(1,{success:AQ});}else{AQ();}}function w(AM,AG){var AK=AA.call(this,{title:AM.title,cssClass:o("edtSlider")}),AH=AM.getDisplayValue(true,false),AJ=new mstrmojo.Label({text:AH,cssClass:"value"}),AI=new mstrmojo.Label({text:AM.mn,cssClass:"title"}),AN=this.id;var AL=new mstrmojo.ui.MobileSlider({value:H.parseNumeric(AH),max:AM.max,min:AM.min,interval:AM.interval,onvalueChange:function(){AJ.set("text",H.toLocaleString(this.value));},onslidingValueChange:function(){AJ.set("text",H.toLocaleString(this.slidingValue));},onRender:function(){this.parent.attachEventListener("resizeCurtain",this.id,this.resize);}});f.call(this,AK,[AJ,AI,AL],AG,function(){if(!AD.call(mstrmojo.all[AN],AM,AG,[String(AL.value)])){return false;}});}function AC(AP,AO,AL){var AI=AA.call(this,{title:AP.title}),AJ=mstrmojo.date,AN=mstrmojo.locales.datetime,AQ=AP.answer,AK=AP.min,AM=AP.max,AG=new mstrmojo.ui.MobileDateTimePicker({value:AJ.parseDateAndOrTime(AQ||""),min:AJ.parseDateAndOrTime(AK||""),max:AJ.parseDateAndOrTime(AM||""),minuteInterval:AP.interval,hideSwitchers:AL==Q.DTP.DATE,dtp:AL||Q.DTP.TIMESTAMP}),AH=this.id;f.call(this,AI,[AG],AO,function(){var AR=AG.getDateTime(),AU=AR&&AR.date,AW=AR&&AR.time,AS=(AU&&AJ.formatDateInfo(AU,AN.DATEOUTPUTFORMAT))||"",AV=(AW&&AJ.formatTimeInfo(AW,AN.TIMEOUTPUTFORMAT))||"",AT=[AS+" "+AV];if(AP.promptType===Y.ELEMENTS_PROMPT){AT=[AT];}if(!AD.call(mstrmojo.all[AH],AP,AO,AT)){return false;}});}function b(AP,AO){var AM={alias:"calendar"},AN=AP.max,AG=this.id,AI,AH,AL=false,AK=this.parent.domNode,AJ=R.copy(AA.call(this,{cssClass:o()}),{targetListHeight:AK.clientHeight,targetListWidth:AK.clientWidth});switch(AP.promptType){case Y.CONSTANT_PROMPT:AL=true;break;case Y.ELEMENTS_PROMPT:if(1===parseInt(AN,10)){AL=true;break;}AJ.title=O(8383,"Select Dates");AM.min=d.parseDate(AP.prs.LocalizedMinDate||"");AM.max=d.parseDate(AP.prs.LocalizedMaxDate||"");AM.selectedDates=AP.getAnswerAsDateArray();AM.isMultiSelect=true;AI=function(){try{AP.setAnswerValue(AH.getSelectedDates());}catch(AQ){mstrmojo.alert(AQ.message||AQ);return false;}AP.syncDateAnswer({success:function(){mstrApp.closeDialog();var AR=mstrmojo.all[AG];AR.updateItem(AO);AD.call(AR,AP,AO,[AH.getSelectedDates()]);},failure:function(AR){window.setTimeout(function(){mstrmojo.alert(AR);},0);}});return false;};break;default:throw new Error(O(8397,"Error: Unknown prompt type."));}if(AL){AC.call(this,AP,AO,Q.DTP.DATE);}else{AH=new mstrmojo.android.ui.Calendar(AM);f.call(this,AJ,[AH],AO,AI,false,"CalendarDialog");}}function F(AH,AG){var AI=this.id;mstrmojo.confirm(O(8384,'"MicroStrategy" Would Like to use Your Current Location.'),[AB(O(221,"Cancel")),AB(O(1442,"OK"),function(){mstrmojo.GeoLocation.getCurrentLocation({success:function(AL,AJ,AK){AD.call(mstrmojo.all[AI],AH,AG,[AL,AJ]);},failure:function(AJ){AH.setError(AJ);mstrmojo.all[AI].updateItem(AG);}});})]);}function J(AH,AG){AH.toggleSwitch();this.updateItem(AG);}var t={};t[P.BARCODE]=x;t[P.TEXT]=M;t[P.LIST]=X;t[P.SLIDER]=w;t[P.CALENDAR]=b;t[P.TIME]=AC;t[P.GEO]=F;t[P.SWITCH]=J;mstrmojo.android.ui.PromptsList=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo._SupportsEllipsisText,mstrmojo.android._HasLingeringListSelections],{scriptClass:"mstrmojo.android.ui.PromptsList",listHooks:{select:function(AI,AJ,AG){var AH=h.call(this,AJ);if(AH){mstrmojo.css.addClass(AI,AH);}AI.style[B]=0;this.setClearHandler(200);},unselect:function(AI,AJ,AG){var AH=h.call(this,AJ);if(AH){mstrmojo.css.removeClass(AI,AH);}AI.style[B]="300ms";}},getItemMarkup:function(AI){if(AI.isTtl){return'<div class="item {@cls}" idx="{@idx}">{@ttl}</div>';}var AH=AI.getStyle(),AL=I(AI,P.GEO,T)||I(AI,P.BARCODE,AF),AJ=AH+String(AI.req)+(AL?"ic":""),AG=G[AJ];if(!AG){var AK=new mstrmojo.StringBuffer();AK.append('<div class="item {@cls}" idx="{@idx}"><div><h3>{@ttl}'+a+"</h3><h4>{@val}</h4>");if(AH===P.STEPPER){AK.append('<div class="step"><div'+V+"></div><div>{@v}</div><div"+z+"></div></div>");}else{if(AL||AH===P.SWITCH){AK.append('<div class="'+L+'"><div></div></div>');}}AG=G[AJ]=AK.toString()+"</div></div>";}return AG;},getItemProps:function k(AK,AG){var AJ=this._super(AK,AG);AJ.ttl=AK.title;if(AK.isTtl){AJ.addCls("ttl");return AJ;}var AI=AK.getStyle(),AL=(AI===P.STEPPER||AI===P.SWITCH),AH=AK.getDisplayValue(AL,AL);if(I(AK,P.BARCODE,AF)){AJ.addCls("bar");}else{if(I(AK,P.GEO,T)){AJ.addCls("geo");}}AJ.wid=this.id;AJ.val=AH||"";AJ.addCls("st"+AI);if(AK.req){AJ.addCls("req");}switch(AI){case P.STEPPER:if(!AK.canStepUp()){AJ.addCls("max");}if(!AK.canStepDown()){AJ.addCls("min");}AJ.v=AH;AJ.val=AK.mn||"";break;case P.SWITCH:AJ.val=AK.mn||"";if(AH){AJ.addCls("on");}break;case P.GEO:if(!AK.displayLoc){AK.getDisplayLocation(this,AH);}break;}if(AJ.val){AJ.addCls("has-ans");}return AJ;},updateItem:function p(AG){l.call(this,this._super(AG),AG);},allowTouchBubble:false,onRender:function C(){if(this._super){this._super();}var AG=this.itemsContainerNode.childNodes,AI=AG.length,AH;for(AH=0;AH<AI;AH++){l.call(this,AG[AH],AH);}},clickStepper:function E(AG,AH){this.items[AG]["step"+(AH?"Up":"Down")]();this.updateItem(AG);},postselectionChange:function A(AH){var AJ=AH.added;if(!AJ){return ;}var AG=AJ[0],AK=this.items[AG],AI=AK.getStyle();if(AI===P.BARCODE&&!D.call(this)){AI=P.TEXT;}var AL=t[AI];if(AL){AL.call(this,AK,AG);}},rootOrientationChange:function K(){this.refresh();},touchSelectBegin:function W(AM){var AG=this.getItemIdxTouch(AM);if(AG>-1){var AJ=this.items[AG],AH=AJ.getStyle(),AL=[];var AI=AJ.mn||"";if(AI){AL.push(AI);}if(!(AH===P.SWITCH)&&!(AH===P.STEPPER)){var AK=AJ.getDisplayValue(false,false);if(AK){AL.push(AK);}}if(AJ.req){AL.push(O(475,"This prompt is required and must be answered."));}if(AL.length){mstrmojo.alert(AL.join("<br /><br />"),null,O(189,"Details"));}return false;}return true;},touchTap:function s(AG){var AH=this.items[this.getItemIdxTouch(AG)];if(AH&&AH.isTtl){return ;}this._clkTarget=AG.target;this._super(AG);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileDateTimePicker","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.date","mstrmojo.expr","mstrmojo.locales");mstrmojo.requiresDescs(2052,2170,7656);var C=mstrmojo.date,H=mstrmojo.desc,D=5,G=6,A=mstrmojo.expr.DTP;mstrmojo.android.inputControls.DateTimePickerDIC=mstrmojo.declare(mstrmojo.ui.MobileDateTimePicker,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.DateTimePickerDIC",cssText:"",valueField:"dtValue",popupTitle:"",init:function F(I){var J=I.dic;if(J.min!==undefined){I.min=C.parseDateAndOrTime(J.min);}if(J.max!==undefined){I.max=C.parseDateAndOrTime(J.max);}I[this.valueField]=C.parseDateAndOrTime(I.value);if(J.t===D){I.dtp=J.ict?A.TIMESTAMP:A.DATE;I.popupTitle=J.ict?H(7656,"Date and Time"):H(2052,"Date");}else{if(J.t===G){I.dtp=A.TIME;I.minuteInterval=I.dic.itv;I.popupTitle=H(2170,"Time");}}this._super(I);},getCurValue:function B(Q){var N=this[this.valueField]||{},M=this.getDate()||N.date||{year:1970,month:1,day:1},L=this.getTime()||N.time||{hour:0,min:0,sec:0},K=this.dic,J=parseInt(K.dt,10),P=mstrmojo.locales.datetime,O=P.TIMEOUTPUTFORMAT,I=P.DATEOUTPUTFORMAT,S=C.formatDateInfo(M,I),R=C.formatTimeInfo(L,O);if(Q){if(K.t===D){return K.ict?(S+" "+R):S;}return R;}if(J===A.TIMESTAMP){return S+" "+R;}if(J===A.TIME){return R;}return S;},renderPreview:function E(){this.renderPreviewButton(this.openerNode,this.getCurValue(true));}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.SelectBoxList","mstrmojo.array");mstrmojo.android.controllers._HasSelectBoxDialog=mstrmojo.provide("mstrmojo.android.controllers._HasSelectBoxDialog",{_mixinName:"mstrmojo.android.controllers._HasSelectBoxDialog",showSelectBoxDialog:function A(C,F,D){var B=D.children=[{scriptClass:"mstrmojo.android.ui.SelectBoxList",isElastic:true,items:C,selectListChange:function(G,H){if(!F.call(this,G,H)){mstrApp.closeDialog();}}}][0];if(C.length===1){var E=C[0];C=E.items;D.title=E.n;B.scriptClass="mstrmojo.ui.MobileCheckList";B.items=C;B.multiSelect=false;B.selectedIndex=mstrmojo.array.find(C,"on",true);B.postselectionChange=function(G){this.selectListChange(0,C[G.added[0]]);};}mstrApp.showDialog(D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TxEditDoc","mstrmojo.android.medium.ui.TxActionButtons","mstrmojo.css","mstrmojo.array");mstrmojo.android.medium.ui.TxEditDoc=mstrmojo.declare(mstrmojo.android.ui.TxEditDoc,null,{scriptClass:"mstrmojo.android.medium.ui.TxEditDoc",layoutConfig:{h:{typeNode:"auto",txNode:"100%",btmNode:"auto"},w:{typeNode:"100%",txNode:"100%",btmNode:"100%"}},addChildren:function A(E,C,D){E=E.concat([{scriptClass:"mstrmojo.android.medium.ui.TxActionButtons",alias:"btns",cssClass:"btns",slot:"btmNode"}]);this._super(E,C,D);},enableButtons:function B(C){this.btns.set("enabled",C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ViewSwitcher","mstrmojo.android.ui.TxDocList","mstrmojo.android.large.ui.TxEditDoc","mstrmojo.OfflineTransactionModel","mstrmojo.hash","mstrmojo.css");mstrmojo.requiresDescs(9249,9753);var C=mstrmojo.hash,H=mstrmojo.css;var E=mstrmojo.OfflineTransactionModel,K=E.PENDING,B=E.FAILED;var F=mstrmojo.desc(9753,"Transactions");function A(O){var Q=this._editDocView;if(!Q){Q=this._editDocView=mstrApp.viewFactory.newView("TransactionsEditDoc",{model:this.model});}else{Q.set("docID",null);}this.switchView(Q);this.disposables.push(Q);Q.set("docID",O.v);var P=O.n;if(this.controller.isAllTransactionLevel()){P="<em>"+F+"</em>"+P;}this.setTitle(P);}function G(){this.enableButtons(false);var R=this.model,P=(R&&R.docsTx)||{},Q=[],T=this.id;if(C.isEmpty(P)){N.call(this);return ;}C.forEach(P,function(W,V){var U=W[K]||[],X=W[B]||[];Q.push({n:W.name,v:V,c:U.length+X.length,desc:W.p.pn});});this.dirty=false;var O=this._docList;if(!O){O=this._docList=new mstrmojo.android.ui.TxDocList({cssClass:"docList",items:Q,postselectionChange:function(U){var V=U.added;if(V){A.call(mstrmojo.all[T],this.items[V[0]]);}}});this.disposables.push(O);}else{O.set("items",Q);}this.switchView(O);this.setTitle(F);var S=this._editDocView;if(S){S.set("docID",null);}}function N(){var O=this._docList=new mstrmojo.Label({cssClass:"txtEmpty",text:mstrmojo.desc(9249,"No pending or failed transactions")});this.disposables.push(O);this.switchView(O);this.enableButtons(false);}mstrmojo.android.ui.TransactionView=mstrmojo.declare(mstrmojo.android.ui.ViewSwitcher,null,{scriptClass:"mstrmojo.android.ui.TransactionView",context:null,model:null,controller:null,dirty:true,init:function L(O){this._super(O);H.addWidgetCssClass(this,"mstrmojo-TxView");},onRender:function M(){var P=function(){var R=this.model,Q=(R&&R.docsTx)||{},S=this.context;if(C.isEmpty(Q)){N.call(this);return ;}if(S){A.call(this,{v:S.id,n:S.n});}else{G.call(this);}};if(!this._txListener){var O=this._txListener=this.model.attachEventListener("recordChanged",this.id,function(){this.dirty=true;P.call(this);});this.disposables.push(O);}P.call(this);},deleteRecord:function J(){var Q=this._editDocView,P=(Q.getType()===0),O=Q.getSelectedTx(),R=this.id;this.controller.deleteTransactionRecord(Q.docID,P,O.v,{success:function(T){var S=mstrmojo.all[R];S.dirty=true;Q.generateTypeList();Q.setType((P||!T.length)?0:1);}});},editRecord:function D(){var P=this._editDocView,O=P.getSelectedTx();this.controller.editTransactionRecord(P.docID,(P.getType()===0),O.v);},enableButtons:mstrmojo.emptyFn,setTitle:mstrmojo.emptyFn,goBack:function I(){if(!this.controller.isAllTransactionLevel()){return false;}var O=this.getCurrentView();if(!O||O===this._docList){return false;}G.call(this);return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.controllers._SupportsQueuedTransactions","mstrmojo.android.controllers._HasFolderView","mstrmojo.android.EnumMenuOptions","mstrmojo.publisher","mstrmojo.array");mstrmojo.requiresDescs(773,8386,8388);var P=mstrmojo.array,M=mstrmojo.desc,U=mstrmojo.android.EnumMenuOptions,V=U.REFRESH;function B(){var a=this._requests;return a[a.length-1];}function Y(f,d,g){var b=this,a=this.view;f.csp=this.csp;g=g||{};this.dataService.getData(f,{success:function(h){a.set("items",h.items);if(d){B.call(b).res=h;}else{b._requests.push({p:f,res:h});}var j=g.success;if(j){j.call(b,h);}},failure:function(h){b.viewFailed(h);},canceled:function(){var h=g.canceled;if(h){h.call(b);}}},d);}function S(a){var b=B.call(this);b.orientation=mstrApp.isLandscape();b.idx=a;b.origin=this.view.getScrollPos();b.hasState=true;}function I(){var a=this.view;if(a&&!mstrApp.isTablet()){a.clearSelect();}}function D(a){var d=a.st,b={ttl:a.n,st:d,did:a.did,ab:a.ab,rtf:a.rtf};this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(d),b),b);}function K(f){if(!f.hasState){return ;}var b=this.view,g=(mstrApp.isTablet()&&f.orientation!==mstrApp.isLandscape()),a=f.idx,d={x:0,y:0};if(!g){d=f.origin;}b.restoreListState(a,d);b.items=f.res.items;b.refresh();if(g){b.scrollToItem(a);}}function X(a){var g=this._requests;if(a!==undefined){if(g.length<=a+1){return false;}g.splice(a+1);}else{g.pop();}var d=B.call(this);if(!d){return false;}K.call(this,d);var b=this.rootCtrl,f=d.res;b.updateFolder(null,f.n);b.contentUpdated(2048);this.updatePropertiesMsg();return true;}mstrmojo.android.controllers.FolderController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,[mstrmojo.android.controllers._SupportsQueuedTransactions,mstrmojo.android.controllers._HasFolderView],{scriptClass:"mstrmojo.android.controllers.FolderController",start:function H(b){this._super(b);this.ctrlType=2048;this.dataService=mstrApp.modelFactory.newDataService("Folder");this._requests=[];var a=this.initFolderView();Y.call(this,b,false,{success:function(f){if(b.systemFolder===7){f.n=b.n||b.txt;}var d=this.rootCtrl;d.updateFolder(this.view,f.n);if(this.hsc&&!mstrApp.isTablet()){d.updateContent(null,f.n);}this.updatePropertiesMsg();},canceled:function(){this.prevController&&this.prevController.makeCurrent();}});},openFolder:function N(a){S.call(this,a._renderIdx);this.view.resetListState();Y.call(this,a,false,{success:function(d){var b=this.rootCtrl;b.updateFolder(null,d.n);b.contentUpdated(2048);this.updatePropertiesMsg();},canceled:I});},openItem:function C(a){S.call(this,a._renderIdx);D.call(this,a);},itemLongPressed:function J(a){S.call(this,a._renderIdx);return this._super(a);},getDefaultMenus:function O(){return U.SETTINGS+U.HELP+U.LEARN;},getDefaultMessage:function T(){var a=this.view.items;return(a&&a.length)?M(8386,"Select a report, document or folder to view its content"):M(8388,"No items in folder");},makeCurrent:function G(a){this._super(a);var b=B.call(this);if(b){var d=(this.hsc&&mstrApp.isTablet())?undefined:b.res.n;this.rootCtrl.updateFolder(this.view,d,a);K.call(this,b);}},makeHome:function R(){this._super();X.call(this,0);},goBack:function Z(){if(this._super()){return true;}return X.call(this);},goUp:function L(){if(!this._super()){if(this._requests.length>1){X.call(this,0);}else{this.rootCtrl.goBack();}}return true;},getUpStatus:function W(){if(!this._super()){var a=this._requests;return !!(a&&a.length>1);}return true;},updateActionToolbar:function Q(a){this.getTxnToolbarButton(a);if(mstrMobileApp.isOnline()){a.addMenuItem(V,M(773,"Refresh"),V,true,5);}return this._super(a);},handleMenuItem:function A(b,a){if(b===V){Y.call(this,B.call(this).p,true,{success:function(){this.view._scroller.scrollTo(0,0);}});return false;}return this._super(b,a);},getPath:function E(){var a=[],b=this.id;P.forEach(this._requests,function(g,d){var f=g.res;a.push({n:f.n,fn:function(){X.call(mstrmojo.all[b],d);}});});return a;},goHome:function F(){X.call(this,0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.date","mstrmojo.locales","mstrmojo.hash");mstrmojo.requiresDescs(8391,8392);function F(M){var J=M.st;if(J===2048||J==="Project"){return undefined;}var K=mstrMobileApp.getCachedTime(M.sub_id||M.did,(M.sub_id)?-1:J,M.projectID||M.pid||""),L;if(K>0){var P=mstrmojo.date,O=mstrmojo.locales.datetime,N=P.getDateJson(new Date(parseInt(K,10)));L=P.formatDateInfo(N,O.DATEOUTPUTFORMAT)+" "+P.formatTimeInfo(N,O.TIMEOUTPUTFORMAT);}return mstrmojo.desc(8391,"Cached On:")+" "+(L||mstrmojo.desc(8392,"Not available"));}function I(K){var J=K.item;if(J){K=mstrmojo.hash.copy(K,{desc:J.desc||"",ttl:J.n||J.ttl||"",cached:F(J),did:J.did,st:J.st});}this.view.updateView(K);}mstrmojo.android.controllers.PropertiesController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.PropertiesController",doNotRefresh:true,start:function A(K){this._super(K);var J=this.view=mstrApp.viewFactory.newView("Properties",{controller:this});this.rootCtrl.updateProperties(J,"Properties");I.call(this,K);},updateItemProperties:function E(M,K,J,L){I.call(this,{defaultMsg:M,item:K,ctrlId:J,avail:L});},extractView:function D(){var J=this.view;J.parent.removeChildren(J);J.unrender();return J;},afterViewVisible:function B(){this.view.afterViewVisible();this._super();},restoreView:function C(J){J.unrender();this.rootCtrl.updateProperties(J);},makeCurrent:function H(J){this._super(J);this.rootCtrl.updateProperties(this.view,"Properties");},goUp:function G(){if(!this._super()){this.rootCtrl.goBack();}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.controllers._SupportsQueuedTransactions","mstrmojo.android.controllers._HasFolderView","mstrmojo.hash");mstrmojo.requiresDescs(8385);function F(P,K,O){mstrApp.setCurrentProjectId(P.did);var N=mstrmojo.hash.copy(P),M={};if(O){M.hsc=true;}var L=P.rtf;if(L){N.did=N.folderID=L.did;}else{N.systemFolder=7;}N.st=2048;K.spawn(mstrApp.controllerFactory.newController("Folder",M),N);}function D(L){if(L.length<1){var K=this._noPrjView;if(!K){K=this._noPrjView=new mstrmojo.android.ui.NoProjectsView({controller:this});}this.rootCtrl.updateDisplayMessage(K);}}var C=mstrmojo.android.controllers.ProjectsController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,[mstrmojo.android.controllers._SupportsQueuedTransactions,mstrmojo.android.controllers._HasFolderView],{scriptClass:"mstrmojo.android.controllers.ProjectsController",start:function B(N){this._super(N);var M=mstrApp.getConfiguration().getProjectList(),L=this.rootCtrl,K=this.initFolderView();K.set("items",M);L.updateFolder(K);this.updatePropertiesMsg();D.call(this,M);},openFolder:function G(K){F(K,this);},getDefaultMessage:function A(){return mstrmojo.desc(8385,"Select a project to view contents");},makeCurrent:function J(L){this._super(L);this.view.clearSelect();var K=this.rootCtrl;K.updateFolder(this.view);K.restoreNavigation();this.updatePropertiesMsg();D.call(this,mstrApp.getConfiguration().getProjectList());},goUp:function I(){if(!this._super()){this.rootCtrl.goBack();}return true;},destroy:function H(){var K=this._noPrjView;if(K){K.destroy();}this._super();},updateActionToolbar:function E(K){this.getTxnToolbarButton(K);return this._super(K);}});C.spawnFolderController=F;}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.controllers._HasFolderView","mstrmojo.android.EnumMenuOptions");mstrmojo.requiresDescs(773,1089,9931);var E=mstrmojo.desc;var A=mstrmojo.android.EnumMenuOptions.REFRESH;function H(N){var O=this,P=function(S){var Q=O.view,R=O.rootCtrl,T;Q.set("items",S.items);if(R.getCurrent()==O){if(!O.hsc){T=E(1089,"Subscriptions");}R.updateFolder(Q,T);O.updatePropertiesMsg();}};mstrApp.modelFactory.newDataService("Subscriptions").getSubscriptions({success:P,failure:function(Q){if(mstrApp.isHosted()){P({items:[{n:"Subscriptions Unavailable"}]});}else{O.viewFailed(Q);}}},N);}mstrmojo.android.controllers.SubscriptionsController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,[mstrmojo.android.controllers._HasFolderView],{scriptClass:"mstrmojo.android.controllers.SubscriptionsController",init:function M(O){this._super(O);var N=mstrmojo.publisher;N.subscribe(N.NO_SRC,N.RECONCILE_END_EVENT,function(){H.call(this,true);},this.id);},start:function C(N){this._super(N);this.csp=N.csp;this.initFolderView();H.call(this,false);},openItem:function I(O){var N=O.st;if(N){this.spawnedItem=O;this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(N),O),O);}else{this.view.clearSelect();}},spawnFailed:function J(N){delete this.spawnedItem;this._super(N);},itemLongPressed:function G(N){if(N.st){return this._super(N);}return false;},getDefaultMessage:function B(){return E(9931,"Select a subscription to view its content.");},makeCurrent:function L(P){var N=this.spawnedItem;if(P&&N){delete N.unread;delete this.spawnedItem;}this._super(P);var O=this.rootCtrl;O.updateFolder(this.view,this.txt,P);O.restoreNavigation();this.updatePropertiesMsg();},goUp:function K(){if(!this._super()){this.rootCtrl.goBack();}return true;},updateActionToolbar:function F(N){N.addMenuItem(A,E(773,"Refresh"),A,true,5);return this._super(N);},handleMenuItem:function D(N,O){if(N===A){mstrMobileApp.restartReconciler();return ;}this._super(N,O);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.EnumMenuOptions");mstrmojo.android.controllers.PromptsController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.PromptsController",doNotRefresh:true,start:function D(H){this._super(H);this.callback=H.callback;var F=this.prompts=H.prompts,E=this.view=this.newView("Prompts",{maskNode:H.maskNode,prompts:F,supportedPrompts:H.supportedPrompts});var G=F.host.n||H.n;this.rootCtrl.updatePrompts(E,G);},getDefaultMenus:function B(){return 0;},goUp:function C(){if(!this._super()){this.rootCtrl.goBack();}return true;},answerPrompts:function A(){var E=this.id;this.prompts.prepareAnswer({success:function(){try{var F=mstrmojo.all[E];F.prompts.validate();F.callback();}catch(G){mstrApp.onerror(G);return false;}return true;}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController");var B="mstrmojo.android.controllers.HomeScreenController";mstrmojo.android.controllers.HomeScreenController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.HomeScreenController",openItem:function A(E){$MAPF(true,B);try{var F=mstrmojo.hash.copy(E);var C=this.getViewKey,G=F.act?C(F.act):C(F.st);if(G==="Help"){mstrApp.displayHelp();return ;}if(G===""){G=F.type;}delete F.type;if(G===C(5)){var I=mstrApp.getConfiguration(),H=I.getProjectCount();if(H===1){G=C(2048);F.systemFolder=7;F.pid=mstrmojo.hash.any(I.getProjectHash(),true);}}mstrApp.setCurrentProjectId(F.pid);delete F.pid;this.spawn(mstrApp.controllerFactory.newController(G,F),F);}catch(D){throw D;}finally{$MAPF(false,B);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.func","mstrmojo.hash");mstrmojo.requiresDescs(9478,9479,9753);var P=mstrmojo.hash,A=1,E=2,O;mstrmojo.android.controllers.TransactionNotificationController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.TransactionNotificationController",widgetMap:null,boardOpen:null,init:function R(X){this._super(X);var W=this.widgetMap={},V=this.boardModel=this.model.getBoardModel();if(!this._txListener){this._txListener=V.attachEventListener("recordChanged",this.id,function(Y){P.forEach(W,function(a,Z){if(!Y.data||!Y.data[Z]){a.set("txData",null);delete W[Z];}});if(this.isNotificationBoardOpen()){this.pendingUpdate=true;}else{this.generateActionToolbar();}});}},start:function G(W){this._super(W);var V=this.view=mstrApp.viewFactory.newView("Transactions",{model:this.boardModel,context:W.context,controller:this});O=mstrmojo.desc(9753,"Transactions");this.rootCtrl.updateTransactions(V,O);},destroy:function S(V){var W=this._txListener;if(W){W.clear();}this._super(V);},hasTransactionQueue:function L(W){var V=this.model.hasOfflineTransactions();if(V&&W){V=this.boardModel.getOfflineRecords(W);}return V;},hasPendingTransactions:function N(W){var V=this.boardModel.getOfflineRecords(W);return(V&&V.pending&&V.pending.length);},showNotificationBoard:function C(Z,X,Y){var V={},W=E;if(X){V={context:{id:X,n:Y||Z.ttl}};W=A;}this.boardOpen=W;this.contextController=Z;Z.spawn(this,V);},isNotificationBoardOpen:function D(){return !!this.boardOpen;},isAllTransactionLevel:function H(){return(this.boardOpen===E);},editTransactionRecord:function I(X,W,V,a){var Y=this.boardModel,Z=this.id;this.model.editTransactionRecord(X,W,V,mstrmojo.func.wrapMethods(a,{success:function(b){mstrmojo.all[Z].startDocument(b,X,Y.docsTx[X]&&Y.docsTx[X].p.pid);}}));},deleteTransactionRecord:function Q(Z,W,V,a){a=a||{};var X=a.success||mstrmojo.emptyFn,Y=this;a.success=function(f){var b=!Y.boardModel.getOfflineRecords();X(f);var d=Y.boardOpen;if(d===E&&b){Y.goBack();}if((d===A&&b)||Y.model.emptyTransactionQueue){mstrmojo.toast(Y.model.emptyTransactionQueue?mstrmojo.desc(9478,"There are no more pending transactions"):mstrmojo.desc(9479,"There are no more pending transactions for the current document"));Y.goUp();}};this.model.deleteTransactionRecord(Z,W,V,a);},startDocument:function B(Y,Z,X){Y.ifc=false;this.rootCtrl.closeTransactions(true);var V=this.contextController;if(V){if(V instanceof mstrmojo.android.controllers.ResultSetController){if(V.did===Z){V.hasTxChanges=true;V.model.transactionUpdate(Y);V.setData(Y);V.getPageByTree(true);V.makeCurrent();return ;}}var W={action:"open",data:Y,documentID:Z,hasTxChanges:true,st:14081};if(X!==mstrApp.getCurrentProjectId()){W.projectID=X;}V.spawn(mstrApp.controllerFactory.newController("Document",{st:14081}),W);}},detach:function T(){this._super();this.boardOpen=null;if(this.pendingUpdate){this.rootCtrl.getCurrent().generateActionToolbar();delete this.pendingUpdate;}},addWidgetListener:function K(W,V){this.widgetMap[W]=V;},goBack:function U(){if(this._super()){return true;}if(this.boardOpen!==E||!this.view.goBack()){this.rootCtrl.closeTransactions();}return true;},goUp:function M(){if(!this._super()){this.rootCtrl.closeTransactions();}return true;},makeCurrent:function F(V){this._super(V);this.rootCtrl.updateTransactions(this.view,O,V);},setOfflineRecords:function J(V){this.model.refresh();}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.ui.ActionToolbar","mstrmojo.android.EnumMenuOptions","mstrmojo.android.ui.PropertiesView","mstrmojo.hash","mstrmojo.array","mstrmojo.string");mstrmojo.requiresDescs(1142,8623,8429,8430,8624,8625,9099,11191);var L=mstrmojo.hash,h=mstrmojo.array.forEach,K=mstrmojo.dom,O=768,d=mstrmojo.android.EnumMenuOptions,AC=d.FULL_SCREEN,AF=d.SHARE,C=d.ANNOTATION,g=d.ABOUT_RESULTSET,F=3,I=50;function w(){var AH=this._oldPID;if(AH){mstrApp.setCurrentProjectId(AH);}}function D(AL,AM,AJ,AK){var AI=this.model,AH=AI.prompts;if(AH){AL.promptsAnswerXML=AH.getAnswerXML();}AL.useRefreshProgress=AK;mstrApp.closeAllDialogs();AI.execute(AL,AM,AJ);}function R(AK){var AI=this.model,AH=AI.prompts,AJ={fresh:false,useRefreshProgress:mstrApp.isTablet()};if(AH){AJ.promptsAnswerXML=AH.getAnswerXML();}mstrApp.closeAllDialogs();this.refresh(AJ,AK);}function U(){var AH=this._startParams,AJ=AH.action,AI;if(!AJ||(AJ!=="drillGrid"&&AJ!=="drill2Grid")){AI=AH;}this.rootCtrl.updateLastOpened(AI);}function AD(AI,AM){AM=AM||{};var AH=this.view=this.createView(AI,L.copy(AM)),AL=AI.n||AM.ttl||"",AJ=this;AH.slot="containerNode";var AK=this.frame=this.newView("ResultSet",{controller:this});AK.addChildren([AH]);this.rootCtrl.updateContent(AK,AL);this.ttl=this._startParams.n=AL;this.desc=AI.dsc;U.call(this);window.setTimeout(function(){AJ.checkCache(AI,AM);},100);}function M(){if(this.isFullScreen){this.cancelFlashFullScreen();}var AH=this.frame.getPosition(),AI=K.windowDim();AH.ww=AI.w;AH.wh=AI.h;return JSON.stringify(AH);}mstrmojo.android.controllers.ResultSetController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.ResultSetController",supportsFullScreen:true,start:function T(AJ){this._super(AJ);this._startParams=L.copy(AJ);var AP=this,AL=AJ.projectID,AR=AP.prevController,AH=function(AS){w.call(AP);AP.viewFailed(AS);},AM=function(AS){$MAPF(AS,"ResultSetController","start");},AQ=function(){if(AR&&AR.docRequestComplete){AR.docRequestComplete();}};var AN=this.ctrlType=AJ.st;AM(true);if(AL){this._oldPID=mstrApp.getCurrentProjectId();mstrApp.setCurrentProjectId(AL);this.pid=AL;}try{var AI=AJ.action||"execute";delete AJ.action;var AK=this.model=this.initModel();if(AN){AK.st=AN;AK.n=AJ.n;}this.did=this.did||AJ.documentID||AJ.reportID||AJ.objectID;AK[AI](AJ,{success:function(AS){try{AD.call(AP,AS,AJ);}catch(AT){AH(AT);}},prompts:function(){AP.openPrompts(AJ);},failure:function(AS){AH(AS);},complete:function(){AM(false);AQ();},canceled:function(){AH();}});}catch(AO){AH(AO);AQ();}},initModel:mstrmojo.emptyFn,canDelegateToolBar:function J(){return true;},createView:mstrmojo.emptyFn,getDefaultMenus:function z(){return 0;},onorientationChange:function Q(){var AH=this.frame;if(AH&&AH.hasRendered){AH.rootOrientationChange({isLandscape:!this.orientation});}this._super();},refresh:function AG(AI,AJ){var AH=this.view;this.model.refresh(AI,mstrmojo.func.wrapMethods({success:function(AK){if(AK){AH.refresh();}}},AJ));},reExecute:function A(AH){if(mstrApp.useBinaryFormat){mstrMobileApp.removeLiveCache(mstrApp.getCurrentProjectId(),this.model.ci.cid);var AI=this;D.call(this,{},{success:function(AJ){AI.setData(AJ);}},{refresh:true},false);}else{AH.model.raiseEvent({name:"refresh"});}},reprompt:function AE(){this.repromptFlag=true;this.openPrompts();},openPrompts:function s(AL){var AO=this,AN=this.model.prompts,AP=AN.size(),AH=[],AQ=false,AM;for(AM=0;AM<AP;AM++){var AJ=AN.get(AM);if(AJ.supported()){AH.push(AJ);}else{if(!AJ.hasAnswer){if(AJ.req){this.viewFailed({message:mstrmojo.desc(8623,"Report cannot be executed because it contains unanswered, required prompts.")});return ;}AQ=true;}}}var AK=function(){if(AQ){mstrmojo.alert(mstrmojo.desc(8624,"Warning: Report contains unasnwered, unsupported prompts."),function(){AO.answerPrompts();});}else{AO.answerPrompts();}};if(AH.length>0){var AI=this.frame;this.spawn(mstrApp.controllerFactory.newController("Prompts"),{maskNode:AI&&AI.getMaskNode(),prompts:AN,supportedPrompts:AH,n:(AL&&(AL.n||AL.ttl))||this.ttl,callback:function(){AK();}});}else{AK();}},answerPrompts:function W(){var AH=this;this.model.answerPrompts({success:function(AI){var AJ=AH.nextController;if(AJ){AJ.destroy();}if(AH.repromptFlag){AH.afterReprompt(AI);delete AH.repromptFlag;AH.rootCtrl.updateContent(AH.frame,AI.n);U.call(AH);AH.checkCache(AI);}else{AD.call(AH,AI);}},prompts:function(){AH.viewFailed({message:mstrmojo.desc(8625,"Prompts in prompts are not supported.")});},failure:function(AI){mstrApp.onerror(AI);}});},afterReprompt:function b(AH){this.getPageByTree(true);},hasPageBy:mstrmojo.emptyFn,getPageByTree:function q(AK){var AI=!!this.pageByData;if((!AK&&AI)||!this.hasPageBy()){return ;}var AL=this,AH=this.view,AJ=(AH.isVis&&AH.isVis())?AH.xtabModel:this.model;if(AJ.getPageByTree){if(AI){this.set("pageByData",null);}AJ.getPageByTree({success:function(AM){AL.set("pageByData",AM);},failure:function(AM){mstrApp.onerror(AM);}});}},destroy:function AA(){this.model.destroy();var AH=this.frame;if(AH){AH.destroy();}this._super();},checkCache:function H(AM,AK,AS,AL,AI){var AO=this,AQ=this.model.getDataService(),AH=AM&&AM.ifc;AS=AS||mstrmojo.emptyFn;if(!mstrApp.useBinaryFormat||!AH){AS();return ;}AK=AK||{did:this.did,n:this.n,st:this.st,t:this.t,sub_id:this.sub_id};var AJ=function(AU){var AT=(AU!==true);AO.rootCtrl.setActionToolbarStatus(AT);AO.frame.setActionToolbarStatus(AT);};var AR=true,AP=1,AN={success:function(AT){if(AR&&AL!==2){mstrmojo.toast(mstrmojo.desc(8617,"Your view has been updated with the latest version of the document."),3000);}if(AP===1){AO.setData(AT,true);}AO.getPageByTree(true);AO.generateActionToolbar();AS();AJ();},prompts:function(){mstrmojo.alert(mstrmojo.desc(8619,"New prompts were added to the document."),function(){AJ();AO.reprompt();});},failure:function(){AJ();},canceled:AJ};AJ(true);if(AL===1&&AM.ci.cid==="00000000000000000000000000000000"){AR=false;}AQ.checkCache(L.copy(AM.ci||{}),{success:function(AT){if(AT.needUpdate){if(AT.refresh&&AL===2){AP=2;R.call(AO,AN);}else{D.call(AO,AK,AN,{},mstrApp.isTablet());}}else{AS();AJ();}},failure:function(){if(!mstrApp.onMobileDevice()){if(AL===2){AP=2;R.call(AO,AN);}else{D.call(AO,AK,AN,{},mstrApp.isTablet());}}else{AJ();}},canceled:AJ},AI);},goBack:function E(){var AH=this._super();if(!AH){w.call(this);}return AH;},makeCurrent:function a(AH){var AI=this.frame;if(AI){this._super(AH);this.rootCtrl.updateContent(AI,this._startParams.n,AH);U.call(this);}else{this.doNotRefresh=true;this.prevController.makeCurrent(AH);}},onExecuteNewObject:function P(AI){var AH=(AI.objType===F)?768:14081;this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(AH),{st:AH}),AI);},onDrill:function j(AH){this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(O)),L.copy(AH,{action:(this.ctrlType===O)?"drillGrid":"drill2Grid",st:O}));},goUp:function X(){if(!this._super()){var AH=this.getController("ctrlType",2048);if(AH){AH.makeCurrent(true);}else{this.rootCtrl.goHome();}}return true;},updateActionToolbar:function t(AH){if(mstrApp.getConfiguration().isMenuAllowed(AF,AF)){if(mstrMobileApp.getSDKVersion()>=11){AH.addToolbarBtn(C,mstrmojo.desc(11191,"Annotation"),C,false,24);}AH.addToolbarBtn(AF,mstrmojo.desc(9099,"Share"),AF,false,22);}AH.addMenuItem(g,mstrmojo.desc(1142,"About"),g,false,23);AH=this._super(AH);if(this.frame&&this.frame.delegateToolbar(AH)){AH=mstrmojo.android.ui.ActionToolbar.newToolbarConfig();}return AH;},handleMenuItem:function o(AI,AH){switch(AI){case g:this.rootCtrl.updateItemProperties("",{ttl:this.ttl,st:this.st,did:this.did||this.getDepth(),pid:this.pid,desc:this.desc,propsPopup:true},this.id,false);return ;case AF:this.share("",false);return ;case AC:this[((AH===11)?"enter":"exit")+"FullScreen"]();return ;case C:this.startAnnotate();return ;}return this._super(AI,AH);},beforeViewHidden:function G(AI){this._super(AI);var AH=this.view;if(AH&&AH.beforeViewHidden){AH.beforeViewHidden(AI);}if(this.isFullScreen){this.exitFullScreen(true,AI);}},afterViewVisible:function V(AH){this._super(AH);if(this.isFullScreen||!!this.model.fs||!!this.model.data.fs){this.enterFullScreen();}else{if(mstrMobileApp.getSDKVersion()>=16){window.setTimeout(function(){mstrMobileApp.clearWebViewCache(false);},100);}}mstrMobileApp.hideProgress();if(!AH){var AI=this.id;window.setTimeout(function(){var AJ=mstrmojo.all[AI];if(AJ&&AJ.rootCtrl.getCurrent()===AJ){AJ.takeScreenShot();}},300);}},takeScreenShot:function Y(){var AI=this.view,AH=(AI.getCaptureDimensions&&AI.getCaptureDimensions())||K.position(AI.domNode),AK=K.windowDim(),AL=this.did||this.getDepth(),AJ=mstrApp.getCurrentProjectId();h(mstrmojo.android.ui.PropertiesView.getPreviewSizes(),function(AM){mstrMobileApp.takeScreenShot(JSON.stringify({pid:AJ,dssId:AL,x:AH.x,y:AH.y,w:Math.max(AH.w,AM.w),h:Math.max(AH.h,AM.h),pw:AM.w,ph:AM.h,ww:AK.w,wh:AK.h}));});},addFullScreenButton:function Z(AH){var AJ=mstrmojo.desc(8430,"Enter Fullscreen"),AI=11;if(this.isFullScreen){AJ=mstrmojo.desc(8429,"Exit Fullscreen");AI=10;}AH.addToolbarBtn(AC,AJ,AI,false,AI);},enterFullScreen:function N(){this.frame.enterFullScreen();this.rootCtrl.enterFullScreen();this.isFullScreen=true;this.generateActionToolbar();mstrmojo.touchManager.raiseEvent({name:"fullScreenStateChange"});},exitFullScreen:function AB(AH,AI){this.isFullScreen=false;this.frame.exitFullScreen(!AH);this.rootCtrl.exitFullScreen(!AH,AI);this.generateActionToolbar();mstrmojo.touchManager.raiseEvent({name:"fullScreenStateChange"});},viewTap:function B(){if(this.isFullScreen){this.frame.flashFullScreen();this.rootCtrl.flashFullScreen();}},cancelFlashFullScreen:function l(){this.frame.cancelFlashFullScreen();this.rootCtrl.cancelFlashFullScreen();},getMagnifierConfig:function f(){var AH=this.frame.getPosition();return{curtainPosition:AH};},share:function p(AJ,AI){var AK=M.call(this),AH=this.ttl;window.setTimeout(function(){mstrMobileApp.takeScreenShotAndSend(AK,JSON.stringify({attachmentName:mstrmojo.string.decodeHtmlString(AH),subject:AJ,useDefault:AI}));},100);},getBottomToolBarHeight:function S(){return(!mstrApp.isTablet()&&!this.isFullScreen&&!mstrApp.isLandscape())?(Math.round(I*mstrMobileApp.getDeviceDPI()/160)):0;},startAnnotate:function x(){if(!!this.ignoreAnnotationMenuItem){return ;}this.ignoreAnnotationMenuItem=true;mstrMobileApp.showProgress([mstrmojo.desc(8445,"Loading")],false);var AI=M.call(this),AH=this;window.setTimeout(function(){mstrMobileApp.startAnnotate(AI,mstrmojo.string.decodeHtmlString(AH.ttl),"javascript:mstrmojo.all."+AH.id+".onAnnotationFinished()");},100);},onAnnotationFinished:function k(){this.ignoreAnnotationMenuItem=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.SimpleList","mstrmojo.android.EnumMenuOptions","mstrmojo.android.ui.Button","mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo.num");mstrmojo.requiresDescs(11,16,17,18,37,187,295,629,702,784,844,845,874,1088,1142,1563,1900,1905,2411,2461,2822,3157,4253,5191,6560,7227,7559,7561,7778,7779,7831,7840,8027,8360,8361,8362,8363,8364,8365,8366,8367,8368,8369,8370,8371,8372,8373,8374,8375,8376,8377,8378,8379,8390,8441,8447,8455,8456,8457,8458,8459,8489,8633,8634,8635,8760,9446,9447,9448,9449,9450,9451,9452,9456,9457,9458,9459,9460,9464,9465,9466,9467,9468,9469,9470,9471,9481,9790,9791,9792,9793,9794,9795,9796,9797,9807);var $ARR=mstrmojo.array,$HASH=mstrmojo.hash,$BTN=mstrmojo.android.ui.Button.newButton,$DESC=mstrmojo.desc,MENUS=mstrmojo.android.EnumMenuOptions,MENU_DELETE=MENUS.DELETE,MENU_ADD_SERVER=MENUS.ADD_SERVER,MENU_ADD_PROJECT=MENUS.ADD_PROJECT,MENU_ABOUT=MENUS.ABOUT,legalText;var STYLE_HEADER=1,STYLE_BUTTON=2,STYLE_VIEW_BUTTON=3,STYLE_TEXT=4,STYLE_LIST=5,STYLE_CHECK=6,STYLE_IMAGE=7,STYLE_TEXT_AREA=8,STYLE_NUMBER=9,STYLE_TIME=10;var TYPE_HOME=1,TYPE_SERVERS=2,TYPE_EDIT_SERVER=3,TYPE_SERVER_CREDS=4,TYPE_EDIT_PROJECT=5,TYPE_PROJECT_CREDS=6,TYPE_GENERAL=7,TYPE_ABOUT=8,TYPE_LEGAL=10,TYPE_CERT=12,TYPE_CERT_AUTH=12,TYPE_TRUSTED_CERTS=13;var DELETE_TXT={};DELETE_TXT[TYPE_EDIT_SERVER]=5191;DELETE_TXT[TYPE_EDIT_PROJECT]=11;var ADD_TXT={};ADD_TXT[TYPE_SERVERS]=5191;ADD_TXT[TYPE_EDIT_SERVER]=11;var MEMORY_LIMIT_LIST=[{v:25,n:"25MB"},{v:50,n:"50MB"},{v:100,n:"100MB"},{v:250,n:"250MB"},{v:500,n:"500MB"},{v:1024,n:"1GB"},{v:2048,n:"2GB"},{v:3072,n:"3GB"},{v:4096,n:"4GB"}];function getHourString(v){return $DESC(9797,"Every ## hours").replace("##",v);}var UPDATE_INTERVAL=[{v:1,n:$DESC(9796,"Every hour")},{v:2,n:getHourString(2)},{v:4,n:getHourString(4)},{v:10,n:getHourString(10)},{v:24,n:getHourString(24)}];var MODIFIED_ITEMS={};function getNewServerNode(){return{nm:"",po:80,pt:"MicroStrategyMobile",ty:1,rt:0,udc:true,wsc:{am:1,lo:"",ps:""},pdc:{am:1,lo:"",ps:""},pl:[],isNew:true};}function getNewProjectNode(){return{pc:{am:0,lo:"",ps:""},pn:"",sn:"",sp:0,udc:false,isNew:true};}function updateView(viewInfo,items){if(items){viewInfo.items=items;}else{items=viewInfo.items;}var view=this.view.getList(viewInfo.cfg.isHome),rootCtrl=this.rootCtrl;view.restoreListState(viewInfo.idx,viewInfo.origin);view.items=items;view.refresh();if(mstrApp.isTablet()&&viewInfo.cfg.isHome){if(!viewInfo.idx){view.singleSelect(0);}}rootCtrl.updateContent(null,(mstrApp.isTablet())?$DESC(7831,"Settings"):viewInfo.title);rootCtrl.contentUpdated("Settings");this.generateActionToolbar();}function generateView(fnView,item){var viewInfo=fnView.call(this,item);this.view.getList(viewInfo.cfg.isHome).resetListState();viewInfo.cfg.fnRedraw=fnView;this._viewInfos.push(viewInfo);updateView.call(this,viewInfo);}function getLastViewInfo(){var views=this._viewInfos;return views[views.length-1];}function getCurrentConfig(){var viewInfo=getLastViewInfo.call(this);return viewInfo&&viewInfo.cfg;}function cacheViewState(idx){var lastViewInfo=getLastViewInfo.call(this);lastViewInfo.idx=idx;lastViewInfo.origin=this.view.getList(lastViewInfo.cfg.isHome).getScrollPos();}function showCurrentView(){var current=getLastViewInfo.call(this),cfg=current.cfg;updateView.call(this,current,cfg.fnRedraw.call(this,cfg.item).items);this.view.getList(cfg.isHome).restoreListState(current.idx,current.origin);}function confirmDelete(itemName,fnOk){mstrmojo.confirm($DESC(8390,"Are you sure you want to delete #?").replace("#",itemName),[$BTN($DESC(1442,"OK"),fnOk),$BTN($DESC(221,"Cancel"))]);}function deleteItem(item){var me=this;confirmDelete(item.nm,function(){var mobileConfig=me.mobileConfigObj,cfg=getCurrentConfig.call(me),servers=mobileConfig.getWebServersList(),collection=(cfg.type===TYPE_SERVERS)?servers:servers[cfg.idx].pl;collection.splice(item.idx,1);me.view.getList(cfg.isHome).set("items",cfg.fnRedraw.call(me,cfg.item).items);me.mobileConfigObj.reconcileHomescreen();me.mobileConfigObj.saveConfiguration();me.connectivityChanged=true;});}function showPopup(item){var controller=this,dialog;dialog=mstrApp.showDialog({title:item.nm,cssClass:"mstrmojo-SimpleOptions",children:[{scriptClass:"mstrmojo.android.SimpleList",isElastic:true,items:[{n:$DESC(1088,"Edit"),v:1},{n:$DESC(629,"Delete"),v:2}],postselectionChange:function(evt){dialog.close();if(this.items[evt.added[0]].v===1){item.fn();}else{deleteItem.call(controller,item);}}}]});}function convertListToItems(list){var rtn=[],x=-1;$ARR.forEach(list,function(n,idx){if(n){rtn[++x]={n:n,v:idx};}});return rtn;}function editItem(item,value,node){var cfg=getCurrentConfig.call(this),type=cfg.type,path=item.pt.split("."),prop=path.pop(),mobileConfig=this.mobileConfigObj,servers=mobileConfig.getWebServersList();switch(type){case TYPE_EDIT_SERVER:node=servers[cfg.idx];if(!node){node=getNewServerNode();servers.push(node);this.connectivityChanged=true;}break;case TYPE_EDIT_PROJECT:var serverNode=servers[cfg.parent.idx],projects=serverNode.pl||[];node=projects[cfg.idx];if(!node){node=getNewProjectNode();this.mobileConfigObj.setPid(node);projects.push(node);this.connectivityChanged=true;}break;case TYPE_GENERAL:node=mobileConfig.getGeneralSettings();if(prop==="am"||prop==="lo"||prop==="ps"){node=mobileConfig.getDefaultServerCreds();}else{if(prop==="ebs"||prop==="tod"||prop==="ui"||prop==="wo"||prop==="co"){node=mobileConfig.getBackgroundSyncSettings();}}break;case TYPE_CERT:case TYPE_CERT_AUTH:case TYPE_TRUSTED_CERTS:break;default:throw new Error("AndroidSettingsController::editItem -- Unhandled edit action.");}if(path.length){node=$HASH.walk(path.join("."),node);}var oldValue=node[prop];if(oldValue!==value){node[prop]=value;item.v=value;var mods=MODIFIED_ITEMS[type]||{};mods[item.pt.replace(".","@")]=item;MODIFIED_ITEMS[type]=mods;$ARR.forEach(item.dependents,function(dependentItem){$ARR.forEach(["Hidden","Disabled"],function(prop){var fnDependent=dependentItem["fn"+prop];if(fnDependent){dependentItem[prop.toLowerCase()]=fnDependent(value);}});});if(prop==="lo"||prop==="ps"){node.um=true;}}}function newImage(props){return $HASH.copy(props,{nm:"",style:STYLE_IMAGE});}function newHeader(text,props){return $HASH.copy(props,{nm:text,style:STYLE_HEADER});}function newItem(title,value,style,props){return $HASH.copy(props,{nm:title,v:value,style:style});}function newBtnItem(title,value,fnClick,props){var controller=this;return newItem(title,value,STYLE_BUTTON,$HASH.copy({fn:function(){fnClick.call(controller);}},props));}function newViewItem(title,value,fnView,props){var controller=this;return newItem(title,value,STYLE_VIEW_BUTTON,$HASH.copy({fn:function(){cacheViewState.call(controller,this._renderIdx);generateView.call(controller,fnView,this);}},props));}function newEditItem(title,style,node,path,props){var controller=this;return newItem(title,$HASH.walk(path,node),style,$HASH.copy({pt:path,fn:function(value){editItem.call(controller,this,value,node);}},props));}function newListItem(title,node,path,items,props){return newEditItem.call(this,title,STYLE_LIST,node,path,$HASH.copy({items:items},props));}function newCheckItem(title,description,node,path,on,off,props){return newEditItem.call(this,title,STYLE_CHECK,node,path,$HASH.copy({desc:description,on:on,off:off},props));}function ellipsizeHeaderText(text,ellipsize){return ellipsize?mstrmojo.string.ellipsize(text,20):text;}function addTabletHeader(items,title,ellipsize){if(mstrApp.isTablet()){var headerTitle=[];$ARR.forEach(this._viewInfos,function(info,idx){if(idx&&info.title!==title){headerTitle.push('<div hidx="'+idx+'">'+ellipsizeHeaderText(info.title,(idx>1&&ellipsize))+"</div>");}});headerTitle.push("<em>"+ellipsizeHeaderText(title,ellipsize)+"</em>");items=[newHeader(headerTitle.join(""),{cls:"tablet-header"})].concat(items);}return items;}function validateServerChanges(cfg,mods){var servers=this.mobileConfigObj.getWebServersList(),server=servers[cfg.idx],serverCreds=server.wsc,serverAuth=serverCreds.am,projects=server.pl,isNewServer=server.isNew;if(isNewServer&&!mods.nm){servers.splice(cfg.idx,1);return false;}delete server.isNew;if(mods.nm||mods.po||mods.pt||mods.ty){$ARR.forEach(projects,function(project){mstrApp.removeProjectCaches(project);});}else{if(mods["wsc@lo"]&&(mods["wsc@am"]||(serverAuth===2||serverAuth===3))){var projectDefaultAuth=server.pdc.am;$ARR.forEach(projects,function(project){var projectAuth=(project.udc)?projectDefaultAuth:project.pc.am;if(projectAuth===2||projectAuth===64){mstrApp.removeProjectCaches(project);}});}}server.udc=(!serverAuth);if(!serverAuth){serverCreds.lo="";serverCreds.ps="";}this.mobileConfigObj.setWebServerList(servers);return(isNewServer||!!mods.nm);}function validateProjectChanges(cfg,mods){var servers=this.mobileConfigObj.getWebServersList(),projects=servers[cfg.parent.idx].pl,project=projects[cfg.idx],projectCreds=project.pc,projectAuth=projectCreds.am,isNewProject=project.isNew;if(isNewProject&&(!mods.pn||!mods.sn)){projects.splice(cfg.idx,1);return false;}delete project.isNew;if(!isNewProject&&(mods.pn||mods.sn||mods["pc@am"]||(projectAuth>0&&mods.lo))){mstrApp.removeProjectCaches(project.pid);this.mobileConfigObj.setPid(project);this.connectivityChanged=true;}project.udc=(!projectAuth);if(!projectAuth){projectCreds.lo="";projectCreds.ps="";}return(isNewProject||!!mods.pn||!!mods.sn);}function validateGeneralSettingsChanges(cfg,mods){var mobileConfig=this.mobileConfigObj,creds=mobileConfig.getDefaultServerCreds(),isAnonymousMode=(creds.am===1);if(mods.am||(mods.lo&&!isAnonymousMode)){$ARR.forEach(mobileConfig.getWebServersList(),function(server){if(server.udc){var defaultProjAuth=server.pdc.am;$ARR.forEach(server.pl,function(project){var projAuthMode=(project.udc)?defaultProjAuth:project.pc.am;if(projAuthMode===2||projAuthMode===64){mstrApp.removeProjectCaches(project.pid);}});}});}if(isAnonymousMode){creds.lo="";creds.ps="";}return false;}function newAuthenticationItems(type,node){var path="",fnDisabled=mstrmojo.emptyFn,items;if(type===TYPE_EDIT_SERVER||type===TYPE_SERVER_CREDS){items=convertListToItems([$DESC(8441,"Default"),$DESC(7778,"Anonymous"),$DESC(7227,"Basic"),$DESC(7779,"Windows"),$DESC(8027,"Trusted")]);if(type===TYPE_EDIT_SERVER){path="wsc";}fnDisabled=function(v){return(v<2||v===64);};if((type!==TYPE_SERVER_CREDS)&&node.udc){node[path].am=0;}}else{items=[{n:$DESC(8441,"Default"),v:0},{n:$DESC(3157,"Standard"),v:1},{n:$DESC(7779,"Windows"),v:2},{n:"LDAP",v:16},{n:$DESC(1563,"Database"),v:32},{n:mstrmojo.desc(8027,"Trusted"),v:64}];path=(type===TYPE_PROJECT_CREDS)?"pdc":"pc";fnDisabled=function(v){return(!v||parseInt(v,10)===2||parseInt(v,10)===64);};if((type!==TYPE_PROJECT_CREDS)&&node.udc){node[path].am=0;}}if(type===TYPE_SERVER_CREDS||type===TYPE_PROJECT_CREDS){items.shift();}path=(path&&path+".")||"";var cfgLogin={disabled:fnDisabled($HASH.walk(path+"am",node)),fnDisabled:fnDisabled},userName=newEditItem.call(this,$DESC(17,"User Name"),STYLE_TEXT,node,path+"lo",cfgLogin),pwd=newEditItem.call(this,$DESC(18,"Password"),STYLE_TEXT,node,path+"ps",$HASH.copy(cfgLogin,{pwd:true})),rtn=[];rtn.push(newListItem.call(this,$DESC(2822,"Authentication"),node,path+"am",items,{dependents:[userName,pwd]}));rtn.push(userName);rtn.push(pwd);return rtn;}function getEditProjectView(item){var idx=item.idx,settingsCfg=getCurrentConfig.call(this),server=this.mobileConfigObj.getWebServersList()[settingsCfg.idx]||getNewServerNode(),project=server.pl[idx]||getNewProjectNode(),items=[];items.push(newEditItem.call(this,$DESC(11,"Project"),STYLE_TEXT,project,"pn",{showHint:true}));items.push(newEditItem.call(this,$DESC(5191,"Server"),STYLE_TEXT,project,"sn",{showHint:true}));items=items.concat(newAuthenticationItems.call(this,TYPE_EDIT_PROJECT,project));return{title:item.nm,items:addTabletHeader.call(this,items,item.nm,true),cfg:{type:TYPE_EDIT_PROJECT,item:item,idx:idx,parent:settingsCfg,fnVal:validateProjectChanges}};}function getEditServerView(item){var controller=this,serverIndex=item.idx,server=this.mobileConfigObj.getWebServersList()[serverIndex]||getNewServerNode(),projects=server.pl||[],items=[];server.pl=projects;items.push(newEditItem.call(this,$DESC(7559,"Name"),STYLE_TEXT,server,"nm",{showHint:true}));items.push(newEditItem.call(this,$DESC(16,"Port"),STYLE_NUMBER,server,"po",{limits:{min:0,max:65535}}));items.push(newEditItem.call(this,$DESC(8489,"Path"),STYLE_TEXT,server,"pt"));items.push(newListItem.call(this,$DESC(8362,"Web server type"),server,"ty",convertListToItems(["J2EE","ASP.Net"])));items.push(newCheckItem.call(this,$DESC(8363,"Secure HTTP"),$DESC(9449,"Use HTTPS to access the mobile server"),server,"rt",1,0));items=items.concat(newAuthenticationItems.call(this,TYPE_EDIT_SERVER,server));items.push(newHeader($DESC(8364,"Default Project Credentials")));items=items.concat(newAuthenticationItems.call(this,TYPE_PROJECT_CREDS,server));items.push(newHeader($DESC(37,"Projects")));$ARR.forEach(projects,function(project,idx){items.push(newViewItem.call(controller,project.pn,project.sn,getEditProjectView,{idx:idx,fnPress:showPopup}));});return{title:item.nm,items:addTabletHeader.call(this,items,item.nm,true),cfg:{type:TYPE_EDIT_SERVER,item:item,idx:serverIndex,parent:getCurrentConfig.call(this),fnVal:validateServerChanges}};}function getLegalView(){var items=[],title=$DESC(8365,"Legal");if(!legalText){legalText="<p>"+$DESC(8633)+"</p><p>"+$DESC(8634)+"</p><p>"+$DESC(8635)+"</p>";}items.push(newItem(legalText,"",STYLE_TEXT_AREA,{noclick:true}));return{title:title,items:addTabletHeader.call(this,items,title),cfg:{type:TYPE_LEGAL}};}function getAboutView(){var items=[],title=mstrApp.isTablet()?$DESC(1142,"About"):$DESC(9457,"About #").replace("#","MicroStrategy");items.push(newImage.call(this,{noclick:true,cls:"mstr-logo"}));items.push(newItem.call(this,"MicroStrategy Mobile 9.4.0",$DESC(8366,"Build Number #").replace("#",mstrMobileApp.getAppVersion()),STYLE_BUTTON,{cls:"build-info",noclick:true}));items.push(newHeader($DESC(9456,"More Information"),{cls:"more-info"}));items.push(newViewItem.call(this,$DESC(8365,"Legal"),$DESC(9460,"Copyright disclosure"),getLegalView));items.push(newBtnItem.call(this,$DESC(9458,"Get in touch"),$DESC(9459,"Send us an email with your feedback, suggestions and appreciation!"),function(){var bodyMsg=[$DESC(9465,"I was looking through the MicroStrategy Mobile Android App. Please contact me with details on how I can:")];bodyMsg.push($DESC(9466," - Find out how I can use MicroStrategy Apps to drive my business."));bodyMsg.push($DESC(9467," - Have apps, based on my workflow, specifications and design, in two weeks."));bodyMsg.push($DESC(9468," - How I can partner with MicroStrategy for all my Mobile solutions."));bodyMsg.push($DESC(9469," - Attend a free, hands-on, class to teach developers how to build and maintain Mobile Business Apps."));bodyMsg.push("");bodyMsg.push($DESC(9470,"Thank you."));mstrMobileApp.sendEmail("info@microstrategy.com",$DESC(9464,"Request information about MicroStrategy Mobile"),bodyMsg.join("\r\n"),"");}));return{title:title,items:addTabletHeader.call(this,items,title),cfg:{type:TYPE_ABOUT}};}function getBackgroundSyncingItems(){var settings=this.mobileConfigObj.getBackgroundSyncSettings(),fnDisabled=function(v){return(!v||v===false);},depProps={disabled:fnDisabled($HASH.walk("ebs",settings)),fnDisabled:fnDisabled},timeOfDay=newEditItem.call(this,$DESC(9807,"Time of day"),STYLE_TIME,settings,"tod"),updateInterval=newListItem.call(this,$DESC(9792,"Update interval"),settings,"ui",UPDATE_INTERVAL,$HASH.copy(depProps,{dependents:[timeOfDay]})),wifi=newCheckItem.call(this,$DESC(9793,"Only over Wi-Fi"),null,settings,"wo",true,false,depProps),charge=newCheckItem.call(this,$DESC(9794,"Only if charging"),null,settings,"co",true,false,depProps),enable=newCheckItem.call(this,$DESC(9795,"Enable background syncing"),null,settings,"ebs",true,false,{dependents:[updateInterval,timeOfDay,wifi,charge,timeOfDay]}),items=[];items.push(enable);items.push(updateInterval);items.push(timeOfDay);items.push(wifi);items.push(charge);timeOfDay.disabled=updateInterval.disabled||(updateInterval.v!==24);timeOfDay.fnDisabled=function(){return(enable.v!==true)||(updateInterval.v!==24);};return items;}function deleteCertificate(item){var controller=this;confirmDelete(item.nm,function(){mstrApp.showMessage("Deleting...");window.setTimeout(function(){var cfg=getCurrentConfig.call(controller);mstrMobileApp.deleteCertificate();item.hidden=!mstrMobileApp.hasCertificate();$ARR.forEach(item.dependents,function(d){d.hidden=!item.hidden;});controller.view.getList(cfg.isHome).set("items",cfg.fnRedraw.call(controller,cfg.item).items);mstrApp.hideMessage();},100);});}function showPopupDeleteCertificate(item){var controller=this,dialog;dialog=mstrApp.showDialog({title:item.nm,cssClass:"mstrmojo-SimpleOptions",children:[{scriptClass:"mstrmojo.android.SimpleList",isElastic:true,items:[{n:$DESC(1900,"View"),v:1},{n:$DESC(629,"Delete"),v:2}],postselectionChange:function(evt){dialog.close();if(this.items[evt.added[0]].v===1){item.fn();}else{if(this.items[evt.added[0]].v===2){deleteCertificate.call(controller,item);}}}}]});}function getCertificateDetailsView(item){var detailsStr=mstrMobileApp.getCertificateDetails(),details=eval("("+detailsStr+")"),items=[],result="",i;if(details.prs){for(i=0;i<details.prs.pr.length;++i){var pr=details.prs.pr[i];var name;if(pr.n==="edat"){name=$DESC(8457,"Expiration");}else{if(pr.n==="issr_n"){name=$DESC(8458,"Issuer");}else{name=pr.n;}}result+=name+": "+pr.v+"<br/>";}items.push(newItem.call(this,result,"",STYLE_TEXT_AREA,{disabled:true}));return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_CERT,item:item}};}throw details.message||"No certificate details available";}function getTrustedCertificatesView(item){var result=mstrMobileApp.getTrustedCertificates(),jsonResult=eval("("+result+")"),items=[],i;if(jsonResult&&jsonResult.certs){for(i=0;i<jsonResult.certs.length;++i){var cert=jsonResult.certs[i].dsc;items.push(newItem(cert,"",STYLE_TEXT_AREA,{disabled:true}));}}return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_TRUSTED_CERTS,item:item}};}function getCertificateAuthenticationFieldsView(item){var result=mstrMobileApp.getCertificateAuthenticationFields(),jsonResult=eval("("+result+")"),items=[],controller=this,i=0;if(jsonResult.login_info){var settings={},loginInfoField=jsonResult.login_info.field;for(i=0;i<loginInfoField.length;++i){var field=loginInfoField[i],cfgAuth={};settings[field.n]="";if(!!field.pass){cfgAuth=$HASH.copy(cfgAuth,{pwd:true});}items.push(newEditItem.call(this,field.dn,((field.tp==="numeric")?STYLE_NUMBER:STYLE_TEXT),settings,field.n,cfgAuth));}items.push(newItem.call(this,"Submit","",STYLE_BUTTON,{fn:function(){mstrApp.showMessage();window.setTimeout(function(){var responseStr=mstrMobileApp.getNewCertificate(JSON.stringify(settings));mstrApp.hideMessage();var response=eval("("+responseStr+")"),message=response.message;if(message){window.alert(response.message);}else{window.alert("Certificate obtained");if(item&&item.nm==="Get Certificate"){item.hidden=mstrMobileApp.hasCertificate();$ARR.forEach(item.dependents,function(d){d.hidden=!d.hidden;});}mstrApp.goBack();}},100);}}));var title=jsonResult.login_info.msg;return{title:title,items:addTabletHeader.call(this,items,title),cfg:{type:TYPE_CERT_AUTH,item:item}};}throw new Error(jsonResult.message);}function getGeneralSettingsView(item){var mobileConfig=this.mobileConfigObj,generalSettings=mobileConfig.getGeneralSettings(),items=[];items.push(newEditItem.call(this,$DESC(8367,"Network Timeout (seconds)"),STYLE_NUMBER,generalSettings,"nt",{limits:{min:0,max:9999}}));items.push(newEditItem.call(this,$DESC(7840,"Maximum Columns in Grid"),STYLE_NUMBER,generalSettings,"mgc",{limits:{min:0,max:9999}}));if(generalSettings.usd){var diagnosticMode=newCheckItem.call(this,$DESC(8760,"Diagnostic Mode"),$DESC(9450,"Store a log file in the device"),{b:mobileConfig.getDiagnosticMode()},"b",true,false);diagnosticMode.fn=function(value){mobileConfig.setDiagnosticMode(value);this.v=value;};items.push(diagnosticMode);}var monitor=newCheckItem.call(this,$DESC(9471,"Monitor Network Status"),$DESC(9790,"Notify the user when connection quality is below optimal"),generalSettings,"mns",true,false);var fn=function(value){mstrMobileApp.setNetworkMonitoringEnabled(value);};monitor.fn=mstrmojo.func.composite([fn,monitor.fn]);if(generalSettings.mns===undefined){monitor.v=true;}items.push(monitor);items.push(newHeader($DESC(8361,"Mobile Server Default")));items=items.concat(newAuthenticationItems.call(this,TYPE_SERVER_CREDS,this.mobileConfigObj.getDefaultServerCreds()));if(generalSettings.usc){items.push(newHeader($DESC(8368,"Caching")));items.push(newListItem.call(this,$DESC(8369,"Memory limit"),generalSettings,"ml",MEMORY_LIMIT_LIST));items.push(newCheckItem.call(this,$DESC(8370,"Folder caching"),$DESC(9451,"Store folders information for offline analysis"),generalSettings,"fc",true,false));items.push(newCheckItem.call(this,$DESC(8371,"Clear cache when closed"),$DESC(9452,"Delete reports and documents information after exiting the app"),generalSettings,"cc",2,1));}items.push(newHeader($DESC(8459,"Certificates")));if(generalSettings.ucs!==undefined&&generalSettings.ucs!==""&&generalSettings.ucs){var hasCert=mstrMobileApp.hasCertificate(),certItem,getCertItem;certItem=newViewItem.call(this,"Device Certificate","",getCertificateDetailsView,{fnPress:showPopupDeleteCertificate,hidden:!hasCert});getCertItem=newViewItem.call(this,"Get Certificate","",getCertificateAuthenticationFieldsView,{hidden:hasCert,dependents:[certItem]});certItem.dependents=[getCertItem];items.push(certItem);items.push(getCertItem);}items.push(newViewItem.call(this,$DESC(8447,"Trusted Certificates"),"",getTrustedCertificatesView,{hidden:false}));if(mstrMobileApp.isDPCEnabled()){items.push(newHeader($DESC(9481,"Device Passcode")));items.push(newItem.call(this,$DESC(1905,"Reset"),"",STYLE_BUTTON,{fn:function(){mstrMobileApp.resetDPC();}}));}items.push(newHeader($DESC(9791,"Background Syncing")));items=items.concat(getBackgroundSyncingItems.call(this));return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_GENERAL,fnVal:validateGeneralSettingsChanges,item:item}};}function getMobileServersView(item){var config=this.mobileConfigObj,servers=config.getWebServersList(),items=[];$ARR.forEach(servers,function(server,idx){items.push(newViewItem.call(this,server.nm,"",getEditServerView,{idx:idx,fnPress:showPopup}));},this);return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_SERVERS,item:item}};}function getHomeSettingsView(){var items=[newViewItem.call(this,$DESC(6560,"General Settings"),"",getGeneralSettingsView),newViewItem.call(this,$DESC(8375,"Mobile Servers"),"",getMobileServersView)];if(mstrApp.isTablet()){items.push(newViewItem.call(this,$DESC(1142,"About"),"",getAboutView));}return{title:$DESC(7831,"Settings"),items:items,cfg:{type:TYPE_HOME,isHome:true}};}function saveChanges(cfg,doSave){var type=cfg.type,modifications=MODIFIED_ITEMS[cfg.type];if(modifications){var fnValidate=cfg.fnVal;if(fnValidate){fnValidate.call(this,cfg,modifications);}if(doSave){this.mobileConfigObj.saveConfiguration();}delete MODIFIED_ITEMS[type];}}var $CTRL=mstrmojo.android.controllers.SettingsController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.SettingsController",connectivityChanged:false,init:function(props){this._super(props);this.mobileConfigObj=this.mobileConfigObj||mstrApp.getConfiguration();},start:function(params){var viewFn=params.viewFn;this._super(params);mstrApp.cancelPending();this._viewInfos=[];var view=this.view=this.newView("Settings");this.rootCtrl.updateContent(view,$DESC(7831,"Settings"));generateView.call(this,(viewFn&&eval("("+viewFn+")"))||getHomeSettingsView);},getDefaultMenus:function getDefaultMenus(){return MENUS.HELP;},updateActionToolbar:function updateActionToolbar(tbCfg){var cfg=getCurrentConfig.call(this),cfgType=cfg&&cfg.type,deleteDescId=DELETE_TXT[cfgType],addDescId=ADD_TXT[cfgType];if(addDescId){var menuId=MENU_ADD_SERVER,iconId=19;if(cfgType===TYPE_EDIT_SERVER){menuId=MENU_ADD_PROJECT;iconId=20;}tbCfg.addToolbarBtn(menuId,$DESC(9446,"Add #").replace("#",$DESC(addDescId,"Item")),menuId,true,iconId);}if(deleteDescId){tbCfg.addMenuItem(MENU_DELETE,$DESC(8379,"Delete #").replace("#",$DESC(deleteDescId,"Item")),MENU_DELETE,true,16);}if(!mstrApp.isTablet()&&cfgType!==TYPE_ABOUT&&cfgType!==TYPE_LEGAL){tbCfg.addMenuItem(MENU_ABOUT,$DESC(1142,"About"),MENU_ABOUT,true,21);}return this._super(tbCfg);},handleMenuItem:function handleMenuItem(group,cmdId){var cfg=getCurrentConfig.call(this),type=cfg.type,servers=this.mobileConfigObj.getWebServersList(),isServer=(type===TYPE_EDIT_SERVER);switch(group){case MENU_ABOUT:cacheViewState.call(this,-1);generateView.call(this,getAboutView);break;case MENU_ADD_SERVER:case MENU_ADD_PROJECT:cacheViewState.call(this,-1);if(group===MENU_ADD_SERVER){generateView.call(this,getEditServerView,{nm:$DESC(9447,"New Server"),idx:servers.length});}else{var server=servers[cfg.item.idx];generateView.call(this,getEditProjectView,{nm:$DESC(9448,"New Project"),idx:(server&&server.pl.length)||0});}break;case MENU_DELETE:var collection;if(isServer){collection=servers;}else{if(type===TYPE_EDIT_PROJECT){var idx=cfg.parent.idx;collection=servers[idx]&&servers[idx].pl;}}if(collection){var me=this,item=collection[cfg.idx];var okFn=function(){collection.splice(cfg.idx,1);me.mobileConfigObj.reconcileHomescreen();me.mobileConfigObj.saveConfiguration();me.view.getList(cfg.isHome).set("items",cfg.parent.fnRedraw.call(me,cfg.parent.item).items);me.goBack();me.connectivityChanged=true;};if(item){confirmDelete(item.nm||item.pn,okFn);}else{okFn();}}else{this.goBack();}return false;}return this._super(group,cmdId);},goBack:function goBack(){if(this._super()){return true;}var currentConfig=getCurrentConfig.call(this);saveChanges.call(this,currentConfig,true);var viewInfos=this._viewInfos;viewInfos.pop();if(currentConfig.type===TYPE_EDIT_SERVER&&mstrApp.deviceType===3&&this.mobileConfigObj.getWebServersList().length===0){viewInfos.pop();}var current=getLastViewInfo.call(this);if(!current||(mstrApp.isTablet()&&viewInfos.length===1)){if(this.connectivityChanged){this.rootCtrl.restart();return true;}return false;}showCurrentView.call(this);return true;},goUp:function goUp(){if(!this._super()){$ARR.forEach(this._viewInfos,function(view){saveChanges.call(this,view.cfg);},this);this.mobileConfigObj.saveConfiguration();this.rootCtrl[(this.connectivityChanged)?"restart":"goHome"]();}return true;},jumpTo:function jumpTo(idx,showView){var viewInfos=this._viewInfos,targetIdx=idx+1;$ARR.forEach(viewInfos,function(view,vIdx){if(vIdx>targetIdx){saveChanges.call(this,view.cfg);}},this);viewInfos.splice(targetIdx);if(showView){showCurrentView.call(this);}}});$CTRL.STYLES={HEADER:STYLE_HEADER,BUTTON:STYLE_BUTTON,VIEW_BUTTON:STYLE_VIEW_BUTTON,TEXT:STYLE_TEXT,LIST:STYLE_LIST,CHECK:STYLE_CHECK,IMAGE:STYLE_IMAGE,TEXT_AREA:STYLE_TEXT_AREA,NUMBER:STYLE_NUMBER,TIME:STYLE_TIME};}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.hash","mstrmojo.array");mstrmojo.requiresDescs(8394);var H={FOLDER:1,RESULTSET:2,REPORTS:3,SETTINGS:4,SHAREDLIBRARY:5,SUBSCRIPTIONS:8,HELP:6};var V=1,Q=2,M=3,Z=4;var T=mstrmojo.hash,P=mstrmojo.array;function f(){this.rootView.setUpStatus(this.getCurrent().getUpStatus());}function B(p,q){var o=p&&p.getHomeScreenType();if(!p||(o<V||o>Z)){mstrmojo.err({name:"StartupError",message:p?"illegal default homescreen type, hsc="+o:"no device configuration found."});return false;}if(o>Q){var j=p.getHomeScreen(),k=j.pid,h=j.st;q.did=j.did;var s=j.systemFolder;if(s){q.systemFolder=s;}if(o===Z){var l=j.oi;k=q.pid=l.pid;h=l.st;q.did=l.did;q.csp=!!j.csp;}else{q.projectID=k;T.copyProps(["promptsAnswerXML","elementsPromptAnswers","valuePromptAnswers","objectsPromptAnswers","reportViewMode"],j,q);if(parseInt(q.reportViewMode,10)===2){h=769;}}mstrApp.setCurrentProjectId(k);q.st=h;}this.initHomeScreen(o,q);}var b=mstrmojo.android.controllers.RootController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.RootController",start:function G(){var h=mstrApp.getConfiguration(),j={hsc:true};this._lastOpened=P.filter(this._lastOpened,function(k){return !!h.getProject(k.projectID||k.pid);});B.call(this,h,j);},direct:function C(h){var j=new mstrmojo.MobileConfiguration({_cfg:h});mstrApp.closeAllDialogs();B.call(this,j,{});},restart:function W(){mstrApp.closeAllDialogs();var h=this.nextController;if(h){h.destroy();}this.start();},initHomeScreen:function I(h,j){this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(j.st),j),j);},initNav:function d(){var h=mstrApp.getConfiguration(),j=[{n:mstrmojo.desc(1873,"Home"),act:-1,fromNav:true}];if(h.isSubscriptionEnabled()){j.push({n:mstrmojo.desc(1089,"Subscriptions"),act:8,fromNav:true});}this.rootView.setNavigation(j,0);},updateLastOpened:function S(k){var j=this._lastOpened,h=mstrApp.getCurrentProjectId(),l;if(k){l=k.did||k.documentID||k.reportID||k.objectID;mstrmojo.array.forEach(j,function(p,o){if(p.xId===l&&p.projectID===h){j.splice(o,1);return false;}});}this.rootView.updateLastOpened(j);if(k){j=this._lastOpened=[T.copy(k,{projectID:h,xId:l})].concat(j);if(j.length>5){j.pop();}}},updateProperties:mstrmojo.emptyFn,updateFolder:function X(j,k,h){f.call(this);},updatePrompts:function U(h,j){this.updateContent(h,j);},updateTransactions:mstrmojo.emptyFn,closeTransactions:mstrmojo.emptyFn,updateContent:function O(j,l,h){var k=this.rootView;if(l!==undefined){this._lastTitle=l;k.setTitle(l);k.clearNavigation();}if(j){k.setContent(j,h);}f.call(this);},contentUpdated:function K(h){this.rootView.contentUpdated(h);},restoreNavigation:function a(){this.rootView.restoreNavigation();},updateDisplayMessage:mstrmojo.emptyFn,setActionToolbarStatus:function J(h){this.rootView.setActionToolbarStatus(h);},getTitle:function L(){return this._lastTitle||"";},jumpTo:function R(h){var j=h.act;if(j){if(!h.fromNav){if(!this.rootView.hasNavigationItems()){this.initNav();}else{this.restoreNavigation();}this.rootView.selectNavigationItem(h);}if(j===-1){this.restart();}else{if(j===H.SHAREDLIBRARY){this.spawn(mstrApp.controllerFactory.newController("Projects",{hsc:true}));}else{if(j===H.SUBSCRIPTIONS){this.spawn(mstrApp.controllerFactory.newController("Subscriptions",{hsc:true}));}}}return ;}this._super(h);},goHome:function E(){mstrApp.closeAllDialogs();var h=this.nextController;if(h){h.makeHome();}},makeCurrent:mstrmojo.emptyFn,setActionToolbar:function N(j,h){this.rootView.setActionToolbar(j,h);},enterFullScreen:function Y(){this.rootView.enterFullScreen();},flashFullScreen:function g(){this.rootView.flashFullScreen();},exitFullScreen:function D(h,j){this.rootView.exitFullScreen(h);},cancelFlashFullScreen:function A(){return this.rootView.cancelFlashFullScreen();},onorientationChange:function F(h){this._super(h);this.rootView.reset();this.raiseEvent({name:"rootOrientationChange",isLandscape:!!this.orientation});}});b.EnumHSType={DEFAULT:V,CUSTOM:Q,RESULTSET:M,FOLDER:Z};}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ActionBar","mstrmojo.hash");mstrmojo.android.medium.ui.ActionBar=mstrmojo.declare(mstrmojo.android.ui.ActionBar,null,{scriptClass:"mstrmojo.android.medium.ui.ActionBar",setNavigation:function A(H,I){this.title.setListItems(H,I);},restoreNavigation:function F(){var H=this._lastNav;if(H){this.title.setListItems(H.items,H.idx);}},clearNavigation:function B(){var H=this.title.clearListItems();if(H){this._lastNav=H;}},getNavList:function C(){return this.title.list;},onExitFullScreen:function G(){this.propogateMenuVisibleChange(true);},onEnterFullScreenEnd:function E(){this.propogateMenuVisibleChange(false);},propogateMenuVisibleChange:function D(H){this.toolbar.propogateMenuVisibleChange(H);}});mstrmojo.android.ui.ActionBar.adjustLayoutConfig({160:48,213:64,240:72,320:96});}());(function(){mstrmojo.requiresCls("mstrmojo.TextFieldDIC","mstrmojo.android._HasPreviewButton");mstrmojo.android.inputControls.TextFieldDIC=mstrmojo.declare(mstrmojo.TextFieldDIC,[mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",cssDisplay:"block",onfontChange:mstrmojo.emptyFn,applyChanges:function F(){this.domNode.blur();return this._super();},handleInvalid:function A(){mstrmojo.alert(this.validationStatus.msg);},cancelChanges:function D(){this.domNode.blur();this._super();},focus:function B(){this.validate();},onfocus:function E(){if(this.value!=undefined&&this.maxLength!=undefined&&String(this.value).length>this.maxLength){this.set("value","");}window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},renderPreview:function C(){var I=this.openerNode,J=this.group||this,H=(J.openerType===2)||!!this.dic.dm||this.dicChanged;var G=this.type==="password"?"********":this.dv;this.renderPreviewButton(I,H?G:I.innerHTML);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Magnifier","mstrmojo.hash");var A="xtab-selected-cell";mstrmojo._HasMagnifier={scriptClass:"mstrmojo._HasMagnifier",magnifiedNode:null,magnifier:null,magnifierHelper:null,onmagnifiedNodeChange:function(C){var E=C.valueWas,D=C.value;if(E){mstrmojo.css.removeClass(E,A);}if(D){mstrmojo.css.addClass(D,A);}},displayMagnifier:function B(J,F){var H=this.magnifierHelper,C=H.resolveTouchEvent(J),I,E,D;if(C){E=C.cell;D=C.pos;if(E!=this.magnifiedNode){I=H.resolveInfoToDisplay(C);if(I){this.set("magnifiedNode",E);if(!this.magnifier){var G=this;this.magnifier=mstrApp.showPopup(mstrmojo.hash.copy({scriptClass:"mstrmojo.Magnifier",onClose:function(){G.magnifier=null;G.set("magnifiedNode",null);},helper:H},F),E);}this.magnifier.updateContent();this.magnifier.resizeAndPosition(D);}else{if(this.magnifier){this.magnifier.close();}}}else{if(this.magnifier){this.magnifier.moveTo(D);}}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=(Y)?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=(Y)?0:U-1;}else{V+=(Y)?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(j){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,h=this._last_hit;if(!this.noCache&&(d||h)){var g=this.filterCandidates(a,j,this.REQUEST_THRESHOLD),b=g.length,f=this.suggestCount,U=false;if(!X&&b<f){var V=h&&h.pattern;if(h&&V&&(j.indexOf(V)>-1)){U=true;var l=this.filterCandidates(h.items,j,this.REQUEST_THRESHOLD),Y=l&&l.length,W=mstrmojo.array,k=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(g,k,l[Z][k])===-1){g.push(l[Z]);}}b=g.length;}}if(!X&&((j.length>2&&b<this.REQUEST_THRESHOLD)||(b<f))){this.requestCandidates(j);return -1;}return(b<f)?g:g.slice(0,f);}this.requestCandidates(j);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(f){if(!f){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var k=d.getSearchPattern(),a=f.items;X._last_hit={items:a,pattern:U};X.sz=f.sz;if(!X.noCache&&a){var g=X.candidates&&X.candidates.items||[],h=[].concat(a);for(var Z=0,b=a.length;Z<b;Z++){var Y=h[Z];if(mstrmojo.array.indexOf(g,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=g.concat(a);}}if(k&&k.indexOf(U)>-1){var j=X.filterCandidates(a,k);X.updateSuggestion(j);}},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:((V)?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var V=this.zIndex;this.openPopup("ob",{zIndex:(V&&(V+10))||110});this.ob.browser.browse({folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes});this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopup:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInputBox-suggest",showTitle:false,modal:false,autoClose:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U&&U.autoSelect){this.list.singleSelect(0);}},onClose:function F(){this.list.clearSelect();if(this.opener){this.opener.suggestionShown=false;}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.android.Popup","mstrmojo.array","mstrmojo.android.TextArea","mstrmojo._TouchGestures","mstrmojo.android.ui.Button","mstrmojo.dom","mstrmojo.css","mstrmojo.hash");mstrmojo.requiresDescs(1442);var Q=mstrmojo.css,D=mstrmojo.dom,K=mstrmojo.array,M=mstrmojo.hash;var T=mstrmojo.android.Dialog=mstrmojo.declare(mstrmojo.android.Popup,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.Dialog",autoClose:false,btnVisible:true,init:function N(V){this._super(V);var U=["dialog"];if(this.title){U.push("has-ttl");}if(V.anchor){this.curtainPosition=mstrApp.getContentPosition();}Q.addWidgetCssClass(this,U);},preBuildRendering:function A(){var W=this.buttons;if(W&&!this.btnHbox){var U=this,X=this.id,V=function(){if(!U.manualClose){window.setTimeout(function(){var Y=mstrmojo.all[X];if(Y){Y.close();}},50);}};K.forEach(W,function(Y){Y.origFn=Y.onclick;Y.onclick=function(Z){if(this.origFn){if(this.origFn()===false){return ;}}V();Z.e.stopPropagation();Z.e.cancelBubble=true;};});}this._super();},postBuildRendering:function O(){if(this.onTitleClick){var U=this.id;D.attachEvent(this.titleNode,"click",function(V){mstrmojo.all[U].onTitleClick(V);});}return this._super();},getResizeHandler:function F(){var V=this.id,U=function(){var W=mstrmojo.all[V];if(W.dialogRefresh){W.dialogRefresh();}else{W.resizeDialog();W.positionDialog();}};return U;},resizeDialog:function C(){this._super();var g=this.buttons&&this.buttons.length;if(g){var V=this.buttonNode,X=this.btnVisible;if(!X){this.set("btnVisible",true);}var W=this.btnHbox.children,f=Q.getComputedStyle,U=f(V),b=f(W[0].domNode);var Y=V.clientWidth-parseInt(U.paddingLeft,10)-parseInt(U.paddingRight,10),d=parseInt(b.paddingLeft,10)+parseInt(b.paddingRight,10)+parseInt(b.borderLeftWidth,10)+parseInt(b.borderRightWidth,10),a=Y-(g*d);var Z=Math.floor(a/g);K.forEach(W,function(h){h.set("width",Z+"px");});this.set("btnVisible",X);}},resizeCurtain:function R(){var X=this.curtainNode,U=document.body,W=X.style,V=this.curtainPosition;W.width=U.scrollWidth+"px";if(V&&V.h){W.height=V.h+"px";}else{W.height=U.scrollHeight+"px";}if(V&&V.y){W.top=V.y+"px";}this.raiseEvent({name:"resizeCurtain"});},setButtonVisibility:function B(U){this.buttonNode.style.display=U?"block":"none";},createTitleBarButton:function S(V,U,W){var X=document.createElement("div");X.className=V;X.setAttribute("title",W||"");X[(mstrApp.isTouchApp())?"ontouchend":"onclick"]=U;this.titleNode.appendChild(X);}});var G=M.copy(T.prototype.markupMethods);G.onbtnVisibleChange=function(){this.buttonNode.style.display=(this.btnVisible)?"block":"none";};T.prototype.markupMethods=G;if(window.mstrConfig&&!window.mstrConfig.simpleDialog){var E=function(U){return[{scriptClass:"mstrmojo.android.TextArea",text:U,cssClass:"mstrmojo-androidAlert",isElastic:true}];};mstrmojo.alert=function L(W,U,V){mstrApp.showDialog({title:V||"MicroStrategy Mobile",buttons:[mstrmojo.android.ui.Button.newButton(mstrmojo.desc(1442,"OK"),function(){if(U){U();}})],children:E(W)});};mstrmojo.confirm=function H(W,U,V){mstrApp.showDialog({title:V||"MicroStrategy Mobile",buttons:U,children:E(W)});};mstrmojo.toast=function I(V,U){mstrApp.showToastNotification(V,U||3500);};mstrmojo.mask={show:function P(U){mstrMobileApp.showProgress([U||""],false);},hide:function J(){mstrMobileApp.hideProgress();}};}}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl","mstrmojo.css");mstrmojo.android.inputControls.RadioListDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.android.inputControls.RadioListDIC",styleCssClass:"radio",init:function(B){this._super(B);this.items=this.getItems();this.itemsPerRow=this.dic.ipr||0;},ontouchend:function(B){this.onclick(B);},setDirtyFlag:function A(C,B){mstrmojo.css.addClass(this.itemsNode||B,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,C={0:"default",1:"stars_dots"};mstrmojo.RatingDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RatingDIC",styleCssClass:"rate",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover,mouseout><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',lastIdx:null,init:function(D){this._super(D);this.items=this.getItems();this.starCount=this.items&&this.items.length;B.addWidgetCssClass(this,C[this.dic.stl||0]);},setRating:function(D){var F=0,G=this.starCount,E="less_equal";if(this.lastIdx==undefined||this.lastIdx!=D){for(;F<G;F++){if(F<=D){B.addClass(this._getItemNode(F),E);}else{B.removeClass(this._getItemNode(F),E);}}this.lastIdx=D;}},onvalueChange:function(){this._super&&this._super();var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},onmouseover:function(E){this._super&&this._super(E);var F=E.target||A.eventTarget(E.hWin,E.e),D=F&&F.getAttribute("idx");if(D!=undefined){this.setRating(D);}},onmouseout:function(E){this._super&&this._super(E);var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}var D=mstrmojo.array.find(this.items,"v",this.value);if(D>-1){this.setRating(D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl");function A(E){var D=[];mstrmojo.array.forEach(E,function(F){D.push(F.n);});return D;}mstrmojo.LikertScaleDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.LikertScaleDIC",styleCssClass:"scale",init:function(D){this._super(D);this.items=this.getItems();this.titleItems=A(this.items);},getDisplayValue:function B(){return(this.selectedIndex>=0)?this.items[this.selectedIndex].n:this.dv;},getLeftEndTitle:function C(D){return D>=0?(this.dic.mint||""):"";},getRightEndTitle:function(D){return D>=0?(this.dic.maxt||""):"";},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabGraph","mstrmojo.TouchScroller","mstrmojo.graph._MobileGraphAreaHelper","mstrmojo._TouchGestures");var F=mstrmojo.dom;function C(O,L,R){var N=mstrmojo.dom.position(O.domNode,false),Q=0,P=0,M=O.node;if(N){Q=N.x;P=N.y;}O.model.getDataService().handleUserSingleTap(M.data.sid,M.k,L-Q,R-P,false,{success:function(S){O.displayTooltips(S.Areas,Q,P);}});}function J(P){var O="",L=[],S,R,M,N,Q,T;if(!P){return O;}S=P.currlaykey;O=S+"_";R=P.data&&P.data.layouts;for(Q=0;Q<(R.length||0);Q++){N=R[Q];if(N.k===S){M=N;break;}}if(M){if(M.gbys){L=M.gbys.groupbys;for(Q=0;Q<(L.length||0);Q++){T=L[Q];O=O+T.k+":"+T.lvl;if(T.unit){O=O+":"+T.unit.idx;}O=O+"_";}}}return O;}function K(S){this.displayTooltips([],0,0);var N=this,O=this.model.getDataService(),R=mstrmojo.dom.position(this.domNode,true),L=S.pageX-R.x,Q=S.pageY-R.y,M={getBoundingClientRect:function(){var U=S.pageX,T=S.pageY;return{left:U,top:T,right:U+1,bottom:T+1};}},P={success:function(V){var U=V.Areas,W=N.defn,T=N.k,X=V.tks;if(U&&U.length>0){if(U[0].Selectable===1){N.highlightArea(N.selectionNode,U);}else{if(U[0].Selectable===-1){N.highlightedAreas=[];N.clearHighlightArea(N.selectionNode);}}if(X){N.showInfoWin(X,M);}}else{N.highlightedAreas=[];N.clearHighlightArea(N.selectionNode);}window.setTimeout(function(){mstrMobileApp.forceRepaint();N.model.slice({type:parseInt(W.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:T,ck:W.ck,gk:T,sid:N.node.data.sid,x:L,y:Q,tks:X,anchor:M});},0);}};O.handleUserSingleTap(N.node.data.sid,N.k,L,Q,true,P);}function A(M){var L=this.imgNode;if(L.src!==M){L.src=M;F.translate(L,0,0,0);}}mstrmojo.MobileDocXtabGraph=mstrmojo.declare(mstrmojo.DocXtabGraph,[mstrmojo._TouchGestures,mstrmojo.graph._MobileGraphAreaHelper],{scriptClass:"mstrmojo.MobileDocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" {@extra}/>',retrieveGraphSrc:function G(N,L){var O=this.id,M=this.model;if(parseInt(N,10)>0&&parseInt(L,10)>0){M.getDataService().getRWGraphImage({w:L,h:N,k:this.k,sid:this.node.data.sid,gbk:J(M)},M.newCallback({success:function(P){A.call(mstrmojo.all[O],P);}}));}},invalidate:function E(){A.call(this,"");},showTooltip:function I(){},touchSelectBegin:function D(L){this.restoreDefaultTouches(false);C(this,L.pageX,L.pageY);},touchSelectMove:function H(L){this.restoreDefaultTouches(false);C(this,L.pageX,L.pageY);},touchTap:function B(L){this.restoreDefaultTouches(false);K.call(this,L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileGraph","mstrmojo.graph._CanvasGraph");mstrmojo.graph.MobileXtabCanvasGraph=mstrmojo.declare(mstrmojo.MobileGraph,[mstrmojo.graph._CanvasGraph],{scriptClass:"mstrmojo.graph.MobileXtabCanvasGraph"});}());(function(){var N,J;mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DocPortlet");var Q={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};mstrmojo.Vis=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,updated:false,reRenderOnDimensionChg:true,getFormats:function(){return this.fmts;},isVis:function(){return true;},setModel:function L(V){this.set("model",V);if(V.data){this.set("model",V.data);}this.xtabModel=V;if(typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function S(){this._super();var V=this.xtabModel;if(V&&V.destroy){V.destroy();delete this.xtabModel;}},setDimensions:function O(X,W){var V=this._super(X,W);if(V&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return V;},reRender:function F(){this.unrender();this.render();},getWidth:function B(){return parseInt(this.width,10);},getHeight:function I(){return parseInt(this.height,10);},buildRendering:function H(){if(!this.updated){this.update();}if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function E(){N=this.width;J=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function A(){var V=this.domNode,W={top:0,left:0};if(typeof (mstr)!="undefined"){W.top=mstr.utils.BoxModel.getElementSumOffsetTop(V);W.left=mstr.utils.BoxModel.getElementSumOffsetLeft(V);}else{if(typeof (mstrmojo)!="undefined"){W=mstrmojo.boxmodel.offset(V);}}this.offsetTop=W.top;this.offsetLeft=W.left;},initFromVisProps:function R(V){},update:function G(X){X=X||this.node;if(X){if(X.data){this.set("model",X.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",X.data);}this.model=X.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(X.data.extProps,this);}this.fmts=X.defn.fmts||X.defn.units[this.model.k].fmts;var V=this.fmts;if(V){for(var W in Q){v=Q[W];if(W in V){this[v]=V[W];}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;},getModel:function M(W){if(W){var V=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,W);if(V){return V.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));}}else{return this.model;}},getDataParser:function K(V){return new mstrmojo.Vis.DataParser(this.getModel(V));},renderErrorMessage:function T(V){this.domNode.innerHTML='<div class="mstrmojo-message">'+V+"</div>";},getMessageID:function D(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function U(Y){var h=this.xtabModel,g=(h&&h.docModel);var k=false;if(g){var f=g.defn&&g.defn.layouts,X=null;var W;if(f){for(W in f){if(f[W].loaded){X=f[W];break;}}}var Z=X&&X.units;this.selectorTargets={};if(Z&&Y.scObjList){for(var W=0;W<Y.scObjList.length;W++){var a=Y.scObjList[W];var b=a.sc.tks.split("\x1E");for(var V=0;V<b.length;V++){var d=Z[b[V]];if(d){this.selectorTargets[b[V]]=d;if(!this.isChildOfIfw(Z,d)){k=true;}}}}}}return k;},isChildOfIfw:function C(V,W){while(W){if(W.ifw){return true;}W=V[W.pnk];}return false;},performAction:function P(V){var X=this.xtabModel.getAction(V),W=X&&X.h;if(W&&this.controller[W]){this.controller[W](this,X.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(V,d,W){var a=d;var Y=V.getChildren(d,false);for(var X=0;X<Y.length;X++){var b=Y[X];if(b.k==W){return b;}else{var Z=mstrmojo.Vis.getVisGrid(V,b,W);if(Z){d=a;return Z;}}}};mstrmojo.Vis.DataParser=function(X){var g=mstrmojo.Vis;return{getRowTitles:function(){return new g.Titles(X,true);},getColTitles:function(){return new g.Titles(X,false);},findMetricValue:function(k,q){var p=X.ghs.rhs.items;for(var l in p){var o=p[l].items;var j=true;for(var h in k){if(k[h]!=o[h].idx){j=false;break;}}if(j){return new mstrmojo.Vis.MetricValue(X.gvs.items[l].items[q]);}}},getTotalRows:function a(){return X.eg?0:X.ghs.rhs.items.length;},getTotalColHeaderRows:function Y(){return(!X.ghs.chs.items?0:X.ghs.chs.items.length);},getTotalCols:function V(){return this.getColHeaders(0).size();},getRowHeaders:function f(h){return new g.Headers(X,h,true);},getColHeaders:function d(h){return new g.Headers(X,h,false);},getMetricValue:function b(j,h){return new g.MetricValue(X,X.gvs.items[j].items[h]);},getColumnHeaderCount:function Z(){return X.gvs.items[0].items.length;},getCSSString:function W(){return X.cssString;}};};mstrmojo.Vis.Titles=function(V,a){var Z=(a)?V.gts.row:V.gts.col;return{size:function Y(){return Z.length;},getTitle:function X(b){return new mstrmojo.Vis.Title(Z[b]);},getCSS:function W(b){return V.css[Z[b].cni].n;}};};mstrmojo.Vis.Headers=function(W,X,b){var d=(b)?W.gts.row:W.gts.col;var a=(b)?W.ghs.rhs:W.ghs.chs;var Y=a.items&&a.items[X].items;return{size:function f(){return(!Y?0:Y.length);},getHeader:function V(g){return Y&&Y[g]&&new mstrmojo.Vis.Header(Y[g],b?d[g]:d[X]);},getCSS:function Z(g){return Y&&W.css[Y[g].cni].n;},getHeaderCell:function(g){return Y&&Y[g];}};};mstrmojo.Vis.Title=function(W){return{getActionType:function(){return W.at;},getDrillPath:function(){return W.dp;},getHeaderValues:function V(){return W.es;},getHeaderName:function X(Z){return W.es[Z].n;},getHeaderId:function X(Z){return W.es[Z].id;},getForms:function Y(){return W.fs;},getFormId:function(){return W.fid;},getFormType:function(){return W.ftp;},getUnitId:function(){return W.id;},getLinkMap:function(){return W.lm;},getName:function(){return W.n;},getUnitDssType:function(){return W.otp;},getSelectorControl:function(){return W.sc;}};};mstrmojo.Vis.Header=function(X,V){return{getName:function Z(){return(X.idx===-1)?"":V.es[X.idx].n;},getElementId:function d(){return(X.idx===-1)?"":V.es[X.idx].id;},getObjectId:function Y(){return(X.idx===-1)?"":V.es[X.idx].oid;},getElementIndex:function W(){return X.idx;},getActionType:function b(){return X.at;},isTotal:function a(){return X.otr===1;}};};mstrmojo.Vis.MetricValue=function(V,d){var b=d;return{getValue:function W(){return b.v;},getThresholdType:function X(){return b.ty;},getRawValue:function a(){return b.rv;},getCSS:function Y(){return V.css[b.cni].n;},getThresholdValue:function f(g){if(b.ti==undefined){return g;}return V.th[b.ti].n;},getFillColor:function Z(g){if(b.ci==undefined){return g;}return V.fc[b.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.android.inputControls.CheckBoxDIC");mstrmojo.android.inputControls.MarkRowDIC=mstrmojo.declare(mstrmojo.android.inputControls.CheckBoxDIC,null,{scriptClass:"mstrmojo.android.inputControls.MarkRowDIC",isSwitchStyle:false,oncheckedChange:function(){if(this.markAll){var B=this.group&&this.group.widgetsMap,A;for(A in B){if(B.hasOwnProperty(A)){if(B[A].checked!==this.checked){B[A].set("checked",this.checked);}}}}else{this._super();}},postBuildRendering:function(){this._super();this.domNode.style.height="30px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo._HasTouchScroller","mstrmojo.css");var L=mstrmojo.css;var N=15;function K(R){var Q=mstrmojo.dom.findAncestorByAttr(R.target,"clk",true,this.domNode);return Q||null;}function J(){var R=this._scroller;var T=this.timeSelectorListContainer.width;var Q=this.timeSelectorList.offsetWidth;if(Q>T){this.scrollPast=true;}var U=Q>T?Q-T:0;R.origin={x:0,y:0};R.showScrollbars=true;R.noHScroll=false;R.hScroll=(U!==0&&R.noHScroll!==true)||this.scrollPast;if(R.hScroll){R.offset={x:{start:0,end:U},scrollPast:this.scrollPast};}var S=this.timeSelectorList;this.widget.utils.translateCSS(0,0,false,S);}mstrmojo.VisTimeSeriesTimeSelector=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisTimeSeriesTimeSelector",scrollerConfig:{bounces:false,showScrollbars:true,useTranslate3d:true},scrollPast:false,isAndroidTab:false,offsetx:0,widget:null,markupString:'<div id="{@id}-TimeSelector-Container" class="mstrmojo-timeseries-timeselector-div" style="position:absolute; left:{@offsetx}px; overflow:hidden;"><div id="{@id}-TimeSelector-List" style="position:absolute;left:0;top:0"></div></div>',markupSlots:{timeSelectorListContainer:function(){return this.domNode;},timeSelectorList:function(){return this.domNode.firstChild;}},toggleSelected:function C(U,T){if(!U){return ;}var S=U.style;var V=this.widget;var R=V.utils.rgb2rgbStr(V.formatProp.textClr);var Q=V.utils.rgb2rgbStr(V.formatProp.backgroundClr);if(T){S.backgroundColor=R;S.color=Q;}else{S.backgroundColor="";S.color=R;}},toggleGlowEffect:function B(Q,R){if(!Q){return ;}if(R){L.applyShadow(Q,0,0,20,this.widget.glowColor);}else{L.removeShadow(Q);}},drawTimeSelectorLabels:function H(){var V=this.widget.baseModel.vp.rl;var b=this.chartStatus;if(V){var Y=this.widget,W=Y.margin,f=Y.utils,R=Y.getWidth(),U=0;this.timeSelectorListContainer.width=R-W.l-W.r;this.timeSelectorListContainer.style.width=(R-W.l-W.r)+"px";this.timeSelectorListContainer.style.height=W.t+"px";var X=V.length;var a=(R-W.l-W.r)/(X+1);var Q=Y.id,S=this.timeSelectorList;if(S.childNodes.length==0){Y.currSelection=null;for(var T=0;T<X;T++){var Z=document.createElement("div");Z.id="timeseries-intervals";Z.className="timeseries-intervals";Z.style.fontWeight="bold";Z.style.fontFamily="Arial";Z.style.fontSize=N+"px";Z.innerHTML=V[T].n;Z.setAttribute("clk","S");Z.setAttribute("value",T);Z.style.position="relative";Z.style.whiteSpace="nowrap";Z.style.cssFloat="left";if(T===0&&b.currSelectionIdx==-1&&!b.usingCustomInterval){this.toggleSelected(Z,true);Y.currSelection=Z;}else{if(!b.usingCustomInterval&&b.currSelectionIdx==T){this.toggleSelected(Z,true);Y.currSelection=Z;}else{this.toggleSelected(Z,false);}}S.appendChild(Z);offsetWidth=Z.offsetWidth;U+=offsetWidth;spaceWidth=offsetWidth<a?a-offsetWidth:20;U+=spaceWidth;if(T==0){S.insertBefore(this.createWhiteSpace(spaceWidth),S.firstChild);U+=spaceWidth;}S.appendChild(this.createWhiteSpace(spaceWidth));}}else{var h=S.childNodes;var g=h.length;for(var T=0;T<g;T++){var Z=h[T];offsetWidth=Z.offsetWidth;U+=offsetWidth;if(T==0){continue;}spaceWidth=offsetWidth<a?a-offsetWidth:20;U+=spaceWidth;if(T==1){h[0].style.paddingLeft=spaceWidth+"px";}T++;h[T].style.paddingLeft=spaceWidth+"px";}}this.timeSelectorList.style.width=U+"px";}},postBuildRendering:function E(){N=Math.round(15*this.widget.utils.getScreenZoomFactor());this.scrollerConfig.scrollEl=this.timeSelectorList;if(this._super){this._super();}this.drawTimeSelectorLabels();J.call(this);},reRender:function I(){this.drawTimeSelectorLabels();J.call(this);},createWhiteSpace:function F(R){var Q=document.createElement("div");Q.style.height="30px";Q.style.position="relative";Q.style.whiteSpace="nowrap";Q.style.cssFloat="left";Q.style.paddingLeft=R+"px";return Q;},initScroller:function M(Q){Q.hScroll=true;this._super(Q);},touchBegin:function D(Q){this.widget.hiddenTooltipAndShowTimeSelector();},touchSelectEnd:function P(R){var Q=this.widget.currSelection;if(Q){this.toggleGlowEffect(Q,false);}},touchSelectBegin:function G(S){var Q=K.call(this,S);if(Q){var R=Q.value;if(R==="S"){this.widget.timeSelectorOnClick(Q);}}},touchTap:function A(S){var Q=K.call(this,S);if(Q){var R=Q.value;if(R==="S"){this.widget.timeSelectorOnClick(Q);}}this.toggleGlowEffect(this.widget.currSelection,false);},destroy:function O(){if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.VisChartUtils","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.color","mstrmojo.array","mstrmojo.css");var Ay=true;var Bi="0",T="1",A8="2";var Ak=0,AI=1,AG=2;var o=0,Ao=1,AR=2;var b=0,AP=1,Ba=2;var AB=0,w=1;var p=1,W=0.01;var V=0.3,G=0.3,D=0.3;var j=0,A3=1,AT=2;var Ai=0,t=1;var k=1,AZ=2,BQ=4;var AV=1,BD=2;var Ad="#FFFFFF";var Ap="RGBA(139,139,139,0.8)",Ar="RGBA(33,195,255,0.8)",A4="RGBA(195,195,195,0.8)",A6="RGBA(112,168,207,0.8)",Aw="#4C4C4C",AS="#FFFFFF",Be=0.8,AL=0.7,x=1,q=0.5,H=0.5,BR=1,BE=0.7,Aq=0.5,AE=0.7,BN=1,BI="#FFFFFF",J="#000000",AC="#FFFFFF",An="#000000",U="#FFFFFF",BB="#000000",At="RGBA(0,0,0,0)",Ab="RGBA(0,0,0,0)",Au="RGBA(33,195,255,0.8)",f="RGBA(31,119,180,0.8)",X="RGBA(129,129,129,0.8)",Bf="RGBA(129,129,129,0.8)",Ax=0.8,AH=0.5,h=1,A5=0.8,AM="RGBA(129,129,129,0.8)",BM="RGBA(129,129,129,0.8)",AX="RGBA(129,129,129,0.8)",S="RGBA(129,129,129,0.8)",BO="RGBA(255,255,255,0.8)",BX="RGBA(0,0,0,0.8)",Bd="#FFFFFF",Al="#000000";var Y="#FFF",C="#000";var BL=300;function N(Bk){var Bj;for(Bj in Bk){if(Bk.hasOwnProperty(Bj)){return false;}}return true;}function BG(Bk){var Bj=mstrmojo.color.hex2rgb(Bk);mstrmojo.array.forEach(Bj,function(Bm,Bl){Bj[Bl]=Math.floor(Bm*0.75);});return"rgb("+Bj.join(",")+")";}function BU(Bn,Bk,Bj){var Bm=Bn.style,Bo="translate("+Bk+"px, "+Bj+"px)",Bl=Bo.replace("late(","late3d(").replace("px)","px, 0)");Bm.MozTransform=Bo;Bm.msTransform=Bo;Bm.webkitTransform=Bl;Bm.transform=Bl;}function P(Bl,Bv,Bu){var Br=Bl.length,Bo=false,Bn,Bj,Bw,Bq,Bm,Bt,Bk,Bs,Bp;if(Br/2<3){return false;}Bw=Bl[Br-2];Bq=Bl[Br-1];for(Bp=0;Bp<Br;Bp=Bp+2){Bn=Bl[Bp];Bj=Bl[Bp+1];if(Bn>Bw){Bm=Bw;Bk=Bn;Bt=Bq;Bs=Bj;}else{Bm=Bn;Bk=Bw;Bt=Bj;Bs=Bq;}if((Bn<Bv)===(Bv<=Bw)&&((Bu-Bt)*(Bk-Bm)<(Bs-Bt)*(Bv-Bm))){Bo=!Bo;}Bw=Bn;Bq=Bj;}return Bo;}function AU(Bv,Bt,Bl,Bu,Br,Bk){try{var B0=Bl?Bl.x:0,By=Bl?Bl.y:0;var Bj=function(B1){var B2=B1%2?By:B0;return Bq[B1]+B2;};var Bx,Bw;for(Bx=0;Bx<Bt.length;Bx++){var Bq=Bt[Bx];Bv.beginPath();Bv.moveTo(Bj(0),Bj(1));for(Bw=2;Bw<Bq.length-1;Bw=Bw+2){var Bn=Bj(Bw),Bs=Bj(Bw+1);Bv.lineTo(Bn,Bs);}var Bp=Bj(0),Bo=Bj(1),Bm=Bk;Bv.lineTo(Bp,Bo);Bv.fillStyle=Bm;Bv.fill();Bv.strokeStyle=Bu;Bv.lineWidth=Br;Bv.stroke();}}catch(Bz){}}function L(Bl,Bm,Bn,Bk,Bj){Bl.fillStyle=Bk;Bl.beginPath();Bl.arc(Bm[0]+Bn.x,Bm[1]+Bn.y,Bj,0,Math.PI*2,true);Bl.closePath();Bl.fill();}function R(Bl,Bm,Bn,Bk,Bj,Bo){Bl.strokeStyle=Bk;Bl.lineWidth=Bo;Bl.beginPath();Bl.arc(Bm[0]+Bn.x,Bm[1]+Bn.y,Bj,0,Math.PI*2,true);Bl.closePath();Bl.stroke();}function AK(Bk){if(Bk){var Bj;for(Bj in Bk){if(Bk.hasOwnProperty(Bj)){if(Bj==="bgImage"){continue;}if(Bk[Bj][0]){if(Bk[Bj][0].length===2){return AR;}else{if(Bk[Bj][0].length>2){return Ao;}else{return o;}}}else{return o;}}}}else{return o;}}function AA(Bo){var Bn=0,Bm=0;i;for(i=0;i<Bo.length;i++){Bn=Bn+Bo[i];i++;Bm=Bm+Bo[i];}var Bl=Bn/(Bo.length/2),Bk=Bm/(Bo.length/2),Bj=[Bl,Bk];center2=[];center2.push(Bj);return center2;}function BH(Bs){if(Bs==null||Bs.length<4){return null;}var Bj=0,Bm=Bs.length,Bl,Br,Bq,Bp,Bo;for(Bl=0;Bl<Bm-2;Bl+=2){Br=Bs[Bl];Bq=Bs[Bl+1];Bp=Bs[Bl+2];Bo=Bs[Bl+3];Bj+=(Br*Bo-Bp*Bq);}Br=Bs[Bm-2];Bq=Bs[Bm-1];Bp=Bs[0];Bo=Bs[1];Bj+=(Br*Bo-Bp*Bq);Bj=Math.abs(Bj/2);if(Bj<=0){return null;}var Bk=[0,0];for(Bl=0;Bl<Bm-2;Bl+=2){Br=Bs[Bl];Bq=Bs[Bl+1];Bp=Bs[Bl+2];Bo=Bs[Bl+3];Bk[0]+=((Br+Bp)*(Br*Bo-Bp*Bq));Bk[1]+=((Bq+Bo)*(Br*Bo-Bp*Bq));}Br=Bs[Bm-2];Bq=Bs[Bm-1];Bp=Bs[0];Bo=Bs[1];Bk[0]+=((Br+Bp)*(Br*Bo-Bp*Bq));Bk[1]+=((Bq+Bo)*(Br*Bo-Bp*Bq));Bk=[Math.abs(Bk[0]/(Bj*6)),Math.abs(Bk[1]/(Bj*6))];var Bn=[];Bn.push(Bk);return Bn;}function BZ(Bl,Bm){var Bp,Bn;var Bo=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(Bl){var Bk;if(/^(rgba|RGBA)/.test(Bl)){var Bj=Bl.replace(/rgba\(|RGBA\(/,"");Bj=Bj.replace(")","");Bk=Bj.split(",");Bp="RGBA("+Bk[0]+","+Bk[1]+","+Bk[2]+","+Bm+")";return Bp;}else{if(/^(rgb|RGB)/.test(Bl)){Bk=Bl.replace(/rgb\(|RGB\(/,"");Bk=Bk.replace(")","");Bp="RGBA("+Bk+","+Bm+")";return Bp;}else{if(Bo.test(Bl)){if(Bl.length===4){Bk="#";for(Bn=1;Bn<4;Bn++){Bk+=Bl.slice(Bn,Bn+1).concat(Bl.slice(Bn,Bn+1));}Bl=Bk;}var Bq=[];for(Bn=1;Bn<7;Bn+=2){Bq.push(parseInt("0x"+Bl.slice(Bn,Bn+2)));}Bq.push(Bm);Bp="RGBA("+Bq.join(",")+")";return Bp;}else{return Bl;}}}}else{return null;}}function AQ(Bm){var Bk=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,Bn,Bj,Bo,Br,Bq;if(Bm){var Bs,Bp;if(/^(rgba|RGBA)/.test(Bm)){Bp=Bm.replace(/rgba\(|RGBA\(/,"");Bp=Bp.replace(")","");Bs=Bp.split(",");Bj=Bs[0];Bo=Bs[1];Br=Bs[2];}else{if(/^(rgb|RGB)/.test(Bm)){Bp=Bm.replace(/rgb\(|RGB\(/,"");Bp=Bp.replace(")","");Bs=Bp.split(",");Bj=Bs[0];Bo=Bs[1];Br=Bs[2];}else{if(Bk.test(Bm)){if(Bm.length===4){Bs="#";for(Bn=1;Bn<4;Bn++){Bs+=Bm.slice(Bn,Bn+1).concat(Bm.slice(Bn,Bn+1));}Bm=Bs;}var Bl=[];for(Bn=1;Bn<7;Bn+=2){Bl.push(parseInt("0x"+Bm.slice(Bn,Bn+2)));}Bj=Bl[0];Bo=Bl[1];Br=Bl[2];}else{return Ai;}}}Bq=(Bj*299+Bo*587+Br*114)/1000;if(Bq>150){return t;}else{return Ai;}}else{return Ai;}}function Bb(Bk,Bm,Bn,Bl,Bj){Bk.strokeStyle="#FFF";Bk.lineWidth=2;Bk.beginPath();Bk.moveTo(Bm+Bl*0.25,Bn);Bk.lineTo(Bm,Bn);Bk.lineTo(Bm,Bn+Bj*0.25);Bk.moveTo(Bm,Bn+Bj*0.75);Bk.lineTo(Bm,Bn+Bj);Bk.lineTo(Bm+Bl*0.25,Bn+Bj);Bk.moveTo(Bm+Bl*0.75,Bn+Bj);Bk.lineTo(Bm+Bl,Bn+Bj);Bk.lineTo(Bm+Bl,Bn+Bj*0.75);Bk.moveTo(Bm+Bl,Bn+Bj*0.25);Bk.lineTo(Bm+Bl,Bn);Bk.lineTo(Bm+Bl*0.75,Bn);Bk.stroke();Bk.closePath();}mstrmojo.AndroidVisMap=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.AndroidVisMap",model:null,utils:mstrmojo.VisChartUtils,scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:true,vScroll:true,hScroll:true,offset:{y:{start:0,end:0},x:{start:0,end:0}},origin:{x:0,y:0}},relScaleFactor:1,scaleFactor:1,currSelectedObj:null,defaultSelectedObjs:{},currHoverObj:null,currLinkObj:null,tooltipOn:false,context:null,multiTap:true,multiTouch:true,browserSupportsHtml5:true,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};z-index:{@zIndex};position:absolute;{@cssText};overflow:hidden;"  mstrAttach:mouseover,mousemove ><div id="{@id}"-scroll-element style="position:absolute;left:0;top:0;width:{@width};height={@height}"><canvas id="{@id}-highlightCanvas" style="position:absolute;left:0;top:0;z-index:100" width="{@width}" height="{@height}"></canvas><canvas id="{@id}-animationCanvas" style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas></div><div id="{@id}-tooltip" style="z-index:200" class="mstrmojo-ImageLayout-tooltip" clk="clk"><table style="margin:5px 7px"></table></div><div id="{@id}-infowindow-anchor" style="position:absolute;width:18px;height:18px;display:block"></div><div id="{@id}-css" style="display:none"></div><div id="{@id}-errMsg" align="center" style="position:absolute; z-index:300; top:35%; word-wrap:break-word;"></div></div>',markupSlots:{scrollableCanvasDiv:function(){return this.domNode.childNodes[0];},highlightCanvas:function(){return this.domNode.childNodes[0].firstChild;},animationCanvas:function(){return this.domNode.childNodes[0].lastChild;},tooltip:function(){return this.domNode.childNodes[1];},infowindowAnchor:function(){return this.domNode.childNodes[2];},cssDiv:function(){return this.domNode.childNodes[3];},errorMessage:function(){return this.domNode.childNodes[4];}},postBuildRendering:function Bh(){var Bn=this;Bn.setFontByDPI();Ay=Bn.highlightCanvas.getContext;if(!Ay){Bn.renderErrorMessage(mstrmojo.desc(8126,"Your browser does not support HTML5"));return ;}if(Bn.model.hasOwnProperty("eg")){var Bl=Bn.model.eg,Bq="The Image Layout requires:";if(Bl.match(Bq)){Bn.renderErrorMessage(mstrmojo.desc(9853,Bl));}else{Bn.renderErrorMessage(Bl);}return ;}Bn.newRenderFlag=true;Bn.attrIndices=Bn.getAttrIndices();Bn.createTooltipTable();Bn.getDefaultSelectedObjs();Bn.highlightContext=Bn.highlightCanvas.getContext("2d");Bn.animationContext=Bn.animationCanvas.getContext("2d");var Br=Bn.scrollerConfig;Br.scrollEl=Bn.scrollableCanvasDiv;Br.offset.x.start=0;Br.offset.x.end=Bn.getWidth()*(Bn.scaleFactor-1);Br.offset.y.start=0;Br.offset.y.end=Bn.getHeight()*(Bn.scaleFactor-1);if(Br.origin.x>Br.offset.x.end){Br.origin.x=Br.offset.x.end;}if(Br.origin.y>Br.offset.y.end){Br.origin.y=Br.offset.y.end;}Bn.animationCanvas.width=Bn.highlightCanvas.width=Bn.getWidth()*2;Bn.animationCanvas.height=Bn.highlightCanvas.height=Bn.getHeight()*2;if(!Bn.model.coords){if(typeof (mstrApp)!="undefined"&&mstrApp.serverRequest){var Bm={success:function(Bs){if(!Bs){return ;}Bn.model.coords=Bs.coords;Bn.drawMap();if(Bn.markerType!==AI){Bn.highlightPoint();}Bn.adjustWidgetOffsets();if(!Bn.mapDataScreenshotTaken){Bn.mapDataScreenshotTaken=true;Bn.localTakeScreenshot(BL);}},failure:function(Bs){}};params={taskId:"getMapCoordinates"};var Bj=Bn.model.vp;if(Bj&&Bj.mf){params.coordinatesFile=Bj.mf;}mstrApp.serverRequest(params,Bm,{src:"postBuildRendering"});}}else{Bn.drawMap();Bn.highlightPoint();this.adjustWidgetOffsets();}if(this._super){this._super();}if(this._tn){var Bk=this._tsCallback;this._tsCallback=function(Bs){Bn.infowindowOn=Bn.model.infowindowOn;Bn.currSelectedObjBackup=Bn.currSelectedObj;Bk.call(this,Bs);};mstrmojo.dom.detachEvent(this._tn,mstrmojo.dom.TOUCHSTART,Bk);mstrmojo.dom.attachEvent(this._tn,mstrmojo.dom.TOUCHSTART,this._tsCallback);}var Bp=Bn.xtabModel,Bo=(Bp&&Bp.docModel);if(Bo){Bn.docModelListener=Bn.xtabModel.docModel.attachEventListener("infoWindowClosed",this.id,function(Bs){Bn.model.infowindowOn=false;if(!Bn.hasNonifwTarget&&Bn.currSelectedObj){window.setTimeout(function(){Bn.currSelectedObj=null;Bn.highlightPoint();},10);}});}Bn.fullScreenListener=mstrmojo.touchManager.attachEventListener("fullScreenStateChange",this.id,function(Bs){Bn.adjustWidgetOffsets();});},getFullPath:function AO(Bo){var Bk="";var Bn=/^[A-z]:\/\//;if(Bn.test(Bo)){Bk=Bo;}else{var Bm=/^(..\/|..\\)/;var Bl=/^(.\/|.\\)/;var Bj=/^(\/|\\)/;Bo=Bo.replace(Bm,"");Bo=Bo.replace(Bl,"");Bo=Bo.replace(Bj,"");if(typeof (mstrApp)!="undefined"&&mstrApp.getConfiguration){Bk=mstrmojo.url.getAbsoluteURL(Bo,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());}}return Bk;},touchMultiBegin:function(Bn){this.hideTooltip();var Bl,Bk;if(Bn.evt.touches&&Bn.evt.touches.length==2){Bl=Bn.evt.touches[0];Bk=Bn.evt.touches[1];}else{Bl=Bn;Bk={pageX:100,pageY:100};}var Bm=Bl.pageX-Bk.pageX,Bj=Bl.pageY-Bk.pageY;this.initDiffDiff=Bm*Bm+Bj*Bj;this.initCenterX=(Bl.pageX+Bk.pageX)>>1;this.initCenterY=(Bl.pageY+Bk.pageY)>>1;this.initScrollX=this._scroller.origin.x;this.initScrollY=this._scroller.origin.y;this.relScaleFactor=1;},touchMultiMove:function(Bm){var Bo,Bn;if(Bm.evt.touches&&Bm.evt.touches.length==2){Bo=Bm.evt.touches[0];Bn=Bm.evt.touches[1];}else{Bo=Bm;Bn={pageX:100,pageY:100};}var Bq=Bo.pageX-Bn.pageX,Bp=Bo.pageY-Bn.pageY,Br=Bq*Bq+Bp*Bp,Bt=(Bo.pageX+Bn.pageX)>>1,Bs=(Bo.pageY+Bn.pageY)>>1;var Bk=Math.sqrt(Br/this.initDiffDiff);var Bl={x:Bk*(this.initCenterX+this.initScrollX)-Bt,y:Bk*(this.initCenterY+this.initScrollY)-Bs};var Bj={scale:Bk,offset:Bl};this.relScaleFactor=Bk;this.applyTransform(Bj);},touchMultiEnd:function(Bk){if(this.relScaleFactor*this.scaleFactor<1){this.relScaleFactor=1/this.scaleFactor;this.applyTransform({scale:this.relScaleFactor},500,this.postScale);}else{if(this.relScaleFactor*this.scaleFactor>2){var Bj=this.relScaleFactor*this.scaleFactor/2;this.relScaleFactor=2/this.scaleFactor;this.applyTransform({scale:this.relScaleFactor,scaleBack:Bj},500,this.postScale);}else{this.postScale();}}},handleTouchSelectWithIfw:function BJ(Bk,Bj){var Bm=this,Bl=Bm.getAreaOrNearestBubble(false,Bk,Bj);if(!Bl){Bm.closeInfowindow();}else{if(Bl.hdrIndex<0){Bm.closeInfowindow();}else{if(!Bm.currSelectedObj||Bl.touchVal!==Bm.currSelectedObj.touchVal){Bm.showInfowindow(Bl);Bm.currSelectedObj=Bl;Bm.highlightPoint();}else{}}}},handleTouchSelectNoIfw:function a(Bk,Bj){var Bm=this,Bl=Bm.getAreaOrNearestBubble(false,Bk,Bj);if(!Bl){Bm.hideTooltip();}else{if(!Bm.currHoverObj||Bl.touchVal!==Bm.currHoverObj.touchVal){Bm.currHoverObj=Bl;Bm.highlightPoint();}else{Bm.renderTooltip(Bl.touchVal,Bl.point.x,Bl.point.y,Bl.hdrIndex);}}},touchSelectBegin:function(Bj){if(Bj.evt.ctrlKey){this.touchMultiBegin(Bj);return ;}if(this.infowindowOn){this.touchSelectWithIfw=true;this.handleTouchSelectWithIfw(Bj.pageX,Bj.pageY);}else{this.handleTouchSelectNoIfw(Bj.pageX,Bj.pageY);}},touchSelectMove:function(Bj){if(Bj.evt.ctrlKey){this.touchMultiMove(Bj);return ;}if(this.touchSelectWithIfw){this.handleTouchSelectWithIfw(Bj.pageX,Bj.pageY);}else{this.handleTouchSelectNoIfw(Bj.pageX,Bj.pageY);}},touchSelectEnd:function(Bj){if(Bj.evt.ctrlKey){this.touchMultiEnd(Bj);}this.touchSelectWithIfw=false;return ;},touchSwipeBegin:function AY(Bj){this.hideTooltip();if(this._super){this._super(Bj);}},applyTransform:function(Bk,Bl,Bt){var Bs=this._scroller;if(Bl===undefined){Bl=0;}Bs.scrollEl.style.webkitTransformOrigin="left top";Bs.transform="scale("+Bk.scale+","+Bk.scale+")";var Br,Bq;if(Bk.offset){Br=Bk.offset.x;Bq=Bk.offset.y;}else{var Bp=Bk.scaleBack||1;Br=this._scroller.origin.x/Bp;Bq=this._scroller.origin.y/Bp;}var Bj=this.scaleFactor*this.relScaleFactor-1,Bm=this.getHeight()*Bj,Bo=this.getWidth()*Bj;if(Bj<0){Bs.offset={y:{start:Bm,end:0},x:{start:Bo,end:0}};}else{Bs.offset={y:{start:0,end:Bm},x:{start:0,end:Bo}};}this._scroller.scrollTo(Br,Bq,Bl);if(Bt){var Bn=this;setTimeout(function(){Bt.apply(Bn);Bn=null;},Bl);}},pointCanBeSelected:function E(Bs){var Bq=this,Bm=Bq.model,Bj=Bm.gts,Bk=Bj.col,Bo=Bk.length,Bl=Bj.row,Bp=Bl.length,Bn;for(Bn=0;Bn<Bp;Bn++){var Br=Bl[Bn];if(Br.sc&&Br.sc.tks){return true;}if(Br.lm&&Br.lm[0]&&Br.lm[0].links&&Br.lm[0].hasOwnProperty("di")){return true;}}return false;},getModelK:function AD(){var Bj=this.model&&this.model.k;return Bj;},getActionObj:function g(Bw,Bz,Bu){var Bk=[],Bs=0,Bl=[],Bo=null;var B2=this,Bn=B2.model,Bj=Bn.gts,Bq=Bj.row[0];if(Bq.sc&&Bq.sc.tks&&(!Bw||Bw.hdrIndex>=0)){if(Bz&&(Bq.sc.all==="false"||Bq.sc.all===false)){return null;}var Bv={};Bv.sc=Bq.sc;if(Bw&&Bw>=0){Bv.es=Bq.es[Bw.hdrIndex].n;}else{Bv.es=null;}Bv.eid=Bz?"OA:(All)":Bq.es[Bw.hdrIndex].id;Bk.push(Bv);Bs=Bq.at||0;}if(Bq.lm&&Bq.lm[0]&&Bq.lm[0].links&&!Bo&&Bw&&Bw.hdrIndex>=0){Bo={};Bo.titleInfo=Bq;Bo._e=Bq.es[Bw.hdrIndex];}var Br=Bj.col&&Bj.col.length>0&&Bj.col[0];if(Bk.length>0){Bs=Bs|AZ;if(Bw&&Bw.hdrIndex>=0){if(!Bu){if(this.hasIfwTarget){this.getAnchorStyle(Bw);this.model.infowindowOn=true;return{at:Bs,k:this.getModelK(),scObjList:Bk,anchor:this.infowindowAnchor};}else{return{at:Bs,k:this.getModelK(),scObjList:Bk};}}else{return{at:Bs,k:this.getModelK(),scObjList:Bk};}}else{if(Bw&&Bw.hdrIndex<0){return{at:Bs,k:this.getModelK(),scObjList:Bk};}else{if(!Bw){return{at:Bs,k:this.getModelK(),scObjList:Bk};}}}}if(!Bo&&Bw&&Bw.hdrIndex>=0){var Bx=Br,Bp=Bx&&Bx.es&&Bx.es.length,B0;if(Bx&&Bp>0){for(B0=Bp-1;B0>=0;B0--){var By=Bx.es[B0],Bt=Bx.lm[B0];if(Bt&&Bt.links){Bo={};Bo.titleInfo=Bx;Bo.mix=B0;var Bm=Bo,B1={};B1.titleInfo=Bq;B1._e=Bq.es[Bw.hdrIndex];Bm._lp=B1;Bm.axis=AV;}}}}if(Bo){Bs=Bs|BQ;return{at:Bs,k:this.getModelK(),node:Bo};}return null;},getAnchorStyle:function Am(Bo){if(!Bo){return ;}var Bj=Bo.touchVal,B0=this,Bl=B0.model,Bs=Bl.coords,Bt,Br,Bq;B0.infowindowAnchor.style.left=(Bo.point.x-9)+"px";B0.infowindowAnchor.style.top=(Bo.point.y-9)+"px";if(B0.displayMode===T){var Bz=Number.POSITIVE_INFINITY,Bx=0,Bw=Number.POSITIVE_INFINITY,Bv=0;if(Bs.hasOwnProperty(Bj)){var Bu=Bs[Bj];for(Bt in Bu){if(!Bu.hasOwnProperty(Bt)){continue;}var By=Bu[Bt];for(Br=0;Br<By.length;Br++){if(Bz>By[Br]){Bz=By[Br];}if(Bx<By[Br]){Bx=By[Br];}Br++;if(Bw>By[Br]){Bw=By[Br];}if(Bv<By[Br]){Bv=By[Br];}}}B0.infowindowAnchor.style.left=(Bz+B0.leftOffset-B0._scroller.origin.x)+"px";B0.infowindowAnchor.style.top=(Bw+B0.topOffset-B0._scroller.origin.y)+"px";B0.infowindowAnchor.style.width=(Bx-Bz)+"px";B0.infowindowAnchor.style.height=(Bv-Bw)+"px";}}else{if(B0.displayMode===A8){if(B0.shapeFileType===Ao){Bs=Bl.polygonCenters;}if(Bs.hasOwnProperty(Bj)){if(B0.markerType===AG){var Bn=Bs[Bj][0],Bp=B0.getRadiusFromName(Bj);B0.infowindowAnchor.style.left=(Bn[0]+B0.leftOffset-Bp-B0._scroller.origin.x)+"px";B0.infowindowAnchor.style.top=(Bn[1]+B0.topOffset-Bp-B0._scroller.origin.y)+"px";B0.infowindowAnchor.style.width=(2*Bp)+"px";B0.infowindowAnchor.style.height=(2*Bp)+"px";}else{if(B0.markerType===AI){var Bn=Bs[Bj][0],Bk=Bl["imageIcon_"+Bj],Bm=0,B1=0;if(Bk){Bm=Bk.width;B1=Bk.height;}B0.infowindowAnchor.style.left=(Bn[0]+B0.leftOffset-Bm/2-B0._scroller.origin.x)+"px";B0.infowindowAnchor.style.top=(Bn[1]+B0.topOffset-B1/2-B0._scroller.origin.y)+"px";B0.infowindowAnchor.style.width=Bm+"px";B0.infowindowAnchor.style.height=B1+"px";}}}}}},getLastHighlightPoint:function Z(){return this.currHoverObj||null;},getTouchedObj:function BF(Bn,Bs,Br){var Bq=this;if(Bq.displayMode==T){return this.getAreaOrNearestBubble(Bn,Bs,Br);}else{if(Bq.displayMode==A8){var Bt=this.getLastHighlightPoint(),Bl=Bq.utils.getTouchXYOnWidget(Bs,Br,Bq);var Bj=false,Bm=0,Bk=0,Bp=0,Bo=0;if(Bt&&Bl){Bm=Bt.point.x;Bk=Bt.point.y;Bp=Bl.touchX;Bo=Bl.touchY;touchPointInHighLightArea=this.tooltipOn&&(Bm-Bp)*(Bm-Bp)+(Bk-Bo)*(Bk-Bo)<=this.bias*this.bias;}if(Bj){Bq.hideTooltip();Bt=this.getLastHighlightPoint();}else{Bt=this.getAreaOrNearestBubble(Bn,Bs,Br);}return Bt;}}return null;},closeInfowindow:function Af(){var Bj=this;Bj.getFirstInfowindow();if(Bj.model.infowindowOn&&Bj.infowindow){Bj.model.infowindowOn=false;Bj.infowindow.close();if(Bj.infowindow._tchHandler){mstrmojo.touchManager.detachEventListener(Bj.infowindow._tchHandler);delete Bj.infowindow._tchHandler;}}},getFirstInfowindow:function d(){var Bn=this,Bl=Bn.model,Br=Bn.xtabModel,Bo=(Br&&Br.docModel),Bp=Bl&&Bl.gts&&Bl.gts.row,Bq=null;if(Bp&&Bp.length>0){Bq=Bp[0]&&Bp[0].sc&&Bp[0].sc.tks;}if(Bo&&Bq){var Bk=Bo.getTargetInfoWin(Bq);if(Bk&&Bk.length>0){var Bm=Bo.infoWinByKey[Bk[0]],Bj=Bm&&(Bm.id+"_ifw");Bn.infowindow=mstrmojo.all[Bj];}}},hasNoninfowindowTarget:function Av(Bm){var Bt=this.xtabModel,Bs=(Bt&&Bt.docModel);if(Bs){var Br=Bs.defn&&Bs.defn.layouts,Bl=null,Bk;if(Br){for(Bk in Br){if(Br.hasOwnProperty(Bk)){if(Br[Bk].loaded){Bl=Br[Bk];break;}}}}var Bn=Bl&&Bl.units;if(Bn){for(Bk=0;Bk<Bm.scObjList.length;Bk++){var Bo=Bm.scObjList[Bk];var Bp=Bo.sc.tks.split("\x1E"),Bj;for(Bj=0;Bj<Bp.length;Bj++){var Bq=Bn[Bp[Bj]];if(Bq){if(!Bq.ifw){return true;}}}}}}return false;},hasInfowindowTarget:function B(Bm){var Bt=this.xtabModel,Bs=(Bt&&Bt.docModel);if(Bs){var Br=Bs.defn&&Bs.defn.layouts,Bl=null,Bk;if(Br){for(Bk in Br){if(Br.hasOwnProperty(Bk)&&Br[Bk].loaded){Bl=Br[Bk];break;}}}var Bn=Bl&&Bl.units;if(Bn){for(Bk=0;Bk<Bm.scObjList.length;Bk++){var Bo=Bm.scObjList[Bk];var Bp=Bo.sc.tks.split("\x1E"),Bj;for(Bj=0;Bj<Bp.length;Bj++){var Bq=Bn[Bp[Bj]];if(Bq){if(Bq.ifw){return true;}}}}}}return false;},touchTap:function A2(Bk){var Bn=this;if(Bk.count==2){Bn.hideTooltip();Bn.relScaleFactor=1/Bn.scaleFactor;Bn.applyTransform({scale:Bn.relScaleFactor},500,Bn.postScale);}else{if(Bk.count==1){var Bl;if(Bn.tooltipOn){var Bq=mstrmojo.dom.findAncestorByAttr(Bk.target,"clk",true,this.domNode)||null;if(Bq){var Bp=Bq.value;if(Bp==="clk"){Bn.hideTooltip();return ;}}}var Br=this.getTouchedObj(true,Bk.pageX,Bk.pageY);if(Br&&Br.hdrIndex>=0){var Bo=Bn.pointCanBeSelected(Br),Bj=Bn.currSelectedObjBackup&&(Br.touchVal==Bn.currSelectedObjBackup.touchVal),Bm;if(Bo){if(!Bj){Bn.defaultSelectedObjs={};Bn.hideTooltip();Bl=this.getActionObj(Br);if(Bl&&Bl.scObjList){Bn.currSelectedObj=Br;if(!Bn.hasOwnProperty("hasNonifwTarget")||!Bn.hasOwnProperty("hasIfwTarget")){Bn.hasNonifwTarget=Bn.hasNoninfowindowTarget(Bl);Bn.hasIfwTarget=Bn.hasInfowindowTarget(Bl);Bl=this.getActionObj(Br);}Bn.highlightPoint();Bn.performAction([Bl]);}else{if(Bl&&Bl.node){Bn.currLinkObj=Br;Bn.highlightPoint();Bn.performAction([Bl]);Bn.currLinkObj=null;}}}else{if(this.currHoverObj&&this.currSelectedObj&&this.currHoverObj.touchVal===this.currSelectedObj.touchVal){}else{if(Bn.hasNonifwTarget){Bl=Bn.getActionObj(Br,true,true);if(Bl){Bn.performAction([Bl]);Bn.currSelectedObj=null;Bn.highlightPoint();}else{Bn.getFirstInfowindow();if(!Bn.infowindowOn&&Bn.infowindow){Bn.model.infowindowOn=true;Bn.infowindow.open();}}}}Bn.hideTooltip();}}else{Bm=Bn.currHoverObj&&(Br.touchVal==Bn.currHoverObj.touchVal);if(!Bm){Bn.currHoverObj=Br;Bn.highlightPoint();}else{Bn.hideTooltip();}}}else{if(Br&&Br.hdrIndex<0){Bm=Bn.currHoverObj&&(Br.touchVal==Bn.currHoverObj.touchVal);if(!Bm){Bn.currHoverObj=Br;Bn.highlightPoint();}else{Bn.hideTooltip();}}else{if(!Br){Bn.hideTooltip();if(Bn.currSelectedObjBackup&&Bn.hasNonifwTarget){Bl=this.getActionObj(Br,true);if(Bl){Bn.performAction([Bl]);Bn.currSelectedObj=null;Bn.highlightPoint();}}}}}}}},showInfowindow:function F(Bk){var Bm=this,Bj;if(Bk&&Bk.hdrIndex>=0){var Bl=Bm.pointCanBeSelected(Bk),Bn=Bm.currSelectedObj&&(Bk.touchVal==Bm.currSelectedObj.touchVal);if(Bl){if(!Bn){Bm.hideTooltip();Bj=Bm.getActionObj(Bk);if(Bj&&Bj.scObjList){Bm.currSelectedObj=Bk;}Bm.highlightPoint();Bm.performAction([Bj]);}else{if(this.currHoverObj&&this.currSelectedObj&&this.currHoverObj.touchVal===this.currSelectedObj.touchVal){Bm.hideTooltip();}else{Bm.hideTooltip();Bj=this.getActionObj(Bk,true,true);if(Bj){Bm.performAction([Bj]);Bm.currSelectedObj=null;Bm.highlightPoint();}}}}else{}}else{if((Bk&&Bk.hdrIndex<0)||!Bk){Bm.hideTooltip();if(Bm.currSelectedObj){Bj=Bm.getActionObj(Bk,true);if(Bj){Bm.performAction([Bj]);Bm.currSelectedObj=null;Bm.highlightPoint();}}}}},postScale:function(){delete this._scroller.transform;this._scroller.scrollTo(this._scroller.origin.x,this._scroller.origin.y,0);this.scaleFactor*=this.relScaleFactor;this.refreshWidget();},refreshWidget:function(){this.drawMap();this.highlightPoint();},getAttrIndices:function BK(){var Bp=this,Bm=Bp.model,Bq=Bm&&Bm.gts&&Bm.gts.row,Bn,Bl;if(Bq){var Bo=[],Bk=0;for(Bn=0;Bn<Bq.length;Bn++){var Bj=Bq[Bn]&&Bq[Bn].fs;Bo.push(new Array());if(Bj){for(Bl=0;Bl<Bj.length;Bl++){Bo[Bn].push(Bk++);}}}return Bo;}else{return null;}},createTooltipTable:function BV(){var Bo=this,Bm=Bo.model,Br=Bo.tooltip.childNodes[0],Bs=Bm&&Bm.gts&&Bm.gts.row,Bq=Bm&&Bm.gts&&Bm.gts.col&&Bm.gts.col[0]&&Bm.gts.col[0].es,Bk;if(Br.childNodes.length===0&&Bs&&Bs.length>0){var Bp=Bs.length+(Bq?Bq.length:0);for(Bk=0;Bk<Bp;Bk++){var Bn=document.createElement("tr");var Bl=document.createElement("td");Bl.align="right";Bl.style.color="#545462";Bn.appendChild(Bl);var Bj=document.createElement("td");Bj.align="left";Bj.style.color="#000000";Bn.appendChild(Bj);Br.appendChild(Bn);}}},localTakeScreenshot:function Bg(Bk){var Bj=this;window.setTimeout(function(){var Bl=Bj.controller.id;var Bm=mstrmojo.all[Bl];if(Bm&&Bm.rootCtrl.getCurrent()===Bm){Bm.takeScreenShot();}},Bk);},getDefaultSelectedObjs:function AW(){var Bq=this,Bm=Bq.model,Bl=Bm&&Bm.ghs&&Bm.ghs.rhs&&Bm.ghs.rhs.items,Bp=Bm&&Bm.gts&&Bm.gts.row,Bn,Bk,Bj,Bo;if(Bq.haveGotDftSltObjs){return ;}else{Bq.haveGotDftSltObjs=true;}Bq.defaultSelectedObjs={};if(Bl&&Bp&&Bp.length>0){for(Bn in Bl){if(Bl.hasOwnProperty(Bn)){Bo=Bl[Bn].items[0];if(Bo&&Bo.hasOwnProperty("cet")){Bj=Bo.idx;Bk=Bp[0].es[Bj].n;if(!(Bq.defaultSelectedObjs.hasOwnProperty(Bk))){Bq.defaultSelectedObjs[Bk]=Bj;}}}}}},renderErrorMessage:function BC(Bj){var Bl=this,Bk=Bl.errorMessage,Bn=Bj.replace(/-/g,"<br />-");Bk.innerHTML=Bn;Bk.style.width=Bl.getWidth()+"px";Bk.style.fontSize=Bl.errMsgFontSize+"px";Bk.style.fontFamily="Tahoma";Bk.style.color=Y;Bk.style.backgroundColor="RGBA(0,0,0,0)";var Bm=Ad;if(Bl.model.hasOwnProperty("vp")&&Bl.model.vp.hasOwnProperty("bc")&&Bl.model.vp.bc!==""){Bm="#"+Bl.model.vp.bc;}else{Bm=Bl.utils.getAncestorBgColor(Bl)||Ad;}Bl.domNode.style.backgroundColor=Bm;Bl.model.themeMode=AQ(Bm);if(Bl.model.themeMode===t){Bk.style.color=C;}},setFontByDPI:function O(){if(this.setFontByDPIFlag){return ;}var Bo=this;Bo.setFontByDPIFlag=true;Bo.hoverBubbleRadiusLarger=5;Bo.bubbleStrokeWidth=2;Bo.baseMaxBubbleSizeAuto=12;Bo.baseMaxBubbleSizeManual=24;Bo.polygonStrokeWidth=1;Bo.highlightPolygonStrokeWidth=2;Bo.borderSpace=5;Bo.tooltipFontSize=12;Bo.tooltipBorderWidth=1;Bo.tooltipBorderRadius=5;Bo.errMsgFontSize=16;Bo.bias=30;Bo.tooltipRightShadowWidth=4;var Bv=Bo.xtabModel,Bs=(Bv&&Bv.docModel),Bk=false,Bj=false;if(Bs){Bk=Bs.zt&&(Bs.zt==2);var Br=Bs.defn&&Bs.defn.layouts,Bm,Bl;for(Bl in Br){if(Br.hasOwnProperty(Bl)&&Br[Bl]&&Br[Bl].loaded){Bm=Br[Bl];break;}}if(Bm&&Bm.hasOwnProperty("fch")){Bj=Bm.fch;}}if(Bk&&Bj){var Bq=mstrMobileApp.getDeviceDPIX();var Bp=149;var Bn=1;if(Bq>0){Bn=Bq/Bp;}if(Bn>1){Bo.hoverBubbleRadiusLarger*=Bn;Bo.bubbleStrokeWidth*=Bn;Bo.baseMaxBubbleSizeAuto*=Bn;Bo.baseMaxBubbleSizeManual*=Bn;Bo.polygonStrokeWidth*=Bn;Bo.highlightPolygonStrokeWidth*=Bn;Bo.borderSpace*=Bn;Bo.tooltipFontSize*=Bn;Bo.tooltipBorderWidth*=Bn;Bo.tooltipBorderRadius*=Bn;Bo.errMsgFontSize*=Bn;Bo.bias*=Bn;Bo.tooltipRightShadowWidth*=Bn;var Bu=Bo.tooltip,Bt=Bu.childNodes[0];Bu.style.fontSize=Bo.tooltipFontSize+"px";Bu.style.borderWidth=Bo.tooltipBorderWidth+"px";Bu.style.borderRadius=Bo.tooltipBorderRadius+"px";Bu.style.boxShadow=3*Bn+"px "+3*Bn+"px "+4*Bn+"px RGBA(0,0,0,0.45)";Bt.style.margin=5*Bn+"px "+7*Bn+"px";}}},initScroller:function BP(Bj){Bj.vScroll=true;Bj.hScroll=true;this._super(Bj);},getIndexFromHdrindex:function BT(Bo){var Bn=this,Bj=Bn.model.ghs.rhs.items;if(Bj){var Bl,Bk,Bm;for(Bl=0;Bl<Bj.length;Bl++){Bk=Bj[Bl].items;if(Bk.length>0&&Bk[0].idx==Bo){if(Bl===Bj.length-1){return Bl;}else{Bm=Bj[Bl+1].items;if(Bm.length>0&&Bm[0].idx!=Bo){return Bl;}else{continue;}}}else{continue;}}}return 0;},drawMap:function I(){var Bk=this,Bj=Bk.model;Bk.animationCanvas.width=Bk.animationCanvas.width;Bk.highlightCanvas.width=Bk.highlightCanvas.width;if(!Bk.hasOwnProperty("displayMode")){Bk.displayMode=Bi;}if(!Bk.hasOwnProperty("markerType")){Bk.markerType=Ak;}if(!Bk.hasOwnProperty("shapeFileType")){Bk.shapeFileType=o;}if(!Bk.hasOwnProperty("colorByIndex")){Bk.colorByIndex=-1;}if(!Bk.hasOwnProperty("sizeByIndex")){Bk.sizeByIndex=-1;}if(!Bk.hasOwnProperty("drawBgImageFlag")){Bk.drawBgImageFlag=false;}if(!Bk.hasOwnProperty("thresholdType")){Bk.thresholdType=b;}if(!Bk.hasOwnProperty("curPolygonOpacity")){Bk.curPolygonOpacity=Be;}if(!Bj.hasOwnProperty("infowindowOn")){Bj.infowindowOn=false;}if(!Bk.hasOwnProperty("touchSelectWithIfw")){Bk.touchSelectWithIfw=false;}if(Bk.model.hasOwnProperty("vp")){var Bl=Ad;if(Bk.model.vp.hasOwnProperty("bc")&&Bk.model.vp.bc!==""){Bl="#"+Bk.model.vp.bc;}else{Bl=Bk.utils.getAncestorBgColor(Bk)||Ad;}Bk.domNode.style.backgroundColor=Bl;Bk.model.themeMode=AQ(Bl);Bk.model.bgColor=Bl;Bk.tooltip.style.top="0px";Bk.setDisplayParas();if(Bk.displayMode===T){Bk.drawAreaMap();}else{if(Bk.displayMode===A8){Bk.drawBubbleMap();}}}},getIndexById:function z(Bo){var Bm=this,Bj=Bm.model,Bn=Bj.gts&&Bj.gts.col,Bl=null,Bk;if(Bn&&Bn.length>0&&Bn[0].hasOwnProperty("es")){Bl=Bn[0].es;for(Bk=0;Bk<Bl.length;Bk++){if(Bl[Bk].oid===Bo){return Bk;}}}return -1;},setDisplayParas:function AN(){var Bl=this,Bj=Bl.model;if(!Bl.hasOwnProperty("setDisplayParasFlag")){Bl.setDisplayParasFlag=true;}else{return ;}Bl.shapeFileType=AK(Bj.coords);var Bk=0;if(Bj.hasOwnProperty("gvs")&&Bj.gvs.hasOwnProperty("items")&&Bj.gvs.items.length>0&&Bj.gvs.items[0].hasOwnProperty("items")&&Bj.gvs.items[0].items.length>0){Bk=Bj.gvs.items[0].items.length;}Bl.displayMode=Bj.vp.mt;if(Bl.displayMode===T){if(Bk>0){if(Bj.vp.hasOwnProperty("ColorBy")){Bl.colorByIndex=Bl.getIndexById(Bj.vp.ColorBy);if(Bl.colorByIndex<0){Bl.colorByIndex=0;}}else{Bl.colorByIndex=0;}Bl.thresholdType=Bl.getThresholdType(Bl.colorByIndex);}else{}}else{if(Bl.displayMode===A8){if(Bk>0){this.setBubbleModeParasWithData(Bk);}else{Bl.markerType=AG;}}else{if(Bl.displayMode===Bi){if(Bk>0){Bl.displayMode=A8;this.setBubbleModeParasWithData(Bk);}else{if(Bl.shapeFileType===Ao){Bl.displayMode=T;}else{if(Bl.shapeFileType===AR){Bl.displayMode=A8;Bl.markerType=AG;}}}}else{if(!Bl.displayMode){if(Bk>0){Bl.displayMode=A8;this.setBubbleModeParasWithData(Bk);}else{if(Bl.shapeFileType===Ao){Bl.displayMode=T;}else{if(Bl.shapeFileType===AR){Bl.displayMode=A8;Bl.markerType=AG;}}}}}}}},setBubbleModeParasWithData:function Aa(Bl){var Bk=this,Bj=Bk.model;if(Bj.vp.hasOwnProperty("SizeBy")){Bk.sizeByIndex=this.getIndexById(Bj.vp.SizeBy);if(Bk.sizeByIndex<0){Bk.sizeByIndex=0;}}else{Bk.sizeByIndex=0;}if(Bj.vp.hasOwnProperty("ColorBy")){Bk.colorByIndex=this.getIndexById(Bj.vp.ColorBy);if(Bk.colorByIndex<0){Bk.colorByIndex=0;}Bk.thresholdType=Bk.getThresholdType(Bk.colorByIndex);if(Bk.thresholdType===Ba){Bk.markerType=AI;}else{Bk.markerType=AG;}}else{if(Bl===1){Bk.colorByIndex=0;Bk.thresholdType=this.getThresholdType(0);if(Bk.thresholdType===Ba){Bk.markerType=AI;}else{Bk.markerType=AG;}}else{if(Bl>1){var Bm=this.getThresholdType(0);if(Bm===Ba){Bk.colorByIndex=0;Bk.thresholdType=Bm;Bk.markerType=AI;}else{Bk.colorByIndex=1;Bk.thresholdType=this.getThresholdType(1);if(Bk.thresholdType===Ba){Bk.markerType=AI;}else{Bk.markerType=AG;}}}}}},getThresholdType:function s(Bs){var Br=this,Bl=Br.model&&Br.model.th,Bj=Bl&&Bl[Bs],Bn=Br.model&&Br.model.gvs,Bk=Br.model.gts.row[0].es,Bm,Bo,Bp;if(Bj&&Bn.items.length>0){if(Bs>=Bn.items[0].items.length||Bs<0||Bj.length===0){return b;}for(Bo in Bk){if(Bk.hasOwnProperty(Bo)){Bp=Bn.items[Br.getIndexFromHdrindex(Bo)].items[Bs];if(Bp.hasOwnProperty("ty")&&parseInt(Bp.ty,10)===4){return Ba;}}}var Bq=/(jpg|jpeg|png|gif|tiff|bmp)$/i;for(Bm in Bj){if(Bj.hasOwnProperty(Bm)&&Bq.test(Bj[Bm].n)){return Ba;}}for(Bo in Bk){if(Bk.hasOwnProperty(Bo)){Bp=Bn.items[Br.getIndexFromHdrindex(Bo)].items[Bs];if(Bp.hasOwnProperty("ty")&&parseInt(Bp.ty,10)===2){return AP;}}}return b;}else{return b;}},scalePolygonCoords:function Bc(){var Bu=this,Bq=Bu.model,Bv=Bq.coords;var Bk=0,Bj=0,Bl,Bt,Bp,Bo,Bn;for(Bp in Bv){if(Bv.hasOwnProperty(Bp)){if(Bp==="bgImage"){continue;}Bl=Bv[Bp];for(Bo in Bl){if(Bl.hasOwnProperty(Bo)){Bt=Bl[Bo];for(Bn=0;Bn<Bt.length;Bn++){if(Bt[Bn]>Bk){Bk=Bt[Bn];}Bn++;if(Bt[Bn]>Bj){Bj=Bt[Bn];}}}}}}var Bm=Bk/((this.getWidth()-10)*this.scaleFactor),Br=Bj/((this.getHeight()-10)*this.scaleFactor),Bs=Math.max(Br,Bm);this.topOffset=(this.getHeight()*this.scaleFactor-Bj/Bs)/2;this.leftOffset=(this.getWidth()*this.scaleFactor-Bk/Bs)/2;for(Bp in Bv){if(Bv.hasOwnProperty(Bp)){if(Bp==="bgImage"){continue;}Bl=Bv[Bp];for(Bo in Bl){if(Bl.hasOwnProperty(Bo)){Bt=Bl[Bo];for(Bn=0;Bn<Bt.length;Bn++){Bt[Bn]=parseInt(Bt[Bn]/Bs,10);}}}}}},getBubbleColorFromName:function A7(Bj){if(this.allBubblesColor&&this.allBubblesColor.hasOwnProperty(Bj)){return this.allBubblesColor[Bj];}else{return null;}},getBgColorFromCSS:function Az(Bk){var Bj=this.cssDiv,Bn=null,Bm=null,Bl,Bo;if(this.model.hasOwnProperty("css")){Bn=this.model.css;}if(this.model.hasOwnProperty("th")){Bm=this.model.th&&this.model.th[this.colorByIndex];}if(Bn&&Bm&&Bk&&Bk.hasOwnProperty("ty")){if((parseInt(Bk.ty,10)===2||parseInt(Bk.ty,10)===4)&&Bk.hasOwnProperty("ti")&&Bm.length>Bk.ti&&Bm[Bk.ti].udbg===1){Bl=Bm[Bk.ti].cni;Bj.className=Bl&&Bn[Bl]&&Bn[Bl].n;Bo=mstrmojo.css.getComputedStyle(Bj);if(Bo.hasOwnProperty("backgroundColor")){return Bo.backgroundColor;}}}return null;},drawPolygonInMap:function l(Bo){var Bq=this,Bm=Bq.model,Bs=Bm.coords,Bj=this.animationContext,Bl;Bq.animationCanvas.width=Bq.animationCanvas.width;if(Bq.drawBgImageFlag&&Bm.bgImg){var Bk=Bq.oriBgImageWidth/((Bq.getWidth()-Bq.borderSpace*2)*Bq.scaleFactor),Bn=Bq.oriBgImageHeight/((Bq.getHeight()-Bq.borderSpace*2)*Bq.scaleFactor),Bp=Math.max(Bn,Bk);Bq.topOffset=(Bq.getHeight()*Bq.scaleFactor-Bq.oriBgImageHeight/Bp)/2;Bq.leftOffset=(Bq.getWidth()*Bq.scaleFactor-Bq.oriBgImageWidth/Bp)/2;Bj.drawImage(Bm.bgImg,Bq.leftOffset,Bq.topOffset,Bq.oriBgImageWidth/Bp,Bq.oriBgImageHeight/Bp);}Bq.curPolygonOpacity=Bo;var Bt=Ap,Br=Ar,Bx=Aw;if(Bm.themeMode===t){Bt=A4;Br=A6;Bx=AS;}if(Bm.vp&&Bm.vp.npc){Bt=BZ("#"+Bm.vp.npc,Be);}for(Bl in Bs){if(!Bs.hasOwnProperty(Bl)){continue;}if(Bs.hasOwnProperty(Bl)){if(Bl==="bgImage"){continue;}var Bw=Bt;if(Bq.displayMode===T){var Bv=this.getHeaderIndex(Bl);if(Bv>=0){if(Bq.colorByIndex>=0){var Bu=Bm.gvs.items[Bq.getIndexFromHdrindex(Bv)].items[Bq.colorByIndex];Bw=Bq.getBgColorFromCSS(Bu);if(!Bw){Bw=Br;}if(Bq.drawBgImageFlag){Bw=BZ(Bw,AL);}else{Bw=BZ(Bw,Be);}}else{Bw=Br;}}else{Bw=Bt;}}else{if(Bq.displayMode===A8){Bw=Bt;}}}Bw=BZ(Bw,Bo);AU(Bj,Bs[Bl],{x:this.leftOffset,y:this.topOffset},Bx,Bq.polygonStrokeWidth,Bw);}},getRadiusFromName:function A(Bk){var Bl=this,Bj=Bl.model;if(Bj.coords.hasOwnProperty(Bk)){if(Bl.model.hasOwnProperty("oriBubbleSize")){return Bl.model.oriBubbleSize[Bk]*Bl.scaleFactor;}else{if(Bl.model.hasOwnProperty("maxBubbleRadius")){return Bl.model.maxBubbleRadius*Bl.scaleFactor;}else{return 2;}}}else{return -1;}},drawBubblesInMap:function Q(){var B1=this,Bm=B1.model,Bx=Bm.coords,By;if(Bm.hasOwnProperty("polygonCenters")){Bx=Bm.polygonCenters;}B1.highlightCanvas.width=B1.highlightCanvas.width;var Bs=Au,Bv=X;if(Bm.themeMode===t){Bs=f;Bv=Bf;}var Bu=Math.max(2,Math.min(12,V*0.15*Math.min(B1.getWidth(),B1.getHeight())));Bu=Bu*B1.scaleFactor;var Bo=Bm.th&&Bm.th[B1.colorByIndex];if(B1.markerType===AI){var Bt=B1.getFullPath("images/image_not_found.jpg");defaultImageIconPath=B1.getFullPath("images/roundedpp.png");for(By in Bx){if(Bx.hasOwnProperty(By)){if(By==="bgImage"){continue;}var Br="imageIcon_"+By;if(Bm.hasOwnProperty(Br)){var Bl=Bm[Br];if(Bl&&Bl.width&&Bl.height&&Bl.width<B1.getWidth()*B1.scaleFactor&&Bl.height<B1.getHeight()*B1.scaleFactor){var B2=Bx[By][0][0]-Bl.width/2+B1.leftOffset,Bp=Bx[By][0][1]-Bl.height/2+B1.topOffset;B1.animationContext.drawImage(Bl,B2,Bp);}continue;}var Bk=B1.getHeaderIndex(By);if(Bo&&Bk>=0&&B1.colorByIndex>=0&&B1.thresholdType===Ba){var Bq=Bm.gvs.items[B1.getIndexFromHdrindex(Bk)].items[B1.colorByIndex];if(Bq.hasOwnProperty("ty")&&parseInt(Bq.ty,10)===4){var Bz=Bo.length>Bq.ti&&Bo[Bq.ti].n;if(Bz){var B0=B1.getFullPath(Bz);Bm[Br]=new Image();Bm[Br].src=B0;Bm[Br].id=By;Bm[Br].onload=function(){if(this.width<B1.getWidth()*B1.scaleFactor&&this.height<B1.getHeight()*B1.scaleFactor){var B4=Bx[this.id][0][0]-this.width/2+B1.leftOffset,B5=Bx[this.id][0][1]-this.height/2+B1.topOffset;B1.animationContext.drawImage(this,B4,B5);if(B1.defaultSelectedObjs.hasOwnProperty(this.id)){B1.highlightCanvas.width=B1.highlightCanvas.width;for(var B3 in B1.defaultSelectedObjs){if(B1.defaultSelectedObjs.hasOwnProperty(B3)){B1.highlightImageIcon(B1.highlightContext,Bx,B3,0);}}}}};Bm[Br].onerror=function(){Bm["imageIcon_"+this.id].src=Bt;};}}else{Bm[Br]=new Image();Bm[Br].src=defaultImageIconPath;Bm[Br].id=By;Bm[Br].onload=function(){if(this.width<B1.getWidth()*B1.scaleFactor&&this.height<B1.getHeight()*B1.scaleFactor){var B3=Bx[this.id][0][0]-this.width/2+B1.leftOffset,B4=Bx[this.id][0][1]-this.height/2+B1.topOffset;B1.animationContext.drawImage(this,B3,B4);if(B1.defaultSelectedObjs.hasOwnProperty(this.id)){B1.highlightImageIcon(B1.highlightContext,Bx,this.id,0);}}};Bm[Br].onerror=function(){Bm["imageIcon_"+this.id].src=Bt;};}}else{delete Bx[By];}}}if(!B1.imageIconScreenshotTaken){B1.imageIconScreenshotTaken=true;}}else{if(B1.markerType===AG){for(By in Bx){if(!Bx.hasOwnProperty(By)){continue;}if(By==="bgImage"||By===(B1.currHoverObj&&B1.currHoverObj.touchVal)||By===(B1.currSelectedObj&&B1.currSelectedObj.touchVal)||By===(B1.currLinkObj&&B1.currLinkObj.touchVal)||(!N(B1.defaultSelectedObjs)&&B1.defaultSelectedObjs.hasOwnProperty(By))){continue;}var Bw=Bs,Bj=Bu,Bk=B1.getHeaderIndex(By);if(Bk>=0){if(B1.sizeByIndex>=0){Bj=B1.getRadiusFromName(By);}if(B1.colorByIndex>=0&&B1.thresholdType===AP){Bw=B1.getBubbleColorFromName(By);if(!Bw){Bw=Bs;}else{Bw=BZ(Bw,Ax);}}var Bn={x:B1.leftOffset,y:B1.topOffset};L(B1.highlightContext,Bx[By][0],Bn,Bw,Bj);R(B1.highlightContext,Bx[By][0],Bn,Bv,Bj,B1.bubbleStrokeWidth);}else{delete Bx[By];}}}}},getOriPolygonCoords:function BW(){var Br=this,Bn=Br.model,Bs=Bn.coords,Bm,Bl,Bk,Bj,Bq;if(!Bn.hasOwnProperty("oriPolyCoords")){Bn.oriPolyCoords={};for(Bm in Bs){if(Bs.hasOwnProperty(Bm)){if(Bm==="bgImage"){continue;}var Bo=[];Bj=Bs[Bm];for(Bl in Bj){if(Bj.hasOwnProperty(Bl)){Bq=Bj[Bl];var Bp=[];for(Bk=0;Bk<Bq.length;Bk++){Bp.push(Bq[Bk]);}Bo.push(Bp);}}Bn.oriPolyCoords[Bm]=Bo;}}}},getAllBubblesColor:function A9(){var Bn=this,Bk=Bn.model,Bp=Bk.coords,Bm;if(Bn.haveAllBubblesColor){return ;}else{Bn.allBubblesColor={};}var Bj=Au;if(Bk.themeMode===t){Bj=f;}if(Bn.markerType===AG&&Bn.colorByIndex>=0&&Bn.thresholdType===AP){for(Bm in Bp){if(Bp.hasOwnProperty(Bm)){if(Bm==="bgImage"){continue;}var Bq=Bn.getHeaderIndex(Bm);if(Bq>=0){var Bo=Bk.gvs.items[Bn.getIndexFromHdrindex(Bq)].items[Bn.colorByIndex],Bl=Bn.getBgColorFromCSS(Bo);if(!Bl){Bl=Bj;}Bn.allBubblesColor[Bm]=Bl;}else{}}}}},getOriBubbleSize:function As(){var B5=this,Bl=B5.model,Bv=Bl.gvs,Bq=Bl.ghs.rhs.items,B0=Bl.gts.row[0].es,B2,Bz,By,Bx,Bu,Bn=0;var Bp=1;if(Bl.vp.ty==="0"){if(B5.sizeByIndex<0){Bp=V;}else{if(B5.sizeByIndex>=0){Bp=G;}}}else{if(Bl.vp.ty==="1"){if(Bl.vp.hasOwnProperty("val")&&Bl.vp.val!==null&&Bl.vp.val!==""){Bp=parseFloat(Bl.vp.val);if(Bp>p){Bp=p;}if(Bp<W){Bp=W;}}else{if(B5.sizeByIndex<0){Bp=V;}else{if(B5.sizeByIndex>=0){Bp=D;}}}}else{if(B5.sizeByIndex<0){Bp=V*2;}else{if(B5.sizeByIndex>=0){Bp=D*2;}}}}var B4=B5.baseMaxBubbleSizeAuto;if(B5.sizeByIndex>=0){B4=B5.baseMaxBubbleSizeManual;}var B3=0.15*Math.min(B5.getWidth(),B5.getHeight());if(Bl.vp.ty==="0"){Bn=Math.min(Bp*B3,B4);}else{if(Bl.vp.ty==="1"){Bn=Bp*B3;}else{Bn=Bp*B3;}}if(Bn<=2){Bn=3;}B5.model.maxBubbleRadius=Bn;if(B5.sizeByIndex>=0){var Bs=B5.sizeByIndex,B1=Math.abs(parseFloat(Bv.items[0].items[Bs].rv)),Bt=Math.abs(parseFloat(Bv.items[0].items[Bs].rv));for(Bz in B0){if(B0.hasOwnProperty(Bz)){var Bj=B5.getIndexFromHdrindex(Bz),Bk=Math.abs(parseFloat(Bv.items[Bj].items[Bs].rv));if(B1<Bk){B1=Bk;}if(Bt>Bk){Bt=Bk;}}}var Bw={};if(B1>Bt){var Br=Bn*Bt/B1;if(Br<2){Br=2;}var Bo=(Bn-Br)/(B1-Bt),Bm;for(Bz in B0){if(B0.hasOwnProperty(Bz)){Bm=(Math.abs(parseFloat(Bv.items[B5.getIndexFromHdrindex(Bz)].items[Bs].rv))-Bt)*Bo+Br;Bw[B0[Bz].n]=Bm;}}}else{for(Bz=0;Bz<B0.length;Bz++){Bw[B0[Bz].n]=Bn;}}B5.model.oriBubbleSize=Bw;}},storeOriPoints:function Ae(){var Bn=this.model.coords,Bm={},Bj,Bk,Bl;for(Bl in Bn){if(Bn.hasOwnProperty(Bl)){Bj=Bn[Bl][0];Bk=[Bj[0],Bj[1]];Bm[Bl]=Bk;}}return Bm;},drawBubbleMap:function BA(){var Bw=this,Bt=Bw.model,Bk=this.animationContext,Bx=Bt.coords,Bn,Bs,Bq,Bp,By;Bw.getAllBubblesColor();Bw.getOriBubbleSize();if(Bt.hasOwnProperty("bgImg")&&Bt.bgImg.hasOwnProperty("src")&&Bt.bgImg.src!=""&&Bt.bgImg.src!=null){Bw.drawBgImageFlag=true;if(!Bw.hasOwnProperty("oriBgImageWidth")){Bw.oriBgImageWidth=Bt.bgImg.width;}if(!Bw.hasOwnProperty("oriBgImageHeight")){Bw.oriBgImageHeight=Bt.bgImg.height;}if(!Bw.hasOwnProperty("oriCoords")){Bw.oriCoords=Bw.storeOriPoints();}var Bl=Bt.bgImg.width/((Bw.getWidth()-Bw.borderSpace*2)*Bw.scaleFactor),Bu=Bt.bgImg.height/((Bw.getHeight()-Bw.borderSpace*2)*Bw.scaleFactor),Bv=Math.max(Bu,Bl);Bw.topOffset=(Bw.getHeight()*Bw.scaleFactor-Bw.oriBgImageHeight/Bv)/2;Bw.leftOffset=(Bw.getWidth()*Bw.scaleFactor-Bw.oriBgImageWidth/Bv)/2;Bk.drawImage(Bt.bgImg,Bw.leftOffset,Bw.topOffset,Bw.oriBgImageWidth/Bv,Bw.oriBgImageHeight/Bv);if(Bw.shapeFileType===Ao){var Bo={};for(Bs in Bx){if(Bx.hasOwnProperty(Bs)){if(Bs==="bgImage"){continue;}var Bj=BH(Bx[Bs][0]);Bo[Bs]=Bj;Bo[Bs][0][0]/=Bv;Bo[Bs][0][1]/=Bv;}}Bt.polygonCenters=Bo;}else{var Br=Bw.oriCoords;for(Bs in Bx){if(Bx.hasOwnProperty(Bs)){if(Bs==="bgImage"){continue;}By=Bx[Bs][0];By[0]=parseInt(Br[Bs][0]/Bv,10);By[1]=parseInt(Br[Bs][1]/Bv,10);}}}Bw.drawBubblesInMap();}else{Bt.bgImg=new Image();Bt.bgImg.onerror=function(){var Bz="The backgrond Image cannot be found.";Bw.renderErrorMessage(mstrmojo.desc(9856,Bz));return ;};Bt.bgImg.onload=function(){Bw.drawBgImageFlag=true;if(!Bw.hasOwnProperty("oriBgImageWidth")){Bw.oriBgImageWidth=this.width;}if(!Bw.hasOwnProperty("oriBgImageHeight")){Bw.oriBgImageHeight=this.height;}if(!Bw.hasOwnProperty("oriCoords")){Bw.oriCoords=Bw.storeOriPoints();}var B2=this.width/((Bw.getWidth()-Bw.borderSpace*2)*Bw.scaleFactor),B1=this.height/((Bw.getHeight()-Bw.borderSpace*2)*Bw.scaleFactor),B3=Math.max(B1,B2);Bw.topOffset=(Bw.getHeight()*Bw.scaleFactor-Bw.oriBgImageHeight/B3)/2;Bw.leftOffset=(Bw.getWidth()*Bw.scaleFactor-Bw.oriBgImageWidth/B3)/2;Bw.animationCanvas.width=Bw.animationCanvas.width;Bk.drawImage(this,Bw.leftOffset,Bw.topOffset,Bw.oriBgImageWidth/B3,Bw.oriBgImageHeight/B3);if(Bw.shapeFileType===Ao){var B0={};for(Bs in Bx){if(Bx.hasOwnProperty(Bs)){if(Bs==="bgImage"){continue;}var Bz=BH(Bx[Bs][0]);B0[Bs]=Bz;B0[Bs][0][0]/=B3;B0[Bs][0][1]/=B3;}}Bt.polygonCenters=B0;}else{var B4=Bw.oriCoords;for(Bs in Bx){if(Bx.hasOwnProperty(Bs)){if(Bs==="bgImage"){continue;}By=Bx[Bs][0];By[0]=parseInt(B4[Bs][0]/B3,10);By[1]=parseInt(B4[Bs][1]/B3,10);}}}Bw.drawBubblesInMap();if(!Bw.bgImageScreenshotTaken){Bw.bgImageScreenshotTaken=true;Bw.localTakeScreenshot(BL);}};}if(Bx.hasOwnProperty("bgImage")&&Bx.bgImage!==""){if(!Bt.hasOwnProperty("bgImg")||!Bt.bgImg.hasOwnProperty("src")||Bt.bgImg.src==""||Bt.bgImg.src==null){var Bm=Bx.bgImage;Bt.bgImg.src=Bw.getFullPath(Bm);}}else{if(Bw.shapeFileType===Ao){Bw.drawBgImageFlag=false;Bw.scalePolygonCoords();Bw.drawPolygonInMap(x);var Bo={};for(Bs in Bx){if(Bx.hasOwnProperty(Bs)){if(Bs==="bgImage"){continue;}var Bj=BH(Bx[Bs][0]);Bo[Bs]=Bj;}}Bt.polygonCenters=Bo;Bw.drawBubblesInMap();}}},drawAreaMap:function A1(){var B1=this,Bk=B1.model,Bj=this.animationContext,Bt=Bk.coords,Bw,Bu,Bs,Bq,Bv,Bl,Bx,B0,Bp;if(!Bk.hasOwnProperty("oriPolyCoords")){B1.getOriPolygonCoords();}var Br=Bk.oriPolyCoords;Bj.save();Bj.lineWidth=2;Bj.strokeStyle="#AAAAAA";if(Bk.hasOwnProperty("bgImg")&&Bk.bgImg.hasOwnProperty("src")&&Bk.bgImg.src!=""&&Bk.bgImg.src!=null){if(B1.shapeFileType===AR){B1.drawBgImageFlag=false;}else{if(B1.shapeFileType===Ao){B1.drawBgImageFlag=true;if(!B1.hasOwnProperty("oriBgImageWidth")){B1.oriBgImageWidth=Bk.bgImg.width;}if(!B1.hasOwnProperty("oriBgImageHeight")){B1.oriBgImageHeight=Bk.bgImg.height;}var Bn=Bk.bgImg.width/((B1.getWidth()-B1.borderSpace*2)*B1.scaleFactor),Bo=Bk.bgImg.height/((B1.getHeight()-B1.borderSpace*2)*B1.scaleFactor),Bm=Math.max(Bo,Bn);B1.topOffset=(B1.getHeight()*B1.scaleFactor-B1.oriBgImageHeight/Bm)/2;B1.leftOffset=(B1.getWidth()*B1.scaleFactor-B1.oriBgImageWidth/Bm)/2;Bj.drawImage(Bk.bgImg,B1.leftOffset,B1.topOffset,B1.oriBgImageWidth/Bm,B1.oriBgImageHeight/Bm);for(Bu in Bt){if(Bt.hasOwnProperty(Bu)){if(Bu==="bgImage"){continue;}Bv=Bt[Bu];oriRgn=Br[Bu];for(Bs in Bv){if(Bv.hasOwnProperty(Bs)){Bx=Bv[Bs];B0=oriRgn[Bs];for(Bq=0;Bq<Bx.length;Bq++){Bx[Bq]=parseInt(B0[Bq]/Bm,10);}}}}}var Bz={};for(Bu in Bt){if(Bt.hasOwnProperty(Bu)){if(Bu==="bgImage"){continue;}var By=BH(Bt[Bu][0]);Bz[Bu]=By;}}Bk.polygonCenters=Bz;B1.drawPolygonInMap(AL);}}}else{Bk.bgImg=new Image();Bk.bgImg.onerror=function(){var B2="The backgrond Image cannot be found.";B1.renderErrorMessage(mstrmojo.desc(9856,B2));return ;};Bk.bgImg.onload=function(){if(B1.shapeFileType===AR){B1.drawBgImageFlag=false;}else{if(B1.shapeFileType===Ao){B1.drawBgImageFlag=true;if(!B1.hasOwnProperty("oriBgImageWidth")){B1.oriBgImageWidth=this.width;}if(!B1.hasOwnProperty("oriBgImageHeight")){B1.oriBgImageHeight=this.height;}var B5=this.width/((B1.getWidth()-B1.borderSpace*2)*B1.scaleFactor),B4=this.height/((B1.getHeight()-B1.borderSpace*2)*B1.scaleFactor),B6=Math.max(B4,B5);B1.topOffset=(B1.getHeight()*B1.scaleFactor-B1.oriBgImageHeight/B6)/2;B1.leftOffset=(B1.getWidth()*B1.scaleFactor-B1.oriBgImageWidth/B6)/2;Bj.drawImage(this,B1.leftOffset,B1.topOffset,B1.oriBgImageWidth/B6,B1.oriBgImageHeight/B6);for(Bu in Bt){if(Bt.hasOwnProperty(Bu)){if(Bu==="bgImage"){continue;}Bv=Bt[Bu];oriRgn=Br[Bu];for(Bs in Bv){if(Bv.hasOwnProperty(Bs)){Bx=Bv[Bs];B0=oriRgn[Bs];for(Bq=0;Bq<Bx.length;Bq++){Bx[Bq]=parseInt(B0[Bq]/B6,10);}}}}}var B3={};for(Bu in Bt){if(Bt.hasOwnProperty(Bu)){if(Bu==="bgImage"){continue;}var B2=BH(Bt[Bu][0]);B3[Bu]=B2;}}Bk.polygonCenters=B3;B1.drawPolygonInMap(AL);}}if(!B1.bgImageScreenshotTaken){B1.bgImageScreenshotTaken=true;B1.localTakeScreenshot(BL);}};}if(Bt.hasOwnProperty("bgImage")&&Bt.bgImage!==""){if(!Bk.bgImg.hasOwnProperty("src")||Bk.bgImg.src==""||Bk.bgImg.src==null){Bk.bgImg.src=B1.getFullPath(Bt.bgImage);}}else{if(B1.shapeFileType===Ao){B1.drawBgImageFlag=false;this.scalePolygonCoords();var Bz={};for(Bu in Bt){if(Bt.hasOwnProperty(Bu)){if(Bu==="bgImage"){continue;}var By=BH(Bt[Bu][0]);Bz[Bu]=By;}}Bk.polygonCenters=Bz;this.drawPolygonInMap(Be);}}Bj.restore();},getHeaderIndex:function BY(Bn){var Bm=-1,Bl=this.model.gts.row[0].es,Bk;if(Bn){Bn=Bn.toLowerCase();for(Bk=0;Bk<Bl.length;Bk++){var Bj=Bl[Bk].n;if(Bj&&Bj.toLowerCase()===Bn){Bm=Bk;break;}}}return Bm;},getNewColorForOpacityChange:function AJ(Bo,Bp,Bl,Bk,Bn){if(Bk>1||Bk<0||Bn>1||Bn<0){return Bl;}var Bj=0.0001,Bm=Bo;if(!Bo||Bp){Bm="#FFFFFF";}if(Bn>=Bk){if(Bk+Bj>1){return Bl;}else{return BZ(Bl,(Bn-Bk)/(1-Bk));}}else{if(Bn<Bk){if(Bk-Bj<0){return BZ(Bl,0);}else{return BZ(Bm,(Bk-Bn)/Bk);}}}},drawPartOpacityBG:function AF(Bt,Bs,Bl){Bt.save();var B1=this,Bk=B1.model,Bx=B1.leftOffset?B1.leftOffset:0,Bw=B1.topOffset?B1.topOffset:0;var Bj=function(B2){var B3=B2%2?Bw:Bx;return Br[B2]+B3;};Bt.beginPath();var Bv,Bu;for(Bv=0;Bv<Bs.length;Bv++){var Br=Bs[Bv],B0=Bj(0),Bz=Bj(1),By=Bj(1),Bp,Bo;Bt.moveTo(Bj(0),Bj(1));for(Bu=2;Bu<Br.length-1;Bu=Bu+2){Bp=Bj(Bu);Bo=Bj(Bu+1);Bt.lineTo(Bp,Bo);By=Math.max(Bo,By);Bz=Math.min(Bo,Bz);B0=Math.min(Bp,B0);}Bp=Bj(0);Bo=Bj(1);Bt.lineTo(Bp,Bo);}Bt.clip();Bt.globalAlpha=Bl;var Bn=B1.oriBgImageWidth/((B1.getWidth()-B1.borderSpace*2)*B1.scaleFactor),Bq=B1.oriBgImageHeight/((B1.getHeight()-B1.borderSpace*2)*B1.scaleFactor),Bm=Math.max(Bq,Bn);B1.topOffset=(B1.getHeight()*B1.scaleFactor-B1.oriBgImageHeight/Bm)/2;B1.leftOffset=(B1.getWidth()*B1.scaleFactor-B1.oriBgImageWidth/Bm)/2;Bt.drawImage(Bk.bgImg,B1.leftOffset,B1.topOffset,B1.oriBgImageWidth/Bm,B1.oriBgImageHeight/Bm);Bt.restore();},highlightImageIcon:function BS(Bm,Bt,Bu,Bq){var Br=this,Bo=Br.model,Bk="RGBA(255,255,255,0.5)",Bs="imageIcon_"+Bu;if(Bo.hasOwnProperty(Bs)){var Bn=Bo[Bs],Bj=Bn.width+Bq*2,Bv=Bn.height+Bq*2,Bp=Bt[Bu][0][0]-Bj/2+Br.leftOffset,Bl=Bt[Bu][0][1]-Bv/2+Br.topOffset;Bm.fillStyle=Bk;Bm.fillRect(Bp,Bl,Bj,Bv);Bb(Bm,Bp,Bl,Bj,Bv);}},highlightPoint:function A0(){var Bx=this,Bn=Bx.model,B7=Bx.highlightContext,B5;Bx.highlightCanvas.width=Bx.highlightCanvas.width;if(Bx.currSelectedObj===null&&N(Bx.defaultSelectedObjs)&&Bx.displayMode===T){if(Bx.drawBgImageFlag){if(Bx.curPolygonOpacity!==AL){Bx.drawPolygonInMap(AL);}}else{if(Bx.curPolygonOpacity!==Be){Bx.drawPolygonInMap(Be);}}}if(Bx.displayMode===T){var CA=Bn.bgColor,CH=U,By=BI,CC=At,B8=Ap,Bs=Ar;if(Bn.themeMode===t){CH=BB;By=J;CC=Ab;B8=A4;Bs=A6;}if(Bn.vp&&Bn.vp.npc){B8=BZ("#"+Bn.vp.npc,Be);}var CN=B8;var CD=Bx.defaultSelectedObjs;if(!N(CD)){if(Bx.curPolygonOpacity!==Aq){Bx.drawPolygonInMap(Aq);}var CI;for(CI in CD){if(CD.hasOwnProperty(CI)){if(Bx.currHoverObj!==null&&Bx.currHoverObj.hasOwnProperty("touchVal")&&Bx.currHoverObj.touchVal!==""&&Bx.currHoverObj.touchVal!==null&&Bx.currHoverObj.touchVal===CI){continue;}else{var Bl=Bx.defaultSelectedObjs[CI];if(Bl>=0){if(Bx.colorByIndex>=0){if(Bx.thresholdType===AP){var B3=Bn.gvs.items[Bx.getIndexFromHdrindex(Bl)].items[Bx.colorByIndex];CN=Bx.getBgColorFromCSS(B3);if(!CN){CN=Bs;}}else{CN=Bs;}}else{CN=Bs;}}else{CN=B8;}if(Bx.drawBgImageFlag){CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Aq,BE);}else{CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Aq,BR);}AU(B7,Bn.coords[CI],{x:Bx.leftOffset,y:Bx.topOffset},CH,Bx.highlightPolygonStrokeWidth,CN);}}}CN=B8;}else{if(Bx.currSelectedObj!==null&&Bx.currSelectedObj.hasOwnProperty("touchVal")&&Bx.currSelectedObj.touchVal!==""&&Bx.currSelectedObj.touchVal!==null){if(Bx.curPolygonOpacity!==Aq){Bx.drawPolygonInMap(Aq);}if(Bx.currHoverObj!==null&&Bx.currHoverObj.hasOwnProperty("touchVal")&&Bx.currHoverObj.touchVal!==""&&Bx.currHoverObj.touchVal!==null&&Bx.currHoverObj.touchVal===Bx.currSelectedObj.touchVal){}else{if(Bx.currSelectedObj.hasOwnProperty("hdrIndex")){B5=Bx.currSelectedObj.hdrIndex;}else{B5=Bx.getHeaderIndex(Bx.currSelectedObj.touchVal);}if(B5>=0){if(Bx.colorByIndex>=0){if(Bx.thresholdType===AP){var B3=Bn.gvs.items[Bx.getIndexFromHdrindex(B5)].items[Bx.colorByIndex];CN=Bx.getBgColorFromCSS(B3);if(!CN){CN=Bs;}}else{CN=Bs;}}else{CN=Bs;}}else{CN=B8;}if(Bx.drawBgImageFlag){CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Aq,BE);}else{CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Aq,BR);}AU(B7,Bn.coords[Bx.currSelectedObj.touchVal],{x:Bx.leftOffset,y:Bx.topOffset},CH,Bx.highlightPolygonStrokeWidth,CN);}}else{if(Bx.currLinkObj!==null&&Bx.currLinkObj.hasOwnProperty("touchVal")&&Bx.currLinkObj.touchVal!==""&&Bx.currLinkObj.touchVal!==null){if(Bx.currLinkObj.hasOwnProperty("hdrIndex")){B5=Bx.currLinkObj.hdrIndex;}else{B5=Bx.getHeaderIndex(Bx.currLinkObj.touchVal);}if(B5>=0){if(Bx.colorByIndex>=0){if(Bx.thresholdType===AP){var B3=Bn.gvs.items[Bx.getIndexFromHdrindex(B5)].items[Bx.colorByIndex];CN=Bx.getBgColorFromCSS(B3);if(!CN){CN=Bs;}}else{CN=Bs;}}else{CN=Bs;}}else{CN=B8;}if(Bx.drawBgImageFlag){CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,AL,H);}else{CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Be,H);}AU(B7,Bn.coords[Bx.currLinkObj.touchVal],{x:Bx.leftOffset,y:Bx.topOffset},By,Bx.highlightPolygonStrokeWidth,CN);}}}if(Bx.currHoverObj!==null&&Bx.currHoverObj.hasOwnProperty("touchVal")&&Bx.currHoverObj.touchVal!==""&&Bx.currHoverObj.touchVal!==null){var CB=Bx.currHoverObj;if(CB.hasOwnProperty("hdrIndex")){B5=CB.hdrIndex;}else{B5=Bx.getHeaderIndex(CB.touchVal);}if(B5>=0){if(Bx.colorByIndex>=0){if(Bx.thresholdType===AP){var B3=Bn.gvs.items[Bx.getIndexFromHdrindex(B5)].items[Bx.colorByIndex];CN=Bx.getBgColorFromCSS(B3);if(!CN){CN=Bs;}}else{CN=Bs;}}else{CN=Bs;}}else{CN=B8;}if(Bx.currSelectedObj!==null||!N(Bx.defaultSelectedObjs)){if(Bx.drawBgImageFlag){CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Aq,AE);}else{CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Aq,BN);}AU(B7,Bn.coords[Bx.currHoverObj.touchVal],{x:Bx.leftOffset,y:Bx.topOffset},CC,Bx.highlightPolygonStrokeWidth,CN);}else{if(Bx.drawBgImageFlag){var B6=(AL-q)/AL;this.drawPartOpacityBG(B7,Bn.coords[Bx.currHoverObj.touchVal],B6);CN="RGBA(0,0,0,0)";AU(B7,Bn.coords[Bx.currHoverObj.touchVal],{x:Bx.leftOffset,y:Bx.topOffset},By,Bx.highlightPolygonStrokeWidth,CN);}else{CN=this.getNewColorForOpacityChange(CA,Bx.drawBgImageFlag,CN,Be,q);AU(B7,Bn.coords[Bx.currHoverObj.touchVal],{x:Bx.leftOffset,y:Bx.topOffset},By,Bx.highlightPolygonStrokeWidth,CN);}}if(Bx.newRenderFlag){Bx.newRenderFlag=false;var CK=Bx.model.polygonCenters&&Bx.model.polygonCenters[Bx.currHoverObj.touchVal]&&Bx.model.polygonCenters[Bx.currHoverObj.touchVal][0];if(CK){var B9=CK[0]+Bx.leftOffset-Bx._scroller.origin.x;var Bo=CK[1]+Bx.topOffset-Bx._scroller.origin.y;Bx.renderTooltip(this.currHoverObj.touchVal,B9,Bo,this.currHoverObj.hdrIndex);}}else{Bx.renderTooltip(this.currHoverObj.touchVal,this.currHoverObj.point.x,this.currHoverObj.point.y,this.currHoverObj.hdrIndex);}}}else{if(Bx.displayMode===A8){var CH=BO,By=AM,B0=AX,CJ=Bd,Bs=Au;if(Bn.themeMode===t){CH=BX;By=BM;B0=S;CJ=Al;Bs=f;}if(Bx.markerType===AG){Bx.drawBubblesInMap();var CD=Bx.defaultSelectedObjs;if(!N(CD)){var CI;for(CI in CD){if(CD.hasOwnProperty(CI)){var Bq=Bx.getRadiusFromName(CI);CN=Bx.getBubbleColorFromName(CI);if(!CN){continue;}CN=BZ(CN,h);if(Bx.shapeFileType===Ao){if(Bn.hasOwnProperty("polygonCenters")){Bv=Bn.polygonCenters[CI][0];}}else{if(Bx.shapeFileType===AR){Bv=Bn.coords[CI][0];}}L(B7,Bv,{x:Bx.leftOffset,y:Bx.topOffset},CN,Bq);R(B7,Bv,{x:Bx.leftOffset,y:Bx.topOffset},CH,Bq,Bx.bubbleStrokeWidth);}}CN=B8;}else{if(Bx.currSelectedObj!==null&&Bx.currSelectedObj.hasOwnProperty("touchVal")&&Bx.currSelectedObj.touchVal!==""&&Bx.currSelectedObj.touchVal!==null){var CN=Bs,Bv,Bq;Bq=Bx.getRadiusFromName(Bx.currSelectedObj.touchVal);CN=Bx.getBubbleColorFromName(Bx.currSelectedObj.touchVal);if(!CN){CN=Bs;}CN=BZ(CN,h);if(Bx.shapeFileType===Ao){if(Bn.hasOwnProperty("polygonCenters")){Bv=Bn.polygonCenters[Bx.currSelectedObj.touchVal][0];}}else{if(Bx.shapeFileType===AR){Bv=Bn.coords[Bx.currSelectedObj.touchVal][0];}}L(B7,Bv,{x:Bx.leftOffset,y:Bx.topOffset},CN,Bq);R(B7,Bv,{x:Bx.leftOffset,y:Bx.topOffset},CH,Bq,Bx.bubbleStrokeWidth);}else{if(Bx.currLinkObj!==null&&Bx.currLinkObj.hasOwnProperty("touchVal")&&Bx.currLinkObj.touchVal!==""&&Bx.currLinkObj.touchVal!==null){var CF,CM;CM=Bx.getRadiusFromName(Bx.currLinkObj.touchVal);CN=Bx.getBubbleColorFromName(Bx.currLinkObj.touchVal);if(!CN){CN=Bs;}CN=BZ(CN,A5);if(Bx.shapeFileType===Ao){if(Bn.hasOwnProperty("polygonCenters")){CF=Bn.polygonCenters[Bx.currLinkObj.touchVal][0];}}else{if(Bx.shapeFileType===AR){CF=Bn.coords[Bx.currLinkObj.touchVal][0];}}L(B7,CF,{x:Bx.leftOffset,y:Bx.topOffset},CN,CM);R(B7,CF,{x:Bx.leftOffset,y:Bx.topOffset},B0,CM,Bx.bubbleStrokeWidth);R(B7,CF,{x:Bx.leftOffset,y:Bx.topOffset},CJ,CM+Bx.hoverBubbleRadiusLarger,Bx.bubbleStrokeWidth);}}}if(Bx.currHoverObj!==null&&Bx.currHoverObj.hasOwnProperty("touchVal")&&Bx.currHoverObj.touchVal!==""&&Bx.currHoverObj.touchVal!==null){var Bw,Bp,CG=Bx.currHoverObj.touchVal;Bp=Bx.getRadiusFromName(CG);CN=Bx.getBubbleColorFromName(CG);if(!CN){CN=Bs;}var Bm=By;if((Bx.currSelectedObj&&Bx.currSelectedObj.touchVal===CG)||(!N(Bx.defaultSelectedObjs)&&Bx.defaultSelectedObjs.hasOwnProperty(CG))){CN=BZ(CN,h);Bm=CH;}else{CN=BZ(CN,AH);}if(Bx.shapeFileType===Ao){if(Bn.hasOwnProperty("polygonCenters")){Bw=Bn.polygonCenters[Bx.currHoverObj.touchVal][0];}}else{if(Bx.shapeFileType===AR){Bw=Bn.coords[Bx.currHoverObj.touchVal][0];}}L(B7,Bw,{x:Bx.leftOffset,y:Bx.topOffset},CN,Bp);R(B7,Bw,{x:Bx.leftOffset,y:Bx.topOffset},Bm,Bp,Bx.bubbleStrokeWidth);R(B7,Bw,{x:Bx.leftOffset,y:Bx.topOffset},CJ,Bp+Bx.hoverBubbleRadiusLarger,Bx.bubbleStrokeWidth);if(Bx.newRenderFlag){Bx.newRenderFlag=false;var Bu;if(Bx.shapeFileType===Ao){Bu=Bx.model.polygonCenters&&Bx.model.polygonCenters[Bx.currHoverObj.touchVal]&&Bx.model.polygonCenters[Bx.currHoverObj.touchVal][0];}else{if(Bx.shapeFileType===AR){Bu=Bx.model.coords&&Bx.model.coords[Bx.currHoverObj.touchVal]&&Bx.model.coords[Bx.currHoverObj.touchVal][0];}}if(Bu){var B9=Bu[0]+Bx.leftOffset-Bx._scroller.origin.x;var Bo=Bu[1]+Bx.topOffset-Bx._scroller.origin.y;Bx.renderTooltip(this.currHoverObj.touchVal,B9,Bo,this.currHoverObj.hdrIndex);}}else{Bx.renderTooltip(this.currHoverObj.touchVal,this.currHoverObj.point.x,this.currHoverObj.point.y,this.currHoverObj.hdrIndex);}}}else{if(Bx.markerType===AI){var Bt=Bn.coords;if(Bn.hasOwnProperty("polygonCenters")){Bt=Bn.polygonCenters;}var CD=Bx.defaultSelectedObjs;if(!N(CD)){var CI;for(CI in CD){if(CD.hasOwnProperty(CI)){Bx.highlightImageIcon(B7,Bt,CI,0);}}}else{if(Bx.currSelectedObj!==null&&Bx.currSelectedObj.hasOwnProperty("touchVal")&&Bx.currSelectedObj.touchVal!==""&&Bx.currSelectedObj.touchVal!==null){var B4=Bx.currSelectedObj.touchVal;Bx.highlightImageIcon(B7,Bt,B4,0);}else{if(Bx.currLinkObj!==null&&Bx.currLinkObj.hasOwnProperty("touchVal")&&Bx.currLinkObj.touchVal!==""&&Bx.currLinkObj.touchVal!==null){var B4=Bx.currLinkObj.touchVal;Bx.highlightImageIcon(B7,Bt,B4,Bx.hoverBubbleRadiusLarger);}}}if(Bx.currHoverObj!==null&&Bx.currHoverObj.hasOwnProperty("touchVal")&&Bx.currHoverObj.touchVal!==""&&Bx.currHoverObj.touchVal!==null){var B4=Bx.currHoverObj.touchVal,CN="RGBA(255,255,255,0.5)";var CE="imageIcon_"+B4;if(Bn.hasOwnProperty(CE)){var Bz=Bn[CE],Bj=Bz.width+Bx.hoverBubbleRadiusLarger*2,Bk=Bz.height+Bx.hoverBubbleRadiusLarger*2,B1=Bt[B4][0][0]-Bj/2+Bx.leftOffset,B2=Bt[B4][0][1]-Bk/2+Bx.topOffset;B7.fillStyle=CN;B7.fillRect(B1,B2,Bj,Bk);var Br=Bx.currSelectedObj,CL=Bx.currHoverObj.touchVal;if((Br!==null&&Br.hasOwnProperty("hdrIndex")&&Br.hdrIndex>=0&&Br.touchVal===CL)||(!N(Bx.defaultSelectedObjs)&&Bx.defaultSelectedObjs.hasOwnProperty(CL))){}else{Bb(B7,B1,B2,Bj,Bk);}}if(Bx.newRenderFlag){Bx.newRenderFlag=false;var Bu;if(Bx.shapeFileType===Ao){Bu=Bx.model.polygonCenters&&Bx.model.polygonCenters[Bx.currHoverObj.touchVal]&&Bx.model.polygonCenters[Bx.currHoverObj.touchVal][0];}else{if(Bx.shapeFileType===AR){Bu=Bx.model.coords&&Bx.model.coords[Bx.currHoverObj.touchVal]&&Bx.model.coords[Bx.currHoverObj.touchVal][0];}}if(Bu){var B9=Bu[0]+Bx.leftOffset-Bx._scroller.origin.x;var Bo=Bu[1]+Bx.topOffset-Bx._scroller.origin.y;Bx.renderTooltip(this.currHoverObj.touchVal,B9,Bo,this.currHoverObj.hdrIndex);}}else{Bx.renderTooltip(this.currHoverObj.touchVal,this.currHoverObj.point.x,this.currHoverObj.point.y,this.currHoverObj.hdrIndex);}}}}}}},getTouchValue:function Ah(Bu,Bs){var Br=this,Bo=this.model,Bt=Bo.coords,Bl,Bn;if(Br.displayMode===T){if(Br.shapeFileType===Ao){for(Bl in Bt){if(Bt.hasOwnProperty(Bl)){if(Bl==="bgImage"){continue;}var Bj=Bt[Bl],Bm=Bj.length;for(Bn=0;Bn<Bm;Bn++){if(P(Bj[Bn],Bu,Bs)){return Bl;}}}}}}else{if(Br.displayMode===A8){if(Br.shapeFileType===Ao&&Bo.hasOwnProperty("polygonCenters")){Bt=Bo.polygonCenters;}var Bv=Number.MAX_VALUE,Bq="";for(Bl in Bt){if(Bt.hasOwnProperty(Bl)){if(Bl==="bgImage"){continue;}var Bp=Bt[Bl][0],Bk=Math.sqrt((Bu-Bp[0])*(Bu-Bp[0])+(Bs-Bp[1])*(Bs-Bp[1]));if(Bk<Bv){Bv=Bk;Bq=Bl;}}}if(Bv<this.bias){return Bq;}}}return null;},getAreaOrNearestBubble:function(Bn,Bu,Bt){var Bo=this,Bm=Bo.model,Br=Bm.coords;var Bk=Bo.utils.getTouchXYOnWidget(Bu,Bt,Bo);Bu=Bk.touchX;Bt=Bk.touchY;var Bs=Bu+Bo._scroller.origin.x-Bo.leftOffset,Bp=Bt+Bo._scroller.origin.y-Bo.topOffset,Bq;if(Bn&&Bo.tooltipOn&&Bo.currHoverObj!==null){var Bl=null;if(Bo.shapeFileType===Ao){Bl=Bm.polygonCenters&&Bm.polygonCenters[Bo.currHoverObj.touchVal]&&Bm.polygonCenters[Bo.currHoverObj.touchVal][0];}else{if(Bo.shapeFileType===AR){Bl=Br[Bo.currHoverObj.touchVal]&&Br[Bo.currHoverObj.touchVal][0];}}if(Bl){var Bj=Math.sqrt((Bs-Bl[0])*(Bs-Bl[0])+(Bp-Bl[1])*(Bp-Bl[1]));if(Bj<Bo.bias){Bq=Bo.currHoverObj.touchVal;}else{Bq=Bo.getTouchValue(Bs,Bp);}}}else{Bq=Bo.getTouchValue(Bs,Bp);}if(!Bq){return null;}var Bv=Bo.getHeaderIndex(Bq);return{touchVal:Bq,hdrIndex:Bv,point:{x:Bu,y:Bt}};},renderTooltip:function M(Bj,B1,B0,Bl){var CF=this,Bu=this.tooltip,Bs=this.model,CD=this.tooltip.childNodes[0],B2=0,CA,B8,Bm,By,CE;if(CD){for(CA=0;CA<CD.childNodes.length;CA++){Bm=CD.childNodes[CA];if(Bm){Bm.childNodes[0].innerHTML="";Bm.childNodes[1].innerHTML="";}}}this.tooltip.style.visibility="visible";if(!CF.tooltipOn){CF.tooltipOn=true;var Bt=mstrmojo.touchManager;CF.tooltipListener=Bt.attachEventListener("touchesBegin",CF.id,function(CG){if(!CF.isTouchedOnWidget(CG.touch)){CF.hideTooltip();}});}var Bk=Bs.gts,B6,Bo;if(Bl>=0){var Bz=Bk.row,Bw=Bs.ghs.rhs.items,B4;Bm=B2<CD.childNodes.length&&CD.childNodes[B2++];if(Bm){Bm.childNodes[0].style.display="table-cell";Bm.childNodes[1].style.align="left";Bm.childNodes[0].style.paddingRight="5px";B6=Bz[0].n+":";Bm.childNodes[0].innerHTML=B6;Bo=Bz[0].es[Bl].n;Bm.childNodes[1].innerHTML=Bo;}var Bx=CF.getIndexFromHdrindex(Bl);for(CA=1;CA<Bz.length;CA++){Bm=B2<CD.childNodes.length&&CD.childNodes[B2++];if(Bm){Bm.childNodes[0].style.paddingRight="5px";B6=Bz[CA].n+":";Bm.childNodes[0].innerHTML=B6;Bo="";var Bq=CF.attrIndices[CA];if(Bq){for(B8=0;B8<Bq.length;B8++){B4=Bw[Bx].items[Bq[B8]].idx;Bo+=Bz[CA].es[B4].n;if(B8!==Bq.length-1){Bo+=" ";}}}Bm.childNodes[1].innerHTML=Bo;}}var CC=Bk.col;if(CC&&CC.length>0){var B7=CC[0].es,Bn=Bs.gvs.items[Bx].items;for(CA=0;CA<B7.length;CA++){Bm=B2<CD.childNodes.length&&CD.childNodes[B2++];if(Bm){Bm.childNodes[0].style.paddingRight="5px";var B5=Bn[CA],B3=B5.v;if(B5&&B5.hasOwnProperty("ty")&&B5.ty!=4&&B5.ty!=10&&B5.ty!=3&&B5.hasOwnProperty("ti")){var Bv=Bs.th&&Bs.th[CA];B3=(Bv&&Bv[B5.ti]&&Bv[B5.ti].n)?Bv[B5.ti].n:B5.v;}B6=B7[CA].n+":";Bm.childNodes[0].innerHTML=B6;Bo=""+B3;Bm.childNodes[1].innerHTML=Bo;}}}else{}}else{if(Bl<0){Bo=Bj;Bm=B2<CD.childNodes.length&&CD.childNodes[B2++];if(Bm){Bm.childNodes[1].innerHTML=Bo;Bm.childNodes[0].style.display="none";Bm.childNodes[1].style.align="center";}}}var CB=B1+this.bias,B9=B0-this.bias-Bu.offsetHeight,Br=this.getWidth()-Bu.offsetWidth-this.tooltipRightShadowWidth,Bp=this.getHeight()-Bu.offsetHeight;if(CB>Br){if(B9<0){B9=0;CB=Math.max(B1-this.bias-Bu.offsetWidth,0);}else{if(B9>=0){CB=Br;}}}else{if(CB<=Br){if(B9<0){B9=0;}else{if(B9>=0){}}}}BU(Bu,CB,B9);},hideTooltip:function Ag(){if(this.tooltipOn){this.tooltipOn=false;this.currHoverObj=null;this.highlightPoint();this.tooltip.style.visibility="hidden";if(this.tooltipListener){mstrmojo.touchManager.detachEventListener(this.tooltipListener);delete this.tooltipListener;}}},isTouchedOnWidget:function Aj(Bn){if(!Bn){return false;}var Bl=this,Bk=Bl.utils.getTouchXYOnWidget(Bn.pageX,Bn.pageY,Bl),Bj=Bk.touchX,Bm=Bk.touchY;if((Bj>0&&Bj<Bl.getWidth())&&(Bm>0&&Bm<Bl.getHeight())){return true;}return false;},unrender:function Ac(Bk){var Bl=this,Bj=Bl.model;if(this._super){this._super(Bk);}if(Bl.docModelListener){if(Bl.xtabModel&&Bl.xtabModel.docModel){Bl.xtabModel.docModel.detachEventListener(Bl.docModelListener);}delete Bl.docModelListener;}if(Bl.fullScreenListener){mstrmojo.touchManager.detachEventListener(Bl.fullScreenListener);delete Bl.fullScreenListener;}if(Bl.tooltipListener){mstrmojo.touchManager.detachEventListener(Bl.tooltipListener);delete Bl.tooltipListener;}if(Bl.highlightContext){delete Bl.highlightContext;}if(Bl.animationContext){delete Bl.animationContext;}if(Bl._tn){delete Bl._tn;}},destroy:function K(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.VisChartUtils","mstrmojo.VisChartData","mstrmojo.boxmodel");function N(S,R){var O="",P=S.length;if(P!==R.hi.length){return S[0].items[R.hi[0]].n;}for(var Q=0;Q<P;Q++){O+=(Q>0?" ":"")+S[Q].items[R.hi[Q]].n;}return O;}mstrmojo.VisChart=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.VisChart",utils:mstrmojo.VisChartUtils,data:mstrmojo.VisChartData,model:null,prevYLabel:{x:0,y:0,h:0},prevXLabel:{x:0,y:0,w:0},context:null,themeColor:"#000000",highlightColor:"#ff8833",margin:{t:50,r:2,b:30,l:2},offsetLeft:null,xLabelPadding:10,yLabelPadding:10,isDrawAxis:true,drawXAxisLabels:true,drawYAxisLabels:true,isHighlightOnTouch:true,isLinearChart:true,showHighlightLine:true,browserSupportsHtml5:true,multiLine:true,drawGridLines:3,drawHorizontalGridLines:1,drawVerticalGridLines:2,switchSeriesOnTouch:true,seriesIndex:-1,displayMode:0,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};position:relative;"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><div id="{@id}-tooltip" class="mstrmojo-Chart-tooltip"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},animationCanvas:function(){return this.domNode.childNodes[1];},highlightCanvas:function(){return this.domNode.childNodes[2];},tooltip:function(){return this.domNode.childNodes[3];}},postBuildRendering:function G(){if(this._super){this._super();}this.browserSupportsHtml5=this.canvas.getContext;if(!this.browserSupportsHtml5){this.renderErrorMessage(mstrmojo.desc(8126,"Your browser does not support HTML5"));return ;}if(!this.model){this.renderErrorMessage(mstrmojo.desc(8426,"No model provided"));return ;}if(this.model.err||this.model.eg){this.renderErrorMessage(this.model.err||this.model.eg);return ;}if(this.isLinearChart){this.data.processLinearData(this);}else{this.data.process(this);}this.windowSize=this.model.series[0].rv.length;this.context=this.canvas.getContext("2d");this.highlightContext=this.highlightCanvas.getContext("2d");this.animationContext=this.animationCanvas.getContext("2d");this.utils.fillBackground(this);if(this.windowSize<=1){return ;}this.plot();},getMaxValue:function C(){var O=this.model.mvalues;return O&&O[O.length-1];},getMinValue:function F(){var O=this.model.mvalues;return O&&O[0];},plot:function J(){this.drawChart();if(this.model.err||this.model.eg){return ;}if(this.isDrawAxis){if(this.isTimeSeries||!(this.isAnimateLines&&(!this.multiLine||this.model.series.length===1))){this.drawLabels();}else{this.drawAxis();}}},drawChart:function M(){},drawAxis:function B(){var P=this.utils,S=this.margin,R=this.getWidth(),O=this.canvas.height,Q=this.context;Q.save();Q.strokeStyle=P.getColor(this);Q.lineWidth=2;Q.globalAlpha=0.3;P.drawRectangle(this,S.l,S.t,R-S.l-S.r,O-S.t-S.b);Q.restore();},drawLabels:function E(){if(!this.isDrawAxis||!this.drawYAxisLabels){return ;}var U=this.model,X=this.utils,S=this.margin,Y=U.mvalues,O=U.ylbls,R=Y.length,Q=this.drawGridLines;this.prevYLabel.x=0;this.prevYLabel.y=0;this.prevYLabel.h=0;for(var T=0;T<R;T++){var W=X.getYValue(this,Y[T]);var V=X.addDataLabel(this,O[T],W,this.prevYLabel);var P=Math.floor(W)+0.5;if(V&&(Q&this.drawHorizontalGridLines)&&T>0&&T<R-1){X.drawHighlightLine(this,P);}if(T==R-1&&this.isTimeSeries&&V&&(Q&this.drawHorizontalGridLines)){X.drawHighlightLine(this,P);}}},renderTooltip:function A(d,b,a){if(d<0){this.tooltip.style.display="none";return ;}var R=this.model,g=R.series,Z=this.utils,T=g.length,W=this.seriesIndex,O=R.colHeaders,f=this.tooltip;var Q="";if(!this.multiLine){Q=N(O,g[0])+": "+g[0].v[d];}else{if(this.showHighlightLine){for(var V=0;V<T;V++){Q+=(V===0?"":"<br/>")+N(O,g[V])+": "+g[V].v[d];}}else{Q=N(O,g[W])+": "+g[W].v[d];}}var Y=this.model.categories.items[d];f.innerHTML=Y+"<br/>"+Q;f.style.display="block";var X=f.offsetWidth;var S=b-X/2;var U=this.margin;if(S<U.l){S=U.l;}else{if(S>this.getWidth()-U.r-X){S=this.getWidth()-U.r-X;}}if(this.showHighlightLine){Z.translateCSS(S,0,false,f);}else{var P=Z.getYValue(this,g[W].rv[d])-f.offsetHeight-20;if(P<0){P=Z.getYValue(this,g[W].rv[d]);}Z.translateCSS(S,P,false,f);}},getTouchValue:function L(P,T){var R=this.model,O=this.margin;var S=R.rne-R.rns>0?R.rne-R.rns>1?R.rne-R.rns:2:this.windowSize;var Q=Math.round(((P-O.l)*(S-1))/(this.getWidth()-O.l-O.r-1));return(Q<S)?Q:null;},highlightPoint:function I(P,O){},handleTouchBegin:function H(P,O){if(!this.isHighlightOnTouch||!this.browserSupportsHtml5){return ;}this.tooltipOn=true;this.adjustWidgetOffsets();this.handleTouchMove(P,O);},handleTouchMove:function D(R,Q){var U=this,P=U.model;if(!U.tooltipOn||!U.isHighlightOnTouch||!this.browserSupportsHtml5||this.windowSize<=1){return ;}var T=U.utils.getTouchXYOnWidget(R,Q,U);R=T.touchX;Q=T.touchY;var V=U.margin;if(R<V.l||Q<V.t||Q>U.canvas.height-V.b){return ;}var S=U.getTouchValue(R,Q);if(S!==null){var O=(P.rne-P.rns>1)?P.rns:P.rns-1;if(U.seriesIndex===-1||U.switchSeriesOnTouch){U.seriesIndex=U.utils.getSeriesIndexAndYValue(U,O+S,Q).si;}if(P.series[U.seriesIndex].rv[O+S]===""){return ;}U.prevHighlight=U.currentHighlight;U.currentHighlight=S;U.renderTooltip(S,R,Q);if(this.isTimeSeries){U.highlightPoint(S,R,Q);}else{U.highlightPoint(S,Q);}}},handleTouchEnd:function K(){if(!this.browserSupportsHtml5){return ;}var O=this;if(O.model.err||this.model.eg){return ;}O.tooltipOn=false;O.seriesIndex=-1;O.currentHighlight=null;O.highlightCanvas.height=O.highlightCanvas.height;O.tooltip.style.display="none";},onmousedown:function(O){if(!this.isAndroid){this.handleTouchBegin(O.e.pageX,O.e.pageY);}},onmouseup:function(O){if(!this.isAndroid){this.handleTouchEnd();}},onmousemove:function(O){if(!this.isAndroid){this.handleTouchMove(O.e.pageX,O.e.pageY);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.url","mstrmojo._TouchGestures","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Image","mstrmojo._HasTouchScroller");var B=Math,K=mstrmojo.css,H=mstrmojo.dom,Q=30,D=50,E=32;function P(T){var U="container"+T;if(!this[U]){var S=this.domNode,R=parseInt(this[T.toLowerCase()],10);this[U]=(isNaN(R))?S["client"+T]:R;}return this[U];}function J(R){var S,T="";if(R>0){for(S=0;S<R;S++){T+='<col style="width:'+(100/R)+'%" />';}}return"<colgroup>"+T+"</colgroup>";}function C(R){return mstrmojo.url.getAbsoluteURL(R,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());}function O(S,R){S.style[H.CSS3_TRANSITION_DURATION]="500ms";H.translate(S,R,0,0,"",true);}function L(Y,R,V){if(!Y){return ;}var U=Y.clientWidth,W=Y.clientHeight,X,T,S=false;if(R<U||V<W){S=true;X=R/U;T=V/W;if(X<T){Y.width=R;}else{Y.height=V;}}return S;}function I(V){var Y=[],S,X,T,W,Z,R=V.getTotalRows(),U=R>0?V.getRowTitles().size():0;for(S=0;S<R;S++){W=V.getRowHeaders(S);for(X=0;X<U;X++){if(!Y[X]){Y[X]=[];}Z=W.getHeader(X);Y[X].push({n:Z.getName()});}}return Y;}mstrmojo.ImageCarousel=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.ImageCarousel",markupString:'<div class="mstrmojo-ImageCarousel {@cssClass}" style="overflow:hidden;{@cssText}"><div class="imageViewer" mstrAttach:click>{@noImageMsg}</div><div class="imageTitle"></div><div class="statusBar" style="overflow:hidden"></div></div>',markupSlots:{viewerNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.childNodes[1];},statusBarNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW"]},scrollerConfig:{friction:0.0087,bounces:false,vScroll:false,hScroll:true},selected:-1,children:[{scriptClass:"mstrmojo.HBox",slot:"viewerNode",alias:"viewer",onitemsChange:function(){var Y,V,W,X=[],S=this.parent.vp,Z;Y=this.items;if(!this.hasRendered){var T=this.parent,U=P.call(T,"Width"),R=P.call(T,"Height");if(this.children){this.removeChildren();}W=Y.length;this.colHTML=J(W);this.cssText="width:"+(U*W)+"px;height:"+(R-D)+"px";Z=(S&&S.bw)?("border:"+S.bw+"px solid #"+(S.bc||"FFF")):"";for(V=0;V<W;V++){X.push({scriptClass:"mstrmojo.Image",cssText:Z,cssDisplay:"inline-block",src:C(Y[V].n||Y[V].v),onload:function(){L(this.imgNode,U-Q,R-D);}});}this.addChildren(X);}}},{scriptClass:"mstrmojo.Label",slot:"textNode",alias:"description"},{scriptClass:"mstrmojo.HBox",slot:"statusBarNode",alias:"sb",onitemsChange:function(){var S=this.items,U=[],T,R;if(this.children){this.removeChildren();delete this.numVisibleDots;this.lastSelected=-1;}for(T=0,R=S.length;T<R;T++){U.push({scriptClass:"mstrmojo.Label"});}this.addChildren(U);},lastSelected:0,select:function(R){var U,V,S=this.domNode,T=this.numVisibleDots;if(this.selectedNode){K.removeClass(this.selectedNode.domNode,"selected");}if(this.items.length>0){this.selectedNode=this.children[R];K.addClass(this.selectedNode.domNode,"selected");if(!T){T=this.numVisibleDots=B.floor(P.call(this.parent,"Width")/E);if(this.items.length<T){K.addClass(S,"center");}else{K.removeClass(S,"center");}}U=B.floor(this.lastSelected/this.numVisibleDots);V=B.floor(R/this.numVisibleDots);if(U!==V){O(S,-V*T*E);}this.lastSelected=R;}}}],updateScrollerConfig:function G(){var R=this.viewer.items.length;mstrmojo.hash.copy({scrollEl:this.viewerNode,origin:{x:0,y:0},offset:{x:{start:0,end:((R>0)?(R-1):0)*P.call(this,"Width")}}},this.scrollerConfig);return this._super();},touchSwipeEnd:function N(T){var S=T.delta,R=this.viewer.items.length;if(S&&S.x>0){this.set("selected",Math.max(0,this.selected-1));}else{if(S&&S.x<0){this.set("selected",Math.min(this.selected+1,R));}}},onclick:function(S){var R;if(mstrApp.getScreenDimensions&&this.selectedImage){R={cssClass:"image-FullScreen",onclick:function(){this.close();},resizeDialog:function(){var V=mstrApp.getScreenDimensions(),T=this.domNode,U=T&&T.style;if(V&&U){U.width=V.w+"px";U.height=V.h+"px";}},children:[{scriptClass:"mstrmojo.Image",src:this.selectedImage,onload:function(){var T=mstrApp.getScreenDimensions();if(T){L(this.imgNode,T.w,T.h);this.parent.positionDialog();}}}]};mstrApp.showDialog(R);}},touchTap:function(R){this.onclick(R);},preBuildRendering:function M(){var U=this.getDataParser(),S=I(U),T,R;if(!this.vp){this.vp=this.model.vp;}T=S[0]||[];R=S[1]||[];this.viewer.set("items",T);this.sb.set("items",R);this.selected=-1;if(T.length>0){this.cssClass=this.cssClass?"":this.cssClass.replace(/noImage/,"");this.noImageMsg="";}else{this.cssClass+=this.cssClass?"":" noImage";this.noImageMsg="No Photo Found";}if(this.vp&&this.vp.bgc){this.cssText="background-color:#"+this.vp.bgc+";";}this._super();},postBuildRendering:function A(){this._super();this.set("selected",0);},onselectedChange:function F(){var R=this.selected,T=this.sb,S=this.viewer.items[R],U=T.items[R];if(S){this._scroller.scrollTo(R*P.call(this,"Width"),0,500);this.selectedImage=C((S&&S.n)||"");T.select(R);this.description.set("text",(U&&U.n)||"");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.hash","mstrmojo.GeoLocation","mstrmojo._TouchGestures");var R="\u001F",J="\u001E",F="\u001D",W="\u001C",X="\u001B";function O(Z,Y){if(!!Z&&!!Z.imgNode){var a=Z.imgNode.style;a.opacity=Y;}}var D=mstrmojo.Image.baseCssClass+"-prv";mstrmojo.maps.androidmap.AndroidMap=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.maps.androidmap.AndroidMap",cssClass:"mstr-googleMapView",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@domNodeCssText}" mstrAttach:touchstart></div>',reRenderOnDimensionChg:false,mapRendered:false,firstScreen:true,children:[{scriptClass:"mstrmojo.Image",alias:"imgPreview",cssClass:"prv",cssText:"position:absolute;left:0;top:0;",firstLoad:false,onload:function(){O(this,1);var Y=this;window.setTimeout(function(){Y.parent.postImageProcessing(Y.firstLoad);Y.firstLoad=false;},300);}}],markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onheightChange:function(){this.domNode.style.height=this.getHeight()+"px";},onwidthChange:function(){this.domNode.style.width=this.getWidth()+"px";}},setModel:function K(Y){this.set("model",Y);this.xtabModel=Y;if(Y.data){this.set("gridData",Y.data);}},postImageProcessing:function V(Y){if(Y&&this.controller&&this.controller.takeScreenShot){this.controller.takeScreenShot();}if(this.imgPreview.src!=""&&mstrMobileApp&&mstrMobileApp.hideMapView){window.setTimeout(function(){mstrMobileApp.hideMapView(0);},100);}},ongridDataChange:function(){this.parser=new mstrmojo.Vis.DataParser(this.gridData);delete this.dataMap;},update:function G(a){a=a||this.node;if(a){if(a.data){this.set("gridData",a.data);var Z=this.gridData;if(Z.layoutModel){this.layoutModel=Z.layoutModel;}if(Z.layoutNode){this.layoutNode=Z.layoutNode;}delete Z.layoutModel;delete Z.layoutNode;}var Y=a.defn.fmts||a.defn.units[this.xtabModel.k].fmts;this.width=parseInt(Y.width,10);this.height=parseInt(Y.height,10);this.top=parseInt(Y.top,10);this.left=parseInt(Y.left,10);this.fmts=Y;}if(this.xtabModel){this.initFromVisProps(this.gridData.vp);}this.updated=true;},getMapModel:function(){var Y=mstrApp.getCurrentProjectId(),Z=mstrApp.serverProxy.getSessions();return{pid:Y,sessions:Z,mapId:this.id,hasTarget:false,hostUrl:mstrApp.getConfiguration().getHostUrlByProject(Y)};},getGridModel:function(){var Y=mstrmojo.hash.copy(this.gridData,{});return Y;},initFromVisProps:function S(Y){this.vp=Y;},dispatchMapData:function C(){var Y=this.getMapModel(),Z=this.simplifyGridData();mstrMobileApp.loadMap(JSON.stringify(mstrmojo.hash.copy(Y,{gdProp:Z.prop,infoWindow:{dft:true}})),Z.es,Z.data,"");this.mapRendered=true;},simplifyGridData:function H(){if(this.dataMap){return this.dataMap;}var z=this.gridData,AA=[],p=[],Y={row:[],col:[]},g,b,a,x=[],AB=[],l=[],h=[],d=[],Z,f,k,t,q,s,w;if(typeof (z.ghs)=="undefined"||(z.gts.row.length==0)){z.eg="no data returned";}if(z.eg){this.dataMap={prop:{},data:"",es:""};}else{for(t=0,f=z.ghs.rhs.items,q=f.length;t<q;t++){for(s=0,k=f[t].items,w=k.length;s<w;s++){h.push(k[s].idx);}AA.push(h.join(F));h=[];}for(t=0,f=z.gvs.items,q=f.length;t<q;t++){for(s=0,k=f[t].items,w=k.length;s<w;s++){d.push(k[s].v);d.push(k[s].rv||0);if(k[s].ti!==undefined||k[s].ts!==undefined){v="";if(k[s].ti!==undefined){z.th[k[s].ti].ty=k[s].ty;v=k[s].ti;}v+=X;if(k[s].ts!==undefined){v+=k[s].ts;}d.push(v);}h.push(d.join(W));d=[];}p.push(h.join(F));h=[];}b=z.gts.row;mstrmojo.array.forEach(b,function(j){g={};mstrmojo.hash.copyProps(["n","id","fid","fs","sc"],j,g);Y.row.push(g);h=[];mstrmojo.array.forEach(j.es,function(o){h.push(o.n);});AB.push(h.join(W));});x.push(AB.join(J));a=z.gts.col;mstrmojo.array.forEach(a,function(j){g={};mstrmojo.hash.copyProps(["n","id","fid"],j,g);Y.col.push(g);h=[];mstrmojo.array.forEach(j.es,function(o){h.push(o.n);});l.push(h.join(W));});x.push(l.join(J));this.dataMap={prop:{vp:z.vp,th:z.th,gts:Y},es:x.join(R),data:AA.join(J)+R+p.join(J)};}return this.dataMap;},getModel:function L(){return this.gridData;},handleMarkerSelection:mstrmojo.emptyFn,postBuildRendering:function Q(){this.dispatchMapData();this._super();},rebuildLayout:mstrmojo.emptyFn,resetLayout:mstrmojo.emptyFn,setDimensions:function N(b,a){var d=this.googleMap,Y=d?d.getCenter():null,Z=this._super(b,a);if(d){this.map.style.height=this.getHeight()+"px";this.map.style.width=(this.getWidth()-1)+"px";d.setCenter(Y);}return Z;},unrender:function P(){this.imgPreview.src="";if(this.mapRendered){this.removeMap();this.mapRendered=false;}this._super();},removeMap:function U(){mstrMobileApp.hideMapView("1");},switchToImage:function B(b,a,Z){var Y=this.imgPreview;Y.firstLoad=this.firstScreen;this.firstScreen=false;if(b&&Y.hasRendered){if(Y.src!==b){O(Y,0);Y.domNode.className=D;Y.set("src",b);Y.set("width",a);Y.set("heihgt",Z);}else{if(mstrMobileApp&&mstrMobileApp.hideMapView){O(this.imgPreview,1);this.postImageProcessing(false);}}}else{mstrMobileApp.hideMapView(0);}},hidePreview:function M(){O(this.imgPreview,0);},showPreview:function A(){O(this.imgPreview,1);},closeInfoWindow:function E(){do{mstrApp.closeDialog();}while(mstrmojo.all.mstrMapInfoWindow);},ontouchstart:function I(){if(this.mapRendered){mstrMobileApp.showMapView(0);}},destroy:function T(){var Y=this.parent;while(Y){if(Y._scroller&&Y.scrollMoveListener){}Y=Y.parent;}this._super();if(this.mapRendered){mstrMobileApp.navigateAway();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.array","mstrmojo.hash","mstrmojo.android.EnumMenuOptions","mstrmojo.GeoLocation","mstrmojo._TouchGestures","mstrmojo.android.DropDownList","mstrmojo.Label");mstrmojo.requiresDescs(7736,8068,8069,8102,8395,8954);var T=mstrmojo.array,O=mstrmojo.android.EnumMenuOptions,C=O.REPROMPT,E=1000;function L(a,b,X,Z,Y){this.title=a;this._latlng=b;this._rad=X;this._ix=Z;this._color=Y;}function I(){L.prototype=new google.maps.OverlayView();L.prototype.draw=function(){var g=this.div_;if(!g){g=this.div_=document.createElement("DIV");var b=g.style,Z=this._rad,a=Z/2,Y=a+"px "+a+"px",d=this.getPanes(),f=this;b.position="absolute";b.paddingLeft="0px";b.cursor="pointer";b.backgroundColor=this._color;b.opacity=".65";b.borderRadius=Y;b.height=b.width=Z+"px";b.border="2px solid black";google.maps.event.addDomListener(g,"click",function(h){google.maps.event.trigger(f,"click");});d.overlayMouseTarget.appendChild(g);}var X=this.getProjection().fromLatLngToDivPixel(this._latlng);if(X){g.style.left=(X.x-this._rad/2)+"px";g.style.top=(X.y-this._rad/2)+"px";}};L.prototype.remove=function(){var X=this.div_;if(X){X.parentNode.removeChild(X);this.div_=null;}};L.prototype.getPosition=function(){return this._latlng;};}var D=function D(a){var b;if(a.length>0){b=new google.maps.LatLngBounds();for(var Y in a){var X=a[Y],Z=X.getPosition();b.extend(Z);}}return b;};function S(Y,X){return X.replace(/POINT[ ]?\(|\)/g,"").split(" ")[Y=="lat"?1:0];}function G(){return this._mapTypeToGoogleMapTypeId[this.mapType];}mstrmojo.maps.jsmap.AndroidMap=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.maps.jsmap.AndroidMap",cssClass:"mstr-googleMapView",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@domNodeCssText}"><div></div><div class="androidMap-metricSelector"><span class="androidMap-toggleHeader"></span></div><div class="mstr-googleMap" id="map_canvas_{@id}"></div></div>',reRenderOnDimensionChg:false,noMapsMsg:mstrmojo.desc(8954,"Google Maps have not been configured for this device. Please check with your mobile administrator to enable Google Maps in the mobile configuration."),selMetricIx:0,markerArr:[],googleMap:null,bubblesMaxInfo:[],maxBubbleSize:50,minBubbleSize:20,markupSlots:{msg:function(){return this.domNode.childNodes[0];},metricSelector:function(){return this.domNode.childNodes[1];},map:function(){return this.domNode.childNodes[2];}},markupMethods:{onheightChange:function(){this.domNode.style.height=this.getHeight()+"px";},onwidthChange:function(){this.domNode.style.width=this.getWidth()+"px";}},layoutConfig:{h:{metricSelector:"32px",map:"100%"},w:{metricSelector:"200px",map:"100%"}},children:[{scriptClass:"mstrmojo.android.DropDownList",slot:"metricSelector",options:null,onidxChange:function(X){this._super(X);this.parent.onselMetricIxChange(X);this.set("value",this.options[X.value].v);},visible:false,alias:"metricSel"},{scriptClass:"mstrmojo.Box",slot:"map"},{scriptClass:"mstrmojo.Label",cssClass:"androidMap-errorMsg",visible:true,alias:"errorMsg",slot:"msg"}],setModel:function N(X){this.set("model",X);this.xtabModel=X;if(X.data){this.set("gridData",X.data);}},ongridDataChange:function(){this.parser=new mstrmojo.Vis.DataParser(this.gridData);},update:function F(Z){Z=Z||this.node;if(Z){if(Z.data){this.set("gridData",Z.data);var Y=this.gridData;if(Y.layoutModel){this.layoutModel=Y.layoutModel;}if(Y.layoutNode){this.layoutNode=Y.layoutNode;}}var X=Z.defn.fmts||Z.defn.units[this.xtabModel.k].fmts;this.width=parseInt(X.width,10);this.height=parseInt(X.height,10);this.top=parseInt(X.top,10);this.left=parseInt(X.left,10);this.fmts=X;}if(this.xtabModel){this.initFromVisProps(this.gridData.vp);}this.updated=true;},getMapModel:function(){return this.xtabModel;},initFromVisProps:function U(X){if(!X){return ;}if(X.dv){this.mapType=parseInt(X.dv,10);}this.usePt=(X.gr=="1");this.useAttributes=(X.af==="0");this.geoAttr=X.ga;this.markerType=X.mtp;this.attrThresholds=X.at;this.flong=X.flong;this.flat=X.flat;this.fpt=X.fpt;this.mstyl=X.mstyl;this.maxBubbleSize=X.mbs||50;},showErrorMsg:function K(X,Y){this.errorMsg.set("text",Y);this.metricSelector.style.display=X?"none":"block";this.map.style.display=X?"none":"block";this.msg.style.display=X?"block":"none";},postBuildRendering:function R(){console.log("JSMAP:androiMap:postBuildRendering");this._super();if(typeof this.gridData.eg!=="undefined"){this.showErrorMsg(true,this.gridData.eg);}else{if(typeof google==="undefined"||(google&&typeof google.maps==="undefined")){this.showErrorMsg(true,this.noMapsMsg);}else{this.showErrorMsg(false);var Y=this.children[0];Y.idx=0;Y.unset=true;Y.options=[{v:"-1",n:""}];if((typeof google!=="undefined"&&google.maps)){if(!mstrApp.isInfoWindow){this.markerArr=[];this.bubblesMaxInfo=[];}this._mapTypeToGoogleMapTypeId=[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.TERRAIN];I();if(this.gridData){var Z=this.buildMetricSelector(),X=Z?parseInt(this.layoutConfig.h.metricSelector,10):0;this.metricSel.set("visible",Z);this.map.style.height=this.getHeight()+"px";this.map.style.width=(this.getWidth()-1)+"px";this.metricSelector.style.height=X+"px";this.metricSelector.style.display=Z?"block":"none";this.initMap();if(this.map.firstChild){this.map.firstChild.style.zIndex=1;}}}}}},gup:function H(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var Z="[\\?&]"+a+"=([^&#]*)",Y=new RegExp(Z),X=Y.exec(window.location.href);return X==null?"":X[1];},onselMetricIxChange:function(X){var a=function(f,b){for(var d in b){if(b[d].setMap){b[d].setMap(f);}}};if(this.openedInfoWindow){this.openedInfoWindow.close();}var Y=this.getMarkers(X.value),Z=this.getMarkers(X.valueWas);this.selMetricIx=X.value;a(null,Z);a(this.googleMap,Y);},buildMetricSelector:function J(){var a=this.gridData.gts.col,d=false;if(a.length>0){var b=a[0].es;if(b.length>1){var Z=[],Y=-1;T.forEach(b,function(g,f){Z[++Y]={n:g.n,v:Y,id:g.id};});var X=this.children[0];X.set("options",Z);X.set("value",0);d=true;}}return d;},initMap:function(){var Y,h=google.maps,Z=h.event,a=G.call(this)||h.MapTypeId.ROADMAP,b={mapTypeControl:true,mapTypeControlOptions:{position:h.ControlPosition.TOP_LEFT,style:h.MapTypeControlStyle.HORIZONTAL_BAR},streetViewControl:false,mapTypeId:a,navigationControlOptions:{position:h.ControlPosition.RIGHT_BOTTOM,style:h.NavigationControlStyle.ANDROID},zoomControlOptions:{style:h.ZoomControlStyle.LARGE},tilt:0};this.googleMap=Y=new h.Map(this.map,b);this.selMetricIx=this.selMetricIx;var f=this.getMarkers(this.selMetricIx);if(f.length>0){var j=this.mapBounds;if(j){Y.fitBounds(j);Y.setCenter(j.getCenter());}}else{var g=new h.LatLng(38.893444,77.221648);Y.setCenter(g);}var d=30,l=0,k=Y.getZoom(),X=setInterval(function(){k=Y.getZoom();l+=d;if(k!==undefined){if(k>20){Y.setZoom(15);}else{if(k<2){Y.setZoom(2);}}clearTimeout(X);}else{if(l>10*d){clearTimeout(X);Y.setZoom(2);}}},d);},getMarkers:function B(AZ){if(!!this.markerArr[AZ]){return this.markerArr[AZ];}var AE=this.googleMap,AV=this.gridData,o=AV.vp,X=AV.gts,q=X.row,h=this.usePt,AY=(h?1:2),g=this.useAttributes,j=this.geoAttr,z,Y,l,x=-1,AA=-1,AI=-1,k=[],t=null;for(var AO=0,AG=q.length,AP=0;AO<AG;++AO){var AT=q[AO],AB=AT.id;if(h){if(AB==this.fpt){z=Y=AT;x=AA=AP;}}else{if(AB==this.flong){z=AT;x=AP;}else{if(AB==this.flat){Y=AT;AA=AP;}}}for(var AU=0,AF=AT.fs.length;AU<AF;++AU){var AX=AT.fs[AU],AR=AX.id;if(h){if(AR==this.fpt){z=Y=AT;x=AA=AP+AU;}}else{if(AR==this.flong){z=AT;x=AP+AU;}else{if(AR==this.flat){Y=AT;AA=AP+AU;}}}if(AI<0){l=AT;AI=AP+AU;}}AP+=AF;}if(Math.min(x,AA,AI)<0){throw new Error(mstrmojo.desc(8395,"Not enough data to display map."));}var AJ=AV.ghs.rhs.items,Z=Math.min(AJ.length,E),AN=-90,w=90,AQ=-180,AC=180;for(var AS=0;AS<Z;AS++){var AM=AJ[AS].items;if(AM.length<AY){continue;}var AL=z.es[AM[x].idx].n,a=parseFloat(h?S("long",AL):AL),AH=parseFloat(h?S("lat",AL):Y.es[AM[AA].idx].n),s=l.es[AM[AI].idx].n,AW,AD=AV.gvs.items[AS];if(isNaN(AH)||isNaN(a)){continue;}w=(AH<w)?AH:w;AN=(AH>AN)?AH:AN;AC=(a<AC)?a:AC;AQ=(a>AQ)?a:AQ;latLng=new google.maps.LatLng(AH,a);if(this.markerType=="2"){AW=this.getMetricBubble(AV.gvs.items[AS],s,latLng,AS,AZ);}else{t="../"+this.mstyl;var b=AV.gvs.items[AS];if(b){var AK=b.items;if(AK){var p=AK[AZ];if(p&&(p.ts==4)&&(this.attrThresholds=="1")){t=this.getImage(p.v);}}}AW=new google.maps.Marker({position:latLng,title:s,_ix:AS,icon:t,zIndex:AS});}AW.eid=l.es[AM[AI].idx].id;AW.attrid=l.id;AW.setMap(AE);google.maps.event.addListener(AW,"click",function(f,d){return function(){f.handleMarkerClick(AE,d);};}(this,AW));k[k.length]=AW;}this.mapBounds=new google.maps.LatLngBounds(new google.maps.LatLng(w,AC),new google.maps.LatLng(AN,AQ));this.markerArr[AZ]=k;return k;},handleMarkerClick:function(Y,X){if(this.openedInfoWindow){this.openedInfoWindow.close();this.openedInfoWindow=null;}this.openInfoWindow(Y,X);this.postHandleMarkerClick(Y,X);},postHandleMarkerClick:mstrmojo.emptyFn,getImage:function A(Y){var Z=mstrApp,X=Z.getConfiguration();if(X&&Y&&Y.indexOf("://")===-1){Y=X.getHostUrlByProject(Z.getCurrentProjectId())+Y;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(Y)):Y;},getMetricBubble:function W(f,l,Y,j,b){var k=this.gridData,Z=k.gvs.items,s=this.bubblesMaxInfo[b],q=parseFloat(f.items[b].rv),a="red",X=Math.abs(this.maxBubbleSize-this.minBubbleSize);if(!s){for(var h in Z){var p=Z[h].items[b],o=parseFloat(p.rv)||0;if(!s){s=o;}s=Math.max(s,o);}this.bubblesMaxInfo[b]=s;}if(this.attrThresholds=="1"&&(typeof f.items[b].ty!=="undefined")){var g=f.items[b].ty;if(g==2){a=k.th[f.items[b].ti].n;}else{a="#FFF";}}return new L(l,Y,this.minBubbleSize+Math.round((q/s)*X),j,a);},openInfoWindow:function(a,Z){var Y=Z._ix,X=this.getInfoWindow(a,Z);if(X){this.openedInfoWindow=X;X.open(a,Z);}},getInfoWindow:function(Y,X){return this.getDefaultInfoWindow(this.gridData,X);},getDefaultInfoWindow:function M(g,f){var Y=f._ix,k=[],Z=g.gvs.items,h=document.createElement("div"),j='<table><tbody><tr><td colspan="2" class="androidMap-infoWindowTitle" style="padding-right: 20px">'+f.title+"</td></tr>";if(g.gts.col.length!=0){k=g.gts.col[0].es;}for(var b in k){var l=Z[Y].items[b];if(l.ts==4){var o=l.v;if(o.indexOf("http")!==0){o="../"+o;}j+='<tr><td class="androidMap-infoWindowText">'+k[b].n+'</td><td><img src="'+o+'"></td></tr>';}else{var a="black",X="white";if(g.th&&this.attrThresholds=="1"&&(typeof l.ti!=="undefined")){a=g.th[l.ti].n;}j+='<tr><td class="androidMap-infoWindowText">'+k[b].n+'</td><td style="background-color:'+X+";color:"+a+';">'+l.v+"</td></tr>";}}j+="</tbody></table>";h.innerHTML=j;return new google.maps.InfoWindow({content:h});},touchBegin:function(X){X.stop();return false;},rebuildLayout:mstrmojo.emptyFn,setDimensions:function P(a,Z){var b=this.googleMap,X=b?b.getCenter():null,Y=this._super(a,Z);if(b){this.map.style.height=this.getHeight()+"px";this.map.style.width=(this.getWidth()-1)+"px";b.setCenter(X);}return Y;},unrender:function Q(X){if(this.googleMap){delete this.googleMap;}this._super(X);},destroy:function V(){if(this.googleMap){delete this.googleMap;}this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo._HasTouchScroller");var P="Helvetica",d="bold 14px Helvetica",X="bold 20px Helvetica",O=30,N=1;function E(g){N=g;d="bold "+Math.round(14*N)+"px Helvetica";X="bold "+Math.round(20*N)+"px Helvetica";O=Math.round(30*N);}function a(h){var g=mstrmojo.dom.findAncestorByAttr(h.target,"clk",true,this.domNode);return g||null;}function C(){var g=this._scroller;var h=this.height-this.legendBarSwitcher.height-15*N;var j=this.legendListDiv.offsetHeight;if(j>h){this.scrollPast=true;}var l=j>h?j-h:0;g.origin={x:0,y:0};g.showScrollbars=true;g.noVScroll=false;g.vScroll=(l!==0&&g.noVScroll!==true)||this.scrollPast;if(g.vScroll){g.offset={y:{start:0,end:l},scrollPast:this.scrollPast};}var k=this.legendListDiv;this.utils.translateCSS(0,0,false,k);}mstrmojo.VisTimeSeriesLegend=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisTimeSeriesLegend",scrollerConfig:{bounces:false,showScrollbars:true,useTranslate3d:true},multiTouch:true,scrollPast:false,isAndroidTab:false,legendBarWidth:30,isLegendBarOpen:false,isLegendSelected:false,legendSelectedIndex:-1,maxLegendAttrLength:0,widget:null,y_axis_interval:25,markupString:'<div id="{@id}-legend-bar" style="position:absolute;top:{@top};right:{@right};z-index:{@zIndex};" ><div id="{@id}-legend-switcher" class="mstrmojo-timeseries-legend-switcher" clk="S"><canvas id="{@id}-legend-triangle" width="15px" height="17px" style="position:absolute;" ></canvas><div id="{@id}-legend-shadow" class="timeseries-legend-switcher-shadow" style="height:0px; width:0px;position:absolute"></div></div><div class="mstrmojo-timeseries-legend-List-Div" style="overflow:hidden;"><div id="{@id}-legend-List" ></div></div><canvas style="z-index:-1;" clk="C"></canvas></div>',markupSlots:{legendBarDiv:function(){return this.domNode;},legendBarSwitcher:function(){return this.domNode.firstChild;},triangle:function(){return this.domNode.firstChild.firstChild;},legendListDivContainer:function(){return this.domNode.childNodes[1];},legendListDiv:function(){return this.domNode.childNodes[1].firstChild;},legendCanvas:function(){return this.domNode.childNodes[2];}},switchLegendBar:function T(){this.isLegendBarOpen=!this.isLegendBarOpen;this.calculateAndSetLegendWidth();this.widget.reDrawSlaveChartImpl();this.renderLegend(true);C.call(this);},enableLegendGlowEffect:function Q(j,h){var k=this.legendListDiv.childNodes[j];var g=h||k.style.color;k.style.textShadow=g+"0px 0px 8px";k.style.font=X;},hiddenLegendGlowEffect:function A(g){var h=this.legendListDiv.childNodes[g];h.style.textShadow="none";h.style.font=d;},toggleTriangle:function f(k){var j=this.triangle,p=j.style,h=j.getContext("2d"),o=this.widget;var l=Math.round(17*N),g=Math.round(15*N);j.height=l;j.width=g;p.top=Math.round(7*N)+"px";p.left=Math.round(8*N)+"px";h.save();h.fillStyle=o.utils.rgb2rgbStr(o.formatProp.textClr,0.75);h.beginPath();if(k){h.moveTo(0,0);h.lineTo(g,l/2);h.lineTo(0,l);h.lineTo(0,0);}else{h.moveTo(0,l/2);h.lineTo(g,0);h.lineTo(g,l);h.lineTo(0,l/2);}h.closePath();h.fill();h.restore();},renderLegend:function G(z){var w=this.model,AF=w.series,p=AF&&AF.length||0,t=this.height,AE=this.utils,j=w.colHeaders,k=this.legendCanvas.getContext("2d"),AC=this.legendListDiv,l=this.legendBarSwitcher;this.legendBarDiv.style.width=this.legendBarWidth+"px";this.legendBarDiv.style.height=t+"px";AC.style.width=this.legendBarWidth+"px";l.width=this.legendBarWidth;l.height=O;l.style.width=this.legendBarWidth+"px";this.legendCanvas.width=this.legendBarWidth;this.legendCanvas.height=t;if(this.isLegendSelected&&this.legendSelectedIndex>=p){this.legendSelectedIndex=0;this.widget.setLegendSelected(this.isLegendSelected,this.legendSelectedIndex);}if(AC.childNodes.length==0){for(var q=0;q<p;q++){var o=document.createElement("div");o.id="legendAttr"+q;o.style.font=d;o.className="timeseries-legendAttr";o.innerHTML=this.widget.getLegendName(j,AF,q);o.setAttribute("clk","LA");o.setAttribute("vIndex",q);o.style.color=this.widget.getSerieColor(q);AC.appendChild(o);AE.changeElementSize(o,"height",AE.getScreenZoomFactor());}this.y_axis_interval=Math.max(o.offsetHeight,25);}if(this.isLegendBarOpen){this.toggleTriangle(true);AC.style.display="block";this.legendListDivContainer.style.height=(t-l.height-15*N)+"px";this.legendListDivContainer.style.weight=this.legendBarWidth+"px";this._scroller.updateScrollBars();this.utils.translateCSS(0,l.height,false,this.legendListDivContainer);if(this.isLegendSelected){this.enableLegendGlowEffect(this.legendSelectedIndex);}this.legendCanvas.height=t;this.legendCanvas.style.position="absolute";this.legendCanvas.style.top="0px";this.legendCanvas.style.left="0px";this.drawLegendOutline(t,l.height,k);}else{this.toggleTriangle(false);AC.style.display="none";this.legendCanvas.height=t;this.legendCanvas.style.position="absolute";this.legendCanvas.style.top="0px";this.legendCanvas.style.left="0px";this.drawLegendOutline(t,l.height,k);k.save();var AD=this.legendBarWidth/2;var AB=this.y_axis_interval/2;var g=Math.round(5*N);for(var q=0;q<p&&AB+this.y_axis_interval<t-15*N;q++){k.fillStyle=this.widget.getSerieColor(q);AB+=this.y_axis_interval;AE.drawArc(this,AD,AB,g,0,Math.PI*2,true,true,k);}k.restore();}var AA=this.legendBarSwitcher.lastChild;if(z){AA.className="timeseries-legend-switcher-shadow";AA.style.left=Math.round(15*N)+"px";AA.style.top=Math.round(15*N)+"px";AA.style.display="";AA.style.visibility="visible";}else{AA.className="";AA.style.visibility="hidden";}},reRender:function K(){this.calculateAndSetLegendWidth();this.height=this.calculateHeight();this.renderLegend(false);this.legendBarDiv.style.top=this.widget.margin.t+"px";C.call(this);},hiddenSwitcherArrowGlowEffect:function I(){var g=this.legendBarSwitcher.lastChild;g.innerHTML="";g.style.visibility="hidden";},drawLegendOutline:function D(g,o,j){var s=this.utils,q=this.widget.formatProp;j.save();j.globalAlpha=1;j.strokeStyle=s.rgb2rgbStr(q.textClr,0.5)||"#58595B";j.lineWidth=2;s.drawHalfRoundedRectangle(this,1,1,this.legendBarWidth,g-2,Math.round(15*N),false,j);var p=j.createLinearGradient(0,0,this.legendBarWidth-2,0);var h=s.rgb2rgbStr(q.textClr,0.5)||"#58595B";var l=s.rgb2rgbStr(q.textClr,0.13)||"#222222";p.addColorStop(0,h);p.addColorStop(1,l);j.strokeStyle=p;j.lineWidth=1;var k=o-0.5;s.drawLineSet(this,[{x:2,y:k},{x:this.legendBarWidth,y:k}],false,j);j.restore();},calculateMaxLegendAttrLength:function M(q){var o=this.model,t=o.series,j=t.length,g=o.colHeaders;for(var l=0;l<j;l++){var h=0;var p=this.widget.getLegendName(g,t,l);var k=q?X:d;h=this.widget.getTextWidth(p,k);this.maxLegendAttrLength=Math.max(this.maxLegendAttrLength,h);}this.maxLegendAttrLength=this.maxLegendAttrLength+10;},calculateAndSetLegendWidth:function W(){if(this.isLegendBarOpen){var g=(this.widget.getWidth()-50)*0.3+20;this.legendBarWidth=Math.min(g,this.maxLegendAttrLength);}else{this.legendBarWidth=Math.round(40*N);}this.widget.setlegendStatus(this.isLegendBarOpen,this.legendBarWidth);},calculateHeight:function F(){var g=this.widget.margin;return this.widget.getHeight()-this.widget.masterChartHeight-g.t-g.b;},postBuildRendering:function J(){E(this.utils.getScreenZoomFactor());this.height=this.calculateHeight();var g=this.model.series&&this.model.series.length;if(g==1){this.isLegendSelected=true;this.legendSelectedIndex=0;this.widget.setLegendSelected(this.isLegendSelected,this.legendSelectedIndex);}this.calculateMaxLegendAttrLength(g==1);this.calculateAndSetLegendWidth();this.scrollerConfig.scrollEl=this.legendListDiv;if(this._super){this._super();}this.renderLegend(false);C.call(this);},initScroller:function V(g){g.vScroll=true;this._super(g);},touchBegin:function U(j){this.widget.hiddenTooltipAndShowTimeSelector();var g=a.call(this,j);if(g){var h=g.value;if(h==="S"){this.switchLegendBar();}else{if(!this.isLegendBarOpen&&h==="C"){this.switchLegendBar();}}}},touchTap:function Z(k){var h=a.call(this,k);if(h){var j=h.value;if(j==="LA"){var g=mstrmojo.dom.findAncestorByAttr(k.target,"vIndex",true,this.domNode);if(g){this.handleLegendItemTap(parseInt(g.value,10));}}}},touchEnd:function H(h){var g=this;g.hiddenSwitcherArrowGlowEffect();},touchSelectBegin:function B(p){var h=a.call(this,p);if(h){var j=h.value;if(j==="LA"){var g=mstrmojo.dom.findAncestorByAttr(p.target,"vIndex",true,this.domNode);if(g){var l=(g.value==this.legendSelectedIndex)?X:d;var k=this.widget.getTextWidth(h.node.innerHTML,l);if(k>this.legendBarWidth-12){var o=h.node.offsetTop-this._scroller.origin.y+this.widget.margin.t+this.legendBarSwitcher.height-5;this.widget.showLegendTooltip(h.node);}}}}},touchSelectEnd:function S(g){this.widget.hiddenLegendTooltip();},touchMultiBegin:function R(g){this.touchSelectEnd(g);},onCrossWidgetMultitouch:function Y(){this.widget.hiddenLegendTooltip();this.hiddenSwitcherArrowGlowEffect();},handleLegendItemTap:function L(g){if(this.model.series.length==1){return ;}if(this.isLegendSelected){if(this.legendSelectedIndex===g){this.isLegendSelected=false;this.hiddenLegendGlowEffect(g);this.legendSelectedIndex=-1;}else{this.hiddenLegendGlowEffect(this.legendSelectedIndex);this.legendSelectedIndex=g;this.enableLegendGlowEffect(g);}}else{this.isLegendSelected=true;this.legendSelectedIndex=g;this.enableLegendGlowEffect(g);}this.widget.setLegendSelected(this.isLegendSelected,this.legendSelectedIndex);this.widget.reDrawSlaveChart();},destroy:function b(){if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.url","mstrmojo.Vis","mstrmojo._CanSupportTransaction");mstrmojo.PhotoUploader=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._CanSupportTransaction,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.PhotoUploader",photoNum:0,markupString:'<div id="{@id}" class="mstrmojo-PhotoUploader" style="left:{@left};top:{@top};width:{@width};height:{@height}" mstrAttach:click><div class="actionButton" style="line-height:{@height}">{@n}</div><img class="preview"></img><div class="numberBadge"><div class="badgeText"></div></div></div>',markupSlots:{buttonNode:function(){return this.domNode.firstChild;},previewNode:function(){return this.domNode.childNodes[1];},badgeNode:function(){return this.domNode.lastChild;},badgeTextNode:function(){return this.domNode.lastChild.firstChild;}},markupMethods:{onphotoNumChange:function(){mstrmojo.css.toggleClass(this.domNode,"empty",this.photoNum==0);if(this.photoNum>0){this.badgeTextNode.innerHTML=this.photoNum;}}},preBuildRendering:function(){this._super();var E=this.getDataParser(),J=E.getRowTitles(),C=E.getColTitles(),F,I,H,G,D,B;if(J.size()<3&&C.size()<1){mstrmojo.alert("Incorrect grid template structure!");return false;}else{if(E.getTotalRows()<10){mstrmojo.alert("At least 10 rows required!");return false;}}F=E.getRowHeaders(0);I=J.getTitle(0);H=J.getTitle(1);D=I.getUnitId();B=H.getUnitId();G=C.getTitle(0).getHeaderValues()[0];this.cellInfo=[{atid:D,form_id:I.getFormId(),ui:0},{atid:B,form_id:H.getFormId(),ui:(D==B)?0:1},{metric_id:G.oid}];this.photoNum=0;this.n=mstrmojo.desc(8470);},setModel:function(B){this.model=this.txModel=B&&B.docModel;},getKeyContext:function(B){return{o:parseInt(B,10)};},getUpdateObject:function(D){var B=this.getUpdatedValues(),H=2,I=[],J=this.cellInfo;for(var D in B){var E=B[D],C=mstrmojo.string.encodeXMLAttribute(String(E.v[0])),G=mstrmojo.string.encodeXMLAttribute(String(E.v[1])),F="1";I.push({rowOrdinal:E.o,attId:J[0].atid,formId:J[0].form_id,unitIndex:J[0].ui,newValue:C},{rowOrdinal:E.o,attId:J[1].atid,formId:J[1].form_id,unitIndex:J[1].ui,newValue:G},{rowOrdinal:E.o,colOrdinal:0,newValue:F});}return{manipulation:H,nodeKey:this.k,sliceId:this.sid,cells:I,autoRefresh:false};},getUpdates:function A(){var D=[],L=this,E,K=false,C=this.getUpdatedValues(),I,J=1,G=2,B=9,H=1,M=this.cellInfo;D.push('<gr rw_tree_type="'+this.defn.tt+'" rw_node_key="'+L.k+'" slice_id="'+(L.sid||0)+'">');for(E in C){if(C.hasOwnProperty(E)){I=C[E];for(var F=0;F<2;F++){D.push('<cli ax="1" attribute_id="'+M[F].atid+'" form_id="'+M[F].form_id+'"><updt types="'+J+'" ordinal="'+I.o+'" value="'+I.v[F]+'" dt="'+B+'"/></cli>');}D.push('<cli cordinal="0" metric_id="'+M[2].metric_id+'"><updt types="'+G+'" rordinal="'+I.o+'" value="1" dt="'+H+'"/></cli>');K=true;}}D.push("</gr>");if(!K){D=[];}return D.join("");},photoUploaded:function(B,E){mstrMobileApp.setWaitScreenVisibility(false);var C=mstrmojo.url.getAbsoluteURL(B,mstrApp.getConfiguration().getCurrentProjectWebServerUrl()),F=E,D=this.photoNum;this.previewNode.src=C;this.dataChanged(D,{},{v:[C,F]});this.set("photoNum",D+1);},touchTap:function(){this.onclick();},onclick:function(){if(this.photoNum==10){mstrmojo.alert("can upload at most 10 photos");}else{var B={serverUrl:mstrApp.getConfiguration().getTaskUrlByProject(mstrApp.getCurrentProjectId()),sessionState:mstrApp.getSessionState(),descs:{ADD_PHOTO:mstrmojo.desc(8470),TAKE_NEW_PHOTO:mstrmojo.desc(8471),CHOOSE_FROM_GALLERY:mstrmojo.desc(8472),DONE:mstrmojo.desc(8473),CANCEL:mstrmojo.desc(221)}};mstrMobileApp.uploadPhotos(JSON.stringify(B),'mstrmojo.all["'+this.id+'"].photoUploaded');}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis");var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;mstrmojo.VisMicroChartBullet=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.VisMicroChartBullet",isDrawAxis:false,margin:{t:0,r:5,b:0,l:5},showHighlightLine:false,themeColor:"#FFFFFF",noBackground:true,isAnimateLines:false,toolTipMain:null,mainWidth:0,mainLeftPos:0,showMinLabel:false,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};position:relative;"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@height}"></canvas><div style="position:absolute;left:0px;bottom:0px;display:none;font:7px Arial;text-align:left;line-height:7px;"></div><div style="width:100%;height:{@height};top:0px;left:0px;position:absolute;display:none;font:10pt Arial;overflow: hidden; text-overflow: ellipsis; white-space:nowrap"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},minLabel:function(){return this.domNode.childNodes[1];},errorMsg:function(){return this.domNode.childNodes[2];}},postBuildRendering:function postBR(){if(this._super){this._super();}this.browserSupportsHtml5=this.canvas.getContext;if(!this.browserSupportsHtml5){this.renderErrorMessage(mstrmojo.desc(8126,"Your browser does not support HTML5"));return ;}if(!this.model){this.renderErrorMessage(mstrmojo.desc(8426,"No model provided"));return ;}if(this.model.err||this.model.eg){this.renderErrorMessage(this.model.err||this.model.eg);return ;}this.context=this.canvas.getContext("2d");this.setColorByTheme();this.drawChart();},setColorByTheme:function setColorByTheme(){var bulletProps=this.config;var dpi=mstrMobileApp&&mstrMobileApp.getDeviceDPI()||160;if(this.theme==DEFAULT_DARK_THEME){this.bandColor1="#494949";this.bandColor2="#595959";this.bandColor3="#727272";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=dpi>=160?2:1;this.blueBarPosColor="#00BDFF";this.blueBarNegColor=bulletProps.mwNegCol;}else{if(this.theme==DEFAULT_LIGHT_THEME){this.bandColor1="#A5A5A5";this.bandColor2="#B3B3B3";this.bandColor3="#C4C4C4";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=dpi>=160?2:1;this.blueBarPosColor="#00BDFF";this.blueBarNegColor=bulletProps.mwNegCol;}else{this.bandColor1=bulletProps.mwBand1||"#999999";this.bandColor2=bulletProps.mwBand2||"#BBBBBB";this.bandColor3=bulletProps.mwBand3||"#DEDEDE";this.refLinePosColor=bulletProps.mwRefLineCol;this.refLineNegColor=bulletProps.mwRefLineCol;this.blueBarPosColor=bulletProps.mwPosCol;this.blueBarNegColor=bulletProps.mwNegCol;}}},showTooltip:function shwttp(touchX,touchY){if(!this.config.mbShowTooltip){return false;}var minValue=this.config.mfMinValue;var refV=this.refv;var mc3=refV[2].rv-minValue;var mc4=refV[3].rv-minValue;var ttp=this.toolTipMain;var model=this.model;var metrics=model.mtrcs.items;var bulletProps=this.config;var ofht=17;var line1;if(
/*this.widget.isKPI &&*/
this.widget.bulletProps.mstrAssMetric){line1=this.widget.bulletProps.mstrAssMetric+": "+refV[2].v;}else{line1=metrics[2]+": "+refV[2].v;}var maxWidth=this.widget.getTextWidthByCanvas(line1,ttp);if(bulletProps.mbRefLine){line1='<div style="margin-left:5px;margin-top:5px;"><div style="float:left;margin-right:5px;margin-top:2px;width:12px;height:10px;background-color:'+this.targetColor+';"></div><div style="float:left;text-align:top;">'+line1+"</div></div>";}else{line1='<div style="margin-left:5px;margin-top:5px;margin-bottom:5px;"><div style="float:left;margin-right:5px;margin-top:2px;width:12px;height:10px;background-color:'+this.targetColor+';"></div><div style="float:left;text-align:top;">'+line1+"</div></div>";}if(bulletProps.mbRefLine){ofht+=17;var line2=metrics[6]+": "+refV[6].v;var line2Width=this.widget.getTextWidthByCanvas(line2,ttp);if(line2Width>maxWidth){maxWidth=line2Width;}line2='<div style="margin-left:5px;margin-bottom:5px;"><div style="float:left;margin-left:5px;margin-top:2px;margin-right:10px;width:2px;height:10px;background-color:'+this.refLineColor+';"></div><div style="float:left;">'+line2+"</div></div>";line1+="<br/>"+line2;}ofht+=10;if(this.tooltipErrMsg){ttp.innerHTML=this.tooltipErrMsg;}else{ttp.innerHTML=line1;}var pos=mstrmojo.dom.position(this.domNode,true);var posWdt=mstrmojo.dom.position(this.widget._leftChart.domNode,true);maxWidth+=28;ttp.style.display="block";ttp.style.borderColor=this.targetColor;ttp.style.width=maxWidth+"px";var tpof=0;if((this.getHeight()-ofht)%2==0){tpof=(pos.y-posWdt.y+(this.getHeight()-ofht)/2);}else{tpof=(pos.y-posWdt.y+(this.getHeight()-ofht-1)/2);}if(tpof<0){tpof=0;}if(tpof+ofht>this.widget.getHeight()){tpof=this.widget.getHeight()-ofht-5;}ttp.style.top=tpof+"px";var ttpLeft=0;if(pos.x+pos.w/2>(posWdt.x+posWdt.w/2)){ttpLeft=pos.x-posWdt.x-maxWidth-10;}else{ttpLeft=pos.x-posWdt.x+pos.w+10;}if(ttpLeft<0){ttpLeft=0;}ttp.style.left=ttpLeft+"px";return true;},drawChart:function drwchrt(){var bulletProps=this.config;var minValue=bulletProps.mfMinValue;var refV=this.refv;var mc3,mc4,mc5,mc6,mc7;var mMc3,mMc4,mMc5,mMc6,mMc7;mMc3=parseFloat(refV[2].rv);mMc4=parseFloat(refV[3].rv);mMc5=parseFloat(refV[4].rv);mMc6=parseFloat(refV[5].rv);mMc7=parseFloat(refV[6].rv);mc3=mMc3-minValue;mc4=mMc4-minValue;mc5=mMc5-minValue;mc6=mMc6-minValue;mc7=mMc7-minValue;var isInverted=bulletProps.mbInvertAxis;var hasRefLine=bulletProps.mbRefLine;var hasRefBands=bulletProps.mbRefBands;var mShowTooltip=bulletProps.mbShowTooltip;var ctx=this.context;var ratioBetweenMetricViewWidth;var bulletHeight;var minLabelHeight=7,minLabelWidth;var xPadding=0,yPadding=5;if(isNaN(mc3)||isNaN(mc4)||isNaN(mc5)||isNaN(mc6)){var err=mstrmojo.desc(10860,"Insufficient data to plot the graph");this.errorMsg.innerHTML=err;this.errorMsg.style.display="block";this.minLabel.style.display="none";this.tooltipErrMsg=err;return ;}else{if(mc3*mc4>0&&Math.abs(mc3)>Math.abs(mc4)){var err=mstrmojo.desc(10381,"Metric of Butllet is out of the max graph range");this.errorMsg.innerHTML=err;this.errorMsg.style.display="block";this.minLabel.style.display="none";this.tooltipErrMsg=err;return ;}else{this.errorMsg.style.display="none";this.tooltipErrMsg=null;}}var xOri;var redComp,greenComp,blueComp;var mcOriX,mcOriY;var mcHeight,mcWidth;if(mc3<0&&mc4>0){ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/(mc4-mc3);xOri=xPadding-mc3*ratioBetweenMetricViewWidth;bulletHeight=this.getHeight()-minLabelHeight-2*yPadding-2;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6>mc3&&mc6<mc4){mcWidth=(mc6-mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor2;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5>mc3&&mc5<mc4){mcWidth=(mc5-mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor1;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=Math.abs(mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7>mc3&&mc7<mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+mc7*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}else{if(mc3<0&&mc4<0){ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/(Math.abs(mc4));xOri=xPadding;bulletHeight=this.getHeight()-minLabelHeight-2*yPadding-2;isInverted=!isInverted;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6<0&&mc6>mc4){mcWidth=Math.abs(mc6)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor2;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5<0&&mc5>mc4){mcWidth=Math.abs(mc5)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor1;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=Math.abs(mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7<0&&mc7>mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+Math.abs(mc7)*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;mcOriX=this.getWidth()-mcOriX-mcWidth;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}else{if(mc3>0&&mc4>0){if(this.showMinLabel){yPadding=9.5;}else{yPadding=5;}ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/mc4;xOri=xPadding;bulletHeight=this.getHeight()-2*yPadding;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6>0&&mc6<mc4){mcWidth=mc6*ratioBetweenMetricViewWidth;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle=this.bandColor2;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5>0&&mc5<mc4){mcWidth=mc5*ratioBetweenMetricViewWidth;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle=this.bandColor1;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=mc3*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7>0&&mc7<mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+mc7*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}else{ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/(mc3-mc4);bulletHeight=this.getHeight()-minLabelHeight-2*yPadding-2;xOri=xPadding-mc4*ratioBetweenMetricViewWidth;isInverted=!isInverted;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6<mc3&&mc6>mc4){mcWidth=(mc3-mc6)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriX=this.getWidth()-mcOriX-mcWidth;ctx.fillStyle=this.bandColor2;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5<mc3&&mc5>mc4){mcWidth=(mc3-mc5)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriX=this.getWidth()-mcOriX-mcWidth;ctx.fillStyle=this.bandColor1;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=Math.abs(mc3)*ratioBetweenMetricViewWidth;mcOriX=xOri;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7<mc3&&mc7>mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+mc7*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}}}if(mc3<0){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri;mcOriY=yPadding;redComp=0;greenComp=0;blueComp=0;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle="#000000";this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);minValue=minValue+"";var disPlayValue=(minValue=="0")?"":"$";var mlen=0;for(var i=0;i<minValue.length;i++){if(minValue[i]=="."){break;}mlen++;}for(var i=0;i<minValue.length;i++){disPlayValue+=minValue[i];mlen--;if(mlen%3==0&&mlen>0){disPlayValue+=",";}}minValue=disPlayValue;var textWidth=this.widget.getTextWidthByCanvas(minValue,this.minLabel);minLabelWidth=textWidth-1;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}if(mcOriX-minLabelWidth/2<=xPadding){this.minLabel.style.paddingLeft=xPadding;}else{if(mcOriX+minLabelWidth/2<=this.getWidth()-xPadding){this.minLabel.style.paddingLeft=Math.round(mcOriX-minLabelWidth/2)+"px";}else{this.minLabel.style.paddingLeft=Math.round((this.getWidth()-xPadding-minLabelWidth))+"px";}}this.minLabel.style.bottom=yPadding+"px";this.minLabel.style.fontSize="7pt";if(this.labelColorRGB){this.minLabel.style.color="rgb("+this.labelColorRGB[0]+","+this.labelColorRGB[1]+","+this.labelColorRGB[2]+")";}else{this.minLabel.style.color="";}this.minLabel.innerHTML=minValue;this.minLabel.style.display="block";}else{this.minLabel.style.display="none";}},convertColor:function convrtClr(ngv){var ret="#";var base=parseInt("0xff");var blueComp=ngv&base;base=parseInt("0xff00");var greenComp=((ngv&base)>>8);base=parseInt("0xff0000");var redComp=((ngv&base)>>16);var redP=redComp.toString(16);if(redP.length<2){redP="0"+redP;}var greenP=greenComp.toString(16);if(greenP.length<2){greenP="0"+greenP;}var blueP=blueComp.toString(16);if(blueP.length<2){blueP="0"+blueP;}ret+=redP;ret+=greenP;ret+=blueP;return ret;},drawRect:function(ctx,x,y,width,height){x=Math.round(x);y=Math.round(y);width=Math.round(width);height=Math.round(height);ctx.fillRect(x,y,width,height);},reDrawChart:function reDrwchart(){var context=this.context,canvas=this.canvas,wd=canvas.width,ht=canvas.height;context.clearRect(0,0,wd,ht);this.postBuildRendering();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.dom","mstrmojo.VisHeatMapColorTheme","mstrmojo.VisHeatMapPopup","mstrmojo.VisHeatMapTree","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.num","mstrmojo._HasWaitIcon","mstrmojo.EnumReadystate","mstrmojo.css","mstrmojo.VisHeatMapCanvas");var $READYSTATE=mstrmojo.EnumReadystate;var DRILLING_ACTION=1,SELECTOR_ACTION=2,HYPERLINK_ACTION=4,INFOWINDOW_ACTION=4;var $CSS=mstrmojo.css,cssShow="heatmap-show";var LabelSize={On:0,Off:1,Proportional:2};var AggregationType={Sum:0,Avg:1,Cnt:2,Max:3,Min:4,GeoAvg:5};var BandDirection={LeftToRight:0,RightToLeft:1,Center:2,None:3};var LayoutAlgorithm={Squarified:0,PivotByMiddle:1,SliceAndDice:2};var LayoutProperties={Padding:6,MaxLegendHeight:60,LegendMenuEditorWidth:70,LegendTickCount:5,LegendMinWidth:15,LegendTickLength:4,LegendMaxBandWidth:400,LegendWidthPercent:0.9,LegendMinPadding:15,LegendBottomPadding:3,LegendGutter:5,LegendBandAspect:10,MinShowLabelDimension:6,DeletedListHeight:500,EditorDialogWidth:565,EditorDialogHeight:574,EditButtonWidth:60,EditButtonHeight:40,EditButtonRight:10,WaitIconWidth:205,WaitIconHeight:105,WaitIconMargin:10,WaitIconFontSize:20};var Spec={heatmap_popup_panel_title:{font_size:{value:18,unit:"pt"}},heatmap_gray_label:{padding_bottom:{value:7,unit:"px"},font_size:{value:10,unit:"pt"},height:{value:32,unit:"px"},padding_left:{value:22,unit:"px"}},heatmap_tree_button:{font_size:{value:12,unit:"pt"}},heatmap_one_level_1:{font_size:{value:14,unit:"pt"}},heatmap_multi_level_1:{font_size:{value:24,unit:"pt"}},heatmap_two_level_2:{font_size:{value:14,unit:"pt"}},heatmap_multi_level_2:{font_size:{value:20,unit:"pt"}},heatmap_multi_level_3:{font_size:{value:10,unit:"pt"}},heatmap_size_legend:{font_size:{value:12,unit:"pt"}},heatmap_color_legend:{font_size:{value:12,unit:"pt"}},heatmap_color_legend_label:{font_size:{value:12,unit:"pt"}},heatmap_color_legend_tooltip:{font_size:{value:12,unit:"pt"}},heatmap_color_legend:{font_size:{value:12,unit:"pt"}},heatmap_editor_button:{font_size:{value:12,unit:"pt"}},heatmap_tooltip_gray_bold:{font_size:{value:14,unit:"pt"}},heatmap_tooltip_gray:{font_size:{value:14,unit:"pt"}},heatmap_tooltip_black_bold:{font_size:{value:14,unit:"pt"}},heatmap_tooltip_black:{font_size:{value:14,unit:"pt"}},heatmap_tree_div:{font_size:{value:18,unit:"pt"}},heatmap_tree_root__heatmap_tree_div:{font_size:{value:14,unit:"pt"}}};var Fake_Metric_ID="--";var Background_Color=16119287;var EID_SELECTALL="OA:(All)";function adjustPixel(px,forceFix){var DPIX=149,base=160;if(forceFix){base=149;}if(this.enableMultiDPI||forceFix){DPIX=this.DPIX;}return parseInt(px*(DPIX/base));}function getCSSColor(rgb){var c=16777216+rgb;var str="#"+c.toString(16).substring(1).toUpperCase();return str;}function roundNumber(n,l){return Math.round(n*Math.pow(10,l))/Math.pow(10,l);}function createPath(x,y,w,h,r,ctx){ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r-1,y);ctx.quadraticCurveTo(x+w-1,y,x+w-1,y+r);ctx.lineTo(x+w-1,y+h-r-1);ctx.quadraticCurveTo(x+w-1,y+h-1,x+w-r-1,y+h-1);ctx.lineTo(x+r,y+h-1);ctx.quadraticCurveTo(x,y+h-1,x,y+h-r-1);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);ctx.closePath();}function updateEntityAggValue(ev,rawValue,needsCopy){if(needsCopy&&ev.total===undefined){ev.avgTotal=ev.total=ev.geomProduct=ev.max=ev.min=ev.value;ev.count=isNaN(ev.value)?0:1;ev.positiveCount=ev.value>0?1:0;}ev.value=rawValue;ev.allChildrenCount++;if(!isNaN(rawValue)){if(isNaN(ev.total)){ev.total=rawValue;}else{ev.total+=rawValue;}if(isNaN(ev.avgTotal)){ev.avgTotal=rawValue;}else{ev.avgTotal+=rawValue;}if(isNaN(ev.max)){ev.max=rawValue;}else{ev.max=Math.max(ev.max,rawValue);}if(isNaN(ev.min)){ev.min=rawValue;}else{ev.min=Math.min(ev.min,rawValue);}if(isNaN(ev.geomProduct)){if(rawValue>0){ev.geomProduct=rawValue;ev.positiveCount++;}}else{if(rawValue>0){ev.geomProduct*=rawValue;ev.positiveCount++;}}ev.count++;}}function updateEntityContainerAggValue(ev,oldev){var rawValue=oldev.total;if(!isNaN(rawValue)){if(isNaN(ev.total)){ev.total=rawValue;}else{ev.total+=rawValue;}ev.count++;}rawValue=oldev.avg;if(!isNaN(rawValue)){if(isNaN(ev.avgTotal)){ev.avgTotal=rawValue;}else{ev.avgTotal+=rawValue;}}rawValue=oldev.max;if(!isNaN(rawValue)){if(isNaN(ev.max)){ev.max=rawValue;}else{ev.max=Math.max(ev.max,rawValue);}}rawValue=oldev.min;if(!isNaN(rawValue)){if(isNaN(ev.min)){ev.min=rawValue;}else{ev.min=Math.min(ev.min,rawValue);}}rawValue=oldev.geomAvg;if(!isNaN(rawValue)){if(isNaN(ev.geomProduct)){if(rawValue>0){ev.geomProduct=rawValue;ev.positiveCount++;}}else{if(rawValue>0){ev.geomProduct*=rawValue;ev.positiveCount++;}}}}function decodeXML(s){return s.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');}var delStatus={dftUnDel:0,dftDel:1,usrDel:2};function parseDeletedList(s){var oParser=new DOMParser(),oDOM=oParser.parseFromString(decodeXML(s),"text/xml"),i=0,ce=oDOM.childNodes[0],l=oDOM.childNodes[0].childElementCount;if(l==0){return{};}var cr=ce.firstElementChild,at=cr.attributes,al=at.length,ret=this.props.deletedList||{},dict=ret,key;while(i<l){dict=ret;at=cr.attributes;for(var j=0;j<al;j++){key=at[j].value;if(j===(al-1)){dict[key]=delStatus.dftDel;}else{if(!dict[key]){dict[key]={};}dict=dict[key];}}i++;cr=cr.nextElementSibling;}return ret;}function loadSession(){var props=this.props,session=this.controller.view.model.session;if(session){if(session.db!==undefined){props.delButtonEnabled=session.db;}if(session.dl!==undefined){props.deletedList=mergeDeletedList(props.deletedList,session.dl);}if(session.ps!=undefined){this.previousSelected=lookUpSelectionDic.call(this,session.ps);}this.isUsingSavedColorTheme=session.isUsingSavedColorTheme;this.isUsingDefaultColorTheme=session.isUsingDefaultColorTheme;}function lookUpSelectionDic(sd){var root=this.root;for(var i=0,len=sd.length;i<len;i++){var children=root.entityChildren;for(var j=0,l=children.length;j<l;j++){var ret=null;if(this.getEntityDisplayName(children[j])===sd[i]){ret=children[j];root=ret;break;}}}return ret;}function mergeDeletedList(d1,d2){function merge(a,b){var keys=Object.keys(b),len=keys.length;for(var i=0;i<len;i++){var key=keys[i];if(typeof b[key]!=="object"){a[key]=b[key];}else{if(a[key]===undefined){a[key]={};}merge(a[key],b[key]);}}}var ret={};merge(ret,d1);merge(ret,d2);return ret;}}function storeSession(){var cvm=this.controller.view.model,session={},props=this.props;cvm.session=session;if(props.delButtonEnabled!==undefined){session.db=props.delButtonEnabled;}if(props.deletedList!==undefined){session.dl=props.deletedList;}if(this.previousSelected){session.ps=generateSelectionDic.call(this,this.previousSelected);}session.isUsingSavedColorTheme=this.isUsingSavedColorTheme;session.isUsingDefaultColorTheme=this.isUsingDefaultColorTheme;function generateSelectionDic(entity){var sd=[];while(entity.parent){sd.push(this.getEntityDisplayName(entity));entity=entity.parent;}return sd;}}function loadProps(){this.props={};var props=this.props,m=this.model,propValue=m.vp?m.vp:{},temp;props.deletedList={};props.delButtonEnabled=false;props.showMetricValues=false;props.refreshType=0;props.labelSize=LabelSize.On;props.showLegend=true;props.sizeMetricEnabled=true;props.colorMetricEnabled=true;props.layout=LayoutAlgorithm.Squarified;props.legendAsc=true;var w=mstrmojo.VisHeatMapColorTheme.newInstance();w.initialize();this.colorTheme=w;if(propValue.dl){props.deletedList=parseDeletedList.call(this,propValue.dl);}if(propValue.ed){props.delButtonEnabled=(propValue.ed=="true"?true:false);}if(propValue.mv){props.showMetricValues=(propValue.mv=="true"?true:false);}if(propValue.rt!=""){props.refreshType=parseInt(propValue.rt);}if(propValue.ml){temp=propValue.ml.split(",");if(temp.length>=2){props.sizeMetricID=temp[0];props.colorMetricID=temp[1];}}if(propValue.lb){temp=propValue.lb;if(temp=="Off"){props.labelSize=LabelSize.Off;}else{if(temp=="Proportional"){props.labelSize=LabelSize.Proportional;}}}if(propValue.lg){props.showLegend=(propValue.lg=="true"?true:false);}if(propValue.rlp=="false"&&propValue.abs){w.convertAbsoluteToBlend(this,propValue);}if(propValue.blc){w.isBlend=(propValue.blc=="true"?true:false);}if(propValue.gradientColors&&propValue.bandColors){w.createDataProviderFromString(propValue.gradientColors,propValue.bandColors);}if(propValue.la){props.layout=parseInt(propValue.la,10);}if(propValue.rlp=="false"&&propValue.abs){this.colorTheme.convertAbsoluteToBlend(this,propValue);this.colorTheme.createDataProviderFromString(propValue.gradientColors,propValue.bandColors);}}function setLayout(){var widgetWidth=parseInt(this.width,10),widgetHeight=parseInt(this.height,10),heatMapWidth=widgetWidth-2*this.LayoutProperties.Padding,legendHeight=0,heatMapHeight;if(this.model.gvs.items.length<=0){this.props.showLegend=false;}if(this.props.showLegend){legendHeight=Math.min(Math.floor(0.2*(widgetHeight-2*this.LayoutProperties.Padding)),this.LayoutProperties.MaxLegendHeight);heatMapHeight=widgetHeight-legendHeight-3*this.LayoutProperties.Padding;}else{heatMapHeight=widgetHeight-2*this.LayoutProperties.Padding;}this.heatMapSize={x:0,y:0,w:heatMapWidth,h:heatMapHeight};this.legendSize={x:0,y:widgetHeight-2*this.LayoutProperties.Padding-legendHeight,w:widgetWidth,h:legendHeight};this.infoWindowSize={maxWidth:parseInt(this.width)-60,maxHeight:parseInt(this.height)-60};this.maxScale=10;}function resetMetricIndices(){var m=this.model,l=m.ghs.chs.items[0]?m.ghs.chs.items[0].items.length:0,sid=this.props.sizeMetricID,cid=this.props.colorMetricID,a=[];this.metricArray=a;for(var i=0;i<l;i++){a.push(getMetricID.call(this,i));}a.push(Fake_Metric_ID);l++;this.sizeMetricIndex=0;this.colorMetricIndex=l>2?1:0;for(var i=0;i<l;i++){if(sid==a[i]){this.sizeMetricIndex=i;}if(cid==a[i]){this.colorMetricIndex=i;}}if(sid===undefined){sid=a[this.sizeMetricIndex];this.props.sizeMetricID=sid;}if(cid===undefined){cid=a[this.colorMetricIndex];this.props.colorMetricID=cid;}var gvs=m.gvs&&m.gvs.items,lgvs=gvs&&gvs.length,i,sidx=this.sizeMetricIndex,cidx=this.colorMetricIndex;this.sizeByMetricMissing=true;this.colorByMetricMissing=true;for(i=0;i<lgvs;i++){var values=gvs[i]&&gvs[i].items;if(values[sidx]===undefined||values[sidx].rv!==""){this.sizeByMetricMissing=false;break;}}for(i=0;i<lgvs;i++){var values=gvs[i]&&gvs[i].items;if(values[cidx]===undefined||values[cidx].rv!==""){this.colorByMetricMissing=false;break;}}if(this.sizeByMetricMissing){this.props.sizeMetricEnabled=false;this.sizeMetricIndex=a.length-1;this.props.sizeMetricID=a[this.sizeMetricIndex];}if(this.colorByMetricMissing){this.props.colorMetricEnabled=false;}if(this.props.sizeMetricID===Fake_Metric_ID){this.props.sizeMetricEnabled=false;}if(this.props.colorMetricID===Fake_Metric_ID){this.props.colorMetricEnabled=false;this.colorTheme.hasNoColorMetric=true;}if(this.props.sizeMetricEnabled==false&&this.props.colorMetricEnabled==false){this.props.showLegend=false;}}function loadMetricsInfo(){this.aggFunctions=[];var props=this.props,cid=props.colorMetricID,af=this.aggFunctions,m=this.model,propValue=m.vp?m.vp:{},ar=this.metricArray,l=ar.length-1;if(cid!=Fake_Metric_ID){var mlEnabled=(propValue["mle"+cid]=="true")?true:false;if(mlEnabled){var val=parseFloat(propValue["mlma"+cid]);if(!isNaN(val)){this.mlmax=val;}val=parseFloat(propValue["mlmi"+cid]);if(!isNaN(val)){this.mlmin=val;}}}for(var i=0;i<l;i++){var id="agf"+ar[i];if(propValue[id]!==undefined){af.push(parseInt(propValue[id]));}else{af.push(AggregationType.Sum);}}}function totalRow(row){for(var i=0;i<row.length;i++){var obj=row[i].etk;if(obj==-1||obj=="-1"){return true;}}return false;}function convertDataToModels(){resetMetricIndices.call(this);loadMetricsInfo.call(this);var m=this.model,deletedList=this.props.deletedList,att=m.gts.row,atl=att.length,mv=m.gvs.items,rl=m.ghs.rhs?m.ghs.rhs.items.length:0;ml=mv[0]?mv[0].items.length:0,rhs=m.ghs.rhs.items;if(atl<=0){var errmsg="The Heat Map requires at least one attribute on row axis to render properly; it is recommended that two metrics be placed on the column axis as well.";m.err=mstrmojo.desc(11147,errmsg);return ;}this.singleSelection=false;this.hasNegativeSizeValue=false;this.levelAttributes=[];this.root={aggValues:[],entityChildren:[],level:0};for(var i=0;i<atl;i++){this.levelAttributes[i]={index:i,order:i+1,isInLOA:i+1>0?true:false};}var hashDict={},attSpan=[];for(var i=0;i<atl;i++){var o=att[i].fs;attSpan[i]=Math.max(1,o?o.length:1);}this.attSpan=attSpan;var isAllSelectable=true,lastSerialRowIndex,serialEntity,highestLevelEntity,highestLevelIndex;for(var i=0;i<rl;i++){var attributeArray=[],rowHeaderData=rhs[i].items,k;if(totalRow(rowHeaderData)){continue;}var levelID="",delDict=deletedList,parent=this.root,cur=0,entity,str,serialEndIndex=-1;for(var j=0;j<atl;j++){var index,newEntity;str="";for(var k=0;k<attSpan[j];k++,cur++){index=rowHeaderData[cur].idx;if(index==-1){continue;}str+=att[j].es[index].n+" ";if(k==0){levelID+=index;}}str=str.substring(0,str.length-1);if(delDict){delDict=delDict[decodeXML(str)];}if(j!=atl-1){if(hashDict[levelID]!==undefined){parent=hashDict[levelID];}else{var entityContainer={aggValues:[],entityChildren:[],parentEntity:parent};var childrenArray=parent.entityChildren;childrenArray.push(entityContainer);hashDict[levelID]=entityContainer;parent=entityContainer;entityContainer.deleted=false;entityContainer.text=str;entityContainer.label=str;entityContainer.level=j;entityContainer.index=i;}levelID+=":";newEntity=entityContainer;}else{if(hashDict[levelID]!==undefined){entity=hashDict[levelID];var indice=entity.indices;indice.push(i);for(var k=0;k<ml+1;k++){var ev=entity.aggValues[k];var rawValue;if(k==ml){rawValue=1;}else{rawValue=mv[i].items[k].rv;}updateEntityAggValue(ev,parseFloat(rawValue),true);if(!isNaN(rawValue)){this.aggregated=true;}}}else{entity={indices:[],aggValues:[],parentEntity:parent};var indice=entity.indices;indice.push(i);var aggValues=entity.aggValues;for(var k=0;k<ml+1;k++){var ev={};aggValues[k]=ev;var rawValue;if(k==ml){rawValue=1;}else{rawValue=mv[i].items[k].rv;}ev.value=parseFloat(rawValue);ev.allChildrenCount=1;}this.aggregated=false;if(delDict){entity.deleted=true;this.colorTheme.useDefault=false;}var childrenArray=parent.entityChildren;childrenArray.push(entity);entity.level=atl-1;entity.text=str;entity.label=str;hashDict[levelID]=entity;}newEntity=entity;}if(rowHeaderData[j].cet!=undefined){if(j-serialEndIndex!=1||(!isNaN(lastSerialRowIndex)&&lastSerialRowIndex!=i)){isAllSelectable=false;}if(isAllSelectable){serialEntity=newEntity;serialEndIndex=j;lastSerialRowIndex=i;}if(isNaN(highestLevelIndex)||highestLevelIndex<j){highestLevelIndex=j;highestLevelEntity=newEntity;}}}}if(isAllSelectable){this.previousSelected=serialEntity;}else{this.previousSelected=highestLevelEntity;}checkSelector.call(this);checkLinkDrill.call(this);}function clearMaxMinValues(){this.cmax=NaN;this.cmin=NaN;this.smax=NaN;this.smin=NaN;}function checkLinkDrill(){this.hasLinkDrill=false;var rowHeader=this.model.gts.row,rl=rowHeader.length;for(var i=0;i<rl;i++){var attr=rowHeader[i];if(attr.lm){for(var j=0;j<attr.lm.length;j++){if(attr.lm[j].links){break;}}if(j!=attr.lm.length){this.hasLinkDrill=true;this.firstRowLinkDrillIndex=i;break;}}}var metricH=this.model.gts.col[0];if(!metricH){return ;}var metricHL=metricH.es.length;for(var i=0;i<metricHL;i++){var metric=metricH.es[i],lm=metricH.lm[i];if(lm&&lm.links){this.hasLinkDrill=true;this.firstColLinkDrillIndex=i;break;}}}function checkSelector(){this.hasSelector=false;var m=this.model,rown=m.gts.row,rl=rown.length;var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel),layouts=(docModel&&docModel.defn&&docModel.defn.layouts),currentLayout;for(var i=0;layouts&&i<layouts.length;i++){if(layouts[i].loaded==true){currentLayout=layouts[i];break;}}var units=(currentLayout&&currentLayout.units);for(var i=0;i<rl;i++){var att=rown[i];if(att.otp!=-1&&att.sc!==undefined){this.hasSelector=true;var targets=att.sc.tks;if(typeof targets!="string"){continue;}targets=targets.split("\x1E");var len=targets.length;this.hasGridTarget=false;for(var j=0;j<len;j++){if(targets[j]==""){continue;}targetName=targets[j];if(units&&units[targetName]&&!units[targetName]["ifw"]){this.hasGridTarget=true;return ;}}}}}function layoutEntities(){var width=this.width-2*this.LayoutProperties.Padding;var legendHeight=0;if(this.props.showLegend){legendHeight=Math.min(Math.floor(0.2*(parseInt(this.height)-2*this.LayoutProperties.Padding)),this.LayoutProperties.MaxLegendHeight);}var hm=this,area=copyRect(this.heatMapSize);area.w*=this.scaleFactor;area.h*=this.scaleFactor;var min=Math.min(area.w,area.h);var ch=this.root.entityChildren;switch(this.props.layout){case LayoutAlgorithm.Squarified:var arr=ch.slice(0);arr.sort(function sortEntity(s,t){var vs=getSizeValue(s,hm);var vt=getSizeValue(t,hm);if(isNaN(vs)){if(isNaN(vt)){return 0;}return 1;}else{if(isNaN(vt)){return -1;}return vs<vt?1:-1;}return 0;});squarify.call(this,arr,{r:[]},min,area);break;case LayoutAlgorithm.SliceAndDice:sliceAndDice.call(this,ch,area);break;case LayoutAlgorithm.PivotByMiddle:var arr=getVisibleEntities.call(this,ch),l=arr.length;if(l>0){pivotByMiddle.call(this,arr,0,l-1,area);}break;}}function squarify(t,r,m,c,a){var newRow=false;if(t.length==0){setLayoutOrder.call(this,r,c);}else{var area=c.w*c.h;var cwa;if(a!==undefined){cwa=a;}else{cwa=worstAspect.call(this,r,m,area);}var data=t[0],arr=r.r;arr.push(data);var fwa=worstAspect.call(this,r,m,area);if(cwa>=fwa||cwa==-1){t.shift();squarify.call(this,t,r,m,c,fwa);}else{r.r.pop();setLayoutOrder.call(this,r,c);m=Math.min(c.w,c.h);if(r.t===undefined){squarify.call(this,t,{r:[]},m,c);}else{squarify.call(this,t,{r:[],t:r.t},m,c);}}}}function getTextStyle(l,w){var fs,css,len=w.levelAttributes.length;if(len==1){if(l==0){css="heatmap-one-level-1";fs=this.Spec.heatmap_one_level_1.font_size.value;}}else{if(len==2){if(l==0){css="heatmap-multi-level-1";fs=this.Spec.heatmap_multi_level_1.font_size.value;}else{if(l==1){css="heatmap-two-level-2";fs=this.Spec.heatmap_two_level_2.font_size.value;}}}else{if(len>=3){if(l==0){css="heatmap-multi-level-1";fs=this.Spec.heatmap_multi_level_1.font_size.value;}else{if(l==1){css="heatmap-multi-level-2";fs=this.Spec.heatmap_multi_level_2.font_size.value;}else{css="heatmap-multi-level-3";fs=this.Spec.heatmap_multi_level_3.font_size.value;}}}}}return{css:css,size:fs};}function getRectangleGap(e){var getGapPixel=function(){var te=e,level=e.level,l=this.levelAttributes.length;if(l==1){return 1;}if(l==2){if(level==0){return 3;}return 1;}if(l==3){if(level==0){return 6;}if(level==1){return 3;}return 1;}else{if(level==0){return 8;}if(level==1){return 4;}if(level==2){return 2;}return 1;}};var ret,gap=getGapPixel.call(this);if(this.DPI>160){ret=adjustPixel.call(this,gap);}else{ret=gap;}if(ret<=0){ret=1;}return ret;}function rectIsValid(a){return a.w>0&&a.h>0;}function rectIntersection(a,b){var x=Math.max(a.x,b.x);var y=Math.max(a.y,b.y);var w=Math.min(a.x+a.w,b.x+b.w)-x;var h=Math.min(a.y+a.h,b.y+b.h)-y;if(w<0||h<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:x,y:y,w:w,h:h};}function rectIsEqual(a,b){if(a.x==b.x&&a.y==b.y&&a.w==b.w&&a.h==b.h){return true;}else{return false;}}function rectCanEncircle(a,b){var c=rectIntersection(a,b);return rectIsEqual(c,b);}function rectPutAside(a,b,c){var p=[{x:b.x-a.w,y:b.y+b.h/2-a.h/2,w:a.w,h:a.h},{x:b.x+b.w,y:b.y+b.h/2-a.h/2,w:a.w,h:a.h},{x:b.x+b.w/2-a.w/2,y:b.y-a.h,w:a.w,h:a.h},{x:b.x+b.w/2-a.w/2,y:b.y+b.h,w:a.w,h:a.h}];for(var i=0;i<4;i++){if(rectCanEncircle(c,p[i])){return{rect:p[i],index:i};}}}function swapRect(a){var temp=a.x;a.x=a.y;a.y=temp;temp=a.w;a.w=a.h;a.h=temp;return a;}function copyRect(a){var b={};b.x=a.x;b.y=a.y;b.w=a.w;b.h=a.h;return b;}function worstAspect(r,m,a){var worst,arr=r.r,l=arr.length;if(l>0&&a>0){var e=arr[0];var pval=getSizeValue(e.parentEntity,this);if(isNaN(pval)||pval<=0){return -1;}var min,max,sum=0,val,e,inited=false;for(var i=0;i<l;i++){e=arr[i];if(!e.deleted){val=getSizeValue(e,this);if(!isNaN(val)){if(inited==false){max=min=val;inited=true;}else{max=Math.max(val,max);min=Math.min(val,min);}sum+=val;}}}var suba=a*sum/pval,otherMin=suba/m,newMin=(m<otherMin)?m:otherMin;max=a*max/pval;min=a*min/pval;var e1=max/(newMin*newMin);var e2=min/(newMin*newMin);e1=(e1>1)?e1:(1/e1);e2=(e2>1)?e2:(1/e2);worst=Math.max(e1,e2);}else{worst=-1;}return worst;}function layoutRow(r,c,n,sum,swapped){var width,height,ch=r.r,l=ch.length,w,h,tmpc,localSwapped=false;if(l==0){return ;}if(n<c.h){w=n;h=c.h;tmpc=c;}else{w=c.h;h=n;var tmpc=copyRect(c);swapRect(tmpc);localSwapped=true;}var x=tmpc.x,y=tmpc.y,bound={x:x,y:y,w:w,h:h};var gap=getRectangleGap.call(this,ch[0]);for(var i=0;i<l;i++){var e,rect,minDim;e=ch[i];if(e.deleted){if((swapped==true&&localSwapped!=true)||(swapped==false&&localSwapped==true)){e.size={x:y,y:x,w:0,h:0};}else{e.size={x:x,y:y,w:0,h:0};}continue;}var value=getSizeValue(e,this);height=(sum<=0||e.deleted)?0:Math.ceil(h*value/sum);width=w;if(e.entityChildren!==undefined){if(value<sum){if(i==0){if(gap>1){height-=(gap>>1);}else{height--;}}else{if(i<l-1){if(gap>1){height-=gap;}else{height--;}}else{height=h+tmpc.y-y;}}}var nc={x:x,y:y,w:width,h:height};rect=rectIntersection(nc,bound);if((swapped==true&&localSwapped!=true)||(swapped==false&&localSwapped==true)){swapRect(nc);swapRect(rect);}if(rectIsValid(rect)){e.size=rect;}else{e.size={x:rect.x,y:rect.y,w:0,h:0};}minDim=Math.min(rect.w,rect.h);var hm=this;var arr=e.entityChildren.slice(0);arr.sort(function sortEntity(s,t){var vs=getSizeValue(s,hm);var vt=getSizeValue(t,hm);if(isNaN(vs)){if(isNaN(vt)){return 0;}return 1;}else{if(isNaN(vt)){return -1;}return vs<vt?1:-1;}return 0;});squarify.call(this,arr,{r:[]},minDim,nc);y+=height+gap;}else{if(value<sum){if(i==0||i==l-1){if(gap>1){if(height>(gap>>1)){height-=(gap>>1);}}else{if(height>1){height--;}}}else{if(height>gap){height-=gap;}}}width=Math.max(0,width);height=Math.max(0,height);var rect=rectIntersection({x:x,y:y,w:width,h:height},bound);rect.x=x;rect.y=y;y+=height+gap;if(y>=tmpc.y+h){rect.h=tmpc.y+h-rect.y;}if((swapped==true&&localSwapped!=true)||(swapped==false&&localSwapped==true)){rect=swapRect(rect);}if(rectIsValid(rect)){e.size=rect;}else{e.size={x:rect.x,y:rect.y,w:0,h:0};}}}}function setLayoutOrder(r,c){var sum=0,arr=r.r,l=arr.length;if(l==0){return ;}var ra,p=arr[0].parentEntity,ch=p.entityChildren,ll=ch.length;for(var i=0;i<l;i++){var e=arr[i],v=getSizeValue(e,this);if(!e.deleted&&v>0){sum+=v;}}if(r.t===undefined){var t=0;for(var i=0;i<ll;i++){var e=ch[i],v=getSizeValue(e,this);if(!e.deleted&&v>0){t+=v;}}r.t=t;}var e=arr[0],gap=getRectangleGap.call(this,e),bound={x:0,y:0,w:0,h:0};if(e==this.root){ra=this.heatMapSize.w*this.scaleFactor*this.heatMapSize.h*this.scaleFactor;bound.w=this.heatMapSize.w*this.scaleFactor;bound.h=this.heatMapSize.h*this.scaleFactor;}else{if(p==this.root){ra=this.heatMapSize.w*this.scaleFactor*this.heatMapSize.h*this.scaleFactor;bound.w=this.heatMapSize.w*this.scaleFactor;bound.h=this.heatMapSize.h*this.scaleFactor;}else{var pSize=p.size;ra=pSize.w*pSize.h;bound=copyRect(pSize);}if(r.t==0){ra=0;}else{ra*=sum/r.t;}}var aw=c.w,ah=c.h,swapped=false;if(c.h<c.w){}else{swapped=true;swapRect(c);swapRect(bound);var temp=aw;aw=ah;ah=temp;}if((bound.x<c.x)||(bound.x+bound.w>c.x+c.w)){if(gap>1){aw+=(gap>>1);}}if((bound.y<c.y)||(bound.y+bound.h>c.y+c.h)){if(gap>1){ah+=(gap>>1);}}var width=ah==0?0:Math.min(c.w,Math.ceil(ra/ah));if(sum<r.t&&sum>0){if(c.x+width<bound.x+bound.w){if(gap>1){width-=(gap>>1);}else{width--;}}}layoutRow.call(this,r,c,width,sum,swapped);var newX=c.x+width,newWidth=c.w-width;if(sum<r.t&&sum>0){if(c.x+width<bound.x+bound.w){if(gap>1){newX+=gap;newWidth-=gap;}else{newX++;newWidth--;}}}c.x=newX;c.w=Math.max(0,newWidth);if(swapped){swapRect(c);}}function getVisibleEntities(a){if(a==null){return[];}var arr=a.slice(0),total=0,l=arr.length;arr.t=[];for(var i=0;i<l;i++){var e=arr[i],val=getSizeValue(e,this);if(e.deleted||isNaN(val)||val<=0){arr.splice(i,1);i--;l--;continue;}total+=val;arr.t[i]=total;}return arr;}function pivotByMiddle(t,l,r,c){var e=t[0],gap=getRectangleGap.call(this,e),lc,rc,lv,rv,lp,swapped=false,n=r-l+1,pivot=(n>2?((n-1)>>1):(n>>1))+l,cc;cc=copyRect(c);if(cc.w>cc.h){}else{swapRect(cc);swapped=true;}lc=copyRect(cc);rc=copyRect(cc);if(l==r){e=t[l];layoutEntityByMiddle.call(this,e,cc,swapped);return ;}if(l+1==r){e=t[l];lv=getSizeValue(e,this);e=t[r];rv=getSizeValue(e,this);}else{if(l==0){lv=t.t[pivot-1];}else{lv=t.t[pivot-1]-t.t[l-1];}if(pivot==0){rv=t.t[r];}else{rv=t.t[r]-t.t[pivot-1];}}lp=lv/(lv+rv);lc.w=Math.ceil(lc.w*lp);if(lc.w<c.w){if(gap>1){if(lc.w>(gap>>1)){lc.w-=(gap>>1);}}else{if(lc.w>1){lc.w--;}}}if(l+1==r){rc.w-=lc.w+gap;rc.x+=lc.w+gap;e=t[l];layoutEntityByMiddle.call(this,e,lc,swapped);e=t[r];layoutEntityByMiddle.call(this,e,rc,swapped);return ;}var mc=copyRect(cc),as,pap,cv=0,pi=-1,la=1,pv;if(pivot>l){var llc=copyRect(lc);if(swapped){swapRect(llc);}pivotByMiddle.call(this,t,l,pivot-1,llc);}mc.w-=lc.w+gap;mc.x+=lc.w+gap;rc.w=mc.w;rc.x=mc.x;as=mc.w/mc.h;e=t[pivot];pv=getSizeValue(e,this);pap=pv/rv;for(var i=pivot;i<=r;i++){e=t[i];cv+=getSizeValue(e,this);if(i==r-1){continue;}var pwp=cv/rv,php=pv/cv,a=pwp/php*as;if(a>=1){if(la<1&&la*a>1){pi=(i==r)?i-2:i-1;}else{pi=i;}break;}la=a;}pi=pi<0?r:pi;var mv,pw,ph;if(pivot==0){mv=t.t[pi];}else{mv=t.t[pi]-t.t[pivot-1];}pw=Math.ceil(mc.w*(mv/rv));ph=Math.ceil(mc.h*(pv/mv));if(pw<mc.w){if(gap>1){if(pw>(gap>>1)){pw-=(gap>>1);}}else{if(pw>1){pw--;}}}if(ph<mc.h){if(gap>1){if(ph>(gap>>1)){ph-=(gap>>1);}}else{if(ph>1){ph--;}}}var pc={x:mc.x,y:mc.y,w:pw,h:ph};e=t[pivot];layoutEntityByMiddle.call(this,e,pc,swapped);if(pivot<pi){mc.y+=ph+gap;mc.w=pw;mc.h-=ph+gap;if(swapped){swapRect(mc);}pivotByMiddle.call(this,t,pivot+1,pi,mc);}if(pi<r){rc.x+=pw+gap;rc.w-=pw+gap;if(swapped){swapRect(rc);}pivotByMiddle.call(this,t,pi+1,r,rc);}}function layoutEntityByMiddle(e,c,swapped){var size=copyRect(c);if(swapped==true){swapRect(size);}if(rectIsValid(size)){e.size=size;}else{e.size={x:size.x,y:size.y,w:0,h:0};}var ch=e.entityChildren;if(ch!==undefined){var arr=getVisibleEntities.call(this,ch),l=arr.length;if(l>0){pivotByMiddle.call(this,arr,0,l-1,size);}}}function sliceAndDice(r,c){if(r==null||r.length==0){return ;}var t=0,e=r[0],val,gap=getRectangleGap.call(this,e),swapped=false,l=r.length,x,y,w,h;for(var i=0;i<l;i++){e=r[i],val=getSizeValue(e,this);if(!e.deleted&&val>0){t+=val;}}if(c.w<c.h){}else{swapped=true;swapRect(c);}w=c.w;h=c.h;x=c.x;y=c.y;for(var i=0;i<l;i++){e=r[i],val=getSizeValue(e,this);if(!e.deleted&&val>0){var width,height;height=t<=0?0:Math.ceil(val/t*h);width=w;if(val<t){if(i==0||i==l-1){if(gap>1){if(height>(gap>>1)){height-=(gap>>1);}}else{if(height>1){height--;}}}else{if(height>gap){height-=gap;}}}width=Math.max(0,width);height=Math.max(0,height);var nc={x:x,y:y,w:width,h:height},rect=rectIntersection(nc,c);y+=height+gap;if(y>=c.y+h){rect.h=c.y+h-rect.y;}if(swapped){swapRect(rect);}if(rectIsValid(rect)){e.size=rect;}else{e.size={x:rect.x,y:rect.y,w:0,h:0};}if(e.entityChildren!==undefined){sliceAndDice.call(this,e.entityChildren,rect);}}else{e.size={};if(swapped){e.size={x:y,y:x,w:0,h:0};}else{e.size={x:x,y:y,w:0,h:0};}continue;}}if(swapped){swapRect(c);}}function setShow(mf,s,fm,sfm,ec,w,ml){if(ec.entityChildren!==undefined){var parent=ec.parentEntity,del=true,cd=false,teAggValues=[],eChildren=ec.entityChildren,l=eChildren.length;for(var i=0;i<ml;i++){teAggValues[i]={count:0,allChildrenCount:0,positiveCount:0};}for(var i=0;i<l;i++){var child=eChildren[i];setShow(mf,s,fm,sfm,child,w,ml);if(!child.deleted){del=false;}if(child.entityChildren===undefined){if(child.deleted){cd=true;}}else{if(child.hasChildDeleted){cd=true;}}if(!child.deleted){aggregateTotals(ec,child,teAggValues,w,ml);}}ec.deleted=del;ec.hasChildDeleted=cd;for(var i=0;i<ml;i++){var ev=ec.aggValues[i];if(ev==null){ev={};ec.aggValues[i]=ev;}var temp=teAggValues[i];ev.total=temp.total;ev.avg=temp.count==0?0:temp.avgTotal/temp.count;ev.geomAvg=temp.positiveCount==0?NaN:Math.pow(temp.geomProduct,1/temp.positiveCount);ev.min=temp.min;ev.max=temp.max;ev.count=temp.count;ev.positiveCount=temp.positiveCount;}}else{if(ec.deleted){return ;}var sv=getSizeValue(ec,w);if(!isNaN(sv)){if(isNaN(w.smax)){w.smax=w.smin=sv;}else{if(sv>w.smax){w.smax=sv;}if(sv<w.smin){w.smin=sv;}}}var cv=getColorValue(ec,w);if(!isNaN(cv)){if(isNaN(w.cmax)){w.cmax=w.cmin=cv;}else{if(cv>w.cmax){w.cmax=cv;}if(cv<w.cmin){w.cmin=cv;}}}}}function aggregateTotals(ec,child,teAggValues,w,ml){var ev,agg=child.aggValues;if(child.entityChildren!==undefined){ev=getEntityValue(child,w.sizeMetricIndex);if(ev!==null){var cnt=ev.count;if(cnt>0){for(var i=0;i<ml;i++){ev=teAggValues[i];updateEntityContainerAggValue(ev,agg[i]);}}}}else{if(getSizeValue(child,w)>0&&!child.deleted){for(var i=0;i<ml;i++){ev=teAggValues[i];updateEntityAggValue(ev,getAggValue(child,i,w));}}}}function getEntityValue(e,index){var agg=e.aggValues;if(index>=agg.length){return NaN;}return agg[index];}function getColorValue(e,w){var idx=w.colorMetricIndex;return getAggValue(e,idx,w);}function getSizeValue(e,w){var idx=w.sizeMetricIndex,val=getAggValue(e,idx,w);if(val<0){w.hasNegativeSizeValue=true;return Math.abs(val);}return val;}function getSizeRawValue(e,w){var idx=w.sizeMetricIndex;return getAggValue(e,idx,w);}function getAggValue(e,i,w){var agg=e.aggValues;if(i>=agg.length){return NaN;}var ev=agg[i],t=w.aggFunctions[i];if(e.entityChildren!==undefined){switch(t){case AggregationType.Sum:return ev.total;case AggregationType.Avg:return ev.avg;case AggregationType.Cnt:return ev.count;case AggregationType.Max:return ev.max;case AggregationType.Min:return ev.min;case AggregationType.GeoAvg:return(ev.positiveCount>0)?ev.geomAvg:0;default:return ev.total;}}else{if(ev.allChildrenCount==1){return ev.value;}switch(t){case AggregationType.Sum:return ev.total;case AggregationType.Avg:return ev.count==0?0:ev.avgTotal/ev.count;case AggregationType.Cnt:return ev.count;case AggregationType.Max:return ev.max;case AggregationType.Min:return ev.min;case AggregationType.GeoAvg:return ev.positiveCount>0?NaN:Math.pow(ev.geomProduct,1/ev.positiveCount);default:return ev.total;}}}function getLegendMaxMin(){if(!isNaN(this.mlmax)||!isNaN(this.mlmin)){if(!isNaN(this.mlmax)){this.cmax=this.mlmax;if(isNaN(this.mlmin)&&(this.mlmax<this.cmin)){this.cmin=this.mlmax;}}if(!isNaN(this.mlmin)){this.cmin=this.mlmin;if(isNaN(this.mlmax)&&(this.mlmin>this.cmax)){this.cmax=this.mlmin;}}}if(!isNaN(this.mlmax)&&this.cmax>this.mlmax){this.cmax=this.mlmax;}if(!isNaN(this.mlmin)&&this.cmin<this.mlmin){this.cmin=this.mlmin;}this.colorTheme.min=this.cmin;this.colorTheme.max=this.cmax;this.colorTheme.checkMinMax();}function getMetricID(idx){var str="",m=this.model,col=m.ghs.chs.items,cnt=col.length,ml=col[0].items.length,coln=m.gts.col;if(idx<0||idx>=ml){return"";}for(var i=0;i<cnt;i++){var index=col[i].items[idx].idx;var temp=coln[i].es[index];var id=(temp.oid!==undefined)?temp.oid:temp.id;str+=id+" ";}return str.slice(0,str.length-1);}function getNumberForTick(i){var v;if(this.props.legendAsc){v=this.cmin+(this.cmax-this.cmin)*i/this.legendTickCount;}else{v=this.cmax+(this.cmin-this.cmax)*i/this.legendTickCount;}if(this.props.legendRounded){v=Math.floor(v);}return v;}function getTooltip(e,w){var level=e.level,index=(e.index===undefined)?e.indices[0]:e.index,st=0,str="",ret="",ar=w.attSpan,rhs=w.model.ghs.rhs.items,rowHeaderData=rhs[index].items,attr=w.model.gts.row,mv=w.model.gvs.items,ml=mv[0]?mv[0].items.length:0,att,fs;for(var i=0;i<level;i++){att=attr[i];ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-gray-bold">'+att.n+'</div><div class="heatmap-tooltip-gray-bold"><p>:&nbsp;</p></div>';str="";for(var j=st;j<st+ar[i];j++){var idx=rowHeaderData[j].idx;if(idx==-1){continue;}str+=att.es[idx].n+" ";}str=str.substring(0,str.length-1);ret+='<div class = "heatmap-tooltip-gray">'+str+"</div></div>";st+=ar[i];}att=attr[level];ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-black-bold">'+att.n+'</div><div class="heatmap-tooltip-black-bold"><p>:&nbsp;</p></div>';str="";for(var i=st;i<st+ar[level];i++){var idx=rowHeaderData[i].idx;if(idx==-1){continue;}str+=att.es[idx].n+" ";}str=str.substring(0,str.length-1);ret+='<div class = "heatmap-tooltip-black">'+str+"</div></div>";var si=w.sizeMetricIndex,ci=w.colorMetricIndex,n,v;if(si!=ml){n=w.getMetricName(si);if(e.entityChildren!==undefined||w.aggregated){var tmp=w.aggFunctions[si];n=tooltipMacro(n,tmp);v=getSizeRawValue(e,w);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=w.getFormatString(si);v=w.nf.formatByMask(fs,v);}}}else{v=mv[index].items[si].v;}ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-black-bold">'+n+'</div><div class="heatmap-tooltip-black-bold"><p>:&nbsp;</p></div>';ret+='<div class = "heatmap-tooltip-black">'+v+"</div></div>";}if(e.entityChildren===undefined&&ci!=ml&&si!=ci){n=w.getMetricName(ci);if(e.entityChildren!==undefined||w.aggregated){var tmp=w.aggFunctions[ci];n=tooltipMacro(n,tmp);v=getColorValue(e,w);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=w.getFormatString(ci);v=w.nf.formatByMask(fs,v);}}}else{v=mv[index].items[ci].v;}ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-black-bold">'+n+'</div><div class="heatmap-tooltip-black-bold"><p>:&nbsp;</p></div>';ret+='<div class = "heatmap-tooltip-black">'+v+"</div></div>";}for(var i=0;i<ml;i++){if(i==si){continue;}if(i==ci&&e.entityChildren===undefined&&si!=ci){continue;}n=w.getMetricName(i);if(e.entityChildren!==undefined||w.aggregated){var tmp=w.aggFunctions[i];n=tooltipMacro(n,tmp);v=getAggValue(e,i,w);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=w.getFormatString(i);v=w.nf.formatByMask(fs,v);}}}else{v=mv[index].items[i].v;}ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-gray-bold">'+n+'</div><div class="heatmap-tooltip-gray-bold"><p>:&nbsp;</p></div>';ret+='<div class = "heatmap-tooltip-gray">'+v+"</div></div>";}return ret;}function tooltipMacro(n,t){var macro;switch(t){case AggregationType.Sum:macro="Sum of {0}";break;case AggregationType.Avg:macro="Average of {0}";break;case AggregationType.Cnt:macro="Count of {0}";break;case AggregationType.Max:macro="Maximum of {0}";break;case AggregationType.Min:macro="Minimum of {0}";break;case AggregationType.GeoAvg:macro="Geometry Average of {0}";break;default:macro="Sum of {0}";}return macro.replace("{0}",n);}function bindTouchEvents(d,owner){if(d.eventOwner==owner){return ;}var $D=mstrmojo.dom,eventList=[$D.TOUCHSTART,$D.TOUCHMOVE,$D.TOUCHEND,$D.TOUCHCANCEL];for(var i=0;i<eventList.length;i++){if(eventList[i]==""){continue;}if(document.createTouch){d["on"+eventList[i]]=function(e){var evt=document.createEvent("TouchEvent"),t=e.touches[0];if(!t){t={};}evt.initTouchEvent(e.touches,e.targetTouches,e.changedTouches,e.type,e.view,t.screenX,t.screenY,t.clientX,t.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey);owner.dispatchEvent(evt);};}else{d["on"+eventList[i]]=function(e){var evt=document.createEvent("MouseEvent");evt.initMouseEvent(e.type,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget);owner.dispatchEvent(evt);};}}d.eventOwner=owner;}mstrmojo.VisHeatMap=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisHeatMap",scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:true,vScroll:true,hScroll:true,offset:{y:{start:0,end:0},x:{start:0,end:0}},origin:{x:0,y:0}},selectedStyle:"background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #058CF5), color-stop(1, #015DE6));color:#FFFFFF;",selectedClass:"",insertedStyles:[],LayoutProperties:{},highlightBoxWidth:3,waitIconString:mstrmojo.desc("8445","Loading"),markupString:'<div id="{@id}" class="mstrmojo-{@cssClass}" style="background-color:#333333;width:{@width};height:{@height}; left:{@left}; top:{@top}; z-index: {@zIndex}; position:absolute;" mstrAttach:mousedown,mouseup,mousemove,click><div class="heatmap-canvas-outer-container" style="padding: {@LayoutProperties.Padding}px; height:{@heatMapSize.h}px; width:{@heatMapSize.w}px"><div id ="{@id}-heatmap-canvas-container" class="heatmap-canvas-container" style="left: {@LayoutProperties.Padding}px; top: {@LayoutProperties.Padding}px; height:{@heatMapSize.h}px; width:{@heatMapSize.w}px"><div><div></div><div class="heatmap-selection-highlight-box heatmap-round-corner" style="border: {@highlightBoxWidth}px solid white;"></div></div></div></div><div class="heatmap-legend" style="left:{@legendSize.x}px; top:{@legendSize.y}px; height:{@legendSize.h}px; width:{@legendSize.w}px"><div  class="heatmap-size-legend"><div class="heatmap-size-legend-title">Rectangle Size:</div><div id="{@id}-color-legend-ticker" class="heatmap-size-legend-label" ></div></div><div  class="heatmap-color-legend"><div class="heatmap-color-legend-title">Rectangle Color:</div><table cellpadding="4" class="heatmap-color-legend-label"><tbody><tr><td class="heatmap-color-legend-label-td"></td></tr></tbody></table><div style="position:relative;"><canvas id="{@id}-color-legend-band" class="heatmap-color-legend-band"></canvas><div id="{@id}-legend-tooltip" class="heatmap-color-legend-tooltip"></div></div></div><div id="{@id}-editor-div" class="heatmap-editor-button" style="width: {@LayoutProperties.EditButtonWidth}px; height:{@LayoutProperties.EditButtonHeight}px; right:{@LayoutProperties.EditButtonRight}px"></div></div><span id="textSpan" class="heatmap-measure-text"></span><div class="mojo-overlay-wait" style="display: -webkit-box; -webkit-box-align:center; -webkit-box-pack:center; position: absolute; left: -100000px; top: -100000px"><div class="overlay"></div><div style="width:{@LayoutProperties.WaitIconWidth}px; height:{@LayoutProperties.WaitIconHeight}px; background-color: black; opacity: 0.8; display: -webkit-box"><div style="display: -webkit-box; -webkit-box-align: center; -webkit-box-pack: center; -webkit-box-flex:1;  margin: {@LayoutProperties.WaitIconMargin}px; border: 1px solid white; color: white; font-family: Helvetica; font-weight: bold; font-size:{@LayoutProperties.WaitIconFontSize}pt">{@waitIconString}</div></div></div><div></div></div>',markupSlots:{canvas:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0].childNodes[0];},canvasContainer:function(){return this.domNode.childNodes[0].childNodes[0];},canvasOuterContainer:function(){return this.domNode.childNodes[0];},scrollNode:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0];},selectionHighlightBox:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0].childNodes[1];},legend:function(){return this.domNode.childNodes[1];},sizeLegend:function(){return this.domNode.childNodes[1].childNodes[0];},sizeLegendTitle:function(){return this.domNode.childNodes[1].childNodes[0].firstChild;},sizeLegendLabel:function(){return this.domNode.childNodes[1].childNodes[0].lastChild;},colorLegend:function(){return this.domNode.childNodes[1].childNodes[1];},colorLegendTitle:function(){return this.domNode.childNodes[1].childNodes[1].firstChild;},colorLegendLabel:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[1];},colorLegendBand:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2].firstChild;},legendTooltip:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2].childNodes[1];},editorButton:function(){return this.domNode.childNodes[1].lastChild;},textSpan:function(){return this.domNode.childNodes[2];},waitIcon:function(){return this.domNode.childNodes[3];},infoBoxPuppet:function(){return this.domNode.childNodes[4];}},addCSSToHead:function(){var cssString={text:".heatmap-popup-panel-title {  font-size: "+adjustPixel.call(this,22,true)+"pt !important;  height: "+adjustPixel.call(this,65,true)+"px !important;}.heatmap-gray-label {        padding-bottom: "+adjustPixel.call(this,7,true)+"px !important;        font-size: "+adjustPixel.call(this,14,true)+"pt !important;  height: "+adjustPixel.call(this,32,true)+"px !important;  padding-left: "+adjustPixel.call(this,22,true)+"px !important;  line-height: "+adjustPixel.call(this,40,true)+"px !important;}.heatmap-tree-text {  font-size: "+adjustPixel.call(this,18,true)+"pt !important;  line-height: "+adjustPixel.call(this,65,true)+"px !important;}.heatmap-tree-div {  font-size: "+adjustPixel.call(this,18,true)+"pt !important;  line-height: "+adjustPixel.call(this,40,true)+"px !important;}.heatmap-tree-button {  font-size: "+adjustPixel.call(this,16,true)+"pt !important;}.heatmap-apply-button > .mstrmojo-Button-text {  font-size: "+adjustPixel.call(this,14,true)+"pt !important;  line-height: "+adjustPixel.call(this,24,true)+"px !important;   height: "+adjustPixel.call(this,24,true)+"px !important; }.heatmap-tree.root > .heatmap-tree-div > div {  font-size: "+adjustPixel.call(this,14,true)+"pt !important;  line-height: "+adjustPixel.call(this,40,true)+"px !important;  height: "+adjustPixel.call(this,40,true)+"px !important;}.heatmap-one-level-1 {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-multi-level-1 {  font-size: "+adjustPixel.call(this,24)+"pt !important;}.heatmap-two-level-2 {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-multi-level-2 {  font-size: "+adjustPixel.call(this,20)+"pt !important;}.heatmap-multi-level-3 {  font-size: "+adjustPixel.call(this,10)+"pt !important;}.heatmap-size-legend {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-color-legend {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-color-legend-label {  font-size: "+adjustPixel.call(this,10)+"pt !important;}.heatmap-color-legend-tooltip {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-legend {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-editor-button {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-tooltip-gray-bold {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-tooltip-gray {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-tooltip-black-bold {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-tooltip-black {  font-size: "+adjustPixel.call(this,14)+"pt !important;}"};this.addAdjustedClassToDocument(cssString.text);},addAdjustedClassToDocument:function(classString){var beginIndex=classString.indexOf(".");if(beginIndex==-1){return ;}var p=document.getElementsByTagName("head")[0];this.CSSParent=p;for(var i=beginIndex;i<classString.length;){var endIndex=i+classString.substring(i).indexOf("}");if(endIndex==-1){break;}var style=document.createElement("style");style.type="text/css";style.innerHTML=classString.substring(i,endIndex+1);this.insertedStyles.push(style);p.appendChild(style);i=endIndex+1;}},isMultipleDPIEnabled:function(){var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel),fitToPage=false,microApp=false;if(docModel){fitToPage=docModel.zt&&(docModel.zt==2);var layouts=(docModel&&docModel.defn&&docModel.defn.layouts),layout;var i;for(i in layouts){if(layouts[i].loaded){layout=layouts[i];break;}}if(layout&&layout.hasOwnProperty("fch")){microApp=layout.fch;}}if(fitToPage&&microApp){return true;}else{return false;}},init:function(e){if(this._super){this._super(e);}var canvas=document.createElement("canvas");browserSupportsHtml5=canvas.getContext;if(!browserSupportsHtml5){this.error=mstrmojo.desc(8126,"Your browser does not support HTML5");return ;}},preBuildRendering:function(){delete this.error;if(this._super){this._super();}this.dpiAdjusted=true;this.DPI=mstrMobileApp.getDeviceDPI();if(mstrMobileApp.getDeviceDPIX){this.DPIX=mstrMobileApp.getDeviceDPIX();}else{this.DPIX=149;}if(this.isMultipleDPIEnabled()){this.enableMultiDPI=true;}else{this.enableMultiDPI=false;}this.adjustLocalDPI();this.addCSSToHead();this.zIndex=null;this.loadDefinedFormat();loadProps.call(this);loadSession.call(this);if(!this.model){this.error=mstrmojo.desc(8426,"No model provided");return ;}var err=this.model.err||this.model.eg;if(err){this.error=err;return ;}convertDataToModels.call(this);var err=this.model.err||this.model.eg;if(err){this.error=err;return ;}setLayout.call(this);this.calculateValuesInTree();layoutEntities.call(this);getLegendMaxMin.call(this);this.nf=mstrmojo.num;if(this.editorDialog){this.editorDialog.destroy();this.editorDialog=null;}},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res;try{res=eval(s);}catch(e){res=undefined;}finally{}return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},createInfoBox:function(){var html='<div id="'+this.id+'-infobox" class="heatmap-infobox" style="position:absolute; left:0px; top:0px;"><div class="heatmap-highlight-box heatmap-round-corner" style="border: '+this.highlightBoxWidth+'px solid white;"></div><div class="heatmap-shadow-box heatmap-round-corner"></div><div class="heatmap-triangle"></div><div class="heatmap-tooltip-box heatmap-round-corner" style="max-width: '+document.body.offsetWidth+"px; max-height: "+document.body.offsetHeight+'px; "></div><div class="heatmap-delete-button"></div><div class="heatmap-tooltip-shelter heatmap-round-corner"></div></div>';var div=document.createElement("div");div.innerHTML=html;this.infoBox=div.childNodes[0];this.highlightBox=this.infoBox.childNodes[0];this.shadowBox=this.infoBox.childNodes[1];this.triBox=this.infoBox.childNodes[2];this.tooltipBox=this.infoBox.childNodes[3];this.deleteButton=this.infoBox.childNodes[4];this.shelter=this.infoBox.childNodes[5];div.style.cssText="position: absolute; left: 0px; top: 0px";bindTouchEvents(div,this.infoBoxPuppet);document.body.appendChild(div);},postBuildRendering:function postBR(){if(this.error){this.renderErrorMessage(this.error);return ;}var heatMap=this;var tmpFunction=this.controller.onorientationChange;this.controller.onorientationChange=function(){tmpFunction.call(heatMap.controller);heatMap.onorientationChange();};this.enableGlobalDismiss();this.setupScroller();if(this._super){this._super();}var backup=this._tsCallback;this._tsCallback=function(e){if(heatMap.isInfoWindowDisplayed()){heatMap.infoWindowMode=true;}else{heatMap.infoWindowMode=false;}backup.call(heatMap,e);};var $DAE=mstrmojo.dom.attachEvent,$DDE=mstrmojo.dom.detachEvent,TOUCHSTART=mstrmojo.dom.TOUCHSTART;$DDE(this._tn,TOUCHSTART,backup);$DAE(this._tn,TOUCHSTART,this._tsCallback);if(this.isUsingSavedColorTheme){this.useSavedColorTheme();}if(this.isUsingDefaultColorTheme){this.useDefaultColorTheme();}this.initCanvas();this.renderLegend();if(!this.infoBox){this.createInfoBox();}if(this.props.delButtonEnabled){this.deleteButton.style.display="block";}if(this.previousSelected&&this.previousSelected.parentEntity){this.highlightEntity(this.selectionHighlightBox,this.previousSelected);}},unrender:function(){storeSession.call(this);this.disableGlobalDismiss();var $DAE=mstrmojo.dom.attachEvent,$DDE=mstrmojo.dom.detachEvent,TOUCHSTART=mstrmojo.dom.TOUCHSTART;$DDE(this._tn,TOUCHSTART,this._tsCallback);if(this.infoBox&&this.infoBox.parentNode&&this.infoBox.parentNode.parentNode){this.infoBox.parentNode.parentNode.removeChild(this.infoBox.parentNode);}delete this.infoBox;if(this._super){this._super();}},getFirstInfowindow:function getFirstInfowindow(){var me=this,model=me.model,xtabModel=me.xtabModel,docModel=(xtabModel&&xtabModel.docModel),row=model&&model.gts&&model.gts.row,tks;if(row&&row.length>0){tks=row[0]&&row[0].sc&&row[0].sc.tks;}if(docModel&&tks){ifws=docModel.getTargetInfoWin(tks);if(ifws&&ifws.length){var ifwunit=docModel.infoWinByKey[ifws[0]];var id=ifwunit&&(ifwunit.id+"_ifw");return mstrmojo.all[id];}}},isInfoWindowDisplayed:function(){var ifw=this.getFirstInfowindow();if(ifw){ifw=ifw.domNode;}if(!ifw){return false;}if(ifw.style.display=="block"){return true;}else{return false;}},globalListener:function(){var that=window.heatMap;if(!that){return ;}that.hideInfoBox();if(!that.selectAll){that.doSelection(that.previousSelected);}},addGlobalListener:function(){window.heatMap=this;var p=document.getElementsByClassName("mstrmojo-DocLayoutViewer-layout")[0];if(p){p.addEventListener(mstrmojo.dom.TOUCHSTART,window.heatMap.globalListener,false);}},removeGlobalListener:function(){var p=document.getElementsByClassName("mstrmojo-DocumentView")[0];if(p){p.removeEventListener("click",this.globalListener,false);}delete window.heatMap;},addCurtain:function(){var p=document.getElementsByClassName("mstrmojo-DocLayoutViewer-layout")[0];var div=document.createElement("div"),that=this;div.style.width=p.offsetWidth+"px";div.style.height=p.offsetHeight+"px";div.style.position="absolute";div.style.zIndex=-1;div.id=this.id+"curtain";div.onclick=this.globalListener;p.appendChild(div);},removeCurtain:function(){var div=document.getElementById(this.id+"curtain");if(div){div.parentNode.removeChild(div);}},renderErrorMessage:function renderErrorMessage(msg){var d=this.domNode,p=d.parentNode,div=document.createElement("div"),textDiv=document.createElement("div");if(d){div.style.width=d.offsetWidth-2+"px";div.style.height=d.offsetHeight-2+"px";div.style.left=d.offsetLeft+"px";div.style.top=d.offsetTop+"px";div.style.zIndex=this.zIndex;}else{div.style.width=parseInt(this.width)-2+"px";div.style.height=parseInt(this.height)-2+"px";div.style.left=this.left;div.style.top=this.top;div.style.zIndex=this.zIndex;}div.style.cssText+="background-color:#F5F5F2; position:absolute; display:-webkit-box; -webkit-box-pack:center; -webkit-box-align:center; -webkit-box-orient:vertical; border-style:solid; border-color:#A7A7A7; border-width:1px; ";textDiv.className="mstrmojo-message";textDiv.innerText=msg;div.appendChild(textDiv);if(d){p.replaceChild(div,d);}else{p.appendChild(div);}},convertDPI:function(props){if(typeof props!="object"){if(typeof props=="number"&&props%1==0){return adjustPixel.call(this,props);}else{return props;}}else{var ret={};for(var key in props){ret[key]=this.convertDPI(props[key]);}return ret;}},adjustLocalDPI:function(){this.LayoutProperties=this.convertDPI(LayoutProperties);this.LayoutProperties.LegendTickCount=5;this.LayoutProperties.LegendWidthPercent=0.9;this.LayoutProperties.LegendBandAspect=10;this.LayoutProperties.EditorDialogWidth=adjustPixel.call(this,565,true);this.LayoutProperties.EditorDialogHeight=adjustPixel.call(this,574,true);var h=document.body.offsetHeight,eh=this.LayoutProperties.EditorDialogHeight,sfh=h/eh,sf=1;if(sfh<1){sf=sfh;sf*=0.9;this.LayoutProperties.EditorDialogHeight=parseInt(eh*sf);}this.LayoutProperties.DeletedListHeight=adjustPixel.call(this,500*sf,true);this.LayoutProperties.EditButtonWidth=adjustPixel.call(this,60);this.LayoutProperties.EditButtonHeight=adjustPixel.call(this,40);this.LayoutProperties.EditButtonRight=adjustPixel.call(this,10);},onorientationChange:function(){if(this.editorDialog){var domNode=this.editorDialog.domNode;if(domNode&&domNode.firstChild){var d=domNode.firstChild,t=d.firstChild.firstChild;d.style.marginTop=parseInt((document.body.offsetHeight-this.LayoutProperties.DeletedListHeight-t.offsetHeight)/2)+"px";}}},loadDefinedFormat:function(){if(this.defn&&this.defn.fmts){var fmts=this.defn.fmts,pWidgetHeight=fmts&&fmts.p_fmts&&fmts.p_fmts.height;if(fmts.height){this.height=fmts.height;}if(!this.isFullScreenWidget){if(fmts.width){this.width=fmts.width;}}if(fmts["z-index"]){this.zIndex=fmts["z-index"];}}},checkErrors:function(){var err=this.error;if(err){this.renderErrorMessage(err);return true;}if(!this.model){this.renderErrorMessage(mstrmojo.desc(8426,"No model provided"));return true;}var err=this.model.err||this.model.eg;if(err){this.renderErrorMessage(err);return true;}return false;},setupScroller:function(){var sclConfig=this.scrollerConfig;sclConfig.scrollEl=this.scrollNode;sclConfig.offset.x.start=0;sclConfig.offset.x.end=this.heatMapSize.w*(this.scaleFactor-1);sclConfig.offset.y.start=0;sclConfig.offset.y.end=this.heatMapSize.h*(this.scaleFactor-1);if(sclConfig.origin.x>sclConfig.offset.x.end){sclConfig.origin.x=sclConfig.offset.x.end;}if(sclConfig.origin.y>sclConfig.offset.y.end){sclConfig.origin.y=sclConfig.offset.y.end;}},refreshLabelInTree:function(){var getLabel=function(e,idx){if(e==this.root){return ;}var text=this.getLabelForEntity(e);e.text=text;e.idx=idx;};this.dfs(this.root,getLabel,"");},refreshColorInTree:function(){var paintColor=function(e){if(e.EntityChildren||e==this.root){return ;}var color=getCSSColor(this.colorTheme.getColor(getColorValue(e,this)));e.color=color;};this.dfs(this.root,paintColor,"");},dfs:function(root,f,indexString){if(root.deleted){return ;}if(indexString===undefined){f.call(this,root);}else{f.call(this,root,indexString);}if(root.entityChildren===undefined){return ;}var arr=root.entityChildren,l=arr.length;for(var i=0;i<l;i++){var e=arr[i];if(indexString===undefined){this.dfs(e,f);}else{var param=indexString;if(!param){param=i.toString();}else{param=param+":"+i;}this.dfs(e,f,param);}}},traverseBFS:function traverse(){var heatMap=this,canvas=this.textCanvas,renderText=function(e,indexString){},terminate=function(level){var lv=level-heatMap.levelToShowText;if(lv>=3){return false;}return true;};},initCanvas:function(){this.refreshColorInTree();this.refreshLabelInTree();var props={colorTheme:this.colorTheme,placeholder:this.canvas,root:this.root,width:this.heatMapSize.w,height:this.heatMapSize.h,scale:this.scaleFactor,attributes:this.levelAttributes,showMetric:this.props.showMetricValues,labelSetting:this.props.labelSize};this.canvasObject=new mstrmojo.VisHeatMapCanvas(props);this.canvasObject.render();this.canvasObject.updateOffsets(this._scroller.origin.x,this._scroller.origin.y);this.canvas=this.canvasObject.domNode;},renderRectangles:function(){this.refreshColorInTree();this.refreshLabelInTree();this.canvasObject.scale=this.scaleFactor;this.canvasObject.offsetX=this._scroller.origin.x;this.canvasObject.offsetY=this._scroller.origin.y;this.canvasObject.draw();},renderLegend:function renderLegend(){if(this.props.showLegend==false){this.editorButton.style.height="";this.editorButton.style.width="";this.editorButton.style.right="";this.editorButton.style.bottom="";this.editorButton.className="heatmap-editor-legend-unshown";this.editorButton.innerHTML="";this.editorButton.style.top="";this.sizeLegend.style.display="none";this.colorLegend.style.display="none";this.legend.style.left="";this.legend.style.top="";this.legend.style.right="0px";this.legend.style.bottom="0px";this.legend.style.zIndex="100";return ;}var el=mstrmojo.desc(11158,"EDIT"),rsl=mstrmojo.desc(10079,"Rectangle Size"),rcl=mstrmojo.desc(10080,"Rectangle Color");this.editorButton.className="heatmap-editor-button";this.editorButton.innerHTML=el;var w=parseInt(this.width),h=parseInt(this.height),canvasHeight=this.heatMapSize.h,computedStyle=window.getComputedStyle(this.editorButton,null),editorButtonHeight=parseInt(computedStyle.height),editorButtonWidth=parseInt(computedStyle.width),legendHeight=this.legendSize.h,legendWidth=this.legendSize.w-editorButtonWidth-parseInt(computedStyle.right),sfs=this.getFormatString(this.sizeMetricIndex);this.legend.style.top=this.heatMapSize.h+2*this.LayoutProperties.Padding+"px";this.editorButton.style.top=((legendHeight-editorButtonHeight)>>1)+"px";this.editorButton.style.bottom="";if(this.props.showEditor){legendWidth-=this.LayoutProperties.LegendMenuEditorWidth;}var sizeT={w:0,h:0},sizeL={w:0,h:0},sizeSize={w:0,h:0},tickCount,padding,bandWidth,bandHeight;if(this.props.sizeMetricEnabled){var sizeTitle="<span style='font-weight: bold'>"+rsl+":</span>";var vld=this.checkMetricValid(this.sizeMetricIndex),mn=this.getMetricName(this.sizeMetricIndex);if(this.hasNegativeSizeValue){mn="Absolute value of "+mn;}if(isNaN(this.smin)){this.smin=0;}if(isNaN(this.smax)){this.smax=0;}var sizeLabel="<div>"+(vld?this.nf.formatByMask(sfs,this.smin):"0")+" < </div><div class='heatmap-flex'>"+mn+"</div><div> < "+(vld?this.nf.formatByMask(sfs,this.smax):"0")+"</div>";this.sizeLegendTitle.innerHTML=sizeTitle;this.sizeLegendLabel.innerHTML=sizeLabel;sizeSize={w:Math.max(this.sizeLegendTitle.offsetWidth,this.sizeLegendLabel.offsetWidth),h:this.sizeLegendTitle.offsetHeight};}else{this.sizeLegend.style.display="none";}if(this.props.colorMetricEnabled){var colorTitle;if(this.props.sizeMetricEnabled){colorTitle=rcl+": <span style='font-weight:normal;'>"+this.getMetricName(this.colorMetricIndex)+"</span>";}else{colorTitle="<span style='font-weight:bold'>"+this.getMetricName(this.colorMetricIndex)+"</span>";}tickCount=this.LayoutProperties.LegendTickCount;if(isNaN(this.cmin)||this.cmin>=this.cmax){tickCount=1;}this.legendTickCount=tickCount;bandWidth=Math.min(this.LayoutProperties.LegendMaxBandWidth,this.LayoutProperties.LegendWidthPercent*(legendWidth-sizeSize.w));padding=Math.floor((legendWidth-sizeSize.w-bandWidth)/3);var pd=this.renderTickLabels(bandWidth,tableHeight,tickCount);if(padding>=this.LayoutProperties.LegendMinPadding+pd.l+pd.r){bandWidth+=pd.l+pd.r;padding-=((pd.l+pd.r)>>1);}else{if(padding<this.LayoutProperties.LegendMinPadding){padding=this.LayoutProperties.LegendMinPadding;var temp=((legendWidth-3*padding)>>1);if(temp>sizeSize.w){bandWidth=legendWidth-3*padding-sizeSize.w;}else{sizeSize.w=temp;bandWidth=sizeSize.w;}}}bandHeight=Math.min(Math.floor(bandWidth/this.LayoutProperties.LegendBandAspect),Math.floor(legendHeight/3))-this.LayoutProperties.LegendBottomPadding;this.colorLegend.style.display="";this.colorLegendTitle.innerHTML=colorTitle;}else{padding=((legendWidth-sizeSize.w)>>1);this.colorLegend.style.display="none";}if(this.props.sizeMetricEnabled){this.sizeLegend.style.left=padding+"px";this.sizeLegend.style.width=sizeSize.w+this.LayoutProperties.LegendGutter+2*this.LayoutProperties.Padding+"px";this.sizeLegend.style.height=legendHeight+"px";}else{this.sizeLegend.style.left="0px";this.sizeLegend.style.width="0px";this.sizeLegend.top="0px";this.sizeLegend.style.height="0px";this.sizeLegendLabel.style.marginTop="0px";padding=((legendWidth-bandWidth)>>1);}if(this.props.colorMetricEnabled){if(this.props.sizeMetricEnabled){this.colorLegend.style.left=sizeSize.w+2*padding+"px";}else{this.colorLegend.style.left=sizeSize.w+padding+"px";}this.colorLegend.style.width=bandWidth+"px";this.colorLegend.style.height=legendHeight+"px";sizeT={w:this.colorLegendTitle.offsetWidth,h:this.colorLegendTitle.offsetHeight};var tableHeight=legendHeight-bandHeight-sizeT.h-2*this.LayoutProperties.LegendBottomPadding;this.colorLegendLabel.style.width=bandWidth+"px";this.colorLegendLabel.style.height=tableHeight+"px";this.colorLegendBand.width=bandWidth;this.colorLegendBand.height=bandHeight+10;var pd=this.renderTickLabels(bandWidth,tableHeight,tickCount);this.colorTheme.tooltipInfo=null;this.legendBand={x:pd.l,y:0,w:bandWidth-pd.r-pd.l,h:bandHeight};this.colorLegendBand.parentNode.style.width=bandWidth+"px";this.colorLegendBand.parentNode.style.height=bandHeight+"px";this.renderGradientBand(this.legendBand);}},renderTickLabels:function renderLabel(w,h,t){var count=t+1;var p=this.colorLegendLabel.firstChild.firstChild,nodes=p.childNodes,curCount=nodes.length,lastNode=p.lastChild,diff=curCount-count,cfs=this.getFormatString(this.colorMetricIndex);lastNode.style.display="";lastNode.style.width="";lastNode.style.textAlign="center";if(diff<0){for(var i=0;i<Math.abs(diff);i++){var node=lastNode.cloneNode(true);p.insertBefore(node,lastNode.nextSibling);lastNode=node;}}else{for(var i=0;i<diff;i++){if(t==0&&i==diff-1){lastNode.style.display="none";break;}p.removeChild(p.lastChild);}}p.firstChild.style.textAlign="left";p.lastChild.style.textAlign="right";var valid=true;if(isNaN(this.cmax)||isNaN(this.cmin)){valid=false;}for(var i=0;i<count;i++){node=nodes[i];var v="Null";if(valid){v=getNumberForTick.call(this,i);}node.innerHTML='<div style="display: inline-block; overflow: hidden; text-overflow: ellipsis; max-width: 100%; white-space: nowrap;">'+this.nf.formatByMask(cfs,v)+"</div>";if(this.props.legendRounded){}}var firstV=p.firstChild.innerHTML,lastV=p.lastChild.innerHTML,fSize={w:p.firstChild.firstChild.offsetWidth,h:p.firstChild.firstChild.offsetHeight};lSize={w:p.lastChild.firstChild.offsetWidth,h:p.lastChild.firstChild.offsetHeight};left=Math.min(w/count,fSize.w)>>1,right=Math.min(w/count,lSize.w)>>1;return{l:left,r:right};},renderGradientBand:function renderBand(frame){var x=frame.x,y=frame.y,w=frame.w,h=frame.h,ctx=this.colorLegendBand.getContext("2d");ctx.clearRect(x,y,w+2,h);var lingrad=ctx.createLinearGradient(x,y,w+x,y);lingrad.addColorStop(0,"#333333");var gradientInfo=this.colorTheme.getGradientFillInfo(this.cmin,this.cmax);var c=gradientInfo.c,r=gradientInfo.r,l=c.length;for(var i=0;i<l;i++){lingrad.addColorStop(roundNumber(r[i],2),getCSSColor(c[i]));}ctx.fillStyle=lingrad;createPath(x,y,w,h,0,ctx);ctx.fill();},renderHilightedBand:function renderHighlightedBand(i){var frame=this.legendBand,info=this.colorTheme.tooltipInfo[i],x=frame.x,y=frame.y,w=frame.w,h=frame.h,ctx=this.colorLegendBand.getContext("2d");this.renderGradientBand(frame);this.selectedBandIndex=i;ctx.strokeStyle="#FFFFFF";ctx.lineWidth=2;ctx.strokeRect(info.r.x+x+1,y+1,info.r.w-1,h-3);},getTextSize:function gts(str,fontName,fontSize,isBold,isItalic){this.textSpan.style="";this.textSpan.style.fontFamily=fontName;this.textSpan.style.fontSize=isNaN(fontSize)?fontSize:fontSize+"px";this.textSpan.style.fontWeight=isBold?"bold":"normal";this.textSpan.style.fontStyle=isItalic?"italic":"normal";this.textSpan.innerHTML=str;var w=this.textSpan.offsetWidth,h=this.textSpan.offsetHeight;return{w:w,h:h};},reRender:function reRender(){if(this.model.err||this.model.eg){return ;}if(this._super){this._super();}},useDefaultColorTheme:function(callback){var colorTheme=this.colorTheme,needsRefresh=false;if(colorTheme.useDefault==false){needsRefresh=true;colorTheme.isBlend=true;colorTheme.setDefaultDataProvider();}if(this.scaleFactor!=1){needsRefresh=true;this.scaleFactor=1;}function markUndelete(delDict){for(var key in delDict){var childDict=delDict[key];if(typeof childDict==="object"){if(Object.keys(childDict).length===0){delete delDict[key];}else{markUndelete(childDict);}}else{if(childDict===delStatus.dftDel){needsRefresh=true;delDict[key]=delStatus.dftUnDel;}else{if(childDict===delStatus.usrDel){needsRefresh=true;delete delDict[key];}}}}}markUndelete(this.props.deletedList);this.loadDeleteStatus(this.root,this.props.deletedList);if(needsRefresh){colorTheme.tooltipInfo=null;this.refreshWidget();}if(callback){callback();}},loadDeleteStatus:function(node,delDict){if(!node.entityChildren){if(delDict===delStatus.dftDel||delDict===delStatus.usrDel){node.deleted=true;}else{delete node.deleted;}return ;}if((!delDict||Object.keys(delDict).length===0)&&!node.hasChildDeleted){return ;}var children=node.entityChildren;for(var i=0;i<children.length;i++){var child=children[i];var name=this.getEntityDisplayName(child);var thisDict=delDict&&delDict[name];this.loadDeleteStatus(child,thisDict);}},useSavedColorTheme:function(callback){var colorTheme=this.colorTheme,needsRefresh=false;if(colorTheme.useDefault==true){needsRefresh=true;var propValue=this.model.vp;if(propValue){colorTheme.isBlend=((propValue.blc===undefined||propValue.blc=="true")?true:false);}if(propValue.gradientColors&&propValue.bandColors){colorTheme.createDataProviderFromString(propValue.gradientColors,propValue.bandColors);}colorTheme.useDefault=false;}if(this.scaleFactor!=1){needsRefresh=true;this.scaleFactor=1;}function markDelete(delDict){for(var key in delDict){var childDict=delDict[key];if(typeof childDict==="object"){if(Object.keys(childDict).length===0){delete delDict[key];}else{markDelete(childDict);}}else{if(childDict===delStatus.dftUnDel){needsRefresh=true;delDict[key]=delStatus.dftDel;}else{if(childDict===delStatus.usrDel){needsRefresh=true;delete delDict[key];}}}}}markDelete(this.props.deletedList);this.loadDeleteStatus(this.root,this.props.deletedList);if(needsRefresh){colorTheme.tooltipInfo=null;this.refreshWidget();}if(callback){callback();}},getFormatString:function getFormatString(idx){var m=this.model,col=m.gvs.items[0]?m.gvs.items[0].items:[],cnt=col.length;if(idx>=0&&idx<cnt){var obj=col[idx];if(obj.formatstring!==undefined){return obj.formatstring.replace(/\'/g,'"');}return"";}return"";},checkMetricValid:function checkMetric(idx){var str="",m=this.model,col=m.ghs.chs.items,cnt=col.length,ml=col[0]?col[0].items.length:0,coln=m.gts.col;if(idx<0||idx>=ml){return false;}return true;},getMetricName:function getMetricName(idx){var str="",m=this.model,col=m.ghs.chs.items,cnt=col.length,coln=m.gts.col;if(!this.checkMetricValid(idx)){return Fake_Metric_ID;}for(var i=0;i<cnt;i++){var index=col[i].items[idx].idx;var name=coln[i].es[index].n;str+=name+" ";}return str.slice(0,str.length-1);},getEntityDisplayName:function getEntityDisplayName(e){var level=e.level,index=(e.index===undefined)?e.indices[0]:e.index,st=0,str="",ar=this.attSpan,rhs=this.model.ghs.rhs.items,rowHeaderData=rhs[index].items,att=this.model.gts.row[level];for(var i=0;i<level;i++){st+=ar[i];}str="";for(var i=st;i<st+ar[level];i++){var idx=rowHeaderData[i].idx;if(idx==-1){continue;}str+=att.es[idx].n+" ";}str=str.substring(0,str.length-1);return str;},previousTooltip:null,previousSelected:null,highlightEntity:function(box,entity){if(!entity||!box){return ;}var w=this.canvasContainer.offsetWidth,h=this.canvasContainer.offsetHeight,size=entity.size,origin=this._scroller.origin,border=this.highlightBoxWidth,widgetRect=mstrmojo.dom.position(this.canvasContainer,true);var container={x:origin.x,y:origin.y,w:w,h:h};var canvasRect={x:0,y:0,w:Math.ceil(this.heatMapSize.w*this.scaleFactor),h:Math.ceil(this.heatMapSize.h*this.scaleFactor)};var rect={x:size.x-border,y:size.y-border,w:size.w+2*border,h:size.h+2*border};var inters=rectIntersection(rect,canvasRect);if(box==this.highlightBox){inters=rectIntersection(inters,container);this.previousHighlighted=entity;}if(isNaN(inters.x)){return null;}inters.x+=(border-origin.x);inters.y+=(border-origin.y);inters.w-=2*border;inters.h-=2*border;if(box==this.highlightBox){box.style.left=inters.x-border+widgetRect.x+"px";box.style.top=inters.y-border+widgetRect.y+"px";inters.x+=widgetRect.x;inters.y+=widgetRect.y;}else{box.style.left=inters.x-border+"px";box.style.top=inters.y-border+"px";}box.style.width=inters.w+"px";box.style.height=inters.h+"px";box.style.display="block";return inters;},getLowestLevelRectangle:function(touch){target=document.elementFromPoint(touch.pageX,touch.pageY);var hiddenStack=[];while(!this.isLowestLevelRectangle(target)){target.style.display="none";hiddenStack.push(target);target=document.elementFromPoint(touch.pageX,touch.pageY);}while(hiddenStack.length){hiddenStack.pop().style.display="block";}return target;},getEntityByTouch:function(touch,getLowest){var entity=null;var pageX=touch.pageX,pageY=touch.pageY;console.log("#getEntityByTouch#pageX:"+pageX+" pageY:"+pageY);var target=document.elementFromPoint(pageX,pageY),backUps=[];if(!target){console.log("target is null! at elementFromPoint.");return null;}var lastLevel=target;while(!this.isRectangle(target)&&target!=this.domNode){backUps.push(target);target.style.visibility="hidden";target=document.elementFromPoint(pageX,pageY);if(!target||target==lastLevel){break;}lastLevel=target;}if(getLowest){lastLevel=target;while(target!=this.domNode&&target.tagName.toLowerCase()!="img"){backUps.push(target);target.style.visibility="hidden";target=document.elementFromPoint(pageX,pageY);if(!target||target==lastLevel){break;}lastLevel=target;}}var backLen=backUps.length;while(backUps.length>0){var node=backUps.pop();node.style.visibility="visible";}if(!target){console.log("target is null. At backups.");return null;}if(target!=this.domNode){if(target.getAttribute("idx")&&!getLowest){var entity=this.getIdxObjectByTarget(target);}else{var rectPosition=mstrmojo.dom.position(this.canvas,true),offsetX=pageX-rectPosition.x,offsetY=pageY-rectPosition.y;var position={x:offsetX,y:offsetY},entity=this.canvasObject.getEntity(position);}}else{}return entity;},getLabelForEntity:function(e){if(!this.props.showMetricValues||e.entityChildren!==undefined){return this.getEntityDisplayName(e);}var index=(e.index===undefined)?e.indices[0]:e.index,st="",si=this.sizeMetricIndex,ci=this.colorMetricIndex,mv=this.model.gvs.items,ml=mv[0].items.length,n,v,dn=this.getEntityDisplayName(e);st='<span style="font-weight:bold;">';if(dn!==""){st+=dn+"<br>";}if(si!=ml){if(e.entityChildren!==undefined||this.aggregated){var tmp=this.aggFunctions[si];v=getSizeValue(e,this);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=this.getFormatString(si);v=this.nf.formatByMask(fs,v);}}}else{v=mv[index].items[si].v;}if(v!==""){st+=v+"<br>";}}if(e.entityChildren===undefined&&ci!=ml&&si!=ci){if(e.entityChildren!==undefined||this.aggregated){var tmp=this.aggFunctions[ci];v=getColorValue(e,this);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=this.getFormatString(ci);v=this.nf.formatByMask(fs,v);}}}else{v=mv[index].items[ci].v;}if(v!==""){st+=v+"<br>";}}st+='</span><span style="font-weight:normal;">';for(var i=0;i<ml;i++){if(i==si){continue;}if(i==ci&&e.entityChildren===undefined&&si!=ci){continue;}if(e.entityChildren!==undefined||this.aggregated){var tmp=this.aggFunctions[i];n=tooltipMacro(n,tmp);v=getAggValue(e,i,this);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=this.getFormatString(i);v=this.nf.formatByMask(fs,v);}}}else{v=mv[index].items[i].v;}if(v!==""){st+=v;if(i!==ml-1){st+="<br>";}}}st+="</span>";return st;},multiTap:true,touchBegin:function(touch){},touchTap:function(touch){if(touch.count>=2){if(this.scaleFactor>1){this.scaleFactor=1;this._scroller.offset.x.start=0;this._scroller.offset.x.end=0;this._scroller.offset.y.start=0;this._scroller.offset.y.end=0;this._scroller.scrollTo(0,0,0);this.refreshWidget();}return ;}var target=touch.target;if(target==this.infoBoxPuppet){target=document.elementFromPoint(touch.pageX,touch.pageY);}if(this.touchLegendTooltipValid(touch)){this.showLegendTooltip(touch);}else{this.hideLegendTooltip();}switch(target){case this.editorButton:target.style.backgroundColor="rgba(51, 181, 229, 0.6)";var callback=function(){mstrmojo.VisHeatMapAnimation.animate(target,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};var that=this;setTimeout(function(){setTimeout(function(){try{that.popupEditor(target);}catch(e){}finally{callback();}},0);},0);return ;case this.deleteButton:if(this.previousTooltip){var delDict=this.props.deletedList;var delNode=this.previousTooltip;var keyStack=[];var tempNode=delNode;do{keyStack.push(this.getEntityDisplayName(tempNode));tempNode=tempNode.parentEntity;}while(tempNode.parentEntity);var parentDict,key;for(var i=keyStack.length-1;i>=0;i--){parentDict=delDict;key=keyStack.pop();var tempDict=delDict[key];if(!tempDict){delDict[key]={};tempDict=delDict[key];}delDict=tempDict;}this.deleteNode(delNode,delDict,parentDict,key);this.hideInfoBox();this.refreshWidget();var deleteTreeId=this.id+"-deleteTree";var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}}this.previousTooltip=null;break;case this.selectionHighlightBox:this.doSelection(this.previousSelected);break;case this.highlightBox:this.hideInfoBox();var entity=this.previousHighlighted;if(this.hasSelector){if(!this.previousHighlighted.entityChildren){this.doSelection(entity);}}else{if(this.hasLinkDrill){this.doLinkDrill(entity);}}break;default:if(this.isRectangle(target)){if(this.hasSelector){this.hideInfoBox();var entity=this.getEntityByTouch(touch,true);this.doSelection(entity);}else{if(this.hasLinkDrill){var entity=this.getEntityByTouch(touch);this.doLinkDrill(entity);}else{var entity=this.getEntityByTouch(touch);this.showInfoBox(entity);}}break;}else{if(target.parentNode==this.infoBox){this.hideInfoBox();}else{this.hideInfoBox();if(!this.selectAll){this.doSelection(this.previousSelected);}}}}},isRectangle:function(target){if(this.canvasObject.domNode==target.parentNode||(target.parentNode&&this.canvasObject.domNode==target.parentNode.parentNode)||target.tagName.toLowerCase()=="img"){return true;}else{return false;}},isLowestLevelRectangle:function(target){if(target.getAttribute&&target.getAttribute("idx")&&!(target.innerHTML)){return true;}else{return false;}},doLinkDrill:function(entity){if(!entity){return ;}var actionObj=this.getActionObj({entity:entity,type:HYPERLINK_ACTION});if(actionObj){this.highlightEntity(this.selectionHighlightBox,entity);this.performAction([actionObj]);}},getActionObj:function(actionInfo){if(!actionInfo){return null;}var actionType=actionInfo.type,entity=actionInfo.entity,actionObj=null;switch(actionType){case HYPERLINK_ACTION:var rowHeader=this.model.gts.row,rl=rowHeader.length,level=entity.level,attrIndex;for(var i=0;i<=level;i++){var attr=rowHeader[i];if(attr.lm){for(var j=0;j<attr.lm.length;j++){if(attr.lm[j].links){break;}}if(j!=attr.lm.length){attrIndex=i;break;}}}var rowIndex=(entity.index===undefined)?entity.indices[0]:entity.index,ghs=this.model.ghs;if(!isNaN(attrIndex)){var attr=this.model.gts.row[attrIndex];linkDrillNode={};linkDrillNode.titleInfo=attr;linkDrillNode._e=attr.es[ghs.rhs.items[rowIndex].items[attrIndex].idx];actionObj={at:actionType,k:this.getModelKey(),node:linkDrillNode};break;}index=this.firstColLinkDrillIndex;if(!isNaN(index)){var metricH=this.model.gts.col[0],metric=metricH.es[index],lm=metricH.lm[index];if(lm&&lm.links){linkDrillNode={};linkDrillNode.titleInfo=metricH;linkDrillNode.mix=index;actionObj={at:actionType,k:this.getModelKey(),node:linkDrillNode};}break;}break;case SELECTOR_ACTION:var entity=actionInfo.entity,anchor=actionInfo.anchor;if(!entity||!anchor){break;}if(entity){var m=this.model,rown=m.gts.row,rl=rown.length,rhs=m.ghs.rhs.items,index=(entity.index===undefined)?entity.indices[0]:entity.index,row=rhs[index].items,selectorObjects=[];for(var i=0;i<rl;i++){var att=rown[i],sc=att.sc;if(att.otp!=-1&&sc!==undefined){var ix=row[i].idx,elementId=att.es[ix].id,es=att.es[ix].n,eid;if(!elementId||elementId.substring(0,1)==="D"){continue;}if(sc.all!="false"&&sc.all!=false&&actionInfo.needSelectAll){eid=EID_SELECTALL;}else{eid=att.es[ix].id;}selectorObjects.push({sc:sc,es:es,eid:eid});}}actionObj={at:actionType,k:this.getModelKey(),scObjList:selectorObjects,anchor:anchor};}break;case INFOWINDOW_ACTION:var entity=actionInfo.entity,anchor=actionInfo.anchor;if(!entity||!anchor){break;}if(entity){var m=this.model,rown=m.gts.row,rl=rown.length,rhs=m.ghs.rhs.items,index=(entity.index===undefined)?entity.indices[0]:entity.index,row=rhs[index].items,selectorObjects=[];for(var i=0;i<rl;i++){var att=rown[i],sc=att.sc;if(att.otp!=-1&&sc!==undefined){var ix=row[i].idx,elementId=att.es[ix].id,es=att.es[ix].n,eid;if(!elementId||elementId.substring(0,1)==="D"){continue;}if(sc.all!="false"&&sc.all!=false&&actionInfo.needSelectAll){eid=EID_SELECTALL;}else{eid=att.es[ix].id;}selectorObjects.push({sc:sc,es:es,eid:eid});}}actionObj={at:actionType,k:this.getModelKey(),scObjList:selectorObjects,anchor:anchor};}break;default:break;}return actionObj;},getModelKey:function(){return this.model&&this.model.k;},deleteNode:function(node,delDict,parentDict,key){if(!(node.size&&node.size.w&&node.size.h)){return ;}if(!node.entityChildren){node.deleted=true;if(parentDict&&key){if(delDict===delStatus.dftUnDel||delDict===delStatus.dftDel){parentDict[key]=delStatus.dftDel;}else{parentDict[key]=delStatus.usrDel;}}return ;}else{parentDict=delDict;for(var index in node.entityChildren){var thisChild=node.entityChildren[index];key=this.getEntityDisplayName(thisChild);var thisDict=parentDict[key];if(!thisDict){parentDict[key]={};thisDict=parentDict[key];}this.deleteNode(thisChild,thisDict,parentDict,key);}}},toggleSelectAll:function(entity){var sc=this.model.gts.row[entity.level].sc;if((sc&&sc.all!="false"&&sc.all!=false)||!this.hasGridTarget){if(this.selectAll){this.selectAll=false;}else{this.selectAll=true;}return true;}return false;},doSelection:function(entity){if(!entity){return ;}if(entity==this.previousSelected){if(!this.toggleSelectAll(entity)){return ;}var anchor=this.selectionHighlightBox,actionInfo={entity:entity,type:SELECTOR_ACTION,needSelectAll:this.selectAll,anchor:anchor};actionObject=this.getActionObj(actionInfo);if(this.selectAll){this.selectionHighlightBox.style.display="none";delete actionObject.anchor;}else{this.highlightEntity(this.selectionHighlightBox,entity);}this.performAction([actionObject]);}else{this.selectAll=false;var anchor=this.selectionHighlightBox,actionInfo={entity:entity,type:SELECTOR_ACTION,needSelectAll:this.selectAll,anchor:anchor};this.previousSelected=entity;this.highlightEntity(this.selectionHighlightBox,entity);var actionObject=this.getActionObj(actionInfo);this.performAction([actionObject]);}},getObjectByIdx:function(idx){if(idx){var indexArray=idx.split(":");var obj=this.root;for(var i=0;i<indexArray.length;i++){obj=obj.entityChildren[indexArray[i]];}return obj;}return null;},toggleDeleteButton:function(){if(!this.infoBox){return ;}if(this.props.delButtonEnabled){this.deleteButton.style.display="none";this.props.delButtonEnabled=false;}else{this.deleteButton.style.display="block";this.props.delButtonEnabled=true;}},editorDialog:null,popupEditor:function(anchor){this.hideInfoBox();var heatmapId=this.id;var deleteTreeId=heatmapId+"-deleteTree";var editorId=heatmapId+"-editor";var that=this;var defaultSelectionStatus=0;if(this.props.delButtonEnabled){defaultSelectionStatus=1;}var strSettings=mstrmojo.desc(7831,"Settings"),strDeletedItems=mstrmojo.desc(10081,"Deleted Items"),strRefresh=mstrmojo.desc(10378,"REFRESH"),strRTSC=mstrmojo.desc(10082,"Refresh to saved configuration"),strRTDC=mstrmojo.desc(10083,"Refresh to default configuration"),strApply=mstrmojo.desc(10379,"APPLY"),strDelete=mstrmojo.desc(10380,"DELETE"),strEnableDelete=mstrmojo.desc(10085,"Enable Delete"),strRestore=mstrmojo.desc(10084,"Please select elements that you want to restore"),strButtonCancel=mstrmojo.desc(221,"Cancel"),strButtonApply=mstrmojo.desc(134,"Apply");var prop={anchor:this.editorButton,title:"Heat Map",id:editorId,anchorOrientation:"h",width:this.LayoutProperties.EditorDialogWidth+"px",contentMaxHeight:this.LayoutProperties.DeletedListHeight,panels:[{title:strSettings,scriptClass:"mstrmojo.VisHeatMapPopupPanel",width:"100%",height:"100%",children:[{scriptClass:"mstrmojo.Label",text:strRefresh,cssDisplay:"-webkit-box",cssClass:"heatmap-gray-label"},{scriptClass:"mstrmojo.VisHeatMapTree",showIndicators:false,isSelectable:false,cssClass:"simple-tree",cssText:"padding-left:15px;padding-right:15px;",buttonNodeCss:"",items:[{n:strRTSC,buttonNodeWidget:{scriptClass:"mstrmojo.Button",text:strApply,cssClass:"heatmap-apply-button",onclick:function(){that.isUsingSavedColorTheme=true;that.isUsingDefaultColorTheme=false;var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();that.hideLegendTooltip();that._scroller.offset.x.start=0;that._scroller.offset.x.end=0;that._scroller.offset.y.start=0;that._scroller.offset.y.end=0;that._scroller.scrollTo(0,0,0);var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){that.useSavedColorTheme(callback);var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}},0);},0);}}},{n:strRTDC,buttonNodeWidget:{scriptClass:"mstrmojo.Button",text:strApply,cssClass:"heatmap-apply-button",onclick:function(){that.isUsingSavedColorTheme=false;that.isUsingDefaultColorTheme=true;var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();that.hideLegendTooltip();that._scroller.offset.x.start=0;that._scroller.offset.x.end=0;that._scroller.offset.y.start=0;that._scroller.offset.y.end=0;that._scroller.scrollTo(0,0,0);var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){that.useDefaultColorTheme(callback);var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}},0);},0);}}}]},{scriptClass:"mstrmojo.Label",text:strDelete,cssDisplay:"-webkit-box",cssClass:"heatmap-gray-label"},{scriptClass:"mstrmojo.VisHeatMapTree",isSelectable:true,cssClass:"simple-tree",cssText:"margin-left:15px;margin-right:15px;",showIndicators:false,defaultSelectionStatus:defaultSelectionStatus,items:[{n:strEnableDelete,itemFunction:function(){that.toggleDeleteButton();}}]},]},{title:strDeletedItems,scriptClass:"mstrmojo.VisHeatMapPopupPanel",cssText:"position: relative",width:"100%",naviAction:function(){var object=mstrmojo.all[deleteTreeId];if(object){object.refresh();}},children:[{scriptClass:"mstrmojo.Box",cssText:"padding-left:16px;padding-right:16px; maxHeight:"+parseInt(this.LayoutProperties.DeletedListHeight*0.89)+"px",children:[{scriptClass:"mstrmojo.VisHeatMapTree",height:"100%",heightLimit:parseInt(this.LayoutProperties.DeletedListHeight*0.89),showIndicators:true,showScrollbars:true,id:deleteTreeId,itemDisplayField:"label",itemChildrenField:"entityChildren",draggable:true,showRoot:true,rootText:strRestore,itemIncludeFunction:function(item){if(item&&(item.deleted||item.hasChildDeleted)){return true;}else{return false;}},apply:function(callback){var itemFunction=function(){if(this.selectionStatus===1&&this.dataProvider&&this.dataProvider.deleted){this.dataProvider.deleted=false;var tempNode=this.dataProvider;if(!tempNode.entityChildren){var keyStack=[];while(tempNode.parentEntity){keyStack.push(that.getEntityDisplayName(tempNode));tempNode=tempNode.parentEntity;}var delDict=that.props.deletedList;while(keyStack.length>1){delDict=delDict[keyStack.pop()];}var key=keyStack.pop();if(delDict[key]===delStatus.dftDel){delDict[key]=delStatus.dftUnDel;}else{delete delDict[key];}}}};var iterator=function(item,itemFunction){itemFunction.apply(item);if(!item.childTree){return ;}for(var i=0;i<item.childTree.length;i++){var subItem=item.childTree[i];iterator(subItem,itemFunction);}};iterator(this,itemFunction);that.refreshWidget();var tree=this;window.setTimeout(function(){tree.needRefresh=true;tree.refresh();if(callback){callback();}},50);},dataProvider:that.root,owner:that}]},{scriptClass:"mstrmojo.Box",cssText:"background-color:whiteSmoke; position:relative; bottom:0px;font:12pt Roboto,Regular;text-align:center;vertical-align:middle;line-height:55px;border-top: 1px solid rgba(34, 34, 34, 0.18);",height:parseInt(this.LayoutProperties.DeletedListHeight*0.11)+"px",width:"100%",children:[{scriptClass:"mstrmojo.Button",text:strButtonCancel,cssClass:"heatmap-tree-button",cssDisplay:"inline-block",cssText:"border-right: 1px solid rgba(34, 34, 34, 0.18); position: absolute; left:0px; top: 0px; height:100%;",width:"49.5%",onclick:function(){var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});setTimeout(function(){mstrmojo.all[editorId].close();},100);}},{scriptClass:"mstrmojo.Button",text:strButtonApply,cssClass:"heatmap-tree-button",cssDisplay:"inline-block",cssText:"position: absolute; right:0px; top:0px; height: 100%",width:"50.5%",postBuildRendering:function(){mstrmojo.all[deleteTreeId].register(this);},notify:function(enabled){this.set("enabled",enabled);},onclick:function(){var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){mstrmojo.all[deleteTreeId].apply(callback);},0);},0);}}]}]}]};this.editorDialog=mstrApp.showDialog(prop,"HeatMapEditor");},showWaitIcon:function(delay){var w=this.waitIcon;w.style.display="-webkit-box";w.style.left="0px";w.style.top="0px";},hideWaitIcon:function(){var w=this.waitIcon;w.style.left="-100000px";w.style.top="-100000px";},clearChildren:function(node){var firstChild;if(!node){return ;}while(firstChild=node.firstChild){node.removeChild(firstChild);}},calculateValuesInTree:function(){var ml=this.model.gvs.items[0]?this.model.gvs.items[0].items.length:0;clearMaxMinValues.call(this);setShow(false,false,true,true,this.root,this,ml+1);},refreshWidget:function(){this.showWaitIcon();var that=this;var refresh=function(){that.calculateValuesInTree();getLegendMaxMin.call(that);layoutEntities.call(that);that.renderRectangles();that.renderLegend();var ps=that.previousSelected;if(ps){if(ps.deleted){that.selectionHighlightBox.style.display="none";}else{if(!that.selectAll){that.highlightEntity(that.selectionHighlightBox,that.previousSelected);}}}that.hideWaitIcon();};window.setTimeout(refresh,10);},hideInfoBox:function(){if(!this.infoBox){return ;}this.infoBox.style.zIndex="-50";this.infoBox.style.opacity=0;this.previousTooltip=null;},getIdxObjectByTarget:function(target){var ancestor=mstrmojo.dom.findAncestorByAttr(target,"idx",true,this.domNode);var idx=ancestor&&ancestor.value;if(!idx){return null;}var idxObject=this.getObjectByIdx(idx);return idxObject;},showInfoBox:function(entity){if(!entity){return ;}if(!this.infoBox){this.createInfoBox();}var idxObject=entity;if(idxObject===this.previousTooltip){return ;}this.previousTooltip=idxObject;if(this.infoBox.style.display!="block"){this.infoBox.style.display="block";}this.infoBox.style.zIndex="75";this.infoBox.style.opacity=1;var hBoxWidth=this.highlightBoxWidth,domRect=mstrmojo.dom.position(document.body,true),interRect=this.highlightEntity(this.highlightBox,idxObject);if(!interRect||isNaN(interRect.x)){return ;}this.deleteButton.style.left=interRect.x+"px";this.deleteButton.style.top=interRect.y+"px";this.tooltipBox.style.width="";this.tooltipBox.innerHTML=getTooltip(idxObject,this);var anchorBox={x:interRect.x-hBoxWidth,y:interRect.y-hBoxWidth,w:interRect.w+hBoxWidth*2,h:interRect.h+hBoxWidth*2};this.triBox.style.display="block";var anchorCenterX=anchorBox.x+(anchorBox.w>>1);var anchorCenterY=anchorBox.y+(anchorBox.h>>1);var triSize=this.triBox.offsetWidth*0.717;var cNodes=this.tooltipBox.childNodes,len=cNodes.length;for(var i=0;i<len;i++){var cInline=cNodes[i].childNodes;if(cInline[0].offsetWidth+cInline[1].offsetWidth+cInline[2].offsetWidth>cNodes[i].offsetWidth){cInline[0].className+=" heatmap-half-width";}}var tHeight=this.tooltipBox.offsetHeight;var tWidth=this.tooltipBox.offsetWidth;var matched=false;var xFit=((anchorCenterX-(tWidth>>1))>0)&&(anchorCenterX+(tWidth>>1))<(domRect.w);var yFit=((anchorCenterY-(tHeight>>1))>0)&&(anchorCenterY+(tHeight>>1))<(domRect.h);var canShiftPadding=10;function calcPosition(triBox,tooltipBox,deleteButton,canShift){if(canShift===undefined){canShift=false;}if(!matched&&(canShift||yFit)){if(anchorBox.x-triSize-tWidth>=0){matched=true;triBox.style.left=anchorBox.x-triSize+"px";tooltipBox.style.left=anchorBox.x-triSize-tWidth+"px";deleteButton.style.left=interRect.x+interRect.w+"px";}else{if(anchorBox.x+anchorBox.w+triSize+tWidth<=domRect.w){matched=true;triBox.style.left=anchorBox.x+anchorBox.w+triSize+"px";tooltipBox.style.left=anchorBox.x+anchorBox.w+triSize+"px";}}if(matched){var triTop=anchorCenterY;var tooltipTop=anchorCenterY-tHeight/2;if(canShift){if(tHeight+canShiftPadding*2>domRect.h){matched=false;}else{var upLimit=canShiftPadding;var downLimit=domRect.h-canShiftPadding-tHeight;if(tooltipTop<upLimit){tooltipTop=upLimit;}else{if(tooltipTop>downLimit){tooltipTop=downLimit;}}}}triBox.style.top=triTop+"px";tooltipBox.style.top=tooltipTop+"px";}}if(!matched&&(canShift||xFit)){if(anchorBox.y-triSize-tHeight>=0){matched=true;triBox.style.top=anchorBox.y-triSize+"px";tooltipBox.style.top=anchorBox.y-triSize-tHeight+"px";deleteButton.style.top=interRect.y+interRect.h+"px";}else{if(anchorBox.y+anchorBox.h+triSize+tHeight<=domRect.h){matched=true;triBox.style.top=anchorBox.y+anchorBox.h+triSize+"px";tooltipBox.style.top=anchorBox.y+anchorBox.h+triSize+"px";}}if(matched){var triLeft=anchorCenterX;var tooltipLeft=anchorCenterX-tWidth/2;if(canShift){if(tWidth+canShiftPadding*2>domRect.w){matched=false;}else{var leftLimit=canShiftPadding;var rightLimit=domRect.w-canShiftPadding-tWidth;if(tooltipLeft<leftLimit){tooltipLeft=leftLimit;}else{if(tooltipLeft>rightLimit){tooltipLeft=rightLimit;}}}}triBox.style.left=triLeft+"px";tooltipBox.style.left=tooltipLeft+"px";}}}calcPosition(this.triBox,this.tooltipBox,this.deleteButton,false);this.infoBox.style.display="block";if(!matched){anchorBox={x:anchorCenterX,y:anchorCenterY,w:0,h:0};this.triBox.style.display="none";triSize=0;calcPosition(this.triBox,this.tooltipBox,this.deleteButton,true);}if(!matched){this.triBox.style.display="none";this.tooltipBox.style.left=anchorCenterX-tWidth/2+"px";this.tooltipBox.style.top=anchorCenterY-tHeight/2+"px";}this.shadowBox.style.left=this.tooltipBox.style.left;this.shadowBox.style.top=this.tooltipBox.style.top;this.shadowBox.style.width=this.tooltipBox.offsetWidth+"px";this.shadowBox.style.height=this.tooltipBox.offsetHeight+"px";this.shelter.style.left=this.tooltipBox.style.left;this.shelter.style.top=this.tooltipBox.style.top;this.shelter.style.width=this.tooltipBox.offsetWidth+"px";this.shelter.style.height=this.tooltipBox.offsetHeight+"px";var span=this.tooltipBox.childNodes[0].childNodes[0];var style=window.getComputedStyle(span,null);},enableGlobalDismiss:function(){var touchManager=mstrmojo.touchManager;var heatMap=this;this._globalTouchListener=touchManager.attachEventListener("touchesBegin",this.id,function(evt){if(!evt||!evt.touch||!evt.touch.target){return ;}var target=evt.touch.target,backgroundDiv1=document.getElementsByClassName("mstrmojo-DocLayoutViewer-layout")[0],backgroundDiv2=document.getElementsByClassName("mstrmojo-DocSubsection")[0];if(heatMap.infoBoxPuppet!=target&&!mstrmojo.dom.contains(heatMap.infoBox,target,true)){heatMap.hideInfoBox();}if(target!=backgroundDiv1&&target!=backgroundDiv2){return ;}if(!this.selectAll){heatMap.doSelection(heatMap.previousSelected);}});},disableGlobalDismiss:function(){var touchManager=mstrmojo.touchManager;if(this._globalTouchListener){touchManager.detachEventListener(this._globalTouchListener);delete this._globalTouchListener;}},touchInfoBoxValid:function(touch){var taget=touch.target;if(target.id==this.id+"-infobox"){return true;}},touchLegendTooltipValid:function touchValid(touch){var target=touch.target;if(target.id!=this.id+"-color-legend-band"){return false;}var frame=mstrmojo.dom.position(target,true),x=touch.clientX-frame.x,y=touch.clientY-frame.y,p=this.legendBand;if(x<p.x||x>=p.x+p.w-1){return false;}return true;},showLegendTooltip:function(touch){var target=touch.target,frame=mstrmojo.dom.position(target,true),x=touch.clientX-frame.x,y=touch.clientY-frame.y,p=this.legendBand,idx;var ct=this.colorTheme;if(ct.tooltipInfo===undefined||ct.tooltipInfo===null){ct.createTooltipInfo(this.legendTickCount,p.w,this);this.selectedBandIndex=-1;}var i=ct.getTooltipInfo(x-p.x);if(i!=this.selectedBandIndex){this.renderHilightedBand(i);}var t=this.colorTheme.tooltipInfo[i],cfs=this.getFormatString(this.colorMetricIndex),mn=this.getMetricName(this.colorMetricIndex),sign=(t.sign===undefined)?" < ":" > ",str="<div>"+this.nf.formatByMask(cfs,t.sv)+sign+"</div><div class='heatmap-flex'>"+mn+"</div><div>"+sign+this.nf.formatByMask(cfs,t.ev)+"</div>";this.legendTooltip.innerHTML=str;this.legendTooltip.style.borderColor=getCSSColor(t.c);this.legendTooltip.style.lineHeight=this.legendTooltip.style.height;this.legendTooltip.style.display="-webkit-box";var size={w:this.legendTooltip.offsetWidth,h:this.legendTooltip.offsetHeight};var lc=mstrmojo.dom.position(this.colorLegend,true),cv=mstrmojo.dom.position(this.canvas,true),tx=t.r.x+((t.r.w-size.w)>>1);if(tx<0){tx=0;}else{if(tx>frame.w-size.w){tx=frame.w-size.w;}}this.legendTooltip.style.left=tx+"px";this.legendTooltip.style.top=-35+"px";},hideLegendTooltip:function(){if(this.selectedBandIndex===undefined||this.selectedBandIndex==-1){return ;}this.renderGradientBand(this.legendBand);this.selectedBandIndex=-1;this.legendTooltip.style.left="-100000px";},touchSelectBegin:function(touch){if(touch.evt.ctrlKey){this.touchMultiBegin(touch);return ;}var target=touch.target;if(!target){return ;}this.lastTouchSelectTarget=target;if(this.touchLegendTooltipValid(touch)){this.showLegendTooltip(touch);this.hideInfoBox();}else{this.hideLegendTooltip();var entity;if(this.infoWindowMode){entity=this.getEntityByTouch(touch,true);}else{entity=this.getEntityByTouch(touch);}if(!entity){return ;}if(this.timer){cleatTimeout(this.timer);this.timer=null;}if(this.infoWindowMode){this.doSelection(entity);}else{this.showInfoBox(entity);}}},touchSelectMove:function(touch){if(touch.evt.ctrlKey){this.touchMultiMove(touch);return ;}var target=touch.target;if(!target){return ;}if(this.touchLegendTooltipValid(touch)){this.showLegendTooltip(touch);this.hideInfoBox();}else{this.hideLegendTooltip();var entity;if(this.infoWindowMode){entity=this.getEntityByTouch(touch,true);}else{entity=this.getEntityByTouch(touch);}if(!entity){return ;}var that=this;if(this.timer){clearTimeout(this.timer);this.timer=null;}if(this.infoWindowMode){if(this.previousSelected!=entity){this.doSelection(entity);}}else{this.showInfoBox(entity);}}},touchSelectEnd:function(touch){if(touch.evt.ctrlKey){this.touchMultiEnd(touch);}return ;},initScroller:function(scroller){scroller.attachEventListener("scrollMoved",this.id,function(evt){this.hideInfoBox();});scroller.attachEventListener("scrollDone",this.id,function(evt){this.canvasObject.updateOffsets(scroller.origin.x,scroller.origin.y);});},multiTouch:true,touchMultiBegin:function(touch){this.hideLegendTooltip();this.hideInfoBox();var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:300,pageY:300};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;this.initDiffDiff=xDiff*xDiff+yDiff*yDiff;this.initCenterX=((touch1.pageX+touch2.pageX)>>1);this.initCenterY=((touch1.pageY+touch2.pageY)>>1);this.initScrollX=this._scroller.origin.x;this.initScrollY=this._scroller.origin.y;this.relScaleFactor=1;},touchMultiMove:function(touch){var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:300,pageY:300};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;var curDiffDiff=xDiff*xDiff+yDiff*yDiff;var curCenterX=((touch1.pageX+touch2.pageX)>>1);var curCenterY=((touch1.pageY+touch2.pageY)>>1);var scale=Math.sqrt(curDiffDiff/this.initDiffDiff);var offset={x:scale*(this.initCenterX+this.initScrollX)-curCenterX,y:scale*(this.initCenterY+this.initScrollY)-curCenterY};var transform={scale:scale,offset:offset};this.relScaleFactor=scale;if(this.relScaleFactor*this.scaleFactor>=this.maxScale&&!this.oldTransform){this.oldTransform=transform;}this.applyTransform(transform);},touchMultiEnd:function(touch){var finalScale=this.relScaleFactor*this.scaleFactor;if(finalScale<1){var initTransform={offset:{x:0,y:0},scale:1/this.scaleFactor};this.relScaleFactor=initTransform.scale;this.applyTransform(initTransform,500,this.postScale);}else{if(finalScale>this.maxScale){this.relScaleFactor=this.maxScale/this.scaleFactor;this.applyTransform(this.oldTransform,500,this.postScale);delete this.oldTransform;}else{this.postScale();}}},relScaleFactor:1,scaleFactor:1,applyTransform:function(transform,duration,callback){var scl=this._scroller;if(duration===undefined){duration=0;}scl.scrollEl.style.webkitTransformOrigin="left top";scl.transform="scale("+transform.scale+","+transform.scale+")";var scrollX=transform.offset.x,scrollY=transform.offset.y,scrollerOffsetScale=this.scaleFactor*this.relScaleFactor-1,vOffsetEnd=this.heatMapSize.h*scrollerOffsetScale,hOffsetEnd=this.heatMapSize.w*scrollerOffsetScale;scl.offset={y:{start:0,end:vOffsetEnd},x:{start:0,end:hOffsetEnd}};this._scroller.scrollTo(scrollX,scrollY,duration);if(callback){var that=this;setTimeout(function(){callback.apply(that);that=null;},duration);}},postScale:function(){delete this._scroller.transform;this._scroller.scrollTo(this._scroller.origin.x,this._scroller.origin.y,0);this.scaleFactor*=this.relScaleFactor;if(this.scaleFactor>this.maxScale){this.scaleFactor=this.maxScale;}this.refreshWidget();},destroy:function(skipCleanup){this._super(skipCleanup);if(this.editorDialog){this.editorDialog.destroy();delete this.editorDialog;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.MobileDocXtabGraph","mstrmojo.graph._CanvasGraph");mstrmojo.graph.MobileDocXtabCanvasGraph=mstrmojo.declare(mstrmojo.MobileDocXtabGraph,[mstrmojo.graph._CanvasGraph],{scriptClass:"mstrmojo.graph.MobileDocXtabCanvasGraph",update:function C(D){delete this.graphData;this._super(D);},setModel:function B(D){this.graphData=D.data;},retrieveGraphSrc:function A(F,D){if(!this.graphData){var H=this.id,E=this._super,G=this.model;if(parseInt(F,10)>0&&parseInt(D,10)>0){this.model.getDataService().getRWGraphImage({w:D,h:F,k:this.k,sid:this.node.data.sid},G.newCallback({success:function(I){var K=mstrmojo.all[H];if(!K){return ;}K.setModel({data:I});E.call(K,F,D);var J=K.parent;if(J&&J.updateScroller){J.updateScroller();}}}));}}else{this._super(F,D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.LikertScaleDIC","mstrmojo.css");mstrmojo.android.inputControls.LikertScaleDIC=mstrmojo.declare(mstrmojo.LikertScaleDIC,null,{scriptClass:"mstrmojo.android.inputControls.LikertScaleDIC",lowestLabel:null,hightestLabel:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}<div class="label {@lowestClass}">{@lowestLabel}</div><div class="label {@hightestClass}">{@hightestLabel}</div></div></div>',init:function A(C){this._super(C);var B=this.titleItems&&this.titleItems.length,E=this.dic.mint&&B,D=this.dic.maxt&&B;this.lowestLabel=E?(this.titleItems[0]+": "+this.dic.mint):"";this.lowestClass=E?"":"hidden";this.hightestLabel=D?(this.titleItems[B-1]+": "+this.dic.maxt):"";this.hightestClass=D?"":"hidden";},getLeftEndTitle:function(B){return"";},getRightEndTitle:function(B){return"";},ontouchend:function(B){this.onclick(B);},setDirtyFlag:function(C,B){mstrmojo.css.addClass(this.itemsNode||B,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.RatingDIC","mstrmojo._TouchGestures");var C=mstrmojo.dom;mstrmojo.android.inputControls.RatingDIC=mstrmojo.declare(mstrmojo.RatingDIC,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.inputControls.RatingDIC",touchTap:function E(F){F.e=F.e||F.evt;this.onclick(F);},touchSwipeMove:function A(H){var G=document.elementFromPoint(H.pageX,H.pageY),F;if(C.contains(this.domNode,G)){F=G&&G.getAttribute("idx");if(F!=undefined){this.setRating(F);this.ratingSelectedValue=this.items[F].v;}}},touchSwipeEnd:function D(F){if(this.ratingSelectedValue!=undefined&&this.ratingSelectedValue!=this.value){this.set("value",this.ratingSelectedValue);}},setDirtyFlag:function B(G,F){mstrmojo.css.addClass(this.itemsNode||F,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.android.ui.CalendarMarkupBuilder","mstrmojo.ui.MobileCheckList","mstrmojo._TouchGestures","mstrmojo.android.Dialog");var B=mstrmojo.css,C="mstrmojo-CalDialog";mstrmojo.android.ui.CalendarDialog=mstrmojo.declare(mstrmojo.android.Dialog,null,{scriptClass:"mstrmojo.android.ui.CalendarDialog",markupBuilder:undefined,requiredOrientation:0,init:function(H){this._super(H);var I=this.calendar,F=this.popDimensions=this.getPopupDimensions(),G=this.requiredOrientation,J=mstrMobileApp.getLockedOrientation();if(G!==0&&G!==J){mstrMobileApp.lockOrientation(G);this._prevOr=J;}I.markupBuilder=this.markupBuilder;I.width=F.w+"px";I.height=F.h+"px";I.layoutConfig={h:{yearNode:"100px"},w:{yearNode:"100%"}};I.defaultCSS=this.cssClass;I.target=new mstrmojo.ui.MobileCheckList({alias:"contentList",cssDisplay:""});B.addWidgetCssClass(this,[C]);},getPopupDimensions:function E(){var F=mstrApp.getScreenDimensions();return{h:F.h*0.9,w:Math.min(F.w*0.85,720)};},getCancelBtnFn:function A(){var F=this.calendar.target,H=F.parent,G=F.getSelectedItems(),I=true;if(G&&G.length>0){F.set("items",[]);H.resizeDialog();I=false;}else{H.close();}return I;},close:function D(){this._super();var F=this._prevOr;if(F!==undefined){if(F===0){mstrMobileApp.releaseOrientation();}else{mstrMobileApp.lockOrientation(F);}delete this._prevOr;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.Dialog","mstrmojo.Button");mstrmojo.android.AndroidDICPopup=mstrmojo.declare(mstrmojo.android.Dialog,null,{scriptClass:"mstrmojo.AndroidDICPopup",cssClass:"mstrmojo-AndroidDICPopup",autoClose:false,fadeOnClose:false,init:function D(E){this._super(E);this.addChildren([this.widget]);},close:function C(){this.set("visible",false);if(this.widget.hasRendered){this.widget.unrender();}this.removeChildren(this.widget);this._super();},onpopupResized:function A(E){if(this.widget.onpopupResized){this.widget.onpopupResized(E);}},onkeyup:function B(F){var E=F.hWin,G=F.e||E.event;if(this.widget.applyOnEnter&&G.keyCode===13){this.onApply();}else{if(G.keyCode===27){this.onCancel();}}},onApply:function(){return this.widget.applyChanges();},onCancel:function(){this.widget.cancelChanges();},enableApply:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.Enum_Keys","mstrmojo.hash","mstrmojo.dom");var E=mstrmojo.dom,B=mstrmojo.Enum_Keys,H=200,M;var L={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var N="mstrmojo-SimpleObjectInputBox-del";function I(){var V=this.inputBox,W=V.value;if(W!==this._lastPattern){this.showSuggestion(W);}this._lastPattern=W;delete this._timerHandle;}function U(){var V=this._timerHandle;if(V){window.clearTimeout(V);delete this._timerHandle;}}function P(){var X=this.maxObjectCount,V=(this.items&&this.items.length)||0,W=(X!=null&&V>=X);this.set("state",!V?L.EMPTY:(W?L.FULL:L.DEFAULT));}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur style="display: none;" /></div><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@emptyText}</div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;},emptyTextNode:function(){return this.domNode.childNodes[1];},inputBox:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function Q(){var V=this.maxItemWidth;if(!isNaN(V)){V+="px";}this.emptyTextNode.style.maxWidth=V;}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,maxObjectCount:null,getItemMarkup:function(V){if(!M){var W=this.itemField;M=this._super(V).replace(">{@n}<",' title="{@'+W+'}"><div class="elem">{@'+W+'}<div class="'+N+'"></div></div><');}return M;},getItemProps:function R(Y,V){var W=this._super(Y,V),Z=this.itemField;W[Z]=Y[Z];var X=this.maxItemWidth;if(!isNaN(X)){X=(X-24)+"px";}W.addStyle("max-width:"+X);return W;},getSuggestionPos:function K(){var V=this._inputPos;return{target:this.inputBox,left:V.x,top:V.y+V.h,zIndex:100};},getSearchPattern:function T(){return this.inputBox.value;},onSuggestionItemSelect:function F(V){U.call(this);this.set("items",this.items.concat(V));this._super();var W=this.id;window.setTimeout(function(){var X=mstrmojo.all[W];if(X.state!=L.FULL){X.set("state",L.ADDING);}},0);},onstateChange:function A(W){var X=W.value;this.emptyTextNode.style.display=(X===L.EMPTY)?"block":"none";var V=this.inputBox,Y=V.style,Z=this.itemsContainerNode;if(X===L.ADDING){Y.display="";V.focus();this._inputPos=E.position(V,true);}else{U.call(this);Y.display="none";V.value="";this._lastPattern="";}},postBuildRendering:function O(){P.call(this);return this._super();},preitemsChange:function J(){P.call(this);},onclick:function S(W){var Z=E.eventTarget(W.hWin,W.e);if(Z&&Z.className===N){var Y=E.findAncestorByAttr(Z,"idx",true,this.domNode),V=Y&&parseInt(Y.value,10);if(V!==null&&!isNaN(V)){var X=this.items.concat();X.splice(V,1);this.set("items",X);}return ;}if(this.state!=L.FULL){this.set("state",L.ADDING);}},onblur:function D(){U.call(this);if(!this.suggestionShown){P.call(this);}},prekeydown:function C(V){var Y=V.e;switch(parseInt(Y.keyCode||Y.charCode,10)){case B.DOWN_ARROW:this.nextHighlight();break;case B.UP_ARROW:this.preHighlight();break;case B.TAB:case B.ENTER:E.preventDefault(V.hWin,Y);var X=this.getSelected();if(X){this.handleSuggestionItemSelect(X);}else{this.hideSuggestion();P.call(this);}break;case B.ESCAPE:U.call(this);this.hideSuggestion();P.call(this);break;case B.BACKSPACE:if(!this.getSearchPattern()){E.preventDefault(V.hWin,Y);var W=this.items&&this.items.concat();if(W&&W.length){W.splice(W.length-1,1);this.set("items",W);var Z=this.id;window.setTimeout(function(){mstrmojo.all[Z].set("state",L.ADDING);},0);}}break;}},prekeyup:function G(){if(this.useKeyDelay){var V=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){I.call(mstrmojo.all[V]);},H);}}else{I.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo.XtabZone","mstrmojo._TouchGestures","mstrmojo._HasXtabTouchScroll","mstrmojo._XtabSelections","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo._HasMagnifier","mstrmojo.XtabMagnifierHelper");var f=mstrmojo.css,F=mstrmojo.dom;var I=0;var V=1;var Q=2;var g=3;function R(j,k){f.toggleClass(j.firstChild,"tx-active",k);}function C(j){if(j){j.domNode.style.pointerEvents="auto";}}function N(){if(mstrMobileApp.isOnline()){return ;}var q=this.controller,AA,x,j,k,AD,o,p,w,s=[],l=[],AB;if(!q.getLinkRequest){return ;}for(AA in this.zones){if(AA==="_BL"||AA==="_BR"){x=this.zones[AA];j=x.getNodesByPositions(x.posMap);for(p=0;p<j.length;p++){k=j[p];AD=this.getCellForNode(k);if(AD&&AD.at&&(AD.at&4)){o=this.model.getAction(this.getActionCells(AD),null);if(o){w=o.a;AB=q.getLinkRequest(w);if(AB){s.push(AB);l.push(k);}}}}}}var t=s.length;if(t){var AC=function(AE){var z,AF;for(z=0;z<t;z++){AF=l[z];if(!AE[z]){AF.setAttribute("hl_d",true);f.addClass(AF,"hl_d");}}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(s,{success:AC,failure:mstrmojo.emptyFn});}}}function a(){if(mstrMobileApp.isOnline()){var p,j,k,o,l;for(p in this.zones){if(p==="_BL"||p==="_BR"){j=this.zones[p];k=j.getNodesByPositions(j.posMap);for(l=0;l<k.length;l++){o=k[l];o.removeAttribute("hl_d");f.removeClass(o,"hl_d");}}}}else{N.call(this);}}mstrmojo.MobileXtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._TouchGestures,mstrmojo._HasXtabTouchScroll,mstrmojo._XtabSelections,mstrmojo._HasMagnifier],{scriptClass:"mstrmojo.MobileXtab",frameRate:30,enableMagnifier:true,useSeamlessIncFetch:false,allowToggleSelections:true,markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";}},init:function X(j){this._super(j);this.magnifierHelper=new mstrmojo.XtabMagnifierHelper({xtab:this});this.disposables.push(this.magnifierHelper);},gridPagesRendered:function B(){this._super();N.call(this);},onRender:function G(){this._super();var j=this.interactiveCellsArray;if(j&&j.length>0&&this.controller.getLinkRequest){if(!this.subscr){var l=mstrmojo.publisher;this.subscr=l.subscribe(l.NO_SRC,l.CONNECTIVITY_CHANGED_EVENT,a,this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var k=this;window.setTimeout(function(){try{N.call(k);}catch(o){}},100);}}},unrender:function Z(){if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}this._super();},getDataService:function J(j){return this.model.getDataService();},setData:function E(j){this.set("gridData",j);},createZone:function D(j){j=j||{};var k=this.getDataService();j.imgCacheMap=(k&&k.imgCache)||this.imgCacheMap;j.unCachedMap={};return new mstrmojo.XtabZone(j);},showDownloadStatus:function b(){},onclick:mstrmojo.emptyFn,setupTNs:function O(){var k=this.contentNode,j=k.rows[1].cells[1].lastChild,l=0;switch(this.lockHeadersCase){case I:this._TSN.x=[j.lastChild.lastChild];this._TSN.y=[j.firstChild];break;case Q:this._TSN.x=[k];this._TSN.y=[j.firstChild];break;case V:this._TSN.x=[j];this._TSN.y=[k];l=-1;break;case g:this._TSN.x=[k.rows[0].cells[1].lastChild,j.firstChild];this._TSN.y=[k.rows[1]];l=2;break;}if(l){this._TSN.x[0].style.zIndex=l;}this.setOffsets();this.attachEventListener("scrolledOut",this.id,this.scrolledOut);},useDomToCalculateOffsets:function P(){return(this.lockHeadersCase===I||(this._super&&this._super()));},setOffsets:function d(){var AE=0,s=0;var t=this.lockHeadersCase;if(this.useDomToCalculateOffsets()){var k=this._TSN,AD=k.x[0],w=k.y[0];AE=AD.offsetLeft+AD.offsetWidth+(!!(t&V)?this._BL.offsetWidth:0);s=w.offsetTop+w.offsetHeight+(!!(t&Q)?this._TR.offsetHeight:0);}else{var l=this.zones,AA=(this.gridData.rh&&parseInt(this.gridData.rh,10))||0,x=l._TR?l._TR.cp.rc:0,AB=l._BR.cp.rc,o=l._BL?l._BL.totalColWidth:0,j=l._BR.totalColWidth;s=((t===V)?AB:x+AB)*AA;AE=(t===Q)?j:o+j;}var q=1,z=2,p=this.getGridDimension(z)||0,AC=this.getGridDimension(q)||0;this._TMAX={x:Math.min(p-AE,0),y:Math.min(AC-s,0)};if(this._super){this._super();}},touchTap:function Y(k){if(!this.magnifier){if(this._super){this._super();}if(this.performAction(k)===false){var j=this.controller;if(j&&j.viewTap){j.viewTap();}}}},performAction:function W(s){this.deselectCell();var q=F.findAncestorByAttr(s.target,"ei",true,this.domNode);if(!q||!q.value){return false;}var p=q.node,j=this.getCellForNode(p),o=j.at;if(this._super&&this._super(s)){return ;}if(!o){return false;}if((o&4)&&!p.getAttribute("hl_d")){var k=document.createElement("div"),l=k.style;id=this.id;k.className="activeLink on";l.left=p.offsetLeft+"px";l.top=p.offsetTop+"px";l.width=p.offsetWidth+"px";l.height=p.offsetHeight+"px";p.appendChild(k);window.setTimeout(function(){var t=mstrmojo.all[id];if(t&&t.hasRendered){F.attachOneTimeEvent(k,"webkitTransitionEnd",function(){p.removeChild(k);});f.removeClass(k,"on");}},200);}this.defaultAction(p);},selectCell:function L(j){var l=document.createElement("div"),k=l.style;l.className="overlay";k.top=j.offsetTop+"px";k.left=(j.offsetLeft+1)+"px";k.height=(j.clientHeight-2)+"px";k.width=(j.clientWidth-1)+"px";j.appendChild(l);},flagDirtyUnit:function h(j){R(j,true);},clearDirtyUnit:function M(j){R(j,false);},deselectCell:function U(){var j=this._selectedCell;if(j){j.removeChild(j.lastChild);delete this._selectedCell;}},touchSelectBegin:function A(l){if(this.enableMagnifier){var k=this.controller,j;if(k.getMagnifierConfig){j=k.getMagnifierConfig();}this.displayMagnifier(l,j);}},touchSelectMove:function H(k){if(this.enableMagnifier){var j=this;this.latestTouch=k;if(!this._moveMagnifierTimer){this._moveMagnifierTimer=setTimeout(function(){j.displayMagnifier(j.latestTouch);j._moveMagnifierTimer=null;},50);}}},touchSelectCancel:function T(j){C(this.magnifier);},touchSelectEnd:function S(j){C(this.magnifier);},getCaptureDimensions:function K(){var k=this.viewport,j=F.position(this.domNode,true);j.w=Math.min(k.offsetWidth,j.w);j.h=Math.min(k.offsetHeight,j.h);return j;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.RootController");mstrmojo.requiresDescs(8394);var A=mstrmojo.android.controllers.RootController.EnumHSType;mstrmojo.android.medium.controllers.RootController=mstrmojo.declare(mstrmojo.android.controllers.RootController,null,{scriptClass:"mstrmojo.android.medium.controllers.RootController",initHomeScreen:function H(J,K){switch(J){case A.DEFAULT:this.jumpTo({act:5,fromNav:true});this.initNav();break;case A.CUSTOM:this.spawn(mstrApp.controllerFactory.newController("HomeScreen",K));break;default:this._super(J,K);}},updateProperties:function G(J,K){this.updateContent(J,K);},updateFolder:function E(K,L,J){this.updateContent(K,L,J);},updateTransactions:function F(L,K,J){this.updateContent(L,K,J);},updateDisplayMessage:function B(J){this.updateContent(J);},closeTransactions:function C(J){if(!J){this.getCurrent().prevController.makeCurrent();}else{this.getCurrent().detach();}},updateItemProperties:function D(M,K,J,L){if(!K){return ;}mstrmojo.all[J].spawn(mstrApp.controllerFactory.newController("Properties"),{item:K,ctrlId:J,avail:L});},propogateMenuVisibleChange:function I(J){this.rootView.propogateMenuVisibleChange(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.android.controllers.SettingsController","mstrmojo.android._HasLingeringListSelections","mstrmojo.android.ui.Button","mstrmojo.ui.MobileCheckList","mstrmojo.android.ui.TextInput","mstrmojo.android.ui.ValidationTextInput","mstrmojo.expr","mstrmojo.array","mstrmojo.css");mstrmojo.requiresDescs(221,1442,7883,9454);var I=mstrmojo.android.controllers.SettingsController.STYLES,D=mstrmojo.android.ui.Button.newButton,M=mstrmojo.array,F=mstrmojo.validation,B=F.TRIGGER,A=F.STATUSCODE,E={},K=mstrmojo.dom,G=K.CSS3_TRANSITION_DURATION;mstrmojo.android.ui.SettingsView=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo.android._HasLingeringListSelections],{scriptClass:"mstrmojo.android.ui.SettingsView",init:function O(P){this._super(P);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-AndroidSettings");},allowTouchBubble:false,getList:function L(){return this;},listHooks:{select:function(Q,R,P){Q.style[G]=0;if(R.disabled){return true;}if(R.style!==I.VIEW_BUTTON){this.setClearHandler(200);}},unselect:function(Q,R,P){Q.style[G]="300ms";}},getItemMarkup:function(R){var Q=R.style;if(!E[Q]){var P="<div><h3>{@ttl}</h3><h4>{@value}</h4></div>";if(Q===I.TEXT_AREA){P='<div readonly="readonly">{@ttl}</div>';}else{if(Q===I.IMAGE){P="<h3></h3>";}}E[Q]=this._super(R).replace("{@n}",P);}return E[Q];},getItemProps:function N(U,Q){var V=U.v,T=this._super(U,Q);T.ttl=U.nm;T.value=V||"";var R=U.cls;if(R){T.addCls(R);}var P=function(){T.addCls("drop-down");if(U.pwd){T.value="********";}else{if(U.showHint&&V===""){T.value=mstrmojo.desc(9454,"&lt;not set&gt;");}}};switch(U.style){case I.TEXT_AREA:T.addCls("textarea");break;case I.HEADER:T.addCls("header");break;case I.TIME:T.value=new Date((U.v<60000)?U.v*60000:U.v).toJSON().replace(/.*T/,"").replace(/\.[0-9]{3}Z/,"");P();break;case I.NUMBER:case I.TEXT:P();break;case I.LIST:T.addCls("drop-down");var S=U.items;T.value=S[M.find(S,"v",V)].n;break;case I.CHECK:T.addCls("check");if(V===U.on){T.addCls("on");}T.value=U.desc;break;}if(U.hidden){T.addCls("hidden");}else{if(U.disabled){T.addCls("disabled");T.value="";}}if(T.value){T.addCls("with-desc");}return T;},touchSelectBegin:function J(S){var P=this.getItemIdxTouch(S);if(P>-1){var R=this.items[P],Q=R.fnPress;if(Q){Q.call(this.controller,R);return false;}}return true;},preselectionChange:function C(Q){var R=Q.added;if(!R){return true;}var P=R[0],S=this.items[P];if(S.disabled||S.noclick){return false;}if(S.style===I.HEADER){if(!this._listTarget.getAttribute("hidx")){return false;}}return true;},postselectionChange:function H(W){var S=W.added;if(!S){return ;}var X=S[0],f=this.items[X];var h=this,R={title:f.nm},j=[],a,d,Q=function(k,l){k.fn(l);h.updateItem(X);};switch(f.style){case I.HEADER:var P=this._listTarget.getAttribute("hidx");if(P){this.controller.jumpTo(parseInt(P,10),true);}break;case I.BUTTON:case I.VIEW_BUTTON:if(f.fn){f.fn();}break;case I.NUMBER:case I.TEXT:var Y=(f.style===I.NUMBER),T={scriptClass:"mstrmojo.android.ui."+(Y?"Validation":"")+"TextInput",alias:"textInput",textValue:f.v,textType:Y?"number":(f.pwd?"password":"text"),onEnter:function(k){Q(f,k);d.close();}};if(Y){T.valProps={dtp:mstrmojo.expr.DTP.UNSIGNED,min:f.limits.min,max:f.limits.max,constraints:{trigger:B.ONKEYUP,validator:function(l){l=parseInt(l,10);var o=this.min,k=this.max,p=(l>=o&&l<=k)?"":mstrmojo.desc(7883).replace("##",o).replace("###",k);return{code:p?A.INVALID:A.VALID,msg:p};}}};}j.push(T);a=function(){var k=d.textInput;if(k.validate){k.validate();if(k.isValid()){Q(f,k.getValue());return true;}return false;}Q(f,k.getValue());return true;};break;case I.LIST:var Z=f.items;var V=new mstrmojo.ui.MobileCheckList({items:Z,multiSelect:false,isElastic:true,selectedIndex:M.find(Z,"v",f.v)});j.push(V);a=function(){Q(f,Z[V.selectedIndex].v);};break;case I.CHECK:Q(f,(f.v===f.on)?f.off:f.on);break;case I.TIME:var U=(f.v<60000)?f.v*60000:f.v,g=new Date(U),b=new mstrmojo.ui.MobileDateTimePicker({value:{time:{hour:g.getUTCHours(),min:g.getUTCMinutes(),sec:0}},is24HourMode:false,dtp:mstrmojo.expr.DTP.TIME});j.push(b);a=function(){var k=b.getTime();Q(f,k.hour*60+k.min);};break;}if(j.length){R.children=j;if(a){R.buttons=[D(mstrmojo.desc(221,"Cancel")),D(mstrmojo.desc(1442,"OK"),a)];}d=mstrApp.showDialog(R);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.HomeScreenController");var B="mstrmojo.android.medium.controllers.HomeScreenController";mstrmojo.android.medium.controllers.HomeScreenController=mstrmojo.declare(mstrmojo.android.controllers.HomeScreenController,null,{scriptClass:"mstrmojo.android.medium.controllers.HomeScreenController",start:function D(I){this._super(I);var F=mstrApp.getConfiguration().getHomeScreen(),H=this,E=this.view=this.newView("HomeScreen",{cssClass:"home-screen",hsFmt:F.fmt,items:F.btns,postselectionChange:function G(J){var K=J.added;if(K){var L=this.items[K];H.openItem(L);}}});this.ttl=F.ttl;this.rootCtrl.updateContent(E,F.ttl);},getDefaultMenus:function A(){return 0;},makeCurrent:function C(E){this._super(E);this.rootCtrl.updateContent(this.view,this.ttl,E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TransactionView");var C=/<\/em>(.*)$/;mstrmojo.android.medium.ui.TransactionView=mstrmojo.declare(mstrmojo.android.ui.TransactionView,null,{scriptClass:"mstrmojo.android.medium.ui.TransactionView",enableButtons:function B(D){var E=this._editDocView;if(E){E.enableButtons(D);}},setTitle:function A(E){var D=E.match(C);this.controller.rootCtrl.updateContent(null,(D&&D[1])||E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.desc","mstrmojo.android.ui.Button","mstrmojo.android.controllers._HasSelectBoxDialog");mstrmojo.requiresDescs(221,1442,5136,2941);var D=mstrmojo.hash,G=mstrmojo.array,F=mstrmojo.desc,B=mstrmojo.android.ui.Button.newButton;function A(U,T){var W=D.clone(this.pageByData),V=W.es,M={title:U,dialogRefresh:function(){this.refresh();}},I=this,S=0,R,Q,J,L,P,O,N,H,K;P=function(Z){var X=L.shift(),Y=Z.ph.h[X];delete Y.cet;if(Y.ph){P(Y);}};O=function(Z){var b=Z.ph;if(!b){return ;}var X=[],a;G.forEach(b.h,function(g,d){var f=g.ix,j=g.cet||0;var h=V[f];X[d]={n:h.en,v:f,on:j};if(j){J[R]=X[d];L[R]=d;a=g.ph;}});var Y=J[R];Q.push({n:b.n,items:X,v:Y.n});R++;O(D.copy(Y,{ph:a}));};N=function(){R=0;Q=[];J=[];L=[];O(W);S=Q.length;};H=function(Y){var X=W.ph;G.forEach(J,function(Z){var b=X.h,a=G.find(b,"ix",Z.v),d;if(a<0){a=(T&&b.length>1)?1:0;}d=b[a];Y(d,X);X=d.ph;});};K=function(){var X=[];H(function(Z,Y){X.push({id:Y.id||"m",tp:Y.tp,v:V[Z.ix].ei});});I.pageByData=W;I.onPageBy(X);};N();if(S>1){M.buttons=[B(F(221,"Cancel")),B(F(1442,"OK"),function(){K();})];}this.showSelectBoxDialog(Q,function(X,Y){P(W);J[X]=Y;H(function(Z){Z.cet=1;});N();if(S>1){this.set("items",Q);}else{K();}return(S>1);},M);}mstrmojo.android.controllers._HasPageBy=mstrmojo.provide("mstrmojo.android.controllers._HasPageBy",D.copy(mstrmojo.android.controllers._HasSelectBoxDialog,{_mixinName:"mstrmojo.android.controllers._HasPageBy",showGroupByDialog:function E(){A.call(this,mstrmojo.desc(2941,"Grouping"),true);},showPageByDialog:function C(){A.call(this,mstrmojo.desc(5136,"Page By"),false);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.android.ui.PromptsList","mstrmojo.android.ui.Button");mstrmojo.requiresDescs(2550,3649,3650);var D=mstrmojo.desc,E="100%";function G(J,K){var L=this.parent;if(L[J]){L[J].apply(L,K);return true;}return false;}var C=mstrmojo.android.ui.PromptsView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.PromptsView",markupString:'<div id="{@id}" class="mstrmojo-Prompts {@cssClass}" style="{@cssText}"><div class="summary"></div><div class="command"></div></div>',markupSlots:{summaryNode:function(){return this.domNode.firstChild;},cmdNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{summaryNode:E,cmdNode:"90px"},w:{summaryNode:E,cmdNode:E}},init:function I(M){this._super(M);var L=this.prompts,K=this.supportedPrompts;if(L&&K){var J=mstrmojo.android.ui.Button.newButton((L.host.st===14081)?D(3650,"Run Document"):D(3649,"Run Report"),function(){this.parent.controller.answerPrompts();},{slot:"cmdNode",alias:"cmdButton",cssClass:"mstrmojo-GlowButton",ignoreLayout:true,enabled:mstrMobileApp.isOnline(),glowClass:"glow"});var N=mstrmojo.publisher;N.subscribe(N.NO_SRC,N.CONNECTIVITY_CHANGED_EVENT,function(O){this.cmdButton.set("enabled",O);},this.id);this.addChildren([J]);if(mstrApp.isTablet()){K=[{title:D(2550,"FILTERS"),isTtl:true}].concat(K);}this.promptList.set("items",K);}},rootOrientationChange:function F(){if(!this.ignoreRotation){mstrApp.closeDialog();}},children:[{scriptClass:"mstrmojo.android.ui.PromptsList",slot:"summaryNode",alias:"promptList",canItemLinger:function H(J){return !mstrApp.isTablet()||J.getStyle()===mstrmojo.prompt.WebPrompt.STYLES.SWITCH;}}],openPrompt:function A(L){var J=this.controller;if(!J.prevController&&!J.nextController){return ;}this.ignoreRotation=true;if(!G.call(this,"openPrompt",[L])){L();}var K=this;window.setTimeout(function(){delete K.ignoreRotation;},300);},closePrompt:function B(){G.call(this,"closePrompt");}});mstrmojo.DPIManager.registerClass(C,"h","cmdNode",{160:60,213:60,240:90,320:120});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo._ResultSetXt","mstrmojo._ReportDataService","mstrmojo._IsGraphDataService");var D={objectType:3},C={showWait:true,hideWait:true},E=mstrmojo.hash.copy;function B(){var J=mstrApp.getContentDimensions(true);return{taskId:"getReportGraphImage",height:0,width:0,availHeight:J.h,availWidth:J.w,imgType:4,showTooltips:true};}mstrmojo.GraphDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._ResultSetXt,mstrmojo._ReportDataService,mstrmojo._IsGraphDataService],{scriptClass:"mstrmojo.GraphDataService",execute:function H(K,L){var J=mstrmojo.hash.copy(K,{});J.taskId=J.taskId||"reportExecute";J.reportID=J.reportID||(K&&K.dssId)||this.dssId;this.dssId=J.reportID;this._super(J,L);},getResults:function A(J,K){this._super(B(),K);},answerPrompts:function G(J,K){this._super(J,K,E(D));},loadPrompts:function F(K,J){this._super(K,E(D,J));},pageBy:function I(K,M){var L=mstrApp,J={taskId:"changePageBy",messageID:this.msgId,pageByKeys:this.pageByUnitsToKeys(K)};if(!L.useBinaryFormat){E(B(),J);}mstrApp.serverRequest(J,M,C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array","mstrmojo._ResultSetXt","mstrmojo._ReportDataService");function B(U,V,R,S){var T=this;mstrApp.serverRequest(U,{success:function(W){T.msgId=W.id;T.visName=W.visName;T.getResults(S,V);},failure:function(W){if(V.failure){V.failure(W);}},canceled:function(){if(V.canceled){V.canceled();}}},R);}function C(T,S){var R={hideWait:!T,delay:true};R["show"+(S?"Progress":"Wait")]=true;return R;}var F={objectType:3};var G=mstrmojo.hash.copy,J=mstrmojo.array;function L(){var R="MojoXtabStyle",T=this.visName;if(T){var S=mstrmojo.AndroidVisList.getVis(T);R=(S&&S.s)||R;}return R;}mstrmojo.XtabDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._ResultSetXt,mstrmojo._ReportDataService],{scriptClass:"mstrmojo.XtabDataService",execute:function K(W,Y,U){var X=this.id;var T=this.controller.ab;if(T){var V=T.split("|"),R=mstrApp.isTablet()?"73^":"72^";J.forEach(V,function(d,a,Z){var b=d.indexOf(R);if(b>=0){mstrmojo.all[X].visName=d.substring(b+3);return false;}});}var S=mstrmojo.hash.copy(W,{});S.taskId=S.taskId||"reportExecute";S.reportID=S.reportID||this.dssId;S.styleName=mstrApp.isTablet()?"AndroidTabletMessageResultStyle":"AndroidMessageResultStyle";if(W){if(W.dssId){S.reportID=W.dssId;}}this.dssId=S.reportID;this._super(S,Y,U);},getResults:function A(X,Z){var W=L.call(this),V=mstrMobileApp.getDeviceDPI(),a=160;if(V<160){a=80;}else{if(V>240){a=230;}}var Y={taskId:"iPhoneGetReportResults",styleName:W,zoomFactor:a,deviceMode:mstrApp.isTablet?(mstrApp.isTablet()?73:72):0};if(X){var T=X.pbUnits,U=X.yPos,S=X.colsPerPage,R=X.rowsPerPage;if(T){Y.pageByKeys=this.pageByUnitsToKeys(T);}if(U){Y.yPos=U;}if(S){Y.colsPerPage=S;}if(R){Y.rowsPerPage=R;}}this._super(Y,Z);},answerPrompts:function I(R,S){this._super(R,S,G(F));},loadPrompts:function H(S,R){this._super(S,G(F,R));},drill2Grid:function D(S,T){var R={taskId:"RWGridDrillToReport",msgID:S.srcMsgId,displayMode:-1,retainParent:3,retainThreshold:3,drillPathKey:S.drillPathKey,drillPathIndex:S.drillPathIndex,elementList:S.drillElements,nodeKey:S.nodeKey,rwGroupByElements:S.rwGroupByElements};if(S.sliceId){R.sliceId=S.sliceId;}B.call(this,R,T,C(true,true));},drillGrid:function Q(R,S){B.call(this,{taskId:"gridDrill",msgID:R.srcMsgId,drillPathKey:R.drillPathKey,drillPathIndex:R.drillPathIndex,elementList:R.drillElements},S,C(true,true));},pageBy:function M(S,U){var T=mstrApp,R={taskId:"changePageBy",messageID:this.msgId,pageByKeys:this.pageByUnitsToKeys(S)};if(!T.useBinaryFormat){R.taskId="iPhoneGetReportResults";R.styleName=L.call(this);R.zoomFactor=200;}mstrApp.serverRequest(R,U,C());},sort:function E(R,S){B.call(this,{taskId:"gridSort",msgID:this.msgId,sortKey:R.sortKey,sortOrder:((R.isAsc)?1:0),subtotalPos:R.subTotalsPos,clearSorts:1},S,C());},pivot:function O(S,T){var R={taskId:"gridPivot",msgID:this.msgId,objectId:S.objectId,pos:S.pos,objectType:S.objectType};if(S.axis){R.axis=S.axis;}B.call(this,R,T,C());},getImage:function N(R){if(R&&R.indexOf("://")===-1){R=mstrApp.getConfiguration().getHostUrlByProject(mstrApp.getCurrentProjectId())+R;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(R)):R;},downloadGridData:function P(R,S){mstrApp.serverRequest({taskId:"DocXtabIncrementalFetch",nodeKey:"",rowPosition:R.rowPosition,maxRows:R.maxRows,colPosition:-1,maxColumns:-1},S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService","mstrmojo._ResultSetXt");var F={objectType:55};var B=mstrmojo.hash.copy;mstrmojo.DocDataServiceXt=mstrmojo.declare(mstrmojo.DocDataService,[mstrmojo._ResultSetXt],{scriptClass:"mstrmojo.DocDataServiceXt",execute:function E(I,J,H){var G=mstrmojo.hash.copy(I,{});G.taskId="RWExecute";if(!G.objectID){G.objectID=(I&&I.dssId)||this.dssId;}this.dssId=G.objectID;this._super(G,J,H);},getResults:function D(H,I){H=H||{};H.taskId=H.taskId||"androidRWExecute";H.styleName=H.styleName||"RWDocumentMobileStyle";H.useTerseElementId=H.useTerseElementId||1;var G=this.model.controller.getContentDimensions();H.availableWidth=G.w;H.availableHeight=G.h;H.executionOrientation=mstrMobileApp.getOrientation();this._super(H,this.wrapCallback(I));},answerPrompts:function A(G,H){this._super(G,this.wrapCallback(H),B(F));},loadPrompts:function C(H,G){this._super(this.wrapCallback(H),B(F,G));}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.FolderDataService","mstrmojo.XtabDataService","mstrmojo.DocDataServiceXt","mstrmojo.GraphDataService","mstrmojo.RptXtabModel","mstrmojo.ResultSetDocumentModel","mstrmojo.GraphModel","mstrmojo.prompt.WebPrompts","mstrmojo.maps.AndroidMapModel","mstrmojo.mstr.ElementDataService","mstrmojo.SubscriptionsDataService");mstrmojo.android.factories.ModelFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.android.factories.ModelFactory",newFolderDataService:function A(N){return new mstrmojo.FolderDataService(N);},newXtabDataService:function H(N){return new mstrmojo.XtabDataService(N);},newGraphDataService:function G(N){return new mstrmojo.GraphDataService(N);},newDocumentDataService:function D(N){return new mstrmojo.DocDataServiceXt(N);},newElementDataService:function B(){return mstrmojo.mstr.ElementDataService;},newSubscriptionsDataService:function J(){return new mstrmojo.SubscriptionsDataService();},newXtabModel:function L(N){return new mstrmojo.RptXtabModel(N);},newDocumentModel:function C(N){return new mstrmojo.ResultSetDocumentModel(N);},newGraphModel:function K(N){return new mstrmojo.GraphModel(mstrmojo.hash.copy(N,{dataService:this.newGraphDataService()}));},newPromptsModel:function M(N,O){var P=new mstrmojo.prompt.WebPrompts({rsl:N});if(O){P.populateAnswers(O);}return P;},newMapModel:function F(N){return new mstrmojo.maps.AndroidMapModel(N);},newDataService:function E(N,O){return this["new"+N+"DataService"](O);},newModel:function I(N,O){return this["new"+N+"Model"](O);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.desc","mstrmojo.android.EnumMenuOptions","mstrmojo.android.controllers._HasPageBy");mstrmojo.requiresDescs(5136,6189);var C=mstrmojo.android.EnumMenuOptions,G=C.PAGE_BY,F=C.REPROMPT;var E=mstrmojo.hash,H=mstrmojo.desc;mstrmojo.android.controllers._IsReportController=mstrmojo.provide("mstrmojo.android.controllers._IsReportController",E.copy(mstrmojo.android.controllers._HasPageBy,{_mixinName:"mstrmojo.android.controllers._IsReportController",hasPageBy:function B(){var J=this.gridData,I=J&&J.ghs;return !!(I&&I.phs);},updateActionToolbar:function A(L){this.addFullScreenButton(L);var I=this.view;if((I&&I.hasPageBy&&I.hasPageBy())||this.hasPageBy()){L.addToolbarBtn(G,H(5136,"Page By"),G,true,1);}if(mstrMobileApp.isOnline()){var K=this.xtabModel||this.model,J=K.prompts;if(J&&J.hasSupported()){L.addToolbarBtn(F,H(6189,"Filter"),F,true,3);}}return this._super(L);},handleMenuItem:function D(J,I){switch(J){case G:this.showPageByDialog();break;case F:this.reprompt();break;default:return this._super(J,I);}return false;}}));}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ResultSetController","mstrmojo._IsDocController","mstrmojo.android.controllers._SupportsQueuedTransactions","mstrmojo.android.controllers._HasPageBy","mstrmojo.ui.MobileCheckList","mstrmojo.android.EnumMenuOptions","mstrmojo.string","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(1089,1917,2941,6189,9233,9254,9255,9256,9257);var K=mstrmojo.hash,d=mstrmojo.array,a=mstrmojo.android.EnumMenuOptions,C=a.DOC_LAYOUTS,T=a.GROUP_BY,b=a.REPROMPT,AI=a.SHARE,B=a.ANNOTATION,w="\u001F",z=1;function q(AO){var AM=AO.model,AL=AM.data.layouts,AN=d.find(AL,"k",AM.currlaykey);return AN>=0?AL[AN]:null;}function o(AO,AM){var AP=AO.getGroupByElements(AM),AN=[],AL=q(AO),AS=AL&&AL.gbys&&AL.gbys.groupbys,AR=AP&&AP.length;if(AR&&AS){for(i=0;i<AR;i++){var AQ=AS[i].unit.target;AN.push(AQ.did);AN.push(AQ.t);AN.push(AP[i]);}}return AN.join(w);}function x(AR,AL){var AQ=AR.desiredUnits||{},AP=q(AR),AM=AL&&AL.length;if(AP&&AP.gbys){var AO=AP.gbys.groupbys,AT=AO.length;for(i=0;i<AT;i++){var AS=AO[i].unit,AN;if(AL){if(i<AM){AN=AL[i];}else{break;}}else{AN=AS.elms[AS.idx].v;}AQ[AS.target.did]=AN;}}return AQ;}function V(AL){var AO="",AN=0,AM;for(AM in AL){if(AN>0){AO+=w;}AO+=AM+w+AL[AM];AN++;}return AO;}function S(){if(this.refreshTimer){clearInterval(this.refreshTimer);delete this.refreshTimer;}}function D(){var AM=this.model.rf;if(AM&&AM>0){var AL=this;this.refreshTimer=self.setInterval(function(){AL.checkCache(null,null,null,2);},AM*1000);}}function s(){var AL=this._previousOr;if(AL===-1){return ;}if(AL===0){window.setTimeout(function(){mstrMobileApp.releaseOrientation();});}else{if(AL>0){mstrMobileApp.lockOrientation(AL);}}this._previousOr=-1;}function AE(){return mstrApp.getTransactionNotificationController();}function A(AL,AM){var AN={srcMsgId:this.model.mid,desiredUnits:x(this,this.getGroupByElements(AM))};K.forEach(AL,function(AP,AO){AP=AP.replace(/\+/g," ");AN[AO]=decodeURIComponent(AP);});return AN;}function AG(AS){var AR=AS.txData.split(";"),AQ,AP=AR.length;for(AQ=0;AQ<AP;AQ++){var AO=AR[AQ],AN=AO.split(","),AM=decodeURIComponent(AN[1]),AL=this.model.getFirstUnitInstanceByName(AN[0]);if(AL){AL.dataChanged(0,AL.v,{dv:AM,v:AM},AL.valueNode);}}}mstrmojo.android.controllers.DocumentController=mstrmojo.declare(mstrmojo.android.controllers.ResultSetController,[mstrmojo.android.controllers._SupportsQueuedTransactions,mstrmojo._IsDocController,mstrmojo.android.controllers._HasPageBy],{scriptClass:"mstrmojo.android.controllers.DocumentController",initModel:function I(AL){return mstrApp.modelFactory.newModel("Document",K.copy(AL,{controller:this}));},hasTxChanges:false,start:function R(AN,AO){var AM=this.desiredUnits=AN.desiredUnits;if(AM){var AL=V(AM);if(AL){AN.desiredElements=AL;}delete AN.desiredUnits;}this.sub_id=AN.sub_id;this.hasTxChanges=!!AN.hasTxChanges;this._super(AN,AO);},createView:function N(AR,AM){var AU=AR.defn.layouts,AP=mstrMobileApp.getLockedOrientation(),AN=-1,AV=-1,AO=true,AL=AU.length,AQ;for(AQ=0;AQ<AL;AQ++){if(AU[AQ].iw){continue;}var AS=AU[AQ].or;if(AN===-1){AN=AS;}if(AS!==AN||AS===3){AO=false;break;}}if(AP>0){if(AO){if(AN!==AP){AV=AN;}}else{AV=0;}}else{if(AO){AV=AN;}}if(AV>-1){if(AV===0){mstrMobileApp.releaseOrientation();}else{mstrMobileApp.lockOrientation(AV);}this._previousOr=AP;}var AT=this.view=this.newView("Document",AM);AT.set("model",this.model);AT.buildChildren();return AT;},afterReprompt:function Z(AM){var AL=this.view;AL.unloadLayouts(null,false);AL.model.loadLayout(AM,true);this._super(AM);},onPageBy:function Q(AL){var AM="";d.forEach(AL,function(AO,AN){if(AN){AM+=w;}AM+=AO.id+w+AO.v;});this.onGroupBy({gbUnits:AM});},hasPageBy:function h(){var AL=this.view,AM=AL&&AL.getLayouts()&&AL.getCurrentLayout();return !!(AM&&AM.gb&&AM.defn.dpb);},onGroupBy:function t(AO,AP,AN){var AL=this.view,AM=this.model;AN=AN||{};AN.showWait=true;AN.hideWait=true;AN.delay=true;AP=mstrmojo.func.wrapMethods(AP,{success:function(AQ){AL.unloadLayouts(null,true);AM.loadLayout(AQ);}});AM.getDataService().changeDocGroupBy(AO,AP,AN);},setData:function P(AM,AN){var AL=this.view;if(AN&&AL){AL.unloadLayouts(null,false);}this.model.loadLayout(AM);if(AM.rf!=this.old_rf){S.call(this);D.call(this);}this.rootCtrl.updateContent(null,this.model.n,false);},onDrill:function j(AL,AM){if(!this.isInRequest()){if(AM.isWithin){AL.model.drillGrid(this._addNodeKeyToAction(AL,AM),this._getXtabCallback(AL));}else{AM.rwGroupByElements=o(this,AL);this._super(this._addNodeKeyToAction(AL,AM));}}},onDownloadGridData:function M(AL,AM){this.model.downloadGridData(this._addNodeKeyToAction(AL,AM));},onExecuteNewObject:function O(AL,AM){this._super(AM);},onReExecute:function AC(AL){this.reExecute(AL);},refresh:function AJ(AL,AN){var AM=this.id;this.model.getDataService().refresh(AL,mstrmojo.func.wrapMethods({success:function(AO){mstrmojo.all[AM].setData(AO,true);}},AN));},invalidClientCache:function(){if(mstrApp.useBinaryFormat){mstrMobileApp.removeLiveCache(mstrApp.getCurrentProjectId(),this.model.ci.cid);}},onTransactionUpdates:function l(AL,AN,AM){var AO=this.model,AQ;if(mstrApp.useBinaryFormat){AQ=AO.newCallback({success:function(){AL.clear();AO.clearTxDeltaUpdate();if(AM){setTimeout(function(){AL.autoRefresh();},250);}}});var AP=AO.getDataService();if(AN.manipulation===z){AP.txMarkRows(AN,AQ);}else{AP.txChangeData(AN,AQ);}}else{if(AM){AL.autoRefresh();}}this.hasTxChanges=true;},onLink:function F(AL,AO){if(!AO.url){return this._super(AL,AO);}var AN=mstrmojo.string.parseUri(AO.url),AQ=AN.authority,AP=AN.path;if(AN.protocol==="mstr"){this.handleSpecialLink(AN,AO);}else{if(AQ==="mstrWeb"||AQ==="Main.aspx"||(/mstrWeb$/.test(AP))||(/Main\.aspx$/.test(AP))){this._super(AL,A.call(this,AN.queryKey,AO.src));}else{var AM=mstrMobileApp.openLink(AN.source,AO.target);if(AM){mstrApp.onerror({message:AM});}}}},getLinkRequest:function g(AQ){var AL;if(!AQ.url){AL=this.buildLinkParams(AQ);}else{var AP=mstrmojo.string.parseUri(AQ.url),AO=AP.queryKey,AS=AP.authority,AR=AP.path;if(AP.protocol!=="mstr"&&(AS==="mstrWeb"||AS==="Main.aspx"||(/mstrWeb$/.test(AR))||(/Main.aspx$/.test(AR)))){AL=this.buildLinkParams(A.call(this,AO,AQ.src));if(AL){switch(parseInt(AO.evt,10)){case 4001:AL.taskID="reportExecute";AL.styleName="AndroidMessageResultStyle";break;case 2048001:AL.taskID="RWExecute";AL.objType=55;var AN=AL.desiredUnits;if(AN){var AM=V(AN);if(AM){AL.desiredElements=AM;}delete AL.desiredUnits;}break;}}}}if(AL&&AL.link){AL.linkAnswers=AL.link.toXml();delete AL.link;}return AL;},getDesiredElements:function f(AP){var AO=this.model.gbElements,AN="";if(AO){var AQ=AO.split(";"),AM=AQ.length,AL;for(AL=0;AL<AM;AL+=3){if(AL>0){AN+=w;}AN+=AQ[AL]+w+AQ[AL+2];}}else{AN=V(x(this,AP));}return AN;},confirmMsgBeforeSubmit:function E(){var AM=this.model,AL=AE(),AN;if(this.hasTxChanges&&AL&&AL.hasPendingTransactions(this.did)){if(AM.txrcd){AN=mstrmojo.desc(9254,"Pending transaction exists")+". "+mstrmojo.desc(9255,"You are about to replace a pending transaction.");}else{AN=mstrmojo.desc(9256,"There are one or more pending submissions in the transaction queue for this document.")+" "+mstrmojo.desc(9257,"Continuing will submit a new transaction.");}}return AN;},offlineTransactionsSubmitted:function AF(AM){var AL=AE();if(AL){AL.setOfflineRecords(this.did);}this.hasTxChanges=false;},openOfflineTransactions:function AH(){var AL=AE();if(AL){AL.showNotificationBoard(this,this.did,this.ttl);}},transactionDiscarded:function W(AL){this.hasTxChanges=false;},destroy:function AD(){s.call(this);this._super();},nudgeWidget:function L(AM,AL){if(mstrMobileApp!==undefined&&mstrMobileApp.nudgeWidget){mstrMobileApp.nudgeWidget(AM,JSON.stringify(AL));}},resetOrientation:function AK(){s.call(this);},checkCache:function H(AN,AP,AL,AO,AM){this.old_rf=this.model.rf;this._super(AN||{ifc:true,ci:this.model.ci},AP,AL,AO,AM);},beforeViewHidden:function G(AL){this._super(AL);if(AL){mstrmojo.GraphBase.hideTooltips();this.resetOrientation();}S.call(this);},afterViewVisible:function U(){this._super();var AL=this.view;if(AL&&AL.afterViewVisible){AL.afterViewVisible();}if(!this.isSubscription){D.call(this);}},hasFullScreenInfoWindow:function AB(){var AL=this.view;return AL&&AL.fullScreenInfoWindow;},updateActionToolbar:function p(AO){if(!this.hasFullScreenInfoWindow()){this.getTxnToolbarButton(AO);this.addFullScreenButton(AO);if(mstrMobileApp.isOnline()){var AN=this.model,AL=AN.docModel||AN,AM=AL.prompts,AP=AL.getCurrentLayoutDef&&AL.getCurrentLayoutDef(),AR=(AP&&AP.dri);if(AM&&AM.hasSupported()&&(AR===undefined||AR)){AO.addToolbarBtn(b,mstrmojo.desc(6189,"Filter"),b,true,3);}}if(this.hasPageBy()){AO.addToolbarBtn(T,mstrmojo.desc(2941,"Grouping"),T,true,2);}var AQ=this.view&&this.view.getSupportedLayouts();if(AQ&&(AQ.length>1)){AO.addToolbarBtn(C,mstrmojo.desc(4174,"Layouts"),C,false,8);}}return this._super(AO);},handleMenuItem:function k(AP,AL){if(AP!==AI&&AP!==B){mstrmojo.GraphBase.hideTooltips();if(mstrApp.isTablet()){this.view.closeInfoWindowsOnTablet();}}switch(AP){case C:var AM=this.view,AN=function(){var AQ=AM.getSupportedLayouts();return{l:AQ,idx:d.indexOf(AQ,AM.getCurrentLayout())};},AO=AN();mstrApp.showDialog({title:mstrmojo.desc(4174,"Layouts"),children:[{scriptClass:"mstrmojo.ui.MobileCheckList",isElastic:true,multiSelect:false,items:AO.l,selectedIndex:AO.idx,postselectionChange:function(AQ){var AR=AQ.added;if(AR){if(AM.showLayout(this.items[AR[0]])){mstrApp.closeDialog();}}},postCreate:function(){mstrApp.rootController.attachEventListener("rootOrientationChange",this.id,function(){var AQ=AN();this.set("items",AQ.l);this.select(AQ.idx);this.parent.resizeDialog();});}}]});return ;case T:this.showGroupByDialog();return ;case b:this.reprompt();return ;}return this._super(AP,AL);},makeCurrent:function Y(AL){this.isBack=true;this._super(AL);delete this.isBack;},handleSpecialLink:function X(AR,AU){var AT=AR.queryKey,AX=this.view,AM=AT.evt;if(AM==="2048500"){var AN=AT.panelName,AV=AX.model,Aa=AV.getInfoWindow(AN);if(Aa){AX.showInfoWindow(Aa.id,Aa.k,AU.src.domNode);}}else{if(AM==="2048030"){var AZ=!!AT.useCache&&AT.useCache==="0",AP={fresh:AZ,useRefreshProgress:mstrApp.isTablet()};this.refresh(AP);}else{if(AM==="2048258"){AG.call(this,AT);}else{if(AM==="3037"){this.share(AT.emailSubject,true);}else{if(AM==="3175"){this.startAnnotate();}else{if(AR.authority==="gb"){var AW=this,AS=AX.getSelectedLayoutWidget(),AO=AS.gb,AY=AT.a,AQ=AT.e,AL=d.forEach;AL(AO.groupbys,function(Ae){var Ac=Ae.unit,Ad=Ac.target;if(Ad.did===AY){var Ab=function(){var Ag=Ac.elms,Af=[];AL(Ag,function(Ai,Ah){Af.push(K.copy(Ai,{k:Ae.k,on:(Ah===Ac.idx)}));});mstrApp.showDialog({title:Ad.n,children:[{scriptClass:"mstrmojo.ui.MobileCheckList",selectionPolicy:"reselect",items:Af,multiSelect:false,isElastic:true,selectedIndex:Ac.idx,preselectionChange:function(Ah){if(Ah.added[0]===Ah.removed[0]){mstrApp.closeDialog();return false;}if(this._super){return this._super(Ah);}},postselectionChange:function(Ah){mstrApp.closeDialog();var Ai=Af[Ah.added[0]];AW.onGroupBy({groupbyKey:Ai.k,elementId:Ai.v});}}]});};if(AQ&&parseInt(AQ,10)!==0){this.onGroupBy({groupbyKey:Ae.k,elementId:AQ},{failure:Ab},{noErrorMessage:true});}else{Ab();}return false;}});}else{this._super(AR,AU);}}}}}}},getContentDimensions:function AA(){var AL=mstrApp.getContentDimensions();return{w:AL.w,h:AL.h};},canDelegateToolBar:function J(){if(this.hasFullScreenInfoWindow()){return false;}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileXtab","mstrmojo.array","mstrmojo.hash");function B(){var K=this.xtabStyleSheet,J=K&&K.parentNode;if(J){J.removeChild(K);delete this.xtabStyleSheet;}}mstrmojo.AndroidXtab=mstrmojo.declare(mstrmojo.MobileXtab,null,{scriptClass:"mstrmojo.AndroidXtab",scrollerFriction:0.0015,preBuildRendering:function G(){B.call(this);this.updateXtabStyles(this.model.data.cssString);this._super();},onwidthChange:function D(){if(this.gridData.afw){var K=this.scrollboxNode,J=this.width;if(K){K.style.width=J;}else{this.scrollboxNodeCssText="width: "+J;}}if(this._super){this._super();}},updateXtabStyles:function E(J){if(!this.xtabStyleSheet){this.xtabStyleSheet=document.getElementsByTagName("head")[0].appendChild(document.createElement("style"));}this.xtabStyleSheet.appendChild(document.createTextNode(J));},unrender:function F(J){this._super(J);B.call(this);},getMaskNode:function C(){var J=document.createElement("div");J.appendChild(this.xtabStyleSheet.cloneNode(true));J.appendChild(this.domNode.cloneNode(true));return J;},updateActionMenu:function A(J,K){this._selectionActions=K;return true;},setModel:function I(J){this._super(J);this.controller.getPageByTree(false);},deselectCell:function H(){this._super();delete this._selectionActions;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox");var I=mstrmojo.array,G=mstrmojo.dom,C=mstrConfig.thousandsSep;if(C===undefined){C=",";}var B=2147762227,D=2147762262,J=2147762269,E=140;var N;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{getItemMarkup:function(Q,P){if(!N){N=this._super(Q,P).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return N;},getItemProps:function K(R,P){var Q=this._super(R,P),S=R.wt;Q.weight=(S)?"<em>("+mstrmojo.num.addSeparators(S,C)+" likes)</em>":"";return Q;}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-SearchBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",suggestionListClass:"mstrmojo.SearchBoxSelectorList",postCreate:function M(){var P=this.suggestionPopup;P.cssClass="mstrmojo-SearchBoxSelector-suggest";P.nudge=function(){var R=this.editorNode;if(!R){return ;}var Q=Math.min(R.offsetHeight,E),T=R.offsetWidth,W=G.windowDim(),V=this.left,U=this.top;if(U+Q>=W.h){U-=Q;}if(V+T>=W.w){V-=T;}var S=R.style;S.top=U+"px";S.left=V+"px";};},preBuildRendering:function L(){this.set("maxItemWidth",this.parent.contentNode.offsetWidth);this._super();},postBuildRendering:function A(){var P=this.parent.defn.fmts;if(!P.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function H(Q,T,P){var U=Q,R=this.suggestCount;if(!this.noCache){P=P||R;T=mstrmojo.string.regEscape(T);var V=this.itemField,S=new RegExp("^"+T,"i");U=I.filter(Q,function(W){return S.test(W[V]);},{max:P});}if(U.length){I.forEach(this.items,function(X){var W=I.find(U,"v",X.v);if(W>-1){U.splice(W,1);}});}if(U.length>=R){U=U.slice(0,R);}return U;},getCandidatesThroughTaskCall:function O(S,V){var P=this.id,R=this.getSuggestionTarget(),Q=S.pattern||"",X=this.parent,W=this.srcid;Q=Q.replace(/"/,"");if(W){var T={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:W,dataSourcesXML:this.dsrc||"",blockCount:this.REQUEST_THRESHOLD,searchPattern:Q,browseFlags:1};var U=X.defn;if(U.dsid){T.datasetID=U.dsid;T.messageID=X.model.mid;T.ctlKey=X.ckey;}if(U.sfid){T.searchForms=U.sfid;if(parseInt(U.sfdt,10)===8){T.searchPattern+="*";}}V.success=function(b){if(b&&b.es){var f=mstrmojo.all[P],g=f.getSuggestionTarget(),Y=b.es.length;if(!b||!g||(R!==g)){return ;}if(Y&&(Y>f.suggestCount)){return ;}var a=g.getSearchPattern(),Z=b.es;if(W){Z=mstrmojo.elementHelper.buildElemsTerseID(Z,W,true);}var d=S.pattern;f._last_hit={items:Z,pattern:d};if(a&&a.indexOf(d)>-1){f.updateSuggestion(f.filterCandidates(Z,a));}}};V.failure=function(Z){var Y=parseInt(Z.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296;if(Y!==B&&Y!==D&&Y!==J){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,T,false,null,true);}},onsuggestionItemsChange:function F(){var U=this.suggestionItems,R=this.suggestionPopup,Q=R.editorNode,S=U&&(U.length>8),P="",T="";if(S){P=E;T="px";}if(Q){Q.style.height=P+T;}else{if(S){T+=";";R.cssText=(R.cssText||"")+"height:"+P+T;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.AndroidDICPopup","mstrmojo.DefaultDIC","mstrmojo.android.inputControls.SliderDIC","mstrmojo.android.inputControls.TextFieldDIC","mstrmojo.android.inputControls.CheckBoxDIC","mstrmojo.android.inputControls.PullDownDIC","mstrmojo.android.inputControls.RadioListDIC","mstrmojo.android.inputControls.LikertScaleDIC","mstrmojo.android.inputControls.CalendarDIC","mstrmojo.android.inputControls.DateTimePickerDIC","mstrmojo.android.inputControls.TextAreaDIC","mstrmojo.android.inputControls.MarkRowDIC","mstrmojo.android.inputControls.ToggleDIC","mstrmojo.android.inputControls.SignatureDIC","mstrmojo.android.inputControls.StepperDIC","mstrmojo.android.inputControls.RatingDIC","mstrmojo.android.inputControls.BarcodeDIC","mstrmojo.android.ui.Button");mstrmojo.requiresDescs(221,1442);var Q=mstrmojo.android.ui.Button.newButton,A=1,I=2,C=3,E=4,L=5,R=6,D=7,F=8,H=9,T=10,G=12,S=13,P=14,K=102;var B=mstrmojo.android.AndroidDICConfig=mstrmojo.provide("mstrmojo.android.AndroidDICConfig",{DICList:{1:mstrmojo.android.inputControls.TextFieldDIC,2:mstrmojo.android.inputControls.CheckBoxDIC,3:{0:mstrmojo.android.inputControls.PullDownDIC,1:mstrmojo.android.inputControls.RadioListDIC},4:mstrmojo.android.inputControls.SliderDIC,5:mstrmojo.android.inputControls.DateTimePickerDIC,6:mstrmojo.android.inputControls.DateTimePickerDIC,7:mstrmojo.android.inputControls.ToggleDIC,8:mstrmojo.android.inputControls.TextAreaDIC,9:mstrmojo.android.inputControls.SignatureDIC,10:mstrmojo.android.inputControls.RatingDIC,11:mstrmojo.DefaultDIC,12:mstrmojo.android.inputControls.StepperDIC,13:mstrmojo.android.inputControls.BarcodeDIC,14:mstrmojo.android.inputControls.LikertScaleDIC,102:mstrmojo.android.inputControls.MarkRowDIC},DICPopup:{getInstance:function(U,V){return mstrApp.showPopup({scriptClass:"mstrmojo.android.AndroidDICPopup",widget:V,buttons:[Q(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.onCancel();}),Q(mstrmojo.desc(1442,"OK"),function(){return this.parent.parent.onApply();})],title:V.popupTitle||U.parent.title});}},getDICClass:function J(U){if(U.t===C){return this.DICList[U.t][U.st||0];}return this.DICList[U.t];},showDICByDefault:function O(V,U){if(V.sbd===undefined){switch(V.t){case C:V.sbd=(!!V.st)?true:false;break;case L:case R:case A:case S:V.sbd=false;break;case D:case I:case K:case T:case G:case P:V.sbd=true;break;default:V.sbd=(V.dm===1);}}return V.sbd;},hasDICPreview:function N(V,U){return true;},isKeyNavigable:function M(U){if(U.ikn===undefined){U.ikn=false;}return U.ikn;}});B.TYPES={TEXTFIELD:A,SWITCH:I,LIST:C,SLIDER:E,CALENDAR:L,TIMEPICKER:R,TOGGLE:D,TEXTAREA:F,SIGNATURE:H,RATING:T,STEPPER:G,LIKERTSCALE:P};mstrmojo.DICConfig=B;mstrmojo.DICList=B.DICList;mstrmojo.DICPopup=B.DICPopup;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Button","mstrmojo.android.medium.ui.CalendarMarkupBuilder","mstrmojo.android.ui.CalendarDialog","mstrmojo.android.EnumOrientationTypes");var E=true,A={160:{YEAR:80,CELL:40},240:{YEAR:100,CELL:60},320:{YEAR:120,CELL:80}},B=mstrmojo.desc(2827,"Clear");function D(){if(!this.elasticHeight){this.contentList.elasticHeight=parseInt(this.calendar.domNode.offsetHeight,10);}}mstrmojo.android.medium.ui.CalendarDialog=mstrmojo.declare(mstrmojo.android.ui.CalendarDialog,null,{scriptClass:"mstrmojo.android.medium.ui.CalendarDialog",markupBuilder:mstrmojo.android.medium.ui.CalendarMarkupBuilder,currentViewMode:E,requiredOrientation:mstrmojo.android.EnumOrientationTypes.PORTRAIT,init:function(H){this._super(H);var K=this,J=this.calendar,I=J.target,F=mstrMobileApp.getDeviceDPI();J.layoutConfig.h={monthNode:(8*A[F].CELL)+"px",yearNode:A[F].YEAR+"px"};I.visible=this.currentViewMode!==E;this.addChildren([I]);this._elasticChild=I;var L=this.buttons[0],G=J.selectedDates;L.onclick=function(){return K.getCancelBtnFn();};if(G&&G.length>0){L.text=B;}},touchTap:function C(J){if(this._super){this._super(J);}var G=!this.currentViewMode,I=G===E,F=this.contentList,H=this.calendar;this.currentViewMode=G;if(mstrmojo.dom.contains(this.titleNode,J.target,true,this.domNode)===true){D.call(this);H.set("visible",I);F.set("visible",!I);F.rowHeight=F.rowHeight||-1;H.syncListItemsWithSelections(F.getSelectedItems());}}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidMap","mstrmojo.maps.jsmap.AndroidDocMapInfoWindow","mstrmojo.Overlay","mstrmojo.hash","mstrmojo.array","mstrmojo.dom");var F=mstrmojo.dom;mstrmojo.maps.jsmap.AndroidDocMap=mstrmojo.declare(mstrmojo.maps.jsmap.AndroidMap,[mstrmojo._Formattable],{scriptClass:"mstrmojo.maps.jsmap.AndroidDocMap",cssClass:"mstr-googleMapView",formatHandlers:{domNode:["left","top","z-index","height","width","border","border-color","border-style","border-width"]},sc:null,getMapModel:function C(){var O=this.doc,M=O.model,N=mstrApp.getCurrentProjectId(),P=mstrApp.serverProxy.getSessions();return{pid:N,sessions:P,model:this.model,docData:{did:O.did,ttl:O.ttl,st:O.st,mid:M.mid,bs:M.bs,data:M.data,defn:M.defn},cfg:mstrApp.getConfiguration().getConfiguration()};},postBuildRendering:function A(){this._touchListener=mstrmojo.touchManager.attachEventListener("touchesBegin",this.id,function(M){var N=this.openedInfoWindow;if(N){if(!F.contains(this.domNode,M.touch.target,true,document.body)&&!mstrApp.isDialogUp()){N.close();}}});return this._super();},destroy:function J(M){var N=this._touchListener;if(N){mstrmojo.touchManager.detachEventListener(N);delete this._touchListener;}this._super(M);},setModel:function L(M){this.doc=M.controller.view;this._super(M);},initFromVisProps:function I(M){this._super(M);if(!M){return ;}this.iwDocLayout=(parseInt(M.dl,10)===1);if(M.lyt){this.iwLayoutKey=M.lyt;}},findSelectorTarget:function G(R){if(R&&R.tks){var O=this.model.docModel,N=R.tks.split("\u001E"),P=0,M=N.length;for(P=0;P<M;++P){var Q=O.getTargetDefn(N[P]);if(Q[N[P]].ifw){return N[P];}}}},showInfoWindow:function D(O,N,M){this.openedInfoWindow=M;M.open(O,N);},getInfoWindow:function K(P,N){var O=this.gridData;if(this.iwDocLayout){this.getInfoWindowFromLayout(O,P,N,this.showInfoWindow);}else{var Q=this.getInfoWindowSelectorControl(O),M=this.findSelectorTarget(Q);if(!(!!Q&&M)){return this.getDefaultInfoWindow(O,N);}}},getInfoWindowFromLayout:function B(T,N,P,X){var M=this,V=this.doc,W=V.getLayouts(),O=this.iwLayoutKey,Q=W[mstrmojo.array.find(W,"k",O)],Y="\x1F",S="12",U=P.attrid+Y+S+Y+P.eid;var R={layoutKey:O,groupByIDs:U};V.selectLayout(Q,(O!==V.model.currlaykey),{complete:function(){Q.defn.loaded=false;V.getNewLayout(R,W,false,{complete:function(){mstrApp.hideMessage();},submisson:function(){mstrApp.showMessage();},success:function(k){var a=k.node,d,j=document.createElement("div"),q=j.style,o=a.defn.fmts.width,f=a.defn.fmts.height||a.data.mh;d=new mstrmojo.Overlay({children:[k]});d.set("width",o);d.set("height",f);var l=document.createElement("div");d.placeholder=l;d.render();q.overflow="hidden";j.appendChild(d.domNode);var g=new google.maps.InfoWindow({content:j});M.openedInfoWindow=g;g.open(N,P);var b=300,p=0,Z=window.setInterval(function(){var t=j.parentNode;if(t){var h=t.offsetWidth,s=t.offsetHeight;if(h!==parseInt(o,10)||s!==parseInt(f,10)){d.setDimensions(s+"px",h+"px");window.clearTimeout(Z);}}p+=b;if(p>10*b){window.clearTimeout(Z);}},b);}},true);}});},getInfoWindowSelectorControl:function E(M){if(!this.sc){this.sc=M.gts.row[0].sc;}return this.sc;},postHandleMarkerClick:function H(P,M){var R=this.gridData,Q=this.getInfoWindowSelectorControl(R);if(Q&&Q.tks){var O=this,S=null,N=O.model.docModel;N.getDataService().setDocSelectorElements(Q.ck,M.eid,Q.ckey,Q.include,{success:function(x){var s=N.getTargetDefn(Q.tks);if(x.pukeys){s=N.getTargetDefn(x.pukeys);}S=N.updateDataCache(x.data,s);var q=O.findSelectorTarget(Q);if(q){var Z=N.getTargetDefn(q),T="*l"+x.currlaykey+"*k"+q+"*x1*t"+N.buildTime,g=T+"_ifw",U=mstrmojo.all[g];if(U){U.destroy();}var X=new mstrmojo.maps.jsmap.AndroidDocMapInfoWindow({id:g,parent:O,builder:O.builder,model:N,psKey:q,psId:T});var f=Z[q].fmts,k=document.createElement("div"),l=k.style,a=f.width,p=f.height;X.set("width",a);X.set("height",p);var Y=document.createElement("div");X.placeholder=Y;X.render();l.height=p;l.width=a;l.overflow="hidden";k.appendChild(X.domNode);var V=new google.maps.InfoWindow({content:k});var o=V.close;V.close=function(){o.call(V);X.destroy();delete O.openedInfoWindow;};O.openedInfoWindow=V;V.open(P,M);var b=300,d=0,W=window.setInterval(function(){var w=k.parentNode;if(w){var h=w.offsetWidth,t=w.offsetHeight;if(h!==parseInt(a,10)||t!==parseInt(p,10)){X.setDimensions(t+"px",h+"px");window.clearTimeout(W);}}d+=b;if(d>10*b){window.clearTimeout(W);}},b);}var j={name:"partialUpdate",tree:x.data,ids:S};if(!mstrmojo.hash.isEmpty(j.ids.ifws)){delete j.ids.ifws[q];}N.raiseEvent(j);}},N.zf,true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidMap");mstrmojo.maps.jsmap.AndroidRptMap=mstrmojo.declare(mstrmojo.maps.jsmap.AndroidMap,null,{scriptClass:"mstrmojo.maps.jsmap.AndroidRptMap",setModel:function A(B){this._super(B);this.controller.getPageByTree(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.androidmap.AndroidMap","mstrmojo.maps.androidmap.AndroidDocMapInfoWindow","mstrmojo.Image","mstrmojo.DynamicClassFactory","mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.DocPanel","mstrmojo.hash","mstrmojo.array","mstrmojo.dom");var F=mstrmojo.dom;var a=0,K=1,R=mstrmojo.hash;function G(f){if(!f||!f.p_fmts){return f;}var d=f.p_fmts;var g=parseInt(d.top)||0;var h=parseInt(d.height)||0;var b=parseInt(f.height)||0;return{top:(g+h-b)+"px",left:d.left,width:f.width,height:f.height,"z-index":d["z-index"]};}function Y(j,h){if(j&&h){if(j["z-index"]>h["z-index"]){return false;}var d=parseInt(j.left),p=parseInt(j.top),g=parseInt(j.width),l=parseInt(j.height),b=parseInt(h.left),o=parseInt(h.top),f=parseInt(h.width)||0,k=parseInt(h.height)||0;return((((d<=b)&&(b<d+g))||((b<d)&&(d<b+f)))&&(((p<=o)&&(o<p+l))||((o<p)&&(p<o+k))));}return false;}function L(){if(!mstrApp.renderingMap||(mstrApp.renderingMap===this.id)){mstrApp.renderingMap=this.id;return true;}else{return false;}}function P(){if(mstrApp.renderingMap===this.id){delete mstrApp.renderingMap;return true;}return false;}mstrmojo.maps.androidmap.AndroidDocMap=mstrmojo.declare(mstrmojo.maps.androidmap.AndroidMap,[mstrmojo._Formattable],{scriptClass:"mstrmojo.maps.androidmap.AndroidDocMap",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@domNodeCssText}" mstrAttach:touchstart></div>',formatHandlers:{domNode:["left","top","z-index","height","width","border","border-color","border-style","border-width"]},sc:null,domNodeCssText:"position:relative;",lastSelectedRow:null,hasTarget:function J(){var b=this.getInfoWindowSelectorControl(this.gridData);return !!(b&&b.tks);},postBuildRendering:function U(){this._touchListener=mstrmojo.touchManager.attachEventListener("touchesBegin",this.id,function(b){var d=this.openedInfoWindow;if(d){if(!F.contains(this.domNode,b.touch.target,true,document.body)){d.close();}}});return this._super();},destroy:function X(b){var d=this._touchListener;if(d){mstrmojo.touchManager.detachEventListener(d);delete this._touchListener;}if(this.mapRendered){this.removeMap();}this._super(b);},setModel:function M(b){this.doc=b.controller.view;this._super(b);},initFromVisProps:function W(b){this._super(b);if(!b){return ;}this.iwDocLayout=(parseInt(b.dl,10)===1);if(b.lyt){this.iwLayoutKey=b.lyt;}},findSelectorTarget:function O(k){if(k&&k.tks){var g=this.xtabModel.docModel,f=k.tks.split("\u001E"),h=0,b=f.length;for(h=0;h<b;++h){var j=g.getTargetDefn(f[h]);if(j[f[h]].ifw){return f[h];}}}return null;},findIntersectingComponents:function C(){var g=this,k,f=this.getFormats();while(g.scriptClass!="mstrmojo.DocSubsection"||g.scriptClass!="mstrmojo.DocInfoWindow"){k=g;g=g.parent;if(!g){break;}var j=g.children,d=(j&&j.length)||0,h=null,b;for(b=0;b<d;b++){h=j[b];if(h!=k&&h.getFormats&&Y(G(f),G(h.getFormats()))){return true;}}}return false;},getGridModel:function(){var b=this._super();delete b.layoutModel;delete b.layoutNode;return b;},dispatchMapData:function B(){if(!L.call(this)){this.domNode.innerHTML=mstrmojo.desc(9480,"Only one map visualization is supported at a time");mstrmojo.css.addClass(this.domNode,"noMapVis");return ;}var h=this.doc,b=h.model,f=this.getViewHierarchy(),g=this.getMapModel(),p=this.simplifyGridData(),j=(h.getSupportedLayouts&&h.getSupportedLayouts())||h.getLayouts(),k=!!this.isFullScreenWidget?K:a,o=false,l=h.getCurrentLayout(),d;d=JSON.stringify({did:h.did,ttl:h.ttl,st:h.st,mid:b.mid,ci:b.ci,bs:b.bs,zt:b.zt,defn:b.defn,currlaykey:b.currlaykey});delete g.model;if(l.setMapID){l.setMapID(this.id);}if(!k){o=this.findIntersectingComponents();}mstrMobileApp.loadMap(JSON.stringify(R.copy({fullScreen:k,infoWindow:this.getInfoWindowConfig(),viewTree:f,mapPath:this.mapPath,active:o,docModelId:this.xtabModel.docModel.id,hasTarget:this.hasTarget(),zt:b.zt,gdProp:p.prop},g)),p.es,p.data,d);this.mapRendered=true;},getViewHierarchy:function(){var k=[];var h=this.parent,b=[],j=R.copy(this.fmts,{}),d=this;b.push(j);while(h){j=R.copy(h.fmts,{});j.id=h.id;k.push(j.id);if(h.scriptClass==="mstrmojo.MobileDocLayoutViewer"){delete j.width;delete j.height;}else{if(h instanceof mstrmojo.DocPanel){var g=parseInt(h.domNode.style.left,10);if(g>0){h.parent._scrollOffsetLeft=g;}}else{if(h.scriptClass==="mstrmojo.DocSection"){if(h.domNode.offsetTop){j.top=h.domNode.offsetTop+"px";}}else{if(h.scriptClass==="mstrmojo.DocInfoWindow"){if(h.containerNode){j.top=h.containerNode.offsetTop+"px";j.left=h.containerNode.offsetLeft+"px";}h.onClose=function(){mstrMobileApp.hideMapView(1);};}}}}if(h._scroller){if(!h._scroller.scrollMoveListener){var f=function(l){mstrMobileApp.scrollerUpdated(JSON.stringify({id:this.id,x:l.x-(this._scrollOffsetLeft||0),y:l.y}));};h._scroller.attachEventListener("scrollMoved",h.id,f);h._scroller.attachEventListener("scrollDone",h.id,f);h._scroller.attachEventListener("transformAnim",h.id,f);h._scroller.scrollMoveListener=true;}j.scroller=true;}b.splice(0,0,j);h=h.parent;}this.mapPath=k.join("")+":"+JSON.stringify(b);return b;},getInfoWindowConfig:function T(){if(!this.iwConfig){if(this.iwDocLayout){this.iwConfig={dft:false};}else{var j=this.gridData,h=this.getInfoWindowSelectorControl(j);if(h){var f=this.xtabModel.docModel,g=f.getTargetDefn(h.tks);if(this.findSelectorTarget(h)){this.iwConfig={dft:false};if(g&&g[h.tks]){var b=g[h.tks].fmts;this.iwConfig.size={w:parseInt(b.width,10),h:parseInt(b.height,10)};return this.iwConfig;}}}this.iwConfig={dft:true};}}return this.iwConfig;},resetLayout:function E(){if(this.iwDocLayout&&this.preIWLayout){this.doc.selectLayout(this.preIWLayout,true,null,true);this.preIWLayout=null;}},closeInfoWindow:function D(){do{mstrApp.closeDialog();}while(mstrmojo.all.mstrMapInfoWindow);},removeMarkerAnchor:function Q(){var b=mstrmojo.all.mstrMapMarkerAnchor;if(b){b.destroy();}},beforeViewHidden:function I(b){this.unrender();},handleMarkerSelection:function H(b,g,f){this.removeMarkerAnchor();var d=mstrmojo.insert({id:"mstrMapMarkerAnchor",scriptClass:"mstrmojo.Box",cssText:"left:"+g+"px;top:"+f+"px;position:absolute;z-index:100",width:"1px",height:"1px"});d.render();document.body.appendChild(d.domNode);this.handleMarkerTargetSelection(b,d);this.handleMarkerInfoWindowLayoutSelection(b,d);},handleMarkerInfoWindowLayoutSelection:function A(x,k){var q=this.gridData,w=q.gts.row[0],j=w.id,b=q.ghs.rhs.items[x],t=b&&b.items[0].idx,f=this,g=(t>=0)?w.es[t].id:-1;if(this.iwDocLayout){var AA=this.doc,z=AA.getLayouts(),h=this.iwLayoutKey,l=z[mstrmojo.array.find(z,"k",h)],AB="\x1F",p="12",s=j+AB+p+AB+g;var o={layoutKey:h,groupByIDs:s,reload:true};if(!this.preIWLayout){this.preIWLayout=z[mstrmojo.array.find(z,"k",this.defn._lkz)];}(function(AH,AF){var AE=AA,d=AE.model,AG=d.getDataService(),AC=AH.layoutKey,AD=AF[mstrmojo.array.find(AF,"k",AC)];if(AD.defn&&(AH.reload||AD.defn.loaded===false)){AG.loadDocLayout(AH,{success:function(AS){var AP=f.xtabModel.docModel,AV=h,AR;AS.key=AV;AS.isSelected=false;AP.replaceLayout(AV,AS);AR=AA.rebuildLayout(AV,AF);f.lastSelectedRow=x;var AL=AR.node,AN,AJ=mstrApp.getScreenDimensions(),AW=AJ.w*0.85,AQ=AJ.h*0.9,AI=AJ.w*0.6,AT=AJ.h*0.5,AU=AL.defn.fmts.width||(AI+"px"),AO=AL.defn.fmts.height||AL.data.mh||(AT+"px");f.closeInfoWindow();AN=new mstrmojo.Overlay({cssClass:"iwOverlay",children:[AR]});AN.set("width",AU);AN.set("height",AO);mstrApp.showPopup({id:"mstrMapInfoWindow",cssClass:"mapInfoWindow",scriptClass:"mstrmojo.android.Popup",anchorOffset:1,onClose:function(){window.setTimeout(function(){f.resetLayout();},0);},resizeDialog:function(){var AZ=this.editorNode;if(mstrApp.isTablet()){var AY=this.popDimensions;if(AY){AQ=AY.h;AW=AY.w;}else{AQ=Math.min(488,AQ);AW=Math.min(550,parseInt(AU,10));}}this.set("width",Math.min(parseInt(AU,10),AW)+"px");if(AZ){AZ.style.height=Math.min(parseInt(AO,10),AQ)+"px";}mstrmojo.Dialog.prototype.resizeDialog.call(this);},children:[AN]},k.domNode);var AM=300,AX=0,AK=window.setInterval(function(){var Aa=AN.parent.editorNode;if(Aa){var AY=Aa.clientWidth,AZ=Aa.clientHeight;if(AY!==parseInt(AU,10)||AZ!==parseInt(AO,10)){AN.setDimensions(AZ+"px",AY+"px");window.clearTimeout(AK);}}AX+=AM;if(AX>10*AM){window.clearTimeout(AK);}},AM);AA.selectLayout(AD,true);}});}else{AE.selectLayout(AD,true);}})(o,z);}},handleMarkerTargetSelection:function V(w,k){var o=this.gridData,s=o.gts.row[0],j=s.id,b=o.ghs.rhs.items[w],q=b&&b.items[0].idx,f=this,g=(q>=0)?s.es[q].id:-1;var p=this.getInfoWindowSelectorControl(o),h=this.findSelectorTarget(p);if(p&&p.tks){var t=null,l=f.xtabModel.docModel;l.getDataService().setDocSelectorElements(p.ck,g,p.ckey,p.include,{success:function(AE){var AA=l.getTargetDefn(p.tks);if(AE.pukeys){AA=l.getTargetDefn(AE.pukeys);}t=l.updateDataCache(AE.data,AA);var AB=f.findSelectorTarget(p);if(AB){var AD=l.getTargetDefn(AB),x=AB+"_ifw",AG=mstrmojo.all[x],d="*l"+AE.currlaykey+"*k"+AB+"*x1*t"+l.buildTime;if(AG){AG.destroy();}var z=new mstrmojo.maps.androidmap.AndroidDocMapInfoWindow({id:x,builder:f.doc.builder,model:l,psKey:AB,psId:d});var AF=AD[AB].fmts,AC=parseInt(AF.width,10)||width,AI=parseInt((AF.p_fmts&&AF.p_fmts.height)||AF.height,10)||height;z.set("width",AC+"px");z.set("height",AI+"px");mstrApp.showPopup({id:"mstrMapInfoWindow",scriptClass:"mstrmojo.android.Popup",cssClass:"mapInfoWindow",anchorOffset:1,children:[z],resizeDialog:function(){var AJ=this.editorNode;this.set("width",AC+"px");if(AJ){AJ.style.height=AI+"px";}mstrmojo.Dialog.prototype.resizeDialog.call(this);}},k.domNode);}var AH={name:"partialUpdate",tree:AE.data,ids:t,anchor:k.domNode};if(!mstrmojo.hash.isEmpty(AH.ids.ifws)){delete AH.ids.ifws[AB];}l.raiseEvent(AH);}},l.zf,true);}},getInfoWindowSelectorControl:function S(b){if(!this.sc&&!b.eg){this.sc=b.gts.row[0].sc;}return this.sc;},afterViewVisible:function N(){window.setTimeout(function(){mstrMobileApp.showMapView(1);},300);},removeMap:function Z(){this.closeInfoWindow();this.removeMarkerAnchor();this.resetLayout();if(P.call(this)){mstrMobileApp.hideMapView(1);}},unrender:function(){this.lastSelectedRow=null;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.androidmap.AndroidMap");mstrmojo.maps.androidmap.AndroidRptMap=mstrmojo.declare(mstrmojo.maps.androidmap.AndroidMap,null,{scriptClass:"mstrmojo.maps.androidmap.AndroidRptMap",setModel:function A(B){this._super(B);this.controller.getPageByTree(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisChart");var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;mstrmojo.VisMicroChartBar=mstrmojo.declare(mstrmojo.VisChart,null,{scriptClass:"mstrmojo.VisMicroChartBar",isDrawAxis:false,margin:{t:0,r:1,b:0,l:1},showHighlightLine:false,themeColor:"#FFFFFF",noBackground:true,isAnimateLines:false,toolTipMain:null,labelLen:0,mainWidth:0,mainLeftPos:0,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};position:relative;"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><div style="position:absolute;left:0px;top:0px;padding-left:1px;padding-top:1px;text-align:left;-webkit-text-size-adjust: none"></div><div style="position:absolute;left:0px;bottom:0px;padding-left:1px;padding-bottom:1px;text-align:left;-webkit-text-size-adjust: none"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},animationCanvas:function(){return this.domNode.childNodes[1];},highlightCanvas:function(){return this.domNode.childNodes[2];},minLabel:function(){return this.domNode.childNodes[3];},maxLabel:function(){return this.domNode.childNodes[4];}},postBuildRendering:function postBR(){if(this._super){this._super();}this.windowSize=this.model.series[0].rv.length;if(this.windowSize===1){this.plot();}},getTouchValue:function gtvlindx(touchX){var series=this.model.series[0];var ind=0;for(var i=0;i<series.v.length;i++){if(touchX<this.hightLightPos[i].x){if(i===0){ind=i;}else{ind=(this.hightLightPos[i].x+this.hightLightPos[i-1].x)/2>touchX?(i-1):i;}break;}}if(i!==series.v.length){}else{ind=i-1;}return ind;},isTouchPointInGraphRange:function tpInGR(touchX,touchY){if(touchX<=this.labelLen+1||touchX>=this.getWidth()-1){return false;}return true;},showTooltip:function rndrttp(pageX,pageY){if(!this.config.mbShowTooltip||this.noDataToShowTtp){return false;}var m=this.model,series=m.series[0];if(series.rv.length<=1){return false;}var pos=mstrmojo.dom.position(this.domNode,true);var touchX=pageX-pos.x;var touchY=pageY-pos.y;if(!this.isTouchPointInGraphRange(touchX,touchY)){return false;}var touchVal=this.getTouchValue(touchX,touchY);var x=this.hightLightPos[touchVal].x;if(this.widget.enableSmoothScroll){if(this.domNode.offsetLeft+x<this.widget._scroller.origin.x){return false;}}this.prevHighlight=this.currentHighlight;this.currentHighlight=touchVal;if(!this.widget.tooltipShow||this.prevHighlight!=this.currentHighlight){touchX=Math.round(this.hightLightPos[touchVal].x);touchY=Math.round(this.hightLightPos[touchVal].y);var vl=series.rv[touchVal]*1;var tColor=this.posBarColor;if(vl<0){tColor=this.negBarColor;}if(series.thClr&&series.thClr[touchVal]){tColor=series.thClr[touchVal];}this.renderTooltip(touchVal,x,touchY,tColor);this.highlightPoint(touchX,touchY,tColor);}return true;},renderTooltip:function rndrttp(valIndex,touchX,touchY,tColor){var model=this.model;var barProps=this.config;var series=model.series[0],categories=model.categories.items,width=this.getWidth();var metrics=model.mtrcs;metrics=metrics.items;var ttp=this.toolTipMain;var line1=model.categories.tn+": "+categories[valIndex];if(isNaN(this.kpiOffset)){this.kpiOffset=0;}if(
/*this.widget.isKPI && */
this.widget.sparklineProps.mstrAssMetric){line2=this.widget.sparklineProps.mstrAssMetric+": "+series.v[valIndex];}else{line2=metrics[this.kpiOffset]+": "+series.v[valIndex];}var maxLength=this.widget.getTextWidthByCanvas(line1,ttp);var leng2=this.widget.getTextWidthByCanvas(line2,ttp);if(leng2>maxLength){maxLength=leng2;}var domHtml=line1+"<br/>"+line2;if(this.refv&&this.refv.length>1&&this.config.mbRefLine){domHtml+="<br/>";var line3=metrics[this.kpiOffset+1]+": "+this.refv[1].v;var leng3=this.widget.getTextWidthByCanvas(line3,ttp);if(leng3>maxLength){maxLength=leng3;}domHtml+=line3;}ttp.innerHTML='<div style="margin-left:5px;margin-bottom:4px;margin-top:5px;">'+domHtml+"</div>";var pos=mstrmojo.dom.position(this.domNode,true);var posWdt=mstrmojo.dom.position(this.widget.domNode,true);var oft={left:pos.x-posWdt.x,top:pos.y-posWdt.y};var maxWidth=maxLength+10;ttp.style.display="block";ttp.style.borderColor=tColor;ttp.style.width=maxWidth+"px";var topOff=(touchY+pos.y-posWdt.y-ttp.offsetHeight-29);if(topOff<0){topOff=0;}var leftOff=(oft.left+touchX+maxWidth+20);if(leftOff>this.widget.getWidth()){leftOff=(touchX+oft.left-maxWidth-20);if(leftOff<0){leftOff=0;}}else{leftOff-=maxWidth;}ttp.style.display="none";ttp.style.top=(topOff)+"px";ttp.style.left=(leftOff)+"px";ttp.style.display="block";},highlightPoint:function highlightPoint(touchX,touchY,tColor){var ctx=this.highlightContext,width=this.getWidth(),height=this.getHeight(),utils=this.utils;ctx.clearRect(0,0,width,height);ctx.globalAlpha=1;touchX=touchX>5?touchX:5;if(touchX>width-5){touchX=width-5;}touchY=touchY>5?touchY:5;if(touchY>height-5){touchY=height-5;}ctx.globalAlpha=0.8;ctx.strokeStyle="FFFFFF";ctx.fillStyle=ctx.strokeStyle;utils.drawArc(this,touchX,touchY,5,0,Math.PI*2,true,true,ctx);ctx.strokeStyle=tColor;ctx.fillStyle=ctx.strokeStyle;ctx.globalAlpha=1;utils.drawArc(this,touchX,touchY,5,0,Math.PI*2,true,false,ctx);utils.drawArc(this,touchX,touchY,2.5,0,Math.PI*2,true,true,ctx);this.highlightCanvas.id="highLightCav"+this.widget.domNode.id;},textLen:function txtLn(str){var len=0;for(var i=0;i<str.length;i++){if(str.charCodeAt(i)>255||str.charCodeAt(i<0)){len+=2;}else{len++;}}return len;},handleTouchMove:function(){},reDrawChart:function reDrwchart(){var context=this.context,canvas=this.canvas,wd=canvas.width,ht=canvas.height;context.clearRect(0,0,wd,ht);this.data.processLinearData(this);this.windowSize=this.model.series[0].rv.length;this.utils.fillBackground(this);if(this.windowSize<1){return ;}this.drawChart();},setColorByTheme:function setColorByTheme(){var barProps=this.config;if(this.theme==DEFAULT_DARK_THEME||this.theme==DEFAULT_LIGHT_THEME){this.posBarColor="#598200";this.negBarColor="#CC3A06";this.xAxisLineWidth=1;this.xAxisLineColor="#7F7F7F";this.refLineWidth=1;this.refLineColor="#00A6EF";}else{this.posBarColor=barProps.mwPosCol;this.negBarColor=barProps.mwNegCol;this.xAxisLineWidth=1;this.xAxisLineColor="#000000";this.refLineWidth=1;this.refLineColor=barProps.mwRefLineCol;}},drawChart:function drwchrt(){var model=this.model;var barProps=this.config;if(model.err){this.noDataToShowTtp=true;return ;}this.setColorByTheme();var context=this.context,values=model.series,height=this.getHeight(),width=this.getWidth(),me=this,utils=this.utils;var barOffset=0;var barPadLeft=this.margin.l;var barPadRight=this.margin.r;var min=0,max=0,minLabel=maxLabel="",series=model.series[0];for(var i=0;i<series.v.length;i++){var vl=parseFloat(series.rv[i]);if(i===0){max=min=vl;minLabel=maxLabel=series.v[i];}else{if(vl>max){max=vl;maxLabel=series.v[i];}else{if(vl<min){min=vl;minLabel=series.v[i];}}}}if(isNaN(min)&&isNaN(max)){this.minLabel.innerHTML="";this.maxLabel.innerHTML="";this.noDataToShowTtp=true;return ;}this.noDataToShowTtp=false;if(barProps.mbShowLegend){var fontSize=Math.ceil(Math.min(12,(height/2)*0.7));var mintxt="Min:"+minLabel.replace(/[ ]/g,"");var maxtxt="Max:"+maxLabel.replace(/[ ]/g,"");this.minLabel.innerHTML=mintxt;this.maxLabel.innerHTML=maxtxt;var maxBarOffset=width-10;if(maxBarOffset>width*0.5){maxBarOffset=Math.floor(width*0.5);}do{this.minLabel.style.fontSize=fontSize+"px";this.maxLabel.style.fontSize=fontSize+"px";var fontFamily="Arial";var minTxtLen=this.widget.getTextWidth(mintxt,"",fontFamily,fontSize,"px",this.isTextBold);var maxTxtLen=this.widget.getTextWidth(maxtxt,"",fontFamily,fontSize,"px",this.isTextBold);var txtLen=minTxtLen>maxTxtLen?minTxtLen:maxTxtLen;barOffset=txtLen+barPadLeft;fontSize-=1;}while(barOffset>maxBarOffset&&fontSize>5);fontSize+=1;}else{barOffset=barPadLeft;}this.labelLen=barOffset;if(this.refv&&this.refv.length>1&&barProps.mbRefLine){var refValue=this.refv[1].rv*1;if(refValue<min){min=refValue;}if(refValue>max){max=refValue;}}var ts=max-min;var baseY=0;var barPadTop=5;var barPadBottom=5;var rangeRatio=height-barPadTop-barPadBottom;if(ts==0){if(min==0){baseY=height/2;rangeRatio=0;}else{rangeRatio/=Math.abs(max);if(max<0){baseY=barPadTop;}else{baseY=height-barPadBottom;}}}else{if(max<0){baseY=barPadTop;rangeRatio/=Math.abs(min);}else{if(min<0){baseY=max/ts*rangeRatio+barPadTop;rangeRatio/=ts;}else{baseY=height-barPadBottom;rangeRatio/=max;}}}var barTotalWidth=width-barOffset-barPadRight;var barCount=series.v.length;var barSpaceWidth=barTotalWidth*0.4/barCount;barSpaceWidth=barSpaceWidth>=1?barSpaceWidth:1;var barWidth=barTotalWidth/barCount-barSpaceWidth;this.hightLightPos=[];for(var i=0;i<barCount;i++){this.hightLightPos[i]={};var vl=series.rv[i]*1;var direct=true;if(vl<0){vl=0-vl;direct=false;}var hgt=vl*rangeRatio;var cw=(width-barOffset)/series.v.length;this.drawBar(barOffset+(barWidth+barSpaceWidth)*i+barSpaceWidth/2,baseY,barWidth,hgt,context,series.thClr&&series.thClr[i],direct,this.hightLightPos[i]);}context.strokeStyle=this.xAxisLineColor;context.lineWidth=this.xAxisLineWidth;if(context.lineWidth%2===1){baseY=Math.round(baseY+0.5)-0.5;}context.beginPath();context.moveTo(barOffset,baseY);context.lineTo(width-barPadRight,baseY);context.stroke();if(this.refv&&this.refv.length>1&&barProps.mbRefLine){var refValue=this.refv[1].rv*1;var refH=baseY-refValue*rangeRatio;if(context.lineWidth%2===1){refH=Math.round(refH+0.5)-0.5;}context.beginPath();context.moveTo(barOffset,refH);context.lineTo(width-barPadRight,refH);context.strokeStyle=this.refLineColor;context.stroke();}},drawBar:function drwBr(x,y,width,height,context,color,direct,posStore){if(width>=3){x=Math.round(x);y=Math.round(y);width=Math.round(width);}if(height!=0){height=Math.round(height);if(height<1){height=1;}}if(direct){context.fillStyle=color?color:this.posBarColor;context.fillRect(x,y-height,width,height);posStore.x=x+Math.round(width/2);posStore.y=y-height;}else{context.fillStyle=color?color:this.negBarColor;context.fillRect(x,y,width,height);posStore.x=x+Math.round(width/2);posStore.y=y+height;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisChart");var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;mstrmojo.VisMicroChartLine=mstrmojo.declare(mstrmojo.VisChart,null,{scriptClass:"mstrmojo.VisMicroChartLine",isDrawAxis:false,margin:{t:5,r:2,b:1,l:2},showHighlightLine:false,themeColor:"#FFFFFF",isDrawRefArea:true,noBackground:true,isAnimateLines:false,toolTipMain:null,mainWidth:0,mainLeftPos:0,reDrawChart:function reDrwchart(){var context=this.context,canvas=this.canvas,wd=canvas.width,ht=canvas.height;context.clearRect(0,0,wd,ht);this.data.processLinearData(this);this.windowSize=this.model.series[0].rv.length;this.utils.fillBackground(this);if(this.windowSize<=1){return ;}this.drawChart();},setColorByTheme:function setColorByTheme(){var lineProps=this.config;if(this.theme===DEFAULT_DARK_THEME||this.theme===DEFAULT_LIGHT_THEME){this.startPointColor="#50B5D8";this.endPointColor="#50B5D8";this.otherPointColor="#50B5D8";this.isDrawRefArea=false;this.sparkLineColor="#50B5D8";this.refLineColor="#FF781D";}else{this.startPointColor="#000000";this.endPointColor="#FF0000";this.otherPointColor="#663300";this.isDrawRefArea=lineProps.mbRefArea;this.sparkLineColor=lineProps.mwSeriesLineCol;this.refLineColor=lineProps.mwRefLineCol;}var dpi=mstrMobileApp.getDeviceDPI();this.sparkLineWidth=dpi>160?2:1;this.refLineWidth=1;this.startEndPointRadius=dpi>=320?4:dpi>=240?3:2;},drawChart:function drwchrt(){this.setColorByTheme();var lineProps=this.config;var context=this.context;var model=this.model;var values=model.series;var mvalues=model.mvalues;var margin=this.margin;var height=this.getHeight();var width=this.getWidth();var utils=this.utils;var maxVR=mvalues[mvalues.length-1];var minVR=mvalues[0];var maxYValue=mvalues[mvalues.length-1];var minYValue=mvalues[0];if(this.refv&&this.refv.length>1&&lineProps.mbRefLine){var refValue=parseFloat(this.refv[1].rv);if(isNaN(refValue)){}else{if(refValue>maxVR){maxVR=refValue;if(mvalues.length===1){mvalues[1]=maxVR;}else{mvalues[mvalues.length-1]=maxVR;}}if(refValue<minVR){minVR=refValue;if(mvalues.length===1){mvalues[1]=mvalues[0];mvalues[0]=maxVR;}else{mvalues[0]=minVR;}}}}this.themeColor=lineProps.mwRefAreaCol;this.isDrawStartEndPoints=lineProps.mbAllPoints?7:(lineProps.mbEndPoints?3:0);if(this.isDrawStartEndPoints&1&&margin.l<this.startEndPointRadius){margin.l=this.startEndPointRadius;}if(this.isDrawStartEndPoints&2&&margin.r<this.startEndPointRadius){margin.r=this.startEndPointRadius-1;}if(model.err){return ;}if(!values){return ;}if(maxVR!==minVR){this.RTY=(height-margin.t-margin.b-4)/(maxVR-minVR);}else{this.RTY=0;}if(this.windowSize!==1){this.RTX=(width-margin.l-margin.r-1)/(this.windowSize-1);}else{this.RTX=0;}var lines=[];var k=0;for(var i=0;i<this.windowSize;i++){var val=values[0].rv[i];if(val.length===0){continue;}var x=(i*this.RTX)+margin.l;var y=utils.getYValue(this,val);lines[k]={x:x,y:y};k++;}if(lines.length===0){return ;}maxYValue=utils.getYValue(this,maxYValue);minYValue=utils.getYValue(this,minYValue);if(maxYValue===undefined||minYValue===undefined){maxYValue=height-4-margin.b;minYValue=margin.t;}if(this.isDrawRefArea){context.fillStyle=this.themeColor;context.fillRect(margin.l,minYValue,width-margin.r-margin.l,(maxYValue-minYValue));}context.lineCap="round";context.lineWidth=this.sparkLineWidth;context.lineJoin="round";context.strokeStyle=this.sparkLineColor;utils.drawLineSet(this,lines,false,context);if(this.isDrawStartEndPoints){utils.drawStartEndPoints(this,lines,context,this.isDrawStartEndPoints);}if(this.refv&&this.refv.length>1&&lineProps.mbRefLine){var refValue=this.refv[1].rv*1;var y=this.utils.getYValue(this,refValue);if(isNaN(y)){y=height-5;}if(context.lineWidth%2===1){y=Math.round(y+0.5)-0.5;}context.beginPath();context.moveTo(margin.l,y);context.lineTo(width-margin.r,y);context.lineWidth=this.refLineWidth;context.strokeStyle=this.refLineColor;context.stroke();}},highlightPoint:function hghlghtpnt(x,touchY){var me=this,ctx=me.highlightContext,height=me.getHeight(),width=me.getWidth(),margin=me.margin,model=me.model,utils=me.utils;ctx.clearRect(0,0,width,height);if(x<0){return ;}var xcoord=(x*me.RTX)+margin.l;ctx.globalAlpha=1;ctx.strokeStyle=this.sparkLineColor;ctx.fillStyle=ctx.strokeStyle;var y=utils.getYValue(me,model.series[0].rv[x]);if(xcoord<5){xcoord=5;}if(xcoord>width-5){xcoord=width-5;}if(y<5){y=5;}if(y>height-5){y=height-5;}ctx.strokeStyle="FFFFFF";ctx.fillStyle=ctx.strokeStyle;ctx.globalAlpha=0.8;utils.drawArc(this,xcoord,y,5,0,Math.PI*2,true,true,ctx);ctx.strokeStyle=this.sparkLineColor;ctx.fillStyle=ctx.strokeStyle;ctx.globalAlpha=1;utils.drawArc(me,xcoord,y,5,0,Math.PI*2,true,false,ctx);utils.drawArc(me,xcoord,y,2.5,0,Math.PI*2,true,true,ctx);this.highlightCanvas.id="highLightCav"+this.widget.domNode.id;},renderTooltip:function rndrttp(valIndex,touchX,touchY){if(valIndex<0){this.toolTipMain.style.display="none";return ;}var highLightCav=document.getElementById("highLightCav"+this.widget.domNode.id);if(highLightCav){var highlightCt=highLightCav.getContext("2d");highLightCav.id="";highlightCt.clearRect(0,0,1000,1000);}var m=this.model,s=m.series,utils=this.utils,l=s.length,si=this.seriesIndex,ch=m.colHeaders,rh=this.baseModel.rowHeaders,ttp=this.toolTipMain;var me=this,ctx=me.highlightContext,height=me.getHeight(),width=me.getWidth(),margin=me.margin,utils=me.utils;var metrics=m.mtrcs;metrics=metrics.items;if(isNaN(this.kpiOffset)){this.kpiOffset=0;}var sn="";var line1=m.categories.tn+": "+m.categories.items[valIndex];var line2;if(
/*this.widget.isKPI &&*/
this.widget.sparklineProps.mstrAssMetric){line2=this.widget.sparklineProps.mstrAssMetric+": "+s[0].v[valIndex];}else{line2=metrics[this.kpiOffset]+": "+s[0].v[valIndex];}var relx=(valIndex*me.RTX)+margin.l;var rely=utils.getYValue(me,s[0].rv[valIndex]);var leng1=this.widget.getTextWidthByCanvas(line1,ttp);var leng2=this.widget.getTextWidthByCanvas(line2,ttp);var domHtml=line1+"<br/>"+line2;var leng3=0;if(this.refv&&this.refv.length>1&&this.config.mbRefLine){domHtml+="<br/>";var line3=metrics[this.kpiOffset+1]+": "+this.refv[1].v;leng3=this.widget.getTextWidthByCanvas(line3,ttp);domHtml+=line3;}ttp.innerHTML='<div style="margin-left:5px;margin-bottom:4px;margin-top:5px;">'+domHtml+"</div>";var maxLength=Math.max(leng1,leng2,leng3);var oft=mstrmojo.boxmodel.offset(this.domNode,this.widget.domNode);var pos=mstrmojo.dom.position(this.domNode,true);var posWdt=mstrmojo.dom.position(this.widget.domNode,true);var maxWidth=maxLength+10;ttp.style.display="block";ttp.style.borderColor=this.sparkLineColor;ttp.style.width=maxWidth+"px";var topOff=(rely+pos.y-posWdt.y-ttp.offsetHeight-29);if(topOff<0){topOff=0;}var leftOff=(oft.left+relx+maxWidth+20);if(leftOff>this.widget.getWidth()){leftOff=(relx+oft.left-maxWidth-20);if(leftOff<0){leftOff=0;}}else{leftOff-=maxWidth;}ttp.style.top=topOff+"px";ttp.style.left=leftOff+"px";var yadjust=this.mainOffsetTop===0?ttp.offsetHeight+20:(2*ttp.offsetHeight)+30;var yPos=utils.getYValue(this,s[si].rv[valIndex])-yadjust+this.offsetTop;if(yPos<0){yPos=0;}if(this.mainWidth>0){var xposr=touchX+ttp.offsetWidth+this.offsetLeft-this.mainLeftPos;if(xposr>this.mainWidth){touchX-=(xposr-this.mainWidth);}}},isTouchPointInGraphRange:function tpInGR(touchX,touchY){var margin=this.margin;if(touchX<margin.l||touchY<margin.t||touchY>this.canvas.height-margin.b){return false;}return true;},showTooltip:function handleTouchMove(touchX,touchY){if(!this.config.mbShowTooltip){return false;}var me=this,m=me.model;if(m.series[0].rv.length<=1){return false;}var pos=mstrmojo.dom.position(this.domNode,true);touchX=touchX-pos.x;touchY=touchY-pos.y;if(!this.isTouchPointInGraphRange(touchX,touchY)){return false;}var touchVal=me.getTouchValue(touchX,touchY);var margin=this.margin;if(touchVal!==null){var x=(touchVal*me.RTX)+margin.l;if(me.widget.enableSmoothScroll){if(this.domNode.offsetLeft+x<this.widget._scroller.origin.x){return false;}}var rns=(m.rne-m.rns>1)?m.rns:m.rns-1;if(me.seriesIndex===-1||me.switchSeriesOnTouch){me.seriesIndex=me.utils.getSeriesIndexAndYValue(me,rns+touchVal,touchY).si;}if(m.series[me.seriesIndex].rv[rns+touchVal]===""){return false;}me.prevHighlight=me.currentHighlight;me.currentHighlight=touchVal;if(!me.widget.tooltipShow||me.prevHighlight!=me.currentHighlight){me.renderTooltip(touchVal,x,touchY);me.highlightPoint(touchVal,touchY);}return true;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisChart","mstrmojo.locales");var K=20;var I=-20;var O=25;var E=mstrmojo.hash;var A=null;mstrmojo.VisChartLine=mstrmojo.declare(mstrmojo.VisChart,null,{scriptClass:"mstrmojo.VisChartLine",fillinColor:null,rotateXLabels:false,isFillLinesArea:null,isAnimateLines:true,isDrawStartEndPoints:0,startEndPointRadius:5,startPointColor:null,endPointColor:null,prevLines:null,chartLineColors:["#0099FF","#FFB03C","#F26AE1","#888BF4","#93CA20","#FE2F68"],maxXLabels:6,DSS_XML_BASE_FORM_DATE:"8",drawChart:function L(){var T=this.model;if(T.err){return ;}var S=this.animationContext,U=T.mvalues,R=T.series,V=this.margin,Q=[],P=[],W=this.getHeight(),X=this.getWidth(),h=this,f=this.utils;if(!R){return ;}var g=R.length;if(this.isDrawAxis&&this.drawYAxisLabels){V.l=f.getLabelWidthForMargin(this,T.mls);}h.RTY=(W-V.t-V.b-5)/(U[U.length-1]-U[0]);h.RTX=(X-V.l-V.r-1)/(h.windowSize-1);var b=(U[0]+U[U.length-1])/2;var d=f.getYValue(h,b);for(var Z=0;Z<g;Z++){Q=[];var Y=0;for(var a=0;a<h.windowSize;a++){var l=R[Z].rv[a];if(l.length===0){continue;}Q[Y]={x:(a*h.RTX)+V.l,y:f.getYValue(h,l)};if(!this.prevLines){P[Y]={x:Q[Y].x,y:d};}Y++;}this.drawChartLine(Q,P,g,Z,S);if(!this.multiLine){break;}}this.prevLines=Q;},drawChartLine:function C(Z,W,R,T,P,Q){var V=this,Y=V.getHeight(),X=V.utils;var U={rate:6};P.strokeStyle=X.getColor(V);P.lineCap="round";P.lineWidth=Q||2;P.lineJoin="round";if(V.isAnimateLines&&(!V.multiLine||R===1)){if(V.prevLines){W=V.prevLines;if(W.length<Z.length){for(var S=W.length;S<Z.length;S++){W.push(Z[W.length-1]);}}}X.animateLineSet(V,V.prevLines||W,Z,U);}else{if(V.multiLine&&R>1){P.strokeStyle=V.chartLineColors[T%6];}X.drawLineSet(V,Z,false,P);if(V.isFillLinesArea){X.fillLinesArea(V,Z.slice(0));}if(V.isDrawStartEndPoints){X.drawStartEndPoints(V,Z,P,V.isDrawStartEndPoints);}}},setMicroChartProperties:function F(){this.isDrawAxis=false;this.margin={t:0,r:5,b:0,l:5};this.showHighlightLine=false;this.isDrawStartEndPoints=3;},initFromVisProps:function J(P){if(!P){return ;}if(P.thc){this.themeColor="#"+P.thc;}if(P.shl==="0"){this.showHighlightLine=false;}if(P.mc==="1"){this.setMicroChartProperties();}},postCreate:function N(){if(this._super){this._super();}if(this.rotateXLabels){this.margin.b=75;}if(typeof (this.isFillLinesArea)==="undefined"&&!this.multiLine){this.isFillLinesArea=true;}},drawLabels:function D(f){if(!this.isDrawAxis){return ;}if(this._super){this._super();}if(!this.drawXAxisLabels){return ;}var z=this,V=z.model.categories,s=V.items,R=V.tp,q=z.utils,t=z.margin,h=s.length,d=null,Y=null,X=0,o=null,P=z.isTimeSeries,g=z.animationContext,Q=z.drawGridLines;var b=z.prevXLabel;b.x=0;b.y=0;b.w=0;g.save();g.globalAlpha=1;g.strokeStyle=q.rgb2rgbStr(z.formatProp.textClr,0.35);g.lineWidth=1;g.lineCap="round";var T=h>z.maxXLabels?z.maxXLabels:h;var p=null;if(P){p=document.createElement("div");z.xdiv=p;T*=(z.totalChartWidth/(z.chartWidth));}if(z.rotateXLabels){X=z.canvas.height+I;}else{if(P){X=z.canvas.height-this.margin.b+5;}else{X=z.canvas.height-O;}}var a=Math.round(h/T);if(a===0){a=1;}var U=Math.round(a*z.RTX)-z.xLabelPadding;A=null;var S={mn:0,dt:0,yr:0};if(P){var w=-1;this.needRedrawVerticalLine=false;for(var j=z.ACrns;j<z.ACrne;j+=a){Y=((j-z.ACrns)*z.RTX);var k=s[j];if(w<0&&j>=z.model.rns){w=0;}if(P&&(R.toString()===z.DSS_XML_BASE_FORM_DATE)){if(w==0){A=null;w=1;}k=z.getFormattedDateLabel(k,S);}if(z.rotatXLabels){o=q.addLabel(z,k,Y-K,X,null,true,b);}else{o=q.addLabel(z,k,Y,X,null,false,b);}if(o){if(Q&z.drawVerticalGridLines){A=E.clone(S);if(!f){var Z=Math.floor(Y)+0.5;q.drawLineSet(z,[{x:Z,y:z.canvas.height-t.b},{x:Z,y:t.t}],false,g);}}}}}else{for(var j=0;j<h;j+=a){Y=(j*z.RTX)+t.l;var k=s[j];if(P&&(R.toString()===z.DSS_XML_BASE_FORM_DATE)){k=z.getFormattedDateLabel(k,S);}if(z.rotateXLabels){o=q.addLabel(z,k,Y-K,X,null,true,b);}else{o=q.addLabel(z,k,Y,X,U,false,b);}if(o){if(Q&z.drawVerticalGridLines){A=E.clone(S);q.drawLineSet(z,[{x:Y,y:z.canvas.height-t.b},{x:Y,y:t.t}],false,g);}}}}if(p){if(this.isTimeSeries){z.xLabelsDiv.innerHTML=p.innerHTML;z.xdiv=null;}else{var W=z.animationCanvas;z.itemsContainerNode.innerHTML=p.innerHTML;z.itemsContainerNode.insertBefore(W,z.itemsContainerNode.firstChild);z.xdiv=null;}}g.restore();},getFormattedDateLabel:function M(V,R){if(isNaN(V)){return V;}var S=V;try{V=this.utils.convertRawValueToMilliseconds(V);var Q=new Date(Number(V));var U=R.mn=mstrmojo.locales.datetime.MONTHNAME_SHORT[Q.getMonth()];var P=R.yr=Q.getFullYear().toString().substring(2);R.dt=Q.getDate();if(!A||(U!==A.mn&&P!==A.yr)){S=U+" "+R.dt+" "+P;}else{if(U!==A.mn){S=U+" "+R.dt;}else{S=R.dt;}}}catch(T){}return S;},removeLabels:function G(){var P=this.domNode.getElementsByClassName("mstrmojo-Chart-lbl");for(var Q=P.length-1;P&&Q>=0;Q--){P[Q].parentElement.removeChild(P[Q]);}},highlightPoint:function H(a,d){var Y=this,g=Y.highlightContext,f=Y.getHeight(),S=Y.margin,X=Y.model,b=Y.utils,V=Y.seriesIndex;var R=(a*Y.RTX)+S.l;if(this.prevHighlight>=0){var W=(this.prevHighlight*Y.RTX)+S.l;var P=10;var T=8;var Z=S.t-T>0?S.t-T:0;g.clearRect(W-P,Z,W+P,f-S.b);}if(a<0){return ;}var R=(a*Y.RTX)+S.l;g.shadowBlur=5;g.shadowColor="#000";g.globalAlpha=1;if(Y.showHighlightLine){g.strokeStyle=this.highlightColor;g.fillStyle=this.highlightColor;g.lineWidth=2;g.lineCap="round";b.drawLineSet(Y,[{x:R,y:S.t},{x:R,y:f-S.b}],false,g);}else{g.strokeStyle=b.getColor(Y);g.fillStyle=g.strokeStyle;}var h=X.series,Q=h.length,Z=b.getYValue(Y,h[V].rv[a]);if(!Y.multiLine){b.drawArc(Y,R,Z,5,0,Math.PI*2,true,true,g);}else{if(Y.showHighlightLine){if(Q>1){g.strokeStyle=this.chartLineColors[0];g.fillStyle=g.strokeStyle;}for(var U=0;U<Q;U++){g.strokeStyle=this.chartLineColors[U%6];if(U>0){g.fillStyle=g.strokeStyle;}Z=b.getYValue(Y,h[U].rv[a]);b.drawArc(Y,R,Z,5,0,Math.PI*2,true,true,g);}}else{if(Q>1){g.strokeStyle=this.chartLineColors[V];g.fillStyle=g.strokeStyle;}b.drawArc(Y,R,b.getYValue(Y,h[V].rv[a]),5,0,Math.PI*2,true,true,g);}}},refreshChart:function B(){var P=this.getHeight(),Q=this.getWidth();this.highlightContext.clearRect(0,0,Q,P);this.animationContext.clearRect(0,0,Q,P);this.removeLabels();this.drawChart();this.drawLabels();}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisChartLine","mstrmojo.EnumRWUnitType","mstrmojo.VisTooltip","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo._HasTouchScroller","mstrmojo.css","mstrmojo.color","mstrmojo.VisTimeSeriesLegend","mstrmojo.VisTimeSeriesTimeSelector");mstrmojo.requiresDescs(5674,8475,8626);var $CSS=mstrmojo.css,$CLR=mstrmojo.color;var DRILLING_ACTION=1,SELECTOR_ACTION=2,HYPERLINK_ACTION=4;var ROW_AXIS=1,COL_AXIS=2;var chartStatus={},widgetCount=0,tooltipShown=false,itemClicked=false,isDataSetChanged=false,chartSizeChanged=false,originalTouchPosition=0,masterSliderClicked=null,rangeToSeriesMaxRatio=5;var MCHW=20;var MCHH=20;var MAXPOINTS_PER_DRAW=80;var SWidthChanged=false;var masterMargin={t:5,r:MCHW/2,b:5,l:MCHW/2};var PADDING=10,TOP_PADDING=8;var canvasReseted=false;var $_DT=mstrmojo.locales.datetime;function resetLocalVars(){tooltipShown=false;itemClicked=false;isDataSetChanged=false;chartSizeChanged=false;originalTouchPosition=0;masterSliderClicked=null;}function getParentBkgColor(){var parentNode=this.domNode.parentNode;while(parentNode){var compStyle=mstrmojo.css.getComputedStyle(parentNode);var bkgColor=compStyle.backgroundColor;if(bkgColor){if(bkgColor.indexOf("rgba")>=0){var rgba=this.utils.rgbaStr2rgba(bkgColor);if(rgba&&rgba[4]){return rgba;}}else{if(bkgColor.indexOf("rgb")>=0){var rgb=$CLR.rgbStr2rgb(bkgColor);return rgb;}}}parentNode=parentNode.parentNode;}return[255,255,255];}var LIGHT_THEME=0;var DARK_THEME=1;function getUITheme(){var utils=this.utils;var rgb=getParentBkgColor.call(this);var opacity=this.formatProp.backgroundAlpha;rgb=utils.getRGBWithOpacity(rgb,opacity,this.formatProp.backgroundClr);var brightness=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1000;if(brightness>150){this.theme=LIGHT_THEME;}else{this.theme=DARK_THEME;}}function addChartStatus(id){chartStatus[id]={isLegendBarOpen:false,legendBarWidth:30,isLegendSelected:false,legendSelectedIndex:-1,timeSelectedIntervalPosition:{},currSelectionIdx:-1,usingCustomInterval:false};}function isScrollableElementTouched(touch){var me=this,m=me.margin,chartWidth=me.getChartWidthOnScreen();var touchPointOnWidget=me.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,me);var x=touchPointOnWidget.touchX,y=touchPointOnWidget.touchY;if(x<m.l||x>(chartWidth+m.l)||y<m.t||y>this.canvas.height-m.b){return false;}return true;}function isTouchedOnWidget(touch){if(!touch){return false;}var me=this;var touchPointOnWidget=me.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,me);var x=touchPointOnWidget.touchX,y=touchPointOnWidget.touchY;if((x>0&&x<me.getWidth())&&(y>0&&y<me.getHeight())){return true;}return false;}function getTouchedElement(touch){var item=mstrmojo.dom.findAncestorByAttr(touch.target,"clk",true,this.domNode);return item||null;}function getMinYPosition(lines){var l=lines.length;var i=0,min;while(i<l){if(lines[i]){min=lines[i].y;break;}i++;}for(i=0;i<l;i++){if(lines[i]){min=Math.min(min,lines[i].y);}}return min;}function resetBaseAndDerivedData(tsl){var obm=this.baseModel;var currStatus=chartStatus[this.chartID];this.baseModel=this.getModel(tsl.ds)||this.baseModel;var bm=this.baseModel;this.checkData(bm);var err=bm.err||bm.eg;if(err){this.renderErrorMessage(err);return false;}var bms=bm.series,m=this.model,cs=m.series,sl=bms.length,s=[],j=0;for(j=0;j<sl;j++){s[j]=bms[j];}this.model.categories=bm.categories;this.model.series=s;this.model.colHeaders=bm.colHeaders;var currWindowSize=this.model.series[0].rv.length;if(this.windowSize!==currWindowSize){currStatus.rns=0;currStatus.rne=currWindowSize;}this.windowSize=currWindowSize;if(!bm.vp||!bm.vp.rl||bm.vp.rl.length<obm.vp.rl.length){bm.vp=obm.vp;}isDataSetChanged=true;return true;}function localUpdateScrollerConfig(){var scl=this._scroller,m=this.model,margin=this.margin,currStatus=chartStatus[this.chartID],animationCanvas=this.animationCanvas,chartWidth=this.getChartWidthOnScreen(),offsetEnd=Math.max(this.acContentWidth-chartWidth,0);var rns=(currStatus.rns!==0&&currStatus.rns+1===currStatus.rne)?currStatus.rns-1:currStatus.rns;scl.origin={x:parseInt(((rns-this.ACrns)*this.RTX),10),y:0};scl.hScroll=(offsetEnd!==0&&scl.noHScroll!==true)||this.scrollPast;if(scl.hScroll){scl.offset={x:{start:0,end:offsetEnd},scrollPast:this.scrollPast};}this.utils.translateCSS(-(scl.origin.x),scl.origin.y,false,this.animationCanvasDiv);this.utils.translateCSS(-(scl.origin.x)+this.maxYLblWidth,scl.origin.y,false,this.xLabelsDiv);}function getCurrencySymbolForMetric(m){var s=m.series,ch=m.colHeaders,chl=ch[0].items.length;var hi0=s[0].hi,fInfo=ch[ch.length-1].items[hi0[hi0.length-1]],f=fInfo.f;var cs=(fInfo&&f&&f.indexOf(fInfo.cs)>=0)?","+fInfo.cs:"";if(cs===""&&f){cs=f.indexOf("%")>=0?",%":"";}if(cs===""&&f){var q=null;if(f.indexOf("'")>=0){q="'";}else{if(f.indexOf('"')>=0){q='"';}}if(q){var temp=f.substring(f.indexOf(q)+1);cs=","+temp.substring(0,temp.indexOf(q));}}return cs;}function hideMasterSliderTooltip(){var ms=this.masterSlider,stt=this.sliderTooltip,sttF=stt.firstChild,sttP=stt.lastChild,fc=ms.firstChild,lc=ms.lastChild;$CSS.removeClass(fc,"mstrmojo-timeseries-span-shadow");$CSS.removeClass(lc,"mstrmojo-timeseries-span-shadow");sttF.innerHTML="";sttF.style.display="none";sttP.style.display="none";}function resizeMasterSliderDone(){var me=this,currStatus=chartStatus[this.chartID];if(currStatus.usingCustomInterval&&me.currSelection){me._timeSelector.toggleSelected(me.currSelection,false);me._timeSelector.toggleGlowEffect(me.currSelection,false);this.updateIntervalPosition();me.currSelection=null;currStatus.currSelectionIdx=-1;}if(chartSizeChanged&&masterSliderClicked!=="MS"){me.showMessage();this.makeSureMasterSliderNotBeyondTheMargin();this.makeSureSliderOnPoint();this.makeSureSelectedIntervalMoreThanTwo();this.makeSureMasterSliderNoOverlap();this.setMasterSliderLayout();window.setTimeout(function(){me.reDrawSlaveChart();},10);}else{masterSliderClicked=null;}hideMasterSliderTooltip.call(this);}function getFormattedDateForSliderTooltip(sliderTooltipXPosition){var me=this,cat=me.model.categories,tp=cat.tp;var pos=Math.round((sliderTooltipXPosition-masterMargin.l)/me.MRTX),rVal=cat.items[pos];if(tp.toString()===me.DSS_XML_BASE_FORM_DATE){rVal=me.getFormattedDateForTooltip(rVal,true);}return rVal;}function getPointDistanceSquare(p1,p2){return(p1.x-p2.x)*(p1.x-p2.x)+(p1.y-p2.y)*(p1.y-p2.y);}function getACRnsRne(rns,rne){var me=this,currStatus=chartStatus[me.chartID],model=me.model,windowSize=me.windowSize,needRedraw=true,ACrns,ACrne;if((!rns&&rns!==0)||!rne){rns=currStatus.rns;rne=currStatus.rne;}var diff=rne-rns;model.currentRatio=Math.round(windowSize/((diff-1)||1));if(model.currentRatio>rangeToSeriesMaxRatio){var ACRation=(rangeToSeriesMaxRatio-1)/2;ACrns=Math.max(0,rns-ACRation*(diff-1));ACrne=Math.min(windowSize,rne+ACRation*(diff-1));if(ACrns===0){ACrne=rangeToSeriesMaxRatio*(diff-1)+1;}else{if(ACrne===windowSize){ACrns=ACrne-rangeToSeriesMaxRatio*(diff-1)-1;}}}else{ACrns=0;ACrne=windowSize;var ACdiff=ACrne-ACrns;}if(me.ACrns===ACrns&&me.ACrne===ACrne){needRedraw=false;}else{me.ACrns=ACrns;me.ACrne=ACrne;}return needRedraw;}function removeChildren(container){var count=container&&container.childNodes&&container.childNodes.length,i;for(i=0;i<count;++i){container.removeChild(container.firstChild);}}function removeLegendAndTimeSelectorChildren(){if(this._legend){this._legend.destroy();}if(this._timeSelector){this._timeSelector.destroy();}}mstrmojo.VisTimeSeries=mstrmojo.declare(mstrmojo.VisChartLine,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisTimeSeries",isLinearChart:true,highlightColor:"#ffffff",chartLineColors:["#16b0ff","#ff3729","#04ba22","#ff960e","#ae79de","#cccd25","#19cee0","#a9a9a9","#b3cdef","#ffa796","#98df8a","#ffbf80","#dac3ec","#dac3ec","#a1dfea","#d6d6d6"],switchSeriesOnTouch:false,multiTouch:true,margin:{t:70,r:1,b:50,l:5},SLXP:0,SRXP:0,isTimeSeries:true,maxXLabels:4,scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:true},scrollPast:true,isAndroidTab:false,masterContext:null,selectionOrLinkdrillOnRow:false,lastSelectedPoint:null,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};left:{@left};top:{@top};z-index:{@zIndex};position:absolute;-webkit-transition: 0ms; transition: 0ms; -webkit-transform: translate3d(0px, 0px, 0px);"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@slaveChartHeight}"></canvas><div style="overflow:hidden;position:absolute;left:0px;top:0px;"><div id="{@id}-animation-canvas-div" class="mstrmojo-timeseries-animation-canvas" style="position:absolute;left:0px;top:0px;width:{@width};height:{@slaveChartHeight+"px"};"><canvas style="position:absolute;left:0px;top:0px;" width="{@width}" height="{@slaveChartHeight}"></canvas></div></div><div style="overflow:hidden;position:absolute;left:0px;top:0px;"><div id="{@id}-x-labels-div" class="mstrmojo-timeseries-animation-canvas" style="position:absolute;left:0px;top:0px;width:{@width};height={@slaveChartHeight+"px"}"></div></div><canvas id="{@id}-highlight-canvas" style="position:absolute;left:0px;top:0px;" width="{@width}" height="{@slaveChartHeight}"></canvas><div id="{@id}-tooltip"></div><div id="{@id}-time-selector-div"></div><div id="{@id}-legend-bar-div" ></div><div id="{@id}-loading-msg" class="mstrmojo-loading-msg" style="display:none"></div><canvas id="{@id}-master-canvas" style=" position:absolute;left:0px;bottom:0px;" width="{@width}" height="{@masterChartHeight}"></canvas><div id="{@id}-master-div" class="mstrmojo-master-parent-div" width="{@width}" style="position:absolute;bottom:5px" ><div id="{@id}-master-cover-span" style="position:absolute;left:0px;" class="mstrmojo-master-cover-span"></div><div id="{@id}-master-slider" class="mstrmojo-master-slider-div" clk="MS"><canvas id="{@id}-master-img-L" width="20" height="20" style="position:absolute;left:0px" class="mstrmojo-timeseries-master-span" clk="L" ></canvas><canvas id="{@id}-master-slider" width="{@width}" height="{@masterChartHeight}" style="top:0px;left:0px" class="mstrmojo-master-slider-div-top"></canvas><canvas id="{@id}-master-img-R" width="20" height="20" style="position:absolute;right:0px" class="mstrmojo-timeseries-master-span" clk="R" ></canvas></div><div id="{@id}-master-cover-span" style="position:absolute;right:0px;" class="mstrmojo-master-cover-span"></div></div><div id="{@id}-slider-tooltip" style="position:absolute;left:0;top:0;z-index:150;width:{@width};"><div class="timeseries-slider-tooltip"></div><canvas style="position:absolute;left:0px;top:20px;display: none;" width="6px" height="5px"></canvas></div><div id="{@id}-legend-tooltip" class="mstrmojo-Chart-tooltip timeseries-legend-tooltip"></div><span id="textSpan" style="z-index:-10;visibility:hidden;"></span><div id="{@id}-infowindow-anchor" style="position:absolute;width:18px;height:18px;display:block"></div><div id="{@id}-errMsg" class="mstrmojo-message" style="width:{@width};height:{@height};top:0px;left:0px;position:absolute;display:none; z-index:20;"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},animationCanvasDiv:function(){return this.domNode.childNodes[1].firstChild;},animationCanvas:function(){return this.domNode.childNodes[1].firstChild.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},xLabelsDiv:function(){return this.domNode.childNodes[2].firstChild;},xLabelsDivContainer:function(){return this.domNode.childNodes[2];},highlightCanvas:function(){return this.domNode.childNodes[3];},tooltip:function(){return this.domNode.childNodes[4];},timeSelectorDiv:function(){return this.domNode.childNodes[5];},legendBarDiv:function(){return this.domNode.childNodes[6];},loadingMsg:function(){return this.domNode.childNodes[7];},masterCanvas:function(){return this.domNode.childNodes[8];},masterSlider:function(){return this.domNode.childNodes[9].childNodes[1];},sliderTooltip:function(){return this.domNode.childNodes[10];},legendTooltip:function(){return this.domNode.childNodes[11];},textSpan:function(){return this.domNode.childNodes[12];},infoWindowAnchor:function(){return this.domNode.childNodes[13];},errorMsg:function(){return this.domNode.childNodes[14];}},getTextWidth:function gtw(str,fontStyle,zf){this.textSpan.style.font=fontStyle;this.textSpan.innerHTML=str;if(zf){this.utils.changeElementSize(this.textSpan,"font",zf);}var ret=this.textSpan.offsetWidth;return ret;},getTextWidthByElem:function gtwCvs(text,elem){var computedStyle=mstrmojo.css.getComputedStyle(elem);var fontStyle=computedStyle.fontStyle+" "+computedStyle.fontWeight+" "+computedStyle.fontSize+"/"+computedStyle.fontVariant+" "+computedStyle.fontFamily;return this.getTextWidth(text,fontStyle);},getTextHeight:function gtw(str,fontStyle,zf){this.textSpan.style.font=fontStyle;this.textSpan.innerHTML=str;if(zf){this.utils.changeElementSize(this.textSpan,"font",zf);}var ret=this.textSpan.offsetHeight;return ret;},getMaxTextWidth:function(textArray,fontStyle){var me=this,l=textArray.length,maxWidth=0,currWidth=0,i;for(i=1;i<l;i++){currWidth=me.getTextWidth(textArray[i],fontStyle);maxWidth=currWidth>maxWidth?currWidth:maxWidth;}return maxWidth;},getChartWidthOnScreen:function getChartWidthOnScreen(){var m=this.margin;return this.getWidth()-m.r-m.l-chartStatus[this.chartID].legendBarWidth;},drawChartXYAxis:function drawChartXYAxis(){var utils=this.utils,m=this.margin,w=this.getWidth()-chartStatus[this.chartID].legendBarWidth,h=this.canvas.height,c=this.context;c.save();c.strokeStyle=utils.rgb2rgbStr(this.formatProp.textClr);c.lineWidth=1;c.globalAlpha=0.8;var xPos=Math.floor(m.l)-0.5;utils.drawLineSet(this,[{x:xPos,y:m.t},{x:xPos,y:h-m.b}],false,c);var yPos=Math.floor(h-m.b)+0.5;utils.drawLineSet(this,[{x:m.l-this.maxYLblWidth,y:yPos},{x:w-m.r,y:yPos}],false,c);c.restore();},setMasterSlider:function setMasterSlider(){var width=this.getWidth(),h=this.masterCanvas.height-masterMargin.t-masterMargin.b,utils=this.utils,msl=this.masterSlider,msStyle=msl.style,mslp=msl.parentNode,lcStyle=mslp.firstChild.style,rcStyle=mslp.childNodes[2].style,m=this.model,mrtx=this.MRTX,currStatus=chartStatus[this.chartID];mslp.style.display="block";mslp.style.height=h+"px";mslp.style.width=width+"px";msStyle.height=h+"px";lcStyle.height=h-2+"px";rcStyle.height=h-2+"px";lcStyle.backgroundColor=rcStyle.backgroundColor=utils.rgb2rgbStr(this.formatProp.backgroundClr,this.formatProp.backgroundAlpha*0.5);this.drawMasterChartHandler(msl.firstChild,MCHW,MCHH,true);this.drawMasterChartHandler(msl.lastChild,MCHW,MCHH,false);msl.firstChild.style.marginTop=msl.lastChild.style.marginTop=Math.round((h-MCHH)/2)+"px";this.calculateSXP(currStatus.rns,currStatus.rne,true);this.makeSureMasterSliderNotBeyondTheMargin();this.makeSureMasterSliderNoOverlap();this.setMasterSliderLayout();},drawMasterChartHandler:function drwMCH(canvas,w,h,isLeft){var utils=this.utils,ctx=canvas.getContext("2d");canvas.width=w;canvas.height=h;ctx.save();ctx.fillStyle=utils.rgb2rgbStr(this.formatProp.backgroundClr,0.76);utils.drawRoundRect(ctx,0.5,0.5,w-1,h-1,1,true);ctx.strokeStyle=utils.rgb2rgbStr(this.formatProp.textClr);ctx.lineWidth=1;utils.drawRoundRect(ctx,0.5,0.5,w-1,h-1,1);ctx.beginPath();ctx.lineWidth=2;if(isLeft){ctx.moveTo(11,6);ctx.lineTo(7,10);ctx.lineTo(11,14);}else{ctx.moveTo(9,6);ctx.lineTo(13,10);ctx.lineTo(9,14);}ctx.stroke();ctx.restore();},drawMasterChartDiv:function drwMCD(x,w){var canvas=this.masterSlider.childNodes[1],width=this.SRXP-this.SLXP+MCHW;if(canvas.width==width){}else{var margin=masterMargin,mcHeight=this.masterChartHeight,divHeight=mcHeight-margin.t-margin.b,h=(divHeight-MCHH)/2;canvas.height=divHeight;canvas.width=width;var ctx=canvas.getContext("2d");ctx.save();ctx.strokeStyle=this.utils.rgb2rgbStr(this.formatProp.textClr);ctx.lineWidth=1;ctx.beginPath();var leftX=0.5+MCHW/2;var rightX=width-0.5-MCHW/2;ctx.moveTo(leftX,h);ctx.lineTo(leftX,0);ctx.lineTo(rightX,0);ctx.lineTo(rightX,h);ctx.moveTo(leftX,h+MCHH);ctx.lineTo(leftX,divHeight);ctx.lineTo(rightX,divHeight);ctx.lineTo(rightX,h+MCHH);ctx.stroke();ctx.restore();}},setMasterSliderLayout:function setMasterSliderLayout(){var width=this.getWidth(),utils=this.utils,msl=this.masterSlider,msStyle=msl.style,mslp=msl.parentNode,lcStyle=mslp.firstChild.style,rcStyle=mslp.childNodes[2].style;lcStyle.width=(this.SLXP)+"px";rcStyle.width=(width-this.SRXP)+"px";var slWidth=(this.SRXP-this.SLXP);msStyle.width=(slWidth+MCHW)+"px";utils.translateCSS(this.SLXP-MCHW/2,0,false,msl);this.drawMasterChartDiv();},makeSureMasterSliderNoOverlap:function makeSureMasterSliderNoOverlap(fixWhich){var slWidth=this.SRXP-this.SLXP;if(slWidth<MCHW){slWidth=MCHW;var width=this.getWidth();if(!fixWhich){fixWhich=this.SRXP+MCHW/2===width-1?"R":"L";}if(fixWhich=="L"){this.SRXP=this.SLXP+MCHW;}else{this.SLXP=this.SRXP-MCHW;}}},calculateSXP:function calculateSXP(rns,rne,intervalChanged){if(intervalChanged){this.SLXP=Math.round((this.MRTX*rns)+masterMargin.l);this.SRXP=Math.round((this.MRTX*(rne-1))+masterMargin.l);}else{var width=this.SRXP-this.SLXP;this.SLXP=Math.round((this.MRTX*rns)+masterMargin.l);this.SRXP=this.SLXP+width;}},makeSureMasterSliderNotBeyondTheMargin:function makeSureMasterSliderNotBeyondTheMargin(keepWidth){var SWidth=this.SRXP-this.SLXP;var width=this.getWidth();if(this.SLXP<masterMargin.l){this.SLXP=masterMargin.l;if(keepWidth){this.SRXP=this.SLXP+SWidth;}}if(this.SRXP>width-masterMargin.r-1){this.SRXP=width-masterMargin.r-1;if(keepWidth){this.SLXP=this.SRXP-SWidth;}}},makeSureSelectedIntervalMoreThanTwo:function makeSureSelectedIntervalMoreThanTwo(){var mrtx=this.MRTX,width=this.getWidth();if(this.SRXP-this.SLXP<mrtx){if(masterSliderClicked){if(masterSliderClicked==="L"){this.SLXP=this.SRXP-mrtx;}else{this.SRXP=this.SLXP+mrtx;}}else{if(this.SLXP+mrtx<=width-masterMargin.r){this.SRXP=this.SLXP+mrtx;}else{this.SLXP=this.SRXP-mrtx;}}}},makeSureSXPNotEqual:function makeSureSXPNotEqual(){var mrtx=this.MRTX,width=this.getWidth();if(this.SLXP===this.SRXP){if(masterSliderClicked){if(masterSliderClicked==="L"){this.SLXP-=mrtx;}else{this.SRXP+=mrtx;}}else{if(this.SRXP+mrtx<=width-masterMargin.r){this.SRXP+=mrtx;}else{this.SLXP-=mrtx;}}}},makeSureSliderOnPoint:function makeSureSliderOnPoint(){var mrtx=this.MRTX,diff=0,currStatus=chartStatus[this.chartID];if(masterSliderClicked){diff=Math.round((this.SRXP-this.SLXP)/mrtx);if(masterSliderClicked==="L"){this.SLXP=this.SRXP-diff*mrtx;}else{if(masterSliderClicked==="R"){this.SRXP=this.SLXP+diff*mrtx;}else{this.calculateSXP(currStatus.rns,currStatus.rne,true);}}}},initScroller:function initScroller(scroller){if(!scroller.offset&&this.scrollPast){scroller.offset={scrollPast:this.scrollPast};}this._super(scroller);var me=this;this._scrollDoneListener=this._scroller.attachEventListener("scrollDone",me.id,function(evt){var m=me.model,currStatus=chartStatus[me.chartID],r=currStatus.rne-currStatus.rns,rns=me.ACrns+parseInt(Math.round(me._scroller.origin.x/me.RTX),10);if(r===1){rns++;}var rne=rns+r;if(rns<0){currStatus.rns=0;currStatus.rne=currStatus.rns+r;}else{if(rne>m.series[0].rv.length){currStatus.rne=m.series[0].rv.length;currStatus.rns=currStatus.rne-r;}else{currStatus.rns=rns;currStatus.rne=rne;}}me.updateRnsRne();SWidthChanged=false;me.incFetchChart();});this._scrollMovedListener=this._scroller.attachEventListener("scrollMoved",me.id,function(evt){if(tooltipShown){me.hiddenTooltipAndShowTimeSelector();}var m=me.model,currStatus=chartStatus[me.chartID],sl=m.series[0].rv.length,r=currStatus.rne-currStatus.rns,rns=me.ACrns+Math.round(evt.x/me.RTX),rne=Math.min(rns+r,sl);if(rns<0){rns=0;}if(rne-rns!=r){SWidthChanged=true;}me.utils.translateCSS(-evt.x+me.maxYLblWidth,-evt.y,false,me.xLabelsDiv);me.calculateSXP(rns,rne,SWidthChanged);me.makeSureSXPNotEqual();me.makeSureMasterSliderNoOverlap();me.setMasterSliderLayout();});},initFromVisProps:function(vp){var propValue=vp?vp:{};this.formatProp={};this.formatProp.backgroundClr=propValue.fbg?$CLR.hex2rgb(propValue.fbg):[0,0,0];this.formatProp.textClr=propValue.flt?$CLR.hex2rgb(propValue.flt):[255,255,255];this.formatProp.tooltipClr=propValue.ftt?$CLR.hex2rgb(propValue.ftt):[255,255,255];this.formatProp.backgroundAlpha=propValue.fbt!=undefined?(1-parseInt(propValue.fbt)/100):1;var getBool=function(v){if(v==true||v=="1"||v==1||v=="true"){return true;}return false;};this.formatProp.useCustomAxisScale=propValue.fcas?getBool(propValue.fcas):false;var numCheck=function(num){if(num>Number.MAX_VALUE){num=Number.MAX_VALUE;}if(num<-1*Number.MAX_VALUE){num=-1*Number.MAX_VALUE;}return num;};this.formatProp.minValue=propValue.fmiav?numCheck(parseFloat(propValue.fmiav)):"";this.formatProp.maxValue=propValue.fmaav?numCheck(parseFloat(propValue.fmaav)):"";this.formatProp.condenseLabels=propValue.fcl?getBool(propValue.fcl):true;this.chartLineColors=["#16b0ff","#ff3729","#04ba22","#ff960e","#ae79de","#cccd25","#19cee0","#a9a9a9","#b3cdef","#ffa796","#98df8a","#ffbf80","#dac3ec","#dac3ec","#a1dfea","#d6d6d6"];for(var i=0;i<this.chartLineColors.length;i++){var propName=""+Math.floor(i/4)+i%4;propName="fs"+propName;var color=propValue[propName];if(color){this.chartLineColors[i]="#"+color;}}this.glowColor=this.utils.rgb2rgbStr(this.formatProp.tooltipClr);},getMaxValue:function getMaxV(){if(typeof this.formatProp.maxValue=="number"){return this.formatProp.maxValue;}else{return this._super();}},getMinValue:function getMinV(){if(typeof this.formatProp.minValue=="number"){return this.formatProp.minValue;}else{return this._super();}},preBuildRendering:function preBR(){if(this._super){this._super();}this.masterChartHeight=90;this.slaveChartHeight=this.getHeight()-this.masterChartHeight;},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res=eval(s);return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},postBuildRendering:function postBR(){var model=this.model;this.checkData(model);var err=model.err||model.eg;var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel);if(err){if(docModel&&docModel.prompts){this.model.docModel=docModel;}this.renderErrorMessage(err);return ;}else{this.errorMsg.style.display="none";}resetLocalVars();getUITheme.call(this);this.updateSelectionLinkdrillInfo(model);if(this.baseModel&&!model.vp){this.model=this.baseModel;}this.chartID=this.getChartID(docModel);if(!chartStatus[this.chartID]){addChartStatus(this.chartID);}this.scrollerConfig.scrollEl=this.animationCanvasDiv;this.isAndroidTab=!!mstrApp.isTablet();this.masterContext=this.masterCanvas.getContext("2d");this.renderVisTooltip();this.setMarginTopByTooltipHeight();this.renderLegend();if(this._super){this._super();}this.renderTimeSelector();this.setAnimationCanvasContainer();localUpdateScrollerConfig.call(this);if(docModel&&docModel.prompts){this.model.docModel=docModel;}this.drawSliderTooltipPointer();var me=this;if(docModel){this._infoWClosedListener=this.xtabModel.docModel.attachEventListener("infoWindowClosed",this.id,function(evt){var infoWindowK=evt.psKey;if(!me.hasNonifwTarget&&me.selectorTargets&&me.selectorTargets[infoWindowK]){me.lastSelectedPoint=null;me.incFetchChart(true);return ;}});}this.fullScreenListener=mstrmojo.touchManager.attachEventListener("fullScreenStateChange",this.id,function(evt){this.adjustWidgetOffsets();});this.renderLegendTooltip();},ongridDataChange:function onGridDataChange(evt){this.model=this.gridData;},getChartID:function getChartID(docModel){var chartID="";var layoutModel=docModel?docModel:(this.layoutModel?this.layoutModel:(this.model.layoutModel?this.model.layoutModel:null));if(layoutModel){chartID=layoutModel.oid+"_"+layoutModel.currlayKey+"_"+this.model.k;}else{if(this.model.mid){chartID=this.model.mid;}else{chartID=widgetCount++;}}return chartID;},checkData:function checkData(model){var colHeaders=model.colHeaders,categories=model.categories;if(!colHeaders||(colHeaders&&colHeaders.length<1)){this.model.err=mstrmojo.desc(8626,"The Time Series widget requires at least one attribute on the row axis and at least one metric on the column axis; optionally, one attribute can be placed above the metrics.");}if(colHeaders&&colHeaders.length>=1&&!this.isMetric(colHeaders[colHeaders.length-1].items)){this.model.err=mstrmojo.desc(8626,"The Time Series widget requires at least one attribute on the row axis and at least one metric on the column axis; optionally, one attribute can be placed above the metrics.");}if((categories&&(!categories.items||categories.items.length<2))){this.model.err=mstrmojo.desc(8475,"There is not enough data to plot the graph.");}},renderErrorMessage:function renderErrorMessage(msg){this.errorMsg.innerHTML=msg;this.errorMsg.style.display="block";},isMetric:function isMetric(items){if(items&&items.length>0&&items[0].cs!=null){return true;}return false;},updateSelectionLinkdrillInfo:function uscld(model){var rowHeaders=model.rowHeaders,rowHL=rowHeaders.length;for(var i=0;i<rowHL;i++){var rowH=rowHeaders[i];if(rowH.sc&&rowH.sc.tks){this.selectionOrLinkdrillOnRow=true;return ;}if(rowH.lm&&rowH.lm[0]&&rowH.lm[0].links){this.selectionOrLinkdrillOnRow=true;return ;}}},hasPageBy:function hasPageBy(){if(this.baseModel&&this.baseModel.phs&&this.baseModel.phs.show){return true;}return false;},setlegendStatus:function setlegendStatus(ilo,lbw){chartStatus[this.chartID].legendBarWidth=lbw;chartStatus[this.chartID].isLegendBarOpen=ilo;},setLegendSelected:function setLegendSelected(ils,lsi){chartStatus[this.chartID].isLegendSelected=ils;chartStatus[this.chartID].legendSelectedIndex=lsi;},getLegendBarDiv:function getLegendBarDiv(){return this.domNode.childNodes[6];},getTimeSelectorDiv:function getTimeSelectorDiv(){return this.domNode.childNodes[5];},renderLegend:function renderLegend(){var placeholder=this.legendBarDiv;var m=this.margin;var chartID=this.chartID;var props={placeholder:placeholder,model:this.model,utils:this.utils,widget:this,isLegendBarOpen:chartStatus[chartID].isLegendBarOpen,isAndroidTab:this.isAndroidTab,isLegendSelected:chartStatus[chartID].isLegendSelected,legendSelectedIndex:chartStatus[chartID].legendSelectedIndex,top:m.t+"px",right:"0px",zIndex:1};var w=new mstrmojo.VisTimeSeriesLegend(props);w.render();this._legend=w;},renderTimeSelector:function renderTimeSelector(){var placeholder=this.timeSelectorDiv;var m=this.margin;var chartID=this.chartID;var props={placeholder:placeholder,offsetx:this.margin.l,widget:this,chartStatus:chartStatus[this.chartID]};var w=new mstrmojo.VisTimeSeriesTimeSelector(props);w.render();this._timeSelector=w;},renderVisTooltip:function renderVisTooltip(){var props={placeholder:this.tooltip,cssClass:"timeseries-tooltip"};this._tooltip=new mstrmojo.VisTooltip(props);this._tooltip.render();this._tooltip.toggle(false);},renderLegendTooltip:function renderLegendTooltip(){var props={placeholder:this.legendTooltip,boundary:this.domNode};this._legendTooltip=new mstrmojo.VisTextTooltip(props);this._legendTooltip.render();this._legendTooltip.toggle(false);},setAnimationCanvasContainer:function setAnimationCanvasContainer(){var currStatus=chartStatus[this.chartID],m=this.margin;this.itemsContainerNode.style.left=m.l+"px";this.xLabelsDivContainer.style.left=(m.l-this.maxYLblWidth)+"px";},updateRnsRne:function updateRnsRne(rns,rne){var currStatus=chartStatus[this.chartID],m=this.model;if((rns==0||rns)&&rne){currStatus.rns=rns;currStatus.rne=rne;}m.rns=currStatus.rns;m.rne=currStatus.rne;},drawPreparation:function drawPreparation(windowSize,rns,rne){var me=this,margin=this.margin,model=me.model,diff=rne-rns,height=me.getHeight()-me.masterChartHeight,ctx=me.animationContext;var chartWidth=me.getChartWidthOnScreen();this.chartWidth=chartWidth;getACRnsRne.call(this,rns,rne);var ACdiff=me.ACrne-me.ACrns;if(diff<windowSize){if(diff>1){diff--;}if(ACdiff>1){ACdiff--;}windowSize--;}this.itemsContainerNode.style.width=chartWidth+"px";this.itemsContainerNode.style.height=height+"px";this.xLabelsDivContainer.style.width=me.maxYLblWidth+chartWidth+"px";this.xLabelsDivContainer.style.height=height+"px";totalChartWidth=(windowSize/diff)*chartWidth;me.totalChartWidth=totalChartWidth;var acContentWidth=0;if(model.currentRatio>rangeToSeriesMaxRatio){acContentWidth=(ACdiff/diff)*chartWidth;}else{acContentWidth=totalChartWidth;}this.acContentWidth=acContentWidth;var acWidth=rangeToSeriesMaxRatio*this.getWidth();if(me.animationCanvas.width!==acWidth){canvasReseted=true;}me.animationCanvas.width=acWidth;me.RTX=(totalChartWidth-1)/(this.windowSize-1);},drawChart:function drwchrt(){var model=this.model;if(model.err){return ;}var me=this,mvalues=model.mvalues,width=me.getWidth(),margin=me.margin,utils=me.utils,values=model.series,ylbls=model.ylbls,windowSize=me.windowSize,currStatus=chartStatus[this.chartID];if((!currStatus.rns&&currStatus.rns!=0)||!currStatus.rne||currStatus.rns<0||currStatus.rne>windowSize){currStatus.rns=model.rns;currStatus.rne=model.rne;if((currStatus.rne-currStatus.rns)<2){if(currStatus.rns>0){currStatus.rns=currStatus.rne-2;}else{currStatus.rne=currStatus.rns+2;}}}this.updateRnsRne();var mch=me.masterChartHeight;var height=me.slaveChartHeight;if(!values){return ;}if(me.isDrawAxis&&me.drawYAxisLabels){margin.l=utils.getLabelWidthForMargin(me,model.mls);}me.masterCanvas.height=mch;me.masterCanvas.width=width;utils.fillMasterChartBackground(me,0,masterMargin.t,width,mch-masterMargin.t-masterMargin.b,masterMargin.b,me.masterContext);me.MRTY=(mch-masterMargin.t-masterMargin.b-1-3)/(mvalues[mvalues.length-1]-mvalues[0]);me.MRTX=(width-masterMargin.l-masterMargin.r-1)/(windowSize-1);me.drawSeries(0,windowSize,currStatus.rns,currStatus.rne,values,me.masterContext,true);me.setMasterSlider();this.calculateRnsRneFromSXP();if(me.canvas.height!=height||me.animationCanvas.height!=height||me.highlightCanvas.height!=height||me.canvas.width!=width){me.canvas.height=me.animationCanvas.height=me.highlightCanvas.height=height;me.canvas.width=me.highlightCanvas.width=width;canvasReseted=true;utils.fillBackground(me);}this.maxYLblWidth=this.getMaxTextWidth(ylbls,this.mstrmojo_Chart_lbl_font)+5;this.drawPreparation(windowSize,currStatus.rns,currStatus.rne);me.RTY=(height-margin.t-margin.b-1-4)/(mvalues[mvalues.length-1]-mvalues[0]);me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,me.animationContext,false);},calculateRnsRneFromSXP:function calrns(){var me=this;var rne=Math.round((me.SRXP-masterMargin.l)/me.MRTX)+1;rne=Math.min(rne,me.windowSize);var rns=Math.round((me.SLXP-masterMargin.l)/me.MRTX);this.updateRnsRne(rns,rne);},reDrawSlaveChartImpl:function reDrawSlaveChartImpl(){var me=this,model=me.model,currStatus=chartStatus[this.chartID],values=model.series,context=me.animationContext;this.drawPreparation(me.windowSize,currStatus.rns,currStatus.rne);me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,context,false);localUpdateScrollerConfig.call(me);this.removeLabels();itemClicked=true;this.drawLabels();itemClicked=false;},redrawSeries:function redrawSeries(){var me=this,model=me.model,values=model.series,context=me.animationContext,windowSize=me.windowSize,ht=me.getHeight(),currStatus=chartStatus[this.chartID];me.animationCanvas.width=me.animationCanvas.width;me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,context,false);localUpdateScrollerConfig.call(me);this.removeLabels();itemClicked=true;this.drawLabels();itemClicked=false;},incFetchChart:function incFetchChart(mustRedraw){var me=this,model=me.model,currStatus=chartStatus[this.chartID],values=model.series,context=me.animationContext,m=me.margin,utils=me.utils,lines=[],width=me.getWidth(),chartWidth=me.getChartWidthOnScreen(),h=me.canvas.height,windowSize=me.windowSize;var v0l=values[0].rv.length;var diff=currStatus.rne-currStatus.rns;var needRedraw=getACRnsRne.call(this);var redrawChart=mustRedraw||needRedraw||currStatus.isLegendSelected||me.needRedrawVerticalLine;if(redrawChart){var ACdiff=me.ACrne-me.ACrns;if(diff<v0l){if(diff>1){diff--;}if(ACdiff>1){ACdiff--;}v0l--;}totalChartWidth=(v0l/diff)*chartWidth;me.totalChartWidth=totalChartWidth;var acContentWidth=0;if(model.currentRatio>rangeToSeriesMaxRatio){acContentWidth=(ACdiff/diff)*chartWidth;}else{acContentWidth=totalChartWidth;}this.acContentWidth=acContentWidth;me.animationCanvas.width=me.animationCanvas.width;me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,context,false);localUpdateScrollerConfig.call(me);}this.removeLabels();itemClicked=true;this.drawLabels(!redrawChart);itemClicked=false;},reDrawSlaveChart:function reDrawSlaveChart(){var me=this;this.calculateRnsRneFromSXP();this.reDrawSlaveChartImpl();chartSizeChanged=false;masterSliderClicked=null;this.hideMessage();},drawSeries:function drawSeries(start,end,rns,rne,values,context,isMasterChart){var me=this,utils=me.utils,lines=[],k=0,vl=values.length;var lineWidth=isMasterChart?1:(rne-rns>180?1:2);for(var j=vl-1;j>=0;j--){lines=[];k=0;for(var i=start;i<end;i++){var val=values[j].rv[i];if(val.length===0){lines[k++]=null;continue;}lines[k]={x:isMasterChart?((i*me.MRTX)+masterMargin.l+1):((i-start)*me.RTX),y:isMasterChart?utils.getMasterYValue(me,val,masterMargin):utils.getYValue(me,val)};k++;}me.drawChartLine(lines,rns-start,rne-start,j,context,isMasterChart,lineWidth);}if(!isMasterChart&&me.lastSelectedPoint){me.highlightSelectedPoint();}},getSerieColor:function getSerieColor(serieIndex){var clrLength=this.chartLineColors.length;return this.chartLineColors[serieIndex%clrLength];},drawChartLine:function drwcl(lines,rns,rne,si,context,isMasterChart,lw){var me=this,m=me.model,s=m.series[si],utils=this.utils,currStatus=chartStatus[this.chartID];context.save();context.lineCap="round";context.lineWidth=lw||2;context.lineJoin="round";context.beginPath();if(this.formatProp&&this.formatProp.useCustomAxisScale){var margin;if(!isMasterChart){margin=me.margin;context.rect(0,margin.t,me.animationCanvas.width,me.slaveChartHeight-margin.b-margin.t);}else{margin=masterMargin;context.rect(0,margin.t,me.getWidth(),me.masterChartHeight-margin.b-margin.t);}context.clip();}var clr=this.getSerieColor(si),rgbClr=$CLR.hex2rgb(clr),l=lines.length,dataPointPerScreen=rne-rns;context.strokeStyle=clr;if(currStatus.isLegendSelected&&!isMasterChart){if(currStatus.legendSelectedIndex===si){var MaxY=this.canvas.height-this.margin.b;var start=rns,end=rne-1;for(var i=0;i<Math.ceil((l-1-rns)/(dataPointPerScreen-1));i++){if(mstrmojo.dom.isIE10){utils.drawLineAreaWithSplit(me,lines,start,end,MaxY,rgbClr,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineArea(me,lines,start,end,MaxY,rgbClr,context);}start=end;end=Math.min(start+dataPointPerScreen-1,l-1);}start=Math.max(rns-dataPointPerScreen+1,0),end=rns;for(var i=Math.ceil((rns)/(dataPointPerScreen-1));i>0;i--){if(mstrmojo.dom.isIE10){utils.drawLineAreaWithSplit(me,lines,start,end,MaxY,rgbClr,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineArea(me,lines,start,end,MaxY,rgbClr,context);}end=start;start=Math.max(start-dataPointPerScreen+1,0);}if(mstrmojo.dom.isIE10){utils.drawLineAreaWithSplit(me,lines,start,end,MaxY,rgbClr,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineArea(me,lines,start,end,MaxY,rgbClr,context);}context.strokeStyle=this.highlightColor;context.globalAlpha=1;context.lineWidth=2;}else{context.globalAlpha=0.3;context.lineWidth=1;}}if(mstrmojo.dom.isIE10){utils.drawLineSetWithSplit(me,lines,false,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineSet(me,lines,false,context);}context.restore();},drawLabels:function drwlbls(needNotDrawVerticalGridLine){this.drawChartXYAxis();if(this._super){this._super(needNotDrawVerticalGridLine);}},drawSelector:function drwsl(lbl,rl,intervalChanged){var m=this.model,sl=m.series[0].rv.length,rng=sl,bm=this.baseModel,row=bm.rowHeaders,currStatus=chartStatus[this.chartID],rns=currStatus.rns,rne=currStatus.rne;if(intervalChanged){var rs=parseInt(rl.rs,10);var sr=rl.sr;for(var i=0;i<row.length;i++){if(row[i].id===sr){rng=row[i].l*rs;break;}}if(rng<2){rng=2;}var index=mstrmojo.dom.findAncestorByAttr(lbl,"value",true,this.domNode);var right=rne;if(right-rng>=0){currStatus.rns=right-rng;currStatus.rne=right;}else{currStatus.rns=0;currStatus.rne=rng<sl?rng:sl;}this.updateIntervalPosition();this.updateRnsRne();}this.refreshChart(true,isDataSetChanged);itemClicked=false;this.hideMessage();},getTouchValue:function gtvlindx(x,y){var md=this.model,m=this.margin,currStatus=chartStatus[this.chartID];var sz=currStatus.rne-currStatus.rns>0?currStatus.rne-currStatus.rns>1?currStatus.rne-currStatus.rns:2:this.windowSize;var touchVal=Math.round(((x-m.l)*(sz-1))/(this.getChartWidthOnScreen()));return(touchVal<sz)?touchVal:null;},getNearestPoint:function getNP(touchX,touchY){var me=this,currStatus=chartStatus[this.chartID],margin=me.margin;var touchPointOnWidget=me.utils.getTouchXYOnWidget(touchX,touchY,me);touchX=touchPointOnWidget.touchX;touchY=touchPointOnWidget.touchY;if(touchX<margin.l||touchY<margin.t||touchY>me.canvas.height-margin.b){return ;}var xIndexOnScreen=this.getTouchValue(touchX,touchY);var rowIdx=xIndexOnScreen+currStatus.rns;var pointX=(xIndexOnScreen*me.RTX)+me.margin.l;var pointY,serieIdx;if(currStatus.isLegendSelected){serieIdx=currStatus.legendSelectedIndex;pointY=me.utils.getYValue(me,me.model.series[serieIdx].rv[rowIdx]);}else{var nearestPoint=me.utils.getSeriesIndexAndYValue(me,rowIdx,touchY);serieIdx=nearestPoint.si;pointY=nearestPoint.y;}return{rowIdx:rowIdx,serieIdx:serieIdx,point:{x:pointX,y:pointY}};},highlightPoint:function hghlghtpnt(x,touchX,touchY){var me=this,ctx=me.highlightContext,height=me.highlightCanvas.height,mg=me.margin,m=me.model,utils=me.utils,currStatus=chartStatus[this.chartID],si=currStatus.isLegendSelected?currStatus.legendSelectedIndex:me.seriesIndex;this.highlightCanvas.width=this.highlightCanvas.width;if(x<0){return ;}var xcoord=(x*me.RTX)+mg.l;ctx.strokeStyle=this.utils.rgb2rgbStr(this.formatProp.textClr);ctx.lineCap="round";ctx.lineWidth=2;ctx.globalAlpha=1;utils.drawLineSet(me,[{x:touchX,y:this._tooltip.domNode.offsetHeight},{x:touchX,y:height-mg.b}],false,ctx);ctx.strokeStyle=me.highlightColor;ctx.fillStyle=ctx.strokeStyle;var s=m.series,l=s.length,rns=(currStatus.rns===0||currStatus.rne-currStatus.rns>1)?currStatus.rns:currStatus.rns-1,rowIdx=rns+x,y=utils.getYValue(me,s[si].rv[rowIdx]);if(!chartStatus[this.chartID].isLegendSelected){ctx.strokeStyle=me.getSerieColor(si);}ctx.fillStyle=ctx.strokeStyle;if(y>=mg.t&&y<=this.canvas.height-mg.b){utils.drawArc(me,xcoord,y,5,0,Math.PI*2,true,true,ctx);}this.lastHighlightPoint={rowIdx:rowIdx,serieIdx:si,point:{x:xcoord,y:y}};},hideTimeSelectorLabels:function htsl(){var lbls=this.domNode.getElementsByClassName("timeseries-intervals");for(var i=0;i<lbls.length;i++){lbls[i].style.display="none";}},showTimeSelectorLabels:function stsl(){var lbls=this.domNode.getElementsByClassName("timeseries-intervals");for(var i=0;i<lbls.length;i++){lbls[i].style.display="block";}},getFormattedDateForTooltip:function getFormattedDateForTooltip(val,isLongFormat){if(isNaN(val)){return val;}var fVal=val;try{val=this.utils.convertRawValueToMilliseconds(val);var dt=new Date(Number(val)),$_DT=mstrmojo.locales.datetime;var mn=isLongFormat?$_DT.MONTHNAME_FULL[dt.getMonth()]:$_DT.MONTHNAME_SHORT[dt.getMonth()];var yr=dt.getFullYear().toString();if(isLongFormat){fVal=mn+" "+dt.getDate()+", "+yr;}else{fVal=mn+"-"+dt.getDate()+"-"+yr.substring(2);}}catch(e){}return fVal;},showLegendTooltip:function showLegendTooltip(e){this._legendTooltip.updateContent(e);},hiddenLegendTooltip:function hiddenLegendTooltip(){this._legendTooltip&&this._legendTooltip.toggle(false);},getLegendName:function getLegendName(colHeaders,series,i){var colHLength=colHeaders.length;var hiLength=series[i].hi.length;if(colHLength<1){return"null";}if(hiLength==colHLength){var legendName="";for(var j=0;j<hiLength;j++){var colHeader=colHeaders[j];var colName="";if(colHeader.es){colName=colHeader.es[series[i].hi[j]];}else{colName=colHeader.items[series[i].hi[j]].n;}if(j>0){legendName+=" ";}if(colName!=""){legendName+=colName;}}return legendName;}else{var items=colHeaders[0].items;legendName=items[i%items.length].n;return legendName;}return"null";},getRowHeader:function getrh(idx){var me=this,m=me.model,riArray=m.ri,s=m.series,cat=m.categories,tp=cat.tp,currStatus=chartStatus[this.chartID],rowHs=m.rowHeaders,rowHLength=rowHs.length,rowHeader=[];var rVal=cat.items[idx];var ri=riArray&&riArray[idx];if(!ri){return rowHeader;}if(tp.toString()===me.DSS_XML_BASE_FORM_DATE){rVal=me.getFormattedDateForTooltip(rVal,true);var rowHeaderObj={};rowHeaderObj.n=rowHs[rowHLength-1].n;rowHeaderObj.v=rVal;rowHeader.push(rowHeaderObj);}else{for(var i=0;i<rowHLength;i++){var rowHeaderObj={};var rowH=rowHs[i];rowHeaderObj.n=rowH.n;rowHeaderObj.v=rowH.es[ri[i]]||"";rowHeader.push(rowHeaderObj);}}return rowHeader;},setMarginTopByTooltipHeight:function setMarginTopByTooltipHeight(){var me=this,m=me.model,mg=me.margin,s=m.series,colH=m.colHeaders;if(this._tooltip){this._tooltip.displayInfo([{n:"legendName",v:"val"},{n:"rowHeaderName",v:"rowHeaderValue"}]);this._tooltip.toggle(true);var height=this._tooltip.domNode.offsetHeight+10;this._tooltip.toggle(false);if(me.margin.t<height){me.margin.t=height;}}var stt=me.sliderTooltip,sttF=stt.firstChild,sttP=stt.lastChild;sttF.innerHTML="name: value";sttF.style.display="block";var sliderTooltipHeight=sttF.offsetHeight;me.sliderTooltipYPosition=me.getHeight()-me.masterChartHeight-sliderTooltipHeight-7+masterMargin.t;sttP.style.top=sliderTooltipHeight+"px";sttF.style.display="none";},renderTooltip:function rndrttp(valIndex,touchX,touchY){if(valIndex<0){this._tooltip.toggle(false);return ;}var me=this,m=me.model,mg=me.margin,s=m.series,currStatus=chartStatus[this.chartID],si=currStatus.isLegendSelected?currStatus.legendSelectedIndex:me.seriesIndex,rns=(currStatus.rns===0||currStatus.rne-currStatus.rns>1)?currStatus.rns:currStatus.rns-1,colH=m.colHeaders;var width=me.getWidth();if(!tooltipShown){me.hideTimeSelectorLabels();tooltipShown=true;var touchManager=mstrmojo.touchManager;this._touchListener=touchManager.attachEventListener("touchesBegin",this.id,function(evt){if(!isTouchedOnWidget.call(me,evt.touch)){me.hiddenTooltipAndShowTimeSelector();}});}var vIdx=rns+valIndex;var val=s[si].v[vIdx]?s[si].v[vIdx]:"null";var legendName=this.getLegendName(colH,s,si);var rowHeaders=this.getRowHeader(vIdx),rowHeaderName="",rowHeaderValue="";for(var i=0;i<rowHeaders.length;i++){rowHeaderName+=rowHeaders[i].n;rowHeaderValue+=rowHeaders[i].v;if(i<rowHeaders.length-1){rowHeaderName+=" ";rowHeaderValue+=" ";}}this._tooltip.displayInfo([{n:legendName,v:val},{n:rowHeaderName,v:rowHeaderValue}]);this._tooltip.toggle(true);this._tooltip.doLayout(width-10);var ttw=this._tooltip.domNode.offsetWidth,x=touchX-ttw/2;if(x<5){x=5;}else{if(x>width-5-ttw){x=width-5-ttw;}}this._tooltip.posTo({x:x,y:5});},handleTouchEnd:function handleTouchEnd(){this._super();this._tooltip&&this._tooltip.toggle(false);},showMessage:function shmsg(text){var msg=this.loadingMsg,mns=msg.style;msg.innerHTML=text||mstrmojo.desc(5674,"Loading...");mns.display="block";mns.opacity=1;var x=Math.round(this.getWidth()/2-msg.offsetWidth/2);var y=Math.round(this.getHeight()/2-msg.offsetHeight/2);this.utils.translateCSS(x,y,false,msg);},hideMessage:function hmsg(){this.loadingMsg.style.opacity=0;},showMasterSliderTooltip:function showMasterSliderTooltip(item){$CSS.addClass(item.node,"mstrmojo-timeseries-span-shadow");var stt=this.sliderTooltip;stt.firstChild.style.display="block";stt.lastChild.style.display="block";this.renderSliderTooltip(item.value==="L"?this.SLXP:this.SRXP);},unrender:function unrender(ignoreDom){if(this._tooltip){this._tooltip.destroy();delete this._tooltip;}if(this._legend){this._legend.destroy();delete this._legend;}if(this._timeSelector){this._timeSelector.destroy();delete this._timeSelector;}if(this._legendTooltip){this._legendTooltip.destroy();delete this._legendTooltip;}if(this._super){this._super(ignoreDom);}},refresh:function refresh(){var me=this;removeLegendAndTimeSelectorChildren.call(this);me.removeLabels();me.lastSelectedPoint=null;me.render();},removeLabels:function rmvlbls(){var me=this;me.canvas.width=me.canvas.width;me.utils.fillBackground(me);me.xLabelsDiv.innerHTML="";var lbls=me.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(lbls){lbls.innerHTML="";}},refreshChart:function refcht(isMetric,pld){var me=this,wd=me.getWidth(),ht=me.getHeight();if(me.model.err){return ;}me.highlightCanvas.width=wd;me.animationCanvas.width=me.animationCanvas.width;if(isMetric){me.context.clearRect(0,0,wd,ht);me.removeLabels();if(pld){me.data.processLinearData(me);}}me.drawChart();this.setAnimationCanvasContainer();me.drawLabels();localUpdateScrollerConfig.call(me);},timeSelectorOnClick:function hoc(item){var currStatus=chartStatus[this.chartID];if(!itemClicked){itemClicked=true;var me=this,v=item.value,node=item.node,intervalChanged=true;if(node===me.currSelection&&!currStatus.usingCustomInterval){itemClicked=false;return ;}if(v==="S"){if(currStatus.usingCustomInterval){currStatus.usingCustomInterval=false;}else{me.updateIntervalPosition();}if(me.currSelection){me._timeSelector.toggleSelected(me.currSelection,false);me._timeSelector.toggleGlowEffect(me.currSelection,false);}me._timeSelector.toggleSelected(node,true);me._timeSelector.toggleGlowEffect(node,true);var bm=me.baseModel,tslIndex=parseInt(node.getAttribute("value"));var tsl=bm.vp.rl[tslIndex];if((bm.k&&bm.k!==tsl.ds)&&me.layoutModel){var getData=resetBaseAndDerivedData.call(this,tsl);if(!getData){return ;}}else{isDataSetChanged=false;}intervalChanged=node!==me.currSelection;me.currSelection=node;currStatus.currSelectionIdx=me.currSelection.getAttribute("value");me.showMessage();window.setTimeout(function(){me.drawSelector(node,tsl,intervalChanged);},10);}}},moveMasterSlider:function moveMasterSlider(x){var me=this,m=me.model,width=me.getWidth(),delta=Math.round(x-originalTouchPosition),currStatus=chartStatus[this.chartID];this.SLXP+=delta;this.SRXP+=delta;this.SLXP=Math.round(this.SLXP);this.SRXP=Math.round(this.SRXP);this.makeSureMasterSliderNotBeyondTheMargin(true);this.setMasterSliderLayout();this.calculateRnsRneFromSXP();localUpdateScrollerConfig.call(me);if(!currStatus.usingCustomInterval&&this.currSelection){this.updateIntervalPosition();}},updateIntervalPosition:function updateIntervalPosition(){var me=this,m=me.model,currStatus=chartStatus[this.chartID];if(me.currSelection){var index=me.currSelection.getAttribute("value");currStatus.timeSelectedIntervalPosition[index]={rns:currStatus.rns,rne:currStatus.rne};}},drawSliderTooltipPointer:function drawSliderTooltipPointer(){var canvas=this.sliderTooltip.lastChild,cntx=canvas.getContext("2d"),width=canvas.width,height=canvas.height;cntx.fillStyle="#ffffff";cntx.beginPath();cntx.moveTo(0,0);cntx.lineTo(width,0);cntx.lineTo(width/2,height);cntx.lineTo(0,0);cntx.closePath();cntx.fill();},renderSliderTooltip:function renderSliderTooltip(sliderTooltipXPosition){var me=this,stt=me.sliderTooltip,sttF=stt.firstChild,sttP=stt.lastChild,width=me.getWidth();var pointerPos=sliderTooltipXPosition;var content=getFormattedDateForSliderTooltip.call(this,sliderTooltipXPosition);if(content==""){content="--";}sttF.innerHTML=content;var stWidth=sttF.offsetWidth,stHalfWidth=stWidth/2;if(sliderTooltipXPosition!==this.SLXP){sliderTooltipXPosition=this.SRXP-stHalfWidth;}else{sliderTooltipXPosition-=stHalfWidth;}if(sliderTooltipXPosition<0){sliderTooltipXPosition=0;}else{if(sliderTooltipXPosition+stWidth>width){sliderTooltipXPosition=width-stWidth;}}sttP.style.left=(pointerPos-sliderTooltipXPosition-3)+"px";me.utils.translateCSS(sliderTooltipXPosition,me.sliderTooltipYPosition,false,stt);},resizeMasterSlider:function resizeMasterSlider(x){var me=this,width=me.getWidth(),msl=me.masterSlider,msls=msl.style,lcs=msl.parentNode.firstChild.style,rcs=msl.parentNode.childNodes[2].style;var touchPoint=me.utils.getTouchXYOnWidget(x,0,me);x=touchPoint.touchX;var fixWhich;if(masterSliderClicked==="L"){this.SLXP=x;fixWhich="R";}else{this.SRXP=x;fixWhich="L";}me.makeSureMasterSliderNotBeyondTheMargin();me.makeSureMasterSliderNoOverlap(fixWhich);this.setMasterSliderLayout();if(masterSliderClicked==="L"){me.renderSliderTooltip(this.SLXP);}else{me.renderSliderTooltip(this.SRXP);}chartStatus[this.chartID].usingCustomInterval=true;chartSizeChanged=true;},shouldTouchBubble:function shouldTouchBubble(touch){return false;},hiddenTooltipAndShowTimeSelector:function hsctooltip(){if(tooltipShown){this.handleTouchEnd();tooltipShown=false;this.showTimeSelectorLabels();var touchManager=mstrmojo.touchManager;touchManager.detachEventListener(this._touchListener);delete this._touchListener;}},onCrossWidgetMultitouch:function onCrossWidgetMultitouch(){this.hiddenTooltipAndShowTimeSelector();},touchBegin:function touchBegin(touch){this.adjustWidgetOffsets();var item=this.isMasterSliderTouched(touch);if(item){this.hiddenTooltipAndShowTimeSelector();var value=item.value;if(value==="L"||value==="R"||value==="MS"){masterSliderClicked=item.value;originalTouchPosition=touch.pageX;if(item.value!=="MS"){this.showMasterSliderTooltip(item);}}else{return false;}}else{if(!isScrollableElementTouched.call(this,touch)){this.hiddenTooltipAndShowTimeSelector();if(this.shouldTouchBubble(touch)){return this.bubbleTouchEvent(touch);}return false;}}},isMasterSliderTouched:function isMasterSliderTouched(touch){var item=getTouchedElement.call(this,touch);if(item&&(item.value==="L"||item.value==="R")){return item;}var touchRadius=45*this.utils.getScreenZoomFactor();var position=this.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,this);var touchX=position.touchX,touchY=position.touchY;var height=this.getHeight();if(touchY>height||touchY<height-this.masterChartHeight){return null;}if(touchX<this.SRXP&&touchX>this.SLXP){return{node:this.masterSlider.childNodes[1],value:"MS"};}var LDistance=Math.abs(touchX-this.SLXP);var RDistance=Math.abs(this.SRXP-touchX);var minDistance=Math.min(LDistance,RDistance);if(minDistance<touchRadius){if(LDistance==minDistance){return{node:this.masterSlider.firstChild,value:"L"};}else{if(RDistance==minDistance){return{node:this.masterSlider.lastChild,value:"R"};}}}else{return null;}return null;},touchSelectBegin:function touchSelectBegin(touch){this.hiddenTooltipAndShowTimeSelector();var item=this.isMasterSliderTouched(touch);if(item){if(item.value==="L"||item.value==="R"||item.value==="MS"){masterSliderClicked=item.value;originalTouchPosition=touch.pageX;}}else{this.handleTouchBegin(touch.pageX,touch.pageY);}},touchSelectMove:function touchSelectMove(touch){if(masterSliderClicked){if(masterSliderClicked==="MS"){this.moveMasterSlider(touch.pageX);}else{this.resizeMasterSlider(touch.pageX);}originalTouchPosition=touch.pageX;return false;}this.handleTouchMove(touch.pageX,touch.pageY);},handleTouchSelectEnd:function handleTouchSelectEnd(touch){if(masterSliderClicked){if(masterSliderClicked==="MS"){this.makeSureSliderOnPoint();this.setMasterSliderLayout();this.incFetchChart();}else{resizeMasterSliderDone.call(this);}return false;}var canBeSelected=false;if(touch){var nearestPoint=this.getLastHighlightPoint();canBeSelected=nearestPoint&&this.pointCanBeSelected(nearestPoint.rowIdx,nearestPoint.serieIdx);}if(!canBeSelected){this.handleTouchEnd();if(tooltipShown){tooltipShown=false;this.showTimeSelectorLabels();}}else{this.seriesIndex=-1;}this.hiddenLegendTooltip();},touchSelectEnd:function touchSelectEnd(touch){this.handleTouchSelectEnd(touch);},touchMultiBegin:function touchMultiBegin(touch){this.handleTouchSelectEnd();},touchSwipeMove:function touchSwipeMove(touch){if(isScrollableElementTouched.call(this,touch)&&this._super){this._super(touch);}else{if(masterSliderClicked){if(masterSliderClicked==="MS"){this.moveMasterSlider(touch.pageX);}else{this.resizeMasterSlider(touch.pageX);}originalTouchPosition=touch.pageX;}}},touchSwipeEnd:function touchSwipeEnd(touch){if(masterSliderClicked){if(masterSliderClicked==="MS"){this.makeSureSliderOnPoint();this.setMasterSliderLayout();this.incFetchChart();}else{resizeMasterSliderDone.call(this);}return false;}else{if(this._super){this._super(touch);}}},touchSelectCancel:function touchSelectCancel(touch){this.touchCancel(touch);},touchCancel:function touchCancel(touch){this.touchSelectEnd(touch);},touchEnd:function touchEnd(touch){if(masterSliderClicked&&!chartSizeChanged){hideMasterSliderTooltip.call(this);masterSliderClicked=null;}this._legend.hiddenSwitcherArrowGlowEffect();return false;},pointCanBeSelected:function pcbs(rowIdx,serieIdx){if(this.selectionOrLinkdrillOnRow){return true;}var me=this,m=me.model,colHeaders=m.colHeaders,colHL=colHeaders.length,hi=m.series[serieIdx].hi,hiLength=hi.length;for(var i=0;i<colHL;i++){var colH=colHeaders[i];if(colH.es){if(colH.sc&&colH.sc.tks){return true;}if(colH.lm&&colH.lm[0]&&colH.lm[0].links){return true;}}else{if(colH.sc&&colH.sc.tks){return true;}var lmArray=colH.lm,lm=lmArray&&lmArray[hi[i]];if(lm&&lm.links){return true;}}}return false;},getModelK:function getModelK(){var k=this.baseModel&&this.baseModel.k;return k;},getActionObjList:function getActionObjList(nearestPoint,selectedAll){var actionObjList=[];var scObjList=[];var actionType=0;var actionObjList=[];var linkDrillNode=null;var metricColHIdx=-1;var me=this,model=me.model,riArray=model.ri,ri=riArray[nearestPoint.rowIdx],rowHeaders=model.rowHeaders,rowHL=rowHeaders.length;for(var i=0;i<rowHL;i++){var rowH=rowHeaders[i];if(rowH.sc&&rowH.sc.tks){if(selectedAll&&(rowH.sc.all==="false"||rowH.sc.all===false)){return null;}var scObj={};scObj.sc=rowH.sc;scObj.es=rowH.es[ri[i]];scObj.eid=selectedAll?"OA:(All)":rowH.eid[ri[i]];scObjList.push(scObj);actionType=rowH.at||0;}if(rowH.lm&&rowH.lm[0]&&rowH.lm[0].links&&!linkDrillNode){linkDrillNode={};linkDrillNode.titleInfo=rowH;linkDrillNode._e={id:rowH.eid[ri[i]],n:rowH.es[ri[i]]};}}var colHeaders=model.colHeaders,colHL=colHeaders.length,hi=model.series[nearestPoint.serieIdx].hi,hiLength=hi.length;for(var i=colHL-1;i>=0;i--){var colH=colHeaders[i];if(colH.es){if(colH.sc&&colH.sc.tks){if(selectedAll&&(colH.sc.all==="false"||colH.sc.all===false)){return null;}var scObj={};scObj.sc=colH.sc;scObj.es=colH.es[hi[i]];scObj.eid=selectedAll?"OA:(All)":colH.eid[hi[i]];scObjList.push(scObj);actionType=colH.at||0;}if(colH.lm&&colH.lm[0]&&colH.lm[0].links&&!linkDrillNode){linkDrillNode={};linkDrillNode.titleInfo=colH;linkDrillNode._e={id:colH.eid[hi[i]],n:colH.es[hi[i]]};}}else{if(colH.sc&&colH.sc.tks){if(selectedAll&&(colH.sc.all==="false"||colH.sc.all===false)){return null;}var scObj={};scObj.sc=colH.sc;scObj.es=colH.items[hi[i]].n;scObj.eid=selectedAll?"OA:(All)":colH.items[hi[i]].id;scObjList.push(scObj);actionType=colH.at||0;}metricColHIdx=i;}}if(scObjList.length>0){actionType=actionType|SELECTOR_ACTION;this.infoWindowAnchor.style.left=(nearestPoint.point.x-9)+"px";this.infoWindowAnchor.style.top=(nearestPoint.point.y-9)+"px";actionObjList.push({at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:this.infoWindowAnchor});return actionObjList;}if(!linkDrillNode){var metricH=colHeaders[metricColHIdx],metric=metricH.items[hi[metricColHIdx]],lm=metricH.lm[hi[metricColHIdx]];if(lm&&lm.links){linkDrillNode={};linkDrillNode.titleInfo=metricH;linkDrillNode.mix=hi[metricColHIdx];var currNode=linkDrillNode;for(var i=0;i<rowHL;i++){var rowH=rowHeaders[i];var nodeLP={};nodeLP.titleInfo=rowH;nodeLP._e={id:rowH.eid[ri[i]],n:rowH.es[ri[i]]};currNode._lp=nodeLP;currNode.axis=ROW_AXIS;currNode=nodeLP;}currNode=linkDrillNode;for(var i=colHL-1;i>=0;i--){var colH=colHeaders[i];if(colH.es){var nodeTP={};nodeTP.titleInfo=colH;nodeTP._e={id:colH.eid[hi[i]],n:colH.es[hi[i]]};currNode._tp=nodeTP;currNode.axis=COL_AXIS;currNode=nodeTP;}}}}if(linkDrillNode){actionType=actionType|HYPERLINK_ACTION;actionObjList.push({at:actionType,k:this.getModelK(),node:linkDrillNode});return actionObjList;}return null;},getLastHighlightPoint:function gtLstHighlightPnt(){return this.lastHighlightPoint||null;},performAction:function performAction(actionObjList){this.hasNonifwTarget=this.hasNoninfowindowTarget(actionObjList[0]);if(this._super){this._super(actionObjList);}},touchTap:function touchTap(touch){var me=this,nearestPoint=this.getLastHighlightPoint(),touchPointOnWidget=me.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,me);var touchPointInHighlightArea=tooltipShown&&getPointDistanceSquare({x:nearestPoint.point.x,y:nearestPoint.point.y},{x:touchPointOnWidget.touchX,y:touchPointOnWidget.touchY})<=45*45;if(touchPointInHighlightArea){me.hiddenTooltipAndShowTimeSelector();nearestPoint=this.getLastHighlightPoint();}else{nearestPoint=this.getNearestPoint(touch.pageX,touch.pageY);}if(isScrollableElementTouched.call(this,touch)){var fallInPointArea=getPointDistanceSquare({x:nearestPoint.point.x,y:nearestPoint.point.y},{x:touchPointOnWidget.touchX,y:touchPointOnWidget.touchY})<=45*45,canBeSelected=me.pointCanBeSelected(nearestPoint.rowIdx,nearestPoint.serieIdx),sameAsLastSelectedPoint=me.lastSelectedPoint&&(nearestPoint.rowIdx==me.lastSelectedPoint.rowIdx&&nearestPoint.serieIdx==me.lastSelectedPoint.serieIdx);if(fallInPointArea&&canBeSelected&&!sameAsLastSelectedPoint){if(tooltipShown){me.hiddenTooltipAndShowTimeSelector();}me.lastSelectedPoint=nearestPoint;me.incFetchChart(true);var actionObjList=this.getActionObjList(nearestPoint);me.performAction(actionObjList);}else{if(fallInPointArea&&!canBeSelected){if(touchPointInHighlightArea){}else{this.handleTouchBegin(touch.pageX,touch.pageY);}}else{if(tooltipShown){me.hiddenTooltipAndShowTimeSelector();}else{if(me.lastSelectedPoint){var actionObjList=this.getActionObjList(nearestPoint,true);if(actionObjList){me.performAction(actionObjList);me.lastSelectedPoint=null;me.incFetchChart(true);}}}}}}},highlightSelectedPoint:function highlightSelectedPoint(){var me=this,ctx=me.animationContext,utils=me.utils,pointInfo=me.lastSelectedPoint,point=pointInfo.point,currStatus=chartStatus[this.chartID];ctx.save();if(currStatus.isLegendSelected&&currStatus.legendSelectedIndex!=pointInfo.serieIdx){ctx.globalAlpha=0.3;}else{ctx.globalAlpha=1;}var pointX=(pointInfo.rowIdx-me.ACrns)*me.RTX;ctx.fillStyle=me.getSerieColor(pointInfo.serieIdx);ctx.lineWidth=1;utils.drawArc(me,pointX,point.y,4,0,Math.PI*2,true,true,ctx);if(this.theme==LIGHT_THEME){ctx.strokeStyle="#ffffff";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,5,0,Math.PI*2,true,false,ctx);ctx.strokeStyle="#000000";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,7,0,Math.PI*2,true,false,ctx);}else{ctx.strokeStyle="#333333";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,5,0,Math.PI*2,true,false,ctx);ctx.strokeStyle="#ffffff";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,7,0,Math.PI*2,true,false,ctx);}ctx.restore();},destroy:function destroy(){if(this.currSelection){delete this.currSelection;}if(this._touchListener){mstrmojo.touchManager.detachEventListener(this._touchListener);delete this._touchListener;}if(this._scrollDoneListener){this._scroller.detachEventListener(this._scrollDoneListener);delete this._scrollDoneListener;}if(this._scrollMovedListener){this._scroller.detachEventListener(this._scrollMovedListener);delete this._scrollMovedListener;}if(this._infoWClosedListener){this.xtabModel.docModel.detachEventListener(this._infoWClosedListener);delete this._infoWClosedListener;}if(this.fullScreenListener){mstrmojo.touchManager.detachEventListener(this.fullScreenListener);delete this.fullScreenListener;}if(this.selectorTargets){delete this.selectorTargets;}this._super();if(this._tn){delete this._tn;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.VisChartUtils","mstrmojo._HasTouchScroller","mstrmojo.color","mstrmojo.css","mstrmojo.VisMicroChartLine","mstrmojo.VisMicroChartBar","mstrmojo.VisMicroChartBullet","mstrmojo._NeedSyncScroller");var S=1;var w=2;var A=3;var W=4;var V=0,d=1,t=2,C=3,AG=4,F=5;var p=0;var AB=1;var AH=2;var AE="width:0px;height:0px;border-left:10px solid black;border-top:5px solid transparent;border-bottom:5px solid transparent;margin-left:auto;margin-right:auto;-webkit-transform:scale(0.8,0.9)";var AD="width:0px;height:0px;border-left:5px solid transparent;border-top:10px solid black;border-right:5px solid transparent;margin-left:auto;margin-right:auto;-webkit-transform:scale(0.9,0.8)";var o=0,T=1;var E=1;var Q=mstrmojo.color,D=mstrmojo.css;var a="microchart-table-text";var R=0;var P=0;function g(AJ){AJ.innerHTML="";}function f(){var AJ=this.backgroundColor;if(!AJ){return ;}this.dockedHeaderTable.style.backgroundColor=AJ;this.dockedHeaderTable.style.opacity="1";this.dockedHeaderReplaceDiv.firstChild.style.backgroundColor=AJ;this.dockedHeaderReplaceDiv.firstChild.style.opacity="1";}function M(AL,AM){var AQ=AL.style.height;var AJ=AL.style.width;var AR=AL.style.textDecoration;var AP=AL.style.display;var AS=AL.style.fontSize;var AN=AL.style.paddingLeft;var AK=AL.style.paddingRight;var AO=AL.style.boxShadow;AL.style.cssText=AM;AL.style.height=AQ;AL.style.width=AJ;AL.style.textDecoration=AR;if(AP){AL.style.display=AP;}if(AS){AL.style.fontSize=AS;}if(AN){AL.style.paddingLeft=AN;}if(AK){AL.style.paddingRight=AK;}if(AO){AL.style.boxShadow=AO;}}function z(AR,AQ,AM){var AK=AQ.level;var AL="";if(AQ.isLeaf){AL=p;}else{if(AQ.needExpand){AL=AB;}else{AL=AH;}}var AN=null;var AO=this.bodyFontColorRGB;var AP=this.theme;if(AL==AH){AR.className="microchart-tree-arrow-close";AN="border-left-color";}else{if(AL==AB){AR.className="microchart-tree-arrow-open";AN="border-top-color";}else{AR.className="";AR.setAttribute("style","");return ;}}var AJ="";if(AM){AJ=AN+":"+AM;}else{if(AP==w){if(AK==0){AJ=AN+":#4c4c4c";}else{if(AK==1){AJ=AN+":rgba(76,76,76,0.8)";}else{if(AK>1){AJ=AN+":rgba(76,76,76,0.6)";}}}}else{if(AP==S){if(AK==0){AJ=AN+":white";}else{if(AK==1){AJ=AN+":rgba(255,255,255,0.8)";}else{if(AK>1){AJ=AN+":rgba(255,255,255,0.6)";}}}}else{if(AO&&AO.length>2&&(AP==W||AP==A)){if(AK==0){AJ=AN+":rgba("+AO[0]+","+AO[1]+","+AO[2]+",0.8)";}else{if(AK>0){AJ=AN+":rgba("+AO[0]+","+AO[1]+","+AO[2]+",0.7)";}}}}}}AR.setAttribute("style",AJ);}function O(Ay,Ad){var Ag=this.widget,Ao=Ag.rows[Ay],AN=Ao.model,AQ=AN.elms,AP=this.rowTemplate,AS=Ao.treeNode,Ah=this.colInfos,Ay=Ao.rowIdx,An=null,AT=Ah.length;var Af=this.bodyFontColorRGB;var AX=this.headerTable.firstChild.firstChild.childNodes;An=Ad?Ad.rowRef:Ao.rowRef;var Ax=null;var Ak=null;if(An[this.domRefName]){Ax=An[this.domRefName];}else{Ax=AP.cloneNode(true);An[this.domRefName]=Ax;}Ax.style.display="";k.call(this,Ad?Ad:Ao);if(!this.isAndroidTab){Ax.style.fontSize=14*E+"px";}Ax.setAttribute("rowType",Ad?o:T);var Ak=Ax.childNodes;var AU=null;for(var At=0,AV=0;At<AT;At++,AV++){var Am=Ah[At];var Ai=Am.colIdx;Ak[At].setAttribute("mrow",Ao.rowIdx);if(Ai==this.treeColumnIdx&&AS){var Aq=Ak[At].firstChild;z.call(this,Aq,AS);if(!AS.isLeaf){Aq.parentNode.setAttribute("CLK","T");}continue;}if(Am.type==V||Am.type==d){if(this.isTreeMode){var Aj="";for(var Ar=0;Ar<AS.es.length;Ar++){Aj+=AS.es[Ar].n;}if(Aj.indexOf("&lt;")>=0){Aj=Aj.replace(/&lt;/g,"<");Aj=Aj.replace(/&gt;/g,">");}Ak[At].innerHTML=Aj;if(AS.level==0){Ak[At].style.fontWeight="bold";}else{Ak[At].style.fontWeight="";}if(AS.level>0&&(this.theme==A||this.theme==W)){if(Af&&Af.length>2){Ak[At].style.color="rgba("+Af[0]+","+Af[1]+","+Af[2]+",0.8)";}}else{}}else{AU=AQ[Am.order];var Aj=AU?AU.n:"";if(Aj.indexOf("&lt;")>=0){Aj=Aj.replace(/&lt;/g,"<");Aj=Aj.replace(/&gt;/g,">");}Ak[At].innerHTML=Aj;}continue;}if(Am.order=="LineChart"){if(An[Ai]){var Al=An[Ai];if(AN.isTotal&&!this.isTreeMode){Al.domNode.style.display="none";}else{Al.domNode.style.display="";Al.model=AN.model;Al.refv=AN.refv;Al.kpiOffset=this.kpiOff*Ay;Al.reDrawChart();}}else{if(AN.isTotal&&!this.isTreeMode){continue;}var Ae=document.createElement("div");var Ab={placeholder:Ae,model:AN.model,refv:AN.refv,config:Ag.sparklineProps,widget:Ag,kpiOffset:this.kpiOff*Ay,width:Am.contentWidth,height:P,toolTipMain:Ag.tooltip,mainOffsetTop:this.offsetTop,mainLeftPos:parseInt(this.domNode.style.left,0)||0,mainWidth:this.getWidth(),isTreeMode:this.isTreeMode,theme:this.theme};Ak[At].appendChild(Ae);var Al=new mstrmojo.VisMicroChartLine(Ab);Al.render();Ak[At].removeAttribute("class");An[Ai]=Al;}}else{if(Am.order=="BarChart"){if(An[Ai]){var Al=An[Ai];if(AN.isTotal&&!this.isTreeMode){Al.domNode.style.display="none";}else{Al.model=AN.model;Al.refv=AN.refv;Al.kpiOffset=this.kpiOff*Ay;Al.isTextBold=this.isTreeMode?AS.level==0:false;Al.reDrawChart();}}else{if(AN.isTotal&&!this.isTreeMode){continue;}var Ae=document.createElement("div");var Ab={placeholder:Ae,model:AN.model,refv:AN.refv,widget:Ag,kpiOffset:this.kpiOff*Ay,config:Ag.barProps,width:Am.contentWidth,height:P,toolTipMain:Ag.tooltip,mainOffsetTop:this.offsetTop,mainLeftPos:parseInt(this.domNode.style.left,0)||0,mainWidth:this.getWidth(),isTreeMode:this.isTreeMode,theme:this.theme,isTextBold:this.isTreeMode?AS.level==0:false};Ak[At].appendChild(Ae);var Al=new mstrmojo.VisMicroChartBar(Ab);Al.render();Ak[At].className=this.valueCssClass;An[Ai]=Al;}}else{if(Am.order=="GaugeChart"){if(An[Ai]){var Al=An[Ai];Al.model=AN.model;Al.refv=AN.refv;Al.kpiOffset=this.kpiOff*Ay;Al.labelColorRGB=this.bodyFontColorRGB;Al.reDrawChart();}else{var Ae=document.createElement("div");var Ab={placeholder:Ae,model:AN.model,refv:AN.refv,widget:Ag,config:Ag.bulletProps,width:Am.contentWidth,height:P,toolTipMain:Ag.tooltip,mainOffsetTop:this.offsetTop,mainLeftPos:parseInt(this.domNode.style.left,0)||0,mainWidth:this.getWidth(),labelColorRGB:this.bodyFontColorRGB,showMinLabel:this.showMinLabel,isTreeMode:this.isTreeMode,theme:this.theme};Ak[At].appendChild(Ae);var Al=new mstrmojo.VisMicroChartBullet(Ab);Al.render();Ak[At].removeAttribute("class");An[Ai]=Al;}}else{var AJ=-1;var Aw=-1;if(this.widget.isKPI){Aw=parseInt(Am.order)%this.kpiOff;var AJ=Ao.model.metricIdx+Aw;}else{if(Am.type==t){AJ=parseInt(Am.order);Aw=AJ;}}var AZ="";var AW="";if(!AN.refv[Aw]){continue;}if(AN.refv[Aw].ti===undefined){if(AN.refv[Aw].ts===4){AZ="<img src='"+AN.refv[Aw].v+"'/>";}else{AZ=AN.refv[Aw].v;}}else{try{var AM=this.widget.model;var AL=AM.th[""+AJ];var AK=AN.refv[Aw].ti;if(AN.refv[Aw].ty===4){var Ap;if(AL[AK]&&AL[AK].n){Ap=AL[AK].n;}else{Ap=AN.refv[Aw].v;}if(Ap.indexOf(":")>=0){}else{var As;try{As=mstrApp.getConfiguration().getHostUrlByProject(mstrApp.getCurrentProjectId());}catch(Av){As="";}Ap=As+Ap;}AZ="<img src='"+Ap+"'/>";}else{if(AL[AK]&&AL[AK].n&&AL[AK].cni!==undefined){AZ=AL[AK].n;}else{AZ=AN.refv[Aw].v;}Ak[At].style.fontSize=this.widget.fontSize;}AW=AM.css[AL[AK].cni].n;}catch(Av){if(!AZ){AZ=AN.refv[Aw].v;}}}if(AW){Ak[At].className=Am.valueCssClass+" "+AW;}else{if(this.valueCssClass){Ak[At].className=Am.valueCssClass+" "+this.valueCssClass;}else{Ak[At].className=Am.valueCssClass;}}Ak[At].innerHTML=AZ;}}}if(this.isTreeMode){if(AS.level==0){Ak[At].style.fontWeight="bold";}else{Ak[At].style.fontWeight="";}}}if(this.isTreeMode){var AY=Ag.rows[Ay-1];var AO=AY&&AY.treeNode.level<Ao.treeNode.level;var AR=Ad!=undefined;var Ac=Ay==0;if(AO||(AR&&AS.level>0)){var Aa=Ak.length;for(var Au=0;Au<Aa;Au++){if(this.theme==w||this.theme==W){Ak[Au].style.boxShadow="0px 5px 3px -3px rgba(0,0,0,0.2) inset";}else{if(this.theme==S||this.theme==A){Ak[Au].style.boxShadow="0px 6px 3px -3px rgba(0,0,0,0.5) inset";}}}Ax.style.borderTop="solid 1px rgba(0, 0, 0, 0)";}else{if((AR&&AS.level==0||Ac)&&(this.theme==w||this.theme==S)){Ax.style.borderTop="solid 1px rgba(0, 0, 0, 0)";}else{var Aa=Ak.length;for(var Au=0;Au<Aa;Au++){Ak[Au].style.boxShadow="";}}}}var Az=Ad?Ad:Ao;if(this.isTreeMode){if(AS.selected){this.widget.highlightRowByRowInfo(Az);}else{this.widget.unHighlightRowByRowInfo(Az);}}else{if(this.widget.isAllAttrSelectable){if(Ao.selected[-1]){this.widget.highlightRowByRowInfo(Ao);}else{this.widget.unHighlightRowByRowInfo(Ao);}}else{this.widget.highlightCellsByRowInfo(Ao);}}return Ax;}function k(AL){var AK=AL.rowRef[this.domRefName];if(this.isTreeMode){var AJ=AL.treeNode;var AN=AJ.level;if(AN==0){if(this.theme==w){AK.style.backgroundColor="#f9f9f9";AK.style.color="#191919";AK.style.borderTop="solid 1px rgba(0, 0, 0, 0.3)";}else{if(this.theme==S){AK.style.backgroundColor="#333333";AK.style.color="white";AK.style.borderTop="solid 1px rgba(255, 255, 255, 0.3)";}else{if(this.theme==A){AK.style.backgroundColor="";AK.style.borderTop="solid 1px rgba(255, 255, 255, 0.3)";}else{if(this.theme==W){AK.style.backgroundColor="";AK.style.borderTop="solid 1px rgba(0, 0, 0, 0.3)";}}}}AK.style.font="bold 12pt Helvetica";}else{if(AN==1){if(this.theme==w){AK.style.backgroundColor="#e5e5e5";AK.style.color="#4c4c4c";AK.style.borderTop="solid 1px rgba(0, 0, 0, 0.2)";}else{if(this.theme==S){AK.style.backgroundColor="#232323";AK.style.color="#cccccc";AK.style.borderTop="solid 1px rgba(255, 255, 255, 0.2)";}else{if(this.theme==A){AK.style.backgroundColor="rgba(255, 255, 255, 0.1)";AK.style.borderTop="solid 1px rgba(255, 255, 255, 0.2)";}else{if(this.theme==W){AK.style.backgroundColor="rgba(0, 0, 0, 0.1)";AK.style.borderTop="solid 1px rgba(0, 0, 0, 0.2)";}}}}AK.style.font="12pt Helvetica";}else{if(AN==2){if(this.theme==w){AK.style.backgroundColor="#d1d1d1";AK.style.color="#333333";AK.style.borderTop="solid 1px rgba(0, 0, 0, 0.1)";}else{if(this.theme==S){AK.style.backgroundColor="#0F0F0F";AK.style.color="#cccccc";AK.style.borderTop="solid 1px rgba(255, 255, 255, 0.1)";}else{if(this.theme==A){AK.style.backgroundColor="rgba(255, 255, 255, 0.2)";AK.style.borderTop="solid 1px rgba(255, 255, 255, 0.1)";}else{if(this.theme==W){AK.style.backgroundColor="rgba(0, 0, 0, 0.2)";AK.style.borderTop="solid 1px rgba(0, 0, 0, 0.1)";}}}}AK.style.font="12pt Helvetica";}else{if(AN>2){var AM=AN>9?1:AN/10;if(this.theme==w){AK.style.backgroundColor="#BDBDBD";AK.style.color="#333333";}else{if(this.theme==S){AK.style.backgroundColor="#000000";AK.style.color="#cccccc";}else{if(this.theme==A){AK.style.backgroundColor="rgba(255, 255, 255, "+AM+")";}else{if(this.theme==W){AK.style.backgroundColor="rgba(0, 0, 0, "+AM+")";}}}}AK.style.font="12pt Helvetica";AK.style.borderTop="solid 1px rgba(255, 255, 255, 0.1)";}}}}}else{if(this.theme==w){AK.style.backgroundColor="#f9f9f9";AK.style.font="12pt Helvetica";AK.style.color="#191919";}else{if(this.theme==S){AK.style.backgroundColor="#333333";AK.style.font="12pt Helvetica";AK.style.color="white";}}}}function X(AJ){var AK=this._scroller,AL=this.chartTable,AM=Math.max(this.chartTableOffsetHeight+this.headerTableOffsetHeight-this.getHeight(),0);AK.origin={x:AJ&&AJ.x||0,y:AJ&&AJ.y||0};AK.showScrollbars=this.showScrollbars;AK.vScroll=(AM!==0&&AK.noVScroll!==true)||this.scrollPast;if(AK.vScroll){AK.offset={y:{start:0,end:AM},scrollPast:this.scrollPast};}this.utils.translateCSS(-AK.origin.x,-AK.origin.y,false,AL);}mstrmojo.VisMicroChartTable=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo._NeedSyncScroller],{scriptClass:"mstrmojo.VisMicroChartTable",utils:mstrmojo.VisChartUtils,scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:false,hScroll:false,vScroll:true},scrollPast:false,colInfos:null,rowTemplate:null,theme:-1,isTreeMode:false,showMinLabel:false,bodyFontColorRGB:null,markupString:'<div id="{@id}-microchart-table" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};z-index:{@zIndex};position:absolute;background-color:{@backgroundColor}"><div id="{@id}-header-bar" class="microchart-header-div" style="width:{@width};"><table id="{@id}-header-table" style="width:{@width};table-layout:fixed;"><tr class="microchart-table-row" ><th style="border:none;text-decoration:none;"></th></tr></table></div><div id="{@id}-chart-table-container" class="microchart-canvas-div" style="position:absolute;overflow:hidden;width:{@width};"><table id="{@id}-charts-body" style="width:{@width};table-layout:fixed"><tr class="microchart-table-row"><td style="border:none;background:transparent;text-decoration:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0px;padding-bottom:0px"></td></tr></table></div><div style="position:absolute;z-index:2;"><table id="{@id}-docked-header" style="width:{@width};table-layout:fixed;position:relative;background-color:white;"><tbody></tody></table><div id="{@id}-docked-header-replace-div" style="width:{@width};position:relative;overflow:hidden"><table id="{@id}-docked-header-replace" style="width:{@width};table-layout:fixed;background-color:white;"><tbody></tody></table></div></div></div>',markupSlots:{headerTable:function(){return this.domNode.childNodes[0].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},chartTable:function(){return this.domNode.childNodes[1].firstChild;},dockedHeaderTable:function(){return this.domNode.childNodes[2].firstChild;},dockedHeaderReplaceDiv:function(){return this.domNode.childNodes[2].lastChild;}},postBuildRendering:function x(){R=(this.widget.otherProps.mRowHeight-1)+"px";P=(this.widget.otherProps.mRowHeight-2)+"px";E=this.utils.getScreenZoomFactor();this.scrollerConfig.scrollEl=this.chartTable;this.scrollerConfig.indicatorEl=this.widget.indicatorEl;this.scrollerConfig.showScrollbars=this.showScrollbars;this._super();this.renderMicroChart();this.updateRowOffsetHeight();this.updateHeaderTableOffsetH();this.updateChartTableOffsetH();X.call(this,this.widget.mcStatus&&this.widget.mcStatus.scrollTo);f.call(this);var AK=this.widget;if(this._tn){var AJ=this._tsCallback;this._tsCallback=function(AL){AK.closedIfwAttr=null;AJ.call(this,AL);};mstrmojo.dom.detachEvent(this._tn,mstrmojo.dom.TOUCHSTART,AJ);mstrmojo.dom.attachEvent(this._tn,mstrmojo.dom.TOUCHSTART,this._tsCallback);}},renderMicroChart:function L(){var AL=this.colInfos.length;var AV=this.headerTable;AV.style.font="bold 13pt Helvetica";if(this.theme==w){AV.style.backgroundColor="#B5BDC4";AV.style.color="black";}else{if(this.theme==S){AV.style.backgroundColor="#1C273A";AV.style.color="white";}}if(!this.isAndroidTab){AV.style.height=E*32+"px";AV.style.fontSize=14*E+"px";}var AN=AV.firstChild.firstChild;var AR=this.chartTable.firstChild;var AU=AR.firstChild;var AZ=AN.firstChild;var AO=AU.firstChild;for(var AQ=AV.childNodes.length;AQ<AL;AQ++){AN.appendChild(AZ.cloneNode(true));AU.appendChild(AO.cloneNode(true));}this.rowTemplate=AU;var AS=function(Ae,Ad,Ac){var Aa=0;var Ab=mstrmojo.css.getComputedStyle(Ae);if(Ab.paddingLeft){Aa+=parseFloat(Ab.paddingLeft);}if(Ab.paddingRight){Aa+=parseFloat(Ab.paddingRight);}Ae.style.width=(Ad-Aa)+"px";if(!Ac){Ae.style.height=R;}};var AJ=AN.childNodes;var AP=AU.childNodes;if(this.isTreeMode){D.removeClass(AU,"microchart-table-row");D.removeClass(AN,"microchart-table-row");}for(var AQ=0;AQ<AL;AQ++){var AY=this.colInfos[AQ];AJ[AQ].innerHTML=AY.title?AY.title:"";if(AY.padding.l!=undefined){AP[AQ].style.paddingLeft=AY.padding.l+"px";}if(AY.padding.r!=undefined){AP[AQ].style.paddingRight=AY.padding.r+"px";}AJ[AQ].className=AY.headerCssClass;if(this.treeColumnIdx==AY.colIdx){var AX=document.createElement("div");AP[AQ].appendChild(AX);AX.style.display="";}else{AP[AQ].className=AY.valueCssClass+" "+this.valueCssClass;}if(AY.type==V||AY.type==d){this.bodyFontColorRGB=this.valueCssClass&&Q.rgbStr2rgb(mstrmojo.css.getStyleValue(AP[AQ],"color"));}AS(AJ[AQ],AY.colWidth);AS(AP[AQ],AY.colWidth);AJ[AQ].style.wordBreak="break-word";AJ[AQ].style.whiteSpace="normal";AP[AQ].setAttribute("mcol",AY.colIdx);AJ[AQ].setAttribute("mcol",AY.colIdx);AJ[AQ].setAttribute("mrow",-1);}for(var AQ=0;AQ<AL;AQ++){var AY=this.colInfos[AQ];AY.titleOverflow=this.utils.truncateTextToLineWithWordWrap2(AJ[AQ],this.textCanvas,2);if(AY.type==C){AY.contentWidth=AP[AQ].offsetWidth-AY.padding.l-AY.padding.r;}}var AM=this.widget.otherProps;this.kpiOff=AM.mnMetricsPerKPI;if(!this.widget.isKPI){this.kpiOff=0;}var AW=this.widget;var AT=document.createDocumentFragment();for(var AQ=AW.startCnt;AQ<AW.endCnt;AQ++){var AK=O.call(this,AQ);AT.appendChild(AK);}AR.appendChild(AT);AU.style.display="none";if(AM.mbHideColHeaders){this.headerTable.style.display="none";}this.itemsContainerNode.style.top=this.headerTableOffsetHeight+"px";},reRenderRows:function G(AP,AN,AT,AM,AK){var AO=this.chartTable.firstChild;AO.innerHTML="";var AR=this.widget;var AQ=document.createDocumentFragment();if(AN==undefined){AN=0;AT=0;AM=AR.startCnt;AK=AR.endCnt;}var AS=AR.rows;if(AN<AM){for(var AL=AN;AL<AT;AL++){var AJ=AS[AL].rowRef[this.domRefName];AQ.appendChild(AJ);}for(var AL=AM;AL<AK;AL++){var AJ=O.call(this,AL);AQ.appendChild(AJ);}}else{for(var AL=AM;AL<AK;AL++){var AJ=O.call(this,AL);AQ.appendChild(AJ);}for(var AL=AN;AL<AT;AL++){var AJ=AS[AL].rowRef[this.domRefName];AQ.appendChild(AJ);}}AO.appendChild(AQ);this.updateChartTableOffsetH();X.call(this,AP);},updateHeaderTableOffsetH:function I(){if(this.widget.otherProps.mbHideColHeaders){this.headerTableOffsetHeight=0;}else{this.headerTableOffsetHeight=this.headerTable.offsetHeight;}},updateRowOffsetHeight:function J(){this.rowOffsetHeight=this.chartTable.firstChild.lastChild.offsetHeight;},updateChartTableOffsetH:function AC(){this.chartTableOffsetHeight=this.chartTable.firstChild.offsetHeight;},onScrollDone:function q(AJ){if(this._super){this._super(AJ);}this.widget.onScrollDone(AJ);},onScrollMoved:function AI(AJ){if(this._super){this._super(AJ);}this.widget.onScrollMoved(AJ);},initScroller:function j(AJ){if(!AJ.offset&&this.scrollPast){AJ.offset={scrollPast:this.scrollPast};}AJ.vScroll=true;if(this._super){this._super(AJ);}var AK=this;},initDHs:function N(){var AJ=this.dockedHeaderTable;AJ.parentNode.style.top=this.headerTableOffsetHeight+"px";},addRowsToDH:function B(AK,AN){var AJ=this.widget;var AO=null;if(AN){AO=AJ.dockedHeaderReplaceRows;}else{AO=AJ.dockedHeaderRows;}var AL=document.createDocumentFragment();for(var AM=AO.length-AK;AM<AO.length;AM++){var AP=O.call(this,AO[AM].rowIdx,AO[AM]);AO[AM].rowRef[this.domRefName]=AP;AL.appendChild(AP);}if(AN){this.dockedHeaderReplaceDiv.firstChild.firstChild.appendChild(AL);}else{this.dockedHeaderTable.firstChild.appendChild(AL);}},removeRowsFromDH:function H(AL,AK){var AM=this.dockedHeaderTable,AJ=AM.firstChild;var AP=this.dockedHeaderReplaceDiv.firstChild.firstChild;if(AL>AJ.childNodes.length){AL=AJ.childNodes.length;}if(AL>1){AM.removeChild(AJ);for(var AO=0;AO<AL;AO++){AJ.removeChild(AJ.lastChild);}AM.appendChild(AJ);}else{if(AL==1){var AN=AJ.lastChild;AJ.removeChild(AN);if(AK){AP.appendChild(AN);}}}},moveRowFromDHRplcTableToDH:function s(){var AL=this.dockedHeaderTable,AK=AL.firstChild;var AM=this.dockedHeaderReplaceDiv.firstChild.firstChild;var AJ=AM.firstChild;if(AJ){g(AM);AK.appendChild(AJ);}},removeChildrenForDHReplaceTable:function l(){var AJ=this.dockedHeaderReplaceDiv.firstChild.firstChild;g(AJ);},showDockedHeader:function Y(){this.dockedHeaderTable.parentNode.style.display="block";},hideDockedHeader:function AF(){this.dockedHeaderTable.parentNode.style.display="none";},setTreeArrow:function b(AN,AJ){var AM=AN.rowRef[this.domRefName];var AL=AM.childNodes;var AK=AL[this.treeColumnIdx].firstChild;z.call(this,AK,AN.treeNode,AJ);},scrollTo:function(AJ){var AK=this.chartTable;this.utils.translateCSS(-AJ.x,-AJ.y,false,AK);},shouldTouchBubble:function h(AM){var AJ=this._scroller,AK=AM.isVertical;var AL=!!AJ.offset&&AJ.offset.y.end!==0;return AK?!AL:this._super(AM);},multiTap:true,touchTap:function(AJ){this.widget.touchTap(AJ);},touchSelectBegin:function U(AJ){this.bubbleTouchEvent(AJ);},touchSelectEnd:function Z(AJ){this.bubbleTouchEvent(AJ);},touchSelectMove:function K(AJ){this.bubbleTouchEvent(AJ);},multiTouch:true,touchMultiBegin:function(AJ){this.bubbleTouchEvent(AJ);},touchMultiMove:function(AJ){this.bubbleTouchEvent(AJ);},touchMultiEnd:function(AJ){this.bubbleTouchEvent(AJ);},destroy:function AA(){delete this.widget;delete this.parent;delete this.rowTemplate;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidRptMap","mstrmojo.maps.androidmap.AndroidRptMap","mstrmojo.Obj");mstrmojo.maps.AndroidRptMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.AndroidRptMap"});if((typeof (mstrMobileApp)!="undefined")&&(typeof (mstrMobileApp.useNativeMap)!="undefined")&&mstrMobileApp.useNativeMap()){mstrmojo.maps.AndroidRptMap=mstrmojo.maps.androidmap.AndroidRptMap;}else{mstrmojo.maps.AndroidRptMap=mstrmojo.maps.jsmap.AndroidRptMap;}})();(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidDocMap","mstrmojo.maps.androidmap.AndroidDocMap");mstrmojo.maps.AndroidDocMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.AndroidDocMap"});if((typeof (mstrMobileApp)!="undefined")&&(typeof (mstrMobileApp.useNativeMap)!="undefined")&&mstrMobileApp.useNativeMap()){mstrmojo.maps.AndroidDocMap=mstrmojo.maps.androidmap.AndroidDocMap;}else{mstrmojo.maps.AndroidDocMap=mstrmojo.maps.jsmap.AndroidDocMap;}}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.Label","mstrmojo.hash","mstrmojo.array");var O=mstrmojo.hash,L=mstrmojo.array,C=mstrmojo.emptyFn;var B=0,R=1,Q=2,W=3,I=4,S=5,F=6,M=7,Y=8,U=9;var E=2;var V=1,X=3;var K="u;";var P={};P[M]="MetricSlider";P[Y]="MetricQualification";P[U]="SearchBoxSelector";function A(b,a,k,l,o,Z){switch(a){case B:b.idx=O.any(o,true);var f=(typeof (b.idx)==="undefined"||b.idx<0);if(f){if(L.find(Z,"v","-1")<0){Z=[{v:"-1",n:""}].concat(Z);}b.idx="0";}b.unset=!!f;b.options=Z;break;case Y:case M:if(b.updateData){b.updateData({low:k.min,high:k.max,cnt:k.cnt,nov:k.nov},{cs:k.cs,f:k.f,ft:k.ft,qua:k.qt});}b.items=Z;b.selectedIndices=o;break;case U:if(Z&&!l.sos){b.candidates={isComplete:true,items:l.srcid?Z:[]};}if(l.srcid){var g=[],h=k.ces;if(h&&h.constructor===Array){if(l.dfm==V){for(var j=0;j<h.length;j++){if(h[j]["t"]!=X){g.push(h[j]);}}}else{g=h.concat();}}if(!l.sos){var d=mstrmojo.array,p=[];d.forEach(g,function(q){if(d.find(b.candidates.items,"v",q.v)>-1){p.push(q);}});g=p;}b.items=g;}break;default:b.items=Z;b.selectedIndices=o;break;}}mstrmojo.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocSelectorViewFactory",newPulldown:C,attachTargetListeners:C,getSelectorClass:function J(b,a){var Z=P[b];if(Z.constructor===Array){Z=Z[(a)?0:1];}return Z;},isSelectorSupported:function T(){return true;},newSelector:function H(t){var d=t.children,b=d&&d[0],o=t.style,k=t.selIdx,f=t.node,q=f.defn,l=f.data,Z=l.elms,a;if(!this.isSelectorSupported(t)){return null;}if(!b){if(!b){var h=t._cekEvtListener,w=t.id,s;if(h){q.detachEventListener(h);delete t._cekEvtListener;}if(o===B){b=this.newPulldown(t);s=function(x){a=this.options;if(L.find(a,"v",x.value)<0){if(L.find(a,"v","-1")<0){a.unshift({v:"-1",n:""});}b.idx="0";b.options=a;b.unset=true;t._inSyncPhase=true;b.refresh();t._inSyncPhase=false;}else{b.set("value",x.value);}};w=b.id;}else{var p=this.getSelectorCtrlConfig(t,o,q,Z),j=p.scriptClass;if(!j){b=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{delete p.scriptClass;var g=O.walk(j,mstrmojo);b=new g(p);if(o===M){t.attachEventListener("includeChange",b.id,function(x){this.set("include",x.value);this.selectRange();});}if(o===M||o===Y){t.attachEventListener("quaChange",b.id,function(x){this.set("qua",x.value);});s=function(x){if(t.id!==x.value.id){t._inSyncPhase=true;b.updateExpr(x.value);if(t.style===M){t.set("include",x.value.include);}t._inSyncPhase=false;}};}else{s=function(x){var z=[];a=this.node.data.elms;L.forEach(x.value,function(AB){var AA=L.find(a,"v",AB);if(AA>-1){z.push(AA);}});this._inSyncPhase=true;b.select(z);this._inSyncPhase=false;};}}}if(s){t._cekEvtListener=q.attachEventListener("cekChange",w,s);}}t.addChildren(b);}A(b,t.style,l,q,k,Z);return b;},getSelectorCtrlConfig:function N(j,d,g,Z){var k=g.horiz,h=j.getFormats(),l=h&&h.height,a=O.copyProps,b=j.node.data,f={scriptClass:this.getSelectorClass(d,k),multiSelect:g.multi,isHoriz:k,include:g.include,itemWidthMode:g.iwm,allIdx:L.find(Z,"v",K),noneIdx:g.include?-1:L.find(Z,"v",K),renderAllItems:!l,onchange:function(){if(!j._inSyncPhase){j.selectorControlChange(this);}},makeSelection:function(o){if(!j._inSyncPhase){j.showInfoWin(o&&o.selItem);}}};if(f.noneIdx!==-1){f.allIdx=-1;}if(d===R||d===M){j.extCls="extSlider";if(g.cek){g.include=g.cek.include;b.cs=g.cek.cs;b.f=g.cek.f;b.ft=g.cek.ft;j.qua=g.cek.qua;}}if(d===R){a(["height","width"],h,f);}else{if(d===Y||d===M){if(d===M){f.isHoriz=true;f.include=g.include;}a(["height","width","font"],h,f);a(["cs","ft"],g,f);f.fmts=g.f;f.qua=j.qua;f.numFmts=g.numFmts;}else{if(d===U){f={scriptClass:f.scriptClass,cssText:h.height?"height: "+h.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(g.ttl||""),items:g.srcid?(b.ces?b.ces.concat():[]):[],REQUEST_THRESHOLD:55,suggestCount:50,srcid:g.srcid||"",dsrc:g.dsrc||"",onitemsChange:function(){if(!j._inSyncPhase){j.showInfoWin();j.selectorControlChange(this);}}};if(Z&&!g.sos){f.candidates={isComplete:true,items:g.srcid?Z:[]};}else{f.useKeyDelay=true;f.noCache=true;}if(!g.multi){f.maxObjectCount=1;}}}}return f;},updateControlStyles:function D(a){if(a.isInFilterPanel()&&!a.isHorizFP()){var Z=a.style;if(Z===R||Z===Y||M){a.children[0].width=a.parent.parent.contentWidth;}}}});var G=mstrmojo.DocSelectorViewFactory;G.STYLES={PULLDOWN:B,SCROLLER:R,LIST:Q,RADIO:W,CHECKBOX:I,BUTTON:S,LINK:F,METRIC_SLIDER:M,METRIC_QUAL:Y,SEARCH_BOX:U};G.ELEM_ALL=K;G.UC_ON_DS=E;}());(function(){mstrmojo.requiresCls("mstrmojo.AndroidXtab");mstrmojo.AndroidXtabStandalone=mstrmojo.declare(mstrmojo.AndroidXtab,null,{scriptClass:"mstrmojo.AndroidXtabStandalone"});}());(function(){mstrmojo.requiresCls("mstrmojo.AndroidXtab","mstrmojo._IsInteractiveGrid","mstrmojo._Formattable","mstrmojo._IsDocXtab");mstrmojo.DocInteractiveGridXtab=mstrmojo.declare(mstrmojo.AndroidXtab,[mstrmojo._IsInteractiveGrid,mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocInteractiveGridXtab",formatHandlers:{domNode:["RW","T","font"],msgNode:["D"],viewport:["D","B","fx"]}});}());(function(){mstrmojo.requiresCls("mstrmojo.AndroidXtab","mstrmojo._IsInteractiveGrid");mstrmojo.AndroidInteractiveGridXtab=mstrmojo.declare(mstrmojo.AndroidXtab,[mstrmojo._IsInteractiveGrid],{scriptClass:"mstrmojo.AndroidInteractiveGridXtab"});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.DocumentController");mstrmojo.android.medium.controllers.DocumentController=mstrmojo.declare(mstrmojo.android.controllers.DocumentController,null,{scriptClass:"mstrmojo.android.medium.controllers.DocumentController",exitFullScreen:function A(B,C){this._super(B,C);this.rootCtrl.propogateMenuVisibleChange(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ResultSetController","mstrmojo.android.controllers._IsReportController");function K(N){return{success:function(O){N.setData(O);}};}function E(N,P){P.push(K(this));var O=this.model;O[N].apply(O,P);}mstrmojo.android.controllers.XtabController=mstrmojo.declare(mstrmojo.android.controllers.ResultSetController,[mstrmojo.android.controllers._IsReportController],{scriptClass:"mstrmojo.android.controllers.XtabController",initModel:function D(){return mstrApp.modelFactory.newModel("Xtab",{controller:this});},createView:function C(O,R){var N=this.model.data.visName;if(N){var P=mstrmojo.AndroidVisList.getVis(N);if(P){R.viz=P;}}var Q=this.view=this.newView("Xtab",R);Q.setModel(this.model);return Q;},afterReprompt:function L(N){this.view.set("gridData",N);this._super(N);},setData:function M(N){var P=this.view;P.unrender();P.set("gridData",N);var O=mstrApp.getContentDimensions();P.width=O.w+"px";P.height=O.h+"px";P.render();},hasPageBy:function H(){var P=this.model.data;if(this.view&&this.view.isTimeSeries){var O=P&&P.phs;return !!(O&&O.show);}else{var N=P&&P.ghs;return !!(N&&N.phs);}},checkCache:function I(O,Q,R,P,N){this._super(O||{ifc:true,ci:this.model.data.ci},Q,R,P,N);},onDrill:function J(N,P){var O=this,Q=this._super;this.checkCache(this.model.data,{did:this.did,t:this.t,st:this.ctrlType},function(){Q.call(O,P);},false,{silent:false,showWait:true});},onSort:function A(N){E.call(this,"sort",[N]);},onPivot:function G(N){E.call(this,"pivot",[N]);},onPageBy:function F(N){this.model.pageBy(N,mstrmojo.func.wrapMethods(K(this),{failure:function(O){mstrApp.onerror(O);}}));},onDownloadGridData:function B(N,O){this.model.downloadGridData(O);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ResultSetController","mstrmojo.android.controllers._IsReportController","mstrmojo.android.EnumMenuOptions");var B=mstrmojo.android.EnumMenuOptions,A=B.SHARE,L=B.ANNOTATION;mstrmojo.android.controllers.GraphController=mstrmojo.declare(mstrmojo.android.controllers.ResultSetController,[mstrmojo.android.controllers._IsReportController],{scriptClass:"mstrmojo.android.controllers.GraphController",initModel:function E(){return mstrApp.modelFactory.newModel("Graph",{controller:this});},createView:function D(N,P){var O=this.view=this.newView("Graph",P);O.setModel(this.model);return O;},hasPageBy:function J(){var N=this.model&&this.model.data;return !!(N&&N.gd&&N.gd.pb);},reprompt:function F(){this.repromptOrientation=mstrMobileApp.getOrientation();this._super();},afterReprompt:function M(N){this.view.setGraphData(N);this._super(N);},onPageBy:function G(N){var O=this.view;this.model.pageBy(N,{success:function(){O.refresh();},failure:function(P){mstrApp.onerror(P);}});},setData:function K(N){this.model.setData(N);this.view.refresh();},beforeViewVisible:function I(N){if(this.repromptFlag&&(this.repromptOrientation!==mstrMobileApp.getOrientation())&&N){delete this.repromptFlag;delete this.repromptOrientation;this.refresh();}},beforeViewHidden:function H(N){mstrmojo.GraphBase.hideTooltips();},handleMenuItem:function C(O,N){if(O!==A&&O!==L){this.view.syncTooltips(0,0);}this._super(O,N);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.android.controllers.RootController","mstrmojo.android.controllers.FolderController","mstrmojo.android.controllers.ProjectsController","mstrmojo.android.controllers.SubscriptionsController","mstrmojo.android.controllers.XtabController","mstrmojo.android.controllers.DocumentController","mstrmojo.android.controllers.GraphController","mstrmojo.android.controllers.PromptsController","mstrmojo.android.controllers.PropertiesController","mstrmojo.android.controllers.SettingsController","mstrmojo.android.controllers.TransactionNotificationController");mstrmojo.android.factories.ControllerFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.android.factories.ControllerFactory",newRootController:function C(M){return new mstrmojo.android.controllers.RootController(M);},newFolderController:function F(M){return new mstrmojo.android.controllers.FolderController(M);},newProjectsController:function K(M){return new mstrmojo.android.controllers.ProjectsController(M);},newSubscriptionsController:function E(M){return new mstrmojo.android.controllers.SubscriptionsController(M);},newXtabController:function A(M){return new mstrmojo.android.controllers.XtabController(M);},newDocumentController:function J(M){return new mstrmojo.android.controllers.DocumentController(M);},newGraphController:function D(M){return new mstrmojo.android.controllers.GraphController(M);},newPromptsController:function G(M){return new mstrmojo.android.controllers.PromptsController(M);},newPropertiesController:function I(M){return new mstrmojo.android.controllers.PropertiesController(M);},newSettingsController:function H(M){return new mstrmojo.android.controllers.SettingsController(M);},newTransactionsController:function L(M){return new mstrmojo.android.controllers.TransactionNotificationController(M);},newController:function B(M,O){var N=this["new"+M+"Controller"](O);N.type=M;return N;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.DocSelectorViewFactory","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper");var L=mstrmojo.array,P=mstrmojo.hash,V=mstrmojo.dom,Y=mstrmojo.DocSelectorViewFactory.STYLES,S=mstrmojo.DocSelectorViewFactory.ELEM_ALL,M=mstrmojo.elementHelper;var F=mstrmojo.DocSelectorViewFactory.UC_ON_DS;function H(){return{type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,disablePU:(parseInt(this.defn.subTp,10)===F)};}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" class="mstrmojo-DocSelector {@extCls}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100; position:absolute; top:0px; left:0px; width:100%; height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onincludeChange:function(){mstrmojo.css.toggleClass(this.domNode,"strikeout",!this.include);},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwaitChange:function(){this.wIconNode.style.display=((this.wait)?"block":"none");}},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",bGetElems:false,init:function U(b){this._super(b);var a=this.node.defn.style;this.spm=(a===Y.METRIC_QUAL||a===Y.METRIC_SLIDER);},initControlInfo:function I(){var f=this.node,g=f.data,k=f.defn,a=g.elms,h=g.ces,b=k.style;var l=["include","ckey","ck","tks","style","multi","showall"];if(!this.bGetElems&&parseInt(k.subTp,10)===F&&b!==Y.SEARCH_BOX){this._fetchAllElems();a=g.elms;}if(b===Y.METRIC_QUAL||b===Y.METRIC_SLIDER){l=l.concat(["srcid","srct"]);this.qua=g.qt;this.dt=g.dt;}this.type=k.ct;var o=k.fmts;if(o){var p=o.width;if(!p||parseInt(p,10)<=0){o.width="95px";}}P.copyProps(l,k,this);var d=this.selIdx={},j=k.multi;if(this.include&&j&&L.find(h,"v",S)>-1){h=a;}if(h){L.forEach(a,function(s,q){if(L.find(h,"v",s.v)>=0){d[q]=true;}});}},resetFormatHandlers:function A(){this.formatHandlers={contentNode:["RW"]};},selectorControlChange:function O(b){var AD=H.call(this),AE="\u001E",d=[],AB=this.style,x=this.defn.sec,z;switch(AB){case Y.PULLDOWN:var t=b.value,s=null;if(b.selectNode){var AC=b.selectNode;s=AC.options[AC.selectedIndex].text;}AD.eid=t;if(parseInt(AD.type,10)===1&&s!==null){AD.eid=AD.eid+";"+s;}this.defn.set("cek",t);this.currSelValue=t;if(x){this.parent.set("count",M.buildElemsCountStr([t],this.node.data.elms));}break;case Y.SEARCH_BOX:L.forEach(b.items,function(AG){d.push(AG.v+";"+AG.n);});if(!d.length&&this.showall){d.push("u;");}AD.eid=d.join(AE);if(x){this.parent.set("count",M.buildElemsCountStr(d,this.node.data.elms));}break;case Y.METRIC_QUAL:case Y.METRIC_SLIDER:if(this.srcid===undefined){return ;}var f=[];L.forEach(b.cs,function(AG){f.push(AG.v);if(AD.dtp===undefined){AD.dtp=AG.dtp;}});if(f.length){AD.cs=f.join(AE);}var a=mstrmojo.MCSUtil.getFuncInfo(b.opId,b.qua);AD.f=b.f=a.f;AD.ft=b.ft=a.ft;AD.include=b.include=this.include;AD.ckey=this.ckey;AD.srcid=this.srcid;AD.srct=this.srct;AD.unset=b.unSet;AD.onlyInclude=b.onlyInclude;AD.changeQual=b.changeQual;AD.qt=b.qua;this.node.defn.set("cek",{id:this.id,f:b.f,ft:b.ft,cs:b.cs,qua:b.qua,include:b.include});break;default:var w=this.node,p=w.data.elms,g=b.selectedIndices,o=b.allIdx,k=!!g[o],j=[],l=this.include;if(k){d=[p[o].v];j=[p[o].v];}else{if(g[o]){g[o]=false;}var AA=P.keyarray(g,true).sort(L.numSorter),q={};for(z in AA){q[AA[z]]=g[AA[z]];}g=q;P.forEach(g,function(AH,AG){if(AH){d.push(p[AG].v);j.push(p[AG].v+";"+p[AG].n);}});}AD.eid=((parseInt(AD.type,10)===1)?j:d).join(AE);var h=mstrmojo.dom.position(b.domNode,true);if(h){AD.left=h.x;AD.top=h.y;}if(k&&this.multi&&l){L.forEach(p,function(AH){var AG=AH.v;if(d[0]!==AG){d.push(AG);}});}w.defn.set("cek",d);if(x&&AB!==Y.SCROLLER){this.parent.set("count",M.buildElemsCountStr(d,p));}break;}var AF=this;window.setTimeout(function(){AF.slice(AD);},0);},showInfoWin:function Q(g){var b=this.model,d=b.getTargetInfoWin(this.tks);if(d&&d.length){var l=this.defn.horiz,a=g||this.contentNode,h=V.position(a),k=V.position(this.contentNode),j=(l||this.defn.style==Y.SCROLLER)?null:{x:k.x,y:h.y,w:k.w,h:h.h};for(var f=0;f<d.length;f++){b.showInfoWin(d[f],a,l?"v":"h",false,P.copy(j));}}},preBuildRendering:function G(){var f=true,g=this.node.defn.style,d=P.clone(this.formatHandlers),b=d.contentNode;if(b){if((g===Y.RADIO||g===Y.CHECKBOX)&&d.filterNode){b.push("fx");b.push("background-color");delete d.filterNode;}if(g===Y.LIST){delete b.height;}if(g===Y.SEARCH_BOX){var h=d.domNode;L.removeItem(h,"color");var a=L.indexOf(h,"F");if(a>-1){L.removeIndices(h,a,1);h.push("font");}}}this.formatHandlers=d;f=this._super();this.builder.selectorFactory.updateControlStyles(this);return f;},postBuildRendering:function X(){var d=this.node.defn.style,h=this.filterNode.style,a=this.contentNode,b=this.node.defn;this._super();if(this.formatHandlers.filterNode){var g=this.getFormats();if(!g.width){h.width=a.clientWidth+"px";}if(!g.height){h.height=a.clientHeight+"px";if(d===Y.METRIC_QUAL||d===Y.METRIC_SLIDER){this.updateHeight();}}else{if(d===Y.METRIC_QUAL){a.style.height=g.height;}}}else{h.display="none";}if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(b.ds,10)===0);}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");this.builder.selectorFactory.attachTargetListeners(this);if(V.isAndroid&&d===Y.SCROLLER){a.style.overflow="visible";}return true;},_fetchAllElems:function J(){var a=this.node.defn,f=this.node.data;var g={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:a.srcid||"",dataSourcesXML:a.dsrc||"",browseFlags:1};var d=this,b={success:function(h){d.bGetElems=true;d.set("wait",false);if(h&&h.es){f.elms=(a.srcid)?M.buildElemsTerseID(h.es,a.srcid,true):h.es;var j=d.parent,k=j&&j.parent;if(f.ces&&f.elms&&f.elms.length>0&&j){j.set("count",M.buildElemsCountStr(f.ces,f.elms));}if(d.hasRendered){d.refresh();if(d.isInFilterPanel()){if(j&&j.defn.ttl){j.updateContentHeight();}if(k&&k.refreshFP){k.refreshFP();}}}}},failure:function(h){mstrmojo.alert(h.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.set("wait",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,b,g,false,null,true);},updateHeight:function B(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var a=this.parent;if(a&&(a.defn.ttl!==undefined)&&a.updateContentHeight){a.updateContentHeight();}},onCGBMapChange:function D(b){var a=b.cgbMap;if(!a){return ;}var d=this.tks;P.forEach(this.defn.cgb,function(g){var f=a[g];if(f&&d.indexOf(f)<0){d+="\u001E"+f;}});this.tks=d;},update:function K(g){this.node=g;var k=this.node.defn,b=k.style,a=this.node.data.elms,l=this.parent,f=(b===Y.SCROLLER);if(f&&k.multi){var d=L.find(a,"v",S);if(d>-1){L.removeIndices(a,d,1);}}if(k.sec&&!f&&!k.sos){var h=g.data.ces;if(l&&l.count){if(h&&a&&a.length){l.set("count",M.buildElemsCountStr(h,a));}}}this.initControlInfo();var j=this.content=this.builder.selectorFactory.newSelector(this);if(!j){this.set("visible",false);}},onincludeChange:function E(a){this.node.defn.include=this.include=a.value;if(this.style!==Y.METRIC_SLIDER){this.include=a.value;var b=H.call(this);b.ckey=this.ckey;this.slice(b);}},slice:function R(d){var a=this.model;if(this.isInFilterPanel()){var b=this.getFilterPanel();if(b&&!b.defn.cas){b.bufferSlice(d);return ;}}a.slice(d);},onquaChange:function T(a){this.node.data.qt=a.value;},isInFilterPanel:function N(){var a=this.parent;return(a&&a.isInFilterPanel&&a.isInFilterPanel())||false;},isHorizFP:function Z(){var a=this.parent;return(a&&a.isHorizFP&&a.isHorizFP())||false;},getFilterPanel:function W(){var a=this.parent;return(a&&a.getFilterPanel&&a.getFilterPanel())||null;}});if(!mstrmojo.dom.isIE){var C=mstrmojo.DocSelector.prototype.formatHandlers;C.contentNode=C.filterNode;delete C.filterNode;}}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelectorViewFactory","mstrmojo.android.DropDownList","mstrmojo.android.selectors.CheckList","mstrmojo.android.selectors.ListBox","mstrmojo.android.selectors.LinkBar","mstrmojo.android.selectors.ButtonBar","mstrmojo.android.selectors.Slider","mstrmojo.array");var F=mstrmojo.DocSelectorViewFactory.STYLES;var B={};B[F.RADIO]="CheckList";B[F.CHECKBOX]="CheckList";B[F.LIST]="ListBox";B[F.LINK]="LinkBar";B[F.BUTTON]="ButtonBar";B[F.SCROLLER]="Slider";B["9"]="LinkBar";mstrmojo.android.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.DocSelectorViewFactory,null,{scriptClass:"mstrmojo.android.DocSelectorViewFactory",isSelectorSupported:function A(K){var J=K.node.defn;if(J.ct==="3"){var I=K.tks;if(I&&K.defn.dk){K.model.getLayoutUnitDefn(I,J._lkz).dk=true;return false;}}return true;},newPulldown:function H(I){return new mstrmojo.android.DropDownList({name:I.node.defn.n,postvalueChange:function(){if(!I._inSyncPhase){I.showInfoWin();I.selectorControlChange(this);}}});},updateControlStyles:function G(N){var J=N.getFormats(),L=N.style,M=N.children&&N.children[0];if(!M){return ;}if(J){var I=J.height,K=J.width;if(I!==undefined){M.height=I;}if(K!==undefined){M.width=K;}if(L===F.LINK){var O=N.defn.ssc;if(O){M.selColor=O;}}}this._super(N);},attachTargetListeners:function E(J){this._super(J);if(J.defn.ct==="3"&&this.isSelectorSupported(J)){if(!J._panelEvtListener){var I=J.model.getUnitInstance(J.tks,1);if(I){J._panelEvtListener=I.attachEventListener("panelSelected",J.id,function(K){this._inSyncPhase=true;this.content.singleSelectByField(K.key,"v");this._inSyncPhase=false;});}}}},getSelectorClass:function C(K,J){var I=B[K];return(I&&"android.selectors."+I)||this._super(K,J);},getSelectorCtrlConfig:function D(L,J,I,K){if(J===9){if(K&&K.length===0){K.push({n:"(All)",t:14,v:"u;"});}L.style=J=F.LINK;}return this._super(L,J,I,K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.VisMicroChartTable","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.VisTextTooltip","mstrmojo.hash","mstrmojo.color","mstrmojo.css");var $CLR=mstrmojo.color,$CSS=mstrmojo.css,$HASH=mstrmojo.hash,$forEachHash=$HASH.forEach,$M=Math,$D=mstrmojo.dom;var zf=1;var PAGE_COUNT=5;var TRIANGLE_WIDTH=30;var COMPACT=0;var NORMAL=1;var LARGE=2;var DEFAULT_TH_CSS="border:none;word-break:break-word;white-space:normal;";var DEFAULT_TD_CSS="border:none;background:transparent;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0px;padding-bottom:0px;";var TD_SELECTED_CSS="border:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0px;padding-bottom:0px;";var TH_SELECTED_CSS="border:none;word-break:break-word;white-sapce:normal;";var NO_REPLACE=2;var IN_REPLACE=3;var TOP_Z_INDEX=200;var DOCKED_HEADER=0,OTHER_ROW=1;var ROW_AXIS=1,COL_AXIS=2;var DRILLING_ACTION=1,SELECTOR_ACTION=2,HYPERLINK_ACTION=4;var linkCount=0;var attrCount=0;var order=[];var ID_NAME={};var METRIC_INDEX={};var METRICS=[];var models=[];var LEFT_CHART_ROW="leftRow";var RIGHT_CHART_ROW="rightRow";var GFL=1;var CGL=0;var textAlign={left:"microchart-table-text-L",center:"microchart-table-text-M",right:"microchart-table-text-R"};function getParentBkgColor(){var parentNode=this.domNode.parentNode;while(parentNode){var compStyle=mstrmojo.css.getComputedStyle(parentNode);var bkgColor=compStyle.backgroundColor;if(bkgColor){if(bkgColor.indexOf("rgba")>=0){var rgba=this.utils.rgbaStr2rgba(bkgColor);if(rgba&&rgba[4]){return rgba;}}else{if(bkgColor.indexOf("rgb")>=0){var rgb=$CLR.rgbStr2rgb(bkgColor);return rgb;}}}parentNode=parentNode.parentNode;}bkgColor=this.model["background-color"];if(bkgColor){return $CLR.hex2rgb(bkgColor);}return[255,255,255];}var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;function getUITheme(){var ct=this.model.vp.ct;if(!ct||ct==""){ct="0";}this.theme=parseInt(ct);if(this.theme==0){var rgb=getParentBkgColor.call(this);var opacity=this.otherProps.mfBkgOpacity;rgb=this.utils.getRGBWithOpacity(rgb,opacity);this.backgroundColor=this.utils.rgb2rgbStr(rgb);var brightness=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1000;if(brightness>150){this.theme=CUSTOM_LIGHT_THEME;}else{this.theme=CUSTOM_DARK_THEME;}}else{if(this.theme==1){this.backgroundColor="#333333";}else{if(this.theme==2){this.backgroundColor="#f9f9f9";}}}this.domNode.style.backgroundColor=this.backgroundColor;}function setDimensionWithDPI(){zf=this.utils.getScreenZoomFactor();var otherProps=this.otherProps;otherProps.mRowHeight=Math.round(zf*otherProps.mRowHeight);TRIANGLE_WIDTH=Math.round(zf*36);this.dropShadowWidth=Math.round(zf*7);paddingForSS=[Math.round(5*zf),Math.round(8*zf),Math.round(10*zf)];colWidthForChart=[Math.round(100*zf),Math.round(150*zf),Math.round(200*zf)];maxColWidthForAttr=[Math.round(120*zf),Math.round(150*zf),Math.round(180*zf)];maxColWidthForMetric=[Math.round(100*zf),Math.round(150*zf),Math.round(200*zf)];adjustWidthForColumnValue=[Math.round(20*zf),Math.round(40*zf),Math.round(80*zf)];}function isScrollableElementTouched(touch){if(this.enableSmoothScroll){var touchPointOnWidget=this.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,this);var x=touchPointOnWidget.touchX,y=touchPointOnWidget.touchY;if(x<this.leftWidth){return false;}return true;}else{return true;}}function setNodeCssText(node,cssText){var height=node.style.height;var width=node.style.width;var textDecoration=node.style.textDecoration;var display=node.style.display;var fontSize=node.style.fontSize;var fontWeight=node.style.fontWeight;var paddingLeft=node.style.paddingLeft;var paddingRight=node.style.paddingRight;var boxShadow=node.style.boxShadow;node.style.cssText=cssText;node.style.height=height;node.style.width=width;node.style.textDecoration=textDecoration;if(display){node.style.display=display;}if(fontSize){node.style.fontSize=fontSize;}if(fontWeight){node.style.fontWeight=fontWeight;}if(paddingLeft){node.style.paddingLeft=paddingLeft;}if(paddingRight){node.style.paddingRight=paddingRight;}if(boxShadow){node.style.boxShadow=boxShadow;}}function init(w){METRICS=[];METRIC_INDEX={};ID_NAME={};order=[];models=[];GFL=1;CGL=0;linkCount=0;attrCount=0;}function initProp(){var sparklineProps=this.sparklineProps={};sparklineProps.mbShow=true;sparklineProps.mbAllPoints=false;sparklineProps.mbEndPoints=true;sparklineProps.mbRefLine=true;sparklineProps.mbRefArea=true;sparklineProps.mbAssMetric=true;sparklineProps.mbShowTooltip=true;sparklineProps.mwSeriesLineCol="#333333";sparklineProps.mwRefLineCol="#0066FF";sparklineProps.mwRefAreaCol="#DEDEDE";sparklineProps.mstrHeader="[Sparkline]";sparklineProps.mstrAssMetric="";var barProps=this.barProps={};barProps.mbShow=false;barProps.mbShowLegend=true;barProps.mbRefLine=true;barProps.mbShowTooltip=true;barProps.mwPosCol="#66CC00";barProps.mwNegCol="#FF0000";barProps.mwRefLineCol="#0066FF";barProps.mstrHeader="[Bar]";var bulletProps=this.bulletProps={};bulletProps.mbShow=true;bulletProps.mbRefLine=true;bulletProps.mbRefBands=true;bulletProps.mbShowLegend=true;bulletProps.mbAssMetric=true;bulletProps.mbInvertAxis=false;bulletProps.mbShowTooltip=true;bulletProps.mfMinValue=0;bulletProps.mwPosCol="#000066";bulletProps.mwNegCol="#FF0000";bulletProps.mwRefLineCol="#0066FF";bulletProps.mwBand1="#999999";bulletProps.mwBand2="#BBBBBB";bulletProps.mwBand3="#DEDEDE";bulletProps.mstrHeader="[Bullet]";bulletProps.mstrAssMetric="";bulletProps.mstrBand1="Low";bulletProps.mstrBand2="Medium";bulletProps.mstrBand3="High";var otherProps=this.otherProps={};otherProps.mfBkgOpacity=1;otherProps.mnMetricsPerKPI=1;otherProps.mbHideColHeaders=false;otherProps.mbHideTextColumns=false;otherProps.mbLockLayout=false;otherProps.mbShowForHiddenGraphs=true;otherProps.mbInheritFromGridGraph=false;otherProps.mbInSingleColumnMode=false;otherProps.mpColumnIDs=[];otherProps.mpColumnIDsInTreeMode=[];otherProps.mpColumnPositions=null;otherProps.mpColumnWidths=null;otherProps.mpSortKey=null;otherProps.mbSortDescend=true;otherProps.mRowHeight=36;}function isTouchedOnWidget(touch){if(!touch){return false;}var me=this;var pos=mstrmojo.dom.position(this.domNode);var x=touch.pageX-pos.x,y=touch.pageY-pos.y;if((x>0&&x<me.getWidth())&&(y>0&&y<me.getHeight())){return true;}return false;}function convertToColor(intString){var colorString=parseInt(intString).toString(16);var len=colorString.length;for(var i=len;i<6;i++){colorString="0"+colorString;}colorString="#"+colorString;return colorString;}function buildNonTreeRows(){this.rows=[];for(var i=0;i<models.length;i++){this.rows[i]={model:models[i],rowIdx:i,selected:{},rowRef:{}};}}function isSubTotal(row,rowTitles){for(var i=0;i<row.length;i++){if(row[i].etk!=undefined&&row[i].etk<0){return true;}}return false;}function getAttrIdxArray(w){var attrIDArray=w.attrIDArray;var m=w.model,gts=m.gts,rows=gts.row;var id=rows[0].id;attrIDArray[0]=id;for(var i=1;i<rows.length;i++){if(id==rows[i].id||id==rows[i].id+":CG"){}else{id=rows[i].id;attrIDArray[i]=id;}}}function getTreeNode(tree,treePath){var treePathArray=treePath.split("_");var treeNode=tree;for(var i=0;i<treePathArray.length;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];}return treeNode;}function getPreSiblingTreeNode(tree,treePath){var treePathArray=treePath.split("_");var lowestLevelIdx=treePathArray[treePathArray.length-1];if(lowestLevelIdx>0){treePathArray[treePathArray.length-1]=lowestLevelIdx-1;var treeNode=tree;for(var i=0;i<treePathArray.length;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];}return treeNode;}else{return null;}return null;}function getParentTreeNodeAtLevel(tree,treePath,level){var treePathArray=treePath.split("_");var treeNode=tree;for(var i=0;i<=level;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];}return treeNode;}function getBoolValue(value){if(value===true||value==="true"){return true;}return false;}function setNeedExpandToLevel(tree,level){if(!tree){return ;}if(tree.level<=level){tree.needExpand=true;}else{tree.needExpand=false;}var treeNodeList=tree.childrenTreeNodeList;for(var j=0;j<treeNodeList.length;j++){setNeedExpandToLevel(treeNodeList[j],level);}}function initTree(){this.tree={};this.tree.childrenTreeNodeList=[];this.tree.needExpand=true;this.tree.treePath="";this.tree.level=-1;this.attrIDArray=[];this.currSelectedObj=[];this.lastSelectedObj=[];this.initDockedHeadersDone=false;}function compareTreePath(src,des){var count=src.length;if(des.length!=count){return false;}for(var i=0;i<count-1;i++){if(src[i]!=des[i].idx){return false;}}return true;}function convertDataToTreeModels(AttrIndexes){var treeNodeList=this.tree.childrenTreeNodeList,model=this.model,rhs=model.ghs.rhs,rowTitles=model.gts.row,gvs=model.gvs,expsTree=model.vp.exps&&model.vp.exps.tree;var allExpanded=expsTree&&getBoolValue(expsTree.allExpanded);var mcStatus=this.mcStatus;var expandToLevel=-1;var expandedEntryArray=mcStatus?mcStatus.expandedEntryArray:expsTree&&expsTree.expandedEntry;this.attrIDArray=[];var attrIdxArray=this.attrMapIdx;getAttrIdxArray(this);var rowAttrCount=rhs.items&&rhs.items[0]&&rhs.items[0].items&&rhs.items[0].items.length;var levelCount=attrIdxArray.length-1;this.maxTreeLevel=levelCount-2;expandToLevel=mcStatus?mcStatus.expandToLevel:allExpanded?this.maxTreeLevel-1:-1;var lastTreePath=[];for(var i=0;i<rowAttrCount;i++){lastTreePath.push(-1);}var modelIdx=-1;var gridRowCount=rhs.items.length;if(this.mcStatus&&this.mcStatus.currSelectedObj){this.currSelectedObj=this.mcStatus.currSelectedObj;}for(var i=0;i<gridRowCount;i++){var currRow=rhs.items[i].items;var sameAsLastRow=compareTreePath(lastTreePath,currRow);if(!sameAsLastRow){modelIdx++;}else{continue;}for(var j=0;j<levelCount-1;j++){var attrIdx=attrIdxArray[j];var currSelectedNodeID=this.currSelectedObj[j];if(lastTreePath[attrIdx]!=currRow[attrIdx].idx){var isSubtotal=isSubTotal(currRow);var addToNodeList=treeNodeList;var lastSameNode=null;var treePath="";for(var k=1;k<=j;k++){var treeNodeIdx=addToNodeList.length-1;if(k==j){lastSameNode=addToNodeList[treeNodeIdx];}addToNodeList=addToNodeList[treeNodeIdx].childrenTreeNodeList;treePath+=treeNodeIdx;treePath+="_";}if(isSubtotal&&lastSameNode){lastSameNode.model=models[modelIdx];break;}else{var newTreeNode={};newTreeNode.es=[];newTreeNode.es.push(rowTitles[j].es[currRow[attrIdx].idx]);var elem=rowTitles[j].es[currRow[attrIdx].idx];newTreeNode.id=elem.id;newTreeNode.n=elem.n;newTreeNode.model=models[modelIdx];newTreeNode.selected=false;newTreeNode.childrenTreeNodeList=[];newTreeNode.attrElemIdx=currRow[attrIdx].idx;newTreeNode.isLeaf=(j==this.maxTreeLevel);newTreeNode.level=j;var preSiblingCount=addToNodeList.length;newTreeNode.preSiblingCount=preSiblingCount;newTreeNode.preSibling=preSiblingCount>0?addToNodeList[preSiblingCount-1]:null;treePath+=addToNodeList.length;newTreeNode.treePath=treePath;addToNodeList.push(newTreeNode);newTreeNode.needExpand=j<=expandToLevel?true:false;if(currSelectedNodeID==newTreeNode.id){this.currSelectedObj[j]=newTreeNode;}}}}for(var j=0;j<rowAttrCount;j++){lastTreePath[j]=currRow[j].idx;}}if(expandToLevel<0&&expandedEntryArray){for(var i=0;i<expandedEntryArray.length;i++){var expandedEntry=expandedEntryArray[i];var treeNode=this.tree;for(var j=0;j<expandedEntry.length;j++){var eid=expandedEntry[j].element;var idx=mstrmojo.array.find(treeNode.childrenTreeNodeList,"id",eid);if(idx<0){break;}treeNode=treeNode.childrenTreeNodeList[idx];}treeNode.needExpand=true;}}var preOrderTreeNodeQueue=[];preOrderTreeNodeQueue.push(this.tree);var treeNode=null;while(preOrderTreeNodeQueue.length>0){treeNode=preOrderTreeNodeQueue.pop();var treeNodeList=treeNode.childrenTreeNodeList;var childrenCount=treeNodeList.length;for(var i=childrenCount-1;i>=0;i--){treeNode=treeNodeList[i];preOrderTreeNodeQueue.push(treeNode);treeNode.postSiblingCount=childrenCount-treeNode.preSiblingCount;}}}var ATTR_NAME=0,METRIC_NAME=1,METRIC_VALUE=2,CHART=3,TREE_TRIANGLE=4;DROP_SHADOW=5;function scaleColumnWidthToFitWidget(colInfos,fitToWidth){var colLen=colInfos.length;var totalWidth=0;for(var i=0;i<colLen;i++){if(colInfos[i].type==TREE_TRIANGLE){fitToWidth-=TRIANGLE_WIDTH;}else{totalWidth+=colInfos[i].colWidth;}}var scaleRatio=fitToWidth/totalWidth;for(var i=0;i<colLen;i++){if(colInfos[i].type==TREE_TRIANGLE){colInfos[i].colWidth=TRIANGLE_WIDTH;}else{colInfos[i].colWidth=Math.round(colInfos[i].colWidth*scaleRatio);}}return scaleRatio;}function getContentOffsetWidth(rows,rowIdx,colIdx){var rowInfo=rows[rowIdx],curM=rowInfo.model,elms=curM.elms,treeNode=rowInfo.treeNode,colInfos=this.colInfos,rowIdx=rowInfo.rowIdx,colCount=colInfos.length,colInfo=colInfos[colIdx],colIdx=colInfo.colIdx;if(colInfo.type==ATTR_NAME||colInfo.type==METRIC_NAME){if(this.isTreeMode){var attrName="";for(var k=0;k<treeNode.es.length;k++){attrName+=treeNode.es[k].n;}if(attrName.indexOf("&lt;")>=0){attrName=attrName.replace(/&lt;/g,"<");attrName=attrName.replace(/&gt;/g,">");}return this.getTextWidth(attrName,colInfo.valueCssClass,null,null,null,treeNode.level==0?true:false);}else{attr=elms[colInfo.order];var attrName=attr?attr.n:"";if(attrName.indexOf("&lt;")>=0){attrName=attrName.replace(/&lt;/g,"<");attrName=attrName.replace(/&gt;/g,">");}return this.getTextWidth(attrName,colInfo.valueCssClass,null,null,null,false);}}if(colInfo.type==METRIC_VALUE){var metricIdx=-1;var idx=-1;if(this.isKPI){idx=parseInt(colInfo.order)%this.otherProps.mnMetricsPerKPI;var metricIdx=rowInfo.model.metricIdx+idx;}else{if(colInfo.type==METRIC_VALUE){metricIdx=parseInt(colInfo.order);idx=metricIdx;}}var innerHTML="";var cssClass="";if(curM.refv[idx].ti===undefined){if(curM.refv[idx].ts===4){innerHTML="<img src='"+curM.refv[idx].v+"'/>";}else{innerHTML=curM.refv[idx].v;}}else{try{var model=this.model;var th=model.th[""+metricIdx];var ti=curM.refv[idx].ti;if(curM.refv[idx].ty===4){var path;if(th[ti]&&th[ti].n){path=th[ti].n;}else{path=curM.refv[idx].v;}if(path.indexOf(":")>=0){}else{var baseURL;try{baseURL=mstrApp.getConfiguration().getHostUrlByProject(mstrApp.getCurrentProjectId());}catch(err){baseURL="";}path=baseURL+path;}innerHTML="<img src='"+path+"'/>";}else{if(th[ti]&&th[ti].n&&th[ti].cni!==undefined){innerHTML=th[ti].n;}else{innerHTML=curM.refv[idx].v;}}cssClass=model.css[th[ti].cni].n;}catch(err){if(!innerHTML){innerHTML=curM.refv[idx].v;}}}var className="";if(cssClass){className=colInfo.valueCssClass+" "+cssClass;}else{if(this.valueCssClass){className=colInfo.valueCssClass+" "+this.valueCssClass;}else{className=colInfo.valueCssClass;}}return this.getTextWidth(innerHTML,className,null,null,null,this.isTreeMode&&treeNode.level==0?true:false);}return 0;}var paddingForSS=[5,8,10];var colWidthForChart=[100,150,200];var maxColWidthForAttr=[120,150,180];var maxColWidthForMetric=[100,150,200];var adjustWidthForColumnValue=[20,40,80];function updateColumnWidth(){var colInfos=this.colInfos,width=this.getWidth();if(this.enableSmoothScroll){var rows=this.isTreeMode?getTreeNodeRows.call(this,true,50):this.rows;var rowCount=Math.min(rows.length,50);var mcs=this.metricColumnsSpacing;var paddingWidth=paddingForSS[mcs];for(var j=0;j<this.colInfos.length;j++){var colInfo=this.colInfos[j];if(colInfo.type==ATTR_NAME||colInfo.type==METRIC_NAME||colInfo.type==METRIC_VALUE){var maxColumnValueW=0;for(var i=0;i<rowCount;i++){var columnW=getContentOffsetWidth.call(this,rows,i,j);if(columnW>maxColumnValueW){maxColumnValueW=columnW;}}var headerStr=colInfo.title;var midPos=Math.round(headerStr.length/2);var leftHalf=headerStr.slice(0,midPos);var rightHalf=headerStr.slice(midPos);var leftW=this.getTextWidth(leftHalf,colInfo.headerCssClass,null,null,null,true,false);var rightW=this.getTextWidth(rightHalf,colInfo.headerCssClass,null,null,null,true,false);var maxColumnHeaderW=Math.max(leftW,rightW);var finalColumnW=0;if(maxColumnValueW>maxColumnHeaderW){finalColumnW=Math.min(maxColumnValueW,maxColWidthForMetric[mcs]);}else{finalColumnW=Math.min(maxColumnValueW+adjustWidthForColumnValue[mcs],maxColumnHeaderW,100);}colInfo.colWidth=Math.round(finalColumnW+paddingWidth);colInfo.padding.l=Math.floor(paddingWidth/2);colInfo.padding.r=Math.ceil(paddingWidth/2);}else{if(colInfo.type==TREE_TRIANGLE){colInfo.colWidth=Math.round(TRIANGLE_WIDTH);}else{if(colInfo.type==DROP_SHADOW){colInfo.colWidth=Math.round(this.dropShadowWidth);}else{colInfo.colWidth=Math.round(colWidthForChart[mcs]+paddingWidth);colInfo.padding.l=Math.floor(paddingWidth/2);colInfo.padding.r=Math.ceil(paddingWidth/2);}}}}this.leftWidth=0;for(var i=0;i<this.attrColumnCount;i++){this.leftWidth+=colInfos[i].colWidth;}this.rightWidth=0;var maxMetricWidth=0;for(var i=this.attrColumnCount;i<colInfos.length;i++){console.log(i+": "+colInfos[i].colWidth);this.rightWidth+=colInfos[i].colWidth;if(colInfos[i].colWidth>maxMetricWidth){maxMetricWidth=colInfos[i].colWidth;}}if(this.leftWidth+this.rightWidth<this.getWidth()){var scaleRatio=scaleColumnWidthToFitWidget(this.colInfos,this.getWidth());this.dropShadowDiv.style.display="none";this.enableSmoothScroll=false;this.scrollerConfig.hScroll=false;this.leftWidth=this.getWidth();this.rightWidth=0;this.leftChart.style.width=this.getWidth()+"px";}else{if(this.attrColumnCount>=0){var spaceCol={order:"",type:DROP_SHADOW,title:"",titleAlign:textAlign.center,colWidth:this.dropShadowWidth,padding:{},headerCssClass:this.headerCssClass,valueCssClass:"",colIdx:this.colInfos.length};this.colInfos.splice(this.attrColumnCount,0,spaceCol);this.rightWidth+=this.dropShadowWidth;}var requiredSpace=this.leftWidth+maxMetricWidth+this.dropShadowWidth;if(this.getWidth()<requiredSpace){var rightContainWidth=Math.min(maxMetricWidth+this.dropShadowWidth,0.75*this.getWidth());this.leftWidth=this.getWidth()-rightContainWidth;var attrWidth=this.treeColumnIdx>-1?(this.leftWidth-TRIANGLE_WIDTH)/(this.attrColumnCount-1):this.leftWidth/this.attrColumnCount;for(var i=0;i<this.attrColumnCount;i++){colInfos[i].colWidth=colInfos[i].type==TREE_TRIANGLE?TRIANGLE_WIDTH:attrWidth;}}this.dropShadowDiv.style.display="block";this.scrollerConfig.hScroll=true;this.leftChart.style.width=this.leftWidth+"px";this.rightChart.style.width=this.rightWidth+"px";this.itemsContainerNode.style.width=(this.getWidth()-this.leftWidth)+"px";this.itemsContainerNode.style.left=this.leftWidth+"px";}for(var i=0;i<this.colInfos.length;i++){this.colInfos[i].colIdx=i;if(this.colInfos[i].type==TREE_TRIANGLE){this.treeColumnIdx=i;}}}else{var colLen=colInfos.length;if(this.otherProps.mpColumnWidths.length>0){scaleColumnWidthToFitWidget(this.colInfos,width);}else{if(this.treeColumnIdx>-1){colLen--;width-=TRIANGLE_WIDTH;}var chWidth=Math.round(width/colLen);for(var i=0;i<colInfos.length;i++){if(colInfos[i].type==TREE_TRIANGLE){colInfos[i].colWidth=TRIANGLE_WIDTH;}else{colInfos[i].colWidth=chWidth;}}}}}function buildColInfos(metricColIdx){var m=this.model,rows=m.gts.row,cols=m.gts.col,mes=cols[metricColIdx].es,propValue=m.vp?m.vp:{},width=this.getWidth(),otherProps=this.otherProps;otherProps.mpColumnWidths=propValue.cw?propValue.cw.split(","):(propValue.tcw?propValue.tcw.split(","):[]);var columnWidths=otherProps.mpColumnWidths;if(columnWidths.length!=order.length){columnWidths=[];otherProps.mpColumnWidths=[];}this.colInfos=[];this.showGauge=false;for(var i=0;i<order.length;i++){if(order[i]=="GaugeChart"){this.showGauge=true;}}for(var i=0,colInfoIdx=0;i<order.length;i++){var orderID=order[i];var colInfo={order:orderID,colWidth:0,padding:{},headerCssClass:" ",valueCssClass:" "};if(orderID=="LineChart"){colInfo.type=CHART;colInfo.title=this.sparklineProps.mstrHeader;colInfo.titleAlign=textAlign.center;colInfo.padding.l=Math.round(3*zf);colInfo.padding.r=Math.round(3*zf);}else{if(orderID=="BarChart"){colInfo.type=CHART;colInfo.title=this.barProps.mstrHeader;colInfo.titleAlign=textAlign.center;colInfo.padding.l=Math.round(3*zf);colInfo.padding.r=Math.round(3*zf);}else{if(orderID=="GaugeChart"){colInfo.type=CHART;colInfo.title=this.bulletProps.mstrHeader;colInfo.titleAlign=textAlign.center;colInfo.padding.l=Math.round(3*zf);colInfo.padding.r=Math.round(3*zf);}else{if(orderID=="Metric"){if(otherProps.mbHideTextColumns){this.treeColumnIdx=-1;continue;}colInfo.type=METRIC_NAME;colInfo.title=mstrmojo.desc(1158,"Metrics");colInfo.titleAlign=textAlign.left;colInfo.valueCssClass+=" "+this.valueCssClass;if(cols[metricColIdx].lm&&cols[metricColIdx].lm.length>0){colInfo.lm=cols[metricColIdx];linkCount++;}}else{if(orderID!=parseInt(orderID)){if(otherProps.mbHideTextColumns){this.treeColumnIdx=-1;continue;}colInfo.associateAttr=[];if(this.isTreeMode){this.treeColumnIdx=colInfoIdx;this.colInfos[colInfoIdx]={order:orderID,type:TREE_TRIANGLE,title:"",titleAlign:textAlign.center,colWidth:0,padding:{},headerCssClass:this.headerCssClass,valueCssClass:"",colIdx:this.treeColumnIdx};colInfo.associateAttr.push(colInfoIdx);colInfoIdx++;}colInfo.type=ATTR_NAME;colInfo.title=ID_NAME[orderID];colInfo.titleAlign=textAlign.left;colInfo.valueCssClass+=" "+this.valueCssClass;for(var j=0;j<rows.length;j++){if(orderID.split(":")[0]==rows[j].id){if(otherProps.mbInheritFromGridGraph&&rows[j].cni!==undefined&&m.css.length>rows[j].cni){colInfo.titleAlign=m.css[rows[j].cni].n;}var isFirstAttrForm=(orderID==rows[j].id+":"+rows[j].fid);if(isFirstAttrForm){attrCount++;}if(rows[j].lm&&rows[j].lm.length>0&&rows[j].lm[0].links){colInfo.lm=rows[j];if(isFirstAttrForm){linkCount++;}}var fs=rows[j].fs;for(var q=0;q<fs.length;q++){var attrID=rows[j].id+":"+fs[q].id;if(attrID==orderID){continue;}else{for(var n=0;n<order.length;n++){if(order[n]==attrID){colInfo.associateAttr.push(n);break;}}}}break;}}}else{colInfo.type=METRIC_VALUE;var index=parseInt(orderID);if(index>=mes.length){continue;}if(otherProps.mbInheritFromGridGraph&&mes[index].cni!==undefined&&m.css.length>mes[index].cni){colInfo.titleAlign=m.css[mes[index].cni].n;}else{colInfo.titleAlign=textAlign.right;}if(orderID=="0"){if(this.sparklineProps.mstrAssMetric){colInfo.title=this.sparklineProps.mstrAssMetric;}else{if(this.isKPI){colInfo.title="";}else{colInfo.title=mes[index].n;}}}else{if(orderID=="2"){if(this.bulletProps.mstrAssMetric){colInfo.title=this.bulletProps.mstrAssMetric;}else{if(this.isKPI&&this.showGauge){colInfo.title="";}else{colInfo.title=mes[index].n;}}}else{colInfo.title=mes[index].n;}}if(cols[metricColIdx].lm[index].links){colInfo.lm=cols[metricColIdx];linkCount++;}}}}}}colInfo.valueCssClass+=" microchart-table-text "+colInfo.titleAlign;colInfo.headerCssClass+=" microchart-table-text "+colInfo.titleAlign+" "+this.headerCssClass;if(columnWidths.length>0){colInfo.colWidth=parseFloat(columnWidths[i]);}colInfo.colIdx=colInfoIdx;this.colInfos[colInfoIdx++]=colInfo;}if(order.length==0){colInfos[0].title=rows[0].n;for(var i=1;i<rows.length-GFL;i++){colInfos[i].title=rows[i].n;}}if(this.enableSmoothScroll){var belongToLeft=function(type){switch(type){case ATTR_NAME:return -1;case TREE_TRIANGLE:return -1;case METRIC_NAME:return -1;default:return 1;}};var sortFunc=function(colInfo1,colInfo2){if(belongToLeft(colInfo1.type)*belongToLeft(colInfo2.type)>0){return colInfo1.colIdx<colInfo2.colIdx?-1:1;}else{return belongToLeft(colInfo1.type);}};this.colInfos.sort(sortFunc);for(var i=0;i<this.colInfos.length;i++){if(belongToLeft(this.colInfos[i].type)>0){this.attrColumnCount=i;break;}}}}function convertDataToModels(){init(this);var m=this.model,cols=m.gts.col,metricL=m.gts.col[0].es.length,rows=m.gts.row,rowL=rows.length,rl=m.gvs.items.length,propValue=m.vp?m.vp:{};if(rowL===0||metricL===0||cols.length>1){var errmsg="The widget requires at least two attributes on row axis and one metrics in column axis OR exactly one attribute on row axis and at least one metric on column axis for KPI List mode.";m.err=mstrmojo.desc(8424,errmsg);return ;}if(this.isTreeMode){var row=this.model.gts.row;if(row.length<3){this.isTreeMode=false;}}var len=rows.length;var gfid=rows[len-1].id;len=len-2;while(len>=0){if(gfid==rows[len].id){GFL++;len--;}else{break;}}if(rowL<=GFL){this.isKPI=true;}for(var i=0;i<rows.length;i++){if(rows[i].otp==1){rows[i].otp=-1;while(++i<rows.length&&rows[i].otp==1){rows[i].id+=":CG";rows[i].n=" ";rows[i].otp=-1;}}}for(var i=0;i<rows.length;i++){if(rows[i].fs&&rows[i].fs.length>0){for(var q=0;q<rows[i].fs.length;q++){if(q==0){ID_NAME[rows[i].id+":"+rows[i].fs[q].id]=rows[i].n;}else{ID_NAME[rows[i].id+":"+rows[i].fs[q].id]=" ";}}}if(rows[i].fid&&rows[i].fid.length>0){var headerTitle;headerTitle=rows[i].n;ID_NAME[rows[i].id]=headerTitle;ID_NAME[rows[i].id+":"+rows[i].fid]=headerTitle;}else{ID_NAME[rows[i].id]=rows[i].n;}}var metricIdx=-1;for(var i=0;i<cols.length;i++){if(cols[i].n="Metrics"){metricIdx=i;var mes=cols[i].es;for(var j=0;j<mes.length;j++){ID_NAME[mes[j].oid]=mes[j].n;METRIC_INDEX[mes[j].n]=j;METRIC_INDEX[mes[j].oid]=j;METRICS[j]=mes[j].n;}}}var orderValid=true;if(!propValue.co&&!propValue.tco){orderValid=false;}else{order=propValue.tco?propValue.tco.split(","):propValue.co.split(",");orderValid=processAndCheckOrderValid.call(this);if(!orderValid){propValue.cw=null;propValue.tcw=null;}}if(!orderValid){order=[];if(!this.isKPI){createNonKPIDefaultCol.call(this);}else{createKPIDefaultCol.call(this);}}var otherProps=this.otherProps;if(otherProps.mpSortKey&&otherProps.mpSortKey.length>0){var tempSortKey="";for(var i=0;i<otherProps.mpSortKey.length;i++){if(otherProps.mpSortKey[i]=="_"){break;}tempSortKey+=otherProps.mpSortKey[i];}var mIdx=METRIC_INDEX[tempSortKey];if(mIdx>=0){otherProps.mpSortKey=mIdx;}else{for(var id in ID_NAME){if(ID_NAME[id]==tempSortKey){otherProps.mpSortKey=id;break;}}if(!ID_NAME[otherProps.mpSortKey]){otherProps.mpSortKey=null;}}}else{otherProps.mpSortKey=null;}if(otherProps.mbInheritFromGridGraph&&(this.theme==CUSTOM_DARK_THEME||this.theme==CUSTOM_LIGHT_THEME)){try{var headerIndex=m.headercni?m.headercni:0;var valueIndex=m.valuecni?m.valuecni:(m.css.length-1);var getCssClass=function(name){if(name){return name;}return"";};this.headerCssClass=getCssClass(m.css[headerIndex].n);this.valueCssClass=getCssClass(m.css[valueIndex].n);if(this.valueCssClass&&this.valueCssClass.length>0){var textSpan=this.textSpan;textSpan.className=this.valueCssClass;textSpan.style.font="";this.fontSize=mstrmojo.css.getStyleValue(textSpan,"fontSize");}var fontHeight=this.getTextHeight("a",this.valueCssClass,true);if(fontHeight>otherProps.mRowHeight){otherProps.mRowHeight=fontHeight;}}catch(err){}}var applyLocale=function(proOwner,proName,dftStr,hasBracket,descID){var compareStr=dftStr;var returnStr;if(hasBracket){compareStr="["+dftStr+"]";}if(proOwner[proName]===compareStr){returnStr=mstrmojo.desc(descID,dftStr);if(hasBracket){returnStr="["+returnStr+"]";}proOwner[proName]=returnStr;}};buildColInfos.call(this,metricIdx);if(!this.isKPI){convertAttributeDrivenData(this);}else{convert(this);}var kpi=otherProps.mnMetricsPerKPI;var m=this.model;if(this.isKPI&&metricL<kpi){var errmsg="Metric per KPI should be at least 1 or less than or equal to the total number of Metrics in the widget";m.err=errmsg;return ;}if(models.length==0){var errmsg="No data returned for this view, this might be because the applied filter excludes all data";m.err=errmsg;return ;}this.buildRows();updateColumnWidth.call(this);this.showMinLabel=bulletShowMinLabel.call(this);}function processAndCheckOrderValid(){for(var i=0;i<order.length;i++){if(order[i]=="LineChart"||order[i]=="BarChart"||order[i]=="GaugeChart"||order[i]=="Metric"){continue;}if(order[i].length<3){return false;}var tstStr=order[i];var len=tstStr.length;if(tstStr[len-2]=="|"){order[i]=tstStr=tstStr.substring(0,len-2);}if(!ID_NAME[tstStr]){return false;}else{if(METRIC_INDEX[tstStr]!==undefined){order[i]=METRIC_INDEX[tstStr]+"";}else{if(this.isKPI){order[i]="0";}}}}if(this.enableSmoothScroll){return false;}var m=this.model,metricES=m.gts.col[0].es;var columnIDs=[],cIDs=[];if(this.isTreeMode){columnIDs=this.otherProps.mpColumnIDsInTreeMode;if(columnIDs.length==1){return false;}for(var i=0;i<metricES.length;i++){var metricID=metricES[i].oid;cIDs.push(metricID);}}else{columnIDs=this.otherProps.mpColumnIDs;if(this.isKPI){if(columnIDs.length<=1){return false;}cIDs.push("Metric");var metricPerKPI=this.otherProps.mnMetricsPerKPI;if(metricPerKPI>2){for(var i=0;i<metricPerKPI;i++){if(i%metricPerKPI<=1){continue;}var metricID=metricES[i].oid;cIDs.push(metricID);}}}else{if(columnIDs.length==1){return false;}var rows=m.gts.row,attrCnt=rows.length-1,rowHeaderCnt=0;for(var i=0;i<attrCnt;i++){var attr=rows[i],attrFormCnt=attr.fs&&attr.fs.length;cIDs.push(attr.id);for(var j=1;j<attrFormCnt;j++){cIDs.push(attr.fs[j].id);}rowHeaderCnt+=attrFormCnt;}for(var i=0;i<metricES.length;i++){var metricID=metricES[i].oid;cIDs.push(metricID);}}}if(cIDs.length!=columnIDs.length){return false;}for(var i=0;i<cIDs.length;i++){var metricID=cIDs[i];if(mstrmojo.array.indexOf(columnIDs,metricID)==-1){return false;}}return true;}function createKPIDefaultCol(){var ind=0;var otherProps=this.otherProps,sparklineProps=this.sparklineProps,barProps=this.barProps,bulletProps=this.bulletProps;order[ind++]="Metric";var kpi=otherProps.mnMetricsPerKPI;if(isNaN(kpi)){kpi=1;}var firstChartShow=false;if(sparklineProps.mbShow){firstChartShow=true;order[ind++]="LineChart";}if(barProps.mbShow){firstChartShow=true;order[ind++]="BarChart";}if((!firstChartShow&&otherProps.mbShowForHiddenGraphs)||(firstChartShow&&sparklineProps.mbAssMetric)){order[ind++]="0";}if(kpi>=7){if(bulletProps.mbShow){if(bulletProps.mbAssMetric){order[ind++]="2";}order[ind++]="GaugeChart";}else{if(otherProps.mbShowForHiddenGraphs){for(var i=3;i<=kpi&&i<=7;i++){order[ind++]=""+(i-1);}}}for(var i=8;i<=kpi;i++){order[ind++]=""+(i-1);}}else{for(var i=3;i<=kpi;i++){order[ind++]=""+(i-1);}}}function createNonKPIDefaultCol(){var ind=0;var m=this.model,rows=m.gts.row,cols=m.gts.col;var mtrcNum=0;if(this.isTreeMode){order[ind++]=rows[0].id;}else{for(var i=0;i<rows.length-GFL;i++){if(rows[i].fs&&rows[i].fs.length>0){for(var q=0;q<rows[i].fs.length;q++){order[ind++]=rows[i].id+":"+rows[i].fs[q].id;}}else{if(rows[i].fid&&rows[i].fid.length>0){order[ind++]=rows[i].id+":"+rows[i].fid;}else{order[ind++]=rows[i].id;}}}}for(var i=0;i<cols.length;i++){if(cols[i].n="Metrics"){mtrcNum=cols[i].es.length;}}var firstChartShow=false;if(this.sparklineProps.mbShow){firstChartShow=true;order[ind++]="LineChart";}if(this.barProps.mbShow){firstChartShow=true;order[ind++]="BarChart";}if((!firstChartShow&&this.otherProps.mbShowForHiddenGraphs)||(firstChartShow&&this.sparklineProps.mbAssMetric)){order[ind++]="0";}if(mtrcNum>=7){if(this.bulletProps.mbShow){if(this.bulletProps.mbAssMetric){order[ind++]="2";}order[ind++]="GaugeChart";}else{if(this.otherProps.mbShowForHiddenGraphs){for(var i=3;i<=7&&i<=mtrcNum;i++){order[ind++]=""+(i-1);}}}for(var i=8;i<=mtrcNum;i++){order[ind++]=""+(i-1);}}else{for(var i=3;i<=mtrcNum;i++){order[ind++]=""+(i-1);}}}function convertAttributeDrivenData(w){var m=w.model,metricES=m.gts.col[0].es,rows=m.gts.row,gvsRows=m.gvs.items,rl=m.gvs.items.length,rhs=m.ghs.rhs.items;var rowsLen=rows.length;var lai=rows.length-GFL;var slai=lai-1;var idxPos=0;w.attrMapIdx=[];var attrMapIdx=w.attrMapIdx;for(var q=0;q<rowsLen;q++){attrMapIdx[q]=idxPos;if(!rows[q].fs||rows[q].fs.length==0){idxPos++;}else{idxPos+=rows[q].fs.length;}}attrMapIdx[rowsLen]=idxPos;var attrName=rows[lai].dn||rows[lai].n;var fnCopyArray=function(src,isIdx){var dest=[];for(var i=0;i<src.length;i++){dest[i]=src[i];}return dest;};w.ctlMatrix={};w.isAllAttrSelectable=true;for(var i=0;i<lai;i++){var attribute=rows[i];if(!attribute.sc||!attribute.sc.tks||attribute.sc.tks==""){w.isAllAttrSelectable=false;continue;}w.ctlMatrix[attribute.id]={es:attribute.es,sc:attribute.sc,map:[],selectedIdx:{},colIdx:w.getColIdx(attribute.id)};if(attribute.sc.all&&attribute.sc.allSelected){w.ctlMatrix[attribute.id].selectedIdx["-1"]=true;}}var AttrIndexes=[];var i=0,j=0;var template=[];var tempLen=0;for(i=0;i<rhs.length;i++){if(i===0){AttrIndexes[0]=[];for(j=0;j<rhs[i].items.length;j++){AttrIndexes[0][j]=rhs[0].items[j].idx;if(AttrIndexes[0][j]<0&&rows[j].otp==-1){AttrIndexes[0][j]=rows[j].es.length+AttrIndexes[0][j-1];}if(rhs[0].items[j].cet){var id=rhs[0].items[j].cet;if(order[j]==id+":CG"){id+=":CG";}var controlMatrix=w.ctlMatrix[id];if(controlMatrix&&!controlMatrix.selectedIdx[-1]){controlMatrix.selectedIdx[AttrIndexes[0][j]]=true;}}}template=fnCopyArray(AttrIndexes[0]);tempLen=template.length;continue;}var rhsRow=rhs[i].items;var rhsRowLen=rhsRow.length;for(j=1;j<=rhsRowLen;j++){template[tempLen-j]=rhsRow[rhsRowLen-j].idx;if(template[tempLen-j]<0){var k=0;for(;k<attrMapIdx.length;k++){if(tempLen-j<attrMapIdx[k]){break;}}template[tempLen-j]=rows[k-1].es.length+rhsRow[rhsRowLen-j-1].idx;}if(rhsRow[rhsRowLen-j].cet){var id=rhsRow[rhsRowLen-j].cet;if(order[rhsRowLen-j]==id+":CG"){id+=":CG";}var controlMatrix=w.ctlMatrix[id];if(controlMatrix){delete controlMatrix.selectedIdx[-1];controlMatrix.selectedIdx[template[tempLen-j]]=true;}}}AttrIndexes[i]=fnCopyArray(template);}var fnBEL=function(index){var elms={};var ind=0;for(var i=0;i<rows.length-GFL;i++){var fL=rows[i].fs.length;if(fL<1){fL=1;}var attId=rows[i].id;if(AttrIndexes[index][ind]<0){elms[attId]="";}else{elms[attId]=rows[i].es[AttrIndexes[index][ind]];}if(elms[attId]==undefined){elms[attId]={n:""};}var fidId=rows[i].fid;if(fidId&&fidId.length>0){elms[attId+":"+fidId]=rows[i].es[AttrIndexes[index][ind]];}for(var j=0;j<fL;j++){var formId="";if(rows[i].fs&&rows[i].fs[j]){formId=rows[i].fs[j].id;}if(formId&&formId.length>0){var afID=attId+":"+formId;elms[afID]=rows[i].es[AttrIndexes[index][ind]];}ind++;}}return elms;};var s={v:[],rv:[],thClr:[],hi:[0]};var referValue=[];var sortValue=0;var attrElems=null;var ch=[{items:[{n:metricES[0].n}]}];var c=[],baseRow=[],j=0,si=0,isTotal=false,compareResult=false;function indexChanged(baseRow,newRow){if(baseRow.length!=newRow.length){return true;}var endIndex=attrMapIdx[lai]-1;if(endIndex>=baseRow.length){endIndex=baseRow.length-1;}for(var i=endIndex;i>=0;i--){if(baseRow[i]!=newRow[i]){return true;}}return false;}for(var i=0;i<=rl;i++){if(i===0){baseRow=AttrIndexes[i];}else{if((compareResult=(i===rl||indexChanged(baseRow,AttrIndexes[i])))||isTotal){if(isTotal&&!compareResult){}else{for(var x=0;x<lai;x++){var controlMatrix=w.ctlMatrix[rows[x].id];if(controlMatrix){controlMatrix.map[si]=AttrIndexes[i-1][x];}}models[si]={sortV:sortValue,isTotal:isTotal,refv:referValue,elms:attrElems,tr:s.v[s.v.length-1],model:{categories:{items:c,tn:attrName},mtrcs:{items:METRICS},colHeaders:ch,series:[s],rowHeaders:[{n:rows[lai].n}]}};si++;if(i===rl){break;}}s={v:[],rv:[],thClr:[],hi:[0]};referValue=[];c=[];baseRow=AttrIndexes[i];j=0;isTotal=false;}}var otherProps=w.otherProps;for(var p=0;p<gvsRows[i].items.length;p++){if(!referValue[p]){referValue[p]={};}referValue[p]=gvsRows[i].items[p];}attrElems=fnBEL(i);if(otherProps.mpSortKey!=null){var sortByAttr=(otherProps.mpSortKey!=parseInt(otherProps.mpSortKey));if(sortByAttr){sortValue=attrElems[otherProps.mpSortKey].n;}else{sortValue=parseFloat(referValue[otherProps.mpSortKey].rv);}}if(!w.isTreeMode){var isSubTotal=function(attr){return(attr.id&&attr.id.substring(0,1)==="D")||(attr.id===undefined&&attr.n==="Total");};var attrSlai=rows[slai].es[AttrIndexes[i][attrMapIdx[slai]]];if(attrSlai&&isSubTotal(attrSlai)){isTotal=true;continue;}var attr=rows[lai].es[AttrIndexes[i][attrMapIdx[lai]]];if(attr&&isSubTotal(attr)){continue;}}var attrElement="";var attIdxPos=attrMapIdx[lai];var thisAtt=null;var thisAttFormLen=1;try{for(var p=0;p<GFL;p++){thisAtt=rows[lai+p];if(thisAtt.fs&&thisAtt.fs.length>0){thisAttFormLen=thisAtt.fs.length;}else{thisAttFormLen=1;}for(var pp=0;pp<thisAttFormLen;pp++){attrElement+=" "+thisAtt.es[AttrIndexes[i][attIdxPos]].n;attIdxPos++;}}}catch(err){}c[j]=attrElement;var item=gvsRows[i].items[0];s.v[j]=item.v;s.rv[j]=item.rv;var th=m.th&&m.th["0"];var ti=item.ti;if(ti!=undefined&&item.ty==2&&th[ti].cni!=undefined&&otherProps.mbInheritFromGridGraph){this.textSpan.className=m.css[th[ti].cni].n;var compStyle=mstrmojo.css.getComputedStyle(this.textSpan);s.thClr[j]=compStyle.backgroundColor;if(s.thClr[j]=="rgba(0, 0, 0, 0)"){s.thClr[j]=null;}}else{s.thClr[j]=null;}j++;}if(!w.isTreeMode&&otherProps.mpSortKey!=null){var rowCount=models.length;for(var i=0;i<rowCount;i++){for(var j=0;j<rowCount-1;j++){if((otherProps.mbSortDescend&&models[j].sortV<models[j+1].sortV)||(!otherProps.mbSortDescend&&models[j].sortV>models[j+1].sortV)){var temp=models[j];models[j]=models[j+1];models[j+1]=temp;}}}}if(w.isTreeMode){convertDataToTreeModels.call(w,AttrIndexes);}}function convert(w){var m=w.model,rows=m.gts.row,cols=m.gts.col,cs=rows[rows.length-1].es,sn=cols[0].es,idxItems=m.ghs.rhs.items,csl=idxItems.length,v=m.gvs.items,ch=[];for(var i=0;i<sn.length;i++){if(!ch[0]){ch[0]={items:[]};}ch[0].items[i]=[{n:sn[i].n}];}var vl=v[0].items.length;var series=[];var c=[];var attrName=m.gts.row[0].dn||m.gts.row[0].n;var referValue=[];var kpi=w.otherProps.mnMetricsPerKPI;if(isNaN(kpi)){kpi=1;}var sNum=0;var metrixIdxArray=[];for(var i=0;i+kpi<=vl;i=i+kpi){var fv=[];var rv=[];series[sNum]={v:fv,rv:rv,hi:[0]};var refV=[];referValue[sNum]={refv:refV};for(var j=0;j<kpi;j++){referValue[sNum].refv[j]=v[csl-1].items[i+j];}metrixIdxArray[sNum]=i;sNum++;}for(var i=0;i<csl;i++){var idxItemsItems=idxItems[i].items;var idx=idxItemsItems[idxItemsItems.length-1].idx;if(isNaN(idx)){console.log("idx is not a number!"+idx);c[i]=cs[i].n;}else{if(idx<0){c[i]="";}else{c[i]=cs[idx].n;}for(var k=2;k<=idxItemsItems.length&&k<=rows.length;k++){var anotherIdx=idxItemsItems[idxItemsItems.length-k].idx;if(!isNaN(anotherIdx)){c[i]=rows[rows.length-k].es[anotherIdx].n+" "+c[i];}}}var ind=0;for(var j=0;j+kpi<=vl;j=j+kpi){series[ind].v[i]=v[i].items[j].v;series[ind].rv[i]=v[i].items[j].rv;ind++;}}var sl=series.length;for(var i=0;i<sl;i++){var elmsValue={};elmsValue[m.gts.row[0].id]=ch[0].items[i*kpi][0];if(m.gts.row[0].fid){elmsValue[m.gts.row[0].id+":"+m.gts.row[0].fid]=ch[0].items[i*kpi][0];}elmsValue.Metric=ch[0].items[i*kpi][0];models[i]={refv:referValue[i].refv,elms:elmsValue,tr:series[i].v[series[i].v.length-1],model:{categories:{items:c,tn:attrName},mtrcs:{items:METRICS},series:[series[i]],colHeaders:[{items:ch[0].items[i]}],rowHeaders:[{n:rows[0].n}]},metricIdx:metrixIdxArray[i]};}}function bulletShowMinLabel(){var showMinLabel=false;var otherProps=this.otherProps;if(this.showGauge){var minValue=this.bulletProps.mfMinValue;var count=models.length;for(var i=0;i<count;i++){var v=models[i].refv[2];if(v&&v.rv<minValue){showMinLabel=true;otherProps.mRowHeight=otherProps.mRowHeight>36?otherProps.mRowHeight:36;break;}}}return showMinLabel;}function getFirstRowUnderDockedHeader(yPos){var scl=this.getChartWithScrollBar()._scroller;var y=yPos||scl&&scl.origin&&scl.origin.y;var rowOffsetHeight=this.rowOffsetHeight;var rowIdx=this.startCnt+parseInt(y/rowOffsetHeight)+this.dockedHeaderRows.length;var rowPast=y%rowOffsetHeight;var rowInfo=getRowAtIdx.call(this,rowIdx);return{rowInfo:rowInfo,treeNode:rowInfo.treeNode,pastOffset:rowPast,rowIdx:rowIdx};}function getRowAtIdx(rowIdx){if(rowIdx<0){rowIdx=0;}var maxRowIdx=this.rows.length-1;if(rowIdx>maxRowIdx){rowIdx=maxRowIdx;}return this.rows[rowIdx];}function getTreeNodeRows(allExpand,rowCnt){var preOrderTreeNodeQueue=[];var treeNode=null;var rows=[];var treeNodeList=this.tree.childrenTreeNodeList;var childrenCount=treeNodeList.length;for(var i=childrenCount-1;i>=0;i--){preOrderTreeNodeQueue.push(treeNodeList[i]);}var rowCount=0;while(preOrderTreeNodeQueue.length>0){treeNode=preOrderTreeNodeQueue.pop();var row={treeNode:treeNode,model:treeNode.model,rowIdx:rowCount,selected:treeNode.selected,rowRef:{}};rows.push(row);if(!allExpand){treeNode.rowIdx=rowCount++;}if(rowCnt&&rowCount>=rowCnt){break;}if(treeNode.needExpand||allExpand){treeNodeList=treeNode.childrenTreeNodeList;childrenCount=treeNodeList.length;for(var i=childrenCount-1;i>=0;i--){preOrderTreeNodeQueue.push(treeNodeList[i]);}}}return rows;}function getLowestLevelOnScreen(){var scl=this.getChartWithScrollBar()._scroller;var y=scl&&scl.origin&&scl.origin.y;var rowOffsetHeight=this.rowOffsetHeight;var firstRowIdx=this.startCnt+parseInt(y/rowOffsetHeight);var chartHeight=Math.min(this.chartTableMaxHeight,parseInt(this._leftChart.itemsContainerNode.style.height));var lastRowIdx=this.startCnt+parseInt((y+chartHeight)/rowOffsetHeight);if(firstRowIdx<0){firstRowIdx=0;}if(lastRowIdx>=this.rows.length){lastRowIdx=this.rows.length-1;}var lowestLevel=-1;for(var i=firstRowIdx;i<=lastRowIdx;i++){var currLevel=this.rows[i].treeNode.level;if(currLevel>lowestLevel){lowestLevel=currLevel;}}return lowestLevel;}function removeChildren(container){var count=container&&container.childNodes&&container.childNodes.length;for(var i=0;i<count;++i){container.removeChild(container.firstChild);}}function hasScrollDownPast(yPos){return yPos<0;}function expandOrCollapseTreeAndSetScrlPos(levelToExpand,anchorRowTreeNode,anchorRowIdxOnScrn){if(this.expandToLevel==levelToExpand){return ;}setNeedExpandToLevel(this.tree,levelToExpand);this.expandToLevel=levelToExpand;this.rowsNeedRebuild=true;this.reRenderChartWithAnchor(anchorRowTreeNode,anchorRowIdxOnScrn);setChartTableHeight.call(this);this.reBuildDH(levelToExpand);}function expandTreeNodeAndSetScrlPos(rowInfo,rowType){var treeNode=rowInfo.treeNode;treeNode.needExpand=true;this.expandToLevel=-1;var scl=this.getChartWithScrollBar()._scroller;var currRowIdx=rowInfo.rowIdx;this.reRenderChart(scl.origin);setChartTableHeight.call(this);if(currRowIdx==this.startCnt+parseInt(scl.origin.y/this.rowOffsetHeight)+this.dockedHeaderRows.length){var rowIdxList=[];var currRowTreeNode=rowInfo.treeNode;while(currRowTreeNode.needExpand){rowIdxList.push(currRowIdx);currRowTreeNode=getRowAtIdx.call(this,++currRowIdx).treeNode;}this.addRowsToDH(rowIdxList);}var rowOffsetHeight=this.rowOffsetHeight;var lastRowOnScrnIdx=this.startCnt+Math.round((scl.origin.y+this.chartTableHeight)/rowOffsetHeight)-1;if(currRowIdx==lastRowOnScrnIdx){var scroller=scl;var maxYPos=Math.min(scl.origin.y+2*rowOffsetHeight,scl.offset.y.end);scl.origin.y=maxYPos;$D.translate(scroller.scrollEl,-scroller.origin.x,-scroller.origin.y,0,scroller.transform,scroller.useTranslate3d);this.onScrollMoved({y:maxYPos});}}function getIdxByRowIdx(rows,targetIdx){var rowCount=rows.length;for(var i=0;i<rowCount;i++){var rowInfoDH=rows[i];if(rowInfoDH.rowIdx==targetIdx){return i;}}return -1;}function collapseTreeNodeAndSetScrlPos(rowInfo,rowType){var treeNode=rowInfo.treeNode;treeNode.needExpand=false;this.expandToLevel=-1;var scl=this.getChartWithScrollBar()._scroller;if(rowType==DOCKED_HEADER){var adjustOffset=0;var rowCount=this.dockedHeaderRows.length;var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,rowInfo.rowIdx);if(dockedHeaderIdx>=0){this.removeRowsFromDH(rowCount-dockedHeaderIdx);this.removeChildrenForDHReplaceTable();this.dockedHeaderStatus=NO_REPLACE;}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,rowInfo.rowIdx);if(dockedHeaderIdx<0){return ;}dockedHeaderIdx+=rowCount;adjustOffset=scl.origin.y%this.rowOffsetHeight;this.removeChildrenForDHReplaceTable();this.dockedHeaderStatus=NO_REPLACE;}var rowCount=this.startCnt+parseInt(scl.origin.y/this.rowOffsetHeight)+dockedHeaderIdx-rowInfo.rowIdx;this.reRenderChart(scl.origin,rowCount,adjustOffset);}else{if(rowType==OTHER_ROW){this.reRenderChart(scl.origin);}}setChartTableHeight.call(this);}var hideTooltipGlobal=function(){if(this.tooltip.style.display==="block"){var highLightCav=document.getElementById("highLightCav"+this.domNode.id);if(highLightCav){highLightCav.id="";var context=highLightCav.getContext("2d");context.clearRect(0,0,highLightCav.width,highLightCav.height);}this.tooltip.style.display="none";this.tooltipShow=false;if(this._touchListener){var touchManager=mstrmojo.touchManager;touchManager.detachEventListener(this._touchListener);delete this._touchListener;}}};function setChartTableHeight(){if(!this._leftChart){return ;}var chartTableOffsetHeight=(this.otherProps.mbHideTextColumns&&this.enableSmoothScroll)?this._rightChart.chartTableOffsetHeight:this._leftChart.chartTableOffsetHeight;var headerTableOffsetHeight=(this.otherProps.mbHideTextColumns&&this.enableSmoothScroll)?this._rightChart.headerTableOffsetHeight:this._leftChart.headerTableOffsetHeight;var chartTableHeight=0;if(chartTableOffsetHeight>=this.chartTableMaxHeight){chartTableHeight=this.chartTableMaxHeight;}else{chartTableHeight=chartTableOffsetHeight;}this._leftChart.itemsContainerNode.style.height=chartTableHeight+"px";if(this._rightChart){this._rightChart.itemsContainerNode.style.height=chartTableHeight+"px";}this.legend.style.top=(headerTableOffsetHeight+chartTableHeight)+"px";this.dropShadowDiv.style.height=(headerTableOffsetHeight+chartTableHeight)+"px";this.indicatorEl.parentNode.style.top=headerTableOffsetHeight+"px";this.indicatorEl.parentNode.style.height=chartTableHeight+"px";this.chartTableHeight=chartTableHeight;var scl=this.getChartWithScrollBar()._scroller;var yPos=scl.origin.y;var maxYPos=chartTableOffsetHeight-chartTableHeight+2;if(yPos>maxYPos){if(scl.vScroll){scl.origin.y=maxYPos;this._leftChart.scrollTo(scl.origin);if(this._rightChart){this._rightChart.scrollTo(scl.origin);}var rowOffsetHeight=this.rowOffsetHeight;while((yPos=yPos-rowOffsetHeight)>maxYPos){this.updateDockedHeadersByOneRow(yPos,true);}this.updateDockedHeadersByOneRow(maxYPos);this.firstRowIdxOnScrn=parseInt(this.startCnt+scl.origin.y/rowOffsetHeight);}else{scl.origin.y=0;this._leftChart.scrollTo(scl.origin);if(this._rightChart){this._rightChart.scrollTo(scl.origin);}this.firstRowIdxOnScrn=parseInt(this.startCnt+scl.origin.y/rowOffsetHeight);}}this.updateWindowRatio();this.updateScrollBarPosition();}function setScrollerPosition(scrollTo){var scl=this._scroller,icn=this.rightChart,offsetEnd=this.rightChart.offsetWidth-(this.getWidth()-this.leftWidth);scl.origin={x:scrollTo&&scrollTo.x||0,y:scrollTo&&scrollTo.y||0};scl.showScrollbars=true;scl.hScroll=(offsetEnd!==0&&scl.noHScroll!==true)||this.scrollPast;if(scl.hScroll){scl.offset={x:{start:0,end:offsetEnd},scrollPast:this.scrollPast};}this.utils.translateCSS(-scl.origin.x,-scl.origin.y,false,icn);}mstrmojo.VisMicroChart=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisMicroChart",utils:mstrmojo.VisChartUtils,scrollerConfig:{bounces:false,showScrollbars:true,vScroll:false,hScroll:true,useTranslate3d:false},scrollPast:false,legendHeight:30,selectedStyle:"background-color:#015DE6;color:#FFFFFF;",selectedClass:"",isAllAttrSelectable:false,prevSelected:{mrow:-2,mcol:-1},rows:[],dockedHeaderRows:[],dockedHeaderReplaceRows:[],rowsReusePool:[],unselectedRemainCells:[],isTreeMode:false,isKPI:false,showMinLabel:false,rowsNeedRebuild:true,lastScrollPosition:{y:0},startCnt:-1,endCnt:-1,firstRowIdxOnScrn:0,pageSize:10,mcStatus:null,fontSize:"10pt",headerCssClass:"",valueCssClass:"",enableSmoothScroll:false,metricColumnsSpacing:NORMAL,attrColumnCount:0,dropShadowWidth:7,markupString:'<div id="{@id}-microchart" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};left:{@left};top:{@top};z-index:{@zIndex};position:absolute"  mstrAttach:mousedown,mouseup,mousemove,click ><div id="{@id}-microchart-left" style="width:{@leftWidth+"px"};height:{@height};left:0px;right:0px;position:absolute;z-index:1;" > </div><div id="{@id}-microchart-smoothscroll-container" class="mstrmojo-Chart {@cssClass}" style="width:{@rightWidth+"px"};height:{@height};left:{@leftWidth+"px"};top:0;position:absolute;overflow:hidden;"><div id="{@id}-microchart-right" style="width:{@rightWidth};position:absolute;" > </div><div id="{@id}-drop-shadow-ss" style="position:absolute;left:0px;width:{@dropShadowWidth+"px"}" > </div></div><div style="display:none;position:absolute;right:0;z-index:5;height:{@legendHeight + "px"};width:{@width};border:none;background:transparent;text-decoration:none;" class="microchart-lengend-text"><div style="position:absolute;right:0;top:0;padding-bottom:7px"><div style="float:left;padding-top:7px;"><div class="microchart-legend-band" ></div><div style="float:right;margin-right:10px;margin-left:10px;">Low</div></div><div style="float:left;padding-top:7px;"><div class="microchart-legend-band"></div><div style="float:right;margin-right:10px;margin-left:10px;">Mid</div></div><div style="float:left;padding-top:7px;"><div class="microchart-legend-band"></div><div style="float:right;margin-right:10px;margin-left:10px;">High</div></div></div></div><span id="textSpan" style="z-index:-10;visibility:hidden;-webkit-text-size-adjust: none;"></span><div id="{@id}-loading-msg" class="mstrmojo-loading-msg" style="display:none;z-index:10"></div><canvas id="textCanvas" width="900" height="500" style="z-index:-11;visibility:hidden;-webkit-text-size-adjust: none;"></canvas><div id="{@id}-tooltip" class="mstrmojo-MicroChart-tooltip" style="z-index:10;opacity: 0.9;"></div><div id="{@id}-text-tooltip" class="mstrmojo-Chart-tooltip timeseries-legend-tooltip" style="z-index:10"></div><div id="{@id}-errMsg" class="mstrmojo-message" style="width:{@width};height:{@height};top:0px;left:0px;position:absolute; display:none; z-index:30;"><div style="width:{@width};position:absolute;top:50%;text-align:center"></div></div><div id="{@id}-indicatorEl-container"  style="width:{@width};height:{@height};top:0px;left:0px;position:absolute;z-index:-5"><div></div></div></div>',markupSlots:{leftChart:function(){return this.domNode.childNodes[0];},rightChart:function(){return this.domNode.childNodes[1].firstChild;},dropShadowDiv:function(){return this.domNode.childNodes[1].childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[1];},textSpan:function(){return this.domNode.childNodes[3];},loadingMsg:function(){return this.domNode.childNodes[4];},textCanvas:function(){return this.domNode.childNodes[5];},tooltip:function(){return this.domNode.childNodes[6];},textTooltip:function(){return this.domNode.childNodes[7];},errorMsg:function(){return this.domNode.childNodes[8];},indicatorEl:function(){return this.domNode.childNodes[9].firstChild;},legend:function(){return this.domNode.childNodes[2];},legendLow:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0];},legendLowFont:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0].childNodes[1];},legendLowBand:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0].childNodes[0];},legendMid:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1];},legendMidFont:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1].childNodes[1];},legendMidBand:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1].childNodes[0];},legendHigh:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[2];},legendHighFont:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[2].childNodes[1];},legendHighBand:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[2].childNodes[0];}},renderErrorMessage:function renderErrorMessage(msg){var contentDiv=this.errorMsg.firstChild;contentDiv.innerHTML=msg;this.errorMsg.style.display="block";var contentHeight=contentDiv.offsetHeight;contentDiv.style.marginTop=-0.5*contentHeight;},getTextWidthByCanvas:function gtwCvs(text,elem,withPadding){var canvas=this.textCanvas;var context=canvas.getContext("2d");var computedStyle=mstrmojo.css.getComputedStyle(elem);var fontStyle=computedStyle.fontStyle+" "+computedStyle.fontWeight+" "+computedStyle.fontSize+"/"+computedStyle.fontVariant+" "+computedStyle.fontFamily;context.font=fontStyle;context.textAlign="center";context.fillStyle="blue";var metrics=context.measureText(text);var result=metrics.width;if(withPadding){var addPadding=function(padding){if(computedStyle[padding]){result+=parseInt(computedStyle[padding]);}};addPadding("paddingLeft");addPadding("paddingRight");}return result;},getTextWidth:function gtw(str,className,fontName,fontSize,fontSizeUnit,bold,withoutPadding){var selfTextSpan=this.textSpan;if(selfTextSpan.className!==className||""){selfTextSpan.className=className||"";}if(selfTextSpan.style.fontFamily!==fontName||""){selfTextSpan.style.fontFamily=fontName||"";}var fsUnit=fontSizeUnit||"pt";if(fontSize){selfTextSpan.style.fontSize=fontSize+fsUnit;}else{selfTextSpan.style.fontSize="";}if(bold){if(selfTextSpan.style.fontWeight!=="bold"){selfTextSpan.style.fontWeight="bold";}}else{if(selfTextSpan.style.fontWeight!==""){selfTextSpan.style.fontWeight="";}}if(withoutPadding){selfTextSpan.style.padding="0px 0px";}else{selfTextSpan.style.padding="";}selfTextSpan.innerHTML=str;var ret=selfTextSpan.offsetWidth;return ret;},getTextHeight:function gth(str,className,bold,fontFamily,fontSize){this.textSpan.style.fontFamily=fontFamily||"";this.textSpan.style.fontSize=fontSize||"";if(bold){this.textSpan.style.fontWeight="bold";}else{this.textSpan.style.fontWeight="";}this.textSpan.className=className;this.textSpan.innerHTML=str;return this.textSpan.offsetHeight;},removeMCStatus:function removeMCStatus(){this.mcStatus=null;if(this.controller&&this.controller.view&&this.controller.view.model){this.controller.view.model.mcStatus=null;}},restoreMCStatus:function restoreMCStatus(){if(this.isTreeMode&&this.mcStatus&&this.mcStatus.currSelectedObj&&this.mcStatus.currSelectedObj.length>0){this.lastSelectedObj=$HASH.clone(this.currSelectedObj);}if(this.mcStatus&&this.mcStatus.startCnt!=undefined&&this.mcStatus.endCnt!=undefined){this.startCnt=this.mcStatus.startCnt;this.firstRowIdxOnScrn=this.mcStatus.firstRowIdxOnScrn;var minRowCntToCoverScreen=Math.max(this.mcStatus.endCnt-this.mcStatus.firstRowIdxOnScrn,this.minPageSize);this.endCnt=Math.min(this.mcStatus.firstRowIdxOnScrn+minRowCntToCoverScreen,this.rows.length);}if(this.isTreeMode&&this.mcStatus){this.replacingStartRowIdx=this.mcStatus.replacingStartRowIdx;this.needReplaceCount=this.mcStatus.needReplaceCount;this.lastFirstRowIdxOnScrn=this.mcStatus.lastFirstRowIdxOnScrn;this.dockedHeaderStatus=this.mcStatus.dockedHeaderStatus;this.lastScrollPosition=this.mcStatus.lastScrollPosition;}},storeMCStatus:function storeMCStatus(noNeedToStoreScrollInfo){this.mcStatus={};if(this.isTreeMode){this.mcStatus.expandToLevel=this.expandToLevel||-1;this.mcStatus.expandedEntryArray=[];if(this.mcStatus.expandToLevel<0){this.addTreeNodeToExpanedEntry(this.tree.childrenTreeNodeList,[]);}this.mcStatus.currSelectedObj=[];for(var i=0;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];this.mcStatus.currSelectedObj[i]=treeNode&&treeNode.id;}if(!noNeedToStoreScrollInfo){this.mcStatus.dHRowIdxList=[];var dHRows=this.dockedHeaderRows;for(var i=0;i<dHRows.length;i++){this.mcStatus.dHRowIdxList.push(dHRows[i].rowIdx);}this.mcStatus.dHReplaceRowIdxList=[];var dHRows=this.dockedHeaderReplaceRows;for(var i=0;i<dHRows.length;i++){this.mcStatus.dHReplaceRowIdxList.push(dHRows[i].rowIdx);}this.mcStatus.replacingStartRowIdx=this.replacingStartRowIdx;this.mcStatus.needReplaceCount=this.needReplaceCount;this.mcStatus.lastFirstRowIdxOnScrn=this.lastFirstRowIdxOnScrn;this.mcStatus.dockedHeaderStatus=this.dockedHeaderStatus;this.mcStatus.lastScrollPosition=this.lastScrollPosition;}}if(!noNeedToStoreScrollInfo){this.mcStatus.startCnt=this.startCnt;this.mcStatus.endCnt=this.endCnt;this.mcStatus.firstRowIdxOnScrn=this.firstRowIdxOnScrn;var chart=this.getChartWithScrollBar();this.mcStatus.scrollTo=chart&&chart._scroller.origin||{x:0,y:0};}if(this.enableSmoothScroll&&this._scroller&&this._scroller.origin){this.mcStatus.hScrollPos=this._scroller.origin.x/this.rightWidth;}if(this.controller&&this.controller.view&&this.controller.view.model){this.controller.view.model.mcStatus=this.mcStatus;}},addTreeNodeToExpanedEntry:function addExpanedEntry(treeNodeList,parentEntry){var expEntryArray=this.mcStatus.expandedEntryArray;var treeNodeCount=treeNodeList.length;for(var i=0;i<treeNodeCount;i++){var treeNode=treeNodeList[i];if(treeNode.needExpand){var expandedEntry=$HASH.clone(parentEntry);expandedEntry.push({element:treeNode.id});expEntryArray.push(expandedEntry);this.addTreeNodeToExpanedEntry(treeNode.childrenTreeNodeList,expandedEntry);}}},unrender:function unrender(ignoreDom,noNeedToStoreScrollInfo){console.log("in unrender");if(!this.mcStatus){this.storeMCStatus(noNeedToStoreScrollInfo);}this.destroyChartWidget();if(this._super){this._super(ignoreDom);}},refresh:function refresh(){this.unrender(null,true);this.render();},initScroller:function initScroller(scroller){if(this._super){this._super(scroller);}if(this.enableSmoothScroll){this._scrollDoneListener=this._scroller.attachEventListener("scrollDone",this.id,function(){this.updateScrollBarPosition();var scrl=this._scroller;if(scrl){scrl.toggleScrollBars(false);}});}},updateScrollBarPosition:function updateScrollBarPosition(){var scroller=this._rightChart&&this._rightChart._scroller;var scrollBar=scroller&&scroller._scrollBarEls&&scroller._scrollBarEls.y;if(scrollBar){scrollBar.style.left=(this._scroller.origin.x+this.getWidth()-this.leftWidth-9)+"px";}scroller=this._scroller;scrollBar=scroller&&scroller._scrollBarEls&&scroller._scrollBarEls.x;if(scrollBar){scrollBar.style.top=(this.chartTableHeight+this._leftChart.headerTableOffsetHeight-9)+"px";}},onScrollDone:function onScrollDone(evt){var scrl=this.getChartWithScrollBar()._scroller;scrl.toggleScrollBars(false);if(this.partialRender){this.firstRowIdxOnScrn=parseInt(this.startCnt+evt.y/this.rowOffsetHeight);if((this.firstRowIdxOnScrn-this.startCnt<=this.pageSize&&this.firstRowIdxOnScrn>=this.pageSize)||this.endCnt-1-this.firstRowIdxOnScrn<=this.pageSize&&this.endCnt!=this.rows.length){this.reRenderChartWhenScrollDone(scrl.origin);setChartTableHeight.call(this);}}},onScrollMoved:function onScrollMoved(evt){hideTooltipGlobal.call(this);if(this.isTreeMode){if(hasScrollDownPast(evt.y)){this._leftChart.hideDockedHeader();if(this._rightChart){this._rightChart.hideDockedHeader();}}else{this._leftChart.showDockedHeader();if(this._rightChart){this._rightChart.showDockedHeader();}}var rowOffsetHeight=this.rowOffsetHeight;this.firstRowIdxOnScrn=this.startCnt+parseInt(evt.y/rowOffsetHeight);var currPos=evt.y;var lastPos=this.lastScrollPosition.y;if(lastPos>currPos){while((lastPos-=rowOffsetHeight)>currPos){this.updateDockedHeadersByOneRow(lastPos,true);}this.updateDockedHeadersByOneRow(currPos);}else{while((lastPos+=rowOffsetHeight)<currPos){this.updateDockedHeadersByOneRow(lastPos,true);}this.updateDockedHeadersByOneRow(currPos);}}},initDockedHeaders:function initDockedHeaders(){this._leftChart.initDHs();if(this._rightChart){this._rightChart.initDHs();}this.clearDockedHeader();var rowIdx=0;var rowIdxList=[];var currRow=getRowAtIdx.call(this,rowIdx);while(currRow&&currRow.treeNode.needExpand){rowIdxList.push(rowIdx);currRow=getRowAtIdx.call(this,++rowIdx);}this.addRowsToDH(rowIdxList);this.lastFirstRowIdxOnScrn=rowIdx;this.lastScrollPosition={x:0,y:0};this.dockedHeaderStatus=NO_REPLACE;},clearDockedHeader:function clearDockedHeader(){this.removeRowsFromDH(this.dockedHeaderRows.length);this.removeChildrenForDHReplaceTable();},reBuildDH:function reBuildDH(level){this.clearDockedHeader();var rows=this.rows;var rowIdxToCheck=this.firstRowIdxOnScrn+level;if(rowIdxToCheck<0||rowIdxToCheck>=rows.length){return ;}var treeNodeToCheck=rows[rowIdxToCheck].treeNode;if(treeNodeToCheck.level>level){var rowIdxList=[];for(var i=0;i<=level;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}this.addRowsToDH(rowIdxList);}else{if(treeNodeToCheck.level==level){var rowIdxList=[];for(var i=0;i<level;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}rowIdxList.push(treeNodeToCheck.rowIdx);this.addRowsToDH(rowIdxList);}else{if(treeNodeToCheck.level<level){var preSiblingTreeNode=getPreSiblingTreeNode(this.tree,treeNodeToCheck.treePath);while(!preSiblingTreeNode){rowIdxToCheck--;var treeNodeToCheck=rows[rowIdxToCheck].treeNode;preSiblingTreeNode=getPreSiblingTreeNode(this.tree,treeNodeToCheck.treePath);}var rowIdxList=[];for(var i=0;i<treeNodeToCheck.level;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}rowIdxList.push(preSiblingTreeNode.rowIdx);var dHCount=treeNodeToCheck.rowIdx-this.firstRowIdxOnScrn;rowIdxToCheck--;var treeNodeToCheck=rows[rowIdxToCheck].treeNode;for(var i=rowIdxList.length;i<dHCount;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}this.addRowsToDH(rowIdxList);}}}this.dockedHeaderStatus=NO_REPLACE;},updateDockedHeadersByOneRow:function updateDHBOR(yPos,onlyUpdateStatus){var scroller=this.getChartWithScrollBar()._scroller;if(!scroller.vScroll||yPos>scroller.offset.y.end||yPos<0){return ;}var lastDockedHeaderRow;var currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);this.firstRowIdxOnScrn=currFirstRow.rowIdx-this.dockedHeaderRows.length;if(this.dockedHeaderStatus==IN_REPLACE){var hasReplacedRowCount=this.firstRowIdxOnScrn-this.replacingStartRowIdx;if(hasReplacedRowCount>=0){if(hasReplacedRowCount<this.needReplaceCount){lastDockedHeaderRow=this.dockedHeaderRows[this.dockedHeaderRows.length-1];if(this.firstRowIdxOnScrn>this.lastFirstRowIdxOnScrn){this.removeChildrenForDHReplaceTable();this.shiftDockedHeaderWithRow(0,onlyUpdateStatus);if(lastDockedHeaderRow){this.removeRowsFromDH(1,true);}}else{if(this.firstRowIdxOnScrn<this.lastFirstRowIdxOnScrn){this.dockedHeaderStatus=NO_REPLACE;this.moveRowFromDHRplcTableToDH();currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);}}this.shiftDockedHeaderWithRow(-currFirstRow.pastOffset,onlyUpdateStatus);}else{this.dockedHeaderStatus=NO_REPLACE;this.removeChildrenForDHReplaceTable();this.shiftDockedHeaderWithRow(0,onlyUpdateStatus);currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);}}else{this.dockedHeaderStatus=NO_REPLACE;this.moveRowFromDHRplcTableToDH();currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);}}if(this.dockedHeaderStatus==NO_REPLACE&&currFirstRow.treeNode){var currLevel=currFirstRow.treeNode.level;lastDockedHeaderRow=this.dockedHeaderRows[this.dockedHeaderRows.length-1];var lastLevel=lastDockedHeaderRow?lastDockedHeaderRow.treeNode.level:-1;if(yPos>this.lastScrollPosition.y){if(currLevel<=lastLevel){if(lastDockedHeaderRow){this.removeRowsFromDH(1,true);}this.replacingRowTreeNode=currFirstRow.treeNode;this.replacingStartRowIdx=this.firstRowIdxOnScrn;this.needReplaceCount=lastLevel-currLevel+1;this.dockedHeaderStatus=IN_REPLACE;this.shiftDockedHeaderWithRow(-currFirstRow.pastOffset,onlyUpdateStatus);}else{if(currLevel>lastLevel){var currRowIdx=currFirstRow.rowIdx;var rowIdxList=[];var currRowTreeNode=currFirstRow.treeNode;while(currRowTreeNode.needExpand){rowIdxList.push(currRowIdx);currRowTreeNode=getRowAtIdx.call(this,++currRowIdx).treeNode;}this.addRowsToDH(rowIdxList);}}}else{if(yPos<this.lastScrollPosition.y){if(currLevel==lastLevel){var addedTreeNode=currFirstRow.treeNode.preSibling;var currRowIdx=currFirstRow.rowIdx;var rowCount=0;while(!addedTreeNode){rowCount++;currFirstRow=getRowAtIdx.call(this,--currRowIdx);addedTreeNode=currFirstRow&&currFirstRow.treeNode.preSibling;}this.removeRowsFromDH(rowCount);lastDockedHeaderRow=this.dockedHeaderRows[this.dockedHeaderRows.length-1];if(lastDockedHeaderRow){this.removeRowsFromDH(1);}if(addedTreeNode.needExpand){var rowIdxList=[addedTreeNode.rowIdx];this.addRowsToDH(rowIdxList,true);}else{}this.replacingStartRowIdx=this.firstRowIdxOnScrn;this.replacingRowTreeNode=addedTreeNode;this.needReplaceCount=1;this.dockedHeaderStatus=IN_REPLACE;var pastOffset=yPos%this.rowOffsetHeight;this.shiftDockedHeaderWithRow(-pastOffset,onlyUpdateStatus);}else{if(currLevel>lastLevel+1){var addedTreeNode=getParentTreeNodeAtLevel(this.tree,currFirstRow.treeNode.treePath,lastLevel+1);var rowIdxList=[addedTreeNode.rowIdx];this.addRowsToDH(rowIdxList,true);this.replacingStartRowIdx=this.firstRowIdxOnScrn;this.replacingRowTreeNode=addedTreeNode;this.needReplaceCount=currLevel-lastLevel-1;this.dockedHeaderStatus=IN_REPLACE;this.shiftDockedHeaderWithRow(-currFirstRow.pastOffset,onlyUpdateStatus);}}}}}this.lastScrollPosition.y=yPos;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;},checkParentBeforeAddToDH:function checkParentBeforeAddToDH(addedRowIdx){var rowInfo=this.rows[addedRowIdx];var treeNode=rowInfo&&rowInfo.treeNode;var rowCount=this.dockedHeaderRows.length;if(rowCount!=treeNode.level){}},addRowsToDH:function addRowsToDH(rowIdxList,toDHReplacingTable){var rows=this.rows;var rowCount=rowIdxList.length;if(rowCount<=0){return ;}var addTo=null;if(toDHReplacingTable){addTo=this.dockedHeaderReplaceRows;}else{addTo=this.dockedHeaderRows;}for(var i=0;i<rowCount;i++){var rowIdx=rowIdxList[i];var rowInfo=rows[rowIdx];addTo.push({rowIdx:rowIdx,treeNode:rowInfo.treeNode,rowRef:this.popFromReusePool()});}this._leftChart.addRowsToDH(rowCount,toDHReplacingTable);if(this._rightChart){this._rightChart.addRowsToDH(rowCount,toDHReplacingTable);}},removeRowsFromDH:function removeRowsFromDH(rowCount,moveToReplacingTable){if(this._leftChart){this._leftChart.removeRowsFromDH(rowCount,moveToReplacingTable);}if(this._rightChart){this._rightChart.removeRowsFromDH(rowCount,moveToReplacingTable);}if(rowCount>this.dockedHeaderRows.length){rowCount=this.dockedHeaderRows.length;}for(;rowCount>0;rowCount--){var row=this.dockedHeaderRows.pop();if(!moveToReplacingTable){this.pushRowRefToReusePool(row);}else{this.dockedHeaderReplaceRows.push(row);}}},moveRowFromDHRplcTableToDH:function moveRowFromDHRplcTableToDH(){this._leftChart.moveRowFromDHRplcTableToDH();if(this._rightChart){this._rightChart.moveRowFromDHRplcTableToDH();}this.shiftDockedHeaderWithRow(0);var row=this.dockedHeaderReplaceRows.pop();if(row){this.dockedHeaderRows.push(row);}},removeChildrenForDHReplaceTable:function removeChildrenForDHReplaceTable(){if(this._leftChart){this._leftChart.removeChildrenForDHReplaceTable();}if(this._rightChart){this._rightChart.removeChildrenForDHReplaceTable();}var rowCount=this.dockedHeaderReplaceRows.length;for(;rowCount>0;rowCount--){var row=this.dockedHeaderReplaceRows.pop();this.pushRowRefToReusePool(row);}},pushRowRefToReusePool:function pushRowRefToReusePool(row){if(!row){return ;}var rowRef=row.rowRef;this.rowsReusePool.push(rowRef);row.rowRef={};},shiftDockedHeaderWithRow:function shiftDockedHeaderWithRow(pastOffset,onlyUpdateStatus){if(onlyUpdateStatus){return ;}if(this._leftChart){this.utils.translateCSS(0,pastOffset,0,this._leftChart.dockedHeaderReplaceDiv.firstChild);}if(this._rightChart){this.utils.translateCSS(0,pastOffset,0,this._rightChart.dockedHeaderReplaceDiv.firstChild);}},init:function init(props){this._super(props);},initFromVisProps:function(vp){initProp.call(this);var propValue=vp?vp:{},sparklineProps=this.sparklineProps,barProps=this.barProps,bulletProps=this.bulletProps,otherProps=this.otherProps;this.isTreeMode=getBoolValue(propValue.itd);if(propValue.lsh){sparklineProps.mbShow=(propValue.lsh==="true");}if(propValue.lap){sparklineProps.mbAllPoints=(propValue.lap==="true");}if(propValue.lep){sparklineProps.mbEndPoints=(propValue.lep==="true");}if(propValue.lrl){sparklineProps.mbRefLine=(propValue.lrl==="true");}if(propValue.lra){sparklineProps.mbRefArea=(propValue.lra==="true");}if(propValue.lmsh){sparklineProps.mbAssMetric=(propValue.lmsh==="true");}if(propValue.let){sparklineProps.mbShowTooltip=(propValue.let==="true");}if(propValue.llsc){sparklineProps.mwSeriesLineCol=convertToColor(propValue.llsc);}if(propValue.lrlc){sparklineProps.mwRefLineCol=convertToColor(propValue.lrlc);}if(propValue.lrac){sparklineProps.mwRefAreaCol=convertToColor(propValue.lrac);}if(propValue.lh){sparklineProps.mstrHeader=propValue.lh;}if(propValue.lam){sparklineProps.mstrAssMetric=propValue.lam;}if(propValue.bsg){barProps.mbShow=(propValue.bsg==="true");}if(propValue.bl){barProps.mbShowLegend=(propValue.bl==="true");}if(propValue.brl){barProps.mbRefLine=(propValue.brl==="true");}if(propValue.bet){barProps.mbShowTooltip=(propValue.bet==="true");}if(propValue.bpv){barProps.mwPosCol=convertToColor(propValue.bpv);}if(propValue.bnv){barProps.mwNegCol=convertToColor(propValue.bnv);}if(propValue.brlc){barProps.mwRefLineCol=convertToColor(propValue.brlc);}if(propValue.bh){barProps.mstrHeader=propValue.bh;}if(propValue.gsh){bulletProps.mbShow=(propValue.gsh==="true");}if(propValue.grl){bulletProps.mbRefLine=(propValue.grl==="true");}if(propValue.gra){bulletProps.mbRefBands=(propValue.gra==="true");}if(propValue.gl){bulletProps.mbShowLegend=(propValue.gl==="true");}if(propValue.gmsh){bulletProps.mbAssMetric=(propValue.gmsh==="true");}if(propValue.gia){bulletProps.mbInvertAxis=(propValue.gia==="true");}if(propValue.get){bulletProps.mbShowTooltip=(propValue.get==="true");}if(propValue.gmm){bulletProps.mfMinValue=parseFloat(propValue.gmm);}if(propValue.ggc){bulletProps.mwPosCol=convertToColor(propValue.ggc);}if(propValue.gnv){bulletProps.mwNegCol=convertToColor(propValue.gnv);}if(propValue.grlc){bulletProps.mwRefLineCol=convertToColor(propValue.grlc);}if(propValue.gpc){bulletProps.mwBand1=convertToColor(propValue.gpc);}if(propValue.grc){bulletProps.mwBand2=convertToColor(propValue.grc);}if(propValue.gsc){bulletProps.mwBand3=convertToColor(propValue.gsc);}if(propValue.gh){bulletProps.mstrHeader=propValue.gh;}if(propValue.gtam){bulletProps.mstrAssMetric=propValue.gtam;}if(propValue.glt){bulletProps.mstrBand1=propValue.glt;}if(propValue.gmt){bulletProps.mstrBand2=propValue.gmt;}if(propValue.ght){bulletProps.mstrBand3=propValue.ght;}if(propValue.wa){var value=parseFloat(propValue.wa);if(propValue.wa.indexOf("%")){value/=100;}otherProps.mfBkgOpacity=value;}if(propValue.metkpi){otherProps.mnMetricsPerKPI=parseInt(propValue.metkpi);}if(propValue.hch){otherProps.mbHideColHeaders=(propValue.hch==="true");}if(propValue.htc){otherProps.mbHideTextColumns=(propValue.htc==="true");}if(propValue.ll){otherProps.mbLockLayout=(propValue.ll==="true");}if(propValue.gam){otherProps.mbShowForHiddenGraphs=(propValue.gam==="true");}if(propValue.igf){otherProps.mbInheritFromGridGraph=(propValue.igf==="true");}if(propValue.scm){otherProps.mbInSingleColumnMode=(propValue.scm==="true");}if(propValue.cid){otherProps.mpColumnIDs=propValue.cid.split(",");}if(propValue.tcid){otherProps.mpColumnIDsInTreeMode=propValue.tcid.split(",");}if(propValue.co){otherProps.mpColumnPositions=propValue.co.split(",");}if(propValue.sc){otherProps.mpSortKey=propValue.sc;}if(propValue.so){otherProps.mbSortDescend=(propValue.so!=="false");}if(propValue.rh){otherProps.mRowHeight=parseFloat(propValue.rh);}otherProps.mRowHeight=otherProps.mRowHeight>27?otherProps.mRowHeight:27;setDimensionWithDPI.call(this);},preBuildRendering:function preBR(){console.log("in preb in MC");if(this._super){this._super();}var m=this.model;if(!m){m.err=mstrmojo.desc(8426,"No model provided");return ;}this.isAndroidTab=$D.isAndroid?!!mstrApp.isTablet():false;this.isAndroidPhone=$D.isAndroid&&!this.isAndroidTab;var propValue=m.vp||{};var isReport=this.controller&&(this.controller instanceof mstrmojo.android.controllers.XtabController);var fullScreen=this.isFullScreenWidget||isReport;this.enableSmoothScroll=(this.isAndroidPhone&&fullScreen)?true:getBoolValue(propValue.ss);if(propValue.mcs){this.metricColumnsSpacing=parseInt(propValue.mcs);}else{this.metricColumnsSpacing=this.isAndroidPhone?(mstrApp.isLandscape()?NORMAL:COMPACT):-1;}if(this.enableSmoothScroll){this.leftWidth=this.getWidth()/3;this.rightWidth=this.getWidth()/3*2;}else{this.leftWidth=this.getWidth();this.rightWidth=0;this.scrollerConfig.hScroll=false;}},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res=eval(s);return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},buildRows:function buildRows(){if(this.rowsNeedRebuild){if(this.isTreeMode){this.rows=getTreeNodeRows.call(this);}else{buildNonTreeRows.call(this);}this.rowsNeedRebuild=false;}},pushToReusePool:function pushToReusePool(beginCnt,endCnt){var bCnt=beginCnt!=undefined?beginCnt:this.startCnt;var eCnt=endCnt!=undefined?endCnt:this.endCnt;var rowInfo=null;for(var i=bCnt;i<eCnt;i++){rowInfo=this.rows[i];this.rowsReusePool.push(rowInfo.rowRef);rowInfo.rowRef={};}},popFromReusePool:function popFromReusePool(){var rowRef=this.rowsReusePool.pop();return rowRef||{};},reRenderChart:function reRenderChart(scrollTo,rowCount,adjustOffsetY){this.pushToReusePool();this.buildRows();var rowOffsetHeight=this.rowOffsetHeight;if(!rowCount){rowCount=0;}this.firstRowIdxOnScrn=parseInt(this.startCnt+scrollTo.y/rowOffsetHeight)-rowCount;this.getCurrRenderRowCount();if(adjustOffsetY==undefined){adjustOffsetY=scrollTo.y%rowOffsetHeight;}scrollTo.y=(this.firstRowIdxOnScrn-this.startCnt)*rowOffsetHeight+adjustOffsetY;this.lastScrollPosition.y=scrollTo.y;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;var rows=this.rows;for(var i=this.startCnt;i<this.endCnt;i++){rows[i].rowRef=this.popFromReusePool();}if(!this.enableSmoothScroll){this._leftChart.reRenderRows(scrollTo);}else{this._leftChart.reRenderRows(scrollTo);this._rightChart.reRenderRows(scrollTo);}},reRenderChartWhenScrollDone:function reRenderChartwsd(scrollTo){var oldStartCnt=this.startCnt;var oldEndCnt=this.endCnt;var rowOffsetHeight=this.rowOffsetHeight;this.firstRowIdxOnScrn=parseInt(this.startCnt+scrollTo.y/rowOffsetHeight);this.getCurrRenderRowCount();var firstRowToRemove,lastRowToRemove,firstRowToRender,lastRowToRender;if(this.startCnt<oldEndCnt&&this.startCnt>oldStartCnt){firstRowToRemove=oldStartCnt;lastRowToRemove=this.startCnt;firstRowRemain=this.startCnt;lastRowRemain=oldEndCnt;firstRowToRender=oldEndCnt;lastRowToRender=this.endCnt;}else{if(oldStartCnt<this.endCnt&&oldStartCnt>this.startCnt){firstRowToRemove=this.endCnt;lastRowToRemove=oldEndCnt;firstRowRemain=oldStartCnt;lastRowRemain=this.endCnt;firstRowToRender=this.startCnt;lastRowToRender=oldStartCnt;}else{firstRowToRemove=oldStartCnt;lastRowToRemove=oldEndCnt;firstRowRemain=0;lastRowRemain=0;firstRowToRender=this.startCnt;lastRowToRender=this.endCnt;}}this.pushToReusePool(firstRowToRemove,lastRowToRemove);scrollTo.y=(this.firstRowIdxOnScrn-this.startCnt)*rowOffsetHeight+scrollTo.y%rowOffsetHeight;this.lastScrollPosition.y=scrollTo.y;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;var rows=this.rows;for(var i=firstRowToRender;i<lastRowToRender;i++){rows[i].rowRef=this.popFromReusePool();}if(!this.enableSmoothScroll){this._leftChart.reRenderRows(scrollTo,firstRowRemain,lastRowRemain,firstRowToRender,lastRowToRender);}else{this._leftChart.reRenderRows(scrollTo,firstRowRemain,lastRowRemain,firstRowToRender,lastRowToRender);this._rightChart.reRenderRows(scrollTo,firstRowRemain,lastRowRemain,firstRowToRender,lastRowToRender);}},reRenderChartWithAnchor:function reRenderChartWithAnchor(anchorRowTreeNode,anchorRowIdxOnScrn){this.pushToReusePool();this.buildRows();var rowOffsetHeight=this.rowOffsetHeight;var anchorRowIdx=-1;for(var i=0;i<this.rows.length;i++){if(this.rows[i].treeNode.treePath==anchorRowTreeNode.treePath){anchorRowIdx=i;break;}}this.firstRowIdxOnScrn=anchorRowIdx-anchorRowIdxOnScrn;if(this.firstRowIdxOnScrn<0){this.firstRowIdxOnScrn=0;}this.getCurrRenderRowCount();scrollTo.y=(this.firstRowIdxOnScrn-this.startCnt)*rowOffsetHeight;this.lastScrollPosition.y=scrollTo.y;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;var rows=this.rows;for(var i=this.startCnt;i<this.endCnt;i++){rows[i].rowRef=this.popFromReusePool();}if(!this.enableSmoothScroll){this._leftChart.reRenderRows(scrollTo);}else{this._leftChart.reRenderRows(scrollTo);this._rightChart.reRenderRows(scrollTo);}},supportsIncFetch:false,pageSize:0,getCurrRenderRowCount:function getCRRC(){var maxRenderRowCount=this.pageSize*PAGE_COUNT;if(this.rows.length<=maxRenderRowCount){this.partialRender=false;this.startCnt=0;this.endCnt=this.rows.length;}else{this.partialRender=true;this.startCnt=Math.round(this.firstRowIdxOnScrn-this.pageSize*(PAGE_COUNT-1)/2);if(this.startCnt<0){this.startCnt=0;}this.endCnt=this.startCnt+maxRenderRowCount;if(this.endCnt>this.rows.length){this.endCnt=this.rows.length;}}},getChartWithScrollBar:function(){if(this.enableSmoothScroll){return this._rightChart;}else{return this._leftChart;}},updateWindowRatio:function updateWindowRatio(){var chart=this.getChartWithScrollBar(),scroller=chart._scroller;scroller.chartTableRenderRatio=(this.endCnt-this.startCnt)/this.rows.length;scroller.topUnRenderedRatio=this.startCnt/this.rows.length;chart.updateScroller();},initValues:function initValues(){this.prevSelected={mrow:-2,mcol:-1};if(this.isTreeMode){initTree.call(this);}this.treeColumnIdx=-1;this.minPageSize=Math.ceil((this.getHeight()/this.otherProps.mRowHeight)*3/PAGE_COUNT);this.pageSize=this.minPageSize;this.rowsNeedRebuild=true;this.rows=[];this.dockedHeaderRows=[];this.dockedHeaderReplaceRows=[];this.rowsReusePool=[];this.unselectedRemainCells=[];this.errorMsg.style.display="none";},postBuildRendering:function postBR(){var me=this,model=me.model;var err=model.err||model.eg;if(err){me.renderErrorMessage(err);return ;}if(me.controller&&me.controller.view&&me.controller.view.model){if(!me.mcStatus&&me.controller.view.model.mcStatus){me.mcStatus=me.controller.view.model.mcStatus;}}me.initValues();me.highlightEntireRow=me.isTreeMode||me.isAllAttrSelectable;getUITheme.call(me);convertDataToModels.call(me);if(me.otherProps.mbInheritFromGridGraph){me.selectedClass="sc_"+me.model.k;}else{me.selectedClass="";}err=model.err||model.eg;if(err){me.renderErrorMessage(err);return ;}if(this._super){this._super();}me.renderLegend();me.getCurrRenderRowCount();me.restoreMCStatus();if(!me.enableSmoothScroll){me.itemsContainerNode.style.display="none";var props={placeholder:me.leftChart,colInfos:me.colInfos,theme:me.theme,isTreeMode:me.isTreeMode,showMinLabel:me.showMinLabel,width:me.leftWidth+"px",height:(me.getHeight()-me.legendHeight)+"px",textSpan:me.textSpan,textCanvas:me.textCanvas,headerCssClass:me.headerCssClass,valueCssClass:me.valueCssClass,isAndroidTab:me.isAndroidTab,widget:me,treeColumnIdx:me.treeColumnIdx,backgroundColor:me.backgroundColor,domRefName:LEFT_CHART_ROW,showScrollbars:true};var w=new mstrmojo.VisMicroChartTable(props);w.render();me._leftChart=w;w.parent=me;me.replaceScrollerUpdate(w);}else{var props={placeholder:me.leftChart,colInfos:me.colInfos.slice(0,this.attrColumnCount),theme:me.theme,isTreeMode:me.isTreeMode,showMinLabel:me.showMinLabel,width:me.leftWidth+"px",height:(me.getHeight()-me.legendHeight)+"px",textSpan:me.textSpan,textCanvas:me.textCanvas,headerCssClass:me.headerCssClass,valueCssClass:me.valueCssClass,isAndroidTab:me.isAndroidTab,widget:me,treeColumnIdx:me.treeColumnIdx,backgroundColor:me.backgroundColor,domRefName:LEFT_CHART_ROW,showScrollbars:false,zIndex:1};var w=new mstrmojo.VisMicroChartTable(props);w.render();me._leftChart=w;w.parent=me;me.leftChart=w.domNode;var props={placeholder:me.rightChart,colInfos:me.colInfos.slice(this.attrColumnCount),theme:me.theme,isTreeMode:me.isTreeMode,showMinLabel:me.showMinLabel,width:me.rightWidth+"px",height:(me.getHeight()-me.legendHeight)+"px",textSpan:me.textSpan,textCanvas:me.textCanvas,headerCssClass:me.headerCssClass,valueCssClass:me.valueCssClass,isAndroidTab:me.isAndroidTab,widget:me,treeColumnIdx:me.treeColumnIdx,backgroundColor:me.backgroundColor,domRefName:RIGHT_CHART_ROW,showScrollbars:true};var w2=new mstrmojo.VisMicroChartTable(props);w2.render();me._rightChart=w2;w2.parent=me;me.rightChart=w2.domNode;me.replaceScrollerUpdate(w2);if(this.theme==DEFAULT_LIGHT_THEME||this.theme==CUSTOM_LIGHT_THEME){me.dropShadowDiv.style.backgroundImage="-webkit-gradient(linear, left top, right top, color-stop(0, rgba(0,0,0,0.25)), color-stop(1, rgba(0,0,0,0)))";}else{me.dropShadowDiv.style.backgroundImage="-webkit-gradient(linear, left top, right top, color-stop(0, rgba(0,0,0,0.5)), color-stop(1, rgba(0,0,0,0)))";}w2.addSyncScroller(w);w.addSyncScroller(w2);me.scrollerConfig.scrollEl=me.rightChart;me.updateScroller();var scrollTo=null;if(this.mcStatus&&this.mcStatus.hScrollPos!=undefined){var xPos=Math.min(this.mcStatus.hScrollPos*this.rightWidth,this.rightWidth+this.leftWidth-this.getWidth());scrollTo=this._scroller.origin={x:xPos,y:0};}setScrollerPosition.call(me,scrollTo);var headerHeight=Math.max(me._leftChart.headerTableOffsetHeight,me._rightChart.headerTableOffsetHeight);me._leftChart.headerTable.style.height=headerHeight+"px";me._rightChart.headerTable.style.height=headerHeight+"px";me._leftChart.updateHeaderTableOffsetH();me._rightChart.updateHeaderTableOffsetH();}me.rowOffsetHeight=(me.otherProps.mbHideTextColumns&&this.enableSmoothScroll)?w2.rowOffsetHeight:w.rowOffsetHeight;if(me.isTreeMode){if(me.mcStatus&&me.mcStatus.dHRowIdxList){me._leftChart.initDHs();if(me._rightChart){me._rightChart.initDHs();}me.addRowsToDH(me.mcStatus.dHRowIdxList);if(me.mcStatus.dHReplaceRowIdxList.length>0){me.addRowsToDH(me.mcStatus.dHReplaceRowIdxList,true);var pastOffset=me.mcStatus.scrollTo.y%me.rowOffsetHeight;me.shiftDockedHeaderWithRow(-pastOffset);}}else{me.initDockedHeaders();}}me.removeMCStatus();me.getDefaultHighlightRow();me.updateSelectedStatus(me.tree);me.updateHighlightForCurrRenderRows();me.chartTableMaxHeight=me.getHeight()-me._leftChart.headerTableOffsetHeight;if(me.legendDis){me.chartTableMaxHeight-=me.legendHeight;}me.pageSize=Math.max(Math.min(parseInt(me.chartTableMaxHeight/me.rowOffsetHeight)+1,20),me.minPageSize);setChartTableHeight.call(me);var xtabModel=me.xtabModel,docModel=(xtabModel&&xtabModel.docModel);if(docModel){me._infoWClosedListener=me.xtabModel.docModel.attachEventListener("infoWindowClosed",this.id,function(evt){var infoWindowK=evt.psKey;if(!me.hasNonifwTarget&&me.selectorTargets&&me.selectorTargets[infoWindowK]){window.setTimeout(function(){if(me.isTreeMode){var treeNode=me.lastSelectedObj[me.lastSelectedObj.length-1];if(treeNode&&treeNode.treePath){me.closedIfwAttr=treeNode.treePath;me.currSelectedObj=[];me.updateSelectedStatus(me.tree);me.updateHighlightForCurrRenderRows();me.lastSelectedObj=[];}}else{if(me.isAllAttrSelectable){me.closedIfwAttr=me.prevSelected.mrow;me.clearPreHighlightRowStatus();me.updateUnselectedRemainCells();me.updateSelectedStatus(me.tree);me.updateHighlightForCurrRenderRows();}else{var mcol=me.prevSelected&&me.prevSelected.mcol;var id=me.colInfos[mcol]&&me.colInfos[mcol].order;id=id.split(":")[0];me.closedIfwAttr=id;var ctlMatrix=me.ctlMatrix[id];var ctlMatrixCG=me.ctlMatrix[id+":CG"];var selectedIdxBackup=ctlMatrix.selectedIdx;var selectedIdxCGBackup=ctlMatrixCG&&ctlMatrixCG.selectedIdx;ctlMatrix.selectedIdx={};if(ctlMatrixCG){ctlMatrixCG.selectedIdx={};}me.updateSelectedStatus();me.updateHighlightForCurrRenderRows();ctlMatrix.selectedIdx=selectedIdxBackup;if(ctlMatrixCG){ctlMatrixCG.selectedIdx=selectedIdxCGBackup;}}}},10);}});}this.renderTextTooltip();},renderTextTooltip:function renderTextTooltip(){var props={placeholder:this.textTooltip,boundary:this.domNode};this._textTooltip=new mstrmojo.VisTextTooltip(props);this._textTooltip.render();this._textTooltip.toggle(false);},replaceScrollerUpdate:function replaceScrollerUpdate(chartTable){chartTable._scroller.updateScrollBars=function updateScrollBars(viewportCoords,scrollBarContainerElement){var scrollEl=this.scrollEl;if(!this.showScrollbars||!scrollEl){return ;}var bars=this._scrollBarEls;var chartTableRenderRatio=this.chartTableRenderRatio||1;var topUnRenderedRatio=this.topUnRenderedRatio||0;if(!bars){var me=this;bars=this._scrollBarEls={x:"hScroll",y:"vScroll"};$forEachHash(bars,function(scroll,axis){if(me[scroll]){var bar=document.createElement("div");bar.className="mstrmojo-touch-scrollBar "+axis+"Axis";(scrollBarContainerElement||scrollEl.parentNode).appendChild(bar);bars[axis]=bar;}else{delete bars[axis];}});}if(!viewportCoords){var parentNode=this.scrollEl.parentNode;viewportCoords={top:0,right:parentNode.clientWidth,bottom:parentNode.clientHeight,left:0};}var offset=9,scrollBarCoords={x:{left:viewportCoords.left,top:viewportCoords.bottom-offset,x:viewportCoords.right-viewportCoords.left,d:"Width"},y:{left:viewportCoords.right-offset,top:viewportCoords.top,x:viewportCoords.bottom-viewportCoords.top,d:"Height"}};var me=this;$forEachHash(bars,function(bar,axis){var barStyle=bar.style,coords=scrollBarCoords[axis],dimension=coords.d,parentNode=bar.parentNode,x=coords.x;var left=coords.left,top=coords.top+x*topUnRenderedRatio,ratio=x/scrollEl["offset"+dimension]*chartTableRenderRatio,length=Math.min(Math.round(x*ratio),x);bar.baseLeft=left;bar.baseTop=top;bar.ratio=ratio;bar.viewportSize=$M.round(x*chartTableRenderRatio);bar.length=length;barStyle.left=left+"px";barStyle.top=top+"px";barStyle[dimension.toLowerCase()]=length+"px";var isX=(axis==="x"),direction=isX?"hScroll":"vScroll";if(me[direction]){var origin=me.origin,position=origin&&origin[axis]||0,viewportSize=bar.viewportSize,minScale=6/length,minPosition=bar["base"+((isX)?"Left":"Top")],maxPosition=minPosition+viewportSize-length,newPosition=$M.round(minPosition+(ratio*position));if(newPosition<minPosition){newPosition=minPosition-position;length+=position;}else{if(newPosition>maxPosition){var delta=(position-me.offset[axis].end)*ratio;newPosition=$M.min(maxPosition+delta,viewportSize+minPosition-6)-1;length-=delta;}}var v=0,translate=[v,v,v],scale=[1,1,1],idx=(isX)?0:1;translate[idx]=(newPosition-minPosition);scale[idx]=$M.min($M.max(length/bar.length,minScale),1);$D.translate(bar,translate[0],translate[1],translate[2]," scale3d("+scale.join(",")+")");}});};},setElementDimension:function setElementDimension(e,width){var paddingWidth=0;var compStyle=mstrmojo.css.getComputedStyle(e);if(compStyle.paddingLeft){paddingWidth+=parseFloat(compStyle.paddingLeft);}if(compStyle.paddingRight){paddingWidth+=parseFloat(compStyle.paddingRight);}e.style.width=(width-paddingWidth)+"px";},setColorByTheme:function setColorByTheme(){var bulletProps=this.bulletProps;if(this.theme==DEFAULT_DARK_THEME){this.bandColor1="#494949";this.bandColor2="#595959";this.bandColor3="#727272";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=2;this.blueBarPosColor="#00BDFF";this.blueBarNegColor="#00BDFF";}else{if(this.theme==DEFAULT_LIGHT_THEME){this.bandColor1="#A5A5A5";this.bandColor2="#B3B3B3";this.bandColor3="#C4C4C4";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=2;this.blueBarPosColor="#00BDFF";this.blueBarNegColor="#00BDFF";}else{this.bandColor1=bulletProps.mwBand1||"#999999";this.bandColor2=bulletProps.mwBand2||"#BBBBBB";this.bandColor3=bulletProps.mwBand3||"#DEDEDE";this.refLinePosColor=bulletProps.mwRefLineCol;this.refLineNegColor=bulletProps.mwRefLineCol;this.blueBarPosColor=bulletProps.mwPosCol;this.blueBarNegColor=bulletProps.mwNegCol;}}},renderLegend:function renderLgd(){var bulletProps=this.bulletProps;this.setColorByTheme();this.legendDis=this.showGauge&&this.bulletProps.mbShowLegend;if(this.legendDis){this.legend.className+=" "+this.valueCssClass;this.legend.style.display="block";this.legend.style.fontSize=Math.round(11*zf)+"pt";this.setElementDimension(this.legend,this.getWidth());if(bulletProps.mstrBand1){this.legendLowFont.innerHTML=bulletProps.mstrBand1;}this.legendLowBand.style.backgroundColor=this.bandColor1;if(bulletProps.mstrBand2){this.legendMidFont.innerHTML=bulletProps.mstrBand2;}this.legendMidBand.style.backgroundColor=this.bandColor2;if(bulletProps.mstrBand3){this.legendHighFont.innerHTML=bulletProps.mstrBand3;}this.legendHighBand.style.backgroundColor=this.bandColor3;var lowWidth=this.legendLow.offsetWidth,midWidth=this.legendMid.offsetWidth,highWidth=this.legendHigh.offsetWidth;if(lowWidth+midWidth+highWidth>this.getWidth()){if(lowWidth+midWidth>this.getWidth()){this.legendLow.style.width=this.width;if(midWidth+highWidth>this.getWidth()){this.legendMid.style.width=this.width;this.legendHigh.style.width=this.width;}else{this.legendMid.style.width=(this.getWidth()-highWidth)+"px";}}else{this.legendLow.style.width=(this.getWidth()-midWidth)+"px";this.legendHigh.style.width=this.width;}}this.legendHeight=this.legend.firstChild.offsetHeight;this.legend.style.height=this.legendHeight+"px";}else{this.legend.style.display="none";this.legendHeight=0;}},showChartTooltip:function showChartTooltip(touchedChart,touch){var me=this;var wasNoTooltip=this.tooltip.style.display==="none"||!(this.tooltip.style.display);touchedChart.showTooltip(touch.pageX,touch.pageY);var nowHasTooltip=this.tooltip.style.display==="block";this.tooltipShow=nowHasTooltip;if(wasNoTooltip&&nowHasTooltip){var touchManager=mstrmojo.touchManager;this._touchListener=touchManager.attachEventListener("touchesBegin",this.id,function(evt){if(!isTouchedOnWidget.call(me,evt.touch)){hideTooltipGlobal.call(me,evt.touch);}});}},touchSelectBegin:function touchSelectBegin(touch){if(touch.evt.ctrlKey){this.touchMultiBegin(touch);return ;}var me=this;hideTooltipGlobal.call(me);var td=mstrmojo.dom.findAncestorByAttr(touch.target,"mcol",true,this.domNode);if(td&&td.node){var mrow=td.node.getAttribute("mrow");var mcol=td.node.getAttribute("mcol");if(mrow==-1){this.showTextTooltip(td.node,mcol,true);}else{var tr=td.node.parentNode;var rowInfo=null;if(tr.getAttribute("rowType")==DOCKED_HEADER){var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,mrow);if(dockedHeaderIdx>=0){rowInfo=this.dockedHeaderRows[dockedHeaderIdx];}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,mrow);rowInfo=this.dockedHeaderReplaceRows[dockedHeaderIdx];}}else{rowInfo=this.rows[mrow];}var colInfo=this.colInfos[mcol];if(colInfo.type==CHART){var touchedChart=rowInfo&&rowInfo.rowRef&&rowInfo.rowRef[mcol];if(touchedChart){this.showChartTooltip(touchedChart,touch);this.currSelectedWidget={mrow:mrow,mcol:mcol};}}else{if(colInfo.type==ATTR_NAME||colInfo.type==METRIC_VALUE||colInfo.type==METRIC_NAME){this.showTextTooltip(td.node,mcol);}}}}},showTextTooltip:function showTextTooltip(e,mcol,onHeader){if(onHeader){var colInfo=this.colInfos[mcol],text=colInfo.title;if(colInfo.titleOverflow&&this._textTooltip){this._textTooltip.updateContent(e,onHeader?"title":"content",text);}}else{var text=e.innerText;var tmpLength=this.getTextWidthByCanvas(text,e,true);if(tmpLength>e.offsetWidth&&this._textTooltip){this._textTooltip.updateContent(e,onHeader?"title":"content",text);}}},hideTextTooltip:function hideTextTooltip(){if(this._textTooltip){this._textTooltip.toggle(false);}},touchSelectEnd:function touchSelectEnd(touch){if(touch.evt.ctrlKey){this.touchMultiEnd(touch);return ;}this.currSelectedWidget=null;this.hideTextTooltip();},touchSelectMove:function touchSelectMove(touch){if(touch.evt.ctrlKey){this.touchMultiMove(touch);return ;}if(!this.currSelectedWidget){return ;}this.tooltip.style.display="none";var target=touch.target;var mcol=-1,colInfo=null;var targetFound=true;var td=mstrmojo.dom.findAncestorByAttr(target,"mcol",true,this.domNode);td=td&&td.node;if(td){mcol=td.getAttribute("mcol");colInfo=this.colInfos[mcol];if(colInfo.order=="GaugeChart"){targetFound=false;}}else{targetFound=false;}if(targetFound===false){target=document.elementFromPoint(touch.pageX,touch.pageY);td=mstrmojo.dom.findAncestorByAttr(target,"mcol",true,this.domNode);td=td&&td.node;if(!td){return ;}mcol=td.getAttribute("mcol");colInfo=this.colInfos[mcol];}var mrow=td.getAttribute("mrow");var tr=td.parentNode;var rowInfo=null;if(tr.getAttribute("rowType")==DOCKED_HEADER){var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,mrow);if(dockedHeaderIdx>=0){rowInfo=this.dockedHeaderRows[dockedHeaderIdx];}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,mrow);rowInfo=this.dockedHeaderReplaceRows[dockedHeaderIdx];}}else{rowInfo=this.rows[mrow];}var touchedChart=rowInfo&&rowInfo.rowRef&&rowInfo.rowRef[mcol];var tooltipShown;if(touchedChart){if(colInfo.order=="LineChart"||colInfo.order=="BarChart"){if(mrow==this.currSelectedWidget.mrow&&mcol==this.currSelectedWidget.mcol){tooltipShown=touchedChart.showTooltip(touch.pageX,touch.pageY);this.currSelectedWidget={mrow:mrow,mcol:mcol};}}else{if(mcol==this.currSelectedWidget.mcol&&mrow!=this.currSelectedWidget.mrow){tooltipShown=touchedChart.showTooltip(touch.pageX,touch.pageY);this.currSelectedWidget={mrow:mrow,mcol:mcol};}}}if(tooltipShown){this.tooltipShow=true;}console.log("tooltip show:"+this.tooltipShow);if(this.tooltipShow){this.tooltip.style.display="block";}},touchSwipeBegin:function touchSwipeBegin(touch){hideTooltipGlobal.call(this);if(isScrollableElementTouched.call(this,touch)&&this._super){this._super(touch);}else{this._touchCanceled=true;}},touchSwipeMove:function touchSwipeMove(touch){if(!this._touchCanceled&&this._super){this._super(touch);}},touchSwipeEnd:function touchSwipeEnd(touch){if(!this._touchCanceled&&this._super){this._super(touch);}},getColIdx:function getColIdx(order){var colInfos=this.colInfos,colCount=colInfos.length;for(var i=0;i<colCount;i++){var target=colInfos[i].order.split(":")[0];if(target+":CG"==colInfos[i].order){target=target+":CG";}if(order==target){return colInfos[i].colIdx||i;}}return -1;},buildLeftParent:function buildLeftParent(node,mrow,mcol){var colInfos=this.colInfos,colCount=colInfos.length;if(!this.isKPI){if(mrow==-1){var gts=this.model.gts;var metricIndex=mstrmojo.array.find(gts.col,"n","Metrics");node._e=gts.col[metricIndex].es[colInfos[mcol].order]||{id:"",n:""};node.v=node._e.n;}else{var rows=this.model.gts.row;var currNode=node;for(var i=colCount-1;i>=0;i--){var colInfo=colInfos[i];if(colInfo.type==CHART){continue;}if(colInfo.type==ATTR_NAME){var nodeLP={};var index=mstrmojo.array.find(rows,"id",colInfo.order.split(":")[0]);nodeLP.titleInfo=rows[index];nodeLP._e=this.rows[mrow].model.elms[colInfo.order]||{id:"",n:""};nodeLP.v=nodeLP._e.n;nodeLP.axis=ROW_AXIS;currNode._lp=nodeLP;currNode=nodeLP;}}}}else{if(mcol==0){var gts=this.model.gts;var metricIndex=mstrmojo.array.find(gts.col,"n","Metrics");node._e=gts.col[metricIndex].es[mrow]||{id:"",n:""};node.v=node._e.n;}else{var rows=this.model.gts.row;var currNode=node;for(var i=0;i<rows.length;i++){var nodeLP={};nodeLP.titleInfo=rows[i];var idx=rows[i].es.length;nodeLP._e=rows[i].es[idx-1]||{id:"",n:""};nodeLP.v=nodeLP._e.n;nodeLP.axis=ROW_AXIS;currNode._lp=nodeLP;currNode=nodeLP;}}}},getModelK:function getModelK(){var k=this.model&&this.model.k;return k;},addSCObjToList:function addSCObjToList(scObjList,rowH,n,id){var scObj={};scObj.sc=rowH.sc;scObj.es=n;scObj.eid=id;scObjList.push(scObj);},getSelectionObjForTreeMode:function getSelectionObjForTreeMode(touchedObj){var attrIdxArray=this.attrMapIdx;var me=this,model=me.model,gts=model.gts,rows=gts.row;var scObjList=[];var actionType=0;var selectedAll=false;var treeNode=touchedObj.treeNode;var treePath=treeNode.treePath;var treePathArray=treePath.split("_");var treeLevel=treePathArray.length-1;var isAttrSelectable=this.isAttrSelectable(treeLevel);if(this.closedIfwAttr==treePath){return null;}if(isAttrSelectable){var isTappedNodeSelected=this.lastSelectedObj&&this.lastSelectedObj[treeLevel]&&(this.lastSelectedObj[treeLevel].treePath==treePath);if(!isTappedNodeSelected){this.currSelectedObj=this.getSelectedTreeNodeListFromTreePath(treePathArray);var useFirstAttr=false;var parentTreeNode=this.currSelectedObj[treeLevel];for(var i=treeLevel+1;i<this.lastSelectedObj.length;i++){var thisLevelSelectable=this.isAttrSelectable(i);var thisLevelSelected=!!this.lastSelectedObj[i];if(!thisLevelSelectable||!thisLevelSelected){useFirstAttr=true;this.currSelectedObj[i]=null;parentTreeNode=parentTreeNode.childrenTreeNodeList[0];continue;}if(!useFirstAttr){var attrID=this.lastSelectedObj[i].id;var treeNodeList=parentTreeNode.childrenTreeNodeList;for(var j=0;j<treeNodeList.length;j++){if(attrID==treeNodeList[j].id){this.currSelectedObj[i]=treeNodeList[j];break;}}if(j==treeNodeList.length){useFirstAttr=true;}}if(useFirstAttr){this.currSelectedObj[i]=parentTreeNode.childrenTreeNodeList[0];}parentTreeNode=this.currSelectedObj[i];}selectedAll=false;for(var i=0;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(treeNode){var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];this.addSCObjToList(scObjList,rowH,treeNode.n,treeNode.id);}else{continue;}}}else{for(var i=treeLevel;i<this.lastSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(!treeNode){continue;}var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];var unselectable=rowH.sc&&!(rowH.sc.all==="false"||rowH.sc.all===false);if(treeNode&&!unselectable){break;}else{this.addSCObjToList(scObjList,rowH,treeNode.n,"OA:(All)");this.currSelectedObj[i]=null;}}if(i==treeLevel){return{at:0};}while(this.currSelectedObj.length>0&&!this.currSelectedObj[this.currSelectedObj.length-1]){this.currSelectedObj.pop();}for(;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(treeNode){var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];this.addSCObjToList(scObjList,rowH,treeNode.n,treeNode.id);}else{continue;}}selectedAll=true;}}if(scObjList.length>0){actionType=actionType|SELECTOR_ACTION;var hasInfoWOnNode=this.hasInfoWOnNode(rows[attrIdxArray[treeLevel]]);var anchorNode=selectedAll?null:hasInfoWOnNode?touchedObj.node:null;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}return null;},hasInfoWOnNode:function hasInfoWOnNode(rowH,onlyIfW){var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel);if(docModel){var layouts=docModel.defn&&docModel.defn.layouts,layout=null;var i;if(layouts){for(i in layouts){if(layouts[i].loaded){layout=layouts[i];break;}}}var units=layout&&layout.units;if(units&&rowH){var tksList=rowH.sc.tks.split("\x1E");for(var j=0;j<tksList.length;j++){var unit=units[tksList[j]];if(unit){if(this.isChildOfIfw(units,unit)){if(!onlyIfW){return true;}}else{if(onlyIfW){return false;}}}}}}return onlyIfW?true:false;},getSelectionObjForNonTreeMode:function getSelectionObjForNonTreeMode(touchedObj){var mcol=touchedObj.mcol,mrow=touchedObj.mrow,colInfos=this.colInfos;var attrIdxArray=this.attrMapIdx;var me=this,model=me.model,gts=model.gts,rows=gts.row;var scObjList=[];var actionType=0;var selectedAll=false;var id=colInfos[mcol].order;if(this.isAllAttrSelectable){id=id.split(":")[0];var hasTapRemainCell=this.updateUnselectedRemainCells({mrow:mrow,mcol:mcol});if(hasTapRemainCell){return null;}if(mrow==this.prevSelected.mrow){if(mrow>=0){for(var key in this.ctlMatrix){var obj=this.ctlMatrix[key];if(!obj.sc||!obj.sc.tks){continue;}if(obj.sc.all==="false"||obj.sc.all===false){var i=0;var colInfos=this.colInfos;var colCount=colInfos.length;for(;i<colCount;i++){if(key==colInfos[i].order.split(":")[0]){break;}}this.unselectedRemainCells.push({mrow:mrow,mcol:i});continue;}var selectedIdx=obj.map[mrow];var elementId=obj.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){continue;}selectedAll=true;this.addSCObjToList(scObjList,obj,"","OA:(All)");}if(scObjList.length>0){this.clearPreHighlightRowStatus();this.prevSelected={mrow:-2,mcol:-1};this.updateUnselectedRemainCells();actionType=actionType|SELECTOR_ACTION;var anchorNode=selectedAll?null:touchedObj.node;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}else{this.unselectedRemainCells=[];}return{at:actionType};}}else{this.updateUnselectedRemainCells();this.unselectedRemainCells=[];}if(touchedObj.mrow==-1){}else{if(this.ctlMatrix){this.clearPreHighlightRowStatus();for(var key in this.ctlMatrix){var obj=this.ctlMatrix[key];if(!obj.sc){continue;}if(!obj.sc.tks||(obj.sc.tks=="")){continue;}var selectedIdx=obj.map[mrow];if(obj.es[selectedIdx]){var elementId=obj.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){continue;}this.addSCObjToList(scObjList,obj,"",elementId);}}if(scObjList.length>0){this.rows[mrow].selected[-1]=true;this.prevSelected={mrow:mrow,mcol:-1};actionType=actionType|SELECTOR_ACTION;var anchorNode=selectedAll?null:touchedObj.node;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}}}}else{var isCG=false;if(id.indexOf(":CG")===id.length-3&&id.length>=3){isCG=true;}id=id.split(":")[0];if(this.ctlMatrix&&this.ctlMatrix[id]){var ctlMatrix=this.ctlMatrix[id];var ctlMatrixCG=this.ctlMatrix[id+":CG"];if(ctlMatrix.sc&&ctlMatrix.sc.tks!=""){var elementId="";var isAll=false;if(mrow==-1){}else{var selectedIdx=ctlMatrix.map[mrow];if(ctlMatrix.es[selectedIdx]){elementId=ctlMatrix.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){return ;}}var sameAsLastSelected=function(){var result=ctlMatrix.selectedIdx[selectedIdx];if(ctlMatrixCG){if(ctlMatrixCG.selectedIdx[-1]){return result;}else{return result&&ctlMatrixCG.selectedIdx[ctlMatrixCG.map[mrow]];}}return result;};if(sameAsLastSelected()){var canSelectAll=!(ctlMatrix.sc.all==="false"||ctlMatrix.sc.all===false);if(canSelectAll){elementId="OA:(All)";selectedAll=true;ctlMatrix.selectedIdx={};if(ctlMatrixCG){ctlMatrixCG.selectedIdx={};}this.prevSelected={mrow:-2,mcol:-1};}else{return null;}}else{ctlMatrix.selectedIdx={};ctlMatrix.selectedIdx[selectedIdx]=true;if(ctlMatrixCG){ctlMatrixCG.selectedIdx={};if(isCG){ctlMatrixCG.selectedIdx[ctlMatrixCG.map[mrow]]=true;if(ctlMatrixCG.map[mrow]<ctlMatrixCG.es.length){elementId=ctlMatrixCG.es[ctlMatrixCG.map[mrow]].id;}}else{ctlMatrixCG.selectedIdx[-1]=true;}}this.prevSelected={mrow:mrow,mcol:mcol};}}var scObj={};scObj.sc=ctlMatrix.sc;scObj.eid=elementId;scObjList.push(scObj);}}if(scObjList.length>0){actionType=actionType|SELECTOR_ACTION;var anchorNode=selectedAll?null:touchedObj.node;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}}return null;},getLinkDrillObjForTreeMode:function getLinkDrillObjForTreeMode(touchedObj){var actionType=0;var linkDrillNode=null;var model=this.model,gts=model.gts,rowHs=gts.row;var mcol=touchedObj.mcol,mrow=touchedObj.mrow,colInfos=this.colInfos;var treeNode=touchedObj.treeNode;var treePath=treeNode.treePath;var treePathArray=treePath.split("_");var treeLevel=treePathArray.length-1;var attrIdxArray=this.attrMapIdx;var id=null;var colInfo=colInfos[mcol];var colType=colInfo&&colInfo.type;if(colType==ATTR_NAME){if(mrow==-1){}else{var rowH=rowHs[attrIdxArray[treeLevel]];if(rowH.lm&&rowH.lm[0]&&rowH.lm[0].links){linkDrillNode={};linkDrillNode.titleInfo=rowH;var treeNode=getTreeNode(this.tree,treePath);linkDrillNode._e=treeNode.es[0]||{n:"",id:""};linkDrillNode.v=linkDrillNode._e.n;}}}else{if(colType==METRIC_VALUE){if(colInfo.lm){id=colInfo.order;var mix=parseInt(id);var metricH=gts.col[0];if(metricH){linkDrillNode={};linkDrillNode.mix=mix;linkDrillNode.titleInfo=metricH;if(mrow==-1){linkDrillNode._e=metricH.es[mix]||{n:"",id:""};linkDrillNode.v=linkDrillNode._e.n;}else{var currNode=linkDrillNode;var treeNode=this.tree;for(var i=0;i<treePathArray.length;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];var attrIdx=attrIdxArray[i];rowH=rowHs[attrIdx];var nodeLP={};nodeLP.titleInfo=rowH;nodeLP._e=treeNode.es[0]||{n:"",id:""};nodeLP.v=nodeLP._e.n;currNode._lp=nodeLP;currNode.axis=ROW_AXIS;currNode=nodeLP;}}}}}}if(linkDrillNode){this.highlightEntireRow=false;actionType=actionType|HYPERLINK_ACTION;return{at:actionType,k:this.getModelK(),node:linkDrillNode};}},getLinkDrillObjForNonTreeMode:function getLinkDrillObjForNonTreeMode(touchedObj){var actionType=0;var model=this.model,gts=model.gts,rowHs=gts.row;var mcol=touchedObj.mcol,mrow=touchedObj.mrow,colInfos=this.colInfos;var node=touchedObj.node,titleInfo;this.highlightEntireRow=false;var attrIdxArray=this.attrMapIdx;var colInfo=colInfos[mcol];if(!this.isKPI){if(linkCount===1&&attrCount===1&&mrow!=-1){for(var key in colInfos){var colInf=colInfos[key];if(colInf.lm&&colInf.type==ATTR_NAME){this.highlightEntireRow=true;var titleInfo=colInf.lm;actionType=titleInfo&&titleInfo.at||HYPERLINK_ACTION;node._e=this.rows[mrow].model.elms[colInf.order]||{id:"",n:""};node.v=node._e.n;break;}}}if(!this.highlightEntireRow){if(colInfo.type==CHART){return null;}var titleInfo=colInfo.lm;if(titleInfo){actionType=titleInfo&&titleInfo.at;if(colInfo.type==ATTR_NAME){if(mrow===-1){node._e={};node._e.onTitle=true;node._e.id=titleInfo.id;node._e.n=titleInfo.n;node.v=titleInfo.n;}else{node._e=this.rows[mrow].model.elms[colInfo.order]||{id:"",n:""};node.v=node._e.n;}}else{if(colInfo.type==METRIC_VALUE){node.mix=colInfo.order;node.axis=ROW_AXIS;this.buildLeftParent(node,mrow,mcol);actionType=this.rows[mrow==-1?0:mrow].model.refv[colInfo.order].at||HYPERLINK_ACTION;}}}}}else{if(colInfo.type==CHART){return null;}var titleInfo=colInfo.lm;var metricIdx=this.rows[mrow].model.metricIdx;if(titleInfo&&titleInfo.lm&&titleInfo.lm[metricIdx]&&titleInfo.lm[metricIdx].links){node.mix=""+metricIdx;node.axis=ROW_AXIS;this.buildLeftParent(node,metricIdx,mcol);actionType=this.rows[mrow].model.refv[0].at||HYPERLINK_ACTION;}else{titleInfo=null;}}if(titleInfo){node.titleInfo=titleInfo;actionType=actionType|HYPERLINK_ACTION;return{at:actionType,mcol:mcol,mrow:mrow,k:this.getModelK(),node:node};}return null;},getActionObj:function getActionObj(touchedObj){var actionObjList=[];if(touchedObj.mrow==-1){return null;}var actionObj=null;if(this.isTreeMode){actionObj=this.getSelectionObjForTreeMode(touchedObj);}else{actionObj=this.getSelectionObjForNonTreeMode(touchedObj);}if(actionObj){actionObjList.push(actionObj);return actionObjList;}else{if(this.isTreeMode){actionObj=this.getLinkDrillObjForTreeMode(touchedObj);}else{actionObj=this.getLinkDrillObjForNonTreeMode(touchedObj);}actionObjList.push(actionObj);}return actionObjList;},getDefaultHighlightRow:function getDHR(){var attrIdxArray=this.attrMapIdx;var rows=this.model.gts.row;if(!this.isTreeMode){if(this.isAllAttrSelectable){var isAllSelected=false;var resultSet=null,controlMatrix=null;var hasOnlyIfwTarget=true;var colInfos=this.colInfos,colCount=colInfos.length;for(var i=0;i<colCount;i++){var colInfo=colInfos[i],id=colInfo.order;var trueId=id.split(":")[0];if(id!=trueId+":CG"){id=trueId;}controlMatrix=this.ctlMatrix[id];if(controlMatrix){if(!this.hasInfoWOnNode(controlMatrix,true)){hasOnlyIfwTarget=false;}if(controlMatrix.selectedIdx[-1]){isAllSelected=true;this.prevSelected={mrow:-1,mcol:i};}else{colInfo.selected=false;}if(!isAllSelected){if(!resultSet){resultSet={};for(var j=0;j<controlMatrix.map.length;j++){if(controlMatrix.selectedIdx[controlMatrix.map[j]]){resultSet[j]=true;}}}else{for(var j in resultSet){if(!controlMatrix.selectedIdx[controlMatrix.map[j]]){delete resultSet[j];}}}}}}if(hasOnlyIfwTarget){for(key in this.ctlMatrix){var obj=this.ctlMatrix[key];obj.selectedIdx={};}}if(hasOnlyIfwTarget||isAllSelected||!resultSet||Object.keys(resultSet).length!==1){}else{console.log("xiawang: The selected row is:"+JSON.stringify(resultSet));var selectedRow=parseInt(Object.keys(resultSet)[0]);this.prevSelected={mrow:selectedRow,mcol:-1};if(this.rows[selectedRow]){this.rows[selectedRow].selected[-1]=true;}for(key in this.ctlMatrix){var obj=this.ctlMatrix[key];obj.selectedIdx={};}}}else{var hasOnlyIfwTarget=true;for(key in this.ctlMatrix){var controlMatrix=this.ctlMatrix[key];var checkThisAttr=false;for(var sIdx in controlMatrix.selectedIdx){checkThisAttr=true;}if(checkThisAttr&&!this.hasInfoWOnNode(controlMatrix,true)){hasOnlyIfwTarget=false;break;}}if(hasOnlyIfwTarget){for(key in this.ctlMatrix){var obj=this.ctlMatrix[key];obj.selectedIdx={};}}}}else{if(this.currSelectedObj&&this.currSelectedObj.length<=0){var resultSet=null,controlMatrix=null;this.currSelectedObj=[];var findTreeNodeByAttrElemIdx=function(treeNodeList,attrElemIdx){var treeNodeCount=treeNodeList.length;for(var i=0;i<treeNodeCount;i++){var treeNode=treeNodeList[i];if(treeNode.attrElemIdx==attrElemIdx){return treeNode;}}return null;};var me=this;var findCurrSelectedObjByAttrElemIdx=function(tree,level){var id=me.attrIDArray[level];controlMatrix=me.ctlMatrix[id];var treeNodeList=tree.childrenTreeNodeList;var treeNodeCount=treeNodeList.length;if(treeNodeCount<=0){return ;}var treeNode=null;if(controlMatrix){for(var key in controlMatrix.selectedIdx){treeNode=findTreeNodeByAttrElemIdx(treeNodeList,key);}if(treeNode){me.currSelectedObj[level]=treeNode;findCurrSelectedObjByAttrElemIdx(treeNode,level+1);return true;}}else{me.currSelectedObj[level]=null;for(var i=0;i<treeNodeCount;i++){var find=findCurrSelectedObjByAttrElemIdx(treeNodeList[i],level+1);if(find){return true;}}}return false;};findCurrSelectedObjByAttrElemIdx(this.tree,0);while(this.currSelectedObj.length>0&&!this.currSelectedObj[this.currSelectedObj.length-1]){this.currSelectedObj.pop();}var hasOnlyIfwTarget=true;for(var i=0;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(treeNode){var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];if(!this.hasInfoWOnNode(rowH,true)){hasOnlyIfwTarget=false;break;}}else{continue;}}if(hasOnlyIfwTarget){this.currSelectedObj=[];}this.lastSelectedObj=$HASH.clone(this.currSelectedObj);return ;}}},updateSelectedStatus:function updateSS(tree){if(this.isTreeMode){this.updateTreeSelection(tree);}else{if(!this.isAllAttrSelectable||this.unselectedRemainCells.length>0){if(!this.ctlMatrix){return ;}var update=function(key){var pureId=key.split(":")[0],ctlMatrix=this.ctlMatrix[pureId],ctlMatrixCG=this.ctlMatrix[pureId+":CG"];var colInfos=this.colInfos,selectedIdx=ctlMatrix.selectedIdx,colIdx=ctlMatrix.colIdx;if(ctlMatrixCG&&!ctlMatrixCG.selectedIdx[-1]){ctlMatrix=ctlMatrixCG;}var map=ctlMatrix.map,rows=this.rows,rowCount=rows.length,selectedIdx=ctlMatrix.selectedIdx,colIdx=this.ctlMatrix[key].colIdx,assAttr=colInfos[colIdx].associateAttr;for(var i=0;i<rowCount;i++){var rowInfo=rows[i];if(selectedIdx[map[i]]){rowInfo.selected[colIdx]=true;for(var idx in assAttr){rowInfo.selected[assAttr[idx]]=true;}}else{rowInfo.selected[colIdx]=false;for(var idx in assAttr){rowInfo.selected[assAttr[idx]]=false;}}}};for(var key in this.ctlMatrix){update.call(this,key);}}}},hasOnlyInfoWindowTarget:function hasOnlyInfoWindowTarget(){},performAction:function performAction(actionObjList){this.hasNonifwTarget=this.hasNoninfowindowTarget(actionObjList[0]);if(this._super){this._super(actionObjList);}},clearPreHighlightRowStatus:function clearPreHighlightRowStatus(pass){var mrow=this.prevSelected.mrow,mcol=this.prevSelected.mcol;if(mrow==-2){return ;}if(mcol==-1){this.rows[mrow].selected[-1]=false;}else{if(mrow==-1){for(var i=0;i<this.colInfos.length;i++){var colInfo=this.colInfos[i];if(colInfo.selected){colInfo.selected=false;}}}else{this.rows[mrow].selected[mcol]=false;}}},updateUnselectedRemainCells:function uurc(tappedCell){var hasTapRemainCell=false;for(var i=this.unselectedRemainCells.length-1;i>=0;i--){cell=this.unselectedRemainCells[i];var id=order[cell.mcol];var isCG=false;if(id.indexOf(":CG")===id.length-3&&id.length>=3){isCG=true;}else{id=id.split(":")[0];}var obj=this.ctlMatrix[id];var anotherObj=undefined;if(isCG){anotherObj=this.ctlMatrix[id.split(":")[0]];}else{anotherObj=this.ctlMatrix[id+":CG"];}if(obj.sc&&obj.sc.tks!=""){if(anotherObj&&!anotherObj.sc){anotherObj=undefined;}var selectedIdx=obj.map[cell.mrow];elementId=obj.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){continue;}else{if(obj.selectedIdx[selectedIdx]){if(tappedCell){if(cell.mcol==tappedCell.mcol){var tappedID=order[cell.mcol].split(":")[0];var tappedCtlMatrix=this.ctlMatrix[tappedID];var tappedIdx=tappedCtlMatrix.sc&&tappedCtlMatrix.map[tappedCell.mrow];if(tappedIdx==selectedIdx){hasTapRemainCell=true;}}continue;}obj.selectedIdx={};}else{obj.selectedIdx={};obj.selectedIdx[selectedIdx]=true;if(anotherObj){if(elementId.indexOf("BE")===0||elementId.indexOf("Z")===0){}else{anotherObj.selectedIdx={};anotherObj.selectedIdx[selectedIdx]=true;}}}}}}return hasTapRemainCell;},highlightCellsByRowInfo:function highlightCellsByRowInfo(rowInfo){var rowRef=rowInfo.rowRef;if(!rowRef){return ;}var trL=rowRef[LEFT_CHART_ROW];var trR=rowRef[RIGHT_CHART_ROW];var tdsL=trL&&trL.childNodes;var tdsR=trR&&trR.childNodes;var tdsLLen=tdsL&&tdsL.length||0,tdsRLen=tdsR&&tdsR.length||0;var colCount=tdsLLen+tdsRLen;for(var i=0;i<colCount;i++){var td=i<tdsLLen?tdsL[i]:tdsR[i-tdsLLen];if(rowInfo.selected[i]){this.highlightCell(td);}else{this.unHighlightCell(td);}}},setSelectedStyle:function setSelectedStyle(level){if(level==0){this.selectedStyle="background-color:#015DE6;color:#FFFFFF;";}else{if(level==1){this.selectedStyle="background-color:rgba(1,93,230, 0.7);color:#FFFFFF;";}else{this.selectedStyle="background-color:rgba(1,93,230, 0.5);color:#FFFFFF;";}}},highlightTreeArrow:function highlightTreeArrow(rowInfo){if(this.treeColumnIdx>-1&&this._leftChart){this._leftChart.setTreeArrow(rowInfo,"white");}},unHighlightTreeArrow:function unHighlightTreeArrow(rowInfo){if(this.treeColumnIdx>-1&&this._leftChart){this._leftChart.setTreeArrow(rowInfo);}},highlightCell:function highlightCell(td,isHeaderTable){if(isHeaderTable){setNodeCssText(td,TH_SELECTED_CSS+this.selectedStyle);}else{setNodeCssText(td,TD_SELECTED_CSS+this.selectedStyle);}if(this.selectedClass&&this.selectedClass.length>0){$CSS.addClass(td,this.selectedClass);}},unHighlightCell:function unHighlightCell(td,isHeaderTable){if(isHeaderTable){setNodeCssText(td,DEFAULT_TH_CSS);}else{setNodeCssText(td,DEFAULT_TD_CSS);}if(this.selectedClass&&this.selectedClass.length>0){$CSS.removeClass(td,this.selectedClass);}},highlightForLD:function highlightForLD(mrow,mcol,node){if(this.highlightEntireRow&&!this.isTreeMode){this.highlightRowByRowInfo(this.rows[mrow]);}else{if(node){this.highlightCell(node);}var colInfo=this.colInfos[mcol],aAttr=colInfo.associateAttr;var siblings=node.parentNode.childNodes;for(var idx in aAttr){this.highlightCell(siblings[aAttr[idx]]);if(this.treeColumnIdx==idx){this.highlightTreeArrow(this.rows[mrow]);}}}},highlightRowByRowInfo:function highlightRowByRowInfo(rowInfo){var rowRef=rowInfo.rowRef;if(!rowRef){return ;}var level=rowInfo.treeNode?rowInfo.treeNode.level:0;this.setSelectedStyle(level);if(rowRef[LEFT_CHART_ROW]){this.highlightRow(rowRef[LEFT_CHART_ROW]);}if(rowRef[RIGHT_CHART_ROW]){this.highlightRow(rowRef[RIGHT_CHART_ROW]);}this.highlightTreeArrow(rowInfo);},highlightRow:function highlightRow(tr){var tds=tr.childNodes;for(var i=0;i<tds.length;i++){setNodeCssText(tds[i],TD_SELECTED_CSS+this.selectedStyle);if(this.selectedClass&&this.selectedClass.length>0){$CSS.addClass(tds[i],this.selectedClass);}}},unHighlightRowByRowInfo:function unHighlightRowByRowInfo(rowInfo){var rowRef=rowInfo.rowRef;if(!rowRef){return ;}if(rowRef[LEFT_CHART_ROW]){this.unHighlightRow(rowRef[LEFT_CHART_ROW]);}if(rowRef[RIGHT_CHART_ROW]){this.unHighlightRow(rowRef[RIGHT_CHART_ROW]);}this.unHighlightTreeArrow(rowInfo);},unHighlightRow:function unHighlightRow(tr){var tds=tr.childNodes;for(var i=0;i<tds.length;i++){setNodeCssText(tds[i],DEFAULT_TD_CSS);if(this.selectedClass&&this.selectedClass.length>0){$CSS.removeClass(tds[i],this.selectedClass);}}},isAttrSelectable:function isAttrSelectable(treeLevel){var attrID=this.attrIDArray[treeLevel];var ctlMatrix=this.ctlMatrix[attrID];if(ctlMatrix){return true;}return false;},updateTreeSelection:function updateTreeSelection(tree){this.selectOrClearTreeNodes(tree,true,0);this.selectOrClearTreeNodes(tree,false,0);},findTheTreeNodeWithSameID:function findTheTreeNodeWithSameID(treeNodeList,id){var treeNodeCount=treeNodeList.length;for(var i=0;i<treeNodeCount;i++){var treeNode=treeNodeList[i];if(treeNode.id==id){return treeNode;}}return null;},selectOrClearTreeNodes:function selectOrClearTreeNodes(treeNode,clear,treeLevel){if(!treeNode){return ;}if(clear&&this.lastSelectedObj.length<=treeLevel){return ;}if(!clear&&this.currSelectedObj.length<=treeLevel){return ;}var tappedTreeNode=null;if(clear){tappedTreeNode=this.lastSelectedObj[treeLevel];}else{tappedTreeNode=this.currSelectedObj[treeLevel];}var treeNodeList=treeNode.childrenTreeNodeList,treeNodeCount=treeNodeList.length;if(tappedTreeNode){treeNode=this.findTheTreeNodeWithSameID(treeNodeList,tappedTreeNode.id);if(treeNode){treeNode.selected=clear?false:true;this.selectOrClearTreeNodes(treeNode,clear,treeLevel+1);}}else{for(var i=0;i<treeNodeCount;i++){this.selectOrClearTreeNodes(treeNodeList[i],clear,treeLevel+1);}}},updateHighlightForCurrRenderRows:function updateHighlightForCurrRenderRows(){var rows=this.rows;var rowCount=rows.length,rowInfo=null;for(var i=this.startCnt;i<this.endCnt;i++){rowInfo=rows[i];if(this.isTreeMode){if(rowInfo.treeNode.selected){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}else{if(this.isAllAttrSelectable){if(rowInfo.selected[-1]){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}else{this.highlightCellsByRowInfo(rowInfo);}if(this.unselectedRemainCells.length>0){this.highlightCellsByRowInfo(rowInfo);}}}if(this.isTreeMode){rows=this.dockedHeaderRows;rowCount=rows.length;for(var i=0;i<rowCount;i++){rowInfo=rows[i];if(rowInfo.treeNode.selected){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}rows=this.dockedHeaderReplaceRows;rowCount=rows.length;for(var i=0;i<rowCount;i++){rowInfo=rows[i];if(rowInfo.treeNode.selected){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}}},getSelectedTreeNodeListFromTreePath:function getSelectedTreeNodeListFromTreePath(treePathArray){if(!treePathArray){return[];}var treeNodeList=[];var treeNode=this.tree;for(var i=0;i<treePathArray.length;i++){var treeNodeIdx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[treeNodeIdx];if(!treeNode){break;}if(this.isAttrSelectable(i)){treeNodeList[i]=treeNode;}else{treeNodeList[i]=null;}}return treeNodeList;},multiTap:true,touchTap:function(touch){var widget=this;if(widget.tooltip.style.display==="block"){hideTooltipGlobal.call(this);return ;}var td=mstrmojo.dom.findAncestorByAttr(touch.target,"mcol",true,this.domNode);if(!td){this._leftChart.dockedHeaderReplaceDiv.style.display="none";touch.target=document.elementFromPoint(touch.pageX,touch.pageY);td=mstrmojo.dom.findAncestorByAttr(touch.target,"mcol",true,this.domNode);this._leftChart.dockedHeaderReplaceDiv.style.display="";}if(td&&td.node){var mrow=parseInt(td.node.getAttribute("mrow"));var mcol=parseInt(td.node.getAttribute("mcol"));if(mrow==-1){return ;}if(this.isTreeMode){if(mrow>=0){var rowInfo=this.rows[mrow];var treeNode=rowInfo&&rowInfo.treeNode;if(touch.count==2||(touch.count==1&&mcol==this.treeColumnIdx)){if(!treeNode.isLeaf){this.rowsNeedRebuild=true;var rowType=td.node.parentNode.getAttribute("rowType");if(treeNode.needExpand){collapseTreeNodeAndSetScrlPos.call(this,rowInfo,rowType);}else{expandTreeNodeAndSetScrlPos.call(this,rowInfo,rowType);}}return ;}}var touchedObj={node:td.node,treeNode:treeNode,mcol:mcol,mrow:mrow};var actionObjList=this.getActionObj(touchedObj);var actionObj=actionObjList&&actionObjList[0];if(actionObj){if(actionObj.at&SELECTOR_ACTION){var doHighlight=!(this.isAndroidPhone&&actionObj.anchor);if(doHighlight){this.updateSelectedStatus(this.tree);this.updateHighlightForCurrRenderRows();this.lastSelectedObj=$HASH.clone(this.currSelectedObj);}}else{if(actionObj.at&HYPERLINK_ACTION){this.highlightForLD(mrow,mcol,td.node);}}this.performAction(actionObjList);return ;}}else{var actionObjList=this.getActionObj({mcol:mcol,mrow:mrow,node:td.node});var actionObj=actionObjList&&actionObjList[0];if(actionObj){if(actionObj.at&SELECTOR_ACTION){var doHighlight=!(this.isAndroidPhone&&actionObj.anchor);if(doHighlight){this.updateSelectedStatus();this.updateHighlightForCurrRenderRows();}}else{if(actionObj.at&HYPERLINK_ACTION){this.highlightForLD(mrow,mcol,td.node);}}this.performAction(actionObjList);return ;}}var me=this;var tr=td.node.parentNode;var rowInfo=null;if(tr.getAttribute("rowType")==DOCKED_HEADER){var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,mrow);if(dockedHeaderIdx>=0){rowInfo=this.dockedHeaderRows[dockedHeaderIdx];}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,mrow);rowInfo=this.dockedHeaderReplaceRows[dockedHeaderIdx];}}else{rowInfo=this.rows[mrow];}var touchedChart=rowInfo&&rowInfo.rowRef&&rowInfo.rowRef[mcol];if(touchedChart){this.showChartTooltip(touchedChart,touch);}}},shouldTouchBubble:function shouldTouchBubble(touch){var isVertical=touch.isVertical;return isVertical?this._super(touch):this.enableSmoothScroll&&isScrollableElementTouched.call(this,touch)?false:true;},multiTouch:true,touchMultiBegin:function(touch){hideTooltipGlobal.call(this);this.initTouchObj=touch;var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:100,pageY:100,target:touch.target};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;this.initDiffDiff=xDiff*xDiff+yDiff*yDiff;this.relScaleFactor=1;var td1=mstrmojo.dom.findAncestorByAttr(touch1.target,"mrow",true,this.domNode);var td2=mstrmojo.dom.findAncestorByAttr(touch2.target,"mrow",true,this.domNode);if(td1&&td1.value&&td2&&td2.value){this.centerRowIdx=Math.round((parseInt(td1.value)+parseInt(td2.value))/2);}else{this.centerRowIdx=this.firstRowIdxOnScrn;}},touchMultiMove:function(touch){var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:100,pageY:100};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;this.curDiffDiff=xDiff*xDiff+yDiff*yDiff;},touchMultiEnd:function(touch){if(this.isTreeMode){if(this.curDiffDiff>this.initDiffDiff){this.onPinchOpen();}else{if(this.curDiffDiff<this.initDiffDiff){this.onPinchClose();}}}},onPinchOpen:function onPinchOpen(){var currLowestLevel=getLowestLevelOnScreen.call(this);var levelToExpand=currLowestLevel;if(levelToExpand>=this.maxTreeLevel){levelToExpand=this.maxTreeLevel-1;}var anchorRowTreeNode=this.rows[this.centerRowIdx].treeNode;var anchorRowIdxOnScrn=this.centerRowIdx-this.firstRowIdxOnScrn;expandOrCollapseTreeAndSetScrlPos.call(this,levelToExpand,anchorRowTreeNode,anchorRowIdxOnScrn);},onPinchClose:function onPinchClose(){var currLowestLevel=getLowestLevelOnScreen.call(this);var levelToExpand=currLowestLevel-2;if(levelToExpand<-1){levelToExpand=-1;}var anchorRowTreeNode=this.rows[this.centerRowIdx].treeNode;if(anchorRowTreeNode.level>levelToExpand+1){anchorRowTreeNode=getParentTreeNodeAtLevel(this.tree,anchorRowTreeNode.treePath,levelToExpand+1);}var anchorRowIdxOnScrn=this.centerRowIdx-this.firstRowIdxOnScrn;expandOrCollapseTreeAndSetScrlPos.call(this,levelToExpand,anchorRowTreeNode,anchorRowIdxOnScrn);},destroyChartWidget:function destroyChartWidget(){if(this.rows&&this.rows.length>0&&this.rowsReusePool){this.pushToReusePool();}if(this.dockedHeaderRows&&this.dockedHeaderReplaceRows){this.clearDockedHeader();}if(this.rowsReusePool&&this.rowsReusePool.length>0){var rows=this.rowsReusePool,rowCount=rows.length,colInfos=this.colInfos,colCount=colInfos.length;for(var i=0;i<rowCount;i++){var rowRef=rows[i];if(rowRef[LEFT_CHART_ROW]){delete rowRef[LEFT_CHART_ROW];}if(rowRef[RIGHT_CHART_ROW]){delete rowRef[RIGHT_CHART_ROW];}for(var j=0;j<colCount;j++){var w=rowRef[colInfos[j].colIdx];if(w&&w.destroy){w.destroy();delete rowRef[colInfos[j].colIdx];}}}this.rowsReusePool=[];}},destroy:function destroy(){console.log("in destroy");var listener=this._touchListener;if(listener){mstrmojo.touchManager.detachEventListener(listener);delete this._touchListener;}if(this._infoWClosedListener){mstrmojo.touchManager.detachEventListener(this._infoWClosedListener);delete this._infoWClosedListener;}this.destroyChartWidget();if(this._leftChart){this._leftChart.destroy();delete this._leftChart;}if(this._rightChart){this._rightChart.destroy();delete this._rightChart;}if(this.rows){delete this.rows;}if(this.rowsReusePool){delete this.rowsReusePool;}if(this.selectorTargets){delete this.selectorTargets;}this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisTimeSeries");mstrmojo.AndroidVisTimeSeries=mstrmojo.declare(mstrmojo.VisTimeSeries,null,{scriptClass:"mstrmojo.AndroidVisTimeSeries"});}());(function(){mstrmojo.requiresCls("mstrmojo.VisTimeSeries");mstrmojo.DocVisTimeSeries=mstrmojo.declare(mstrmojo.VisTimeSeries,null,{scriptClass:"mstrmojo.DocVisTimeSeries"});}());(function(){mstrmojo.requiresCls("mstrmojo.DynamicClassFactory","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo.AndroidInteractiveGridXtab","mstrmojo.DocXtabModel","mstrmojo.DocInteractiveGridXtab","mstrmojo.AndroidVisTimeSeries","mstrmojo.DocVisTimeSeries","mstrmojo.VisMicroChart","mstrmojo.maps.AndroidRptMap","mstrmojo.maps.AndroidMapModel","mstrmojo.maps.AndroidDocMap","mstrmojo.ImageCarousel","mstrmojo.PhotoUploader","mstrmojo.AndroidVisMap","mstrmojo.VisHeatMap");var B={AndroidImageMapStyle:{s:"ImageMapVisualizationDataStyle",c:"AndroidVisMap"},MicroChartsVisualizationStyle:{s:"MicroChartVisualizationDataStyle",c:"VisMicroChart"},TimeSeriesAjaxVisualizationStyle:{dc:"DocVisTimeSeries",s:"TimeSeriesVisualizationDataStyle",c:"AndroidVisTimeSeries"},ImageViewerVisualizationStyle:{s:"VisualizationDataStyle",c:"ImageCarousel"},AndroidPhotoUploaderStyle:{s:"VisualizationDataStyle",c:"PhotoUploader"},HeatMapVisualizationStyle:{s:"HeatMapVisualizationDataStyle",c:"VisHeatMap"},AndroidMapStyle:{dc:"maps.AndroidDocMap",s:"MapVisualizationDataStyle",c:"maps.AndroidRptMap",m:"maps.AndroidMapModel"},InteractiveGridAjaxVisualizationStyle:{dc:"DocInteractiveGridXtab",s:"InteractiveGridDataStyle",c:"AndroidInteractiveGridXtab",m:"DocXtabModel"}};mstrmojo.AndroidVisList=mstrmojo.provide("mstrmojo.AndroidVisList",{getVis:function C(D){return B[D]||null;},getVisClass:function A(D,E){if(E.txi&&E.t===115){D=mstrmojo.DynamicClassFactory.newComponent(D,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.base64","mstrmojo.Dialog");mstrmojo.requiresDescs(1442,2140,5369,8233,8232,8313,8322);var V=8,P=16,W=4,T=1,R=8,B=16,O=268435456,I=536870912,A=1073741824,F=window.mstrConfig&&!window.mstrConfig.simpleDialog,L=2147755235,J=2147755236;var S=mstrmojo.Button.newInteractiveButton;function C(f,b,a,Y,Z){if(F){var d=[S(Y||mstrmojo.desc(1442),b||null,null),S(Z||mstrmojo.desc(2140),a||null,null)];mstrmojo.confirm(f,mstrApp.useBinaryFormat?d.reverse():d);}else{if(mstrmojo.confirm(f)){if(b){b();}}else{if(a){a();}}}}function X(Z,Y){if(F){mstrmojo.alert(Z,Y);}else{mstrmojo.alert(Z);if(Y){Y();}}}mstrmojo.DocActionSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.DocActionSelector",extCls:"mstrmojo-ActionSelector",type:V,targets:null,initControlInfo:function E(){var Y=this.node.defn;this.aa=parseInt(Y.aa,10);this.dpTxt=Y.dpTxt||{8:mstrmojo.desc(5369),4:mstrmojo.desc(8233),16:mstrmojo.desc(8232)}[this.aa]||"";this.dpCfm=Y.dpCfm;this.sac=parseInt(Y.sac,10);this.msg=Y.msg;this.rsid=Y.rsid;this.rst=Y.rst;this.node.data.elms=[{n:this.dpTxt,v:this.dpTxt}];this._super();},selectorControlChange:function K(Y){if(Y.selectedIndex!==0){return ;}this.executeAction();Y.select([]);},executeAction:function N(){var Z=this.aa,Y=this;if(Z===V){if(this.dpCfm){C(mstrmojo.desc(8313),function(){Y.onControllerCheck();});}else{Y.onControllerCheck();}}else{if(Z===W){if(this.dpCfm){C(mstrmojo.desc(8322),function(){Y.onDiscard();});}else{Y.onDiscard();}}else{this.onRecalculate();}}},onControllerCheck:function H(){this.onCommit();},onCommit:function M(){var b=this,d=this.model,Z=b.controller,Y=mstrApp.useBinaryFormat;if(!Y&&!this.validateRequiredObjects()){X(mstrmojo.desc(9200));return ;}var a=function(f){if((b.sac&I)>0){Z.invalidClientCache();}if((b.sac&B)>0){var g={did:b.rsid,objType:b.rst,forceExec:(b.sac&O)>0};if((b.sac&A)>0){g.linkAnswers='<hl mid="'+d.mid+'" srct="2" aopam="1"><prms></prms></hl>';}Z.onExecuteNewObject(b,g);}else{if((b.sac&R)>0){Z.onReExecute(b);}else{if(mstrApp.isMobile){Z.generateActionToolbar();}d.transactionUpdate(f);}}};mstrmojo.mask.show("Running");d.sendTransactionActions(this.ck,V,d.newCallback({success:function(f){mstrmojo.mask.hide();if(d.txrcd||f.offln){Z.offlineTransactionsSubmitted(b.ck);}if(f.offln){if(Y&&!b.networkToastShowed){b.networkToastShowed=true;mstrmojo.toast(mstrmojo.desc(9258,"No Network Connectivity")+". "+mstrmojo.desc(9259,"Transaction will be submitted when connectivity is resumed."));}d.transactionUpdate(f);}else{if((b.sac&T)>0&&b.msg){if(Y){mstrmojo.toast(b.msg);window.setTimeout(function(){a(f);},100);}else{X(b.msg,function(){a(f);});}}else{a(f);}}},failure:function(h){var f=mstrmojo.all.mojoAlertx9;if(f){f.destroy();}mstrmojo.mask.hide();if(d.txrcd){Z.offlineTransactionsSubmitted(b.ck);}var g=4294967296+parseInt(h.code,10);if(g===L){if(Y){b.validateRequiredObjects();}X(mstrmojo.desc(9200,"You have some required inputs that are not modified."));}else{if(g===J){var j=mstrmojo.desc(9201,"You haven't made any changes to submit.");if(Y){mstrmojo.toast(j);}else{X(j);}}else{X(mstrmojo.base64.decodeHttpHeader(h.message),function(){if(!Y){b.controller.onReExecute(b,true);}});}}}}));},onDiscard:function D(){var Z=this,a=this.model,Y=Z.controller;a.txDiscardTargets=this.getTxTargets();a.sendTransactionActions(this.ck,W,{success:function(b){a.transactionUpdate(b);Y.transactionDiscarded(Z.ck);},complete:function(){delete a.txDiscardTargets;if(mstrApp.isMobile){Y.generateActionToolbar();}}});},onRecalculate:function G(){this.model.sendTransactionActions(this.ck,P);},getTxTargets:function U(){var g=this.tks.split("\u001E"),f,Y,d,h,Z,a,b={};for(f=0,Y=g.length;f<Y;f++){d=g[f];h=1;do{Z=this.model.getUnitInstance(d,h++);if(Z&&Z.checkRequiredObjects){if(Z.isPanelStack){for(a in Z.txWidgets){b[Z.txWidgets[a].id]=1;}}else{b[Z.id]=1;}}else{break;}}while(true);}return b;},validateRequiredObjects:function Q(){var Y=true,Z;for(Z in this.getTxTargets()){Y=mstrmojo.all[Z].checkRequiredObjects()&&Y;}return Y;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.factories.ControllerFactory","mstrmojo.android.medium.controllers.RootController","mstrmojo.android.medium.controllers.HomeScreenController");mstrmojo.android.medium.factories.ControllerFactory=mstrmojo.declare(mstrmojo.android.factories.ControllerFactory,null,{scriptClass:"mstrmojo.android.medium.factories.ControllerFactory",newRootController:function C(D){return new mstrmojo.android.medium.controllers.RootController(D);},newHomeScreenController:function A(D){return new mstrmojo.android.medium.controllers.HomeScreenController(D);},newDocumentController:function B(D){return new mstrmojo.android.medium.controllers.DocumentController(D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.DocLayout","mstrmojo.DocLayoutHoriz","mstrmojo.DocSection","mstrmojo.DocSubsection","mstrmojo.DocTextfield","mstrmojo.DocXtabModel","mstrmojo.DocVisModel","mstrmojo.XtabBase","mstrmojo.DocPortlet","mstrmojo.DocResizablePortlet","mstrmojo.DocXtabGraph","mstrmojo.DocGridGraph","mstrmojo.DocLine","mstrmojo.DocImage","mstrmojo.DocHTMLContainer","mstrmojo.DocRectangle","mstrmojo.DocRoundRectangle","mstrmojo.DocPanel","mstrmojo.DocSelector","mstrmojo.DocActionSelector","mstrmojo._HasDocLink","mstrmojo.DocVisualization","mstrmojo.DynamicClassFactory","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo._IsSelectorTarget","mstrmojo.DocInfoWindow","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo._IsEditableTextfield","mstrmojo.DocSelectorViewFactory","mstrmojo._HasHoverButton","mstrmojo.hash");var N=mstrmojo.hash;var A=mstrmojo.EnumRWUnitType,C={};C[A.LAYOUT]={n:"Layout"};C[A.HEADER]=C[A.FOOTER]=C[A.PAGEHEADER]=C[A.PAGEFOOTER]=C[A.DETAILS]={n:"Section",scriptClass:"mstrmojo.DocSection"};C[A.SUBSECTION]={n:"SubSection",scriptClass:"mstrmojo.DocSubsection"};C[A.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.DocTextfield"};C[A.GRID]={n:"Xtab",scriptClass:"mstrmojo.DocXtab"};C[A.GRAPH]={n:"XtabGraph",scriptClass:"mstrmojo.DocXtabGraph"};C[A.GRIDGRAPH]={n:"GridGraph",scriptClass:"mstrmojo.DocGridGraph"};C[A.SELECTOR]={n:"Selector",scriptClass:"mstrmojo.DocSelector"};C[A.LINE]={n:"Line",scriptClass:"mstrmojo.DocLine"};C[A.IMAGE]={n:"Image",scriptClass:"mstrmojo.DocImage"};C[A.HTMLCONTAINER]={n:"HTMLContainer",scriptClass:"mstrmojo.HTMLContainer"};C[A.RECTANGLE]={n:"Rectangle",scriptClass:"mstrmojo.DocRectangle"};C[A.ROUNDEDRECTANGLE]={n:"RoundedRectangle",scriptClass:"mstrmojo.DocRoundRectangle"};C[A.PANEL]={n:"Panel",scriptClass:"mstrmojo.DocPanel"};C[A.VISUALIZATION]={n:"Visualization",scriptClass:"mstrmojo.DocVisualization"};C[A.MOJOVISUALIZATION]={n:"MojoVisualization"};var R={};var S=mstrmojo.DynamicClassFactory.newComponent;var K=mstrmojo.elementHelper;function Q(a){return function(){return this.parent.parent["on"+a]();};}var B=Q("maximize"),V=Q("restore"),F=Q("minimize"),U=Q("collapse"),G=Q("expand");mstrmojo.DocXtab=S(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab"});var H=function(d,b){var a=d&&d.parent;while(a){if(a[b]){return a;}a=a.parent;}return null;};function Z(b,g,d,a,f){return mstrmojo.Button.newIconButton(b,g,d,null,{ds:a,visible:(f!==a)});}function O(a,f,d){var b=C[f].n+(d?"Hover":""),g=R[b];if(!g){g=R[b]=S(a,[mstrmojo._HasDocLink].concat(this.getLinkDrillMixins(d)));}return g;}mstrmojo.DocBuilder=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocBuilder",visList:null,destroy:function W(){var a=this.selectorFactory;if(a){a.destroy();}this._super();},classMap:C,build:function M(x,f){var d=[],s=this.classMap,AB=((x&&x.length)||0),AA;for(AA=0;AA<AB;AA++){var z=x[AA],g=z&&z.defn,b=z&&z.data,o=(g&&g.t)||mstrmojo.EnumRWUnitType.LAYOUT,AC=s[o];var l=(o===A.TEXTFIELD&&((g&&g.dpst)));if(l){AC=s[o+"B"];}var j=(AC&&AC.n)?"new"+AC.n:"",k;if(this[j]){k=this[j](f,z);}else{if(AC&&AC.scriptClass){var h=AC.cls;if(!h){h=N.walk(AC.scriptClass,window);}if(o===A.TEXTFIELD||o===A.IMAGE){var a=b.dl,p=g.dl,q=(a&&a.items&&a.items.length)||(p&&p.items&&p.items.length>0);if(q||b.url||g.url||g.ifw){h=O.call(this,h,o+(l?"B":""),q);}else{if((o===A.TEXTFIELD)&&g.txi){h=S(h,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableTextfield]);}}}if(h){k=new h({id:z.id,node:z,controller:this.parent.controller,model:f});}}}if(k){k.k=z.k;k.formatResolver=f.formatResolver;k.builder=this;k.tooltip=b.tooltip||g.tooltip||"";if(!k.defn){k.defn=g;}k.disposables.push(k.defn);if(k.update){k.update(z);}if((g.ttl!==undefined&&o!==A.PANEL)||g.qsm){k=this.createPortlet(o,z,k);}d.push(k);}}return d;},createPortlet:function E(AD,AK,AB){var g=AK.defn,AH=g.ds,s=(g.iifp||!(AD===A.PANELSTACK||(g.ttl===undefined&&g.qsm)||AD===A.SELECTOR)),AI=(AD===A.GRAPH||AD===A.GRIDGRAPH),o=[],AS=mstrmojo.Button.newIconButton,AJ="",AL="",d="",AG=(AD===A.GRID||AI||AD===A.VISUALIZATION)&&parseInt(g.eo,10)!==2,AN=[],AE="mstrmojo-oivmSprite ",f=false;if(g.qsm){AJ="qks";var AC=function(AU,t,w){return AS(AU,AE+t,function(){return this.parent.parent.content.quickSwitch();},{visible:"this.parent.parent.defn.qsm !== this.qsm"},{qsm:w});};o.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",cssClass:(!s)?"grouped":"",children:[AC(mstrmojo.desc(3547,"View: Grid"),"tbGrid",1),AC(mstrmojo.desc(3548,"View: Graph"),"tbGraph",2)]});}if(AG){var z=this.getPortletExportGridToolbar(AB.k);if(z){AL=z.css;AN=z.node;o.push(AN);}}if(s){if(g.iifp){AJ="wrap";o.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:[Z(mstrmojo.desc(8973,"Collapse"),"co",U,1,AH),Z(mstrmojo.desc(8972,"Expand"),"ex",G,0,AH)]});}else{var AP=[Z(mstrmojo.desc(4539,"Minimize"),"mn",F,1,AH),Z(mstrmojo.desc(4540,"Restore"),"rs",V,0,AH),Z(mstrmojo.desc(4541,"Maximize"),"mx",B,2,AH)];if(AG){AN.children=(AN.children||[]).concat(AP);}else{AL="resize";o.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AP});}}}AB.slot="contentNode";AB.alias="content";AB.title=g.ttl||"";if(g.sec){if(g.style!==mstrmojo.DocSelectorViewFactory.STYLES.SCROLLER&&!g.sos){var a=AK.data,AR=a.elms,AM=a.ces;if(AM&&AR&&AR.length){AB.count=K.buildElemsCountStr(AM,AR);}}}o.push(AB);if(AD===A.PANELSTACK){var j=function(AV,w,AU,t){return AS(AV,AE+w,function(){return this.parent.parent.content.switchToPanel(t);},{enabled:"this.parent.parent."+AU});},AF=[],p=[],AO=!!AK.sw,AA=!!g.ifw,k=!!g.ifp;if(AO){p.push(j(mstrmojo.desc(1058,"Previous"),"tbPrev","prevEnabled",-1));AF.push(j(mstrmojo.desc(2917,"Next"),"tbNext","nextEnabled",1));}if(AA){AF.push(AS(mstrmojo.desc(2102,"Close"),AE+"mstrmojo-DocInfoWindow-close",function(){this.parent.parent.parent.close();}));}if(k){d="ifp";o.push({scriptClass:"mstrmojo.HBox",slot:"buttonbarNode",alias:"buttonbar",cssClass:"buttonBox",children:[{scriptClass:"mstrmojo.Button",alias:"applyNow",title:mstrmojo.desc(2164,"Apply"),text:mstrmojo.desc(2164,"Apply"),cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !g.cas;},enabled:function(){return this.parent.parent.applyEnabled;}},onclick:function AT(){if(AB&&AB.applyBufferedSlices){AB.applyBufferedSlices();}}}]});AF.push({scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AT(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.FilterPanelMenu",{openerButton:this,fps:AB,cmPos:this.cmPos});}}});f=true;}if(AA||k){var b=[];if(AO){b[0]="pst-l";}if(k){b.push("ifp");}p.push({scriptClass:"mstrmojo.Box",cssClass:b.join(" ")});}if(AA||AO||k){var q=AA?"ifw ":"",l=k?"ifp ":"",AQ=!g.cas?"cas ":"";AL=(AO?"pst-r ":"")+q+l+AQ;AJ=(AO?"pst-l ":"")+q+l+AQ;o.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:p});o.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AF});}}if(AD===A.SELECTOR&&AB.spm){AL="spm";o.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AT(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.SelectorMenu",{openerButton:this,selector:AB,cmPos:this.cmPos});}}}]});f=true;}var x="Doc"+(s?"Resizable":"")+"Portlet",h={defn:AB.defn,model:AB.model,children:o,title:AB.title,count:AB.count,floatingTitle:(g.ttl===undefined&&g.qsm),leftToolbarNodeClass:AJ,loadDataOnResize:AI,toolbarNodeClass:AL,buttonbarNodeClass:d,attachContextMenuEvent:f};if(AD===A.PANELSTACK){h.bindings={title:"this.children[0].title"};if(AK.sw){h.bindings.prevEnabled=function(){return this.children[0].hasPreviousPanel;};h.bindings.nextEnabled=function(){return this.children[0].hasNextPanel;};}if(g.ifp){h.bindings.applyEnabled=function(){return this.children[0].applyEnabled;};}}return new mstrmojo[x](h);},getPortletExportGridToolbar:mstrmojo.emptyFn,getLayoutViewerClass:function D(a){return mstrmojo.DocLayoutViewer;},newLayout:function Y(k,g){var j=[],d=g.data,h=g.defn,b=this.getLayoutViewerClass(g),a=new b({n:h.title,model:k,node:g,controller:this.parent.controller,tbc:h.tbc,slot:"containerNode",visible:false,ifs:d.ifs,gb:d.gbys});var l=a.defn=N.copy(h);l.fmts=N.copy(h.fmts);var f=function(t,w){var p=t.length;if(p){var q,s;for(q=0;q<p;q++){s=this.build([t[q]],k)[0];s.slot=w;j.push(s);}}};f.call(this,k.getFixedHeaders(g),"fixedHeaderNode");var o=mstrmojo["DocLayout"+((h.horiz)?"Horiz":"")];j.push(new o({slot:"layout",id:g.id,k:g.k,minHeight:d.mh,formatResolver:k.formatResolver,rules:h.rules,builder:this,node:g,defn:h,model:k}));f.call(this,k.getFixedFooters(g),"fixedFooterNode");a.addChildren(j);return a;},newSection:function(b,d){var a=(d.defn.horiz&&d.data.subsections.length>1)?"DocSectionHoriz":"DocSection";return new mstrmojo[a]({id:d.id,node:d,model:b});},newHTMLContainer:function(b,d){var a=(d.defn.ht===0)?"DocHTMLContainer":"DocTextfield";return new mstrmojo[a]({id:d.id,node:d,model:b});},adjustMojoVisualizationClass:function L(a){return a;},newMojoVisualization:function(j,f){var g=this.visList,b=f.data,q=g.getVis(b.visName);if(!q){var o=b.className;if(!o){return this.newXtab(j,f);}q={dc:o};}var k=(q.dc!==undefined)?q.dc:q.c;k=this.adjustMojoVisualizationClass(k);mstrmojo.requiresCls("mstrmojo."+k);var p=N.walk(k,mstrmojo),l=N.walk(q.m||"DocVisModel",mstrmojo);if(!p||!l){throw new Error("Missing visualization class.");}p=g.getVisClass(p,f.defn);var a=new p(N.copy(b.extProps,{id:f.id,node:f,n:f.defn.title,controller:this.parent.controller,gb:b.gbys}));a.setModel(new l({xtab:a,controller:this.parent.controller,docModel:j}));a.model.set("data",b);if(!!f.data.sdp){var d;for(d in f.data.sdp){f.data.sdp[d].defn={};var h=this.newXtab(j,f.data.sdp[d]);h.setModel(new l({xtab:h,controller:this.parent.controller,docModel:j,data:f.data.sdp[d]}));h.k=d;}}return a;},newInfoWindow:function X(a){return new mstrmojo.DocInfoWindow(a);},newRoundedRectangle:function P(d,f){var b=mstrmojo.dom,a=(b.supports(b.cssFeatures.ROUND_CORNERS))?"DocRectangle":"DocRoundRectangle";return new mstrmojo[a]({id:f.id,node:f,model:d});},newSelector:function J(b,d){var a=(d.defn.ct==="4"?"DocActionSelector":"DocSelector");return new mstrmojo[a]({id:d.id,node:d,controller:this.parent.controller,model:b});},newXtab:function I(b,d){var a=d.defn.txi,g,f=mstrmojo.DocXtab;if(a){f=S(mstrmojo.DocXtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.DocXtab"});}g=new f({id:d.id,node:d,controller:this.parent.controller});g.model=new mstrmojo.DocXtabModel({xtab:g,docModel:b});return g;},getLinkDrillMixins:function T(a){return a?[mstrmojo._HasHoverButton]:[];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.DocBuilder","mstrmojo.MobileDocLayoutViewer","mstrmojo.MobileDocXtabGraph","mstrmojo._XtabSeamlessIncrementalFetch","mstrmojo._HasScrollbox","mstrmojo.MobileXtab","mstrmojo.graph.MobileDocXtabCanvasGraph","mstrmojo.DynamicClassFactory","mstrmojo.android.DocSelectorViewFactory","mstrmojo.android.DocPanelStack","mstrmojo.android.AndroidDocPanel","mstrmojo.android.ui.DocButton","mstrmojo.android.HTMLContainer","mstrmojo._HasRelativeUrls","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo._IsSelectorTarget","mstrmojo._IsInteractiveGrid","mstrmojo.android.AndroidDICConfig","mstrmojo.AndroidVisList","mstrmojo.array","mstrmojo.hash","mstrmojo.maps.AndroidDocMap","mstrmojo.maps.MapInfoWindowLayoutViewer","mstrmojo.android.ui._IsTouchLink","mstrmojo._HasDrillLinks");var L=mstrmojo.DynamicClassFactory.newComponent,A=mstrmojo._HasRelativeUrls,C=mstrmojo.Obj.free,D=mstrmojo.EnumRWUnitType,F=mstrmojo.array,B=mstrmojo.hash;mstrmojo.DocXtab=L(mstrmojo.MobileXtab,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab",scrollerConfig:{scrollPast:false}});var J=(!!mstrMobileApp&&!!mstrMobileApp.useNativeMap&&mstrMobileApp.useNativeMap())?"androidmap":"jsmap";mstrmojo.maps.AndroidDocLayoutMap=L(mstrmojo.maps[J].AndroidDocMap,null,{scriptClass:"mstrmojo.maps.AndroidDocLayoutMap"});mstrmojo.MobileDocImage=L(mstrmojo.DocImage,[A],{scriptClass:"mstrmojo.MobileDocImage",relativeUrls:["v"]});mstrmojo.MobileDocHTMLContainer=L(mstrmojo.DocHTMLContainer,[A],{scriptClass:"mstrmojo.MobileDocHTMLContainer",relativeUrls:["v"]});var N=mstrmojo.DocLayout.prototype.formatHandlers.domNode;F.removeItem(N,"border");F.removeItem(N,"background-color");mstrmojo.MobileDocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,null,{scriptClass:"mstrmojo.MobileDocBuilder",init:function M(P){this._super(P);if(!this.destroyObjects){this.destroyObjects=[];}this.selectorFactory=new mstrmojo.android.DocSelectorViewFactory();var O=this.classMap;O[D.GRAPH]=(mstrApp.onMobileDevice()&&mstrApp.useBinaryFormat)?{n:"graph.MobileDocXtabCanvasGraph",scriptClass:"mstrmojo.graph.MobileDocXtabCanvasGraph"}:{n:"MobileDocXtabGraph",scriptClass:"mstrmojo.MobileDocXtabGraph"};O[D.IMAGE]={n:"MobileDocImage",scriptClass:"mstrmojo.MobileDocImage"};O[D.PANELSTACK]={n:"PanelStack",scriptClass:"mstrmojo.android.DocPanelStack"};O[D.PANEL]={n:"Panel",scriptClass:"mstrmojo.android.AndroidDocPanel"};O[D.TEXTFIELD+"B"]={n:"Button",scriptClass:"mstrmojo.android.ui.DocButton"};},visList:mstrmojo.AndroidVisList,getLayoutViewerClass:function H(P){if(P.defn.iw){var O="MapInfoWindowLayoutViewer";if(mstrApp.onMobileDevice()){O="Mobile"+O;}return mstrmojo.maps[O];}return mstrmojo.MobileDocLayoutViewer;},newLayout:function E(T,Q){var O=Q.defn.visName;if(O){var d=Q.data.gbys;var P=T,R=B.clone(Q);var Y=mstrmojo.Vis.getVisGrid(T,Q,Q.defn.visGK);if(Y){Q.data=Y.data;if(Q.defn.vp&&Object.keys(Q.defn.vp).length>0){Y.data.vp=Q.defn.vp;}Q.data.layoutModel=P;Q.data.layoutNode=R;Q.data.gbys=d;}Q.defn=T.makeObservable(Q.defn);this.destroyObjects.push(Q.defn);var V=this.visList.getVis(O),U=(V.dc!==undefined)?V.dc:V.c,a,b;try{if(/AndroidDocMap/.test(U)){U="maps.AndroidDocLayoutMap";}var Z=B.walk(U,mstrmojo),X=B.walk(V.m||"DocVisModel",mstrmojo),S=this.parent.controller;a=new Z({id:(Y&&Y.id)||Q.id,node:Q,n:Q.defn.title,controller:S,gb:Q.data.gbys,isFullScreenWidget:true});b=new X({xtab:a,controller:S,docModel:T});a.setModel(b);}catch(W){a=C(a);b=C(b);throw W;}return a;}return this._super(T,Q);},newHTMLContainer:function(O,Q){var P=(Q.defn.ht===0)?"MobileDocHTMLContainer":"android.HTMLContainer",R=mstrmojo.hash.walk(P,mstrmojo);return new R({id:Q.id,node:Q,model:O});},getLinkDrillMixins:function I(O){return[mstrmojo.android.ui._IsTouchLink,mstrmojo._HasDrillLinks];},createPortlet:function G(P,Q,O){if(Q.defn.ifw){var S=O.selectedKey,T=(O.model.getUnitDefinitions(S)||{})[S],R=T&&T.ttl;O.defn.ttl=((O.titleSrc===O.TTL_SRC_PANEL)?R:O.defn.ttl)||"";if(!mstrApp.isTablet()){O.title=O.defn.ttl;return O;}}return this._super(P,Q,O);},destroy:function K(){var P=this.destroyObjects,O;if(P){for(O=0;O<P.length;O++){if(P[O].destroy){P[O].destroy();}}}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.android.ui.RootView","mstrmojo.android.ui.ViewSwitcher","mstrmojo.android.ui.ActionBar","mstrmojo.android.ui.FolderView","mstrmojo.android.ui.ResultSetView","mstrmojo.android.ui.DocumentView","mstrmojo.graph.MobileXtabCanvasGraph","mstrmojo.android.ui.PromptsView","mstrmojo.android.ui.PropertiesView","mstrmojo.android.ui.SettingsView","mstrmojo.AndroidXtabStandalone","mstrmojo.MobileDocBuilder","mstrmojo.MobileGraph","mstrmojo.hash","mstrmojo.android.ui.NoProjectsView");mstrmojo.android.factories.ViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.android.factories.ViewFactory",newRootView:function J(N){return new mstrmojo.android.ui.RootView(N);},newActionBarView:function G(N){return new mstrmojo.android.ui.ActionBar(N);},newSwitcherView:function F(N){return new mstrmojo.android.ui.ViewSwitcher(N);},newFolderView:function K(N){return new mstrmojo.android.ui.FolderView(N);},newResultSetView:function M(N){return new mstrmojo.android.ui.ResultSetView(N);},newXtabView:function I(P){var N=P.viz,O=mstrmojo.hash.walk((N)?N.c:"AndroidXtabStandalone",mstrmojo);return new O(P);},newDocumentView:function C(O){var N=new mstrmojo.android.ui.DocumentView(mstrmojo.hash.copy(O,{cssClass:"mstrmojo-DocumentView"}));N.builder=new mstrmojo.MobileDocBuilder({parent:N});return N;},newGraphView:function A(O){var N=(mstrApp.onMobileDevice()&&mstrApp.useBinaryFormat)?mstrmojo.graph.MobileXtabCanvasGraph:mstrmojo.MobileGraph;return new N(O);},newPromptsView:function E(N){return new mstrmojo.android.ui.PromptsView(N);},newPropertiesView:function L(N){return new mstrmojo.android.ui.PropertiesView(N);},newSettingsView:function B(N){return new mstrmojo.android.ui.SettingsView(N);},newCalendarDialogView:mstrmojo.emptyFn,newNoProjectsView:function H(N){return new mstrmojo.android.ui.NoProjectsView(N);},newHeatMapEditorView:function(N){return new mstrmojo.VisHeatMapPopup(N);},newView:function D(N,O){return this["new"+N+"View"](O);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.factories.ViewFactory","mstrmojo.android.medium.ui.ActionBar","mstrmojo.android.medium.ui.ResultSetView","mstrmojo.android.medium.ui.HomeScreenView","mstrmojo.android.medium.ui.TransactionView","mstrmojo.android.medium.ui.TxEditDoc","mstrmojo.android.medium.ui.TxTypeList","mstrmojo.android.medium.ui.CalendarDialog");mstrmojo.android.medium.factories.ViewFactory=mstrmojo.declare(mstrmojo.android.factories.ViewFactory,null,{scriptClass:"mstrmojo.android.medium.factories.ViewFactory",newActionBarView:function D(H){return new mstrmojo.android.medium.ui.ActionBar(H);},newResultSetView:function C(H){return new mstrmojo.android.medium.ui.ResultSetView(H);},newHomeScreenView:function B(H){return new mstrmojo.android.medium.ui.HomeScreenView(H);},newTransactionsView:function G(H){return new mstrmojo.android.medium.ui.TransactionView(H);},newTransactionsEditDocView:function F(H){return new mstrmojo.android.medium.ui.TxEditDoc(H);},newTransactionsTypeListView:function E(H){return new mstrmojo.android.medium.ui.TxTypeList(H);},newCalendarDialogView:function A(H){return new mstrmojo.android.medium.ui.CalendarDialog(H);}});}());