(function(){var F="#000000";mstrmojo.color=mstrmojo.provide("mstrmojo.color",{hexChars:"0123456789ABCDEF",toHex:function J(L){L=L||0;L=Math.max(Math.min(isNaN(L)?0:parseInt(L,10),255),0);return this.hexChars.charAt((L-L%16)/16)+this.hexChars.charAt(L%16);},toDec:function K(L){return this.hexChars.indexOf(L.toUpperCase());},rgbStr2rgb:function G(L){var M=[0,0,0];L=L.replace(/ /g,"");var N=L.indexOf("rgb");if(N>=0){L=L.substring(N+4,L.length-1);M=L.split(",");}return M;},rgbStr2hex:function B(L){if(L.indexOf("rgb")>=0){var M=this.rgbStr2rgb(L);return"#"+this.rgb2hex(M[0],M[1],M[2]);}return L;},rgb2hex:function C(N,M,L){return this.toHex(N)+this.toHex(M)+this.toHex(L);},rgb2hsv:function E(L,Q,U){var S=[L,Q,U];S.sort(function(Z,Y){return Z-Y;});var P,X,W=0;var O=S[0];var T=S[2];W=T/255;X=(T!=0)?(parseFloat(T)-parseFloat(O))/parseFloat(T):0;if(X==0){P=0;}else{var R=T-O;var M=(T-L)/R;var N=(T-Q)/R;var V=(T-U)/R;if(L==T){P=V-N;}else{if(Q==T){P=2+M-V;}else{P=4+N-M;}}P=P/6;if(P<0){P=P+1;}}return[Math.round(P*360),Math.round(X*100),Math.round(W*100)];},hex2rgb:function H(O){var M=(O.charAt(0)=="#")?O.substr(1):O;var L=M.length!==3;var N=[0,0,0];if(L){N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(1,1)));N[1]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(3,1)));N[2]=(this.toDec(M.substr(4,1))*16)+(this.toDec(M.substr(5,1)));}else{N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(0,1)));N[1]=(this.toDec(M.substr(1,1))*16)+(this.toDec(M.substr(1,1)));N[2]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(2,1)));}return N;},hex2hsv:function(M){var L=this.hex2rgb(M);return this.rgb2hsv(L[0],L[1],L[2]);},hsv2rgb:function(S,Y,W){S=S/360;Y=Y/100;W=W/100;var L,T,V;if(Y==0){L=W*255;T=W*255;V=W*255;}else{var O=S*6;if(O==6){O=0;}var R=Math.floor(O);var N=W*(1-Y);var M=W*(1-Y*(O-R));var X=W*(1-Y*(1-(O-R)));var U,P,Q;switch(R){case 0:U=W;P=X;Q=N;break;case 1:U=M;P=W;Q=N;break;case 2:U=N;P=W;Q=X;break;case 3:U=N;P=M;Q=W;break;case 4:U=X;P=N;Q=W;break;default:U=W;P=N;Q=M;break;}L=U*255;T=P*255;V=Q*255;}return[Math.round(L),Math.round(T),Math.round(V)];},hsv2hex:function(O,N,L){var M=this.hsv2rgb(O,N,L);return this.rgb2hex(M[0],M[1],M[2]);},getContrastingColor:function A(N,L){var M=this.hex2rgb(N);return(((M[0]*299)+(M[1]*587)+(M[2]*114))/1000<125)?L[0]:L[1];},getHighlightColor:function D(S,Q){var L,R,T,U,V=this.hex2rgb(!Q?"#FFCE7F":"#EFE6D8"),P=parseInt(S[0],10),N=parseInt(S[1],10),X=parseInt(S[2],10),O=parseInt(V[0],10),M=parseInt(V[1],10),W=parseInt(V[2],10);L=(P*O)/255;R=(N*M)/255;T=(X*W)/255;U=P*0.3+N*0.59+X*0.11;if(U<85){L=L+(63*(85-U)/85);L=L>255?255:L;R=R+(63*(85-U)/85);R=R>255?255:R;T=T+(63*(85-U)/85);T=T>255?255:T;}return"#"+this.rgb2hex(Math.round(L),Math.round(R),Math.round(T));},get3DBorderColor:function I(N,Q){var M=parseInt(N[0],10)*0.3+parseInt(N[1],10)*0.59+parseInt(N[2],10)*0.11;var P=parseInt(N[0],10);var O=parseInt(N[1],10);var L=parseInt(N[2],10);switch(Q){case"light":if(M>150){P=P*0.9;O=O*0.9;L=L*0.9;}else{P=P*0.6+102;O=O*0.6+102;L=L*0.6+102;}break;case"dark":if(M>10){P=P*0.4;O=O*0.4;L=L*0.4;}else{P=P*0.8+30;O=O*0.8+30;L=L*0.8+30;}}return"#"+this.rgb2hex(Math.round(P),Math.round(O),Math.round(L));},encodeColor:function(L,M){if(M!=undefined&&(L==null||L.length==0||L=="undefined")){L=M;}if(L=="transparent"){return -1;}else{if(L==-2){return -2;}else{if(L.substring(0,1)=="#"){L=L.substring(1);}return parseInt(L.substring(4)+L.substring(2,4)+L.substring(0,2),16);}}},decodeColor:function(N){var L=parseInt(N,10);if(L==0){return F;}var M=16777216+(L&255)*65536+(L&65280)+(L&16711680)/65536;return"#"+M.toString(16).substring(1).toUpperCase();}});})();(function(){mstrmojo.requiresDescs(2050,2051,2052,2053,2054,2055,2056,2067,2068,2170,2182,2183,2193,2194,2195,2231,2232,2233,2234,2235,2236,2237,2238,2239,2240,2241,2242,2243,2244,2245,2246,2247,2248,2250,2256,2257,2258,2259,2260,2261,2262,2264,2265,2296,2378,2412,2718,2719,2886,3433,3434,3435,3436,3440,3441,3604,3905,4601,5156,7942,7943,7944,7945);var A=mstrmojo.desc(3604);mstrmojo._FormatDefinition={Formats:[{n:mstrmojo.desc(3433)},{n:mstrmojo.desc(3434)},{n:mstrmojo.desc(3435)},{n:mstrmojo.desc(3436)}],FormatTarget:[{n:mstrmojo.desc(7942),v:1,p:"header_format"},{n:mstrmojo.desc(7943),v:2,p:"grid_format"},{n:mstrmojo.desc(7944),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:mstrmojo.desc(3434)},{n:mstrmojo.desc(3435)},{n:mstrmojo.desc(3433)},{n:mstrmojo.desc(2886)},{n:mstrmojo.desc(3905)}],MetricHeaderFormats:[{n:mstrmojo.desc(3434)},{n:mstrmojo.desc(3435)},{n:mstrmojo.desc(3433)},{n:mstrmojo.desc(2886)},{n:mstrmojo.desc(3905)},{n:"Chart"}],DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:[{n:mstrmojo.desc(2412),v:"pru"},{n:"Arial",v:"Arial"},{n:"Arial Black",v:"Arial Black"},{n:"Arial Narrow",v:"Arial Narrow"},{n:"Arial Unicode MS",v:"Arial Unicode MS"},{n:"Batang",v:"Batang"},{n:"Book Antiqua",v:"Book Antiqua"},{n:"Bookman Old Style",v:"Bookman Old Style"},{n:"Bookshelf Symbol 1",v:"Bookshelf Symbol 1"},{n:"Bookshelf Symbol 2",v:"Bookshelf Symbol 2"},{n:"Bookshelf Symbol 3",v:"Bookshelf Symbol 3"},{n:"Comic Sans MS",v:"Comic Sans MS"},{n:"Courier New",v:"Courier New"},{n:"Garamond",v:"Garamond"},{n:"Haettenschweiler",v:"Haettenschweiler"},{n:"Helvetica",v:"Helvetica"},{n:"Impact",v:"Impact"},{n:"Lucida Console",v:"Lucida Console"},{n:"Lucida Sans Unicode",v:"Lucida Sans Unicode"},{n:"Map Symbols",v:"Map Symbols"},{n:"Marlett",v:"Marlett"},{n:"Monotype Corsiva",v:"Monotype Corsiva"},{n:"Monotype Sorts",v:"Monotype Sorts"},{n:"MS Gothic",v:"MS Gothic"},{n:"MS Outlook",v:"MS Outlook"},{n:"Microsoft Sans Serif",v:"Microsoft Sans Serif"},{n:"MT Extra",v:"MT Extra"},{n:"Symbol",v:"Symbol"},{n:"Tahoma",v:"Tahoma"},{n:"Times New Roman",v:"Times New Roman"},{n:"Trebuchet MS",v:"Trebuchet MS"},{n:"Verdana",v:"Verdana"},{n:"Webdings",v:"Webdings"},{n:"Wingdings",v:"Wingdings"},{n:"Wingdings 2",v:"Wingdings 2"},{n:"Wingdings 3",v:"Wingdings 3"}],Sizes:[{n:mstrmojo.desc(2412),v:"pru"},{n:"2",v:"2"},{n:"3",v:"3"},{n:"4",v:"4"},{n:"5",v:"5"},{n:"6",v:"6"},{n:"7",v:"7"},{n:"8",v:"8"},{n:"9",v:"9"},{n:"10",v:"10"},{n:"11",v:"11"},{n:"12",v:"12"},{n:"14",v:"14"},{n:"16",v:"16"},{n:"18",v:"18"},{n:"20",v:"20"},{n:"22",v:"22"},{n:"24",v:"24"},{n:"36",v:"36"},{n:"48",v:"48"},{n:"72",v:"72"}],Styles:[{n:mstrmojo.desc(2412),v:"pru"},{n:mstrmojo.desc(3440),v:"0,0"},{n:mstrmojo.desc(2718),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:mstrmojo.desc(2412),v:-2},{n:mstrmojo.desc(2378),v:9},{n:mstrmojo.desc(2050),v:0},{n:mstrmojo.desc(2051),v:1},{n:mstrmojo.desc(2052),v:2},{n:mstrmojo.desc(2170),v:3},{n:mstrmojo.desc(2053),v:4},{n:mstrmojo.desc(2054),v:5},{n:mstrmojo.desc(2055),v:6},{n:mstrmojo.desc(2056),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:"-1,234.12",v:1,f:"#,##0.00"},{n:"-1,234.12["+A+"]",r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:"1,234.12["+A+"]",r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:"(1,234.12)",v:3,f:"#,##0.00;(#,##0.00)"},{n:"(1,234.12)["+A+"]",r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:"$-1,234.12",v:1,f:'"$"#,##0.00'},{n:"$-1,234.12["+A+"]",r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:"$1,234.12["+A+"]",r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:"$(1,234.12)",v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:"$(1,234.12)["+A+"]",r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194),v:0},{n:mstrmojo.desc(2195),v:1},{n:mstrmojo.desc(2183),v:2},{n:mstrmojo.desc(2182),v:3}],Date:[{n:mstrmojo.desc(2231),v:"m/d"},{n:mstrmojo.desc(2232),v:"mm/dd"},{n:mstrmojo.desc(2233),v:"m/d/yy"},{n:mstrmojo.desc(2234),v:"mm/dd/yy"},{n:mstrmojo.desc(2235),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236),v:"d-mmm"},{n:mstrmojo.desc(2237),v:"d-mmm-yy"},{n:mstrmojo.desc(2238),v:"mmm-yy"},{n:mstrmojo.desc(2239),v:"mmm 'yy"},{n:mstrmojo.desc(2240),v:"mmmm yyyy"},{n:mstrmojo.desc(2241),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244),v:"h:mm"},{n:mstrmojo.desc(2245),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246),v:"h:mm:ss"},{n:mstrmojo.desc(2247),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%["+A+"]",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%["+A+"]",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)["+A+"]",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:mstrmojo.desc(2412),v:"pru"},{n:mstrmojo.desc(4601),v:0},{n:mstrmojo.desc(5156),v:-90}],Horizontal:[{n:mstrmojo.desc(2296),v:"pru"},{n:mstrmojo.desc(2378),v:1},{n:mstrmojo.desc(2194),v:2},{n:mstrmojo.desc(2193),v:3},{n:mstrmojo.desc(2195),v:4},{n:mstrmojo.desc(2068),v:6}],Vertical:[{n:mstrmojo.desc(2296),v:"pru"},{n:mstrmojo.desc(2256),v:1},{n:mstrmojo.desc(2067),v:2},{n:mstrmojo.desc(2257),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:mstrmojo.desc(2412),v:"pru"},{n:mstrmojo.desc(2258),v:0},{n:mstrmojo.desc(2259),v:3},{n:mstrmojo.desc(2260),v:4},{n:mstrmojo.desc(2261),v:7},{n:mstrmojo.desc(2262),v:1},{n:mstrmojo.desc(2264),v:5},{n:mstrmojo.desc(2265),v:6}],extractModel:function(D,F,C){var H=C||this.DefaultFormat;for(var G in D){var B=D[G];if(!B.attachEventListener){if(!_H.isEmpty(B)){F[G]=B;}}else{for(var E in B){if(H[G]&&H[G][E]){if(!F[G]){F[G]={};}F[G][E]=B[E];}}}}},getStandardFormat:function(C,B){var E=mstrmojo.hash.clone(B||this.DefaultFormat);C=C||{};for(var D in E){C[D]=C[D]||{};}for(var D in C){if(!C[D].attachEventListener){C[D]=mstrmojo.hash.make(C[D],mstrmojo.Obj);}}return C;},saveFormatModel:function(F,L,C,M){var K=M||this.DefaultFormat;for(var H=0;H<C.length;H++){var G=C[H],E=L[G]||null,J=F[G];if(typeof J==="undefined"){delete L[G];continue;}for(var B in K){var I=K[B];if(!E&&!J||E&&!E[B]&&!J[B]){continue;}for(var D in I){if(typeof J[B]==="undefined"||J[B]===""||J[B][D]==="pru"||typeof J[B][D]=="undefined"){if(E&&E[B]&&E[B][D]!=null&&E[B][D]!="pru"){E[B][D]="pru";}}else{E=E||{};E[B]=E[B]||{};E[B][D]=J[B][D];}}}if(E){L[G]=E;}}}};})();(function(){var L=/\{\@([^\}]+)\}/gm,H=/\</gm,P=/\>/gm,D=/\S/,O=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],E=new RegExp("(\\"+O.join("|\\")+")","g"),Q={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'};var J=function(S){if(S==null){return"null";}var T=typeof (S);if(T!="object"){return T;}else{if(S.length===undefined){return"object";}else{return"array";}}};var R={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function F(T,V){if(!T){return"";}var U=[];for(var S in V){U.push(S.k||S);}return T.replace(new RegExp(U.join("|"),"g"),function(W){var X=V[W];return X.v||X;});},trim:function N(S){return(S&&S.replace)?S.replace(/^\s+/,"").replace(/\s+$/,""):S;},ellipsize:function A(U,T){var S=this.trim(U.substr(0,(T||1)-1));if(S!==U){S+="&hellip;";}return S;},isEmpty:function I(S){return(S==null)||!(D.test(S));},regEscape:function M(S){return S.replace(E,"\\$1");},encodeXMLAttribute:function(S){return mstrmojo.string.multiReplace(S,Q);},encodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,C);},decodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,K);},htmlAngles:function(S){S=String(S);if(S!=null){return S.replace(H,"&lt;").replace(P,"&gt;");}return S;},apply:function G(S,T){if(!S){return"";}return S.replace(L,function U(V,W){return(W in T&&T[W]!==null)?T[W]:"";});},json2xml:function(f,b,V){if(!(b instanceof Array)){b=[b];}var T=V&&V.isSerializable,Z=(V.convertBoolean===false)?false:true;var c=[],S=[],U,g,l;for(var Y=0,h=b.length;Y<h;Y++){var k=b[Y];for(U in k){if(T){var a=T(U,b,Y);if(a!==true){if(a===false){continue;}else{if(a.att){c.push(a.att);}if(a.child){S.push(a.child);}continue;}}}g=k[U];l=J(g);switch(l){case"array":S.push("<"+U+">");for(var W=0,X=g.length;W<X;W++){var d=V.getArrItemName(U,g,W)||W;S.push(this.json2xml(d,g[W],V));}S.push("</"+U+">");break;case"object":S.push(this.json2xml(U,g,V));break;case"string":c.push(U+'="'+mstrmojo.string.encodeXMLAttribute(g)+'"');break;case"boolean":c.push(U+'="'+((Z)?(g?"-1":"0"):g)+'"');break;case"null":if(!V.skipNull){c.push(U+'="'+V.nullValue+'"');}break;default:c.push(U+'="'+g+'"');break;}}}return"<"+f+" "+c.join(" ")+">"+S.join("")+"</"+f+">";},escape4HTMLText:function B(Z){if(!Z||!Z.replace){return Z;}var W=/\"/gm;var U="&quot;";var a=/\&/gm;var Y="&amp;";var X=/\</gm;var S="&lt;";var V=/\>/gm;var T="&gt;";return Z.replace(a,Y).replace(W,U).replace(X,S).replace(V,T);},parseUri:function(W,T){T=T||R;var S=T.parser[((T.strictMode)?"strict":"loose")].exec(W),V={},U=14;while(U--){V[T.key[U]]=S[U]||"";}V[T.q.name]={};V[T.key[12]].replace(T.q.parser,function(Y,X,Z){if(X){V[T.q.name][X]=Z;}});return V;}});})();(function(){mstrmojo._IsPopup={visible:false,opener:null,onOpen:null,onClose:null,open:function B(E,D){if(this.updatePopupConfig){this.updatePopupConfig(D,E);}else{if(D){for(var C in D){this.set(C,D[C]);}}}this.set("opener",E);if(!this.hasRendered){this.render();}if(this.nudge){this.domNode.style.top="-10000px";}this.set("visible",true);if(this.nudge){this.nudge();}if(this.onOpen){this.onOpen();}},close:function A(C){if(this.onClose){this.onClose(C);}this.set("visible",false);this.set("opener",null);}};})();mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){function P(T,Q,R){if(T.nodeType===3&&Q){return T;}else{var S=(Q&&T.nodeType===1&&T.lastChild)?T.lastChild:E(T,R);return S?C(S,R):null;}}function E(R,Q){return(R===Q)?null:(R.previousSibling||E(R.parentNode,Q));}function C(R,Q){if(R===Q){return null;}if(R.nodeType===3&&H(R)){return R;}else{if(R.nodeType===1&&R.lastChild){return C(R.lastChild);}else{return C(E(R,Q));}}}function H(Q){return Q.textContent||Q.nodeValue||Q.innerText;}function L(T,Q,R){if(T.nodeType===3&&Q){return T;}else{var S=(Q&&T.nodeType===1&&T.firstChild)?T.firstChild:B(T,R);return S?D(S,R):null;}}function B(R,Q){return(R===Q)?null:(R.nextSibling||B(R.parentNode,Q));}function D(R,Q){if(R===Q){return null;}if(R.nodeType===3&&H(R)){return R;}else{if(R.nodeType===1&&R.firstChild){return D(R.firstChild);}else{return D(B(R,Q));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function O(S,T){var Q=0,R;if(S.nodeType===1){if(window.getSelection){R=document.createRange();R.selectNode(S);Q=R.toString().length;}else{R=document.body.createTextRange();R.moveToElementText(S);Q=R.text.length;}}else{Q=H(S).length;}return T===Q?this.EDGE.EDGE_END:(T===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function J(T,R){if(!T.offsetParent){return ;}var S=this.getSelection(),Q=this.getRange();if(window.getSelection){Q.selectNodeContents(T);Q.collapse(R);S.removeAllRanges();S.addRange(Q);}else{Q.moveToElementText(T);Q.collapse(R);Q.select();}},collapseOnTextNode:function K(T,U){var S=this.getSelection(),R=this.getRange();if(window.getSelection){var Q=L(T,true);R.setStart(Q,U);R.collapse(true);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(T);R.collapse(true);R.move("character",U);R.select();}},getRangeInfo:function I(){var X=null,b,U=this.getRange(),d;if(window.getSelection){var a=function(g,k,h){var f=g.cloneRange();f.collapse(h);f.setStartBefore(k);return f.toString().length;},Z=U.startContainer,R=U.startOffset;if(Z.nodeType===1){R=a(U,Z,true);}X={collapsed:U.collapsed,startContainer:Z,startOffset:R};if(!U.collapsed){var V=U.endContainer,Q=U.endOffset;if(V.nodeType===1){Q=a(U,V,false);}X.endContainer=V;X.endOffset=Q;}X.range=U;}else{var W,c,Y=function(k,l){var h=k.duplicate(),f=document.body.createTextRange(),g;h.collapse(l);g=h.parentElement();f.moveToElementText(g);f.setEndPoint("EndToStart",h);return{container:g,offset:f.text.length};},T=Y(U,true),S;X={collapsed:(U.compareEndPoints("StartToEnd",U)===0),startContainer:T.container,startOffset:T.offset};if(!X.collapsed){S=Y(U,false);X.endContainer=S.container;X.endOffset=S.offset;}}return X;},collapse:function N(R){if(window.getSelection){var S=this.getSelection();if(R){S.collapseToStart();}else{S.collapseToEnd();}}else{var Q=this.getRange();Q.collapse(R);Q.select();}},selectSingleNode:function G(S){var R=this.getSelection(),Q=this.getRange();if(window.getSelection){Q.selectNodeContents(S);R.removeAllRanges();R.addRange(Q);}else{Q.moveToElementText(S);Q.select();}},selectMultipleNodes:function M(V,R,W,T){var U=this.getSelection(),S=this.getRange();if(window.getSelection){S.setStart(V,R);S.setEnd(W,T);U.removeAllRanges();U.addRange(S);}else{V=(V.nodeType===3)?V.parentNode:V;S.moveToElementText(V);S.move("character",R);W=(W.nodeType===3)?W.parentNode:W;var Q=document.body.createTextRange();Q.moveToElementText(W);Q.move("character",T);S.setEndPoint("EndToStart",Q);S.select();}},getSelection:function F(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});})();(function(){var R=Math;function AC(G,b){return b||(G||window).event;}var Ad=!!document.all,t=navigator.userAgent,g=!Ad&&!!t.match(/Firefox/),o=0,u=!!t.match(/Android/),AX=!!t.match(/iPad/),AR=!!document.createTouch||u,r=!!t.match(/PlayBook/),S=!!t.match(/Windows Phone/),V=Ad&&!!t.match(/MSIE 10/),Ae=!Ad&&!!t.match(/Trident.*rv/),x=Ad&&!V,f=g?"-moz-":Ad?"":"-webkit-",AI=g?"Moz":V?"":Ad?"ms":"webkit",AP=(V?"t":"T"),AL=AI+AP+"ransition",Ab=AY(),AU=AF(),AB=W(),A=Q(),p=h();function AY(){return AI+AP+"ransform";}function AF(){return AL+"Property";}function W(){return AL+"Duration";}function Q(){return(V||g)?"transitionend":"webkitTransitionEnd";}function h(){return AI+"BoxShadow";}function AO(){if(!o&&g){var G=t.match(/.*Firefox\/([\d|\.]*).*/);if(G){o=parseFloat(G[1],10);}}return o;}function Ac(){var Ag=0,Ak=0,Ah=window,Ai=document,G=Ai.body,Aj=Ai.documentElement;if(typeof Ah.pageYOffset=="number"){Ak=Ah.pageYOffset;Ag=Ah.pageXOffset;}else{if(G&&(G.scrollLeft||G.scrollTop)){Ak=G.scrollTop;Ag=G.scrollLeft;}else{if(Aj&&(Aj.scrollLeft||Aj.scrollTop)){Ak=Aj.scrollTop;Ag=Aj.scrollLeft;}}}return{x:Ag,y:Ak};}function AG(G){G=G||0;G=String(G);return((G.indexOf("%",0))!=-1)?G:(G+"px");}function AM(d,Aj,Ai,Ah,Ag){if(!mstrmojo.dom.isWinPhone){Ah=(Ah||false||this.isHWAccelerated);}else{Ah=false;}var b=Ag+(Ah?"3d":"")+"(",G=Ah?(","+Ai+")"):")";return b+d+","+Aj+G;}var L=1,AV=2,Y=3,D=4,K=5;function z(Aj,Ai,Am){var Al=Aj.style,b=Al.display,Ah=this.windowDim(),Ag=Ac();Al.display="block";var Ak=Ah.w-Aj.clientWidth,An=Ah.h-Aj.clientHeight,G={4:0,5:Ak,3:Ak/2},d={1:0,3:An/2,2:An};Al.left=G[Ai]+Ag.x+"px";Al.top=d[Am]+Ag.y+"px";Al.display=b;}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:t,isIE:Ad,isIE6:Ad&&!!t.match(/MSIE 6/),isIE7:Ad&&!!t.match(/MSIE 7/),isIE8:Ad&&!!t.match(/MSIE 8/),isIE9:Ad&&!!t.match(/MSIE 9/),isIE10:V,isIEW3C:Ae,isNSIE:Ad&&!V,isDXIE:x,isFF:g,isWK:!!t.match(/AppleWebKit/),isSafari:!!t.match(/Safari/)&&!t.match(/Chrome/),isHWAccelerated:!u,isAndroid:u,isIPad:AX,isPlayBook:r,isWinPhone:S,supportsTouches:AR,TOUCHSTART:AR?"touchstart":"mousedown",TOUCHMOVE:AR?"touchmove":"mousemove",TOUCHEND:AR?"touchend":"mouseup",TOUCHCANCEL:AR?"touchcancel":"",RESIZE:AR?"orientationchange":"resize",CSS3_PREFIX:f,CSS3_BOXSHADOW:p,CSS3_TRANSFORM:Ab,CSS3_TRANSITION:AL,CSS3_TRANSITION_PROPERTY:AU,CSS3_TRANSITION_DURATION:AB,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},supports:function B(b){var G=this.isFF&&AO();switch(b){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||G>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||G>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);}return false;},replace:function F(d,G){if(!d||!G){return ;}var b=d.parentNode;if(b){b.replaceChild(G,d);}},attachEvent:function y(d,b,Ag,G){if(d.addEventListener){return d.addEventListener(b,Ag,!!G);}else{return d.attachEvent("on"+b,Ag);}},detachEvent:function AS(d,b,Ag,G){if(!d){return ;}if(d.removeEventListener){d.removeEventListener(b,Ag,!!G);}else{d.detachEvent("on"+b,Ag);}},attachOneTimeEvent:function Z(Ag,b,Ah,G){var d=function(Ai){Ah(Ai);mstrmojo.dom.detachEvent(this,b,d,G);};this.attachEvent(Ag,b,d,G);Ag=null;return d;},captureDomEvent:function AK(Ai,Ag,b,Ah,d){var G=mstrmojo.all[Ai];if(G){G.captureDomEvent(Ag,b,Ah,d);}},translate:function O(d,b,Ai,Ah,G,Ag){G=(G&&" "+G)||"";d.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(b,Ai,Ah,Ag)+G;},createTranslateString:function T(G,Ag,d,b){G=AG(G);Ag=AG(Ag);d=AG(d);return AM(G,Ag,d,b,"translate");},createScaleString:function AA(G,Ag,d,b){G=G||0;Ag=Ag||0;d=d||0;return AM(G,Ag,d,b,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function E(d,G,Ag,Ai){var b=d.id+"-"+G,Ah=this._bufferConnects[b];if(!Ah){Ah=this._bufferConnects[b]={elId:d.id,eventName:G,timer:null,bufferSize:Ai,listeners:[],callback:function(Aj){mstrmojo.dom._callback(Aj,mstrmojo.global,b);return true;}};this.attachEvent(d,G,Ah.callback);}Ah.listeners.push(Ag);},_callback:function N(Ah,G,d){if(!Ah){Ah=G.event;}var Ag=this._bufferConnects[d],Ai=Ag&&Ag.timer;if(Ag&&!Ai){var b=(Ag.bufferSize===null)?this._bufferSize:Ag.bufferSize;if(Ag.bufferSize){Ag.timer=G.setTimeout(function(){mstrmojo.dom.updateBuffers(d);},b);}else{mstrmojo.dom.updateBuffers(d);}}},updateBuffers:function AW(Ag){var Ah=this._bufferConnects[Ag],b=Ah&&Ah.listeners;for(var d=0,G=b&&b.length||0;d<G;d++){b[d]();}if(Ah&&Ah.timer){delete Ah.timer;}},detachBufferedEvent:function a(Ai,d,Aj){if(!Ai){return ;}var Ah=Ai.id+"-"+d,Ak=this._bufferConnects[Ah],b=Ak&&Ak.listeners,G=(b&&b.length)||0;if(G){for(var Ag=G-1;Ag>-1;Ag--){if(b[Ag]==Aj){b.splice(Ag,1);}}if(!b.length){this.detachEvent(Ai,d,Ak.callback);delete this._bufferConnects[Ah];if(Ak.timer){mstrmojo.global.clearTimeout(Ak.timer);}}}},eventTarget:function AD(G,b){b=AC(G,b);return b.target||b.srcElement;},ctrlKey:function AZ(G,b){return AC(G,b).ctrlKey;},shiftKey:function AE(G,b){return AC(G,b).shiftKey;},getButton:function AQ(G,b){return((AC(G,b)).button==2)?2:1;},getMousePosition:function k(Ai,Ah){Ah=Ah||window;var Ag,Al;if(mstrmojo.dom.isIE){Ai=Ai||Ah.event;var Aj=document,G=Aj.body,Ak=Aj.documentElement;Ag=Ai.clientX+G.scrollLeft+(Ak.scrollLeft||0);Al=Ai.clientY+G.scrollTop+(Ak.scrollTop||0);}else{Ag=Ai.pageX;Al=Ai.pageY;}return{x:Ag,y:Al};},position:function(b,d){var Ai={x:0,y:0};if(b&&b.getBoundingClientRect){try{Ai=b.getBoundingClientRect();}catch(Ah){Ai={left:0,top:0,right:0,bottom:0,height:0,width:0};}Ai={x:Ai.left,y:Ai.top,w:Ai.right-Ai.left,h:Ai.bottom-Ai.top};if(this.isIE6||this.isIE7){var G=b.ownerDocument;if(G){var Ak=G.documentElement,Aj=Ak.getBoundingClientRect();Ai.x-=Aj.left;Ai.y-=Aj.top;}}}if(d){var Ag=Ac();Ai.x+=Ag.x;Ai.y+=Ag.y;}return Ai;},delta:function J(d,G){G=G||document.body;var b=this.position(d),Ag=this.position(G);return{x:Math.round(b.x-Ag.x),y:Math.round(b.y-Ag.y)};},windowDim:function Af(){var G=0,Ag=0,Ah=window,Ai=document,Aj=Ai.documentElement,b=Ai.body;if(typeof (Ah.innerWidth)=="number"){G=Ah.innerWidth;Ag=Ah.innerHeight;}else{if(Aj&&(Aj.clientWidth||Aj.clientHeight)){G=Aj.clientWidth;Ag=Aj.clientHeight;}else{if(b&&(b.clientWidth||b.clientHeight)){G=b.clientWidth;Ag=b.clientHeight;}}}return{w:G,h:Ag};},center:function AJ(G){z.call(this,G,Y,Y);},bottomCenter:function H(G){z.call(this,G,Y,AV);},clearBrowserHighlights:function P(G){G=G||self;if(Ad){var Aj=G.document,Ai=Aj&&Aj.selection,Ag=Ai&&Ai.empty;if(Ag){try{Ai.empty();}catch(d){}}}else{var b=G.getSelection,Ah=b&&G.getSelection();if(Ah&&!Ah.isCollapsed){if(Ah.empty){Ah.empty();}else{if(Ah.removeAllRanges){Ah.removeAllRanges();}}}}},findAncestorByAttr:function AN(Ah,d,b,G){var Ai=b?Ah:Ah&&Ah.parentNode;while(Ai&&(Ai!=G)){var Ag=Ai.getAttribute&&Ai.getAttribute(d);if(Ag!=null){return{node:Ai,value:Ag};}Ai=Ai.parentNode;}return null;},findAncestorByName:function Aa(d,Ai,b,G){Ai=Ai&&Ai.toLowerCase();var Ag=b?d:d&&d.parentNode;while(Ag&&(Ag!=G)){var Ah=Ag.nodeName;if(Ah&&(Ah.toLowerCase()==Ai)){return Ag;}Ag=Ag.parentNode;}return null;},contains:function M(Ag,Ah,b,G){var d=Ah;if(!b){d=d.parentNode;}while(d){if(d==Ag){return true;}if(d===G){break;}d=d.parentNode;}return false;},preventDefault:function AT(G,b){if(!b){b=G.event;}if(b.preventDefault){b.preventDefault();}else{b.returnValue=false;}},stopPropogation:function l(G,b){if(!b){b=G.event;}if(b.stopPropogation){b.stopPropogation();}else{b.cancelBubble=true;}},firstTouch:function C(G,b){return b&&b.touches&&b.touches.length?b.touches[0]:(b||G.event);},firstChangedTouch:function I(G,b){return b&&b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:(b||G.event);},isLandscape:function X(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function(G){while(G){var b=G.mstrmojoId;if(b!=null){return mstrmojo.all[b];}G=G.parentNode;}return null;},setCaret:function(G,d){if(G.setSelectionRange){G.focus();G.setSelectionRange(d,d);}else{if(G.createTextRange){var b=G.createTextRange();b.move("character",d);b.select();}}}});var AH=mstrmojo.dom,c=window,n=document,U=n&&n.documentElement,q=n&&n.body;if(c.innerWidth){AH.getHorizontalScroll=function(){return c.pageXOffset;};AH.getVerticalScroll=function(){return c.pageYOffset;};}else{if(U&&U.clientWidth){AH.getHorizontalScroll=function(){return U.scrollLeft;};AH.getVerticalScroll=function(){return U.scrollTop;};}else{if(q.clientWidth){AH.getHorizontalScroll=function(){return q.scrollLeft;};AH.getVerticalScroll=function(){return q.scrollTop;};}}}})();(function(){mstrmojo.boxmodel={rangeIntersect:function C(H,F,G,E){if(H<G){return G<=F;}else{if(H>G){return H<=E;}else{return true;}}},px2Inches:function A(F,E){E=parseInt(E,10);return parseFloat((E/F.zf/F.dpi).toFixed(4),10);},offset:function D(G,F){var I=G,E=0,H=0;while(G){E+=G.offsetLeft;H+=G.offsetTop;G=G.offsetParent;if(G===F){break;}}for(e=I&&I.parentNode;e&&e!=F;e=e.parentNode){if(e.scrollTop){H-=e.scrollTop;}if(e.scrollLeft){E-=e.scrollLeft;}}return{left:E,top:H};},convert2px:function B(H,F){if(!/px$/.test(F)){var E=document.createElement("img"),G;E.style.zIndex=-1;E.style.left=F;H.appendChild(E);G=E.style.pixelLeft;H.removeChild(E);return G+"px";}else{return F;}}};})();(function(){mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Object,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",callback:null,ob:null,item:null,path:mstrConfig.taskURL,fetchFolderContents:function(A,B,E){this.ob=A;this.item=B;this.callback=E;var C=this.ob.blockCount,D={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:C,includeAncestorInfo:true,includeObjectDesc:A.includeObjectDesc};if(A.folderLinksContextId){D.folderLinksContextId=A.folderLinksContextId;}if(A.sId){D.sessionState=A.sId;}if(B.fid){D.rootFolderID=B.fid;}else{if(B.fty){D.rootFolderType=B.fty;}}if(A.browsableTypes){D.objectType=A.browsableTypes;}if(B.blockBegin){D.blockBegin=B.blockBegin;}if(B.searchPattern){D.searchPattern=B.searchPattern;if(B.recursive){D.recursive=B.recursive;}}mstrmojo.xhr.request("POST",this.path,E,D,undefined,this.XServer,this.baseParams);},newFolder:function(D,E,C,A){var B={taskId:"createFolder",folderID:D,name:E,description:C};mstrmojo.xhr.request("POST",this.path,A,B,undefined,this.XServer,this.baseParams);}});})();mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){function G(S,V,U){var W=this._layoutWidgets[V],Z=S.slot,X=W.f,Y=W.p,T=(X&&X[Z]!==undefined),R=(Y&&Y[Z]!==undefined);if(Z&&((!U&&T)||R)){return T?X[Z]:(W.x*parseInt(Y[Z],10)/100)+"px";}return S[(V==="h")?"height":"width"];}function Q(T,S,R){if(T.ignoreLayout){return ;}if(T.setDimensions){T.setDimensions(S,R);}else{if(T.set){T.set("height",S);T.set("width",R);}}}function I(U){var S=this.children,W,Y;for(W=0,Y=(S&&S.length)||0;W<Y;W++){var T=S[W],Z=T.slot;if(Z){var X=G.call(this,T,"h",U),a=G.call(this,T,"w",U);this.setSlotDimensions(Z,X,a);Q(T,X,a);var R=G.call(this,T,"h",U),V=G.call(this,T,"w",U);if(R!==X||V!==a){Q(T,R,V);}this.setSlotDimensions(Z,R,V);}}this.afterLayout();}function F(X,T,V){var W=X.slot,U=T&&T.a;if(!U||U[W]===undefined){return ;}var R=this[W]["offset"+V],S=U[W];if(R===S){return ;}T.x-=(R-S);U[W]=R;}function N(R){this.beforeLayout();var S=this._layoutWidgets,T=R.src;F.call(this,T,S.h,"Height");F.call(this,T,S.w,"Width");I.call(this,true);}function E(T,W){if(!T){return null;}var R=this.children,d=W.toLowerCase(),X=parseInt(this[d],10),a,b,V,S,Y,Z,U,f,c;for(c in T){f=T[c];if(f.match(/px$/)){X-=parseInt(f,10);a=a||{};a[c]=f;}else{if(f.match(/\%$/)){b=b||{};b[c]=f;}else{V=V||{};V[c]=f;}}}if(V&&b){for(Y=0,Z=(R&&R.length)||0;Y<Z;Y++){U=R[Y];c=U.slot;if(U.slot&&V[c]&&!U.ignoreLayout){S=S||{};if(U.hasRendered){S[c]=this[U.slot]["offset"+W];X-=S[c];}else{S[c]=0;U.attachEventListener((U instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,N);}}}}return{f:a,p:b,a:S,x:X};}mstrmojo._HasLayout={_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function O(R){this._super(R);this.layoutConfig=mstrmojo.hash.clone(this.layoutConfig);},preBuildRendering:function M(){var T=this.cssText||"";var R=this.height;if(R&&R!=="auto"){T+="height:"+this.height+";";}var S=this.width;if(S&&S!=="auto"){T+="width:"+this.width+";";}this.cssText=T;return(this._super)?this._super():true;},postBuildRendering:function B(){this.doLayout();return this._super();},doLayout:function A(){var R=this.layoutConfig;if(!R){return ;}this.beforeLayout();this._layoutWidgets={h:E.call(this,R.h,"Height"),w:E.call(this,R.w,"Width")};I.call(this,false);},browserResized:function L(R){this.setDimensions(R.h,R.w);return true;},onwidthChange:function P(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.width=this.width;this.doLayout();},onheightChange:function D(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.height=this.height;this.doLayout();},adjustParentDimensions:function C(){var S=this.parent,R=S&&S._layoutWidgets;if(R){F.call(S,this,R.h,"Height");F.call(S,this,R.w,"Width");}},setDimensions:function K(T,S){if(this.height!==T||this.width!==S){this.height=T;this.width=S;var R=this.domNode;if(R){R.style.height=T;R.style.width=S;this.doLayout();}return true;}return false;},setSlotDimensions:function H(U,T,S){var R=this[U]&&this[U].style;if(!R){return ;}if(T!==undefined&&R.height!==T){R.height=T;}if(S!==undefined&&R.width!==S){R.width=S;}}};mstrmojo._HasLayout.getSlotSize=function J(U,V){var S=U&&U.prototype.layoutConfig;if(S){var T=S.h,R=S.w;return{h:(T&&T[V])||undefined,w:(R&&R[V])||undefined};}return null;};}());(function(){mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,tooltipNode:null,postBuildRendering:function(){var B;if(this._super){B=this._super();}if(this.useRichTooltip){var D=this.tooltipNode||this.domNode,C=mstrmojo.dom,A=D&&D.getAttribute("title");if(A){D.setAttribute("title","");}if(!this._ontooltipover){var E=this.id;this._ontooltipover=function(G){var F=mstrmojo.all[E];F.showTooltip(G,self);};this._ontooltipout=function(G){var F=mstrmojo.all[E];F.hideTooltip(G,self);};}C.attachEvent(D,"mouseover",this._ontooltipover);C.attachEvent(D,"mouseout",this._ontooltipout);}return B;},showTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.open(this,B,A);},hideTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.close();},unrender:function(A){var C=this.tooltipNode||this.domNode,B=mstrmojo.dom;if(C&&this._ontooltipover){B.detachEvent(C,"mouseover",this._ontooltipover);}if(C&&this._ontooltipout){B.detachEvent(C,"mouseout",this._ontooltipout);}if(this._super){this._super(A);}}});})();mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function rqMth(B){if(!B){return ;}if(typeof (this[B])==="function"){return true;}else{var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof (A)==="string"){this.requiresCls(A);return typeof (this[B])==="function";}return false;}},requiresCls:function req(mixins,callback){if(mixins){if(typeof (mixins)=="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin;for(var i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof (A)=="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresES(E,F,B){if(E&&E instanceof Array){if(E.length==0){F&&F.call(B);return ;}if(E[0].forceReload&&E[0].forceReload==false&&mstrmojo.LoadedExternalJSURLs[E[0].url]){E.splice(0,1);return this.requiresExternalScripts(E,F,B);}var A=document.createElement("script"),C=!!document.all;A.type="text/javascript";A.src=E[0].url;if(!E[0].callbackParamName){if(C){A.onreadystatechange=function(){if(A.readyState=="loaded"||A.readyState=="complete"){A.onreadystatechange=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}}};}else{A.onload=function(){A.onload=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}};}}else{if(E[0].callbackParamName.length!=0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy==true){var D=this;window.setTimeout(function(){D.requiresExternalScripts(E,F,B);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+E[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=E;mstrmojo._LoadsScript.callback=F;mstrmojo._LoadsScript.esScritsContext=B;}}document.getElementsByTagName("head")[0].appendChild(A);}}});(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var BasicAggMap={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"};function _sortFunctions(fcts){var fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);},i,len;fcts=fcts.sort(fs);for(i=0,len=fcts.length;i<len;i++){fcts[i].fns=fcts[i].fns.sort(fs);}return fcts;}function getBasicCategoryIndex(fcts){var Agg_Func_Greatest="B2C0FA4020C711D6AD1400C04F0423DE",len=fcts.length,ci;for(ci=0;ci<len;ci++){var fns=fcts[ci].fns;if(mstrmojo.array.find(fns,"did",Agg_Func_Greatest)>-1){return ci;}}mstrmojo.alert("No Basic Functions found!");}function buildTaskParams(params){var qse=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();params=mstrmojo.hash.copy(params,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false,sessionState:mstrApp.sessionState});if(qse){params.quickSearch=qse;params.nameWildcards=16,params.sortKey=-1;}return params;}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getMetricDefintion:function getMetricDefintion(params,callbacks){var taskParams={taskId:"getMetricDefinition",metricId:params.id,outputFlags:65599,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},validateMetric:function validateMetric(params,callbacks){var taskParams={taskId:"validateMetric",metricId:params.metricId,tokenStreamXML:params.tokenStreamXML,metricXML:params.metricXML,outputFlags:327695,sessionState:mstrApp.sessionState};if(mstrmojo.string.isEmpty(params.metricId)){taskParams.isNew=true;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getMetricComponents:function getMetricComponents(params,callbacks){var me=this,mc=this.metricComponents;if(!this.noCache&&mc&&mc.items.length==mc.sz){callbacks.success(mc);return ;}else{callbacks.success=mstrmojo.func.composite([callbacks.success,function(res){if(me.metricComponents&&me.metricComponents.items){me.metricComponents.items.push(res.items);}else{me.metricComponents=res;}}]);}var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||24,objectType:params.objectType||"11,12,13,43"});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getAttributes:function getAttributes(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||26,objectType:12});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getFacts:function getFacts(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||29,objectType:13});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getMetrics:function getMetrics(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||5,objectType:4});if(params.isVerify){taskParams.nameWildcards=2;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getFunctions:function getFunctions(callbacks){var me=this,wss=window.sessionStorage,fcts=this.functions||wss&&wss.getItem("functions"),localeId=wss&&wss.getItem("mstrLocaleId"),cLocaleId=mstrApp&&mstrApp.localeId;if(fcts&&localeId==cLocaleId){fcts=_sortFunctions(eval("("+fcts+")").fncs);callbacks.success(fcts);}else{var cb={failure:callbacks.failure,textResponse:true},taskParams={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2,sessionState:mstrApp.sessionState,includeFunctionHelpTopic:true};cb.success=function(res){if(wss){wss.setItem("functions",res);wss.setItem("mstrLocaleId",cLocaleId);}me.functions=res;fcts=_sortFunctions(eval("("+res+")").fncs);callbacks.success(fcts);};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,taskParams);}},getAggFunctions:function getAggFunctions(){if(this._aggFunctions){return this._aggFunctions;}var fcts=this.functions||window.sessionStorage&&window.sessionStorage.getItem("functions");if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[getBasicCategoryIndex(fcts)].fns,function(item){var did=item.did,retVal;if(did!=="B2C0FA4020C711D6AD1400C04F0423DE"&&did!=="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=BasicAggMap[did];}return retVal;});return fcts;},getFunctionCatList:function getFunctionCatList(){if(this._functionCatList){return this._functionCatList;}var fcts=this.functions||window.sessionStorage&&window.sessionStorage.getItem("functions");if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.hash.make(fcts,mstrmojo.Arr);this._functionCatList=fcts;return fcts;},getFunctionDetails:function getFunctionDetails(params,callbacks){var taskParams={taskId:"getSystemFunctions",functionId:params.did,includeFunctionDetails:true,sessionState:mstrApp.sessionState,includeFunctionHelpTopic:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getTransformations:function getTransformations(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||38,objectType:43});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getFilters:function getFilters(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||4,objectType:1});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getAttributeForms:function getAttributeForms(params,callbacks){var taskParams={taskId:"getAttributeForms",attributeID:params.attributeID,displayedForms:params.displayedForms,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getSubtotalFunctions:function getSubTotalFunctions(params,callbacks){var taskParams=buildTaskParams({objectType:"1025,1026",searchPattern:""});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},isBasicAggMap:function isBasicAggMap(did){var retVal=!!BasicAggMap[did];if(did==="B2C0FA4020C711D6AD1400C04F0423DE"||did==="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=false;}return retVal;},getFunctionHelpTopic:function getFunctionHelpTopic(h){return'<a href="'+((mstrApp.helpUrl||"../help/")+"FunctionsRef/index.html?context=functionsref&topic="+(h||""))+'" target="_new">'+mstrmojo.desc(5811,"Details ...")+"</a>";}});})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var B=false,D="mstrmojo.Binding",A="bindings",C=mstrmojo.registry;function E(K){for(var L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function F(K,M){if(!B){mstrmojo.requiresCls(D);B=true;}for(var N in K){var J=K[N];if(J==null){continue;}var L=typeof (J);if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=C.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function G(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[A]);if(K){delete this[A];this._set_bindings(A,K,true);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children;if(M){for(var L=0,J=M.length;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function I(){var J=this.bindings;if(J){E(J);delete this.bindings;}},_set_bindings:function H(L,J){var K=this[A];if(J!==K){if(K){E(K);}this[A]=J;if(J){F(J,this);}return true;}return false;}});})();(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom");var M=mstrmojo.string,T=mstrmojo.dom;var N=mstrmojo.useFrames?null:document.createElement("span");var B=/\mstrAttach\:([\w\,]+)/g;var R;function O(X){if(R===undefined){R=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return X.replace(B,function W(c,f){var Z=f.split(","),a=[],Y=Z.length,b;for(b=0;b<Y;b++){var d=Z[b];if(d){if(R){if(d.indexOf("mouse")>-1){continue;}else{if(d==="click"){d="touchend";}}}a.push("on"+d+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+d+"', self, event)\"");}}return a.join(" ");});}var P="preBuildRendering",D="buildRendering",A="postBuildRendering";function E(Y){var X=Y.markupString;if(X.match(/mstrAttach:/)){X=O(X);if(Y.markupString===Y.constructor.prototype.markupString){Y.constructor.prototype.markupString=X;}}var W=M.apply(X,Y);if(W){if(mstrmojo.useFrames){var Z=(Y.domNode&&Y.domNode.ownerDocument)||self.document;if(!N||N.ownerDocument!==Z){N=Z.createElement("span");}}N.innerHTML=W;var a=N.firstChild;a.mstrmojoId=Y.id;return a;}return null;}function J(Y){var X=Y.markupSlots,W,Z;if(X){W={};for(Z in X){W[Z]=X[Z].apply(Y,[]);}}return W;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function G(){if((this[P]&&this[P]()===false)||(this[D]()===false)||(this[A]&&this[A]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var W="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,W)){this.raiseEvent({name:W});}return true;},buildDom:function S(){return E(this);},preBuildRendering:mstrmojo.emptyFn,buildRendering:function C(){var W=this.domNode,X=this.buildDom();this.domNode=X;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(J(this));this.paint();if(X){var a=W;if(!a){a=this.placeholder;if(a){if(typeof a==="string"){a=document.getElementById(a);}delete this.placeholder;}}if(a){T.replace(a,X);}}var Y="onchildRenderingChange",Z=this.parent;if(Z&&Z[Y]){Z[Y](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function Q(Y){if(this.hasRendered){if(!Y){try{var W=this.domNode;if(W.parentNode){W.parentNode.removeChild(W);}if(mstrmojo.dom.isIE&&W.outerHTML!=="undefined"){W.outerHTML="";}}catch(X){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function V(){var X=this.markupMethods;if(!X){return ;}var a=this,b=function(h){var d=X[h];if(d){try{d.apply(a,[true]);}catch(g){throw new Error(["Error in markup method.","Widget id: "+a.id,"Method name: "+h,"Err: "+g.message].join("\n\n"));}}};var Z=X.sequence,W,Y,c;if(Z){W=Z.length||0;for(Y=0;Y<W;Y++){b(Z[Y]);}}else{for(c in X){b(c);}}},refresh:function F(W){if(this.hasRendered){var X=this.domNode;this.unrender(true);this.placeholder=X;if(W){W();}this.render();}},set:function L(Z,W){this._super(Z,W);if(this.domNode){var X=this.markupMethods,Y=X&&X["on"+Z+"Change"];if(Y){Y.apply(this);}}return this;},slotNames:null,addSlots:function I(X){var W=this.slotNames,Y;if(!W){W={};this.slotNames=W;}for(Y in X){this[Y]=X[Y];W[Y]=true;}},removeSlots:function K(W){if(W){var X=this.slotNames,Y;for(Y in W){delete this[Y];if(X){delete X[Y];}}}},captureDomEvent:function H(Y,W,Z,X){if(this.enabled!==false){this.raiseEvent({name:Y,hWin:W,e:Z||W.event,config:X});}},playEffect:function U(X){var W=this[X];if(W&&W.constructor===Object){W=mstrmojo.insert(mstrmojo.hash.clone(W));W.widget=this;this[X]=W;}if(W){W.play();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=mstrmojo.dom;function E(J,I){var G=[];if(J){for(var F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function D(L,F,N){var I=N.hWin,J=N.e,G=A.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=A.ctrlKey(I,J),O=A.shiftKey(I,J);if(K||O){A.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}},premouseup:function C(H,K,G){var F=G.hWin,J=G.e,L=A.ctrlKey(F,J),I=A.shiftKey(F,J);if(L||I){A.clearBrowserHighlights(F);}},onadd:function B(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=E(K,G);for(var J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function B(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){for(var H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);for(var J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var I=mstrmojo.dom;var L="mousedown";function P(S){var R=S[S.hotSlot||"domNode"];if(R){if(!S._closeCallback){var U=S.id,T=function(V){return function(X){var W=mstrmojo.all[U];if(W&&!W.ignoreHover){W["auto"+V](X,self);}};};S._uncloseCallback=T("Unclose");S._closeCallback=T("Close");}I.attachEvent(R,"mouseover",S._uncloseCallback);I.attachEvent(R,"mouseout",S._closeCallback);}}function C(S){if(S._closeCallback){var R=S[S.hotSlot||"domNode"];if(R){I.detachEvent(R,"mouseover",S._uncloseCallback);I.detachEvent(R,"mouseout",S._closeCallback);}}}function N(T,S){var R=T;while(R){if(R.open||R.openPopup){if(R.set){R.set("ignoreHover",S);}else{R.ignoreHover=S;}}R=R.opener||R.parent;}}function A(){var R=this._lockHoverCallback;if(R){I.detachEvent(document.body,L,R,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose={autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function B(){this._super();if(this.autoCloses){P(this);}this.oncloseOnClickChange();},onautoClosesChange:function D(){var R=(this.autoCloses)?P:C;R(this);},oncloseOnClickChange:function O(){if(!this.curtainNode){return ;}var T=this,S="click",R=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(R){S="touchstart";}I.attachEvent(T.curtainNode,S,function(){T.close();if(R){mstrmojo.touchManager.notify([]);}});},autoUnclose:function H(){var R=this._autoCloseTimer;if(R){self.clearTimeout(R);delete this._autoCloseTimer;}},autoClose:function F(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var R=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[R].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function M(R){A.call(this);this._super(R);},lockHover:function K(){N(this,true);if(!this._lockHoverCallback){var S=this.id,R=this._lockHoverCallback=function(T){mstrmojo.all[S]._unlockHoverCheck(T,self);};if((I.isIE7||I.isIE8)&&window.event&&(window.event.type==L)&&this.opener){this.opener._ignoreMousedown=true;}I.attachEvent(document.body,L,R,true);}},unlockHover:function E(){N(this,false);A.call(this);},_unlockHoverCheck:function J(T,R){var S=this.opener;if(S&&S._ignoreMousedown){delete S._ignoreMousedown;return ;}if(!I.contains(this.domNode,I.eventTarget(R,T),true,document.body)){this.close();}},open:function G(S,R){if(this.autoCloses){this.autoUnclose();}this._super(S,R);if(this.locksHover){this.lockHover();}},close:function Q(R){if(this.locksHover){this.unlockHover();}this._super(R);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=false,P=mstrmojo.dom,S=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(T){return false;},queryEnabled:function(T){return true;},queryVisible:function(T){return true;},executeCommand:function O(T){},item2textCss:function E(T){return T.cssClass||T.cmdId||("cmd"+T[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var Z=this._subMenu,X=this.getMenuPosition();if(!Z){var b=(this.menuZIndex||this.zIndex||10)+1,V={left:X.x+"px",top:X.y+"px",zIndex:b,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};Z=new mstrmojo.ContextMenu(V);Z.render();this._subMenu=Z;}else{Z.set("left",X.x+"px");Z.set("top",X.y+"px");}if(this.dynamicUpdate){var U=Z.ctxtBuilder.itemWidgets,W=U&&U.length,T,Y,a=this.getContextMenuSource();for(T=0;T<W;T++){Y=U[T];if(a.queryVisible){Y.set("visible",a.queryVisible(Y.data));}if(a.queryChecked){Y.set("checked",a.queryChecked(Y.data));}if(a.queryEnabled){Y.set("enabled",a.queryEnabled(Y.data));}}}Z.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var T=this._subMenu;if(T&&T.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function N(){var T=this._subMenu,W=this._subMenu.domNode,V=W.offsetHeight,U=W.offsetWidth,Z=P.windowDim(),Y=P.position(W,false),X=P.position(W,true);if((Y.x+U+S)>Z.w){T.set("left",(Z.w-U-S+(X.x-Y.x))+"px");}if((Y.y+V+S)>Z.h){T.set("top",(Z.h-V-S+(X.y-Y.y))+"px");}},attachMousedownEvent:function L(){var T=this;if(!this._close_handler){this._close_handler=function(){if(!T.isOnMySubmenu(P.eventTarget(self,arguments[0]))){T.closeMenuTree();}};}P.attachEvent(document.body,"mousedown",this._close_handler);},isOnMySubmenu:function M(X){var U=this._subMenu;if(!U){return false;}if(P.contains(U.domNode,X,true,document.body)){return true;}var Y=U.ctxtBuilder.itemWidgets,T=Y&&Y.length,W,V;for(W=0;W<T;W++){V=Y[W];if(V.isOnMySubmenu(X)){return true;}}return false;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function R(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var T=P.position(this.domNode,true);return{x:Math.round(T.x),y:Math.round(T.y+T.h)};},isSeparatorItem:function G(T){return T[this.itemIdField]===-1||T[this.itemField]==="-";},hasSubmenu:function K(T){return !!T[this.itemChildrenField];},closeMenuTree:function Q(V){var U=this.activeMenuItem,T=this._cmSource||this;if(!U){if(V){this.activeMenuItem=V;}else{T.hideContextMenu();}return ;}if(U===V){return ;}if(V){this.activeMenuItem=V;if(V.parent.parent===U){return ;}if(V.parent===U.parent){U.hideContextMenu();return ;}}else{V=T;this.activeMenuItem=null;}U.hideContextMenu();while(U!==T){U=U.parent.parent;if(U!==V||T===V){U.hideContextMenu();if(T===V){P.detachEvent(document.body,"mousedown",this._close_handler);}}if(U.parent===V.parent){break;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var F=mstrmojo.dom,L=mstrmojo.string;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:F.isNSIE?"block":"table",DISPLAY_CELL:F.isNSIE?"block":"table-cell",MINHEIGHT:F.isIE6?"height":"minHeight",addClass:function H(V,U){if(!V){return ;}if(U.constructor!==Array){U=[U];}var R=V.className||"",X=" "+R+" ",S=false;for(var T=0,Q=U.length;T<Q;T++){var W=U[T];if(!X.match(new RegExp("\\s"+W+"\\s"))){R+=" "+W;S=true;}}if(S){V.className=L.trim(R);}},removeClass:function M(U,T){if(!U){return ;}if(T.constructor!==Array){T=[T];}var R=" "+(U.className||"")+" ";for(var S=0,Q=T.length;S<Q;S++){R=R.replace(new RegExp("\\s"+T[S]+"\\s","g")," ");}U.className=L.trim(R);},addWidgetCssClass:function G(T,R){var Q=T.cssClass,S=(Q&&Q.split(" "))||[];if(R.constructor!==Array){R=[R];}T.cssClass=S.concat(R).join(" ");},toggleClass:function N(S,R,Q){if(Q){this.addClass(S,R);}else{this.removeClass(S,R);}},applyShadow:function D(U,V,T,S,Q){var R=U.style;if(F.isDXIE){R.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+V+"px, OffY="+T+"px, Color='"+Q+"')";}else{if(F.isFF||F.isWK||F.isIE10){R[F.CSS3_BOXSHADOW]=V+"px "+T+"px "+S+"px "+Q;}}},removeShadow:function O(R){var Q=R.style;if(F.isDXIE){}else{if(F.isFF||F.isWK||F.isIE10){Q[F.CSS3_BOXSHADOW]="";}}},setOpacity:function A(R,T){if(F.isDXIE&&!F.isIE9){var U=R.currentStyle.filter;var Q=null;if(U.length>0){Q=R.filters["DXImageTransform.Microsoft.Alpha"];}if(Q){Q.opacity=T;Q.enabled=(T!=100);}else{if(T<100){var S="progid:DXImageTransform.Microsoft.Alpha(Opacity="+T+")";R.style.filter=(U?U:"")+" "+S;}}}else{R.style.opacity=T/100-(F.isIE9?0.00001:0);}},buildGradient:function C(R,T,Q){if(F.supports(F.cssFeatures.GRADIENTS)){var S={};if(F.isDXIE){S.n="filter";S.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+R+",StartColorStr='"+T+"',EndColorStr='"+Q+"')";}else{if(F.isFF){S.n="background-image";S.v="-moz-linear-gradient("+((R===0)?"top":"left")+","+T+","+Q+")";}else{if(F.isWK){S.n="background";S.v="-webkit-gradient(linear,"+((R===0)?"left top, left bottom":"left top, right top")+",from("+T+"),to("+Q+"))";}else{if(F.isIE10||F.isIEW3C){S.n="background";S.v="linear-gradient("+((R===0)?"to bottom":"to right")+","+T+","+Q+")";}}}}return S;}return null;},buildRoundCorners:function K(V,U){if(F.supports(F.cssFeatures.ROUND_CORNERS)){var R=V+"px";var X=R+((U)?" "+R+" 0 0":"")+";";if(F.isFF){return"-moz-border-radius:"+X;}else{if(F.isWinPhone||F.isIE10){return"border-radius:"+X;}else{if(F.isWK){if(!U){return"-webkit-border-radius:"+R+";";}else{var W=["left","right"],T=[],Q=-1;for(var S=0;S<2;S++){T[++Q]="-webkit-border-top-"+W[S]+"-radius:"+R;T[++Q]="-webkit-border-bottom-"+W[S]+"-radius:0";}return T.join(";");}}}}}return"";},getBorderWidthsOrPaddings:function E(R,U){var V={t:0,r:0,b:0,l:0,h:0,w:0};if(!R){return V;}var S=R.split(" "),Q=S.length;for(var T=0;T<Q;T++){S[T]=Math.round(U*parseFloat(S[T],10)/72);}if(Q<4){if(Q===1){S[1]=S[2]=S[3]=S[0];}else{S[3]=S[1];if(Q===2){S[2]=S[0];}}}V.t=S[0];V.r=S[1];V.b=S[2];V.l=S[3];V.h=V.t+V.b;V.w=V.l+V.r;return V;},getBorderWidths:function I(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},getPaddings:function J(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},parkAfterFade:function P(Q){var R=Q.target.style;if(R.opacity==0){R.left="-10000px";window.setTimeout(function(){R.opacity=0.99;},0);return true;}return false;},getStyleValue:function B(Q,S){if(Q.currentStyle){S=S=="float"?"styleFloat":S;value=Q.currentStyle[S];}else{if(document.defaultView&&document.defaultView.getComputedStyle){S=S=="float"?"cssFloat":S;var R=document.defaultView.getComputedStyle(Q,null);value=R?R[S]:null;}}return value;},getComputedStyle:function(Q,S){var R=(window.getComputedStyle)?function(T,U){return window.getComputedStyle(T,U||null);}:function(T){return T.currentStyle||{};};mstrmojo.css.getComputedStyle=R;return R(Q,S);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,E=false;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function(){var F=C.windowDim(),J=(C.isFF||C.isWK)?0:2;var G=F.w,I=F.h;if(E){var H=I;I=G;G=H;}return{w:Math.max(G,0)+"px",h:Math.max(I-J,0)+"px"};},simulateOrientationChange:function A(){E=!E;this.monitorWindow();},preBuildRendering:function B(){var G=true;if(this._super){G=this._super();}var H=this.getBrowserDimensions();if(!("browserResized" in this)||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return G;},destroy:function D(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function(F){var H=F.currentTarget,I=this.getBrowserDimensions(),G={w:(H?H.innerWidth+"px":I.w),h:(H?H.innerHeight+"px":I.h)};if(G.h===this.height&&G.w===this.width){return ;}if(!("browserResized" in this)||this.browserResized(G)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var R=mstrmojo.dom,P=mstrmojo.hash;var M=100;var E=R.supportsTouches?0.5:1;var F=1;var Q=100;var N={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var K=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[R.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[R.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[R.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[R.CSS3_TRANSITION]=this.decelerating?(R.CSS3_PREFIX+"transform 0.2s linear"):"";}},P.copy(N));var G=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},P.copy(N));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function L(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=P.copy(R.isSafari?K:G,P.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}R.attachEvent(U,R.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){R.detachEvent(T,R.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function I(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}R.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=R.getMousePosition(R.firstTouch(T,V),T);this.dragging=false;R.attachEvent(window,R.TOUCHMOVE,this._tmCallback);R.attachEvent(window,R.TOUCHEND,this._teCallback);},touchesMoved:function D(b,d){var Z=R.getMousePosition(R.firstTouch(b,d),b);R.preventDefault(b,d);if(!this.dragging){var T=5,h=Math.abs;if((this.scrollsHoriz&&h(Z.x-this.pos.x)>T)||(this.scrollsVert&&h(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},f={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=f;this.maxPos={x:Math.max(f.x-Y.x,0),y:Math.max(f.y-Y.y,0)};this.showScroll();}}if(this.dragging){R.stopPropogation(b,d);var c=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(c.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(c.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),g=this.lastDragTime;this.nextLastDragTime=g;this.lastDragTime=U;if((U-g)>Q){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function H(T,U){R.preventDefault(T,U);R.detachEvent(window,R.TOUCHMOVE,this._tmCallback);R.detachEvent(window,R.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;R.stopPropogation(T,U);if((new Date())-this.lastDragTime<=Q){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=R.getMousePosition(R.firstChangedTouch(Y,Z),Y),c=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-c.x,y:W.y-c.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),d=T?(new Date())-T:0,V={x:d?Number(b.x*M*E/d).toFixed(2):0,y:d?Number(b.y*M*E/d).toFixed(2):0};var a=this,U=function(f){return(a.scrollsHoriz&&Math.abs(f.x)>=F)||(a.scrollsVert&&Math.abs(f.y)>=F);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,M);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=(b)?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=(b)?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function J(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function O(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof (W)=="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget.apply(this,[]);}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children;for(var Y=0,W=(X&&X.length)||0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);for(var X=0,W=(Y&&Y.length)||0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props;for(var Z in Y){var X=Y[Z],W=X.ease;if(typeof (W)=="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props;for(var a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}else{return parseInt(W*Y,10)/W;}}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}else{if(X===0){return W;}else{return W+Z*I(X,Y);}}},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}else{return W+Z*Math.sin((Math.PI/2)*X/Y);}},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}else{return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}else{if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}else{if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}else{return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;}}}},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}else{return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.shouldEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){if(this.shouldEllipsize){A(this);mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered&&this.shouldEllipsize){this.doEllipsize();}}},this.markupMethods);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,D=mstrmojo.hash;function C(X,V){if(!V){return ;}var Y=[],O=X.selectedIndices,N=X.allIdx,T=X.noneIdx,P=X.parent&&X.parent.include;if(X.multiSelect&&(T>-1)&&(G.indexOf(V,T)>-1)){return Y;}var R,S,W=X.items,U=X.itemIdField,Q=X.selectedItems,a;if(X.multiSelect&&(N>-1)&&(G.indexOf(V,X.allIdx)>-1)){for(R=0,S=W.length;R<S;R++){if(!O[R]){Y.push(R);O[R]=true;X.selectedIndex=R;X.selectedItem=W[R];}}}else{for(R=0,S=V.length;R<S;R++){var Z=V[R];if(!O[Z]){O[Z]=true;Y.push(Z);X.selectedIndex=Z;a=X.selectedItem=W[Z];if(Q){Q[a[U]]=a;}}}}return Y;}function A(P){var O=[],Q=P.selectedIndices,R=P.selectedItems;for(var N in Q){delete Q[N];O.push(parseInt(N,10));}P.selectedIndex=-1;P.selectedItem=null;if(R){P.selectedItems={};}return O;}function L(W,V){if(!V){return ;}var S=[],O=W.selectedIndices,Y=G.indexOf,N=W.allIdx,T=W.noneIdx,U=W.itemIdField,P=W.selectedItems;if(W.multiSelect&&(((N>-1)&&(Y(V,N)>-1))||((T>-1)&&(Y(V,T)>-1)))){return A(W);}if(V.length>0&&O[N]){if(Y(V,N)<0){V.push(N);}}for(var Q=0,R=V.length;Q<R;Q++){var X=V[Q];if(O[X]){delete O[X];S.push(X);if(P){delete P[W.items[X][U]];}if(W.selectedIndex==X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function F(Q,P,R,N){if(Q.raiseEvent){Q.raiseEvent({name:"select",idxs:N||[]});if((P&&P.length)||(R&&R.length)){try{Q.raiseEvent({name:"selectionChange",added:P,removed:R});}catch(O){L(Q,P);C(Q,R);throw O;}}}}function I(P,O){if(O==null){return -1;}var N=typeof (O)=="object",Q=P.itemIdField;if(N&&Q!=null){return G.find(P.items,Q,O[Q]);}else{return G.indexOf(P.items,O);}}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(N){this._super(N);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function M(W){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this.items,N=this.items.length,Q=this.selectedItems,S=[],P;U=this.items=U.concat(W);P=U.length;if(Q){var O=this.selectedIndices,T=this.itemIdField,R,V;for(R=N;R<U.length;R++){V=U[R];if(Q[V[T]]){S.push(R);}}}if(S&&S.length){C(this,S);}if(P>N){this.itemsContainerNode.innerHTML+=this._buildItemsMarkup(N,P-1).join("");}},addSelectedItems:function H(N){this.selectItems(N,false);},setSelectedItems:function K(N){this.selectItems(N,true);},selectItems:function J(W,Y){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this;if(Y&&U.selectedItems){U.selectedItems={};}var P=U.selectedItems,T=U.itemIdField,X,V,Q,N=[],S=U.items.length,R=[],O=U.allowUnlistedValues;for(Q=0;Q<W.length;Q++){X=W[Q];V=I(this,X);if(V===-1){if(P===null){if(O){N.push(v);V=S++;}}else{P[X[T]]=X;}}if(V!==-1){R.push(V);}}if(N.length>0){U.addItems(N);}if(R.length>0){if(Y){U.select(R);}else{U.addSelect(R);}}},unselectItems:function J(O){if(!O){return ;}if(O.constructor!=Array){O=[O];}var S=this,U=S.selectedItems,P=[],T=S.itemIdField,R,N,Q;if(U===null){return ;}for(Q=0;Q<O.length;Q++){R=O[Q];if(U){delete U[R[T]];}N=I(this,R);if(N!==-1){P.push(N);}}if(P.length>0){S.removeSelect(P);}},getSelectedItems:function B(){if(this.selectedItems!=null){return D.valarray(this.selectedItems);}else{return G.get(this.items,D.keyarray(this.selectedIndices,true));}},singleSelect:function(N,O){if(N!==-1){this.select([N],O);}},singleSelectByField:function E(O,P,N){this.singleSelect(G.find(this.items,P,O),N);},toggleSelect:function(N){var P,O;if(this.selectedIndices[N]){O=L(this,[N]);}else{P=C(this,[N]);}F(this,P,O,[N]);},rangeSelect:function(N){},select:function(O,N){if(O==null){return ;}if(O.constructor!=Array){O=[O];}var Q=A(this),S=C(this,O),P=Q.length-1;if(this.selectionPolicy!=="reselect"){for(;P>=0;P--){var R=G.indexOf(S,Q[P]);if(R>-1){Q.splice(P,1);S.splice(R,1);}}}if(!N){F(this,S,Q,O);}},clearSelect:function(N){var O=A(this);if(N!==true){F(this,null,O,[]);}},addSelect:function(P,N){if(P==null){return ;}if(P.constructor!=Array){P=[P];}var O=C(this,P);var R=null,Q=this.noneIdx;if(this.multiSelect&&(Q>-1&&G.indexOf(P,Q)>-1)){R=L(this,P);}if(N!==true){F(this,O,R,P);}},removeSelect:function(N){if(N==null){return ;}if(N.constructor!=Array){N=[N];}F(this,null,L(this,N),N);},_set_selectedIndices:function(P,W,N){var S=this,O=S.selectedIndices;if(S.selectedItems){S.selectedItems={};}var O=S.selectedIndices;if(O==W){return false;}if(!O){O={};S.selectedIndices=O;}if(!W){W={};}var U=S.selectedIndex,T=[],V;for(V in O){if(!W[V]){V=parseInt(V,10);delete O[V];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var Z=[],X=S.items,R=S.itemIdField,Y;for(V in W){if(!O[V]){V=parseInt(V,10);O[V]=true;Z.push(V);S.selectedIndex=V;Y=S.selectedItem=X[V];if(S.selectedItems){S.selectedItems[Y[R]]=Y;}}}if(N!==true){var Q=[];for(V in W){if(O[V]){V=parseInt(V,10);Q.push(V);}}F(S,Z,T,Q);}return(Z.length||T.length);},_set_selectedIndex:function(Q,O,N){var P={};if(O>-1){P[O]=true;}return this._set_selectedIndices("selectedIndices",P,N);},_set_selectedItem:function(Q,P,O){var N=I(this,P);if((N===-1)&&(P!=null)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(P));N=this.items.length-1;}return this._set_selectedIndex("selectedIndex",N,O);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var G="*";var F=".";var I="-";var C="_";var A="<";var E=new RegExp("[\\"+G+"\\"+F+"\\"+I+"\\"+C+"\\"+A+"]","g");var H=G+"$&";mstrmojo.Serializer={scriptClass:"mstrmojo.Serializer",serializeValueGroup:function(B){mstrmojo.array.forEach(B,function(D,J){B[J]=mstrmojo.Serializer.serializeValues(D);});return I+this.serializeValues(B)+C;},serializeValues:function(D){var B=[];mstrmojo.array.forEach(D,function(J){if(typeof (J)==="Boolean"){J=(J)?"1":"0";}B.push(String(J).replace(E,H));});return B.join(F);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo._HasBuilder={postBuildRendering:function B(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function C(){return this.model.getChildren(this.node,false);},buildChildren:function A(E){if(!this.builder||!this.model){return false;}if(this.children&&this.children.length){this.set("children",[]);}var D=this.model,F=this.builder.build(this.getChildren(),D,this.buildConfig);if(!E){this.addChildren(F);}this.builtChildren=true;return(E)?F:true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,L=mstrmojo.hash;function F(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(C.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function B(R){var Q=[],S=R.selectedIndices;for(var P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function N(V,U){var S=[],Q=V.selectedIndices,X=C.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return B(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}for(var R=0,T=U.length;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex==W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V;for(var Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function H(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function O(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=B(this),S=F(this,[P]);if(Q!==true){H(this,S,R);}}},toggleSelect:function J(P,Q){var S,R;if(this.selectedIndices[P]){R=N(this,[P]);}else{S=F(this,[P]);}if(Q!==true){H(this,S,R);}},rangeSelect:function G(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=B(this);if(P!==true){H(this,null,Q);}},select:function E(R,P){var Q=A(this,C.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){H(this,Q.add,Q.rmv);}},addSelect:function M(R,P){if(R==null){return ;}if(R.constructor!==Array){R=[R];}var Q=F(this,R);if(P!==true){H(this,Q,null);}return Q;},removeSelect:function K(R,P){if(R==null){return ;}if(R.constructor!=Array){R=[R];}var Q=N(this,R);if(P!==true){H(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){H(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof (T)=="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=C.find(U,V,T[V]);}else{if(T!=null){Q=C.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function D(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!=null){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return L.keyarray(this.selectedIndices,true).sort(C.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return C.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],u=this.itemIdField!=null?C.findMulti(S,this.itemIdField,Q):C.indexOfMulti(S,Q),V=Q.length,T=V-u.count,r=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(r&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],g=u.map;if(T&&r){var q=0;for(var f=0;f<V;f++){if(g[f]==null){R.push(Q[f]);U.push(b+q++);}}this.add(R,b);}var W=[];for(var l in g){var p=g[l];if(p>=b){p+=X;}W.push(p);}var t=W.concat(U),Y=this.addSelect(t,!d);if(!d){var Z=C.hash(Y),h=this.selectedIndices,a=[];for(var o in h){if(!Z[o]){a.push(parseInt(o,10));}}var P=this.removeSelect(a,true);H(this,Y,P);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",H="";var N=/\+/g;for(var I=0,F=M.length;I<F;I++){var E=M[I].split("=");L=E[0];H=E[1];if(H){H=decodeURIComponent(H.replace(N," "));}var G=document.createElement("INPUT");G.type="HIDDEN";G.name=L;G.value=H;K.appendChild(G);}return false;}mstrmojo.form={createDynamicForm:function A(E){var G=document.createElement("FORM"),H=E.indexOf("?")>0;G.name="dynamic_form";G.method="POST";var F=((H)?E.substring(0,E.indexOf("?")):E);G.action=F;if(H){B(G,E);}document.body.appendChild(G);return G;},send:function D(J,K,E,M,H,F){var O=((H&&H.hWin)||window).document,L=O.createElement("form"),I=mstrApp;L.method=E||"GET";if(M){L.target=M;}L.action=K||I.name;F=(F!==undefined)?F:!(L.action&&L.action.indexOf("aspx")>0);if(I.sessionId){L.action+=";jsessionid="+I.sessionId;}if(F){L.action+=";uxts"+mstrmojo.now();}L.appendChild(C(O,"xts",mstrmojo.now()));for(var P in I.persistTaskParams){J[P]=I.persistTaskParams[P];}if(I.servletState&&I.name){J[I.name]=I.servletState;}if(J){for(var G in J){if(J[G].constructor==Array){mstrmojo.array.forEach(J[G],function(Q){L.appendChild(C(O,G,Q));});}else{L.appendChild(C(O,G,J[G]));}}}O.body.appendChild(L);try{L.submit();}catch(N){if(M&&N.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}O.body.removeChild(L);}};})();(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,f,V,X){var W=b,Z;while(Z=W.match(f)){var c=Z[0],a=c.length,d=true;c=c.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===c){d=false;break;}else{if(c.indexOf(Y)===0){delete U[Y];}}}if(d){U[c]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var d=S.evt2idx,h=S.idx2evt,Z=S.parts;var f=(U>=0)?U:0,b=this.id,W=mstrmojo.all,c=(U>0)?W[h[f-1].context][Z[f-1]]:(S.host?W[S.host]:this.parent),T=Z[f];var V=mstrmojo.array;while(c&&T){if(c.attachEventListener){var g=c[T+"_bindEvents"]||(T+"Change");if(typeof (g)=="string"){g=[g];}var Y=[];for(var a=0,X=g.length;a<X;a++){Y[a]=c.attachEventListener(g[a],b,"_callback");}for(var a=0;a<g.length;a++){d[c.id+"_"+g[a]]=f;}h[f]={context:c.id,evts:g,subs:Y};}c=c[T];T=S.parts[++f];}},_detachChain:function G(S,T){var U=mstrmojo.all,k=S.idx2evt,d=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=k.length;if(Y<b){for(;Y<b;Y++){var Z=k[Y];if(!Z){break;}var W=Z.context,c=U[W],h=Z.evts;if(c&&c.detachEventListener){var l=Z.subs;for(var g=0,V=l.length;g<V;g++){c.detachEventListener(l[g]);}}k[Y]=null;for(var X=0,f=h.length;X<f;X++){delete d[W+"_"+h[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo._HasPopup={openPopup:function B(G,D){var C=!!G&&(typeof (G)==="string")&&!G.match(/\./)&&!!this[G],I=mstrmojo.registry.ref(C?this[G]:G,true);if(I&&I.open){if(C){this[G]=I;}this.disposables.push(I);var F=I.slot&&this[I.slot];if(F){if(I.parent!==this){if(this.addChildren){this.addChildren(I);}else{var H=false,E=I.domNode||I.placeholder;if(E&&typeof (E)==="string"){E=document.getElementById(E);}if(!E){H=true;E=document.createElement("span");I.placeholder=E;}if(H||(E.parentNode!==F)){F.appendChild(E);}}}}I.open(this,D);this._lastOpened=I;}},closePopup:function A(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}};})();(function(){mstrmojo.requiresCls("mstrmojo.locales");var V=function(){return mstrmojo.locales.datetime;},J=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},isDate:function W(Z,d,Y){var b=this.parseDate(Z,Y);var c=!!(b&&this.doesDateExist(b.month,b.day,b.year));if(d){if(c){var a=this.formatDateInfo(b,V().DATEOUTPUTFORMAT);if(Y){return{match:b.match,formatted:a};}else{return a;}}else{return null;}}else{return !!c;}},formatDateInfo:function P(b,d){if(!d){return"";}var Y=b.day,c=b.month,a=b.year;var Z=d.replace(/dd/g,this.formatInteger(Y,2)).replace(/d/g,Number(Y)).replace(/yyyy/g,Number(a)).replace(/yy/g,this.formatInteger(Number(a)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,V().MONTHNAME_FULL[Number(c)-1]).replace(/\~\~\~\~/g,V().MONTHNAME_SHORT[Number(c)-1]).replace(/\@\@/g,this.formatInteger(c,2)).replace(/\^/g,Number(b.month));return Z;},parseDate:function X(l,d,h){if(l==null){return false;}if(typeof (l)!="string"){l=String(l);}l=J.trim(l);var Y=this.CACHE.PARSEDATE[d?"CONTAINS":"EQUALS"],a=Y[l];if(a||(a===null)){return a;}var Z=null;var g;if(h){g=[h];}else{g=[].concat(V().DATEINPUTFORMATS);g.unshift(V().DATEOUTPUTFORMAT);}for(var b=0,c=g.length;b<c;b++){var f=this._buildRegExp4DateFormat(g[b]),k=f&&l.match(d?f.reContains:f.reEquals);if(k){Z={match:k[0],year:f.yearIndex&&this.fourDigitYear(k[f.yearIndex]),day:f.dayIndex&&parseInt(Number(k[f.dayIndex])),month:f.monthIndex&&this.numericMonth(k[f.monthIndex])};break;}}Y[l]=Z;return Z;},isTime:function H(Z,c,Y){var d=this.parseTime(Z,Y);var b=!!(d&&this.doesTimeExist(d.hour,d.min,d.sec));if(c){if(b){var a=this.formatTimeInfo(d,V().TIMEOUTPUTFORMAT);if(Y){return{match:d.match,formatted:a};}else{return a;}}else{return null;}}else{return !!b;}},parseTime:function I(n,d,k){if(n==null){return false;}if(typeof (n)!="string"){n=String(n);}n=J.trim(n);var Y=this.CACHE.PARSETIME[d?"CONTAINS":"EQUALS"],a=Y[n];if(a||(a===null)){return a;}var Z=null;var h;if(k){h=[k];}else{h=[].concat(V().TIMEINPUTFORMATS);h.unshift(V().TIMEOUTPUTFORMAT);}for(var b=0,c=h.length;b<c;b++){var g=this._buildRegExp4TimeFormat(h[b]),l=g&&n.match(d?g.reContains:g.reEquals);if(l){var f=g.ampmIndex&&l[g.ampmIndex];Z={match:l[0],hour:g.hourIndex&&this.capitalHour(l[g.hourIndex],f),min:g.minIndex&&parseInt(Number(l[g.minIndex])),sec:g.secIndex&&parseInt(Number(l[g.secIndex]))};break;}}Y[n]=Z;return Z;},formatTimeInfo:function Q(b,Z){if(!Z){return"";}var a=!(Number(b.hour)%12)?12:(Number(b.hour)%12),Y=Z.replace(/HH/g,this.formatInteger(b.hour,2)).replace(/H/g,Number(b.hour)).replace(/hh/g,this.formatInteger(a,2)).replace(/h/g,a).replace(/mm/g,this.formatInteger(Number(b.min)||0,2)).replace(/m/g,Number(b.min)||0).replace(/ss/g,this.formatInteger(Number(b.sec)||0,2)).replace(/s/g,Number(b.sec)||0).replace(/a/g,(Number(b.hour)<12)?V().AM_NAME:V().PM_NAME);return Y;},doesTimeExist:function F(d,Z,c){var b=parseInt(d);if(b>=0&&b<=23){var Y=parseInt(Z);if(Y>=0&&Y<=59){if(!c){return true;}var a=parseInt(c);if(a>=0&&a<=59){return true;}}}return false;},capitalHour:function C(Y,Z){Y=parseInt(Number(Y));if(Z&&(Z.match(V().AM_NAME)||Z.match(/AM/i))){return Y%12;}else{if(Z&&(Z.match(V().PM_NAME)||Z.match(/PM/i))){return 12+(Y%12);}else{return Y;}}},isDateAndOrTime:function T(Y,Z){return this.isDateTime(Y,Z)||this.isDate(Y,Z)||this.isTime(Y,Z);},isDateTime:function B(k,Y){var c=this.parseDateAndOrTime(k),g=c&&c.date,b=c&&c.time,f=!!g&&!!b&&this.doesDateExist(g.month,g.day,g.year)&&this.doesTimeExist(b.hour,b.min,b.sec);if(Y){if(f){var Z=this.formatDateInfo(g,V().DATEOUTPUTFORMAT),a=this.formatTimeInfo(b,V().TIMEOUTPUTFORMAT),h=k.indexOf(g.match),d=k.indexOf(b.match);return(d<h)?a+" "+Z:Z+" "+a;}else{return null;}}else{return !!f;}},parseDateAndOrTime:function O(Z,Y,d){var a=this.parseDate(Z,true,Y);var b=J.trim((a&&a.match)?Z.replace(a.match,""):Z),c=this.parseTime(b,false,d);if(!a&&!c){return null;}else{return{date:a,time:c};}},inDateTimeRange:function N(a,c,g){var Z=this.parseDateAndOrTime(a),d=Z&&Z.date,h=Z&&Z.time;if(!d&&!h){return 0;}if(c!=null){var b=this.parseDateAndOrTime(c);if(d&&b&&b.date){var k=this.compareDate(d,b.date);if(k<0){return -1;}else{if(k==0){if(h&&b.time&&(this.compareTime(h,b.time)<0)){return -1;}}}}}if(g!=null){var Y=this.parseDateAndOrTime(g);if(d&&Y&&Y.date){var f=this.compareDate(d,Y.date);if(f>0){return 1;}else{if(f==0){if(h&&Y.time&&(this.compareTime(h,Y.time)>0)){return 1;}}}}}return 0;},compareDate:function A(a,Y){if(a==Y){return 0;}var b=typeof (a)=="string"?this.parseDate(a):a,Z=typeof (Y)=="string"?this.parseDate(Y):Y;if(!b){return -1;}if(!Z){return 1;}return(b.year-Z.year)||(b.month-Z.month)||(b.day-Z.day)||0;},compareTime:function K(Z,Y){if(Z==Y){return 0;}var b=typeof (Z)=="string"?this.parseTime(Z):Z,a=typeof (Y)=="string"?this.parseTime(Y):Y;if(!b){return -1;}if(!a){return 1;}return(b.hour-a.hour)||(b.min-a.min)||(b.sec-a.sec)||0;},compareDateTime:function S(Z,Y){return this.compareDate(Z,Y)||this.compareTime(Z,Y);},compareDateAndOrTime:function D(g,d){if(g==d){return 0;}var Z=typeof (g)=="string"?this.parseDateAndOrTime(g):g,Y=typeof (d)=="string"?this.parseDateAndOrTime(d):d;if(!Z){return -1;}if(!Y){return 1;}var f=Z.date,c=Y.date,b=Z.time,a=Y.time;return this.compareDate(f,c)||this.compareTime(b,a);},_buildRegExp4DateFormat:function M(a){if(!a){return null;}var c=this.REGEXPS.DATES[a];if(!c){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=V().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=V().MONTHNAME_SHORT.join("|");}c=this.REGEXPS.DATES[a]={};c.formatStr=a;var Z=c.reStr=a.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");c.reEquals=new RegExp("^"+Z+"$");c.reContains=new RegExp("^"+Z+"\\b");var d=[{key:"monthIndex",index:a.indexOf("M")},{key:"dayIndex",index:a.indexOf("d")},{key:"yearIndex",index:a.indexOf("y")}];d.sort(function(g,f){return g.index-f.index;});var Y=1;for(var b=0;b<3;b++){c[d[b].key]=d[b].index>-1?Y++:null;}}return c;},_buildRegExp4TimeFormat:function E(b){if(!b){return null;}var d=this.REGEXPS.TIMES[b];if(!d){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[V().AM_NAME,V().PM_NAME,String(V().AM_NAME).toLowerCase(),String(V().PM_NAME).toLowerCase()].join("|");}d=this.REGEXPS.TIMES[b]={};d.formatStr=b;var a=b.replace(/\'\'/g,'"');var f=a.match(/\'(.+?)\'/g);a.replace(/\'(.+?)\'/g,"*");a=a.replace(/([^H|h|m|s|z|Z|a|\s])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/gi,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");for(var c=1,Y=f&&f.length||0;c<Y;c++){a=a.replace(/\*/,f[c]);}a=a.replace(/\"/g,"'");d.reEquals=new RegExp("^"+a+"$");d.reContains=new RegExp(a);var g=[{key:"hourIndex",index:b.search(/h|H/)},{key:"minIndex",index:b.indexOf("m")},{key:"secIndex",index:b.indexOf("s")},{key:"ampmIndex",index:b.indexOf("a")},{key:"zoneIndex",index:b.search(/z|Z/)}];g.sort(function(k,h){return k.index-h.index;});var Z=1;for(var c=0;c<5;c++){d[g[c].key]=g[c].index>-1?Z++:null;}}return d;},doesDateExist:function L(b,Y,Z){var a=new Date(Z,b-1,Y);return Z==a.getFullYear()&&b==a.getMonth()+1&&Y==a.getDate();},fourDigitYear:function R(Z){Z=parseInt(Number(Z));if(!isNaN(Z)){var Y=(V().TWODIGITYEARSTART%100)||0;if(Z>=0&&Z<=Y){Z=2000+Z;}else{if(Z>Y&&Z<100){Z=1900+Z;}}}return Z;},numericMonth:function U(c){var b=parseInt(Number(c)),a=mstrmojo.array;if(!isNaN(b)){return b;}var Y=c&&c.length||0,Z=-1;if(Y){if(Y<=3){Z=a.indexOf(V().MONTHNAME_SHORT,c);}if(Z==-1){Z=a.indexOf(V().MONTHNAME_FULL,c);}}return Z+1;},formatInteger:function G(a,Z){var d=String(a),c=Math.max(Z-d.length,0);if(c>0){var Y=[d];for(var b=1;b<=c;b++){Y.push("0");}d=Y.reverse().join("");}return d;},getFirstDateOfMonth:function(Z,Y){return new Date(Z,Y-1,1);},getDateObject:function(f,Y,c,a,b,Z){f=f||0;Y=Y||1;c=c||1;a=a||0;b=b||0;Z=Z||0;return new Date(f,Y-1,c,a,b,Z);},getDateFromDateInfo:function(Y){return this.getDateObject(Y.date&&Y.date.year,Y.date&&Y.date.month,Y.date&&Y.date.day,Y.time&&Y.time.hour,Y.time&&Y.time.min,Y.time&&Y.time.sec);},getDateJson:function(Y){return{year:Y.getFullYear(),month:Y.getMonth()+1,day:Y.getDate(),hour:Y.getHours(),min:Y.getMinutes(),sec:Y.getSeconds()};},isLeapYear:function(Y){return !(Y%400)||(!(Y%4)&&!!(Y%100));},getDaysOfMonth:function(a,Y){var Z=[31,28,31,30,31,30,31,31,30,31,30,31];if(Y==2&&this.isLeapYear(a)){return 29;}return Z[Y-1];},getPreMonth:function(Z,Y){if(Y===1){return{y:Z-1,m:12};}return{y:Z,m:Y-1};},getNextMonth:function(Z,Y){if(Y===12){return{y:Z+1,m:1};}return{y:Z,m:Y+1};}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.locales");var X=mstrmojo.array,M=mstrmojo.meta.TP,L=mstrmojo.hash,D={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1},B={};for(var R in D){B[D[R]]=true;}var V={};V[D.AQ]="a";V[D.AL]="a";V[D.AC]="a";V[D.AE]="a";V[D.MQ]="m";V[D.MC]="m";V[D.F]="f";V[D.R]="r";V[D.XML]="p";var G={};G[D.MQ]=["not","m","fn","fnt","cs","dmy"];G[D.MC]=["not","m","fn","fnt","m2","m3","p","dmy"];G[D.AE]=["not","a","fn","es","a2","fm2","p"];G[D.AQ]=["not","a","fm","fn","cs"];G[D.AL]=["not","a","fm","fn","cs"];G[D.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];G[D.R]=["not","r"];G[D.F]=["not","f"];G[D.XML]=["not","n","p"];var J={};J[D.MQ]="METRIC_FNS";J[D.MC]="METRIC_FNS";J[D.AQ]="FORM_FNS";J[D.AL]="FORM_FNS";J[D.AC]="FORM_FNS";J[D.AE]="ELEM_FNS";var K={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43},W={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776},P={a:K.ATTR,a2:K.ATTR,m:K.METRIC,m2:K.METRIC,r:K.REPORT,f:K.FILTER,p:K.PROMPT};var Q={};Q[D.MQ]=K.METRIC;Q[D.MC]=K.METRIC;Q[D.AQ]=K.ATTR;Q[D.AL]=K.ATTR;Q[D.AC]=K.ATTR;Q[D.AE]=K.ATTR;Q[D.F]=K.FILTER;Q[D.R]=K.REPORT;var F=function(Y){var H=Y.length,a={};for(var Z=0;Z<H;Z++){var b=Y[Z];a[b.did]=b.n;}return a;},C=function(Z){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){Y.t=Y.tp;}}return Z;},S=function(Z,b){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){if(b){Y.t=b;}else{delete Y.t;}}}return Z;},U=function(Y,a){if(!a){a=[];}a.length=0;for(var Z=0,H=Y.length;Z<H;Z++){a[Z]=Y[Z];}return a;},I={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};METRIC_PROHIBITED={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:D,ETs:B,ET2TGT:V,ET2COND:G,ET2TP:Q,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:K,STP:W,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":W.PROMPT,1:W.PROMPT_LONG,2:W.PROMPT_LONG,3:W.PROMPT_LONG,4:W.PROMPT_DOUBLE,5:W.PROMPT_DOUBLE,6:W.PROMPT_DOUBLE,7:W.PROMPT_DOUBLE,8:W.PROMPT_STRING,9:W.PROMPT_STRING,10:W.PROMPT_STRING,14:W.PROMPT_DATE,15:W.PROMPT_DATE,16:W.PROMPT_DATE,21:W.PROMPT_LONG,22:W.PROMPT_LONG,23:W.PROMPT_STRING,24:W.PROMPT_BOOLEAN,30:W.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0},fnCstCount:function A(Y,H){var Z=this.FN;switch(Y){case Z.BETWEEN:case Z.NOT_BETWEEN:return 2;case Z.IS_NULL:case Z.IS_NOT_NULL:return 0;default:return 1;}},fn_List:function O(Y,H){var Z=this.FN;return Y==Z.IN_LIST||Y==Z.NOT_IN_LIST;},fn_AC_MC:function T(Y,H){var Z=this.FN;return(Y==Z.EQUAL)||(Y==Z.NOT_EQUAL)||(Y==Z.GREATER)||(Y==Z.LESS)||(Y==Z.GREATER_EQUAL)||(Y==Z.LESS_EQUAL);},fnName:function N(c,b,Y,a){var H=this[J[c]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[a]]||H["*"];}var Z=X.find(H,"did",(Y||1)+this.FN_SEP+b);if(Z>-1){return H[Z].n;}return"";},findTargets:function E(g,a,n){if(!n){n={};}if(g){for(var f in P){var y=g[f];if(y){if(!y[M]){y[M]=P[f];}n[y[a]]=y;}}if(g.dmy){var c=this.TP.ATTR,o=this.DMY_TP.ATTR,Z=g.dmy.uts;for(var x=0,Y=(Z&&Z.length)||0;x<Y;x++){var d=Z[x];if(d&&d.utp===o){var b=d.utgt;if(!b.t){b.t=c;}n[b[a]]=b;}}}var H=g.nds,l,q;for(l=0,q=(H&&H.length)||0;l<q;l++){this.findTargets(H[l],a,n);}var p=g.cs,r=p&&p.length;if(r){for(l=0;l<r;l++){this.findTargets(p[l],a,n);}}}return n;},onLocaleUpdated:function(){var Y=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=L.copy(F(Y.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=U(S(Y.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":S(X.filter(Y.Metric,function(Z){return Z.did&&(X.find(METRIC_PROHIBITED["0"],"did",Z.did)<0);}))};H.FORM_FNS={0:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0);})),1:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["1"],"did",Z.did)<0);})),2:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0)&&(X.find(I["1"],"did",Z.did)<0);}))};H.DIMTYLEVELS=U(S(Y.DimtyLevels),H.DIMTYLEVELS);}});mstrmojo.expr.onLocaleUpdated();})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var E=mstrmojo.hash,H=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=E.clone(I);O.data=M;O.parent=N;return H.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length);for(var N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L;for(var O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}for(var M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var H=mstrmojo.registry,C=mstrmojo.array,K=mstrmojo.publisher;function M(O,P){if(P){P.parent=O;return H.ref(P);}return null;}function J(O,P){if(P&&P.alias!=null){O[P.alias]=P;}}function D(P,Q){var O=Q.alias;if(Q.parent===P){delete Q.parent;}if((O!=null)&&(P[O]===Q)){delete P[O];}}function E(S,P){var O=P&&P.length,R,Q;if(O){R=[];for(Q=0;Q<O;Q++){var T=M(S,P[Q]);if(!T){continue;}R.push(T);J(S,T);}}return R;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,initChildren:function I(){var O="children",P=this[O];if(!P){return ;}this[O]=null;this._set_children(O,P,true);if(this.postCreateChildren){this.postCreateChildren();}},_set_children:function A(R,P,O){var Q=this.children;if(P!==Q){if(Q){this.removeChildren(null,O);}this.addChildren(P,0,O);}return false;},destroyChildren:function N(R){var Q=this.children,O=(Q&&Q.length)||0,P;if(O){for(P=O-1;P>-1;P--){var S=Q[P];if(S&&S.destroy){S.destroy(R);if(!R){D(this,S);}}}if(!R){Q.length=0;}}},invalidateChildren:function F(){mstrmojo.array.forEach(this.children,function(O){O.invalidate();});},invalidate:function L(){this.invalidateChildren();},addChildren:function G(T,P,Q){if(!T){return T;}var S=T.constructor===Array,O=E(this,S?T:[T]);if(O&&O.length){var R=this.children||[];if(P==null){P=R.length;}this.children=C.insert(R,P,O);if(!Q&&(this.onaddChild||K.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:O,index:P});}}return S?O:(O&&O[0]);},removeChildren:function B(U,Q){var S=this.children,T=U?[U]:(this.children||[]).concat(),P=T.length,O=-1,R;if(P){for(R=P-1;R>-1;R--){D(this,T[R]);}if(U){O=C.removeItem(S,U);}else{if(S){S.length=0;O=0;}}if(!Q&&(this.onremoveChild||K.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:T,index:O});}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;if(this.preHandleEvent){this.preHandleEvent(H);}var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){if(this.postHandleEvent){this.postHandleEvent(H);}C.publish(this.id,M,H);}return H;},attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,B=mstrmojo.css,D="selected";function G(I,J,K,H,M){var L=M.listHooks[I];if(L&&L.call(M,J,K,H)){return ;}B[((I==="select")?"add":"remove")+"Class"](J,D);}function E(K,J,I){var L=this[K],H=(L)?L.split(J):[];H=H.concat(I.split(J));this[K]=H.join(J);return H.length-1;}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},getItemMarkup:function(I,H){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}">{@n}</{@tag}>';},getItemProps:function C(J,H){var I=!!this.selectedIndices[H];return{tag:"div",sel:I,cls:(I)?D:"",n:J.n||"",style:"",idx:H,addCls:function(K){E.call(this,"cls"," ",K);},addStyle:function(K){E.call(this,"style",";",K);}};},itemRenderer:{render:function(I,H,J){I._renderIdx=H;return mstrmojo.string.apply(J.getItemMarkup(I,H),J.getItemProps(I,H));},select:function(I,J,H,K){G("select",I,J,H,K);},unselect:function(I,J,H,K){G("unselect",I,J,H,K);}},onclick:function A(J){try{var M=J.target||F.eventTarget(J.hWin,J.e),L=F.findAncestorByAttr(M,"idx",true,this.domNode),I=L&&parseInt(L.value,10);if(I!==null&&!isNaN(I)){if(!this.multiSelect){this.singleSelect(I);}else{var H=(this.selectedIndices[I])?"remove":"add";this[H+"Select"](I);}}}catch(K){mstrApp.onerror(K);}}});mstrmojo._IsList.SELECTED_CLS=D;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,J="mstrmojo-itemwrap",I="&nbsp;",S=mstrmojo.array;function F(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}else{if(X===V){break;}}Y=X;X=Y.parentNode;}}return null;}function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=S.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;}function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function L(n,Z,l,r,W,c,t,q){if(!Z){return{start:0,end:0};}var f=this.wrapperNodes(n),k=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,g=l+r,d=f[0].offsetTop,b;for(var o=1;o<=Y;o++){b=f[k].offsetTop-d+q;if(b<l){X=k;}else{if(b>g){V=k;}}var a=Math.round(Z/Math.pow(2,o+1));k+=(b>l)?-a:a;k=Math.min(Math.max(0,k),Z-1);}return{start:X,end:V};},findWrapper:function K(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function E(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function R(c,V,X,b,W){var Y=this._nd2iw(c,V,X),d,a,f;if(Y){a=this._iw2idx(c,V,Y);d=a;f=this.itemOffsetTop(c,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+f+Z/2){d++;f+=Z;}}else{return c.dropCuePos;}return{left:0,top:f,idx:d,idxActual:a};},getWrapperCss:function(V){return J;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function O(f,b,l,d,a,n){var o=this.itemWrapperPrefix(l),h=this.itemWrapperSuffix,Z=o+this.itemWrapperPrefill+h,Y=[this.markupPrefix],W=1,V=l.selectedIndices||{},q=function p(r,k){for(var t=r;t<k;t++){Y[W++]=o;var u=b.build(l,d,f[t],t);if(V[t]){u=u.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=u;Y[W++]=h;}};var c=(f&&f.length)||0;a=a&&b?Math.min(a,c):0;if(a){q(0,a);}n=n&&b?Math.min(n,c-a):0;var g=c-n;for(var X=a;X<g;X++){Y[W++]=Z;}if(n){q(g,c);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,h,d,q,g,W,b,o){var f=(h&&h.length)||0,n=this.wrapperNodes(X),r=g.itemStatus,V=mstrmojo.css,Z=q.selectedIndices||{};for(var c=W,l=Math.min(b+1,f),a=0;c<l;c++){if(r[c]!==A){n[c].innerHTML=d.build(q,g,h[c],c);if(Z[c]){var Y=n[c].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===o){break;}}}return a;},onadd:function N(f,V,Z,g){if(V&&g){var a=g.value.length,b=this.wrapperNodes(V),d=b[g.index],Y=this.getWrapperCss(f);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=I;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(f,this);}},onremove:function P(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function Q(h,X,c,l){if(X&&l){var d=this.wrapperNodes(X);if(d){var W=mstrmojo.css,n=c.itemStatus,k;for(var b=0,V=l.removed,g=V&&V.length;b<g;b++){k=V[b];if(n[k]){W.removeClass(d[k].firstChild,["selected"]);}}for(var Z=0,f=l.added,Y=f&&f.length;Z<Y;Z++){k=f[Z];if(n[k]){W.addClass(d[k].firstChild,["selected"]);}}}}},_nd2iw:F,_iw2idx:M,toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,f=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=f.clientHeight,d=f.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}f.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function A(E,H,D){var C=D.hWin,G=D.e,F=mstrmojo.dom.eventTarget(C,G),B=E.listMapper.findIndex(E,H,F);if(B>-1){E.toggleSelect(B);}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom,B=A.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function C(E,I,D){var G=E&&E.tree||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var G=mstrmojo.hash,A=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",init:function E(H){this.disposables=[];G.copy(H,this);if(this.postApplyProperties){this.postApplyProperties();}A.add(this);if(this.postCreate){this.postCreate();}},destroy:function B(H){this._super(H);F.forEach(this.disposables,function(I){if(I.destroy){I.destroy(H);}else{if(I.clear){I.clear();}}});this.disposables=[];A.remove(this);}});var C=mstrmojo.Obj;C.free=function D(H){if(H instanceof C){H.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr");var C=mstrmojo.array,F=mstrmojo.expr;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function E(){var H=this.parent;if(H&&H.indent){var G=this.childIndex();G=(G>-1&&(G>0))?[G,G-1]:null;if(G){H.indent(G);}}},out:function B(){var H=this.parent;if(H&&H.outdent){var G=this.childIndex();G=(G>-1&&(G>0))?[G,G-1]:null;if(G){H.outdent(G);}}},andOrTxt:function D(){var I=this.parent,G=I&&I.data,H="",J=this.data;if(G&&(G.et===F.ET.ANDOR)&&G.fn){H=G.fn+(J&&J.not?"_"+F.FN.NOT:"");H=F.BRANCH_FNS[H];}return'<span class="mstrmojo-text mstrmojo-andor">'+H+"</span>";},childIndex:function A(){var I=this.parent,G=I&&I.data,H=G&&G.nds,J=this.data;if(H&&J){return C.indexOf(H,J);}return -1;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var Q=mstrmojo.hash;function B(h,g){var d=g.showWait,f=g.suppressError,c=g.waitMsg;delete g.showWait;delete g.suppressError;delete g.waitMsg;mstrApp.serverRequest(h,g,d,f,c);}mstrmojo.qb.DataService=mstrmojo.provide("mstrmojo.qb.DataService",{submitRequest:function M(d,c){B.call(this,d,c);},createReportInstance:function T(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.CreateQBReportInstance",showWait:true,suppressError:true}));},setDBRole:function W(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.SetDBRole",showWait:true}));},getReportDefinition:function O(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.GetReportXDADefinition",showWait:true}));},getShapeKeys:function H(d,c){B.call(this,d,Q.copy(c,{taskId:"arch.readFileContents",showWait:false}));},addTable:function U(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.AddTable",showWait:true}));},removeTable:function Y(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.RemoveTable",showWait:true}));},editTable:function I(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.EditTable",showWait:true}));},addColumn:function R(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.AddSelectedColumn",showWait:true}));},addSelectedColumns:function A(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.AddMultiSelectedColumns",showWait:true}));},removeColumn:function b(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.RemoveSelectedColumn",showWait:true}));},addJoin:function F(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.AddJoin",showWait:true}));},removeJoin:function N(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.RemoveSelectedJoin",showWait:true}));},editJoin:function D(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.EditJoin",showWait:true}));},autoJoin:function E(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.GenerateJoins",showWait:true}));},editCondition:function L(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.EditCondition",showWait:true}));},remapObject:function P(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.RemapObject",showWait:true}));},updateTableStructure:function C(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.UpdateWHTable",showWait:true}));},catalogAction:function G(d,c){B.call(this,d,Q.copy(c,{taskId:"arch.catalogAction",showWait:true}));},parse:function K(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.Parse",showWait:true}));},getReportDefinition:function O(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.GetReportXDADefinition",showWait:true}));},saveReport:function S(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.SaveReportXDADefinition",showWait:true,suppressError:true,waitMsg:mstrmojo.desc(10492,"Saving...")}));},getSystemFunctions:function X(d,c){B.call(this,d,Q.copy(c,{taskId:"getSystemFunctions"}));},convertToQB:function a(c){B.call(this,c,{taskId:"qBuilder.ConvertToQueryBuilder",showWait:true});},convertToFFSQL:function J(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.ConvertToFreeFormSQL",showWait:true}));},editFFSQL:function Z(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.EditFreeFormSQL",showWait:true}));},catalogAction:function G(d,c){B.call(this,d,Q.copy(c,{taskId:"arch.catalogAction",showWait:true}));},publishCube:function V(d,c){B.call(this,d,Q.copy(c,{taskId:"qBuilder.PublishCube",showWait:true,suppressError:true,waitMsg:mstrmojo.desc(11163,"Publishing...")}));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip");var B=mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",init:function A(D){this._super(D);var E=this.parent;if(!E||E.hasInitBindings){this.initBindings();}},destroy:function C(D){if(this.hasRendered){this.unrender(D);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn});B.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};B.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};B.heightMarkupMethod=function(){this.domNode.style.height=this.height||"";};B.widthMarkupMethod=function(){this.domNode.style.width=this.width||"";};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.string","mstrmojo.date","mstrmojo.hash","mstrmojo.array");var U=mstrmojo.func.wrapMethods,G=mstrmojo.date,Q=mstrmojo.hash,J=mstrmojo.string;var E=mstrmojo.desc(9143,"Available tables cache was created at ##. Click Refresh to get the latest tables and update the cache.");var L={DssCatalogDefault:0,DssCatalogGetTables:1,DssCatalogGetColumns:2,DssCatalogGetTablePrimaryKeys:4,DssCatalogGetTableForeignKeys:8,DssCatalogGetTableKeys:12,DssCatalogGetTableSize:16,DssCatalogGetTableContent:32,DssCatalogGetColumnCardinality:64,DssCatalogGetColumnContent:128,DssCatalogGetFullCatalog:255,DssCatalogSelectedOnly:256,DssCatalogApplyConnectionMapping:512,DssCatalogAllNamespaces:1024,DssCatalogGetFresh:4096,DssCatalogIgnoreNamespace:8192,DssCatalogIgnoreCase:16384,DssCatalogIgnoreInvalidNames:32768,DssCatalogReuseMatching:65536,DssCatalogReuseCompatible:131072,DssCatalogReuseAny:262144,DssCatalogAugmentExisting:524288,DssCatalogSortDescending:1048576,DssCatalogSortTableNameFirst:2097152,DssCatalogGetNamespaces:16777216,DssCatalogCompareWithMetadata:134217728};var P={DssCatalogStateDefault:0,DssCatalogStateSelected:1,DssCatalogStateFresh:2,DssCatalogStateMissing:4,DssCatalogStateUnexpected:8,DssCatalogStateCompatibleSmaller:16,DssCatalogStateCompatibleLarger:32,DssCatalogStateCompatible:64,DssCatalogStateIncompatible:128,DssCatalogStateCompatibilityMask:240,DssCatalogStateFreshTables:256,DssCatalogStateMissingTables:512,DssCatalogStateFreshColumns:1024,DssCatalogStateMissingColumns:2048,DssCatalogStatePartitionMappingTable:65536,DssCatalogStateDummyPartitionMappingTable:131072,DssCatalogStateDummyPartitionSliceTable:262144};var B={DssBaseFormDateTime:1,DssBaseFormNumber:2,DssBaseFormText:3,DssBaseFormPicture:4,DssBaseFormUrl:5,DssBaseFormEmail:6,DssBaseFormHTMLTag:7,DssBaseFormDate:8,DssBaseFormTime:9,DssBaseFormSymbol:10,DssBaseFormBigDecimal:11,DssBaseFormPhoneNumber:12};var D={DssDataTypeReserved:0,DssDataTypeInteger:1,DssDataTypeUnsigned:2,DssDataTypeNumeric:3,DssDataTypeDecimal:4,DssDataTypeReal:5,DssDataTypeDouble:6,DssDataTypeFloat:7,DssDataTypeChar:8,DssDataTypeVarChar:9,DssDataTypeLongVarChar:10,DssDataTypeBinary:11,DssDataTypeVarBin:12,DssDataTypeLongVarBin:13,DssDataTypeDate:14,DssDataTypeTime:15,DssDataTypeTimeStamp:16,DssDataTypeNChar:17,DssDataTypeNVarChar:18,DssDataTypeBigDecimal:30,DssDataTypeCellFormatData:31,DssDataTypeUTF8Char:33};var W={0:"[unknown]",1:"[Signed Integer]",2:"[Unsigned Integer]",3:"[Number]",4:"[Decimal]",5:"[Real]",6:"[Double]",7:"[Float]",8:"[Char]",9:"[VarChar]",10:"[LongVarChar]",11:"[Binary]",12:"[VarBin]",13:"[LongVarBin]",14:"[Date]",15:"[Time]",16:"[TimeStamp]",17:"[NChar]",18:"[NVarChar]",30:"[BigDecimal]",31:"[CellFormatData]",33:"[UTF8Char]"};function H(X){return J.decodeHtmlString(X).replace(/&apos;/g,"'");}function A(X){var Y=" ",a="-",c=":",Z=X.split(Y),b=Z[0].split(a),d=Z[1].split(c);return new Date(Date.UTC(b[0],parseInt(b[1],10)-1,b[2],d[0],d[1],d[2]));}function N(b,a,Y){if(Y){mstrApp.showWait&&mstrApp.showWait();}if(mstrApp.sessionState!==undefined){a.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,U(b,{success:mstrmojo.emptyFn,complete:function X(c){if(Y){mstrApp.hideWait&&mstrApp.hideWait();}},failure:function Z(c){var d=c.getResponseHeader("X-MSTR-TaskFailureMsg");if(d){d=(d.length>2000)?d.substring(0,2000)+"...":d;mstrmojo.alert(d.replace(/com\.microstrategy(\.\w+)*: \(?/,"").replace(/\)$/,""));}else{d=c.responseText;d=d&&d.match(/\[HttpException \(0x80004005\): (.)+\]/);mstrmojo.alert((d&&d[0]&&d[0].replace(/\[HttpException \(0x80004005\): |\]/gi,""))||"Request timed out.");}}}),a);}function F(Z,Y){var X=Z.n.toString().toLowerCase(),c=Y.n.toString().toLowerCase();if(X<c){return -1;}else{if(X>c){return 1;}else{return 0;}}}function K(Y,X){return Number(Y.db_ver)-Number(X.db_ver);}function V(Z,a){if(Z.dsns.length==0){var X={taskId:"arch.getODBCDSNs"};var Y={success:function(d){var c=[{n:"select a dsn",des:0}],b=d.dsns.dsn,f=b&&b.length;if(!f){if(b){c.push(b);}}else{b.sort(F);c=c.concat(b);}Z.set("dsns",c);if(a){a(d);}}};N(Y,X,true);}else{if(a){a();}}}function I(Y,a){if(Y.dbms.length==0){var Z={taskId:"arch.getDBMSObjects"};var X={success:function(c){var b=c.dbmss.dbms;b.sort(K);Y.set("dbms",b);C(Y,a);}};N(X,Z,true);}else{C(Y,a);}}function C(Z,a){if(Z.suppdbs.length==0){var Y={taskId:"arch.readFileContents",fileNumber:"1"};var X={success:function(c){var f=[],b=c.DBS.DB,d=b&&b.length;if(!d){if(b){f.push(b);}}else{f=b;}f.sort(F);Z.set("suppdbs",f);T(Z,a);}};N(X,Y,true);}else{T(Z,a);}}function T(Z,a){if(Z.drivers.length==0){var Y={taskId:"arch.getODBCDrivers"};var X={success:function(b){Z.set("drivers",b.odns.name);V(Z,a);}};N(X,Y,true);}else{V(Z,a);}}mstrmojo.WH.WHModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.WH.WHModel",dbtbls:{},dbtables:[],cachedStamp:{},dbrs:[],dsns:[],drivers:[],dbms:[],suppdbs:[],namespaces:[],catalogStamp:"",SelDBRoleID:null,SelNameSpaceID:null,usecCache:false,isCloud:false,catalogRefresh:false,loadDBRoles:function(){var Z=this;var Y={taskId:"getDBInstances",isDataImport:true,reverseOrder:true,verbose:true};var X={success:function(c){var a=c.dbrs,b=[];if(!a){Z.dbrs=[];}else{for(lc=0;lc<a.length;lc++){db=a[lc];db.n=db.n.toString();db.des=(db&&!(db.des&&mstrApp.isCloud)?db.n:db.des+"");db.uCche=(parseInt(db.uCche,10)===1)?true:false;if(db.db_type!=2900){b.push(db);}}Z.set("dbrs",b);}}};N(X,Y,true);},loadDBObjects:function(X){I(this,X);},_set_SelDBRoleID:function(a,Y){var Z=this,X=Z.getDBRle(Y);this.SelDBRoleID=Y;this.raiseEvent({name:"dbroleSelection",value:Y});Z.SelNameSpaceID=null;if(X&&X.uCche){Z.usecCache=true;this.getNameSpaces();}else{Z.usecCache=false;Z.set("namespaces",[{cdid:"",dbrid:Y,ns:""}]);Z._set_SelNameSpaceID(a,"");}},_set_SelNameSpaceID:function(Y,X){this.SelNameSpaceID=X;this.filterText="";this.raiseEvent({name:"namespaceSelection",value:X});},getDBRle:function S(X){var Y=this,Z,a=0;for(a=0;a<Y.dbrs.length;a++){Z=Y.dbrs[a];if(Z.did===X){return Z;}}},getDBRoleType:function O(X){var Y=this,Z,a=0;for(a=0;a<Y.dbrs.length;a++){Z=Y.dbrs[a];if(Z.did===X){return Z.db_type;}}return 0;},getNameSpaces:function(){var c=this,Y=c.SelDBRoleID,a=L.DssCatalogGetNamespaces,b={taskId:"arch.catalogAction",dbrid:Y,flags:a},X={success:function(f){var d=f.xrc.cas;mstrmojo.array.forEach(d,function(g){g.n=g.ns;});c.set("namespaces",f.xrc.cas);},complete:function Z(){c.raiseEvent({name:"loadNamespaces",value:0});}};c.raiseEvent({name:"loadNamespaces",value:1});N(X,b,false);},getSelectedDBRoleTables:function(AB,AC){var a=this,b=a.SelDBRoleID,k=a.cachedStamp,Z=a.dbtbls,Y,y=AB.blockCount,f=AB.blockBegin,t=this.filterText,p=a.getDBRle(b);if(!p){AC.success({items:[]});return ;}if(p.db_type===3000){AC.success({items:[]});return ;}var l=(Z[b]=Z[b]||{}),x=(k[b]=k[b]||{}),q=a.SelNameSpaceID+"",X=false,n=[],o=[],u=[],AA,g,d=0,h=a.usecCache;q=q.replace(/&amp;/g,"&");q=q.replace(/&lt;/g,"<");q=q.replace(/&gt;/g,">");q=q.replace(/&quot;/g,'"');if(!a.catalogRefresh&&l&&(g=l[q])){Q.forEach(g,function(AE,AD){X=true;AA={id:AE.tbid,n:AD,did:AD,st:8405,tag:AE,ns:AE.ns,items:[]};if(!t||AD.toUpperCase().indexOf(t)>-1){o.push(AA);}u.push(AA);});if(X){a.set("catalogStamp",x[q]);n=o.slice(f,f+y);AC.success({items:n,sz:o.length,bb:f,bc:y});a.raiseEvent({name:"dbTablesChange",value:u});return ;}}g=(l[q]={});x[q]=null;var c=L.DssCatalogGetTables;c=a.catalogRefresh?(c|L.DssCatalogGetFresh):c;c=h?c:(c|L.DssCatalogAllNamespaces);var z={taskId:"arch.catalogAction",dbrid:b,flags:c,ns:q},r={success:function(AG){var AD=AG.xrc.cas[0],AJ=AD.timestamp,AE=AD.tis,AF,AH;if(AJ){var AI=G.getDateJson(A(AJ.replace(/&apos;/,"")));AJ=[G.formatDateInfo(AI,"yyyy-MM-dd")," ",G.formatTimeInfo(AI,"hh:mm a")].join("");AJ=E.replace(/##/,AJ);}x[q]=AJ;a.set("catalogStamp",AJ);a.catalogRefresh=false;mstrmojo.array.forEach(AE,function(AL,AK){AF=AL.tbn=H(AL.tbn);AH=AL.ns=H(AL.ns);!h&&AH&&(AF=AH+"."+AF);if(!g[AF]){g[AF]=AL;l[AH]=l[AH]||{};l[AH][AF]=AL;AA={n:AF,id:AL.tbid,ns:AH,did:AF,st:8405,tag:AL,items:[]};u.push(AA);if(AK<y){n.push(AA);}}});AC.success({items:n,sz:AE.length,bb:f,bc:y});a.raiseEvent({name:"dbTablesChange",value:u});},failure:function(AD){AC.failure();}};N(r,z,false);},getColumnsForDBTable:function R(a,l){var f=this,h=f.SelDBRoleID,c=a.data,d=c.n,Z=c.ns,k=f.usecCache;if(h){var Y=f.dbtbls[h][Z][d].columns;if(Y){l.success({src:a,items:Y,selDBRole:h});return ;}var n=d,g=Z+".";if(d.indexOf(g)===0){n=d.substring(g.length);}var b={taskId:"arch.catalogAction",dbrid:h,ns:k?Z:"",dbts:JSON.stringify([{tbn:k?d:n,ns:Z}]),flags:L.DssCatalogGetColumns},X={success:function o(r){var q=r.xrc.cas[0].tis[0].clis,u,p=[],t;mstrmojo.array.forEach(q,function(x){u=x.dt;t=H(x.cln);p.push({n:t,nt:t+" "+f.getColumnDataTypeString(u.tp),id:x.cmid,sta:x.sta,cln:t,did:t,dtps:u.prec,dtsc:u.scl,dttp:u.tp,st:26});});f.dbtbls[h][Z][d].columns=p;l.success({src:a,items:p,selDBRole:h});}};N(X,b,false);}},getColumnDataTypeString:function M(X){X=parseInt(X,10);return(W[X]||"[unknown]");}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._ListSelections");mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onheightChange:function(){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width;}}},buildRendering:function E(){this.itemsHtml="";var F=this.items&&this.items.length;if(F){this.itemsHtml=this._buildItemsMarkup(0,F-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,_buildItemsMarkup:function(F,I,R,G,U,H){var V=[],N=0;V[N++]=R||"";var L=this.itemRenderer,Q=L&&L.render;if(Q&&typeof (Q)=="function"){var T=U||"",S=H||"",K=this.items,M=(K&&K.length)||0,O=this;for(var J=F,P=Math.min(I+1,M);J<P;J++){V[N++]=T;V[N++]=Q(K[J],J,O);V[N++]=S;}}V[N++]=G||"";return V;},onselectionChange:function A(P){if(!P){return ;}var M=this.itemRenderer;if(!M){return ;}var I=M.unselect,L=this.items||[],Q=P.removed,H,G;if(I&&Q){for(var J=0,R=Q.length;J<R;J++){H=Q[J];G=this._getItemNode(H);if(G){I(G,L[H],H,this);}}}var F=M.select,O=P.added;if(F&&O){for(var K=0,N=O.length;K<N;K++){H=O[K];G=this._getItemNode(H);if(G){F(G,L[H],H,this);}}}if(this.onchange){this.onchange();}},onselect:function B(F){if(this.makeSelection&&F.idxs&&F.idxs.length){var G=this._getItemNode(F.idxs[0]);this.makeSelection({selIdx:F.idxs[0],selItem:G});}},autoHide:false,init:function D(F){this._super(F);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},_getItemNode:function(F){var G=this.itemsContainerNode;return(G&&G.childNodes[F])||null;},_set_items:function C(I,F){if(this.autoHide){this.set("visible",!!(F&&F.length));}var H=this.items;this.items=F;if(H!=F){var G=this.hasRendered;if(G){this.unrender();}this.clearSelect();if(G){this.render();}return true;}else{return false;}return H!=F;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget");var J=["(",")","{","}","-","+","*","/","<",">","=","|","~",","," ","\t","\n",";"],F=null;function D(O){if(!F){F={};var N,M;for(N=0,M=J.length;N<M;N++){F[J[N]]=true;}}return F[O];}mstrmojo.qb.FFsqlToken=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.qb.FFsqlToken",data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}"></span>',active:false,dropZone:true,allowDrop:function H(M){return this.dropZone;},ondrop:function(M){mstrmojo.all.FFsql.ondrop(M);},markupMethods:{ondataChange:function(){var M=this.data;if(M.v===","){this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(M.v));}else{if(M.v=="\n"){this.domNode.innerHTML="<br>";}else{this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(M.v));}}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["sql"],this.isSql());mstrmojo.css.toggleClass(this.domNode,["invalid"],M.sta===-1);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);if(!this.active){var N=mstrmojo.all.FFsql;if(!this.isMstrO()&&!this.isDelimiter()){var M=N.candidates.items,P=this.data,O=P.v.toLowerCase();mstrmojo.array.forEach(M,function(Q){if(O===Q.n.toLowerCase()){P.oi=Q;return false;}});}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["sql"],this.isSql());}}},isMstrO:function I(){var M=this.data;return(!!M.oi&&M.oi.sta!==2)||!!M.rfd;},isSql:function L(){return this.data.oi&&this.data.oi.sta===100;},length:function B(){return this.data.v.length;},isDelimiter:function A(){return this.data.isDelimiter||(this.length()===1&&D(this.data.v));},split2Tokens:function E(Q,N){var P=this.data,O=P&&P.v,R=O.substring(0,Q),M=O.substring(Q);return[{v:R,isNew:true,did:P.did},{v:M,isNew:true,did:N}];},mergeTo:function C(N){var P=this.data,O=P&&P.v,M=N.data.v;return{v:O+M,isNew:true};},setItemInfo:function G(M){var N=this.data;N.v=M.n;N.oi=M;N.sta=1;N.isNew=true;this.set("data",N);this.paint();},spliceContent:function K(S,Q,N){var R=this.data,P=R&&R.v,T=P.substring(0,S);Q=(Q===null||Q===undefined)?(P.length-S):Q;var M=P.substring(S+Q),O=T+(N||"")+M;R.v=O;R.isNew=true;R.sta=1;delete R.oi;this.set("data",R);this.paint();}});mstrmojo.qb.FFsqlToken.isDelimiter=D;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var D=mstrmojo.dom,E=mstrmojo.hash,B=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){B[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){B[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.textNode.innerHTML=this.text;},onwidthChange:function(){var F=this.width;if(F){this.domNode.style.width=F;}}},oniconClassChange:function C(G){if(this.hasRendered&&this.domNode){var F=G.valueWas,H=G.value;this.domNode.className=this.domNode.className.replace(F,"")+" "+H;}},onclick:mstrmojo.emptyFn,ontouchend:function A(F){this.onclick(F);}});mstrmojo.Button.newIconButton=function(H,K,I,F,J){var G={scriptClass:"mstrmojo.Button",title:H,cssClass:K,text:"",onclick:I};if(F){G.bindings=F;}E.copy(J,G);return G;};mstrmojo.Button.newInteractiveButton=function(G,H,J,I){var F={scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",text:G,glowClass:"glow"};if(H){F.onclick=H;}if(J&&(D.isFF||D.isWK)){E.copy({onmousedown:function(){B.applyShadow(this.domNode,0,0,10,J);},onmouseup:function(){B.removeShadow(this.domNode);}},F);}E.copy(I,F);return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(J,M,F,K){var H=J.domNode,L=H.offsetWidth;var D=!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5,I=K?1:-1,E=parseInt(L,10)*I,G=D?500:0;A(0,-E,G,{target:F,duration:G,preStart:function(){this.target.style.overflowY="hidden";}});A(E,0,G,{target:M,preStart:function(){this.target.style.overflowY="auto";}});if(J.waiting){A(0,-E,G,{widget:J,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",text:null,markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" mstrAttach:click></div>',cssDisplay:"block",markupMethods:{ontextChange:function(){this.domNode.innerHTML=(this.text!=null)?this.text:"";},oncssTextChange:function(){this.domNode.style.cssText=(this.cssText!=null)?this.cssText:"";},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},autoHide:false,_set_text:function A(D,B){if(this.autoHide){this.set("visible",(B!=null)&&(B!==""));}var C=this.text;this.text=B;return C!=B;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css;function E(F,H){var G={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[F];if(typeof H==="object"){mstrmojo.hash.copy(H,G);}return G;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",width:"100px",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}sbClear" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(1049,"Match case")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;},optionNode:function(){return this.domNode.rows[0].cells[3].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function D(F){var H=this;var G=H.searchTimer;if(G){window.clearTimeout(G);}H.searchTimer=window.setTimeout(function(){H.onkeyupDelayed(F);delete H._searchTimer;},parseInt(F.e.keyCode||F.e.charCode,10)===13?0:H.searchDelay);},onkeyupDelayed:function A(G){var F=G.hWin,I=G.e||F.event;var H=mstrmojo.string.trim(this.inputNode.value);if(this.clearNode){C.toggleClass(this.clearNode,["show"],H.length>0);}this.showTaskError=false;this.click2Search=false;if(H.length==0||this.autoSubmit||this.onEnter&&I.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(G){var F=G.hWin,I=G.e||F.event,K=I.target||I.srcElement,J=K&&K.id;switch(J.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var H=this.optionNode.parentNode.style;H.display=H.display=="block"?"none":"block";}break;case"sbSearch":if(this.onEnter&&I.keyCode===13){this.onEnter();}this.showTaskError=true;this.click2Search=true;this._onsearch();break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbClear":this.clearSearch();break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.clearNode,["show"]);var G=this.searchCache,F=this.rootID;if(G&&G[F]){G[F][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache();var G=this.searchCache[this.rootID];if(G){var F=G[B]||"";this.inputNode.value=F;if(F.length>0){if(F.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(G){var F=this.contentWidget||this;F.set("items",G[0]);if(this.supportIncFetch){var H=G[1],J=G[2],I=this.blockCount;F.set("ifs",{np:Math.floor(H/I)+((H%I>0)?1:0),cp:Math.floor(J/I)+((J%I>0)?1:0)});}},_onsearch:function(F){this.getRootID();this._setupCache();var I=mstrmojo.string.trim(this.inputNode.value);if(I.length===0){F=true;}var J=this.token[this.taskId];if(J.test(I)){}if(this.searchPattern==I&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var K=this.rootID,H=this.searchCache[K];if((I.length<this.minSearchLength&&!this.click2Search)&&!F){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(H[K]);this.searchPattern=I;}}else{this.searchPattern=I;H[B]=this.searchPattern;var G=this.filterCache(I,H,F);if((this.click2Search||G===null)&&!F){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(G);}}H[B]=I;},_setupCache:function(){var H=this.searchCache,G=this.rootID;if(H&&!H[G]){H[G]=H[G]||{};var F=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];H[G][G]=[F,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var F=this,G=E.apply(this,[this.taskId]);G.searchPattern=this.searchPattern;callback={success:function(H){var I=H.items||H.es||[];I=[I,H.totalSize||H.sz||0,H.blockBegin||H.bb];mstrmojo.all[F.id].searchCache[F.rootID][(G.searchPattern.length==0?F.rootID:F.buildIndex(G.searchPattern))]=I;F._notifyContentWidget(I);},failure:function(H){if(F.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+H.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(F.spinnerNode){F.spinnerNode.style.display="none";}if(F.postFetch){F.postFetch();}}};if(this.sessionState!==undefined){G.sessionState=this.sessionState;}mstrmojo.xhr.request(this.method,this.path,callback,G,undefined,this.XServer,this.baseParams);},fetchPage:function(F){this.blockBegin=F*this.blockCount+1;this.fetch();},filterCache:function(K,G,N){var J=G&&G[N?this.rootID:this.buildIndex(K)];if(J){return J;}var H=this.token[this.taskId];if(H.test(K)||this.totalSize>this.blockCount){return null;}var M=K.replace(/.$/,"");J=G&&G[this.buildIndex(M)];while(J===undefined&&(M=M.replace(/.$/,"")).length>0){J=G&&G[this.buildIndex(M)];}if(J!==undefined){if(J[1]>this.blockCount){return null;}var L=J[0],F=[];for(var I in L){if(L[I].n.search(new RegExp(K,this.matchCase?"":"i"))>-1){F.push(L[I]);}}this.totalSize=F.length;return(G[this.buildIndex(K)]=[F,F.length,this.blockBegin].concat());}return null;},buildIndex:function(F){if(F.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?F.toUpperCase():F+"::0";},init:function(F){if(this._super){this._super(F);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.clearNode,["show"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var Z=mstrmojo.hash,f=mstrmojo.array,d=mstrmojo.boxmodel,b=mstrmojo.dom;function A(k,n,h){var l=k.listSelector;if(l){l[n](k,k.itemsContainerNode,h);}}function K(k,h){var l=k.lastPagePos;if(!l||l.dragId!==h){l=d.offset(k.itemsContainerNode);l.dragId=h;k.lastPagePos=l;var n=k.scrollboxNode;k.lastScrollPos={left:n.scrollLeft,top:n.scrollTop,width:n.clientWidth,height:n.clientHeight};}}function N(n,q,k){var l=q&&q.node;if(l===n.dropCueNode||l===n.dropCueNode.firstChild){return n.dropCuePos;}var o=n.listMapper;var h=o&&o.whereDrop(n,n.itemsContainerNode,l,q.pos,{left:n.lastPagePos.left-n.lastScrollPos.left,top:n.lastPagePos.top-n.lastScrollPos.top,width:n.lastScrollPos.width,height:n.lastScrollPos.height});var p=n.dropCuePos;return((k!==false)&&p&&h&&(p.idx===h.idx)&&(p.left===h.left)&&(p.top===h.top))?p:h;}var g="attachEventListener";function C(k,h){if(k.makeObservable){h=h||[];if(!h[g]){mstrmojo.hash.make(h,k.itemsScriptClass||mstrmojo.Arr);}}return h;}function G(k,h){if(h&&h[g]){k._sub_its=h;k._sub_add=h[g]("add",k.id,"preadd");k._sub_rmv=h[g]("remove",k.id,"preremove");}}function F(h){if(h._sub_its){var k=mstrmojo.publisher;k.unsubscribe(h._sub_add);k.unsubscribe(h._sub_rmv);delete h._sub_add;delete h._sub_rmv;delete h._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var k=this.dropCueNode,h=k&&k.style;if(!h){return ;}var n=this.dropCuePos,l=!!n;if(l){h.left=n.left+"px";h.top=n.top+"px";}h.display=l?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Y(p){this._super(p);this.items=this.initItems(this.items);var n=this.selectedIndices,k=this.selectedIndicesList,l=this.selectedIndex,q=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(n||k||(l>-1)||q){this.initSelections(n,k,l,q);}if(this.postInitItems){this.postInitItems();}},initItems:function H(h){return C(this,h);},preBuildRendering:function V(){var o=this.listBuilder,r=o.newContext(this);this.ctxtBuilder=r;var k=this.markupSlots,n=!!(this.renderOnScroll&&this.renderBlockSize&&k&&k.scrollboxNode),l=this.items,h=(l&&l.length)||0,p=n?this.firstRenderBlockSize:h,q=n?this.firstRenderBlockSize:0;this._eros=n;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(l,o,this,r,p,q).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function D(){delete this.itemsHtml;var p=this.listMapper;if(p&&p.postBuildRendering){p.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}G(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var r=this.id;this._cb_scroll=function(){var n=mstrmojo.all[r];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],h=k.length;l<h;l++){var q=k[l],o=this[q];if(o&&o.constructor===Object){o=mstrmojo.insert(mstrmojo.hash.clone(o));o.widget=this;this[q]=o;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function W(n){F(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],h=l.length;k<h;k++){var o=this[l[k]];if(o&&o.isPlaying){o.cancel();}}this._super(n);},pauseScrollRendering:function O(l,h,k){if(l!==false){l=true;}if(this.paused===!!l){return ;}this.paused=!!l;if(l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(h,k);}},onscroll:function J(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var h=this;this._fillTmr=self.setTimeout(function(){h.fill();h=null;},50);}}if(this._super){this._super();}},fill:function a(h,o){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var p=(this.items&&this.items.length)||0;if(!p){if(o){o();}}else{var l=this.scrollboxNode,q=this.itemsContainerNode,n=mstrmojo.boxmodel.offset(q,l),t=this.listMapper,r=t.findScrollRange(q,p,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||l.scrollTop,l.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||l.scrollLeft,l.clientWidth,n.left,n.top);if(this.fillAt(r.start,r.end)){if(h){h();}var k=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[k].fill(h,o);},100);}else{if(o){o();}}}},fillAt:function L(l,k){var h=this.listMapper;if(h){return h.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,l,k,this.renderBlockSize);}else{return false;}},add:function Q(k,h){if(!k||!k.length){return -1;}var l=this.items;if(h==null){h=Z.min(this.selectedIndices,false,true);if(h!==null&&h!==undefined){h++;}}if(h==null||h===-1){h=(l&&l.length)||0;}if(l&&l.add){l.add(k,h);}else{this.set("items",l?f.insert(l.concat(),h,k):k);}return h;},preadd:function B(l){if(this.hasRendered){var p=this.listMapper;if(p){p.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var o=this.listBuilder;if(o){o.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var n=l.index,h=l.value.length;this.fillAt(n,n+h-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function T(h){if(h==null){return -1;}if(h.constructor!==Array){return this._remove(h);}var l=this.items;if(l){var k;if(l.remove){for(k=h.length-1;k>-1;k--){l.remove(h[k],1);}}else{l=l.concat();for(k=h.length-1;k>-1;k--){l.splice(h[k],1);}this.set("items",l);}return h[0];}return -1;},_remove:function T(l){var k=this.items;if(!k||(l==null)){return -1;}var h;if(!isNaN(l)){h=l;}else{h=this.itemIndex(l);}if(h>-1){if(k.remove){k.remove(h,1);}else{k=k.concat();k.splice(h,1);this.set("items",k);}}return h;},duplicate:function X(p,k,l){var n=this.items,h=-1;if(!n||(p==null)){return -1;}if(!isNaN(p)){if(k===null||k===undefined){k=p+1;}p=n[p];}else{if(k===null||k===undefined){k=this.itemIndex(p)+1;}}if(p){var o;o=Z.copy(l,Z.clone(p));h=this.add([o],k);}return h;},preremove:function M(k){if(this.hasRendered){var n=this.listMapper;if(n){n.onremove(this,this.itemsContainerNode,this.ctxtBuilder,k);}var l=this.listBuilder;if(l){l.onremove(this,this.ctxtBuilder,k);}var h=this.listSelector;if(h){h.onremove(this,k);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(k);}if(this._super){this._super(k);}},move:function R(n,t){function q(x,u){return(t>=x)&&(t<=x+u);}var r=(this.items&&this.items.length)||0;if(t===-1||t==null||isNaN(t)){t=r;}else{t=Math.min(t,r);}var l,h,p,o;if(n.constructor===Array){h=n;p=n;o=(h&&h.length)||0;if(q(n[0],n.length)){return false;}l=f.get(this.items,n);}else{if(typeof (n)==="object"){l=[n];o=1;h=this.itemIndex(l[0]);p=[h];if(q(h,1)){return false;}}else{h=n;p=[n];o=1;if(q(h,1)){return false;}l=[this.items[h]];}}for(var k=0;k<o;k++){if(p[k]<=t){t--;}}if(l[0]!=null){this.remove(h);this.add(l,t);}return true;},itemIndex:function E(h){if(h==null){return -1;}var k=this.itemIdField;return k?f.find(this.items,k,h[k]):f.indexOf(this.items,h);},prechange:function S(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var n=0,h=k.length;n<h;n++){var p=k[n];if(p&&p.onchange){p.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function I(q,h){var p=this.items;h=this.initItems(h);this.items=h;if(p!==h){var o=this,l=function(){if(o.autoHide){o.set("visible",!!(h&&h.length));}o=null;},k=this.hasRendered;if(k){this.refresh(l);}else{l();}}return p!==h;},premousedown:function c(h){A(this,"premousedown",h);},premouseup:function P(h){A(this,"premouseup",h);},scrollTo:function U(k){var h,l=this.listMapper;if(l&&l.toItem){if(!isNaN(k)){h=k;}else{h=this.itemIndex(k);}if(h>=0){l.toItem(this,h);}}},draggable:false,getDragData:function(o){K(this,o.id);var l=N(this,o.src),k=l&&l.idxActual;if((k>-1)&&this.selectedIndices[k]){var n=this.sortSelectedIndices(),h=f.get(this.items,n)||[];switch(h.length){case 1:return Z.copy(h[0],{html:h[0][this.itemDisplayField],index:n[0]});case 0:return null;default:return Z.copy({html:h.length+" selections",indices:n},h);}}},dropZone:false,ondragenter:function(h){K(this,h.id);this.set("dropCuePos",N(this,h.tgt));},ondragover:function(h){this.set("dropCuePos",N(this,h.tgt));},ondragleave:function(h){this.set("dropCuePos",null);},ondragstart:function(h){if(!(h&&h.src&&h.src.data)){return false;}},allowCopy:false,ondragend:function(n){var k=n&&n.tgt,h=k&&k.widget;if(h===this){}else{if(this.tree&&h&&h.tree===this.tree){if(!this.allowCopy||!b.ctrlKey(k.hWin,k.e)){var l=n.src&&n.src.data;if(l&&(l.indices||(l.index!==null))){this.remove(l.indices||l.index);}}}}},ondrop:function(r){var x=r&&r.src,q=x&&x.data;if(q){var k=N(this,r.tgt,false),t=k&&k.idx,l=(q&&q.constructor===Array);var o=this.items;t=Math.min(t,(o&&o.length)||0);var u=true;if(x.widget===this){u=this.move(this.sortSelectedIndices(),t);}else{this.add(l?q:[q],t);}if(u){var p=l?q.length:1,h={};for(var n=0;n<p;n++){h[t+n]=true;}this.set("selectedIndices",h);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget");var O=mstrmojo.dom,B=mstrmojo.css,F=mstrmojo.string.htmlAngles,M=mstrmojo.expr,N=M.ET,L=M.FN,A=M.BRANCH_FNS[L.NOT],E={};E[L.BETWEEN]=1;E[L.NOT_BETWEEN]=1;var D={"*":function(Q,P){return Q?('<span class="mstrmojo-unknown">'+(F(Q.n||Q.xml)||"...")+"</span>"):null;}};function I(Q,P,S,R){return S&&((R?'<span class="mstrmojo-ListIcon t'+R+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+F(S)+"</span>");}D[N.R]=function(Q,P){return I(Q,P,Q.r&&Q.r.n,Q.r&&Q.r.t);};D[N.F]=function(Q,P){return I(Q,P,Q.f&&Q.f.n,Q.f&&Q.f.t);};D[N.XML]=function(Q,P){return I(Q,P,Q.n||Q.p&&Q.p.n||Q.xml,Q.p&&Q.p.t);};D[N.AE]=function(V,S){var R=[];if(V&&V.a&&V.a.n){R.push('<span class="mstrmojo-text mstrmojo-attr">'+F(V.a.n)+"</span>");if(V.fn!==M.FN.IN_LIST){R.push('<span class="mstrmojo-text mstrmojo-fn">'+F(M.fnName(V.et,V.fn,V.fnt))+"</span>");}var U=V.es,P=U&&U.length||0;if(P){R.push('<span class="mstrmojo-elems">');var Q=R.length;for(var T=0;T<P;T++){R[Q++]='<span class="mstrmojo-text mstrmojo-elem">';R[Q++]=F(U[T].n);if(T<P-1){R[Q++]=",";}R[Q++]="</span>";}R[Q++]="</span>";}else{R.push('<span class="mstrmojo-text mstrmojo-emptyelems">(Empty)</span>');}}return R.join("");};D[N.AQ]=function(W,X){var T=[];if(W&&W.a&&W.a.n){T.push('<span class="mstrmojo-text mstrmojo-attr">'+F(W.a.n)+"</span>");if(W.fm&&W.fm.n){T.push('<span class="mstrmojo-text mstrmojo-form">'+F(W.fm.n)+"</span>");if(W.fn!=null){T.push('<span class="mstrmojo-text mstrmojo-fn">'+F(M.fnName(W.et,W.fn,W.fnt,W.fm.dtp))+"</span>");var P=M.fnCstCount(W.fn,W.fnt);if(W.et===N.AC){if(P>=1){if(W.a2&&W.a2.n){T.push('<span class="mstrmojo-text mstrmojo-attr2">'+F(W.a2.n)+"</span>");if(W.fm2&&W.fm2.n){T.push('<span class="mstrmojo-text mstrmojo-form2">'+F(W.fm2.n)+"</span>");}}if(P>1){T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");if(W.a3&&W.a3.n){T.push('<span class="mstrmojo-text mstrmojo-attr3">'+F(W.a3.n)+"</span>");if(W.fm3&&W.fm3.n){T.push('<span class="mstrmojo-text mstrmojo-form3">'+F(W.fm3.n)+"</span>");}}}}}else{if(W.et===N.AL){var U=W.cs,Y=[];for(var R=0,V=U.length;R<V;R++){Y.push(U[R].v);}T.push('<span class="mstrmojo-text mstrmojo-c1">'+Y.join(mstrConfig.listSep)+"</span>");}else{if(P>=1){var U=W.cs,S=U&&U[0];T.push('<span class="mstrmojo-text mstrmojo-c1">'+F(S&&S.p&&S.p.n||S&&S.v)+"</span>");if(P>1){var Q=U&&U[1];T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");T.push('<span class="mstrmojo-text mstrmojo-c1">'+F(Q&&Q.p&&Q.p.n||Q&&Q.v)+"</span>");}}}}}}}return T.join("");};D[N.AC]=D[N.AQ];D[N.AL]=D[N.AQ];D[N.MQ]=function(a,b){var W=[];if(a&&a.m&&a.m.n){W.push('<span class="mstrmojo-text mstrmojo-metric">'+F(a.m.n)+"</span>");if(a.fn!=null){W.push('<span class="mstrmojo-text mstrmojo-fn">'+F(M.fnName(a.et,a.fn,a.fnt,M.DTP.REAL))+"</span>");var T=M.fnCstCount(a.fn,a.fnt);if(a.et==M.ET.MC){if(T>=1){var X=(a.m2&&a.m2.n)||"?";W.push('<span class="mstrmojo-text mstrmojo-m2">'+F(X)+"</span>");if(T>1){W.push('<span class="mstrmojo-text mstrmojo-btwn">'+b.betweenText+"</span>");var R=(a.m3&&a.m3.n)||"?";W.push('<span class="mstrmojo-text mstrmojo-m3">'+F(R)+"</span>");}}}else{if(T>=1){var Z=a.cs,V=Z&&Z[0];var Y=function(f){var d=f.v;if(a.fnt==M.FNT.PER){f.v=f.v.replace(/%$/,"");d=f.v+"%";}return d;};W.push('<span class="mstrmojo-text mstrmojo-c1">'+F(V&&V.p&&V.p.n||V&&V.v&&Y(V))+"</span>");if(T>1){var U=Z&&Z[1];W.push('<span class="mstrmojo-text mstrmojo-btwn">'+b.betweenText+"</span>");W.push('<span class="mstrmojo-text mstrmojo-c2">'+F(U&&U.p&&U.p.n||U&&U.v)+"</span>");}}}var Q=a.dmy&&a.dmy.uts,P=Q&&Q.length;if(P){W.push('<span class="mstrmojo-text mstrmojo-at">'+b.atText+"</span>");W.push('<span class="mstrmojo-dmy">');for(var c=0;c<P;c++){var S=Q[c];W.push('<span class="mstrmojo-text mstrmojo-dmyunit">');W.push(F(S.utgt?S.utgt.n:S.n));if(c<P-1){W.push(",");}W.push("</span>");}W.push("</span>");}}}return W.join("");};D[N.MC]=D[N.MQ];function H(P){var Q=P.data;if(Q.not){return'<span class="mstrmojo-text mstrmojo-not">'+A+"</span>";}return"";}function G(P){var R=P.data,Q=D[R&&R.et]||D["*"];return H(P)+((Q&&Q(R,P))||('<span class="mstrmojo-text">'+P.emptyText+"</span>"));}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}"><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}" mstrAttach:mousedown><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><img class="mstrmojo-outdent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" /><img class="mstrmojo-outdent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'"onclick="mstrmojo.all[\'{@id}\'].out()" /><img class="mstrmojo-indent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" /><img class="mstrmojo-indent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'"onclick="mstrmojo.all[\'{@id}\'].ind()" /></span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topleft mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixNode:function(){return this.domNode.firstChild.firstChild;},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},popupNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{oneditableChange:function(){B.toggleClass(this.textNode,["editable"],this.editable);B.toggleClass(this.prefixNode,["editable"],this.editable);},onselectedChange:function(){B.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=G(this);}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),del:function K(){var P=this.parent;if(P&&P.remove&&this.data){P.remove(this.data);}},isEmpty:function(){var Q=this.data,P=Q&&Q.et,R=P&&mstrmojo.expr.ET2TGT[P];return !(R&&Q[R]);},premousedown:function C(P){O.stopPropogation(P.hWin,P.e);},preclick:function J(P){var R=null,Q=O.eventTarget(P.hWin,P.e);if(O.contains(this.prefixNode,Q,true)){R="andor";}else{if(O.contains(this.textNode,Q,true)){R="condition";}}P.part=R;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});})();(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo._HasChildren");var F=mstrmojo.publisher;mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",init:function I(L){this._super(L);if(this.children){this.initChildren();}var M=this.parent;if(!M||M.hasInitBindings){this.initBindings();}},destroy:function G(L){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(L);},unrender:function J(N){var O=this.children,L=(O&&O.length)||0,M;for(M=L-1;M>-1;M--){O[M].unrender(true);}this._super(N);},postBuildRendering:function K(){var L=this._super?this._super():undefined;if(L!==false){this.renderChildren();L=true;}return L;},renderChildren:function C(){var N=this.children,L=(N&&N.length)||0,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render(null);}}},childRenderCheck:function H(M){if(M&&!M.hasRendered){var L=M.slot||this.defaultChildSlot;return !!this[L];}return false;},addChildren:function E(O,M,N){var L=this._super(O,M,N);if(L){this.childRenderOnAddCheck(L);}return L;},removeChildren:function A(S,O){var R=S?[S]:(this.children||[]),L=R.length,P;for(P=L-1;P>-1;P--){var N=R[P],M=N&&N.domNode;if(M){var Q=this[(N.slot||this.defaultChildSlot)];if(M.parentNode===Q){Q.removeChild(M);}}}return this._super(S,O);},childRenderOnAddCheck:function B(N){if(this.hasRendered&&N){var L=N.length,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render();}else{if(O&&O.hasRendered){this.onchildRenderingChange(O);}}}}},preserveChildDomOrder:true,onchildRenderingChange:function D(M){var T=M&&M.domNode;if(!T){return ;}var N=this.defaultChildSlot,W=M.slot||N,O=this[W],L=this.children;if(!O){if(T.parentNode){T.parentNode.removeChild(T);}}else{if(T.parentNode===O){return ;}if(!this.preserveChildDomOrder){O.appendChild(T);}else{var P,R;for(R=L.length-1;R>=0;R--){var U=L[R];if(U===M){break;}if(W===(U.slot||N)){var V=U.domNode;if(V&&V.parentNode===O){P=V;}}}if(P){O.insertBefore(T,P);}else{O.appendChild(T);}}}if(F.hasSubs(this.id,"childrenRendered")){var S=L.length,Q;for(Q=0;Q<S;Q++){if(!L[Q].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var F=mstrmojo.css,C={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchWidget=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchWidget",quickSearch:false,placeholderText:"",markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" placeholder="{@placeholderText}" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}sbClear" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;}},onsearch:function H(){},onclear:function G(){},prekeyup:function E(K){var I=K.hWin,M=K.e||I.event;var L=this.getSearchPattern(),J=(L.length===0);F.toggleClass(this.clearNode,["show"],!J);if(this.quickSearch){this[J?"clearSearch":"onsearch"](L);}var N=C[M.keyCode];if(this["on"+N]){this["on"+N](K);}},onEnter:function B(){this.onsearch(this.getSearchPattern());},getSearchPattern:function D(){return mstrmojo.string.trim(this.inputNode.value);},preclick:function A(J){var I=J.hWin,K=J.e||I.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbSearch":this.onsearch(this.getSearchPattern());break;case"sbClear":this.clearSearch();break;}},clearSearch:function(){var I=this.getSearchPattern();this.inputNode.value="";F.removeClass(this.clearNode,["show"]);if(this.onclear){this.onclear(I);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget");var L=["(",")","{","}","-","+","*","/","<",">","|","~",","],J={" ":true,"@":true},H=null;function E(P){if(!H){H={};var O,N;for(O=0,N=L.length;O<N;O++){H[L[O]]=true;}}return H[P];}function C(P){if(!P){return false;}var N=P.length,O,Q;for(O=0;O<N;O++){Q=P.charAt(O);if(E(Q)||J[Q]){return true;}}return false;}function F(N){return C(N)?"["+N+"]":N;}mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,null,{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}"></span>',active:false,markupMethods:{ondataChange:function(){var N=this.data;if(N.v===","){this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(N.v))+"&nbsp;";}else{this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(N.v));}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["invalid"],N.sta===-1);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},isMstrO:function K(){return !!this.data.oi||!!this.data.rfd;},brackets:F,length:function B(){return this.data.v.length;},isDelimiter:function A(){return this.data.isDelimiter||(this.length()===1&&E(this.data.v));},split2Tokens:function G(Q){var P=this.data,O=P&&P.v,R=O.substring(0,Q),N=O.substring(Q);return[{v:R,isNew:true},{v:N,isNew:true}];},mergeTo:function D(O){var Q=this.data,P=Q&&Q.v,N=O.data.v;return{v:P+N,isNew:true};},brackets:F,setItemInfo:function I(N){var O=this.data;O.v=this.brackets(N.n);O.oi=N;O.sta=1;O.isNew=true;this.set("data",O);this.paint();},spliceContent:function M(T,R,O){var S=this.data,Q=S&&S.v,U=Q.substring(0,T);R=(R===null||R===undefined)?(Q.length-T):R;var N=Q.substring(T+R),P=U+(O||"")+N;S.v=P;S.isNew=true;S.sta=1;delete S.oi;this.set("data",S);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=E;mstrmojo.ME.MetricToken.brackets=F;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click /><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var P=mstrmojo.dom,B=mstrmojo.css,M=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var U=document.createElement("tr"),V=this.data,Y=this._cmSource,R,S;U.id=this.id;U.className="mstrmojo-ContextMenuItem "+(Y.isSeparatorItem(V)?"separator":Y.item2textCss(V));var W=this,X=function(){W.handleMouseOver();},T=function(){W.handleMouseOut();},Q=function(){W.handleClick();};P.attachEvent(U,"mouseover",X);P.attachEvent(U,"mouseout",T);P.attachEvent(U,"click",Q);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-text";if(Y.isSeparatorItem(V)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=V.itemWidget?"&nbsp":V[this.itemField];}R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return U;},buildRendering:function K(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){B.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){B.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=P.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function C(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function E(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function L(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function O(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,T=this._subMenu.domNode,S=T.offsetHeight,R=T.offsetWidth,W=P.windowDim(),V=P.position(T,false),U=P.position(T,true);if((V.x+R+M)>W.w){Q.set("left",(P.position(this.domNode,true).x-R)+"px");}if((V.y+S+M)>W.h){Q.set("top",(W.h-S-M+(U.y-V.y))+"px");}},handleMouseOver:function N(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function D(){this._cmSource.closeMenuTree();},handleClick:function F(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}else{}}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}" ><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},buildRendering:function A(){var C=this.placeholder;if(this._super()){if(!this.parent&&!C){var B=this.placeNode||document.body;B.appendChild(this.domNode);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K[I].slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.css");var C=mstrmojo.css;var B=mstrmojo.dom;function E(J){var L=document.createElement("div"),K=L.style,I=J.domNode;L.className="mstrmojo-SplitPanel-avatar";K.height=I.clientHeight+"px";I.appendChild(L);J.avatar=L;return L;}mstrmojo.qb.SplitPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.qb.SplitPanel",draggable:true,dropZone:false,marginSpan:10,minSpan:200,leftItemVisible:true,rightItemVisible:true,lp:25,markupString:'<div id="{@id}" class="mstrmojo-SplitPanel {@cssClass}" style="{@cssText}" ><table cellpadding=0 cellspacing=0><tr><td><div></div></td><td style="padding-left:{@marginSpan}px;"><div class="mstrmojo-SplitPanel-resizeHandle" style="height:{@height};width:{@marginSpan}px;margin-left:-{@marginSpan}px;" ></div><div></div></td></tr></table></div>',markupSlots:{leftItem:function(){return this.domNode.firstChild.firstChild.firstChild.firstChild.firstChild;},rightItem:function(){return this.domNode.firstChild.firstChild.firstChild.children[1].children[1];}},getDragData:function F(I){var J=I.src,L=J.node;if(L.className&&L.className.indexOf("mstrmojo-SplitPanel-resizeHandle")>=0){var K=B.position(this.domNode);return{node:L,x:K.x,y:K.y,w:K.w,h:K.h};}else{if(this._super){return this.dropZone&&this._super(I);}}return null;},allowDrop:function A(I){var J=I.src,K=J&&J.data;if(K&&K.node){return true;}else{return this.dropZone;}},ondragmove:function H(I){var K=I.src,M=K&&K.data;if(M&&M.node){var J=I.tgt,L=this.avatar;if(L){L.style.left=Math.min(Math.max(M.x+this.minSpan,J.pos.x),M.x+M.w-this.minSpan)+"px";}}},ondragstart:function D(I){var J=I.src,L=J&&J.data;if(L&&L.node){var K=this.avatar||E(this);this.ownAvatar=true;K.style.left=J.pos.x+"px";K.style.top=L.y+"px";K.style.display="block";K.style.zIndex="9999";K.style.height=L.h+"px";return true;}else{if(this._super){return this._super(I);}}return false;},ondragend:function G(I){var K=I.src,N=K&&K.data;if(N&&N.node){var M=this.avatar;if(M){M.style.display="none";var J=parseInt(M.style.left)-N.x-this.marginSpan/2,L=this.domNode.clientWidth;this.lp=J*100/L;this.layoutConfig.w={leftItem:this.lp+"%",rightItem:100-this.lp+"%"};this.doLayout();}this.ownAvatar=false;}else{if(this._super){this._super(I);}}},children:[{scripClass:"mstrmojo.Box",slot:"leftItem"},{scripClass:"mstrmojo.Box",slot:"rightItem"}],layoutConfig:{w:{leftItem:"20%",rightItem:"80%"},h:{leftItem:"100%",rightItem:"100%"}},afterLayout:function(){if(this.domNode){var I=this.domNode.firstChild.firstChild.firstChild.children[1].children[0].style;if(this.leftItemVisible&&this.rightItemVisible){I.display="block";this.children[0].set("visible",true);this.children[1].set("visible",true);I.height=this.height;var K=parseInt(this.children[0].width);this.children[0].set("width",K+"px");this.rightItem.style.width=parseInt(this.width)-K-this.marginSpan+"px";this.children[1].set("width",this.rightItem.style.width);}else{I.display="none";if(this.leftItemVisible){this.children[0].set("width",this.width);this.children[1].set("visible",false);}else{this.children[1].set("width",this.width);this.children[0].set("visible",false);var J=this.rightItem.parentNode;J.style["padding-left"]="0px";}}}},_set_leftItemVisible:function(K,I){if(this.leftItemVisible!=I){this.leftItemVisible=I;if(I){this.layoutConfig.w={leftItem:this.lp+"%",rightItem:100-this.lp+"%"};if(this.rightItem){var J=this.rightItem.parentNode;J.style["padding-left"]=this.marginSpan+"px";}}else{this.layoutConfig.w={leftItem:"0%",rightItem:"100%"};if(this.rightItem){var J=this.rightItem.parentNode;J.style["padding-left"]="0px";}}this.doLayout();}},_set_rightItemVisible:function(J,I){if(this.rightItemVisible!=I){this.rightItemVisible=I;if(I){this.layoutConfig.w={leftItem:this.lp+"%",rightItem:100-this.lp+"%"};}else{this.layoutConfig.w={leftItem:"100%",rightItem:"0%"};}this.doLayout();}},postBuildRendering:function(){if(this._super){this._super();}this.height=this.domNode.clientHeight+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");function E(S,O,R,Y,T,W,P){var U=T?"height:"+T+"px;":"";var V=W?"width:"+W+"px;":"";var X='<div class="mstrmojo-qb-DBTableRow-bullet" style="'+U+V+'">';X+='<div class="icon t'+R[1]+'"></div>';X+='<div class="text" >'+S+"</div>";if(P&&P.length){for(var Q=0;Q<P.length;Q++){X+='<div class="cxtmenu '+P[Q].n+'"></div>';}}X+="</div></div>";return X;}var N=mstrmojo.dom,A=mstrmojo.global.document;var J,I,D;var L;function B(Q,O,P){if(P!=null){I.innerHTML=P;}D.left=Q.x+"px";D.top=Q.y+"px";}function K(O,P){if(!J){J=A.createElement("div");D=J.style;D.position="absolute";D["z-index"]=9999;J.className="mstrmojo-Architect-TableRow-avatar";J.innerHTML="<div></div>";I=J.firstChild;A.body.appendChild(J);}B(P,true,O);D.display="block";}function M(){if(J){D.display="none";}}function G(P,O,R){if(!P.domNode){return false;}var Q=N.position(P.domNode,true);return((Q.y<=R)&&(Q.x<=O)&&(Q.x+Q.w>=O)&&(Q.y+Q.h>=R));}function C(Q,O,S){var R=document.elementFromPoint(O,S);var P=N.findWidget(R);while(P){if(P.dropZone){if(P.allowDrop&&P.allowDrop(Q)){return P;}}P=P.parent;}return null;}mstrmojo.qb.DBTableRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.DBTableRow",indent:0,text:"",checkBox:false,draggable:true,ownAvatar:true,dropZone:true,cxtmenus:null,allowDrop:function F(O){return true;},ondrop:function H(T){var R=T.src.widget,P=T.tgt.widget,Q=mstrmojo.all.QBuilderModel;if(R.domNode.className.indexOf("mstrmojo-qb-DBTableRow")<0){return ;}if(R.srcID==P.srcID){return ;}var S=this.parent.parent.parent.parent.linker;var O={success:function(){S.drawLinks();},failure:function(){}};if(Q.joinsInfo[R.srcID+P.srcID]){Q.addLink(R,P,R.srcID+P.srcID,O);}else{if(Q.joinsInfo[P.srcID+R.srcID]){Q.addLink(P,R,P.srcID+R.srcID,O);}else{Q.addJoin(R,P,0,null,O);}}},_leftPos:0,_topPos:0,movable:false,dropTarget:null,markupString:'<div id="{@id}" class="mstrmojo-qb-DBTableRow {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick></div>',markupMethods:{ontextChange:function(){this.domNode.innerHTML=E(this.text,this.indent,this.images,this.selected,null,null,this.cxtmenus);}},getDragData:function(P){var O=new Object();if(this.domNode){O.html=E(this.text,this.indent,this.images,this.selected,this.domNode.offsetHeight,this.domNode.offsetWidth);O.n=this.text;}return O;},ondragstart:function(Q){var P=Q.src.node,O=this.domNode;if(N.contains(O,P,true,document.body)){if(N.isWK){document.onselectstart=function(R){R.preventDefault();return false;};}this.domNode.style.cssText="opacity:0.3; filter: alpha(opacity=30);";L=N.position(this.domNode);K(E(this.text,this.indent,this.images,this.selected,this.domNode.offsetHeight,this.domNode.offsetWidth),L);return true;}else{return false;}},ondragmove:function(S){var R=S.tgt.pos,Q=S.src.pos,P=R.x-Q.x,O=R.y-Q.y;B({x:R.x+5,y:R.y+5},true,E(this.text,this.indent,this.images,this.selected,this.domNode.offsetHeight,this.domNode.offsetWidth));},ondragend:function(O){if(N.isWK){document.onselectstart=function(P){return true;};}if(this.domNode){this.domNode.style.cssText="opacity:1; filter: alpha(opacity=100);";}M();},onclick:function(P){var O=P.hWin,Q=P.e||O.event,R=Q.target||Q.srcElement;if(R.type=="checkbox"){if(this.onCheck){this.onCheck(R.checked);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.css;function I(R){var Q=R.inputNode;var P=(R.value!=null)?String(R.value):"";if(P!==Q.value){Q.value=P;}if(Q.mstrmojoEmpty){C.removeClass(Q,[R.emptyClass]);Q.mstrmojoEmpty=null;}}function E(Q){var P=Q.inputNode;P.value=Q.emptyText||"";C.addClass(P,[Q.emptyClass]);P.mstrmojoEmpty=true;}function G(Q){var P=Q.inputNode;if(P){Q.readingDom=true;Q.set("value",P.value);Q.readingDom=false;}}var M={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",autoComplete:true,autoCorrect:true,autoCapitalize:true,placeholderText:"",markupString:'<input id="{@id}" placeholder="{@placeholderText}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css.toggleClass(this.inputNode,"disabled",!this.enabled);},onvalueChange:function(){var P=this.value,Q=(P===null)||(P==="");if(Q){if(!this.hasFocus){E(this);}else{this.inputNode.value="";}}else{I(this);}},ontooltipChange:function(){this.domNode.title=this.tooltip;},onreadOnlyChange:function(){this.inputNode.readOnly=this.readOnly;}},emptyText:"",emptyClass:"mstrmojo-empty",postBuildRendering:function B(){this._super();var P=this.inputNode;P.setAttribute("autocomplete",this.autoComplete?"on":"off");P.setAttribute("autocorrect",this.autoCorrect?"on":"off");P.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function O(){this.inputNode.focus();},prefocus:function J(){this.hasFocus=true;I(this);},preblur:function D(){window.setTimeout(function(){},200);this.hasFocus=false;G(this);var P=this.value;if((P===null||P==="")&&this.emptyText){E(this);}},prekeyup:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);var S=M[R.keyCode];if(this["on"+S]){this["on"+S](Q);}},preinput:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);},prepaste:function N(){this.delaySetValue(this);},precut:function L(){this.delaySetValue(this);},delaySetValue:function K(P){window.setTimeout(function(){G(P);},100);},setInvalidState:function H(P){mstrmojo.css.addClass(this.inputNode,["err"]);if(P){this.domNode.setAttribute("title",P);}},cleanUp:function F(){this.inputNode.value="";mstrmojo.css.removeClass(this.domNode,["err"]);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(E,D){if(!A){var F=this.itemField;A=this._super(E).replace(">{@n}<",' title="{@'+F+'}">{@'+F+"}<");}return A;},getItemProps:function C(F,D){var E=this._super(F,D),G=this.itemField;E[G]=F[G];return E;},onclick:function B(D){this._super(D);var E=this.parent,G=E.opener;G.suggestionShown=false;var F=this.selectedItem;if(F){G.handleSuggestionItemSelect(F);}E.close();},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems"}});}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList");var A=function(O,P){var N=O.parent.opener,F=N&&N.showDesc,M=N&&N.showPath,E=P[O.itemField];var L=mstrmojo.string.escape4HTMLText,Q="";if(M){var I=P.anc&&P.anc.items,K=I&&I.length;if(K>0){for(var H=0;H<K-1;H++){Q+=I[H].n+" > ";}Q+=L(I[K-1].n);}else{if(P.path){Q+=P.path;}}}Q+=(Q.length==0?"":" > ")+L(E);if(F){var J=P[O.itemDescField],G=120;if(J){Q+="\r\n\r\n"+L(J.substring(0,G)+(J.length>G?"...":""));}}return Q;};var C=function(E,F,G){if(!F||!G){return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var H=F.path||F.getAttribute("path");if(H){return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(I){var J=D(I.toString())||"";G.path=J;F.path=1;F.title=A(E,G);}},{taskId:"getObjectDetails",objectID:G.did,objectType:G.t,sessionState:mstrApp.sessionState},undefined);},200);};var D=function(G){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(G,"text/xml");}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(G);}var K=xmlDoc.getElementsByTagName("path")[0],H=K.childNodes,J="";if(H){for(var F=0,E=H.length;F<E;F++){var I=H[F].childNodes&&H[F].childNodes[0];if(I){J+=mstrmojo.string.escape4HTMLText(I.nodeValue)+(F<E-2?"> ":"");}}}return J;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",itemDescField:"desc",getItemMarkup:function(G,E){var F=this.parent.opener,H=A(this,G);return'<div class="mstrmojo-suggest-text '+((F&&F.item2textCss(G))||"")+'" idx="'+E+'" title="'+H+'">'+F.getHighlightedText(F.getSearchPattern(),mstrmojo.string.escape4HTMLText(G[this.itemField]))+"</div>";},getItemProps:function B(F,E){return{};},onmouseover:function(F){var I=this.parent.opener;if(I&&I.showPath){var G=mstrmojo.dom.eventTarget(F.hWin,F.e),E=G.getAttribute("idx"),H=E!=null?this.items[E]:null;if(H&&H.t>-1){C(this,G,H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ListHoriz","mstrmojo.Label","mstrmojo.Image");mstrmojo.requiresDescs(8042,5,2918,9950);var G=mstrmojo.desc;var E={exit:0,report:1,doc:2,analysis:3};function A(J,H){var I={};switch(J){case E.analysis:I={evt:"3104",src:microstrategy.servletName+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:H,rwCreateFlags:"16",rwViewMode:"2048"};break;case E.doc:I={evt:"3104",src:microstrategy.servletName+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:H};break;case E.report:I={iframe:"true",evt:["5005","17004"],src:[microstrategy.servletName+".create.5005",microstrategy.servletName+".create.ObjectExplorer.17004"],selectedObjectID:H,defaultevtlist:"17004"};break;case E.exit:I={evt:"3010"};break;}return I;}function D(){var H=[],I=this.privileges;if(I.CreateAnalysis===1){H.push({icon:"newvi",n:G(8042,"Create Analysis"),desc:G(9948,"Explore data visually and discover trends, patterns, relationships and outliers"),redirect:E.analysis});}if(I.CreateViewReport===1){H.push({icon:"newreport",n:G(5,"Create Report"),desc:G(49),redirect:E.report});}if(I.CreateReportServices===1){H.push({icon:"newdoc",n:G(2918,"Create Document"),desc:G(3289,"Create an enterprise report, scorecard, or dashboard from scratch or from a template"),redirect:E.doc});}return H;}mstrmojo.DI.DIExitOptions=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DI.DIExitOptions",markupString:'<div id="{@id}" class="mstrmojo-di-exitoptions {@cssClass}" ><div class="cf green-background"></div><div></div></div>',markupSlots:{headerNode:function(){return this.domNode.firstChild;},listNode:function(){return this.domNode.children[1];}},privileges:mstrApp.diParams,redirectToPage:function B(H){mstrApp.redirectToPage(A.call(this,H,this.model.cubeID));},children:[{scriptClass:"mstrmojo.Image",cssClass:"di-exit-options mstrmojo-di-check-icon checkcircle",slot:"headerNode"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-exit-title",alias:"exitTitle",text:"",onRender:function F(){this.set("text",G(9950,"Your data was imported successfully as ##.").replace("##",this.parent.model.path)+"<br>"+G(11185,"Please select what you would like to do with the data now."));},slot:"headerNode"},{scriptClass:"mstrmojo.ListHoriz",cssClass:"mstrmojo-di-exitList",slot:"listNode",alias:"exitOptions",itemMarkup:'<div class="mstrmojo-di-option-lnk" title="{@title}" ><div class="mstrmojo-di-option-icn {@icon}"></div><div class="mstrmojo-di-option-nm">{@n}</div><div class="mstrmojo-di-option-dsc">{@desc}</div></div>',onchange:function(){this.parent.redirectToPage(this.selectedItem.redirect);}}],preBuildRendering:function C(){if(this._super){this._super();}this.exitOptions.set("items",D.call(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.List");mstrmojo.requiresDescs(9924);var A=mstrmojo.dom,B=mstrmojo.css,E=mstrmojo.desc;var C={NONE:0,CITY:1,STATE:2,COUNTRY:3,LOCATION:4,LATITUDE:5,LONGTITUDE:6,OTHER:7,ZIPCODE:8,COUNTY:9};var D=[{n:mstrmojo.desc(2057,"None"),did:C.NONE,geo:true},{n:mstrmojo.desc(7674,"Country"),did:C.COUNTRY,geo:true},{n:mstrmojo.desc(7676,"State"),did:C.STATE,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456}]},{n:"County",did:C.COUNTY,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456},{n:mstrmojo.desc(7676,"State"),did:536870912}]},{n:mstrmojo.desc(7675,"City"),did:C.CITY,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456},{n:mstrmojo.desc(7676,"State"),did:536870912}]},{n:mstrmojo.desc(7677,"Zip Code"),did:C.ZIPCODE,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456},{n:mstrmojo.desc(7676,"State"),did:536870912},{n:mstrmojo.desc(7675,"City"),did:1073741824}]},{n:mstrmojo.desc(7696,"Latitude"),did:C.LATITUDE,geo:true},{n:mstrmojo.desc(7697,"Longtitude"),did:C.LONGTITUDE,geo:true},{n:"City, State",did:C.LOCATION,geo:true},{n:mstrmojo.desc(9923,"Others..."),did:C.OTHER,geo:true}];if(mstrApp.isCloudPro){D.splice(-1);}mstrmojo.qb.GeoRole=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.GeoRole",markupString:'<div id="{@id}"  class="{@cssClass}" style="top:{@top};left:{@left};width:155px;height:{@height};"><div style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown,click><div class="mstrmojo-qb-mapping-title">{@title}</div><div class="mstrmojo-qb-mapping-georole"></div><div class="mstrmojo-qb-mapping-buttons"></div></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild.childNodes[1];},titleNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];}},top:"0px",left:"0px",height:"320px",title:"Please select a geography role for this attribute and any additional attributes that you want to create.",georole:0,shapeKeys:[],der:0,_close:function(){var F=this.parent;if(F&&F._cmSource){F._cmSource.closeMenuTree();}},onOK:function(){var I=this.parent,F=I._cmSource;if(F.executeCommand){this.data.geo=true;if(this.geolist.selectedItem.geo){var H=this.geolist.selectedItem.did;this.data.georole=H;var G={2:268435456,1:805306368,9:805306368,8:1879048192}[H]||0;this.data.der=this.der=this.der&G;}else{this.data.georole=7;this.data.shapeKey=this.geolist.selectedItem.did;}F.executeCommand(this.data);}this._close();},onCancel:function(){this._close();},children:[{scriptClass:"mstrmojo.List",slot:"contentNode",alias:"geolist",cssClass:"mstrmojo-qb-geolist",itemIdField:"did",cssClassItem:"",onclick:function(G){var L=A.eventTarget(G.hWin,G.e).parentNode;if(L.className.indexOf("mstrmojo-qb-georole-attribute")>-1){var J=parseInt(L.getAttribute("did"),10);var I=[],K=this.domNode.children[0].children;switch(J){case 268435456:I.push(K[5].children[0].children[1].children[0].children[1]);I.push(K[4].children[0].children[1].children[0].children[1]);I.push(K[3].children[0].children[1].children[0].children[1]);I.push(K[2].children[0].children[1].children[0].children[1]);break;case 536870912:I.push(K[5].children[0].children[1].children[0].children[2]);I.push(K[4].children[0].children[1].children[0].children[2]);I.push(K[3].children[0].children[1].children[0].children[2]);break;case 1073741824:I.push(L);break;default:break;}if(this.parent.der&J){for(var H=0,F=I.length;H<F;H++){B.removeClass(I[H],"selected");}}else{for(var H=0,F=I.length;H<F;H++){B.addClass(I[H],"selected");}}this.parent.der=this.parent.der^J;}},adjustMenu:function(){var F=this.parent.parent;if(F){F=F.parent.parent;if(F&&F.adjustMenuPosition){F.adjustMenuPosition();}}},expandShapeKeyNode:function(){B.addClass(this.domNode,"showShapeKey");this.adjustMenu();},onmouseup:function(F){switch(this.selectedItem.did){case C.OTHER:this.expandShapeKeyNode();this.set("selectedItem",{did:this.parent.shapeKey});break;}},onchange:function(H){var F=H.added;if(F){switch(this.selectedItem.did){case C.COUNTY:case C.CITY:case C.STATE:case C.ZIPCODE:this.adjustMenu();break;case C.OTHER:var G=H.removed;if(G&&G.length){this.set("selectedIndex",G[0]);this.expandShapeKeyNode();}break;}}},bindings:{items:function(){return(this.parent.shapeKeys)?D.concat(this.parent.shapeKeys):D;}},itemMarkupFunction:function(M,K,H){var N=[],F=H.parent;if(M.items){var I=M.items,L="onclick=\"mstrmojo.dom.captureDomEvent('"+H.id+"','click', self, event)\"";N.push('<div class="mstrmojo-qb-georole-attribute-box"><span>');N.push(E(9924,"Create attributes for:"));N.push("</span>");for(var G=0,J=I.length;G<J;G++){N.push('<div class="mstrmojo-qb-georole-attribute '+((F.der&I[G].did)?"selected":"")+'" did="'+I[G].did+'"'+L+'><img class="mstrmojo-qb-georole-checkbox" src="../images/1ptrans.gif"><span style="padding-left:5px;">');N.push(I[G].n);N.push("</span></div>");}N.push("</div>");}return'<div class="mstrmojo-qb-georole '+((M.did==C.OTHER)?"other":"")+(M.geo?"":"shapeKey ")+H.cssClassItem+'" idx="'+K+'" did="'+M.did+'"><div class="mstrmojo-qb-georole-itemtext"><img class="mstrmojo-qb-georole-img" src="../images/1ptrans.gif"><span class="mstrmojo-qb-georole-text">'+M.n+'</span></div><div class="mstrmojo-qb-georole-itemcontent">'+N.join("")+"</div></div>";},onRender:function(){this.set("selectedItem",{did:this.parent.georole});}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox cf",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(1442,"OK"),onclick:function(F){var G=this.parent.parent;if(G.onOK){G.onOK();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(F){var G=this.parent.parent;if(G.onCancel){G.onCancel();}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(E){var D=E[this.itemType],C=E[this.itemSubType],A=" t"+D,B=(D==1||D==3)?" st"+C:"",F=E[this.itemISC]?'class="mstrmojo-ListIcon isc"':"";return'<span class="mstrmojo-ListIcon '+A+B+'"><span '+F+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length;if(A>0){for(var B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+E.substring(0,G)+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc"});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(F,D){var E=this.items;this.items=D||[];return E!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var E=this.value,D=this.selectedIndex,G=this.items||[],H,F;if(D===undefined||(E!==null&&(D===-1||(D!==-1&&G[D]&&G[D][this.itemIdField]!==E)))){D=mstrmojo.array.find(G,this.itemIdField,E);D=(D>-1)?D:this.defaultSelection;this.selectedIndex=D;}else{if(E===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=H=G[this.selectedIndex];if(H){F=H[this.itemField];}else{F=this.defaultText||"";}this.set("text",F);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function(E){var F=this.value,D=-1;if(F!==null){D=mstrmojo.array.find(this.items,this.itemIdField,F);}if(D>-1){this.selectedItem=this.items[D];this.selectedIndex=D;}},togglePopup:function C(){if(this.popupToBody){var G=mstrmojo.dom.position(this.popupNode,true),F=this.popupRef,D={left:Math.round(G.x)+"px",top:Math.round(G.y)+"px"};if(!F.hasRendered){delete F.slot;D.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(D,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var E=this.popupRef.domNode;if(E){if(this.fixWidth){E.style.width=(this.domNode.offsetWidth-2)+"px";}else{E.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(D){this.togglePopup();},unrender:function B(D){var E=this.popupRef;if(this.popupToBody&&E.hasRendered){E.unrender(false);}if(this._super){this._super(D);}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var F=this.opener,E=F&&F.popupZIndex,G=F&&F.popupCssClass||"",D=this.domNode;if(E){D.style.zIndex=E;}if(G){mstrmojo.css.addClass(D,[G]);}if(F&&F.fixWidth){mstrmojo.css.addClass(D,["fix-width"]);}if(F&&F.fixHeight){mstrmojo.css.addClass(D,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(F,D,E){return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+(F[E.itemCSS]||"")+'" title="'+F[E.itemField]+'">'+(F[E.itemField]||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var F=this.parent,G=F.visible,D=F.opener,E=this.selectedItem;if(!D||!E||!G){return ;}D.set("value",E[this.itemIdField]);}}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.CheckBox");function A(B){var C={scriptClass:"mstrmojo.CheckBox",label:B.caption,alias:"check",oncheckedChange:function(D){B.set("checked",D.value);},slot:"0,1"};B.tbl.addChildren([C]);}mstrmojo.WH.DBRoleSettingCheckbox=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.WH.DBRoleSettingCheckbox",cssText:"width: 100%;",postBuildRendering:function(){if(this._super){this._super();}A(this);},caption:"",checked:false,oncheckedChange:function(B){this.tbl.check.set("checked",B.value);},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"tbl",cssText:"width:100%;",layout:[{cells:[{cssText:"width: 20%; text-align:right;"},{cssText:"width:80%;"}]}],children:[{scriptClass:"mstrmojo.Label",alias:"lbl",text:"",slot:"0,0"}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.Box");function A(B){B.tbl.lbl.set("text",B.caption);if(B.isPassword){B.tbl.txt.type="password";}}mstrmojo.WH.Password=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.WH.DBRoleSetting",cssText:"width: 100%;",settingtype:"text",postBuildRendering:function(){if(this._super){this._super();}A(this);},caption:"",text:"",ontextChange:function(B){this.tbl.txt.set("value",this.text);},isPassword:false,isNumeric:false,children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"tbl",cssText:"width:100%;",layout:[{cells:[{cssText:"width:20%;"},{cssText:"width:80%;"}]}],children:[{scriptClass:"mstrmojo.Label",alias:"lbl",text:"this.parent.caption",slot:"0,0"},{scriptClass:"mstrmojo.TextBox",alias:"txt",markupString:'<input type="password" id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" mstrAttach:focus,keyup,blur,paste,cut,input />',cssText:"margin:5px 0px;",onvalueChange:function(B){this.parent.parent.text=B.value;},slot:"0,1"}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.Box");function A(B){B.tbl.lbl.set("text",B.caption);if(B.isPassword){B.tbl.txt.type="password";}}mstrmojo.WH.DBRoleSetting=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.WH.DBRoleSetting",cssText:"width: 100%;",settingtype:"text",postBuildRendering:function(){if(this._super){this._super();}A(this);},caption:"",text:"",ontextChange:function(B){this.tbl.txt.set("value",this.text);},isPassword:false,isNumeric:false,children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"tbl",cssText:"width:100%;",layout:[{cells:[{cssText:"width:20%;"},{cssText:"width:80%;"}]}],children:[{scriptClass:"mstrmojo.Label",alias:"lbl",text:"this.parent.caption",slot:"0,0"},{scriptClass:"mstrmojo.TextBox",alias:"txt",cssText:"width:278px;margin:5px 0px;",onvalueChange:function(B){this.parent.parent.text=B.value;},slot:"0,1"}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox");mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur ></textarea>',maxLength:256,markupSlots:{inputNode:function(){return this.domNode;}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncssClassChange=function(){this.domNode.className="mstrmojo-TextArea "+(this.cssClass||"");};},onkeydown:function(D){var C=(this.value&&this.value.length)||0;if(this.maxLength<=C){this.isDeleteKeys=D.e.keyCode===8||D.e.keyCode===46;this.isArrowKeys=D.e.keyCode===37||D.e.keyCode===38||D.e.keyCode===39||D.e.keyCode===40;var B=(this.domNode.selectionEnd!==undefined)?(this.domNode.selectionEnd-this.domNode.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!B){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var A=this.domNode;A.blur();window.setTimeout(function(){A.focus();},1);}mstrmojo.dom.preventDefault(window,D.e);return false;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var H=mstrmojo.func.composite,F=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(O){if(O){return ;}var M=this.visible,N=M?"block":"none";this.editorNode.style.display=N;if(this.modal){this.curtainNode.style.display=N;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function I(){var M;var N=this.buttons;if(N&&!this.btnHbox){for(M in N){N[M].cssClass="mstrmojo-Editor-button";}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:N},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function D(){var M=this.placeholder;if(this._super()){if(!this.parent&&!M){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function G(){var M=this.id;return function(){var N=mstrmojo.all[M];N.resizeDialog();N.positionDialog();};},postBuildRendering:function B(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var M=this._resizeHandler=this.getResizeHandler();F.attachEvent(window,"resize",M);}this.resizeDialog();this.positionDialog();this.domNode.focus();return true;},resizeDialog:function J(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function E(){var N=this,R=N.curtainNode,M=document.body,P=document.documentElement,Q=R.style,O=N.curtainPosition;Q.width=Math.max(M.clientWidth,P.scrollWidth)+"px";if(O&&O.h){Q.height=O.h+"px";}else{Q.height=Math.max(M.clientHeight,P.scrollHeight)+"px";}if(O&&O.y){Q.top=O.y+"px";}N.raiseEvent({name:"resizeCurtain"});},positionDialog:function K(){if(!this.left||!this.top){var M=this.editorNode;F.center(M);if(this.alignment==="top"){M.style.top="10px";}}},destroy:function(N){var M=this._resizeHandler;if(M){F.detachEvent(window,"resize",M);}this._super(N);}});if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.confirm=function A(P,N,O){var Q="mojoConfirmx9",M=function(){mstrmojo.all[Q].destroy();};mstrmojo.array.forEach(N,function(R){var S=R.onclick;R.onclick=S?H([M,S]):M;});mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:N,children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.alert=function C(P,M,O){var Q="mojoAlertx9";try{mstrmojo.all[Q].destroy();}catch(N){}mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),function(){mstrmojo.all.mojoAlertx9.destroy();if(M){M();}},"#666666")],children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.toast=function L(Q,O){var R="mojoToast9",P,N=O||3000;try{mstrmojo.all[R].destroy();}catch(M){}mstrmojo.insert({id:R,scriptClass:"mstrmojo.Label",cssClass:"toastCss",text:Q}).render();P=mstrmojo.all[R].domNode;document.body.appendChild(P);F.bottomCenter(P);window.setTimeout(function(){mstrmojo.all[R].destroy();},N);};mstrmojo.mask={};mstrmojo.mask.show=function(){mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});mstrmojo.mask.win.render();document.body.appendChild(mstrmojo.mask.win.domNode);};mstrmojo.mask.hide=function(){mstrmojo.mask.win.destroy();};}}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.hash","mstrmojo.css","mstrmojo.Button");var H=mstrmojo.css,E="mstrmojo-qb-toolbarIcon",J="on",F="connectionview",C="viewtable",B="conditionview",I="refreshOption",K="help",D=" ";function G(N){return mstrmojo.hash.copy(N,{scriptClass:"mstrmojo.Button",onactiveChange:function M(){H.toggleClass(this.domNode,J,this.active);},onclick:function L(){this.set("active",!this.active);if(this.cmd){mstrApp.getRootController()[this.cmd](this.active);}if(!this.persistSelection){var O=this;window.setTimeout(function(){O.set("active",false);},100);}}});}mstrmojo.qb.Toolbar=mstrmojo.declare(mstrmojo.Box,null,{children:[G({cmd:"toggleDatabaseView",active:true,iconClass:[E,F,J].join(D),title:mstrmojo.desc(9111,"Database View"),persistSelection:true}),G({cmd:"toggleDataPreview",active:false,iconClass:[E,C].join(D),title:mstrmojo.desc(9113,"Data Preview"),persistSelection:true,postBuildRendering:function A(){var L=mstrApp.getRootController(),M=this.id;L.attachEventListener("dataPreview",M,function(){this.set("active",true);});L.attachEventListener("reportModeChange",M,function(N){this.set("active",N.showPreview);});}}),G({cmd:"openConditionDialog",iconClass:[E,B].join(D),title:mstrmojo.desc(6189,"Filter"),postBuildRendering:function A(){mstrApp.getRootController().attachEventListener("reportModeChange",this.id,function(L){this.set("visible",L.mode!==2);});}}),G({cmd:"openRefreshOptionDialog",iconClass:[E,I].join(D),title:mstrmojo.desc(9136,"Data Refresh Options")}),G({cmd:"openHelp",iconClass:[E,K].join(D),title:mstrmojo.desc(1143,"help")})]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom","mstrmojo.css");var C=mstrmojo.css;var B=mstrmojo.dom;function E(J){var L=document.createElement("div"),K=L.style,I=J.domNode;L.className="mstrmojo-VSplitPanel-avatar";K.width=I.clientWidth+"px";I.appendChild(L);J.avatar=L;return L;}mstrmojo.qb.VSplitPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.qb.VSplitPanel",draggable:true,dropZone:false,width:0,topP:40,topItemVisible:true,bottomItemVisible:true,borderoffset:0,marginSpan:20,minSpan:80,markupString:'<div id="{@id}" class="mstrmojo-VSplitPanel {@cssClass}" style="{@cssText}" mstrAttach:mouseup,mousemove ><div></div><div style="padding-top:{@marginSpan}px;"><div class="mstrmojo-VSplitPanel-resizeHandle" style="width:{@width};height:{@marginSpan}px;margin-top:-{@marginSpan}px"></div></div></div>',markupSlots:{topItem:function(){return this.domNode.children[0];},bottomItem:function(){return this.domNode.children[1];}},children:[{scripClass:"mstrmojo.Box",slot:"topItem"},{scripClass:"mstrmojo.Box",slot:"bottomItem"}],getDragData:function F(I){var J=I.src,L=J.node;if(L.className&&L.className.indexOf("mstrmojo-VSplitPanel-resizeHandle")>=0){var K=B.position(this.domNode);return{node:L,x:K.x,y:K.y,h:K.h,w:K.w};}else{if(this._super){return this.dropZone&&this._super(I);}}return null;},allowDrop:function A(I){var J=I.src,K=J&&J.data;if(K&&K.node){return true;}else{return this.dropZone;}},ondragmove:function H(I){var K=I.src,M=K&&K.data;if(M&&M.node){var J=I.tgt,L=this.avatar;if(L){L.style.top=Math.min(Math.max(M.y+this.minSpan,J.pos.y),M.y+M.h-this.minSpan)+"px";}}},ondragstart:function D(I){var J=I.src,L=J&&J.data;if(L&&L.node){var K=this.avatar||E(this);this.ownAvatar=true;K.style.top=Math.max(L.y,J.pos.y)+"px";K.style.left=L.x+"px";K.style.display="block";K.style.zIndex="9999";K.style.width=L.w+"px";return true;}else{if(this._super){return this._super(I);}}return false;},ondragend:function G(I){var L=I.src,N=L&&L.data;if(N&&N.node){var M=this.avatar;if(M){M.style.display="none";var J=parseInt(M.style.top)-N.y,K=this.domNode.clientHeight;this.topP=J*100/K;this.layoutConfig.h={topItem:this.topP+"%",bottomItem:100-this.topP+"%"};this.doLayout();}this.ownAvatar=false;}else{if(this._super){this._super(I);}}},layoutConfig:{w:{topItem:"100%",bottomItem:"100%"},h:{topItem:"40%",bottomItem:"60%"}},afterLayout:function(){if(this.domNode){var J=this.domNode.children[1].children[0].style;if(this.topItemVisible&&this.bottomItemVisible){J.display="block";this.children[0].set("visible",true);this.children[1].set("visible",true);J.width=this.width;var I=parseInt(this.children[0].height);this.children[0].set("height",I+"px");this.bottomItem.style.height=parseInt(this.height)-I-this.marginSpan+"px";this.children[1].set("height",this.bottomItem.style.height);}else{J.display="none";if(this.topItemVisible){this.children[0].set("width",this.width);this.children[1].set("visible",false);}else{this.children[1].set("width",this.width);this.children[0].set("visible",false);}}}},_set_topItemVisible:function(K,I){if(this.topItemVisible!=I){this.topItemVisible=I;if(I){this.layoutConfig.h={topItem:this.topP+"%",bottomItem:100-this.topP+"%"};if(this.bottomItem){var J=this.bottomItem;J.style["padding-top"]=this.marginSpan+"px";}}else{this.layoutConfig.h={topItem:"0%",bottomItem:"100%"};if(this.bottomItem){var J=this.bottomItem.parentNode;J.style["padding-top"]="0px";}}this.doLayout();}},_set_bottomItemVisible:function(J,I){if(this.bottomItemVisible!=I){this.bottomItemVisible=I;if(I){this.layoutConfig.h={topItem:this.topP+"%",bottomItem:100-this.topP+"%"};}else{this.layoutConfig.h={topItem:"100%",bottomItem:"0%"};}this.doLayout();}},postBuildRendering:function(){if(this._super){this._super();}this.width=this.domNode.clientWidth+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var O=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],V=["width","height"],n="p_fmts";var k="px";var g={getContentHeight:function(q,t){var r=t.ttl&&t.ttl.height;if(q&&r&&!this.floatingToolbar){return Math.max(parseInt(q,10)-parseInt(r,10),0)+k;}return"";},getPortletMinHeight:function(q){return q.ttl.height;},adjustTitleCss:function(q){return ;}};var d={getContentHeight:function(q,r){return q;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(q){q.titlebarNodeClass+=" floating";return ;}};function A(u,r){var t=this.parent,q=u+"DirtyKey";if(t[q]){t[q](r);}}function N(){var q=this.title;if(this.count){q+=" "+this.count;}this.toolbarTitleTextNode.innerHTML=q;}function f(){var r=this.parent,u=r&&r.defn;if(u&&parseInt(u.t,10)===mstrmojo.EnumRWUnitType.PANEL){var q=r.parent,t=q.defn;if(t&&t.ifp){return q;}}return null;}var P=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;">{@title} {@count}</div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){N.call(this);},oncountChange:function(){N.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B"],shadowNode:["RW","B","fx","background-color"],titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]},buttonbarNode:{src:"ttl",props:["background-color"]}},fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:g,getCacheKey:function F(q){return this._super(q)+"-portlet";},getFormats:function L(){var r=this.content,q=r&&r.getFormats();return q&&q[n];},updateContentHeight:function b(x){var q=this.getFormats(),r=this.content,u=r.dimNode||r.domNode,t=((q.ttl&&parseInt(q.ttl.height,10))||0);if(u){if(!x){t+=((this.fc||this.isInFilterPanel())?u.offsetHeight:(q.height?parseInt(q.height,10):0));}this.containerNode.style.height=t+k;this.shadowNode.style.height=t+k;}},init:function o(q){this._super(q);var r=this.content;if(r&&r.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var r=this._ts=(this.floatingTitle)?d:g;this._super();r.adjustTitleCss(this);var q="display:none;";if(this.isInFilterPanel()){var t=P.clone(this.formatHandlers);t.portletContainerNode=["z-index","height","B","backgroud-color"];t.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=t;}if(!this.leftToolbar){this.leftToolbarNodeCssText+=q;}if(!this.toolbar){this.toolbarNodeCssText+=q;}var u=mstrmojo._Formattable.getBorderWidths(this);if(u.l||u.t||u.r){this.borderCss="has-border";}},postBuildRendering:function W(){var u=mstrmojo.dom,x=mstrmojo.css,z=this.contentNode,AC=this.titleNode,AA=this;if(this.titleNode){if(this.floatingTitle){document.body.appendChild(this.titleNode);if(!this._onhover){this._onhovertt=function(){x.addClass(AA.titleNode,["visible"]);AA._onflt=true;return true;};this._onhoverofftt=function(){x.removeClass(AA.titleNode,["visible"]);AA._onflt=false;return true;};this._onhover=function(){var AD=AA.titleNode;x.addClass(AD,["visible"]);var AE=u.position(AA.contentNode,true);AD.style.top=(AE.y-AD.clientHeight+2)+k;AD.style.left=AE.x+k;return true;};this._onhoveroff=function(){x.removeClass(AA.titleNode,["visible"]);return true;};}u.attachEvent(z,"mouseover",this._onhover);u.attachEvent(z,"mouseout",this._onhoveroff);u.attachEvent(AC,"mouseover",this._onhovertt);u.attachEvent(AC,"mouseout",this._onhoverofftt);}if(this.attachContextMenuEvent){this._oncontextmenu=function(AE,t){var AD=AA.rightToolbar&&AA.rightToolbar.btnMenu;if(AD){AD.cmPos=u.getMousePosition(AE,t);AD.openPopupMenu();AD.cmPos=null;u.preventDefault(t,AE);}};u.attachEvent(AC,"contextmenu",this._oncontextmenu);}}if(this._super){this._super();}var y=this.getFormats();this.set("fc",y&&!y.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var q=this.portletContainerNode.style,r=this.shadowNode.style,AB=this.parent;q.width=r.width="99%";q.top=r.top=AB.topStart+k;q.left=r.left=G+k;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(y.left)+G*this.orgPos+k;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}},adjustFPHeight2Fit:function(){var t=mstrmojo.dom,q=t.position(this.titleNode),r=t.position(this.contentNode).y-q.y-q.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height)-r+"px";},unrender:function E(r){if(this.floatingTitle&&this.titleNode){var x=this.domNode,q=this.titleNode,u=mstrmojo.dom;if(x&&this._onhover){u.detachEvent(x,"mouseover",this._onhover);}if(x&&this._onhoveroff){u.detachEvent(x,"mouseout",this._onhoveroff);}if(q&&this._onhovertt){u.detachEvent(q,"mouseover",this._onhovertt);}if(q&&this._onhoverofftt){u.detachEvent(q,"mouseout",this._onhoverofftt);}if(q&&this._oncontextmenu){u.detachEvent(q,"contextmenu",this._oncontextmenu);}if(q){document.body.removeChild(q);}}if(this._super){this._super(r);}},updateStyle:function(r,q){var u=this.shadowNode.style,t=this.containerNode.style;u.height=t.height=r;u.width=t.width=q;},_createFormats:function T(){var u=this.content&&this.content.getFormats(),r;r=u.p_fmts={};var q,t;for(q in O){t=O[q];if(t in u){r[t]=u[t];delete u[t];}}for(q in V){t=V[q];if(t in u){r[t]=u[t];}}u.height=this._ts.getContentHeight(u.height,r);if(mstrmojo.dom.isIE&&r.fx&&r.fx.ds&&!r["background-color"]){r["background-color"]="#ffffff";}},refresh:function p(){if(!this.hasRendered){return ;}var r=this.children,q;for(q=r.length-1;q>=0;q--){r[q].refresh();}},isInFilterPanel:function K(){return(f.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var q=this.getFilterPanel();return q&&q.defn&&q.defn.fds==2;}else{return false;}},getFilterPanel:function H(){return f.call(this);},getContainerHeight:function a(){return this.containerNode.clientHeight;},relocate:function C(r,q){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=r+k;}},setInfoWindowDimensions:function l(x){var r=this.domNode.style,q=this.shadowNode.style,t=this.portletContainerNode.style,u=mstrmojo._Formattable.getBorderWidths(this);x.h-=u.h;x.w-=u.w;q.height=t.height=r.height=x.h+k;q.width=t.width=r.width=x.w+k;x.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function J(q){A.call(this,"add",q);},removeDirtyKey:function I(q){A.call(this,"remove",q);},setDirtyChildren:function X(){var q=this.content;if(q&&q.setDirtyChildren){q.setDirtyChildren.apply(q,arguments);}}});var U=0,M=1,h=2;function Y(AE,AC,q,AF){var AB=this.content,AD=AB.k,AA=mstrmojo.boxmodel.px2Inches,t=AB.model.docModel||AB.model,u=this.getFormats(),AG={},z=this,x=function(){var AH=z.content&&z.content.defn;if(AH){AH.set("ds",AE);}},r={ZIndex:u["z-index"],WindowState:AE},y={};y[AD]=r;if(AC!==undefined&&q!==undefined){P.copy({OldHeight:AA(t,AC),OldWidth:AA(t,q),Height:AA(t,parseInt(u.height,10)),Width:AA(t,parseInt(u.width,10))},r);AG.success=function(AH){var AI=AH&&AH.data;if(AI){AB.model.loadPartialData(AI,AD);}x();var AJ=z.parent;if("adjustSectionSize" in AJ){AJ.adjustSectionSize();}};t.saveRWProps(AD,y,1,this.loadDataOnResize,AG,true);}else{x();if(!(AF&&AF.all)){t.saveRWProps(AD,y,1,this.loadDataOnResize,AG,true);}}return y;}function R(){var z=this.content;if(!z){return ;}var x=function(AD){mstrmojo.array.forEach(AD,function(AE){if("ds" in AE){AE.set("visible",(AE.ds!==z.defn.ds));}});},AA;if(this.isInFilterPanel()){var t=(parseInt(this.defn.ds,10)===U);z.set("visible",t);this.updateContentHeight(!t);AA=this.leftToolbar;x(AA&&AA.children);var u=this.parent;if(u.refreshFP){u.refreshFP();}}else{var q=z.getFormats(),AB=this.getFormats(),r=this.portletContainerNode.style,AC=this.shadowNode.style,y=this.contentNode.firstChild.style;y.height=q.height;y.width=q.width;AC.height=r.height=AB.height;AC.width=r.width=AB.width;AC.top=r.top=AB.top;AC.left=r.left=AB.left;if("z-index" in AB){AC.zIndex=r.zIndex=AB["z-index"];}AA=this.rightToolbar;x(AA&&AA.children);if(z.resize){z.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function T(){this._super();var r=this.getFormats();var q=parseInt(this.defn.ds,10);if(q===U){r.normHeight=r.height;r.normWidth=r.width;if(r["z-index"]!==null&&r["z-index"]!==undefined){r.normZIndex=r["z-index"];}}if(q!==h){r.normTop=r.top;r.normLeft=r.left;}},onmaximize:function c(){var u=this.parent,z=this.content,y=z&&z.getFormats(),t=this.getFormats(),r=t.height,q=t.width,x=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();z.clearCache();t.height=(parseInt(u.height(),10)-x.h)+k;y.height=this._ts.getContentHeight(t.height,t);t.width=y.width=(u.width()-x.w)+k;t.top=t.left=0;t["z-index"]=u.getMaxZIndex()+1;Y.call(this,h,r,q);},onminimize:function Z(){var y=this.content,r=y.dimNode||y.domNode,x=y&&y.getFormats(),u=this.getFormats(),t=u.height||r.offsetHeight,q=u.width;this.clearCache();y.clearCache();u.width=x.width=u.normWidth;u.top=u.normTop;u.left=u.normLeft;if(u.normZIndex!==null&&u.normZIndex!==undefined){u["z-index"]=u.normZIndex;}x.height=0;u.height=this._ts.getPortletMinHeight(u);Y.call(this,M,t,q);},onrestore:function Q(){var x=this.content,u=x&&x.getFormats(),t=this.getFormats(),r=t.height,q=t.width;this.clearCache();x.clearCache();t.height=t.normHeight;u.height=this._ts.getContentHeight(t.height,t);t.width=u.width=t.normWidth;t.top=t.normTop;t.left=t.normLeft;if(t.normZIndex!==null&&t.normZIndex!==undefined){t["z-index"]=t.normZIndex;}Y.call(this,U,r,q);},oncollapse:function S(q){return Y.call(this,M,undefined,undefined,q);},onexpand:function D(q){return Y.call(this,U,undefined,undefined,q);},postBuildRendering:function W(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,R);}this._super();if(this.isInFilterPanel()){var q=(parseInt(this.defn.ds,10)===U);this.updateContentHeight(!q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var A=mstrmojo.dom,B={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(B[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=A.eventTarget(D.hWin,D.e);if(F==this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd");function W(a){var c=document.createElement("div"),b=c.style,Z=a.domNode;c.className="mstrmojo-DataGrid-avatar";b.height=Z.clientHeight+"px";Z.appendChild(c);a.avatar=c;return c;}function N(Z){var a=mstrmojo.dom.position(Z.domNode,true);return a.x;}function L(Z){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+Z+'"></div>';}function X(b){var a=b.getAttribute("rh"),Z=a&&parseInt(a,10);return Z;}function U(a,f,Z){var c=Z.src,g=c&&c.data,b=g&&g.resizingIdx;if(!(b&&b>0)){return f&&f.apply(a,[Z]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function E(c,b){var Z=c.colSizeArray;var a=[-Z[b-1]+c.minColWidth,(b==Z.length-1)?Z[b]-c.resizeHandleWidth-c.minColWidth:Z[b]-c.minColWidth];return a;},updateSize:function D(c,b,a){var Z=c.colSizeArray;Z[b-1]=Z[b-1]+a;Z[b]=Z[b]-a;},updateColumnWidth:function Q(c,a,d,b){var Z=c.colSizeArray;a[b-1].style.width=Z[b-1]+"px";d[b-1].style.width=Z[b-1]+"px";a[b].style.width=Z[b]+"px";d[b].style.width=Z[b]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function E(f,d){var g=f.minColWidth+f.resizeHandleWidth,Z=f.colSizeArray,b=0;for(var c=d;c<Z.length;++c){b+=Z[c]-g;}var a=[-Z[d-1]+g,b];return a;},updateSize:function D(c,h,a){var g=c.minColWidth+c.resizeHandleWidth,d=c.colSizeArray;d[h-1]=d[h-1]+a;var Z=[];for(var b=0;b<d.length-h;++b){Z[b]=h+b;}Z.sort(function(l,n){return d[l]-d[n];});for(var b=0;b<Z.length;++b){var k=a/(Z.length-b);var f=d[Z[b]];a-=(f>=k+g)?k:f-g;d[Z[b]]=(f>=k+g)?f-k:g;}},updateColumnWidth:function Q(d,a,f,c){var Z=d.colSizeArray;for(var b=c-1;b<Z.length;++b){a[b].style.width=Z[b]+"px";f[b].style.width=Z[b]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,postBuildRendering:function S(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function C(Z){var b=Z.src,c=b.node,a=X(c);if(a&&a>0){return{resizingIdx:a,startingX:b.pos.x,baseX:N(this)};}else{if(this._super){return this.dropZone&&this._super(Z);}}return null;},allowDrop:function I(Z){var b=Z.src,c=b&&b.data,a=c&&c.resizingIdx;if(a&&a>0){return true;}else{return this.dropZone;}},ondragenter:function O(Z){U(this,this._super,Z);},ondragover:function P(Z){U(this,this._super,Z);},ondragleave:function A(Z){U(this,this._super,Z);},ondrop:function T(Z){U(this,this._super,Z);},ondragstart:function V(f){var p=f.src,g=p&&p.data,o=g&&g.resizingIdx;if(o&&o>0){var k=this.avatar||W(this);this.ownAvatar=true;k.style.left=(g.startingX-g.baseX)+"px";k.style.display="block";document.body.style.cursor="col-resize";var l=this.colSizeArray;if(!l){var b=this.headerContainerNode,h=b&&b.getElementsByTagName("table")[0],n=h.rows[0].cells;l=[];for(var Z=0,c=n.length;Z<c;Z++){l.push(n[Z].offsetWidth);}this.colSizeArray=l;this._firstTimeResize=true;}g.resizingRange=this.resizeColumnBehavior.getRange(this,o);return true;}else{if(this._super){return this._super(f);}}},ondragmove:function M(b){var n=b.src,c=n&&n.data,k=c&&c.resizingIdx;if(k&&k>0){var l=b.tgt,f=this.avatar,h=c.resizingRange,g=l.pos.x-c.startingX,Z=Math.min(h[1],Math.max(g,h[0]));c.deltaX=Z;if(f){f.style.left=(c.startingX-c.baseX+Z)+"px";}}else{if(this._super){this._super(b);}}},ondragend:function J(f){var p=f.src,g=p&&p.data,n=g&&g.resizingIdx;if(n&&n>0){var Z=this.titleColGroup,o=Z&&Z.childNodes,k=this.dataColGroup,l=k&&k.childNodes,c=o.length,h=this.colSizeArray,a=g.deltaX;this.resizeColumnBehavior.updateSize(this,n,a);if(this._firstTimeResize){for(var b=0;b<c;b++){o[b].style.width=h[b]+"px";l[b].style.width=h[b]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,o,l,n);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(f);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function H(b){var f=document.createElement("colgroup"),Z=b.length,a;for(var d=0;d<Z;d++){var c=document.createElement("col");a=b[d];if(a.colWidth){c.style.width=a.colWidth+"px";}c.className=a.colCss||("col"+d);f.appendChild(c);}return f;}function G(a){var b=a._headerWidgets_,Z=b&&b.length;if(Z>0){for(var c=0;c<Z;c++){b[c].destroy(true);}}}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},itemFunction:function(b,Z,a){var d=new mstrmojo.DataRow({columns:a.columns,data:b,idx:Z,dataGrid:a});return d;},preBuildRendering:function B(){var c=this.columns,Z=c.length,d=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],b,a;this._headerWidgets=[];for(var f=0;f<Z;f++){b=c[f];a=b.headerWidget;d.push("<td>");if(f>0&&this.resizableColumns){d.push(L(f));}d.push('<div class="mstrmojo-DataGrid-headerText');d.push(b.headerCss?" "+b.headerCss:"");if(a){this._headerWidgets.push(mstrmojo.hash.copy(a));d.push('" w="1">');}else{d.push('">');}d.push(b.headerText?b.headerText:"&nbsp");d.push("</div>");d.push("</td>");}d.push("</tr></table>");this.headerHtml=d.join("");if(this._super){this._super();}},postBuildRendering:function S(){if(this._super){this._super();}var c=this._headerWidgets,g=c.length;if(g>0){this._headerWidgets_=[];var h=this.headerContainerNode.getElementsByTagName("div"),b=mstrmojo.array.filter(h,function(p){return p.getAttribute("w")=="1";}),n;for(var d=0;d<g;d++){c[d].placeholder=b[d].firstChild;c[d].dataGrid=this;n=mstrmojo.registry.ref(c[d]);n.render();this._headerWidgets_.push(n);}}var Z=H(this.columns),l=Z.cloneNode(true),f=this.headerContainerNode,k=f&&f.getElementsByTagName("table")[0],o=this.itemsContainerNode,a=o&&o.getElementsByTagName("table")[0];this.titleColGroup=Z;this.dataColGroup=l;if(k&&a){k.insertBefore(Z,k.firstChild);a.insertBefore(l,a.firstChild);}},refresh:function F(Z){G(this);if(this._super){this._super(Z);}},destroy:function Y(Z){G(this);this._super();},unrender:function R(d){var b=this._headerWidgets_,a=b&&b.length,Z;if(a>0){for(var c=0;c<a;c++){Z=b[c];if(Z&&Z.hasRendered){Z.unrender(true);}}}this._super(d);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var g=document.createElement("tr"),n=this.data,q=this.idx,a=this.dataGrid,h=this.cssClass,t=this.columns,Z=this.children,b,o=-1,r,p;g.setAttribute("id",this.id);if(a.banding){h+=(q%2==1)?" odd":" even";}g.className=h+(mstrmojo.string.isEmpty(n[a.itemDisplayField||"n"])?" empty-row":"");for(var f=0,l=t.length;f<l;f++){r=t[f];p=(r.dataWidgetBuilder&&r.dataWidgetBuilder(n))||r.dataWidget;b=document.createElement("td");g.appendChild(b);if(p){b.setAttribute("w","1");o++;Z.push(mstrmojo.hash.copy(p,{slot:"slot"+o,data:n,idx:q,dataGrid:a}));}else{if(r.dataFunction){b.innerHTML=r.dataFunction(n,q,a);}else{var c=mstrmojo.string.htmlAngles(n[r.dataField||"n"])||"&nbsp",k=r.tooltip?' title="'+c+'"':"";b.innerHTML='<div class="mstrmojo-DataRow-text" '+k+">"+c+"</div>";}}}this.initChildren();return g;},buildRendering:function K(){this._super();var d=this.domNode.childNodes,Z=d.length,c={},b=0,f;for(var a=0;a<Z;a++){f=d[a];if(f.getAttribute("w")=="1"){c["slot"+b]=f;b++;}}this.addSlots(c);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasPopup","mstrmojo.string","mstrmojo.Pulldown","mstrmojo.Container");var C=mstrmojo.css;mstrmojo.CustomGroupEl=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.CustomGroupEl",markupString:'<div id="{@id}" class="mstrmojo-onhoverparent mstrmojo-CustomGroupEl {@cssClass}" style="{@cssText}" mstrAttach:mouseover><div class="mstrmojo-CustomGroupEl-title {@cssClass}" mstrAttach:click><img class="mstrmojo-CustomGroupEl-state {@cssClass}" src="../images/1ptrans.gif" align="absmiddle" onclick="var w = mstrmojo.all[\'{@id}\']; w.set(\'state\', !w.state)" /><span class="mstrmojo-text"></span></div><div class="mstrmojo-onhover mstrmojo-abs mstrmojo-topright mstrmojo-CustomGroupEl-tools {@cssClass}"><img class="mstrmojo-dup" src="../images/1ptrans.gif" title="'+mstrmojo.desc(3397,"Duplicate")+'" onclick="mstrmojo.all[\'{@id}\'].dup()" /><img class="mstrmojo-ops" src="../images/1ptrans.gif"onclick="var w = mstrmojo.all[\'{@id}\'].showOps();" title="'+mstrmojo.desc(7932,"Element display options")+'" /><img class="mstrmojo-del" src="../images/1ptrans.gif" onclick="mstrmojo.all[\'{@id}\'].del()" title="'+mstrmojo.desc(7933,"Delete element")+'"/></div><div class="mstrmojo-CustomGroupEl-details {@cssClass}"><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr-tools {@cssClass}"></div></div></div>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},titleNode:function(){return this.domNode.firstChild.lastChild;},detailsNode:function(){return this.domNode.lastChild;},exprNode:function(){return this.domNode.lastChild.firstChild;},exprToolsNode:function(){return this.domNode.lastChild.lastChild;},titlebarNode:function(){return this.domNode.firstChild;}},markupMethods:{ondataChange:function(){var G=this.data,F=G&&G.n;this.titleNode.innerHTML=(F!=null)?mstrmojo.string.encodeHtmlString(F):"";},onstateChange:function(){var F=this.stateNode;F.className="mstrmojo-CustomGroupEl-state "+(this.state?"opened":"closed");this.detailsNode.style.display=this.state?"block":"none";},onselectedChange:function(){C.toggleClass(this.domNode,["selected"],this.selected);},onshowaddChange:function(){this.exprToolsNode.style.display=this.showadd?"block":"none";}},_set_data:function A(H,F){var G=this.data;this.data=F;this.set("expr",F&&F.expr);return G!==F;},optionsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(7934,"Element Options"),contentNodeCssClass:"mstrmojo-balloon",cssClass:"mstrmojo-CGEOptionsEditor",help:"element_options_dialog_box.htm",ce:false,isp:false,onOpen:function(){var F=this.opener.data,G=this.ops.dsplb.dspl;G.set("value",F.ce?2:(F.isp?1:0));},save:function(){var F=this.ops.dsplb.dspl.value,G=this.opener.data;G.ce=(F==2);G.isp=(F==1);this.close();},children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ElementOptions",alias:"ops",children:[{scriptClass:"mstrmojo.HBox",alias:"dsplb",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(168,"Display:"),cssText:"margin: 0 5px;"},{alias:"dspl",scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:[{n:mstrmojo.desc(7935,"Display element name only (Default)"),v:0},{n:mstrmojo.desc(7936,"Display individual items only"),v:1},{n:mstrmojo.desc(7937,"Display element name and individual items"),v:2}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssText:"float:right;width:150px;margin:5px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(118,"Save"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;",onclick:function(){this.parent.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin: 5px;",onclick:function(){this.parent.parent.parent.close();}}]}]}]},showOps:function(){var G=this.titlebarNode,F=mstrmojo.dom.position(G,true);this.openPopup("optionsRef",{zIndex:30,left:Math.round(F.x+F.w-300)+"px",top:Math.round(F.y+F.h)+"px"});},init:function E(F){this._super(F);var G=this.data;if(G){delete this.data;this._set_data(null,G);}},del:function B(){var F=this.parent;if(F&&F.remove){F.remove(this.data);}},dup:function D(){var F=this.parent;if(F&&F.duplicate){var K=this.data,L=F.items,N=K.did,M=1,O=new RegExp(K.n+"_(\\d+)");for(var I=0,J=L.length;I<J;I++){var H=L[I],G=H.n&&H.n.match(O);if(G){M=Math.max(M,G[1]);}N=Math.max(N,parseInt(H.did,10));}F.duplicate(this.data,null,{n:mstrmojo.desc(3651,"Copy of ##").replace("##",K.n),did:F.getNextId(),state:1});}},onmouseover:function(F){this.set("showadd",this.state?true:false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Pulldown");function A(B){B.tbl.lbl.set("text",B.caption);B.tbl.list.set("itemIdField",B.itemIdField);B.tbl.list.set("itemField",B.itemField);}mstrmojo.WH.DBRoleSettingPulldown=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.WH.DBRoleSettingPulldown",cssText:"width: 100%;",postBuildRendering:function(){if(this._super){this._super();}A(this);},caption:"",contains:function(C){var B=mstrmojo.array.find(this.items,this.itemIdField,C);return(B>0);},itemIdField:"",itemField:"n",items:null,onitemsChange:function(B){this.tbl.list.set("items",this.items);},selectedID:"",onselectedIDChange:function(B){this.tbl.list.set("value",this.selectedID);},selectedItem:null,onChange:null,children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"tbl",cssText:"width:100%;",layout:[{cells:[{cssText:"width:19.5%;"},{cssText:"width:80.5%;"}]}],children:[{scriptClass:"mstrmojo.Label",alias:"lbl",text:"this.parent.caption",slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",cssText:"margin:5px 0px;",popupCssClass:"mstrmojo-qb-ScrollingPulldown",slot:"0,1",alias:"list",items:[{}],onvalueChange:function(B){this.parent.parent.set("selectedItem",this.selectedItem);if(this.parent.parent.onChange){this.parent.parent.onChange(B);}}}]}]});})();(function(){function G(N,O){var I,L,H,J=[],K,P;try{K=new RegExp(N,"i");}catch(M){return J;}for(I=0,L=O.length;I<L;I++){H=O[I].n;K.lastIndex=0;if(K.test(H)){J.push(O[I]);}}return J;}function E(H){if(this.searchEnabled){this.iconNode.style.display="none";this.inputBar.style.display="";if(H){this.inputNode.focus();this.inputNode.select();}}else{this.hideInputNode();if(H){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var I=this;window.setTimeout(function(){try{I.iconNode.focus();}catch(J){}},100);}else{this.iconNode.focus();}}}}var A={8:"BackSpace",9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchableDropDownList=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearableDropDownList",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" mstrAttach:keyup,blur/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupSlots,{inputBar:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.firstChild.lastChild.rows[0].cells[0].firstChild;}}),markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.iconNode.innerHTML=this.text;this.inputNode.value=this.text;},onheightChange:function(){var H=parseInt(this.height,10);if(H>=0){this.domNode.style.height=H+"px";this.inputBar.style.height=H+"px";}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),popupToBody:true,searchEnabled:false,selectedIndex:-1,prevalueChange:mstrmojo.emptyFn,allItems:null,focus:function(){E.call(this,true);},hideInputNode:function B(){this.inputBar.style.display="none";this.iconNode.style.display="block";},postBuildRendering:function D(){if(!this.allItems){this.allItems=this.items;}this._super();E.call(this);},onkeyup:function F(P){var I=this.getSearchPattern(),N=[],K,O=this.inputNode,M=P.e,H,J,L=this.items.length;if(A[M.keyCode]==="Enter"){if(this.items.length>0){this.set("selectedIndex",this.selectedIndex===-1?0:this.selectedIndex);}this.onEnter&&this.onEnter();this.closePopup();return ;}else{if(A[M.keyCode]==="Esc"){this.onEsc&&this.onEsc();if(this.popupRef.visible){this.popupRef.close();}return ;}else{if(A[M.keyCode]==="ArrowDown"){if(!this.popupRef.visible){this.togglePopup();}this.set("selectedIndex",(this.selectedIndex+1)%L);}else{if(A[M.keyCode]==="ArrowUp"){if(this.popupRef.visible&&L>0){this.set("selectedIndex",(this.selectedIndex+L-1)%L);}}else{if(this.searchEnabled){if(I&&I.length>0&&I.indexOf(this.lastSearchPattern)>-1){N=G(I,this.items);}else{N=G(I,this.allItems);}this.set("selectedIndex",-1);this.set("items",N);L=N.length;if(L===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}if(I&&I.length>0){this.set("selectedIndex",mstrmojo.array.find(N,this.itemIdField,O.value));}}}}}}this.lastSearchPattern=I;},getSearchPattern:function C(){return mstrmojo.string.trim(this.inputNode.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),new mstrmojo.FishEye({items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E=="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E=="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof (G)=="object")&&(typeof (G.length)=="number"));};if(B(F)&&B(E)){for(var C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);})();(function(){mstrmojo.requiresCls("mstrmojo.VBox","mstrmojo.Label","mstrmojo.Box","mstrmojo.WH.DBRoleSetting","mstrmojo.WH.DBRoleSettingPulldown","mstrmojo.WH.DBRoleSettingCheckbox");function N(U){if(!U){return"";}return U.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}function F(V,U){var W=V.scrollbox.tbl.contents;switch(U){case V.SDbT.SDbTUndefined:W=V.scrollboxDSN.tbl.contents2;if(!W.dsnlist.selectedItem){return V.DbTs.DbTReserved;}switch(W.dsnlist.selectedItem.des){case"MicroStrategy ODBC Driver for SQL Server Wire Protocol":case"SQL Server":return V.DbTs.DbTSQLServer;case"MicroStrategy ODBC Driver for DB2 Wire Protocol":case"DB2 Wire":case"DB2 iSeries":case"DB2 z/OS":return V.DbTs.DbTDB2;case"MicroStrategy ODBC Driver for Greenplum Wire Protocol":return V.DbTs.DbTPostgreSQL;case"MicroStrategy ODBC Driver for Informix Wire Protocol":case"Informix Wire":case"Informix XPS":case"MicroStrategy ODBC Driver for Informix XPS":return V.DbTs.DbTInformix;case"MicroStrategy ODBC Driver for MySQL Wire Protocol":case"MySQL":case"MySQL ODBC 5.1 Driver":case"MySQL ODBC 3.51 Driver":case"MySQL ODBC 5.2 Unicode Driver":return V.DbTs.DbTMySQL;case"MicroStrategy ODBC Driver for Oracle Wire Protocol":case"Oracle":case"Microsoft ODBC for Oracle":case"iAnywhere Solutions 11 - Oracle":return V.DbTs.DbTOracle;case"MicroStrategy ODBC Driver for PostgreSQL Wire Protocol":case"Postgre SQL":return V.DbTs.DbTPostgreSQL;case"MicroStrategy ODBC Driver for Sybase ASE Wire Protocol":case"Sybase ASE":case"Sybase IQ":case"Sybase IQ 12.7 ODBC":case"Sybase IQ 15.x ODBC":case"Adaptive Server IQ":case"Sybase IQ 12.7 ODBC Driver":case"Sybase IQ 15.x ODBC Driver":return V.DbTs.DbTSybase;case"SQL Anywhere 11":case"Adaptive Server Anywhere 9.0":return V.DbTs.DbTSybaseSQLAny;case"nCluster ANSI":case"nCluster":case"Aster Data ODBC driver for nCluster":case"Aster Database ODBC Driver":case"Aster ODBC Driver":return V.DbTs.DbTAster;case"HPODBC":case"HP ODBC 2.0":return V.DbTs.DbTNeoview;case"NetezzaSQL":return V.DbTs.DbTNetezza;case"EnterpriseDB 9.0 (ANSI)":return V.DbTs.DbTEnterpriseDB;case"Ingres II":case"Ingres":return V.DbTs.DbTVectorWise;case"Red Brick 6.3 Driver":case"Red Brick (32) Driver":case"Red Brick (64) Driver":return V.DbTs.DbTRedBrick;case"Vertica":return V.DbTs.DbTVertica;case"TERADATA_SERVER":case"Teradata":case"Teradata Driver":return V.DbTs.DbTTeradata;case"MicroStrategy ODBC Driver for Text":case"Microsoft Text Driver (*.txt; *.csv)":return V.DbTs.DbTGeneric;case"Vertica driver":case"Vertica ODBC Driver 3.5":case"Vertica ODBC Driver 4.0":return V.DbTs.DbTVertica;case"Microsoft Access Driver (*.mdb, *.accdb)":case"Driver do Microsoft Access (*.mdb)":case"Microsoft Access-Treiber (*.mdb)":return V.DbTs.DbTAccess;case"Microsoft Excel Driver (*.xls)":case"Microsoft Excel-Treiber (*.xls)":case"Driver do Microsoft Excel(*.xls)":return V.DbTs.DbTExcel;case"OpenAccess for Salesforce":case"MicroStrategy OpenAccess for Salesforce (Workstation)":return V.DbTs.DbTOpenAccess;case"Cloudera ODBC Driver for Apache Hive Protocol":case"Hive ODBC Driver":case"Hive Driver v1":case"ODBC Driver for bigsql":return V.DbTs.DbTHive;case"PAODBC":return V.DbTs.DbTParAccel;case"MicroStrategy ODBC Driver for Salesforce":return V.DbTs.DbTSalesForce;case"Microsoft Access Driver":return V.DbTs.DbTAccess;case"Microstrategy ODBC Driver for Impala Wire Protocol":return V.DbTs.DbTImpala;case"Composite 6.2":return V.DbTs.DbTComposite;case"Simba BigQuery ODBC Driver":return V.DbTs.DbTBigQuery;case"Nucleus ODBC Driver":return V.DbTs.DbTSand;case"Connection Cloud Driver":return V.DbTs.DbTCloud;case"PostgreSQL Unicode":return V.DbTs.DbTDenodo;case"Kognitio WX2":return V.DbTs.DbTKognitio;case" MicroStrategy ODBC Driver for PostgreSQL Wire Protocol ":return V.DbTs.DbTAmazonRedShift;case"Cirro":return V.DbTs.DbTCirro;case"MapR Drill ODBC Driver":return V.DbTs.DbTMapRDrill;default:return V.DbTs.DbTGeneric;}case V.SDbT.SDbTDB2Wire:case V.SDbT.SDbTDB2iSeries:case V.SDbT.SDbTDB2ZOS:return V.DbTs.DbTDB2;case V.SDbT.SDbTInformixWire:case V.SDbT.SDbTInformixXPS:return V.DbTs.DbTInformix;case V.SDbT.SDbTPostgreSQL:return V.DbTs.DbTPostgreSQL;case V.SDbT.SDbTSybaseASE:case V.SDbT.SDbTSybaseIQ:return V.DbTs.DbTSybase;case V.SDbT.SDbTOracle:return V.DbTs.DbTOracle;case V.SDbT.SDbTSQLServer:return V.DbTs.DbTSQLServer;case V.SDbT.SDbTTeradata:return V.DbTs.DbTTeradata;case V.SDbT.SDbTMySQL:return V.DbTs.DbTMySQL;case V.SDbT.SDBTMySQLCommunityEdition:return V.DbTs.DbTMySQL;case V.SDbT.SDbTGreenPlum:return V.DbTs.DbTPostgreSQL;case V.SDbT.SDbTNetezza:return V.DbTs.DbTNetezza;case V.SDbT.SDbTWebServices:return V.DbTs.DbTXQuery;case V.SDbT.SDbTHive:return V.DbTs.DbTHive;case V.SDbT.SDbTSalesforce:return V.DbTs.DbTSalesForce;case V.SDbT.SDbTParAccel:return V.DbTs.DbTParAccel;case V.SDbT.SDbTAccess:return V.DbTs.DbTAccess;case V.SDbT.SDbTDenodo:return V.DbTs.DbTDenodo;case V.SDbT.SDbTConnectionCloud:return V.DbTs.DbTCloud;case V.SDbT.SDbTAmazonRedShift:return V.DbTs.DbTAmazonRedShift;case V.SDbT.SDbTSAPHana:return V.DbTs.DbTHana;case V.SDbT.SDbTComposite:return V.DbTs.DbTComposite;case V.SDbT.SDbTBigQuery:return V.DbTs.DbTBigQuery;case V.SDbT.SDbTSand:return V.DbTs.DbTSand;case V.SDbT.SDbTKognitio:return V.DbTs.DbTKognitio;case V.SDbT.SDbTImpala:return V.DbTs.DbTImpala;case V.SDbT.SDbTCirro:return V.DbTs.DbTCirro;case V.SDbT.SDbTMapRDrill:return V.DbTs.DbTMapRDrill;default:return U;}}function S(V,U){if(U==""){return"";}else{return V+U+";";}}function Q(W,h){var l=h.scrollbox.tbl.contents;var X;switch(h.type){case h.SDbT.SDbTUndefined:l=h.scrollboxDSN.tbl.contents2;if(l.dsnlist.selectedItem){return S("DSN=",l.dsnlist.selectedItem.n);}else{return"";}break;case h.SDbT.SDbTSalesForce:X="DRIVER={MicroStrategy ODBC Driver for Salesforce};";if(l.children[0].children[0].children[1].value!=""){X=X+"HOST={"+l.children[0].children[0].children[1].value+"};";}X=X+"CO(AuditColumns=AuditOnly;MapSystemColumnNames=0;CustomSuffix=Include);SCL=0;TM=1;";return X;break;case h.SDbT.SDbTDB2Wire:X="DRIVER={MicroStrategy ODBC Driver for DB2 Wire Protocol};";X=X+S("IpAddress=",l.children[0].text);X=X+S("TcpPort=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTParAccel:X="DRIVER={PAODBC};";X=X+S("DB=",l.children[2].text);X=X+S("Host=",l.children[0].text);X=X+S("Port=",l.children[1].text);return X;case h.SDbT.SDbTDB2iSeries:X="DRIVER={MicroStrategy ODBC Driver for DB2 Wire Protocol};";X=X+S("IpAddress=",l.children[0].text);X=X+S("Collection=",l.children[1].text);X=X+S("Location=",l.children[2].text);X=X+S("DefaultIsolationLevel=",l.children[3].selectedItem.v);X=X+S("PackageOwner=",l.children[4].text);X=X+S("TcpPort=",l.children[5].text);return X;case h.SDbT.SDbTDB2ZOS:X="DRIVER={MicroStrategy ODBC Driver for DB2 Wire Protocol};";X=X+S("IpAddress=",l.children[0].text);X=X+S("Collection=",l.children[1].text);X=X+S("Location=",l.children[2].text);X=X+S("PackageCollection=",l.children[3].text);X=X+S("PackageOwner=",l.children[4].text);X=X+S("TcpPort=",l.children[5].text);return X;case h.SDbT.SDbTInformixWire:X="DRIVER={MicroStrategy ODBC Driver for Informix Wire Protocol};";X=X+S("ServerName=",l.children[0].text);X=X+S("HostName=",l.children[1].text);X=X+S("PortNumber=",l.children[2].text);X=X+S("Database=",l.children[3].text);return X;case h.SDbT.SDbTInformixXPS:X="DRIVER={MicroStrategy ODBC Driver for Informix XPS};";X=X+S("Database=",l.children[0].text);X=X+S("ServerName=",l.children[1].text);X=X+S("HostName=",l.children[2].text);X=X+S("Service=",l.children[3].text);X=X+S("Protocol=",l.children[4].selectedItem.v);return X;case h.SDbT.SDbTPostgreSQL:X="DRIVER={MicroStrategy ODBC Driver for PostgreSQL Wire Protocol};";X=X+S("HostName=",l.children[0].text);X=X+S("PortNumber=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTSybaseASE:var Z=new String(l.children[0].text);X="DRIVER={MicroStrategy ODBC Driver for Sybase ASE Wire Protocol};";X=X+S("NetworkAddress=",Z);X=X+S("PortNumber=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTAster:var b=h.dbmslist.selectedItem;switch(b.db_ver){case h.DbVs.DbVAsternCluster30:case h.DbVs.DbVAsternCluster40:case h.DbVs.DbVAsternCluster45:X="DRIVER={nCluster};";break;case h.DbVs.DbVAsternCluster46:case h.DbVs.DbVAsternCluster50:X="DRIVER={Aster Data ODBC driver for nCluster};";break;case h.DbVs.DbVAsternCluster51:X="DRIVER={Aster ODBC Driver};";break;}X=X+S("Server=",l.children[0].text);X=X+S("Port=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTRedBrick:X="DRIVER={Red Brick (32) Driver};";X=X+S("Server=",l.children[0].text);X=X+S("Database=",l.children[1].text);return X;case h.SDbT.SDbTVectorWise:var b=h.dbmslist.selectedItem;switch(b.db_ver){case h.DbVs.DbVIngres10s:X="DRIVER={Ingres II};";X=X+S("Server=",l.children[0].text);X=X+S("Database=",l.children[1].text);X=X+"ServerType=INGRES;";break;default:X="DRIVER={Ingres};";X=X+S("Server=",l.children[0].text);X=X+S("Database=",l.children[1].text);X=X+"ServerType=INGRES;";break;}return X;case h.SDbT.SDbTEnterpriseDB:X="DRIVER={EnterpriseDB 9.0 (ANSI)};";X=X+S("Servername=",l.children[0].text);X=X+S("Port=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTVertica:X="DRIVER={Vertica};";X=X+S("Servername=",l.children[0].text);X=X+S("Port=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTSybaseIQ:var b=h.dbmslist.selectedItem;switch(b.db_ver){case h.DbVs.DbVSybaseIQ127:X="DRIVER={Adaptive Server IQ};";X=X+S("EngineName=",l.children[0].text);X=X+S("DatabaseName=",l.children[3].text);var Y=S("host=",l.children[1].text);Y=Y+S("port=",l.children[2].text);X=X+"CommLinks=tcpip("+Y+");";break;case h.DbVs.DbVSybaseIQ153:X="DRIVER={Sybase IQ};";X=X+S("ServerName=",l.children[0].text);X=X+S("DatabaseName=",l.children[3].text);var Y=S("host=",l.children[1].text);Y=Y+S("port=",l.children[2].text);X=X+"CommLinks=SharedMemory,tcpip("+Y+");";break;case h.DbVs.DbVSybaseIQ154:X="DRIVER={Sybase IQ};";X=X+"DriverUnicodeType=1;";X=X+S("EngineName=",l.children[0].text);X=X+S("DatabaseName=",l.children[3].text);var Y=S("host=",l.children[1].text);Y=Y+S("port=",l.children[2].text);X=X+"CommLinks=tcpip("+Y+");";break;default:X="DRIVER={Sybase IQ};";X=X+"DriverUnicodeType=1;";X=X+S("EngineName=",l.children[0].text);X=X+S("DatabaseName=",l.children[3].text);var Y=S("host=",l.children[1].text);Y=Y+S("port=",l.children[2].text);X=X+"CommLinks=tcpip("+Y+");";break;}return X;case h.SDbT.SDbTOracle:X="DRIVER={MicroStrategy ODBC Driver for Oracle Wire Protocol};";var V="",g;if(!l.RB0||l.RB0.checked){g=l.RB0?1:0;p=l.children[g].text;if(mstrmojo.array.indexOf(p,",")===-1){X=X+S("HostName=",l.children[g].text);X=X+S("PortNumber=",l.children[g+1].text);}else{a=p.split(",");p=a[0];k=a[1];X=X+S("HostName=",p);X=X+S("PortNumber=",k);}X=X+S("SID=",l.children[g+2].text);V=l.children[g+3].text;X=X+S("ServiceName=",V);X=X+S("AlternateServers=",l.children[g+4].text);}else{if(l.RB1.checked){X=X+S("ServerName=",l.children[7].text);X=X+S("TNSNamesFile=",l.children[8].text);}}X=X+"EnableNCharSupport=1;";X=X+"IANAAppCodePage=111;";return X;case h.SDbT.SDbTSQLServer:var p,k,a=new Array();b=h.dbmslist.selectedItem;if(mstrmojo.array.indexOf(W.drivers,"MicroStrategy ODBC Driver for SQL Server Wire Protocol")>=0){X="DRIVER={MicroStrategy ODBC Driver for SQL Server Wire Protocol};";}else{if(b.db_ver===h.DbVs.DbVSQLServerAzure){X="DRIVER={MicroStrategy ODBC Driver for SQL Server Wire Protocol};";p=l.children[0].text;if(mstrmojo.array.indexOf(p,",")===-1){X=X+S("hostname=",l.children[0].text);}else{a=p.split(",");p=a[0];k=a[1];X=X+S("hostname=",p);X=X+S("Port=",k);}X=X+S("Database=",l.children[1].text);X=X+"FailoverMode=1;EncryptionMethod=1;ValidateServerCertificate=0";return X;}X="DRIVER={SQL Server};";}p=l.children[0].text;if(mstrmojo.array.indexOf(p,",")===-1){X=X+S("Server=",l.children[0].text);}else{a=p.split(",");p=a[0];k=a[1];X=X+S("Server=",p);X=X+S("Port=",k);}X=X+S("Database=",l.children[1].text);if(l.children[2]){X=X+S("UseWindowsAuthenticationForLogin=",l.children[2].checked);}else{X=X+"UseWindowsAuthenticationForLogin=False";}if(mstrmojo.array.indexOf(W.drivers,"MicroStrategy ODBC Driver for SQL Server Wire Protocol")>=0){X=X+"EncryptionMethod=1;ValidateServerCertificate=0";}return X;case h.SDbT.SDbTTeradata:X="DRIVER={Teradata};";X=X+S("DBCName=",l.children[0].text);X=X+S("Database=",l.children[1].text);X=X+S("UseIntegratedSecurity=",l.children[2].checked);var o=l.children[3].selectedItem.v;if(o=="&nbsp;"){o="";}X=X+S("Authentication Mechanism=",o);X=X+S("Authentication Mechanism Data=",l.children[4].text);return X;case h.SDbT.SDbTMySQL:X="DRIVER={MicroStrategy ODBC Driver for MySQL Wire Protocol};";X=X+S("HostName=",l.children[0].text);X=X+S("PortNumber=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTMySQLCommunityEdition:X="DRIVER={MySQL ODBC 5.2 Unicode Driver};";X=X+S("Server=",l.children[0].text);X=X+S("Port=",l.children[1].text);X=X+S("Database=",l.children[2].text);X=X+"DriverUnicodeType=1";return X;case h.SDbT.SDbTInfoBright:X="DRIVER={ MicroStrategy ODBC Driver for MySQL Wire Protocol };";X=X+S("HostName=",l.children[0].text);X=X+S("PortNumber=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTGreenPlum:X="DRIVER={MicroStrategy ODBC Driver for Greenplum Wire Protocol};";var U=l.children[0].text,n=l.children[1].text,f=[",",":"],g;mstrmojo.array.forEach(f,function(c){g=U.indexOf(c);if(g>-1){n=U.substring(g+1);U=U.substring(0,g);return false;}});X=X+S("HostName=",U);X=X+S("PortNumber=",n||"5432");X=X+S("Database=",l.children[2].text);X=X+S("AlternateServers=",l.children[3].text);return X;case h.SDbT.SDbTImpala:X="DRIVER={Microstrategy ODBC Driver for Impala Wire Protocol};";X=X+S("HOST=",l.children[0].text);X=X+S("PORT=",l.children[1].text);return X;case h.SDbT.SDbTNetezza:X="DRIVER={NetezzaSQL};";X=X+S("servername=",l.children[0].text);X=X+S("port=",l.children[1].text);X=X+S("database=",l.children[2].text);return X;case h.SDbT.SDbTComposite:X="DRIVER={Composite 6.2};";X=X+S("Host=",l.children[0].text);X=X+S("Port=",l.children[1].text);X=X+S("Datasource=",l.children[2].text);X=X+"Domain=composite;CONNECTTIMEOUT=70;";return X;case h.SDbT.SDbTDenodo:X="DRIVER={PostgreSQL Unicode};";X=X+S("Server=",l.children[0].text);X=X+S("Port=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTBigQuery:X="DRIVER={Simba BigQuery ODBC Driver};";X=X+S("RefreshToken=",l.children[0].text);X=X+S("Catalog=",l.children[1].text);return X;case h.SDbT.SDbTSand:X="DRIVER={Nucleus ODBC Driver};";X=X+S("Database=",l.children[0].text);X=X+S("Connection=",l.children[1].text);return X;case h.SDbT.SDbTKognitio:X="DRIVER={Kognitio WX2};";X=X+S("Server=",l.children[0].text);return X;case h.SDbT.SDbTConnectionCloud:X="DRIVER={Connection Cloud Driver};";X=X+S("Server=",l.children[0].text);return X;case h.SDbT.SDbTAmazonRedShift:X="DRIVER={ MicroStrategy ODBC Driver for PostgreSQL Wire Protocol };";X=X+S("HostName=",l.children[0].text);X=X+S("Port=",l.children[1].text);X=X+S("Database=",l.children[2].text);return X;case h.SDbT.SDbTSAPHana:X="DRIVER={HDBODBC32};";X=X+S("SERVERNODE=",l.children[0].text);var b=h.dbmslist.selectedItem;if(b.db_ver===h.DbVs.DbVSAPHANA105){X=X+"DriverUnicodeType=1";}return X;case h.SDbT.SDbTWebServices:if(l.children[0].selectedItem.v==="XQuery"){X="XQUERY;";}else{X="XQUERY;Salesforce";}return X;case h.SDbT.SDbTAccess:var d=l.children[0].text;X="Driver={Microsoft Access Driver (*.mdb, *.accdb)};";X=X+S("DBQ=",d);return X;case h.SDbT.SDbTHive:var b=h.dbmslist.selectedItem;if(b.db_ver===h.DbVs.DbVHive09){X="DRIVER={Microstrategy ODBC Driver for Apache Hive Wire Protocol};";X=X+S("HOST=",l.children[0].text);X=X+S("PORT=",l.children[1].text);X=X+S("DATABASE=",l.children[2].text);return X;}if(b.db_ver===h.DbVs.DbVHiveThrift||b.db_ver===h.DbVs.DbVHiveThrift08||b.db_ver===h.DbVs.DbVHiveThrift09){X="DRIVER={Hive ODBC Driver};";X=X+S("SERVER=",l.children[0].text);X=X+S("PORT=",l.children[1].text);X=X+S("DATABASE=",l.children[2].text);return X;}else{if(b.db_ver===h.DbVs.DbVIBMInfoSphere){X="DRIVER={ODBC Driver for bigsql};";}else{if(mstrmojo.array.indexOf(W.drivers,"Hive Driver v1")>=0){X="DRIVER={Hive Driver v1};";}else{if(mstrmojo.array.indexOf(W.drivers,"Microstrategy ODBC Driver for Apache Hive Wire Protocol")>=0){X="DRIVER={Microstrategy ODBC Driver for Apache Hive Wire Protocol};";}else{if(mstrmojo.array.indexOf(W.drivers,"Hive Driver")>=0){X="DRIVER={Hive Driver};";}else{X="DRIVER={Hive ODBC Driver};";}}}}X=X+S("HOST=",l.children[0].text);X=X+S("PORT=",l.children[1].text);X=X+S("DATABASE=",l.children[2].text);return X;}case h.SDbT.SDbTCirro:X="DRIVER={Cirro};";X=X+S("SERVER=",l.children[0].text);X=X+S("PORT=",l.children[1].text);X=X+S("DATABASE=",l.children[2].text);X=X+"EXTRA_PARMS={schemanamepattern=true}";return X;case h.SDbT.SDbTMapRDrill:X="DRIVER={MapR Drill ODBC Driver};";X=X+S("HOST=",l.children[0].text);X=X+S("PORT=",l.children[1].text);X=X+S("SCHEMA=",l.children[2].text);X=X+"ConnectionType=Direct";return X;}}function B(Y,V){if(Y.info.connstr){var k=Y.scrollbox.tbl.contents;var X=Y.info.connstr;X=X.split(";")[0];var W=(X.split("=")[0]).toUpperCase();switch(W){case"DSN":k=Y.scrollboxDSN.tbl.contents2;X=X.substring(W.length+1,X.length);k.dsnlist.set("selectedID",X);break;case"XQUERY":X=Y.info.connstr;var h=X.split(";");if(h&&h[1]==="Salesforce"){k.children[0].set("selectedID",k.children[0].items[1].v);}break;default:X=Y.info.connstr;X=X.replace("CommLinks=tcpip(","");X=X.replace(")","");var h=X.split(";");var U=mstrmojo.array.indexOf;var f=U(h,"");while(f>-1){h.splice(f,1);f=U(h,"");}var o=(h[0].split("=")[1]);o=o.replace("{","");o=o.replace("}","");switch(o){case"MicroStrategy ODBC Driver for Salesforce":var n=h[1].split("=");k.children[0].set("text",n[1]);break;break;case"MicroStrategy ODBC Driver for DB2 Wire Protocol":switch(V){case Y.SDbT.SDbTDB2Wire:for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"IpAddress":k.children[0].set("text",n[1]);break;case"TcpPort":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case Y.SDbT.SDbTDB2iSeries:for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"IpAddress":k.children[0].set("text",n[1]);break;case"Collection":k.children[1].set("text",n[1]);break;case"Location":k.children[2].set("text",n[1]);break;case"DefaultIsolationLevel":k.children[3].set("selectedID",n[1]);break;case"PackageOwner":k.children[4].set("text",n[1]);break;case"TcpPort":k.children[5].set("text",n[1]);break;}}break;case Y.SDbT.SDbTDB2ZOS:for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"IpAddress":k.children[0].set("text",n[1]);break;case"Collection":k.children[1].set("text",n[1]);break;case"Location":k.children[2].set("text",n[1]);break;case"PackageCollection":k.children[3].set("text",n[1]);break;case"PackageOwner":k.children[4].set("text",n[1]);break;case"TcpPort":k.children[5].set("text",n[1]);break;}}break;}break;case"MicroStrategy ODBC Driver for Informix Wire Protocol":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"ServerName":k.children[0].set("text",n[1]);break;case"HostName":k.children[1].set("text",n[1]);break;case"PortNumber":k.children[2].set("text",n[1]);break;case"Database":k.children[3].set("text",n[1]);break;}}break;case"MicroStrategy ODBC Driver for Informix XPS":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Database":k.children[0].set("text",n[1]);break;case"ServerName":k.children[1].set("text",n[1]);break;case"HostName":k.children[2].set("text",n[1]);break;case"Service":k.children[3].set("text",n[1]);break;case"Protocol":k.children[4].set("selectedID",n[1]);break;}}break;case"EnterpriseDB 9.0 (ANSI":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Servername":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"Vertica":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Servername":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"Ingres II":case"Ingres":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;case"Database":k.children[1].set("text",n[1]);break;}}break;case"Red Brick 6.3 Driver":case"Red Brick (32 Driver":case"Red Brick (64 Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;case"Database":k.children[1].set("text",n[1]);break;}}break;case"nCluster ANSI":case"nCluster":case"Aster Data ODBC driver for nCluster":case"Aster Database ODBC Driver":case"Aster ODBC Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"MicroStrategy ODBC Driver for PostgreSQL Wire Protocol":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HostName":k.children[0].set("text",n[1]);break;case"PortNumber":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"MicroStrategy ODBC Driver for Sybase ASE Wire Protocol":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"NetworkAddress":k.children[0].set("text",n[1]);break;case"PortNumber":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"Adaptive Server IQ":case"Sybase IQ":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"ServerName":k.children[0].set("text",n[1]);break;case"EngineName":k.children[0].set("text",n[1]);break;case"host":k.children[1].set("text",n[1]);break;case"port":k.children[2].set("text",n[1]);break;case"DatabaseName":k.children[3].set("text",n[1]);break;}}break;case"PAODBC":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Host":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"DB":k.children[2].set("text",n[1]);break;}}break;case"MicroStrategy ODBC Driver for Oracle Wire Protocol":var g=false,d=false,f=mstrApp.isCloud?0:1;for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HostName":k.children[f].set("text",n[1]);g=true;break;case"PortNumber":k.children[f+1].set("text",n[1]);g=true;break;case"SID":k.children[f+2].set("text",n[1]);g=true;break;case"ServiceName":k.children[f+3].set("text",n[1]);g=true;break;case"AlternateServers":k.children[f+4].set("text",n[1]);g=true;break;case"ServerName":k.children[f+6].set("text",n[1]);d=true;break;case"TNSNamesFile":k.children[f+7].set("text",n[1]);d=true;break;}}if(g&&f){k.RB0.set("checked",true);}if(d){k.RB1.set("checked",true);}break;case"MicroStrategy ODBC Driver for SQL Server Wire Protocol":case"SQL Server":var Z=Y.dbmslist;if(Z.selectedItem){if(Z.selectedItem.db_type==300){for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"hostname":k.children[0].set("text",n[1]);break;case"Server":k.children[0].set("text",n[1]);break;case"Port":k.children[0].set("text",k.children[0].text+","+n[1]);break;case"Database":k.children[1].set("text",n[1]);break;case"UseWindowsAuthenticationForLogin":if(n[1]=="true"){k.children[2].set("checked",true);}break;}}}break;}for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;case"Port":k.children[0].set("text",k.children[0].text+","+n[1]);break;case"Address":k.children[0].set("text",n[1]);break;case"Database":k.children[1].set("text",n[1]);break;case"UseWindowsAuthenticationForLogin":if(n[1]=="true"){k.children[2].set("checked",true);}break;}}break;case"Teradata":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"DBCName":k.children[0].set("text",n[1]);break;case"Database":k.children[1].set("text",n[1]);break;case"UseIntegratedSecurity":if(n[1]=="true"){k.children[2].set("checked",true);}break;case"Authentication Mechanism":k.children[3].set("selectedID",n[1]);break;case"Authentication Mechanism Data":k.children[4].set("text",n[1]);break;}}break;case"MySQL ODBC 5.1 Driver":case"MySQL ODBC 5.2 Unicode Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case" MicroStrategy ODBC Driver for MySQL Wire Protocol ":case"MicroStrategy ODBC Driver for MySQL Wire Protocol":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HostName":k.children[0].set("text",n[1]);break;case"PortNumber":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"MicroStrategy ODBC Driver for Greenplum Wire Protocol":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HostName":k.children[0].set("text",n[1]);break;case"PortNumber":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;case"AlternateServers":k.children[3].set("text",n[1]);break;}}break;case"NetezzaSQL":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"servername":k.children[0].set("text",n[1]);break;case"port":k.children[1].set("text",n[1]);break;case"database":k.children[2].set("text",n[1]);break;}}break;case"Microstrategy ODBC Driver for Apache Hive Wire Protocol":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HostName":k.children[0].set("text",n[1]);break;case"PortNumber":k.children[1].set("text",n[1]);break;case"HOST":k.children[0].set("text",n[1]);break;case"PORT":k.children[1].set("text",n[1]);break;case"DATABASE":k.children[2].set("text",n[1]);break;}}break;case"Microsoft Access Driver (*.mdb, *.accdb":for(var b=1;b<h.length;b++){var n=h[b].split("=");var a=n[1];switch(n[0]){case"DBQ":k.children[0].set("text",a);break;}}break;case"Microstrategy ODBC Driver for Impala Wire Protocol":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HOST":k.children[0].set("text",n[1]);break;case"PORT":k.children[1].set("text",n[1]);break;}}break;case"ODBC Driver for bigsql":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HOST":k.children[0].set("text",n[1]);break;case"PORT":k.children[1].set("text",n[1]);break;case"DATABASE":k.children[2].set("text",n[1]);break;}}break;case"Composite 6.2":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Host":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"Datasource":k.children[2].set("text",n[1]);break;}}break;case" MicroStrategy ODBC Driver for PostgreSQL Wire Protocol ":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Host":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"Kognitio WX2":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;}}break;case"PostgreSQL Unicode":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;case"Port":k.children[1].set("text",n[1]);break;case"Database":k.children[2].set("text",n[1]);break;}}break;case"Connection Cloud Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Server":k.children[0].set("text",n[1]);break;}}break;case"HDBODBC32":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"SERVERNODE":k.children[0].set("text",n[1]);break;}}break;case"Simba BigQuery ODBC Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"RefreshToken":k.children[0].set("text",n[1]);break;case"Catalog":k.children[1].set("text",n[1]);break;}}break;case"Nucleus ODBC Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"Database":k.children[0].set("text",n[1]);break;case"Connection":k.children[1].set("text",n[1]);break;}}break;case"Hive Driver v1":case"Hive ODBC Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"SERVER":k.children[0].set("text",n[1]);break;case"HOST":k.children[0].set("text",n[1]);break;case"PORT":k.children[1].set("text",n[1]);break;case"DATABASE":k.children[2].set("text",n[1]);break;}}break;case"Cirro":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"SERVER":k.children[0].set("text",n[1]);break;case"PORT":k.children[1].set("text",n[1]);break;case"DATABASE":k.children[2].set("text",n[1]);break;}}break;case"MapR Drill ODBC Driver":for(var b=1;b<h.length;b++){var n=h[b].split("=");switch(n[0]){case"HOST":k.children[0].set("text",n[1]);break;case"PORT":k.children[1].set("text",n[1]);break;case"SCHEMA":k.children[2].set("text",n[1]);break;}}break;}break;}}}function D(U){if(U.info.connstr){var V=U.info.connstr;V=V.split(";")[0];var W=(V.split("=")[0]).toUpperCase();V=V.substring(W.length+1,V.length);switch(W){case"DSN":return U.SDbT.SDbTUndefined;case"XQUERY":return U.SDbT.SDbTWebServices;case"DRIVER":V=V.replace("{","");V=V.replace("}","");switch(V){case"MicroStrategy ODBC Driver for DB2 Wire Protocol":switch(U.info.dbms){case"68CD44318CF911D5804400C04F780688":case"68CD44358CF911D5804400C04F780688":case"6BBD10E2D0794AF7B7ED1E2AA06F6460":case"6BBD10E3D0794AF7B7ED1E2AA06F6460":case"080A7832229F4E92B01316C2250115FE":return U.SDbT.SDbTDB2iSeries;case"1D076B3E099F11D4800100C04F780688":case"68CD443B8CF911D5804400C04F780688":case"38F387A18191493D8CBF8861BCAF7D41":return U.SDbT.SDbTDB2ZOS;default:return U.SDbT.SDbTDB2Wire;}case"nCluster ANSI":case"nCluster":case"Aster Data ODBC driver for nCluster":case"Aster Database ODBC Driver":case"Aster ODBC Driver":return U.SDbT.SDbTAster;case"Vertica":return U.SDbT.SDbTVertica;case"EnterpriseDB 9.0 (ANSI)":return U.SDbT.SDbTEnterpriseDB;case"Ingres II":case"Ingres":return U.SDbT.SDbTVectorWise;case"Red Brick (32) Driver":return U.SDbT.SDbTRedBrick;case"PAODBC":return U.SDbT.SDbTParAccel;case"MicroStrategy ODBC Driver for Salesforce":return U.SDbT.SDbTSalesForce;case"MicroStrategy ODBC Driver for Informix Wire Protocol":return U.SDbT.SDbTInformixWire;case"MicroStrategy ODBC Driver for Informix XPS":return U.SDbT.SDbTInformixXPS;case"MicroStrategy ODBC Driver for PostgreSQL Wire Protocol":return U.SDbT.SDbTPostgreSQL;case"MicroStrategy ODBC Driver for Sybase ASE Wire Protocol":return U.SDbT.SDbTSybaseASE;case"MicroStrategy ODBC Driver for Oracle Wire Protocol":return U.SDbT.SDbTOracle;case"SQL Server":case"MicroStrategy ODBC Driver for SQL Server Wire Protocol":return U.SDbT.SDbTSQLServer;case"MicroStrategy ODBC Driver for MySQL Wire Protocol":return U.SDbT.SDbTMySQL;case"MySQL ODBC 5.1 Driver":case"MySQL ODBC 5.2 Unicode Driver":return U.SDbT.SDbTMySQLCommunityEdition;case" MicroStrategy ODBC Driver for MySQL Wire Protocol ":return U.SDbT.SDbTInfoBright;case"Teradata":return U.SDbT.SDbTTeradata;case"Sybase IQ 12.7 ODBC":case"Sybase IQ 15.x ODBC":case"Sybase IQ":case"Adaptive Server IQ":return U.SDbT.SDbTSybaseIQ;case"MicroStrategy ODBC Driver for Greenplum Wire Protocol":return U.SDbT.SDbTGreenPlum;case"NetezzaSQL":return U.SDbT.SDbTNetezza;case"Hive Driver v1":case"Hive ODBC Driver":case"Microstrategy ODBC Driver for Apache Hive Wire Protocol":case"ODBC Driver for bigsql":return U.SDbT.SDbTHive;case"Microsoft Access Driver (*.mdb, *.accdb)":return U.SDbT.SDbTAccess;case"Microsoft Access Driver":return U.SDbT.SDbTAccess;case"Microstrategy ODBC Driver for Impala Wire Protocol":return U.SDbT.SDbTImpala;case"Composite 6.2":return U.SDbT.SDbTComposite;case"Simba BigQuery ODBC Driver":return U.SDbT.SDbTBigQuery;case"Nucleus ODBC Driver":return U.SDbT.SDbTSand;case"Kognitio WX2":return U.SDbT.SDbTKognitio;case"PostgreSQL Unicode":return U.SDbT.SDbTDenodo;case"Connection Cloud Driver":return U.SDbT.SDbTConnectionCloud;case" MicroStrategy ODBC Driver for PostgreSQL Wire Protocol ":return U.SDbT.SDbTAmazonRedShift;case"HDBODBC32":return U.SDbT.SDbTSAPHana;case"Cirro":return U.SDbT.SDbTCirro;case"MapR Drill ODBC Driver":return U.SDbT.SDbTMapRDrill;default:return U.SDbT.SDbTUndefined;}default:return U.SDbT.SDbTUndefined;}}else{return U.SDbT.SDbTUndefined;}}function R(U,b,Y,X,a){var W;switch(U){case"text":W=new mstrmojo.WH.DBRoleSetting({caption:b,alias:"dbp"+Y});if(X){W.tbl.children[1].value=X;}break;case"number":W=new mstrmojo.WH.DBRoleSetting({caption:b,isNumeric:true,alias:"dbp"+Y});break;case"list":var Z="v";if(a[0].n){Z="n";for(var V=0;V<a.length;V++){a[V].n=mstrmojo.desc(a[V].mojoIDS,a[V].n);}}W=new mstrmojo.WH.DBRoleSettingPulldown({caption:b,alias:"dbp"+Y,itemIdField:"v",itemField:Z,alias:"dbp"+Y});W.render();W.set("items",a);W.set("selectedID",a[0].v);break;case"boolean":W=new mstrmojo.WH.DBRoleSettingCheckbox({caption:b});break;}return W;}function K(X,a){if(X.DBP){var U=X.DBP;if(U.length){for(var W=0;W<U.length;W++){var Z=U[W];var Y=mstrmojo.desc(Z.mojoIDS,Z.n);var V=R(Z.t,Y,W,Z.defaultValue,Z.PV);a.addChildren([V]);}}else{var Z=U;var Y=mstrmojo.desc(Z.mojoIDS,Z.n);var V=R(Z.t,Y,0,Z.defaultValue,Z.PV);a.addChildren([V]);}}}function T(U,X){var V;for(var W=0;W<U.length;W++){V=U[W];if(V.id==X){return V;}}}function C(X,W){var V=X.selectlist,U=X.dbmslist,f=X.scrollbox,Z=X.scrollboxDSN,Y=X.dbmslistDSN;if(W){V.visible=false;U.visible=false;f.visible=false;Z.visible=true;Y.visible=true;}else{V.visible=true;U.visible=true;f.visible=true;Z.visible=false;Y.visible=false;}X.refresh();}function I(V,U){var W=U.scrollboxDSN;C(U,true);W.tbl.contents2.dsnlist.set("items",V.dsns);W.tbl.contents2.dsnlist.set("selectedID",V.dsns[0].n);}function L(V,Z,Y){var f=Z.scrollbox.tbl.contents;var X=Z.selectlist;if(!f){return ;}if((V.isCloud)&&(Y==0)){var g=T(X.items,1);}else{var g=T(X.items,Y);}if(!g){X.visible=false;I(V,Z);}else{C(Z,false);Z.type=g.id;X.set("selectedID",g.id);if(f.children){f.removeChildren(null,true);}if(g.DBPS){var W=g.DBPS;for(idbps=0;idbps<W.length;idbps++){var a=W[idbps];var b=mstrmojo.desc(a.mojoIDS,a.n);var U=new mstrmojo.RadioButton({label:b,alias:"RB"+idbps,index:idbps,count:W.length,cssText:"padding-top: 15px;font-weight:900;",cssDisplay:"block",onclick:function(){if(this.isChecked()){for(j=0;j<this.count;j++){this.parent["RB"+j].set("checked",false);}this.set("checked",true);}}});f.addChildren([U]);K(a,f);}}else{K(g,f);}}E(Z);}function A(U,V){V.selectlist.set("items",U.suppdbs);}function M(Z,U){var Y=Z.dbms;var X=U.dbmslistDSN;X.set("items",null);var a=new Array();for(var W=0,V=0;W<Y.length;W++){if(Y[W].did!="F10446E31B03410E912FB029F19B3799"){a[V]=Y[W];V++;}}X.set("items",a);if(a.length>0){X.set("selectedID",a[0].did);}else{X.set("selectedID",null);}}function E(U){return ;var V=U.dbmslist;if(V.selectedItem){if(V.selectedItem.db_type==300){var W=U.scrollbox.tbl.contents;}}}function P(U,h,k){var d=U.dbms;var W=h.dbmslist;var f=h.dbmslistDSN;var l=h.SDbT;if(k==l.SDbTUndefined){var g=new Array();for(var Y=0,X=0;Y<d.length;Y++){if(d[Y].did!="F10446E31B03410E912FB029F19B3799"&&d[Y].did!="F10446E31B03410E912FB029F19B3800"&&d[Y].did!="DA4662B5563C432D9C48CE5379B9D367"){g[X]=d[Y];X++;}}f.set("items",g);if(g.length>0){f.set("selectedID",g[0].did);}else{f.set("selectedID",null);}}else{var Z=new Array();var b=0;var a=h.DbVs;for(var Y=0;Y<d.length;Y++){var V=d[Y];switch(k){case l.SDbTSalesForce:switch(V.db_ver){case a.DbVSalesForce:Z[b++]=V;}break;case l.SDbTDB2iSeries:switch(V.db_ver){case a.DbVIBMDB2400V5R1:case a.DbVIBMDB2400V5R2:case a.DbVIBMDB2400V5R4:case a.DbVIBMDB2400V6R1:case 134:Z[b++]=V;}break;case l.SDbTDB2Wire:switch(V.db_ver){case a.DbVIBMUDB7:case a.DbVIBMUDB8:case a.DbVIBMUDB91:case a.DbVIBMUDB95:case a.DbVIBMUDB97:case a.DbVDBIBMUDB101:case a.DbVDBIBMUDB105:Z[b++]=V;}break;case l.SDbTDB2ZOS:switch(V.db_ver){case a.DbVIBMDB2OS3907:case a.DbVIBMDB2OS3908:case a.DbVIBMUDB91zOS:case a.DbVDBIBMUDBV10zOS:Z[b++]=V;}break;case l.SDbTPostgreSQL:switch(V.db_ver){case a.DbVPostgreSQL81:case a.DbVPostgreSQL82:case a.DbVPostgreSQL83:case a.DbVPostgreSQL84:case a.DbVPostgreSQL9x:Z[b++]=V;}break;case l.SDbTGreenPlum:switch(V.db_ver){case a.DbVGreenplum3x:case 141:Z[b++]=V;}break;case l.SDbTInfoBright:switch(V.db_ver){case a.DbVInfobright33:case a.DbVInfobright40:Z[b++]=V;}break;case l.SDbTMySQL:switch(V.db_ver){case a.DbVMySQL50:case a.DbVMySQL51:Z[b++]=V;}break;case l.SDbTMySQLCommunityEdition:switch(V.db_ver){case a.DbVMySQL50:case a.DbVMySQL51:case a.DbVMySQLCalpontInfiniDB:case a.DbVMariaDB:Z[b++]=V;}break;case l.SDbTSybaseASE:switch(V.db_ver){case a.DbVSybaseASE15:case a.DbVSybaseAdaptive115:case a.DbVSybaseAdaptive12:case a.DbVSybaseAdaptive125:Z[b++]=V;}break;case l.SDbTSybaseIQ:switch(V.db_ver){case a.DbVSybaseIQ112:case a.DbVSybaseIQ12:case a.DbVSybaseIQ15:case a.DbVSybaseIQ151:case a.DbVSybaseIQ152:case a.DbVSybaseIQ153:case a.DbVSybaseIQ154:case a.DbVSybaseIQ16:Z[b++]=V;}break;case l.SDbTInformixWire:switch(V.db_ver){case a.DbVInformix10:case a.DbVInformixIDS10:case a.DbVInformixIDS11:case a.DbVInformixIDS115:case a.DbVInformixIDS93:case a.DbVInformixIDS94:case a.DbVInformixODS724UC1:case a.DbVInformixODS731:case a.DbVInformixUDO92:case a.DbVInformixIDS121:Z[b++]=V;}break;case l.SDbTInformixXPS:switch(V.db_ver){case a.DbVInformixXPS82:case a.DbVInformixXPS83:Z[b++]=V;}break;case l.SDbTSQLServer:switch(V.db_ver){case a.DbVSQLServer2000:case a.DbVSQLServer2005:case a.DbVSQLServer2008:case a.DbVSQLServer65:case a.DbVSQLServer70:case a.DbVSQLServerAzure:case a.DbVSQL2012Parallel:Z[b++]=V;break;case a.DbVSQLServer2012:case a.DbVSQLServer2008NativeClient:case a.DbVSQLServer2008R2Par:if(!mstrApp.isCloud){Z[b++]=V;}}break;case l.SDbTWebServices:switch(V.db_ver){case a.DbVXQuery:Z[b++]=V;}break;case l.SDbTTeradata:switch(V.db_ver){case a.DbVTeradataV2R1:case a.DbVTeradataV2R20002:case a.DbVTeradataV2R21:case a.DbVTeradatav2R3:case a.DbVTeradataNTV2R2:case a.DbVTeradataNTV2R3:case a.DbVTeradataV2R4:case a.DbVTeradataV2R41:case a.DbVTeradataV2R5:case a.DbVTeradataV2R51:case a.DbVTeradataV2R6:case a.DbVTeradataV2R61:case a.DbVTeradataV2R62:case a.DbVTeradata12:case a.DbVTeradata120:case a.DbVTeradata13:case a.DbVTeradata131:case a.DbVTeradata141:case a.DbVTeradata140:Z[b++]=V;}break;case l.SDbTHive:switch(V.db_ver){case a.DbVHive05:case a.DbVHive06:case a.DbVHive07:case a.DbVHive08:case a.DbVHive09:case a.DbVHive010:case a.DbVHive011:if(!mstrApp.isCloud){Z[b++]=V;}break;case a.DbVHiveThrift08:case a.DbVHiveThrift:case a.DbVIBMInfoSphere:if(!(h.selectlist.selectedID===0)){Z[b++]=V;break;}}break;case l.SDbTParAccel:switch(V.db_ver){case a.DbVParAccel3:case a.DbVParAccel40:case a.DbVParAccel2x:case a.DbVParAccel31x:case a.DbVParAccel35:Z[b++]=V;break;}break;case l.SDbTImpala:switch(V.db_ver){case a.DbVHImpala:Z[b++]=V;break;}break;case l.SDbTRedBrick:switch(V.db_ver){case a.DbVRedBrick5007:case a.DbVRedBrick5012:case a.DbVRedBrick5105:case a.DbVRedBrick6:case a.DbVRedBrick62:case a.DbVRedBrick63:Z[b++]=V;break;}break;case l.SDbTVectorWise:switch(V.db_ver){case a.DbVDBVectorWise15:case a.DbVDBVectorWise20x:case a.DbVDBVectorWise30x:case a.DbVIngres10s:Z[b++]=V;break;}break;case l.SDbTVertica:switch(V.db_ver){case a.DbVVertica25:case a.DbVVertica30:case a.DbVVertica5051:case a.DbVVertica60:Z[b++]=V;break;}break;case l.SDbTEnterpriseDB:switch(V.db_ver){case a.DbVEnterpriseDB9x:Z[b++]=V;break;}break;case l.SDbTAster:switch(V.db_ver){case a.DbVAsternCluster30:case a.DbVAsternCluster40:case a.DbVAsternCluster45:case a.DbVAsternCluster46:case a.DbVAsternCluster50:case a.DbVAsternCluster51:Z[b++]=V;break;}break;case l.SDbTAccess:switch(V.db_ver){case a.DbVAccess20:case a.DbVAccess70:case a.DbVAccess2000:case a.DbVAccess2002:case a.DbVAccess2003:case a.DbVAccess2007:Z[b++]=V;break;}break;case l.SDbTDenodo:switch(V.db_ver){case a.DbVSQLDenodo50:Z[b++]=V;break;}break;case l.SDbTConnectionCloud:switch(V.db_ver){case a.DbVCloud:Z[b++]=V;break;}break;case l.SDbTBigQuery:switch(V.db_ver){case a.DbVBigQuery:Z[b++]=V;break;}break;case l.SDbTKognitio:switch(V.db_ver){case a.DbVKognitio7x:case a.DbVKognitio8x:Z[b++]=V;break;}break;case l.SDbTAmazonRedShift:switch(V.db_ver){case a.DbVAmazonRedShift:Z[b++]=V;break;}break;case l.SDbTSAPHana:switch(V.db_ver){case a.DbVSAPHana1:case a.DbVSAPHANA105:Z[b++]=V;break;}break;case l.SDbTComposite:switch(V.db_ver){case a.DbVComposite450:case a.DbVComposite510:case a.DbVComposite6x:Z[b++]=V;break;}break;case l.SDbTOracle:switch(V.db_ver){case a.DbVOracle733:case a.DbVOracle8003:case a.DbVOracle8i:case a.DbVOracle805:case a.DbVOracle8iR2:case a.DbVOracle8iR3:case a.DbVOracle8iR2SE:case a.DbVOracle9i:case a.DbVOracle8iR2SE:case a.DbVOracle10g:case a.DbVOracle10gR2:case a.DbVOracle11g:case a.DbVOracle11gR2:case a.DbVOracle12c:Z[b++]=V;break;}break;case l.SDbTSand:switch(V.db_ver){case a.DbVSandCDBMS7:Z[b++]=V;break;}case l.SDbTCirro:if(V.db_ver==a.DbVCirro){Z[b++]=V;}break;case l.SDbTMapRDrill:if(V.db_ver==a.DbVMapRDrill){Z[b++]=V;}break;default:if(V.db_type==h.supportedToType(k)){Z[b++]=V;}break;}}if(Z.length===1){V=Z[0];if(V.db_type===h.DbTs.DbTGeneric){var c=d.slice(0);c.splice(0,1);c.sort(function(p,o){var n=p.n.toString().toLowerCase(),q=o.n.toString().toLowerCase();if(n<q){return -1;}else{if(n>q){return 1;}else{return 0;}}});f.set("items",[V].concat(c));f.set("selectedID",V.did);return ;}}f.set("items",Z);W.set("items",Z);if(Z.length>0){if(!h.info){f.set("selectedID",Z[0].did);W.set("selectedID",Z[0].did);return ;}if(((h.info.dbms==="")||(h.info.db_type!=Z[0].db_type))&&h.info.db_type!=3400){f.set("selectedID",Z[0].did);W.set("selectedID",Z[0].did);}else{f.set("selectedID",h.info.dbms);W.set("selectedID",h.info.dbms);E(h);}}else{f.set("selectedID",null);W.set("selectedID",null);}}}mstrmojo.WH.DBRoleDSNConnection=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.WH.DBRoleDSNConnection",cssText:"width: 100%;",postBuildRendering:function O(){if(this._super){this._super();}this.model=this.parent.model;A(this.model,this);},info:null,oninfoChange:function(U){var V=D(this);L(this.model,this,V);B(this,V);},DSNless:true,onDSNChange:null,onConnectionChange:null,useDSN:function J(){var V=this,U=V.model;this.type=0;L(U,V,0);},selectedListChange:function H(U){var W=this.parent,V=W.model;L(V,W,this.selectedItem.id);P(V,W,this.selectedItem.id);},addSelectList:function G(){var U=this;U.selectlist.set("selectedItem",this.model.suppdbs[0]);U.selectlist.onChange();return ;},children:[{scriptClass:"mstrmojo.WH.DBRoleSettingPulldown",alias:"selectlist",itemIdField:"id",caption:mstrmojo.desc(7820,"select:"),cellLayout:[{cssText:"width: 20%;"},{cssText:"width:80%"}],onChange:function(U){var X=this.parent,V=X.DSNless,W=X.model;if(!V){I(W,X,U.value);if(X.onConnectionChange){X.onConnectionChange(X.type);}}else{L(W,X,this.selectedItem.id);P(W,X,this.selectedItem.id);}}},{scriptClass:"mstrmojo.WH.DBRoleSettingPulldown",alias:"dbmslist",itemIdField:"did",caption:mstrmojo.desc(8512,"dbms:"),onChange:function(U){var V=this.parent;E(V);}},{scriptClass:"mstrmojo.Box",alias:"scrollbox",cssText:"margin:5px 0px;width:407px;border:1px solid #bbbbbb;background-color:#FFFFFF;overflow-y:auto;overflow-x:hidden;max-height:160px;",children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"tbl",cssText:"width:410px;background-color:#FFFFFF;padding-left:15px;",children:[{scriptClass:"mstrmojo.VBox",alias:"contents",cssClass:"dsnless-property",cssText:"width:100%;",slot:"0,1"}]}]},{scriptClass:"mstrmojo.Box",alias:"scrollboxDSN",cssText:"margin:5px 0px;width:407px;",children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"tbl",cssText:"width:410px;",cssClass:"DBRoleDSNConnection-scrollboxDSN",layout:[{cells:[{cssClass:"DBRoleDSNConnection-scrollboxDSN-setting"},{cssClass:"DBRoleDSNConnection-scrollboxDSN-tooltip"}]}],children:[{scriptClass:"mstrmojo.VBox",alias:"contents2",cssText:"width:100%;",slot:"0,0",children:[{scriptClass:"mstrmojo.WH.DBRoleSettingPulldown",caption:mstrmojo.desc(8559,"DSN")+":",alias:"dsnlist",itemIdField:"n",onChange:function(U){var V=this.parent.parent.parent.parent;P(V.model,V,F(V,0));}}]}]}]},{scriptClass:"mstrmojo.WH.DBRoleSettingPulldown",alias:"dbmslistDSN",itemIdField:"did",caption:mstrmojo.desc(8512,"dbms:")}],type:0,supportedToType:function(U){return F(this,U);},connstr:function(){return Q(this.model,this);},dbtype:function(){return F(this,this.type);},DbVs:{DbVDbVDefault:-1,DbVDbVReserved:0,DbVTandemMPD45:1,DbVTandemMX1:2,DbVTandemMPD42:3,DbVTeradataV2R1:4,DbVTeradataV2R20002:5,DbVTeradataV2R21:6,DbVTeradatav2R3:7,DbVOracle733:8,DbVOracle8003:9,DbVSQLServer65:10,DbVSQLServer70:11,DbVAccess20:12,DbVAccess70:13,DbVSybaseAdaptive115:14,DbVSybaseSQL112:15,DbVSybaseIQ112:16,DbVIBMDB2OS39041:17,DbVIBMDB2OS39050:18,DbVIBMUDBSMP50:19,DbVIBMUDBEEE50:20,DbVIBMDB2PE12:21,DbVIBMDB2CS212:22,DbVIBMDB2400V3R7:23,DbVIBMDB2400V4R1:24,DbVIBMDB2400V4R2:25,DbVInformixODS724UC1:26,DbVInformixXPS82:27,DbVAdabaseD6112:28,DbVRedBrick5007:29,DbVRedBrick5012:30,DbVRedBrick5105:31,DbVTeradataNTV2R2:32,DbVTeradataNTV2R3:33,DbVOracle8i:34,DbVSybaseIQ12:35,DbVIBMUDB52:36,DbVIBMDB2400V4R3:37,DbVInformixODS731:38,DbVInformixUDO92:39,DbVInformixXPS83:40,DbVIBMUDB61:41,DbVOracle805:42,DbVOracle8iR2:43,DbVIBMUDB7:44,DbVIBMDB2OS39062:45,DbVIBMDB2OS3907:46,DbVIBMDB2400V4R4:47,DbVIBMDB2400V4R5:48,DbVRedBrick6:49,DbVTeradataV2R4:50,DbVSybaseAdaptive12:51,DbVSQLServer2000:52,DbVAccess2000:53,DbVInformix10:54,DbVOracle8iR3:55,DbVOracle9i:56,DbVRedBrick61:57,DbVIBMUDB8:58,DbVOracle8iR2SE:59,DbVTeradataV2R41:61,DbVAccess2002:62,DbVIBMDB2400V5R1:63,DbVSybaseAdaptive125:64,DbVRedBrick62:65,DbVIBMDB2400V5R2:66,DbVTeradataV2R5:67,DbVMDXSAPBW30:68,DbVOracle10g:69,DbVTeradataV2R51:70,DbVInformixIDS93:71,DbVInformixIDS94:72,DbVRedBrick63:73,DbVIBMDB2OS3908:74,DbVNetezza22:75,DbVExcel2003:76,DbVNetezza25:77,DbVMDXEssbaseHyperion:78,DbVMDXMicrosoftAS2005:79,DbVMySQL50:80,DbVPostgreSQL81:81,DbVInformixIDS10:82,DbVInformixIDS11:82,DbVOracle10gR2:83,DbVTeradataV2R6:84,DbVTeradataV2R61:85,DbVSybaseASE15:86,DbVSQLServer2005:87,DbVMDXMicrosoftAS2000:88,DbVIBMDB2400V5R4:89,DbVNetezza3:90,DbVNetezza30:90,DbVSybaseIQ127:91,DbVIBMUDB91:92,DbVTeradataV2R62:93,DbVPostgreSQL82:94,DbVPostgreSQL83:94,DbVHPNeoview22:95,DbVHPNeoview20:95,DbVOracle11g:96,DbVNetezza4:97,DbVNetezza40:97,DbVMDXEssbaseHyperion9:98,DbVGreenplum3x:99,DbVHPNeoview23:100,DbVIBMUDB95:101,DbVTeradata12:102,DbVTeradata120:102,DbVIBMUDB91zOS:103,DbVAccess2007:104,DbVIBMDB2400V6R1:105,DbVMetamatrix55:106,DbVDATAllegro3x:107,DbVComposite450:108,DbVAccess2003:109,DbVSQLServer2008:110,DbVMySQL51:111,DbVMDXMicrosoftAS2008:112,DbVAsternCluster30:113,DbVVertica25:114,DbVMDXEssbaseHyperion9x:115,DbVOpenAccess14:116,DbVSybaseSQLAny11:117,DbVNetezza46:118,DbVTeradata13:119,DbVSybaseIQ15:120,DbVSybaseIQ151:121,DbVHPNeoview24:122,DbVIBMUDB97:123,DbVNetezza50:124,DbVVertica30:125,DbVMDXSAPBW7x:126,DbVOracle11gR2:127,DbVInformixIDS115:128,DbVPostgreSQL84:129,DbVSQLServer2008NativeClient:130,DbVParAccel2x:131,DbVDBIBMDB2400V7R1:134,DbVAsternCluster40:135,DbVInfobright33:136,DbVVertica40:137,DbVSybaseIQ152:139,DbVHive05:138,DbVAsternCluster45:140,DbVXQuery:142,DbVComposite510:146,DbVSQLServer2008R2Par:148,DbVPostgreSQL9x:149,DbVTeradata131:150,DbVParAccel3:151,DbVHive06:152,DbVHive07:153,DbVSalesForce:154,DbVHiveThrift:156,DbVDBIBMUDBV10zOS:157,DbVDBVectorWise15:158,DbVSQLServer2012:159,DbVInfobright40:160,DbVSybaseIQ153:161,DbVSybaseIQ154:162,DbVEnterpriseDB9x:163,DbVKognitio7x:164,DbVVertica5051:167,DbVParAccel31x:168,DbVParAccel35:169,DbVComposite6x:170,DbVDBIBMUDB101:172,DbVAsternCluster46:173,DbVDBVectorWise20x:174,DbVTeradata140:177,DbVHiveThrift08:178,DbVHive08:179,DbVVertica60:180,DbVSAPHana1:181,DbVAsternCluster50:184,DbVNetezza70:185,DbVHive09:186,DbVHiveThrift09:187,DbVHImpala:188,DbVParAccel40:189,DbVAmazonRedShift:190,DbVSQLServerAzure:191,DbVSQLDenodo50:194,DbVBigQuery:196,DbVSQL2012Parallel:195,DbVIBMInfoSphere:197,DbVCloud:198,DbVDBVectorWise30x:199,DbVMariaDB:200,DbVMySQLCalpontInfiniDB:201,DbVDBIBMUDB105:202,DbVSAPHANA105:203,DbVHive010:204,DbVHive011:205,DbVTeradata141:206,DbVSandCDBMS7:207,DbVAsternCluster51:208,DbVSybaseIQ16:209,DbVInformixIDS121:210,DbVKognitio8x:211,DbVOracle12c:212,DbVIngres10s:213,DbVCirro:256,DbVMapRDrill:254},DbTs:{DbTReserved:0,DbTAccess:100,DbTOracle:200,DbTSQLServer:300,DbTInformix:400,DbTSybase:500,DbTRedBrick:600,DbTDB2:700,DbTTandem:800,DbTTeradata:900,DbTUnknown:1000,DbTGeneric:1100,DbTSAP:1200,DbTNetezza:1300,DbTExcel:1400,DbTMicrosoftAS:1500,DbTEssBase:1600,DbTMySQL:1700,DbTPostgreSQL:1800,DbTNeoview:1900,DbTMetamatrix:2000,DbTDATAllegro:2100,DbTComposite:2200,DbTAster:2300,DbTVertica:2400,DbTOpenAccess:2500,DbTSybaseSQLAny:2600,DbTParAccel:2800,DbTXQuery:3000,DbTHive:3100,DbTSand:3200,DbTSalesForce:3300,DbTHiveThrift:3400,DbTVectorWise:3500,DbTEnterpriseDB:3600,DbTKognitio:3700,DbTEXASolution:3800,DbTInformatica:3900,DbTHana:4000,DbTImpala:4100,DbTAmazonRedShift:4200,DbTDenodo:4300,DbTBigQuery:4400,DbTCloud:4500,DbTCirro:7500,DbTMapRDrill:7300},SDbT:{SDbTUndefined:0,SDbTDB2Wire:1,SDbTDB2iSeries:2,SDbTDB2ZOS:3,SDbTInformixWire:4,SDbTInformixXPS:5,SDbTPostgreSQL:6,SDbTSybaseASE:7,SDbTSybaseIQ:8,SDbTOracle:9,SDbTSQLServer:10,SDbTTeradata:11,SDbTMySQL:12,SDbTGreenPlum:13,SDbTNetezza:14,SDbTWebServices:15,SDbTHive:16,SDbTInfoBright:17,SDbTSalesForce:18,SDbTAccess:19,SDbTParAccel:20,SDbTAmazonRedShift:21,SDbTImpala:22,SDbTAster:23,SDbTRedBrick:24,SDbTVectorWise:25,SDbTEnterpriseDB:26,SDbTVertica:27,SDbTDenodo:28,SDbTComposite:29,SDbTMySQLCommunityEdition:30,SDbTSAPHana:31,SDbTConnectionCloud:32,SDbTBigQuery:33,SDbTKognitio:34,SDbTSand:35,SDbTCirro:122,SDbTMapRDrill:121}});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.TreeNode");var I=mstrmojo.dom;mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:mstrmojo.hash.copy({checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,onstateChange:function H(){if(!this.contentRetrieved&&(this.state==1)){this.set("items",[this.tree.loadingItemCreaterFunc()]);this.tree.getContent(this,this.blockBegin);}},toggleState:function F(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function G(J){I.clearBrowserHighlights(J.hWin);return false;},predblclick:function D(J){I.clearBrowserHighlights(J.hWin);return false;},premousedown:function B(K){var P=mstrmojo.dom,M=mstrmojo.dom.eventTarget(K.hWin,K.e),J=this.tree,L=(this.state==2),O=P.contains(this.itemsContainerNode,P.eventTarget(K.hWin,K.e),true,this.domNode),N=(J.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if(this.isSpecialNode()||!(M==this.checkBoxNode||(M==this.textNode&&(L||!N)))){P.stopPropogation(K.hWin,K.e);}if((M==this.stateNode)||(M==this.textNode&&!L&&N)){if(!L){this.toggleState();}}else{if(M==this.checkBoxNode||O){if(this._super){this._super(K);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var J=this.data&&this.data.st;return(J<0);},handleNodeClicked:function E(){var J=this.tree,K=this.parent,L=this.data;switch(L&&L.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin-J.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin+J.blockCount);break;case"-1":case"-2":break;default:if(J.handleNodeClicked){J.handleNodeClicked(L);}}},init:function(J){this._super(J);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var J=function(K){I.preventDefault(window,K||window.event);return false;};I.attachEvent(this.domNode,"mousedown",J);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr");var E=mstrmojo.array,K=mstrmojo.expr,N=mstrmojo.dom,A=mstrmojo.css;function I(P,O){var R=P.data,Q=R&&R.nds;if(!Q){return null;}if(O){O.sort(E.numSorter);}else{O=P.sortSelectedIndices();}if(!O.length){return null;}return{idxs:O,nds:E.get(Q,O)};}function L(Q){var P=Q.ctxtBuilder,S=P&&P.itemWidgets,O=S&&S[0],R=O&&O.data;if(R&&R.not&&(S.length>1)){R.not=false;O.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode],{scriptClass:"mstrmojo.AndOrNode",data:null,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><img class="mstrmojo-outdent disable" src="../images/1ptrans.gif" title="Ungroup Conditions" /><img class="mstrmojo-outdent" src="../images/1ptrans.gif" title="Ungroup Conditions" onclick="mstrmojo.all[\'{@id}\'].out()" /><img class="mstrmojo-indent disable" src="../images/1ptrans.gif" title="Group Conditions" /><img class="mstrmojo-indent" src="../images/1ptrans.gif" title="Group Conditions" onclick="mstrmojo.all[\'{@id}\'].ind()" /></span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixNode:function(){return this.domNode.firstChild.firstChild;},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},oneditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.editable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(O){this._super(O);var P=this.data;if(P){delete this.data;this._set_data(null,P);}},itemCnt:0,postBuildRendering:function(){var O;this.set("itemCnt",this.items.length);if(this._super){O=this._super();}L(this);return O;},preadd:function J(O){if(this._super){this._super(O);}this.set("itemCnt",this.items.length);L(this);},preremove:function M(O){if(this._super){this._super(O);}this.set("itemCnt",this.items.length);L(this);},_set_data:function(R,O){var P=this.data,Q=(P!==O);if(Q){this.data=O;if(O&&!O.nds){O.nds=[];}this.set("items",O&&O.nds);}return Q;},getDragData:function(O){var Q=this._super(O);if(Q&&!Q.html){var P=Q.et&&K.ET2TGT[Q.et];Q.html=P?Q[P]&&Q[P].n||"":Q.n||"";}return Q;},remove:function H(P,Q){var O=this._super(P);if(O>-1){var R=(Q===true)||((Q==null)&&this.suppressConsolidation);if(!R){this.consolidate(false);}}return O;},move:function(P,O){this.suppressConsolidation=true;var Q;if(this._super){Q=this._super(P,O);}this.suppressConsolidation=false;return Q;},consolidate:function D(){var S=this.parent;if(!S||!S.remove){return ;}var Q=this.items,P=Q&&Q.length;if(P<2){var R=P?Q[0]:null,O=this.childIndex();if(R){S.add([R],O);}S.remove(this.data);}},indent:function F(Q,O){var P=I(this,Q);if(!P){return ;}this.remove(P.idxs,true);var S={et:K.ET.ANDOR,nds:P.nds};var R=O&&O.fn;if(!R){R=this.data&&this.data.fn===K.FN.AND?K.FN.OR:K.FN.AND;}S.fn=R;this.add([S],P.idxs[0]);this.consolidate(false);},outdent:function B(P){var Q=this.parent,O=Q&&Q.data;if(!O||O.et!==K.ET.ANDOR){return ;}var R=I(this,P);if(!R){return ;}this.remove(R.idxs,true);Q.add(R.nds,this.childIndex());this.consolidate(false);},edit:function C(X,Y,Q){if(!X){return ;}var W=this.data,V=W&&W.fn,P=X.data,b=P&&P.not;if(!P){P={};X.data=P;}P.not=!!Q;if(V!==Y){var O=W.nds;if(O&&O.length>2){var a=X.childIndex();if(a>0){this.indent([a-1,a],{fn:Y});}}else{W.fn=Y;var T=this.ctxtBuilder,S=T&&T.itemWidgets;for(var R=0,U=(S&&S.length)||0;R<U;R++){var Z=S[R];if(Z){Z.paint();}}}}else{X.paint();}},preclick:function G(O){var Q=null,P=N.eventTarget(O.hWin,O.e);if(P===this.prefixNode){}else{if(N.contains(this.prefixNode,P,true)){Q="andor";}}O.part=Q;}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Label","mstrmojo.array","mstrmojo.qb.DBTableRow");var J=mstrmojo.string,Q=mstrmojo.dom,D=mstrmojo.css,M=mstrmojo.array;function N(R,T,U){var S=R.editorNode.style;T=(T<0)?0:T+"px";U=(U<0)?0:U+"px";S.left=T;R.set("left",T);R.left=T;S.top=U;R.set("top",U);R.top=U;}function L(R){var S=R.children[0].children;M.forEach(S,function(U,T){if(R.selectedIndex[T]){D.addClass(U.domNode,["selected"]);}else{D.removeClass(U.domNode,["selected"]);}});}mstrmojo.qb.DBTable=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.DBTable",title:"",left:"",top:"",minWidth:80,maxWidth:250,maxHeight:300,minHeight:20,model:null,prevPos:{},container:null,selectedIndex:[],draggable:true,noCheckBox:true,topAnchor:function K(){return(this.titlebarNode)?parseInt(this.top)+(this.titlebarNode.clientHeight/2)+"px":"0px";},leftAnchor:function H(){return this.left;},rightAnchor:function E(){return(this.editorNode)?parseInt(this.left)+this.editorNode.clientWidth+"px":"0px";},modal:false,zIndex:7,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown,mouseup,click><div style="position:absolute;background-color:LightSteelBlue;border-top-left-radius: 5px;border-top-right-radius: 5px; height: 20px;"><table cellspacing="0" cellpadding="0" class="mstrmojo-qb-DBTable-titlebar"><tr><td><input id="{@id}check" type="checkbox" mstrAttach:click></td><td class="mstrmojo-Editor-titleCell"><div id="{@id}title" class="mstrmojo-qb-DBTable-title"  mstrAttach:dblclick></div></td><td><div class="mstrmojo-qb-DBTable-close" title="'+mstrmojo.desc(629,"Delete")+'"></div></td><td><div style="display:none;"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>{@titlebarHTML}<div class="mstrmojo-Editor-content" style="overflow-x:hidden; overflow-y:auto; padding:0px;" mstrAttach:scroll></div><div class="mstrmojo-qb-table-resize-handle north" id="{@id}north" ></div><div class="mstrmojo-qb-table-resize-handle east" id="{@id}east"></div><div class="mstrmojo-qb-table-resize-handle south" id="{@id}south"></div><div class="mstrmojo-qb-table-resize-handle west" id="{@id}west"></div></div></div>',titleMarkupString:"",children:[{scriptClass:"mstrmojo.Box",alias:"Rows",cssText:"width:100%; background-color:white; border: 1px solid #C6C6C6; height:100%;white-space: nowrap;"}],markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},checkBoxNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[3].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;},leftanchor:function(){return this.left;}},onscroll:function(){this.parent.parent.linker.drawLinks();},premousedown:function P(R){var S=mstrmojo.dom.eventTarget(R.hWin,R.e);if(S===this.closeNode){if(!this.readOnly){this.close();}}},onmousedown:function(R){this.editorNode.style.zIndex=8;},onmouseup:function(R){this.editorNode.style.zIndex=7;},toggleSelect:function(R){var T,S;if(this.selectedIndex[R]){this.selectedIndex[R]=false;}else{this.selectedIndex[R]=true;}L(this);},rangeSelect:function(R){},singleSelect:function(S){for(var T=0,R=this.selectedIndex.length;T<R;T++){this.selectedIndex[T]=false;}this.selectedIndex[S]=true;L(this);},clearSelect:function(){for(var S=0,R=this.selectedIndex.length;S<R;S++){this.selectedIndex[S]=false;}L(this);},onmouseover:function(R){if(!this.isAndroid){handleTouchBegin(this,R.e.pageX,R.e.pageY);}},touchBegin:function I(S){var R=this.editorNode.style;this._tl=parseInt(R.left);this._tt=parseInt(R.top);},touchSwipeMove:function G(U){var R=mstrmojo.all.QBuilderModel,S=this.container,T=R.tables[this.id];N(this,U.delta.x+this._tl,U.delta.y+this._tt);if(T&&T.njoins>0){S.linker.drawLinks();}},addRow:function C(R,W,S,T){var U=this.children[0];var V={scriptClass:"mstrmojo.qb.DBTableRow",images:S,indent:W,text:R};U.addChildren([V]);},onclick:function(Z){var U=Z.hWin,V=Z.e||U.event,T=V.target||V.srcElement,S=document.elementFromPoint(V.clientX,V.clientY),R=T&&T.id;if(R.replace(this.id,"")=="check"){if(this.onCheck){this.onCheck(T.checked);}}var X=Q.findWidget(S);if(!X||!X.srcData){this.clearSelect();return ;}var Y=X.rIndex,W=Q.ctrlKey(U,V),a=Q.shiftKey(U,V);if(W||a){Q.clearBrowserHighlights(U);}if(W){this.toggleSelect(Y);}else{if(m&&a){this.rangeSelect(Y);}else{this.singleSelect(Y);}}},ondblclick:function(S){var R=S.hWin,U=S.e||R.event,Y=U.target||U.srcElement,X=Y&&Y.id;if(X.replace(this.id,"")=="title"){var W=Q.delta(this.titleNode,this.titlebarNode);var V=this.title,T=this.titleNode.clientWidth-6;this.openPopup("inlineTextRef",{left:W.x+"px",top:(Q.isIE?0:-1)+"px",txtConfig:{cssClass:"mstrmojo-qb-tablealias-edit",width:T+"px",value:J.decodeHtmlString(V)||"",onEnter:function(){var b=J.trim(this.value);this.parent.close({enter:true});if(b){var f=this.parent.parent;if(J.encodeHtmlString(b)!==f.title){var Z=f.model;if(Z&&Z.tbns){var d="";if(b.match(/[~#'"?;:[\]]/)){d="A table alias cannot contain the following characters: ~#'\"?;:/[]";mstrmojo.alert(d);return ;}if(!b.match(/^[a-zA-Z]/)){b=b.replace(/^\S/,"L");d="Table alias starting with non alphabetic character will be replaced by the character L.";}var c=J.encodeHtmlString(b);if(Z.tbns[b]&&(c!==f.title)){d+="'"+c+"' has been used as the alias of another table. Please give a new name.";mstrmojo.alert((d));return ;}if(d){mstrmojo.alert(d);}}var a=J.decodeHtmlString(f.title);if(Z&&Z.renameTable){Z.renameTable(f.id,a,b);}f.set("title",J.encodeHtmlString(b));if(f.onHeaderChange){f.onHeaderChange(a,b);}}}},onCancel:function(){this.set("value",this.parent.title);}}});}},onCheck:function(R){},postBuildRendering:function B(){if(this._super){this._super();}if(this.noCheckBox){this.checkBoxNode.style.display="none";}if(this.titleNode){this.titleNode.style.width=this.titleNode.clientWidth-20+"px";}},getDragData:function O(R){var S=R.src,U=S.node,T=U.id;if(T){switch(T.replace(this.id,"")){case"north":case"east":case"south":case"west":return{dir:T.replace(this.id,""),startX:S.pos.x,startY:S.pos.y};break;default:break;}}else{if(this._super){return this.dropZone&&this._super(R);}}return null;},ondragstart:function F(R){var T=R.src,U=T&&T.data,S=U&&U.dir;if(S){this.prevPos={x:T.pos.x,y:T.pos.y};return true;}else{if(this._super){return this._super(R);}}},ondragmove:function A(V){var Z=V.src,q=Z&&Z.data,b=q&&q.dir;if(b){switch(b){case"north":case"south":var k=V.tgt;var W=k.pos.y-this.prevPos.y;W=(b=="north")?W:-W;this.prevPos=k.pos;var c=this.editorNode.style;if(parseInt(c.height)-W>=this.minHeight&&parseInt(c.height)-W<=this.maxHeight){this.containerNode.style["overflow-y"]="auto";if(b=="north"){c.top=parseInt(c.top)+W+"px";this.top=c.top;}c.height=parseInt(c.height)-W+"px";this.containerNode.style.height=parseInt(c.height)-this.titlebarNode.clientHeight+"px";}else{this.containerNode.style["overflow-y"]="hidden";}break;case"east":case"west":var k=V.tgt,U=this.noCheckBox?39:59;var Y=k.pos.x-this.prevPos.x;Y=(b=="east")?Y:-Y;this.prevPos=k.pos;var c=this.editorNode.style;if(parseInt(c.width)+Y>=this.minWidth&&parseInt(c.width)+Y<=this.maxWidth){if(b=="west"){c.left=parseInt(c.left)-Y+"px";this.left=c.left;}c.width=parseInt(c.width)+Y+"px";this.titleNode.style.width=parseInt(c.width)-U+"px";this.titlebarNode.style.width=parseInt(c.width)+"px";}break;break;}this.parent.parent.linker.drawLinks();}else{var T=mstrmojo.all.QBuilderModel,R=this.container,n=parseInt(R.domNode.clientHeight),X=parseInt(R.domNode.clientWidth),p=V.tgt.pos,Z=V.src.pos,Y=p.x-Z.x,W=p.y-Z.y,c=this.getMovingTarget().style,r=this._leftPos+Y,f=this._topPos+W;r=(r<0)?0:r;f=(f<0)?0:f;if(R.maxWidth>X){R.domNode.style["overflow-x"]="auto";}else{R.domNode.style["overflow-x"]="hidden";}if(R.maxHeight>n){R.domNode.style["overflow-y"]="auto";}else{R.domNode.style["overflow-y"]="hidden";}var a=true,t=true,o=R.canvasbox.children;for(var g=0,l=o.length;g<l;g++){if(this.id!=o[g].id&&r+this.editorNode.clientWidth<parseInt(o[g].left)+o[g].editorNode.clientWidth){a=false;break;}}if(a){R.maxWidth=r+this.editorNode.clientWidth;if(R.maxWidth>X){R.canvasbox.domNode.style.width=R.maxWidth+"px";R.canvasbox.width=R.maxWidth+"px";R.linker.width=R.maxWidth;T.linkerNeedRender=true;R.linker.drawLinks();}}for(var g=0,l=o.length;g<l;g++){if(this.id!=o[g].id&&f+this.editorNode.clientHeight<parseInt(o[g].top)+o[g].editorNode.clientHeight){t=false;break;}}if(t){R.maxHeight=f+this.editorNode.clientHeight+10;if(R.maxHeight>n){R.canvasbox.domNode.style.height=R.maxHeight+"px";R.canvasbox.height=R.maxHeight+"px";R.linker.height=R.maxHeight;T.linkerNeedRender=true;R.linker.drawLinks();}}c.left=r+"px";c.top=f+"px";this.top=f+"px";this.left=r+"px";var S=T.tables[this.id];if(S&&S.njoins>0){R.linker.drawLinks();}}},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,slot:"containerNode",children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var S=this.txt,T=this.txtConfig;if(T){for(var R in T){S.set(R,T[R]);}}S.domNode.style.width=S.width;S.focus();},onClose:function(R){if(!R||(!R.cancel&&!R.enter)){this.txt.onEnter();}}},_set_height:function(T,S){if(this.editorNode&&parseInt(S)>this.titlebarNode.clientHeight){var R=this.editorNode.style;R.height=parseInt(S)+"px";this.containerNode.style.height=parseInt(R.height)-this.titlebarNode.clientHeight+"px";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Editor");var D=mstrmojo.hash;var I={2219:" IN ",2220:"[Not In]"},F={525:" LIKE ",526:"[Not Like]",686:" Contains ",2784:"[Not Contains]",687:"[Begins With]",2785:"[Not Begins With]",688:"[Ends with]",2786:"[Not ends with]"},K=D.copy(I,{520:"=",612:"<>",521:">",523:"<",522:">=",524:"<=",Between:" between ","Not between":"[Not Between]"});K=D.copy(F,K);var G=",",J="'",H='"',C={"'":1,'"':1};function A(O){var N=O.length;O=O.substring(C[O[0]]?1:0,(C[O[N-1]]?N-1:N));return[J,O,J].join("");}function M(O){var N=O.toString();if(N.match(/#\d+#/)){return N;}return"#"+N+"#";}function E(P){var O=P.split(G),N=[];mstrmojo.array.forEach(O,function(Q){N.push(A(Q));});return N.join(G);}mstrmojo.qb.FilterValueEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.FilterValueEditor",zIndex:100,id:"fve1",title:mstrmojo.desc(9124,"Enter Value"),cssClass:"mstrmojo-qb-filtervalue-editor",help:(mstrApp.helpTopics&&mstrApp.helpTopics.filterValue)||"Enter_Value_dialog_box.htm",column:null,operatorID:null,children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-filtervalue-box",alias:"box",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-filtervalue-name",alias:"filter"},{scriptClass:"mstrmojo.TextBox",alias:"txtname",cssClass:"mstrmojo-qb-filtervalue-textbox"}]},{scriptClass:"mstrmojo.Label",alias:"err",cssClass:"mstrmojo-qb-filtervalue-errmsg",text:""},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"float:right;",text:mstrmojo.desc(1442,"OK"),onclick:function L(){var R=this.parent.parent,P=R.box,N=R.operatorID,S=R.box.txtname.value,O=R.isDateTime,Q;if(S==""){return ;}if(O){S=E(S);}if(R.isBigDecimal){S=M(value);}if(F[N]){S=H+S+H;}if(I[N]){S="("+S+")";}Q=[mstrmojo.all.QBuilderModel.brackets(R.column)," ",K[R.operatorID]," ",S].join("");mstrApp.getRootController().parseExpression({expr:Q,qbrex:2,cIndex:1,vo:1},{success:function(U){if(U&&U.mi){var T=U.mi,V=T.reject_error_description;if(V){if(O&&T.reject_error_code===-2147214817){V="(Please enter a valid date/time value.)";}R.err.set("text",V);}else{R.close();mstrApp.getRootController().addNewFilter({et:"*",expr:T.tknstrm.mi.tkn,n:Q,sqltp:T.exp.sqltp});}}}});}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(N){var O=this.parent.parent;if(O.onCancel){O.onCancel();}O.close();}}]}],onOpen:function B(){var N=this.box,O=N.txtname;this.err.set("text","");N.filter.set("text",this.n);O.set("value","");O.focus();}});mstrmojo.qb.FilterValueEditor2=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.FilterValueEditor2",zIndex:100,id:"fve2",title:mstrmojo.desc(9124,"Enter Value"),cssText:"width:260px;",help:(mstrApp.helpTopics&&mstrApp.helpTopics.filterValue)||"Enter_Value_dialog_box.htm",column:null,children:[{scriptClass:"mstrmojo.HBox",alias:"box",cssClass:"mstrmojo-qb-filtervalue-box",children:[{scriptClass:"mstrmojo.Label",alias:"filter"},{scriptClass:"mstrmojo.TextBox",alias:"txtname1",cssClass:"mstrmojo-qb-filtervalue-textbox2"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(5282,"AND"),cssText:"width:30px;"},{scriptClass:"mstrmojo.TextBox",alias:"txtname2",cssClass:"mstrmojo-qb-filtervalue-textbox2"}]},{scriptClass:"mstrmojo.Label",alias:"err",cssClass:"mstrmojo-qb-filtervalue-errmsg",text:""},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"float:right;",text:mstrmojo.desc(1442,"OK"),onclick:function L(){var R=this.parent.parent,Q=R.children[0],O=Q.txtname1.value,N=Q.txtname2.value,P=R.isDateTime,S;if(O==""||N==""){return ;}if(P){O=E(O);N=E(N);}else{if(R.isBigDecimal){O=M(O);N=M(N);}}expression=[mstrmojo.all.QBuilderModel.brackets(R.column)," ",K[R.operatorID]," ",O," AND ",N].join("");mstrApp.getRootController().parseExpression({expr:expression,qbrex:2,cIndex:1,vo:1},{success:function(U){if(U&&U.mi){var T=U.mi,V=T.reject_error_description;if(V){if(P&&T.reject_error_code===-2147214817){V="(Please enter a valid date/time value.)";}R.err.set("text",V);}else{R.close();mstrApp.getRootController().addNewFilter({et:"*",expr:T.tknstrm.mi.tkn,n:expression,sqltp:T.exp.sqltp});}}}});}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(N){var O=this.parent.parent;if(O.onCancel){O.onCancel();}O.close();}}]}],onOpen:function B(){var O=this.box,N=O.txtname1;this.err.set("text","");O.filter.set("text",this.n);O.txtname2.set("value","");N.set("value","");N.focus();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor");mstrmojo.WH.WHNameEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.WH.WHNameEditor",cssText:"width:350px;",help:mstrApp.helpTopics&&mstrApp.helpTopics.DBRole,children:[{scriptClass:"mstrmojo.Label",alias:"name",cssText:"width:100%; margin-left:5px;margin-top:10px;",text:"Please Enter Name:"},{scriptClass:"mstrmojo.TextBox",alias:"txtbox",cssText:"margin-top:10px;margin-left:5px;margin-right:5px;width:94%;",onkeyup:function(A){switch(A.e.keyCode){case 13:var B=true;if(this.parent.onOK){this.parent.onOK();}break;case 27:this.parent.close();break;default:break;}}},{scriptClass:"mstrmojo.Label",cssText:"width:100%; padding: 5px;",alias:"error",text:""},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button rightfloat",text:mstrmojo.desc(1442,"OK"),onclick:function(A){var C=this.parent.parent;var B=true;if(C.onOK){C.onOK();}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(A){var B=this.parent.parent;if(B.onCancel){B.onCancel();}B.close();}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo.Editor","mstrmojo.Label","mstrmojo.HBox");mstrmojo.qb.MissingColumnWarning=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.MissingColumnWarning",title:mstrmojo.desc(3610),warning:mstrmojo.desc(10040,"Some of the previously uploaded columns are missing"),details:mstrmojo.desc(10041,"If you do not import previously used columns, existing reports, documents and analyses might be affected. Do you still want to continue?"),onOpen:function(){this.list.set("items",this.mappings);this.warningLabel.set("text",this.warning);this.detailLabel.set("text",this.details);},cssText:"width: 400px",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-MissingColumns-title",alias:"warningLabel"},{scriptClass:"mstrmojo.List",alias:"list",cssClass:"mstrmojo-qb-MissingColumns-list",itemIdField:"did",itemMarkupFunction:function(A,C,D){var B='<div class="mstrmojo-qb-MissingColumns-bullet mstrmojo-qb-MissingColumns-Icon t'+A.tp+'">'+A.n+"</div>";return B;}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-MissingColumns-instruction",alias:"detailLabel"},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-MissingColumns-buttonBox",slot:"buttonNode",cssText:"float:right;background:transparent;height:45px;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-Yes",text:mstrmojo.desc(219,"Yes"),onclick:function(A){var C=this.parent.parent;var B=true;if(C.onOK){B=C.onOK();}if(B){C.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-No",text:mstrmojo.desc(218,"No"),onclick:function(A){var B=this.parent.parent;if(B.onCancel){B.onCancel();}B.close();}}]}],onRender:function(){this.helpNode&&(this.helpNode.style.display="none");this.closeNode&&(this.closeNode.style.display="none");}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=(Y)?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=(Y)?0:U-1;}else{V+=(Y)?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(k){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,h=this._last_hit;if(!this.noCache&&(d||h)){var g=this.filterCandidates(a,k,this.REQUEST_THRESHOLD),b=g.length,f=this.suggestCount,U=false;if(!X&&b<f){var V=h&&h.pattern;if(h&&V&&(k.indexOf(V)>-1)){U=true;var n=this.filterCandidates(h.items,k,this.REQUEST_THRESHOLD),Y=n&&n.length,W=mstrmojo.array,l=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(g,l,n[Z][l])===-1){g.push(n[Z]);}}b=g.length;}}if(!X&&((k.length>2&&b<this.REQUEST_THRESHOLD)||(b<f))){this.requestCandidates(k);return -1;}return(b<f)?g:g.slice(0,f);}this.requestCandidates(k);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(f){if(!f){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var l=d.getSearchPattern(),a=f.items;X._last_hit={items:a,pattern:U};X.sz=f.sz;if(!X.noCache&&a){var g=X.candidates&&X.candidates.items||[],h=[].concat(a);for(var Z=0,b=a.length;Z<b;Z++){var Y=h[Z];if(mstrmojo.array.indexOf(g,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=g.concat(a);}}if(l&&l.indexOf(U)>-1){var k=X.filterCandidates(a,l);X.updateSuggestion(k);}},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:((V)?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var V=this.zIndex;this.openPopup("ob",{zIndex:(V&&(V+10))||110});this.ob.browser.browse({folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes});this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopup:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInputBox-suggest",showTitle:false,modal:false,autoClose:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U&&U.autoSelect){this.list.singleSelect(0);}},onClose:function F(){this.list.clearSelect();if(this.opener){this.opener.suggestionShown=false;}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){var N,J;mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DocPortlet");var Q={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};mstrmojo.Vis=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,updated:false,reRenderOnDimensionChg:true,getFormats:function(){return this.fmts;},isVis:function(){return true;},setModel:function L(V){this.set("model",V);if(V.data){this.set("model",V.data);}this.xtabModel=V;if(typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function S(){this._super();var V=this.xtabModel;if(V&&V.destroy){V.destroy();delete this.xtabModel;}},setDimensions:function O(X,W){var V=this._super(X,W);if(V&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return V;},reRender:function F(){this.unrender();this.render();},getWidth:function B(){return parseInt(this.width,10);},getHeight:function I(){return parseInt(this.height,10);},buildRendering:function H(){if(!this.updated){this.update();}if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function E(){N=this.width;J=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function A(){var V=this.domNode,W={top:0,left:0};if(typeof (mstr)!="undefined"){W.top=mstr.utils.BoxModel.getElementSumOffsetTop(V);W.left=mstr.utils.BoxModel.getElementSumOffsetLeft(V);}else{if(typeof (mstrmojo)!="undefined"){W=mstrmojo.boxmodel.offset(V);}}this.offsetTop=W.top;this.offsetLeft=W.left;},initFromVisProps:function R(V){},update:function G(X){X=X||this.node;if(X){if(X.data){this.set("model",X.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",X.data);}this.model=X.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(X.data.extProps,this);}this.fmts=X.defn.fmts||X.defn.units[this.model.k].fmts;var V=this.fmts;if(V){for(var W in Q){v=Q[W];if(W in V){this[v]=V[W];}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;},getModel:function M(W){if(W){var V=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,W);if(V){return V.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));}}else{return this.model;}},getDataParser:function K(V){return new mstrmojo.Vis.DataParser(this.getModel(V));},renderErrorMessage:function T(V){this.domNode.innerHTML='<div class="mstrmojo-message">'+V+"</div>";},getMessageID:function D(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function U(Y){var g=this.xtabModel,f=(g&&g.docModel);var h=false;if(f){var d=f.defn&&f.defn.layouts,X=null;var W;if(d){for(W in d){if(d[W].loaded){X=d[W];break;}}}var Z=X&&X.units;this.selectorTargets={};if(Z&&Y.scObjList){for(var W=0;W<Y.scObjList.length;W++){var a=Y.scObjList[W];var b=a.sc.tks.split("\x1E");for(var V=0;V<b.length;V++){var c=Z[b[V]];if(c){this.selectorTargets[b[V]]=c;if(!this.isChildOfIfw(Z,c)){h=true;}}}}}}return h;},isChildOfIfw:function C(V,W){while(W){if(W.ifw){return true;}W=V[W.pnk];}return false;},performAction:function P(V){var X=this.xtabModel.getAction(V),W=X&&X.h;if(W&&this.controller[W]){this.controller[W](this,X.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(V,d,W){var a=d;var Y=V.getChildren(d,false);for(var X=0;X<Y.length;X++){var b=Y[X];if(b.k==W){return b;}else{var Z=mstrmojo.Vis.getVisGrid(V,b,W);if(Z){d=a;return Z;}}}};mstrmojo.Vis.DataParser=function(X){var f=mstrmojo.Vis;return{getRowTitles:function(){return new f.Titles(X,true);},getColTitles:function(){return new f.Titles(X,false);},findMetricValue:function(k,p){var o=X.ghs.rhs.items;for(var l in o){var n=o[l].items;var h=true;for(var g in k){if(k[g]!=n[g].idx){h=false;break;}}if(h){return new mstrmojo.Vis.MetricValue(X.gvs.items[l].items[p]);}}},getTotalRows:function a(){return X.eg?0:X.ghs.rhs.items.length;},getTotalColHeaderRows:function Y(){return(!X.ghs.chs.items?0:X.ghs.chs.items.length);},getTotalCols:function V(){return this.getColHeaders(0).size();},getRowHeaders:function d(g){return new f.Headers(X,g,true);},getColHeaders:function c(g){return new f.Headers(X,g,false);},getMetricValue:function b(h,g){return new f.MetricValue(X,X.gvs.items[h].items[g]);},getColumnHeaderCount:function Z(){return X.gvs.items[0].items.length;},getCSSString:function W(){return X.cssString;}};};mstrmojo.Vis.Titles=function(V,a){var Z=(a)?V.gts.row:V.gts.col;return{size:function Y(){return Z.length;},getTitle:function X(b){return new mstrmojo.Vis.Title(Z[b]);},getCSS:function W(b){return V.css[Z[b].cni].n;}};};mstrmojo.Vis.Headers=function(W,X,b){var c=(b)?W.gts.row:W.gts.col;var a=(b)?W.ghs.rhs:W.ghs.chs;var Y=a.items&&a.items[X].items;return{size:function d(){return(!Y?0:Y.length);},getHeader:function V(f){return Y&&Y[f]&&new mstrmojo.Vis.Header(Y[f],b?c[f]:c[X]);},getCSS:function Z(f){return Y&&W.css[Y[f].cni].n;},getHeaderCell:function(f){return Y&&Y[f];}};};mstrmojo.Vis.Title=function(W){return{getActionType:function(){return W.at;},getDrillPath:function(){return W.dp;},getHeaderValues:function V(){return W.es;},getHeaderName:function X(Z){return W.es[Z].n;},getHeaderId:function X(Z){return W.es[Z].id;},getForms:function Y(){return W.fs;},getFormId:function(){return W.fid;},getFormType:function(){return W.ftp;},getUnitId:function(){return W.id;},getLinkMap:function(){return W.lm;},getName:function(){return W.n;},getUnitDssType:function(){return W.otp;},getSelectorControl:function(){return W.sc;}};};mstrmojo.Vis.Header=function(X,V){return{getName:function Z(){return(X.idx===-1)?"":V.es[X.idx].n;},getElementId:function c(){return(X.idx===-1)?"":V.es[X.idx].id;},getObjectId:function Y(){return(X.idx===-1)?"":V.es[X.idx].oid;},getElementIndex:function W(){return X.idx;},getActionType:function b(){return X.at;},isTotal:function a(){return X.otr===1;}};};mstrmojo.Vis.MetricValue=function(V,c){var b=c;return{getValue:function W(){return b.v;},getThresholdType:function X(){return b.ty;},getRawValue:function a(){return b.rv;},getCSS:function Y(){return V.css[b.cni].n;},getThresholdValue:function d(f){if(b.ti==undefined){return f;}return V.th[b.ti].n;},getFillColor:function Z(f){if(b.ci==undefined){return f;}return V.fc[b.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.color");var A=mstrmojo.css,G=mstrmojo.dom,D;mstrmojo.qb.QBTableLinker=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.qb.QBTableLinker",width:null,height:0,context:0,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="position:absolute;left:0px;top:0px;width:{@width}px;height:{@height}px;overflow:hidden;"  mstrAttach:mouseover,mousemove,click ><canvas width="{@width}px" height="{@height}px"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}px" height="{@height}px"></canvas><div id="{@id}-tooltip" class="mstrmojo-Map-tooltip"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},highlightCanvas:function(){return this.domNode.childNodes[1];},tooltip:function(){return this.domNode.childNodes[2];}},postBuildRendering:function F(){if(this._super){this._super();}if(D===undefined){D=this.canvas&&this.canvas.getContext&&this.canvas.getContext("2d");}if(D){this.context=this.canvas.getContext("2d");this.highlight=this.highlightCanvas.getContext("2d");}else{this.createVMLCanvas();}this.model=mstrmojo.all.QBuilderModel;},getCordValue:function H(L){return CordValue;},drawLinks:function I(){this.clearCanvas();var R=mstrmojo.all.QBuilderModel;if(R.linkerNeedRender){this.render();R.linkerNeedRender=false;}var L=this.model&&this.model.joinsInfo;for(var Q in L){var X=L[Q],N=X.links;for(linkid in N){var T=N[linkid].srcw,O=N[linkid].tgtw,V=T.parent.parent,S=O.parent.parent,Z=parseInt(V.leftAnchor()),P=parseInt(V.rightAnchor()),M=parseInt(S.leftAnchor()),Y=parseInt(S.rightAnchor()),d=V.containerNode.clientWidth,U=G.position(T.domNode),W=G.position(O.domNode),b=G.position(this.domNode),c=G.position(V.containerNode),a=G.position(S.containerNode);if(U.y>c.y&&U.y+0.5*U.h<c.y+c.h){srcwy=U.y-b.y+0.5*T.domNode.clientHeight;}else{srcwy=c.y-b.y-0.5*V.titleNode.clientHeight;}if(W.y>a.y&&W.y+0.5*W.h<a.y+a.h){tgtwy=W.y-b.y+0.5*O.domNode.clientHeight;}else{tgtwy=a.y-b.y-0.5*S.titleNode.clientHeight;}if(M>Z+0.5*d){srcwx=P;srcwx1=srcwx+20;tgtwx=M;tgtwx1=tgtwx-20;}else{if(M>Z&&M<Z+0.5*d){srcwx=P;srcwx1=srcwx+20;tgtwx=Y;tgtwx1=tgtwx+20;}else{if(M<Z&&Y>Z+0.5*d){srcwx=Z;srcwx1=srcwx-20;tgtwx=M;tgtwx1=tgtwx-20;}else{srcwx=Z;srcwx1=srcwx-20;tgtwx=Y;tgtwx1=tgtwx+20;}}}N[linkid].marker=[{x:srcwx,y:srcwy},{x:srcwx1,y:srcwy},{x:tgtwx1,y:tgtwy},{x:tgtwx,y:tgtwy}];N[linkid].coords=[srcwx,srcwy+5,srcwx,srcwy-5,srcwx1,srcwy-5,tgtwx1,tgtwy-5,tgtwx,tgtwy-5,tgtwx,tgtwy+5,tgtwx1,tgtwy+5,srcwx1,srcwy+5];this.drawLine(srcwx,srcwy,srcwx1,srcwy);this.drawLine(srcwx1,srcwy,tgtwx1,tgtwy);this.drawLine(tgtwx1,tgtwy,tgtwx,tgtwy);switch(X.jt){case"3":this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy+5);this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy-5);this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy-5);this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy+5);break;case"1":this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy+5);this.drawLine(srcwx,srcwy,0.5*(srcwx+srcwx1),srcwy-5);break;case"2":this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy-5);this.drawLine(tgtwx,tgtwy,0.5*(tgtwx+tgtwx1),tgtwy+5);break;default:break;}}}if(D){this.context.stroke();}this.drawMarker();},clearCanvas:function K(){if(D){this.context.clearRect(0,0,this.width,this.height);this.context.beginPath();}else{var L=document.getElementById("vmlCanvas");if(L&&L.hasChildNodes()){while(L.childNodes.length>=1){L.removeChild(L.firstChild);}this.createVMLCanvasFrame();}}},clearHighLightCanvas:function(){if(D){this.highlight.clearRect(0,0,this.width,this.height);this.highlight.beginPath();}},drawMarker:function(){if(D){this.clearHighLightCanvas();if(!this.model.selLink){return ;}var P=this.model;var O=P.joinsInfo[P.selLink[0]].links[P.selLink[1]].marker,M=this.highlight;for(var N=0,L=O.length;N<L;N++){M.strokeStyle="blue";M.beginPath();M.arc(O[N].x,O[N].y,3,0,Math.PI*2,true);M.closePath();M.stroke();}}},drawLine:function C(N,P,M,O){if(D){this.context=this.canvas.getContext("2d");this.context.moveTo(N,P);this.context.lineTo(M,O);}else{var L=document.createElement("v:line");L.setAttribute("from",N+" "+P);L.setAttribute("to",M+" "+O);document.getElementById("vmlCanvas").appendChild(L);}},createVMLCanvasFrame:function J(){var L=document.createElement("v:rect");L.setAttribute("id","vmlFrame");L.setAttribute("stroke","true");L.setAttribute("strokecolor","red");L.style.width=this.width;L.style.height=this.height;L.style.zindex="-1";document.getElementById("vmlCanvas").appendChild(L);},createVMLCanvas:function E(){var N=parseInt(this.width);var M=parseInt(this.height);var L=document.createElement("v:group");L.setAttribute("id","vmlCanvas");L.style.width=this.width;L.style.height=this.height;L.setAttribute("coordorigin","0, 0");L.setAttribute("coordsize",N+", "+M);this.domNode.appendChild(L);this.createVMLCanvasFrame();return ;},renderTooltip:function B(O,R,Q,S){var L=this.model.gts;if(S>=0){var N=L.row[0].n+": "+O;var M;for(M=0,len=L.col[0].es.length;L&&L.col&&M<len;M++){var T=this.model.gvs.items[S].items[M];var P=T.v;if(T.ty==4){P='<img src="'+P+'" >';}N+="<br>"+L.col[0].es[M].n+": "+P;}this.tooltip.innerHTML=N;}if(R+this.tooltip.offsetWidth>this.width){R=R-this.tooltip.offsetWidth;}this.tooltip.style.webkitTransform="translate3d("+R+"px, "+Q+"px, 0)";this.tooltip.style.MozTransform="translate("+R+"px, "+Q+"px)";if(this.tooltip.className.indexOf("fadeIn")<0){this.tooltip.className=this.tooltip.className+" fadeIn";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});},ENUM_STATES:{UNDETERMINED:F,VALID:E,INVALID:D}}));}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.LegacySuggestionList");mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function J(E){var q=E.ownerDocument,r=q.createElement("span");return r;}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));var I=mstrmojo.dom,K=mstrmojo.css,h=mstrmojo.Enum_Keys,C=mstrmojo.range,S=C.EDGE,b=mstrmojo.ME.MetricToken.isDelimiter,H=mstrmojo.expr;function l(q){var E=(I.isIE&&!I.isIE9)?q.keyCode:q.charCode;return(E>0)?String.fromCharCode(E):null;}mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",makeObservable:true,showDesc:true,showPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "document.oncontextmenu =  mstrmojo.all.{@id}.fnContextMenu;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.LegacySuggestionList",items:null,itemFunction:function D(r,E,q){return new mstrmojo.ME.MetricToken({data:r});},listMapper:mstrmojo.ME.SpanListMapper,isDelimiter:b,postBuildRendering:function O(){if(this._super){this._super();}if(I.isFF){document.body.spellCheck=false;}},fnContextMenu:function F(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},handlekeydown:function M(AA){AA=AA||window.event;var E=AA.keyCode||AA.charCode,q=false,y=C.getRangeInfo();if(AA.ctrlKey&&this.doubleByte){this.doubleByte=false;var z=this.prev_rInfo,x=y;s=x.startContainer.data.slice(z.startOffset,y.startOffset);this.widgetHandleImeInput(z,s);return ;}switch(E){case h.DELETE:if(!this.doubleByte){try{this.widgetHandleDelete(y);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(u){}q=true;}break;case h.BACKSPACE:if(!this.doubleByte){try{this.widgetHandleBackspace(y);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(t){}q=true;}break;case h.ENTER:case h.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}q=true;break;case h.ESCAPE:this.endTokenSuggestion();q=true;break;case 86:if(AA.ctrlKey){this._saveRangeInfo=C.getRangeInfo();this.clipboardNode.focus();q=false;}break;case 229:if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=y;this.prev_items=this.items;}break;default:}if(q){I.stopPropogation(window,AA);I.preventDefault(window,AA);return false;}else{return true;}},handlekeypress:function A(x){x=x||window.event;var y=l(x),E=x.keyCode||x.charCode,r=false,t;if(y&&!(y==="c"&&x.ctrlKey)){try{this.widgetHandleInput(C.getRangeInfo(),y);this.raiseChangeEvent({type:"input",characeter:y});if(!this.isDelimiter(y)){if(this.useKeyDelay){var u=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){u.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion();}}catch(q){}r=true;}if(r){I.stopPropogation(window,x);I.preventDefault(window,x);return false;}else{return true;}},handlekeyup:function P(r){var E=r.keyCode||r.charCode,q;if(E===h.LEFT_ARROW||E===h.RIGHT_ARROW){q=this.findObjectToken();if(q&&q===this._saveActiveToken){this.startTokenSuggestion(q);}else{this.endTokenSuggestion();}}else{if(E===h.UP_ARROW){this.preHighlight();}else{if(E===h.DOWN_ARROW){this.nextHighlight();}}}this._saveRangeInfo=C.getRangeInfo();},handlemouseup:function V(y){var q=this.findObjectToken();if(q&&q===this._saveActiveToken){this.startTokenSuggestion(q);}else{this.endTokenSuggestion();}var u=C.getRangeInfo();if(this.doubleByte){var x=this.prev_rInfo,t=this._saveRangeInfo;s=t.startContainer.data.slice(x.startOffset,t.startOffset);if(s!==""){var E=this.widgetHandleImeInput(x,s);this.prev_items=this.items;var q=I.findWidget(u.startContainer);if(q){this._delaySetTextCaretPos(q.domNode,u.startOffset);}else{this._delaySetTextCaretPos(E.domNode,u.startOffset-1);}}this.prev_rInfo=u;}this._saveRangeInfo=u;},handlepaste:function T(y){var q=this.clipboardNode.value;this.clipboardNode.value="";var x=[],E=q&&q.length,u,r="",z;if(E>0){for(u=0;u<E;u++){z=q.charAt(u);if(this.isDelimiter(z)){if(!mstrmojo.string.isEmpty(r)){x.push({v:r,isNew:true});r="";}x.push({v:z,isDelimiter:true,isNew:true});}else{r=r+z;}}if(!mstrmojo.string.isEmpty(r)){x.push({v:r,isNew:true});r="";}this.insertTokens(x);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function p(){var E=[],r=this.items,q;for(q=0,len=r.length;q<len;q++){E[q]=r[q].v;}return E.join("| ");},replaceErrorToken:function W(r){var q=this.items,t=mstrmojo.array.find(q,"sta",-1),E={v:r.n,oi:r,isNew:true};if(t>-1){this.remove(t);this.add([E],t);}},widgetHandleDelete:function Q(u){if(u.collapsed){var t,r,E,x=u.startOffset,q=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,u.startContainer,false,document.body)){C.collapseOnNode(this.editNode,false);return ;}t=C.getEdgeInfo(u.startContainer,u.startOffset);r=I.findWidget(u.startContainer);E=this.itemIndex(r.data);if(t===S.EDGE_END){E++;r=q[E];x=0;}if(!r){C.collapseOnNode(this.editNode,false);return ;}if(r.length()===1){this.remove(E);r=q[E];if(r){C.collapseOnNode(r.domNode,true);}else{C.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{r.spliceContent(x,1);C.collapseOnTextNode(r.domNode,x);}}else{this.widgetDeleteTokens(u);}},widgetHandleBackspace:function a(u){if(u.collapsed){var t,r,E,x=u.startOffset,q=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,u.startContainer,false,document.body)){if(u.startOffset>0&&I.isFF){r=q[this.items.length-1];C.collapseOnNode(r.domNode,false);u=C.getRangeInfo();t=C.getEdgeInfo(u.startContainer,u.startOffset);}else{C.collapseOnNode(this.editNode,true);return ;}}t=C.getEdgeInfo(u.startContainer,u.startOffset);r=I.findWidget(u.startContainer);E=this.itemIndex(r.data);if(t===S.EDGE_BEGIN){E--;r=q[E];x=r.length();}if(!r){C.collapseOnNode(this.editNode,true);return ;}if(r.length()===1){this.remove(E);r=q[E-1];if(r){C.collapseOnNode(r.domNode,false);this.checkMergeTwoTokens(E-1,E);r=q[E-1];}else{C.collapseOnNode(this.editNode,true);}}else{r.spliceContent(x-1,1);C.collapseOnTextNode(r.domNode,x-1);}}else{this.widgetDeleteTokens(u);}},widgetHandleInput:function c(y,z){if(!y.collapsed){this.widgetDeleteTokens(y);y=C.getRangeInfo();}var r,AA,AB,AC,E,q,u=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,y.startContainer,false,document.body)){this.add([{v:z,isDelimiter:this.isDelimiter(z),isNew:true}],0);AA=u[0];C.collapseOnTextNode(AA.domNode,1);return ;}r=C.getEdgeInfo(y.startContainer,y.startOffset);AA=I.findWidget(y.startContainer);AB=this.itemIndex(AA.data);if(this.isDelimiter(z)){AC={v:z,isDelimiter:true,isNew:true};if(r===S.EDGE_MIDDLE){var x=AA.split2Tokens(y.startOffset);this.remove(AB);this.add([x[0],AC,x[1]],AB);AB=AB+1;}else{AB=(r===S.EDGE_BEGIN)?AB:AB+1;this.add([AC],AB);}AA=u[AB];C.collapseOnNode(AA.domNode,false);}else{q=y.startOffset;if(AA.isDelimiter()){E=u[(r===S.EDGE_BEGIN)?AB-1:AB+1];if(E&&!E.isDelimiter()){AA=E;q=(r===S.EDGE_BEGIN)?AA.length():0;}}if(!AA.isDelimiter()){AA.spliceContent(q,0,z);C.collapseOnTextNode(AA.domNode,q+1);}else{this.add([{v:z,isNew:true}],(r===S.EDGE_BEGIN)?AB:AB+1);AA=u[(r===S.EDGE_BEGIN)?AB:AB+1];C.collapseOnNode(AA.domNode,false);}}},widgetHandleImeInput:function c(x,y){if(!x.collapsed){this.widgetDeleteTokens(x);x=C.getRangeInfo();}var r,z,AA,AB,E,q,u=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,x.startContainer,false,document.body)){this.clearTokens();this.add([{v:y,isDelimiter:this.isDelimiter(y),isNew:true}],0);u=this.ctxtBuilder.itemWidgets;z=u[0];C.collapseOnTextNode(z.domNode,1);this._delaySetCaretPos(z.domNode,false);return ;}r=C.getEdgeInfo(x.startContainer,x.startOffset);z=I.findWidget(x.startContainer);AA=this.itemIndex(z.data);q=x.startOffset;if(z.isDelimiter()){this.clearTokens();this.set("items",this.prev_items);u=this.ctxtBuilder.itemWidgets;E=u[(r===S.EDGE_BEGIN)?AA-1:AA+1];if(E&&!E.isDelimiter()){z=E;q=(r===S.EDGE_BEGIN)?z.length():0;}}if(!z.isDelimiter()){z.spliceContent(q,0,y);this._delaySetTextCaretPos(z.domNode,q+y.length);}else{this.add([{v:y,isNew:true}],(r===S.EDGE_BEGIN)?AA:AA+1);z=u[(r===S.EDGE_BEGIN)?AA:AA+1];this._delaySetCaretPos(z.domNode,false);}this.startTokenSuggestion();return z;},findObjectToken:function B(){var u=C.getRangeInfo(),r=I.findWidget(u.startContainer);if(!I.contains(this.editNode,u.startContainer,false,document.body)){return null;}if(!r||r===this||!r.isDelimiter){return null;}if(r&&!r.isDelimiter()){return r;}var t=C.getEdgeInfo(u.startContainer,u.startOffset),q=this.ctxtBuilder.itemWidgets,E=this.itemIndex(r.data);r=q[(t===S.EDGE_BEGIN)?E-1:E+1];if(r&&!r.isDelimiter()){return r;}return null;},checkMergeTwoTokens:function Y(u,r){var t=this.ctxtBuilder.itemWidgets,q=t[u],E=t[r];if((q&&!q.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([u,r]);this.add([q.mergeTo(E)],u);C.collapseOnTextNode(t[u].domNode,q.length());}},insertTokens:function f(x){var u=this._saveRangeInfo;if(!u||!I.contains(this.editNode,u.startContainer,false,document.body)){this.add(x);this.raiseChangeEvent({type:"insert"});return ;}var t=C.getEdgeInfo(u.startContainer,u.startOffset),q=I.findWidget(u.startContainer),E=this.itemIndex(q.data);if(t===S.EDGE_MIDDLE){var r=q.split2Tokens(u.startOffset);this.remove(E);x.unshift(r[0]);x.push(r[1]);this.add(x,E);}else{E=(t===S.EDGE_BEGIN?E:E+1);this.add(x,E);}E=E+x.length-1;q=this.ctxtBuilder.itemWidgets[E];this._delaySetCaretPos(q.domNode,false);this.raiseChangeEvent({type:"insert"});},clearTokens:function X(E){this.set("items",E||[]);this._saveRangeInfo=null;this._delaySetCaretPos(this.editNode,false);},focus:function d(){var q=this.ctxtBuilder.itemWidgets,E=q.length;this._delaySetCaretPos(E>0?q[E-1].domNode:this.editNode,false);},startTokenSuggestion:function k(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length==0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[H.TP.FOLDER,H.TP.FACT,H.TP.ATTR,H.TP.FUNCTION,H.TP.FILTER,H.STP.PROMPT_OBJECTS,H.TP.ATTR,H.TP.DIM,H.TP.METRIC,H.TP.ROLE].join(","),getSearchPattern:function L(){var q=this._saveActiveToken,r=q&&q.data.v,E=r&&r.length;if(E>2){if(r.charAt(0)==="["){r=r.substring(1);}if(r.charAt(r.length-1)==="]"){r=r.substring(0,r.length-1);}}return r||"";},getSuggestionPos:function R(){var E=this._saveActiveToken,q=null,r;if(E){r=mstrmojo.dom.position(E.domNode,true);q={left:Math.round(r.x)+"px",top:Math.round(r.y+r.h)+"px",zIndex:100};}return q;},item2textCss:function G(E){return(this._super&&this._super(E))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr","-99":"br"}[E.t]||"";},onBrowserOpen:function Z(){this.editNode.blur();},onSuggestionItemSelect:function g(q){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){E.setItemInfo(q);this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function n(E,r){var q=this.editNode,t=function(){q.focus();q.focus();C.collapseOnNode(E,r);};window.setTimeout(t,0);},_delaySetTextCaretPos:function n(E,t){var q=this.editNode,r=function(){q.focus();q.focus();C.collapseOnTextNode(E,t);};window.setTimeout(r,0);},getCandidatesThroughTaskCall:function N(q,E){q.objectType="11,12,13,43,4";q.rootFolderType=39;q.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(q,E);},endTokenSuggestion:function o(){var E=this._saveActiveToken;if(E){E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function U(AB){var q=AB.startOffset,E=AB.endOffset,AE=I.findWidget(AB.startContainer),AC=I.findWidget(AB.endContainer),x=this.itemIndex(AE.data),t=this.itemIndex(AC.data),y=[],z=C.getEdgeInfo(AB.startContainer,q),AD=C.getEdgeInfo(AB.endContainer,E),AA=(z===S.EDGE_BEGIN?x:x+1),r=(AD===S.EDGE_END?t:t-1),u;if(AE===AC){if((z===S.EDGE_BEGIN)&&(AD===S.EDGE_END)){this.remove(x);AC=this.ctxtBuilder.itemWidgets[x-1];if(AC){C.collapseOnNode(AC.domNode,false);}else{C.collapseOnNode(this.editNode,true);}}else{AE.spliceContent(q,E-q);C.collapseOnTextNode(AC.domNode,q);}}else{for(u=AA;u<=r;u++){y.push(u);}this.remove(y);if(z===S.EDGE_MIDDLE){AE.spliceContent(q);}if(AD===S.EDGE_MIDDLE){AC.spliceContent(0,E);}if(z===S.EDGE_BEGIN){AE=this.ctxtBuilder.itemWidgets[x-1];}if(AE){C.collapseOnNode(AE.domNode,false);}else{C.collapseOnNode(this.editNode,false);}x=(z===S.EDGE_BEGIN)?x-1:x;this.checkMergeTwoTokens(x,x+1);}this.editNode.focus();}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st];},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc());}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){this.getContent(this);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new mstrmojo.TreeBrowserNode({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}else{var J=this.selectionParentNode;return J&&J.getSelectedItems();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetTree","mstrmojo.expr","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var F=mstrmojo.expr,C=F.ET,B={};B[C.ANDOR]=mstrmojo.AndOrNode;B["*"]=mstrmojo.ConditionNode;function A(G){var I=G&&G.src,J=I&&I.data,H=J&&J.et;return(H in F.ETs);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.FilterExpr",allowDrop:A,renderOnScroll:false,itemIdField:null,itemFunction:function(L,H,M){var J=(L.et===C.ANDOR),K=M.tree||M,I={data:L,tree:K,parent:M,itemFunction:J?M.itemFunction:null,draggable:J?K.draggable:false,dropZone:J?K.dropZone:false,allowDrop:J&&K.dropZone?K.allowDrop:null,allowCopy:J?K.allowCopy:false,editable:K.isEditable?K.isEditable(L):K.editable,makeObservable:J&&M.makeObservable,onclick:K.onnodeclick,onadd:K.onnodeadd,onremove:K.onnoderemove},G=B[L.et]||B["*"];return G&&(new G(I));},getDragData:function(G){var I=this._super(G);if(I&&!I.html){var H=I.et&&F.ET2TGT[I.et];I.html=H?I[H]&&I[H].n||"":I.n||"";}return I;},newCondition:function E(K){K=K||{et:C.AQ};var J=this.selectionParentNode||this,G;if(J!==this){G=J.add([K]);}else{var I=this.addCondition([K],null,true);G=I.index;J=I.widget;}var H={widget:J,index:G,data:K};if(this.onNew){this.onNew(H);}return H;},addCondition:function D(I,K){var L=this.items,H=L&&L.length,N=I&&I.length;if(!N){return null;}var J,G;if(H&&L[0].et===C.ANDOR){J=this.ctxtBuilder.itemWidgets[0];G=J.add(I,null);}else{if(!H&&(N===1)){J=this;G=0;this.add(I,0);}else{if(H){var M=L[0];this.remove(M);I.unshift(M);}this.add([{et:C.ANDOR,fn:F.FN.AND,nds:I}],0);J=this.ctxtBuilder.itemWidgets[0];G=H?1:0;}}return{widget:J,index:G};},ondrop:function(J){if(this._super){this._super(J);}var H=this.items,G=H&&H.length,I=H.concat();if(G>1){this.set("items",null);this.add([{et:C.ANDOR,fn:F.FN.AND,nds:I}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch");var A=mstrmojo.meta.TP,K="5CECE58CC1D549F890EB61C4DB2156A3",H="E0CCB9CF22104A489CBE78D974AFD19E",B=function(R,S){var Q=mstrmojo.insert({scriptClass:"mstrmojo.OBList",items:S});Q.render();return Q;},D={success:function(S){var T=this.ob,R=S.items,Q=T.pageCache[T.currentPage]._w;Q.set("items",R);this.ob=null;this.item=null;window.clearTimeout(T._btm);T.booklet.set("waiting",false);},failure:function(Q){window.alert(Q.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},C=function(T,S,Q){var U=O(T,S,false),R=!U;U=U||O(T,S,true);if(!U){T._btm=window.setTimeout(function(){T.booklet.set("waiting",true);},300);Q.ob=T;Q.item=S;T.dataProvider.fetchFolderContents(T,S,Q);}else{G(T,S,U,true,R);}},N=function(R,S,T,Q){C(R,{fid:R.pageCache[R.currentPage].did,blockBegin:S,searchPattern:T,recursive:Q},D);},I=function(R,S){var Q=S.anc;Q=Q&&Q.items;Q=Q&&Q[0];Q=Q&&Q.items;R.set("canGoUp",!(!S.pf||!Q));},G=function(U,T,V,S,R){delete U._btm;var Q;if(!S){Q=B(this,V.items);Q.attachEventListener("change",U.id,"navigate");}else{Q=V._w;}U.booklet.turn(Q,!R);if(!S){E(U,T,Q,V);}U.set("currentFolder",V);U.set("currentPage",U.currentPage+(R?-1:1));I(U,V);},F={success:function(R){var S=this.ob;if(S){window.clearTimeout(S._btm);if(!R.items){R.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var Q=function T(U){var X=U.length;for(var V=0;V<X;V++){var W=U[V];if(W.did===K||W.did===H){W.n=(W.did===K)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(W.items){Q(W.items);}}};if(R.did===K||R.did===H){R.n=(R.did===K)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(R.anc&&R.anc.items){Q(R.anc.items);}}G(S,this.item,R,false,false);this.ob=null;this.item=null;}},failure:function(Q){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(Q);}else{window.alert(Q.getResponseHeader("X-MSTR-TaskFailureMsg"));}}},E=function(U,T,S,V){var W=U.currentPage+1;var R=U.pageCache.length;for(var Q=W;Q<R;Q++){U.pageCache[Q]._w.destroy();delete U.pageCache[Q].items;}U.pageCache=U.pageCache.slice(0,W);V._w=S;V._k=T.k;U.pageCache[W]=V;U.cacheChange();},O=function(T,S,R){var U=T.currentPage+(R?-1:1);if(T.pageCache.length>U&&U>=0){var Q=T.pageCache[U];if(Q._k==S.k){return Q;}}return false;},M=function(S){var R=S.pageCache.length;for(var Q=0;Q<R;Q++){S.pageCache[Q]._w.destroy();}S.pageCache=[];S.currentPage=-1;S.cacheChange();},J=function(S,R){if(R&&R.acg==33){return ;}var Q={};if(R){Q.k=R.did;Q.fid=R.did;}else{if(S.rootFolderID){Q.k=S.rootFolderID;Q.fid=S.rootFolderID;}else{if(S.rootFolderType){Q.k=S.rootFolderType;Q.fty=S.rootFolderType;}else{if(S.folderLinksContextId){Q.k=S.folderLinksContextId;}}}}C(S,Q,F);},P=function(V,Q,S){if(!S){return Q;}var T=V.showCompletePath,X=Q[0],U,R;while(X){for(var W=0;W<S.length;){if(X.did==S[W].did){S.splice(W,1);X._isSc=true;}else{W++;}}R=X;X._open=true;X=X.items;X=X&&X[0];if(!X){R.lastLeaf=true;}}if(!T){X=Q[0];while(X){if(X._isSc){Q[0]=X;break;}X=X.items;X=X&&X[0];}}return Q.concat(S);},L=function(R,Q,S){R._naviInfo=P(R,Q,S);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,showCompletePath:true,dataProvider:mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"}),markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var Q=this.opener.parent.parent,S=this.tree,R=Q._naviInfo;if(S.items!=R){S._pup=this;this.ob=Q;S.set("items",R);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(T,Q,R){var S=mstrmojo.WidgetTree.prototype.itemFunction(T,Q,R);if(T._open){S.state=1;}S._ll=!!T.lastLeaf;S._pup=R._pup;S.onmousedown=function(U){if(!this._ll){var V=mstrmojo.dom.eventTarget(U.hWin,U.e);if(V==this.domNode||V==this.textNode){var W=this._pup;W.close();J(W.ob,this.data);}}};S.markupMethods.onstateChange=function(){var U=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[U]||"closed");this.itemsContainerNode.style.display=(U===1)?"block":"none";};return S;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up one level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 5px 0; ",width:"105px",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,bindings:{quickSearch:"this.parent.parent.quickSearch"},preFetch:function(){this.objectTypes=(this.parent.parent.browsableTypes)?this.parent.parent.browsableTypes:this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssText:"width:100%;background-color:white;",alias:"booklet"},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046),p:mstrmojo.desc(1058),n:mstrmojo.desc(1059),l:mstrmojo.desc(4049),pgs:mstrmojo.desc(5972),gt:mstrmojo.desc(5878),v:mstrmojo.desc(6079)},onvisibleChange:function(R){var T=parseInt(this.height,10),Q=this.np>1,S={target:this.domNode,props:{height:{start:(Q?0:T),stop:(Q?T:0),suffix:"px"}},onEnd:function(){if(Q){this.target.style.overflow="visible";}}},U=new mstrmojo.fx.AnimateProp(S);this.domNode.style.overflow="hidden";U.play();},onifsChange:function(Q){var R=this.np;mstrmojo.hash.copy(Q.value,this);if(this.np>1){this.children=null;this.refresh();}if(R<=1&&this.np>1||R>1&&this.np<=1||R===0&&this.np>0){this.set("visible",this.np>1);}this.cssText="";}}],postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var S=this.searchUpBar;if(S&&S.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var Q=this.obSearchBox.contentWidget||this.obSearchBox;Q.attachEventListener("ifsChange",this.id,function(T){this.obIncFetch.set("ifs",T.value);});}if(this.obIncFetch){var R=this.obIncFetch;R.attachEventListener("fetch",this.id,function(T){R.cp=T.v;R.children=null;R.refresh();N(this,(T.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}},onSearchItemsChange:function(R){var S=R.value,Q=this.pageCache[this.currentPage]._w;if(!S||S.length==0){S=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}Q.set("items",S);},navigate:function(Q){var R=Q&&Q.src.selectedItem;if(R&&R.did=="empty"){return ;}if(!R||R[A]==8){J(this,R);}else{if(R){this.select(R);}}},onFishEyeChange:function(Q){this.goToPage(Q.value);},goToPage:function(Q){if(Q<this.pageCache.length&&Q!=this.currentPage){var S=Q>this.currentPage,R=this.pageCache[Q];this.set("currentPage",Q);this.booklet.turn(R._w,S);this.set("currentFolder",R);I(this,R);}},oncurrentPageChange:function(Q){if(this.fishEye){this.fishEye.setSelectedIndex(Q.value);}var R=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(R.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",R.items||[]);this.obSearchBox.set("totalSize",R.sz);this.obSearchBox.set("rootID",R.did);this.obSearchBox.clearSearch();}if(this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(R.sz/R.bc)+((R.sz%R.bc>0)?1:0),cp:Math.floor(R.bb/R.bc)+((R.bb%R.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(R){for(var Q in R){this[Q]=R[Q];}if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}M(this);this.navigate();},close:function(){var R=this.ctx||this,Q=R.onCloseCB;if(Q){Q[0][Q[1]]();}R.set("visible",false);},select:function(R){var Q=this.onSelectCB;if(Q){Q[0][Q[1]](R);}if(this.closeOnSelect){this.close();}},goUp:function(){if(this.canGoUp){J(this,{did:this.currentFolder.pf});}},oncurrentFolderChange:function(Q){var R=Q.value;L(this,R.anc.items,R.sc);},refreshContent:function(Q){N(this,Q);},onError:null,onheightChange:function(){var Q=["titleBar","fishEye","searchUpBar","obIncFetch"],T=0,S=0;for(var R in Q){T+=parseInt(this[Q[R]].domNode.offsetHeight);}S=parseInt(this.height)-T;this.booklet.set("height",S+"px");}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.hash","mstrmojo.Button","mstrmojo.MenuButton");var F="mstrmojo-qb-footerIcon",A="cancel",E="publish",B=" ";function D(H){return mstrmojo.hash.copy(H,{scriptClass:"mstrmojo.Button",onclick:function G(){if(this.cmd){mstrApp.getRootController()[this.cmd]();}}});}mstrmojo.qb.Footer=mstrmojo.declare(mstrmojo.Box,null,{hidePublish:function C(){this.publish.set("visible",false);},children:[D({cmd:"publish",iconClass:[F,E].join(B),text:mstrmojo.desc(212,"Continue"),alias:"publish"}),D({cmd:"cancel",iconClass:[F,A].join(B),text:mstrmojo.desc(2140,"Cancel")})]});}());(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Table","mstrmojo.Editor","mstrmojo.WH.DBRoleSetting","mstrmojo.WH.DBRoleDSNConnection","mstrmojo.WH.DBRoleSettingPulldown","mstrmojo.WH.Password");mstrmojo.requiresDescs(221,1162,1442,1834,8512,8513,8514);function A(H){var I=new String("");I=H.toString();if(!I){return"";}return I.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}function G(K,J){var H=A(J.txtname.text);if(H==""){mstrmojo.alert(mstrmojo.desc(10068,"The Database Connection Name cannot be empty."));return false;}if(H.indexOf("\\")!=-1){mstrmojo.alert("Invalid Character found in name \\");return false;}if(H.indexOf("[")!=-1){mstrmojo.alert("Invalid Character found in name [");return false;}if(H.indexOf("]")!=-1){mstrmojo.alert("Invalid Character found in name ]");return false;}if(A(J.txtlogin.text)==""){mstrmojo.alert(mstrmojo.desc(10069,"The User field cannot be empty."));return false;}if(J.dsninfo.selectlist.selectedID===0){var I=J.dsninfo.tbl.contents.dsnlist.selectedItem;if(!I){mstrmojo.alert(mstrmojo.desc(10070,"Please select a DSN first"));return false;}if(I.des=="0"){mstrmojo.alert(mstrmojo.desc(10070,"Please select a DSN first"));return false;}}return true;}function C(I,H){H.dsninfo.dbmslist.set("items",I.dbms);}function E(I){var H=I.dbrole;var K=H.connstr;if(!K){if(mstrApp.isCloud){I.dsnSelector.WHDSNLESS.onclick();}else{I.dsnSelector.WHDSNLESS.onclick();}}else{var L=(K.split("=")[0]).toUpperCase();if(L=="DSN"){I.dsnSelector.WHDSN.onclick();}else{I.dsnSelector.WHDSNLESS.onclick();}}if(parseInt(H.shared,10)===1){I.sharedConnection.checked=true;I.sharedConnection.refresh();}var J=I.dsninfo;if(H&&!H.des){H.des=H.n;}H.des=(!mstrApp.isCloud)?H.n:H.des;H.ln=(H.ln==null)?"":H.ln+"";I.txtlogin.set("text",(H.ln==null)?"":H.ln);H.password=(H.password==null)?"":H.password+"";I.txtpwd.set("text",(H.password==null)?"":H.password.replace(/&amp;/g,"&"));I.txtname.set("text",(H.n==null)?"":H.des);if(K){J.set("info",H);}else{J.info=H;}J.dbmslistDSN.set("selectedID",H.dbms);}function D(I,H){var J=(!I.useDSN)?I.dsninfo.dbmslist.selectedItem:I.dsninfo.dbmslistDSN.selectedItem;if(!J){J=I.dsninfo.dbmslistDSN.selectedItem;}if(mstrApp.isCloud){H.des=I.txtname.text;H.n=H.des+"___"+new Date().getTime();}else{H.n=I.txtname.text;}H.dbms=J.did;H.dbr_type="2";H.owned="1";H.writable="1";H.shared=I.sharedConnection.isChecked()?"1":"0";H.db_type=I.dsninfo.dbtype();H.connstr=I.dsninfo.connstr();I.txtlogin.text=I.txtlogin.text+"";H.ln=I.txtlogin.text;I.txtpwd.text=I.txtpwd.text+"";H.password=I.txtpwd.text;switch(H.db_ver){case I.dsninfo.DbVs.DbVSybaseIQ112:case I.dsninfo.DbVs.DbVSybaseIQ12:case I.dsninfo.DbVs.DbVSybaseIQ127:case I.dsninfo.DbVs.DbVSybaseIQ15:case I.dsninfo.DbVs.DbVSybaseIQ151:case I.dsninfo.DbVs.DbVSybaseIQ152:H.cefu="0";break;default:H.cefu="1";break;}if(H.db_type==I.dsninfo.DbTs.DbTHive){H.odbcv="20";}}function B(I){var H=I.dbrole;D(I,H);var J={taskId:"arch.saveDBRole",sessionState:I.sessionState,dbroleinfo:JSON.stringify(H)};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,{success:function(K){I.callback.success(I.id);I.close();},failure:function(K){var L=K&&K.getResponseHeader("X-MSTR-TaskErrorCode");L=(L<0)?(4294967296+parseInt(L,10)):L;switch(L){case 2147749923:mstrmojo.alert(mstrmojo.desc(10077,"The Database connection with name # is already in use. Please provide a different name").replace("#",H.des));break;default:mstrmojo.alert(K.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2").substring(0,500));I.callback.success(I.id);I.close();}}},J);}mstrmojo.WH.DBRoleEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.WH.DBRoleEditor",zIndex:100,id:"",help:mstrApp.helpTopics&&mstrApp.helpTopics.DBRole,dbrole:null,useDSN:true,cssClass:"mstrmojo-ObjectInfoEditor",sessionState:null,callback:null,postBuildRendering:function(){if(this._super){this._super();}C(this.model,this);},ondragend:function F(H){var M=mstrmojo.all.QBuilderPage;if(M){var I=parseInt(M.width)-parseInt(H.src.node.clientWidth);var L=parseInt(M.height)-parseInt(H.src.node.clientHeight);var J=H.tgt.pos.y;var K=H.tgt.pos.x;if(J<1){this.editorNode.style.top="1px";}if(K<1){this.editorNode.style.left="1px";}if(J>L){this.editorNode.style.top=L+"px";}if(K>I){this.editorNode.style.left=I+"px";}}},onOpen:function(){E(this);},onOK:function(){if(G(this.model,this)){return B(this);}else{return false;}},onCancel:function(){this.callback.cancel(null);},onRender:function(){if(this.containerNode){this.containerNode.style.height="100%";this.containerNode.style.padding="20px 20px 0px 20px";this.txtlogin.tbl.txt.domNode.style.width="320px";this.txtpwd.tbl.txt.domNode.style.width="320px";this.txtname.tbl.txt.domNode.style.width="320px";}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:4,cssClass:"mstrmojo-dbrole-dsnOption cf",alias:"dsnSelector",layout:[{cells:[{cssText:"width:0%;"},{cssText:"width:50%;"},{cssText:"width:40%;"},{cssText:"width:10%;"}]}],children:[{scriptClass:"mstrmojo.Label",markupString:'<div class="mstrmojo-radioButton-unselected" mstrAttach:click></div>',cssText:"padding-left:20px; font-weight:bold;",text:mstrmojo.desc(10066,"DSNless Connections"),visible:!mstrApp.isCloud,slot:"0,1",alias:"WHDSNLESS",onclick:function(){this.parent.parent.useDSN=false;mstrmojo.css.removeClass(this.domNode,"mstrmojo-radioButton-unselected");mstrmojo.css.addClass(this.domNode,"mstrmojo-radioButton-selected");mstrmojo.css.removeClass(this.parent.WHDSN.domNode,"mstrmojo-radioButton-selected");mstrmojo.css.addClass(this.parent.WHDSN.domNode,"mstrmojo-radioButton-unselected");this.parent.parent.dsninfo.addSelectList();}},{scriptClass:"mstrmojo.Label",markupString:'<div class="mstrmojo-radioButton-unselected" mstrAttach:click></div>',cssText:"padding-left:20px; font-weight:bold;",text:mstrmojo.desc(10067,"DSN Connections"),visible:!mstrApp.isCloud,slot:"0,2",alias:"WHDSN",onclick:function(){this.parent.parent.useDSN=true;mstrmojo.css.removeClass(this.domNode,"mstrmojo-radioButton-unselected");mstrmojo.css.addClass(this.domNode,"mstrmojo-radioButton-selected");mstrmojo.css.removeClass(this.parent.WHDSNLESS.domNode,"mstrmojo-radioButton-selected");mstrmojo.css.addClass(this.parent.WHDSNLESS.domNode,"mstrmojo-radioButton-unselected");this.parent.parent.dsninfo.useDSN();}}]},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-dbconnection-label",alias:"conninfo",text:mstrmojo.desc(1834,"Connection Information")},{scriptClass:"mstrmojo.WH.DBRoleDSNConnection",alias:"dsninfo"},{scriptClass:"mstrmojo.WH.DBRoleSetting",alias:"txtlogin",caption:mstrmojo.desc(8513,"login:")},{scriptClass:"mstrmojo.WH.Password",alias:"txtpwd",caption:mstrmojo.desc(1162,"password:"),isPassword:true},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-wh-connectionname-label",alias:"nameinfo",text:mstrmojo.desc(8514,"name the connection")},{scriptClass:"mstrmojo.WH.DBRoleSetting",alias:"txtname",caption:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.Label",cssText:"font-weight:bold; width:100%; padding:4px 0px;",text:""},{scriptClass:"mstrmojo.CheckBox",cssText:"width:100%;",cssClass:"mstrmojo-wh-shareconnection",alias:"sharedConnection",visible:!mstrApp.isCloud,label:mstrmojo.desc(10071,"Share this connection with everybody")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-architect-Editor-buttonBox",slot:"buttonNode",cssText:"float:right;background:transparent;height:45px;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-architect-OKButton",text:mstrmojo.desc(1442,"OK"),onclick:function(H){var J=this.parent.parent;var I=true;if(J.onOK){I=J.onOK();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-architect-CancelButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(H){var I=this.parent.parent;if(I.onCancel){I.onCancel();}I.close();}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.MenuButton","mstrmojo.dom","mstrmojo.WH.DBRoleEditor","mstrmojo.WH.WHNameEditor");mstrmojo.requiresDescs(1462,8510,629,1088,8515,637,9104,219,8676);var H=mstrmojo.dom;var g="position:absolute; visibility:hidden;";var Y="position:absolute; visibility:visible;";var c=0;var b;var L=[{did:"Edit",n:mstrmojo.desc(9253,"Edit")},{did:"Delete",n:mstrmojo.desc(3398,"Delete")},{did:"Rename",n:mstrmojo.desc(1388,"Rename")},{did:"Duplicate",n:mstrmojo.desc(3397,"Duplicate")},{did:"Set_as_Primary",n:"Set as Primary"}];var C,R,Z,O,W,Q;function I(k){mstrmojo.alert(k.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2").substring(0,500));}var a=new mstrmojo.WH.WHNameEditor({onOK:function(l){var k=this.dbr,r={success:function(n){b.loadDBRoles();h();o.close();},failure:function(n){}},q="",p="",o=this;p=this.txtbox.value;if(!mstrApp.isCloud){q=E(p);if(q!=p){mstrmojo.alert("The Database connection with name  "+p+" is already in use. Please provide a different name");}else{k.n=p;G(k,r);}}else{k.des=p;G(k,r);}},onOpen:function(){var k=(mstrApp.isCloud)?this.dbr.des:this.dbr.n;this.nn="";this.txtbox.set("value",k);this.error.set("text","");this.txtbox.domNode.focus();this.txtbox.domNode.select();this.set("title",mstrmojo.desc(11127,"Database Connection")+" "+k);}});var U=new mstrmojo.List({alias:"dbrlist",cssClass:"mstrmojo-dbconnectionList",itemMarkupFunction:function(k,o,p){var l=mstrApp.isCloud?k.des+"":k.n+"",n=(parseInt(k.shared,10)===1)?" shared":"";l=trim(l);return'<div class="mstrmojo-qb-DBRoleItem mstrmojo-DBRoleSelector-bullet" di='+o+' ><div class="DbrIcon mstrmojo-ArchitectListIconBlock t'+k.tp+n+'" di='+o+'></div><div class="DbrTxt" >'+l+'</div><div class="DelDbr mstrmojo-ArchitectListIcon div" btn="delbtn"></div></div>';},onitemsChange:function V(k){if(U.selectedIndex>=0){for(var l=0;l<U.items.length;l++){var n=U.items[l];if(n.did==U.selectedItem.did){U.set("selectedIndex",l);break;}}D(false);}},onRender:function F(){var l=this;_menu_popup=function(n){var o=H.eventTarget(window,n);if(o){if(o.attributes.di){c=parseInt(o.attributes.di.nodeValue,10);}}};if(this.domNode){var k=this.domNode.style;k.width="auto";H.attachEvent(this.domNode,"mousemove",_menu_popup);}},onmouseup:function(k){var n=H.eventTarget(k.hWin,k.e),l=n.className;if(l==="DelDbr mstrmojo-ArchitectListIcon div"||l==="mstrmojo-ListBase2 mstrmojo-dbconnectionList"){return ;}D(true);},onheightChange:function(){if(this.domNode){this.domNode.style.height=parseInt(this.height,10)+"px";}}});function G(l,o){var n={taskId:"arch.saveDBRole",dbroleinfo:JSON.stringify(l)};var k={success:function(p){o.success(p);},failure:function(p){var r=p&&p.getResponseHeader("X-MSTR-TaskErrorCode");r=(r<0)?(4294967296+parseInt(r,10)):r;switch(r){case 2147749923:var q=(mstrApp.isCloud)?l.des:l.n;mstrmojo.alert("The Database connection with name  "+q+" is already in use. Please provide a different name");o.failure(p);break;default:I(p);o.failure(p);}}};if(this.mstrApp.sessionState!==undefined){n.sessionState=this.mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,k,n);}function B(){var k=b.dbrs[c];var l={taskId:"arch.ProjectPrimaryDBRole",dbroleID:k.did};if(this.mstrApp.sessionState!==undefined){l.sessionState=this.mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,{failure:I},l);}function E(p){var n=/\(\d+\)$/;var o=n.exec(p);var t;if(o){t=p.substring(0,o.index);}else{t=p;}var q=0;var k=t;var r=new Array();for(nc=0;nc<b.dbrs.length;nc++){if(mstrApp.isCloud){r[b.dbrs[nc].des]=b.dbrs[nc].des;}else{r[b.dbrs[nc].n]=b.dbrs[nc].n;}}while(r[k]){q++;k=t+"("+q+")";}return k;}function A(k){if(mstrApp.isCloud){k.des=E(k.des);k.n=k.des+"___"+new Date().getTime();}else{k.n=E(k.n);}k.did="";var n={taskId:"arch.saveDBRole",sessionState:this.mstrApp.sessionState,dbroleinfo:JSON.stringify(k)};var l={success:function(o){b.loadDBRoles();h();},failure:I};if(this.mstrApp.sessionState!==undefined){n.sessionState=this.mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,l,n);}function d(){var k=b.dbrs[c];var n={taskId:"getDBInstances",objectID:k.did};var l={success:function(o){A(o.dbrs[0]);},failure:I};if(this.mstrApp.sessionState!==undefined){n.sessionState=this.mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,l,n);}function N(n,p){var l=b.dbrs[n];var o={taskId:"getDBInstances",objectID:l.did};var k={success:function(q){p.success(q.dbrs[0]);},failure:function(q){I(q);p.failure(q);}};if(this.mstrApp.sessionState!==undefined){o.sessionState=this.mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,k,o);}function K(k){var l={success:function(n){T(n);},failure:function(n){}};N(k,l);}function T(l){var n=mstrmojo.all[l.did];if(n){n.destroy();}var k={success:function(o){b.loadDBRoles();h();},cancel:function(o){}};n=new mstrmojo.WH.DBRoleEditor({id:l.did,title:mstrmojo.desc(11127,"Database Connection"),dbrole:l,model:b,sessionState:this.mstrApp.sessionState,callback:k});n.dbrole=l;n.open();}function J(){var k={n:"",des:mstrmojo.desc(8515,"new connection #").replace("#",1),did:"",tp:"29",stp:"7424"};T(k);}function f(){K(c);}function S(){b.loadDBObjects(f);}function P(){var l=b.dbrs[c];var k=mstrmojo.Button.newInteractiveButton;mstrmojo.confirm(mstrmojo.desc(10073,"Are you sure you want to delete the Database Connection")+" "+l.des+"?",[k(mstrmojo.desc(219,"Yes"),function n(){if(l){var p={taskId:"arch.deleteObject",objectid:l.did,objecttype:l.tp};var o={success:function(){b.loadDBRoles();b.set("SelDBRoleID",null);U.clearSelect();h();},failure:function(){mstrmojo.alert(mstrApp.isCloud?"You are not allowed to delete the database connection.":mstrmojo.desc(10074,"The selected database connection can't be de deleted, or you do not have enough privileges to delete it."));}};if(mstrApp.sessionState!==undefined){p.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,o,p);}},null,{iconClass:"mstrmojo-Editor-button-Yes"}),k("No",null,null,{iconClass:"mstrmojo-Editor-button-No"})],"Confirm delete");}function D(l){var o=b;if(U.selectedIndex!=-1){var n=o.dbrs[U.selectedIndex].did;if(!(o.SelDBRoleID==n)){if(o.dbtables.length>0){var k=mstrmojo.desc(10075,"You are switching to another Database Connection. In order to execute the tables that you have already added, they need to be present in this new connection. Do you want to proceed?");mstrmojo.confirm(k,[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(219),function(){o.set("SelDBRoleID",n);},null,{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button",onRender:function(){mstrmojo.css.addClass(this.domNode,"mstrmojo-Editor-button-Yes");}}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(218),function(){var p=mstrmojo.array.find(o.dbrs,"did",o.SelDBRoleID);U.set("selectedIndex",p);},null,{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button",onRender:function(){mstrmojo.css.addClass(this.domNode,"mstrmojo-Editor-button-No");}})],mstrmojo.desc(10076,"Switch to another Database Connection?"));}else{o.set("SelDBRoleID",n);}}else{if(l){o.set("SelDBRoleID",n);}}}}function h(){U.set("items",b.dbrs);if(b.SelDBRoleID){var k=mstrmojo.array.find(b.dbrs,"did",b.SelDBRoleID);U.set("selectedIndex",k);}}var X=new mstrmojo.Button({slot:"0,1",title:mstrmojo.desc(8510,"new db instance"),iconClass:"mstrmojo-ArchitectListIcon addbtn",cssText:"float:right;",onclick:function(k){b.loadDBObjects(J);},onRender:function(k){this.set("visible",(mstrConfig.useDataBaseInstanceManager===1));}});mstrmojo.WH.DBRoleSelector=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.WH.DBRoleSelector",markupString:'<div id="{@id}" class="mstrmojo-qb-DBRoleSelector {@cssClass}" style="{@cssText} position:relative;" mstrAttach:click ></div>',alias:"DBRolSel",DBRMnEdt:true,DBRMnDlt:true,DBRMnRn:true,DBRMnDp:true,DBRMnSPr:false,mnuX:0,mnuY:0,load:function(){h();},postCreate:function(){R=this.DBRMnEdt;Z=this.DBRMnDlt;O=this.DBRMnRn;W=this.DBRMnDp;Q=this.DBRMnSPr;C=R||Z||O||W||Q;},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,cssClass:"mstrmojo-qb-DBRoleSelector-header",layout:[{cells:[{cssText:"padding-left: 5px; padding-right: 5px;"},{cssText:"height: 20px; padding-right:3px;"}]}],children:[{scriptClass:"mstrmojo.Label",slot:"0,0",cssClass:"mstrmojo-qb-DBRoleSelector-header",text:mstrmojo.desc(1462,"Database Connections")},X,]},U],initModel:function(k){b=k;k.attachEventListener("dbroleSelection",this.id,h);},onheightChange:function(k){this.dbrlist.set("height",parseInt(k.value,10)-25+"px");},onwidthChange:function(k){this.dbrlist&&this.dbrlist.domNode&&(this.dbrlist.domNode.style.width="auto");},onclick:function(k){var o=H.eventTarget(k.hWin,k.e);if(!o){return ;}if(o.className==="DelDbr mstrmojo-ArchitectListIcon div"){c=parseInt(o.parentElement.attributes.di.nodeValue);var n=H.position(o),l=H.position(this.domNode);this.mnuX=n.x-l.x;this.mnuY=n.y-l.y+o.clientHeight;this.showContextMenu();}},getMenuPosition:function M(){return{x:this.mnuX,y:this.mnuY};},executeCommand:function(l){c=this.dbrlist.selectedIndex;switch(l.did){case"Edit":b.loadDBObjects(S);break;case"Delete":P();break;case"Rename":var k={success:function(n){a.dbr=n;a.open();},failure:function(n){}};N(c,k);break;case"Duplicate":d();break;case"Set_as_Primary":B();break;}},onRender:function(){var l=new Array();var n;var k=0;for(lc=0;lc<L.length;lc++){n=L[lc];switch(n.did){case"Edit":if(R){l[k]=n;k++;}break;case"Delete":if(Z){l[k]=n;k++;}break;case"Rename":if(O){l[k]=n;k++;}break;case"Duplicate":if(W){l[k]=n;k++;}break;case"Set_as_Primary":if(Q){if(k>0){l[k]={did:-1,n:"-"};k++;}l[k]=n;k++;}break;}}this.cm=l;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser");function B(){var E={alias:"newFolder",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon nf",title:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var F=this.parent.parent.parent;F.openPopup("newFolder",{zIndex:F.zIndex+10});}},D=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);tc=D[0].children;if(tc&&tc.length>2){tc.splice(2,1,E);}return D;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B()});var A={success:function(D){var E=this.parent;if(E.onObjectSaved){E.onObjectSaved({name:E.name,did:D.did,desc:E.desc});}mstrmojo.confirm(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",E.typeDesc||"Object").replace("###",E.name),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(7984,"Object Saved"));E.ob.refreshContent();E.close();},failure:function(E){var D=parseInt(E.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,F=this.parent;if(D==2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",F.typeDesc||"Object").replace("###",F.name),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(219),function(){F.saveAs(true);},null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(218),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(3179));}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+E.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",help:"Save_As_dialog_box.htm",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3379,"To the folder:"),cssText:"padding-bottom:6px;"},{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,searchVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];}},{scriptClass:"mstrmojo.Table",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBSelect:function(D){this.set("name",D.n);},saveAsCallback:function C(){return A;},saveAs:function(F){var E=this.contPanel;this.name=E.name.value;this.desc=E.desc.value;if(!this.name){mstrmojo.confirm(mstrmojo.desc(3380,"Please enter valid name"),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return ;}var G=this.saveParams||{};G.folderID=this.ob.currentFolder.did;G.description=this.desc||"";G.name=this.name||"";G.saveAsOverwrite=!!F;if(this.sId){G.sessionState=this.sId;}var D=this.saveAsCallback();D.parent=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,D,G);},createFolder:function(F,I){if(!F){mstrmojo.confirm(mstrmojo.desc(3380),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return -1;}var G=this.newFolder,E=this.ob,J=E&&E.dataProvider,H=E&&E.currentFolder.did,D={success:function(K){E.refreshContent();G.contPanel.name.set("value","");G.contPanel.desc.set("value","");},failure:function(K){window.alert(K.getResponseHeader("X-MSTR-TaskFailureMsg"));}};J.newFolder(H,F,I,D);}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(G.createFolder(D,F)!=-1){E.close();}}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.close();}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.expr","mstrmojo.FilterExpr");var K=mstrmojo.expr,M=K.ET,D={},I=mstrmojo.hash,N=mstrmojo.dom;D[M.ANDOR]=mstrmojo.AndOrNode;D["*"]=mstrmojo.ConditionNode;function B(){var P=this.tree,O=P.parent,Q=N.delta(this.domNode,P.domNode);if(this.data.sqltp===1){Q.y+=parseInt(O.filterExpr.domNode.offsetHeight,10)+15;}O.parent.openPopup("andOrPopupRef",{condition:this,zIndex:this.zIndex?this.zIndex+100:100,left:Q.x+40+"px",top:Q.y+65-O.domNode.scrollTop+"px"});}function A(Q){var O=[],P;for(P=0,len=Q.length;P<len;P++){O[P]=Q[P].v;}return O.join(" ").replace(/<\s/g,"<").replace(/>\s/g,">");}function J(Q){if(Q.constructor!==Array){Q=[Q];}var U,T={b:0,c:0},V,S,P;for(var R=0,O=Q.length;R<O;R++){U=Q[R];if(!(U&&U.et)){continue;}V=U.nds;if(V){S=J(V);T.b+=S.b;T.c+=S.c;}else{P=(U.et===M.B);T[P?"b":"c"]++;}}return T;}function H(P){var Q=P.parent.data;if(Q){var O=P.items;if(P.alias==="filterExpr"){Q.expr=O&&O[0];}else{Q.aggexpr=O&&O[0];}}}function E(O){var Q=J(O.value),P=this.tree;P.set("bandingCount",P.bandingCount+Q.b);P.set("conditionCount",P.conditionCount+Q.c);}function C(O){var Q=J(O.value),P=this.tree;P.set("bandingCount",P.bandingCount-Q.b);P.set("conditionCount",P.conditionCount-Q.c);}mstrmojo.qb.FilterTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.qb.FilterTree",draggable:true,dropZone:true,allowCopy:false,makeObservable:true,bandingCount:0,conditionCount:0,onadd:function(O){H(this);E.apply(this,[O]);},onremove:function(O){H(this);C.apply(this,[O]);},editable:true,onRender:function(){var P=J(this.items),O=this.tree;O.set("bandingCount",P.b);O.set("conditionCount",P.c);},itemFunction:function(T,P,U){var R=(T.et===M.ANDOR),S=U.tree||U,Q={data:T,tree:S,parent:U,itemFunction:R?U.itemFunction:null,draggable:R?S.draggable:false,dropZone:R?S.dropZone:false,allowDrop:R&&S.dropZone?S.allowDrop:null,allowCopy:R?S.allowCopy:false,editable:S.isEditable?S.isEditable(T):S.editable,makeObservable:R&&U.makeObservable,onclick:S.onnodeclick,onadd:S.onnodeadd,onremove:S.onnoderemove},O=D[T.et]||D["*"];return O&&(new O(Q));},isEditable:function L(P){if(!this.editable){return false;}var O=false;switch(P&&P.et){case M.AQ:case M.ANDOR:case"*":O=true;break;}return O;},onnodeclick:function G(P){if(!this.editable){return ;}if(P&&P.part==="andor"){B.call(this);}else{var O=this.tree;O.onexprclick&&O.onexprclick(this);}},onnodeadd:E,onnoderemove:C,allowDrop:function F(O){var Q=O&&O.src,T=Q&&Q.data,S=T&&T.et,R=(S===M.B),P=this.tree;return S&&((R&&(P.conditionCount===0))||(!R&&(P.bandingCount===0)));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.TreeBrowser","mstrmojo.fx","mstrmojo.array","mstrmojo.hash");var Q=mstrmojo.desc(8953,"Suggestions"),D=mstrmojo.desc(9135,"No match found"),P=mstrmojo.dom,R=mstrmojo.css,N=mstrmojo.hash,F=16,S,C;function I(X,V){var W=X.did,U=X.n;var T={success:function(c){if(c.container){var a=c.container.dssforms;a=a?a:[];for(var b=0,Z=a.length;b<Z;b++){a[b].aid=W;a[b].an=U;a[b].did=W+a[b].dssid;a[b].idf=a[0].dssid;}if(V&&V.success){V.success({items:a});}}},failure:function(Z){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}};var Y={taskId:"getAttributeForms",attributeID:W,displayedForms:0};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,T,Y);}mstrmojo.qb.AttributeMapping=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup],{scriptClass:"mstrmojo.qb.AttributeMapping",markupString:'<div id="{@id}"  class="mstrmojo-Editor {@cssClass}" style="top:{@top};left:{@left};"><div style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown><div class="mstrmojo-qb-mapping-searchbox" mstrAttach:click ><input class="mstrmojo-SearchBox-input mstrmojo-qb-mapping-searchinput" type="text"  mstrAttach:keyup,blur/><span class="mstrmojo-qb-mapping-spinnerbox" style="width:20px;"><span class="mstrmojo-SearchBox2-spinner" id="{@id}sbSpinner"></span></span></div><div class="mstrmojo-qb-mapping-search-status"></div><div class="mstrmojo-qb-mapping-search-content"></div><div class="mstrmojo-qb-mapping-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild.childNodes[2];},inputNode:function(){return this.domNode.firstChild.firstChild.firstChild;},spinnerNode:function(){return this.domNode.firstChild.firstChild.lastChild.lastChild;},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},statusNode:function(){return this.domNode.firstChild.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;}},blockCount:50,cssClass:"mstrmojo-qb-mapping-editor",children:[{scriptClass:"mstrmojo.TreeBrowser",slot:"contentNode",alias:"tree",noCheckBox:false,itemIdField:"did",cssClass:"mstrmojo-qb-mapping-tree",items:[],isBranch:function H(T){return T.items;},item2textCss:function E(T){return("mstrmojo-ArchitectListIcon "+(T.items?"t12":"t21"));},selectionAcrossBranch:false,listSelector:mstrmojo.ListSelector,multiSelect:false,getContentThroughTaskCall:function L(V,U){var T=this;if(V.isRoot){U.success(T.items);}else{I(V.data,U);}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-mapping-status",slot:"statusNode",alias:"status",text:Q},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-mapping-buttonbox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-attributelink-button",cssText:"float: right",text:mstrmojo.desc(1442,"OK"),onclick:function(V){var Y=this.parent.parent;var X=Y.children[0].getTotalSelections();if(X&&X.length>0){var W=mstrmojo.all.QBuilderModel,a=W.mappings,U=mstrmojo.array.find(a,"did",Y.did),Z=a[U];var T={success:function(){Y.close();Z.alias=X[0].an;Z.ipa=1;Z.fmn=X[0].n;Z.tp=12;Z.oid=X[0].aid;Z.nochange=true;Z.georole=0;Z.der=0;Y.target.parent.dataGrid.populatePreview();},failure:function(b){Y._displayError(b);}};W.mapAttribute(Y.did,X[0].aid,X[0].dssid,X[0].idf,T,Z.oid);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-attributelink-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(T){var U=this.parent.parent;U.close();}}]}],_displayError:function K(U){var T=this.status;T.set("text",U);T.set("title",U);R.addClass(T.domNode,"error");this.adjustPosition();},onEnter:function(){this._onsearch();},onEsc:function(){if(this.onCancel){this.onCancel();}this.close();},close:function(){P.detachEvent(document.body,"mousedown",this._close_handler);if(this.target){R.toggleClass(this.target.domNode,"highlight",false);}this.buttonNode.style.display="none";this.statusNode.style.display="none";this.slideProp(false,this.contentNode,95);this.slideProp(false,this.inputNode,16);var T=this.domNode;self.setTimeout(function(){document.body.removeChild(T);},510);},onkeyup:function M(U){var T=U.hWin,X=U.e||T.event;if(this.onEnter&&X.keyCode===13){this.onEnter();return ;}if(this.onEsc&&X.keyCode===27){this.onEsc();return ;}if(microstrategy.enableQuickSearch){if(this._autoSearchTimer){self.clearTimeout(this._autoSearchTimer);}var W=microstrategy.searchAutoCompleteDelay,V=this;if(W){this._autoSearchTimer=self.setTimeout(function(){V._onsearch();},W);}else{this._onsearch();}}},slideProp:function(T,X,V){var U={target:X,props:{height:{start:(T?0:V),stop:(T?V:0),suffix:"px"}}};var W=new mstrmojo.fx.AnimateProp(U);W.play();},onshowContentChange:function A(){if(this.showContent){this.contentNode.style.display="block";this.slideProp(true,this.contentNode,95);this.buttonNode.style.display="block";}else{this.contentNode.style.display="none";this.buttonNode.style.display="none";}},_onsearch:function(){var V=mstrmojo.string.trim(this.inputNode.value),X=this;if(!V){return ;}var a={success:function Z(c){var d=[],b;S=S.toLowerCase();mstrmojo.array.forEach(c.items,function(f){if(f.n.toString().toLowerCase().indexOf(S)===0){d.push(N.copy({items:[],st:-5},f));}});C=d;b=d.length>0;X.status.set("text",b?Q:D);X.statusNode.style.display="block";X.set("showContent",b);R.removeClass(X.status.domNode,"error");X.children[0].set("items",d);},failure:function W(b){if(X.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+b.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}},complete:function U(b){if(X.spinnerNode){X.spinnerNode.style.display="none";}if(X.postFetch){X.postFetch();}}};var T=microstrategy.useQuickSearch();if(S&&V.indexOf(S)===0&&C.length<this.blockCount){S=V;a.success({items:C});return ;}S=V;if(this.spinnerNode){this.spinnerNode.style.display="block";}var Y={taskId:"searchMetadata",styleName:"MojoFolderStyle",nameWildcards:T?16:1,blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:true,includeAncestorInfo:true,objectType:"12",quickSearch:T};Y.searchPattern=T?V:V+"*";mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,a,Y);},attachMousedownEvent:function J(){var T=this;if(!this._close_handler){this._close_handler=function(){if(!T.isOnMe(P.eventTarget(self,arguments[0]))){T.close();}};}P.attachEvent(document.body,"mousedown",this._close_handler);},isOnMe:function G(T){return P.contains(this.domNode.firstChild,T,true,document.body);},adjustPosition:function O(){var U=this.domNode,W=U.firstChild,V=W.offsetHeight,T=W.offsetWidth,Y=P.windowDim(),X=P.position(W,false);if((X.x+T+F)>Y.w){W.style.left=Y.w-T-F+"px";}if((X.y+V+F)>Y.h){W.style.top=Y.h-V-F+"px";}},onOpen:function B(){var T=this.inputNode;this.tree.set("items",[]);T.value="";this.set("showContent",false);this.statusNode.style.display="none";if(!mstrmojo.dom.isWK){this.slideProp(true,T,16);}T.focus();this.attachMousedownEvent();}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowser","mstrmojo.dnd","mstrmojo.dom");mstrmojo.requiresDescs(9142,773,9143);var J=mstrmojo.dom,D=mstrmojo.dnd;function A(M){var L=M.parent;var O=document.createElement("div"),N=O.style,K=L.parent.parent.domNode;O.className="mstrmojo-wh-avatar";K.appendChild(O);L.avatar=O;return O;}function I(M,L,K){M.style.left=K;M.style.top=L;}mstrmojo.WH.TableTree=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.WH.TableTree",model:null,alias:"DBTableTree",cssClass:"mstrmojo-TreeBrowser mstrmojo-Architect-WarehouseTablesTree",items:[],draggable:true,multiSelect:true,itemDisplayField:"n",useCache:false,noCheckBox:true,ownAvatar:true,itemIdField:"did",blockCount:1000,selectionAcrossBranch:false,listSelector:mstrmojo.ListSelector,branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,itemFunction:function G(S,Q,P){var T=P.tree||P,M=new mstrmojo.TreeBrowserNode({data:S,state:0,parent:P,tree:T,multiSelect:P.multiSelect,text:S[P.itemDisplayField],textCssClass:T.item2textCss(S),items:S[P.itemChildrenField],itemIdField:P.itemIdField,itemDisplayField:"nt",itemIconField:P.itemIconField,itemChildrenField:P.itemChildrenField,itemFunction:P.itemFunction,listSelector:P.listSelector,draggable:true,ownAvatar:true,getDragData:function(U){return U.src.widget.data;},onmousedown:function R(U){if(this.selectedIndex>-1){D.startDragCheck(U.hWin,U.e);}},predblclick:function N(V){var U=V.src,W=U.data,Y=(window.event)?window.event:V,X=J.eventTarget(window.event,J.isFF?Y.e:Y);if(!X||X.className.indexOf("mstrmojo-TreeNode-state")>-1){return ;}if(X.className.indexOf("t26")>-1){T.onColumndblclick&&T.onColumndblclick(V);}else{if(U.items.length==0){T.model&&T.model.getColumnsForDBTable(U,{success:T.onTabledblclick});}else{T.onTabledblclick&&T.onTabledblclick({src:U,items:U.items,selDBRole:T.model.SelDBRoleID});}}J.stopPropogation(V.hWin,V.e);J.clearBrowserHighlights(V.hWin);return false;},ondragstart:function L(Z){if(!T.allowdragstart||!T.allowdragstart(Z)){return false;}var X=Z.src.data,U=X.items;if(!U){return ;}if(U.length==0){var Y=T.model;var W={success:function(g){var a=g.src,f=g.items;a.set("items",f);a.data.items=f;}};Y.getColumnsForDBTable(Z.src.widget,W);}var c=this.domNode.childNodes[0].cloneNode(true);this.parent.ownAvatar=true;var b=this.parent.avatar||A(this);var V=Z.src.pos.x+"px";var d=Z.src.pos.y+"px";if((X)&&(X.ns.length>1)){c.childNodes[2].innerHTML=Z.src.data.ns.length;c.childNodes[2].style.cssText="font-size:12px; font-weight:900;color:black;";}while(b.hasChildNodes()){b.removeChild(b.lastChild);}b.appendChild(c);I(b,d,V);b.style.display="block";return true;},ondragmove:function K(U){var X=U.tgt,W=this.parent.avatar;if(W){var V=X.pos.x+1+"px";var X=X.pos.y+1+"px";I(W,X,V);}T.onItemdragmove&&T.onItemdragmove(U);},ondragend:function O(U){this.parent.avatar.style.display="none";this.parent.ownAvatar=false;T.onItemdragend&&T.onItemdragend(U);},getColumns:function(U){T.model.getColumnsForDBTable(this,U);}});return M;},contentRetrieved:true,getContent:function(L,P){var M=(L===this),K=this,Q=function(R){if(M){mstrmojo.css.removeClass(K.domNode,["loading"]);}K.updateTreeContent(L,R);},N=function(R){L.set("items",[K.failItemCreaterFunc()]);},O={success:Q,failure:N};if(M){mstrmojo.css.addClass(K.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:M,data:L.data,blockBegin:P||0,blockCount:K.blockCount},O);},getContentThroughTaskCall:function H(M,L){var K=this.model;if(M.isRoot){K.getSelectedDBRoleTables(M,L);}else{K.getColumnsForDBTable(M,L);}},isBranch:function F(K){return K.items;},item2textCss:function B(K){return"mstrmojo-ArchitectListIcon "+{"-1":"failed","-2":"loading","-3":"next","-4":"prev","26":"t26","8405":"t15"}[K.st];},onRender:function C(){if(this.domNode){this.domNode.style.height=this.height;this.domNode.style.width=this.width;}},onheightChange:function E(K){if(this.domNode){this.domNode.style.height=parseInt(this.height,10)+"px";}},dbroleSelectHandler:function(K){var L=this;L.set("items",[]);L.blockBegin=0;L.getContent(L);},setSelectedTables:function(K){var L=mstrmojo.array.findMulti(this.items,this.itemIdField,K);this.select(L.indices);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.array","mstrmojo.TreeBrowser","mstrmojo.fx");var E=mstrmojo.hash;var B=[{n:mstrmojo.desc(2461,"All"),did:"all"}],A=[{n:mstrmojo.desc(873,"Year"),did:1},{n:mstrmojo.desc(10050,"Quarter"),did:2},{n:mstrmojo.desc(10051,"Quarter of Year"),did:4},{n:mstrmojo.desc(871,"Month"),did:8},{n:mstrmojo.desc(10049,"Month of Year"),did:16},{n:mstrmojo.desc(10048,"Week"),did:32},{n:mstrmojo.desc(10047,"Week of Year"),did:64},{n:mstrmojo.desc(2052,"Date"),did:128},{n:mstrmojo.desc(10046,"Day of Month"),did:256},{n:mstrmojo.desc(10045,"Day of Week"),did:512}],F=[{n:mstrmojo.desc(10042,"Hour"),did:1024},{n:mstrmojo.desc(10043,"Minute"),did:2048},{n:mstrmojo.desc(10044,"Second"),did:4096}];var D=false;mstrmojo.qb.TimeDimension=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.TimeDimension",markupString:'<div id="{@id}"  class="{@cssClass}" style="top:{@top};left:{@left};width:155px;height:{@height};"><div style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown,click><div class="mstrmojo-qb-mapping-title">{@title}</div><div class="mstrmojo-qb-mapping-time"></div><div class="mstrmojo-qb-mapping-buttons"></div></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild.childNodes[1];},titleNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];}},top:"0px",left:"0px",height:"320px",title:"Please select additional time attributes that you want to create.",mode:3,_close:function(){var G=this.parent;if(G&&G._cmSource){G._cmSource.closeMenuTree();}},onOK:function(){var I=this.timebrowser.getTotalSelections();var M=this.parent,H=M._cmSource;if(H.executeCommand){this.data.geo=false;var K=I.slice(),L=0;for(var J=0,G=K.length;J<G;J++){(K[J].did!=="all")&&(L=L|K[J].did);}this.data.der=L;H.executeCommand(this.data);}this._close();},onCancel:function(){this._close();},children:[{scriptClass:"mstrmojo.TreeBrowser",slot:"contentNode",alias:"timebrowser",noCheckBox:false,itemIdField:"did",itemDisplayField:"n",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,multiSelect:true,cssClass:"mstrmojo-qb-time-tree",isBranch:function C(G){return false;},bindings:{items:function(){var H=this.parent.mode,G=[];switch(H){case 1:G=B.concat(A);break;case 2:G=B.concat(F);break;case 3:G=B.concat(A).concat(F);break;default:break;}return G;}},onchange:function(M){var J=M.added,L=M.removed;if(D){D=false;return ;}if(J){var H=this.items,K=H.length,G,I=this.selectedIndices;if(J[0]===0){for(G=0;G<K;G++){if(!I[G]){D=true;this.setSelectedItems(H,true);break;}}}else{for(G=1;G<K;G++){if(!I[G]){return ;}}if(!I[0]){D=true;this.toggleSelect(0,false);}}}if(L){if(L[0]===0){this.clearTreeSelect();}else{if(this.selectedIndices[0]){D=true;this.toggleSelect(0,false);}}}},onRender:function(){var K=this.parent.der,J=this.items,H=[];for(var I=0,G=J.length;I<G;I++){(K&J[I].did)&&(H.push({did:J[I].did}));}(G==H.length+1)&&(H.push({did:"all"}));H.length&&this.setSelectedItems(H,true);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox cf",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(1442,"OK"),onclick:function(G){var H=this.parent.parent;if(H.onOK){H.onOK();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(G){var H=this.parent.parent;if(H.onCancel){H.onCancel();}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.array","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.qb.FFsqlToken");var c=mstrmojo.dom,P=mstrmojo.array,W=mstrmojo.hash,f=mstrmojo.css,b=mstrmojo.Enum_Keys,T=mstrmojo.range,U=T.EDGE,Q=mstrmojo.expr,a=mstrmojo.qb.FFsqlToken.isDelimiter,N=229;function K(l){var E=(c.isIE&&!c.isIE9)?l.keyCode:l.charCode;return(E>0)?String.fromCharCode(E):null;}var Z,B=100,G={" ":true,"\t":true,"\n":true};SQL_KEYWORD_ACTION=["select","update","insert","delete","create","drop","alter","set","exec"],SQL_KEYWORD=SQL_KEYWORD_ACTION.concat(["from","where","having","in","group","by","order","into","on","values","table","case","then","else","join","as"]),currentDBTableHash={};function S(){if(!Z){Z=[];P.forEach(SQL_KEYWORD,function(E){Z.push({n:E,sta:B,t:B});});}return Z;}mstrmojo.qb.FFsql=mstrmojo.declare(mstrmojo.ME.TokenInputBox,null,{scriptClass:"mstrmojo.qb.FFsql",renderBlockSize:50000,itemFunction:function M(l,E,k){return new mstrmojo.qb.FFsqlToken({data:l});},item2textCss:function O(E){return{11:" mstrmojo-ArchitectListIconSuggest t11 ",15:" mstrmojo-ArchitectListIconSuggest t15 ",26:" mstrmojo-ArchitectListIconSuggest t26 "}[E.t]||"";},itemIdField:"did",itemCount:0,ostack:[],sqlTokens:S(),browseItemVisible:false,customFunctionVisible:false,getSQLstmt:function(){if(!this.items){return"";}var k=[],n,E,l=this.items;for(n=0,E=l.length;n<E;n++){k[n]=l[n].v;}return k.join("");},handlekeydown:function F(AF){if(this.editNode.contentEditable=="false"){return true;}AF=AF||window.event;var y=AF.keyCode||AF.charCode,z=false,o=T.getRangeInfo(),l=c.isFF&&(y===0);if(l&&!this.doubleByte){this.doubleByte=true;this.prev_rInfo=o;this.prev_items=this.items;return true;}if(this.doubleByte&&y!=N&&!l){this.doubleByte=false;var AC=this.prev_rInfo,AI=o.startContainer.data,AA=AC.startOffset;if(AI){c.isFF&&(AA=Math.max(AA-1,0));this.widgetHandleImeInput(AC,AI.slice(AA,o.startOffset));}}switch(y){case b.DELETE:if(!this.doubleByte){try{this.widgetHandleDelete(o);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});this.updatepasses();}catch(x){}z=true;}break;case b.BACKSPACE:if(!this.doubleByte){try{this.widgetHandleBackspace(o);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();}catch(u){}z=true;}break;case b.ENTER:if(this.suggestionShown){var q=this.getSelected();if(q){this.handleSuggestionItemSelect(q);if(this.candidates.isCol){this.set("candidates",{items:mstrmojo.all.QBuilderModel.FFsqlComp,isComplete:true});}}this.hideSuggestion();}else{var n=T.getEdgeInfo(o.startContainer,o.startOffset),AE=c.findWidget(o.startContainer),r=this.itemIndex(AE.data),AG=this.ctxtBuilder.itemWidgets,AH=AG[r].data.v==="\n",p={v:"\n",isDelimiter:true,isNew:true,did:this.itemCount++};em={v:" ",isDelimiter:true,isNew:true,did:this.itemCount++};if(n===U.EDGE_MIDDLE){var E=AE.split2Tokens(o.startOffset,this.itemCount++);this.remove(r);this.add([E[0],p,E[1]],r);r=r+1;}else{if(n===U.EDGE_BEGIN){this.add([p],r);}else{r=r+1;if((c.isFF||c.isIE)&&AH){this.add([em,p],r);}else{this.add([p,em],r);}}}if(c.isFF||c.isIE){AE=AG[AH?r:r+1];this._delaySetCaretPos(AE.domNode,true);}else{AE=AG[r];this._delaySetCaretPos(AE.domNode,false);}this.updatepasses();}z=true;break;case b.TAB:if(this.suggestionShown){var q=this.getSelected();if(q){this.handleSuggestionItemSelect(q);if(this.candidates.isCol){this.set("candidates",{items:mstrmojo.all.QBuilderModel.FFsqlComp,isComplete:true});}}}else{this.startTokenSuggestion();}z=true;break;case b.ESCAPE:this.endTokenSuggestion();z=true;break;case 67:if(AF.ctrlKey||AF.metaKey){this.ctrx=false;z=false;}break;case 86:if(AF.ctrlKey||AF.metaKey){this._saveRangeInfo=T.getRangeInfo();if(this.ctrx){this.handlepaste(this.cutstr);z=true;this.ctrx=false;}else{this.clipboardNode.focus();z=false;}this.updatepasses();}break;case 88:if(AF.ctrlKey||AF.metaKey){try{this.cutstr=o.range.cloneContents().textContent;this.widgetHandleDelete(o);this.startTokenSuggestion();this.ctrx=true;this.raiseChangeEvent({type:"cut"});}catch(u){}z=true;}break;case 90:if(AF.ctrlKey||AF.metaKey){try{var AD=this.ostack,AB=AD.length;if(AB>1){AD.pop();this.set("items",AD[AB-2].its);this.updatepasses();this.focus();}}catch(u){}z=true;}break;case N:if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=o;this.prev_items=this.items;}break;default:}if(z){c.stopPropogation(window,AF);c.preventDefault(window,AF);return false;}else{return true;}},handlekeypress:function Y(p){if(this.editNode.contentEditable=="false"){return true;}p=p||window.event;var r=K(p),o=p.keyCode||p.charCode,E=false,u;if(r&&!((r==="c"||r==="x"||r==="v"||r==="z")&&p.ctrlKey)){try{this.widgetHandleInput(T.getRangeInfo(),r);this.raiseChangeEvent({type:"input",characeter:r});var n=this._saveActiveToken;if(!a(r)){if(!n){w=this.findObjectToken();if(w&&!w.isDelimiter()){this._saveActiveToken=n=w;}}if(n&&r==="."){var l=currentDBTableHash[n.data.v.toLowerCase().slice(0,-1)];if(l){if(l.columns){this.startTokenSuggestion();}else{var t=this;mstrApp.getRootController().getColumnsForDBTable({data:l},{success:function x(z){var y=z.items,k=[],AA=n.data.v;l.columns=y;P.forEach(y,function(AB){k.push({n:AA+AB.n,sta:2,t:26});});t.set("candidates",{items:t.candidates.items.concat(k),isComplete:true});t.startTokenSuggestion();}});}}else{n.isCol=false;n.col=null;this.startTokenSuggestion();}}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion();}}catch(q){}E=true;}if(E){c.stopPropogation(window,p);c.preventDefault(window,p);return false;}else{return true;}},markFailureLabel:function D(E){this.pnum=E;this.updatepasses();},updatepasses:function X(l){var k=[],r=this.ctxtBuilder.itemWidgets,y=true,p=c.position(this.domNode).y,o,x;P.forEach(r,function(z){o=z.data;x=o.v;if(y&&!G[x]){if(x&&P.indexOf(SQL_KEYWORD_ACTION,x.toString().toLowerCase())>-1){k.push(c.position(z.domNode).y-p);}y=false;}else{if(x===";"){y=true;}}});if(k.length===1){k=[];}var n=[],u=this.parent,q=u.passlabel,t=u.domNode.clientHeight,E={scriptClass:"mstrmojo.Button"};P.forEach(k,function(AA,z){if(AA>=0&&AA<=t){n.push(W.copy(E,{cssText:["top:",AA,"px;"].join(""),cssClass:(this.pnum===z?"error":"")}));}});q.removeChildren(null,true);q.addChildren(n,0,true);},widgetHandleBackspace:function d(p){if(p.collapsed){var k=this._saveActiveToken;if(k&&k.data){s=k.data.v;if(s&&s[s.length-1]==="."&&k.isCol){this.set("candidates",{items:mstrmojo.all.QBuilderModel.FFsqlComp,isComplete:true});k.isCol=false;k.col=null;}}var o,n,E,q=p.startOffset,l=this.ctxtBuilder.itemWidgets;if(!c.contains(this.editNode,p.startContainer,false,document.body)){if(p.startOffset>0&&c.isFF){n=l[this.items.length-1];T.collapseOnNode(n.domNode,false);p=T.getRangeInfo();o=T.getEdgeInfo(p.startContainer,p.startOffset);}else{T.collapseOnNode(this.editNode,true);return ;}}o=T.getEdgeInfo(p.startContainer,p.startOffset);n=c.findWidget(p.startContainer);E=this.itemIndex(n.data);if(o===U.EDGE_BEGIN){E--;n=l[E];q=n.length();}if(!n){T.collapseOnNode(this.editNode,true);return ;}if(n.length()===1){this.remove(E);if(n.data.v===";"||n.data.v==="\n"){this.updatepasses();}n=l[E-1];if(n){T.collapseOnNode(n.domNode,false);this.checkMergeTwoTokens(E-1,E);n=l[E-1];}else{T.collapseOnNode(this.editNode,true);}}else{n.spliceContent(q-1,1);if(n.isCol){this.set("candidates",{items:n.col,isComplete:true,isCol:true});}T.collapseOnTextNode(n.domNode,q-1);}}else{this.widgetDeleteTokens(p);this.updatepasses();}},handlepaste:function g(o){if(typeof o!=="string"){var k=this.clipboardNode.value;}else{var k=o;}this.clipboardNode.value="";var p=[],E=k&&k.length,n,l="",q;if(E>0){for(n=0;n<E;n++){q=k.charAt(n);if(a(q)){if(!mstrmojo.string.isEmpty(l)){p.push({v:l,isNew:true,did:this.itemCount++});l="";}p.push({v:q,isDelimiter:true,isNew:true,did:this.itemCount++});}else{l=l+q;}}if(!mstrmojo.string.isEmpty(l)){p.push({v:l,isNew:true,did:this.itemCount++});l="";}this.insertTokens(p);}},insertTokens:function H(q){var p=this._saveRangeInfo;if(!p||!c.contains(this.editNode,p.startContainer,false,document.body)){this.add(q);var k=this.ctxtBuilder.itemWidgets,l=k[k.length-1];this._delaySetCaretPos(l.domNode,false);this.raiseChangeEvent({type:"insert"});return ;}var o=T.getEdgeInfo(p.startContainer,p.startOffset),l=c.findWidget(p.startContainer),E=this.itemIndex(l.data);if(o===U.EDGE_MIDDLE){var n=l.split2Tokens(p.startOffset,this.itemCount++);this.remove(E);q.unshift(n[0]);q.push(n[1]);this.add(q,E);}else{E=(o===U.EDGE_BEGIN?E:E+1);this.add(q,E);}E=E+q.length-1;l=this.ctxtBuilder.itemWidgets[E];this._delaySetCaretPos(l.domNode,false);this.raiseChangeEvent({type:"insert"});},widgetHandleInput:function J(p,q){if(!p.collapsed){this.widgetDeleteTokens(p);p=T.getRangeInfo();}var l,r,u,x,E,k,n=this.ctxtBuilder.itemWidgets;if(!c.contains(this.editNode,p.startContainer,false,document.body)){this.add([{v:q,isDelimiter:a(q),isNew:true,did:this.itemCount++}],0);r=n[0];T.collapseOnTextNode(r.domNode,1);return ;}l=T.getEdgeInfo(p.startContainer,p.startOffset);r=c.findWidget(p.startContainer);u=this.itemIndex(r.data);if(a(q)){if(this.candidates.isCol){this.set("candidates",{items:mstrmojo.all.QBuilderModel.FFsqlComp,isComplete:true});}x={v:q,isDelimiter:true,isNew:true,did:this.itemCount++};if(l===U.EDGE_MIDDLE){var o=r.split2Tokens(p.startOffset,this.itemCount++);this.remove(u);this.add([o[0],x,o[1]],u);u=u+1;}else{u=(l===U.EDGE_BEGIN)?u:u+1;this.add([x],u);}r=n[u];T.collapseOnNode(r.domNode,false);if(q===";"){this.updatepasses();}}else{k=p.startOffset;if(r.isDelimiter()){E=n[(l===U.EDGE_BEGIN)?u-1:u+1];if(E&&!E.isDelimiter()){r=E;k=(l===U.EDGE_BEGIN)?r.length():0;}this.add([{v:q,isNew:true,did:this.itemCount++}],(l===U.EDGE_BEGIN)?u:u+1);r=n[(l===U.EDGE_BEGIN)?u:u+1];T.collapseOnNode(r.domNode,false);this.updatepasses();}else{r.spliceContent(k,0,q);T.collapseOnTextNode(r.domNode,k+1);}}},widgetHandleImeInput:function J(o,p){if(!o.collapsed){this.widgetDeleteTokens(o);o=T.getRangeInfo();}var l,q,r,u,E,k,n=this.ctxtBuilder.itemWidgets;if(!c.contains(this.editNode,o.startContainer,false,document.body)){this.clearTokens();this.add([{v:p,isDelimiter:this.isDelimiter(p),isNew:true,did:this.itemCount++}],0);n=this.ctxtBuilder.itemWidgets;q=n[0];T.collapseOnTextNode(q.domNode,q.data.v.length||1);this._delaySetCaretPos(q.domNode,false);return ;}l=T.getEdgeInfo(o.startContainer,o.startOffset);q=c.findWidget(o.startContainer);r=this.itemIndex(q.data);k=o.startOffset;if(q.isDelimiter()){this.clearTokens();this.set("items",this.prev_items);n=this.ctxtBuilder.itemWidgets;E=n[(l===U.EDGE_BEGIN)?r-1:r+1];if(E&&!E.isDelimiter()){q=E;k=(l===U.EDGE_BEGIN)?q.length():0;}}if(!q.isDelimiter()){q.spliceContent(k,0,p);this._delaySetTextCaretPos(q.domNode,k+p.length);}else{this.add([{v:p,isNew:true,did:this.itemCount++}],(l===U.EDGE_BEGIN)?r:r+1);q=n[(l===U.EDGE_BEGIN)?r:r+1];this._delaySetCaretPos(q.domNode,false);}this.startTokenSuggestion();return q;},getSearchPattern:function h(){var E=this._saveActiveToken;if(E.isCol){var k=E.data.v;pattern=k.slice(k.lastIndexOf(".")+1,k.length);}else{pattern=E&&E.data.v;}len=pattern&&pattern.length;if(len>2){if(pattern.charAt(0)==="["){pattern=pattern.substring(1);}if(pattern.charAt(pattern.length-1)==="]"){pattern=pattern.substring(0,pattern.length-1);}}return pattern;},getSuggestionPos:function V(){var k=this._saveActiveToken,q=null,r,E=0;if(k.isCol){E=k.domNode.offsetWidth;}if(k){r=mstrmojo.dom.position(k.domNode,true);var o=Math.round(r.y+r.h),n=this.suggestionItems.length*19,u=parseInt(mstrmojo.all.QBuilderPage.height),l=u>o-40+n;q={left:Math.round(r.x)+E+"px",top:l?o+"px":r.y-n+"px",zIndex:100};}return q;},onSuggestionItemSelect:function L(r){var o=this._saveActiveToken;this.endTokenSuggestion();if(r.t==-98){var n=this.items;this.clearTokens();for(var l=0;l<n.length;l++){n[l].did=this.itemCount++;}this.customFunctionMode=true;var n=[{v:"{",isDelimiter:true,sta:1,isNew:true,did:this.itemCount++}].concat(n).concat([{v:"}",isDelimiter:true,sta:1,isNew:true,did:this.itemCount++}]);this.set("items",n);var E=this.itemIndex({did:this.itemCount-1}),q=this.ctxtBuilder.itemWidgets[E-1];this._delaySetCaretPos(q.domNode,false);}else{if(o){if(o.isCol){var p=o.data.v,t={};mstrmojo.hash.copy(r,t);t.n=p.slice(0,p.lastIndexOf(".")+1)+r.n;o.setItemInfo(t);}else{o.setItemInfo(r);}this._delaySetCaretPos(o.domNode,false);}}},ontokensModify:function(E){this.ostack.push({its:mstrmojo.hash.cloneArray(this.items)});this.pnum=-1;this.updatepasses();},dropZone:true,allowDrop:function I(E){return this.dropZone&&mstrApp.isFFSQLMode;},ondragover:function R(r){var AA=r.tgt.widget,z=r.tgt.pos.x,t=r.tgt.pos.y;var q=AA.ctxtBuilder.itemWidgets,p=q.length;if(p===0){return ;}var E=q[p-1].domNode,u=c.position(E);if(t>u.y+E.clientHeight){AA._delaySetCaretPos(E,false);}else{for(var o=p-1;o>-1;o--){if(q[o].data.v=="\n"||q[o].data.v=="\t"){continue;}var k=q[o].domNode,l=c.position(k).y;if(l<t&&!(l+14<t)){AA._delaySetCaretPos(k,false);break;}}}},ondrop:function(o){var l=o.src.data.ns,n=[];if(!l){return ;}for(var k=0,E=l.length;k<E;k++){n.push({isNew:true,v:l[k],oi:o.src.data,did:this.itemCount++});if(k<E-1){n.push({isNew:true,v:",",isDelimiter:true,did:this.itemCount++});}}this.insertTokens(n);},onscroll:function(){mstrmojo.all[this.parentNode.id].updatepasses();},onRender:function C(){if(this.hasRendered){mstrmojo.dom.attachEvent(this.editNode,"scroll",this.onscroll);this.itemsContainerNode.style.height="100%";}},addCandidateTables:function A(E){var k=[],l,n=E.value;currentDBTableHash={};P.forEach(n,function(o){l=o.ns?o.ns+"."+o.n:o.n;k.push({n:l,sta:2,t:15});currentDBTableHash[l.toLowerCase()]=o;});this.set("candidates",{items:this.sqlTokens.concat(k).concat(mstrApp.getRootController().getSuggestionItems(true)),isComplete:true});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ME.TokenInputBox");var H={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},D={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},E={0:mstrmojo.desc(9565,"Valid Metric Formula."),1:mstrmojo.desc(9106,"Require Validation?"),2:mstrmojo.desc(9566,"Validation in Progress..."),3:mstrmojo.desc(9567,"Validation Failed with Syntax Error!"),4:mstrmojo.desc(9568,"Validation Failed with Object Ambiguity!")};function B(J){if(!J){return H.VALID;}return{"-2147214845":H.ERROR,"-2147214846":H.AMBIGUITY}[J]||H.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricEditBox",vStatus:H.VALID,iStatus:"",showStatus:true,markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},markupMethods:{onvStatusChange:function(){var K=this.vStatus,J=this.vStatusNode;J.className="mstrmojo-MEBox-vStatus "+D[K];J.innerHTML=E[K];},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;this.iStatusNode.title=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:1000,}],init:function I(J){if(this._super){this._super(J);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function(){return this.inputBox.getSearchPattern();},getHighlightedText:function(K,J){return this.inputBox.getHighlightedText(K,J);},item2textCss:function C(J){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[J.t]||"";},handleSuggestionItemSelect:function(J){var K=this.abiguityDialog;if(J){K.onItemSelect(J);}K.close();},showDesc:true,showPath:true,abiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title","Object Ambiguity: '##'".replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.label.set("text",mstrmojo.desc(9569,"More than one object with the name '##' found. Select the object you would like to use:").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.LegacySuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"}}]},postBuildRendering:function A(){this._super();var J=function(){this.set("vStatus",H.UNKNOWN);this.set("iStatus","");};this.inputBox.attachEventListener("tokensModify",this.id,J);this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function G(J){this.inputBox.set("items",J.items);},handleValidation:function F(N){if(!N){this.set("vStatus",H.ERROR);return ;}N.vs=B(N.rjec);this.set("vStatus",N.vs);this.set("iStatus",N.rjed||"");this.updateInputBoxItems(N);this.inputBox.focus();if(N.vs===H.AMBIGUITY){var M=this,K=N.items,P=mstrmojo.array.find(K,"sta",-1),J=K[P].v,O=function(R){M.inputBox.replaceErrorToken(R);M.set("iStatus","");M.set("vStatus",H.UNKNOWN);if(M.continueValidataion){M.continueValidataion();}};var Q=this.parent.candidates,L=Q&&Q.items;if(L){Q.items=L.concat(N.srfd.items);}this.openPopup("abiguityDialog",{zIndex:100,items:N.srfd.items,ambiguousName:J,onItemSelect:O});}else{if(this.postHandleValidation){this.postHandleValidation();}}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=H;})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AD=mstrmojo.Enum_OIB_States,AC={},AE;for(AE in AD){if(AD.hasOwnProperty(AE)){AC[String(AD[AE])]=AE;}}return AC;}());var P=mstrmojo.dom,R=mstrmojo.hash,X=mstrmojo.Enum_OIB_States,I=0,Z="_did_",z=mstrmojo.Enum_Keys,AB=80,T=200;function O(){return I++;}function f(AC){return(AC&&AC.state===X.ADDING);}function p(AC){var AD={n:AC||"",state:X.EMPTY};AD[Z]=-2;return AD;}function N(AC){return(AC&&AC.state===X.EMPTY);}function u(AD){var AE=AD.items,AC=AE&&AE.length;if(!AC){return true;}return(AC===1&&f(AE[0]))||(AC===2&&N(AE[0])&&f(AE[1]));}function k(){var AD=this.ctxtBuilder.itemWidgets,AC=AD[AD.length-1];if(AC&&AC.isAdding){return AC;}return null;}function K(){var AC=this.editingIdx;if(AC!==null){return this.ctxtBuilder.itemWidgets[AC];}return k.call(this);}function D(){this.isActive=false;var AD=this.emptyText||"",AE=this.items;if(u(this)&&!N(AE[0])&&(AD.length>0)){this.add([p(AD)],0);var AF=this.ctxtBuilder.itemWidgets[0];AF.set("shouldEllipsize",true);AF.doEllipsize();}var AC=K.call(this);if(AC){if(f(AC)){AC.domNode.style.display="none";}this.scrollTo(this.items[0]);AC.blur();}P.detachEvent(document.body,"mousedown",this._mousedownHandler);}function M(){this.isActive=true;if(N(this.items[0])){this.remove(0);}var AC=K.call(this);if(AC){if(f(AC)&&!this.isFull){AC.domNode.style.display="block";}this.scrollTo(AC.data);AC.focus();}P.attachEvent(document.body,"mousedown",this._mousedownHandler);}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,getSearchPattern:function(){var AC=K.call(this);if(AC){return AC.getSearchPattern();}return"";},getSuggestionTarget:function l(){return this.suggestTarget;},onsuggestTargetChanged:function o(AC){this._request_pattern=null;},getSuggestionPos:function a(){return this._pop_cfg;},onSuggestionItemSelect:function x(AC){this.suggestTarget.setItem(AC[this.itemField],AC,false);this.hideSuggestion();},hideEditButton:function(AC){return !!this.noEditButton;},_set_items:function h(AH,AE){AE=AE||[];var AG=this.maxObjectCount;this.set("isFull",(AG&&AE.length>=AG));if(AE.length===0){var AD=this.emptyText||"";if(AD.length>0){AE.push(p(AD));}}var AF={n:"",state:X.ADDING};AF[Z]=-1;AE.push(AF);var AC=AE[AE.length-1];if(AC&&f(AC)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=Z;return this._super(AH,AE);},add:function E(AD,AC){var AE=k.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AD,AC);}if(!u(this)&&N(this.items[0])){this.remove(0);}if(AE){AE.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);}}AE.domNode.style.display="none";},remove:function Y(AC){this._super(AC);var AD=k.call(this);if(AD){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AD.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function W(){this._super();var AD=this,AC=k.call(AD);if(AC){AC.domNode.style.display="none";}this._clickHandler=function(){M.call(AD);};this._mousedownHandler=function(AE){if(!AD.isActive||AD.browserShown){return ;}var AF=P.eventTarget(self,AE);if(AF&&AF.parentNode&&!P.contains(AD.domNode,AF,false,document.body)&&!P.contains(AD.suggestionPopup.domNode,AF,false,document.body)){D.call(AD);}};P.attachEvent(this.domNode,"click",this._clickHandler);},nextId:O,item2textCss:function L(AC){return AC.cssClass||"";},itemFunction:function G(AH,AD,AF){AH[AF.itemIdField]=O();var AI=new mstrmojo.ObjectItem({parent:AF,itemField:AF.itemField,cssClass:AF.item2textCss(AH),data:AH});var AE=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AC=AE.length,AG;for(AG=0;AG<AC;AG++){AI.attachEventListener(AE[AG],AF.id,"_itemChangeHandler");}return AI;},getSelectedObjects:function g(){if(u(this)){return[];}var AC=this.items,AD=AC.length-1;if((AD>-1)&&f(AC[AD])){return AC.slice(0,AD);}return AC.concat();},isValid:function C(){var AD=this.ctxtBuilder.itemWidgets,AC=AD&&AD.length,AE;for(AE=0;AE<AC;AE++){if(!AD[AE].isValid()){return false;}}return true;},_itemChangeHandler:function(AF){var AH=AF.name,AI=AF.d,AD,AC=this.items.length,AE;switch(AH){case"ItemEditBegin":if(this.editingIdx!==null){AE=K.call(this);if(AE){AE.blur();}}AD=this.itemIndex(AI);this.editingIdx=AD;M.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AF.deactivate){D.call(this);}else{M.call(this);}AE=k.call(this);if(AE){AE.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AE=K.call(this);if(AE){AE.blur();}this.editingIdx=null;}AD=this.itemIndex(AI);this.remove(AD);if(!AF.deactivate){this.editingIdx=null;M.call(this);}else{if(!this.isActive){D.call(this);}else{M.call(this);}}break;case"ItemDeletePrev":if(AC>1){this.remove(AC-2);}break;case"ItemAdd":var AG=R.copy(AF.d);this.add([AG],AC-1);if(AF.deactivate){D.call(this);}else{M.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AF.target);this._pop_cfg={target:AF.target,left:AF.l,top:AF.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AF.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AH==="ItemEditEnd"||AH==="ItemAdd"||AH==="ItemDelete"||AH==="ItemDeletePrev"||AH==="ItemEditing")){this.onitemchange();}},unrender:function B(AD){var AC=this.suggestionPopup;if(AC.hasRendered){AC.unrender(false);}if(this._super){this._super(AD);}},destroy:function t(AD){var AC=this.suggestionPopup;if(AC&&AC.hasRendered){AC.destroy(false);}if(this._super){this._super(AD);}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var q="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span class="'+q+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=q+" "+this.cssClass;},onstateChange:function(){var AF=this.state,AE=mstrmojo.Enum_OIB_States_CSS[AF],AD=this.domNode;if(AF===X.EMPTY){AD.innerHTML='<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>";}else{if(AF===X.EDITING){var AC=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AC-4+"px";this.inputNode.style.width=AC-9+"px";}}AD.className="mstrmojo-ObjectItem "+AE;if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},state:X.VALID,onstateChange:function c(AC){this.data.state=this.state;},ontextChange:function H(AC){this.data[this.itemField]=this.text;},updateData:function F(AC){R.copy(AC,this.data);this.set("state",X.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function y(AD){this._super(AD);var AF=this.data,AC=AF.state,AE=this.parent;if(typeof AC==="undefined"){AC=AE.dynamicVerify?AE.verifyObject(AF[this.itemField],this):X.UNDETERMINED;AF.state=AC;}this.cssClass=AE.item2textCss(AF);this.text=AF[this.itemField];this.state=AC;this.isAdding=f(AF);this.useRichTooltip=true;},isValid:function C(){var AC=parseInt(this.state,10);return(AC!==X.INVALID&&AC!==X.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AF=this.inputNode.style;AF.width=AB+"px";var AE=this.domNode.parentNode,AC=AE.parentNode.offsetWidth,AD=Math.max(AC-AE.offsetLeft-20,AB);if(!isNaN(AD)){AF.width=AD+"px";}}},blur:function S(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AE=this.inputNode,AC=AE.value,AD=this.parent;window.setTimeout(function(){try{AE.blur();}catch(AF){}},0);if(!AC){return ;}if(AD.acptSugItemOnly){this.set("text",AC);this.set("text","");this._tWas_=null;return ;}this.setItem(AC,null,true);},focus:function r(){var AD=this.inputNode,AC=this.isActive;window.setTimeout(function(){try{AD.focus();if(AD.createTextRange&&!AC){var AF=AD.createTextRange(),AE=AD.value.length;AF.move("character",AE);AF.select();}}catch(AG){}},0);this.isActive=true;},prekeydown:function J(AC){var AE=this.inputNode.value,AD=parseInt(AC.e.keyCode||AC.e.charCode,10),AG=this.parent;if(!AE){return ;}if(AD===z.TAB||AD===z.ENTER){P.preventDefault(AC.hWin,AC.e);var AF=AG.getSelected();if(AF){AG.handleSuggestionItemSelect(AF);}else{this.hideSuggestion();if(!AG.acptSugItemOnly){this.setItem(AE,null,false);}else{this.set("text",AE);this.set("text","");}}}else{if(AD===z.DOWN_ARROW){if(!AG.noCache){this.showSuggestion(AE);}AG.nextHighlight();}else{if(AD===z.UP_ARROW){AG.preHighlight();}}}},prekeyup:function AA(AC){var AE=this.inputNode.value,AD=parseInt(AC.e.keyCode||AC.e.charCode,10),AH=this.isAdding,AG=this.parent;if(!AE){if(AH){if(AD===z.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});P.preventDefault(AC.hWin,AC.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AD===z.ESCAPE){this.hideSuggestion();if(AG.acptSugItemOnly){this.set("text",AE);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AE){this.raiseEvent({name:"ItemEditing",d:this.data});if(AG.useKeyDelay){if(!this._timerID){var AF=this;this._timerID=window.setTimeout(function(){var AI=AF.inputNode.value;if(AI){AF.showSuggestion(AI);}AF._timerID=null;},T);}}else{this.showSuggestion(AE);}}}this._tWas_=AE;},setItem:function(AC,AE,AD){var AG=this.isAdding,AF=this.parent;AD=AD||false;this.set("text",AC);this._tWas_=null;if(AG){this.set("text","");if(!AE){AE={};AE[this.itemField]=AC;}else{AE.state=X.VALID;}this.raiseEvent({name:"ItemAdd",d:AE,deactivate:AD});}else{this.set("text",AC);if(AE){this.updateData(AE);}else{this.set("state",AF.verifyObject(AC,this));this.set("cssClass",AF.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AE,deactivate:AD});}},getSearchPattern:function U(){return this.inputNode.value;},showSuggestion:function n(AC){var AD=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AD.x)+"px",t:Math.round(AD.y+AD.h)+"px",pattern:AC,target:this});},hideSuggestion:function d(){this.raiseEvent({name:"SuggestionOff"});},del:function Q(AC){AC=AC||self.event;P.stopPropogation(self,AC);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function V(){this.showSuggestion(this.text);this.set("state",X.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});},doEllipsize:function b(){if(!this.shouldEllipsize){return ;}var AD=this.maxItemWidth,AC;if(AD){this.domNode.style.maxWidth=AD;switch(parseInt(this.state,10)){case X.VALID:case X.UNDETERMINED:case X.INVALID:AC=this.textNode;break;case X.EMPTY:AC=this.domNode.firstChild;break;}if(AC){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AC,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo._HasPopup","mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.ObjectBrowser","mstrmojo.ObjectInputBox","mstrmojo.DataGrid","mstrmojo.Editor");mstrmojo.requiresDescs(629,5298,1442,221,9125);var F=mstrmojo.hash,D=mstrmojo.expr,A=mstrmojo.ME.MetricToken.brackets,G=function(L){var I=null;if(L.isParam){I={scriptClass:"mstrmojo.Table",cssClass:"funcParam",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ObjectInputBox",alias:"paramInput",slot:"0,0",item2textCss:function E(M){return{26:" mstrmojo-ArchitectListIconSuggest t26"}[M.t]||"";},hideEditButton:function(M){return false;},browseItemVisible:false,dynamicVerify:false,emptyText:mstrmojo.desc(9125,"Type here to input columns..."),postCreate:function(N){var M=this.parent.dataGrid,O=M&&M.parent;this.candidates=O.getCandidates(function(P){return P.t===26;});if(!N){M.candidatesListener.push(this);}}}],onParamAdded:function(O){var N=this.dataGrid.parent,M=this.paramInput;N.closePopup();O.state=0;M.add([O],M.items.length-1);},getTokens:function(){var P=this.paramInput.getSelectedObjects(),M=P.length,O,Q=[],N;if(M>0){for(O=0;O<M;O++){if(P[O].state===mstrmojo.Enum_OIB_States.VALID){N={v:A(P[O].n)};N.oi=P[O];}else{N={v:P[O].n};}Q.push(N);Q.push({v:",",isDelimiter:true});}Q.pop();}return Q;}};var J=I.children[0];if(!L.isRepeated){J.cssClass="mstrmojo-ObjectInputBox singleObject noVerify";J.maxObjectCount=1;}else{J.cssClass="mstrmojo-ObjectInputBox noVerify";}}else{switch(L&&L.dtp){case 11:I={scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-functionArgs-pulldown mstrmojo-Pulldown",items:[{n:"False",did:"0"},{n:"True",did:"-1"}],popupToBody:true,itemIdField:"did",postCreate:function(M){this.value=this.data.dfv||0;},getTokens:function(){var M=this.data;if(this.value!==M.dfv){return[{v:M.n},{v:"=",isDelimiter:true},{v:this.value=="-1"?"True":"False"}];}else{return[];}}};break;case -2:I={scriptClass:"mstrmojo.Table",cssClass:"breakBy",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ObjectInputBox",slot:"0,0",alias:"breakByInput",item2textCss:function E(M){return(this._super&&this._super(M))||{12:"a","-99":"br"}[M.t]||"";},emptyText:"Type here to input breakby attributes...",noEditButton:true,browseItemVisible:true,folderLinksContextId:16,browsableTypes:[D.TP.FOLDER,D.TP.ATTR].join(","),getCandidatesThroughTaskCall:function K(N,M){mstrmojo.ME.MetricDataService.getAttributes(N,M);},postCreate:function(N){var M=this.parent.dataGrid,O=M&&M.parent;this.candidates=O.getCandidates(function(P){return P.t===12;});if(!N){M.candidatesListener.push(this);}}},{scriptClass:"mstrmojo.ToolBar",slot:"0,1",cssClass:"mstrmojo-oivmSprite grouped",children:[{scriptClass:"mstrmojo.Button",title:"Browse",iconClass:"tbBrowse",onclick:function(){var N=this.parent.parent.dataGrid.parent;N.openPopup("ob",{zIndex:N.zIndex+10});var M=N.ob.browser;M.browse({folderLinksContextId:16,onSelectCB:[this.parent.parent,"onBreakByAdded"],browsableTypes:[D.TP.ATTR,D.TP.FOLDER].join(",")});}}]}],onBreakByAdded:function(O){var N=this.dataGrid.parent,M=this.breakByInput;N.closePopup();M.add([O],M.items.length-1);},getTokens:function(){var O=this.breakByInput.getSelectedObjects(),M=O.length,N,P=[];if(M>0){P.push({v:"BreakBy"});P.push({v:"=",isDelimiter:true});P.push({v:"{",isDelimiter:true});for(N=0;N<M;N++){P.push({v:A(O[N].n),oi:O[N]});if(N!==(M-1)){P.push({v:",",isDelimiter:true});}}P.push({v:"}",isDelimiter:true});}return P;}};break;case -1:I={scriptClass:"mstrmojo.Table",cssClass:"sortBy",layout:[{cells:[{cssText:"width: 330px"},{}]}],getTokens:function(){var P=this.sortByGrid.items,M=P.length,O,S=[];if(M>0){S.push({v:"SortBy"});S.push({v:"=",isDelimiter:true});S.push({v:"(",isDelimiter:true});for(O=0;O<M;O++){var Q=P[O],R=Q.selFrm||(Q.dssforms&&Q.dssforms[0]),N={v:A(Q.n),oi:Q};if(R&&Q.t==12){F.copy({v:A(Q.n)+"@"+A(R.n),exv:R.dssid,extp:R.dtp},N);}S.push(N);if(O!==(M-1)){S.push({v:",",isDelimiter:true});}}S.push({v:")",isDelimiter:true});}return S;},children:[{scriptClass:"mstrmojo.DataGrid",slot:"0,0",cssClass:"mstrmojo-functionArgs-sort",alias:"sortByGrid",renderOnScroll:false,resizableColumns:true,makeObservable:true,itemDisplayField:"n",columns:[{headerText:"Name",dataField:"n",colCss:"nmCol"},{headerText:"Field",dataField:"field",colCss:"spcCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",bindings:{items:"this.data.dssforms"},popupToBody:true,popupZIndex:100,onvalueChange:function(){this.data.selFrm=this.selectedItem;}}},{headerText:"Field",dataField:"field",colCss:"spcCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",bindings:{items:"this.data.dssforms"},popupToBody:true,popupZIndex:100,onvalueChange:function(){this.data.selFrm=this.selectedItem;}}},{headerText:"Order",dataField:"order",colCss:"ordCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",items:[{n:"Ascending",v:0},{n:"Descending",v:1}],itemIdField:"v",popupToBody:true,popupZIndex:100,onvalueChange:function(){this.data.asc=this.value;}}},{dataWidget:{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(M){this.dataGrid.remove(this.data);}},headerText:"&nbsp",colCss:"actionsCol"}]},{scriptClass:"mstrmojo.ToolBar",slot:"0,1",cssClass:"mstrmojo-oivmSprite grouped",children:[{scriptClass:"mstrmojo.Button",title:"Browse",iconClass:"tbBrowse",onclick:function(){var N=this.parent.parent.dataGrid.parent;N.openPopup("ob",{zIndex:N.zIndex+10});var M=N.ob.browser;M.browse({folderLinksContextId:16,onSelectCB:[this.parent.parent,"onSortByAdded"],browsableTypes:[D.TP.ATTR,D.TP.METRIC,D.TP.FOLDER].join(",")});}}]}],onSortByAdded:function(P){var N=this.dataGrid.parent,O=this.sortByGrid;N.closePopup();if(P){switch(P.t){case 12:var Q=function(R){if(R){var S=R.container;if(S&&S.dssforms){P.dssforms=S.dssforms;O.add([P]);}}},M=function(R){mstrmojo.alert(R.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));};mstrmojo.ME.MetricDataService.getAttributeForms({attributeID:P.did,displayedForms:0},{success:Q,failure:M});break;case 4:P.dssforms=[{n:"Value"}];default:O.add([P]);}}}};break;default:I={scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-functionArgs-textInput",postCreate:function(M){var N=this.data;this.value=(N.dfv||N.dfv===0)?N.dfv:"";},getTokens:function(){var M=this.data;if(this.value!==M.dfv){return[{v:M.n},{v:"=",isDelimiter:true},{v:this.value}];}return[];}};break;}}I.alias="inputWidget";return I;},H=function(J,E,I){return'<div class="mstrmojo-DataRow-text"title="'+(J.desc||"")+'">'+J.n+(J.isParam?"*":"")+":</div>";};mstrmojo.qb.FunctionWizard=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.FunctionWizard",cssClass:"mstrmojo-FunctionWidzard",title:"Function Arguments",help:mstrApp.helpTopics&&mstrApp.helpTopics.fnWiz,fctOi:null,fctArgs:null,fctSyntax:"",bindings:{candidates:"this.opener.candidates"},getCandidates:function B(J){var I=this.candidates,E;if(I){E=mstrmojo.array.filter(I.items,J);return{items:E,isComplete:I.isComplete};}return null;},_set_candidates:function(M,I){this.candidates=I;if(this.hasRendered&&this.visible){var K=this.argsGrid,L=K.candidatesListener,E=L.length,J;for(J=0;J<E;J++){L.postCreate(true);}}return true;},onOpen:function(){var I=this,J=function(N){if(N){I.set("fctOi",N);var P=[],M,K,O,L=[];L.push(N.n);L.push("(");K=N.pars&&N.pars.length||0;for(M=0;M<K;M++){O=F.copy(N.pars[M]);O.isParam=true;P.push(O);L.push(N.pars[M].n);if(M!=(K-1)){L.push(", ");}}L.push(")");if(N.rpc>0){O.isRepeated=true;}K=N.pros&&N.pros.length||0;for(M=0;M<K;M++){P.push(F.copy(N.pros[M]));}if(N.ios){P.push({n:"Sort By",dtp:-1,desc:"Sort By is a parameter representing the sort by levels for this function."});}if(N.sqt===5){P.push({n:"Break By",dtp:-2,desc:"Break By is a parameter representing the break by levels for this function."});}I.set("fctArgs",P);I.set("fctSyntax",L.join(""));}mstrmojo.css.removeClass(I.argsGrid.domNode,["loading"]);},E=function(K){mstrmojo.alert(K.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));mstrmojo.css.removeClass(this.argsGrid.domNode,["loading"]);};this.argsGrid.set("items",[]);mstrmojo.css.addClass(this.argsGrid.domNode,["loading"]);this.set("fctSyntax","");this.set("title","Function arguments for: "+this.fctOi.n);mstrmojo.ME.MetricDataService.getFunctionDetails(this.fctOi,{success:J,failure:E});},getTokens:function C(){var K=this.argsGrid.ctxtBuilder.itemWidgets,N=K.length,M,R,O=[],J=[],S=[],P,L,I,E,Q=this.fctOi;for(M=0;M<N;M++){R=K[M].inputWidget;if(R.data.isParam){J.push(R.getTokens());}else{O.push(R.getTokens());}}S.push({v:Q.n,oi:Q});N=O.length;if(N>0){E=false;S.push({v:"<",isDelimiter:true});for(M=0;M<N;M++){P=O[M];I=P.length;if(I===0){continue;}E=true;for(L=0;L<I;L++){S.push(P[L]);}S.push({v:",",isDelimiter:true});}S.pop();if(E){S.push({v:">",isDelimiter:true});}}N=J.length;S.push({v:"(",isDelimiter:true});E=false;for(M=0;M<N;M++){P=J[M];I=P.length;if(I===0){continue;}E=true;for(L=0;L<I;L++){S.push(P[L]);}S.push({v:",",isDelimiter:true});}if(E){S.pop();}S.push({v:")",isDelimiter:true});return S;},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},children:[{scriptClass:"mstrmojo.DataGrid",alias:"argsGrid",cssClass:"functionArgs",banding:false,columns:[{headerText:"Property Name",dataFunction:H,colCss:"name"},{headerText:"Property Type",dataWidgetBuilder:G,colCss:"dtp"}],postCreate:function(){this.candidatesListener=[];},bindings:{items:"this.parent.fctArgs"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FW-syntaxLabel",text:"",bindings:{text:function(){return this.parent.fctSyntax;}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FW-descLabel",text:"",bindings:{text:function(){return this.parent.fctOi.desc;}}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-FW-buttonBox",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;if(E.insertOnFinish){E.insertOnFinish(E.getTokens());}E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricEditBox");mstrmojo.requiresDescs(218,219,221,628,1442,2102,2116,2154,2213,2919,4596,5298,5728,5891,7924,7984,7987);var H=mstrmojo._FormatDefinition,I=mstrmojo.string,Q=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,J={advanced:65536,simple:131072,func:196608};var C=function(R){if(!R){return Q.VALID;}return{"-2147214845":Q.ERROR,"-2147214846":Q.AMBIGUITY}[R]||Q.ERROR;},G=function(S,R){var T={taskId:"saveMetricDefinition",tokenStreamXML:B(S),localSymbolFolderXML:A(S),metricXML:P(S),metricId:S.did||"",outputFlags:327695,description:S.desc||"",name:S.n||"",saveAs:R,sessionState:mstrApp.sessionState};if(I.isEmpty(S.metricId)){T.isNew=true;}return T;},D=function(T){var S=function(U){var W=this.parent;var V=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##","Object").replace("'###'","");if(W){W.ob.refreshContent();W.onObjectSaved({name:W.name,did:U.did,desc:W.desc});V=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",W.typeDesc||"Object").replace("###",W.name);}mstrmojo.confirm(V,[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"OK"),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(7984,"Object Saved"));if(W){W.close();}T.dirty=false;},R={success:S,failure:mstrmojo.SaveAsEditor.SAVEAS_CALLBACK.failure};return R;},M=function(Y,V){var T=this;F(T,true);var Z=mstrmojo.ME._MetricEditorHelper.oi=Y.oi,U=B(Z),W=A(Z),X=P(Z,true),a=function(b){if(b&&b.tks){var c=b.tks;N(c);Z.tks=c;if(!c.rjec){Z.mps=b.mps;}c.vs=C(c.rjec);Y.set("vStatus",c.vs);Y.set("iStatus",c.rjed||"");Y.handleValidation&&Y.handleValidation(c);if(V&&c.vs===Q.VALID){var d=G(Z,false);if(V==="save"&&Z.did){mstrmojo.xhr.request("POST",mstrConfig.taskURL,D(Y),d);}else{if(V==="save"&&mstrmojo.string.isEmpty(Z.did)||V==="saveAs"){d.saveAs=true;Y.openPopup("saveasRef",{zIndex:Y.zIndex+10,folderLinksContextId:17,name:mstrmojo.desc(2213,"New Metric"),saveParams:d,saveAsCallback:function(){return D(Y);}});}else{if(V==="switch"){if(Y.cbSwtichEditor){Y.cbSwtichEditor(Y);}}}}}else{if(V&&c.vs===Q.ERROR){mstrmojo.confirm(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"OK"),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(9571,"Syntax Error!"));}}}},S=function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));},R=function(b){F(T,false);};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:U,localSymbolFolderXML:W,metricXML:X,metricId:Z.did,isNew:I.isEmpty(Z.did)},{success:a,failure:S,complete:R});},O=function(R,T){var S=[];R.oi.tks.items=S;T.clearTokens(S);},P=function(W,V){var U=[];U.push("<mt>");if(W.fmt&&!V){var R={getArrItemName:function(Z,X,Y){return Z.substr(0,Z.length-1);},isSerializable:function(f,c,b){if(mstrmojo.array.indexOf(["header_format","grid_format"],f)>-1){var g=c[b][f];if(!g){return{};}var Z="<"+f+">";for(var d in g){Z+="<prs n='"+d+"'>";var Y=g[d];for(var X in Y){var a=Y[X];Z+="<pr n='"+X+"' v='"+(a=="pru"?"":a)+"'";Z+=a=="pru"?' pru="1"':"";Z+="/>";}Z+="</prs>";}Z+="</"+f+">";return{child:Z};}return true;},skipNull:true};U.push(I.json2xml("fmt",W.fmt,R));}if(W.prss&&!V){var T={getArrItemName:function(Z,X,Y){return Z.substr(0,Z.length-1);},isSerializable:function(f,b,Z){if(mstrmojo.array.indexOf(["AnalyticalEngineProperties","DatamartProperties","VLDBSelect","VLDBFunction","VLDBReport"],f)>-1){var a=b[Z][f];if(!a){return{};}var Y=[],c=[];Y.push("<prs n='"+f+"' ");for(var d in a){var X=a[d];if(X!=null){if(typeof (X)=="object"){c.push(I.json2xml("pr",X,{skipNull:true,convertBoolean:true,isSerializable:function(k,h,g){return true;}}));}else{Y.push(d+"='"+X+"' ");}}}Y.push(">");Y.push(c.join(""));Y.push("</prs>");return{child:Y.join("")};}return true;},skipNull:true};U.push(I.json2xml("prss",W.prss,T));}if(W.mps){U.push(I.json2xml("mps",W.mps,{skipNull:true,convertBoolean:true,isSerializable:function(Z,Y,X){return true;}}));}if(W.datp&&!V){U.push(I.json2xml("datp",W.datp,{skipNull:true,convertBoolean:true,isSerializable:function(Z,Y,X){return true;}}));}if(W.sbs&&!V){var S={getArrItemName:function(Z,X,Y){if(Z=="avs"){return"sb";}else{return Z.substr(0,Z.length-1);}},isSerializable:function(Z,Y,X){return true;},skipNull:true};U.push(I.json2xml("sbs",W.sbs,S));}U.push("</mt>");return U.join("");},B=function(U){var V=K(U.tks);var S="",T={items:true,v:true,tp:true,lv:true,exv:true,extp:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true},R={getArrItemName:function(Y,W,X){return"tkn";},isSerializable:function(Y,X,W){return(T[Y])?true:false;}};S=I.json2xml("tknstrm",V,R);return S;},N=function(U){var S=U.items,R=S.length,T=S[S.length-1];if(T&&T.tp===-1){S.pop();}if(S[0]&&S[0].tp===38){S.splice(0,1);}},K=function(Y){var V=Y.items,S=V.length,X=V[V.length-1],U,W,T=[],R="";if(V[0]&&V[0].tp!==38){T.push({v:"&",tp:38,lv:4,sta:2});}for(U=0,S=V.length;U<S;U++){W=V[U];if(W.isNew&&!W.oi){R+=W.v;}else{if(!I.isEmpty(R)){T.push({v:R,tp:2,lv:1});R="";}T.push(W);}}if(!I.isEmpty(R)){T.push({v:R,tp:2,lv:1});R="";}if(X&&X.tp!==-1){T.push({v:"",tp:-1,lv:4,sta:2});}return{items:T};},A=function(R){return"";},F=function(S,R){S.set("enabled",!R);S.set("iconClass",S.iconClass.replace(/mstrmojo-InlineWaitIcon/,"")+" "+(R?"mstrmojo-InlineWaitIcon":""));},E=function(S,U){var V=U,R=V.oi.fmt,T=H.MetricFormatTarget;F(S,true);window.setTimeout(function(){if(!R){R=V.oi.fmt={};for(var W=0;W<T.length;W++){R[T[W].p]={};}}var X=mstrmojo.dom.position(S.domNode,true);V.openPopup("formatPopupRef",{zIndex:V.zIndex+10,model:R,left:X.x+"px",top:Math.max(0,(X.y-(V.formatPopupRef.height||350)))+"px"});F(S,false);},50);},L=function(T,U){var V=U,R=V.oi,S=function(){var W=mstrmojo.dom.position(T.domNode,true);V.openPopup(mstrmojo.all.mstrMEOptionsDialog||"optionPopupRef",{zIndex:V.zIndex+10,model:R,funcs:V.funcs,left:W.x+"px",top:Math.max(0,(W.y-(V.optionPopupRef.height||350)))+"px"});};if(!V.funcs){F(T,true);mstrmojo.ME.MetricDataService.getSubtotalFunctions(null,{success:function(W){if(W.items){V.funcs=W.items;S();F(T,false);}},failure:function(W){mstrmojo.alert(W.getResponseHeader("X-MSTR-TaskFailureMsg"));F(T,false);}});}else{S();}};mstrmojo.ME._MetricEditorHelper=mstrmojo.provide("mstrmojo.ME._MetricEditorHelper",{noCache:true,useKeyDelay:true,saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Metric",browsableTypes:"4,8",onObjectSaved:function(T){var S=this.opener,R=S&&S.oi;if(S&&R){R.did=T.did;R.n=T.name;R.desc=T.desc;S.set("title",mstrmojo.desc(2154,"Metric:")+" "+T.name);}}},optionPopupRef:{id:"mstrMEOptionsDialog",scriptClass:"mstrmojo.ME.OptionDialog",title:mstrmojo.desc(9572,"Advanced Metric Options"),help:"Advanced_Metric_Options_dialog_box.htm",height:340},formatPopupRef:{scriptClass:"mstrmojo.ME.MetricFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116,"Format"),left:"100px",top:"100px",useAnimate:false,height:360,help:"Format_Metric_dialog_box.htm",locksHover:true},functionSelector:{scriptClass:"mstrmojo.ME.FunctionSelector",insertMode:true},wizard:{scriptClass:"mstrmojo.ME.FunctionWizard"},simpleMetricRef:{scriptClass:"mstrmojo.ME.SimpleMetricEditor"},metricEditorRef:{scriptClass:"mstrmojo.ME.MetricEditor"},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},switchRef:{scriptClass:"mstrmojo.Button",alias:"switchToMetricEdtior",cssClass:"mstrmojo-ME-switch",text:mstrmojo.desc(9563,"Switch to Formula Editor"),bindings:{visible:function(){return !this.parent.insertMode;}},getEditor:function(){return this.parent;},onclick:function(){var S=this.getEditor();S.oi.tks.items=S.getMetricDefAsTokens();var R={vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN,candidates:S.candidates,oi:S.oi,did:S.oi.did,functions:S.functions};if(S.dirty){R.dirty=S.dirty;}S.openPopup("metricEditorRef",R);S.close();}},buttonBarRef:{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:70px;",bindings:{visible:function(){return !this.parent.parent.insertMode;}},children:[{scriptClass:"mstrmojo.Button",iconClass:"tbFormat",alias:"formatButton",title:mstrmojo.desc(4596,"Format..."),text:"",onclick:function(){E(this,this.parent.parent.parent);}},{scriptClass:"mstrmojo.Button",iconClass:"tbAdvOptions",alias:"optButton",title:mstrmojo.desc(7924,"Options..."),text:"",onclick:function(){L(this,this.parent.parent.parent);}}]},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",alias:"saveokButton",text:"",bindings:{text:function(){return(this.parent.parent.insertMode)?mstrmojo.desc(2919,"Insert"):mstrmojo.desc(5891,"Save");}},onclick:function(){var R=this.parent.parent;if(R.insertMode){R.insertOnFinish(R.getMetricDefAsTokens());R.close();}else{if(R.getMetricDefAsTokens){R.oi.tks.items=R.getMetricDefAsTokens();}R.tbValidate=this;M.call(this,R,"save");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",alias:"btnSaveAs",text:mstrmojo.desc(628,"Save As"),bindings:{visible:function(){return !this.parent.parent.insertMode;}},onclick:function(){var R=this.parent.parent;if(R.getMetricDefAsTokens){R.oi.tks.items=R.getMetricDefAsTokens();}R.tbValidate=this;M.call(this,this.parent.parent,"saveAs");}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(2102,"Close"),onclick:function(){var R=this.parent.parent;if(R.onPreClose()){R.close();}}}]},validateSyntax:function(R){M.call(R,this);},validateSyntaxAndSwitch:function(R){M.call(R,this,"switch");},preprocessTokenStram:function(R){N(R);},isDirty:function(){if(this.insertMode){return false;}return this.dirty;},onmetricModify:function(){this.dirty=true;},save:function(){this.buttonBar.btnSaveAs.onclick();},prompt2saveRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:mstrmojo.desc(5728,"Confirm save"),children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",bindings:{text:function(){return mstrmojo.desc(9573,"Do you want to save changes made to #?").replace("#","<b>"+this.parent.opener.oi.n+"</b>");}}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:10px;"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(219,"Yes"),onclick:function(){var R=this.parent.parent;R.opener.save();R.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(218,"No"),onclick:function(){var R=this.parent.parent;R.opener.close();R.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var R=this.parent.parent;R.close();}}]}]},prompt2save:function(){if(this.getMetricDefAsTokens){this.oi.tks.items=this.getMetricDefAsTokens();}this.openPopup("prompt2saveRef",{zIndex:this.zIndex+1});},onPreClose:function(){var R=this;if(R.isDirty&&R.isDirty()){R.prompt2save();return false;}return true;},onClose:function(){this.dirty=false;},init:function(T){var U=mstrApp,R=U&&U.useQuickSearch&&U.useQuickSearch(),S=R?(U&&U.searchAutoCompleteDelay&&U.searchAutoCompleteDelay()||0):0;this.suggestDelay=S||200;this.noCache=this.noCache&&R;this.ob.children[0].quickSearch=R;mstrmojo.ME.MetricDataService.suggestDelay=this.suggestDelay;mstrmojo.ME.MetricDataService.noCache=this.noCache;if(this._super){this._super(T);}},_setupCandidatesCache:function(U){var R=this,S=mstrmojo.ME.MetricDataService,T=500;ms=function(W){var V=W&&W.items||[],X=R.candidates||[];X.items=X.items.concat(V);X.isComplete=X.isComplete&&(W.bc===-1||(W.bb+W.bc>W.sz));if(U){U.candidates=null;U.set("candidates",X);}R.candidates=null;R.set("candidates",X);},success=function(V){if(V){var W={items:V.items,isComplete:(V.bc===-1||(V.bb+V.bc>V.sz))};if(U){U.set("candidates",W);}R.set("candidates",W);}S.getMetrics({rootFolderType:S.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:T},{success:ms,failure:failure});},failure=function(V){mstrmojo.alert(V.getResponseHeader("X-MSTR-TaskFailureMsg"));};if(!this.noCache&&!this.candidates){S.getMetricComponents({rootFolderType:S.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:T},{success:success,failure:failure});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.HBox","mstrmojo.Box","mstrmojo.Table","mstrmojo.DataGrid","mstrmojo.qb.AttributeMapping","mstrmojo.qb.TimeDimension","mstrmojo.qb.GeoRole");var B=mstrmojo.css,O=mstrmojo.dom,K=mstrmojo.string;var L=mstrmojo.desc(11170,"This column contains geographical locations. Additional columns will be created automatically so that you can view your data on Google Maps. See menu options for details."),D=mstrmojo.desc(11171,"This column contains date values. Additional columns will be created automatically. See menu options for details.");var G=function(Q,S,U){var T={},V=Q;for(var R=0,P=S.length;R<P;R++){(S[R].tp==U)&&(T[S[R].alias]=1);}R=0;while(T[V]){V=Q+" ("+(++R)+")";}return V;};function M(S,P,Q){var T="mstrmojo-di-timedimension";var R=mstrmojo.all[T];if(!R){R=new mstrmojo.qb.TimeDimension({height:P,mode:S,der:Q});}else{R.set("height",P);R.set("mode",S);R.set("der",Q);}return R;}function N(T,P,R,Q){var U="mstrmojo-di-georole";var S=mstrmojo.all[U];if(!S){S=new mstrmojo.qb.GeoRole({height:"200px",georole:T,der:P,shapeKey:R,shapeKeys:Q});}else{S.set("georole",T);S.set("der",P);S.set("shapeKey",R);}return S;}var F=[{did:"QBAttribute",n:mstrmojo.desc(518,"Attribute"),items:[{did:"QBTimeGeo"}]},{did:"QBMetric",n:mstrmojo.desc(517,"Metric")},{did:"QBNone",n:mstrmojo.desc(9132,"Do not map")},{did:-1,n:"-"},{did:"QBRename",n:mstrmojo.desc(1388,"Rename")},{did:"QBMap",n:mstrmojo.desc(9133,"Link...")},{did:"QBUnMap",n:mstrmojo.desc(9134,"Unlink")},{did:-1,n:"-"},{did:"QBEdit",n:mstrmojo.desc(1088,"Edit")},{did:"QBRemove",n:mstrmojo.desc(629,"Delete")},{did:-1,n:"-"},{did:"QBDataType",n:mstrmojo.desc(9918,"Data Type"),items:[{did:"2",n:mstrmojo.desc(3434,"Number")},{did:"3",n:mstrmojo.desc(3544,"Text")},{did:"8",n:mstrmojo.desc(2052,"Date")},{did:"1",n:mstrmojo.desc(9919,"DateTime")},{did:"9",n:mstrmojo.desc(2170,"Time")},{did:"11",n:mstrmojo.desc(9920,"Big Decimal")},{did:"6",n:mstrmojo.desc(4699,"Email")},{did:"7",n:mstrmojo.desc(9921,"HTML Tag")},{did:"12",n:mstrmojo.desc(8984,"Phone Number")},{did:"10",n:mstrmojo.desc(4530,"Symbol")},{did:"5",n:mstrmojo.desc(9922,"URL")}]}];function I(Q,R,S){var P,T={1:1|2|4|8|16|32|64|128|256|512|1024|2048|4096,8:1|2|4|8|16|32|64|128|256|512,9:1024|2048|4096};P=T[S];P=P?P:(268435456|536870912|1073741824);Q.der=Q.der&P;R.der=Q.der;}var J={scriptClass:"mstrmojo.MenuButton",cssClass:"mstrmojo-di-datapreview-cxtmenu",cmCssClass:"mstrmojo-di-datapreview-popmenu",id:"mstrmojo-di-datapreview-cm",postCreate:function(){this.cm=F;},getMenuPosition:function H(){var P=mstrmojo.dom.position(this.domSrc,true);return{x:Math.round(P.x),y:Math.round(P.y+P.h)};},dataGrid:null,widget:null,dynamicUpdate:true,queryEnabled:function(P){var Q=this.widget;switch(P.did){case"QBAttribute":return !Q.nochange&&!Q.ipa&&!Q.multiForms;break;case"QBMetric":return !Q.nochange&&(Q.tp!=4)&&!Q.ipa&&(!Q.multiForms||!Q.isIDForm);break;case"QBNone":return Q.mapped;break;case"QBRename":return !Q.nochange&&!Q.ipa&&(!Q.multiForms||Q.isIDForm);break;case"QBEdit":case"QBMap":return !Q.nochange&&!Q.ipa;break;case"QBUnMap":return(Q.nochange||Q.ipa||Q.multiForms);break;default:return true;}},queryVisible:function(R){var Q=this.dataGrid,P=this.widget;switch(R.did){case"QBAttribute":case"QBMetric":case"QBRename":return this.widget.hasMapped;break;case"QBMap":case"QBUnMap":return this.widget.hasMapped&&this.widget.tp==12&&this.widget.sptMap;break;case"QBEdit":case"QBRemove":return !!this.widget.isQB&&(!this.widget.isReadOnly);break;case"QBNone":return !!this.widget.isDI;break;case"QBDataType":return this.widget.hasMapped&&this.widget.sptGeo&&this.widget.tp==12;break;default:return true;}},queryChecked:function(R){var P=this.widget;var Q=parseInt(R.did,10);if(Q>0&&Q<=12){return Q==P.dtp;}return false;},executeCommand:function(l){var n=this.widget.did;var S=this.dataGrid.model;var h=S.mappings;var b=mstrmojo.array.find(h,"did",n);var W=this.dataGrid;var Q;if(b!=-1){Q=mstrmojo.hash.copy(h[b]);}var d={success:function X(q){S.autoMap&&S.autoMap();},failure:function(q){h[b]=Q;W.populatePreview();}};switch(l.did){case"QBAttribute":if(b!=-1){h[b].alias=G(h[b].alias,h,12);if(S.remap){S.remap(h[b].did,h[b].alias,null,12,null,null,null,d);}}break;case"QBMetric":if(b!=-1){h[b].alias=G(h[b].alias,h,4);if(S.remap){S.remap(h[b].did,h[b].alias,null,4,null,null,null,d);}}break;case"QBNone":if(b!=-1){h[b].selected=false;this.dataGrid.populatePreview();}break;case"QBRename":var c=h[b].alias;var Z=this.widget;var g=Z.domNode.parentNode.clientWidth-25;g=(g>0)?(g+"px"):"20px";var T=O.position(Z.domNode).x-O.position(W.domNode).x+20+"px";W.openPopup("inlineTextRef",{top:(O.isIE?0:-1)+"px",left:T,txtConfig:{value:c||"",width:g,onEnter:function(){var q=K.trim(this.value),t=false;this.parent.close({enter:true});if(q===h[b].alias){return ;}if(q===""){return ;}if(S.validateRename){t=S.validateRename(q);}else{t=(q===G(q,h,h[b].tp));}if(t){var r=h[b].oid;mstrmojo.array.forEach(h,function(x){if(x.oid===r){x.alias=q;}});W.populatePreview();S.remap&&S.remap(Z.did,q,null,null,null,null,null,d);}else{var u="The name ## has been used by another column. Please give a new name.";mstrmojo.alert(K.encodeHtmlString(u.replace("##",q)),null,S.alertTitle);}}}});break;case"QBEdit":var b=this.widget.ix,k=S.selectedClns[b],p=3;mstrApp.getRootController().openExpressionEditor({type:p,w:k,tkn:k.expr,cIndex:b+1});break;case"QBRemove":var Z=this.widget;var f=Z.ix+1;if(S.removeSelectedColumn){S.removeSelectedColumn(f);}break;case"QBMap":var W=this.dataGrid,Z=this.widget,V=O.position(Z.domNode),R=S.mappings[b],o=mstrmojo.Button.newInteractiveButton,P=function U(){var q=new mstrmojo.qb.AttributeMapping({});q.placeholder=document.body.appendChild(document.createElement("div"));q.top=V.y+22+"px";q.left=V.x+"px";q.did=Z.did;q.target=Z;q.open();};B.toggleClass(Z.domNode,"highlight",true);if(R.georole||R.der){mstrmojo.confirm(mstrmojo.desc(9912,"Mapping this column to a project attribute will remove its geographical role and any derived attributes. Do you want to continue?"),[o(mstrmojo.desc(219),function(){P();}),o(mstrmojo.desc(218))]);}else{P();}break;case"QBUnMap":if(S.unmap){S.unmap(n,h[b].oid);}break;case"1":case"8":case"9":case"2":case"3":case"4":case"5":case"6":case"7":case"10":case"11":case"12":var Z=this.widget,Y=parseInt(l.did,10),a=S.mappings[b];if(Z.dtp!=Y){Z.dtp=Y;a.dtp=Y;S.remap&&S.remap(n,null,Y,null,null,null,null,d);if(Y==1||Y==8||Y==9){Z.georole=0;B.removeClass(Z.domNode,"geo");if(!Z.ipa){B.addClass(Z.domNode,"time");Z.parent.tips.set("title",D);}}else{B.removeClass(this.widget.domNode,"time");Z.parent.tips.set("title","");}I(Z,a,Y);}break;case"QBTime":if(b!=-1){var R=S.mappings[b];R.tp=12;R.selected=true;R.der=l.der;W.populatePreview();}break;case"QBGeo":if(b!=-1){var R=S.mappings[b];R.tp=12;R.selected=true;R.georole=l.georole;R.der=l.der;R.shapeKey=l.shapeKey;W.populatePreview();}break;default:break;}}};function E(P,V,R){var Q="mstrmojo-di-datapreview-cm",U=mstrmojo.all[Q];var W=P.parent.dataGrid;if(!U){U=mstrmojo.insert(J);U.set("domSrc",V);U.widget=P;U.dataGrid=W;U.render();}else{U.widget=P;U.dataGrid=W;U.set("domSrc",V);}U._subMenu&&U._subMenu.domNode&&U._subMenu.domNode.parentNode.removeChild(U._subMenu.domNode);U._subMenu=null;if(P.sptGeo&&P.tp!=4&&!P.ipa&&!P.multiForms){var T={},X=true;switch(P.dtp){case 8:T={height:"220px",mode:1};X=false;break;case 9:T={height:"100px",mode:2};X=false;break;case 1:T={height:"260px",mode:3};X=false;break;default:T={georole:P.georole};break;}if(X){var S=W.model;F[0].items=[{did:"QBGeo",itemWidget:N(P.georole,P.der,P.shapeKey,S.shapeKeys)}];}else{F[0].items=[{did:"QBTime",itemWidget:M(T.mode,T.height,P.der)}];}}else{delete (F[0].items);}U.cm=F;U.showContextMenu();}function C(R){var P={},Q;mstrmojo.array.forEach(R,function(S){if(S.tp===12){Q=S.oid;P[Q]=(P[Q]||0)+1;}});return P;}mstrmojo.qb.QBPreview=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.QBPreview",resizeColumnBehavior:mstrmojo.RESIZE_ALL_COLUMN_MODE,model:null,visible:false,markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},adjustSize:function(R){var Q=200;var S=this.parent&&this.parent.domNode;if(!S){return ;}var P=Q*R;if(S.clientWidth>P){S.style.overflowX="hidden";this.cssText="width:100%";}else{S.style.overflowX="auto";this.cssText="width:"+P+"px";}},populatePreview:function A(){var R=this.model,P=R.mappings,c=R.supportTimeGeo,X=!R.isCloud;this.columns=[];var d=0;if(this.parent&&this.parent.domNode){d=this.parent.domNode.scrollLeft?this.parent.domNode.scrollLeft:0;}this.unrender();this.adjustSize(P.length);var h,f,g,a,Q,k,U=C(P);for(var Y=0,Z=P.length;Y<Z;Y++){h=P[Y];g=K.encodeHtmlString(h.alias);g=(U[h.oid]>1&&h.fmn)?[g,"(",h.fmn,")"].join(""):g;a=h.tp;Q=((h.dtp==1)||(h.dtp==8)||(h.dtp==9))&&!h.ipa;k="";if(Q){a+=" time";if(h.tp===12){k=D;}}else{if(h.georole){a+=" geo";if(h.tp===12){k=L;}}}f={tag:h,headerWidget:{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-di-datapreview-header",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-datapreview-headerIcon t"+(h.selected?a:0).toString(),text:g,did:h.did,tp:h.tp,isReadOnly:h.isReadOnly,hasMapped:h.hasMapped,isQB:h.isQB,sptGeo:c,sptMap:X,mapped:h.selected,ix:h.ix,nochange:h.nochange,ipa:h.ipa,dtp:h.dtp,georole:h.georole,der:h.der,shapeKey:h.shapeKey,multiForms:h.multiForms,isIDForm:h.isIDForm},{scriptClass:"mstrmojo.Widget",cssClass:"menu",alias:"tips",title:k,markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" title="{@title}" style="{@cssText}" mstrAttach:click></div>',onclick:function(){var l=this.parent.children[0],n=l.tag;E(l,this.domNode,n);},markupMethods:{ontitleChange:function(){this.domNode.title=this.title;}}}]},colWidth:"60",colCss:"mstrmojo-qb-metric",dataFunction:function(r,n,q){var o=q.columns,l=r[this.dataField],p="mstrmojo-di-datapreview-DataRow-text";if(this.tag.selected){p+={"12":" Attribute","4":" Metric"}[this.tag.tp];}p+=(n%2==1)?" odd":" even";return'<div class="'+p+'">'+l+"</div>";},dataField:Y.toString()};this.columns.push(f);}var V=R.dataset;if(V.length==0&&this.columns.length>0){var b=21;var T=parseInt(parseInt(this.parent.height)/b)-1;T=T>0?T:1;var S;for(var Y=0;Y<T;Y++){S=[];for(var W=0,Z=this.columns.length;W<Z;W++){S.push("");}V.push(S);}}this.items=V;this.render();if(this.parent&&this.parent.domNode){this.parent.domNode.scrollLeft=d;}},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,slot:"headerContainerNode",children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onblur:function(){this.onEsc();},onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var Q=this.txt,R=this.txtConfig;if(R){for(var P in R){Q.set(P,R[P]);}}Q.domNode.style.width=Q.width;Q.focus();},onClose:function(P){if(!P||(!P.cancel&&!P.enter)){this.txt.onEnter();}this.unrender();}},onvisibleChange:function(P){if(P.value){this.populatePreview();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Table","mstrmojo.WH.DBRoleSelector","mstrmojo.WH.WHModel","mstrmojo.WH.TableTree","mstrmojo.qb.VSplitPanel","mstrmojo.SearchableDropDownList");var A=mstrmojo.css,C=mstrmojo.array;mstrmojo.WH.WHPanel=mstrmojo.declare(mstrmojo.qb.VSplitPanel,null,{scriptClass:"mstrmojo.WH.WHPanel",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},model:null,sptCache:false,catalogStamp:"   ",marginSpan:10,allowdragstart:function(F){return false;},children:[{scriptClass:"mstrmojo.WH.DBRoleSelector",slot:"topItem",alias:"topPanel"},{scriptClass:"mstrmojo.Box",slot:"bottomItem",alias:"bottomPanel",cssClass:"mstrmojo-qb-WarehouseTableSection",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,cssClass:"mstrmojo-qb-DBRoleSelector-header",layout:[{cells:[{cssText:"padding-left: 5px; padding-right: 5px;"},{cssText:"height: 20px; padding-right: 3px;"}]}],children:[{scriptClass:"mstrmojo.Label",slot:"0,0",cssClass:"mstrmojo-qb-DBRoleSelector-header",text:mstrmojo.desc(9142,"Available Tables")},{scriptClass:"mstrmojo.Button",slot:"0,1",iconClass:"mstrmojo-ArchitectListIcon info",cssText:"float:right;",ontitleChange:function(){this.render();},bindings:{visible:function(){return this.parent.parent.parent.sptCache;},title:function(){return this.parent.parent.parent.catalogStamp;}}}]},{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"actionbar",cssClass:"mstrmojo-Architect-SearchBoxContainer",children:[{scriptClass:"mstrmojo.SearchableDropDownList",cssDisplay:"block",alias:"NameSpaces",popupCssClass:"mstrmojo-qb-ScrollingPulldown",cssText:"margin-top:5px;margin-bottom:5px;margin-left:5px;padding:0px; 5px;",slot:"0,0",itemField:"ns",itemIdField:"ns",visible:true,searchEnabled:true,fixWidth:true,applyChange:function(){if(!this.visible||this.value===null){return ;}var F=this.parent.parent.parent.model;if(this.value!=F.SelNameSpaceID){F.set("SelNameSpaceID",this.value);}else{this.items=this.allItems;this.set("text",this.value);}},onblur:function(F){this.applyChange&&this.applyChange();},onEnter:function(){this.applyChange&&this.applyChange();},onEsc:function(){this.items=this.allItems;this.set("value",this.parent.parent.parent.model.SelNameSpaceID);this.set("text",this.value);},getDisplayValue:function(){return this.items.length&&this.items[this.selectedIndex===-1?0:this.selectedIndex].n;},loadNameSpaces:function(F){var H=this.parent.parent,J=H.parent.model,G=J.namespaces,I=J.usecCache;this.set("visible",I);this.parent.actionBarRefresh.set("visible",I);H.searchbar.searchBarRefresh.set("visible",(!this.visible));H.searchbar.SearchBox.onwidthChange();H.onheightChange();this.set("allItems",G);this.set("items",G);if(this.visible){this.set("value",J.namespaces[0].ns);}},onvalueChange:function(F){var G=this.parent.parent.parent.model;G.set("SelNameSpaceID",F.value);this.defaultText=F.value;},onwidthChange:function(F){if(this.domNode){this.domNode.style.width=parseInt(this.parent.parent.width)-36+"px";}},onRender:function(){this.domNode.style.width=parseInt(this.parent.parent.width)-36+"px";var F=this.parent.parent.parent.model;if(!F||!F.usecCache){var G=this.parent.parent;this.set("visible",false);this.parent.actionBarRefresh.set("visible",false);G.searchbar.searchBarRefresh.set("visible",true);G.searchbar.SearchBox.onwidthChange();G.onheightChange();}}},{alias:"actionBarRefresh",scriptClass:"mstrmojo.Button",slot:"0,1",title:mstrmojo.desc(773,"Refresh"),iconClass:"mstrmojo-ArchitectListIcon refresh",cssText:"float:right;",visible:false,onclick:function(G){var I=this.parent.parent,H=I.parent.model;I.searchbar.SearchBox.clearSearch(true);if(H){if(H.SelDBRoleID!=null){H.catalogRefresh=true;var F=I.DBTableTree;F.clearSelect();F.set("items",[]);F.blockBegin=0;F.getContent(F,0);}}}}]},{scriptClass:"mstrmojo.Table",rows:1,cols:2,alias:"searchbar",cssClass:"mstrmojo-Architect-SearchBoxContainer",children:[{alias:"SearchBox",slot:"0,0",cssClass:"searchbox",scriptClass:"mstrmojo.Widget",markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-Architect-SearchBox {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" mstrAttach:keyup,blur/></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-Architect-SearchBox-search" id="{@id}sbClear" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;}},onclick:function(G){var F=G.hWin,H=G.e||F.event,J=H.target||H.srcElement,I=J&&J.id;switch(I.replace(this.id,"")){case"sbSearch":if(this.onEnter&&H.keyCode===13){this.onEnter();}this._onsearch();break;case"sbClear":this.clearSearch();break;}},clearSearch:function(F){this.inputNode.value="";this.parent.parent.parent.model.filterText="";A.removeClass(this.clearNode,["show"]);if(!F){this._onsearch(true);}},onkeyup:function E(G){var F=G.hWin,I=G.e||F.event;var H=mstrmojo.string.trim(this.inputNode.value);if(this.clearNode){A.toggleClass(this.clearNode,["show"],H.length>0);}if(this._searchTimer){self.clearTimeout(this._searchTimer);}me=this;this._searchTimer=self.setTimeout(function(){me._onsearch();},500);},_onsearch:function(G){var I=this.parent.parent,F=I.DBTableTree,H=I.parent.model;F.clearSelect();F.set("items",[]);F.blockBegin=0;if(H.SelDBRoleID!=null){H.filterText=mstrmojo.string.trim(this.inputNode.value+"").toUpperCase();F.getContent(F,0);}},enableMatchCase:false,onwidthChange:function(F){if(this.domNode){this.inputNode.style.width=parseInt(this.parent.parent.width)-63+"px";}},onRender:function(){this.inputNode.style.width=parseInt(this.parent.parent.width)-63+"px";}},{alias:"searchBarRefresh",scriptClass:"mstrmojo.Button",slot:"0,1",title:mstrmojo.desc(773,"Refresh"),iconClass:"mstrmojo-ArchitectListIcon refresh",cssText:"float:right;",visible:true,onclick:function(G){var I=this.parent.parent,H=I.parent.model;this.parent.SearchBox.clearSearch(true);if(H){if(H.SelDBRoleID!=null){H.catalogRefresh=true;var F=I.DBTableTree;F.clearSelect();F.set("items",[]);F.blockBegin=0;F.getContent(F,0);}}}}]},{alias:"DBTableTree",scriptClass:"mstrmojo.WH.TableTree",bindings:{allowdragstart:"this.parent.parent.allowdragstart",onItemdragmove:"this.parent.parent.onItemdragmove",onItemdragend:"this.parent.parent.onItemdragend",onTabledblclick:"this.parent.parent.onTabledblclick",onColumndblclick:"this.parent.parent.onColumndblclick"}}],onheightChange:function(F){var H=(this.actionbar.NameSpaces.visible)?88:57,G=(F)?parseInt(F.value,10):parseInt(this.height,10);this.DBTableTree.set("height",G-H+"px");},onwidthChange:function(F){var G=parseInt(F.value,10);this.searchbar.SearchBox.set("width",G+"px");this.actionbar.NameSpaces.set("width",G+"px");}}],toggleLoadingStatus:function B(F){A.toggleClass(this.bottomPanel.DBTableTree.domNode,["loading"],F.value);},clearBottomPanel:function D(G){var F=this.bottomPanel,H=F.actionbar.NameSpaces;F.DBTableTree.set("items",[]);H.set("items",[]);H.set("text","");H.value=null;F.searchbar.SearchBox.clearSearch(true);},updatecatalogStamp:function(F){var G=F.value;this.set("sptCache",!!G);this.set("catalogStamp",G);},setDBRoleID:function(F){this.model&&this.model.set("SelDBRoleID",F);},getDBRoleID:function(){return this.model.SelDBRoleID;},getDBRole:function(G){var F=C.find(this.model.dbrs,"did",G);return(F>=0)?this.model.dbrs[F]:null;},getDBRoles:function(){return this.model.dbrs;},setSelectedTables:function(F){var G=this.bottomPanel.DBTableTree;G.setSelectedTables(F);},getSelectedTables:function(){var F=this.bottomPanel.DBTableTree;return F.getSelectedItems();},getTableColumns:function(F,G){this.model.getColumnsForDBTable(F,G);},load:function(){this.model=new mstrmojo.WH.WHModel({});var H=this.model;if(!H){mstrmojo.alert("You need to define a model!");return ;}this.topPanel.initModel(H);this.bottomPanel.DBTableTree.set("model",H);H.attachEventListener("dbrsChange",this.topPanel.id,"load");var I=this.bottomPanel.actionbar.NameSpaces.id;H.attachEventListener("namespacesChange",I,"loadNameSpaces");H.loadDBRoles();var G=this.id;H.attachEventListener("dbroleSelection",G,"clearBottomPanel");H.attachEventListener("loadNamespaces",G,"toggleLoadingStatus");H.attachEventListener("namespaceSelection",this.bottomPanel.DBTableTree.id,"dbroleSelectHandler");H.attachEventListener("namespaceSelection",this.bottomPanel.searchbar.SearchBox.id,function F(){this.clearSearch(true);});H.attachEventListener("catalogStampChange",G,"updatecatalogStamp");if(this.onDBRoleSelection){H.attachEventListener("dbroleSelection",G,this.onDBRoleSelection);}if(this.onDBTablesChange){H.attachEventListener("dbTablesChange",G,this.onDBTablesChange);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.WidgetList","mstrmojo.qb.FilterTree","mstrmojo.CustomGroupEl","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ConditionNode","mstrmojo._IsPopup");var D=mstrmojo.hash,E=mstrmojo.array,J=mstrmojo.expr,F=J.BRANCH_FNS,L=mstrmojo.dom;function B(M){if(!M){return undefined;}var N=M.nds;if(!N){return M;}E.forEach(N,function(P,O){N[O]=B(P);});M.nds=N.slice(0);return M;}function G(M,O,N){E.forEach(M,function(Q,P){if(Q.nds){G(Q.nds,O,N);}else{if(Q===O){M[P]=N;}}});}function K(N,M){var O=N.data;mstrApp.getRootController().openExpressionEditor({n:M?mstrmojo.desc(5893,"New Condition"):mstrmojo.desc(7953,"Condition Editor"),tkn:M?[]:O.expr,callbacks:{success:function P(R){var T={0:"filterExpr",1:"aggfilterExpr"},Q=R.mi,S=Q.exp.sqltp;var U={et:"*",expr:Q.tknstrm.mi.tkn,n:R.expr,sqltp:S};if(M){N[T[S]].newCondition(U);}else{if(O.sqltp===S){G(N.tree.items,N.data,U);N.data=U;N.paint();}else{N.del();N.tree.parent[T[S]].newCondition(U);}}}}});}mstrmojo.qb.ConditionEditor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.qb.ConditionEditor",cssClass:"mstrmojo-qb-filterEditor",title:mstrmojo.desc(2550,"Filters"),ondataChange:function C(){var M=this.CEl,O=this.data,N=O.having,P=O.where;M.filterExpr.set("items",[]);M.filterExpr.add(P?[P]:[],0);M.aggfilterExpr.set("items",[]);M.aggfilterExpr.add(N?[N]:[],0);},children:[{scriptClass:"mstrmojo.CustomGroupEl",cssClass:"mstrmojo-architect-filterTreeBox",alias:"CEl",markupString:'<div id="{@id}" class="mstrmojo-onhoverparent mstrmojo-CustomGroupEl {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-cond-details" {@cssClass}"><div class="mstrmojo-qb-expr-tools {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"><br></div><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div></div></div>',markupMethods:{onstateChange:function(){this.detailsNode.style.display=this.state?"block":"none";}},markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},detailsNode:function(){return this.domNode.lastChild;},exprNode:function(){return this.domNode.lastChild.children[2];},expr2Node:function(){return this.domNode.lastChild.children[4];},exprToolsNode:function(){return this.domNode.lastChild.firstChild;}},parent:this.parent,children:[{scriptClass:"mstrmojo.qb.FilterTree",slot:"exprNode",alias:"filterExpr",onexprclick:function A(M){K(M,false);}},{scriptClass:"mstrmojo.qb.FilterTree",slot:"expr2Node",alias:"aggfilterExpr",onexprclick:function A(M){K(M,false);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-addCondition",text:mstrmojo.desc(1994,"Add Condition"),slot:"exprToolsNode",onclick:function(){K(this.parent,true);}}],state:true}],buttons:[{scriptClass:"mstrmojo.HTMLButton",text:mstrmojo.desc(3415,"OK"),onclick:function I(){var N=this.parent.parent,M=N.CEl;mstrApp.getRootController().updateFilters(B(M.filterExpr.items[0]),B(M.aggfilterExpr.items[0]));N.set("visible",false);}},{scriptClass:"mstrmojo.HTMLButton",text:mstrmojo.desc(3416,"Cancel"),onclick:function I(){var O=this.parent.parent,N=O.CEl,P=O.data;if(D.equals(B(N.filterExpr.items[0]),P.where)&&D.equals(B(N.aggfilterExpr.items[0]),P.having)){O.set("visible",false);return ;}var M=mstrmojo.Button.newInteractiveButton;mstrmojo.confirm("All your changes on the filter will be lost. Do you want to exit?",[M(mstrmojo.desc(3415,"OK"),function Q(){O.set("visible",false);},null,{onRender:function(){if(mstrApp.isCloud){mstrmojo.css.addClass(this.domNode,"cloud");}}}),M(mstrmojo.desc(3416,"Cancel"),mstrmojo.emptyFn,null,{onRender:function(){if(mstrApp.isCloud){mstrmojo.css.addClass(this.domNode,"cloud cancel");}}})],"Lose Your Changes?");}}],getMovingHandle:function H(){return this.children[0].domNode;},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",cssText:"width: auto;",contentNodeCssClass:"mstrmojo-balloon",left:"250px",top:"15px",slot:"containerNode",autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var M=this.condition,P=M&&M.data&&M.data.not,R=M&&M.parent,N=R&&R.data,O=(N&&N.fn)+(P?21:0),Q=this.list;Q.opening=true;Q.set("selectedItem",isNaN(O)?null:{did:O});Q.opening=false;this.curtainNode.style.position="fixed";},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:F[19]},{did:20,n:F[20]},{did:19+21,n:F["19_21"]},{did:20+21,n:F["20_21"]}],onchange:function(){if(this.opening){return ;}var N=this.parent,M=N.condition,S=this.selectedItem,R=S&&S.did,Q=R>21?true:null,P=R-(Q?21:0);N.close();var O=M&&M.parent;if(O&&O.data&&O.data.et===J.ET.ANDOR){O.edit(M,P,Q);}else{var T=M&&M.data;if(T&&(T.not!==Q)){T.not=Q;M.paint();}}}}]},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onTab:function(N){if(this.onEnter){this.onEnter();}var M=L.shiftKey(N.hWin,N.e)?this.prevTab:this.nextTab;if(M&&M.onclick){M.onclick();}},onblur:function(){if(this.onEnter){this.onEnter();}},onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var N=this.txt,M=this.txtConfig;D.forEach(M,function(O){N.set(O,M[O]);});N.focus();},onClose:function(M){if(!M||(!M.cancel&&!M.enter)){this.txt.onEnter();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.qb.QBPreview");var B=mstrmojo.css;var C=20;mstrmojo.qb.QBMappings=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.QBMappings",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},cssClass:"mstrmojo-di-datapreview",cssText:"position:relative;overflow-x:hidden;overflow-y:auto;border:0px solid lightGrey;border-width:1px;border-bottom-right-radius:6px;border-bottom-left-radius:6px;",width:0,height:0,dropZone:false,active:false,children:[{scriptClass:"mstrmojo.qb.QBPreview",alias:"content",columns:[],cssText:"width:100%"},{scriptClass:"mstrmojo.Label",alias:"notice",cssClass:"warnLabel",text:"No preview available."}],handleDataPreview:function A(){mstrApp.getRootController().toggleDataPreview(true);var D=mstrmojo.all.QBuilderModel,E=this.content,F=this.notice,G=(D.mappings&&D.mappings.length>0);E.model=D;E.set("visible",G);F.set("visible",!G);G&&E.populatePreview();},onheightChange:function(D){if(this.domNode){this.domNode.style.height=Math.max(parseInt(D.value,10)-2,0)+"px";}},postCreate:function(){mstrmojo.all.QBuilderModel.attachEventListener("dataPreview",this.id,"handleDataPreview");}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.SearchWidget","mstrmojo.SaveAsEditor","mstrmojo.ME._MetricEditorHelper");var G=mstrmojo.hash;var F={n:mstrmojo.desc(9590,"Search Result"),did:-1,fns:[]},C={n:mstrmojo.desc(4561,"All Functions"),did:-2,fns:[]},A={n:mstrmojo.desc(9591,"Metric Templates"),did:-3,fns:[{n:mstrmojo.desc(3273,"Level"),did:-4,desc:mstrmojo.desc(9592,"Create a level metric.")},{n:mstrmojo.desc(9579,"Condition"),did:-5,desc:mstrmojo.desc(9593,"Create a conditional metric.")},{n:mstrmojo.desc(3324,"Transformation"),did:-6,desc:mstrmojo.desc(9594,"Create a transformation metric.")}]},D={n:mstrmojo.desc(4565,"Select a category:"),did:-4,fns:[]};var B=function(H){var I=H.functionList;H.openWizard(I.items[I.selectedIndex]);};mstrmojo.ME.FunctionSelector=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.FunctionSelector",cssClass:"mstrmojo-FunctionSelector",title:mstrmojo.desc(9595,"Select a function or template"),help:"Select_a_Function_dialog_box.htm",functions:null,selectedCategory:1,selectedIndex:-1,getFunctionSyntax:function(O,J){var N=this.functions;if(!N){return"";}var M=N[O].fns[J];if(M.did<0){return M.n;}var L=M.pars,I=[],K,H;I.push(M.n);I.push("(");for(K=0,H=L.length;K<H;K++){I.push(L[K].n);if(K!==(H-1)){I.push(", ");}}I.push(")");return I.join("");},getFunctionDesc:function(K,H){var J=this.functions;if(!J){return"";}var I=J[K].fns[H];return I.desc;},getFunctionHelpTopic:function(K,H){var J=this.functions;if(!J){return"";}var I=J[K].fns[H];return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(I.h);},getMetricDefAsTokens:function(){return this.getTokens();},getTokens:function E(){var I=this.functionList,H=I.items[I.selectedIndex],J=[];if(H){J.push({v:H.n,oi:H,isNew:true});}return J;},onOpen:function(){this.selectedCategory=1;this.set("selectedCategory",0);this.set("selectedIndex",-1);if(!this.functions.add){this.functions=G.make(this.functions,mstrmojo.Arr);}var I=this.functions,H=I.length;if(H>=1&&I[H-1].did!=A.did){I[H]=A;}},onClose:function(){this.searchWidget.clearSearch();},clearSearchResult:function(){var I=this.fcHBox.fcPulldown,J=this.functions,H=J.length-1;if(J[H]===F){if(this.selectedCategory===H){this.set("selectedCategory",0);this.set("selectedIndex",-1);}J.remove(H);I.refresh();}},wizard:{scriptClass:"mstrmojo.ME.FunctionWizard"},simpleMetricRef:{scriptClass:"mstrmojo.ME.SimpleMetricEditor"},metricEditorRef:{scriptClass:"mstrmojo.ME.MetricEditor"},openWizard:function(J){var I=this;if(mstrmojo.ME.MetricDataService.isBasicAggMap(J.did)||J.did<-1){var H={zIndex:I.zIndex+10,did:J.did,oi:I.oi};H.insertMode=false;I.openPopup("simpleMetricRef",H);}else{I.openPopup("wizard",{functions:mstrmojo.ME.MetricDataService.getFunctionCatList(),fctOi:J,zIndex:I.zIndex+10,oi:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}}});}},children:[{scriptClass:"mstrmojo.Label",cssText:"left:0;background:#f2f2f2; height:40px; position:absolute; width:100%;"},{scriptClass:"mstrmojo.SearchWidget",alias:"searchWidget",cssText:"margin: 5px 0 15px 5px;",width:"330px",quickSearch:true,placeholderText:mstrmojo.desc(9168,"Type to search"),onsearch:function(P){var H=this.parent,N=H.functionList,O=H.fcHBox.fcPulldown,L=H.functions,M=function(Q){return(new RegExp(P,"i")).test(Q.n);},J=[],I,K;for(I=0,K=L.length;I<K;I++){if(L[I]===F||L[I].did===C.did){continue;}J=J.concat(mstrmojo.array.filter(L[I].fns,M));}F.fns=J;if(L[L.length-1]!==F){L.add([F]);}O.refresh();H.set("selectedCategory",0);H.set("selectedCategory",L.length-1);H.set("selectedIndex",-1);},onclear:function(H){this.parent.clearSearchResult();}},{scriptClass:"mstrmojo.HBox",alias:"fcHBox",cssText:"margin-top: 5px; width:100%;",children:[{scriptClass:"mstrmojo.Pulldown",alias:"fcPulldown",itemIdField:"did",itemField:"n",items:[],bindings:{items:function(){var J=this.parent.parent.functions,K=[];if(!J){return J;}mstrmojo.array.forEach(J,function(L){mstrmojo.array.forEach(L.fns,function(M){K.push(M);});});var H=function(M,L){return mstrmojo.array.stringSorter(M.n,L.n);},K=K.sort(H);if(J[0].did!=C.did){var I=C;I.fns=K;J.unshift(I);}return J;},selectedIndex:"this.parent.parent.selectedCategory",value:function(){var H=this.parent.parent.selectedCategory;return this.items[H][this.itemIdField];}},onvalueChange:function(){var H=this.parent.parent;H.set("selectedCategory",this.selectedIndex);H.set("selectedIndex",-1);}}]},{scriptClass:"mstrmojo.List",alias:"functionList",itemIdField:"dssid",itemField:"n",cssClass:"mstrmojo-FE-functionList mstrmojo-suggest-list",itemMarkupFunction:function(J,H,I){return'<div class="mstrmojo-suggest-text">'+J[I.itemField]+"</div>";},bindings:{items:function(){var H=this.parent.functions,I=this.parent.selectedCategory;return H[I].fns;},selectedIndex:"this.parent.selectedIndex"},onchange:function(H){this.parent.set("selectedIndex",this.selectedIndex);},ondblclick:function(){var H=this.parent;B(H);H.close();}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[G.copy({cssClass:"mstrmojo-Button  mstrmojo-HTMLButton mstrmojo-Editor-button ",cssText:"text-align: center; float:left;",text:mstrmojo.desc(9596,"Use Formula Editor"),title:mstrmojo.desc(9597,"Build a metric formula using metrics, facts, attributes and functions."),getEditor:function(){return this.parent.parent;}},G.copy(mstrmojo.ME._MetricEditorHelper.switchRef)),{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1059,"Next"),onclick:function(){var H=this.parent.parent;B(H);H.close();},bindings:{enabled:function(){return this.parent.parent.functionList.selectedIndex>-1;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var H=this.parent.parent;H.close();}}]},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FE-functionSyntax",slot:"editorNode",bindings:{text:function(){return this.parent.getFunctionSyntax(this.parent.selectedCategory,this.parent.selectedIndex);},visible:function(){return this.text.length>0;}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FE-functionDesc",slot:"editorNode",bindings:{text:function(){var I=this.parent,J=this.parent.selectedCategory,H=this.parent.selectedIndex;return I.getFunctionDesc(J,H)+"  "+I.getFunctionHelpTopic(J,H);},visible:function(){return this.text.length>0;}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Editor","mstrmojo.List","mstrmojo.SaveAsEditor","mstrmojo.ME.MetricEditBox","mstrmojo.ME.FunctionSelector","mstrmojo.qb.FunctionWizard","mstrmojo.MenuButton","mstrmojo.qb.FFsqlToken","mstrmojo.array");var N=mstrmojo.string,V=mstrmojo.dom,W=mstrmojo.css,S=mstrmojo.hash,O=mstrmojo.range,U=mstrmojo.array,E=mstrmojo.all.QBuilderModel;_VSTATUS={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3},_VSTATUSCSS={0:"valid",1:"unknown",2:"validating",3:"error"},_VSTATUSDESC={0:mstrmojo.desc(9105,"Valid Expression Formula."),1:mstrmojo.desc(9106,"Require Validation?"),2:mstrmojo.desc(9107,"Validation in Progress..."),3:mstrmojo.desc(9108,"Validation Failed with Syntax Error")};var A=0,X=3;function P(Y){if(!Y){return _VSTATUS.VALID;}return{"-2147214845":_VSTATUS.ERROR}[Y]||_VSTATUS.ERROR;}function J(b){var Y=[],a,Z;for(a=0,len=b.length;a<len;a++){Y[a]=b[a].v;}return Y.join("").replace(/<\s/g,"<").replace(/>\s/g,">");}function H(h,c,f){var b="",Y=1,g="",Z=null,a=this.exprEditBox.inputBox;if(a.doubleByte){g=a.editNode.innerText||a.editNode.textContent;a.ime=false;}else{if(this.oi.type!==0&&this.oi.type!==3){g=J(a.items);Y=2;}else{b=R(a.items);}}if(h){Z=1;}var d=this;mstrApp.getRootController().parseExpression({expr:g,tKnStrm:b,isNew:true,qbrex:Y,vo:Z,cIndex:f},{success:function(l){if(l&&l.mi&&l.mi.tknstrm.mi){var k=l.mi.exp.sqltp;if(k!=null){d.sqltp=k;}d.exprEditBox.handleValidation(l.mi,!h);if(!l.mi.reject_error_code&&c&&c.success){c.success(l);}else{c&&c.failure&&c.failure();}}}});}function R(a){var a=Q(a);var Z={v:true,tp:true,lv:true,n:true,did:true,t:true,st:true,cn:true,mi:true,omit:true,extra:true,tknctx:true,sqlti:true,tindex:true,cli:true,sta:true,tindex:true,ix:true},Y={getArrItemName:function(d,b,c){return"tkn";},isSerializable:function(d,c,b){return(Z[d])?true:false;}};return mstrApp.getRootController().exprjson2xml("mi",a,Y);}function B(a){var Y=a.length,Z=a[Y-1];if(Z&&Z.tp===-1){a.pop();}if(a[0]&&(a[0].tp===64||(a[0].tp===36&&a[0].v==="$"))){a.splice(0,1);}}function Q(g){var c=g,Z=c.length,f=c[c.length-1],b,d,a=[],Y="";if(c[0]&&c[0].tp!==64){a.push({v:"",tp:64,lv:3,sta:1});}for(b=0,Z=c.length;b<Z;b++){d=c[b];if(!d.oi){Y+=d.v;}else{if(!N.isEmpty(Y)){a.push({v:Y,tp:2,lv:1});Y="";}d.lv=1;d.tp=2;d.sta=1;a.push(d);}}if(!N.isEmpty(Y)){a.push({v:Y,tp:2,lv:1});Y="";}if(f&&f.tp!==-1){a.push({v:"",tp:-1,lv:2,sta:1});}return{omit:a,cn:a.length};}function L(Y){return["[",Y,"]"].join("");}mstrmojo.qb.ExpressionEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.ExpressionEditor",cssClass:"mstrmojo-MetricEditor",zIndex:70,title:mstrmojo.desc(4449,"Expression"),functionSelector:{scriptClass:"mstrmojo.ME.FunctionSelector"},wizard:{scriptClass:"mstrmojo.qb.FunctionWizard"},model:null,onfunclistChange:function I(){this.toolBox.toolBar.func.set("cm",[{n:mstrmojo.desc(9925,"Functions"),did:-3,fns:this.funclist}]);},onOpen:function D(){var b=this,a=this.oi,f=this.exprEditBox,g=f.inputBox;g.customFunctionMode=false;g.doubleByte=false;a.isSave=false;this.set("funclist",(this.funclist||mstrApp.getRootController().getFunctionList()));var d={items:mstrApp.getRootController().getSuggestionItems(false),isComplete:true};g.set("candidates",d);b.set("candidates",d);f.set("iStatus","");f.set("vStatus",0);var Z={0:mstrmojo.desc(4449,"Expression"),1:mstrmojo.desc(9109,"Filter Expression"),3:mstrmojo.desc(4449,"Expression")},c={0:(mstrApp.helpTopics&&mstrApp.helpTopics.expression)||"expression_dialog_box.htm",3:(mstrApp.helpTopics&&mstrApp.helpTopics.expression)||"expression_dialog_box.htm"};this.set("title",[Z[a.type]||"",a.n].join(""));this.set("help",c[a.type]||((mstrApp.helpTopics&&mstrApp.helpTopics.condition)||"new_condition_dialog_box.htm"));var Y;if(a&&(Y=S.clone(a.tkn))){B(Y);g.set("items",Y);}},onClose:function C(){var Y=this.exprEditBox.inputBox;Y.set("items",[]);Y.itemcount=0;},children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-toolBox",alias:"toolBox",children:[{scriptClass:"mstrmojo.Label",cssText:"font-size: 10pt",text:mstrmojo.desc(4449,"Expression")+":"},{scriptClass:"mstrmojo.ToolBar",cssClass:"mstrmojo-oivmSprite grouped",alias:"toolBar",cssText:"float: right",children:[{scriptClass:"mstrmojo.MenuButton",alias:"func",iconClass:"tbInsert",title:mstrmojo.desc(2919,"Insert"),zIndex:80,itemIdField:"did",itemField:"n",itemChildrenField:"fns",isSeparatorItem:function M(Y){return Y[this.itemIdField]===-1;},executeCommand:function T(Z){var Y=this.parent.parent.parent,a=Y.exprEditBox.inputBox;if(Z.did===-999){Y.openPopup("functionSelector",{functions:Y.funclist,zIndex:Y.zIndex+10,openWizard:function(b){Y.openPopup("wizard",{fctOi:b,zIndex:Y.zIndex+10,insertOnFinish:function(c){a.insertTokens(c);}});}});}else{Y.openPopup("wizard",{fctOi:Z,zIndex:Y.zIndex+10,insertOnFinish:function(b){a.insertTokens(b);}});}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(9110,"Syntax Validation"),iconClass:"tbValidate",onclick:function(Y){var Z=this.parent.parent.parent;H.call(Z,true,null,1);}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(2827,"Clear"),iconClass:"tbClear",onclick:function(Y){var Z=this.parent.parent.parent,a=[];Z.oi.tkn=a;Z.exprEditBox.inputBox.clearTokens(a);}}]}]},{scriptClass:"mstrmojo.ME.MetricEditBox",alias:"exprEditBox",children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",cssText:"height:100px;",browseItemVisible:false,renderBlockSize:1000,item2textCss:function K(Y){return{11:" mstrmojo-ArchitectListIconSuggest t11 ",26:" mstrmojo-ArchitectListIconSuggest t26 "}[Y.t]||"";},itemFunction:function G(b,Y,Z){return new mstrmojo.ME.MetricToken({data:b,brackets:L,isDelimiter:function a(){return this.data.isDelimiter||(this.length()===1&&mstrmojo.qb.FFsqlToken.isDelimiter(this.data.v));}});},isDelimiter:mstrmojo.qb.FFsqlToken.isDelimiter}],markupMethods:{onvStatusChange:function(){var Z=this.vStatus,Y=this.vStatusNode;Y.className="mstrmojo-MEBox-vStatus "+_VSTATUSCSS[Z];Y.innerHTML=_VSTATUSDESC[Z];},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;}},handleValidation:function F(b,c){if(!b){this.set("vStatus",_VSTATUS.ERROR);return ;}b.vs=P(b.reject_error_code);this.set("vStatus",b.vs);this.set("iStatus",b.reject_error_description||"");var g=b.tknstrm.mi.tkn;var f=[],d,Y=".",a,Z;U.forEach(g,function(k,h){f[h]={};if(k.tp===304&&!/^'.*'$/.test(k.v)){k.v=["'",k.v,"'"].join("");}if(k.tknctx){d=k.v;a=d.lastIndexOf(Y);if(a<1){Z=k.extra.sqlti.als;k.v=L([Z,Y,d].join(""));f[h].oi={tn:Z,rn:d,tp:26};}else{k.v=L(d);f[h].oi={tn:d.slice(0,a),rn:d.slice(a+1),tp:26};}}if(k.orf){f[h].oi=k.orf;k.v=[" ",k.v," "].join("");}f[h].v=!k.v||(typeof k.v)==="string"?k.v:k.v.toString();f[h].sta=k.sta;});this.inputBox.set("items",f);if(!c){this.inputBox.focus();}}},{scriptClass:"mstrmojo.HBox",cssText:"float: right; border-collapse: separate;margin:10px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(5891,"Save"),onclick:function(){var f=this.parent.parent,g=f.oi,b=g.type,a=mstrmojo.all[g.did],Y=g.w,c=f.exprEditBox.inputBox,Z=J(c.items);g.isSave=true;var d=function d(k){H.call(f,false,{success:function(){mstrApp.getRootController().updateTableViewWithExpression(k.cIndex,c.items);f.close();}},k.cIndex);};switch(b){case A:H.call(f,true,{success:function h(){mstrApp.getRootController().addSelectedColumn(Y,Z,{success:d});}},1);break;case X:d({cIndex:g.cIndex});break;default:H.call(f,true,mstrmojo.func.wrapMethods(g.callbacks,{success:function h(k){f.close();}}));}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var Y=this.parent.parent;Y.close();}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.string","mstrmojo.form","mstrmojo.qb.ExpressionEditor","mstrmojo.qb.MissingColumnWarning","mstrmojo.qb.DataService");mstrmojo.requiresDescs(9945,9946,9926,219,218,1442,9220,9221,9222,9223,9224,9225,9226,9227,9228,9229,9230);var U=mstrmojo.string,k=mstrmojo.hash,t=mstrmojo.array,r=mstrmojo.css,A=mstrmojo.desc,An=U.decodeHtmlString;var q="A61B85F4485D3B953003B195E58B5138";var Q=15;var C=12,Al=4;var AW=1,A3=2,x=4,S=15,A5=1,c=2,l=4,AS=8,f=1,Ab=2,d=8,Ax=16,L=1,Av=0;var Y=1,T=2,A8=3,P=4;var Ai=2,AG=4;var g="-2147216373";var W=2147760371,AA=2147760372,h=2147758245,N=2147759877;function z(BP){var BQ=BP&&BP.getResponseHeader("X-MSTR-TaskErrorCode");BQ=(BQ<0)?(4294967296+parseInt(BQ,10)):BQ;switch(BQ){case W:case AA:case h:case N:return true;}return false;}function G(BP,BQ){if(z(BP)){if(mstrApp.isCloudPro){rrOpenHomePage&&rrOpenHomePage();}else{mstrmojo.form.send({evt:"3010"},mstrApp.name,"POST",null,null,false);}}else{var BR=BP.getResponseHeader("X-MSTR-TaskFailureMsg");if(BR){BR=(BR.length>2000)?BR.substring(0,2000)+"...":BR;mstrmojo.alert(BR.replace(/com\.microstrategy(\.\w+)*: \(?/,"").replace(/\)$/,""),BQ);}else{BR=BP.responseText;BR=BR&&BR.match(/\[HttpException \(0x80004005\): (.)+\]/);mstrmojo.alert((BR&&BR[0]&&BR[0].replace(/\[HttpException \(0x80004005\): |\]/gi,""))||"Request timed out.");}}}function Aa(BR){if(!BR||!BR.length){return ;}var BQ=BR[BR.length-1];if(BQ&&BQ.tp===-1){BR.pop();}if(BR[0]&&(BR[0].tp===64||(BR[0].tp===36&&BR[0].v==="$"))){BR.splice(0,1);}var BP="'";t.forEach(BR,function(BS){(BS.tp===304)&&(BS.v=BP+BS.v+BP);});}function X(BQ){var BP=[];t.forEach(BQ,function(BR){BP.push(BR.v);});return BP.join(" ").replace(/<\s/g,"<").replace(/>\s/g,">");}function BM(BQ){var BP={">=":2,"<>":5,"<=":4,"<":3,">":1},BR;for(BR in BP){if(BQ.indexOf(BR)>-1){return BP[BR];}}return 0;}function F(BT){var BQ=function(BV,BU){return mstrmojo.array.stringSorter(BV.n||BV.did,BU.n||BU.did);},BR,BP,BS=[];t.forEach(BT,function(BU){t.forEach(BU.fns,function(BV){if(t.indexOf(BB,BV.did)>-1){BU.fns=BU.fns.sort(BQ);BS.push(BU);return false;}});});BS=BS.sort(BQ);return BS;}var A9={1:"Sum",2:"Avg",3:"Min",4:"Max",5:"Count",6:"Count<Distinct=true>"};var BB=["8107C31BDD9911D3B98100C04F2233EA","6F7DF5F8449111D5BEA300B0D01A55EF","4A257916A153468384320E8DB7FD338B","8107C345DD9911D3B98100C04F2233EA","6F7DF605449111D5BEA300B0D01A55EF","8107C324DD9911D3B98100C04F2233EA","F262C81CDDA611D3B98100C04F2233EA"];function AX(BV,BQ){if(!BV){return false;}var BT=BV.nds;if(BT){var BU=[],BP,BR;t.forEach(BT,function(BX,BW){AX(BX,BQ)&&BU.push(BW);});for(BP=BU.length-1;BP>-1;BP--){BT.splice(BU[BP],1);}BR=BT.length;if(BR===1){BV=BT[0];}return(BR===0);}var BS;t.forEach(BV.expr,function(BW){oi=BW.tknctx&&BW.tknctx.oi;if(oi&&oi.tp===26&&BQ===BW.extra.sqlti.als.toLowerCase()){BS=true;return false;}});if(!BS){t.forEach(BV.cols,function(BW){if(BQ===BW.t.toLowerCase()){BS=true;return false;}});}return BS;}function Ah(BT,BP,BU){if(!BU){return ;}var BS=BU.expr,BQ,BR=BU.cols;t.forEach(BS,function(BV){BQ=BV.tknctx&&BV.tknctx.oi;if(BQ&&BQ.tp===26){if(BV.extra.sqlti.als===BT){BV.extra.sqlti.als=BP;BV.v=(BV.v+"").replace(BT,BP);}}});t.forEach(BR,function(BV){if(BV.t===BT){BV.t=BP;BV.v=(BV.v+"").replace(BT,BP);}});BU.n=(BU.n+"").replace(BT,BP);t.forEach(BU.nds,function(BV){Ah(BT,BP,BV);});}function Az(BR,BU){BR=BR||{};if(!BU){return ;}var BT=BU.expr,BQ,BP,BS=BU.cols;t.forEach(BT,function(BV){BQ=BV.tknctx&&BV.tknctx.oi;if(BQ&&BQ.tp===26){BP=BV.extra.sqlti.als.toLowerCase();BR[BP]=BR[BP]||{};BR[BP][BQ.n.toLowerCase()]=true;}});t.forEach(BS,function(BV){BP=BV.t.toLowerCase();BR[BP]=BR[BP]||{};BR[BP][BV.col.toLowerCase()]=true;});t.forEach(BU.nds,function(BV){Az(BR,BV);});}var o=mstrmojo.expr,AI=o.ET,BK=o.BRANCH_FNS,BJ={19:" "+BK[19]+" ",20:" "+BK[20]+" ",21:"("+BK[21]+"( "},BC="))";function BF(BT){if(!BT){return"";}if(!BT.nds){return BT.n||"";}var BR=[],BS=BT.nds,BQ=BT.fn,BP;t.forEach(BS,function(BV,BU){BP=BV.not;if(BU!==0){BR.push(BJ[BQ]);}BP&&BR.push(BJ[21]);BR.push("(");BR.push(BF(BV));BR.push(")");BP&&BR.push(BC);});return BR.join("");}function AK(BP){return An(BP).replace(/&apos;/g,"'");}function Aq(BP){return BP.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;apos;/g,'"').replace(/&apos;/g,"'").replace(/^\n+|\n+$/g,"").replace(/\t/g," ").replace(/&amp;/g,"&");}var A2=function(BP){if(BP==null){return"null";}var BQ=typeof (BP);if(BQ!="object"){return BQ;}else{if(BP.length===undefined){return"object";}else{return"array";}}};var AH=[{n:"Text",v:"3"},{n:"Number",v:"2"},{n:"Date",v:"8"},{n:"Time",v:"9"},{n:"DateTime",v:"1"},{n:"URL",v:"5"},{n:"Email",v:"6"},{n:"HTML Tag",v:"7"},{n:"Symbol",v:"10"},{n:"Big Decimal",v:"11"},{n:"Phone Number",v:"12"}];function Ao(BP){}function BL(BT){var BR=[],BQ=[];var BS={mi:true,cn:true,v:true,tp:true,lv:true,sta:true,tkn:true};BR.push({lv:3,sta:1,tp:64,v:""});BR.push({lv:1,sta:1,tp:2,v:BT});BR.push({lv:2,sta:1,tp:-1,v:""});var BP={getArrItemName:function(BW,BU,BV){return"tkn";},isSerializable:function(BW,BV,BU){return(BS[BW])?true:false;}};BQ.push('<mi cn="3">');BQ.push(U.json2xml("tkn",BR[0],BP));BQ.push(U.json2xml("tkn",BR[1],BP));BQ.push(U.json2xml("tkn",BR[2],BP));BQ.push("</mi>");return BQ.join("");}var A1=0,AN=1,BD=2,Ad=3,AR=4,BN=5,BE=6,AP=7,B=8,AD=9,AC=10,Ac=11,b=12;var Ap={0:A1,1:BD,2:BD,3:BD,4:BD,5:BD,6:BD,7:BD,8:Ad,9:Ad,10:Ad,11:Ad,12:Ad,13:Ad,14:B,15:AD,16:AN,17:Ad,18:Ad,30:Ac,31:A1,33:A1};function Ay(BR,BV){var BT=[],BQ,BU;for(var BS=0,BP=BV.length;BS<BP;BS++){BQ=BV[BS];if(BR.uiids[BQ.tid+BQ.cid]){BU=BR.uiids[BQ.tid+BQ.cid];BT.push(BU);}}return BT;}function AB(BU,BR,BV,BP,Bb,BY){if(!BR.ftype){var BQ=Aq(BR.exp);if(BQ.indexOf("? aptqbr_prompt")>-1){BY.push({n:BQ});return ;}var Bc=Ay(BU,BH(BP,[])),BX,BZ=[];t.forEach(Bc,function(Bd){BX=mstrmojo.all[Bd];BX&&BX.updateState&&BX.updateState(2);BZ.push({t:BX.srcTable,col:BX.text});});return BV.push({et:"*",n:BQ,expr:[{v:BQ}],sqltp:Bb,cols:BZ});}switch(BR.ftype){case 19:case 20:case 21:var BT=[],Ba;for(var BS=0,BW=BR.children.length;BS<BW;BS++){Ba=BR.children[BS];AB(BU,Ba,BT,BP.chn[BS],Bb,BY);}if(BT.length==0){return ;}if(BT.length<BW&&BT.length==1){BV.push(BT[0]);}else{BV.push({et:14,fn:BR.ftype,nds:BT,not:(BR.ftype==21),sqltp:Bb});}break;default:break;}}function V(BR,BT,BP){if(!BT.ftype){BP.push({lcid:BR.chn[0].col,rcid:BR.chn[1].col,exp:BT.exp});return BT.exp;}var BS,BQ,BU;switch(BT.ftype){case 19:case 20:BS=V(BR.chn[0],BT.children[0],BP);BQ=V(BR.chn[1],BT.children[1],BP);BU=BS+((BT.ftype==19)?" AND ":" OR ")+BQ;break;case 21:BU=" NOT "+V(BR.chn[0],BT.children[0],BP);break;default:break;}return BU;}function BH(BR,BS){var BT=BR.chn;if(!BT){if(BR.col&&BR.stbid){BS.push({cid:BR.col,tid:BR.stbid});}return BS;}for(var BQ=0,BP=BT.length;BQ<BP;BQ++){BS=BH(BT[BQ],BS);}return BS;}function Aj(BP,BS,BQ){var BR=BP[BP.length-1].oi.def.csl.roo.chn[0].va.vv;BR=BR?Aq(BR):"";mstrApp.getRootController().raiseEvent({name:"reportModeChange",mode:2,value:BR});BQ.populateFFSQLMapping(BS);if(BQ.firstTimeLoading){BQ.raiseEvent({name:"dataPreview"});BQ.firstTimeLoading=false;}}function E(Bz,BU){if(!Bz||!Bz.btb){return ;}var Bm=Bz.btb;var B4=Bz.datap.maps;if(BU.firstTimeLoading){BU.orimaps=B4;}BU.refresh_opt=Bm[0].oi.def.crpt;var Bl=null;if(Bm[0].oi.ext_type===304){BU.set("isFFSQL",true);BU.set("FFSQLMode",true);mstrApp.isFFSQL=mstrApp.isFFSQLMode=true;for(var CA=0,Bn=Bm.length;CA<Bn;CA++){if(Bm[CA].oi.tp===53){Bl=Bm[CA].oi.def.dbr.did;}}Bl&&BU.setXDADBRole(Bl);Aj(Bm,B4,BU);return ;}var CC={},BR={},BQ,BT;for(var CA=0,Bn=Bm.length;CA<Bn;CA++){BT=Bm[CA].oi;switch(BT.tp){case 53:CC[BT.did]={cs:BT.def.cs.cs,tbn:AK(BT.def.tbn),did:BT.did,ns:BT.def.ns};break;case 26:BR[BT.did]={did:BT.did,cln:AK(BT.def.cln),dttp:BT.def.dt.tp,dtps:BT.def.dt.ps,dtsc:BT.def.dt.sc};break;case 3:BQ=BT.efd;break;default:break;}}var Bo=null,B0=null;for(var CA=0,Bn=BQ.length;CA<Bn;CA++){B0=BQ[CA].oi;switch(B0.tp){case 53:Bo=B0.def.sqs.c_c[0];Bl=B0.def.dbr.did;break;default:break;}}BU.setXDADBRole(Bl);if(Bo===null){return ;}var Bu=Bo.sqcs.c_c;var Bh=Bo.sjs.c_c;var CB=Bo.stbs.c_c;var Bd=Bo.whe;var B2=Bo.w_cond;var CF=Bo.he;var BW=Bo.h_cond;BU.selectedClns=[];BU.dbtables=[];BU.joins=[];BU.joinsInfo={};BU.uiids={};BU.tables={};var B7=BU.selectedClns;var By={},Bk,CD,Bc,Bg,BZ;for(var CA=0,Bn=Bu.length;CA<Bn;CA++){if(Bu[CA].der&2147483648){B7.push({isDerived:true,existing:true});continue;}Bk=BH(Bu[CA].exp.roo,[]);CD=AK(Bu[CA].exp.exp);B7.push({wid:[],expr:[{v:CD}],existing:true});for(var B9=0;B9<Bk.length;B9++){BZ=Bk[B9];Bc=BZ.cid;Bg=BZ.tid;By[Bg]=By[Bg]||{};By[Bg][Bc]=By[Bg][Bc]||{};By[Bg][Bc].state=1;By[Bg][Bc].count=!By[Bg][Bc].count?1:By[Bg][Bc].count+1;B7[CA].wid.push(Bg+Bc);}}BU.populateMappings(B4);BU.raiseEvent({name:"dataPreview"});BU.tbns={};var Bf=BU.pos_hash;var BY=BU.tbns,B8=[];var B5,BX,BV,Bc,Br,B3,Bj;for(var CA=0,Bn=CB.length;CA<Bn;CA++){B8[CA]={};B5=CB[CA];Bg=B5.id;BX=B5.dbt.did;Bj=B5.als?AK(B5.als):CC[BX].tbn;Br=CC[BX].cs;if(Bf&&Bf[Bj]){B8[CA].pos={w:Bf[Bj].w,h:Bf[Bj].h,t:Bf[Bj].t,l:Bf[Bj].l};}else{BV=B5.sqltf;if(BV&&BV.length){B8[CA].pos={w:BV[0].pdv/Q,h:BV[1].pdv/Q,t:BV[2].pdv/Q,l:BV[3].pdv/Q};}}B3=[];for(var B9=0,Bq=Br.length;B9<Bq;B9++){Bc=Br[B9].did;B3.push(k.copy(BR[Bc]));if(By[Bg]&&By[Bg][Bc]){B3[B9].state=1;B3[B9].count=By[Bg][Bc].count;}}B8[CA].did=Bg;B8[CA].cs=B3;B8[CA].tbn=Bj;B8[CA].ns=CC[BX].ns;B8[CA].dbtbn=CC[BX].tbn;BY[Bj]=Bj;}if(BU.firstTimeLoading){BU.orits=B8.slice(0);}var Bi=BU.orits;t.forEach(B8,function(CG){if(t.find(Bi,"did",CG.did)>-1){CG.existing=true;}});BU.raiseEvent({name:"BindingTableLoaded",value:B8});for(var CA=0,Bn=B7.length;CA<Bn;CA++){var B6=B7[CA].wid;if(B6){for(var B9=0,Bq=B6.length;B9<Bq;B9++){B6[B9]=BU.uiids[B6[B9]];}}}var Be,Bw,BS,Ba,Bx,Bs,Bv,BP,CD,Bp,CE;for(var CA=0,Bn=Bh.length;CA<Bn;CA++){Be=Bh[CA];Bw=Be.ltid,BS=Be.rtid,Ba=Be.jt,idx=Be.ix;Bs=Be.cdn.roo;CE=[];CD=AK(V(Bs,Be.exp_bo,CE));Bp=BU.uiids[Bw]+BU.uiids[BS];BU.joins.push(Bp);BU.joinsInfo[Bp]=new Object();BU.joinsInfo[Bp].jt=""+Ba;BU.joinsInfo[Bp].exp=CD;BU.joinsInfo[Bp].srctID=BU.uiids[Bw];BU.joinsInfo[Bp].tgttID=BU.uiids[BS];if(!BU.joinsInfo[Bp].links){BU.joinsInfo[Bp].links=new Object();}if(BU.tables[BU.uiids[Bw]].njoins){BU.tables[BU.uiids[Bw]].njoins++;}else{BU.tables[BU.uiids[Bw]].njoins=1;}if(BU.tables[BU.uiids[BS]].njoins){BU.tables[BU.uiids[BS]].njoins++;}else{BU.tables[BU.uiids[BS]].njoins=1;}for(var B9=0;B9<CE.length;B9++){Bv=CE[B9].lcid;BP=CE[B9].rcid;CD=AK(CE[B9].exp);var B1=BU.uiids[Bw+Bv],Bb=BU.uiids[BS+BP];BU.joinsInfo[Bp].links[B1+Bb]={srcw:mstrmojo.all[B1],tgtw:mstrmojo.all[Bb],coords:[],exp:CD,jid:Bp,op:BM(CD)};if(BU.joinsInfo[Bp].nlinks){BU.joinsInfo[Bp].nlinks++;}else{BU.joinsInfo[Bp].nlinks=1;}}}BU.raiseEvent({name:"JoinsLoaded"});var Bm=[],Bt=[];if(Bd.exp!=""){AB(BU,B2,Bm,Bd.roo,0,Bt);Bm.length&&(BU.conditions.where=Bm[0]);}if(CF.exp!=""){Bm=[];AB(BU,BW,Bm,CF.roo,1);Bm.length&&(BU.conditions.having=Bm[0]);}BU.firstTimeLoading=false;}function Ar(BQ,BP){var BR=1;if(BQ[BP].existing){BQ[BP].missing=true;BR=0;}else{BQ.splice(BP,1);}return BR;}mstrmojo.qb.QBuilderModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.qb.QBuilderModel",id:"QBuilderModel",tables:new Object(),selLink:null,dbtbls:{},uiids:{},riid:"",analysisID:null,alertTitle:null,msgid:"",dbtables:[],selectedClns:[],joins:[],joinsInfo:new Object(),dbrs:[],dsns:[],drivers:[],dbms:[],suppdbs:[],pos_hash:{},bindingT:[],tbns:{},catalogRefresh:false,SelDBRoleID:null,isDI:false,FFSQLMode:false,isFFSQL:false,isCloud:false,supportTimeGeo:true,isCubeReport:true,autoRefreshSQL:false,isDirty:false,SQLPreviewStmt:"",SQLstmt:"",refresh_opt:1,mappings:[],cloneMappings:[],dataset:[],cacheMP:[],cacheDS:[],conditions:new Object(),cnum:0,datatypes:AH,addLink:function Au(BR,BU,BQ,BT){var BS=this,BX=BR.id+BU.id,BZ=BS.joinsInfo[BQ].links;var BY=this.getjIndex(BQ),BP=this.brackets(BR.oriexpr)+"="+this.brackets(BU.oriexpr),BW="";if(BS.joinsInfo[BQ].exp){BW=BS.joinsInfo[BQ].exp+" AND "+BP;}else{BW=BP;}var BV={success:function(Ba){BS.joinsInfo[BQ].exp=BW;BZ[BX]=new Object();BZ[BX].srcw=BR;BZ[BX].tgtw=BU;BZ[BX].coords=[];BZ[BX].exp=BP;BZ[BX].jid=BQ;BS.joinsInfo[BQ].exp=BW;if(BT&&BT.success){BT.success();}}};BS.parseExpression(false,1,null,BY,A8,BW,null,BV);},removeLink:function AE(BV,BP,BS){var BQ=this,BX=BQ.joinsInfo[BP].links,BW=this.getjIndex(BP),BU="";for(var BR in BX){if(BR!==BV){if(BU){BU+=" AND "+BX[BR].exp;}else{BU=BX[BR].exp;}}}if(!BU){BQ.removeJoin(BP,BS);}else{var BT={success:function(BY){BQ.joinsInfo[BP].exp=BU;delete BX[BV];if(BS&&BS.success){BS.success();}}};BQ.parseExpression(false,1,null,BW,A8,BU,null,BT);}},getTouchValue:function AZ(BP,BU){for(var BS in this.joinsInfo){var BR=this.joinsInfo[BS].links;for(var BT in BR){var BQ=BR[BT].coords;if(this.inPoly(BQ,BP,BU)){return[BS,BT];}}}return null;},inPoly:function M(BR,Bb,Ba){var BX=BR.length;var BU,BP,Bc,BW,BS,BZ,BQ,BY,BV;var BT=false;if(BX/2<3){return false;}Bc=BR[BX-2];BW=BR[BX-1];for(BV=0;BV<BX;BV=BV+2){BU=BR[BV];BP=BR[BV+1];if(BU>Bc){BS=Bc;BQ=BU;BZ=BW;BY=BP;}else{BS=BU;BQ=Bc;BZ=BP;BY=BW;}if((BU<Bb)==(Bb<=Bc)&&((Ba-BZ)*(BQ-BS)<(BY-BZ)*(Bb-BS))){BT=!BT;}Bc=BU;BW=BP;}return BT;},exprEditor:function(BY,BW,BT,BX){var BQ="mstrQB",BV=this,BU=null,BP=function(Ba){_hideWaitPage();var BZ=mstrmojo.all[BQ];if(!BZ){BZ=new mstrmojo.qb.ExpressionEditor({id:BQ,oi:Ba,funclist:BU,model:BV});}else{BZ.set("oi",Ba);}BZ.open();},BR=function(BZ){_hideWaitPage(true);G(BZ);},BS=function(Ba){try{BU=Ba;if(!BY){BP({n:"New Condition Expression",type:BW,w:BT,tks:{tkn:[],vs:0,vm:""},mhfts:{},mvfts:{}});}else{if(BW==3){BP({did:"editsc",n:"Edit Column "+BX,type:BW,w:BY,cIndex:BX,tks:{tkn:BY.expr,vs:0,vm:""},mhfts:{},mvfts:{}});}else{if(BY.id&&!BY.length){var Bb=BY.id;BP({did:Bb,n:mstrmojo.all[Bb].oriexpr,w:BY,type:BW,cIndex:BX,tks:{tkn:mstrmojo.all[Bb].expr,vs:0,vm:""},mhfts:{},mvfts:{}});}else{BP({did:"mod",n:"Modify Condition Expression",type:BW,w:BT,tks:{tkn:BY,vs:0,vm:""},mhfts:{},mvfts:{}});}}}}catch(BZ){}};_showWaitPage();this.getFunctions({success:BS,failure:BR});},brackets:function(BP){return"["+BP+"]";},isEquivalentExpr:function(BR,BQ){var BP=function BP(BS){return BS.replace(/\s/g,"").replace(/\[+(.*?)\]+/g,"$1").replace(/\(+(.*?)\)+/g,"($1)").toUpperCase();};return(BP(BR)===BP(BQ));},_set_SelDBRoleID:function(BR,BP){var BQ=(this.SelDBRoleID!==BP);this.SelDBRoleID=BP;if(BQ){this.raiseEvent({name:"dbroleChange",value:BP});this.setDBRole(BP);}return BQ;},autoMap:function(BR,BQ,BT){var BS=this;if(!BS.FFSQLMode){if(BS.getColumnsCount()===0){mstrmojo.alert(A(9945,"Please add at least one column and try again."),null,BS.alertTitle);if(BR&&BR.failure){BR.failure();}return ;}else{if(BS.getTablesCount()===0){mstrmojo.alert(A(9946,"Please add at least one table and try again."),null,BS.alertTitle);if(BR&&BR.failure){BR.failure();}return ;}}}var BP={success:function(BV){BS.isDirty=false;if(!BQ){var BU=BV.datap,BY=BU.maps,BW=BU.data;if(BS.FFSQLMode){var BX=[];BS.populateFFSQLMapping(BY);BS.populateDataset(BW);}else{BS.populatePreview(BY,BW);}BS.raiseEvent({name:"dataPreview"});}if(BR&&BR.success){BR.success(BV);}}};BS.loadReport(x,S,f+Ab,BT?Av:L,BP);},convertToQueryBuilder:function u(BP){var BQ=this;mstrApp.getRootController().getDataService().convertToQB({success:function BR(BS){mstrApp.msgid=BS.msgid;mstrApp.isFFSQLMode=false;BQ.isDirty=true;BQ.FFSQLMode=false;BQ.mappings=BQ.cacheMP;BQ.dataset=BQ.cacheDS;BQ.raiseEvent({name:"dataPreview"});BP&&BP.success&&BP.success(BS);}});},convertToFFSQL:function K(BS,BQ,BP){var BR=this;BR.SQLstmt=BS;mstrApp.getRootController().getDataService().convertToFFSQL({success:function BT(BU){mstrApp.msgid=BU.msgid;BR.isDirty=true;BR.FFSQLMode=true;mstrApp.isFFSQLMode=true;BR.cacheMP=BR.mappings;BR.cacheDS=BR.dataset;BR.dataset=[];BR.mappings=[];if(!BP){BR.raiseEvent({name:"dataPreview"});}BQ&&BQ.success&&BQ.success(BU);}},{exp:U.encodeXMLAttribute(BS)});},editFFSQL:function A6(BP,BR){var BQ=this;if(this.SQLstmt===BR){if(BP&&BP.success){BP.success();return ;}}this.SQLstmt=BR;mstrApp.getRootController().getDataService().editFFSQL({success:function BS(BT){mstrApp.msgid=BT.msgid;BQ.isDirty=true;BP&&BP.success&&BP.success(BT);}},{exp:U.encodeXMLAttribute(BR)});},updateSQL:function(BP){this.getSQL(BP);},getSQL:function BG(BQ){var BR=this;if((!BR.SelDBRoleID&&BR.riid===q)||BR.dbtables.length===0){var BP="";if(BQ&&BQ.success){BQ.success(BP);}}else{BR.loadReport(A3,S,null,null,{success:function BS(BU){var BV=BU.sqls[BU.sqls.length-1],BT=BV?Aq(BV):"";if(BQ&&BQ.success){BQ.success(BT);}}},true);}},isNameUnique:function(BU,BQ,BR){var BV=this,BT=BV.mappings;for(var BS=0,BP=BT.length;BS<BP;BS++){if(BS!=BQ){if(BR===BT[BS].alias&&BT[BQ].tp==BT[BS].tp){return false;}}}return true;},mapAttribute:function(Bc,BQ,BT,BY,BZ,Ba){var BR=this,BV=BR.mappings;for(var BU=0,BX=BV.length;BU<BX;BU++){if(BV[BU].afid===(BQ+BT)){if(BZ&&BZ.failure){BZ.failure(A(9926,"The attribute form you select has been mapped. Please choose a different one."));}return false;}}var BW=t.find(BV,"did",Bc),BP=BV[BW],Bb=function Bb(Bd){mstrApp.getRootController().getDataService().remapObject({success:function Bf(Bg){BR.autoMap();if(BZ&&BZ.success){BZ.success(Bg);}},failure:function Be(Bg){mstrmojo.alert(Bg.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}},{mpcs:JSON.stringify(Bd),docid:mstrApp.docID||"",suppressError:true});};if(BP.isIDForm&&BP.multiForms&&!BP.ipa){mstrmojo.confirm(mstrmojo.desc(11164,"All other forms of the attribute will be unmapped. Do you want to continue?"),[mstrmojo.Button.newInteractiveButton(A(219,"Yes"),function BS(){var Bd=[];t.forEach(BV,function(Be){if(Be.oid===Ba&&Be.did!==Bc){Bd.push({did:Be.did,aid:"",ot:C});}});Bd.push({did:Bc,aid:BQ,fid:BT});Bb(Bd);}),mstrmojo.Button.newInteractiveButton(A(218,"No"))]);}else{Bb([{did:Bc,aid:BQ,fid:BT}]);}},unmap:function(BU,BS){var BV=this,BW=BV.mappings,BQ=t.find(BW,"did",BU),BP=BW[BQ],BR=function BR(BX){mstrApp.getRootController().getDataService().remapObject({success:function BZ(Ba){BV.autoMap();},failure:function BY(Bb){var Ba=parseInt(Bb.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296;mstrmojo.alert((Ba===2147755261)?"Please unmap the attribute's non-key form first.":Bb.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}},{mpcs:JSON.stringify(BX),docid:mstrApp.docID||"",suppressError:true});};if(BP.isIDForm&&BP.multiForms){mstrmojo.confirm(mstrmojo.desc(11164,"All other forms of the attribute will be unmapped. Do you want to continue?"),[mstrmojo.Button.newInteractiveButton(A(219,"Yes"),function BT(){var BX=[];t.forEach(BW,function(BY){if(BY.oid===BS&&BY.did!==BU){BX.push({did:BY.did,aid:"",ot:C});}});BX.push({did:BU,aid:"",ot:C});BR(BX);}),mstrmojo.Button.newInteractiveButton(A(218,"No"))]);}else{BR([{did:BU,aid:"",ot:C}]);}},remap:function(BX,BT,BW,BQ,BU,BY,BP,BV){var BS=[],BR={did:BX};BT&&(BR.alias=BT);BW&&(BR.bft=BW);BQ&&(BR.ot=BQ);BU&&(BR.georole=BU);BY&&(BR.drvflgs=BY);BP&&(BR.shapekey=BP);BS.push(BR);mstrApp.getRootController().getDataService().remapObject({success:function(BZ){if(BV&&BV.success){BV.success(BZ);}}},{mpcs:JSON.stringify(BS),docid:mstrApp.docID||""});},commitMapping:function(BW){var BQ=this;var BX=this.cloneMappings,BY=this.mappings;var BT,BU=[],BP,BR,BZ;for(var BS=0,BV=BX.length;BS<BV;BS++){BR=BX[BS];BZ=BY[BS];BT={};BP=false;if(!BZ.selected){BU.push({did:BZ.did,cmf:0});}else{if(BZ.alias!=BR.alias){BT.alias=BZ.alias;BP=true;}if(BZ.dtp!=BR.dtp){BT.bft=BZ.dtp;BP=true;}if(BZ.tp!=BR.tp){BT.ot=BZ.tp;BP=true;}if(BP){BT.did=BZ.did;BU.push(BT);}}}if(BU.length>0){mstrApp.getRootController().getDataService().remapObject({success:function(Ba){if(BW&&BW.success){BW.success(Ba);}}},{mpcs:JSON.stringify(BU),docid:mstrApp.docID||""});}else{if(BW&&BW.success){BW.success();}}},setXDADBRole:function(BP){var BQ=this;if(BQ.SelDBRoleID!==BP){BQ.SelDBRoleID=BP;BQ.raiseEvent({name:"dbrsChange"});BQ.raiseEvent({name:"dbroleChange",value:BP});}},validateExpr:function AV(BQ,BP){this.parseExpression(BQ.vo===1,1,BQ.cIndex,null,BQ.qbrex,BQ.expr,BQ.tKnStrm,BP);},parseExpression:function AQ(BW,BQ,BX,BP,BV,BS,BU,BT){var BR={qbrex:BV};BR.qindex=BQ||1;if(BX!=null){BR.cindex=BX;}if(BP!=null){BR.jindex=BP;}if(BS!=null){BR.exp=BS;}if(BU){BR.tokenStrm=BU;}if(BW){BR.vo=1;}mstrApp.getRootController().getDataService().parse({success:function(BY){if(BY&&BY.mi&&BY.mi.tknstrm.mi){var BZ=BY.mi.tknstrm.mi.tkn;Aa(BZ);BY.expr=X(BZ);}if(BT&&BT.success){BT.success(BY);}}},BR);},addTable:function Af(BX,BY){var BP=this;var BV=BX.tbn,BW=BP.tbns;BV=BV.replace(/^[0-9]/,"L");var BT=BV,BU=1;while(BW[BT]){BT=BV+"_"+(BU++);}BV=BT;BW[BT]=BT;var BS={tbn:BX.tbn,clns:JSON.stringify(BY),ns:BX.ns,alias:BV};var BR=this.getMissingTableID(BX.tbn,BV,BX.ns);if(BR){BS.tbid=BR;}var BQ={success:function(BZ){BP.isDirty=true;mstrApp.msgid=BZ.msgid;BP.raiseEvent({name:"TableAdded",data:BY,table:{x:BX.posX,y:BX.posY,tbn:BV,dbtbn:BX.tbn,ns:BX.ns,did:BR}});}};mstrApp.getRootController().getDataService().addTable(BQ,BS);},removeTable:function(BQ,BS){var BU=this,BR=this.gettIndex(BQ.id),BT=BQ.Rows.children;var BP={widget:BQ,success:function(Bb){mstrApp.msgid=Bb.msgid;BU.isDirty=true;var Bg=this.widget.id;var Bd=BU.tbns,Be=BU.tables[Bg];tbn=Be.tbn,dbtbn=Be.dbtbn,ns=Be.ns;if(Bd[tbn]){delete Bd[tbn];}for(var BW in BU.joinsInfo){var BY=BU.joinsInfo[BW].srctID,BV=BU.joinsInfo[BW].tgttID;if(Bg==BY||Bg==BV){delete BU.joinsInfo[BW];mstrmojo.array.removeItem(BU.joins,BW);BU.tables[BY].njoins--;BU.tables[BV].njoins--;}if(BU.selLink&&BU.selLink[0].indexOf(Bg)>-1){BU.selLink=null;}}BU.upttIndex(tbn,dbtbn,Bg,false,Be.did,ns);var Ba=BU.selectedClns,Bf=[],BZ;t.forEach(BT,function(Bh){t.forEach(Ba,function(Bj,Bi){BZ=t.indexOf(Bj.wid,Bh.id);if(BZ>-1){t.removeIndices(Bj.wid,BZ,1);if(Bf.indexOf(Bi+1)==-1){Bf.push(Bi+1);}}});});Bf.sort(mstrmojo.array.numSorter);for(var BX=Bf.length-1;BX>-1;BX--){BU.removeExpression(Bf[BX]);}var Bc=BU.conditions;tbn=tbn.toLowerCase();AX(Bc.where,tbn)&&(delete Bc.where);AX(Bc.having,tbn)&&(delete Bc.having);BU.updateFilterLabel(Bc);if(BS&&BS.success){BS.success();}}};mstrApp.getRootController().getDataService().removeTable(BP,{tindex:BR});},addExpression:function AF(BP){var BU=X(this.selectedClns[BP-1].expr);var BS={did:BP+BU,alias:BU,n:BU,selected:false,hasMapped:false,isQB:!this.FFSQLMode,expr:this.selectedClns[BP-1].expr,dtp:1,ix:BP-1,tp:0};this.mappings.push(BS);var BR=this.dataset.length;if(BR>0){for(var BQ=0;BQ<BR;BQ++){var BT=this.dataset[BQ];BT.push("");}}mstrApp.getRootController().toggleDataPreview(true);this.raiseEvent({name:"dataPreview"});},removeExpression:function n(BV){var BP=this.selectedClns[BV-1],BZ=BP.wid;for(var BS=0,BU=BZ.length;BS<BU;BS++){var BY=mstrmojo.all[BZ[BS]];BY.count--;BY.updateState(0);}var BW=Ar(this.selectedClns,BV-1);var BX=0;for(var BS=0,BU=this.mappings.length;BS<BU;BS++){var BQ=this.mappings[BS];var BR=BQ.ix;if(BR!=null){if(BR==BV-1){BX=BS;}else{if(BR>=BV){BQ.ix=BR-BW;}}}}mstrmojo.array.removeIndices(this.mappings,BX,1);var BT=this.dataset.length;if(BT>0){for(var BS=0;BS<BT;BS++){var BY=this.dataset[BS];mstrmojo.array.removeIndices(BY,BX,1);}}this.raiseEvent({name:"dataPreview"});},editExpression:function(BP){var BR=this.selectedClns[BP-1],BQ=BR.wid;this.exprEditor(BR,3,null,BP);},updateExpression:function Am(BP){var BU=X(this.selectedClns[BP-1].expr);var BS=this.mappings[BP-1];if(!BS){return ;}BS.did=BP+BU;BS.alias=BU;BS.n=BU;BS.expr=this.selectedClns[BP-1].expr,BS.selected=false;BS.hasMapped=false;BS.tp=0;var BR=this.dataset.length;if(BR>0){for(var BQ=0;BQ<BR;BQ++){var BT=this.dataset[BQ];BT[BP-1]="";}}this.raiseEvent({name:"dataPreview"});},addSelectedColumns:function Ae(BQ,BT,BS,BZ){var BR=this,BP,Ba,Bc=[],BY,BW,BX,BV=BR.tables[BR.dbtables[BT-1]].existing;for(i=0;i<BQ.length;i++){BY=BQ[i];BX=BY.dt;Ba={dt:BX.tp,ps:BX.ps,sc:BX.sc,clix:BY.rIndex+1,tblIdx:BT};if(BS!=null){Ba.findex=BS;BW=[A9[BS],"(",BY.oriexpr,")"].join("");}else{BW=BY.expr[0].oi.n;}if(BV){BP=this.getMissingColumnID(BW);if(BP){Ba.cmid=BP;}}Bc.push(Ba);}var Bb=JSON.stringify(Bc);var BU={success:function(Bf){BR.isDirty=true;mstrApp.msgid=Bf.msgid;for(var Be=0,Bd=BQ.length;Be<Bd;Be++){BR.addColumnIndex(BQ[Be],BS,null,!BV,Bc[Be].cmid);}if(BZ&&BZ.success){BZ.success(BY);}}};mstrApp.getRootController().getDataService().addSelectedColumns(BU,{colArray:Bb});},addSelectedColumn:function AY(BP,BU,BQ){var BS=this,BR=BP.dt;isExistingTable=this.tables[BP.srcID].existing;var BV={dt:BR.tp,ps:BR.ps,sc:BR.sc};if(isExistingTable){var BT=this.getMissingColumnID(BU);if(BT){BV.cmid=BT;}}mstrApp.getRootController().getDataService().addColumn({success:function(BW){BS.isDirty=true;mstrApp.msgid=BW.msgid;BW.cIndex=BS.addColumnIndex(BP,null,BU,!isExistingTable,BT);if(BQ&&BQ.success){BQ.success(BW);}}},BV);},removeSelectedColumn:function(BP,BR,BQ){var BS=this;mstrApp.getRootController().getDataService().removeColumn({success:function(BT){BS.isDirty=true;mstrApp.msgid=BT.msgid;if(!BQ){BS.removeExpression(BP);}else{Ar(BS.selectedClns,BP-1);}if(BR&&BR.success){BR.success();}}},{cindex:BP});},editExpr:function(BP){var BQ=this.selectedClns[BP-1];this.exprEditor(BQ,3,null,BP);},autoJoin:function(BQ,BP,BS,BR){mstrApp.getRootController().getDataService().autoJoin({success:function BT(BU){if(BR&&BR.success){BR.success();}}},{tindex:BQ,jflag:BP,qindex:BS||1});},addJoin:function y(BQ,BP,BU,BV,BS){var BT=this;var BR={success:function(BX){BT.isDirty=true;mstrApp.msgid=BX.msgid;var BW=BQ.srcID+BP.srcID;BT.joins.push(BW);BT.joinsInfo[BW]=new Object();BT.joinsInfo[BW].jt=0;BT.joinsInfo[BW].exp="";BT.joinsInfo[BW].srctID=BQ.srcID;BT.joinsInfo[BW].tgttID=BP.srcID;BT.joinsInfo[BW].links=new Object();BT.tables[BQ.srcID].njoins++;BT.tables[BP.srcID].njoins++;cb={success:function(BY){BT.joinsInfo[BW].nlinks++;BS&&BS.success&&BS.success();},failure:function(BY){}};BT.addLink(BQ,BP,BW,cb);}};mstrApp.getRootController().getDataService().addJoin(BR,{srcIndex:BT.gettIndex(BQ.srcID),dstIndex:BT.gettIndex(BP.srcID),jtype:BU});},removeJoin:function(BR,BT){var BU=this;var BS=BU.joinsInfo[BR],BV=BS.srctID,BQ=BS.tgttID;var BP={success:function(BW){BU.isDirty=true;mstrApp.msgid=BW.msgid;mstrmojo.array.removeItem(BU.joins,BR);delete BU.joinsInfo[BR];BU.tables[BV].njoins--;BU.tables[BQ].njoins--;if(BT&&BT.success){BT.success();}}};mstrApp.getRootController().getDataService().removeJoin(BP,{jindex:BU.getjIndex(BR)});},editJoin:function(BP,BW,BT,BV,BQ,BU){var BR=this,BX=this.getjIndex(BP);var BS={success:function(Bb){mstrApp.msgid=Bb.msgid;BR.joinsInfo[BP].jt=BT;links=BR.joinsInfo[BP].links;if(BQ){var BZ=links[BW].exp,Bc="";links[BW].exp=BQ;if(BU!==undefined){links[BW].op=BU;}for(var BY in links){if(Bc){Bc+=" AND "+links[BY].exp;}else{Bc=links[BY].exp;}}var Ba={success:function(Bd){BR.joinsInfo[BP].exp=Bc;if(BV&&BV.success){BV.success();}},failure:function(Bd){links[BW].exp=BZ;}};BR.parseExpression(false,1,null,BX,A8,Bc,null,Ba);}else{if(BV&&BV.success){BV.success();}}}};mstrApp.getRootController().getDataService().editJoin(BS,{jindex:BX,jtype:BT});},renameTable:function a(BS,BP,BR){var BQ=this;mstrApp.getRootController().getDataService().editTable({success:function(BT){mstrApp.msgid=BT.msgid;delete BQ.tbns[BP];BQ.tbns[BR]=BR;BQ.tables[BS].tbn=BR;k.forEach(BQ.conditions,function(BU){Ah(BP,BR,BU);});BQ.raiseEvent({name:"TableNameChanged",value:BR,tid:BS});}},{tables:JSON.stringify([{alias:BR,tindex:this.gettIndex(BS)}])});},saveTableLayout:function BO(BR){var BQ=[];for(var BS in this.tables){var BP=mstrmojo.all[BS];if(BP&&BP.editorNode){BQ.push({tindex:this.gettIndex(BS),t:parseInt(BP.top,10)*Q,l:parseInt(BP.left,10)*Q,w:BP.editorNode.clientWidth*Q,h:BP.editorNode.clientHeight*Q});}}mstrApp.getRootController().getDataService().editTable({success:function BT(BU){mstrApp.msgid=BU.msgid;if(BR&&BR.success){BR.success();}}},{tables:JSON.stringify(BQ)});},loadReport:function At(BV,BX,BW,BT,BU,BP){var BQ=this;BX=BX||S;var BS={browsetype:BV,bindingflag:BX,suppressError:true,showWait:!BP};if(BW!=null){BS.previewflag=BW;}if(BT!=null){BS.automap=BT;BS.docid=mstrApp.docID||"";}var BR={success:function(BY){if(BV&AW){if(BY.btb){BQ.bindingT=BY.btb.slice(0);}}if(BU&&BU.success){BU.success(BY);}},failure:function(Ba){if(BQ.FFSQLMode){var BY=Ba.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(\w+\.*\w+): \(/,"").replace(/ \)$/,"");if(BY.match(/(.\s)*DataImport\)?\[(\d+)\](.\s)*/)){var BZ=parseInt(RegExp.$2,10),Bb=mstrmojo.desc(9944,"SQL Pass ## failed to execute").replace("##",BZ);mstrmojo.all.FFsql.markFailureLabel(BZ);Bb=[Bb,"<div class='mstrmojo-qb-error-tooltip'>",Bb,"<br><br>",BY,"</div>"].join("");mstrmojo.alert(Bb);return ;}}G(Ba);}};mstrApp.getRootController().getDataService().getReportDefinition(BR,BS);},getcIndex:function R(BP){return mstrmojo.array.indexOf(this.selectedClns,BP)+1;},getRowWidget:function D(BP,BT){var BU=this.tables;BT=BT.toLowerCase();if(!BP){for(var BQ in BU){var BS=BU[BQ].rows;for(var BR in BS){if(BS[BR].text.toLowerCase()===BT){return mstrmojo.all[BR];}}}}else{BP=BP.toLowerCase();for(var BQ in BU){if(BU[BQ].tbn.toLowerCase()===BP){var BS=BU[BQ].rows;for(var BR in BS){if(BS[BR].text.toLowerCase()===BT){return mstrmojo.all[BR];}}}}}},uptcIndex:function BA(BQ,BP){while(BP>this.selectedClns.length){this.selectedClns.push("");}this.selectedClns[BP]=BQ;},getjIndex:function p(BP){return mstrmojo.array.indexOf(this.joins,BP)+1;},gettIndex:function A4(BP){return mstrmojo.array.indexOf(this.dbtables,BP)+1;},upttIndex:function AT(BU,BP,BT,Bb,Ba,BY){var BZ=this.dbtables,Bc,BX=this.tables,BV=this.orits,BW=function BW(Bi,Bf,Be,Bh,Bd,Bg){return{rows:{},njoins:0,tbn:Bi,ns:Bf,alias:"",dbtbn:Be,existing:Bh,missing:Bd,did:Bg};};if(!this.isNew&&BV){var BS=t.find(BV,"did",Ba)>-1,BR,BQ=0;if(BS){t.forEach(BZ,function(Bd,Be){if(BX[Bd].did===Ba){BR=Bd;BQ=Be;return false;}});if(Bb){BX[BT]=BW(BU,BY,BP,true,false,Ba);if(BR){delete BX[BR];BZ[BQ]=BT;}else{BZ.push(BT);}}else{if(BR){BX[BR].missing=true;}}return ;}}if(Bb){BX[BT]=BW(BU,BY,BP,false,false,Ba);BZ.push(BT);}else{delete BX[BT];mstrmojo.array.removeItem(BZ,BT);}},save:function(BQ,BZ,BS,Ba,BX,BY,Bb){var BV=this;var BP={success:function(Be){var Bd=Be.did;BV.riid=Bd;mstrApp.path=Be.path;mstrApp.reportID=Bd;mstrApp.folderID=BS;var Bc={success:function(Bf){if(Bb&&Bb.success){Bb.success({did:Bd,path:mstrApp.path});}},failure:function(Bf){var Bg=Bf.getResponseHeader("X-MSTR-TaskErrorCode");Bg=(Bg<0)?(4294967296+parseInt(Bg,10)):Bg;if(2147895426===Bg){G(Bf,function(){mstrmojo.form.send({evt:"3124",src:mstrApp.name+".qbuilder.3124",relativePageNumber:"-1"},mstrApp.name,"POST",null,null,false);});return ;}G(Bf,function(){var Bl=BV.dbtables,Bj,Bi=BV.pos_hash;for(var Bk=0,Bh=Bl.length;Bk<Bh;Bk++){Bj=mstrmojo.all[Bl[Bk]];if(Bj&&Bj.editorNode){Bi[Bj.title]={t:parseInt(Bj.top,10),l:parseInt(Bj.left,10),w:Bj.editorNode.clientWidth,h:Bj.editorNode.clientHeight};}if(Bj){Bj.set("visible",false);Bj.set("opener",null);}delete mstrmojo.all[Bl[Bk]];}var Bn=mstrmojo.all.CE,Bm;if(Bn&&(Bm=Bn.CEl)){Bm.filterExpr.set("items",[]);Bm.aggfilterExpr.set("items",[]);}BV.createReportInstance();});}};mstrApp.getRootController().getDataService().publishCube(Bc,{reportid:Bd});},failure:function(Bc){G(Bc);}};var BR={success:function(){params={reportid:BV.riid,folderID:BS,isCube:BV.isCubeReport,crb:BV.refresh_opt,overwrite:!!Ba,autoName:!!BX};if(BQ){params.name=BQ;}if(BZ){params.desc=BZ;}mstrApp.getRootController().getDataService().saveReport(BP,params);}};var BT={success:function(){BV.updateDerivedFlags(BR);}};var BU={success:function(){if(BV.skipMissingCheck){BT.success();return ;}var Bd=BV.getMissingMaps();if(Bd){var Bc=mstrmojo.insert({scriptClass:"mstrmojo.qb.MissingColumnWarning",mappings:Bd,onOK:function(){BT.success();return true;}});Bc.open();}else{BT.success();}}};var BW={success:function(){if(BV.isDirty){BV.autoMap(BU);}else{BU.success();}}};if(!BV.FFSQLMode){BV.saveTableLayout(BW);}else{BV.editFFSQL(BW,BY);}},populatePreview:function Ag(BQ,BP){this.populateMappings(BQ);this.populateDataset(BP);},populateMappings:function AO(BX){var BY=BX.amps,Bf=BX.mtmps,BW=!mstrApp.isCloud&&(mstrApp.saveAsCube==2)&&(!this.isNew);var BQ={};var Bi=this.mappings.slice(0);this.mappings=[];this.cloneMappings=[];var Ba,BZ,BT,BP,Bj,Bb=0,BU,BR,Bh,Be,BV=function(Bk){var Bl=0;t.forEach(Bk,function(Bm){if(!(Bm.sqc.der&2147483648)){Bl++;}});return Bl;};for(var Bc=0,Bd=BY.length;Bc<Bd;Bc++){BZ=BY[Bc];BT=BZ.aimp;BR=BT.ipa;BP=BZ.afmps;Bb+=BP.length;Be=BV(BP);for(Ba=0,aflen=BP.length;Ba<aflen;Ba++){Bj=BP[Ba].sqc;BU=mstrmojo.array.find(Bi,"did",Bj.id);Bh=(Bj.der&2147483648)?true:false;var Bg={did:Bj.id,alias:AK(BT.atnm),n:AK(BZ.afmps[Ba].cln),selected:(Bj.se==1),hasMapped:true,isReadOnly:BW,isDI:this.isDI,isQB:!(this.FFSQLMode),dtp:BP[Ba].bft,ix:Bj.ix,tp:12,ipa:BR,georole:(BU>=0)?Bi[BU].georole:Bj.geo,der:(BU>=0)?Bi[BU].der:Bj.der,oid:BT.atid,fmid:BP[Ba].fmid,afid:BT.atid+BP[Ba].fmid,fmn:AK(BP[Ba].fmn),shapeKey:AK((BU>=0)?Bi[BU].shapeKey:BP[Ba].sha),toDel:(Bj.ups&4)?true:false,isDerived:Bh,multiForms:Be>1,isIDForm:Ba===0};BQ[Bg.ix]=Bg;}}for(var Bc=0,Bd=Bf.length;Bc<Bd;Bc++){var BS=Bf[Bc],Bj=BS.sqc;var Bg={did:Bj.id,alias:AK(BS.mtn),n:AK(BS.cln),selected:(Bj.se==1),isReadOnly:BW,hasMapped:true,isDI:this.isDI,isQB:!(this.FFSQLMode),dtp:Ap[Bj.dt.tp],ix:Bj.ix,tp:4,oid:BS.mtid,georole:Bj.geo,der:Bj.der,toDel:(Bj.ups&4)?true:false};BQ[Bg.ix]=Bg;}var Bg;for(var Bc=0,Bd=Bb+Bf.length;Bc<Bd;Bc++){Bg=BQ[Bc];if(Bg.toDel){this.selectedClns&&this.selectedClns[Bc]&&(this.selectedClns[Bc].missing=true);}else{if(Bg.isDerived){this.selectedClns&&this.selectedClns[Bc]&&(this.selectedClns[Bc].isDerived=true);}else{this.mappings.push(Bg);this.cloneMappings.push(k.copy(Bg));}}}},populateDataset:function AL(BQ){var BP,BR;if(!BQ.length){this.dataset=[];return ;}BR=[];t.forEach(BQ,function(BS){BP=(BS.dcns.cltp===15);t.forEach(BS.dvs,function(BU,BT){BR[BT]=BR[BT]||[];BR[BT].push(BP?BU.slice(10):BU);});});this.dataset=BR;},populateFFSQLMapping:function Z(BW){var BX=BW.amps,Be=BW.mtmps;var BQ={};var Bj=this.mappings.slice(0);this.mappings=[];this.cloneMappings=[];var BZ,BY,BT,Bh,Ba=0,Bf,BP,Bg,BR,Bi,Bd,BU=function BU(Bk){var Bl=0;t.forEach(Bk,function(Bm){if(!(Bm.col.oi.def.dicl.der&2147483648)){Bl++;}});return Bl;};for(var Bb=0,Bc=BX.length;Bb<Bc;Bb++){BY=BX[Bb];BT=BY.aimp;BR=BT.ipa;BP=BY.afmps;Bd=BU(BP);for(BZ=0,Bf=BP.length;BZ<Bf;BZ++){Bh=BP[BZ].col.oi;pos=mstrmojo.array.find(Bj,"did",Bh.did);if(Bh.def.dicl.ups&4){break;}Bi=(Bh.def.dicl.der&2147483648)?true:false;Ba++;Bg={did:Bh.did,alias:AK(BT.atnm),n:AK(Bh.def.cln),selected:true,hasMapped:true,dtp:BP[BZ].bft,georole:(pos>=0)?Bj[pos].georole:Bh.def.dicl.geo,shapeKey:AK((pos>=0)?Bj[pos].shapeKey:BP[BZ].sha),oid:BT.atid,fmid:BP[BZ].fmid,afid:BT.atid+BP[BZ].fmid,fmn:AK(BP[BZ].fmn),ipa:BR,ix:Bh.def.dicl.clix-1,tp:12,der:(pos>=0)?Bj[pos].der:Bh.def.dicl.der,isDerived:Bi,multiForms:Bd>1,isIDform:BZ===0};BQ[Bg.ix]=Bg;}}var BV=BX.length;for(var Bb=0,Bc=Be.length;Bb<Bc;Bb++){var BS=Be[Bb],Bh=BS.col.oi;if(Bh.def.dicl.ups&4){continue;}Ba++;var Bg={did:Bh.did,alias:AK(BS.mtn),n:AK(Bh.def.cln),selected:true,hasMapped:true,dtp:Ap[Bh.def.dt.tp],ix:Bh.def.dicl.clix-1,oid:BS.mtid,tp:4,georole:Bh.def.dicl.geo,der:Bh.def.dicl.der};BQ[Bg.ix]=Bg;}var Bg;for(var Bb=0;Bb<Ba;Bb++){Bg=BQ[Bb];if(Bg&&!Bg.isDerived){this.mappings.push(Bg);this.cloneMappings.push(k.copy(Bg));}}},updateDerivedFlags:function(BS){var BV=this.mappings;var BQ=[],BT;for(var BR=0,BP=BV.length;BR<BP;BR++){if(BV[BR].hasMapped){BQ.push({did:BV[BR].did,georole:BV[BR].georole,shapekey:BV[BR].shapeKey,drvflgs:BV[BR].der});}}if(BQ.length===0){BS&&BS.success&&BS.success();}else{mstrApp.getRootController().getDataService().remapObject({success:function BU(BW){if(BS&&BS.success){BS.success(BW);}}},{mpcs:JSON.stringify(BQ),docid:mstrApp.docID||"",utm:1});}},getMissingMaps:function(Bl){if(!this.orimaps){return null;}var Ba=[],Bg,Bf,Bh,Bi;var Bj=this.orimaps;var BS=this.mappings;var BY=Bj.amps,BZ=Bj.mtmps;Bj={};var BU,Be,BQ,Bb,Bk,BW,Bc,BX=mstrApp.isFFSQL;for(Bg=0,Bh=BY.length;Bg<Bh;Bg++){Bi=BY[Bg].aimp;BU=Bi.atid;Be=AK(Bi.atnm);Bi=BY[Bg].afmps;for(Bf=0;Bf<Bi.length;Bf++){if(BX){Bb=Bi[Bf].col.oi.def;if(Bb.dicl.der&2147483648){break;}BW=Bb.cln;Bc=Bi[Bf].col.oi.did;}else{Bk=Bi[Bf].sqc;if(Bk.der&2147483648){break;}BW=Bk.exp.exp;Bc=Bk.id;}Bj[BU]=Bj[BU]||{n:Be,oid:BU,tp:12,fms:[]};Bj[BU].fms.push({fmid:Bi[Bf].fmid,fnm:AK(Bi[Bf].fmn),exp:AK(BW),cmid:Bc});}}for(Bg=0,Bh=BZ.length;Bg<Bh;Bg++){if(BX){BW=BZ[Bg].col.oi.def.cln;Bc=BZ[Bg].col.oi.did;}else{Bk=BZ[Bg].sqc;BW=Bk.exp.exp;Bc=Bk.id;}Bj[BZ[Bg].mtid]={oid:BZ[Bg].mtid,n:AK(BZ[Bg].mtn),tp:4,exp:AK(BW),cmid:Bc};}var Bd=mstrmojo.hash.copy((this.pattrs||{}));var Bh=BS.length,BP,BR,BT,BV;for(Bg=0;Bg<Bh;Bg++){BP=BS[Bg].oid;BR=Bj[BP];if(BR&&BR.tp==BS[Bg].tp){BT=BR.fms;if(BT){BV=t.find(BT,"fmid",BS[Bg].fmid);if(BV>-1){t.removeIndices(BT,BV,1);}}else{delete Bj[BP];}}if(Bd[BP]&&Bd[BP].tp==BS[Bg].tp){delete Bd[BP];}}if(Bl){for(BP in Bd){Bi=Bd[BP];Bl.push(Bi);}}for(BP in Bj){Bi=Bj[BP];if(Bi.tp===12){if(Bi.fms.length){Ba.push(Bi);}}else{Ba.push(Bi);}}return((Ba.length>0)?Ba:null);},getMissingColumnID:function(BT){var BQ=this,BP=BQ.getMissingMaps();if(!BP){return null;}var BS=null,BU,BR=BQ.mappings;t.forEach(BP,function(BV){BU=(BV.tp===4)?[BV]:BV.fms;t.forEach(BU,function(BW){if(t.find(BR,"did",BW.cmid)===-1&&BQ.isEquivalentExpr(BW.exp,BT)){BS=BW.cmid;return false;}});if(BS){return false;}});if(BS){t.forEach(BQ.selectedClns,function(BV){if(BV.cmid===BS&&!BV.missing){BS=null;return false;}});}return BS;},getMissingTableID:function(BP,BR,BU){var BW=this.orits;if(!BW){return null;}var BV=this.dbtables,BT=this.tables,BX;for(var BQ=0,BS=BV.length;BQ<BS;BQ++){BX=BT[BV[BQ]];if(BX.existing&&BX.missing&&BX.tbn===BR&&BX.dbtbn===BP&&BX.ns===BU){return(!BX.did?null:BX.did);}}return null;},getTablesCount:function(){var BS=this.tables,BT=this.dbtables,BR=0;for(var BQ=0,BP=BT.length;BQ<BP;BQ++){!BS[BT[BQ]].missing&&(BR++);}return BR;},getColumnsCount:function(){var BQ=this.selectedClns,BS=0;for(var BR=0,BP=BQ.length;BR<BP;BR++){!BQ[BR].missing&&(BS++);}return BS;},addColumnIndex:function(Bb,BT,BY,BP,BR){var BW=this.selectedClns,BZ=this.gettIndex(Bb.parent.parent.id),BS,BX,Ba,BV=BW.length,BU,BQ;if(!!BY){BS=BY;}else{if(BT){BS=A9[BT]+"("+(Bb.oriexpr)+")";}else{BS=this.brackets(Bb.oriexpr);}}if(!BP){for(BU=0;BU<BV;BU++){BQ=BW[BU];if(BQ.missing&&BQ.expr&&this.isEquivalentExpr(BQ.expr[0].v,BS)){BQ.missing=false;BQ.wid=[Bb.id];BQ.cmid=BR;Ba=true;break;}}BX=BU+1;}else{BX=BV+1;}if(!Ba){if(BT){if(BT===6){BW.push({wid:[Bb.id],expr:[{isNew:true,v:"Count",oi:{t:"11",n:"Count"}},{isNew:true,v:"<Distinct=true>",oi:{t:"11",n:"<Distinct=true>"}},{isNew:true,v:"(",isDelimiter:true},{isNew:true,v:this.brackets(Bb.oriexpr),oi:{tIndex:BZ,rIndex:Bb.rIndex,t:"26",n:Bb.oriexpr}},{isNew:true,v:")",isDelimiter:true}]});}else{BW.push({wid:[Bb.id],expr:[{isNew:true,v:A9[BT],oi:{t:"11",n:A9[BT]}},{isNew:true,v:"(",isDelimiter:true},{isNew:true,v:this.brackets(Bb.oriexpr),oi:{tIndex:BZ,rIndex:Bb.rIndex,t:"26",n:Bb.oriexpr}},{isNew:true,v:")",isDelimiter:true}]});}}else{BW.push({wid:[Bb.id],expr:[{isNew:true,v:BS,oi:{tIndex:BZ,rIndex:Bb.rIndex,t:"26",n:Bb.oriexpr}}]});}}this.addExpression(BX);return BX;},compareDBTables:function(BR){var BQ=this;if(BQ.dbtables.length===0){return ;}var BP={success:function(BV){var BS=BV.btb,BT=[],BX,BW;t.forEach(BS,function(BY){BX=BY.oi;BW=BX.def;(BX.tp===53)&&BT.push({tbid:BX.did,tbn:AK(BW.tbn),ns:AK(BW.ns)});});if(BT.length==0){return ;}BQ.whts=BT;mstrApp.getRootController().getDataService().catalogAction({success:function BU(BY){var BZ=BY.xrc.cas[0];BQ.whdef=BZ.tis?BZ.tis:[BZ];BR&&BR.success&&BR.success();}},{dbrid:BQ.SelDBRoleID,flags:1073741824|2|524288,mid:mstrApp.msgid,dbts:JSON.stringify(BT),showWait:true});}};BQ.loadReport(AW+x,S,f,null,BP);},updateDBTables:function(Ba){var BR=this,Bb,BV,BQ=[],BS,BP,BX,BW,BU,BY,BZ;for(BW=0,BY=BR.whdef.length;BW<BY;BW++){Bb=BR.whdef[BW];if(Bb.sta!=0){BS={ns:Bb.ns,sta:Bb.sta,tbid:Bb.tbid,tbn:AK(Bb.tbn),clis:[]};BX=BS.clis;BP=Bb.clis;for(BU=0;BU<BP.length;BU++){BZ=BP[BU];BX.push({cln:AK(BZ.cln),cmid:BZ.cmid,sta:BZ.sta,prec:BZ.dt.prec,scl:BZ.dt.scl,tp:BZ.dt.tp});}BQ.push(BS);}}if(BQ.length==0){return ;}var BT={success:function(Bd){mstrApp.msgid=Bd.msgid;var Bc={success:function(Bj){var Bi=BR.dbtables,Bg,Bf=BR.pos_hash;for(var Bh=0,Be=Bi.length;Bh<Be;Bh++){Bg=mstrmojo.all[Bi[Bh]];if(Bg&&Bg.editorNode){Bf[Bg.title]={t:parseInt(Bg.top,10),l:parseInt(Bg.left,10),w:Bg.editorNode.clientWidth,h:Bg.editorNode.clientHeight};}Bg.set("visible",false);Bg.set("opener",null);delete mstrmojo.all[Bi[Bh]];}var Bl=mstrmojo.all.CE,Bk;if(Bl&&(Bk=Bl.CEl)){Bk.filterExpr.set("items",[]);Bk.aggfilterExpr.set("items",[]);}E(Bj,BR);if(Ba&&Ba.success){Ba.success();}}};BR.loadReport(AW+x,S,f,null,Bc);}};mstrApp.getRootController().getDataService().updateTableStructure(BT,{tables:JSON.stringify(BQ)});},isColumnUsed:function(BX,BV){var BR=BX.tbn,BQ=BV.cln,BS,BT,BY;var BU=this.tables;for(var BP in BU){if(BU[BP].dbtbn===BR){BY=BU[BP].rows;for(var BW in BY){if((BY[BW].text===BQ)&&(BY[BW].state!=0)){return true;}}}}return false;},hasMissingUsedDBColumns:function(){var BS=this.whdef,BW,BV,BU,BP,BR,BQ,BT;for(BV=0,BP=BS.length;BV<BP;BV++){BW=BS[BV];switch(parseInt(BW.sta,10)){case 0:case 64:break;default:BT=BW.clis;for(BU=0,BR=BT.length;BU<BR;BU++){BQ=BT[BU];if(parseInt(BQ.sta,10)===4){if(this.isColumnUsed(BW,BQ)){return true;}}}break;}if(BW.sta==4){BT=BW.clis;for(BU=0,BR=BT.length;BU<BR;BU++){BQ=BT[BU];if(this.isColumnUsed(BW,BQ)){return true;}}}}return false;},getShapeKeys:function(){var BQ=this;var BP={success:function(BU){if(BU&&BU.ShapeFileMaps&&BU.ShapeFileMaps.ShapeFileMap){var BV=BU.ShapeFileMaps.ShapeFileMap,BS=[],BW,BT,BR=function BR(BZ,BY){var BX=BZ.n.toLowerCase();var Ba=BY.n.toLowerCase();if(BX<Ba){return -1;}else{if(BX>Ba){return 1;}else{return 0;}}};t.forEach(BV,function(BX){BW=BX.descWeb;BT=BW?A(BW.slice(8)):AK(BX.name);BS.push({did:BX.shapeKey,n:BT});});BS.sort(BR);BQ.shapeKeys=BS;}}};mstrApp.getRootController().getDataService().getShapeKeys(BP,{fileNumber:2});},createReportInstance:function Aw(){var BT=this;BT.msgid=mstrApp.msgid;BT.riid=mstrApp.reportID||q;var BS=mstrApp.isCloudPro;BT.supportTimeGeo=!BS;BT.analysisID=mstrApp.analysisID;BT.isNew=(BT.riid==q);BT.alertTitle=BS?"Oops!":null;var BQ={success:function BP(BU){BT.msgid=BU.msgid;mstrApp.msgid=BU.msgid;if(BT.riid!==q){BT.firstTimeLoading=true;BT.loadReport(AW+x,S,f,L,{success:function(BV){E(BV,BT);}});}else{BT.skipMissingCheck=true;if(mstrApp.isFFSQL){BT.set("isFFSQL",true);BT.set("FFSQLMode",true);mstrApp.isFFSQLMode=true;BT.convertToFFSQL("",null,true);}}BT.set("isCloud",BS);BT.set("isCubeReport",mstrApp.saveAsCube!=2);},failure:function BR(BU){if(BT.riid===q){if(BU.getResponseHeader("X-MSTR-TaskErrorCode")===g){mstrmojo.confirm("Please contact your Administrator to update the Project Metadata.",[mstrmojo.Button.newInteractiveButton(A(1442,"OK"),function BV(){mstrApp.redirectToPage({evt:3010});})]);return ;}}mstrmojo.alert(BU.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}};mstrApp.getRootController().getDataService().createReportInstance(BQ,{reportid:BT.riid});BT.getShapeKeys();BT.getFunctions();},setDBRole:function H(BP){if(this.SelDBRoleID===BP){return ;}if(BP){mstrApp.getRootController().getDataService().setDBRole({success:function(BQ){mstrApp.msgid=BQ.msgid;}},{dbrid:BP});}this.SelDBRoleID=BP;},getRefreshOption:function AJ(){return this.refresh_opt;},setRefreshOption:function AM(BP){this.refresh_opt=BP;},getAutoReportName:function As(){var BP=this.tbns,BQ=[];k.forEach(BP,function(BS,BR){BQ.push(BR);});BQ=BQ.join("_");if(BQ==""){BQ="FFSQL";}return BQ.substring(0,252);},getFunctions:function I(){var BP=this;if(!this.functions){mstrApp.getRootController().getDataService().getSystemFunctions({success:function(BQ){BP.functions=F(BQ.fncs);}},{includeFunctionDetails:false,functionFlags:2});}},getFunctionList:function Ak(){return this.functions;},getSuggestionItems:function A0(BR){var BP=[],BS;if(BR){var BQ=this.dbtbls[this.SelDBRoleID];k.forEach(BQ,function(BT,BU){BP.push({n:BU,sta:2,t:15});});}else{k.forEach(this.tables,function(BT){k.forEach(BT.rows,function(BU){BS=BU.oriexpr;BP.push({n:BS,cmid:BU.srcData.id,rIndex:BU.rIndex+1,t:26,display:['<span class="mstrmojo-ArchitectListIconBlock t26 "></span><span>',BS,"</span>"].join("")});});});}t.forEach(this.functions,function(BT){t.forEach(BT.fns,function(BU){BP.push(BU);});});if(BR){this.FFsqlComp=BP;}return BP;},getConditions:function A7(){return this.conditions;},removeCondition:function AU(BP,BQ){mstrApp.getRootController().getDataService().editCondition({success:function BR(BS){mstrApp.msgid=BS.msgid;if(BQ&&BQ.success){BQ.success(BS);}}},{clause:BP?"where":"having",exp:""});},updateConditions:function O(BT,BV){var BQ=this,BU=this.conditions,BS={success:function BR(BX){BU.having=BV;BQ.updateFilterLabel(BU);}},BP=function BP(BX){BU.where=BT;if(BV){BQ.parseExpression(false,1,1,null,AG,BF(BV),"",BS);}else{if(BU.having){BQ.removeCondition(true,BS);}else{BS.success();}}},BW={success:BP};if(BT){this.parseExpression(false,1,1,null,Ai,BF(BT),"",BW);}else{if(BU.where){this.removeCondition(true,BW);}else{BP();}}},appendCondition:function J(BQ){var BR=this.conditions,BP=BQ.sqltp===0;condition=BP?BR.where:BR.having;if(!condition){condition=BQ;}else{if(condition.nds){condition.nds.push(BQ);}else{condition={et:AI.ANDOR,fn:o.FN.AND,nds:[k.copy(condition),BQ]};}}BR[BP?"where":"having"]=condition;this.parseExpression(false,1,1,null,(BP?Ai:AG),BF(condition),"",null);this.updateFilterLabel(BR);},updateFilterLabel:function BI(BW){var BQ={},BR=this.tables,BS,BV,BT,BP,BU;k.forEach(BW,function(BX){Az(BQ,BX);});k.forEach(BR,function(BX){BV=BX.rows;BS=BX.tbn.toLowerCase();BP=BQ[BS];k.forEach(BV,function(BY){BU=BY.state;BU=(BP&&BP[BY.text.toLowerCase()])?(BU|2):(BU&(~2));if(BY.state!==BU){BY.state=BU;BY.images[1]=BY.img[BU];BY.render();}});});}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.qb.FilterValueEditor","mstrmojo.qb.QBTableLinker","mstrmojo.qb.ConditionEditor","mstrmojo.qb.DBTable");mstrmojo.requiresDescs(629,9640,9940,9941,9641,9126,4449,2219,2220,520,612,521,523,522,524,9939,525,526,686,2784,687,2785,688,2786,696,746,9913,2131,2122,2127,2125,2123,9938,2151);var b=null;var X=mstrmojo.css,Q=mstrmojo.dom,G=mstrmojo.desc;var P="264px";var U="264px";var R=22;var K=[0,"tick",16,"mix"];var H=[{did:"Delete",n:G(629,"Delete")},{did:-1,n:"-"},{did:"0",n:G(9640,"Inner Join")},{did:"1",n:G(9940,"Left Outer Join")},{did:"2",n:G(9941,"Right Outer Join")},{did:"3",n:G(9641,"Outer Join")},{did:-1,n:"-"},{did:"More Options",n:G(9126,"More Options")}];var E=[{did:"0",n:G(9640,"Inner Join")},{did:"1",n:G(9940,"Left Outer Join")},{did:"2",n:G(9941,"Right Outer Join")},{did:"3",n:G(9641,"Outer Join")}];var V=[{did:"-2",n:G(4449,"Expression")},{did:-1,n:"-"},{did:2219,n:G(2219,"In list")},{did:2220,n:G(2220,"Not in list")},{did:-1,n:"-"},{did:520,n:G(520,"Exactly")},{did:612,n:G(612,"Not Exactly")},{did:-1,n:"-"},{did:521,n:G(521,"Greater than")},{did:523,n:G(523,"Less than")},{did:522,n:G(522,"Greater than equal")},{did:524,n:G(524,"Less than equal")},{did:-1,n:"-"},{did:"-5",n:G(9939,"Strings"),fns:[{did:525,n:G(525,"Like")},{did:526,n:G(526,"Not like")},{did:686,n:G(686,"Contains")},{did:2784,n:G(2784,"Does not contain")},{did:687,n:G(687,"Begins with")},{did:2785,n:G(2785,"Does not begin with")},{did:688,n:G(688,"Ends with")},{did:2786,n:G(2786,"Does not end with")}]},{did:-1,n:"-"},{did:"Between",n:G(696,"Between")},{did:"Not between",n:G(746,"Not between")}];var S=[{did:"0",n:G(4449,"Expression")},{did:"1",n:G(9913,"Aggregation Function"),fns:[{did:"-6",n:G(2131,"Sum"),idx:1},{did:"-6",n:G(2122,"Average"),idx:2},{did:"-6",n:G(2127,"Minimum"),idx:3},{did:"-6",n:G(2125,"Maximum"),idx:4},{did:"-6",n:G(2123,"Count"),idx:5},{did:"-6",n:G(9938,"Count Distinct"),idx:6}]},{did:"2",n:G(2151,"Filter"),fns:V}];function A(d,l,g,c){var k="",f=mstrmojo.all.QBuilderModel,h=f.selectedClns;f.validateExpr({expr:g,tKnStrm:k,isNew:true,qbrex:1,vo:0,cIndex:c},{success:function(n){d.count++;d.updateState(1);h[c-1].expr=l;f.addExpression(c);f.updateSQL();},failure:function(n){mstrmojo.array.removeIndices(h,c-1,1);mstrmojo.alert(n.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.webapi\.MSTRWebAPIException: \((.*)\)/,"$1"));}});}function O(c){return R*(c?(c+2):1);}function J(n){var f=mstrmojo.all.QBuilderModel,g=f.selectedClns,d=g.length,k,l=[];if(!n.srcData){k=f.gettIndex(n.id);for(var h=1,c=n.Rows.children.length;h<c;h++){l.push(n.Rows.children[h]);}}else{l.push(n);k=f.gettIndex(n.parent.parent.id);}f.addSelectedColumns(l,k,null,{success:function(){var q=0,o=l.length,p;for(q;q<o;q++){p=l[q];p.updateState(1);p.count++;}}});}var B=0,I=1,a=3;function Y(c,f,h){var k="mstr-qb-table-moreCM",g=mstrmojo.all[k];if(!g){g=new mstrmojo.MenuButton({id:k,cmCssClass:"mstrmojo-CXM",alias:"fctmenu",itemChildrenField:"fns",itemIdField:"did",itemField:"n",iconClass:"mstrmojo-ArchitectListIcon div",cm:S,domSrc:f,obj:h,dynamicUpdate:true,getMenuPosition:function d(){var l=mstrmojo.dom.position(this.domSrc,true);return{x:Math.round(l.x),y:Math.round(l.y+l.h)};},executeCommand:function(AF){var u=this.obj,p=mstrmojo.all.QBuilderModel,o=u.parent.parent,AE=p.gettIndex(u.srcID);switch(AF.did){case"0":mstrApp.getRootController().openExpressionEditor({type:B,w:u,tkn:u.expr});break;case"-2":mstrApp.getRootController().openExpressionEditor({n:mstrmojo.desc(5893,"New Condition"),w:u,tkn:u.expr,callbacks:{success:function t(AI){var AH=AI.mi;mstrApp.getRootController().addNewFilter({et:"*",expr:AH.tknstrm.mi.tkn,n:AI.expr,sqltp:AH.exp.sqltp});}}});break;case"-6":var l=p.selectedClns,z=l.length,AB=new Array(),q=u.parent.children,AA=o.selectedIndex;AB.push(u);var y={success:function(){var AJ=0,AH=AB.length,AI;for(AJ;AJ<AH;AJ++){AI=AB[AJ];if(AI.state==0||AI.state==2){AI.state++;AI.images[1]=AI.img[AI.state];AI.render();}AI.count++;}},failure:function(){}};p.addSelectedColumns(AB,AE,AF.idx,y);break;default:var n=this.obj,x=n.dt.tp,r={14:true,15:true,16:true},AG={30:true};switch(AF.did){case"Between":case"Not between":var AC=mstrmojo.all.fve2||(new mstrmojo.qb.FilterValueEditor2({}));AC.n=AF.n;AC.operatorID=AF.did;AC.column=n.oriexpr;AC.isDateTime=r[x];AC.isBigDecimal=AG[x];AC.open();break;default:var AD=mstrmojo.all.fve1||(new mstrmojo.qb.FilterValueEditor({}));AD.n=AF.n;AD.operatorID=AF.did;AD.column=n.oriexpr;AD.isDateTime=r[x];AD.isBigDecimal=AG[x];AD.open();}}}});g.render();}else{g.set("domSrc",f);g.set("obj",h);}g.showContextMenu();g.onContextMenuClose=function(){f.style.visibility="inherit";};}function F(k,h,f){var d=mstrmojo.all.QBuilderModel,n=Q.position(f.domNode),c=k.clientX,l=k.clientY,g=d.getTouchValue(c-n.x,l-n.y);if(g){d.selLink=g;h.drawMarker();W(k,g,h,{x:c,y:l});}else{d.selLink=null;h.clearHighLightCanvas();}}function W(c,h,f,l){var k="mstr-qb-table-joinCM",g=mstrmojo.all[k];if(!g){g=new mstrmojo.MenuButton({id:k,cmCssClass:"mstrmojo-CXM",cm:H,zIndex:999,itemChildrenField:"fns",itemIdField:"did",itemField:"n",dynamicUpdate:true,obj:h,pos:l,linker:f,getMenuPosition:function d(){return this.pos;},queryChecked:function(p){switch(p.did){case"Delete":case -1:case"More Options":return false;default:var n=mstrmojo.all.QBuilderModel;var o=n.selLink[0];return(n.joinsInfo[o].jt==p.did);}},executeCommand:function(r){var t=this.linker;var o=mstrmojo.all.QBuilderModel;var q=this.obj,p=r.did;switch(p){case"Delete":var n={success:function(){o.selLink=null;t.drawLinks();},failure:function(){}};o.removeLink(q[1],q[0],n);break;case"0":case"1":case"2":case"3":var n={success:function(u){o.joinsInfo[q[0]].jt=p;t.drawLinks();},failure:function(u){}};o.editJoin(q[0],q[1],p,n);break;case"More Options":N(c,q,t);break;default:break;}}});}else{g.set("pos",l);g.set("obj",h);g.set("linker",f);}g.showContextMenu();}function N(o,n,g,l){var f="mstr-qb-joinOption",h=mstrmojo.all[f];if(!h){h=new mstrmojo.Editor({id:f,slink:n,linker:g,title:mstrmojo.desc(9127,"Join Options"),help:(mstrApp.helpTopics&&mstrApp.helpTopics.tableJoin)||"join_options_dialog_box.htm",zIndex:100,cssText:"width:350px;",children:[{scriptClass:"mstrmojo.Label",cssText:"font-weight:bold; width:100%; padding: 5px;",text:mstrmojo.desc(9128,"Join")},{scriptClass:"mstrmojo.RadioList",alias:"radiolist",cssText:"padding-left:25px;",itemCssClass:"mstrmojo-QB-radiolist-item",items:E},{scriptClass:"mstrmojo.Label",cssText:"font-weight:bold; width:100%; padding-left: 5px;",text:mstrmojo.desc(9129,"Join Operator")},{scriptClass:"mstrmojo.Label",cssText:"padding-left:100px;",bindings:{text:"this.parent.srcText"}},{scriptClass:"mstrmojo.HBox",alias:"jop",cssText:"position:relative;left:100px;",children:[{scriptClass:"mstrmojo.Pulldown",items:[{n:"=",dssid:"0"},{n:">",dssid:"1"},{n:">=",dssid:"2"},{n:"<",dssid:"3"},{n:"<=",dssid:"4"},{n:"<>",dssid:"5"}],popupToBody:true}]},{scriptClass:"mstrmojo.Label",cssText:"padding-left:100px;",bindings:{text:"this.parent.tgtText"}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"float:right;",text:mstrmojo.desc(1442,"OK"),onclick:function(AB){var y=this.parent.parent;var r=mstrmojo.all.QBuilderModel,q=y.radiolist.selectedItem.did,z=y.slink[1],t=y.slink[0],x=y.jop.children[0].selectedItem,AA=r.brackets(y.srcText)+x.n+r.brackets(y.tgtText);var u={success:function(AC){y.linker.drawLinks();},failure:function(AC){}};r.editJoin(t,z,q,u,AA,x.dssid);if(y.onOK){y.onOK();}y.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(q){var r=this.parent.parent;if(r.onCancel){r.onCancel();}r.close();}}]}]});}else{h.set("slink",n);h.set("linker",g);}var c=mstrmojo.all.QBuilderModel,p=c.joinsInfo[n[0]].links[n[1]],d=p.srcw.oriexpr,k=p.tgtw.oriexpr;h.set("srcText",d);h.set("tgtText",k);h.radiolist.set("selectedIndex",parseInt(c.joinsInfo[n[0]].jt));h.jop.children[0].set("value",p.op||"0");h.open();}function C(g,k,o,n,f){var c=mstrmojo.all.QBuilderModel;var t=new mstrmojo.qb.DBTable({scriptClass:"mstrmojo.qb.DBTable",cssText:"opacity:0.3;filter:alpha(opacity=30);left:0px;top:0px;width:180px;height:"+k+"px;",title:f,visible:false,noCheckBox:true});t.container=g.parent;t.selectedIndex=new Array();var q=c.gettIndex(t.id);g.addChildren([t]);t.maxHeight=t.editorNode.clientHeight;t.maxWidth=Math.max(t.Rows.domNode.clientWidth,t.titlebarNode.clientWidth);if(t.maxHeight>parseInt(P)){t.set("height",P);}var d=o+"px",p=n+"px",u=o+t.editorNode.clientWidth,l=n+t.editorNode.clientHeight,r=t.editorNode.style;r.left=d;r.top=p;r.width=t.titlebarNode.clientWidth+"px";t.left=d;t.top=p;return t;}function M(t,AN){var AK=AN.h,r=AN.w,q=AN.x,p=AN.y,f=AN.tbn,AL=AN.did,u=AN.dbtbn,z=AN.ns,AI=AN.readOnly,k=mstrmojo.all.QBuilderModel;var AA=O(t.length);var n=k.dbtables.length+1;q=(q===undefined)?n*15:q;p=(p===undefined)?n*15:p;var AD=new mstrmojo.qb.DBTable({scriptClass:"mstrmojo.qb.DBTable",cssText:"position:absolute;left:0px;top:0px;width:"+(r?r:180)+"px;height:"+AA+"px;",left:q+"px",top:p+"px",readOnly:AI,title:f,visible:true,noCheckBox:true,onClose:function(){var x=this;var h={success:function(){x.parent.parent.linker.drawLinks();},failure:function(){}};k.removeTable(this,h);},onRender:function(){if(AI&&this.closeNode){this.closeNode.title="Cannot delete this table since it is being used by the dashboard";mstrmojo.css.addClass(this.closeNode,"readonly");}}});k.upttIndex(f,u,AD.id,true,AL,z);if(AL){k.uiids[AL]=AD.id;}AD.model=k;AD.container=this.parent;AD.selectedIndex=new Array();var AM=k.gettIndex(AD.id);var l,o,AC,AH,AJ=t.length;if(AJ){AD.addRow("*",0,["0","0"],"");l=AD.Rows.children[0];l.draggable=false;l.dropZone=false;l.allowDrop=false;l.rIndex=-1;l.table=AD;l.cxtmenus=[{n:"add"}];l.onclick=function(h){if(mstrmojo.dom.eventTarget(h.hWin,h.e).className.indexOf("add")>-1){J(AD);}};l.ondblclick=function(h){if(mstrmojo.dom.eventTarget(h.hWin,h.e).className.indexOf("add")<0){J(AD);}};}for(AH=0;AH<AJ;AH++){o=t[AH].cln;AC=t[AH].state?["0",K[t[AH].state]]:["0","0"];AD.addRow(t[AH].cln,0,AC,"");AD.selectedIndex[AH]=false;l=AD.Rows.children[AH+1];l.cssClass=(AH%2)?"odd":"even";l.srcTable=f;l.srcID=AD.id;l.srcData=t[AH];l.oriexpr=t[AH].exp?t[AH].exp:(f+"."+t[AH].cln);l.expr=[{isNew:true,v:k.brackets(l.oriexpr),oi:{tIndex:AM,rIndex:AH+1,t:"26",n:l.oriexpr}}];l.img=K;l.cxtmenus=[{n:"add"},{n:"more"}];l.state=!t[AH].state?0:t[AH].state;k.tables[AD.id].rows[l.id]=l;l.rIndex=AH;l.count=!t[AH].count?0:t[AH].count;l.dt={ps:t[AH].dtps,sc:t[AH].dtsc,tp:t[AH].dttp};l.updateState=function(x){if(this.count<=0){this.state=this.state&2;}this.state=this.state|x;var h=(this.state&1)+(this.state&2);this.images[1]=this.img[h];this.render();};l.onclick=function(h){var x=mstrmojo.dom.eventTarget(h.hWin,h.e);if(x.className.indexOf("add")>-1){J(this);}else{if(x.className.indexOf("more")>-1){Y(h,x,this);}}};l.ondblclick=function(h){if(mstrmojo.dom.eventTarget(h.hWin,h.e).className.indexOf("add")<0){J(this);}};if(AL){k.uiids[AL+t[AH].did]=l.id;}}this.addChildren([AD]);AD.maxHeight=AA;AD.maxWidth=Math.max(AD.Rows.domNode.clientWidth,AD.titlebarNode.clientWidth);if(AK<AA){AD.set("height",AK+"px");}var AO=q+"px",AF=p+"px",AG=q+AD.editorNode.clientWidth,d=p+AD.editorNode.clientHeight,AE=AD.editorNode.style,c=this.parent,g=this.domNode.style,AB=c.linker;AD.titlebarNode.style.width=parseInt(AE.width,10)-38+"px";AD.titleNode.style.width=AD.titlebarNode.style.width;return AD;}mstrmojo.qb.QBTableView=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.QBTableView",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.Box",alias:"scrollBox",cssClass:"mstrmojo-qb-tableview-box",maxWidth:0,maxHeight:0,children:[{scriptClass:"mstrmojo.qb.QBTableLinker",alias:"linker",cssClass:"mstrmojo-qb-tableview-linker",dropZone:true,allowDrop:function D(c){if(c.src&&c.src.data&&c.src.data.st&&c.src.data.st==8405){return true;}return false;},ondrop:function T(d){this.parent.canvasbox.ondrop(d);},ondragenter:function L(d){this.parent.canvasbox.ondragenter(d);},onclick:function Z(c){F(c.e,this,this);},postCreate:function(){if(!mstrmojo.all.QBuilderModel){var c=new mstrmojo.qb.QBuilderModel({});}mstrmojo.all.QBuilderModel.attachEventListener("JoinsLoaded",this.id,"drawLinks");}},{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousemove> </div>',cssClass:"mstrmojo-qb-tableview-canvas",alias:"canvasbox",dropZone:true,allowDrop:function D(c){if(c.src&&c.src.data&&c.src.data.st&&c.src.data.st==8405){return true;}return false;},onclick:function Z(c){F(c.e,this.parent.linker,this);},displayBindingTable:function(o){var p=o.value,d=0,k=20,n=20,q=0,c=0,l,u,f=0;for(var g=0,h=p.length;g<h;g++){u=p[g];l=u.pos;if(l){n=l.t;d=l.l;q=l.h;c=l.w;}else{q=O(u.cs.length);d+=f+k;}u.h=q;u.w=c;u.x=d;u.y=n;u.readOnly=mstrApp.isCloud;var r=M.call(this,u.cs,u);f=r.editorNode.clientWidth;}},updateTableName:function(k){var h=k.tid;if(h&&mstrmojo.all[h]){var f=mstrmojo.all.QBuilderModel,g=mstrmojo.all[h],d=g.Rows.children,l,c=k.value;mstrmojo.array.forEach(d,function(o,n){if(n>0){o.oriexpr=c+"."+o.srcData.cln;o.expr[0].v=f.brackets(o.oriexpr);o.expr[0].n=o.oriexpr;f.tables[h].rows[o.id]=o;}});}},postCreate:function(){var c=mstrmojo.all.QBuilderModel;if(!c){c=new mstrmojo.qb.QBuilderModel({});}c.attachEventListener("BindingTableLoaded",this.id,"displayBindingTable");c.attachEventListener("TableAdded",this.id,"drawTable");c.attachEventListener("TableNameChanged",this.id,"updateTableName");},ondragenter:function L(c){var f=mstrmojo.all.QBuilderModel;if(f.FFSQLMode==true){return true;}var d=c.src.widget.parent.avatar;var h=d.firstChild;if(b==null){b=C(this,"105","1","1",c.src.data.n);}b.domNode.style.display="none";var g=b.domNode.cloneNode(true);g.firstChild.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling.firstChild.innerHTML=c.src.data.n;g.style.display="block";d.removeChild(h);d.appendChild(g);return true;},ondrop:function T(l){var h=l.src;if(h&&h.data){var f=h.widget,d=f.parent;d.avatar.style.display="none";d.ownAvatar=false;var g=l.tgt.pos,k=Q.position(this.domNode);f.getColumns&&f.getColumns({success:function(c){mstrmojo.all.QBuilderModel.addTable(mstrmojo.hash.copy(h.data.tag,{posX:g.x-k.x,posY:g.y-k.y}),c.items);}});}},drawTable:function(c){var g=c.data,f=c.table,d=O(g.length);d=(d>parseInt(P,10))?parseInt(P,10):d;f.h=d;f.w=null;M.call(this,g,f);}}]}],onheightChange:function(f){var d=parseInt(f.value);this.scrollBox.set("height",d+"px");var c=this.scrollBox.canvasbox;if((!c.height)||(c.domNode&&d>c.domNode.clientHeight)){c.set("height",d+"px");this.scrollBox.linker.set("height",d);}if(this.scrollBox.domNode){this.scrollBox.domNode.style.height=this.scrollBox.height;if(parseInt(this.scrollBox.height)<this.scrollBox.maxHeight){this.scrollBox.linker.set("height",parseInt(this.scrollBox.maxHeight));this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();this.scrollBox.canvasbox.domNode.style.height=parseInt(this.scrollBox.maxHeight)+"px";this.scrollBox.domNode.style["overflow-y"]="auto";}else{this.scrollBox.linker.set("height",d);this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();c.domNode.style.height=d+"px";c.height=c.domNode.style.height;this.scrollBox.domNode.style["overflow-y"]="hidden";}}},onwidthChange:function(f){var c=parseInt(f.value);this.scrollBox.set("width",c+"px");var d=this.scrollBox.canvasbox;if((!d.width)||(d.domNode&&c>d.domNode.clientWidth)){d.set("width",c+"px");this.scrollBox.linker.set("width",c);}if(this.scrollBox.domNode){this.scrollBox.domNode.style.width=this.scrollBox.width;if(parseInt(this.scrollBox.width)<this.scrollBox.maxWidth){this.scrollBox.linker.set("width",parseInt(this.scrollBox.maxWidth));this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();this.scrollBox.canvasbox.domNode.style.width=parseInt(this.scrollBox.maxWidth)+"px";this.scrollBox.domNode.style["overflow-x"]="auto";}else{this.scrollBox.linker.set("width",c);this.scrollBox.linker.render();this.scrollBox.linker.drawLinks();d.domNode.style.width=c+"px";d.width=d.domNode.style.width;this.scrollBox.domNode.style["overflow-x"]="hidden";}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.css","mstrmojo.string","mstrmojo.qb.QBTableView","mstrmojo.qb.FFsql","mstrmojo.Label","mstrmojo.Table","mstrmojo.Button");var J=mstrmojo.string,E=mstrmojo.css,G="on";var F=1,H=2;var A=mstrmojo.desc(9215,"Type multi-pass SQL or double-click a table name");mstrmojo.qb.QBPanel=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.QBPanel",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},cssText:"position:relative;",mode:F,children:[{scriptClass:"mstrmojo.Box",alias:"header",cssClass:"mstrmojo-qb-tableview-toolbar",children:[{scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-qb-tableview-toolbarIcon play",text:mstrmojo.desc(9130,"Execute SQL"),onclick:function(){var N=mstrApp.getRootController(),M=this.parent.parent;if(M.mode===F){N.autoMap();}else{var P=M.SQL.ffsql,O=P.getSQLstmt();if(O===P.txt){if(J.trim(O)!==""){N.autoMap();}}else{N.editSQL(O,{success:function Q(){if(J.trim(O)!==""){P.txt=O;N.autoMap();}}});}}}},{scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-qb-tableview-toolbarIcon erase",text:mstrmojo.desc(2827,"Clear"),bindings:{visible:function(){return this.parent.parent.mode===H;}},onclick:function K(){var M=this.parent.parent.SQL.ffsql;M.clearTokens();M.updatepasses();}},{scriptClass:"mstrmojo.Button",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup,mouseover><div class="mstrmojo-Button-text mstrmojo-qb-sqlpreview-tooltip"></div></div>',bindings:{visible:function(){var M=(this.parent.parent.mode===F);this.set("iconClass","mstrmojo-qb-tableview-toolbarIcon "+(M?"toFFSQL":"toQB"));this.hasRendered&&this.render();return !mstrApp.isFFSQL;}},onclick:function(){mstrApp.getRootController().convertMode(this.parent.parent.mode===F);},onmouseover:function L(){var M=this;if(this.parent.parent.mode===F){mstrApp.getRootController().getSQLPreview({success:function N(O){var P=mstrmojo.desc(9137,"Edit SQL");M.set("text",(O?"<div>"+P+"<p>"+J.encodeHtmlString(O)+"<div>":P));}});}else{M.set("text",mstrmojo.desc(9141,"Convert to QueryBuilder"));}}},{scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-qb-tableview-toolbarIcon refresh",text:mstrmojo.desc(9927,"Update Tables"),bindings:{visible:function(){return(this.parent.parent.mode===F);}},onclick:function(){mstrApp.getRootController().updateTableStructure();}}]},{scriptClass:"mstrmojo.qb.QBTableView",cssClass:"mstrmojo-qb-tableview on",alias:"tables",bindings:{visible:function(){return(this.parent.mode===F);}}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-qb-ffsqlview",alias:"SQL",bindings:{visible:function(){return(this.parent.mode===H);}},onwidthChange:function C(M){var P=this.ffsql,O=P.domNode,N=Math.max(parseInt(M.value,10)-10,0)+"px";P.set("width",N);O&&(O.style.width=N);},children:[{scriptClass:"mstrmojo.Box",alias:"passlabel",cssClass:"mstrmojo-qb-ffsqlview-passlabel"},{scriptClass:"mstrmojo.qb.FFsql",alias:"ffsql",cssClass:"mstrmojo-qb-ffsqlview-editnode",id:"FFsql",txt:"",dropZone:true,onwidthChange:function C(){this.hasRendered&&this.updatepasses();},onheightChange:function B(){this.hasRendered&&this.updatepasses();},updateSQL:function(M){if(!this.candidates){this.set("candidates",{items:this.sqlTokens.concat(mstrApp.getRootController().getSuggestionItems(true)),isComplete:true});}this.clearTokens();this.clipboardNode.value=this.txt=M.value;this.handlepaste();this.oriSQL=this.getSQLstmt();}}]}],enterMode:function I(M){var P=M.mode;this.set("mode",P);var N=(P===H);this.tables.set("visible",!N);E.toggleClass(this.tables.domNode,G,!N);E.toggleClass(this.SQL.domNode,G,N);this.SQL.set("visible",N);if(N){var O=this.SQL.ffsql;O.updateSQL(M);}else{this.tables.scrollBox.linker.drawLinks();}},onheightChange:function(M){if(this.domNode&&this.header.domNode){this.tables.set("height",parseInt(M.value,10)-this.header.domNode.clientHeight+"px");this.SQL.set("height",this.tables.height);}},onwidthChange:function C(M){this.tables.set("width",this.width);this.SQL.set("width",this.width);},postBuildRendering:function D(){if(this._super){this._super();}var M=mstrApp.getRootController();M.attachEventListener("reportModeChange",this.id,this.enterMode);M.attachEventListener("addCandidateTables",this.SQL.ffsql.id,"addCandidateTables");}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.qb.SplitPanel","mstrmojo.qb.VSplitPanel","mstrmojo.WH.WHPanel","mstrmojo.qb.QBPanel","mstrmojo.qb.QBMappings","mstrmojo.qb.MissingColumnWarning");var H="leftItem",C="rightItem",A="topItem",F="bottomItem";mstrmojo.qb.QBPageLayout=mstrmojo.declare(mstrmojo.qb.SplitPanel,null,{children:[{scriptClass:"mstrmojo.WH.WHPanel",alias:"WHTableTree",slot:H,onDBRoleSelection:function G(J){mstrApp.getRootController().setDBRole(J.value);},allowdragstart:function D(J){var K=J.src.data;return mstrApp.isFFSQLMode||!K||!K.cln;},onDBTablesChange:function E(J){mstrApp.getRootController().addSQLCandidateTables(J.value);},onColumndblclick:function B(J){if(mstrApp.isFFSQLMode){var K=J.src,L=K.parent.data.tag;mstrApp.getRootController().addSQLFromColumn(mstrmojo.hash.copy(K.data,{tbn:L.tbn,ns:L.ns}));}},onTabledblclick:function I(K){var J=mstrApp.getRootController(),L=K.src.data.tag;if(mstrApp.isFFSQLMode){if(mstrApp.isCloud){return ;}J.addSQLFromTable(L.ns,L.tbn,K.items);}else{J.addTable(L,K.items);}}},{scriptClass:"mstrmojo.qb.VSplitPanel",cssClass:"mstrmojo-qb-main-panel",alias:"workPanel",slot:C,topP:70,borderoffset:10,bottomItemVisible:false,children:[{scriptClass:"mstrmojo.qb.QBPanel",slot:A},{scriptClass:"mstrmojo.qb.QBMappings",alias:"mappingPanel",slot:F}],layoutConfig:{w:{topItem:"100%",bottomItem:"100%"},h:{topItem:"100%",bottomItem:"0%"}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.Box","mstrmojo.Table","mstrmojo.Image","mstrmojo.Button","mstrmojo.qb.SplitPanel","mstrmojo.qb.VSplitPanel","mstrmojo.qb.QBuilderModel","mstrmojo.WH.WHPanel","mstrmojo.qb.QBPanel","mstrmojo.qb.QBMappings","mstrmojo.qb.MissingColumnWarning","mstrmojo.form","mstrmojo.hash","mstrmojo.array","mstrmojo.qb.Toolbar","mstrmojo.qb.QBPageLayout","mstrmojo.qb.Footer","mstrmojo.DI.DIExitOptions");var T=mstrmojo.hash;var H=1,E=2,K=4;var D=[{did:H,n:mstrmojo.desc(9117,"Replace existing data")},{did:K,n:mstrmojo.desc(9118,"Update existing data and add new data")},{did:E,n:mstrmojo.desc(9119,"Keep existing data and add new data")}];var G="qb-refresh-option",R={scriptClass:"mstrmojo.Editor",id:G,cssClass:"mstrmojo-qb-refreshoption-editor",showTitle:true,title:mstrmojo.desc(9120,"Options - Data Refresh"),zIndex:9999,onoptionChange:function Z(){this.radiolist.singleSelectByField(this.option,"did");},children:[{scriptClass:"mstrmojo.Label",cssClass:"instruction",text:mstrmojo.desc(9121,"Choose data refresh policy:")},{scriptClass:"mstrmojo.RadioList",alias:"radiolist",cssClass:"optionlist",itemCssClass:"optionlist-item",items:D},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button OK",text:mstrmojo.desc(1442,"OK"),onclick:function c(d){var f=this.parent.parent;mstrApp.getRootController().setRefreshOption(f.radiolist.selectedItem.did);f.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(d){this.parent.parent.close();}}]}]};var P="qbexpr",W={scriptClass:"mstrmojo.qb.ExpressionEditor",id:P};var B=" ",O=".";function F(d,f){if(!f){return d;}return(d.indexOf(B)>-1||d.indexOf(O)>-1)?f.replace("#0",d):d;}function S(g,l,h){var r=[],f=mstrmojo.all.FFsql,t,o,p=h.length,q=f.items,n,k=this.main.WHTableTree,d=k.getDBRole(k.getDBRoleID()).cpat;t=o=f.itemCount;r.push({isNew:true,v:"select",oi:{n:"select",sta:100,t:100},did:o++},{isNew:true,v:" ",isDelimiter:true,did:o++});mstrmojo.array.forEach(h,function(x,u){r.push({isNew:true,v:F(x.cln,d),did:o++});n=u<p-1;if(n){r.push({isNew:true,v:",",isDelimiter:true,did:o++});}r.push({isNew:true,v:"\n",isDelimiter:true,did:o++});if(n){r.push({isNew:true,v:" ",isDelimiter:true,did:o++});}});l=F(l,d);r.push({isNew:true,v:"from",oi:{n:"from",sta:100,t:100},did:o++},{isNew:true,v:" ",isDelimiter:true,did:o++},{isNew:true,v:(g?F(g,d)+O+l:l),did:o++},{isNew:true,v:";",did:o++});if(t>0&&q[t-1]!=="\n"){q.push({isNew:true,v:"\n",isDelimiter:true,did:o++});}q=q.concat(r);f.itemCount=o;f.set("items",q);f.updatepasses();}mstrmojo.qb.QBuilderPage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.QBuilderPage",markupString:'<div id="{@id}" class="mstrmojo-qb {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-toolbar"></div><div class="mstrmojo-qb-layout"></div><div class="mstrmojo-qb-footer"></div></div>',markupSlots:{toolbar:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.children[1];},footer:function(){return this.domNode.lastChild;}},layoutConfig:{h:{toolbar:"25px",footer:"44px",layout:"100%"},w:{toolbar:"100%",footer:"100%",layout:"100%"}},id:"QBuilderPage",onError:mstrmojo.emptyFn,renderPageLoadError:function M(){var g=this.error,f=g.message,h=g.title,d=g.btns;this.onError(g);if(!d||!d.length){mstrmojo.alert(f,null,h);}else{mstrmojo.confirm(f,d,h);}},render:function b(){if(this.error){this.renderPageLoadError();}else{this._super();}},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",help:(mstrApp.helpTopics&&mstrApp.helpTopics.saveAs)||"Save_As_dialog_box.htm",typeDesc:mstrmojo.desc(3377,"Object"),browsableTypes:"3,8",showCompletePath:false,onObjectSaved:function(g){var f=this.opener,d=f&&f.oi;if(f&&d){d.did=g.did;d.n=g.name;d.desc=g.desc;f.set("title","QBReport: "+g.name);}}},children:[{scriptClass:"mstrmojo.qb.Toolbar",slot:"toolbar",alias:"toolbarWidget"},{scriptClass:"mstrmojo.qb.QBPageLayout",slot:"layout",alias:"main"},{scriptClass:"mstrmojo.qb.Footer",slot:"footer",alias:"footerWidget"}],openDialog:function Y(d){this.openPopup(d);},openRefreshOptionDialog:function A(d){var f=mstrmojo.all[G]||mstrmojo.insert(R);f.open();f.set("option",d||H);},openExpressionEditor:function N(f){var d=mstrmojo.all[P]||mstrmojo.insert(W);d.set("oi",T.copy(f,{mhfts:{},mvfts:{}}));d.open();},addSQLFromColumn:function V(d){S.call(this,d.ns,d.tbn,[d]);},addSQLFromTable:function U(f,g,d){S.call(this,f,g,d);},getSQLStatement:function J(){return mstrmojo.all.FFsql.getSQLstmt();},toggleDatabaseView:function a(d){this.main.set("leftItemVisible",d);},toggleDataPreview:function I(d){this.main.workPanel.set("bottomItemVisible",d);},setDBRoleID:function X(d){this.main.WHTableTree.setDBRoleID(d.value);},loadView:function Q(){this.main.WHTableTree.load();this.toggleDataPreview(true);this.toggleDataPreview(false);},showRedirectionPage:function L(d,f){this.set("children",[{scriptClass:"mstrmojo.Label",slot:"toolbar",text:"Data Imported",cssClass:"mstrmojo-qb-title"},{scriptClass:"mstrmojo.Image",cssClass:"mstrmojo-qb-toolbarIcon help",slot:"toolbar",title:mstrmojo.desc(1143,"help"),onclick:function(){var g=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+((mstrApp.helpTopics&&mstrApp.helpTopics.general)||"About_importing_data.htm");window.open(g);}},{scriptClass:"mstrmojo.DI.DIExitOptions",privileges:{CreateViewReport:mstrConfig.canCreateReport,CreateReportServices:mstrConfig.canCreateDocument,CreateAnalysis:mstrConfig.canCreateAnalysis},model:{cubeID:d,path:f},slot:"layout"},{scriptClass:"mstrmojo.qb.Footer",slot:"footer",alias:"footerWidget"}]);this.footerWidget.hidePublish();},browserResized:function C(f){var d=parseInt(f.w,10)-15+"px";var g=parseInt(f.h,10)-70+"px";if(this.height&&g!==this.height){this.set("height",g);}else{this.height=g;}if(this.width&&d!==this.width){this.set("width",d);}else{this.width=d;}return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.Serializer","mstrmojo.array","mstrmojo.qb.QBuilderPage","mstrmojo.qb.QBuilderModel");var S=mstrmojo.hash,V=mstrmojo.array;var F=function(p){if(p==null){return"null";}var q=typeof (p);if(q!="object"){return q;}else{if(p.length===undefined){return"object";}else{return"array";}}};mstrmojo.qb.RootController=mstrmojo.declare(mstrmojo.Obj,null,{start:function T(){var q=this.rootView,p=this.model;this.dataService=mstrmojo.qb.DataService;p.attachEventListener("dbroleChange",q.id,q.setDBRoleID);q.render();mstrApp.docID=mstrApp.docID||mstrApp.analysisID||"";mstrApp.isFFSQL&&this.raiseEvent({name:"reportModeChange",mode:2,value:""});q.loadView();p.createReportInstance();},getDataService:function J(){return this.dataService;},toggleDatabaseView:function l(p){this.rootView.toggleDatabaseView(p);},toggleDataPreview:function b(p){var r=this.rootView,q=this.model.FFSQLMode;r.toggleDataPreview(p);if(!q){r.showQBPreview=p;}if(p){this.raiseEvent({name:"dataPreview"});}},openConditionDialog:function M(){var q=this.model;if(q.dbtables.length===0){mstrmojo.alert(mstrmojo.desc(9114,"Cannot add Filter without any Tables being added, please add some Tables first"));return ;}var r="qbcondition",p=mstrmojo.all[r]||mstrmojo.insert({scriptClass:"mstrmojo.qb.ConditionEditor",id:r});if(!p.hasRendered){p.render();}p.set("data",S.copy(q.getConditions()));p.set("visible",true);},openRefreshOptionDialog:function E(){this.rootView.openRefreshOptionDialog(this.model.getRefreshOption());},openHelp:function P(){var q=mstrApp.helpTopics||{},p=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(mstrApp.isFFSQL?(q.mainSQL||"freeform_import_page.htm"):(q.mainDB||"database_import_page.htm"));window.open(p);},openExpressionEditor:function H(p){this.rootView.openExpressionEditor(p);},getFunctionList:function Y(){return this.model.getFunctionList();},getSuggestionItems:function n(p){return this.model.getSuggestionItems(p);},exprjson2xml:function L(AE,AB,t){if(!(AB instanceof Array)){AB=[AB];}var q=t&&t.isSerializable,z=(t.convertBoolean===false)?false:true;var AC=[],p=[],r,AF;for(var y=0,AG=AB.length;y<AG;y++){var AH=AB[y];for(r in AH){if(q){var AA=q(r,AB,y);if(AA!==true){if(AA===false){continue;}else{if(AA.att){AC.push(AA.att);}if(AA.child){p.push(AA.child);}continue;}}}AF=AH[r];switch(F(AF)){case"array":if(r!=="omit"){p.push(["<",r,">"].join(""));for(var u=0,x=AF.length;u<x;u++){var AD=t.getArrItemName(r,AF,u)||u;p.push(this.exprjson2xml(AD,AF[u],t));}p.push("</"+r+">");}else{for(var u=0,x=AF.length;u<x;u++){var AD=t.getArrItemName(r,AF,u)||u;p.push(this.exprjson2xml(AD,AF[u],t));}}break;case"object":p.push(this.exprjson2xml(r,AF,t));break;case"string":AC.push([r,'="',mstrmojo.string.encodeXMLAttribute(AF),'"'].join(""));break;case"boolean":AC.push([r,'="',((z)?(AF?"-1":"0"):AF),'"'].join(""));break;case"null":if(!t.skipNull){AC.push([r,'="',t.nullValue,'"'].join(""));}break;default:AC.push([r,'="',AF,'"'].join(""));break;}}}return["<",AE," ",AC.join(" "),">",p.join(""),"</",AE,">"].join("");},parseExpression:function B(q,p){this.model.validateExpr(q,p);},autoMap:function c(){var p=this;if(!p.hasDBConnection()){return ;}p.model.autoMap({success:function(){p.toggleDataPreview(true);}},false,false);},getSQLPreview:function Q(p){this.model.getSQL(p);},convertMode:function h(p){var u=this;if(p){this.model.getSQL({success:function AA(AB){u.model.convertToFFSQL(AB,{success:function AC(){u.toggleDataPreview(false);u.raiseEvent({name:"reportModeChange",mode:2,value:AB});}});}});}else{var x=u.rootView.showQBPreview,z={success:function(){u.toggleDataPreview(x);u.raiseEvent({name:"reportModeChange",mode:1,showPreview:x});}};var q=mstrmojo.all.FFsql;if(q.oriSQL===q.getSQLstmt()){u.model.convertToQueryBuilder(z);}else{var t=mstrmojo.Button.newInteractiveButton;mstrmojo.confirm(mstrmojo.desc(9139,"All changes performed in FFSQL mode will be lost. Do you want to leave FFSQL mode?"),[t(mstrmojo.desc(1442,"OK"),function r(){u.model.convertToQueryBuilder(z);},null),t(mstrmojo.desc(221,"Cancel"),function y(){},null)]);}}},editSQL:function o(p,q){this.model.editFFSQL(q,p);},setRefreshOption:function R(p){this.model.setRefreshOption(p);},setDBRole:function f(p){this.model.setDBRole(p);},addTable:function Z(q,p){this.model.addTable(q,p);},addSQLFromTable:function d(q,r,p){this.rootView.addSQLFromTable(q,r,p);},addSQLFromColumn:function a(p){this.rootView.addSQLFromColumn(p);},addSelectedColumns:function K(t,p,r,q){this.model.addSelectedColumns(t,p,r,q);},addSelectedColumn:function g(p,r,q){this.model.addSelectedColumn(p,r,q);},getColumnsForDBTable:function U(p,q){this.rootView.main.WHTableTree.getTableColumns(p,q);},updateTableViewWithExpression:function G(q,p){var x=this.model,u=x.selectedClns[q-1],t=u.wid,r,y;u.expr=p;V.forEach(t,function(z){r=mstrmojo.all[z];if(r){if(r.count>0){r.count--;}r.updateState(0);}});t=[];V.forEach(p,function(z){y=z.oi;if(y&&y.tp===26){r=x.getRowWidget(y.tn,y.rn);if(r){r.count++;r.updateState(1);t.push(r.id);}}});u.wid=t;x.updateExpression(q);},updateFilters:function k(p,q){this.model.updateConditions(p,q);},addNewFilter:function I(p){this.model.appendCondition(p);},cancel:function D(){if(mstrApp.isCloudPro){rrOpenHomePage&&rrOpenHomePage();}else{mstrmojo.form.send({evt:"3124",src:mstrApp.name+".qbuilder.3124",relativePageNumber:"-1"},mstrApp.name,"POST",null,null,false);}},addSQLCandidateTables:function W(p){this.raiseEvent({name:"addCandidateTables",value:p});},hasDBConnection:function X(){if(this.model.SelDBRoleID){return true;}mstrmojo.alert(mstrmojo.desc(9915,"Please select a database connection first."));return false;},publish:function N(){var u=this.model,x=u.FFSQLMode?this.rootView.getSQLStatement():"",q=u.isNew,p=mstrApp.folderID,r=this,t={success:function(AB){if(mstrApp.analysisID||mstrApp.msgID){var AC=mstrApp.analysisID?[3169,mstrApp.name+".3169","messageID",mstrApp.analysisID]:[3104,mstrApp.name+".3104","messageID",mstrApp.msgID,"rwDesignMode",1,"executionMode",2],AA=[AC,[2048007,mstrApp.name+".rwd.rwframe.rwb.2048007","dsObjectID",AB.did,"dsType",3,"isDatasetAdded",false,"isDefault",false]];mstrApp.redirectToPage({evt:"1024001",events:mstrmojo.Serializer.serializeValueGroup(AA),src:mstrApp.name+"."+mstrApp.pageName+".1024001","1024001":"1",evtorder:"1024001"});}else{r.gotoRedirectionPage(AB.did,AB.path);}}};if(!this.hasDBConnection()){return ;}if(p||!q){var z=q&&mstrApp.isCloud;u.save((z?u.getAutoReportName():null),null,p,!q,z,x,{success:function(AC){var AB=mstrApp.analysisID;if(!q&&AB){mstrApp.hideWait(true);var AA=mstrmojo.insert({scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInfoEditor",showTitle:false,analysisID:AB,children:[{scriptClass:"mstrmojo.Label",text:"Edit data successfully!",cssClass:"mstrmojo-AttCreator-Text"},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button",onclick:function(AE){var AD=this.parent.parent;AD.close();if(rrLockAndRunDashboard){rrLockAndRunDashboard(AB);}else{mstrApp.redirectToPage({evt:"3104",rwDesignMode:"0",rwViewMode:"2048",executionMode:"1",objectType:"55",objectID:AB});}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button",onclick:function(AE){var AD=this.parent.parent;AD.close();mstrApp.showWait();if(mstrApp.isCloud){rrOpenHomePage&&rrOpenHomePage();}else{mstrApp.redirectToPage({evt:3010});}}}]}]});AA.open();}else{r.gotoRedirectionPage(AC.did,AC.path);}}});}else{var y=this.rootView;y.openPopup("saveasRef",{folderLinksContextId:mstrConfig.hasProfileReports?28:1,name:mstrmojo.desc(8041,"New Cube"),saveAs:function(AE){var AF=this,AA=AF.contPanel,AB=AA.name.value,AD=AF.ob.currentFolder,AC=AD.did,AG=AD.items,AH=AB.toUpperCase();if(!AB){mstrmojo.confirm(mstrmojo.desc(9523,"Enter a Name"),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return ;}V.forEach(AG,function(AJ){if(AJ.t===3&&AJ.n.toUpperCase()===AH){AH="";return false;}});var AI=function AI(){u.save(AB||"",AA.desc.value||"",AC,true,false,x,t);AF.close();};if(AH){AI();}else{mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",mstrmojo.desc(3377)).replace("###",AB),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(219),function(){AI();},null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(218),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(3179));}}});}},updateTableStructure:function C(){var p=this.model;p.compareDBTables({success:function(){if(p.hasMissingUsedDBColumns()){mstrmojo.confirm("There are missing columns used in expressions. Do you want to update?",[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(219),function(){p.updateDBTables();},null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(218),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(3179));}else{p.updateDBTables();}}});},gotoRedirectionPage:function A(p,q){if(mstrApp.isNewAnalysis){mstrApp.redirectToPage({evt:"3104",src:microstrategy.servletName+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:p,rwCreateFlags:"16",rwViewMode:"2048"});return ;}if(mstrApp.msgID){mstrApp.redirectToPage({evt:"3104",src:microstrategy.servletName+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:p});return ;}this.rootView.showRedirectionPage(p,q);},save:function O(){this.model.save();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.qb.QBuilderPage","mstrmojo.qb.QBuilderModel","mstrmojo.qb.RootController");var I="waitBox",J={scriptClass:"mstrmojo.Editor",id:I,cssClass:"mstrmojo-Architect-WaitBox",draggable:false,showTitle:false,zIndex:99999,counter:0,displayMsg:null,ondisplayMsgChange:function G(){this.msgfield.set("text",this.displayMsg);},oncounterChange:function F(){var K=this.counter,L=this.visible;if(K===0&&L){this.close();}else{if(K>0&&!L){this.open();}}},children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Architect-Wait"},{scriptClass:"mstrmojo.Label",alias:"msgfield",cssClass:"mstrmojo-Architect-Message",text:this.parent.displayMsg}]};mstrmojo.qb.QBApp=mstrmojo.declare(mstrmojo.Obj,null,{start:function C(){var K=this.rootController=new mstrmojo.qb.RootController({model:new mstrmojo.qb.QBuilderModel({id:"QBuilderModel"}),rootView:new mstrmojo.qb.QBuilderPage({placeholder:this.placeholder})});K.start();},getRootController:function D(){return this.rootController;},showWait:function E(K){var L=mstrmojo.all[I]||mstrmojo.insert(J);L.set("counter",L.counter+1);L.set("displayMsg",K||mstrmojo.desc(889,"Please wait..."));},hideWait:function B(L){var K=mstrmojo.all[I];if(K){K.set("counter",L?0:Math.max(0,K.counter-1));}},redirectToPage:function H(K){this.showWait();mstrmojo.form.send(K,mstrApp.name,"POST",null,null,false);},serverRequest:function A(Q,O,L,P,N){if(L){this.showWait(N);}if(this.sessionState){O.sessionState=this.sessionState;}O.msgid=mstrApp.msgid;mstrmojo.xhr.request("POST",mstrConfig.taskURL,mstrmojo.func.wrapMethods(Q,{complete:function K(R){if(L){mstrApp.hideWait();}},failure:function M(R){if(!P){var S=R.getResponseHeader("X-MSTR-TaskFailureMsg");S=(S.length>2000)?S.substring(0,2000)+"...":S;mstrmojo.alert(S.replace(/com\.microstrategy(\.\w+)*: \(?/,"").replace(/\)$/,""));}}}),O);}});}());