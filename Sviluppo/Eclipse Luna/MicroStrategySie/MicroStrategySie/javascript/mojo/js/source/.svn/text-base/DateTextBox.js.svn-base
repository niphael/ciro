(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.string");var _MK=mstrmojo.ValidationTextBox.prototype.markupMethods,_S=mstrmojo.string;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,isList:false,dtp:14,autoFormat:true,markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:_MK.onvalueChange,onenabledChange:_MK.onenabledChange,onvalidationStatusChange:_MK.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var o=this.opener,z=o&&o.calendarZIndex,c=this.cal,cfg=o&&o.calConfig;if(z){this.domNode.style.zIndex=z;}for(var k in cfg){c.set(k,cfg[k]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",changeValueOnOK:function(){var dtp=this.parent.opener.dtp,cv=this.parent.opener.changeValueOnOK;return dtp===15||dtp===16||cv;}},onValueUpdate:function(evt){var op=this.parent&&this.parent.opener;if(op){var v=op.value,ls=window.mstrConfig&&window.mstrConfig.listSep||";";if(op.isList&&!_S.isEmpty(v)){op.set("value",op.value+ls+this.value);}else{op.set("value",this.value);}op.closePopup();}}}]},onclick:function(evt){var p=this._lastOpened,c=this._calendarConfig;if(!c){c={};if(this.calendarToBody){delete this.calendar.slot;c.placeholder=document.body.appendChild(document.createElement("div"));c.nudge=function(){var op=this.opener;if(op){var p=mstrmojo.dom.position(op.popupNode,true),s=this.domNode.style;s.left=p.x+"px";s.top=p.y+"px";}};}this._calendarConfig=c;}if(p&&p.visible){this.closePopup();}else{this.openPopup("calendar",c);}},unrender:function(){this._super();if(this.calendar.hasRendered){this.calendar.unrender();}}});})();