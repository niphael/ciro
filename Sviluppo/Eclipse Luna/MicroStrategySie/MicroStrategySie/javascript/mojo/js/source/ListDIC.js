(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.dom","mstrmojo.SearchableDropDownList","mstrmojo._IsTableLayoutListDIC","mstrmojo.TableLayoutList","mstrmojo._IsInputControl","mstrmojo.DynamicClassFactory");var $CFC=mstrmojo.DynamicClassFactory.newComponent,$H=mstrmojo.hash,$D=mstrmojo.dom;mstrmojo.SearchableDropDownListForListDIC=mstrmojo.declare(mstrmojo.SearchableDropDownList,null,{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",init:function init(props){this._super(props);this.popupRef.children[0].onmousedown=function(){var p=this.parent,pd=p.opener;p.close();if(pd){pd.onPopupClosed();}};},onmousedown:function onmousedown(evt){this._super&&this._super(evt);if($D.isIE||$D.isIEW3C){this.focus();}},openPopup:function(ref,config){this._super(ref,config);this.parent.setInfoWindowLock(true);},popupRef:$H.copy({onvisibleChange:function(){var showByDefault=this.opener.parent.showByDefault;if(!this.visible&&showByDefault){this.opener.parent.setInfoWindowLock(false);}}},$H.clone(mstrmojo.SearchableDropDownList.prototype.popupRef)),onPopupClosed:mstrmojo.emptyFn});function getTitleItems(items){var arr=[];mstrmojo.array.forEach(items,function(v){arr.push(v.n);});return arr;}mstrmojo.TableLayoutListForListDIC=$CFC(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC],{scriptClass:"mstrmojo.TableLayoutListForListDIC"});function getDICWidget(style,dic,items){var ipr=dic.ipr||0,mint=dic.mint||"",maxt=dic.maxt||"";return{0:{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",cssDisplay:"block",searchEnabled:items.length>=10,itemIdField:"v",fixWidth:true,fixHeight:true,postCreate:function(){var value=this.value,ust=dic.ust||"",idx=mstrmojo.array.find(items,"v",value);if(idx==-1){items=[{n:ust,v:value}].concat(items);idx=0;this.unset=true;}this.items=items;this.selectedIndex=idx;this.set("value",items[idx].v);if(this.parent.showByDefault&&this.searchEnabled){this.applyChange=function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}else{this.items=this.allItems;this.set("text",this.text);}};this.onvalueChange=function(){};if($D.isIE||$D.isIEW3C){this.onPopupClosed=function(){this.applyChange&&this.applyChange();};}}},onblur:function(evt){this.applyChange&&this.applyChange();},onEnter:function(){this.applyChange&&this.applyChange();},onEsc:function(){this.items=this.allItems;this.set("value",this.parent.value);},getDisplayValue:function(){return this.items.length&&this.items[this.selectedIndex===-1?0:this.selectedIndex].n;},isPopupClosed:function(){return !(this.popupRef&&this.popupRef.visible);}},1:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"radio",itemsPerRow:ipr,items:items,getDisplayValue:function(){return this.items[this.selectedIndex].n;}},2:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"check",delim:",",multiSelect:true,itemsPerRow:ipr,items:items,getDisplayValue:function(){return"";}}}[style||0];}mstrmojo.ListDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ListDIC",tabIndex:0,markupString:'<div class="mstrmojo-ListDIC {@cssClass}" tabIndex="{@tabIndex}" mstrAttach:focus></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onwidthChange:function(){if(this.dicWidget&&this.width){this.dicWidget.set("width",this.width);}},onheightChange:function(){if(this.dicWidget&&this.height){this.dicWidget.set("height",this.height);}}},init:function(props){this._super(props);this.style=this.dic.st;this.items=this.getItems();this.set("children",[mstrmojo.hash.copy(getDICWidget(this.style,this.dic,this.items),{alias:"dicWidget",value:this.value,onvalueChange:function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}}})]);if(this.dicWidget.setDirtyFlag){this.setDirtyFlag=function(c,d){this.dicWidget.setDirtyFlag(c,d);};}},getDisplayValue:function getDisplayValue(){return this.dicWidget.getDisplayValue()||this.dv;},onfocus:function(evt){this.focus();},focus:function(){var me=this;if(mstrmojo.dom.isIE){setTimeout(function(){me.dicWidget.focus&&me.dicWidget.focus();},10);}else{me.dicWidget.focus&&me.dicWidget.focus();}},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.dicWidget.set("height",(this.openerStyle.ih||0)+"px");this.dicWidget.set("width",(this.openerStyle.iw||0)+"px");}},applyChanges:function(){var ret=this._super();return this.style?ret:this.dicWidget.isPopupClosed();},cleanup:function cleanup(){if(!this.style){this.dicWidget.closePopup();}}});})();