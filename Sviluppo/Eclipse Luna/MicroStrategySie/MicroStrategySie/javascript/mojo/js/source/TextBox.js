(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var _C=mstrmojo.css;function _hideEmpty(me){var el=me.inputNode;var v=(me.value!=null)?String(me.value):"";if(v!==el.value){el.value=v;}if(el.mstrmojoEmpty){_C.removeClass(el,[me.emptyClass]);el.mstrmojoEmpty=null;}}function _showEmpty(me){var el=me.inputNode;el.value=me.emptyText||"";_C.addClass(el,[me.emptyClass]);el.mstrmojoEmpty=true;}function _dom2value(me){var inputNode=me.inputNode;if(inputNode){me.readingDom=true;me.set("value",inputNode.value);me.readingDom=false;}}var _KEYCODENAME={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",autoComplete:true,autoCorrect:true,autoCapitalize:true,placeholderText:"",markupString:'<input id="{@id}" placeholder="{@placeholderText}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css.toggleClass(this.inputNode,"disabled",!this.enabled);},onvalueChange:function(){var v=this.value,em=(v===null)||(v==="");if(em){if(!this.hasFocus){_showEmpty(this);}else{this.inputNode.value="";}}else{_hideEmpty(this);}},ontooltipChange:function(){this.domNode.title=this.tooltip;},onreadOnlyChange:function(){this.inputNode.readOnly=this.readOnly;}},emptyText:"",emptyClass:"mstrmojo-empty",postBuildRendering:function postBuildRendering(){this._super();var e=this.inputNode;e.setAttribute("autocomplete",this.autoComplete?"on":"off");e.setAttribute("autocorrect",this.autoCorrect?"on":"off");e.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function focus(){this.inputNode.focus();},prefocus:function prefocus(){this.hasFocus=true;_hideEmpty(this);},preblur:function preblur(){window.setTimeout(function(){},200);this.hasFocus=false;_dom2value(this);var v=this.value;if((v===null||v==="")&&this.emptyText){_showEmpty(this);}},prekeyup:function pku(evt){var hWin=evt.hWin,e=evt.e||hWin.event;_dom2value(this);var n=_KEYCODENAME[e.keyCode];if(this["on"+n]){this["on"+n](evt);}},preinput:function pku(evt){var hWin=evt.hWin,e=evt.e||hWin.event;_dom2value(this);},prepaste:function prepaste(){this.delaySetValue(this);},precut:function precut(){this.delaySetValue(this);},delaySetValue:function delaySetValue(tgt){window.setTimeout(function(){_dom2value(tgt);},100);},setInvalidState:function setInvalidState(msg){mstrmojo.css.addClass(this.inputNode,["err"]);if(msg){this.domNode.setAttribute("title",msg);}},cleanUp:function cleanUp(){this.inputNode.value="";mstrmojo.css.removeClass(this.domNode,["err"]);this.domNode.setAttribute("title",this.tooltip);}});}());