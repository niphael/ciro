(function(){var isPremier=false;var premiereKey=null;var mstrLang=null;var mstrRegion=null;var trialKey=null;var channel=null;mstrmojo._CanLoadMapExternalScript={_mixinName:"mstrmojo._CanLoadMapExternalScript",callback:null,mixinParentMapObj:null,setPremiere:function setPremiere(val){isPremier=val;},isPremiere:function isPremiere(){return isPremier;},setPremiereKey:function setPremiereKey(id){premiereKey=id;},getPremiereKey:function getPremiereKey(){return premiereKey;},setTrialKey:function setTrialKey(id){trialKey=id;},getTrialKey:function getTrialKey(){return trialKey;},setLocaleLang:function setLocaleLang(lang){mstrLang=lang;},getLocaleLang:function getLocaleLang(){return mstrLang;},setLocaleRegion:function setLocaleRegion(region){mstrRegion=region;},getLocaleRegion:function getLocaleRegion(){return mstrRegion;},setChannel:function setChannel(val){channel=val;},getChannel:function getChannel(){return channel;},loadExternalScript:function loadScript(callBackFunc,mapObject){var urlBase,_channel=this.getChannel();if(window.location.protocol=="https:"){urlBase="https://maps-api-ssl.google.com/maps/api/js?v=3&sensor=false&libraries=drawing,geometry";}else{urlBase="http://maps.google.com/maps/api/js?v=3&sensor=false&libraries=drawing,geometry";}urlBase+="&language="+this.getLocaleLang()+"&region="+this.getLocaleRegion();if(this.isPremiere()){urlBase=urlBase+"&client="+this.getPremiereKey();}else{urlBase=urlBase+"&key="+this.getTrialKey();}if(!!_channel){urlBase+="&channel="+_channel;}this.callback=callBackFunc;this.mixinParentMapObj=mapObject;mstrmojo._LoadsScript.requiresExternalScripts([{url:urlBase,callbackParamName:"callback",forceReload:true}],this.loadMarkerScript,this);},loadMarkerScript:function loadMarkerScript(){mstrmojo.googleMapLibLoaded=true;mstrmojo.invalidateCls("mstrmojo.gmaps.CustomMarker");mstrmojo.invalidateCls("mstrmojo.gmaps.CircleMarker");mstrmojo.invalidateCls("mstrmojo.gmaps.TextMarker");mstrmojo.invalidateCls("mstrmojo.gmaps.DensityOverlay");mstrmojo.requiresCls("mstrmojo.gmaps.CustomMarker","mstrmojo.gmaps.TextMarker","mstrmojo.gmaps.CircleMarker","mstrmojo.gmaps.DensityOverlay");this.loadCoreCss();var me=this;this.loadGoogleMapVisCss();var intervalId=window.setInterval(function(){if(me.isGoogleMapVisCssLoaded()){window.clearInterval(intervalId);me.loadMap();}},50);},loadMap:function loadMap(){this.callback.call(this.mixinParentMapObj);var i=0;for(i;i<mstrmojo.gmaps.loadScriptListeners.length;i++){mstrmojo.gmaps.loadScriptListeners[i]();}},isOIVM:function isOIVM(){return !(!mstrApp||!mstrApp.isOIVM||!mstrApp.isOIVM());},loadCoreCss:function loadCoreCss(){var currentStyles=document.styleSheets;if(currentStyles){var i,style;for(i=0;i<currentStyles.length;i++){style=currentStyles[i];if(style.id=="mojocore"){return ;}}}var css=document.createElement("link");css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href","../javascript/mojo/css/core.css");css.setAttribute("id","mojocore");document.getElementsByTagName("head")[0].appendChild(css);},isGoogleMapVisCssLoaded:function isGoogleMapVisCssLoaded(){var currentStyles=document.styleSheets;if(currentStyles){var i,style;for(i=0;i<currentStyles.length;i++){style=currentStyles[i];if((style.id=="googleMapVis")||(!!style.ownerNode&&style.ownerNode.id=="googleMapVis")){return true;}}}return false;},loadGoogleMapVisCss:function loadGoogleMapVisCss(){if(this.isGoogleMapVisCssLoaded()){return ;}var css=document.createElement("link");css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href","../style/mstr/googleMap.css");css.setAttribute("id","googleMapVis");document.getElementsByTagName("head")[0].appendChild(css);}};})();