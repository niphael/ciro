mstrmojo.DPIManager={classes:[],registerClass:function registerClass(clz,dimension,slot,dpiValues){this.classes.push({c:clz,d:dimension,s:slot,v:dpiValues});},setDPI:function(){var dpi=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(clz){clz.c.prototype.layoutConfig[clz.d][clz.s]=clz.v[dpi]+"px";});this.classes=[];}};(function(){function calcChildDimension(child,dimension,onlyPercentageSlots){var dim=this._layoutWidgets[dimension],slot=child.slot,fixedSlots=dim.f,percentageSlots=dim.p,isFixed=(fixedSlots&&fixedSlots[slot]!==undefined),isPercent=(percentageSlots&&percentageSlots[slot]!==undefined);if(slot&&((!onlyPercentageSlots&&isFixed)||isPercent)){return isFixed?fixedSlots[slot]:(dim.x*parseInt(percentageSlots[slot],10)/100)+"px";}return child[(dimension==="h")?"height":"width"];}function applyChildDimensions(child,h,w){if(child.ignoreLayout){return ;}if(child.setDimensions){child.setDimensions(h,w);}else{if(child.set){child.set("height",h);child.set("width",w);}}}function applyDimensions(onlyPercentageSlots){var ch=this.children,i,len;for(i=0,len=(ch&&ch.length)||0;i<len;i++){var child=ch[i],slot=child.slot;if(slot){var h=calcChildDimension.call(this,child,"h",onlyPercentageSlots),w=calcChildDimension.call(this,child,"w",onlyPercentageSlots);this.setSlotDimensions(slot,h,w);applyChildDimensions(child,h,w);var zh=calcChildDimension.call(this,child,"h",onlyPercentageSlots),zw=calcChildDimension.call(this,child,"w",onlyPercentageSlots);if(zh!==h||zw!==w){applyChildDimensions(child,zh,zw);}this.setSlotDimensions(slot,zh,zw);}}this.afterLayout();}function adjustDimension(child,lw,d){var slot=child.slot,autoSlots=lw&&lw.a;if(!autoSlots||autoSlots[slot]===undefined){return ;}var x=this[slot]["offset"+d],size=autoSlots[slot];if(x===size){return ;}lw.x-=(x-size);autoSlots[slot]=x;}function adjustLayout(evt){this.beforeLayout();var lw=this._layoutWidgets,child=evt.src;adjustDimension.call(this,child,lw.h,"Height");adjustDimension.call(this,child,lw.w,"Width");applyDimensions.call(this,true);}function calculateDimension(dimensionConfig,dimension){if(!dimensionConfig){return null;}var ch=this.children,lcDimension=dimension.toLowerCase(),widgetDimensionValue=parseInt(this[lcDimension],10),fixedSlots,percentageSlots,autoSlots,autoSlotValues,i,len,child,v,slot;for(slot in dimensionConfig){v=dimensionConfig[slot];if(v.match(/px$/)){widgetDimensionValue-=parseInt(v,10);fixedSlots=fixedSlots||{};fixedSlots[slot]=v;}else{if(v.match(/\%$/)){percentageSlots=percentageSlots||{};percentageSlots[slot]=v;}else{autoSlots=autoSlots||{};autoSlots[slot]=v;}}}if(autoSlots&&percentageSlots){for(i=0,len=(ch&&ch.length)||0;i<len;i++){child=ch[i];slot=child.slot;if(child.slot&&autoSlots[slot]&&!child.ignoreLayout){autoSlotValues=autoSlotValues||{};if(child.hasRendered){autoSlotValues[slot]=this[child.slot]["offset"+dimension];widgetDimensionValue-=autoSlotValues[slot];}else{autoSlotValues[slot]=0;child.attachEventListener((child instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,adjustLayout);}}}}return{f:fixedSlots,p:percentageSlots,a:autoSlotValues,x:widgetDimensionValue};}mstrmojo._HasLayout={_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function init(props){this._super(props);this.layoutConfig=mstrmojo.hash.clone(this.layoutConfig);},preBuildRendering:function preBuildRendering(){var cssText=this.cssText||"";var height=this.height;if(height&&height!=="auto"){cssText+="height:"+this.height+";";}var width=this.width;if(width&&width!=="auto"){cssText+="width:"+this.width+";";}this.cssText=cssText;return(this._super)?this._super():true;},postBuildRendering:function postBuildRendering(){this.doLayout();return this._super();},doLayout:function doLayout(){var lc=this.layoutConfig;if(!lc){return ;}this.beforeLayout();this._layoutWidgets={h:calculateDimension.call(this,lc.h,"Height"),w:calculateDimension.call(this,lc.w,"Width")};applyDimensions.call(this,false);},browserResized:function browserResized(size){this.setDimensions(size.h,size.w);return true;},onwidthChange:function widthChg(){var dn=this.domNode;if(!dn||!this.layoutConfig){return ;}dn.style.width=this.width;this.doLayout();},onheightChange:function heightChg(){var dn=this.domNode;if(!dn||!this.layoutConfig){return ;}dn.style.height=this.height;this.doLayout();},adjustParentDimensions:function adjustParentDimensions(){var p=this.parent,lw=p&&p._layoutWidgets;if(lw){adjustDimension.call(p,this,lw.h,"Height");adjustDimension.call(p,this,lw.w,"Width");}},setDimensions:function setDimensions(h,w){if(this.height!==h||this.width!==w){this.height=h;this.width=w;var dn=this.domNode;if(dn){dn.style.height=h;dn.style.width=w;this.doLayout();}return true;}return false;},setSlotDimensions:function setSlotDimensions(slot,h,w){var sl=this[slot]&&this[slot].style;if(!sl){return ;}if(h!==undefined&&sl.height!==h){sl.height=h;}if(w!==undefined&&sl.width!==w){sl.width=w;}}};mstrmojo._HasLayout.getSlotSize=function getSlotSize(constructor,slot){var layoutCfg=constructor&&constructor.prototype.layoutConfig;if(layoutCfg){var h=layoutCfg.h,w=layoutCfg.w;return{h:(h&&h[slot])||undefined,w:(w&&w[slot])||undefined};}return null;};}());