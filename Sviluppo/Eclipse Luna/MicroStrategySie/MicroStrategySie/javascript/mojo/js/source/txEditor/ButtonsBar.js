(function(){mstrmojo.requiresCls("mstrmojo.HBox","mstrmojo.HTMLButton","mstrmojo.txEditor.CommonComponent");var _TC=mstrmojo.txEditor.CommonComponent;function pollSavingStatus(callback){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(res){if(!res||res.status===2||res.status===3){_TC.showError(mstrmojo.desc(8256));mstrmojo.all.teModel.set("saving",false);}else{if(res.status===1||res.status===21){if(callback){callback();}mstrmojo.all.teModel.set("saving",false);}else{pollSavingStatus(callback);}}},failure:function(){_TC.showError(mstrmojo.desc(8256));mstrmojo.all.teModel.set("saving",false);}},{taskId:"pollStatus",msgID:mstrmojo.all.teModel.messageID});}function saveData(callback){mstrmojo.all.teModel.set("saving",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){if(callback){callback();}mstrmojo.all.teModel.set("saving",false);},failure:function(res){if(res.getResponseHeader("X-MSTR-TaskFailureMsg").indexOf("Task exceeded the maximum wait time")>-1){pollSavingStatus(callback);}else{_TC.showError(mstrmojo.desc(8256));mstrmojo.all.teModel.set("saving",false);}}},{taskId:"saveRWTransactions",msgID:mstrmojo.all.teModel.messageID,rwTransactionInfoXML:mstrmojo.all.teModel.getXML(),isEditExistingTXProperty:!mstrmojo.all.teModel.isNew});}mstrmojo.txEditor.ButtonsBar=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.txEditor.ButtonsBar",cssClass:"mstrmojo-Editor-buttonBox",cssText:mstrmojo.dom.isIE7?"float:none":"",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442),bindings:{text:'mstrmojo.all.teModel.saving? mstrmojo.desc(8298) + "..." : mstrmojo.desc(1442)'},onclick:function(){var model=mstrmojo.all.teModel;if(!model.saving&&(!model.txRpt||(model.isPropertiesValid()&&model.isAllInputsMapped()))){var me=this;saveData(function(){if(model.onsave){model.onsave(model);}me.parent.parent.close();});}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){if(!mstrmojo.all.teModel.saving){this.parent.parent.close();}}}]});}());