(function(){var L=/\{\@([^\}]+)\}/gm,H=/\</gm,P=/\>/gm,D=/\S/,O=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],E=new RegExp("(\\"+O.join("|\\")+")","g"),Q={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'};var J=function(S){if(S==null){return"null";}var T=typeof (S);if(T!="object"){return T;}else{if(S.length===undefined){return"object";}else{return"array";}}};var R={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function F(T,V){if(!T){return"";}var U=[];for(var S in V){U.push(S.k||S);}return T.replace(new RegExp(U.join("|"),"g"),function(W){var X=V[W];return X.v||X;});},trim:function N(S){return(S&&S.replace)?S.replace(/^\s+/,"").replace(/\s+$/,""):S;},ellipsize:function A(U,T){var S=this.trim(U.substr(0,(T||1)-1));if(S!==U){S+="&hellip;";}return S;},isEmpty:function I(S){return(S==null)||!(D.test(S));},regEscape:function M(S){return S.replace(E,"\\$1");},encodeXMLAttribute:function(S){return mstrmojo.string.multiReplace(S,Q);},encodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,C);},decodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,K);},htmlAngles:function(S){S=String(S);if(S!=null){return S.replace(H,"&lt;").replace(P,"&gt;");}return S;},apply:function G(S,T){if(!S){return"";}return S.replace(L,function U(V,W){return(W in T&&T[W]!==null)?T[W]:"";});},json2xml:function(f,b,V){if(!(b instanceof Array)){b=[b];}var T=V&&V.isSerializable,Z=(V.convertBoolean===false)?false:true;var c=[],S=[],U,g,k;for(var Y=0,h=b.length;Y<h;Y++){var j=b[Y];for(U in j){if(T){var a=T(U,b,Y);if(a!==true){if(a===false){continue;}else{if(a.att){c.push(a.att);}if(a.child){S.push(a.child);}continue;}}}g=j[U];k=J(g);switch(k){case"array":S.push("<"+U+">");for(var W=0,X=g.length;W<X;W++){var d=V.getArrItemName(U,g,W)||W;S.push(this.json2xml(d,g[W],V));}S.push("</"+U+">");break;case"object":S.push(this.json2xml(U,g,V));break;case"string":c.push(U+'="'+mstrmojo.string.encodeXMLAttribute(g)+'"');break;case"boolean":c.push(U+'="'+((Z)?(g?"-1":"0"):g)+'"');break;case"null":if(!V.skipNull){c.push(U+'="'+V.nullValue+'"');}break;default:c.push(U+'="'+g+'"');break;}}}return"<"+f+" "+c.join(" ")+">"+S.join("")+"</"+f+">";},escape4HTMLText:function B(Z){if(!Z||!Z.replace){return Z;}var W=/\"/gm;var U="&quot;";var a=/\&/gm;var Y="&amp;";var X=/\</gm;var S="&lt;";var V=/\>/gm;var T="&gt;";return Z.replace(a,Y).replace(W,U).replace(X,S).replace(V,T);},parseUri:function(W,T){T=T||R;var S=T.parser[((T.strictMode)?"strict":"loose")].exec(W),V={},U=14;while(U--){V[T.key[U]]=S[U]||"";}V[T.q.name]={};V[T.key[12]].replace(T.q.parser,function(Y,X,Z){if(X){V[T.q.name][X]=Z;}});return V;}});})();(function(){mstrmojo.requiresDescs(2050,2051,2052,2053,2054,2055,2056,2067,2068,2170,2182,2183,2193,2194,2195,2231,2232,2233,2234,2235,2236,2237,2238,2239,2240,2241,2242,2243,2244,2245,2246,2247,2248,2250,2256,2257,2258,2259,2260,2261,2262,2264,2265,2296,2378,2412,2718,2719,2886,3433,3434,3435,3436,3440,3441,3604,3905,4601,5156,7942,7943,7944,7945);var A=mstrmojo.desc(3604);mstrmojo._FormatDefinition={Formats:[{n:mstrmojo.desc(3433)},{n:mstrmojo.desc(3434)},{n:mstrmojo.desc(3435)},{n:mstrmojo.desc(3436)}],FormatTarget:[{n:mstrmojo.desc(7942),v:1,p:"header_format"},{n:mstrmojo.desc(7943),v:2,p:"grid_format"},{n:mstrmojo.desc(7944),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:mstrmojo.desc(3434)},{n:mstrmojo.desc(3435)},{n:mstrmojo.desc(3433)},{n:mstrmojo.desc(2886)},{n:mstrmojo.desc(3905)}],MetricHeaderFormats:[{n:mstrmojo.desc(3434)},{n:mstrmojo.desc(3435)},{n:mstrmojo.desc(3433)},{n:mstrmojo.desc(2886)},{n:mstrmojo.desc(3905)},{n:"Chart"}],DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:[{n:mstrmojo.desc(2412),v:"pru"},{n:"Arial",v:"Arial"},{n:"Arial Black",v:"Arial Black"},{n:"Arial Narrow",v:"Arial Narrow"},{n:"Arial Unicode MS",v:"Arial Unicode MS"},{n:"Batang",v:"Batang"},{n:"Book Antiqua",v:"Book Antiqua"},{n:"Bookman Old Style",v:"Bookman Old Style"},{n:"Bookshelf Symbol 1",v:"Bookshelf Symbol 1"},{n:"Bookshelf Symbol 2",v:"Bookshelf Symbol 2"},{n:"Bookshelf Symbol 3",v:"Bookshelf Symbol 3"},{n:"Comic Sans MS",v:"Comic Sans MS"},{n:"Courier New",v:"Courier New"},{n:"Garamond",v:"Garamond"},{n:"Haettenschweiler",v:"Haettenschweiler"},{n:"Helvetica",v:"Helvetica"},{n:"Impact",v:"Impact"},{n:"Lucida Console",v:"Lucida Console"},{n:"Lucida Sans Unicode",v:"Lucida Sans Unicode"},{n:"Map Symbols",v:"Map Symbols"},{n:"Marlett",v:"Marlett"},{n:"Monotype Corsiva",v:"Monotype Corsiva"},{n:"Monotype Sorts",v:"Monotype Sorts"},{n:"MS Gothic",v:"MS Gothic"},{n:"MS Outlook",v:"MS Outlook"},{n:"Microsoft Sans Serif",v:"Microsoft Sans Serif"},{n:"MT Extra",v:"MT Extra"},{n:"Symbol",v:"Symbol"},{n:"Tahoma",v:"Tahoma"},{n:"Times New Roman",v:"Times New Roman"},{n:"Trebuchet MS",v:"Trebuchet MS"},{n:"Verdana",v:"Verdana"},{n:"Webdings",v:"Webdings"},{n:"Wingdings",v:"Wingdings"},{n:"Wingdings 2",v:"Wingdings 2"},{n:"Wingdings 3",v:"Wingdings 3"}],Sizes:[{n:mstrmojo.desc(2412),v:"pru"},{n:"2",v:"2"},{n:"3",v:"3"},{n:"4",v:"4"},{n:"5",v:"5"},{n:"6",v:"6"},{n:"7",v:"7"},{n:"8",v:"8"},{n:"9",v:"9"},{n:"10",v:"10"},{n:"11",v:"11"},{n:"12",v:"12"},{n:"14",v:"14"},{n:"16",v:"16"},{n:"18",v:"18"},{n:"20",v:"20"},{n:"22",v:"22"},{n:"24",v:"24"},{n:"36",v:"36"},{n:"48",v:"48"},{n:"72",v:"72"}],Styles:[{n:mstrmojo.desc(2412),v:"pru"},{n:mstrmojo.desc(3440),v:"0,0"},{n:mstrmojo.desc(2718),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:mstrmojo.desc(2412),v:-2},{n:mstrmojo.desc(2378),v:9},{n:mstrmojo.desc(2050),v:0},{n:mstrmojo.desc(2051),v:1},{n:mstrmojo.desc(2052),v:2},{n:mstrmojo.desc(2170),v:3},{n:mstrmojo.desc(2053),v:4},{n:mstrmojo.desc(2054),v:5},{n:mstrmojo.desc(2055),v:6},{n:mstrmojo.desc(2056),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:"-1,234.12",v:1,f:"#,##0.00"},{n:"-1,234.12["+A+"]",r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:"1,234.12["+A+"]",r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:"(1,234.12)",v:3,f:"#,##0.00;(#,##0.00)"},{n:"(1,234.12)["+A+"]",r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:"$-1,234.12",v:1,f:'"$"#,##0.00'},{n:"$-1,234.12["+A+"]",r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:"$1,234.12["+A+"]",r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:"$(1,234.12)",v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:"$(1,234.12)["+A+"]",r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194),v:0},{n:mstrmojo.desc(2195),v:1},{n:mstrmojo.desc(2183),v:2},{n:mstrmojo.desc(2182),v:3}],Date:[{n:mstrmojo.desc(2231),v:"m/d"},{n:mstrmojo.desc(2232),v:"mm/dd"},{n:mstrmojo.desc(2233),v:"m/d/yy"},{n:mstrmojo.desc(2234),v:"mm/dd/yy"},{n:mstrmojo.desc(2235),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236),v:"d-mmm"},{n:mstrmojo.desc(2237),v:"d-mmm-yy"},{n:mstrmojo.desc(2238),v:"mmm-yy"},{n:mstrmojo.desc(2239),v:"mmm 'yy"},{n:mstrmojo.desc(2240),v:"mmmm yyyy"},{n:mstrmojo.desc(2241),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244),v:"h:mm"},{n:mstrmojo.desc(2245),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246),v:"h:mm:ss"},{n:mstrmojo.desc(2247),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%["+A+"]",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%["+A+"]",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)["+A+"]",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:mstrmojo.desc(2412),v:"pru"},{n:mstrmojo.desc(4601),v:0},{n:mstrmojo.desc(5156),v:-90}],Horizontal:[{n:mstrmojo.desc(2296),v:"pru"},{n:mstrmojo.desc(2378),v:1},{n:mstrmojo.desc(2194),v:2},{n:mstrmojo.desc(2193),v:3},{n:mstrmojo.desc(2195),v:4},{n:mstrmojo.desc(2068),v:6}],Vertical:[{n:mstrmojo.desc(2296),v:"pru"},{n:mstrmojo.desc(2256),v:1},{n:mstrmojo.desc(2067),v:2},{n:mstrmojo.desc(2257),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:mstrmojo.desc(2412),v:"pru"},{n:mstrmojo.desc(2258),v:0},{n:mstrmojo.desc(2259),v:3},{n:mstrmojo.desc(2260),v:4},{n:mstrmojo.desc(2261),v:7},{n:mstrmojo.desc(2262),v:1},{n:mstrmojo.desc(2264),v:5},{n:mstrmojo.desc(2265),v:6}],extractModel:function(D,F,C){var H=C||this.DefaultFormat;for(var G in D){var B=D[G];if(!B.attachEventListener){if(!_H.isEmpty(B)){F[G]=B;}}else{for(var E in B){if(H[G]&&H[G][E]){if(!F[G]){F[G]={};}F[G][E]=B[E];}}}}},getStandardFormat:function(C,B){var E=mstrmojo.hash.clone(B||this.DefaultFormat);C=C||{};for(var D in E){C[D]=C[D]||{};}for(var D in C){if(!C[D].attachEventListener){C[D]=mstrmojo.hash.make(C[D],mstrmojo.Obj);}}return C;},saveFormatModel:function(F,L,C,M){var K=M||this.DefaultFormat;for(var H=0;H<C.length;H++){var G=C[H],E=L[G]||null,J=F[G];if(typeof J==="undefined"){delete L[G];continue;}for(var B in K){var I=K[B];if(!E&&!J||E&&!E[B]&&!J[B]){continue;}for(var D in I){if(typeof J[B]==="undefined"||J[B]===""||J[B][D]==="pru"||typeof J[B][D]=="undefined"){if(E&&E[B]&&E[B][D]!=null&&E[B][D]!="pru"){E[B][D]="pru";}}else{E=E||{};E[B]=E[B]||{};E[B][D]=J[B][D];}}}if(E){L[G]=E;}}}};})();mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){function G(S,V,U){var W=this._layoutWidgets[V],Z=S.slot,X=W.f,Y=W.p,T=(X&&X[Z]!==undefined),R=(Y&&Y[Z]!==undefined);if(Z&&((!U&&T)||R)){return T?X[Z]:(W.x*parseInt(Y[Z],10)/100)+"px";}return S[(V==="h")?"height":"width"];}function Q(T,S,R){if(T.ignoreLayout){return ;}if(T.setDimensions){T.setDimensions(S,R);}else{if(T.set){T.set("height",S);T.set("width",R);}}}function I(U){var S=this.children,W,Y;for(W=0,Y=(S&&S.length)||0;W<Y;W++){var T=S[W],Z=T.slot;if(Z){var X=G.call(this,T,"h",U),a=G.call(this,T,"w",U);this.setSlotDimensions(Z,X,a);Q(T,X,a);var R=G.call(this,T,"h",U),V=G.call(this,T,"w",U);if(R!==X||V!==a){Q(T,R,V);}this.setSlotDimensions(Z,R,V);}}this.afterLayout();}function F(X,T,V){var W=X.slot,U=T&&T.a;if(!U||U[W]===undefined){return ;}var R=this[W]["offset"+V],S=U[W];if(R===S){return ;}T.x-=(R-S);U[W]=R;}function N(R){this.beforeLayout();var S=this._layoutWidgets,T=R.src;F.call(this,T,S.h,"Height");F.call(this,T,S.w,"Width");I.call(this,true);}function E(T,W){if(!T){return null;}var R=this.children,d=W.toLowerCase(),X=parseInt(this[d],10),a,b,V,S,Y,Z,U,f,c;for(c in T){f=T[c];if(f.match(/px$/)){X-=parseInt(f,10);a=a||{};a[c]=f;}else{if(f.match(/\%$/)){b=b||{};b[c]=f;}else{V=V||{};V[c]=f;}}}if(V&&b){for(Y=0,Z=(R&&R.length)||0;Y<Z;Y++){U=R[Y];c=U.slot;if(U.slot&&V[c]&&!U.ignoreLayout){S=S||{};if(U.hasRendered){S[c]=this[U.slot]["offset"+W];X-=S[c];}else{S[c]=0;U.attachEventListener((U instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,N);}}}}return{f:a,p:b,a:S,x:X};}mstrmojo._HasLayout={_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function O(R){this._super(R);this.layoutConfig=mstrmojo.hash.clone(this.layoutConfig);},preBuildRendering:function M(){var T=this.cssText||"";var R=this.height;if(R&&R!=="auto"){T+="height:"+this.height+";";}var S=this.width;if(S&&S!=="auto"){T+="width:"+this.width+";";}this.cssText=T;return(this._super)?this._super():true;},postBuildRendering:function B(){this.doLayout();return this._super();},doLayout:function A(){var R=this.layoutConfig;if(!R){return ;}this.beforeLayout();this._layoutWidgets={h:E.call(this,R.h,"Height"),w:E.call(this,R.w,"Width")};I.call(this,false);},browserResized:function L(R){this.setDimensions(R.h,R.w);return true;},onwidthChange:function P(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.width=this.width;this.doLayout();},onheightChange:function D(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.height=this.height;this.doLayout();},adjustParentDimensions:function C(){var S=this.parent,R=S&&S._layoutWidgets;if(R){F.call(S,this,R.h,"Height");F.call(S,this,R.w,"Width");}},setDimensions:function K(T,S){if(this.height!==T||this.width!==S){this.height=T;this.width=S;var R=this.domNode;if(R){R.style.height=T;R.style.width=S;this.doLayout();}return true;}return false;},setSlotDimensions:function H(U,T,S){var R=this[U]&&this[U].style;if(!R){return ;}if(T!==undefined&&R.height!==T){R.height=T;}if(S!==undefined&&R.width!==S){R.width=S;}}};mstrmojo._HasLayout.getSlotSize=function J(U,V){var S=U&&U.prototype.layoutConfig;if(S){var T=S.h,R=S.w;return{h:(T&&T[V])||undefined,w:(R&&R[V])||undefined};}return null;};}());mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function rqMth(B){if(!B){return ;}if(typeof (this[B])==="function"){return true;}else{var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof (A)==="string"){this.requiresCls(A);return typeof (this[B])==="function";}return false;}},requiresCls:function req(mixins,callback){if(mixins){if(typeof (mixins)=="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin;for(var i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof (A)=="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresES(E,F,B){if(E&&E instanceof Array){if(E.length==0){F&&F.call(B);return ;}if(E[0].forceReload&&E[0].forceReload==false&&mstrmojo.LoadedExternalJSURLs[E[0].url]){E.splice(0,1);return this.requiresExternalScripts(E,F,B);}var A=document.createElement("script"),C=!!document.all;A.type="text/javascript";A.src=E[0].url;if(!E[0].callbackParamName){if(C){A.onreadystatechange=function(){if(A.readyState=="loaded"||A.readyState=="complete"){A.onreadystatechange=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}}};}else{A.onload=function(){A.onload=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}};}}else{if(E[0].callbackParamName.length!=0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy==true){var D=this;window.setTimeout(function(){D.requiresExternalScripts(E,F,B);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+E[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=E;mstrmojo._LoadsScript.callback=F;mstrmojo._LoadsScript.esScritsContext=B;}}document.getElementsByTagName("head")[0].appendChild(A);}}});(function(){mstrmojo._IsPopup={visible:false,opener:null,onOpen:null,onClose:null,open:function B(E,D){if(this.updatePopupConfig){this.updatePopupConfig(D,E);}else{if(D){for(var C in D){this.set(C,D[C]);}}}this.set("opener",E);if(!this.hasRendered){this.render();}if(this.nudge){this.domNode.style.top="-10000px";}this.set("visible",true);if(this.nudge){this.nudge();}if(this.onOpen){this.onOpen();}},close:function A(C){if(this.onClose){this.onClose(C);}this.set("visible",false);this.set("opener",null);}};})();(function(){mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Object,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",callback:null,ob:null,item:null,path:mstrConfig.taskURL,fetchFolderContents:function(A,B,E){this.ob=A;this.item=B;this.callback=E;var C=this.ob.blockCount,D={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:C,includeAncestorInfo:true,includeObjectDesc:A.includeObjectDesc};if(A.folderLinksContextId){D.folderLinksContextId=A.folderLinksContextId;}if(A.sId){D.sessionState=A.sId;}if(B.fid){D.rootFolderID=B.fid;}else{if(B.fty){D.rootFolderType=B.fty;}}if(A.browsableTypes){D.objectType=A.browsableTypes;}if(B.blockBegin){D.blockBegin=B.blockBegin;}if(B.searchPattern){D.searchPattern=B.searchPattern;if(B.recursive){D.recursive=B.recursive;}}mstrmojo.xhr.request("POST",this.path,E,D,undefined,this.XServer,this.baseParams);},newFolder:function(D,E,C,A){var B={taskId:"createFolder",folderID:D,name:E,description:C};mstrmojo.xhr.request("POST",this.path,A,B,undefined,this.XServer,this.baseParams);}});})();(function(){var F="#000000";mstrmojo.color=mstrmojo.provide("mstrmojo.color",{hexChars:"0123456789ABCDEF",toHex:function J(L){L=L||0;L=Math.max(Math.min(isNaN(L)?0:parseInt(L,10),255),0);return this.hexChars.charAt((L-L%16)/16)+this.hexChars.charAt(L%16);},toDec:function K(L){return this.hexChars.indexOf(L.toUpperCase());},rgbStr2rgb:function G(L){var M=[0,0,0];L=L.replace(/ /g,"");var N=L.indexOf("rgb");if(N>=0){L=L.substring(N+4,L.length-1);M=L.split(",");}return M;},rgbStr2hex:function B(L){if(L.indexOf("rgb")>=0){var M=this.rgbStr2rgb(L);return"#"+this.rgb2hex(M[0],M[1],M[2]);}return L;},rgb2hex:function C(N,M,L){return this.toHex(N)+this.toHex(M)+this.toHex(L);},rgb2hsv:function E(L,Q,U){var S=[L,Q,U];S.sort(function(Z,Y){return Z-Y;});var P,X,W=0;var O=S[0];var T=S[2];W=T/255;X=(T!=0)?(parseFloat(T)-parseFloat(O))/parseFloat(T):0;if(X==0){P=0;}else{var R=T-O;var M=(T-L)/R;var N=(T-Q)/R;var V=(T-U)/R;if(L==T){P=V-N;}else{if(Q==T){P=2+M-V;}else{P=4+N-M;}}P=P/6;if(P<0){P=P+1;}}return[Math.round(P*360),Math.round(X*100),Math.round(W*100)];},hex2rgb:function H(O){var M=(O.charAt(0)=="#")?O.substr(1):O;var L=M.length!==3;var N=[0,0,0];if(L){N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(1,1)));N[1]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(3,1)));N[2]=(this.toDec(M.substr(4,1))*16)+(this.toDec(M.substr(5,1)));}else{N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(0,1)));N[1]=(this.toDec(M.substr(1,1))*16)+(this.toDec(M.substr(1,1)));N[2]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(2,1)));}return N;},hex2hsv:function(M){var L=this.hex2rgb(M);return this.rgb2hsv(L[0],L[1],L[2]);},hsv2rgb:function(S,Y,W){S=S/360;Y=Y/100;W=W/100;var L,T,V;if(Y==0){L=W*255;T=W*255;V=W*255;}else{var O=S*6;if(O==6){O=0;}var R=Math.floor(O);var N=W*(1-Y);var M=W*(1-Y*(O-R));var X=W*(1-Y*(1-(O-R)));var U,P,Q;switch(R){case 0:U=W;P=X;Q=N;break;case 1:U=M;P=W;Q=N;break;case 2:U=N;P=W;Q=X;break;case 3:U=N;P=M;Q=W;break;case 4:U=X;P=N;Q=W;break;default:U=W;P=N;Q=M;break;}L=U*255;T=P*255;V=Q*255;}return[Math.round(L),Math.round(T),Math.round(V)];},hsv2hex:function(O,N,L){var M=this.hsv2rgb(O,N,L);return this.rgb2hex(M[0],M[1],M[2]);},getContrastingColor:function A(N,L){var M=this.hex2rgb(N);return(((M[0]*299)+(M[1]*587)+(M[2]*114))/1000<125)?L[0]:L[1];},getHighlightColor:function D(S,Q){var L,R,T,U,V=this.hex2rgb(!Q?"#FFCE7F":"#EFE6D8"),P=parseInt(S[0],10),N=parseInt(S[1],10),X=parseInt(S[2],10),O=parseInt(V[0],10),M=parseInt(V[1],10),W=parseInt(V[2],10);L=(P*O)/255;R=(N*M)/255;T=(X*W)/255;U=P*0.3+N*0.59+X*0.11;if(U<85){L=L+(63*(85-U)/85);L=L>255?255:L;R=R+(63*(85-U)/85);R=R>255?255:R;T=T+(63*(85-U)/85);T=T>255?255:T;}return"#"+this.rgb2hex(Math.round(L),Math.round(R),Math.round(T));},get3DBorderColor:function I(N,Q){var M=parseInt(N[0],10)*0.3+parseInt(N[1],10)*0.59+parseInt(N[2],10)*0.11;var P=parseInt(N[0],10);var O=parseInt(N[1],10);var L=parseInt(N[2],10);switch(Q){case"light":if(M>150){P=P*0.9;O=O*0.9;L=L*0.9;}else{P=P*0.6+102;O=O*0.6+102;L=L*0.6+102;}break;case"dark":if(M>10){P=P*0.4;O=O*0.4;L=L*0.4;}else{P=P*0.8+30;O=O*0.8+30;L=L*0.8+30;}}return"#"+this.rgb2hex(Math.round(P),Math.round(O),Math.round(L));},encodeColor:function(L,M){if(M!=undefined&&(L==null||L.length==0||L=="undefined")){L=M;}if(L=="transparent"){return -1;}else{if(L==-2){return -2;}else{if(L.substring(0,1)=="#"){L=L.substring(1);}return parseInt(L.substring(4)+L.substring(2,4)+L.substring(0,2),16);}}},decodeColor:function(N){var L=parseInt(N,10);if(L==0){return F;}var M=16777216+(L&255)*65536+(L&65280)+(L&16711680)/65536;return"#"+M.toString(16).substring(1).toUpperCase();}});})();(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}else{if(D.visible){return this._super(D);}else{var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;}}},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});})();(function(){mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,tooltipNode:null,postBuildRendering:function(){var B;if(this._super){B=this._super();}if(this.useRichTooltip){var D=this.tooltipNode||this.domNode,C=mstrmojo.dom,A=D&&D.getAttribute("title");if(A){D.setAttribute("title","");}if(!this._ontooltipover){var E=this.id;this._ontooltipover=function(G){var F=mstrmojo.all[E];F.showTooltip(G,self);};this._ontooltipout=function(G){var F=mstrmojo.all[E];F.hideTooltip(G,self);};}C.attachEvent(D,"mouseover",this._ontooltipover);C.attachEvent(D,"mouseout",this._ontooltipout);}return B;},showTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.open(this,B,A);},hideTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.close();},unrender:function(A){var C=this.tooltipNode||this.domNode,B=mstrmojo.dom;if(C&&this._ontooltipover){B.detachEvent(C,"mouseover",this._ontooltipover);}if(C&&this._ontooltipout){B.detachEvent(C,"mouseout",this._ontooltipout);}if(this._super){this._super(A);}}});})();(function(){mstrmojo.boxmodel={rangeIntersect:function C(H,F,G,E){if(H<G){return G<=F;}else{if(H>G){return H<=E;}else{return true;}}},px2Inches:function A(F,E){E=parseInt(E,10);return parseFloat((E/F.zf/F.dpi).toFixed(4),10);},offset:function D(G,F){var I=G,E=0,H=0;while(G){E+=G.offsetLeft;H+=G.offsetTop;G=G.offsetParent;if(G===F){break;}}for(e=I&&I.parentNode;e&&e!=F;e=e.parentNode){if(e.scrollTop){H-=e.scrollTop;}if(e.scrollLeft){E-=e.scrollLeft;}}return{left:E,top:H};},convert2px:function B(H,F){if(!/px$/.test(F)){var E=document.createElement("img"),G;E.style.zIndex=-1;E.style.left=F;H.appendChild(E);G=E.style.pixelLeft;H.removeChild(E);return G+"px";}else{return F;}}};})();(function(){var R=Math;function AA(G,b){return b||(G||window).event;}var Ab=!!document.all,q=navigator.userAgent,g=!Ab&&!!q.match(/Firefox/),m=0,r=!!q.match(/Android/),AV=!!q.match(/iPad/),AP=!!document.createTouch||r,p=!!q.match(/PlayBook/),S=!!q.match(/Windows Phone/),V=Ab&&!!q.match(/MSIE 10/),Ac=!Ab&&!!q.match(/Trident.*rv/),t=Ab&&!V,f=g?"-moz-":Ab?"":"-webkit-",AG=g?"Moz":V?"":Ab?"ms":"webkit",AN=(V?"t":"T"),AJ=AG+AN+"ransition",AZ=AW(),AS=AD(),z=W(),A=Q(),n=h();function AW(){return AG+AN+"ransform";}function AD(){return AJ+"Property";}function W(){return AJ+"Duration";}function Q(){return(V||g)?"transitionend":"webkitTransitionEnd";}function h(){return AG+"BoxShadow";}function AM(){if(!m&&g){var G=q.match(/.*Firefox\/([\d|\.]*).*/);if(G){m=parseFloat(G[1],10);}}return m;}function Aa(){var Ae=0,Ai=0,Af=window,Ag=document,G=Ag.body,Ah=Ag.documentElement;if(typeof Af.pageYOffset=="number"){Ai=Af.pageYOffset;Ae=Af.pageXOffset;}else{if(G&&(G.scrollLeft||G.scrollTop)){Ai=G.scrollTop;Ae=G.scrollLeft;}else{if(Ah&&(Ah.scrollLeft||Ah.scrollTop)){Ai=Ah.scrollTop;Ae=Ah.scrollLeft;}}}return{x:Ae,y:Ai};}function AE(G){G=G||0;G=String(G);return((G.indexOf("%",0))!=-1)?G:(G+"px");}function AK(d,Ag,Af,Ae,w){if(!mstrmojo.dom.isWinPhone){Ae=(Ae||false||this.isHWAccelerated);}else{Ae=false;}var b=w+(Ae?"3d":"")+"(",G=Ae?(","+Af+")"):")";return b+d+","+Ag+G;}var L=1,AT=2,Y=3,D=4,K=5;function x(Ag,Af,Aj){var Ai=Ag.style,b=Ai.display,Ae=this.windowDim(),w=Aa();Ai.display="block";var Ah=Ae.w-Ag.clientWidth,Ak=Ae.h-Ag.clientHeight,G={4:0,5:Ah,3:Ah/2},d={1:0,3:Ak/2,2:Ak};Ai.left=G[Af]+w.x+"px";Ai.top=d[Aj]+w.y+"px";Ai.display=b;}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:q,isIE:Ab,isIE6:Ab&&!!q.match(/MSIE 6/),isIE7:Ab&&!!q.match(/MSIE 7/),isIE8:Ab&&!!q.match(/MSIE 8/),isIE9:Ab&&!!q.match(/MSIE 9/),isIE10:V,isIEW3C:Ac,isNSIE:Ab&&!V,isDXIE:t,isFF:g,isWK:!!q.match(/AppleWebKit/),isSafari:!!q.match(/Safari/)&&!q.match(/Chrome/),isHWAccelerated:!r,isAndroid:r,isIPad:AV,isPlayBook:p,isWinPhone:S,supportsTouches:AP,TOUCHSTART:AP?"touchstart":"mousedown",TOUCHMOVE:AP?"touchmove":"mousemove",TOUCHEND:AP?"touchend":"mouseup",TOUCHCANCEL:AP?"touchcancel":"",RESIZE:AP?"orientationchange":"resize",CSS3_PREFIX:f,CSS3_BOXSHADOW:n,CSS3_TRANSFORM:AZ,CSS3_TRANSITION:AJ,CSS3_TRANSITION_PROPERTY:AS,CSS3_TRANSITION_DURATION:z,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},supports:function B(b){var G=this.isFF&&AM();switch(b){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||G>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||G>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);}return false;},replace:function F(d,G){if(!d||!G){return ;}var b=d.parentNode;if(b){b.replaceChild(G,d);}},attachEvent:function u(d,b,w,G){if(d.addEventListener){return d.addEventListener(b,w,!!G);}else{return d.attachEvent("on"+b,w);}},detachEvent:function AQ(d,b,w,G){if(!d){return ;}if(d.removeEventListener){d.removeEventListener(b,w,!!G);}else{d.detachEvent("on"+b,w);}},attachOneTimeEvent:function Z(w,b,Ae,G){var d=function(Af){Ae(Af);mstrmojo.dom.detachEvent(this,b,d,G);};this.attachEvent(w,b,d,G);w=null;return d;},captureDomEvent:function AI(Af,w,b,Ae,d){var G=mstrmojo.all[Af];if(G){G.captureDomEvent(w,b,Ae,d);}},translate:function O(d,b,Af,Ae,G,w){G=(G&&" "+G)||"";d.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(b,Af,Ae,w)+G;},createTranslateString:function T(G,w,d,b){G=AE(G);w=AE(w);d=AE(d);return AK(G,w,d,b,"translate");},createScaleString:function y(G,w,d,b){G=G||0;w=w||0;d=d||0;return AK(G,w,d,b,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function E(d,G,w,Af){var b=d.id+"-"+G,Ae=this._bufferConnects[b];if(!Ae){Ae=this._bufferConnects[b]={elId:d.id,eventName:G,timer:null,bufferSize:Af,listeners:[],callback:function(Ag){mstrmojo.dom._callback(Ag,mstrmojo.global,b);return true;}};this.attachEvent(d,G,Ae.callback);}Ae.listeners.push(w);},_callback:function N(Ae,G,d){if(!Ae){Ae=G.event;}var w=this._bufferConnects[d],Af=w&&w.timer;if(w&&!Af){var b=(w.bufferSize===null)?this._bufferSize:w.bufferSize;if(w.bufferSize){w.timer=G.setTimeout(function(){mstrmojo.dom.updateBuffers(d);},b);}else{mstrmojo.dom.updateBuffers(d);}}},updateBuffers:function AU(w){var Ae=this._bufferConnects[w],b=Ae&&Ae.listeners;for(var d=0,G=b&&b.length||0;d<G;d++){b[d]();}if(Ae&&Ae.timer){delete Ae.timer;}},detachBufferedEvent:function a(Af,d,Ag){if(!Af){return ;}var Ae=Af.id+"-"+d,Ah=this._bufferConnects[Ae],b=Ah&&Ah.listeners,G=(b&&b.length)||0;if(G){for(var w=G-1;w>-1;w--){if(b[w]==Ag){b.splice(w,1);}}if(!b.length){this.detachEvent(Af,d,Ah.callback);delete this._bufferConnects[Ae];if(Ah.timer){mstrmojo.global.clearTimeout(Ah.timer);}}}},eventTarget:function AB(G,b){b=AA(G,b);return b.target||b.srcElement;},ctrlKey:function AX(G,b){return AA(G,b).ctrlKey;},shiftKey:function AC(G,b){return AA(G,b).shiftKey;},getButton:function AO(G,b){return((AA(G,b)).button==2)?2:1;},getMousePosition:function i(Af,Ae){Ae=Ae||window;var w,Ai;if(mstrmojo.dom.isIE){Af=Af||Ae.event;var Ag=document,G=Ag.body,Ah=Ag.documentElement;w=Af.clientX+G.scrollLeft+(Ah.scrollLeft||0);Ai=Af.clientY+G.scrollTop+(Ah.scrollTop||0);}else{w=Af.pageX;Ai=Af.pageY;}return{x:w,y:Ai};},position:function(b,d){var Af={x:0,y:0};if(b&&b.getBoundingClientRect){try{Af=b.getBoundingClientRect();}catch(Ae){Af={left:0,top:0,right:0,bottom:0,height:0,width:0};}Af={x:Af.left,y:Af.top,w:Af.right-Af.left,h:Af.bottom-Af.top};if(this.isIE6||this.isIE7){var G=b.ownerDocument;if(G){var Ah=G.documentElement,Ag=Ah.getBoundingClientRect();Af.x-=Ag.left;Af.y-=Ag.top;}}}if(d){var w=Aa();Af.x+=w.x;Af.y+=w.y;}return Af;},delta:function J(d,G){G=G||document.body;var b=this.position(d),w=this.position(G);return{x:Math.round(b.x-w.x),y:Math.round(b.y-w.y)};},windowDim:function Ad(){var G=0,Ae=0,Af=window,Ag=document,Ah=Ag.documentElement,b=Ag.body;if(typeof (Af.innerWidth)=="number"){G=Af.innerWidth;Ae=Af.innerHeight;}else{if(Ah&&(Ah.clientWidth||Ah.clientHeight)){G=Ah.clientWidth;Ae=Ah.clientHeight;}else{if(b&&(b.clientWidth||b.clientHeight)){G=b.clientWidth;Ae=b.clientHeight;}}}return{w:G,h:Ae};},center:function AH(G){x.call(this,G,Y,Y);},bottomCenter:function H(G){x.call(this,G,Y,AT);},clearBrowserHighlights:function P(G){G=G||self;if(Ab){var Ag=G.document,Af=Ag&&Ag.selection,w=Af&&Af.empty;if(w){try{Af.empty();}catch(d){}}}else{var b=G.getSelection,Ae=b&&G.getSelection();if(Ae&&!Ae.isCollapsed){if(Ae.empty){Ae.empty();}else{if(Ae.removeAllRanges){Ae.removeAllRanges();}}}}},findAncestorByAttr:function AL(Ae,d,b,G){var Af=b?Ae:Ae&&Ae.parentNode;while(Af&&(Af!=G)){var w=Af.getAttribute&&Af.getAttribute(d);if(w!=null){return{node:Af,value:w};}Af=Af.parentNode;}return null;},findAncestorByName:function AY(d,Af,b,G){Af=Af&&Af.toLowerCase();var w=b?d:d&&d.parentNode;while(w&&(w!=G)){var Ae=w.nodeName;if(Ae&&(Ae.toLowerCase()==Af)){return w;}w=w.parentNode;}return null;},contains:function M(w,Ae,b,G){var d=Ae;if(!b){d=d.parentNode;}while(d){if(d==w){return true;}if(d===G){break;}d=d.parentNode;}return false;},preventDefault:function AR(G,b){if(!b){b=G.event;}if(b.preventDefault){b.preventDefault();}else{b.returnValue=false;}},stopPropogation:function j(G,b){if(!b){b=G.event;}if(b.stopPropogation){b.stopPropogation();}else{b.cancelBubble=true;}},firstTouch:function C(G,b){return b&&b.touches&&b.touches.length?b.touches[0]:(b||G.event);},firstChangedTouch:function I(G,b){return b&&b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:(b||G.event);},isLandscape:function X(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function(G){while(G){var b=G.mstrmojoId;if(b!=null){return mstrmojo.all[b];}G=G.parentNode;}return null;},setCaret:function(G,d){if(G.setSelectionRange){G.focus();G.setSelectionRange(d,d);}else{if(G.createTextRange){var b=G.createTextRange();b.move("character",d);b.select();}}}});var AF=mstrmojo.dom,c=window,k=document,U=k&&k.documentElement,o=k&&k.body;if(c.innerWidth){AF.getHorizontalScroll=function(){return c.pageXOffset;};AF.getVerticalScroll=function(){return c.pageYOffset;};}else{if(U&&U.clientWidth){AF.getHorizontalScroll=function(){return U.scrollLeft;};AF.getVerticalScroll=function(){return U.scrollTop;};}else{if(o.clientWidth){AF.getHorizontalScroll=function(){return o.scrollLeft;};AF.getVerticalScroll=function(){return o.scrollTop;};}}}})();(function(){function P(T,Q,R){if(T.nodeType===3&&Q){return T;}else{var S=(Q&&T.nodeType===1&&T.lastChild)?T.lastChild:E(T,R);return S?C(S,R):null;}}function E(R,Q){return(R===Q)?null:(R.previousSibling||E(R.parentNode,Q));}function C(R,Q){if(R===Q){return null;}if(R.nodeType===3&&H(R)){return R;}else{if(R.nodeType===1&&R.lastChild){return C(R.lastChild);}else{return C(E(R,Q));}}}function H(Q){return Q.textContent||Q.nodeValue||Q.innerText;}function L(T,Q,R){if(T.nodeType===3&&Q){return T;}else{var S=(Q&&T.nodeType===1&&T.firstChild)?T.firstChild:B(T,R);return S?D(S,R):null;}}function B(R,Q){return(R===Q)?null:(R.nextSibling||B(R.parentNode,Q));}function D(R,Q){if(R===Q){return null;}if(R.nodeType===3&&H(R)){return R;}else{if(R.nodeType===1&&R.firstChild){return D(R.firstChild);}else{return D(B(R,Q));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function O(S,T){var Q=0,R;if(S.nodeType===1){if(window.getSelection){R=document.createRange();R.selectNode(S);Q=R.toString().length;}else{R=document.body.createTextRange();R.moveToElementText(S);Q=R.text.length;}}else{Q=H(S).length;}return T===Q?this.EDGE.EDGE_END:(T===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function J(T,R){if(!T.offsetParent){return ;}var S=this.getSelection(),Q=this.getRange();if(window.getSelection){Q.selectNodeContents(T);Q.collapse(R);S.removeAllRanges();S.addRange(Q);}else{Q.moveToElementText(T);Q.collapse(R);Q.select();}},collapseOnTextNode:function K(T,U){var S=this.getSelection(),R=this.getRange();if(window.getSelection){var Q=L(T,true);R.setStart(Q,U);R.collapse(true);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(T);R.collapse(true);R.move("character",U);R.select();}},getRangeInfo:function I(){var X=null,b,U=this.getRange(),d;if(window.getSelection){var a=function(g,i,h){var f=g.cloneRange();f.collapse(h);f.setStartBefore(i);return f.toString().length;},Z=U.startContainer,R=U.startOffset;if(Z.nodeType===1){R=a(U,Z,true);}X={collapsed:U.collapsed,startContainer:Z,startOffset:R};if(!U.collapsed){var V=U.endContainer,Q=U.endOffset;if(V.nodeType===1){Q=a(U,V,false);}X.endContainer=V;X.endOffset=Q;}X.range=U;}else{var W,c,Y=function(i,j){var h=i.duplicate(),f=document.body.createTextRange(),g;h.collapse(j);g=h.parentElement();f.moveToElementText(g);f.setEndPoint("EndToStart",h);return{container:g,offset:f.text.length};},T=Y(U,true),S;X={collapsed:(U.compareEndPoints("StartToEnd",U)===0),startContainer:T.container,startOffset:T.offset};if(!X.collapsed){S=Y(U,false);X.endContainer=S.container;X.endOffset=S.offset;}}return X;},collapse:function N(R){if(window.getSelection){var S=this.getSelection();if(R){S.collapseToStart();}else{S.collapseToEnd();}}else{var Q=this.getRange();Q.collapse(R);Q.select();}},selectSingleNode:function G(S){var R=this.getSelection(),Q=this.getRange();if(window.getSelection){Q.selectNodeContents(S);R.removeAllRanges();R.addRange(Q);}else{Q.moveToElementText(S);Q.select();}},selectMultipleNodes:function M(V,R,W,T){var U=this.getSelection(),S=this.getRange();if(window.getSelection){S.setStart(V,R);S.setEnd(W,T);U.removeAllRanges();U.addRange(S);}else{V=(V.nodeType===3)?V.parentNode:V;S.moveToElementText(V);S.move("character",R);W=(W.nodeType===3)?W.parentNode:W;var Q=document.body.createTextRange();Q.moveToElementText(W);Q.move("character",T);S.setEndPoint("EndToStart",Q);S.select();}},getSelection:function F(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var BasicAggMap={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"};function _sortFunctions(fcts){var fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);},i,len;fcts=fcts.sort(fs);for(i=0,len=fcts.length;i<len;i++){fcts[i].fns=fcts[i].fns.sort(fs);}return fcts;}function getBasicCategoryIndex(fcts){var Agg_Func_Greatest="B2C0FA4020C711D6AD1400C04F0423DE",len=fcts.length,ci;for(ci=0;ci<len;ci++){var fns=fcts[ci].fns;if(mstrmojo.array.find(fns,"did",Agg_Func_Greatest)>-1){return ci;}}mstrmojo.alert("No Basic Functions found!");}function buildTaskParams(params){var qse=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();params=mstrmojo.hash.copy(params,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false,sessionState:mstrApp.sessionState});if(qse){params.quickSearch=qse;params.nameWildcards=16,params.sortKey=-1;}return params;}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getMetricDefintion:function getMetricDefintion(params,callbacks){var taskParams={taskId:"getMetricDefinition",metricId:params.id,outputFlags:65599,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},validateMetric:function validateMetric(params,callbacks){var taskParams={taskId:"validateMetric",metricId:params.metricId,tokenStreamXML:params.tokenStreamXML,metricXML:params.metricXML,outputFlags:327695,sessionState:mstrApp.sessionState};if(mstrmojo.string.isEmpty(params.metricId)){taskParams.isNew=true;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getMetricComponents:function getMetricComponents(params,callbacks){var me=this,mc=this.metricComponents;if(!this.noCache&&mc&&mc.items.length==mc.sz){callbacks.success(mc);return ;}else{callbacks.success=mstrmojo.func.composite([callbacks.success,function(res){if(me.metricComponents&&me.metricComponents.items){me.metricComponents.items.push(res.items);}else{me.metricComponents=res;}}]);}var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||24,objectType:params.objectType||"11,12,13,43"});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getAttributes:function getAttributes(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||26,objectType:12});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getFacts:function getFacts(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||29,objectType:13});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getMetrics:function getMetrics(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||5,objectType:4});if(params.isVerify){taskParams.nameWildcards=2;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getFunctions:function getFunctions(callbacks){var me=this,wss=window.sessionStorage,fcts=this.functions||wss&&wss.getItem("functions"),localeId=wss&&wss.getItem("mstrLocaleId"),cLocaleId=mstrApp&&mstrApp.localeId;if(fcts&&localeId==cLocaleId){fcts=_sortFunctions(eval("("+fcts+")").fncs);callbacks.success(fcts);}else{var cb={failure:callbacks.failure,textResponse:true},taskParams={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2,sessionState:mstrApp.sessionState,includeFunctionHelpTopic:true};cb.success=function(res){if(wss){wss.setItem("functions",res);wss.setItem("mstrLocaleId",cLocaleId);}me.functions=res;fcts=_sortFunctions(eval("("+res+")").fncs);callbacks.success(fcts);};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,taskParams);}},getAggFunctions:function getAggFunctions(){if(this._aggFunctions){return this._aggFunctions;}var fcts=this.functions||window.sessionStorage&&window.sessionStorage.getItem("functions");if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[getBasicCategoryIndex(fcts)].fns,function(item){var did=item.did,retVal;if(did!=="B2C0FA4020C711D6AD1400C04F0423DE"&&did!=="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=BasicAggMap[did];}return retVal;});return fcts;},getFunctionCatList:function getFunctionCatList(){if(this._functionCatList){return this._functionCatList;}var fcts=this.functions||window.sessionStorage&&window.sessionStorage.getItem("functions");if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.hash.make(fcts,mstrmojo.Arr);this._functionCatList=fcts;return fcts;},getFunctionDetails:function getFunctionDetails(params,callbacks){var taskParams={taskId:"getSystemFunctions",functionId:params.did,includeFunctionDetails:true,sessionState:mstrApp.sessionState,includeFunctionHelpTopic:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getTransformations:function getTransformations(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||38,objectType:43});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getFilters:function getFilters(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||4,objectType:1});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getAttributeForms:function getAttributeForms(params,callbacks){var taskParams={taskId:"getAttributeForms",attributeID:params.attributeID,displayedForms:params.displayedForms,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},getSubtotalFunctions:function getSubTotalFunctions(params,callbacks){var taskParams=buildTaskParams({objectType:"1025,1026",searchPattern:""});mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,taskParams);},isBasicAggMap:function isBasicAggMap(did){var retVal=!!BasicAggMap[did];if(did==="B2C0FA4020C711D6AD1400C04F0423DE"||did==="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=false;}return retVal;},getFunctionHelpTopic:function getFunctionHelpTopic(h){return'<a href="'+((mstrApp.helpUrl||"../help/")+"FunctionsRef/index.html?context=functionsref&topic="+(h||""))+'" target="_new">'+mstrmojo.desc(5811,"Details ...")+"</a>";}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof (W)=="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget.apply(this,[]);}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children;for(var Y=0,W=(X&&X.length)||0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);for(var X=0,W=(Y&&Y.length)||0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props;for(var Z in Y){var X=Y[Z],W=X.ease;if(typeof (W)=="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props;for(var a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}else{return parseInt(W*Y,10)/W;}}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}else{if(X===0){return W;}else{return W+Z*I(X,Y);}}},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}else{return W+Z*Math.sin((Math.PI/2)*X/Y);}},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}else{return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}else{if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}else{if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}else{return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;}}}},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}else{return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var R=mstrmojo.dom,P=mstrmojo.hash;var M=100;var E=R.supportsTouches?0.5:1;var F=1;var Q=100;var N={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var K=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[R.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[R.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[R.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[R.CSS3_TRANSITION]=this.decelerating?(R.CSS3_PREFIX+"transform 0.2s linear"):"";}},P.copy(N));var G=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},P.copy(N));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function L(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=P.copy(R.isSafari?K:G,P.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}R.attachEvent(U,R.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){R.detachEvent(T,R.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function I(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}R.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=R.getMousePosition(R.firstTouch(T,V),T);this.dragging=false;R.attachEvent(window,R.TOUCHMOVE,this._tmCallback);R.attachEvent(window,R.TOUCHEND,this._teCallback);},touchesMoved:function D(b,d){var Z=R.getMousePosition(R.firstTouch(b,d),b);R.preventDefault(b,d);if(!this.dragging){var T=5,h=Math.abs;if((this.scrollsHoriz&&h(Z.x-this.pos.x)>T)||(this.scrollsVert&&h(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},f={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=f;this.maxPos={x:Math.max(f.x-Y.x,0),y:Math.max(f.y-Y.y,0)};this.showScroll();}}if(this.dragging){R.stopPropogation(b,d);var c=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(c.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(c.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),g=this.lastDragTime;this.nextLastDragTime=g;this.lastDragTime=U;if((U-g)>Q){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function H(T,U){R.preventDefault(T,U);R.detachEvent(window,R.TOUCHMOVE,this._tmCallback);R.detachEvent(window,R.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;R.stopPropogation(T,U);if((new Date())-this.lastDragTime<=Q){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=R.getMousePosition(R.firstChangedTouch(Y,Z),Y),c=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-c.x,y:W.y-c.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),d=T?(new Date())-T:0,V={x:d?Number(b.x*M*E/d).toFixed(2):0,y:d?Number(b.y*M*E/d).toFixed(2):0};var a=this,U=function(f){return(a.scrollsHoriz&&Math.abs(f.x)>=F)||(a.scrollsVert&&Math.abs(f.y)>=F);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,M);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=(b)?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=(b)?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function J(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function O(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var F=mstrmojo.dom,L=mstrmojo.string;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:F.isNSIE?"block":"table",DISPLAY_CELL:F.isNSIE?"block":"table-cell",MINHEIGHT:F.isIE6?"height":"minHeight",addClass:function H(V,U){if(!V){return ;}if(U.constructor!==Array){U=[U];}var R=V.className||"",X=" "+R+" ",S=false;for(var T=0,Q=U.length;T<Q;T++){var W=U[T];if(!X.match(new RegExp("\\s"+W+"\\s"))){R+=" "+W;S=true;}}if(S){V.className=L.trim(R);}},removeClass:function M(U,T){if(!U){return ;}if(T.constructor!==Array){T=[T];}var R=" "+(U.className||"")+" ";for(var S=0,Q=T.length;S<Q;S++){R=R.replace(new RegExp("\\s"+T[S]+"\\s","g")," ");}U.className=L.trim(R);},addWidgetCssClass:function G(T,R){var Q=T.cssClass,S=(Q&&Q.split(" "))||[];if(R.constructor!==Array){R=[R];}T.cssClass=S.concat(R).join(" ");},toggleClass:function N(S,R,Q){if(Q){this.addClass(S,R);}else{this.removeClass(S,R);}},applyShadow:function D(U,V,T,S,Q){var R=U.style;if(F.isDXIE){R.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+V+"px, OffY="+T+"px, Color='"+Q+"')";}else{if(F.isFF||F.isWK||F.isIE10){R[F.CSS3_BOXSHADOW]=V+"px "+T+"px "+S+"px "+Q;}}},removeShadow:function O(R){var Q=R.style;if(F.isDXIE){}else{if(F.isFF||F.isWK||F.isIE10){Q[F.CSS3_BOXSHADOW]="";}}},setOpacity:function A(R,T){if(F.isDXIE&&!F.isIE9){var U=R.currentStyle.filter;var Q=null;if(U.length>0){Q=R.filters["DXImageTransform.Microsoft.Alpha"];}if(Q){Q.opacity=T;Q.enabled=(T!=100);}else{if(T<100){var S="progid:DXImageTransform.Microsoft.Alpha(Opacity="+T+")";R.style.filter=(U?U:"")+" "+S;}}}else{R.style.opacity=T/100-(F.isIE9?0.00001:0);}},buildGradient:function C(R,T,Q){if(F.supports(F.cssFeatures.GRADIENTS)){var S={};if(F.isDXIE){S.n="filter";S.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+R+",StartColorStr='"+T+"',EndColorStr='"+Q+"')";}else{if(F.isFF){S.n="background-image";S.v="-moz-linear-gradient("+((R===0)?"top":"left")+","+T+","+Q+")";}else{if(F.isWK){S.n="background";S.v="-webkit-gradient(linear,"+((R===0)?"left top, left bottom":"left top, right top")+",from("+T+"),to("+Q+"))";}else{if(F.isIE10||F.isIEW3C){S.n="background";S.v="linear-gradient("+((R===0)?"to bottom":"to right")+","+T+","+Q+")";}}}}return S;}return null;},buildRoundCorners:function K(V,U){if(F.supports(F.cssFeatures.ROUND_CORNERS)){var R=V+"px";var X=R+((U)?" "+R+" 0 0":"")+";";if(F.isFF){return"-moz-border-radius:"+X;}else{if(F.isWinPhone||F.isIE10){return"border-radius:"+X;}else{if(F.isWK){if(!U){return"-webkit-border-radius:"+R+";";}else{var W=["left","right"],T=[],Q=-1;for(var S=0;S<2;S++){T[++Q]="-webkit-border-top-"+W[S]+"-radius:"+R;T[++Q]="-webkit-border-bottom-"+W[S]+"-radius:0";}return T.join(";");}}}}}return"";},getBorderWidthsOrPaddings:function E(R,U){var V={t:0,r:0,b:0,l:0,h:0,w:0};if(!R){return V;}var S=R.split(" "),Q=S.length;for(var T=0;T<Q;T++){S[T]=Math.round(U*parseFloat(S[T],10)/72);}if(Q<4){if(Q===1){S[1]=S[2]=S[3]=S[0];}else{S[3]=S[1];if(Q===2){S[2]=S[0];}}}V.t=S[0];V.r=S[1];V.b=S[2];V.l=S[3];V.h=V.t+V.b;V.w=V.l+V.r;return V;},getBorderWidths:function I(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},getPaddings:function J(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},parkAfterFade:function P(Q){var R=Q.target.style;if(R.opacity==0){R.left="-10000px";window.setTimeout(function(){R.opacity=0.99;},0);return true;}return false;},getStyleValue:function B(Q,S){if(Q.currentStyle){S=S=="float"?"styleFloat":S;value=Q.currentStyle[S];}else{if(document.defaultView&&document.defaultView.getComputedStyle){S=S=="float"?"cssFloat":S;var R=document.defaultView.getComputedStyle(Q,null);value=R?R[S]:null;}}return value;},getComputedStyle:function(Q,S){var R=(window.getComputedStyle)?function(T,U){return window.getComputedStyle(T,U||null);}:function(T){return T.currentStyle||{};};mstrmojo.css.getComputedStyle=R;return R(Q,S);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var I=mstrmojo.dom;var L="mousedown";function P(S){var R=S[S.hotSlot||"domNode"];if(R){if(!S._closeCallback){var U=S.id,T=function(V){return function(X){var W=mstrmojo.all[U];if(W&&!W.ignoreHover){W["auto"+V](X,self);}};};S._uncloseCallback=T("Unclose");S._closeCallback=T("Close");}I.attachEvent(R,"mouseover",S._uncloseCallback);I.attachEvent(R,"mouseout",S._closeCallback);}}function C(S){if(S._closeCallback){var R=S[S.hotSlot||"domNode"];if(R){I.detachEvent(R,"mouseover",S._uncloseCallback);I.detachEvent(R,"mouseout",S._closeCallback);}}}function N(T,S){var R=T;while(R){if(R.open||R.openPopup){if(R.set){R.set("ignoreHover",S);}else{R.ignoreHover=S;}}R=R.opener||R.parent;}}function A(){var R=this._lockHoverCallback;if(R){I.detachEvent(document.body,L,R,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose={autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function B(){this._super();if(this.autoCloses){P(this);}this.oncloseOnClickChange();},onautoClosesChange:function D(){var R=(this.autoCloses)?P:C;R(this);},oncloseOnClickChange:function O(){if(!this.curtainNode){return ;}var T=this,S="click",R=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(R){S="touchstart";}I.attachEvent(T.curtainNode,S,function(){T.close();if(R){mstrmojo.touchManager.notify([]);}});},autoUnclose:function H(){var R=this._autoCloseTimer;if(R){self.clearTimeout(R);delete this._autoCloseTimer;}},autoClose:function F(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var R=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[R].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function M(R){A.call(this);this._super(R);},lockHover:function K(){N(this,true);if(!this._lockHoverCallback){var S=this.id,R=this._lockHoverCallback=function(T){mstrmojo.all[S]._unlockHoverCheck(T,self);};if((I.isIE7||I.isIE8)&&window.event&&(window.event.type==L)&&this.opener){this.opener._ignoreMousedown=true;}I.attachEvent(document.body,L,R,true);}},unlockHover:function E(){N(this,false);A.call(this);},_unlockHoverCheck:function J(T,R){var S=this.opener;if(S&&S._ignoreMousedown){delete S._ignoreMousedown;return ;}if(!I.contains(this.domNode,I.eventTarget(R,T),true,document.body)){this.close();}},open:function G(S,R){if(this.autoCloses){this.autoUnclose();}this._super(S,R);if(this.locksHover){this.lockHover();}},close:function Q(R){if(this.locksHover){this.unlockHover();}this._super(R);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=mstrmojo.dom;function E(J,I){var G=[];if(J){for(var F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function D(L,F,N){var I=N.hWin,J=N.e,G=A.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=A.ctrlKey(I,J),O=A.shiftKey(I,J);if(K||O){A.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}},premouseup:function C(H,K,G){var F=G.hWin,J=G.e,L=A.ctrlKey(F,J),I=A.shiftKey(F,J);if(L||I){A.clearBrowserHighlights(F);}},onadd:function B(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=E(K,G);for(var J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function B(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){for(var H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);for(var J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=false,P=mstrmojo.dom,S=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(T){return false;},queryEnabled:function(T){return true;},queryVisible:function(T){return true;},executeCommand:function O(T){},item2textCss:function E(T){return T.cssClass||T.cmdId||("cmd"+T[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var Z=this._subMenu,X=this.getMenuPosition();if(!Z){var b=(this.menuZIndex||this.zIndex||10)+1,V={left:X.x+"px",top:X.y+"px",zIndex:b,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};Z=new mstrmojo.ContextMenu(V);Z.render();this._subMenu=Z;}else{Z.set("left",X.x+"px");Z.set("top",X.y+"px");}if(this.dynamicUpdate){var U=Z.ctxtBuilder.itemWidgets,W=U&&U.length,T,Y,a=this.getContextMenuSource();for(T=0;T<W;T++){Y=U[T];if(a.queryVisible){Y.set("visible",a.queryVisible(Y.data));}if(a.queryChecked){Y.set("checked",a.queryChecked(Y.data));}if(a.queryEnabled){Y.set("enabled",a.queryEnabled(Y.data));}}}Z.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var T=this._subMenu;if(T&&T.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function N(){var T=this._subMenu,W=this._subMenu.domNode,V=W.offsetHeight,U=W.offsetWidth,Z=P.windowDim(),Y=P.position(W,false),X=P.position(W,true);if((Y.x+U+S)>Z.w){T.set("left",(Z.w-U-S+(X.x-Y.x))+"px");}if((Y.y+V+S)>Z.h){T.set("top",(Z.h-V-S+(X.y-Y.y))+"px");}},attachMousedownEvent:function L(){var T=this;if(!this._close_handler){this._close_handler=function(){if(!T.isOnMySubmenu(P.eventTarget(self,arguments[0]))){T.closeMenuTree();}};}P.attachEvent(document.body,"mousedown",this._close_handler);},isOnMySubmenu:function M(X){var U=this._subMenu;if(!U){return false;}if(P.contains(U.domNode,X,true,document.body)){return true;}var Y=U.ctxtBuilder.itemWidgets,T=Y&&Y.length,W,V;for(W=0;W<T;W++){V=Y[W];if(V.isOnMySubmenu(X)){return true;}}return false;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function R(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var T=P.position(this.domNode,true);return{x:Math.round(T.x),y:Math.round(T.y+T.h)};},isSeparatorItem:function G(T){return T[this.itemIdField]===-1||T[this.itemField]==="-";},hasSubmenu:function K(T){return !!T[this.itemChildrenField];},closeMenuTree:function Q(V){var U=this.activeMenuItem,T=this._cmSource||this;if(!U){if(V){this.activeMenuItem=V;}else{T.hideContextMenu();}return ;}if(U===V){return ;}if(V){this.activeMenuItem=V;if(V.parent.parent===U){return ;}if(V.parent===U.parent){U.hideContextMenu();return ;}}else{V=T;this.activeMenuItem=null;}U.hideContextMenu();while(U!==T){U=U.parent.parent;if(U!==V||T===V){U.hideContextMenu();if(T===V){P.detachEvent(document.body,"mousedown",this._close_handler);}}if(U.parent===V.parent){break;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom");var M=mstrmojo.string,T=mstrmojo.dom;var N=mstrmojo.useFrames?null:document.createElement("span");var B=/\mstrAttach\:([\w\,]+)/g;var R;function O(X){if(R===undefined){R=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return X.replace(B,function W(c,f){var Z=f.split(","),a=[],Y=Z.length,b;for(b=0;b<Y;b++){var d=Z[b];if(d){if(R){if(d.indexOf("mouse")>-1){continue;}else{if(d==="click"){d="touchend";}}}a.push("on"+d+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+d+"', self, event)\"");}}return a.join(" ");});}var P="preBuildRendering",D="buildRendering",A="postBuildRendering";function E(Y){var X=Y.markupString;if(X.match(/mstrAttach:/)){X=O(X);if(Y.markupString===Y.constructor.prototype.markupString){Y.constructor.prototype.markupString=X;}}var W=M.apply(X,Y);if(W){if(mstrmojo.useFrames){var Z=(Y.domNode&&Y.domNode.ownerDocument)||self.document;if(!N||N.ownerDocument!==Z){N=Z.createElement("span");}}N.innerHTML=W;var a=N.firstChild;a.mstrmojoId=Y.id;return a;}return null;}function J(Y){var X=Y.markupSlots,W,Z;if(X){W={};for(Z in X){W[Z]=X[Z].apply(Y,[]);}}return W;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function G(){if((this[P]&&this[P]()===false)||(this[D]()===false)||(this[A]&&this[A]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var W="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,W)){this.raiseEvent({name:W});}return true;},buildDom:function S(){return E(this);},preBuildRendering:mstrmojo.emptyFn,buildRendering:function C(){var W=this.domNode,X=this.buildDom();this.domNode=X;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(J(this));this.paint();if(X){var a=W;if(!a){a=this.placeholder;if(a){if(typeof a==="string"){a=document.getElementById(a);}delete this.placeholder;}}if(a){T.replace(a,X);}}var Y="onchildRenderingChange",Z=this.parent;if(Z&&Z[Y]){Z[Y](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function Q(Y){if(this.hasRendered){if(!Y){try{var W=this.domNode;if(W.parentNode){W.parentNode.removeChild(W);}if(mstrmojo.dom.isIE&&W.outerHTML!=="undefined"){W.outerHTML="";}}catch(X){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function V(){var X=this.markupMethods;if(!X){return ;}var a=this,b=function(h){var d=X[h];if(d){try{d.apply(a,[true]);}catch(g){throw new Error(["Error in markup method.","Widget id: "+a.id,"Method name: "+h,"Err: "+g.message].join("\n\n"));}}};var Z=X.sequence,W,Y,c;if(Z){W=Z.length||0;for(Y=0;Y<W;Y++){b(Z[Y]);}}else{for(c in X){b(c);}}},refresh:function F(W){if(this.hasRendered){var X=this.domNode;this.unrender(true);this.placeholder=X;if(W){W();}this.render();}},set:function L(Z,W){this._super(Z,W);if(this.domNode){var X=this.markupMethods,Y=X&&X["on"+Z+"Change"];if(Y){Y.apply(this);}}return this;},slotNames:null,addSlots:function I(X){var W=this.slotNames,Y;if(!W){W={};this.slotNames=W;}for(Y in X){this[Y]=X[Y];W[Y]=true;}},removeSlots:function K(W){if(W){var X=this.slotNames,Y;for(Y in W){delete this[Y];if(X){delete X[Y];}}}},captureDomEvent:function H(Y,W,Z,X){if(this.enabled!==false){this.raiseEvent({name:Y,hWin:W,e:Z||W.event,config:X});}},playEffect:function U(X){var W=this[X];if(W&&W.constructor===Object){W=mstrmojo.insert(mstrmojo.hash.clone(W));W.widget=this;this[X]=W;}if(W){W.play();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var B=false,D="mstrmojo.Binding",A="bindings",C=mstrmojo.registry;function E(K){for(var L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function F(K,M){if(!B){mstrmojo.requiresCls(D);B=true;}for(var N in K){var J=K[N];if(J==null){continue;}var L=typeof (J);if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=C.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function G(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[A]);if(K){delete this[A];this._set_bindings(A,K,true);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children;if(M){for(var L=0,J=M.length;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function I(){var J=this.bindings;if(J){E(J);delete this.bindings;}},_set_bindings:function H(L,J){var K=this[A];if(J!==K){if(K){E(K);}this[A]=J;if(J){F(J,this);}return true;}return false;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,L=mstrmojo.hash;function F(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(C.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function B(R){var Q=[],S=R.selectedIndices;for(var P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function N(V,U){var S=[],Q=V.selectedIndices,X=C.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return B(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}for(var R=0,T=U.length;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex==W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V;for(var Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function H(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function O(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=B(this),S=F(this,[P]);if(Q!==true){H(this,S,R);}}},toggleSelect:function J(P,Q){var S,R;if(this.selectedIndices[P]){R=N(this,[P]);}else{S=F(this,[P]);}if(Q!==true){H(this,S,R);}},rangeSelect:function G(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=B(this);if(P!==true){H(this,null,Q);}},select:function E(R,P){var Q=A(this,C.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){H(this,Q.add,Q.rmv);}},addSelect:function M(R,P){if(R==null){return ;}if(R.constructor!==Array){R=[R];}var Q=F(this,R);if(P!==true){H(this,Q,null);}return Q;},removeSelect:function K(R,P){if(R==null){return ;}if(R.constructor!=Array){R=[R];}var Q=N(this,R);if(P!==true){H(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){H(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof (T)=="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=C.find(U,V,T[V]);}else{if(T!=null){Q=C.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function D(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!=null){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return L.keyarray(this.selectedIndices,true).sort(C.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return C.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],w=this.itemIdField!=null?C.findMulti(S,this.itemIdField,Q):C.indexOfMulti(S,Q),V=Q.length,T=V-w.count,t=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(t&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],g=w.map;if(T&&t){var r=0;for(var f=0;f<V;f++){if(g[f]==null){R.push(Q[f]);U.push(b+r++);}}this.add(R,b);}var W=[];for(var o in g){var q=g[o];if(q>=b){q+=X;}W.push(q);}var u=W.concat(U),Y=this.addSelect(u,!d);if(!d){var Z=C.hash(Y),h=this.selectedIndices,a=[];for(var p in h){if(!Z[p]){a.push(parseInt(p,10));}}var P=this.removeSelect(a,true);H(this,Y,P);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,D=mstrmojo.hash;function C(X,V){if(!V){return ;}var Y=[],O=X.selectedIndices,N=X.allIdx,T=X.noneIdx,P=X.parent&&X.parent.include;if(X.multiSelect&&(T>-1)&&(G.indexOf(V,T)>-1)){return Y;}var R,S,W=X.items,U=X.itemIdField,Q=X.selectedItems,a;if(X.multiSelect&&(N>-1)&&(G.indexOf(V,X.allIdx)>-1)){for(R=0,S=W.length;R<S;R++){if(!O[R]){Y.push(R);O[R]=true;X.selectedIndex=R;X.selectedItem=W[R];}}}else{for(R=0,S=V.length;R<S;R++){var Z=V[R];if(!O[Z]){O[Z]=true;Y.push(Z);X.selectedIndex=Z;a=X.selectedItem=W[Z];if(Q){Q[a[U]]=a;}}}}return Y;}function A(P){var O=[],Q=P.selectedIndices,R=P.selectedItems;for(var N in Q){delete Q[N];O.push(parseInt(N,10));}P.selectedIndex=-1;P.selectedItem=null;if(R){P.selectedItems={};}return O;}function L(W,V){if(!V){return ;}var S=[],O=W.selectedIndices,Y=G.indexOf,N=W.allIdx,T=W.noneIdx,U=W.itemIdField,P=W.selectedItems;if(W.multiSelect&&(((N>-1)&&(Y(V,N)>-1))||((T>-1)&&(Y(V,T)>-1)))){return A(W);}if(V.length>0&&O[N]){if(Y(V,N)<0){V.push(N);}}for(var Q=0,R=V.length;Q<R;Q++){var X=V[Q];if(O[X]){delete O[X];S.push(X);if(P){delete P[W.items[X][U]];}if(W.selectedIndex==X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function F(Q,P,R,N){if(Q.raiseEvent){Q.raiseEvent({name:"select",idxs:N||[]});if((P&&P.length)||(R&&R.length)){try{Q.raiseEvent({name:"selectionChange",added:P,removed:R});}catch(O){L(Q,P);C(Q,R);throw O;}}}}function I(P,O){if(O==null){return -1;}var N=typeof (O)=="object",Q=P.itemIdField;if(N&&Q!=null){return G.find(P.items,Q,O[Q]);}else{return G.indexOf(P.items,O);}}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(N){this._super(N);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function M(W){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this.items,N=this.items.length,Q=this.selectedItems,S=[],P;U=this.items=U.concat(W);P=U.length;if(Q){var O=this.selectedIndices,T=this.itemIdField,R,V;for(R=N;R<U.length;R++){V=U[R];if(Q[V[T]]){S.push(R);}}}if(S&&S.length){C(this,S);}if(P>N){this.itemsContainerNode.innerHTML+=this._buildItemsMarkup(N,P-1).join("");}},addSelectedItems:function H(N){this.selectItems(N,false);},setSelectedItems:function K(N){this.selectItems(N,true);},selectItems:function J(W,Y){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this;if(Y&&U.selectedItems){U.selectedItems={};}var P=U.selectedItems,T=U.itemIdField,X,V,Q,N=[],S=U.items.length,R=[],O=U.allowUnlistedValues;for(Q=0;Q<W.length;Q++){X=W[Q];V=I(this,X);if(V===-1){if(P===null){if(O){N.push(v);V=S++;}}else{P[X[T]]=X;}}if(V!==-1){R.push(V);}}if(N.length>0){U.addItems(N);}if(R.length>0){if(Y){U.select(R);}else{U.addSelect(R);}}},unselectItems:function J(O){if(!O){return ;}if(O.constructor!=Array){O=[O];}var S=this,U=S.selectedItems,P=[],T=S.itemIdField,R,N,Q;if(U===null){return ;}for(Q=0;Q<O.length;Q++){R=O[Q];if(U){delete U[R[T]];}N=I(this,R);if(N!==-1){P.push(N);}}if(P.length>0){S.removeSelect(P);}},getSelectedItems:function B(){if(this.selectedItems!=null){return D.valarray(this.selectedItems);}else{return G.get(this.items,D.keyarray(this.selectedIndices,true));}},singleSelect:function(N,O){if(N!==-1){this.select([N],O);}},singleSelectByField:function E(O,P,N){this.singleSelect(G.find(this.items,P,O),N);},toggleSelect:function(N){var P,O;if(this.selectedIndices[N]){O=L(this,[N]);}else{P=C(this,[N]);}F(this,P,O,[N]);},rangeSelect:function(N){},select:function(O,N){if(O==null){return ;}if(O.constructor!=Array){O=[O];}var Q=A(this),S=C(this,O),P=Q.length-1;if(this.selectionPolicy!=="reselect"){for(;P>=0;P--){var R=G.indexOf(S,Q[P]);if(R>-1){Q.splice(P,1);S.splice(R,1);}}}if(!N){F(this,S,Q,O);}},clearSelect:function(N){var O=A(this);if(N!==true){F(this,null,O,[]);}},addSelect:function(P,N){if(P==null){return ;}if(P.constructor!=Array){P=[P];}var O=C(this,P);var R=null,Q=this.noneIdx;if(this.multiSelect&&(Q>-1&&G.indexOf(P,Q)>-1)){R=L(this,P);}if(N!==true){F(this,O,R,P);}},removeSelect:function(N){if(N==null){return ;}if(N.constructor!=Array){N=[N];}F(this,null,L(this,N),N);},_set_selectedIndices:function(P,W,N){var S=this,O=S.selectedIndices;if(S.selectedItems){S.selectedItems={};}var O=S.selectedIndices;if(O==W){return false;}if(!O){O={};S.selectedIndices=O;}if(!W){W={};}var U=S.selectedIndex,T=[],V;for(V in O){if(!W[V]){V=parseInt(V,10);delete O[V];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var Z=[],X=S.items,R=S.itemIdField,Y;for(V in W){if(!O[V]){V=parseInt(V,10);O[V]=true;Z.push(V);S.selectedIndex=V;Y=S.selectedItem=X[V];if(S.selectedItems){S.selectedItems[Y[R]]=Y;}}}if(N!==true){var Q=[];for(V in W){if(O[V]){V=parseInt(V,10);Q.push(V);}}F(S,Z,T,Q);}return(Z.length||T.length);},_set_selectedIndex:function(Q,O,N){var P={};if(O>-1){P[O]=true;}return this._set_selectedIndices("selectedIndices",P,N);},_set_selectedItem:function(Q,P,O){var N=I(this,P);if((N===-1)&&(P!=null)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(P));N=this.items.length-1;}return this._set_selectedIndex("selectedIndex",N,O);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var C=mstrmojo.array;mstrmojo._BindTargetChildren={target:null,targetProps:null,addTabButtons:null,removeTabButtons:null,clearButtons:null,ontargetChange:function E(L){var M=L&&L.valueWas;if(M){var J=this._targetSubs;if(J){M.detachEventListener(J.add);M.detachEventListener(J.rem);M.detachEventListener(J.sel);}this.clearButtons();}var N=this.target;if(N){var I=this.targetProps,H=I&&I.children||"children",F=N[H];this.addTabButtons(F,0);this._onTargetSelChg();if(N.attachEventListener){var G=this.id,K="attachEventListener";this._targetSubs={add:N[K]("addChild",G,"_onTargetAddChild"),rem:N[K]("removeChild",G,"_onTargetRemoveChild"),sel:N[K]("selectedChange",G,"_onTargetSelChg")};}}if(this._ontargetChange){this._ontargetChange();}},_onTargetAddChild:function A(F){var G=F&&F.value;if(G&&G.length){this.addTabButtons(G,F.index);}if(this._postTargetAddChild){this._postTargetAddChild();}},_onTargetRemoveChild:function B(G){var F=G&&G.value;for(var H=((F&&F.length)||0)-1;H>-1;H--){this.removeTabButton(F[H]);}if(this._postTargetRemoveChild){this._postTargetRemoveChild();}},_onTargetSelChg:function D(L){var G=this.targetProps||{},F=this[G.names||"children"],J=function(O,P){if(O.set){O.set("selected",P);}else{O.selected=P;}};if(L){var H=L.valueWas,K=H?C.find(F,"target",H):-1;if(K>-1){J(F[K],false);}}var M=this.target,N=M&&M.selected,I=N?C.find(F,"target",N):-1;if(I>-1){J(F[I],true);}if(this._postTargetSelChg){this._postTargetSelChg();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.shouldEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){if(this.shouldEllipsize){A(this);mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered&&this.shouldEllipsize){this.doEllipsize();}}},this.markupMethods);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo._HasBuilder={postBuildRendering:function B(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function C(){return this.model.getChildren(this.node,false);},buildChildren:function A(E){if(!this.builder||!this.model){return false;}if(this.children&&this.children.length){this.set("children",[]);}var D=this.model,F=this.builder.build(this.getChildren(),D,this.buildConfig);if(!E){this.addChildren(F);}this.builtChildren=true;return(E)?F:true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,f,V,X){var W=b,Z;while(Z=W.match(f)){var c=Z[0],a=c.length,d=true;c=c.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===c){d=false;break;}else{if(c.indexOf(Y)===0){delete U[Y];}}}if(d){U[c]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var d=S.evt2idx,h=S.idx2evt,Z=S.parts;var f=(U>=0)?U:0,b=this.id,W=mstrmojo.all,c=(U>0)?W[h[f-1].context][Z[f-1]]:(S.host?W[S.host]:this.parent),T=Z[f];var V=mstrmojo.array;while(c&&T){if(c.attachEventListener){var g=c[T+"_bindEvents"]||(T+"Change");if(typeof (g)=="string"){g=[g];}var Y=[];for(var a=0,X=g.length;a<X;a++){Y[a]=c.attachEventListener(g[a],b,"_callback");}for(var a=0;a<g.length;a++){d[c.id+"_"+g[a]]=f;}h[f]={context:c.id,evts:g,subs:Y};}c=c[T];T=S.parts[++f];}},_detachChain:function G(S,T){var U=mstrmojo.all,k=S.idx2evt,d=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=k.length;if(Y<b){for(;Y<b;Y++){var Z=k[Y];if(!Z){break;}var W=Z.context,c=U[W],h=Z.evts;if(c&&c.detachEventListener){var m=Z.subs;for(var g=0,V=m.length;g<V;g++){c.detachEventListener(m[g]);}}k[Y]=null;for(var X=0,f=h.length;X<f;X++){delete d[W+"_"+h[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo._HasPopup={openPopup:function B(G,D){var C=!!G&&(typeof (G)==="string")&&!G.match(/\./)&&!!this[G],I=mstrmojo.registry.ref(C?this[G]:G,true);if(I&&I.open){if(C){this[G]=I;}this.disposables.push(I);var F=I.slot&&this[I.slot];if(F){if(I.parent!==this){if(this.addChildren){this.addChildren(I);}else{var H=false,E=I.domNode||I.placeholder;if(E&&typeof (E)==="string"){E=document.getElementById(E);}if(!E){H=true;E=document.createElement("span");I.placeholder=E;}if(H||(E.parentNode!==F)){F.appendChild(E);}}}}I.open(this,D);this._lastOpened=I;}},closePopup:function A(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}};})();(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var E=mstrmojo.hash,H=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=E.clone(I);O.data=M;O.parent=N;return H.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length);for(var N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L;for(var O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}for(var M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.locales");var X=mstrmojo.array,M=mstrmojo.meta.TP,L=mstrmojo.hash,D={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1},B={};for(var R in D){B[D[R]]=true;}var V={};V[D.AQ]="a";V[D.AL]="a";V[D.AC]="a";V[D.AE]="a";V[D.MQ]="m";V[D.MC]="m";V[D.F]="f";V[D.R]="r";V[D.XML]="p";var G={};G[D.MQ]=["not","m","fn","fnt","cs","dmy"];G[D.MC]=["not","m","fn","fnt","m2","m3","p","dmy"];G[D.AE]=["not","a","fn","es","a2","fm2","p"];G[D.AQ]=["not","a","fm","fn","cs"];G[D.AL]=["not","a","fm","fn","cs"];G[D.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];G[D.R]=["not","r"];G[D.F]=["not","f"];G[D.XML]=["not","n","p"];var J={};J[D.MQ]="METRIC_FNS";J[D.MC]="METRIC_FNS";J[D.AQ]="FORM_FNS";J[D.AL]="FORM_FNS";J[D.AC]="FORM_FNS";J[D.AE]="ELEM_FNS";var K={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43},W={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776},P={a:K.ATTR,a2:K.ATTR,m:K.METRIC,m2:K.METRIC,r:K.REPORT,f:K.FILTER,p:K.PROMPT};var Q={};Q[D.MQ]=K.METRIC;Q[D.MC]=K.METRIC;Q[D.AQ]=K.ATTR;Q[D.AL]=K.ATTR;Q[D.AC]=K.ATTR;Q[D.AE]=K.ATTR;Q[D.F]=K.FILTER;Q[D.R]=K.REPORT;var F=function(Y){var H=Y.length,a={};for(var Z=0;Z<H;Z++){var b=Y[Z];a[b.did]=b.n;}return a;},C=function(Z){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){Y.t=Y.tp;}}return Z;},S=function(Z,b){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){if(b){Y.t=b;}else{delete Y.t;}}}return Z;},U=function(Y,a){if(!a){a=[];}a.length=0;for(var Z=0,H=Y.length;Z<H;Z++){a[Z]=Y[Z];}return a;},I={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};METRIC_PROHIBITED={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:D,ETs:B,ET2TGT:V,ET2COND:G,ET2TP:Q,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:K,STP:W,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":W.PROMPT,1:W.PROMPT_LONG,2:W.PROMPT_LONG,3:W.PROMPT_LONG,4:W.PROMPT_DOUBLE,5:W.PROMPT_DOUBLE,6:W.PROMPT_DOUBLE,7:W.PROMPT_DOUBLE,8:W.PROMPT_STRING,9:W.PROMPT_STRING,10:W.PROMPT_STRING,14:W.PROMPT_DATE,15:W.PROMPT_DATE,16:W.PROMPT_DATE,21:W.PROMPT_LONG,22:W.PROMPT_LONG,23:W.PROMPT_STRING,24:W.PROMPT_BOOLEAN,30:W.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0},fnCstCount:function A(Y,H){var Z=this.FN;switch(Y){case Z.BETWEEN:case Z.NOT_BETWEEN:return 2;case Z.IS_NULL:case Z.IS_NOT_NULL:return 0;default:return 1;}},fn_List:function O(Y,H){var Z=this.FN;return Y==Z.IN_LIST||Y==Z.NOT_IN_LIST;},fn_AC_MC:function T(Y,H){var Z=this.FN;return(Y==Z.EQUAL)||(Y==Z.NOT_EQUAL)||(Y==Z.GREATER)||(Y==Z.LESS)||(Y==Z.GREATER_EQUAL)||(Y==Z.LESS_EQUAL);},fnName:function N(c,b,Y,a){var H=this[J[c]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[a]]||H["*"];}var Z=X.find(H,"did",(Y||1)+this.FN_SEP+b);if(Z>-1){return H[Z].n;}return"";},findTargets:function E(g,a,m){if(!m){m={};}if(g){for(var f in P){var w=g[f];if(w){if(!w[M]){w[M]=P[f];}m[w[a]]=w;}}if(g.dmy){var c=this.TP.ATTR,n=this.DMY_TP.ATTR,Z=g.dmy.uts;for(var r=0,Y=(Z&&Z.length)||0;r<Y;r++){var d=Z[r];if(d&&d.utp===n){var b=d.utgt;if(!b.t){b.t=c;}m[b[a]]=b;}}}var H=g.nds,j,p;for(j=0,p=(H&&H.length)||0;j<p;j++){this.findTargets(H[j],a,m);}var o=g.cs,q=o&&o.length;if(q){for(j=0;j<q;j++){this.findTargets(o[j],a,m);}}}return m;},onLocaleUpdated:function(){var Y=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=L.copy(F(Y.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=U(S(Y.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":S(X.filter(Y.Metric,function(Z){return Z.did&&(X.find(METRIC_PROHIBITED["0"],"did",Z.did)<0);}))};H.FORM_FNS={0:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0);})),1:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["1"],"did",Z.did)<0);})),2:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0)&&(X.find(I["1"],"did",Z.did)<0);}))};H.DIMTYLEVELS=U(S(Y.DimtyLevels),H.DIMTYLEVELS);}});mstrmojo.expr.onLocaleUpdated();})();(function(){mstrmojo.requiresCls("mstrmojo.locales");var V=function(){return mstrmojo.locales.datetime;},J=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},isDate:function W(Z,d,Y){var b=this.parseDate(Z,Y);var c=!!(b&&this.doesDateExist(b.month,b.day,b.year));if(d){if(c){var a=this.formatDateInfo(b,V().DATEOUTPUTFORMAT);if(Y){return{match:b.match,formatted:a};}else{return a;}}else{return null;}}else{return !!c;}},formatDateInfo:function P(b,d){if(!d){return"";}var Y=b.day,c=b.month,a=b.year;var Z=d.replace(/dd/g,this.formatInteger(Y,2)).replace(/d/g,Number(Y)).replace(/yyyy/g,Number(a)).replace(/yy/g,this.formatInteger(Number(a)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,V().MONTHNAME_FULL[Number(c)-1]).replace(/\~\~\~\~/g,V().MONTHNAME_SHORT[Number(c)-1]).replace(/\@\@/g,this.formatInteger(c,2)).replace(/\^/g,Number(b.month));return Z;},parseDate:function X(k,d,h){if(k==null){return false;}if(typeof (k)!="string"){k=String(k);}k=J.trim(k);var Y=this.CACHE.PARSEDATE[d?"CONTAINS":"EQUALS"],a=Y[k];if(a||(a===null)){return a;}var Z=null;var g;if(h){g=[h];}else{g=[].concat(V().DATEINPUTFORMATS);g.unshift(V().DATEOUTPUTFORMAT);}for(var b=0,c=g.length;b<c;b++){var f=this._buildRegExp4DateFormat(g[b]),j=f&&k.match(d?f.reContains:f.reEquals);if(j){Z={match:j[0],year:f.yearIndex&&this.fourDigitYear(j[f.yearIndex]),day:f.dayIndex&&parseInt(Number(j[f.dayIndex])),month:f.monthIndex&&this.numericMonth(j[f.monthIndex])};break;}}Y[k]=Z;return Z;},isTime:function H(Z,c,Y){var d=this.parseTime(Z,Y);var b=!!(d&&this.doesTimeExist(d.hour,d.min,d.sec));if(c){if(b){var a=this.formatTimeInfo(d,V().TIMEOUTPUTFORMAT);if(Y){return{match:d.match,formatted:a};}else{return a;}}else{return null;}}else{return !!b;}},parseTime:function I(m,d,j){if(m==null){return false;}if(typeof (m)!="string"){m=String(m);}m=J.trim(m);var Y=this.CACHE.PARSETIME[d?"CONTAINS":"EQUALS"],a=Y[m];if(a||(a===null)){return a;}var Z=null;var h;if(j){h=[j];}else{h=[].concat(V().TIMEINPUTFORMATS);h.unshift(V().TIMEOUTPUTFORMAT);}for(var b=0,c=h.length;b<c;b++){var g=this._buildRegExp4TimeFormat(h[b]),k=g&&m.match(d?g.reContains:g.reEquals);if(k){var f=g.ampmIndex&&k[g.ampmIndex];Z={match:k[0],hour:g.hourIndex&&this.capitalHour(k[g.hourIndex],f),min:g.minIndex&&parseInt(Number(k[g.minIndex])),sec:g.secIndex&&parseInt(Number(k[g.secIndex]))};break;}}Y[m]=Z;return Z;},formatTimeInfo:function Q(b,Z){if(!Z){return"";}var a=!(Number(b.hour)%12)?12:(Number(b.hour)%12),Y=Z.replace(/HH/g,this.formatInteger(b.hour,2)).replace(/H/g,Number(b.hour)).replace(/hh/g,this.formatInteger(a,2)).replace(/h/g,a).replace(/mm/g,this.formatInteger(Number(b.min)||0,2)).replace(/m/g,Number(b.min)||0).replace(/ss/g,this.formatInteger(Number(b.sec)||0,2)).replace(/s/g,Number(b.sec)||0).replace(/a/g,(Number(b.hour)<12)?V().AM_NAME:V().PM_NAME);return Y;},doesTimeExist:function F(d,Z,c){var b=parseInt(d);if(b>=0&&b<=23){var Y=parseInt(Z);if(Y>=0&&Y<=59){if(!c){return true;}var a=parseInt(c);if(a>=0&&a<=59){return true;}}}return false;},capitalHour:function C(Y,Z){Y=parseInt(Number(Y));if(Z&&(Z.match(V().AM_NAME)||Z.match(/AM/i))){return Y%12;}else{if(Z&&(Z.match(V().PM_NAME)||Z.match(/PM/i))){return 12+(Y%12);}else{return Y;}}},isDateAndOrTime:function T(Y,Z){return this.isDateTime(Y,Z)||this.isDate(Y,Z)||this.isTime(Y,Z);},isDateTime:function B(i,Y){var c=this.parseDateAndOrTime(i),g=c&&c.date,b=c&&c.time,f=!!g&&!!b&&this.doesDateExist(g.month,g.day,g.year)&&this.doesTimeExist(b.hour,b.min,b.sec);if(Y){if(f){var Z=this.formatDateInfo(g,V().DATEOUTPUTFORMAT),a=this.formatTimeInfo(b,V().TIMEOUTPUTFORMAT),h=i.indexOf(g.match),d=i.indexOf(b.match);return(d<h)?a+" "+Z:Z+" "+a;}else{return null;}}else{return !!f;}},parseDateAndOrTime:function O(Z,Y,d){var a=this.parseDate(Z,true,Y);var b=J.trim((a&&a.match)?Z.replace(a.match,""):Z),c=this.parseTime(b,false,d);if(!a&&!c){return null;}else{return{date:a,time:c};}},inDateTimeRange:function N(a,c,g){var Z=this.parseDateAndOrTime(a),d=Z&&Z.date,h=Z&&Z.time;if(!d&&!h){return 0;}if(c!=null){var b=this.parseDateAndOrTime(c);if(d&&b&&b.date){var i=this.compareDate(d,b.date);if(i<0){return -1;}else{if(i==0){if(h&&b.time&&(this.compareTime(h,b.time)<0)){return -1;}}}}}if(g!=null){var Y=this.parseDateAndOrTime(g);if(d&&Y&&Y.date){var f=this.compareDate(d,Y.date);if(f>0){return 1;}else{if(f==0){if(h&&Y.time&&(this.compareTime(h,Y.time)>0)){return 1;}}}}}return 0;},compareDate:function A(a,Y){if(a==Y){return 0;}var b=typeof (a)=="string"?this.parseDate(a):a,Z=typeof (Y)=="string"?this.parseDate(Y):Y;if(!b){return -1;}if(!Z){return 1;}return(b.year-Z.year)||(b.month-Z.month)||(b.day-Z.day)||0;},compareTime:function K(Z,Y){if(Z==Y){return 0;}var b=typeof (Z)=="string"?this.parseTime(Z):Z,a=typeof (Y)=="string"?this.parseTime(Y):Y;if(!b){return -1;}if(!a){return 1;}return(b.hour-a.hour)||(b.min-a.min)||(b.sec-a.sec)||0;},compareDateTime:function S(Z,Y){return this.compareDate(Z,Y)||this.compareTime(Z,Y);},compareDateAndOrTime:function D(g,d){if(g==d){return 0;}var Z=typeof (g)=="string"?this.parseDateAndOrTime(g):g,Y=typeof (d)=="string"?this.parseDateAndOrTime(d):d;if(!Z){return -1;}if(!Y){return 1;}var f=Z.date,c=Y.date,b=Z.time,a=Y.time;return this.compareDate(f,c)||this.compareTime(b,a);},_buildRegExp4DateFormat:function M(a){if(!a){return null;}var c=this.REGEXPS.DATES[a];if(!c){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=V().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=V().MONTHNAME_SHORT.join("|");}c=this.REGEXPS.DATES[a]={};c.formatStr=a;var Z=c.reStr=a.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");c.reEquals=new RegExp("^"+Z+"$");c.reContains=new RegExp("^"+Z+"\\b");var d=[{key:"monthIndex",index:a.indexOf("M")},{key:"dayIndex",index:a.indexOf("d")},{key:"yearIndex",index:a.indexOf("y")}];d.sort(function(g,f){return g.index-f.index;});var Y=1;for(var b=0;b<3;b++){c[d[b].key]=d[b].index>-1?Y++:null;}}return c;},_buildRegExp4TimeFormat:function E(b){if(!b){return null;}var d=this.REGEXPS.TIMES[b];if(!d){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[V().AM_NAME,V().PM_NAME,String(V().AM_NAME).toLowerCase(),String(V().PM_NAME).toLowerCase()].join("|");}d=this.REGEXPS.TIMES[b]={};d.formatStr=b;var a=b.replace(/\'\'/g,'"');var f=a.match(/\'(.+?)\'/g);a.replace(/\'(.+?)\'/g,"*");a=a.replace(/([^H|h|m|s|z|Z|a|\s])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/gi,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");for(var c=1,Y=f&&f.length||0;c<Y;c++){a=a.replace(/\*/,f[c]);}a=a.replace(/\"/g,"'");d.reEquals=new RegExp("^"+a+"$");d.reContains=new RegExp(a);var g=[{key:"hourIndex",index:b.search(/h|H/)},{key:"minIndex",index:b.indexOf("m")},{key:"secIndex",index:b.indexOf("s")},{key:"ampmIndex",index:b.indexOf("a")},{key:"zoneIndex",index:b.search(/z|Z/)}];g.sort(function(i,h){return i.index-h.index;});var Z=1;for(var c=0;c<5;c++){d[g[c].key]=g[c].index>-1?Z++:null;}}return d;},doesDateExist:function L(b,Y,Z){var a=new Date(Z,b-1,Y);return Z==a.getFullYear()&&b==a.getMonth()+1&&Y==a.getDate();},fourDigitYear:function R(Z){Z=parseInt(Number(Z));if(!isNaN(Z)){var Y=(V().TWODIGITYEARSTART%100)||0;if(Z>=0&&Z<=Y){Z=2000+Z;}else{if(Z>Y&&Z<100){Z=1900+Z;}}}return Z;},numericMonth:function U(c){var b=parseInt(Number(c)),a=mstrmojo.array;if(!isNaN(b)){return b;}var Y=c&&c.length||0,Z=-1;if(Y){if(Y<=3){Z=a.indexOf(V().MONTHNAME_SHORT,c);}if(Z==-1){Z=a.indexOf(V().MONTHNAME_FULL,c);}}return Z+1;},formatInteger:function G(a,Z){var d=String(a),c=Math.max(Z-d.length,0);if(c>0){var Y=[d];for(var b=1;b<=c;b++){Y.push("0");}d=Y.reverse().join("");}return d;},getFirstDateOfMonth:function(Z,Y){return new Date(Z,Y-1,1);},getDateObject:function(f,Y,c,a,b,Z){f=f||0;Y=Y||1;c=c||1;a=a||0;b=b||0;Z=Z||0;return new Date(f,Y-1,c,a,b,Z);},getDateFromDateInfo:function(Y){return this.getDateObject(Y.date&&Y.date.year,Y.date&&Y.date.month,Y.date&&Y.date.day,Y.time&&Y.time.hour,Y.time&&Y.time.min,Y.time&&Y.time.sec);},getDateJson:function(Y){return{year:Y.getFullYear(),month:Y.getMonth()+1,day:Y.getDate(),hour:Y.getHours(),min:Y.getMinutes(),sec:Y.getSeconds()};},isLeapYear:function(Y){return !(Y%400)||(!(Y%4)&&!!(Y%100));},getDaysOfMonth:function(a,Y){var Z=[31,28,31,30,31,30,31,31,30,31,30,31];if(Y==2&&this.isLeapYear(a)){return 29;}return Z[Y-1];},getPreMonth:function(Z,Y){if(Y===1){return{y:Z-1,m:12};}return{y:Z,m:Y-1};},getNextMonth:function(Z,Y){if(Y===12){return{y:Z+1,m:1};}return{y:Z,m:Y+1};}});})();(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string");var K=mstrmojo.locales,D=mstrmojo.string,M=window.mstrConfig,E=function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},F=function(){return mstrmojo.locales.number.DECIMALSEPARATOR;},I=M.units,L={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},C={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var N=96;String.prototype.reverse=function(){var P="";for(var O=this.length;O>0;--O){P+=this.charAt(O-1);}return P;};mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function G(O){var R=E(),Q=new RegExp("^(-)?[0-9]{1,3}(\\"+R+"[0-9]{3})*$"),P=new RegExp("^(-)?[0-9]+$");return(String(O).indexOf(R)&&Q.test(O))||P.test(O);},isNumeric:function A(R,S){var Q=F(),T=E(),P=new RegExp("^(-)?[0-9]{1,3}(\\"+T+"[0-9]{3})*(\\"+Q+"[0-9]+)?$"),O=new RegExp("^(-)?[0-9]*(\\"+Q+")?[0-9]+$");return(String(R).indexOf(T)&&P.test(R))||O.test(R);},parseInteger:function B(O,P){if(!this.isInt(O)){return Number.NaN;}return parseInt(String(O).replace(E(),""),P);},parseNumeric:function J(O){if(!this.isNumeric(O)){return Number.NaN;}return parseFloat(String(O).replace(E(),"").replace(F(),"."));},inNumericRange:function H(P,Q,O){P=this.parseNumeric(P);O=(O!=null)?this.parseNumeric(String(O)):Number.NaN;Q=(Q!=null)?this.parseNumeric(String(Q)):Number.NaN;if(O!=Number.NaN&&(P>O||isNaN(P))){return 1;}if(Q!=Number.NaN&&(P<Q||isNaN(P))){return -1;}return 0;},convertToUSUnits:function(R,Q,P){var O=R;Q=Q||I;switch(parseInt(Q,10)){case L.CM:O=parseFloat(this.toString(R))/2.54+"";break;case L.MM:O=parseFloat(this.toString(R))/25.4+"";break;case L.PT:O=parseFloat(this.toString(R))/72+"";break;case L.PC:O=parseFloat(this.toString(R))/6+"";break;case L.PX:O=parseFloat(this.toString(R))/N+"";break;}return P?O:this.toLocaleString(O);},convertToLocalUnits:function(R,Q,P){var O;Q=Q||I;switch(parseInt(Q,10)){case L.CM:O=(parseFloat(this.toString(R))*2.54).toFixed(4)+"";break;case L.MM:O=(parseFloat(this.toString(R))*25.4).toFixed(4)+"";break;case L.PT:O=(parseFloat(this.toString(R))*72).toFixed(4)+"";break;case L.PC:O=(parseFloat(this.toString(R))*6).toFixed(4)+"";break;case L.PX:O=(parseFloat(this.toString(R))*N)+"";break;default:O=parseFloat(this.toString(R)).toFixed(4)+"";}return P?O:this.toLocaleString(O);},convertUnits:function(P,Q,O){return this.convertToLocalUnits(Q,this.convertToUSUnits(P,O,true),true);},toLocaleString:function(O){return(O+"").replace(".",F());},toString:function(Q,O){if(O===true){var P=this.getThousandSepRegex();if(P){Q=String(Q).replace(P,"");}}return String(Q).replace(F(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(E().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(Q,P){var O=P;if(P=="."||P=="*"||P=="\\"){O="\\"+P;}return Q.reverse().replace(/(\d{3})/g,"$1"+P).reverse().replace(new RegExp("^(-)?"+O),"$1");},format:function(S,R,V,O){var U="",T=(R>0)?".":"",P=[];V=(V)?V:"";for(var Q=0;Q<R;Q++){P.push("0");}P=P.join("");switch(S){case C.PERCENT:U="0"+T+P+"%";break;case C.SCIENTIFIC:U="0"+T+P+"E+00";break;default:U='"'+V+'"#,##0'+T+P;}return this.formatByMask(U,O);},formatByMask:function(p,AC){var d=String(p).split(";"),Z="",Q=d[0],X="\u00A4";if(isNaN(AC)){return AC;}var t=Q.indexOf("E+"),W=Q.indexOf("%"),g=Q.match(/\".*\"/),h=Q.indexOf("?/?")>-1,n=(t!=-1)?C.SCIENTIFIC:((W!=-1)?C.PERCENT:((g)?C.CURR:h?C.FRACTION:C.FIXED)),c="",z="",a=false,O=new String(AC),V=parseFloat(AC);if(g){c=Q.replace(/\".*\"/,g[0].substring(1,g[0].length-1)).replace(Q.replace(g[0],""),X);}if(V<0){O=O.substring(1,O.length);V=-V,a=true;if(d.length>1){var T=d[1].replace(/\[.*\]/,"");z=T.replace(d[0],X);}}var U=function(j,i){return(i)?i.replace(X,j):"-"+j;};if(n==C.FRACTION){var x,w,AB,b=10,k,f=0,q,y,R,P=false,o;if(p.indexOf("# ")>-1){P=true;}for(x=5;x>0;x--){o="/";for(w=0;w<x;w++){o+="?";}if(p.indexOf(o)>-1){for(w=1;w<x;w++){b*=10;}break;}}if(P){f=Number(Number(V).toFixed(0));V-=f;}y=b/2;AB=-1;q=V*b;for(x=b;x>=2;x--){R=(q*x)/b;R=R-Math.floor(R);R=R*b;if(Math.abs(R-b)<R){R=Math.abs(R-b);}R=R/x;if(R<y){y=R;AB=x;}else{if((R==y)&&(R==0)){y=R;AB=x;}}}k=Math.round(AB*q/b);for(x=AB;x>=2;x--){if((k%x==0)&&(AB%x==0)){k=k/x;AB=AB/x;break;}}if(AB==b){AB=1;k=0;}if(k==0){AB=1;}if(k==AB){if(P){Z=""+(f+1);}else{Z="1";}}else{if(P&&f>0){Z=f+" "+k+"/"+AB;}else{Z=k+"/"+AB;}}}else{if(n==C.SCIENTIFIC){var AD=Math.floor(Math.log(V)/Math.LN10),u=V/Math.pow(10,AD),AE=Q.substring(0,t),Y=AE.indexOf(".");Z+=Number(u).toFixed((Y!=-1)?AE.length-Y-1:0);Z=((a)?U(Z,z):Z)+"E"+((AD>0)?"+":"")+AD;}else{if(n==C.PERCENT){Q=Q.substring(0,Q.length-1);O=String(V*100);}var Y=Q.indexOf("."),S=0;if(Y!=-1){var AF=Q.substr(Y+1,Q.length).match(/\d+/);if(AF&&AF.length>0){S=AF[0].length;}}Z=String(Number(parseFloat(O).toFixed(S)));var AA=Z.split(".");var r=Q.match(/#.+##/);if(r!==null){AA[0]=this.addSeparators(AA[0],E());}Z=AA.join(F());if(n==C.CURR){Z=c.replace(X,Z);}if(n==C.PERCENT){Z+="%";}if(a){Z=U(Z,z);}}}return Z;},generateUniqueID:function(O){var Q="0123456789ABCDEF".split(""),R=[];for(var P=0;P<O;P++){R[P]=Q[0|Math.random()*16];}return R.join("");},countOfDecimals:function(P,Q){var O=String(P);return O.length-(O.indexOf(Q!==undefined?Q:F())+1);}});})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var H=mstrmojo.registry,C=mstrmojo.array,K=mstrmojo.publisher;function M(O,P){if(P){P.parent=O;return H.ref(P);}return null;}function J(O,P){if(P&&P.alias!=null){O[P.alias]=P;}}function D(P,Q){var O=Q.alias;if(Q.parent===P){delete Q.parent;}if((O!=null)&&(P[O]===Q)){delete P[O];}}function E(S,P){var O=P&&P.length,R,Q;if(O){R=[];for(Q=0;Q<O;Q++){var T=M(S,P[Q]);if(!T){continue;}R.push(T);J(S,T);}}return R;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,initChildren:function I(){var O="children",P=this[O];if(!P){return ;}this[O]=null;this._set_children(O,P,true);if(this.postCreateChildren){this.postCreateChildren();}},_set_children:function A(R,P,O){var Q=this.children;if(P!==Q){if(Q){this.removeChildren(null,O);}this.addChildren(P,0,O);}return false;},destroyChildren:function N(R){var Q=this.children,O=(Q&&Q.length)||0,P;if(O){for(P=O-1;P>-1;P--){var S=Q[P];if(S&&S.destroy){S.destroy(R);if(!R){D(this,S);}}}if(!R){Q.length=0;}}},invalidateChildren:function F(){mstrmojo.array.forEach(this.children,function(O){O.invalidate();});},invalidate:function L(){this.invalidateChildren();},addChildren:function G(T,P,Q){if(!T){return T;}var S=T.constructor===Array,O=E(this,S?T:[T]);if(O&&O.length){var R=this.children||[];if(P==null){P=R.length;}this.children=C.insert(R,P,O);if(!Q&&(this.onaddChild||K.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:O,index:P});}}return S?O:(O&&O[0]);},removeChildren:function B(U,Q){var S=this.children,T=U?[U]:(this.children||[]).concat(),P=T.length,O=-1,R;if(P){for(R=P-1;R>-1;R--){D(this,T[R]);}if(U){O=C.removeItem(S,U);}else{if(S){S.length=0;O=0;}}if(!Q&&(this.onremoveChild||K.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:T,index:O});}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;if(this.preHandleEvent){this.preHandleEvent(H);}var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){if(this.postHandleEvent){this.postHandleEvent(H);}C.publish(this.id,M,H);}return H;},attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom,B=A.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function C(E,I,D){var G=E&&E.tree||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,J="mstrmojo-itemwrap",I="&nbsp;",S=mstrmojo.array;function F(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}else{if(X===V){break;}}Y=X;X=Y.parentNode;}}return null;}function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=S.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;}function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function L(m,Z,k,q,W,c,r,o){if(!Z){return{start:0,end:0};}var f=this.wrapperNodes(m),j=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,g=k+q,d=f[0].offsetTop,b;for(var n=1;n<=Y;n++){b=f[j].offsetTop-d+o;if(b<k){X=j;}else{if(b>g){V=j;}}var a=Math.round(Z/Math.pow(2,n+1));j+=(b>k)?-a:a;j=Math.min(Math.max(0,j),Z-1);}return{start:X,end:V};},findWrapper:function K(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function E(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function R(c,V,X,b,W){var Y=this._nd2iw(c,V,X),d,a,f;if(Y){a=this._iw2idx(c,V,Y);d=a;f=this.itemOffsetTop(c,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+f+Z/2){d++;f+=Z;}}else{return c.dropCuePos;}return{left:0,top:f,idx:d,idxActual:a};},getWrapperCss:function(V){return J;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function O(f,b,i,d,a,m){var n=this.itemWrapperPrefix(i),h=this.itemWrapperSuffix,Z=n+this.itemWrapperPrefill+h,Y=[this.markupPrefix],W=1,V=i.selectedIndices||{},p=function o(k,j){for(var q=k;q<j;q++){Y[W++]=n;var r=b.build(i,d,f[q],q);if(V[q]){r=r.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=r;Y[W++]=h;}};var c=(f&&f.length)||0;a=a&&b?Math.min(a,c):0;if(a){p(0,a);}m=m&&b?Math.min(m,c-a):0;var g=c-m;for(var X=a;X<g;X++){Y[W++]=Z;}if(m){p(g,c);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,h,d,o,g,W,b,n){var f=(h&&h.length)||0,m=this.wrapperNodes(X),q=g.itemStatus,V=mstrmojo.css,Z=o.selectedIndices||{};for(var c=W,j=Math.min(b+1,f),a=0;c<j;c++){if(q[c]!==A){m[c].innerHTML=d.build(o,g,h[c],c);if(Z[c]){var Y=m[c].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===n){break;}}}return a;},onadd:function N(f,V,Z,g){if(V&&g){var a=g.value.length,b=this.wrapperNodes(V),d=b[g.index],Y=this.getWrapperCss(f);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=I;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(f,this);}},onremove:function P(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function Q(h,X,c,m){if(X&&m){var d=this.wrapperNodes(X);if(d){var W=mstrmojo.css,n=c.itemStatus,k;for(var b=0,V=m.removed,g=V&&V.length;b<g;b++){k=V[b];if(n[k]){W.removeClass(d[k].firstChild,["selected"]);}}for(var Z=0,f=m.added,Y=f&&f.length;Z<Y;Z++){k=f[Z];if(n[k]){W.addClass(d[k].firstChild,["selected"]);}}}}},_nd2iw:F,_iw2idx:M,toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,f=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=f.clientHeight,d=f.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}f.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,B=mstrmojo.css,D="selected";function G(I,J,K,H,M){var L=M.listHooks[I];if(L&&L.call(M,J,K,H)){return ;}B[((I==="select")?"add":"remove")+"Class"](J,D);}function E(K,J,I){var L=this[K],H=(L)?L.split(J):[];H=H.concat(I.split(J));this[K]=H.join(J);return H.length-1;}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},getItemMarkup:function(I,H){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}">{@n}</{@tag}>';},getItemProps:function C(J,H){var I=!!this.selectedIndices[H];return{tag:"div",sel:I,cls:(I)?D:"",n:J.n||"",style:"",idx:H,addCls:function(K){E.call(this,"cls"," ",K);},addStyle:function(K){E.call(this,"style",";",K);}};},itemRenderer:{render:function(I,H,J){I._renderIdx=H;return mstrmojo.string.apply(J.getItemMarkup(I,H),J.getItemProps(I,H));},select:function(I,J,H,K){G("select",I,J,H,K);},unselect:function(I,J,H,K){G("unselect",I,J,H,K);}},onclick:function A(J){try{var M=J.target||F.eventTarget(J.hWin,J.e),L=F.findAncestorByAttr(M,"idx",true,this.domNode),I=L&&parseInt(L.value,10);if(I!==null&&!isNaN(I)){if(!this.multiSelect){this.singleSelect(I);}else{var H=(this.selectedIndices[I])?"remove":"add";this[H+"Select"](I);}}}catch(K){mstrApp.onerror(K);}}});mstrmojo._IsList.SELECTED_CLS=D;}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var G=mstrmojo.hash,A=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",init:function E(H){this.disposables=[];G.copy(H,this);if(this.postApplyProperties){this.postApplyProperties();}A.add(this);if(this.postCreate){this.postCreate();}},destroy:function B(H){this._super(H);F.forEach(this.disposables,function(I){if(I.destroy){I.destroy(H);}else{if(I.clear){I.clear();}}});this.disposables=[];A.remove(this);}});var C=mstrmojo.Obj;C.free=function D(H){if(H instanceof C){H.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9\_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')},VALIDATOR:{DEMO:function L(c){var b=parseInt(c,10),d=mstrmojo.validation.STATUSCODE;if(b===0||b===1||b>10){return{code:d.VALID};}return{code:d.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function H(b){var d=this.dtp,c=String(b).replace(/[^\d]/g,"");if(c.length<10){return{code:E.INVALID,msg:mstrmojo.desc(9203)};}if(!J.REGEXP.PHONE_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9204)};}return{code:E.VALID};},VALIDATE_ZIPCODE:function G(b){var d="",c=this.dtp;if(!J.REGEXP.US_ZIP.test(b)){if(J.isNumeric(c)||J.isInt(c)){d=mstrmojo.desc(9208);}else{if(J.isString(c)){d=mstrmojo.desc(9206);}}return{code:E.INVALID,msg:d};}return{code:E.VALID};},VALIDATE_EMAIL:function P(b){var c=b.indexOf("@");if(c===-1){return{code:E.INVALID,msg:mstrmojo.desc(9197)};}if(b.substring(c).indexOf(".")===-1){return{code:E.INVALID,msg:mstrmojo.desc(9198)};}return J.REGEXP.EMAIL_ADDRESS.test(b)?{code:E.VALID}:{code:E.INVALID,msg:mstrmojo.desc(9207)};},VALIDATE_SSN:function O(b){var d=this.dtp,c;if(J.isNumeric(d)||J.isInt(d)){c=String(b).replace(/[^\d]/g,"");if(c.length!=9){return{code:E.INVALID,msg:mstrmojo.desc(9209)};}}if(!J.REGEXP.SOCIAL_SECURITY_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9210)};}return{code:E.VALID};}},isInt:function(b){return B[b]==1;},isNumeric:function(b){return B[b]==2||B[b]==5;},isString:function(b){return B[b]==3;}};var V=window.mstrConfig,I=V.listSep,W=mstrmojo.expr,K=W.DTP,J=mstrmojo.validation,F=J.TRIGGER,E=J.STATUSCODE,X=mstrmojo.css,Q=mstrmojo.num,N=mstrmojo.string,a=mstrmojo.date,B={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,21:2,22:2,23:3,24:4,25:3,30:5};function D(k,m){var h=k.dtp,j=k.constraints,o=j.allowedFormatChars?j.allowedFormatChars:"",g=(B[h]==1),b=(B[h]==2),d=(B[h]==6),n=mstrmojo.locales.number.THOUSANDSEPARATOR,f=mstrmojo.locales.number.DECIMALSEPARATOR,i;if(g){if(!k._intRegExp){o+="0-9-"+(k.isList?I:"")+n;k._intRegExp=new RegExp("[^"+o+"]");}i=k._intRegExp;}if(b){if(!k._numericRegExp){o+="0-9-"+(k.isList?I:"")+f+n;k._numericRegExp=new RegExp("[^"+o+"]");}i=k._numericRegExp;}if(d){}return !!i&&i.test(m);}function Y(k,n){var h=k.dtp,j=k.constraints,g=(B[h]==1),b=(B[h]==2),d=(B[h]==6),f=j.min,m=j.max,i;if(f==undefined&&m==undefined){return false;}if(g||b){return Q.inNumericRange(n,f,m)!==0;}if(d){return a.inDateTimeRange(n,f,m)!==0;}return false;}function Z(c,b){return !Q.isNumeric(b);}function A(f,c){var d=(f.dtp===K.DATE),b=(f.dtp===K.TIME);return(d?!a.isDate(c):(b?!a.isTime(c):!a.isDateAndOrTime(c)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:K.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function S(b){this._super(b);if(!this.constraints){this.constraints={};}var d=this.constraints;if(!("trigger" in d)){d.trigger=F.NONE;}},_set_value:function(h,d){var f=this.value,c=(f!==d);if(c){this.value=d;var g=this.constraints.trigger,b=(g&F.VALUESET)>0;if(b){this.validate(d);}}return c;},validate:function M(){var d=(this.value!==null&&this.value!==undefined)?this.value:"",h=this.isList?d.split(I):[d],g,c,j;for(var f=0,b=h.length;f<b;f++){g=this.doValidation(h[f]);c=(g.code>E.VALID);if(c){if(b>1){g.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",h[f]?h[f]:" ");}break;}}j=c?"onInvalid":"onValid";if(!c&&this.autoFormat){this.format();}this.set("validationStatus",g);if(this[j]){this[j](g);}},format:function T(){var h=this.dtp,d=(B[h]==6);if(!d){return ;}var k=mstrConfig.listSep,o=this.value||"",c=this.isList?o.split(k):[o],n=h===14,m=[],b,f=mstrmojo.locales.datetime;for(var g=0,j=c.length;g<j;g++){o=c[g];b=a.parseDateAndOrTime(o);if(b){if(n&&b.date){m.push(a.formatDateInfo(b.date,f.DATEOUTPUTFORMAT));}else{m.push((b.date?a.formatDateInfo(b.date,f.DATEOUTPUTFORMAT):"")+" "+(b.time?a.formatTimeInfo(b.time,f.TIMEOUTPUTFORMAT):""));}}}this.set("value",m.join(k));},isValid:function R(){var b=this.validationStatus;if(!b){this.validate();}return this.validationStatus.code===E.VALID;},clearValidation:function U(){this.set("validationStatus",{code:E.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function C(p){var m=this.constraints,n=m.regExp,f=m.validator,b={id:this.id,code:E.VALID,msg:""},k=this.dtp,j=(B[k]==1),d=(B[k]==2||B[k]==5),g=(B[k]==3),h=(B[k]==6),i=N.isEmpty(p),o=String(p).length;err="",_VAL=mstrmojo.locales.validation;if(this.required&&i){b.code=E.INVALID_EMPTY;b.msg=_VAL.requiredFieldError;return b;}p=N.trim(p);if(!i&&D(this,p)){if(j){err=_VAL.integerDataType;}if(d){err=_VAL.numericDataType;}if(h){err=_VAL.dateDataType;}b.code=E.INVALID_CHAR;b.msg=_VAL.invalidCharError.replace("#",err);return b;}if(!i&&h&&A(this,p)){b.code=E.INVALID_BAD_DATESTRING;b.msg=_VAL.invalidDateStringError;return b;}if(!i&&(d||j)&&Z(this,p)){b.code=E.INVALID_BAD_NUMERICFORMAT;b.msg=_VAL.invalidNumericFormatError;return b;}if(!i&&(j||d||h)&&Y(this,p)){b.code=E.INVALID_OUTOFRANGE;if(m.min!=null&&m.max!=null){err=_VAL.outofRangeError.replace("#","").replace("##",m.min).replace("###",m.max);}else{if(m.min!=null){err=_VAL.noLessMinError.replace("##",m.min).replace("#","");}else{if(m.max!=null){err=_VAL.noGreaterMaxError.replace("###",m.max).replace("#","");}}}b.msg=err;return b;}if(g&&m.minLen!=null&&m.maxLen!=null){if(o<m.minLen||o>m.maxLen){b.code=E.INVALID;b.msg=mstrmojo.desc(9211).replace(/#/,m.minLen).replace(/##/,m.maxLen);return b;}}if(n&&!n.test(p)){b.code=E.INVALID_REGEX;b.msg=mstrmojo.desc(9205);return b;}var q=f&&f.apply(this,[p]);if(q){b.code=q.code;b.msg=q.msg;return b;}return b;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip");var B=mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",init:function A(D){this._super(D);var E=this.parent;if(!E||E.hasInitBindings){this.initBindings();}},destroy:function C(D){if(this.hasRendered){this.unrender(D);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn});B.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};B.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};B.heightMarkupMethod=function(){this.domNode.style.height=this.height||"";};B.widthMarkupMethod=function(){this.domNode.style.width=this.width||"";};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var Z=mstrmojo.hash,f=mstrmojo.array,d=mstrmojo.boxmodel,b=mstrmojo.dom;function A(i,k,h){var j=i.listSelector;if(j){j[k](i,i.itemsContainerNode,h);}}function K(i,h){var j=i.lastPagePos;if(!j||j.dragId!==h){j=d.offset(i.itemsContainerNode);j.dragId=h;i.lastPagePos=j;var k=i.scrollboxNode;i.lastScrollPos={left:k.scrollLeft,top:k.scrollTop,width:k.clientWidth,height:k.clientHeight};}}function N(k,o,i){var j=o&&o.node;if(j===k.dropCueNode||j===k.dropCueNode.firstChild){return k.dropCuePos;}var m=k.listMapper;var h=m&&m.whereDrop(k,k.itemsContainerNode,j,o.pos,{left:k.lastPagePos.left-k.lastScrollPos.left,top:k.lastPagePos.top-k.lastScrollPos.top,width:k.lastScrollPos.width,height:k.lastScrollPos.height});var n=k.dropCuePos;return((i!==false)&&n&&h&&(n.idx===h.idx)&&(n.left===h.left)&&(n.top===h.top))?n:h;}var g="attachEventListener";function C(i,h){if(i.makeObservable){h=h||[];if(!h[g]){mstrmojo.hash.make(h,i.itemsScriptClass||mstrmojo.Arr);}}return h;}function G(i,h){if(h&&h[g]){i._sub_its=h;i._sub_add=h[g]("add",i.id,"preadd");i._sub_rmv=h[g]("remove",i.id,"preremove");}}function F(h){if(h._sub_its){var i=mstrmojo.publisher;i.unsubscribe(h._sub_add);i.unsubscribe(h._sub_rmv);delete h._sub_add;delete h._sub_rmv;delete h._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var i=this.dropCueNode,h=i&&i.style;if(!h){return ;}var k=this.dropCuePos,j=!!k;if(j){h.left=k.left+"px";h.top=k.top+"px";}h.display=j?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Y(n){this._super(n);this.items=this.initItems(this.items);var m=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,p=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(m||j||(k>-1)||p){this.initSelections(m,j,k,p);}if(this.postInitItems){this.postInitItems();}},initItems:function H(h){return C(this,h);},preBuildRendering:function V(){var m=this.listBuilder,p=m.newContext(this);this.ctxtBuilder=p;var i=this.markupSlots,k=!!(this.renderOnScroll&&this.renderBlockSize&&i&&i.scrollboxNode),j=this.items,h=(j&&j.length)||0,n=k?this.firstRenderBlockSize:h,o=k?this.firstRenderBlockSize:0;this._eros=k;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(j,m,this,p,n,o).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function D(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}G(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var i=mstrmojo.all[q];i.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var k=0,j=["itemsEffect","scrollEffect"],h=j.length;k<h;k++){var p=j[k],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function W(m){F(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var j=0,k=["itemsEffect","scrollEffect"],h=k.length;j<h;j++){var n=this[k[j]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function O(j,h,i){if(j!==false){j=true;}if(this.paused===!!j){return ;}this.paused=!!j;if(j){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(h,i);}},onscroll:function J(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var h=this;this._fillTmr=self.setTimeout(function(){h.fill();h=null;},50);}}if(this._super){this._super();}},fill:function a(h,m){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var n=(this.items&&this.items.length)||0;if(!n){if(m){m();}}else{var j=this.scrollboxNode,o=this.itemsContainerNode,k=mstrmojo.boxmodel.offset(o,j),q=this.listMapper,p=q.findScrollRange(o,n,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||j.scrollTop,j.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||j.scrollLeft,j.clientWidth,k.left,k.top);if(this.fillAt(p.start,p.end)){if(h){h();}var i=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[i].fill(h,m);},100);}else{if(m){m();}}}},fillAt:function L(j,i){var h=this.listMapper;if(h){return h.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,j,i,this.renderBlockSize);}else{return false;}},add:function Q(i,h){if(!i||!i.length){return -1;}var j=this.items;if(h==null){h=Z.min(this.selectedIndices,false,true);if(h!==null&&h!==undefined){h++;}}if(h==null||h===-1){h=(j&&j.length)||0;}if(j&&j.add){j.add(i,h);}else{this.set("items",j?f.insert(j.concat(),h,i):i);}return h;},preadd:function B(k){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,k);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onadd(this,k);}if(this._eros){this.onscroll();}else{var m=k.index,h=k.value.length;this.fillAt(m,m+h-1);}}if(this.onadd){this.onadd(k);}if(this._super){this._super(k);}},remove:function T(h){if(h==null){return -1;}if(h.constructor!==Array){return this._remove(h);}var k=this.items;if(k){var j;if(k.remove){for(j=h.length-1;j>-1;j--){k.remove(h[j],1);}}else{k=k.concat();for(j=h.length-1;j>-1;j--){k.splice(h[j],1);}this.set("items",k);}return h[0];}return -1;},_remove:function T(j){var i=this.items;if(!i||(j==null)){return -1;}var h;if(!isNaN(j)){h=j;}else{h=this.itemIndex(j);}if(h>-1){if(i.remove){i.remove(h,1);}else{i=i.concat();i.splice(h,1);this.set("items",i);}}return h;},duplicate:function X(n,i,j){var k=this.items,h=-1;if(!k||(n==null)){return -1;}if(!isNaN(n)){if(i===null||i===undefined){i=n+1;}n=k[n];}else{if(i===null||i===undefined){i=this.itemIndex(n)+1;}}if(n){var m;m=Z.copy(j,Z.clone(n));h=this.add([m],i);}return h;},preremove:function M(i){if(this.hasRendered){var k=this.listMapper;if(k){k.onremove(this,this.itemsContainerNode,this.ctxtBuilder,i);}var j=this.listBuilder;if(j){j.onremove(this,this.ctxtBuilder,i);}var h=this.listSelector;if(h){h.onremove(this,i);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(i);}if(this._super){this._super(i);}},move:function R(m,r){function p(t,i){return(r>=t)&&(r<=t+i);}var q=(this.items&&this.items.length)||0;if(r===-1||r==null||isNaN(r)){r=q;}else{r=Math.min(r,q);}var k,h,o,n;if(m.constructor===Array){h=m;o=m;n=(h&&h.length)||0;if(p(m[0],m.length)){return false;}k=f.get(this.items,m);}else{if(typeof (m)==="object"){k=[m];n=1;h=this.itemIndex(k[0]);o=[h];if(p(h,1)){return false;}}else{h=m;o=[m];n=1;if(p(h,1)){return false;}k=[this.items[h]];}}for(var j=0;j<n;j++){if(o[j]<=r){r--;}}if(k[0]!=null){this.remove(h);this.add(k,r);}return true;},itemIndex:function E(h){if(h==null){return -1;}var i=this.itemIdField;return i?f.find(this.items,i,h[i]):f.indexOf(this.items,h);},prechange:function S(k){if(this.hasRendered){var j=[this.listBuilder,this.listMapper];for(var m=0,h=j.length;m<h;m++){var n=j[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,k);}}}},makeObservable:false,_set_items:function I(o,h){var m=this.items;h=this.initItems(h);this.items=h;if(m!==h){var k=this,j=function(){if(k.autoHide){k.set("visible",!!(h&&h.length));}k=null;},i=this.hasRendered;if(i){this.refresh(j);}else{j();}}return m!==h;},premousedown:function c(h){A(this,"premousedown",h);},premouseup:function P(h){A(this,"premouseup",h);},scrollTo:function U(i){var h,j=this.listMapper;if(j&&j.toItem){if(!isNaN(i)){h=i;}else{h=this.itemIndex(i);}if(h>=0){j.toItem(this,h);}}},draggable:false,getDragData:function(m){K(this,m.id);var j=N(this,m.src),i=j&&j.idxActual;if((i>-1)&&this.selectedIndices[i]){var k=this.sortSelectedIndices(),h=f.get(this.items,k)||[];switch(h.length){case 1:return Z.copy(h[0],{html:h[0][this.itemDisplayField],index:k[0]});case 0:return null;default:return Z.copy({html:h.length+" selections",indices:k},h);}}},dropZone:false,ondragenter:function(h){K(this,h.id);this.set("dropCuePos",N(this,h.tgt));},ondragover:function(h){this.set("dropCuePos",N(this,h.tgt));},ondragleave:function(h){this.set("dropCuePos",null);},ondragstart:function(h){if(!(h&&h.src&&h.src.data)){return false;}},allowCopy:false,ondragend:function(k){var i=k&&k.tgt,h=i&&i.widget;if(h===this){}else{if(this.tree&&h&&h.tree===this.tree){if(!this.allowCopy||!b.ctrlKey(i.hWin,i.e)){var j=k.src&&k.src.data;if(j&&(j.indices||(j.index!==null))){this.remove(j.indices||j.index);}}}}},ondrop:function(q){var u=q&&q.src,p=u&&u.data;if(p){var j=N(this,q.tgt,false),r=j&&j.idx,k=(p&&p.constructor===Array);var n=this.items;r=Math.min(r,(n&&n.length)||0);var t=true;if(u.widget===this){t=this.move(this.sortSelectedIndices(),r);}else{this.add(k?p:[p],r);}if(t){var o=k?p.length:1,h={};for(var m=0;m<o;m++){h[r+m]=true;}this.set("selectedIndices",h);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._ListSelections");mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onheightChange:function(){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width;}}},buildRendering:function E(){this.itemsHtml="";var F=this.items&&this.items.length;if(F){this.itemsHtml=this._buildItemsMarkup(0,F-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,_buildItemsMarkup:function(F,I,R,G,U,H){var V=[],N=0;V[N++]=R||"";var L=this.itemRenderer,Q=L&&L.render;if(Q&&typeof (Q)=="function"){var T=U||"",S=H||"",K=this.items,M=(K&&K.length)||0,O=this;for(var J=F,P=Math.min(I+1,M);J<P;J++){V[N++]=T;V[N++]=Q(K[J],J,O);V[N++]=S;}}V[N++]=G||"";return V;},onselectionChange:function A(P){if(!P){return ;}var M=this.itemRenderer;if(!M){return ;}var I=M.unselect,L=this.items||[],Q=P.removed,H,G;if(I&&Q){for(var J=0,R=Q.length;J<R;J++){H=Q[J];G=this._getItemNode(H);if(G){I(G,L[H],H,this);}}}var F=M.select,O=P.added;if(F&&O){for(var K=0,N=O.length;K<N;K++){H=O[K];G=this._getItemNode(H);if(G){F(G,L[H],H,this);}}}if(this.onchange){this.onchange();}},onselect:function B(F){if(this.makeSelection&&F.idxs&&F.idxs.length){var G=this._getItemNode(F.idxs[0]);this.makeSelection({selIdx:F.idxs[0],selItem:G});}},autoHide:false,init:function D(F){this._super(F);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},_getItemNode:function(F){var G=this.itemsContainerNode;return(G&&G.childNodes[F])||null;},_set_items:function C(I,F){if(this.autoHide){this.set("visible",!!(F&&F.length));}var H=this.items;this.items=F;if(H!=F){var G=this.hasRendered;if(G){this.unrender();}this.clearSelect();if(G){this.render();}return true;}else{return false;}return H!=F;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget");var L=["(",")","{","}","-","+","*","/","<",">","|","~",","],J={" ":true,"@":true},H=null;function E(P){if(!H){H={};var O,N;for(O=0,N=L.length;O<N;O++){H[L[O]]=true;}}return H[P];}function C(P){if(!P){return false;}var N=P.length,O,Q;for(O=0;O<N;O++){Q=P.charAt(O);if(E(Q)||J[Q]){return true;}}return false;}function F(N){return C(N)?"["+N+"]":N;}mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,null,{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}"></span>',active:false,markupMethods:{ondataChange:function(){var N=this.data;if(N.v===","){this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(N.v))+"&nbsp;";}else{this.domNode.innerHTML=mstrmojo.string.encodeHtmlString(String(N.v));}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["invalid"],N.sta===-1);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},isMstrO:function K(){return !!this.data.oi||!!this.data.rfd;},brackets:F,length:function B(){return this.data.v.length;},isDelimiter:function A(){return this.data.isDelimiter||(this.length()===1&&E(this.data.v));},split2Tokens:function G(Q){var P=this.data,O=P&&P.v,R=O.substring(0,Q),N=O.substring(Q);return[{v:R,isNew:true},{v:N,isNew:true}];},mergeTo:function D(O){var Q=this.data,P=Q&&Q.v,N=O.data.v;return{v:P+N,isNew:true};},brackets:F,setItemInfo:function I(N){var O=this.data;O.v=this.brackets(N.n);O.oi=N;O.sta=1;O.isNew=true;this.set("data",O);this.paint();},spliceContent:function M(T,R,O){var S=this.data,Q=S&&S.v,U=Q.substring(0,T);R=(R===null||R===undefined)?(Q.length-T):R;var N=Q.substring(T+R),P=U+(O||"")+N;S.v=P;S.isNew=true;S.sta=1;delete S.oi;this.set("data",S);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=E;mstrmojo.ME.MetricToken.brackets=F;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var F=mstrmojo.css,C={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchWidget=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchWidget",quickSearch:false,placeholderText:"",markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" placeholder="{@placeholderText}" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}sbClear" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;}},onsearch:function H(){},onclear:function G(){},prekeyup:function E(K){var I=K.hWin,M=K.e||I.event;var L=this.getSearchPattern(),J=(L.length===0);F.toggleClass(this.clearNode,["show"],!J);if(this.quickSearch){this[J?"clearSearch":"onsearch"](L);}var N=C[M.keyCode];if(this["on"+N]){this["on"+N](K);}},onEnter:function B(){this.onsearch(this.getSearchPattern());},getSearchPattern:function D(){return mstrmojo.string.trim(this.inputNode.value);},preclick:function A(J){var I=J.hWin,K=J.e||I.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbSearch":this.onsearch(this.getSearchPattern());break;case"sbClear":this.clearSearch();break;}},clearSearch:function(){var I=this.getSearchPattern();this.inputNode.value="";F.removeClass(this.clearNode,["show"]);if(this.onclear){this.onclear(I);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});})();mstrmojo.ToolSeparator=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ToolSeparator",markupString:'<div class="mstrmojo-ToolSeparator {@cssClass}" style="{@cssText}"></div>',markupSlots:{},markupMethods:{}});(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click /><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",text:null,markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" mstrAttach:click></div>',cssDisplay:"block",markupMethods:{ontextChange:function(){this.domNode.innerHTML=(this.text!=null)?this.text:"";},oncssTextChange:function(){this.domNode.style.cssText=(this.cssText!=null)?this.cssText:"";},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},autoHide:false,_set_text:function A(D,B){if(this.autoHide){this.set("visible",(B!=null)&&(B!==""));}var C=this.text;this.text=B;return C!=B;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Widget");var A=mstrmojo.dom;mstrmojo.InlineEditBox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.InlineEditBox",text:null,editMode:false,allowEdit:true,okSave:false,emptyHint:"Enter your text here.",markupString:'<div id="{@id}" class="mstrmojo-InlineEditBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-InlineEditBox-text">{@text}</div><div class="mstrmojo-InlineEditBox-edit"><input type="text" class="mstrmojo-InlineEditBox-input" mstrAttach:keyup/><img class="mstrmojo-InlineEditBox-ok" src="../images/1ptrans.gif" title="Save"/><img class="mstrmojo-InlineEditBox-cancel" src="../images/1ptrans.gif" title="Cancel"/></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.lastChild;},inputNode:function(){return this.domNode.lastChild.firstChild;},okNode:function(){return this.domNode.lastChild.childNodes[1];},cancelNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=this.text||this.emptyHint||"";},oneditModeChange:function(){var G=this.editMode,D=this.domNode,C=this.textNode,F=this.editNode;mstrmojo.css.toggleClass(D,["edit"],G);if(G){C.style.display="none";F.style.display="block";var C=this.inputNode,E=C.style;C.value=this.text||"";E.width=(D.clientWidth-(this.okSave?(this.okNode.offsetWidth+this.cancelNode.offsetWidth):0))+"px";E.height=D.clientHeight+"px";C.focus();if(C.createTextRange){var H=C.createTextRange(),B=C.value.length;H.move("character",B);H.select();}}else{C.style.display="block";F.style.display="none";}},onokSaveChange:function(){var B=this.okSave?"inline":"none";this.okNode.style.display=B;this.cancelNode.style.display=B;},onallowEditChange:function(){mstrmojo.css.toggleClass(this.domNode,["disable"],!this.allowEdit);}},preclick:function(B){var D=B.e,C=A.eventTarget(B.hWin,D);if(C===this.okNode){this.save();}else{if(C===this.cancelNode){this.cancel();}else{if(this.editMode!=this.allowEdit){this.set("editMode",this.allowEdit);}}}},prekeyup:function(B){var D=B.e,C=D.keyCode||D.charCode;if(C==mstrmojo.Enum_Keys.ENTER){this.save();}else{if(C==mstrmojo.Enum_Keys.ESCAPE){this.cancel();}}},_attachEvents:function(){var B=this;if(this.editMode){if(!this._save_handler){this._save_handler=function(){var C=A.eventTarget(self,arguments[0]);if(!A.contains(B.domNode,C,true,document.body)){B.save();}};}A.attachEvent(document.body,"mousedown",this._save_handler);}else{if(this._save_handler){A.detachEvent(document.body,"mousedown",this._save_handler);}}},postBuildRendering:function(){if(this._super){this._super();}this._em_sub=this.attachEventListener("editModeChange",this.id,"_attachEvents");},destroy:function(){this.detachEventListener(this._em_sub);if(this._super){this._super();}},save:function(){this.set("text",this.inputNode.value);this.set("editMode",false);if(this.onSave){this.onSave();}},cancel:function(){this.set("editMode",false);if(this.onCancel){this.onCancel();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var D=mstrmojo.dom,E=mstrmojo.hash,B=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){B[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){B[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.textNode.innerHTML=this.text;},onwidthChange:function(){var F=this.width;if(F){this.domNode.style.width=F;}}},oniconClassChange:function C(G){if(this.hasRendered&&this.domNode){var F=G.valueWas,H=G.value;this.domNode.className=this.domNode.className.replace(F,"")+" "+H;}},onclick:mstrmojo.emptyFn,ontouchend:function A(F){this.onclick(F);}});mstrmojo.Button.newIconButton=function(H,K,I,F,J){var G={scriptClass:"mstrmojo.Button",title:H,cssClass:K,text:"",onclick:I};if(F){G.bindings=F;}E.copy(J,G);return G;};mstrmojo.Button.newInteractiveButton=function(G,H,J,I){var F={scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",text:G,glowClass:"glow"};if(H){F.onclick=H;}if(J&&(D.isFF||D.isWK)){E.copy({onmousedown:function(){B.applyShadow(this.domNode,0,0,10,J);},onmouseup:function(){B.removeShadow(this.domNode);}},F);}E.copy(I,F);return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css;function E(F,H){var G={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[F];if(typeof H==="object"){mstrmojo.hash.copy(H,G);}return G;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",width:"100px",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}sbClear" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(1049,"Match case")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;},optionNode:function(){return this.domNode.rows[0].cells[3].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function D(F){var H=this;var G=H.searchTimer;if(G){window.clearTimeout(G);}H.searchTimer=window.setTimeout(function(){H.onkeyupDelayed(F);delete H._searchTimer;},parseInt(F.e.keyCode||F.e.charCode,10)===13?0:H.searchDelay);},onkeyupDelayed:function A(G){var F=G.hWin,I=G.e||F.event;var H=mstrmojo.string.trim(this.inputNode.value);if(this.clearNode){C.toggleClass(this.clearNode,["show"],H.length>0);}this.showTaskError=false;this.click2Search=false;if(H.length==0||this.autoSubmit||this.onEnter&&I.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(G){var F=G.hWin,I=G.e||F.event,K=I.target||I.srcElement,J=K&&K.id;switch(J.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var H=this.optionNode.parentNode.style;H.display=H.display=="block"?"none":"block";}break;case"sbSearch":if(this.onEnter&&I.keyCode===13){this.onEnter();}this.showTaskError=true;this.click2Search=true;this._onsearch();break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbClear":this.clearSearch();break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.clearNode,["show"]);var G=this.searchCache,F=this.rootID;if(G&&G[F]){G[F][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache();var G=this.searchCache[this.rootID];if(G){var F=G[B]||"";this.inputNode.value=F;if(F.length>0){if(F.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(G){var F=this.contentWidget||this;F.set("items",G[0]);if(this.supportIncFetch){var H=G[1],J=G[2],I=this.blockCount;F.set("ifs",{np:Math.floor(H/I)+((H%I>0)?1:0),cp:Math.floor(J/I)+((J%I>0)?1:0)});}},_onsearch:function(F){this.getRootID();this._setupCache();var I=mstrmojo.string.trim(this.inputNode.value);if(I.length===0){F=true;}var J=this.token[this.taskId];if(J.test(I)){}if(this.searchPattern==I&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var K=this.rootID,H=this.searchCache[K];if((I.length<this.minSearchLength&&!this.click2Search)&&!F){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(H[K]);this.searchPattern=I;}}else{this.searchPattern=I;H[B]=this.searchPattern;var G=this.filterCache(I,H,F);if((this.click2Search||G===null)&&!F){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(G);}}H[B]=I;},_setupCache:function(){var H=this.searchCache,G=this.rootID;if(H&&!H[G]){H[G]=H[G]||{};var F=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];H[G][G]=[F,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var F=this,G=E.apply(this,[this.taskId]);G.searchPattern=this.searchPattern;callback={success:function(H){var I=H.items||H.es||[];I=[I,H.totalSize||H.sz||0,H.blockBegin||H.bb];mstrmojo.all[F.id].searchCache[F.rootID][(G.searchPattern.length==0?F.rootID:F.buildIndex(G.searchPattern))]=I;F._notifyContentWidget(I);},failure:function(H){if(F.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+H.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(F.spinnerNode){F.spinnerNode.style.display="none";}if(F.postFetch){F.postFetch();}}};if(this.sessionState!==undefined){G.sessionState=this.sessionState;}mstrmojo.xhr.request(this.method,this.path,callback,G,undefined,this.XServer,this.baseParams);},fetchPage:function(F){this.blockBegin=F*this.blockCount+1;this.fetch();},filterCache:function(K,G,N){var J=G&&G[N?this.rootID:this.buildIndex(K)];if(J){return J;}var H=this.token[this.taskId];if(H.test(K)||this.totalSize>this.blockCount){return null;}var M=K.replace(/.$/,"");J=G&&G[this.buildIndex(M)];while(J===undefined&&(M=M.replace(/.$/,"")).length>0){J=G&&G[this.buildIndex(M)];}if(J!==undefined){if(J[1]>this.blockCount){return null;}var L=J[0],F=[];for(var I in L){if(L[I].n.search(new RegExp(K,this.matchCase?"":"i"))>-1){F.push(L[I]);}}this.totalSize=F.length;return(G[this.buildIndex(K)]=[F,F.length,this.blockBegin].concat());}return null;},buildIndex:function(F){if(F.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?F.toUpperCase():F+"::0";},init:function(F){if(this._super){this._super(F);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.clearNode,["show"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo._HasChildren");var F=mstrmojo.publisher;mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",init:function I(L){this._super(L);if(this.children){this.initChildren();}var M=this.parent;if(!M||M.hasInitBindings){this.initBindings();}},destroy:function G(L){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(L);},unrender:function J(N){var O=this.children,L=(O&&O.length)||0,M;for(M=L-1;M>-1;M--){O[M].unrender(true);}this._super(N);},postBuildRendering:function K(){var L=this._super?this._super():undefined;if(L!==false){this.renderChildren();L=true;}return L;},renderChildren:function C(){var N=this.children,L=(N&&N.length)||0,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render(null);}}},childRenderCheck:function H(M){if(M&&!M.hasRendered){var L=M.slot||this.defaultChildSlot;return !!this[L];}return false;},addChildren:function E(O,M,N){var L=this._super(O,M,N);if(L){this.childRenderOnAddCheck(L);}return L;},removeChildren:function A(S,O){var R=S?[S]:(this.children||[]),L=R.length,P;for(P=L-1;P>-1;P--){var N=R[P],M=N&&N.domNode;if(M){var Q=this[(N.slot||this.defaultChildSlot)];if(M.parentNode===Q){Q.removeChild(M);}}}return this._super(S,O);},childRenderOnAddCheck:function B(N){if(this.hasRendered&&N){var L=N.length,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render();}else{if(O&&O.hasRendered){this.onchildRenderingChange(O);}}}}},preserveChildDomOrder:true,onchildRenderingChange:function D(M){var T=M&&M.domNode;if(!T){return ;}var N=this.defaultChildSlot,W=M.slot||N,O=this[W],L=this.children;if(!O){if(T.parentNode){T.parentNode.removeChild(T);}}else{if(T.parentNode===O){return ;}if(!this.preserveChildDomOrder){O.appendChild(T);}else{var P,R;for(R=L.length-1;R>=0;R--){var U=L[R];if(U===M){break;}if(W===(U.slot||N)){var V=U.domNode;if(V&&V.parentNode===O){P=V;}}}if(P){O.insertBefore(T,P);}else{O.appendChild(T);}}}if(F.hasSubs(this.id,"childrenRendered")){var S=L.length,Q;for(Q=0;Q<S;Q++){if(!L[Q].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var P=mstrmojo.dom,B=mstrmojo.css,M=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var U=document.createElement("tr"),V=this.data,Y=this._cmSource,R,S;U.id=this.id;U.className="mstrmojo-ContextMenuItem "+(Y.isSeparatorItem(V)?"separator":Y.item2textCss(V));var W=this,X=function(){W.handleMouseOver();},T=function(){W.handleMouseOut();},Q=function(){W.handleClick();};P.attachEvent(U,"mouseover",X);P.attachEvent(U,"mouseout",T);P.attachEvent(U,"click",Q);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-text";if(Y.isSeparatorItem(V)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=V.itemWidget?"&nbsp":V[this.itemField];}R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return U;},buildRendering:function K(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){B.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){B.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=P.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function C(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function E(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function L(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function O(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,T=this._subMenu.domNode,S=T.offsetHeight,R=T.offsetWidth,W=P.windowDim(),V=P.position(T,false),U=P.position(T,true);if((V.x+R+M)>W.w){Q.set("left",(P.position(this.domNode,true).x-R)+"px");}if((V.y+S+M)>W.h){Q.set("top",(W.h-S-M+(U.y-V.y))+"px");}},handleMouseOver:function N(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function D(){this._cmSource.closeMenuTree();},handleClick:function F(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}else{}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(J,M,F,K){var H=J.domNode,L=H.offsetWidth;var D=!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5,I=K?1:-1,E=parseInt(L,10)*I,G=D?500:0;A(0,-E,G,{target:F,duration:G,preStart:function(){this.target.style.overflowY="hidden";}});A(E,0,G,{target:M,preStart:function(){this.target.style.overflowY="auto";}});if(J.waiting){A(0,-E,G,{widget:J,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.CheckBox");var D=mstrmojo.hash,E=mstrmojo._FormatDefinition;var C=function(F){return mstrmojo.hash.copy(F,{scriptClass:"mstrmojo.TextBox",alias:"decimalPlaces",bindings:{m:F.modelBinding,value:function(){return this.m.DecimalPlaces||"2";},category:function(){var G=this.m.Category;this.onkeyup();}},onkeyup:function(G){if(/^\d{1,2}$/.test(this.value)){var N=this.m.DecimalPlaces,I=this.value;this.m.DecimalPlaces=I;if(N!=I&&this.negative){var J=this.parent[this.negative],L;if(J&&J.refreshFormatList){J.refreshFormatList();}else{L=mstrmojo.hash.clone(E[this.negative]);if(L){var M=I>0?".":"",H=M;for(var K=0;K<Math.min(I,E.MaxNegativeDidigts);K++){M+=K%9;H+="0";}for(K=0;K<L.length;K++){L[K].n=L[K].n.replace(/\.\d{2}/g,M);L[K].f=L[K].f.replace(/\.\d{2}/g,H);}J.set("items",L);}}}}}});},A=function(F){return mstrmojo.hash.copy(F,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",itemMarkupFunction:function(I,G,J){var H=I.r?"color: red":"";return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="'+H+'">'+I.n+"</div></div>";},selectionPolicy:"reselect",bindings:{m:F.modelBinding,selectedIndex:function(){var G=mstrmojo.array.find(this.items,"v",this.m.NegativeNumbers);if(G===-1){G=mstrmojo.array.find(this.items,"f",this.m.Format);}this.singleSelect(G);return G==-1?3:G;},category:function(){var G=this.m.Category;this.onchange();}},onchange:function(G){if(this.parent.idx==mstrmojo.array.find(E.Category,"v",this.m.Category)&&this.selectedItem){this.m.NegativeNumbers=this.selectedItem.v;this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}},onmChange:function(G){if(this.m){var L=this.m.DecimalPlaces;if(L!=2){var J=mstrmojo.hash.clone(E[this.alias]);if(J){var K=L>0?".":"",H=K;for(var I=0;I<Math.min(L,E.MaxNegativeDidigts);I++){K+=I%9;H+="0";}for(var I=0;I<J.length;I++){J[I].n=J[I].n.replace(/\.\d{2}/g,K);J[I].f=J[I].f.replace(/\.\d{2}/g,H);}this.set("items",J);}}}},postCreate:function(){this.onmChange();}});},B=function(F){return mstrmojo.hash.copy(F,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList "+F.alias,itemMarkupFunction:function(H,G,I){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+H.n+"</div></div>";},selectedIndex:0,bindings:{m:F.modelBinding,selectedIndex:function(H){var G=mstrmojo.array.find(this.items,"v",this.m.Format);return G===-1?0:G;},category:function(){var G=this.m.Category;this.onchange();}},onchange:function(G){if(this.parent.idx==mstrmojo.array.find(E.Category,"v",this.m.Category)){this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}}});};mstrmojo.NumberFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.NumberFormatter",cssClass:"mstrmojo-NumberFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7940),cssClass:"category",cssText:"font-weight: bold"},{slot:"1,0",scriptClass:"mstrmojo.List",alias:"numberCategory",cssClass:"mstrmojo-FormatEditor-numberCategory",items:E.Category,selectionPolicy:"reselect",bindings:{m:"this.parent.parent.model",selectedIndex:function(){var G=this.m.Category,F=mstrmojo.array.find(this.items,"v",(G==="pru"?-2:G));return(F==-1)?0:F;}},onchange:function(F){if(this.m){this.m.set("Category",this.selectedIndex===0?"pru":this.selectedItem.v);}}},{slot:"1,1",scriptClass:"mstrmojo.Container",alias:"numberSubpanelContainer",width:"300px",markupString:'<div id={@id} class="mstrmojo-FormatEditor-numberPanel-subpanel {@cssClass}"><div class="mstrmojo-FormatEditor-numberPanel-subpanel-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},postBuildRendering:function(){var F=mstrmojo.Container.prototype.postBuildRendering.apply(this);this.parent.numberCategory.singleSelect(this.parent.numberCategory.selectedIndex);return F;},children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:0,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:"&nbsp;",slot:"0,0"}],bindings:{visible:'this.parent.parent.parent.model.Category=="pru"',category:function(){var G=this.parent.parent.parent.model,F=this.parent.parent.parent.model.Category;if(G&&this.idx==mstrmojo.array.find(E.Category,"v",F)){G.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:1,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:"&nbsp;",slot:"0,0"}],bindings:{visible:"this.parent.parent.parent.model.Category==9",category:function(){var G=this.parent.parent.parent.model,F=this.parent.parent.parent.model.Category;if(G&&this.idx==mstrmojo.array.find(E.Category,"v",F)){G.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item fixed",idx:2,rows:3,cols:2,layout:[{cells:[{},{}]},{cells:[{},{}]},{cells:[{colSpan:2}]}],bindings:{visible:"this.parent.parent.parent.model.Category==0"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",negative:"FixedNegative",alias:"FixedDecimalPlaces",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"1,0"},A({modelBinding:"this.parent.parent.parent.parent.model",items:E.FixedNegative,refreshFormatList:function(){var G=this.parent,J=G&&G.FixedDecimalPlaces,M=G&&G.ThousandSeparator;if(!J||!M){return ;}var H=J.value||0,Q=mstrmojo.hash.clone(E.FixedNegative),F=M.checked,P=H>0?".":"",O=P,N;for(var L=0,K=Math.min(H,E.MaxNegativeDidigts);L<K;L++){P+=L%9;O+="0";}for(var I=0;I<Q.length;I++){N=Q[I].n.replace(/\.\d{2}/g,P);if(!F){N=N.replace("1,234","1234");}Q[I].n=N;N=Q[I].f.replace(/\.\d{2}/g,O);if(!F){N=N.replace(/#,##/g,"###");}Q[I].f=N;}this.set("items",Q);},alias:"FixedNegative",slot:"1,1"}),{scriptClass:"mstrmojo.ImageCheckBox",alias:"ThousandSeparator",label:mstrmojo.desc(2049),cssText:"width:auto;",bindings:{m:"this.parent.parent.parent.parent.model",checked:function(){var F=this.m.ThousandSeparator;if(F==null){F=-1;}return parseInt(F,10)!==0;}},oncheckedChange:function(){if(this.m&&this.parent.idx==mstrmojo.array.find(E.Category,"v",this.m.Category)){this.m.ThousandSeparator=this.checked?-1:0;this.parent.FixedNegative.refreshFormatList();}},slot:"2,0"}]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item currency",idx:3,rows:4,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==1"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",negative:"CurrencyNegative",alias:"currencyDecimal",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2047),slot:"1,0"},{scriptClass:"mstrmojo.TextBox",alias:"currencySymbol",maxLength:5,bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.CurrencySymbol||mstrmojo.desc("2369");},category:function(){var F=this.m.Category;this.onkeyup();}},onkeyup:function(F){this._update();},onvalueChange:function(){this._update();},_update:function(){if(this.m){var G=this.m.CurrencySymbol;this.m.CurrencySymbol=this.value;var F=this.parent.CurrencyNegative;if(F&&(G!=this.value)){F.refreshFormatList();}}},slot:"1,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2048),slot:"2,0"},{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",alias:"CurrencyPosition",items:E.CurrencyPosition,itemMarkupFunction:function(G,F,H){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+G.n+"</div></div>";},bindings:{m:"this.parent.parent.parent.parent.model",selectedIndex:function(){var F=mstrmojo.array.find(E.CurrencyPosition,"v",this.m.CurrencyPosition);return(F==-1?0:F);},category:function(){var F=this.m.Category;this.onchange();}},onchange:function(F){if(this.m){this.m.CurrencyPosition=this.selectedItem.v;var G=this.parent.CurrencyNegative;if(G){G.refreshFormatList();}}},slot:"2,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"3,0"},A({modelBinding:"this.parent.parent.parent.parent.model",items:E.CurrencyNegative,refreshFormatList:function(){var N=this.parent,I=N&&N.currencyDecimal,M=N&&N.CurrencyPosition,J=N&&N.currencySymbol;if(!I||!M||!J){return ;}var L=I.value||0,H=M.selectedIndex||0,G=J.value||"",G=(H==2?G+" ":(H==3?" "+G:G)),K=mstrmojo.hash.clone(E.CurrencyNegative),X=L>0?".":"",V=X,P;for(var W=0,T=Math.min(L,E.MaxNegativeDidigts);W<T;W++){X+=W%9;V+="0";}var O=mstrConfig.decimalSep,F=mstrConfig.thousandsSep;for(var S=0;S<K.length;S++){var Q=K[S].n,U=K[S].f;if(H==1||H==3){P=U.split(";");for(var R=0,T=P.length;R<T;R++){P[R]=P[R].replace(/(\"\$\")(.*)/g,"$2$1");}Q=Q.replace(/(\$)(.*)/g,"$2$1");U=P.join(";");}Q=Q.replace(/\$/g,G).replace(/\.\d{2}/g,X);U=U.replace(/\$/g,G).replace(/\.\d{2}/g,V);K[S].n=Q.replace(/,/,F).replace(/(\d{2,3})\./,"$1"+O);K[S].f=U.replace(/,/,F).replace(/(\d{2,3})\./,"$1"+O);}this.set("items",K);},alias:"CurrencyNegative",slot:"3,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Date",idx:4,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==2"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:E.Date,alias:"Date",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Time",idx:5,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==3"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:E.Time,alias:"Time",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item percentage",idx:6,rows:2,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==4"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",negative:"PercentNegative",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"1,0"},A({modelBinding:"this.parent.parent.parent.parent.model",items:E.PercentNegative,alias:"PercentNegative",slot:"1,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Fraction",idx:7,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==5"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:E.Fraction,alias:"Fraction",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item scientific",idx:8,rows:1,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},C({slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"})],bindings:{m:"this.parent.parent.parent.model",visible:"this.m.Category==6",category:function(){if(this.m&&this.idx==mstrmojo.array.find(E.Category,"v",this.m.Category)){this.m.set("Format","0.00E+00");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item custom",idx:9,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==7"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2133),slot:"0,0"},{scriptClass:"mstrmojo.TextBox",alias:"custom",value:"",bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.Format;}},onvalueChange:function(){if(this.m&&this.parent.idx==mstrmojo.array.find(E.Category,"v",this.m.Category)){this.m.Format=this.value;}},slot:"0,1"}]}]}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K[I].slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.FieldSet=mstrmojo.declare(mstrmojo.Container,null,{legend:null,scriptClass:"mstrmojo.FieldSet",markupString:'<fieldset id="{@id}" class="mstrmojo-FieldSet {@cssClass}" style="{@cssText}"><legend class="{@cssClass}-legend">{@legend}</legend></fieldset>',markupSlots:{legendNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode;}},markupMethods:{onlegendChange:function(){this.legendNode.innerHTML=mstrmojo.string.encodeHtmlString((this.legend!=null)?this.legend:"");},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}" ><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},buildRendering:function A(){var C=this.placeholder;if(this._super()){if(!this.parent&&!C){var B=this.placeNode||document.body;B.appendChild(this.domNode);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.css;function I(R){var Q=R.inputNode;var P=(R.value!=null)?String(R.value):"";if(P!==Q.value){Q.value=P;}if(Q.mstrmojoEmpty){C.removeClass(Q,[R.emptyClass]);Q.mstrmojoEmpty=null;}}function E(Q){var P=Q.inputNode;P.value=Q.emptyText||"";C.addClass(P,[Q.emptyClass]);P.mstrmojoEmpty=true;}function G(Q){var P=Q.inputNode;if(P){Q.readingDom=true;Q.set("value",P.value);Q.readingDom=false;}}var M={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",autoComplete:true,autoCorrect:true,autoCapitalize:true,placeholderText:"",markupString:'<input id="{@id}" placeholder="{@placeholderText}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css.toggleClass(this.inputNode,"disabled",!this.enabled);},onvalueChange:function(){var P=this.value,Q=(P===null)||(P==="");if(Q){if(!this.hasFocus){E(this);}else{this.inputNode.value="";}}else{I(this);}},ontooltipChange:function(){this.domNode.title=this.tooltip;},onreadOnlyChange:function(){this.inputNode.readOnly=this.readOnly;}},emptyText:"",emptyClass:"mstrmojo-empty",postBuildRendering:function B(){this._super();var P=this.inputNode;P.setAttribute("autocomplete",this.autoComplete?"on":"off");P.setAttribute("autocorrect",this.autoCorrect?"on":"off");P.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function O(){this.inputNode.focus();},prefocus:function J(){this.hasFocus=true;I(this);},preblur:function D(){window.setTimeout(function(){},200);this.hasFocus=false;G(this);var P=this.value;if((P===null||P==="")&&this.emptyText){E(this);}},prekeyup:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);var S=M[R.keyCode];if(this["on"+S]){this["on"+S](Q);}},preinput:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);},prepaste:function N(){this.delaySetValue(this);},precut:function L(){this.delaySetValue(this);},delaySetValue:function K(P){window.setTimeout(function(){G(P);},100);},setInvalidState:function H(P){mstrmojo.css.addClass(this.inputNode,["err"]);if(P){this.domNode.setAttribute("title",P);}},cleanUp:function F(){this.inputNode.value="";mstrmojo.css.removeClass(this.domNode,["err"]);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(E,D){if(!A){var F=this.itemField;A=this._super(E).replace(">{@n}<",' title="{@'+F+'}">{@'+F+"}<");}return A;},getItemProps:function C(F,D){var E=this._super(F,D),G=this.itemField;E[G]=F[G];return E;},onclick:function B(D){this._super(D);var E=this.parent,G=E.opener;G.suggestionShown=false;var F=this.selectedItem;if(F){G.handleSuggestionItemSelect(F);}E.close();},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems"}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(E){var D=E[this.itemType],C=E[this.itemSubType],A=" t"+D,B=(D==1||D==3)?" st"+C:"",F=E[this.itemISC]?'class="mstrmojo-ListIcon isc"':"";return'<span class="mstrmojo-ListIcon '+A+B+'"><span '+F+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length;if(A>0){for(var B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+E.substring(0,G)+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc"});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(F,D){var E=this.items;this.items=D||[];return E!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var E=this.value,D=this.selectedIndex,G=this.items||[],H,F;if(D===undefined||(E!==null&&(D===-1||(D!==-1&&G[D]&&G[D][this.itemIdField]!==E)))){D=mstrmojo.array.find(G,this.itemIdField,E);D=(D>-1)?D:this.defaultSelection;this.selectedIndex=D;}else{if(E===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=H=G[this.selectedIndex];if(H){F=H[this.itemField];}else{F=this.defaultText||"";}this.set("text",F);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function(E){var F=this.value,D=-1;if(F!==null){D=mstrmojo.array.find(this.items,this.itemIdField,F);}if(D>-1){this.selectedItem=this.items[D];this.selectedIndex=D;}},togglePopup:function C(){if(this.popupToBody){var G=mstrmojo.dom.position(this.popupNode,true),F=this.popupRef,D={left:Math.round(G.x)+"px",top:Math.round(G.y)+"px"};if(!F.hasRendered){delete F.slot;D.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(D,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var E=this.popupRef.domNode;if(E){if(this.fixWidth){E.style.width=(this.domNode.offsetWidth-2)+"px";}else{E.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(D){this.togglePopup();},unrender:function B(D){var E=this.popupRef;if(this.popupToBody&&E.hasRendered){E.unrender(false);}if(this._super){this._super(D);}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var F=this.opener,E=F&&F.popupZIndex,G=F&&F.popupCssClass||"",D=this.domNode;if(E){D.style.zIndex=E;}if(G){mstrmojo.css.addClass(D,[G]);}if(F&&F.fixWidth){mstrmojo.css.addClass(D,["fix-width"]);}if(F&&F.fixHeight){mstrmojo.css.addClass(D,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(F,D,E){return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+(F[E.itemCSS]||"")+'" title="'+F[E.itemField]+'">'+(F[E.itemField]||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var F=this.parent,G=F.visible,D=F.opener,E=this.selectedItem;if(!D||!E||!G){return ;}D.set("value",E[this.itemIdField]);}}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo._BindTargetChildren","mstrmojo.List");mstrmojo.TabNameList=mstrmojo.declare(mstrmojo.List,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabNameList",isStrip:true,targetProps:{names:"items"},makeObservable:true,postchange:function A(){var E=this.selectedIndex,F=this.target;if(F&&E!=null&&parseInt(E,10)!==-1){F.set("selected",F.children[E]);}},addTabButtons:function B(E,M){var J=this.targetProps||{},Q=J.childTitle||"n",G=this.itemIdField||"v",F=this.itemField||"n",P=[],I=(this.items)?this.items.length:0,L=(E&&E.length)||0,K;for(K=0;K<L;K++,I++){var O=E[K],H=O[Q];if(H){var N={target:O};N[F]=H;N[G]=I;P.push(N);}}if(P.length){this.add(P,M);}},removeTabButton:function D(F){var E=mstrmojo.array.filter(this.items,function(G){return(G.target===F);},{max:1});if(E&&E[0]){this.remove(E[0]);}},clearButtons:function C(){this.remove(this.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList");var A=function(O,P){var N=O.parent.opener,F=N&&N.showDesc,M=N&&N.showPath,E=P[O.itemField];var L=mstrmojo.string.escape4HTMLText,Q="";if(M){var I=P.anc&&P.anc.items,K=I&&I.length;if(K>0){for(var H=0;H<K-1;H++){Q+=I[H].n+" > ";}Q+=L(I[K-1].n);}else{if(P.path){Q+=P.path;}}}Q+=(Q.length==0?"":" > ")+L(E);if(F){var J=P[O.itemDescField],G=120;if(J){Q+="\r\n\r\n"+L(J.substring(0,G)+(J.length>G?"...":""));}}return Q;};var C=function(E,F,G){if(!F||!G){return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var H=F.path||F.getAttribute("path");if(H){return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(I){var J=D(I.toString())||"";G.path=J;F.path=1;F.title=A(E,G);}},{taskId:"getObjectDetails",objectID:G.did,objectType:G.t,sessionState:mstrApp.sessionState},undefined);},200);};var D=function(G){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(G,"text/xml");}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(G);}var K=xmlDoc.getElementsByTagName("path")[0],H=K.childNodes,J="";if(H){for(var F=0,E=H.length;F<E;F++){var I=H[F].childNodes&&H[F].childNodes[0];if(I){J+=mstrmojo.string.escape4HTMLText(I.nodeValue)+(F<E-2?"> ":"");}}}return J;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",itemDescField:"desc",getItemMarkup:function(G,E){var F=this.parent.opener,H=A(this,G);return'<div class="mstrmojo-suggest-text '+((F&&F.item2textCss(G))||"")+'" idx="'+E+'" title="'+H+'">'+F.getHighlightedText(F.getSearchPattern(),mstrmojo.string.escape4HTMLText(G[this.itemField]))+"</div>";},getItemProps:function B(F,E){return{};},onmouseover:function(F){var I=this.parent.opener;if(I&&I.showPath){var G=mstrmojo.dom.eventTarget(F.hWin,F.e),E=G.getAttribute("idx"),H=E!=null?this.items[E]:null;if(H&&H.t>-1){C(this,G,H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.TristateCheckBox","mstrmojo.FieldSet","mstrmojo.Table");var A=mstrmojo.hash,B=mstrmojo._FormatDefinition;mstrmojo.AlignmentFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.AlignmentFormatter",cssClass:"mstrmojo-AlignmentFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){A.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"textAlignment",cssClass:"mstrmojo-FormatEditor-textAlignment",legend:mstrmojo.desc(2065),children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3691),slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Horizontal,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Horizontal"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Horizontal=this.value;}},slot:"0,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3692),slot:"1,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Vertical,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Vertical"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Vertical=this.value;}},slot:"1,1"}]}]},{scriptClass:"mstrmojo.FieldSet",alias:"textControl",cssClass:"mstrmojo-FormatEditor-textControl",legend:mstrmojo.desc(2884),children:[{alias:"TextWrap",scriptClass:"mstrmojo.TristateCheckBox",text:mstrmojo.desc(2070),checked:false,grayed:false,pr:"TextWrap",bindings:{m:"this.parent.parent.model",checked:function(){return this.m[this.pr]==-1;},grayed:function(){return(typeof this.m[this.pr]=="undefined")||this.m[this.pr]=="pru";}},oncheckedChange:function(C){if(this.m){this.m.set(this.pr,this.checked?-1:0);}}},{scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(5159)},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.TextDirection,bindings:{m:"this.parent.parent.parent.model",value:"this.m.TextDirection"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.TextDirection=this.value;}},slot:"1,1"}]}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox");mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur ></textarea>',maxLength:256,markupSlots:{inputNode:function(){return this.domNode;}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncssClassChange=function(){this.domNode.className="mstrmojo-TextArea "+(this.cssClass||"");};},onkeydown:function(D){var C=(this.value&&this.value.length)||0;if(this.maxLength<=C){this.isDeleteKeys=D.e.keyCode===8||D.e.keyCode===46;this.isArrowKeys=D.e.keyCode===37||D.e.keyCode===38||D.e.keyCode===39||D.e.keyCode===40;var B=(this.domNode.selectionEnd!==undefined)?(this.domNode.selectionEnd-this.domNode.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!B){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var A=this.domNode;A.blur();window.setTimeout(function(){A.focus();},1);}mstrmojo.dom.preventDefault(window,D.e);return false;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate");var A=mstrmojo.css,D=mstrmojo.validation,H=D.TRIGGER,G=D.STATUSCODE,E=mstrmojo.TextBox.prototype.markupMethods;mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,markupMethods:{onvisibleChange:E.onvisibleChange,onvalueChange:E.onvalueChange,onenabledChange:E.onenabledChange,onreadOnlyChange:E.onreadOnlyChange,ontooltipChange:E.ontooltipChange,onvalidationStatusChange:function(){var M=this.validationStatus;if(!M){return ;}var L=this.inputNode,J=(M.code>G.VALID),K=this.constraints.invalidCssClass;A.toggleClass(L,K?K:["mstrmojo-TextBox-ErrValidation"],J);if(J){L.setAttribute("title",M.msg);}else{if(this._original_tooltip!==undefined&&this._original_tooltip!==null){L.setAttribute("title",this._original_tooltip);}}}},postBuildRendering:function I(){if(this._super){this._super();}this._original_tooltip=this.inputNode.title;},prekeyup:function B(J){if(this._super){this._super(J);}var L=(this.constraints.trigger&H.ONKEYUP)>0;if(L){if(this.validationDelay>0){if(this._valDelayTimer){window.clearTimeout(this._valDelayTimer);}if(!this._validateHandler){var K=this;this._validateHandler=function(){K.validate();if(K._valDelayTimer){window.clearTimeout(K._valDelayTimer);delete K._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(this._validateHandler,this.validationDelay);}else{this.validate();}}},preinput:function(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONKEYUP)>0;if(K){this.validate();}},preblur:function F(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONBLUR)>0;if(K){this.validate();}},clearValidation:function C(){if(this._super){this._super();}var K=this.inputNode,J=this.constraints.invalidCssClass;A.removeClass(K,J?J:["mstrmojo-TextBox-ErrValidation"]);K.title=this._original_tooltip;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.FieldSet","mstrmojo.Table");var D=mstrmojo.hash,B=mstrmojo.num;var C=function(E){return mstrmojo.hash.copy(E,{scriptClass:"mstrmojo.ValidationTextBox",maxLength:6,dtp:4,min:0,max:100,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{m:E.modelBinding,value:function(){var F=this.m[this.pr];return F==null?"":this._PT2UserUnits(F).replace(/([\.,][1-9]{1,})0{1,}$/,"$1").replace(/\.$/,".0").replace(/,$/,",0");}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy({onvalueChange:function(){this.inputNode.value=this.value;}},mstrmojo.hash.copy(this.markupMethods));},onValid:function(){this.m[this.pr]=this._UserUnits2PT(this.value);},_PT2UserUnits:function(F){return B.toLocaleString(B.convertToLocalUnits(B.toString(F),mstrApp.units));},_UserUnits2PT:function(F){return B.toLocaleString(B.toString(B.convertToUSUnits(F,mstrApp.units)));}});};var A=function(E,F){return{scriptClass:"mstrmojo.Label",text:E,slot:F};};mstrmojo.PaddingFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.PaddingFormatter",cssClass:"mstrmojo-PaddingFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"padding",cssClass:"mstrmojo-FormatEditor-padding",legend:mstrmojo.desc(2883),children:[{scriptClass:"mstrmojo.HBox",cssClass:"paddingBox",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3528),"0,0"),C({pr:"LeftPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(mstrApp.unitsLabel,"0,2"),A(mstrmojo.desc(3526),"1,0"),C({pr:"TopPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(mstrApp.unitsLabel,"1,2")]},{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3529),"0,0"),C({pr:"RightPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(mstrApp.unitsLabel,"0,2"),A(mstrmojo.desc(3527),"1,0"),C({pr:"BottomPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(mstrApp.unitsLabel,"1,2")]}]}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.StackContainer");mstrmojo.TabContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.TabContainer",markupString:'<div id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><div class="mstrmojo-tabcontainer-tabs"></div><div class="mstrmojo-tabcontainer-stack"></div><div></div></div>',markupMethods:{onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{top:function(){return this.domNode.childNodes[0];},stack:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1];},bottom:function(){return this.domNode.childNodes[2];}},addChildren:function A(D,K,H){var G=this._super(D,K,H);var B=this.children,F=B.length;if(F>=2){var L,I,E;for(E=0;E<F;E++){var C=B[E],J=C&&C.slot;if(!L&&C.isStrip){L=C;}else{if(!I&&(!J||J==="stack")){I=C;}}if(L&&I){L.set("target",I);break;}}}return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var H=mstrmojo.func.composite,F=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(O){if(O){return ;}var M=this.visible,N=M?"block":"none";this.editorNode.style.display=N;if(this.modal){this.curtainNode.style.display=N;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function I(){var M;var N=this.buttons;if(N&&!this.btnHbox){for(M in N){N[M].cssClass="mstrmojo-Editor-button";}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:N},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function D(){var M=this.placeholder;if(this._super()){if(!this.parent&&!M){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function G(){var M=this.id;return function(){var N=mstrmojo.all[M];N.resizeDialog();N.positionDialog();};},postBuildRendering:function B(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var M=this._resizeHandler=this.getResizeHandler();F.attachEvent(window,"resize",M);}this.resizeDialog();this.positionDialog();this.domNode.focus();return true;},resizeDialog:function J(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function E(){var N=this,R=N.curtainNode,M=document.body,P=document.documentElement,Q=R.style,O=N.curtainPosition;Q.width=Math.max(M.clientWidth,P.scrollWidth)+"px";if(O&&O.h){Q.height=O.h+"px";}else{Q.height=Math.max(M.clientHeight,P.scrollHeight)+"px";}if(O&&O.y){Q.top=O.y+"px";}N.raiseEvent({name:"resizeCurtain"});},positionDialog:function K(){if(!this.left||!this.top){var M=this.editorNode;F.center(M);if(this.alignment==="top"){M.style.top="10px";}}},destroy:function(N){var M=this._resizeHandler;if(M){F.detachEvent(window,"resize",M);}this._super(N);}});if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.confirm=function A(P,N,O){var Q="mojoConfirmx9",M=function(){mstrmojo.all[Q].destroy();};mstrmojo.array.forEach(N,function(R){var S=R.onclick;R.onclick=S?H([M,S]):M;});mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:N,children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.alert=function C(P,M,O){var Q="mojoAlertx9";try{mstrmojo.all[Q].destroy();}catch(N){}mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),function(){mstrmojo.all.mojoAlertx9.destroy();if(M){M();}},"#666666")],children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.toast=function L(Q,O){var R="mojoToast9",P,N=O||3000;try{mstrmojo.all[R].destroy();}catch(M){}mstrmojo.insert({id:R,scriptClass:"mstrmojo.Label",cssClass:"toastCss",text:Q}).render();P=mstrmojo.all[R].domNode;document.body.appendChild(P);F.bottomCenter(P);window.setTimeout(function(){mstrmojo.all[R].destroy();},N);};mstrmojo.mask={};mstrmojo.mask.show=function(){mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});mstrmojo.mask.win.render();document.body.appendChild(mstrmojo.mask.win.domNode);};mstrmojo.mask.hide=function(){mstrmojo.mask.win.destroy();};}}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.TabContainer");mstrmojo.TabListContainer=mstrmojo.declare(mstrmojo.TabContainer,null,{scriptClass:"mstrmojo.TabListContainer",markupString:'<table id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><tr><td class="mstrmojo-tabcontainer-tabs {@listCssClass}"></td><td class="mstrmojo-tabcontainer-stack {@containerCssClass}"></td><td class="{@bottomCssClass}"></td></tr></table>',markupSlots:{top:function(){return this.domNode.firstChild.childNodes[0].childNodes[0];},stack:function(){return this.domNode.firstChild.childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.firstChild.childNodes[0].childNodes[1];},bottom:function(){return this.domNode.firstChild.childNodes[0].childNodes[2];}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.List","mstrmojo.Button","mstrmojo.color","mstrmojo.Model","mstrmojo.Table","mstrmojo._CanValidate","mstrmojo.ValidationTextBox");var H=mstrmojo.color;function I(U,Q,M,N,T,L,P,S){var R={target:Q,onEnd:function(){if(L){L();}},props:{}};R.props[M]={ease:P,start:parseInt(N,10),stop:parseInt(T,10),suffix:"px"};R=mstrmojo.hash.copy(S,R);var O=new mstrmojo.fx.AnimateProp(R);O.play();}var B=function(P){if(P===null){return ;}var O=mstrmojo.locales.color.userPalette;var L=O.length;if(L==8){O.remove(L-1,1);}O.add([{n:P,v:P}],0);var M="";for(var N=0;N<8;N++){if(O[N]&&O[N].v){M+=O[N].v+",";}}M=M.replace(/,$/,"");mstrmojo.xhr.request("GET",mstrConfig.taskURL,{success:function(Q){},failure:function(Q){mstrmojo.alert(Q.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"userPalette\u001E"+M});};var J=function(L,M,N){return{scriptClass:"mstrmojo.Label",text:L+":",cssClass:M,slot:N};};var E=function(L,O,N,M){return mstrmojo.hash.copy(M||{},{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",cssText:"padding: "+(mstrmojo.dom.isIE7?"0":"1px"),bindings:{value:function(){return this.parent.parent.colorModel[N]||"0";}},onValid:function(){this.parent.parent.colorModel.set(N,this.value);},min:0,max:255,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(Q){var R=this.min,P=this.max;Q=parseInt(Q,10);if(Q>=R&&Q<=P){return{code:mstrmojo.validation.STATUSCODE.VALID};}else{return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7883).replace("##",R).replace("###",P)};}}},slot:O});};var G=function(L){return mstrmojo.hash.copy({scriptClass:"mstrmojo.Slider",alias:L+"Slider",cssClass:"sc "+L,isHoriz:true,width:130,cssBkBW:0,items:[],getItemTooltip:function(){return this.items[this.min].n;},postCreate:function(){for(var M=0;M<{r:256,g:256,b:256,s:101,v:101,h:360}[L];M++){this.items.push({n:M,v:M});}},bindings:{selectedIndex:function(){return this.parent.parent.colorModel[L]||"0";}},onselectedIndexChange:function(){this.parent.parent.colorModel.set(L,this.selectedIndex);if(this.domNode){this.min=this.max=this.selectedIndex;this.typeHelper.updateThumb();}},select:function(M){this.set("selectedIndex",M);},slot:"1,3"});};var A=function(M,L,N){return'<div mstridx="'+L+'" class="mstrmojo-ColorPicker-item '+N.itemCssClas+'" style="background-color:'+M.v+';" type="button" title="'+M.n+'"></div>';};var D=mstrmojo.hash.copy({findIndex:function(L,N,M){return M.getAttribute("mstridx")||-1;}},mstrmojo.hash.copy(mstrmojo.ListMapper));var F=function(L,M){return mstrmojo.hash.copy(M,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ColorPicker-list",itemMarkupFunction:A,listMapper:D,onchange:null,_onchange:function(){this.set("selectedColor",this.selectedItem.v);L.set("selectedColor",this.selectedItem.v);if((L.isSimple||!L.expanded)&&L.onChange){L.onChange();}},onselectedColorChange:function(){L.colorModel.set("hex",this.selectedColor);}});};mstrmojo.ColorPicker=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ColorPicker",markupString:'<div id={@id} class="mstrmojo-ColorPicker {@cssClass} {@shadowCssClass}" style="height:{@height}; width:{@width};{@cssText}"><div class="mstrmojo-ColorPicker-box"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onexpandedChange:function(L){this.domNode.className=this.domNode.className.replace(/ expanded/,"")+(this.expanded?" expanded":"");}},useAnimate:true,useShadow:true,isSimple:false,showNoColor:true,showMoreColors:true,showGradients:true,showUserPalette:true,height:"168px",fullHeight:"326px",width:"158px",fullWidth:"366x",expanded:false,onexpandedChange:function(M){var P=this.domNode,L=parseInt(this.height,10),O=parseInt(this.width,10),N=parseInt(this.fullHeight,10),Q=Math.max(parseInt(this.fullWidth,10),P.scrollWidth);if(this.useAnimate!=false){if(M.value){I(true,P,"width",O,Q);I(true,P,"height",L,N);}else{I(true,P,"width",Q,O);I(true,P,"height",N,L);}}else{if(M.value){P.style.width=Q+"px";P.style.height=N+"px";}else{P.style.width=O+"px";P.style.height=L+"px";}}},selectedColor:null,onChange:null,_updateSelection:function(M){var N=(this.isSimple)?this:this.layout.cp;if(M){var L=mstrmojo.array.find(N.basicColors.items,"v",M);if(L>-1){N.basicColors.set("selectedIndex",L);}else{L=mstrmojo.array.find(N.userPalette.items,"v",M);if(L>-1){N.userPalette.set("selectedIndex",L);}}}},visible:false,onvisibleChange:function(){if(this.visible){this.selectedColor=this.selectedColor&&this.selectedColor.replace(/transparent/,"#FFFFFF")||"#FFFFFF";this.colorModel.set("hex",this.selectedColor);this._updateSelection(this.selectedColor);}},onselectedColorChange:function(){this._updateSelection(this.selectedColor);},init:function(L){var M=this;this.colorModel=new mstrmojo.Model({h:0,s:0,v:100,_hsvChange:function(O){this.hex="#"+H.hsv2hex(this.h,this.s,this.v);var N=H.hsv2rgb(this.h,this.s,this.v);this.r=N[0];this.g=N[1];this.b=N[2];M.set("colorModel",mstrmojo.hash.copy(this,{}));},_rgbChange:function(O){this.hex="#"+H.rgb2hex(this.r,this.g,this.b);var N=H.rgb2hsv(this.r,this.g,this.b);this.h=N[0];this.s=N[1];this.v=N[2];M.set("colorModel",mstrmojo.hash.copy(this,{}));},onhChange:function(){this._hsvChange(this.s!==0);},onsChange:function(){this._hsvChange(false);},onvChange:function(){this._hsvChange(false);},onrChange:function(){this._rgbChange();},ongChange:function(){this._rgbChange();},onbChange:function(){this._rgbChange();},onhexChange:function(){var O=H.hex2rgb(this.hex);this.r=O[0];this.g=O[1];this.b=O[2];var N=H.hex2hsv(this.hex);this.h=N[0];this.s=N[1];this.v=N[2];M.set("colorModel",mstrmojo.hash.copy(this,{}));}});this._super(L);},postBuildRendering:function(){if(this._super){this._super();}this.colorModel.set("hex",this.selectedColor||"#FFFFFF");this.colorModel.set("s",50);},preBuildRendering:function(){if(this._super){this._super();}var O=this.isSimple?100:124;if(this.showNoColor){O+=20;}if(this.showUserPalette){O+=25;}this.height=O+"px";if(this.isSimple){this.width="155px";}this.shadowCssClass=this.useShadow?"shadow":"";var P=this,L={scriptClass:"mstrmojo.Button",cssClass:"nocolor",text:mstrmojo.desc(959,"Default"),visible:this.showNoColor,onclick:function(){P.set("selectedColor","transparent");if(P.onChange){P.onChange();}}},N=F(this,{alias:"basicColors",items:mstrmojo.locales.color.colors,onchange:function(){if(this.selectedIndex>-1){this.parent.userPalette.set("selectedIndex",-1);this._onchange();}}}),Q=F(this,{alias:"userPalette",cssClass:"mstrmojo-ColorPicker-list userPalette",makeObservable:true,visible:this.showUserPalette,bindings:{items:function(){return P.showUserPalette!=false?mstrmojo.locales.color.userPalette:[];}},onchange:function(){if(P.visible){if(this.selectedIndex>-1){this.parent.basicColors.set("selectedIndex",-1);this._onchange();}}},onadd:function(){this.refresh();if(P.visible){this.parent.basicColors.set("selectedIndex",-1);this.set("selectedIndex",0);}}});if(this.isSimple){if(this.showNoColor){this.addChildren(L,0);}this.addChildren(N);this.addChildren(Q);return ;}var M={scriptClass:"mstrmojo.Table",alias:"layout",rows:2,cols:5,layout:[{cells:[{colSpan:2},{colSpan:2},{}]},{cells:[{},{},{},{},{}]}],children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ColorPicker-palette shadow",alias:"cp",children:[L,N,Q],slot:"0,0"},{scriptClass:"mstrmojo.Container",cssClass:"sbSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousemove,mousedown,mouseup,mouseout><div class="sbThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},hex:null,bindings:{hex:"this.parent.parent.colorModel.hex",bgColor:function(){return"#"+H.hsv2hex(this.parent.parent.colorModel.h,100,100);}},onhexChange:function(){if(this.domNode){this.thumbNode.style.left=this.parent.parent.colorModel.s/100*160-3+"px";this.thumbNode.style.top=(1-this.parent.parent.colorModel.v/100)*160-3+"px";}},onmousedown:function(R){var T=this.domNode.getBoundingClientRect();this.mouseX0=T.left;this.mouseY0=T.top;this.onmousemove=this._update;var S=this;this.onmouseup=function(U){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",this.onmouseup);},onclick:function(R){this._update(R);},_update:function(R){var U={x:R.e.clientX,y:R.e.clientY},T=Math.min(Math.max(0,U.x-this.mouseX0),160),S=Math.min(Math.max(0,U.y-this.mouseY0),160);this.thumbNode.style.left=(T-3)+"px";this.thumbNode.style.top=(S-3)+"px";this.parent.parent.colorModel.s=Math.floor(100*T/160);this.parent.parent.colorModel.set("v",Math.floor(100*(1-S/160)));},slot:"0,1"},{scriptClass:"mstrmojo.Container",cssClass:"hueSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousedown,mouseup,mousemove,mouseout><div class="hThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},bindings:{hex:"this.parent.parent.colorModel.hex",h:"this.parent.parent.colorModel.h"},onhexChange:function(){this._moveThumb();},onhChange:function(){this._moveThumb();},_moveThumb:function(){if(this.thumbNode){this.thumbNode.style.top=(1-this.parent.parent.colorModel.h/360)*160-1+"px";}},onmousedown:function(R){this.mouseY0=this.domNode.getBoundingClientRect().top;this.onmousemove=this._update;var S=this;this.onmouseup=function(T){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",S.onmouseup);},onclick:function(R){this._update(R);},_update:function(R){var T={x:R.e.clientX,y:R.e.clientY},S=Math.min(Math.max(0,T.y-this.mouseY0),160);this.thumbNode.style.top=(S-1)+"px";this.parent.parent.colorModel.set("h",Math.max(0,Math.floor(360*(1-S/160))));},slot:"0,2"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-ColorPicker-preview",markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},bindings:{bgColor:"this.parent.parent.colorModel.hex"},onclick:function(){if(P.showUserPalette){B(this.bgColor);}},slot:"1,0"},J(mstrmojo.desc(7848),"Hex","1,0"),E(mstrmojo.desc(7848),"1,0","hex",{cssClass:"hex",cssDisplay:"block",inputNodeCssClass:"hex",dtp:25,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(R){if(/^#[0-9a-fA-F]{6}$/.test(R)){return{code:mstrmojo.validation.STATUSCODE.VALID};}else{return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7882)};}}}}),J(mstrmojo.desc(3604),"Red","1,1"),J(mstrmojo.desc(3606),"Green","1,1"),J(mstrmojo.desc(3608),"Blue","1,1"),J(mstrmojo.desc(3605),"Hue","1,1"),J(mstrmojo.desc(3607),"Saturation","1,1"),J(mstrmojo.desc(3609),"Brightness","1,1"),E(mstrmojo.desc(3604),"1,2","r"),G("r"),E(mstrmojo.desc(3606),"1,2","g"),G("g"),E(mstrmojo.desc(3608),"1,2","b"),G("b"),E(mstrmojo.desc(3695),"1,2","h",{cssClass:"h",max:360}),G("h"),E(mstrmojo.desc(3607),"1,2","s",{max:100}),G("s"),E(mstrmojo.desc(3609),"1,2","v",{max:100}),G("v")]};if(this.showMoreColors){M.children.push({scriptClass:"mstrmojo.Button",cssClass:"more",alias:"more",title:mstrmojo.desc(7833),onclick:function(){var R=this.parent.parent;R.set("expanded",!R.expanded);this.domNode.setAttribute("title",R.expanded?mstrmojo.desc(7834):mstrmojo.desc(7833));this.domNode.className=R.expanded?"less":"more";},slot:"0,0"});}if(this.showGradients){M.children.push({scriptClass:"mstrmojo.Button",alias:"showGradients",cssClass:"ge",text:mstrmojo.desc(4786,"Gradients..."),title:mstrmojo.desc(7970,"Open Graident Editor"),onclick:function(){var R=this.parent.parent;R.set("show",false);R.parent.ge.set("show",true);},slot:"0,0"});}this.addChildren(M);this.addChildren({scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-ColorPicker-buttonBar",children:[new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),function(){var R=this.parent.parent;if(!R.useAnimate){R.set("visible",false);}var S=R.colorModel.hex;if(R.showUserPalette){B(S);}R.set("selectedColor",S);if(R.onOK){R.onOK();}},"#999",{alias:"ok",cssClass:"mstrmojo-Editor-button"}),new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(221),function(){var R=this.parent.parent;if(!R.useAnimate){R.set("visible",false);}if(R.onCancel){R.onCancel();}},"#999",{alias:"cancel",cssClass:"mstrmojo-Editor-button"})]});}});var K={scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"mstrmojo-ColorPicker-popup-content",autoCloses:false,locksHover:true,onOpen:function(){this.colorPicker.set("selectedColor",this.opener.fillColor);var M=this;var L=function(){M.lastOpener=M.lastOpener||M.opener;if(M.opener!==M.lastOpener){M.opener.popupNode.appendChild(M.lastOpener.popupRef.domNode);M.lastOpener=M.opener;}M.colorPicker.set("show",true);};window.setTimeout(function(){L();},100);},onClose:function(){this.colorPicker.set("show",false);if(this.ge){this.ge.set("show",false);}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.onvisibleChange=null;},preBuildRendering:function(){if(this.showGradients||this.colorPicker.showGradients){this.addChildren(this.gradientRef);}},gradientRef:{scriptClass:"mstrmojo.GradientEditor",alias:"ge",cssText:"height:0; display:none; position:absolute; z-index: 4;",left:"0px",top:"0px",visible:false,showTitle:false,height:240,_resizeHandler:function(){},onOK:function(){this.parent.opener.set("gradient",this.gradient);this.parent.opener.set("gradientCss",this.gradient.css);this.set("show",false);},onCancel:function(){this.set("show",false);},onshowChange:function(N){var M=N.value,L=parseInt(this.height,10);var Q=this.domNode.firstChild;if(M){this.set("model",this.parent.opener.gradient);Q.style.display="block";}if(this.useAnimate!=false){var R=M?0:L,O=L-R,P=this;Q.style.overflow="hidden";if(M){Q.style.display="block";}I(N.value,Q,"height",R,O,function(){if(!M){Q.style.display="none";var S=P.parent.opener;if(S){S.closePopup();}}else{Q.style.overflow="visible";}});}else{Q.style.height=M?L+"px":0;Q.style.display=M?"block":"none";}},postCreate:function(){this.bindings={useAnimate:"this.parent.opener.useAnimate"};}},children:[{scriptClass:"mstrmojo.ColorPicker",alias:"colorPicker",onChange:function(){if(!this.parent.opener){return ;}this.parent.opener.set("fillColor",this.selectedColor);this.set("show",false);this.parent.opener.closePopup();},onOK:function(){this.onApply();this._closePopup();},onApply:function(){this.parent.opener.set("fillColor",this.selectedColor);},onCancel:function(){this._closePopup();},_closePopup:function(){this.set("show",false);if(!this.showGradients||!this.parent.ge||this.parent.ge&&!this.parent.ge.show){this.parent.opener.closePopup();}},show:false,onEnd:function(){this.set("visible",this.show);},onshowChange:function(){var L=parseInt(this.expanded?this.fullHeight:this.height,10);if(this.useAnimate!=false){var P=this.show?0:L,N=L-P,O=this,M=(!this.show?function(){O.onEnd();}:null);if(this.show){this.set("visible",true);}I(this.show,this.domNode,"height",P,N,M);}else{this.set("visible",this.show);this.domNode.style.height=L+"px";}},postCreate:function(){this.bindings={showUserPalette:function(){return this.parent.opener?this.parent.opener.showUserPalette:this.showUserPalette;},useAnimate:function(){return this.parent.opener?this.parent.opener.useAnimate:this.useAnimate;},isSimple:function(){return this.parent.opener?this.parent.opener.isSimple:this.isSimple;},showGradients:function(){return this.parent.opener?this.parent.opener.showGradients:this.showGradients;},showNoColor:function(){return this.parent.opener?this.parent.opener.showNoColor:this.showNoColor;}};}}]};mstrmojo.colorPickerPopupRef=mstrmojo.insert(K);mstrmojo.simpleColorPickerPopupRef=mstrmojo.insert(mstrmojo.hash.copy({isSimple:true},mstrmojo.hash.copy(K)));mstrmojo.gradientColorPickerPopupRef=mstrmojo.insert(mstrmojo.hash.copy({showGradients:true},mstrmojo.hash.copy(K)));mstrmojo.ColorPicker.createDropDown=function C(N,M){N=N||{};var L=mstrmojo.colorPickerPopupRef;if(M){if(M.isSimple){L=mstrmojo.simpleColorPickerPopupRef;N.isSimple=M.isSimple;}else{if(M.showGradients){L=mstrmojo.gradientColorPickerPopupRef;N.showGradients=M.showGradients;}}}else{if(N){if(N.isSimple){L=mstrmojo.simpleColorPickerPopupRef;}else{if(N.showGradients){L=mstrmojo.gradientColorPickerPopupRef;}}}}return mstrmojo.hash.copy(N,{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-ColorPicker-DropDownButton",markupMethods:{onfillColorChange:function(){if(this.boxNode&&this.fillColor){this.boxNode.style.cssText="background-color: "+this.fillColor;this.gradient=null;this.gradientCss=null;}},ongradientCssChange:function(){if(this.boxNode&&this.gradientCss){this.boxNode.style.cssText=this.gradientCss;this.fillColor=null;}}},popupRef:L,showUserPalette:true,useAnimate:true,showGradients:false,isSimple:false});};})();(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),new mstrmojo.FishEye({items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E=="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E=="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof (G)=="object")&&(typeof (G.length)=="number"));};if(B(F)&&B(E)){for(var C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var A=mstrmojo.dom,B={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(B[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=A.eventTarget(D.hWin,D.e);if(F==this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd");function W(a){var c=document.createElement("div"),b=c.style,Z=a.domNode;c.className="mstrmojo-DataGrid-avatar";b.height=Z.clientHeight+"px";Z.appendChild(c);a.avatar=c;return c;}function N(Z){var a=mstrmojo.dom.position(Z.domNode,true);return a.x;}function L(Z){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+Z+'"></div>';}function X(b){var a=b.getAttribute("rh"),Z=a&&parseInt(a,10);return Z;}function U(a,f,Z){var c=Z.src,g=c&&c.data,b=g&&g.resizingIdx;if(!(b&&b>0)){return f&&f.apply(a,[Z]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function E(c,b){var Z=c.colSizeArray;var a=[-Z[b-1]+c.minColWidth,(b==Z.length-1)?Z[b]-c.resizeHandleWidth-c.minColWidth:Z[b]-c.minColWidth];return a;},updateSize:function D(c,b,a){var Z=c.colSizeArray;Z[b-1]=Z[b-1]+a;Z[b]=Z[b]-a;},updateColumnWidth:function Q(c,a,d,b){var Z=c.colSizeArray;a[b-1].style.width=Z[b-1]+"px";d[b-1].style.width=Z[b-1]+"px";a[b].style.width=Z[b]+"px";d[b].style.width=Z[b]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function E(f,d){var g=f.minColWidth+f.resizeHandleWidth,Z=f.colSizeArray,b=0;for(var c=d;c<Z.length;++c){b+=Z[c]-g;}var a=[-Z[d-1]+g,b];return a;},updateSize:function D(c,h,a){var g=c.minColWidth+c.resizeHandleWidth,d=c.colSizeArray;d[h-1]=d[h-1]+a;var Z=[];for(var b=0;b<d.length-h;++b){Z[b]=h+b;}Z.sort(function(i,k){return d[i]-d[k];});for(var b=0;b<Z.length;++b){var j=a/(Z.length-b);var f=d[Z[b]];a-=(f>=j+g)?j:f-g;d[Z[b]]=(f>=j+g)?f-j:g;}},updateColumnWidth:function Q(d,a,f,c){var Z=d.colSizeArray;for(var b=c-1;b<Z.length;++b){a[b].style.width=Z[b]+"px";f[b].style.width=Z[b]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,postBuildRendering:function S(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function C(Z){var b=Z.src,c=b.node,a=X(c);if(a&&a>0){return{resizingIdx:a,startingX:b.pos.x,baseX:N(this)};}else{if(this._super){return this.dropZone&&this._super(Z);}}return null;},allowDrop:function I(Z){var b=Z.src,c=b&&b.data,a=c&&c.resizingIdx;if(a&&a>0){return true;}else{return this.dropZone;}},ondragenter:function O(Z){U(this,this._super,Z);},ondragover:function P(Z){U(this,this._super,Z);},ondragleave:function A(Z){U(this,this._super,Z);},ondrop:function T(Z){U(this,this._super,Z);},ondragstart:function V(f){var o=f.src,g=o&&o.data,n=g&&g.resizingIdx;if(n&&n>0){var j=this.avatar||W(this);this.ownAvatar=true;j.style.left=(g.startingX-g.baseX)+"px";j.style.display="block";document.body.style.cursor="col-resize";var k=this.colSizeArray;if(!k){var b=this.headerContainerNode,h=b&&b.getElementsByTagName("table")[0],m=h.rows[0].cells;k=[];for(var Z=0,c=m.length;Z<c;Z++){k.push(m[Z].offsetWidth);}this.colSizeArray=k;this._firstTimeResize=true;}g.resizingRange=this.resizeColumnBehavior.getRange(this,n);return true;}else{if(this._super){return this._super(f);}}},ondragmove:function M(b){var k=b.src,c=k&&k.data,i=c&&c.resizingIdx;if(i&&i>0){var j=b.tgt,f=this.avatar,h=c.resizingRange,g=j.pos.x-c.startingX,Z=Math.min(h[1],Math.max(g,h[0]));c.deltaX=Z;if(f){f.style.left=(c.startingX-c.baseX+Z)+"px";}}else{if(this._super){this._super(b);}}},ondragend:function J(f){var o=f.src,g=o&&o.data,m=g&&g.resizingIdx;if(m&&m>0){var Z=this.titleColGroup,n=Z&&Z.childNodes,j=this.dataColGroup,k=j&&j.childNodes,c=n.length,h=this.colSizeArray,a=g.deltaX;this.resizeColumnBehavior.updateSize(this,m,a);if(this._firstTimeResize){for(var b=0;b<c;b++){n[b].style.width=h[b]+"px";k[b].style.width=h[b]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,n,k,m);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(f);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function H(b){var f=document.createElement("colgroup"),Z=b.length,a;for(var d=0;d<Z;d++){var c=document.createElement("col");a=b[d];if(a.colWidth){c.style.width=a.colWidth+"px";}c.className=a.colCss||("col"+d);f.appendChild(c);}return f;}function G(a){var b=a._headerWidgets_,Z=b&&b.length;if(Z>0){for(var c=0;c<Z;c++){b[c].destroy(true);}}}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},itemFunction:function(b,Z,a){var d=new mstrmojo.DataRow({columns:a.columns,data:b,idx:Z,dataGrid:a});return d;},preBuildRendering:function B(){var c=this.columns,Z=c.length,d=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],b,a;this._headerWidgets=[];for(var f=0;f<Z;f++){b=c[f];a=b.headerWidget;d.push("<td>");if(f>0&&this.resizableColumns){d.push(L(f));}d.push('<div class="mstrmojo-DataGrid-headerText');d.push(b.headerCss?" "+b.headerCss:"");if(a){this._headerWidgets.push(mstrmojo.hash.copy(a));d.push('" w="1">');}else{d.push('">');}d.push(b.headerText?b.headerText:"&nbsp");d.push("</div>");d.push("</td>");}d.push("</tr></table>");this.headerHtml=d.join("");if(this._super){this._super();}},postBuildRendering:function S(){if(this._super){this._super();}var c=this._headerWidgets,g=c.length;if(g>0){this._headerWidgets_=[];var h=this.headerContainerNode.getElementsByTagName("div"),b=mstrmojo.array.filter(h,function(i){return i.getAttribute("w")=="1";}),m;for(var d=0;d<g;d++){c[d].placeholder=b[d].firstChild;c[d].dataGrid=this;m=mstrmojo.registry.ref(c[d]);m.render();this._headerWidgets_.push(m);}}var Z=H(this.columns),k=Z.cloneNode(true),f=this.headerContainerNode,j=f&&f.getElementsByTagName("table")[0],n=this.itemsContainerNode,a=n&&n.getElementsByTagName("table")[0];this.titleColGroup=Z;this.dataColGroup=k;if(j&&a){j.insertBefore(Z,j.firstChild);a.insertBefore(k,a.firstChild);}},refresh:function F(Z){G(this);if(this._super){this._super(Z);}},destroy:function Y(Z){G(this);this._super();},unrender:function R(d){var b=this._headerWidgets_,a=b&&b.length,Z;if(a>0){for(var c=0;c<a;c++){Z=b[c];if(Z&&Z.hasRendered){Z.unrender(true);}}}this._super(d);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var g=document.createElement("tr"),m=this.data,p=this.idx,a=this.dataGrid,h=this.cssClass,r=this.columns,Z=this.children,b,n=-1,q,o;g.setAttribute("id",this.id);if(a.banding){h+=(p%2==1)?" odd":" even";}g.className=h+(mstrmojo.string.isEmpty(m[a.itemDisplayField||"n"])?" empty-row":"");for(var f=0,k=r.length;f<k;f++){q=r[f];o=(q.dataWidgetBuilder&&q.dataWidgetBuilder(m))||q.dataWidget;b=document.createElement("td");g.appendChild(b);if(o){b.setAttribute("w","1");n++;Z.push(mstrmojo.hash.copy(o,{slot:"slot"+n,data:m,idx:p,dataGrid:a}));}else{if(q.dataFunction){b.innerHTML=q.dataFunction(m,p,a);}else{var c=mstrmojo.string.htmlAngles(m[q.dataField||"n"])||"&nbsp",j=q.tooltip?' title="'+c+'"':"";b.innerHTML='<div class="mstrmojo-DataRow-text" '+j+">"+c+"</div>";}}}this.initChildren();return g;},buildRendering:function K(){this._super();var d=this.domNode.childNodes,Z=d.length,c={},b=0,f;for(var a=0;a<Z;a++){f=d[a];if(f.getAttribute("w")=="1"){c["slot"+b]=f;b++;}}this.addSlots(c);}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Editor","mstrmojo.TabListContainer","mstrmojo.TabNameList","mstrmojo.StackContainer","mstrmojo.DataGrid");var X=mstrmojo.hash,Z=mstrmojo.array,Y=mstrmojo.Button;var I="#999",H="mstrmojo-Editor-button",T=[{n:mstrmojo.desc(4114),v:"-1"},{n:mstrmojo.desc(4115),v:"0"}],M={Unknown:-1,Reserved:0,Integer:1,Unsigned:2,Numeric:3,Decimal:4,Real:5,Double:6,Float:7,Char:8,VarChar:9,LongVarChar:10,Binary:11,VarBin:12,LongVarBin:13,Date:14,Time:15,TimeStamp:16,NChar:17,NVarChar:18,Short:21,Long:22,MBChar:23,Bool:24,Pattern:25,BigDecimal:30},E=[{n:mstrmojo.desc(2171),v:M.Reserved},{n:mstrmojo.desc(5471),v:M.BigDecimal},{n:mstrmojo.desc(9611,"Binary"),v:M.Binary},{n:mstrmojo.desc(9612,"Char"),v:M.Char},{n:mstrmojo.desc(2052),v:M.Date},{n:mstrmojo.desc(9613,"Decimal"),v:M.Decimal},{n:mstrmojo.desc(2265),v:M.Double},{n:mstrmojo.desc(8002),v:M.Float},{n:mstrmojo.desc(9614,"Integer"),v:M.Integer},{n:mstrmojo.desc(9615,"Long VarBin"),v:M.LongVarBin},{n:mstrmojo.desc(9616,"Long VarChar"),v:M.LongVarChar},{n:mstrmojo.desc(9617,"NChar"),v:M.NChar},{n:mstrmojo.desc(9618,"NVarChar"),v:M.NVarChar},{n:mstrmojo.desc(1395),v:M.Numeric},{n:mstrmojo.desc(9619,"Real"),v:M.Real},{n:mstrmojo.desc(2170),v:M.Time},{n:mstrmojo.desc(9620,"TimeStamp"),v:M.TimeStamp},{n:mstrmojo.desc(9621,"Unsigned"),v:M.Unsigned},{n:mstrmojo.desc(9622,"VarBin"),v:M.VarBin},{n:mstrmojo.desc(9623,"VarChar"),v:M.VarChar}],B={AnalyticalEngineProperties:"E3796B516F8611D3858D00C04F685B39",DatamartProperties:"1DB1A6268E9B11D485E900C04F685B52",VLDBSelect:"A2185AB0DD7C11D29FE500C04F8E7129",VLDBFunction:"A2185AB6DD7C11D29FE500C04F8E7129",VLDBReport:"A2185AB1DD7C11D29FE500C04F8E7129"},P={NullCheckingForAnalyticalEngine:3,SubtotalDimensionalityAware:7,DatamartTableColumnAlias:9,IntegerConstantInMetric:38,TransformableAggMetric:84,NoNullsInMetricForCubeReuse:72,MetricJoinType:9,NullCheck:2,ZeroCheck:4,CountDistinctwithPartitions:24},G={agg:"F225147A4CA0BB97368A5689D9675E73",total:"96C487AF4D12472A910C1ACACFB56EFB",reserved:"F341109B11D5D528C00084916B98494F"},V=["sbs","prss","mps","datp"];var N=function(b){return X.copy(b,{scriptClass:"mstrmojo.Container",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',cssClass:"mstrmojo-FormatEditor-rightPanel",markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},useAnimate:true,width:"420px",ease:"mstrmojo.ease.sin"});},D=function(c,b){return X.copy(b,S(c,{cssClass:"mstrmojo-OptionEditor-Title"}));},S=function(c,b){return X.copy(b,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-OptionEditor-Label",text:c});},L=function(b,c){return X.copy(c,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-FormatEditor-DropDownButton",items:b});},U=function(c,b){return X.copy(b,{scriptClass:"mstrmojo.ImageCheckBox",cssClass:"mstrmojo-OptionEditor-Checkbox mstrmojo-ImageCheckBox",label:c});},C=function(c,b){return X.copy(b,{scriptClass:"mstrmojo.RadioButton",cssClass:"mstrmojo-OptionEditor-RadioButton",label:c});},O=function(f,b,d,c){return X.copy(b,{scriptClass:"mstrmojo.HBox",cssText:"width: 100%",children:[C(f,d),X.copy(c,{scriptClass:"mstrmojo.Label"})]});},A=function(b){return X.copy(b,{scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-OptionEditor-shortTextBox"});},a=function(c,d,f,h,g,b){c=c||{};c[d]=c[d]||{};c[d][f]=c[d][f]||{did:B[f]||""};c[d][f][h]=c[d][f][h]||{};c[d][f][h][g]=b;c[d][f][h].pri=c[d][f][h].pri||P[h]||0;},F=function(d,g,h,k,c){if(d){var j=c=="-2",b=[{n:"pru",v:j?"1":"0"}];if(!j){b.push({n:"v",v:c});}for(var f=0;f<b.length;f++){a(d,g,h,k,b[f].n,b[f].v);}}};var Q=mstrmojo.insert(N({n:mstrmojo.desc(295),children:[D(mstrmojo.desc(295)),{scriptClass:"mstrmojo.HBox",children:[S(mstrmojo.desc(9625,"Dynamic aggregation function:")),L(null,{cssText:"width:180px",itemIdField:"did",bindings:{items:"this.parent.parent.model.funcPd",value:function(){var b=this.parent.parent.model;if(!b||!b.sbs){return G.agg;}if(!b.sbs.agg||!b.sbs.agg.did){return -1;}var c=this.parent.parent.model.sbs.agg.did;return c||G.agg;}},onvalueChange:function(){var c=this.parent.parent.model,d=this.selectedItem;if(c&&d){c.sbs=c.sbs||{};c.sbs.agg=c.sbs.agg||{};var b=c.sbs.agg;if(this.value==-1){delete c.sbs.agg;}else{b.did=d.did;b.t=d.t;b.st=d.st;}}},onitemsChange:function(){if(this.items&&this.items.length>0){this.refresh();}}})]},U(mstrmojo.desc(9624,"Allow smart metric"),{bindings:{checked:function(){var b=this.parent.model,c=b&&this.parent.model.mps,d=c&&this.parent.model.mps.stl;return !b||!c||d==null||d==3;},enabled:"!this.parent.model.mps||this.parent.model.mps.cbs==true||this.parent.model.isValidExpr==1"},onclick:function(){if(this.parent.model){var b=this.parent.model;b.mps=b.mps||{};b.mps.stl=this.checked?3:2;}}})]})),K=mstrmojo.insert(N({n:mstrmojo.desc(1912),children:[D(mstrmojo.desc(1912)),{scriptClass:"mstrmojo.HBox",children:[S(mstrmojo.desc(9626,"Function for default subtotal (Total):")),L(null,{cssText:"width:180px",itemIdField:"did",bindings:{items:"this.parent.parent.model.funcPd",value:function(){var b=this.parent.parent.model;if(!b||!b.sbs){return G.total;}if(!b.sbs.tot||!b.sbs.tot.did){return -1;}var c=this.parent.parent.model.sbs.tot.did;return c||G.total;}},onvalueChange:function(){var b=this.parent.parent.model,c=this.selectedItem;if(b&&c){b.sbs=b.sbs||{};b.sbs.tot=b.sbs.tot||{};var d=b.sbs.tot;if(this.value==-1){delete b.sbs.tot;}else{d.did=c.did;d.t=c.t;d.st=c.st;}}},onitemsChange:function(){if(this.items&&this.items.length>0){this.refresh();}}})]},{scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-SME-toggleAdvance",text:mstrmojo.desc(9627,"Select the subtotals you want available for this metric:"),onclick:function(b){var d=this.parent.parent,c=!!!d.expanded;d.set("expanded",c);this.set("selected",c);}}]},{scriptClass:"mstrmojo.DataGrid",cssClass:"mstrmojo-OptionEditor-subtotal-func-grid",resizableColumns:false,columns:[{dataWidget:{scriptClass:"mstrmojo.ImageCheckBox",cssClass:"cb-grid",bindings:{checked:function(){var c=this.dataGrid.parent.model.sbs.avs,b=this.data.did;return Z.find(c,"did",b)!=-1;}},onclick:function(){var c=this.dataGrid.parent.model,g=c.sbs=c.sbs||[],j=c.sbs.avs=c.sbs.avs||[],i=this.data,h=i.did,f=i.t,d=i.st;if(this.checked){Z.insert(j,null,[{did:h,t:f,st:d}]);}else{var b=Z.find(j,"did",h);if(b!=-1){Z.removeIndices(j,b,1);}}c.sbs.avs=j;}},colCss:"cb"},{headerText:mstrmojo.desc(9713,"Subtotal"),dataField:"n",colCss:"funcName"},{headerText:mstrmojo.desc(6013,"Description"),dataField:"desc",colCss:"expr"}],bindings:{items:"this.parent.model.funcsDg",visible:"this.parent.expanded"}}]})),W=mstrmojo.insert(N({n:mstrmojo.desc(9670,"VLDB Properties"),id:"VLDBProps",children:[{scriptClass:"mstrmojo.Table",alias:"content",rows:9,cols:2,children:[S(mstrmojo.desc(9628,"Null checking for Analytical Engine:"),{slot:"0,0"}),L([{n:mstrmojo.desc(9712,"Inherit - true"),v:"-2"}].concat(T),{slot:"0,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.AnalyticalEngineProperties.NullCheckingForAnalyticalEngine,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","AnalyticalEngineProperties","NullCheckingForAnalyticalEngine",this.value);}}),S(mstrmojo.desc(9629,"Subtotal Dimensionality Aware:"),{slot:"1,0"}),L([{n:mstrmojo.desc(9712,"Inherit - true"),v:"-2"}].concat(T),{slot:"1,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.AnalyticalEngineProperties.SubtotalDimensionalityAware,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","AnalyticalEngineProperties","SubtotalDimensionalityAware",this.value);}}),S(mstrmojo.desc(9630,"Metric Validation:"),{slot:"2,0"}),L([{n:mstrmojo.desc(9631,"Inherit - Enable dynamic sourcing for metric"),v:"-2"},{n:mstrmojo.desc(9632,"Enable dynamic sourcing for metric"),v:"0"},{n:mstrmojo.desc(9633,"Disable dynamic sourcing for metric"),v:"1"}],{slot:"2,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.VLDBSelect.NoNullsInMetricForCubeReuse,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","VLDBSelect","NoNullsInMetricForCubeReuse",this.value);}}),S(mstrmojo.desc(9634,"Integer Constants in Metric:"),{slot:"3,0"}),L([{n:mstrmojo.desc(9635,"Inherit - Add '.0' to integer constants in metric expressions"),v:"-2"},{n:mstrmojo.desc(9636,"Add '.0' to integer constants in metric expressions"),v:"0"},{n:mstrmojo.desc(9637,"Do not add '.0' to integer constants in metric expressions"),v:"1"}],{slot:"3,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.VLDBSelect.IntegerConstantInMetric,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","VLDBSelect","IntegerConstantInMetric",this.value);}}),S(mstrmojo.desc(9638,"Metric Join type:"),{slot:"4,0"}),L([{n:mstrmojo.desc(9639,"Inherit - Inner Join"),v:"-2"},{n:mstrmojo.desc(9640,"Inner Join"),v:"0"},{n:mstrmojo.desc(9641,"Outer Join"),v:"1"}],{slot:"4,1",alias:"MetricJoinType",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.VLDBSelect.MetricJoinType,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","VLDBSelect","MetricJoinType",this.value);}}),S(mstrmojo.desc(9642,"Null check:"),{slot:"5,0"}),L([{n:mstrmojo.desc(9643,"Inherit - Check for NULL in all queries"),v:"-2"},{n:mstrmojo.desc(9644,"Check for NULL in all queries"),v:"0"},{n:mstrmojo.desc(9645,"Check for NULL in temp table join only"),v:"1"}],{slot:"5,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.VLDBFunction.NullCheck,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","VLDBFunction","NullCheck",this.value);}}),S(mstrmojo.desc(9646,"Transformable Agg Metric:"),{slot:"6,0"}),L([{n:mstrmojo.desc(9712,"Inherit - true"),v:"-2"}].concat(T),{slot:"6,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.VLDBSelect.TransformableAggMetric,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","VLDBSelect","TransformableAggMetric",this.value);}}),S(mstrmojo.desc(9647,"Zero Check:"),{slot:"7,0"}),L([{n:mstrmojo.desc(9648,"Inherit - Check for zero"),v:"-2"},{n:mstrmojo.desc(9649,"Do nothing"),v:"0"},{n:mstrmojo.desc(9650,"Check for zero in all queries"),v:"1"},{n:mstrmojo.desc(9651,"Check for zero in temp table join only"),v:"2"}],{slot:"7,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.VLDBFunction.ZeroCheck,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","VLDBFunction","ZeroCheck",this.value);}}),S(mstrmojo.desc(9652,"Count Distinct:"),{slot:"8,0"}),L([{n:mstrmojo.desc(9653,"Inherit - Do not select distinct elements from each partition"),v:"-2"},{n:mstrmojo.desc(9654,"Do not select distinct elements from each partition"),v:"0"},{n:mstrmojo.desc(9655,"Select distinct elements from each partition"),v:"1"}],{slot:"8,1",itemIdField:"v",bindings:{value:function(){var b=this.parent.parent.model.prss.VLDBReport.CountDistinctwithPartitions,c=b.v,d=b.pru;return d=="1"?"-2":c;}},onvalueChange:function(){F(this.parent.parent.model,"prss","VLDBReport","CountDistinctwithPartitions",this.value);}})]}]})),R=mstrmojo.insert(N({n:mstrmojo.desc(9656,"Colunm Options"),children:[{scriptClass:"mstrmojo.Table",rows:5,cols:1,children:[S(mstrmojo.desc(9657,"Column name used in SQL table creation:"),{slot:"0,0"}),{slot:"1,0",scriptClass:"mstrmojo.TextBox",bindings:{value:"this.parent.parent.model.prss.DatamartProperties.DatamartTableColumnAlias.v"},onvalueChange:function(){if(this.parent.parent.model){a(this.parent.parent.model,"prss","DatamartProperties","DatamartTableColumnAlias","v",this.value||"");}}},S(mstrmojo.desc(9658,"Data Type:"),{slot:"2,0"}),L(E,{slot:"3,0",alias:"dt",itemIdField:"v",bindings:{value:"this.parent.parent.model.datp.ddt"},onvalueChange:function(){var b=this.parent.parent.model;if(b){b.datp=b.datp||{};b.datp.ddt=this.value;}}}),{scriptClass:"mstrmojo.Table",slot:"4,0",rows:2,cols:2,children:[{scriptClass:"mstrmojo.Label",slot:"0,0",alias:"prec",cssClass:"mstrmojo-OptionEditor-shortLabel",bindings:{text:function(){var b=this.parent.parent.dt.value;switch(b){case M.BigDecimal:case M.Decimal:case M.Numeric:return mstrmojo.desc(9659,"Precision:");case M.Binary:case M.Integer:case M.LongVarBin:case M.LongVarChar:case M.NChar:case M.NVarChar:case M.Unsigned:case M.VarBin:case M.VarChar:return mstrmojo.desc(9660,"Byte length:");case M.Time:case M.TimeStamp:return mstrmojo.desc(9661,"Time Scale:");default:return"";}},visible:"!!this.text"}},A({slot:"0,1",bindings:{visible:"this.parent.prec.visible",value:"this.parent.parent.parent.model.datp.prec"},onvalueChange:function(){var b=this.parent.parent.parent.model;if(b){b.datp=b.datp||{};b.datp.prec=this.value;}}}),{scriptClass:"mstrmojo.Label",slot:"1,0",alias:"scl",cssClass:"mstrmojo-OptionEditor-shortLabel",bindings:{text:function(){var b=this.parent.parent.dt.value;switch(b){case M.BigDecimal:case M.Decimal:case M.Numeric:return mstrmojo.desc(9662,"Scale:");default:return"";}},visible:"!!this.text"}},A({slot:"1,1",bindings:{visible:"this.parent.scl.visible",value:"this.parent.parent.parent.model.datp.scl"},onvalueChange:function(){var b=this.parent.parent.parent.model;if(b){b.datp=b.datp||{};b.datp.scl=this.value;}}})]}]}]})),J=mstrmojo.insert(N({n:mstrmojo.desc(9663,"Joins"),children:[{scriptClass:"mstrmojo.Table",rows:8,cols:1,bindings:{mjt:"mstrmojo.all.VLDBProps.content.MetricJoinType.value",acj:"this.parent.model.mps.acj"},setMjt:function(b){mstrmojo.all.VLDBProps&&mstrmojo.all.VLDBProps.content.MetricJoinType.set("value",b);},setAcj:function(c){if(this.parent.model){var b=this.parent.model;b=b||{};b.mps=b.mps||{};b.mps.acj=c;}},children:[S(mstrmojo.desc(9664,"Metric Join"),{slot:"0,0",cssClass:"boldLabel"}),C(mstrmojo.desc(9665,"Default inherit value"),{slot:"1,0",name:"metricJoin",alias:"mjDefault",bindings:{checked:'!this.parent.mjt||this.parent.mjt=="-2"'},onclick:function(){this.parent.setMjt("-2");}}),O(mstrmojo.desc(9666,"Inner Join - use information common to all elements"),{slot:"2,0",alias:"mjInner"},{name:"metricJoin",alias:"rb",bindings:{checked:'this.parent.parent.mjt=="0"'},onclick:function(){this.parent.parent.setMjt("0");}},{cssClass:"innerJoin"}),O(mstrmojo.desc(9667,"Outer Join - use all information to all elements"),{slot:"3,0",alias:"mjOuter"},{name:"metricJoin",alias:"rb",bindings:{checked:'this.parent.parent.mjt=="1"'},onclick:function(){this.parent.parent.setMjt("1");}},{cssClass:"outerJoin"}),S(mstrmojo.desc(9668,"Metric Formula Join"),{slot:"4,0",cssClass:"boldLabel"}),C(mstrmojo.desc(9669,"Default inherit value"),{slot:"5,0",name:"metricFormalaJoin",bindings:{checked:"!this.parent.acj||this.parent.acj==1"},onclick:function(){this.parent.setAcj(1);}}),O(mstrmojo.desc(9666,"Inner Join - use information common to all elements"),{slot:"6,0"},{name:"metricFormalaJoin",bindings:{checked:"this.parent.parent.acj==2"},onclick:function(){this.parent.parent.setAcj(2);}},{cssClass:"innerJoin"}),O(mstrmojo.desc(9667,"Outer Join - use all information to all elements"),{slot:"7,0"},{name:"metricFormalaJoin",bindings:{checked:"this.parent.parent.acj==3"},onclick:function(){this.parent.parent.setAcj(3);}},{cssClass:"outerJoin"})]}]}));mstrmojo.ME.OptionDialog=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.OptionDialog",cssClass:"mstrmojo-OptionEditor mstrmojo-FormatEditor",onOpen:function(){if(!this.model){this.model={};}this.cloneModel=this.cloneModel||{};X.make(this.cloneModel,mstrmojo.Obj);var n=this.cloneModel,d=this.model;for(var g=0;g<V.length;g++){n.set(V[g],X.clone(d[V[g]]));}var c=this.tabCtr.ctr.children;for(var g=0;g<c.length;g++){c[g].set("model",this.cloneModel);}this.cloneModel.set("isValidExpr",this.opener.vStatus);var h=this.funcs,j=this.funcsDg||Z.filter(h,function(i){return i.dssid!=G.agg&&i.dssid!=G.total&&i.dssid!==G.reserved;});funcPd=this.funcPd||Z.insert(X.clone(Z.filter(h,function(i){return parseInt(i.st)==1026&&i.did!==G.reserved;})),0,[{n:mstrmojo.desc(2057),did:-1}]);n.set("funcsDg",j);var f=function(i){if(i.n==="Aggregation"){i.n="Automatic";}else{if(i.n==="Total"){i.n="Sum";}}};Z.forEach(funcPd,f);n.set("funcPd",funcPd);if(!this.model.did&&!this.model.sbs){for(var g=0;g<V.length;g++){delete n[V[g]];}if(h&&h.length>0){var b=[];for(var g=0;g<h.length;g++){var k=h[g];if(k.dssid!=G.agg&&k.dssid!=G.total&&parseInt(k.stp)==1026){b.push({did:k.dssid,t:k.tp,st:k.stp});}}this.cloneModel.set("sbs",{tot:{did:G.total,dm:{did:G.total,t:4,st:1026}},agg:{did:G.agg,dm:{did:G.agg,t:4,st:1026}},avs:b});}}},onOK:function(){var c=this.model,b=this.cloneModel;c.prss=b.prss;c.mps=b.mps;c.sbs=b.sbs;c.datp=b.datp;},children:[{scriptClass:"mstrmojo.TabListContainer",alias:"tabCtr",listCssClass:"mstrmojo-FormatEditor-leftPanel",children:[{scriptClass:"mstrmojo.TabNameList",cssClass:"mstrmojo-FormatEditor-formatList",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>',slot:"top",_ontargetChange:function(){this.set("selectedIndex",0);}},{scriptClass:"mstrmojo.StackContainer",alias:"ctr",cssClass:"mstrmojo-FormatEditor-rightPanel-container",children:[Q,K,W,R,J],slot:"stack"}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",children:[new Y.newInteractiveButton(mstrmojo.desc(2397),function(){var b=this.parent.parent;b.close();b.onOK&&b.onOK();},I,{alias:"btnOk",cssClass:H}),new Y.newInteractiveButton(mstrmojo.desc(2399),function(){var b=this.parent.parent;b.close();},I,{alias:"btnCancel",cssClass:H})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo._FormatDefinition","mstrmojo.Table","mstrmojo._HasLayout","mstrmojo.color","mstrmojo.ColorPicker");var D=mstrmojo.hash,C=mstrmojo.array,F=mstrmojo._FormatDefinition,B=mstrmojo.color;var A=function(G){var H={scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-fontFamily",itemCssClass:"mstrmojo-FormatEditor-bullet",selectedIndex:0,itemIdField:"v",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>'};return D.copy(G,H);};var E=function(I){var H=I.alias,G=I.label,J=I.pr;return{alias:H,scriptClass:"mstrmojo.TristateCheckBox",text:G,checked:false,grayed:false,bindings:{m:I.modelBinding,checked:function(){return this.m[J]==-1;},grayed:function(){return(typeof this.m[J]=="undefined")||this.m[J]=="pru";}},oncheckedChange:function(K){if(this.m){this.m.set(J,this.checked?-1:0);}}};};mstrmojo.FontFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FontFormatter",cssClass:"mstrmojo-FontFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{},{},{}]},{cells:[{},{colSpan:2}]}],children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2172),slot:"0,0"},A({items:F.Families,itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="font-family:{@n}">{@n}</div></div>',pr:"Name",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Name,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Name",this.selectedItem.v);}},slot:"0,0"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3059),slot:"0,1"},A({items:F.Styles,cssClass:"mstrmojo-FormatEditor-fontStyle",bindings:{selectedIndex:function(){var K=this.parent.parent.model;if(K){var I=K.Bold||"",H=K.Italic||"",J=I==""&&H==""?"":I+","+H,G=mstrmojo.array.find(this.items,this.itemIdField,J);G=G==-1?mstrmojo.array.find(this.items,"v2",J):G;return(G==-1?0:G);}}},onchange:function(){var I=this.parent.parent.model;if(I&&this.selectedItem){var H=this.selectedItem.v.split(","),G=italic="pru";if(H[0]!="pru"){G=H[0]=="-1"?"-1":"0";italic=H[1]=="-1"?"-1":"0";}I.set("Bold",G);I.set("Italic",italic);}},slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2178),slot:"0,2"},A({items:F.Sizes,cssClass:"mstrmojo-FormatEditor-fontSize",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Size,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Size",this.selectedItem.v);}},slot:"0,2"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3060),slot:"1,0"},{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-FormatEditor-fontEffect",postCreate:function(){this.addChildren(E({alias:"Underline",label:mstrmojo.desc(3061),pr:"Underline",modelBinding:"this.parent.parent.parent.model"}));this.addChildren(E({alias:"Strikeout",label:mstrmojo.desc(3062),pr:"Strikeout",modelBinding:"this.parent.parent.parent.model"}));},slot:"1,0"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3063),slot:"1,1"},mstrmojo.ColorPicker.createDropDown({pr:"Color",bindings:{fillColor:function(){var G=this.parent.parent.model;if(G){var H=G[this.pr];if(typeof (H)!="undefined"&&/^\d{1,8}$/.test(H)){return B.decodeColor(H);}}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.model){this.parent.parent.model.set(this.pr,this.fillColor=="transparent"?"pru":B.encodeColor(this.fillColor));}},slot:"1,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2036),slot:"1,1"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FormatEditor-fontPreview",text:mstrmojo.desc(2037),bindings:{m:"this.parent.parent.model",cssText:function(){var H=this.m.Color,J=this.m.Size,K=this.m.Name,I=this.m.Bold,G=this.m.Italic,M=this.m.Underline,L=this.m.Strikeout;H=/^\d{1,8}$/.test(H)?B.decodeColor(H):B.decodeColor(F.DefaultFormat.FormattingFont.Color);J=J||F.DefaultFormat.FormattingFont.Size;K=K||F.DefaultFormat.FormattingFont.Name;I=I=="-1"?"bold":"normal";G=G=="-1"?"italic":"normal";M=parseInt(M)==-1;L=parseInt(L)==-1;return";font-family:"+K+";font-style:"+G+";font-weight:"+I+";font-size:"+J+"pt;color:"+H+";text-decoration:"+(M?" underline ":"")+(L?" line-through ":"");}},slot:"1,1"}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo.Label","mstrmojo.ColorPicker");var B=mstrmojo.hash,A=mstrmojo.color;mstrmojo.FillFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FillFormatter",cssClass:"mstrmojo-FillFormatter",isChart:false,markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){B.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"fill",cssClass:"mstrmojo-FormatEditor-fill",legend:mstrmojo.desc(2885,"Fill"),bindings:{legend:"this.parent.isChart ? mstrmojo.desc(3902, 'Series Colors') : mstrmojo.desc(2885, 'Fill')"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060),cssClass:"label"},mstrmojo.ColorPicker.createDropDown({bindings:{m:"this.parent.parent.model",fillStyle:function(){var H=this.m,J=H.FillStyle;if(J==2){var E=parseInt(H.GradientAngle,10),I=E===0?1:0,D=A.decodeColor(H.FillColor),K=A.decodeColor(H.GradientColor),C=parseInt(H["Gradient"+(E===0?"X":"Y")+"Offset"],10)==100?1:0,G=(C!=1)?mstrmojo.css.buildGradient(I,D,K):mstrmojo.css.buildGradient(I,K,D);this.set("gradientCss",G.n+":"+G.v);this._updateGradientInfo();}else{var F=this.m.FillColor;if(typeof (F)!="undefined"&&/^\d{1,8}$/.test(F)){F=A.decodeColor(F);}else{F="transparent";}this.set("fillColor",F);}return J||0;}},_updateGradientInfo:function(){var C=this.m;this.gradient=mstrmojo.hash.copy({FillColor:A.decodeColor(C.FillColor),GradientColor:A.decodeColor(C.GradientColor)},B.copy(C));},onfillColorChange:function(){this.m.FillColor=(this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));this.m.FillStyle=0;},ongradientChange:function(C){var F=["FillStyle","FillColor","GradientColor","GradientXOffset","GradientYOffset","GradientAngle"];for(var E=0;E<F.length;E++){var D=C.value[F[E]];this.m[F[E]]=/Color$/.test(F[E])?A.encodeColor(D):D;}this.m.FillStyle=2;}},{showGradients:true})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo._FormatDefinition","mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ColorPicker");var C=mstrmojo.hash,A=mstrmojo.color,D=mstrmojo._FormatDefinition;var B=function(F,I,E){var H=["Left","Right","Top","Bottom"];for(var G=0;G<3;G++){F[H[G]+I]=E;}F.set(H[3]+I,E);};mstrmojo.BorderFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.BorderFormatter",cssClass:"mstrmojo-BorderFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){C.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"borders",cssClass:"mstrmojo-FormatEditor-border",legend:mstrmojo.desc(2886),children:[{scriptClass:"mstrmojo.Table",alias:"borderTable",cssText:"width:100%;",rows:1,cols:2,children:[{scriptClass:"mstrmojo.List",alias:"borderTypes",selectedIndex:0,cssClass:"borderTypes",items:[{n:'<img border="0" align="absmiddle" src="../images/borders_none.gif" alt=""> '+mstrmojo.desc(2057),v:1},{n:'<img border="0" align="absmiddle" src="../images/borders_all.gif" alt=""> '+mstrmojo.desc(2058),v:2},{n:'<img border="0" align="absmiddle" src="../images/borders_custom.gif" alt=""> '+mstrmojo.desc(2056),v:3}],slot:"0,0",bindings:{m:"this.parent.parent.parent.model",selectedIndex:function(){var E=this.m;if(C.isEmpty(E)){return 0;}if(E.LeftStyle==0&&E.TopStyle==0&&E.RightStyle==0&&E.BottomStyle==0){return 0;}else{if(E.LeftStyle==E.TopStyle&&E.LeftStyle==E.RightStyle&&E.LeftStyle==E.BottomStyle){return 1;}}return 2;}},onchange:function(E){if(this.m){var G=this.parent.borderAndColor;if(!G){return ;}if(this.selectedIndex===0){var H=["Left","Right","Top","Bottom"];for(var F=0;F<4;F++){this.m.set(H[F]+"Style","0");this.m.set(H[F]+"Color","0");}}}}},{scriptClass:"mstrmojo.Container",alias:"borderAndColor",markupString:'<div class="borderStyles"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.Container",alias:"allBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==1"},children:[{scriptClass:"mstrmojo.Table",alias:"allBorders",rows:1,cols:3,onshowChange:function(){if(this.show){B(this.m,"Style",this.styles.value);B(this.m,"Color",A.encodeColor(this.colors.fillColor));}},bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var F=["Left","Right","Top","Bottom"];var E=[{scriptClass:"mstrmojo.Pulldown",alias:"styles",items:D.BorderStyles,itemIdField:"v",bindings:{m:"this.parent.m",value:function(){var I=this.m.LeftStyle,K=this.m.RightStyle,J=this.m.TopStyle,H=this.m.BottomStyle;var G=0;if(I==K&&K==H&&H==J){G=mstrmojo.array.find(D.BorderStyles,"v",I);}G=G==-1?0:G;return this.items[G][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){B(this.m,"Style",this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({alias:"colors",bindings:{m:"this.parent.m",fillColor:function(){var H=this.m.LeftColor,K=this.m.RightColor,J=this.m.TopColor,G=this.m.BottomColor;if(H==K&&K==G&&G==J){var I=H;}if(typeof (I)!="undefined"&&/^\d{1,8}$/.test(I)){return A.decodeColor(I);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){B(this.m,"Color",this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"})];this.addChildren(E);}}]},{scriptClass:"mstrmojo.Container",alias:"customBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==2"},children:[{scriptClass:"mstrmojo.Table",alias:"customBorders",rows:1,cols:3,bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var H=["Left","Right","Top","Bottom"];var G=[];for(var F=0;F<H.length;F++){var E=H[F];G.push({scriptClass:"mstrmojo.Label",text:mstrmojo.desc({Left:3528,Right:3529,Top:3526,Bottom:3527}[E]),alias:E,slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",items:D.BorderStyles,itemIdField:"v",pr:E+"Style",bindings:{m:"this.parent.m",value:function(){var K=this.m.LeftStyle,M=this.m.RightStyle,L=this.m.TopStyle,J=this.m.BottomStyle;var I=mstrmojo.array.find(D.BorderStyles,"v",this.m[this.pr]);I=I==-1?0:I;return this.items[I][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({cssClassx:"mstrmojo-FormatEditor-colorPicker",alias:E+"Color",pr:E+"Color",bindings:{m:"this.parent.m",fillColor:function(){var J=this.m.LeftColor,M=this.m.RightColor,L=this.m.TopColor,I=this.m.BottomColor;var K=this.m[this.pr];if(typeof (K)!="undefined"&&/^\d{1,8}$/.test(K)){return A.decodeColor(K);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"}));}this.addChildren(G);}}]}],slot:"0,1"}]},{scriptClass:"mstrmojo.Label",cssClass:"borderPreview",text:mstrmojo.desc(7941),bindings:{m:"this.parent.parent.model",cssText:function(){var G={0:"None",3:"Dashed",4:"Dotted",6:"Double",7:"Solid"},E={1:"Thin",5:"Thick",6:"medium"};var F=this.parent.borderTable.borderTypes.selectedIndex;return";border-left-style: "+(G[this.m.LeftStyle]||"solid")+";border-right-style: "+(G[this.m.RightStyle]||"solid")+";border-top-style: "+(G[this.m.TopStyle]||"solid")+";border-bottom-style: "+(G[this.m.BottomStyle]||"solid")+";border-left-color: "+A.decodeColor(this.m.LeftColor||"0")+";border-right-color: "+A.decodeColor(this.m.RightColor||"0")+";border-top-color: "+A.decodeColor(this.m.TopColor||"0")+";border-bottom-color: "+A.decodeColor(this.m.BottomColor||"0")+";border-left-width: "+(E[this.m.LeftStyle]||"thin")+";border-right-width: "+(E[this.m.RightStyle]||"thin")+";border-top-width: "+(E[this.m.TopStyle]||"thin")+";border-bottom-width: "+(E[this.m.BottomStyle]||"thin");}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=(Y)?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=(Y)?0:U-1;}else{V+=(Y)?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(j){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,h=this._last_hit;if(!this.noCache&&(d||h)){var g=this.filterCandidates(a,j,this.REQUEST_THRESHOLD),b=g.length,f=this.suggestCount,U=false;if(!X&&b<f){var V=h&&h.pattern;if(h&&V&&(j.indexOf(V)>-1)){U=true;var m=this.filterCandidates(h.items,j,this.REQUEST_THRESHOLD),Y=m&&m.length,W=mstrmojo.array,k=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(g,k,m[Z][k])===-1){g.push(m[Z]);}}b=g.length;}}if(!X&&((j.length>2&&b<this.REQUEST_THRESHOLD)||(b<f))){this.requestCandidates(j);return -1;}return(b<f)?g:g.slice(0,f);}this.requestCandidates(j);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(f){if(!f){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var k=d.getSearchPattern(),a=f.items;X._last_hit={items:a,pattern:U};X.sz=f.sz;if(!X.noCache&&a){var g=X.candidates&&X.candidates.items||[],h=[].concat(a);for(var Z=0,b=a.length;Z<b;Z++){var Y=h[Z];if(mstrmojo.array.indexOf(g,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=g.concat(a);}}if(k&&k.indexOf(U)>-1){var j=X.filterCandidates(a,k);X.updateSuggestion(j);}},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:((V)?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var V=this.zIndex;this.openPopup("ob",{zIndex:(V&&(V+10))||110});this.ob.browser.browse({folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes});this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopup:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInputBox-suggest",showTitle:false,modal:false,autoClose:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U&&U.autoSelect){this.list.singleSelect(0);}},onClose:function F(){this.list.clearSelect();if(this.opener){this.opener.suggestionShown=false;}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});},ENUM_STATES:{UNDETERMINED:F,VALID:E,INVALID:D}}));}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.LegacySuggestionList");mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function J(E){var o=E.ownerDocument,q=o.createElement("span");return q;}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));var I=mstrmojo.dom,K=mstrmojo.css,h=mstrmojo.Enum_Keys,C=mstrmojo.range,S=C.EDGE,b=mstrmojo.ME.MetricToken.isDelimiter,H=mstrmojo.expr;function j(o){var E=(I.isIE&&!I.isIE9)?o.keyCode:o.charCode;return(E>0)?String.fromCharCode(E):null;}mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",makeObservable:true,showDesc:true,showPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "document.oncontextmenu =  mstrmojo.all.{@id}.fnContextMenu;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.LegacySuggestionList",items:null,itemFunction:function D(p,E,o){return new mstrmojo.ME.MetricToken({data:p});},listMapper:mstrmojo.ME.SpanListMapper,isDelimiter:b,postBuildRendering:function O(){if(this._super){this._super();}if(I.isFF){document.body.spellCheck=false;}},fnContextMenu:function F(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},handlekeydown:function M(x){x=x||window.event;var E=x.keyCode||x.charCode,o=false,u=C.getRangeInfo();if(x.ctrlKey&&this.doubleByte){this.doubleByte=false;var w=this.prev_rInfo,t=u;s=t.startContainer.data.slice(w.startOffset,u.startOffset);this.widgetHandleImeInput(w,s);return ;}switch(E){case h.DELETE:if(!this.doubleByte){try{this.widgetHandleDelete(u);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(q){}o=true;}break;case h.BACKSPACE:if(!this.doubleByte){try{this.widgetHandleBackspace(u);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(p){}o=true;}break;case h.ENTER:case h.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}o=true;break;case h.ESCAPE:this.endTokenSuggestion();o=true;break;case 86:if(x.ctrlKey){this._saveRangeInfo=C.getRangeInfo();this.clipboardNode.focus();o=false;}break;case 229:if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=u;this.prev_items=this.items;}break;default:}if(o){I.stopPropogation(window,x);I.preventDefault(window,x);return false;}else{return true;}},handlekeypress:function A(t){t=t||window.event;var u=j(t),E=t.keyCode||t.charCode,p=false,q;if(u&&!(u==="c"&&t.ctrlKey)){try{this.widgetHandleInput(C.getRangeInfo(),u);this.raiseChangeEvent({type:"input",characeter:u});if(!this.isDelimiter(u)){if(this.useKeyDelay){var r=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){r.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion();}}catch(o){}p=true;}if(p){I.stopPropogation(window,t);I.preventDefault(window,t);return false;}else{return true;}},handlekeyup:function P(p){var E=p.keyCode||p.charCode,o;if(E===h.LEFT_ARROW||E===h.RIGHT_ARROW){o=this.findObjectToken();if(o&&o===this._saveActiveToken){this.startTokenSuggestion(o);}else{this.endTokenSuggestion();}}else{if(E===h.UP_ARROW){this.preHighlight();}else{if(E===h.DOWN_ARROW){this.nextHighlight();}}}this._saveRangeInfo=C.getRangeInfo();},handlemouseup:function V(u){var o=this.findObjectToken();if(o&&o===this._saveActiveToken){this.startTokenSuggestion(o);}else{this.endTokenSuggestion();}var q=C.getRangeInfo();if(this.doubleByte){var t=this.prev_rInfo,p=this._saveRangeInfo;s=p.startContainer.data.slice(t.startOffset,p.startOffset);if(s!==""){var E=this.widgetHandleImeInput(t,s);this.prev_items=this.items;var o=I.findWidget(q.startContainer);if(o){this._delaySetTextCaretPos(o.domNode,q.startOffset);}else{this._delaySetTextCaretPos(E.domNode,q.startOffset-1);}}this.prev_rInfo=q;}this._saveRangeInfo=q;},handlepaste:function T(u){var o=this.clipboardNode.value;this.clipboardNode.value="";var r=[],E=o&&o.length,q,p="",w;if(E>0){for(q=0;q<E;q++){w=o.charAt(q);if(this.isDelimiter(w)){if(!mstrmojo.string.isEmpty(p)){r.push({v:p,isNew:true});p="";}r.push({v:w,isDelimiter:true,isNew:true});}else{p=p+w;}}if(!mstrmojo.string.isEmpty(p)){r.push({v:p,isNew:true});p="";}this.insertTokens(r);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function n(){var E=[],p=this.items,o;for(o=0,len=p.length;o<len;o++){E[o]=p[o].v;}return E.join("| ");},replaceErrorToken:function W(p){var o=this.items,q=mstrmojo.array.find(o,"sta",-1),E={v:p.n,oi:p,isNew:true};if(q>-1){this.remove(q);this.add([E],q);}},widgetHandleDelete:function Q(r){if(r.collapsed){var q,p,E,t=r.startOffset,o=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,r.startContainer,false,document.body)){C.collapseOnNode(this.editNode,false);return ;}q=C.getEdgeInfo(r.startContainer,r.startOffset);p=I.findWidget(r.startContainer);E=this.itemIndex(p.data);if(q===S.EDGE_END){E++;p=o[E];t=0;}if(!p){C.collapseOnNode(this.editNode,false);return ;}if(p.length()===1){this.remove(E);p=o[E];if(p){C.collapseOnNode(p.domNode,true);}else{C.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{p.spliceContent(t,1);C.collapseOnTextNode(p.domNode,t);}}else{this.widgetDeleteTokens(r);}},widgetHandleBackspace:function a(r){if(r.collapsed){var q,p,E,t=r.startOffset,o=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,r.startContainer,false,document.body)){if(r.startOffset>0&&I.isFF){p=o[this.items.length-1];C.collapseOnNode(p.domNode,false);r=C.getRangeInfo();q=C.getEdgeInfo(r.startContainer,r.startOffset);}else{C.collapseOnNode(this.editNode,true);return ;}}q=C.getEdgeInfo(r.startContainer,r.startOffset);p=I.findWidget(r.startContainer);E=this.itemIndex(p.data);if(q===S.EDGE_BEGIN){E--;p=o[E];t=p.length();}if(!p){C.collapseOnNode(this.editNode,true);return ;}if(p.length()===1){this.remove(E);p=o[E-1];if(p){C.collapseOnNode(p.domNode,false);this.checkMergeTwoTokens(E-1,E);p=o[E-1];}else{C.collapseOnNode(this.editNode,true);}}else{p.spliceContent(t-1,1);C.collapseOnTextNode(p.domNode,t-1);}}else{this.widgetDeleteTokens(r);}},widgetHandleInput:function c(u,w){if(!u.collapsed){this.widgetDeleteTokens(u);u=C.getRangeInfo();}var p,x,y,z,E,o,q=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,u.startContainer,false,document.body)){this.add([{v:w,isDelimiter:this.isDelimiter(w),isNew:true}],0);x=q[0];C.collapseOnTextNode(x.domNode,1);return ;}p=C.getEdgeInfo(u.startContainer,u.startOffset);x=I.findWidget(u.startContainer);y=this.itemIndex(x.data);if(this.isDelimiter(w)){z={v:w,isDelimiter:true,isNew:true};if(p===S.EDGE_MIDDLE){var r=x.split2Tokens(u.startOffset);this.remove(y);this.add([r[0],z,r[1]],y);y=y+1;}else{y=(p===S.EDGE_BEGIN)?y:y+1;this.add([z],y);}x=q[y];C.collapseOnNode(x.domNode,false);}else{o=u.startOffset;if(x.isDelimiter()){E=q[(p===S.EDGE_BEGIN)?y-1:y+1];if(E&&!E.isDelimiter()){x=E;o=(p===S.EDGE_BEGIN)?x.length():0;}}if(!x.isDelimiter()){x.spliceContent(o,0,w);C.collapseOnTextNode(x.domNode,o+1);}else{this.add([{v:w,isNew:true}],(p===S.EDGE_BEGIN)?y:y+1);x=q[(p===S.EDGE_BEGIN)?y:y+1];C.collapseOnNode(x.domNode,false);}}},widgetHandleImeInput:function c(r,u){if(!r.collapsed){this.widgetDeleteTokens(r);r=C.getRangeInfo();}var p,w,x,y,E,o,q=this.ctxtBuilder.itemWidgets;if(!I.contains(this.editNode,r.startContainer,false,document.body)){this.clearTokens();this.add([{v:u,isDelimiter:this.isDelimiter(u),isNew:true}],0);q=this.ctxtBuilder.itemWidgets;w=q[0];C.collapseOnTextNode(w.domNode,1);this._delaySetCaretPos(w.domNode,false);return ;}p=C.getEdgeInfo(r.startContainer,r.startOffset);w=I.findWidget(r.startContainer);x=this.itemIndex(w.data);o=r.startOffset;if(w.isDelimiter()){this.clearTokens();this.set("items",this.prev_items);q=this.ctxtBuilder.itemWidgets;E=q[(p===S.EDGE_BEGIN)?x-1:x+1];if(E&&!E.isDelimiter()){w=E;o=(p===S.EDGE_BEGIN)?w.length():0;}}if(!w.isDelimiter()){w.spliceContent(o,0,u);this._delaySetTextCaretPos(w.domNode,o+u.length);}else{this.add([{v:u,isNew:true}],(p===S.EDGE_BEGIN)?x:x+1);w=q[(p===S.EDGE_BEGIN)?x:x+1];this._delaySetCaretPos(w.domNode,false);}this.startTokenSuggestion();return w;},findObjectToken:function B(){var r=C.getRangeInfo(),p=I.findWidget(r.startContainer);if(!I.contains(this.editNode,r.startContainer,false,document.body)){return null;}if(!p||p===this||!p.isDelimiter){return null;}if(p&&!p.isDelimiter()){return p;}var q=C.getEdgeInfo(r.startContainer,r.startOffset),o=this.ctxtBuilder.itemWidgets,E=this.itemIndex(p.data);p=o[(q===S.EDGE_BEGIN)?E-1:E+1];if(p&&!p.isDelimiter()){return p;}return null;},checkMergeTwoTokens:function Y(r,p){var q=this.ctxtBuilder.itemWidgets,o=q[r],E=q[p];if((o&&!o.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([r,p]);this.add([o.mergeTo(E)],r);C.collapseOnTextNode(q[r].domNode,o.length());}},insertTokens:function f(t){var r=this._saveRangeInfo;if(!r||!I.contains(this.editNode,r.startContainer,false,document.body)){this.add(t);this.raiseChangeEvent({type:"insert"});return ;}var q=C.getEdgeInfo(r.startContainer,r.startOffset),o=I.findWidget(r.startContainer),E=this.itemIndex(o.data);if(q===S.EDGE_MIDDLE){var p=o.split2Tokens(r.startOffset);this.remove(E);t.unshift(p[0]);t.push(p[1]);this.add(t,E);}else{E=(q===S.EDGE_BEGIN?E:E+1);this.add(t,E);}E=E+t.length-1;o=this.ctxtBuilder.itemWidgets[E];this._delaySetCaretPos(o.domNode,false);this.raiseChangeEvent({type:"insert"});},clearTokens:function X(E){this.set("items",E||[]);this._saveRangeInfo=null;this._delaySetCaretPos(this.editNode,false);},focus:function d(){var o=this.ctxtBuilder.itemWidgets,E=o.length;this._delaySetCaretPos(E>0?o[E-1].domNode:this.editNode,false);},startTokenSuggestion:function i(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length==0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[H.TP.FOLDER,H.TP.FACT,H.TP.ATTR,H.TP.FUNCTION,H.TP.FILTER,H.STP.PROMPT_OBJECTS,H.TP.ATTR,H.TP.DIM,H.TP.METRIC,H.TP.ROLE].join(","),getSearchPattern:function L(){var o=this._saveActiveToken,p=o&&o.data.v,E=p&&p.length;if(E>2){if(p.charAt(0)==="["){p=p.substring(1);}if(p.charAt(p.length-1)==="]"){p=p.substring(0,p.length-1);}}return p||"";},getSuggestionPos:function R(){var E=this._saveActiveToken,o=null,q;if(E){q=mstrmojo.dom.position(E.domNode,true);o={left:Math.round(q.x)+"px",top:Math.round(q.y+q.h)+"px",zIndex:100};}return o;},item2textCss:function G(E){return(this._super&&this._super(E))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr","-99":"br"}[E.t]||"";},onBrowserOpen:function Z(){this.editNode.blur();},onSuggestionItemSelect:function g(o){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){E.setItemInfo(o);this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function k(E,p){var o=this.editNode,q=function(){o.focus();o.focus();C.collapseOnNode(E,p);};window.setTimeout(q,0);},_delaySetTextCaretPos:function k(E,q){var o=this.editNode,p=function(){o.focus();o.focus();C.collapseOnTextNode(E,q);};window.setTimeout(p,0);},getCandidatesThroughTaskCall:function N(o,E){o.objectType="11,12,13,43,4";o.rootFolderType=39;o.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(o,E);},endTokenSuggestion:function m(){var E=this._saveActiveToken;if(E){E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function U(y){var o=y.startOffset,E=y.endOffset,AB=I.findWidget(y.startContainer),z=I.findWidget(y.endContainer),t=this.itemIndex(AB.data),q=this.itemIndex(z.data),u=[],w=C.getEdgeInfo(y.startContainer,o),AA=C.getEdgeInfo(y.endContainer,E),x=(w===S.EDGE_BEGIN?t:t+1),p=(AA===S.EDGE_END?q:q-1),r;if(AB===z){if((w===S.EDGE_BEGIN)&&(AA===S.EDGE_END)){this.remove(t);z=this.ctxtBuilder.itemWidgets[t-1];if(z){C.collapseOnNode(z.domNode,false);}else{C.collapseOnNode(this.editNode,true);}}else{AB.spliceContent(o,E-o);C.collapseOnTextNode(z.domNode,o);}}else{for(r=x;r<=p;r++){u.push(r);}this.remove(u);if(w===S.EDGE_MIDDLE){AB.spliceContent(o);}if(AA===S.EDGE_MIDDLE){z.spliceContent(0,E);}if(w===S.EDGE_BEGIN){AB=this.ctxtBuilder.itemWidgets[t-1];}if(AB){C.collapseOnNode(AB.domNode,false);}else{C.collapseOnNode(this.editNode,false);}t=(w===S.EDGE_BEGIN)?t-1:t;this.checkMergeTwoTokens(t,t+1);}this.editNode.focus();}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.fx","mstrmojo.Box","mstrmojo.Editor","mstrmojo.Button","mstrmojo._FormatDefinition","mstrmojo.TabListContainer","mstrmojo.TabNameList","mstrmojo.StackContainer","mstrmojo.FontFormatter","mstrmojo.NumberFormatter","mstrmojo.AlignmentFormatter","mstrmojo.PaddingFormatter","mstrmojo.FillFormatter","mstrmojo.BorderFormatter");var C=mstrmojo.array,M=mstrmojo.hash,F=mstrmojo._FormatDefinition,B=mstrmojo.Button,L=F.MetricFormatTarget;var G="#999",E="mstrmojo-Editor-button",H=M.clone(F.DefaultFormat);H.FormattingPatternsChart={FillColor:"16777215",FillStyle:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0"};H.FormattingPatterns=M.clone(H.FormattingPatternsChart);var I={n:mstrmojo.desc(3434,"Number"),scriptClass:"mstrmojo.NumberFormatter",visible:false,pr:"FormattingNumber"},K={n:mstrmojo.desc(3435),scriptClass:"mstrmojo.Box",visible:false,pr:["FormattingAlignment","FormattingPadding"],cssClass:"alignmentPanel",children:[{scriptClass:"mstrmojo.AlignmentFormatter",bindings:{model:"this.parent.FormattingAlignment"}},{scriptClass:"mstrmojo.PaddingFormatter",bindings:{model:"this.parent.FormattingPadding"}}]},N={n:mstrmojo.desc(3433,"Font"),scriptClass:"mstrmojo.FontFormatter",visible:false,pr:"FormattingFont",cssClass:"mstrmojo-FormatEditor-fontTable",cellPadding:5},D={n:mstrmojo.desc(2886,"Borders"),scriptClass:"mstrmojo.BorderFormatter",visible:false,pr:"FormattingBorder"},A={n:mstrmojo.desc(3905,"Background"),scriptClass:"mstrmojo.FillFormatter",visible:false,pr:"FormattingPatterns"},J={n:mstrmojo.desc(3479,"Graph"),scriptClass:"mstrmojo.FillFormatter",visible:false,isChart:true,pr:"FormattingPatternsChart"};mstrmojo.ME.MetricFormatEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.MetricFormatEditor",cssClass:"mstrmojo-FormatEditor",title:mstrmojo.desc(2116,"Format"),model:null,obModel:null,_initModel:function(){if(!this.model){this.model={};for(var O=0;O<L.length;O++){this.model[L[O].p]={};}}if(!this.obModel){this.obModel=new mstrmojo.Model({onlevelNameChange:function(P){var Q=P.valueWas;if(Q){this._updateModel(Q);}this._setCurrentFormat();},onmodelChange:function(){return this.model?this._setCurrentFormat():false;},_updateModel:function(Q){var R=M.copy(this.currentFormat),Q=Q||this.levelName,P=this.model[Q];if(!P){P=this.model[Q]={};}F.extractModel(R,P,H);this.model.set(Q,P);},_setCurrentFormat:function(){var P=this.model?M.copy(this.model[this.levelName||L[0].p]):{};P=F.getStandardFormat(P,H);this.set("currentFormat",P);}});}},init:function(O){this._initModel();this._super(O);},onmodelChange:function(){this._initModel();var Q=this.obModel,O=M.clone(this.model)||{};if(O){var P={};if(O&&O[L[0].p]){var R=O[L[0].p].FormattingPatterns;if(R){for(pr in R){if(pr.match(/^Series\w+/gi)){P[pr.substring(6,pr.length)]=R[pr];}}}O[L[0].p].FormattingPatternsChart=P;}}if(O&&!O.attachEventListener){M.make(O,mstrmojo.Obj);}Q.set("model",O);Q.set("levelName",Q.levelName||L[0].p);},promptOnClearFormatRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:"",showTitle:false,children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",bindings:{text:function(){return mstrmojo.desc(9564,"Clear all formatting?");}}},{scriptClass:"mstrmojo.HBox",cssText:"float:right; margin-bottom:5px;",alias:"buttonBar",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"Ok"),onclick:function(){var O=this.parent.parent;O.opener.onClearFormat();O.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var O=this.parent.parent;O.close();}}]}]},prompt2ClearFormat:function(){this.openPopup("promptOnClearFormatRef",{zIndex:this.zIndex+1});},onClearFormat:function(){var P=this.obModel;for(var O=0;O<L.length;O++){delete P.model[L[O].p];}P._setCurrentFormat();},onOK:function(){var Q=this.obModel;Q._updateModel();var R=Q.model[L[0].p];if(R){var P=R.FormattingPatterns,O=R.FormattingPatternsChart;if(O){for(pr in H.FormattingPatternsChart){if(O[pr]!=null){P["Series"+pr]=O[pr];}}delete O;}}F.saveFormatModel(Q.model,this.model,[L[0].p,L[1].p],F.DefaultFormat);},children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.HBox",alias:"btns",children:[{scriptClass:"mstrmojo.Pulldown",alias:"which",items:L,itemIdField:"v",bindings:{value:function(){var O=C.find(this.items,"p",this.parent.parent.parent.obModel.levelName);return this.items[O!=-1?O:0][this.itemIdField];}},cssClass:" mstrmojo-FormatEditor-DropDownButton",popupToBody:true,popupZIndex:100,value:L[0].v,onvalueChange:function(){var R=this.parent.parent.parent,P=this.parent.parent.formatPanels,S=P&&P.stck,Q=this.selectedItem;if(R&&R.obModel&&S){R.obModel.set("levelName",Q?Q.p:L[0].p);var O=C.find(S.children,"pr",J.pr);if(Q==null||Q.p==L[0].p){if(O==-1){S.addChildren(J);S.onchildRenderingChange(J);}}else{S.removeChildren(S.children[O]||[]);}}}},new B.newInteractiveButton(mstrmojo.desc(5976),function(O){var P=this.parent.parent.parent;P.prompt2ClearFormat();},G,{alias:"btnClear",cssClass:E+" clear"})]},{scriptClass:"mstrmojo.TabListContainer",alias:"formatPanels",listCssClass:"mstrmojo-FormatEditor-leftPanel",bindings:{currentModel:"this.parent.parent.obModel.currentFormat"},oncurrentModelChange:function(){this.parent.btns.which.onvalueChange();var O=this.lst;if(O.selectedIndex==0){O.onchange();}else{O.set("selectedIndex",0);}},children:[{scriptClass:"mstrmojo.TabNameList",alias:"lst",slot:"top",cssClass:"mstrmojo-FormatEditor-formatList",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>',onchange:function(){var R=this.parent,S=this.selectedIndex;if(R.stck&&S!=null&&S!=-1){var Q=this.items[S],O=Q&&Q.target;var T=O&&O.pr;if(T){if(T.constructor===Array){for(var P=0;P<T.length;P++){O.set(T[P],R.currentModel[T[P]]);}}else{O.set("model",R.currentModel[T]);}}}}},{scriptClass:"mstrmojo.StackContainer",cssClass:"mstrmojo-FormatEditor-rightPanel-container mstrmojo-FormatEditor-rightPanel",alias:"stck",slot:"stack",children:[I,K,N,D,A,J]}]}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",children:[new B.newInteractiveButton(mstrmojo.desc(2397),function(){var O=this.parent.parent;O.close();O.onOK&&O.onOK();},G,{alias:"btnOk",cssClass:E}),new B.newInteractiveButton(mstrmojo.desc(2399),function(){var O=this.parent.parent;O.close();},G,{alias:"btnCancel",cssClass:E})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch");var A=mstrmojo.meta.TP,K="5CECE58CC1D549F890EB61C4DB2156A3",H="E0CCB9CF22104A489CBE78D974AFD19E",B=function(R,S){var Q=mstrmojo.insert({scriptClass:"mstrmojo.OBList",items:S});Q.render();return Q;},D={success:function(S){var T=this.ob,R=S.items,Q=T.pageCache[T.currentPage]._w;Q.set("items",R);this.ob=null;this.item=null;window.clearTimeout(T._btm);T.booklet.set("waiting",false);},failure:function(Q){window.alert(Q.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},C=function(T,S,Q){var U=O(T,S,false),R=!U;U=U||O(T,S,true);if(!U){T._btm=window.setTimeout(function(){T.booklet.set("waiting",true);},300);Q.ob=T;Q.item=S;T.dataProvider.fetchFolderContents(T,S,Q);}else{G(T,S,U,true,R);}},N=function(R,S,T,Q){C(R,{fid:R.pageCache[R.currentPage].did,blockBegin:S,searchPattern:T,recursive:Q},D);},I=function(R,S){var Q=S.anc;Q=Q&&Q.items;Q=Q&&Q[0];Q=Q&&Q.items;R.set("canGoUp",!(!S.pf||!Q));},G=function(U,T,V,S,R){delete U._btm;var Q;if(!S){Q=B(this,V.items);Q.attachEventListener("change",U.id,"navigate");}else{Q=V._w;}U.booklet.turn(Q,!R);if(!S){E(U,T,Q,V);}U.set("currentFolder",V);U.set("currentPage",U.currentPage+(R?-1:1));I(U,V);},F={success:function(R){var S=this.ob;if(S){window.clearTimeout(S._btm);if(!R.items){R.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var Q=function T(U){var X=U.length;for(var V=0;V<X;V++){var W=U[V];if(W.did===K||W.did===H){W.n=(W.did===K)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(W.items){Q(W.items);}}};if(R.did===K||R.did===H){R.n=(R.did===K)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(R.anc&&R.anc.items){Q(R.anc.items);}}G(S,this.item,R,false,false);this.ob=null;this.item=null;}},failure:function(Q){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(Q);}else{window.alert(Q.getResponseHeader("X-MSTR-TaskFailureMsg"));}}},E=function(U,T,S,V){var W=U.currentPage+1;var R=U.pageCache.length;for(var Q=W;Q<R;Q++){U.pageCache[Q]._w.destroy();delete U.pageCache[Q].items;}U.pageCache=U.pageCache.slice(0,W);V._w=S;V._k=T.k;U.pageCache[W]=V;U.cacheChange();},O=function(T,S,R){var U=T.currentPage+(R?-1:1);if(T.pageCache.length>U&&U>=0){var Q=T.pageCache[U];if(Q._k==S.k){return Q;}}return false;},M=function(S){var R=S.pageCache.length;for(var Q=0;Q<R;Q++){S.pageCache[Q]._w.destroy();}S.pageCache=[];S.currentPage=-1;S.cacheChange();},J=function(S,R){if(R&&R.acg==33){return ;}var Q={};if(R){Q.k=R.did;Q.fid=R.did;}else{if(S.rootFolderID){Q.k=S.rootFolderID;Q.fid=S.rootFolderID;}else{if(S.rootFolderType){Q.k=S.rootFolderType;Q.fty=S.rootFolderType;}else{if(S.folderLinksContextId){Q.k=S.folderLinksContextId;}}}}C(S,Q,F);},P=function(V,Q,S){if(!S){return Q;}var T=V.showCompletePath,X=Q[0],U,R;while(X){for(var W=0;W<S.length;){if(X.did==S[W].did){S.splice(W,1);X._isSc=true;}else{W++;}}R=X;X._open=true;X=X.items;X=X&&X[0];if(!X){R.lastLeaf=true;}}if(!T){X=Q[0];while(X){if(X._isSc){Q[0]=X;break;}X=X.items;X=X&&X[0];}}return Q.concat(S);},L=function(R,Q,S){R._naviInfo=P(R,Q,S);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,showCompletePath:true,dataProvider:mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"}),markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var Q=this.opener.parent.parent,S=this.tree,R=Q._naviInfo;if(S.items!=R){S._pup=this;this.ob=Q;S.set("items",R);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(T,Q,R){var S=mstrmojo.WidgetTree.prototype.itemFunction(T,Q,R);if(T._open){S.state=1;}S._ll=!!T.lastLeaf;S._pup=R._pup;S.onmousedown=function(U){if(!this._ll){var V=mstrmojo.dom.eventTarget(U.hWin,U.e);if(V==this.domNode||V==this.textNode){var W=this._pup;W.close();J(W.ob,this.data);}}};S.markupMethods.onstateChange=function(){var U=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[U]||"closed");this.itemsContainerNode.style.display=(U===1)?"block":"none";};return S;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up one level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 5px 0; ",width:"105px",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,bindings:{quickSearch:"this.parent.parent.quickSearch"},preFetch:function(){this.objectTypes=(this.parent.parent.browsableTypes)?this.parent.parent.browsableTypes:this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssText:"width:100%;background-color:white;",alias:"booklet"},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046),p:mstrmojo.desc(1058),n:mstrmojo.desc(1059),l:mstrmojo.desc(4049),pgs:mstrmojo.desc(5972),gt:mstrmojo.desc(5878),v:mstrmojo.desc(6079)},onvisibleChange:function(R){var T=parseInt(this.height,10),Q=this.np>1,S={target:this.domNode,props:{height:{start:(Q?0:T),stop:(Q?T:0),suffix:"px"}},onEnd:function(){if(Q){this.target.style.overflow="visible";}}},U=new mstrmojo.fx.AnimateProp(S);this.domNode.style.overflow="hidden";U.play();},onifsChange:function(Q){var R=this.np;mstrmojo.hash.copy(Q.value,this);if(this.np>1){this.children=null;this.refresh();}if(R<=1&&this.np>1||R>1&&this.np<=1||R===0&&this.np>0){this.set("visible",this.np>1);}this.cssText="";}}],postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var S=this.searchUpBar;if(S&&S.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var Q=this.obSearchBox.contentWidget||this.obSearchBox;Q.attachEventListener("ifsChange",this.id,function(T){this.obIncFetch.set("ifs",T.value);});}if(this.obIncFetch){var R=this.obIncFetch;R.attachEventListener("fetch",this.id,function(T){R.cp=T.v;R.children=null;R.refresh();N(this,(T.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}},onSearchItemsChange:function(R){var S=R.value,Q=this.pageCache[this.currentPage]._w;if(!S||S.length==0){S=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}Q.set("items",S);},navigate:function(Q){var R=Q&&Q.src.selectedItem;if(R&&R.did=="empty"){return ;}if(!R||R[A]==8){J(this,R);}else{if(R){this.select(R);}}},onFishEyeChange:function(Q){this.goToPage(Q.value);},goToPage:function(Q){if(Q<this.pageCache.length&&Q!=this.currentPage){var S=Q>this.currentPage,R=this.pageCache[Q];this.set("currentPage",Q);this.booklet.turn(R._w,S);this.set("currentFolder",R);I(this,R);}},oncurrentPageChange:function(Q){if(this.fishEye){this.fishEye.setSelectedIndex(Q.value);}var R=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(R.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",R.items||[]);this.obSearchBox.set("totalSize",R.sz);this.obSearchBox.set("rootID",R.did);this.obSearchBox.clearSearch();}if(this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(R.sz/R.bc)+((R.sz%R.bc>0)?1:0),cp:Math.floor(R.bb/R.bc)+((R.bb%R.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(R){for(var Q in R){this[Q]=R[Q];}if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}M(this);this.navigate();},close:function(){var R=this.ctx||this,Q=R.onCloseCB;if(Q){Q[0][Q[1]]();}R.set("visible",false);},select:function(R){var Q=this.onSelectCB;if(Q){Q[0][Q[1]](R);}if(this.closeOnSelect){this.close();}},goUp:function(){if(this.canGoUp){J(this,{did:this.currentFolder.pf});}},oncurrentFolderChange:function(Q){var R=Q.value;L(this,R.anc.items,R.sc);},refreshContent:function(Q){N(this,Q);},onError:null,onheightChange:function(){var Q=["titleBar","fishEye","searchUpBar","obIncFetch"],T=0,S=0;for(var R in Q){T+=parseInt(this[Q[R]].domNode.offsetHeight);}S=parseInt(this.height)-T;this.booklet.set("height",S+"px");}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser");function B(){var E={alias:"newFolder",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon nf",title:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var F=this.parent.parent.parent;F.openPopup("newFolder",{zIndex:F.zIndex+10});}},D=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);tc=D[0].children;if(tc&&tc.length>2){tc.splice(2,1,E);}return D;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B()});var A={success:function(D){var E=this.parent;if(E.onObjectSaved){E.onObjectSaved({name:E.name,did:D.did,desc:E.desc});}mstrmojo.confirm(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",E.typeDesc||"Object").replace("###",E.name),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(7984,"Object Saved"));E.ob.refreshContent();E.close();},failure:function(E){var D=parseInt(E.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,F=this.parent;if(D==2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",F.typeDesc||"Object").replace("###",F.name),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(219),function(){F.saveAs(true);},null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(218),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(3179));}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+E.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",help:"Save_As_dialog_box.htm",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3379,"To the folder:"),cssText:"padding-bottom:6px;"},{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,searchVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];}},{scriptClass:"mstrmojo.Table",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBSelect:function(D){this.set("name",D.n);},saveAsCallback:function C(){return A;},saveAs:function(F){var E=this.contPanel;this.name=E.name.value;this.desc=E.desc.value;if(!this.name){mstrmojo.confirm(mstrmojo.desc(3380,"Please enter valid name"),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return ;}var G=this.saveParams||{};G.folderID=this.ob.currentFolder.did;G.description=this.desc||"";G.name=this.name||"";G.saveAsOverwrite=!!F;if(this.sId){G.sessionState=this.sId;}var D=this.saveAsCallback();D.parent=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,D,G);},createFolder:function(F,I){if(!F){mstrmojo.confirm(mstrmojo.desc(3380),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return -1;}var G=this.newFolder,E=this.ob,J=E&&E.dataProvider,H=E&&E.currentFolder.did,D={success:function(K){E.refreshContent();G.contPanel.name.set("value","");G.contPanel.desc.set("value","");},failure:function(K){window.alert(K.getResponseHeader("X-MSTR-TaskFailureMsg"));}};J.newFolder(H,F,I,D);}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(G.createFolder(D,F)!=-1){E.close();}}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.close();}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ME.TokenInputBox");var H={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},D={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},E={0:mstrmojo.desc(9565,"Valid Metric Formula."),1:mstrmojo.desc(9106,"Require Validation?"),2:mstrmojo.desc(9566,"Validation in Progress..."),3:mstrmojo.desc(9567,"Validation Failed with Syntax Error!"),4:mstrmojo.desc(9568,"Validation Failed with Object Ambiguity!")};function B(J){if(!J){return H.VALID;}return{"-2147214845":H.ERROR,"-2147214846":H.AMBIGUITY}[J]||H.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricEditBox",vStatus:H.VALID,iStatus:"",showStatus:true,markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},markupMethods:{onvStatusChange:function(){var K=this.vStatus,J=this.vStatusNode;J.className="mstrmojo-MEBox-vStatus "+D[K];J.innerHTML=E[K];},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;this.iStatusNode.title=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:1000,}],init:function I(J){if(this._super){this._super(J);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function(){return this.inputBox.getSearchPattern();},getHighlightedText:function(K,J){return this.inputBox.getHighlightedText(K,J);},item2textCss:function C(J){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[J.t]||"";},handleSuggestionItemSelect:function(J){var K=this.abiguityDialog;if(J){K.onItemSelect(J);}K.close();},showDesc:true,showPath:true,abiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title","Object Ambiguity: '##'".replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.label.set("text",mstrmojo.desc(9569,"More than one object with the name '##' found. Select the object you would like to use:").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.LegacySuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"}}]},postBuildRendering:function A(){this._super();var J=function(){this.set("vStatus",H.UNKNOWN);this.set("iStatus","");};this.inputBox.attachEventListener("tokensModify",this.id,J);this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function G(J){this.inputBox.set("items",J.items);},handleValidation:function F(N){if(!N){this.set("vStatus",H.ERROR);return ;}N.vs=B(N.rjec);this.set("vStatus",N.vs);this.set("iStatus",N.rjed||"");this.updateInputBoxItems(N);this.inputBox.focus();if(N.vs===H.AMBIGUITY){var M=this,K=N.items,P=mstrmojo.array.find(K,"sta",-1),J=K[P].v,O=function(R){M.inputBox.replaceErrorToken(R);M.set("iStatus","");M.set("vStatus",H.UNKNOWN);if(M.continueValidataion){M.continueValidataion();}};var Q=this.parent.candidates,L=Q&&Q.items;if(L){Q.items=L.concat(N.srfd.items);}this.openPopup("abiguityDialog",{zIndex:100,items:N.srfd.items,ambiguousName:J,onItemSelect:O});}else{if(this.postHandleValidation){this.postHandleValidation();}}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=H;})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AA=mstrmojo.Enum_OIB_States,z={},AB;for(AB in AA){if(AA.hasOwnProperty(AB)){z[String(AA[AB])]=AB;}}return z;}());var P=mstrmojo.dom,R=mstrmojo.hash,X=mstrmojo.Enum_OIB_States,I=0,Z="_did_",w=mstrmojo.Enum_Keys,y=80,T=200;function O(){return I++;}function f(z){return(z&&z.state===X.ADDING);}function n(z){var AA={n:z||"",state:X.EMPTY};AA[Z]=-2;return AA;}function N(z){return(z&&z.state===X.EMPTY);}function r(AA){var AB=AA.items,z=AB&&AB.length;if(!z){return true;}return(z===1&&f(AB[0]))||(z===2&&N(AB[0])&&f(AB[1]));}function i(){var AA=this.ctxtBuilder.itemWidgets,z=AA[AA.length-1];if(z&&z.isAdding){return z;}return null;}function K(){var z=this.editingIdx;if(z!==null){return this.ctxtBuilder.itemWidgets[z];}return i.call(this);}function D(){this.isActive=false;var AA=this.emptyText||"",AB=this.items;if(r(this)&&!N(AB[0])&&(AA.length>0)){this.add([n(AA)],0);var AC=this.ctxtBuilder.itemWidgets[0];AC.set("shouldEllipsize",true);AC.doEllipsize();}var z=K.call(this);if(z){if(f(z)){z.domNode.style.display="none";}this.scrollTo(this.items[0]);z.blur();}P.detachEvent(document.body,"mousedown",this._mousedownHandler);}function M(){this.isActive=true;if(N(this.items[0])){this.remove(0);}var z=K.call(this);if(z){if(f(z)&&!this.isFull){z.domNode.style.display="block";}this.scrollTo(z.data);z.focus();}P.attachEvent(document.body,"mousedown",this._mousedownHandler);}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,getSearchPattern:function(){var z=K.call(this);if(z){return z.getSearchPattern();}return"";},getSuggestionTarget:function j(){return this.suggestTarget;},onsuggestTargetChanged:function m(z){this._request_pattern=null;},getSuggestionPos:function a(){return this._pop_cfg;},onSuggestionItemSelect:function t(z){this.suggestTarget.setItem(z[this.itemField],z,false);this.hideSuggestion();},hideEditButton:function(z){return !!this.noEditButton;},_set_items:function h(AE,AB){AB=AB||[];var AD=this.maxObjectCount;this.set("isFull",(AD&&AB.length>=AD));if(AB.length===0){var AA=this.emptyText||"";if(AA.length>0){AB.push(n(AA));}}var AC={n:"",state:X.ADDING};AC[Z]=-1;AB.push(AC);var z=AB[AB.length-1];if(z&&f(z)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=Z;return this._super(AE,AB);},add:function E(AA,z){var AB=i.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AA,z);}if(!r(this)&&N(this.items[0])){this.remove(0);}if(AB){AB.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);}}AB.domNode.style.display="none";},remove:function Y(z){this._super(z);var AA=i.call(this);if(AA){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AA.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function W(){this._super();var AA=this,z=i.call(AA);if(z){z.domNode.style.display="none";}this._clickHandler=function(){M.call(AA);};this._mousedownHandler=function(AB){if(!AA.isActive||AA.browserShown){return ;}var AC=P.eventTarget(self,AB);if(AC&&AC.parentNode&&!P.contains(AA.domNode,AC,false,document.body)&&!P.contains(AA.suggestionPopup.domNode,AC,false,document.body)){D.call(AA);}};P.attachEvent(this.domNode,"click",this._clickHandler);},nextId:O,item2textCss:function L(z){return z.cssClass||"";},itemFunction:function G(AE,AA,AC){AE[AC.itemIdField]=O();var AF=new mstrmojo.ObjectItem({parent:AC,itemField:AC.itemField,cssClass:AC.item2textCss(AE),data:AE});var AB=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],z=AB.length,AD;for(AD=0;AD<z;AD++){AF.attachEventListener(AB[AD],AC.id,"_itemChangeHandler");}return AF;},getSelectedObjects:function g(){if(r(this)){return[];}var z=this.items,AA=z.length-1;if((AA>-1)&&f(z[AA])){return z.slice(0,AA);}return z.concat();},isValid:function C(){var AA=this.ctxtBuilder.itemWidgets,z=AA&&AA.length,AB;for(AB=0;AB<z;AB++){if(!AA[AB].isValid()){return false;}}return true;},_itemChangeHandler:function(AC){var AE=AC.name,AF=AC.d,AA,z=this.items.length,AB;switch(AE){case"ItemEditBegin":if(this.editingIdx!==null){AB=K.call(this);if(AB){AB.blur();}}AA=this.itemIndex(AF);this.editingIdx=AA;M.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AC.deactivate){D.call(this);}else{M.call(this);}AB=i.call(this);if(AB){AB.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AB=K.call(this);if(AB){AB.blur();}this.editingIdx=null;}AA=this.itemIndex(AF);this.remove(AA);if(!AC.deactivate){this.editingIdx=null;M.call(this);}else{if(!this.isActive){D.call(this);}else{M.call(this);}}break;case"ItemDeletePrev":if(z>1){this.remove(z-2);}break;case"ItemAdd":var AD=R.copy(AC.d);this.add([AD],z-1);if(AC.deactivate){D.call(this);}else{M.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AC.target);this._pop_cfg={target:AC.target,left:AC.l,top:AC.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AC.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AE==="ItemEditEnd"||AE==="ItemAdd"||AE==="ItemDelete"||AE==="ItemDeletePrev"||AE==="ItemEditing")){this.onitemchange();}},unrender:function B(AA){var z=this.suggestionPopup;if(z.hasRendered){z.unrender(false);}if(this._super){this._super(AA);}},destroy:function q(AA){var z=this.suggestionPopup;if(z&&z.hasRendered){z.destroy(false);}if(this._super){this._super(AA);}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var o="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span class="'+o+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=o+" "+this.cssClass;},onstateChange:function(){var AC=this.state,AB=mstrmojo.Enum_OIB_States_CSS[AC],AA=this.domNode;if(AC===X.EMPTY){AA.innerHTML='<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>";}else{if(AC===X.EDITING){var z=Math.round(this.displayNode.clientWidth);this.editNode.style.width=z-4+"px";this.inputNode.style.width=z-9+"px";}}AA.className="mstrmojo-ObjectItem "+AB;if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},state:X.VALID,onstateChange:function c(z){this.data.state=this.state;},ontextChange:function H(z){this.data[this.itemField]=this.text;},updateData:function F(z){R.copy(z,this.data);this.set("state",X.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function u(AA){this._super(AA);var AC=this.data,z=AC.state,AB=this.parent;if(typeof z==="undefined"){z=AB.dynamicVerify?AB.verifyObject(AC[this.itemField],this):X.UNDETERMINED;AC.state=z;}this.cssClass=AB.item2textCss(AC);this.text=AC[this.itemField];this.state=z;this.isAdding=f(AC);this.useRichTooltip=true;},isValid:function C(){var z=parseInt(this.state,10);return(z!==X.INVALID&&z!==X.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AC=this.inputNode.style;AC.width=y+"px";var AB=this.domNode.parentNode,z=AB.parentNode.offsetWidth,AA=Math.max(z-AB.offsetLeft-20,y);if(!isNaN(AA)){AC.width=AA+"px";}}},blur:function S(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AB=this.inputNode,z=AB.value,AA=this.parent;window.setTimeout(function(){try{AB.blur();}catch(AC){}},0);if(!z){return ;}if(AA.acptSugItemOnly){this.set("text",z);this.set("text","");this._tWas_=null;return ;}this.setItem(z,null,true);},focus:function p(){var AA=this.inputNode,z=this.isActive;window.setTimeout(function(){try{AA.focus();if(AA.createTextRange&&!z){var AC=AA.createTextRange(),AB=AA.value.length;AC.move("character",AB);AC.select();}}catch(AD){}},0);this.isActive=true;},prekeydown:function J(z){var AB=this.inputNode.value,AA=parseInt(z.e.keyCode||z.e.charCode,10),AD=this.parent;if(!AB){return ;}if(AA===w.TAB||AA===w.ENTER){P.preventDefault(z.hWin,z.e);var AC=AD.getSelected();if(AC){AD.handleSuggestionItemSelect(AC);}else{this.hideSuggestion();if(!AD.acptSugItemOnly){this.setItem(AB,null,false);}else{this.set("text",AB);this.set("text","");}}}else{if(AA===w.DOWN_ARROW){if(!AD.noCache){this.showSuggestion(AB);}AD.nextHighlight();}else{if(AA===w.UP_ARROW){AD.preHighlight();}}}},prekeyup:function x(z){var AB=this.inputNode.value,AA=parseInt(z.e.keyCode||z.e.charCode,10),AE=this.isAdding,AD=this.parent;if(!AB){if(AE){if(AA===w.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});P.preventDefault(z.hWin,z.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AA===w.ESCAPE){this.hideSuggestion();if(AD.acptSugItemOnly){this.set("text",AB);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AB){this.raiseEvent({name:"ItemEditing",d:this.data});if(AD.useKeyDelay){if(!this._timerID){var AC=this;this._timerID=window.setTimeout(function(){var AF=AC.inputNode.value;if(AF){AC.showSuggestion(AF);}AC._timerID=null;},T);}}else{this.showSuggestion(AB);}}}this._tWas_=AB;},setItem:function(z,AB,AA){var AD=this.isAdding,AC=this.parent;AA=AA||false;this.set("text",z);this._tWas_=null;if(AD){this.set("text","");if(!AB){AB={};AB[this.itemField]=z;}else{AB.state=X.VALID;}this.raiseEvent({name:"ItemAdd",d:AB,deactivate:AA});}else{this.set("text",z);if(AB){this.updateData(AB);}else{this.set("state",AC.verifyObject(z,this));this.set("cssClass",AC.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AB,deactivate:AA});}},getSearchPattern:function U(){return this.inputNode.value;},showSuggestion:function k(z){var AA=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AA.x)+"px",t:Math.round(AA.y+AA.h)+"px",pattern:z,target:this});},hideSuggestion:function d(){this.raiseEvent({name:"SuggestionOff"});},del:function Q(z){z=z||self.event;P.stopPropogation(self,z);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function V(){this.showSuggestion(this.text);this.set("state",X.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});},doEllipsize:function b(){if(!this.shouldEllipsize){return ;}var AA=this.maxItemWidth,z;if(AA){this.domNode.style.maxWidth=AA;switch(parseInt(this.state,10)){case X.VALID:case X.UNDETERMINED:case X.INVALID:z=this.textNode;break;case X.EMPTY:z=this.domNode.firstChild;break;}if(z){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(z,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ObjectInputBox","mstrmojo.ME.MetricDataService");var H=mstrmojo.expr;mstrmojo.ME.LevelInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{cssClass:"mstrmojo-ObjectInputBox level",useKeyDelay:true,showDesc:true,showPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,browseItemVisible:true,folderLinksContextId:16,browsableTypes:[H.TP.FOLDER,H.TP.ATTR].join(","),item2textCss:function C(E){return(this._super&&this._super(E))||{12:"a","-1":"rl","-99":"br"}[E.t]||"";},getCandidatesThroughTaskCall:function G(J,E){J.rootFolderType=39;J.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(J,E);},itemFunction:function(N,J,L){N[L.itemIdField]=L.nextId();N.filtering=N.filtering||1;N.grouping=N.grouping||1;var O=new mstrmojo.ME.LevelObjectItem({parent:L,itemField:L.itemField,cssClass:L.item2textCss(N),data:N});var K=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff"],M,E;for(M=0,E=K.length;M<E;M++){O.attachEventListener(K[M],L.id,"_itemChangeHandler");}return O;},updateSuggestion:function F(E){var J=this.items;E=mstrmojo.array.filter(E,function(M){var L=M.did,K=false,O;var N=function(P){mstrmojo.array.forEach(J,function(Q){if(Q.did===P){K=true;return false;}});};N(L);if(!K){O=M;}return O;});if(this._super){this._super(E);}},add:function I(J,E){var L=true,K=this.items;mstrmojo.array.forEach(J,function(M){mstrmojo.array.forEach(K,function(N){if(N.did&&N.did===M.did){L=false;return false;}});});if(L){this._super(J,E);}}});mstrmojo.ME.LevelObjectItem=mstrmojo.declare(mstrmojo.ObjectItem,[mstrmojo._HasPopup],{markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span class="mstrmojo-ObjectItem-text {@cssClass}">{@text}</span><img class="mstrmojo-ObjectItem-opts" src="../images/1ptrans.gif" title="Level Options" onclick="mstrmojo.all[\'{@id}\'].options(arguments[0])"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',optsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9598,"Level Options"),cssText:"width: 450px;",onOpen:function B(){var E=this.opener.data;this.filterOption.set("value",E.filtering);this.groupOption.set("value",E.grouping);},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9599,"Relationship with Report Filter:")},{scriptClass:"mstrmojo.Pulldown",alias:"filterOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9600,"Standard - Metric calculates only for elements found in the filter"),did:1},{n:mstrmojo.desc(9601,"Absolute - Raises the calculation to the selected level, if possible"),did:2},{n:mstrmojo.desc(9602,"Ignore - Omit filtering criteria based on selected level and its related attributes"),did:3},{n:mstrmojo.desc(9603,"None - Unspecified - the selected level and group components define the filter"),did:4}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9604,"Metric Aggregations:")},{scriptClass:"mstrmojo.Pulldown",alias:"groupOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9605,"Standard - Metric calculates at the selected level, if possible"),did:1},{n:mstrmojo.desc(9606,"None - Exclude the selected level and children from the GROUP BY clause in the SQL"),did:2},{n:mstrmojo.desc(9607,"Beginning lookup - Use the first value of the lookup table"),did:3},{n:mstrmojo.desc(9608,"Ending lookup - Use the last value of the lookup table"),did:4},{n:mstrmojo.desc(9609,"Beginning fact - Use the first value of the fact table"),did:5},{n:mstrmojo.desc(9610,"Ending fact - Use the last value of the fact table"),did:6}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,J=E.opener;if(J.saveOnClose){J.saveOnClose(E.filterOption.value,E.groupOption.value);}E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},saveOnClose:function A(E,K){var J=this.data;J.filtering=E;J.grouping=K;if(this.parent.onSaveOnClose){this.parent.onSaveOnClose();}},options:function D(){this.openPopup("optsRef",{title:'"'+this.data[this.itemField]+'" '+mstrmojo.desc(9598,"Level Options"),zIndex:40});}});})();(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox");var C=mstrmojo.expr;mstrmojo.ME.ConditionInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{cssClass:"mstrmojo-ObjectInputBox condition",useKeyDelay:true,showDesc:true,showPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,browseItemVisible:true,folderLinksContextId:10,browsableTypes:[C.TP.FOLDER,C.TP.FILTER].join(","),noEditButton:true,maxObjectCount:1,item2textCss:function A(D){return(this._super&&this._super(D))||{1:"f","-99":"br"}[D.t]||"";},getCandidatesThroughTaskCall:function B(E,D){E.rootFolderType=39;E.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getFilters(E,D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox");mstrmojo.ME.TransformInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{cssClass:"mstrmojo-ObjectInputBox transform",items:[],noEditButton:true,item2textCss:function A(C){return(this._super&&this._super(C))||{43:"tr","-99":"br"}[C.t]||"";},getCandidatesThroughTaskCall:function B(D,C){mstrmojo.ME.MetricDataService.getTransformations(D,C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricEditBox");mstrmojo.requiresDescs(218,219,221,628,1442,2102,2116,2154,2213,2919,4596,5298,5728,5891,7924,7984,7987);var H=mstrmojo._FormatDefinition,I=mstrmojo.string,Q=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,J={advanced:65536,simple:131072,func:196608};var C=function(R){if(!R){return Q.VALID;}return{"-2147214845":Q.ERROR,"-2147214846":Q.AMBIGUITY}[R]||Q.ERROR;},G=function(S,R){var T={taskId:"saveMetricDefinition",tokenStreamXML:B(S),localSymbolFolderXML:A(S),metricXML:P(S),metricId:S.did||"",outputFlags:327695,description:S.desc||"",name:S.n||"",saveAs:R,sessionState:mstrApp.sessionState};if(I.isEmpty(S.metricId)){T.isNew=true;}return T;},D=function(T){var S=function(U){var W=this.parent;var V=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##","Object").replace("'###'","");if(W){W.ob.refreshContent();W.onObjectSaved({name:W.name,did:U.did,desc:W.desc});V=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",W.typeDesc||"Object").replace("###",W.name);}mstrmojo.confirm(V,[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"OK"),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(7984,"Object Saved"));if(W){W.close();}T.dirty=false;},R={success:S,failure:mstrmojo.SaveAsEditor.SAVEAS_CALLBACK.failure};return R;},M=function(Y,V){var T=this;F(T,true);var Z=mstrmojo.ME._MetricEditorHelper.oi=Y.oi,U=B(Z),W=A(Z),X=P(Z,true),a=function(b){if(b&&b.tks){var c=b.tks;N(c);Z.tks=c;if(!c.rjec){Z.mps=b.mps;}c.vs=C(c.rjec);Y.set("vStatus",c.vs);Y.set("iStatus",c.rjed||"");Y.handleValidation&&Y.handleValidation(c);if(V&&c.vs===Q.VALID){var d=G(Z,false);if(V==="save"&&Z.did){mstrmojo.xhr.request("POST",mstrConfig.taskURL,D(Y),d);}else{if(V==="save"&&mstrmojo.string.isEmpty(Z.did)||V==="saveAs"){d.saveAs=true;Y.openPopup("saveasRef",{zIndex:Y.zIndex+10,folderLinksContextId:17,name:mstrmojo.desc(2213,"New Metric"),saveParams:d,saveAsCallback:function(){return D(Y);}});}else{if(V==="switch"){if(Y.cbSwtichEditor){Y.cbSwtichEditor(Y);}}}}}else{if(V&&c.vs===Q.ERROR){mstrmojo.confirm(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"OK"),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(9571,"Syntax Error!"));}}}},S=function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));},R=function(b){F(T,false);};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:U,localSymbolFolderXML:W,metricXML:X,metricId:Z.did,isNew:I.isEmpty(Z.did)},{success:a,failure:S,complete:R});},O=function(R,T){var S=[];R.oi.tks.items=S;T.clearTokens(S);},P=function(W,V){var U=[];U.push("<mt>");if(W.fmt&&!V){var R={getArrItemName:function(Z,X,Y){return Z.substr(0,Z.length-1);},isSerializable:function(f,c,b){if(mstrmojo.array.indexOf(["header_format","grid_format"],f)>-1){var g=c[b][f];if(!g){return{};}var Z="<"+f+">";for(var d in g){Z+="<prs n='"+d+"'>";var Y=g[d];for(var X in Y){var a=Y[X];Z+="<pr n='"+X+"' v='"+(a=="pru"?"":a)+"'";Z+=a=="pru"?' pru="1"':"";Z+="/>";}Z+="</prs>";}Z+="</"+f+">";return{child:Z};}return true;},skipNull:true};U.push(I.json2xml("fmt",W.fmt,R));}if(W.prss&&!V){var T={getArrItemName:function(Z,X,Y){return Z.substr(0,Z.length-1);},isSerializable:function(f,b,Z){if(mstrmojo.array.indexOf(["AnalyticalEngineProperties","DatamartProperties","VLDBSelect","VLDBFunction","VLDBReport"],f)>-1){var a=b[Z][f];if(!a){return{};}var Y=[],c=[];Y.push("<prs n='"+f+"' ");for(var d in a){var X=a[d];if(X!=null){if(typeof (X)=="object"){c.push(I.json2xml("pr",X,{skipNull:true,convertBoolean:true,isSerializable:function(i,h,g){return true;}}));}else{Y.push(d+"='"+X+"' ");}}}Y.push(">");Y.push(c.join(""));Y.push("</prs>");return{child:Y.join("")};}return true;},skipNull:true};U.push(I.json2xml("prss",W.prss,T));}if(W.mps){U.push(I.json2xml("mps",W.mps,{skipNull:true,convertBoolean:true,isSerializable:function(Z,Y,X){return true;}}));}if(W.datp&&!V){U.push(I.json2xml("datp",W.datp,{skipNull:true,convertBoolean:true,isSerializable:function(Z,Y,X){return true;}}));}if(W.sbs&&!V){var S={getArrItemName:function(Z,X,Y){if(Z=="avs"){return"sb";}else{return Z.substr(0,Z.length-1);}},isSerializable:function(Z,Y,X){return true;},skipNull:true};U.push(I.json2xml("sbs",W.sbs,S));}U.push("</mt>");return U.join("");},B=function(U){var V=K(U.tks);var S="",T={items:true,v:true,tp:true,lv:true,exv:true,extp:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true},R={getArrItemName:function(Y,W,X){return"tkn";},isSerializable:function(Y,X,W){return(T[Y])?true:false;}};S=I.json2xml("tknstrm",V,R);return S;},N=function(U){var S=U.items,R=S.length,T=S[S.length-1];if(T&&T.tp===-1){S.pop();}if(S[0]&&S[0].tp===38){S.splice(0,1);}},K=function(Y){var V=Y.items,S=V.length,X=V[V.length-1],U,W,T=[],R="";if(V[0]&&V[0].tp!==38){T.push({v:"&",tp:38,lv:4,sta:2});}for(U=0,S=V.length;U<S;U++){W=V[U];if(W.isNew&&!W.oi){R+=W.v;}else{if(!I.isEmpty(R)){T.push({v:R,tp:2,lv:1});R="";}T.push(W);}}if(!I.isEmpty(R)){T.push({v:R,tp:2,lv:1});R="";}if(X&&X.tp!==-1){T.push({v:"",tp:-1,lv:4,sta:2});}return{items:T};},A=function(R){return"";},F=function(S,R){S.set("enabled",!R);S.set("iconClass",S.iconClass.replace(/mstrmojo-InlineWaitIcon/,"")+" "+(R?"mstrmojo-InlineWaitIcon":""));},E=function(S,U){var V=U,R=V.oi.fmt,T=H.MetricFormatTarget;F(S,true);window.setTimeout(function(){if(!R){R=V.oi.fmt={};for(var W=0;W<T.length;W++){R[T[W].p]={};}}var X=mstrmojo.dom.position(S.domNode,true);V.openPopup("formatPopupRef",{zIndex:V.zIndex+10,model:R,left:X.x+"px",top:Math.max(0,(X.y-(V.formatPopupRef.height||350)))+"px"});F(S,false);},50);},L=function(T,U){var V=U,R=V.oi,S=function(){var W=mstrmojo.dom.position(T.domNode,true);V.openPopup(mstrmojo.all.mstrMEOptionsDialog||"optionPopupRef",{zIndex:V.zIndex+10,model:R,funcs:V.funcs,left:W.x+"px",top:Math.max(0,(W.y-(V.optionPopupRef.height||350)))+"px"});};if(!V.funcs){F(T,true);mstrmojo.ME.MetricDataService.getSubtotalFunctions(null,{success:function(W){if(W.items){V.funcs=W.items;S();F(T,false);}},failure:function(W){mstrmojo.alert(W.getResponseHeader("X-MSTR-TaskFailureMsg"));F(T,false);}});}else{S();}};mstrmojo.ME._MetricEditorHelper=mstrmojo.provide("mstrmojo.ME._MetricEditorHelper",{noCache:true,useKeyDelay:true,saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Metric",browsableTypes:"4,8",onObjectSaved:function(T){var S=this.opener,R=S&&S.oi;if(S&&R){R.did=T.did;R.n=T.name;R.desc=T.desc;S.set("title",mstrmojo.desc(2154,"Metric:")+" "+T.name);}}},optionPopupRef:{id:"mstrMEOptionsDialog",scriptClass:"mstrmojo.ME.OptionDialog",title:mstrmojo.desc(9572,"Advanced Metric Options"),help:"Advanced_Metric_Options_dialog_box.htm",height:340},formatPopupRef:{scriptClass:"mstrmojo.ME.MetricFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116,"Format"),left:"100px",top:"100px",useAnimate:false,height:360,help:"Format_Metric_dialog_box.htm",locksHover:true},functionSelector:{scriptClass:"mstrmojo.ME.FunctionSelector",insertMode:true},wizard:{scriptClass:"mstrmojo.ME.FunctionWizard"},simpleMetricRef:{scriptClass:"mstrmojo.ME.SimpleMetricEditor"},metricEditorRef:{scriptClass:"mstrmojo.ME.MetricEditor"},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},switchRef:{scriptClass:"mstrmojo.Button",alias:"switchToMetricEdtior",cssClass:"mstrmojo-ME-switch",text:mstrmojo.desc(9563,"Switch to Formula Editor"),bindings:{visible:function(){return !this.parent.insertMode;}},getEditor:function(){return this.parent;},onclick:function(){var S=this.getEditor();S.oi.tks.items=S.getMetricDefAsTokens();var R={vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN,candidates:S.candidates,oi:S.oi,did:S.oi.did,functions:S.functions};if(S.dirty){R.dirty=S.dirty;}S.openPopup("metricEditorRef",R);S.close();}},buttonBarRef:{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:70px;",bindings:{visible:function(){return !this.parent.parent.insertMode;}},children:[{scriptClass:"mstrmojo.Button",iconClass:"tbFormat",alias:"formatButton",title:mstrmojo.desc(4596,"Format..."),text:"",onclick:function(){E(this,this.parent.parent.parent);}},{scriptClass:"mstrmojo.Button",iconClass:"tbAdvOptions",alias:"optButton",title:mstrmojo.desc(7924,"Options..."),text:"",onclick:function(){L(this,this.parent.parent.parent);}}]},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",alias:"saveokButton",text:"",bindings:{text:function(){return(this.parent.parent.insertMode)?mstrmojo.desc(2919,"Insert"):mstrmojo.desc(5891,"Save");}},onclick:function(){var R=this.parent.parent;if(R.insertMode){R.insertOnFinish(R.getMetricDefAsTokens());R.close();}else{if(R.getMetricDefAsTokens){R.oi.tks.items=R.getMetricDefAsTokens();}R.tbValidate=this;M.call(this,R,"save");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",alias:"btnSaveAs",text:mstrmojo.desc(628,"Save As"),bindings:{visible:function(){return !this.parent.parent.insertMode;}},onclick:function(){var R=this.parent.parent;if(R.getMetricDefAsTokens){R.oi.tks.items=R.getMetricDefAsTokens();}R.tbValidate=this;M.call(this,this.parent.parent,"saveAs");}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(2102,"Close"),onclick:function(){var R=this.parent.parent;if(R.onPreClose()){R.close();}}}]},validateSyntax:function(R){M.call(R,this);},validateSyntaxAndSwitch:function(R){M.call(R,this,"switch");},preprocessTokenStram:function(R){N(R);},isDirty:function(){if(this.insertMode){return false;}return this.dirty;},onmetricModify:function(){this.dirty=true;},save:function(){this.buttonBar.btnSaveAs.onclick();},prompt2saveRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:mstrmojo.desc(5728,"Confirm save"),children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",bindings:{text:function(){return mstrmojo.desc(9573,"Do you want to save changes made to #?").replace("#","<b>"+this.parent.opener.oi.n+"</b>");}}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:10px;"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(219,"Yes"),onclick:function(){var R=this.parent.parent;R.opener.save();R.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(218,"No"),onclick:function(){var R=this.parent.parent;R.opener.close();R.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var R=this.parent.parent;R.close();}}]}]},prompt2save:function(){if(this.getMetricDefAsTokens){this.oi.tks.items=this.getMetricDefAsTokens();}this.openPopup("prompt2saveRef",{zIndex:this.zIndex+1});},onPreClose:function(){var R=this;if(R.isDirty&&R.isDirty()){R.prompt2save();return false;}return true;},onClose:function(){this.dirty=false;},init:function(T){var U=mstrApp,R=U&&U.useQuickSearch&&U.useQuickSearch(),S=R?(U&&U.searchAutoCompleteDelay&&U.searchAutoCompleteDelay()||0):0;this.suggestDelay=S||200;this.noCache=this.noCache&&R;this.ob.children[0].quickSearch=R;mstrmojo.ME.MetricDataService.suggestDelay=this.suggestDelay;mstrmojo.ME.MetricDataService.noCache=this.noCache;if(this._super){this._super(T);}},_setupCandidatesCache:function(U){var R=this,S=mstrmojo.ME.MetricDataService,T=500;ms=function(W){var V=W&&W.items||[],X=R.candidates||[];X.items=X.items.concat(V);X.isComplete=X.isComplete&&(W.bc===-1||(W.bb+W.bc>W.sz));if(U){U.candidates=null;U.set("candidates",X);}R.candidates=null;R.set("candidates",X);},success=function(V){if(V){var W={items:V.items,isComplete:(V.bc===-1||(V.bb+V.bc>V.sz))};if(U){U.set("candidates",W);}R.set("candidates",W);}S.getMetrics({rootFolderType:S.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:T},{success:ms,failure:failure});},failure=function(V){mstrmojo.alert(V.getResponseHeader("X-MSTR-TaskFailureMsg"));};if(!this.noCache&&!this.candidates){S.getMetricComponents({rootFolderType:S.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:T},{success:success,failure:failure});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.SearchWidget","mstrmojo.SaveAsEditor","mstrmojo.ME._MetricEditorHelper");var G=mstrmojo.hash;var F={n:mstrmojo.desc(9590,"Search Result"),did:-1,fns:[]},C={n:mstrmojo.desc(4561,"All Functions"),did:-2,fns:[]},A={n:mstrmojo.desc(9591,"Metric Templates"),did:-3,fns:[{n:mstrmojo.desc(3273,"Level"),did:-4,desc:mstrmojo.desc(9592,"Create a level metric.")},{n:mstrmojo.desc(9579,"Condition"),did:-5,desc:mstrmojo.desc(9593,"Create a conditional metric.")},{n:mstrmojo.desc(3324,"Transformation"),did:-6,desc:mstrmojo.desc(9594,"Create a transformation metric.")}]},D={n:mstrmojo.desc(4565,"Select a category:"),did:-4,fns:[]};var B=function(H){var I=H.functionList;H.openWizard(I.items[I.selectedIndex]);};mstrmojo.ME.FunctionSelector=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.FunctionSelector",cssClass:"mstrmojo-FunctionSelector",title:mstrmojo.desc(9595,"Select a function or template"),help:"Select_a_Function_dialog_box.htm",functions:null,selectedCategory:1,selectedIndex:-1,getFunctionSyntax:function(O,J){var N=this.functions;if(!N){return"";}var M=N[O].fns[J];if(M.did<0){return M.n;}var L=M.pars,I=[],K,H;I.push(M.n);I.push("(");for(K=0,H=L.length;K<H;K++){I.push(L[K].n);if(K!==(H-1)){I.push(", ");}}I.push(")");return I.join("");},getFunctionDesc:function(K,H){var J=this.functions;if(!J){return"";}var I=J[K].fns[H];return I.desc;},getFunctionHelpTopic:function(K,H){var J=this.functions;if(!J){return"";}var I=J[K].fns[H];return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(I.h);},getMetricDefAsTokens:function(){return this.getTokens();},getTokens:function E(){var I=this.functionList,H=I.items[I.selectedIndex],J=[];if(H){J.push({v:H.n,oi:H,isNew:true});}return J;},onOpen:function(){this.selectedCategory=1;this.set("selectedCategory",0);this.set("selectedIndex",-1);if(!this.functions.add){this.functions=G.make(this.functions,mstrmojo.Arr);}var I=this.functions,H=I.length;if(H>=1&&I[H-1].did!=A.did){I[H]=A;}},onClose:function(){this.searchWidget.clearSearch();},clearSearchResult:function(){var I=this.fcHBox.fcPulldown,J=this.functions,H=J.length-1;if(J[H]===F){if(this.selectedCategory===H){this.set("selectedCategory",0);this.set("selectedIndex",-1);}J.remove(H);I.refresh();}},wizard:{scriptClass:"mstrmojo.ME.FunctionWizard"},simpleMetricRef:{scriptClass:"mstrmojo.ME.SimpleMetricEditor"},metricEditorRef:{scriptClass:"mstrmojo.ME.MetricEditor"},openWizard:function(J){var I=this;if(mstrmojo.ME.MetricDataService.isBasicAggMap(J.did)||J.did<-1){var H={zIndex:I.zIndex+10,did:J.did,oi:I.oi};H.insertMode=false;I.openPopup("simpleMetricRef",H);}else{I.openPopup("wizard",{functions:mstrmojo.ME.MetricDataService.getFunctionCatList(),fctOi:J,zIndex:I.zIndex+10,oi:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}}});}},children:[{scriptClass:"mstrmojo.Label",cssText:"left:0;background:#f2f2f2; height:40px; position:absolute; width:100%;"},{scriptClass:"mstrmojo.SearchWidget",alias:"searchWidget",cssText:"margin: 5px 0 15px 5px;",width:"330px",quickSearch:true,placeholderText:mstrmojo.desc(9168,"Type to search"),onsearch:function(P){var H=this.parent,N=H.functionList,O=H.fcHBox.fcPulldown,L=H.functions,M=function(Q){return(new RegExp(P,"i")).test(Q.n);},J=[],I,K;for(I=0,K=L.length;I<K;I++){if(L[I]===F||L[I].did===C.did){continue;}J=J.concat(mstrmojo.array.filter(L[I].fns,M));}F.fns=J;if(L[L.length-1]!==F){L.add([F]);}O.refresh();H.set("selectedCategory",0);H.set("selectedCategory",L.length-1);H.set("selectedIndex",-1);},onclear:function(H){this.parent.clearSearchResult();}},{scriptClass:"mstrmojo.HBox",alias:"fcHBox",cssText:"margin-top: 5px; width:100%;",children:[{scriptClass:"mstrmojo.Pulldown",alias:"fcPulldown",itemIdField:"did",itemField:"n",items:[],bindings:{items:function(){var J=this.parent.parent.functions,K=[];if(!J){return J;}mstrmojo.array.forEach(J,function(L){mstrmojo.array.forEach(L.fns,function(M){K.push(M);});});var H=function(M,L){return mstrmojo.array.stringSorter(M.n,L.n);},K=K.sort(H);if(J[0].did!=C.did){var I=C;I.fns=K;J.unshift(I);}return J;},selectedIndex:"this.parent.parent.selectedCategory",value:function(){var H=this.parent.parent.selectedCategory;return this.items[H][this.itemIdField];}},onvalueChange:function(){var H=this.parent.parent;H.set("selectedCategory",this.selectedIndex);H.set("selectedIndex",-1);}}]},{scriptClass:"mstrmojo.List",alias:"functionList",itemIdField:"dssid",itemField:"n",cssClass:"mstrmojo-FE-functionList mstrmojo-suggest-list",itemMarkupFunction:function(J,H,I){return'<div class="mstrmojo-suggest-text">'+J[I.itemField]+"</div>";},bindings:{items:function(){var H=this.parent.functions,I=this.parent.selectedCategory;return H[I].fns;},selectedIndex:"this.parent.selectedIndex"},onchange:function(H){this.parent.set("selectedIndex",this.selectedIndex);},ondblclick:function(){var H=this.parent;B(H);H.close();}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[G.copy({cssClass:"mstrmojo-Button  mstrmojo-HTMLButton mstrmojo-Editor-button ",cssText:"text-align: center; float:left;",text:mstrmojo.desc(9596,"Use Formula Editor"),title:mstrmojo.desc(9597,"Build a metric formula using metrics, facts, attributes and functions."),getEditor:function(){return this.parent.parent;}},G.copy(mstrmojo.ME._MetricEditorHelper.switchRef)),{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1059,"Next"),onclick:function(){var H=this.parent.parent;B(H);H.close();},bindings:{enabled:function(){return this.parent.parent.functionList.selectedIndex>-1;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var H=this.parent.parent;H.close();}}]},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FE-functionSyntax",slot:"editorNode",bindings:{text:function(){return this.parent.getFunctionSyntax(this.parent.selectedCategory,this.parent.selectedIndex);},visible:function(){return this.text.length>0;}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FE-functionDesc",slot:"editorNode",bindings:{text:function(){var I=this.parent,J=this.parent.selectedCategory,H=this.parent.selectedIndex;return I.getFunctionDesc(J,H)+"  "+I.getFunctionHelpTopic(J,H);},visible:function(){return this.text.length>0;}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo._HasPopup","mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.ObjectBrowser","mstrmojo.DataGrid","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper");var H=function(E){if(E.onmetricModify){E.onmetricModify();}};var K=mstrmojo.hash,N=mstrmojo.expr,D=mstrmojo.ME.MetricToken.brackets,A=function(S){var O=null;if(S.isParam){O={scriptClass:"mstrmojo.Table",cssClass:"funcParam",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ObjectInputBox",alias:"paramInput",slot:"0,0",useKeyDelay:true,showDesc:true,showPath:true,item2textCss:function E(T){return mstrmojo.ObjectInputBox.prototype.item2textCss.call(this,T)||{4:"m",12:"a",13:"fc","-99":"br"}[T.t]||"";},hideEditButton:function(T){return T.state===mstrmojo.Enum_OIB_States.VALID;},browsableTypes:[N.TP.FOLDER,N.TP.FACT,N.TP.METRIC,N.TP.ATTR].join(","),browseItemVisible:true,folderLinksContextId:17,dynamicVerify:!!S.dynamicVerify,emptyText:"Type here to input a fact, metric or attribute ...",blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,getCandidatesThroughTaskCall:function R(U,T){U.objectType="4,11,13";U.rootFolderType=39;U.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(U,T);},postCreate:function(U){var T=this.parent.dataGrid,V=T&&T.parent;this.noCache=V.noCache;if(!this.noCache){this.candidates=V.getCandidates(function(W){return W.t===4||W.t===12||W.t===13;});if(!U){T.candidatesListener.push(this);}}this.set("items",S.items);},onitemchange:function(){H(this.parent.dataGrid.parent);}},{scriptClass:"mstrmojo.ToolBar",slot:"0,1",cssClass:"mstrmojo-oivmSprite grouped",children:[{scriptClass:"mstrmojo.Button",title:"Browse",iconClass:"tbBrowse",bindings:{enabled:"!this.parent.parent.paramInput.isFull"},onclick:function(){var U=this.parent.parent.dataGrid.parent;U.openPopup("ob",{zIndex:U.zIndex+10});var T=U.ob.browser;T.browse({folderLinksContextId:17,onSelectCB:[this.parent.parent,"onParamAdded"],browsableTypes:[N.TP.FACT,N.TP.METRIC,N.TP.ATTR,N.TP.FOLDER].join(",")});}}]}],onParamAdded:function(V){var U=this.dataGrid.parent,T=this.paramInput;U.closePopup();V.state=0;T.add([V],T.items.length-1);H(U);},getTokens:function(){var W=this.paramInput.getSelectedObjects(),T=W.length,V,X=[],U;if(T>0){for(V=0;V<T;V++){if(W[V].state===mstrmojo.Enum_OIB_States.VALID){U={v:D(W[V].n)};U.oi=W[V];}else{U={v:W[V].n};}X.push(U);X.push({v:",",isDelimiter:true});}X.pop();}return X;}};var P=O.children[0];if(!S.isRepeated){P.cssClass="mstrmojo-ObjectInputBox singleObject noVerify";P.maxObjectCount=1;}else{P.cssClass="mstrmojo-ObjectInputBox noVerify";}}else{switch(S&&S.dtp){case 11:O={scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-functionArgs-pulldown mstrmojo-Pulldown",items:[{n:"False",did:"0"},{n:"True",did:"-1"}],popupToBody:true,itemIdField:"did",postCreate:function(T){var U=this.data;this.value=!!U.v?(U.v=="False"?0:-1):(U.dfv||0);},getTokens:function(){var T=this.data;if(this.value!==T.dfv){return[{v:T.n},{v:"=",isDelimiter:true},{v:this.value=="-1"?"True":"False"}];}else{return[];}},onvalueChange:function(){H(this.parent.dataGrid.parent);}};break;case -2:O={scriptClass:"mstrmojo.Table",cssClass:"breakBy",layout:[{cells:[{cssText:"width: 338px"},{cssClass:"mstrmojo-ME-toolbar"}]}],children:[{scriptClass:"mstrmojo.ObjectInputBox",slot:"0,0",alias:"breakByInput",useKeyDelay:true,showDesc:true,showPath:true,item2textCss:function E(T){return mstrmojo.ObjectInputBox.prototype.item2textCss.call(this,T)||{12:"a","-99":"br"}[T.t]||"";},emptyText:"Type here to input breakby attributes...",noEditButton:true,browseItemVisible:true,folderLinksContextId:16,browsableTypes:[N.TP.FOLDER,N.TP.ATTR].join(","),blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,getCandidatesThroughTaskCall:function R(U,T){U.rootFolderType=39;U.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(U,T);},postCreate:function(U){var T=this.parent.dataGrid,V=T&&T.parent;this.noCache=V.noCache;if(!this.noCache){this.candidates=V.getCandidates(function(W){return W.t===12;});if(!U){T.candidatesListener.push(this);}}this.set("items",S.items);},onitemchange:function(){H(this.parent.dataGrid.parent);}},{scriptClass:"mstrmojo.ToolBar",slot:"0,1",cssClass:"mstrmojo-oivmSprite grouped",children:[{scriptClass:"mstrmojo.Button",title:"Browse",iconClass:"tbBrowse",onclick:function(){var U=this.parent.parent.dataGrid.parent;U.openPopup("ob",{zIndex:U.zIndex+10});var T=U.ob.browser;T.browse({folderLinksContextId:16,onSelectCB:[this.parent.parent,"onBreakByAdded"],browsableTypes:[N.TP.ATTR,N.TP.FOLDER].join(",")});}}]}],onBreakByAdded:function(V){var U=this.dataGrid.parent,T=this.breakByInput;U.closePopup();T.add([V],T.items.length-1);H(U);},getTokens:function(){var V=this.breakByInput.getSelectedObjects(),T=V.length,U,W=[];if(T>0){W.push({v:"BreakBy"});W.push({v:"=",isDelimiter:true});W.push({v:"{",isDelimiter:true});for(U=0;U<T;U++){W.push({v:D(V[U].n),oi:V[U]});if(U!==(T-1)){W.push({v:",",isDelimiter:true});}}W.push({v:"}",isDelimiter:true});}return W;}};break;case -1:var Q=function(V,U){switch(U.t){case 12:var W=function(X){if(X){var Y=X.container;if(Y&&Y.dssforms){U.dssforms=Y.dssforms;V.add([U]);}}},T=function(X){mstrmojo.alert(X.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getAttributeForms({attributeID:U.did,displayedForms:0},{success:W,failure:T});break;case 4:U.dssforms=[{n:"Value"}];default:V.add([U]);}};O={scriptClass:"mstrmojo.Table",cssClass:"sortBy",layout:[{cells:[{cssText:"width: 330px"},{cssClass:"mstrmojo-ME-toolbar"}]}],getTokens:function(){var W=this.sortByGrid.items,T=W.length,V,Z=[];if(T>0){Z.push({v:"SortBy"});Z.push({v:"=",isDelimiter:true});Z.push({v:"(",isDelimiter:true});for(V=0;V<T;V++){var X=W[V],Y=X.selFrm||(X.dssforms&&X.dssforms[0]),U={v:D(X.n),oi:X};if(Y&&X.t==12){K.copy({v:D(X.n)+"@"+D(Y.n),exv:Y.dssid,extp:8},U);}Z.push(U);if(!!X.asc){Z.push({v:"Desc"});}if(V!==(T-1)){Z.push({v:",",isDelimiter:true});}}Z.push({v:")",isDelimiter:true});}return Z;},children:[{scriptClass:"mstrmojo.DataGrid",slot:"0,0",cssClass:"mstrmojo-functionArgs-sort",alias:"sortByGrid",renderOnScroll:false,resizableColumns:true,makeObservable:true,itemDisplayField:"n",columns:[{headerText:"Name",dataField:"n",colCss:"nmCol"},{headerText:"Field",dataField:"field",colCss:"spcCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",bindings:{items:function(){var T=this.data;if(T){this.set("value",T.selFrm);return T.dssforms;}return null;}},popupToBody:true,popupZIndex:100,onvalueChange:function(T){this.data.selFrm=this.selectedItem;if(this.hasRendered){H(this.dataGrid.parent.parent.dataGrid.parent);}}}},{headerText:"Order",dataField:"order",colCss:"ordCol",dataWidget:{scriptClass:"mstrmojo.Pulldown",items:[{n:"Ascending",v:0},{n:"Descending",v:1}],itemIdField:"v",popupToBody:true,popupZIndex:100,bindings:{value:function(){return this.data.asc;}},onvalueChange:function(){this.data.asc=this.value;if(this.hasRendered){H(this.dataGrid.parent.parent.dataGrid.parent);}}}},{dataWidget:{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(T){this.dataGrid.remove(this.data);H(this.dataGrid.parent.parent.dataGrid.parent);}},headerText:"&nbsp",colCss:"actionsCol"}],postCreate:function(){var U=S.items;if(U){for(var V=0,T=U.length;V<T;V++){Q(this,U[V]);}}}},{scriptClass:"mstrmojo.ToolBar",slot:"0,1",cssClass:"mstrmojo-oivmSprite grouped",children:[{scriptClass:"mstrmojo.Button",title:"Browse",iconClass:"tbBrowse",onclick:function(){var U=this.parent.parent.dataGrid.parent;U.openPopup("ob",{zIndex:U.zIndex+10});var T=U.ob.browser;T.browse({folderLinksContextId:16,onSelectCB:[this.parent.parent,"onSortByAdded"],browsableTypes:[N.TP.ATTR,N.TP.METRIC,N.TP.FOLDER].join(",")});}}]}],onSortByAdded:function(W){var U=this.dataGrid.parent,V=this.sortByGrid;U.closePopup();if(W){switch(W.t){case 12:var X=function(Y){if(Y){var Z=Y.container;if(Z&&Z.dssforms){W.dssforms=Z.dssforms;V.add([W]);}}},T=function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getAttributeForms({attributeID:W.did,displayedForms:0},{success:X,failure:T});break;case 4:W.dssforms=[{n:"Value"}];default:V.add([W]);}}H(U);}};break;default:O={scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-functionArgs-textInput",postCreate:function(T){var U=this.data;this.value=U.v||((U.dfv||U.dfv===0)?U.dfv:"");},getTokens:function(){var T=this.data;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==T.dfv){return[{v:T.n},{v:"=",isDelimiter:true},{v:this.value}];}return[];},onvalueChange:function(){H(this.parent.dataGrid.parent);}};break;}}O.alias="inputWidget";return O;},J=function(P,E,O){return'<div class="mstrmojo-DataRow-text"title="'+(P.desc||"")+'">'+P.n+(P.isParam?"*":"")+":</div>";};var G=function(Q,R){for(var O=0,E=Q.length;O<E;O++){var P=mstrmojo.array.find(Q[O].fns,"n",R);if(P>-1){return K.clone(Q[O].fns[P]);}}return null;};var L=function(P,Q){var O=0,E=Q.length,R=P&&P.length;for(;O<R-1;O++){P[O].items=[Q[O]];P[O].dynamicVerify=true;}P[R-1].items=[];for(O=R-1;O<E;O++){P[R-1].items.push(Q[O]);P[R-1].dynamicVerify=true;}return P;};var B=function(E,O,R){var Q={items:[]},P={301:"}",302:")"}[R];tk=O[++E];while(tk){if(tk.oi){if(R==302){tk.oi.selFrm=tk.exv;tk.oi.asc=tk.asc;}Q.items.push(tk.oi);}if((tk=O[++E])["v"]==P){break;}}return Q;};mstrmojo.ME.FunctionWizard=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper],{scriptClass:"mstrmojo.ME.FunctionWizard",cssClass:"mstrmojo-Editor-me mstrmojo-FunctionWidzard",title:mstrmojo.desc(9582,"Function Editor:"),help:"Function_Arguments_dialog_box.htm",fctOi:null,fctArgs:null,fctSyntax:"",fctDesc:"",bindings:{candidates:"this.opener.candidates"},getCandidates:function M(P){var O=this.candidates,E;if(O){E=mstrmojo.array.filter(O.items,P);return{items:E,isComplete:O.isComplete};}return null;},_set_candidates:function(S,O){this.candidates=O;if(this.hasRendered&&this.visible){var Q=this.argsGrid,R=Q.candidatesListener,E=R.length,P;for(P=0;P<E;P++){R[P].postCreate(true);}}return true;},onOpen:function(){this._setupCandidatesCache();var P=this.getArgsFromTokens();var S=this,R=P||this.fctOi;var U=[],Q,E,T,O=[];O.push(R.n);O.push("(");E=R.pars&&R.pars.length||0;for(Q=0;Q<E;Q++){T=K.copy(R.pars[Q]);T.isParam=true;U.push(T);O.push(R.pars[Q].n);if(Q!=(E-1)){O.push(", ");}}O.push(")");if(R.rpc>0){T.isRepeated=true;}E=R.pros&&R.pros.length||0;for(Q=0;Q<E;Q++){U.push(K.copy(R.pros[Q]||{n:"pars",v:"test"}));}if(R.ios){U.push({n:"Sort By",dtp:-1,desc:"Sort By is a parameter representing the sort by levels for this function.",items:R.sb&&R.sb.items});}if(R.sqt===5){U.push({n:"Break By",dtp:-2,desc:"Break By is a parameter representing the break by levels for this function.",items:R.bb&&R.bb.items});}S.set("fctArgs",U);S.set("fctSyntax",O.join(""));S.set("fctDesc",R.n+": "+this.fctOi.desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(R.h));S.set("title",this.insertMode?R.n:mstrmojo.desc(9582,"Function Editor:")+" "+this.oi.n);},getArgsFromTokens:function F(){if(!this.oi||this.oi.tks.items.length==0){return null;}var T={},b=this.oi.tks.items,R=b.length,O=[],Z=[],V=0,Y=[];for(var Q=0;Q<R;Q++){var a=b[Q],W=a.tp,E=a.sctt;if(mstrmojo.ME.MetricToken.isDelimiter(a.v)||a.v=="&gt;"||a.v=="&lt;"){continue;}switch(E){case 65536:T.n=a.oi?a.oi.n:a.v;var P=this.fctOi=G(this.functions,T.n);O=P.pars;Z=P.pros;T.rpc=P.rpc;T.sqt=P.sqt;T.ios=P.ios;break;case 196608:if(W>=264&&W<=274){Y.push(a.oi);}else{Y.push({n:a.v,v:a.v});}break;case 131072:if(W==301){var S={};a=b[++Q];while(a){if(a.tp!=282){if(a.oi){S.items=S.items||[];S.items.push(a.oi);}}if((a=b[++Q])["v"]=="}"){break;}}T.bb=S;}else{if(W==302){var U={};a=b[++Q];while(a){if(a.tp!=282){if(a.oi){a.oi.selFrm=a.exv;var X=b[Q+1];if(X.v==="Desc"&&X.tp==259){a.oi.asc=1;Q++;}U.items=U.items||[];U.items.push(a.oi);}}if((a=b[++Q])["v"]==")"){break;}}T.sb=U;}else{if(W==259){Z[V++].v=b[Q+2].v;}}}break;}}T.pars=L(O,Y);T.pros=Z;return T;},getTokens:function C(){var Q=this.argsGrid.ctxtBuilder.itemWidgets,T=Q.length,S,X,U=[],P=[],Y=[],V,R,O,E,W=this.fctOi;for(S=0;S<T;S++){X=Q[S].inputWidget;if(X.data.isParam){P.push(X.getTokens());}else{U.push(X.getTokens());}}Y.push({v:W.n,oi:W});T=U.length;if(T>0){E=false;Y.push({v:"<",isDelimiter:true});for(S=0;S<T;S++){V=U[S];O=V.length;if(O===0){continue;}E=true;for(R=0;R<O;R++){Y.push(V[R]);}Y.push({v:",",isDelimiter:true});}Y.pop();if(E){Y.push({v:">",isDelimiter:true});}}T=P.length;Y.push({v:"(",isDelimiter:true});E=false;for(S=0;S<T;S++){V=P[S];O=V.length;if(O===0){continue;}E=true;for(R=0;R<O;R++){Y.push(V[R]);}Y.push({v:",",isDelimiter:true});}if(E){Y.pop();}Y.push({v:")",isDelimiter:true});for(S=0,T=Y.length;S<T;S++){Y[S].isNew=true;}return Y;},getMetricDefAsTokens:function(){return this.getTokens();},handleValidation:function I(Q){var P=Q&&Q.rjec==="-2147214846";if(P){var O=Q.items,R=mstrmojo.array.find(O,"sta",-1),E=O[R].v;mstrmojo.alert('More than one object with the name "#" found. Browse to select the object or retype to select it from the search autocomplete list.'.replace("#",E));}else{mstrmojo.alert(Q&&Q.rjed);}},children:[{scriptClass:"mstrmojo.HBox",cssText:"color: #999",children:[{scriptClass:"mstrmojo.Label",cssText:"width:100px; padding:5px; text-align:right;",text:mstrmojo.desc(5424,"Function:")},{scriptClass:"mstrmojo.Label",cssText:"margin-left:5px;",bindings:{text:"this.parent.parent.fctSyntax"}}]},{scriptClass:"mstrmojo.DataGrid",alias:"argsGrid",cssClass:"functionArgs",makeObservable:true,banding:false,columns:[{headerText:"Property Name",dataFunction:J,colCss:"name"},{headerText:"Property Type",dataWidgetBuilder:A,colCss:"dtp"}],postCreate:function(){this.candidatesListener=[];},bindings:{items:function(){return this.parent.fctArgs;}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FE-functionDesc",slot:"editorNode",text:"",bindings:{text:function(){return this.parent.fctDesc;var P=this.parent.title;var E="",O=this.parent.fctOi;if(O&&O.desc){E=O.n+": "+O.desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(O.h);}return E;}}},mstrmojo.ME._MetricEditorHelper.switchRef,mstrmojo.ME._MetricEditorHelper.buttonBarRef]});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Table","mstrmojo.CheckBox","mstrmojo.ME.TokenInputBox","mstrmojo.ME.LevelInputBox","mstrmojo.ME.ConditionInputBox","mstrmojo.ME.TransformInputBox","mstrmojo.ME.MetricDataService","mstrmojo.DataGrid","mstrmojo.Button","mstrmojo.ToolBar","mstrmojo.ObjectBrowser","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper");var C=function(W,T){dftsFctProps=[{n:"Distinct",dtp:11,dfv:"0",desc:""},{n:"Null",dtp:11,dfv:"0",desc:""},{n:"UseLookupForAttributes",dtp:11,dfv:"-1",desc:""},{n:"FactID",dtp:-1,desc:"",items:[]}];for(var U=0,S=dftsFctProps.length;U<S;U++){var V=dftsFctProps[U],E=mstrmojo.array.find(W,"n",V.n);if(E>-1){mstrmojo.hash.copy(V,W[E]);}else{W.push(V);}}return W;};var O={level:-4,condition:-5,transformation:-6,simple:-7},H=function(E){return !(E==-4||E==-5||E==-6);},M=function(S,E){return H(S)||S==O[E];};var J={n:"",did:"-1"};var B=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9574,"Aggregation Function:"),slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"did",itemField:"n",cssText:"width:250px;margin:0px;",alias:"fctPulldown",onvalueChange:function(T){var U="",Y="",X=this.selectedItem;if(X){Y=X.n+": "+X.desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(X.h);var W=X.pars,S=[],V,E;S.push(X.n);S.push("(");for(V=0,E=W.length;V<E;V++){S.push(W[V].n);if(V!==(E-1)){S.push(", ");}}S.push(")");U=S.join("");}this.parent.parent.set("fctSyntax",U);this.parent.parent.set("fctDesc",Y);if(T.valueWas){this.parent.parent.onmetricModify();}},slot:"0,1"},{scriptClass:"mstrmojo.ToolBar",cssClass:"mstrmojo-oivmSprite grouped",cssText:"margin-right: 42px;",children:[{scriptClass:"mstrmojo.Button",iconClass:"tbOptions",title:mstrmojo.desc(-1,"Function Parameters"),onclick:function(){var E=this.parent.parent.parent;E.openPopup("functionPropsRef",{zIndex:E.zIndex+10});}}],slot:"0,2"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9575,"Expression:"),slot:"1,0"},{scriptClass:"mstrmojo.ME.MetricEditBox",alias:"metricEditBox",cssText:"width: 250px;",showStatus:false,ontokensModify:function(E){this.parent.parent.onmetricModify();},continueValidataion:function(){var E=this.parent.parent;E.oi.tks.items=E.getMetricDefAsTokens();E.validateSyntax(E.tbValidate);},updateInputBoxItems:function(E){var S=2;this.inputBox.set("items",E.items.slice(S,S+this.inputBox.items.length));},preBuildRendering:function(){var E=this.parent.parent,S=this.inputBox;mstrmojo.css.addWidgetCssClass(S,"expr");S.useKeyDelay=true;S.noCache=E.noCache;if(this._super){this._super();}},slot:"1,1"},{scriptClass:"mstrmojo.ToolBar",slot:"1,2",cssClass:"mstrmojo-oivmSprite grouped",cssText:"margin-right: 42px;",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var E=this.parent.parent.parent;L(E,"expression");}}]}],R=[{scriptClass:"mstrmojo.Button",cssClass:"toggle level",alias:"toggleLevel",text:mstrmojo.desc(4788,"Level"),bindings:{selected:function(){return M(this.parent.parent.did,"level");}},onclick:function(E){var S=!!!this.selected;this.set("selected",S);},slot:"0,0"},{scriptClass:"mstrmojo.ME.LevelInputBox",emptyText:mstrmojo.desc(9576,"Type the attribute name here..."),alias:"levelInput",bindings:{expanded:function(){var E=!this.parent.toggleLevel.selected;this.cssClass=this.cssClass.replace(/ hidden/g,"")+(E?" hidden":"");if(this.domNode){this.domNode.className=this.domNode.className.replace(/ hidden/g,"")+(E?" hidden":"");}},noCache:function(){return this.parent.parent.noCache;}},reportLevelAdded:true,onadd:function(E){var S=this.getSelectedObjects();this.set("reportLevelAdded",A.find(S,"did",-1)>-1);},onremove:function(E){var S=this.getSelectedObjects();this.set("reportLevelAdded",A.find(S,"did",-1)>-1);},onitemchange:function(){this.parent.parent.onmetricModify();},onSaveOnClose:function(){this.parent.parent.onmetricModify();},slot:"1,1"},{scriptClass:"mstrmojo.ToolBar",slot:"1,2",cssClass:"mstrmojo-oivmSprite grouped",bindings:{visible:function(){return this.parent.toggleLevel.selected;return M(this.parent.parent.did,"level");}},children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var E=this.parent.parent.parent;L(E,"level");}},{scriptClass:"mstrmojo.Button",iconClass:"tbOptions",title:mstrmojo.desc(9577,"Level Advanced Options"),onclick:function(){var E=this.parent.parent.parent;E.openPopup("levelAdvRef",{saveLevelOptions:function(T,S){E.levelCanContinue=T;E.levelFilterRest=S;},zIndex:E.zIndex+10});}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(9578,"Add Report Level"),iconClass:"tbReport",bindings:{enabled:"!this.parent.parent.levelInput.reportLevelAdded"},onclick:function(){var E=this.parent.parent.levelInput;E.add([{n:"Report Level",did:-1,t:-1,state:0}],E.items.length-1);}}]},{scriptClass:"mstrmojo.Button",cssClass:"toggle condition",alias:"toggleCondition",text:mstrmojo.desc(9579,"Condition"),bindings:{selected:function(){return M(this.parent.parent.did,"condition");}},onclick:function(E){var S=!!!this.selected;this.set("selected",S);},slot:"2,0"},{scriptClass:"mstrmojo.ME.ConditionInputBox",cssClass:"mstrmojo-ObjectInputBox singleObject condition",cssText:"width:252px;",emptyText:mstrmojo.desc(9580,"Type the filter name here..."),alias:"conditionInput",bindings:{expanded:function(){var E=!this.parent.toggleCondition.selected;this.cssClass=this.cssClass.replace(/ hidden/g,"")+(E?" hidden":"");if(this.domNode){this.domNode.className=this.domNode.className.replace(/ hidden/g,"")+(E?" hidden":"");}},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();},slot:"3,1"},{scriptClass:"mstrmojo.ToolBar",slot:"3,2",cssClass:"mstrmojo-oivmSprite grouped",bindings:{visible:function(){return this.parent.toggleCondition.selected;return M(this.parent.parent.did,"condition");}},children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",bindings:{enabled:"!this.parent.parent.conditionInput.isFull"},onclick:function(){var E=this.parent.parent.parent;L(E,"condition");}},{scriptClass:"mstrmojo.Button",iconClass:"tbOptions",title:mstrmojo.desc(9581,"Condition Advanced Options"),onclick:function(){var E=this.parent.parent.parent;E.openPopup("conditionAdvRef",{saveConditionOptions:function(T,S){E.conditionEmbedMethod=T;E.conditionIgnoreFilterElem=S;},zIndex:E.zIndex+10});}}]},{scriptClass:"mstrmojo.Button",cssClass:"toggle transformation",alias:"toggleTransformation",text:mstrmojo.desc(3324,"Transformation"),bindings:{selected:function(){return M(this.parent.parent.did,"transformation");}},onclick:function(E){var S=!!!this.selected;this.set("selected",S);},slot:"4,0"},{scriptClass:"mstrmojo.DataGrid",cssClass:"transformGrid",cssText:"width:100%",alias:"transformationGrid",bindings:{expanded:function(){var E=!this.parent.toggleTransformation.selected;this.cssClass=this.cssClass.replace(/ hidden/g,"")+(E?" hidden":"");if(this.domNode){this.domNode.className=this.domNode.className.replace(/ hidden/g,"")+(E?" hidden":"");}}},makeObservable:true,renderOnScroll:false,resizableColumns:true,itemDisplayField:"n",slot:"5,1",columns:[{headerText:"Name",dataField:"n",colCss:"nmCol",tooltip:true},{headerText:"Description",dataField:"desc",colCss:"descCol",tooltip:true},{dataWidget:{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(E){var S=this.dataGrid;S.remove(this.data);if(S.items.length<3){S.add([J]);}S.refresh();S.parent.parent.onmetricModify();}},headerText:"&nbsp",colCss:"actionsCol"}]},{scriptClass:"mstrmojo.ToolBar",slot:"5,2",cssClass:"mstrmojo-oivmSprite grouped",bindings:{visible:function(){return this.parent.toggleTransformation.selected;return M(this.parent.parent.did,"transformation");}},children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var E=this.parent.parent.parent;L(E,"transform");}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(7978,"Move Up"),iconClass:"tbMoveUp",onclick:function(){var U=this.parent.parent.transformationGrid,T=U&&U.selectedIndex,S=U&&U.items.length,V,E;if(T>-1){V=(T===0)?S:T-1;U.move(T,V);E=(T===0)?S-1:T-1;U.singleSelect(E);}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(7979,"Move Down"),iconClass:"tbMoveDown",onclick:function(){var U=this.parent.parent.transformationGrid,T=U&&U.selectedIndex,S=U&&U.items.length,V,E;if(T>-1){V=(T===(S-1))?0:T+2;U.move(T,V);E=(T===(S-1))?0:T+1;U.singleSelect(E);}}}]}],Q=mstrmojo.expr,A=mstrmojo.array,L=function(U,T){var V,E;switch(T){case"level":V=[Q.TP.ATTR,Q.TP.DIM];E="onLevelAdded";fctxt=16;break;case"transform":V=[Q.TP.ROLE];E="onTransformAdded";fctxt=26;break;case"condition":V=[Q.TP.FILTER,Q.STP.PROMPT_OBJECTS];E="onConditionAdded";fctxt=10;break;case"expression":V=[Q.TP.FACT,Q.TP.ATTR,Q.TP.FUNCTION,Q.TP.METRIC];E="onExpressionAdded";fctxt=25;break;default:}V[V.length]=Q.TP.FOLDER;U.openPopup("ob",{zIndex:U.zIndex+10});var S=U.ob.browser;S.browse({folderLinksContextId:fctxt,onSelectCB:[U,E],browsableTypes:V.join(","),includeObjectDesc:true});},N={1:"+",2:"*",3:"%",4:""},I={1:"",2:"!",3:"<",4:">",5:"<|",6:">|"},G=mstrmojo.ME.MetricToken.brackets;mstrmojo.ME.SimpleMetricEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper],{scriptClass:"mstrmojo.ME.SimpleMetricEditor",cssClass:"mstrmojo-Editor-me mstrmojo-SimpleMetricEditor",title:"",help:"Simple_metric_editor.htm",fctSyntax:"",fctDesc:"",did:O.simple,bindings:{candidates:"this.opener.candidates"},getMetricDefAsTokens:function K(){var X=this.metricContent1.fctPulldown.selectedItem,a=this.metricContent1.metricEditBox.inputBox.items,b=this.metricContent2.levelInput.getSelectedObjects(),T=this.metricContent2.conditionInput.getSelectedObjects(),E=this.metricContent2.transformationGrid.items,W=[],S,U;W.push({v:X.n,oi:X});W=W.concat(this.functionPropsRef.getTokens());W.push({v:"(",isDelimiter:true});for(S=0,U=a.length;S<U;S++){W.push(a[S]);}W.push({v:")",isDelimiter:true});W.push({v:"{",isDelimiter:true});var Y=null;for(S=0,U=b.length;S<U;S++){Y=b[S];W.push({v:I[Y.grouping],isDelimiter:true});W.push((Y.did===-1)?{v:"~",isDelimiter:true}:{v:G(Y.n),oi:Y});W.push({v:N[Y.filtering],isDelimiter:true});if(S<(U-1)){W.push({v:",",isDelimiter:true});}}if(!this.levelFilterRest){W.push({v:";",isDelimiter:true});W.push({v:"-",isDelimiter:true});}if(!this.levelCanContinue){W.push({v:";",isDelimiter:true});W.push({v:"/",isDelimiter:true});}W.push({v:"}",isDelimiter:true});if(T.length>0){W.push({v:"<",isDelimiter:true});W.push({v:G(T[0].n),oi:T[0]});W.push({v:";",isDelimiter:true});W.push({v:"@",isDelimiter:true});W.push({v:this.conditionEmbedMethod});W.push({v:";",isDelimiter:true});W.push({v:this.conditionIgnoreFilterElem?"-":"+",isDelimiter:true});W.push({v:">",isDelimiter:true});}var Z=A.indexOf(E,J);U=Z<0?E.length:Z;if(U>0){W.push({v:"|",isDelimiter:true});var V=null;for(S=0;S<U;S++){V=E[S];W.push({v:G(V.n),oi:V});if(S<(U-1)){W.push({v:",",isDelimiter:true});}}W.push({v:"|",isDelimiter:true});}for(S=0,U=W.length;S<U;S++){W[S].isNew=true;}return W;},getMetricDefFromTokens:function D(){var a=[],W=[],d=[],E=[],X=[],V=[],Z=(this.insertMode||this.opener&&this.opener.oi)?this.opener.oi.tks.items:this.oi.tks.items,Y=Z.length;if(this.insertMode||Y===0){E.push({n:"Report Level",did:-1,t:-1,state:0});}else{for(var U=0;U<Y;U++){var T=Z[U],b=T.tp,S=T.sctt;switch(S){case 65536:switch(b){case 280:a=T.oi;break;}break;case 131072:if(b==259||b==303){W.push({n:Z[U].v,v:Z[U+2].v,oi:Z[U+2].oi});}break;case 262144:switch(b){case 126:case 264:case 265:var c=b==126?{n:"Report Level",did:-1,t:-1,state:0}:T.oi;c.grouping=1,c.filtering=4;switch(Z[U-1].tp){case 33:c.grouping=2;break;case 60:c.grouping=3;break;case 62:c.grouping=4;break;case 297:c.grouping=5;break;case 298:c.grouping=6;break;}switch(Z[U+1].tp){case 37:c.filtering=3;break;case 42:c.filtering=2;break;case 43:c.filtering=1;break;}E.push(c);break;case 45:this.levelFilterRest=false;break;case 47:this.levelCanContinue=false;break;}break;case 327680:switch(b){case 270:case 273:X.push(T.oi);break;case 262:this.conditionEmbedMethod=T.v;break;case 43:this.conditionIgnoreFilterElem=false;break;case 45:this.conditionIgnoreFilterElem=true;break;}break;case 393216:switch(b){case 271:V.push(T.oi);break;}break;case -1:case 196608:switch(b){case 40:case 41:default:d.push(T);break;}break;}}}if(d.length>2){if(d[0].v=="("){d.shift();}if(d[d.length-1].v==")"){d.pop();}}return{fct:a,fctProps:W,level:E,filter:X,tranformation:V,expr:d};},levelCanContinue:true,levelFilterRest:true,conditionEmbedMethod:2,conditionIgnoreFilterElem:true,insertMode:false,_set_candidates:function(U,S){this.candidates=S;if(this.hasRendered&&this.visible){var T=this.metricContent1.metricEditBox.inputBox,E=this.metricContent2.levelInput;T.candidates=this.candidates;E.candidates=this.getCandidates(12);}return true;},getCandidates:function P(S){var T=this.candidates,E;if(T){E=A.filter(T.items,function(U){return U.t===S;});return{items:E,isComplete:T.isComplete};}return null;},onOpen:function F(){var Z=this.buttonBar.saveokButton,U=this.metricContent1.metricEditBox.inputBox,b=this.metricContent2.levelInput;if(this.insertMode){Z.set("text",mstrmojo.desc(2919,"Insert"));}else{Z.set("text",mstrmojo.desc(5891,"Save"));this._setupCandidatesCache(U);}var V=this.getMetricDefFromTokens();var X=mstrmojo.ME.MetricDataService.getAggFunctions(),Y=this.metricContent1.fctPulldown,a=V.fct&&V.fct.did||this.did;if(X&&Y){Y.set("items",X);if(a&&mstrmojo.ME.MetricDataService.isBasicAggMap(a)){Y.set("value",a);}else{Y.set("value","8107C31BDD9911D3B98100C04F2233EA");}}this.set("fctProps",V.fctProps);U.candidates=this.candidates;U.set("items",V.expr);b.candidates=this.getCandidates(12);b.set("items",V.level);var T=this.metricContent2.conditionInput;if(!this.noCache&&!T.candidates){var c=function(d){if(d){var f={items:d.items,isComplete:(d.bc===-1||(d.bb+d.bc>d.sz))};T.set("candidates",f);}},S=function(d){mstrmojo.alert(d.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getFilters({pattern:"*",blockBegin:1,blockCount:-1},{success:c,failure:S});}T.set("items",V.filter);var E=this.metricContent2.transformationGrid;for(var W=V.tranformation.length;W<3;W++){V.tranformation.push(J);}E.set("items",V.tranformation);this.set("title",this.insertMode?this.metricContent1.fctPulldown.selectedItem.n:mstrmojo.desc(9582,"Function Editor:")+" "+this.oi.n);},functionPropsRef:{scriptClass:"mstrmojo.Editor",cssText:"width: 415px;",onOpen:function(){var E=this.opener;this.set("title",E.metricContent1.fctPulldown.selectedItem.n+" "+mstrmojo.desc(-2,"Parameters"));this.set("fctProps",C(E.fctProps,E.metricContent1.fctPulldown.selectedItem.pros));},children:[{scriptClass:"mstrmojo.DataGrid",alias:"fctPropsGrid",cssClass:"functionPropsGrid",cssText:"margin: 5px auto; 0",makeObservable:true,banding:false,columns:[{headerText:"Name",dataFunction:function(T,E,S){return'<div class="mstrmojo-DataRow-text"title="'+(T.desc||"")+'">'+T.n+":</div>";},colCss:"name"},{headerText:"Value",dataWidgetBuilder:function(U,E,T){var S;switch(U.dtp){case 11:S={scriptClass:"mstrmojo.Pulldown",itemIdField:"did",items:[{n:"False",did:"0"},{n:"True",did:"-1"}],popupToBody:true,popupZIndex:100,postCreate:function(V){var W=this.data;this.value=!!W.v?(W.v=="False"?0:-1):(W.dfv||0);},getTokens:function(){var V=this.data;if(this.value!==V.dfv){return[{v:V.n},{v:"=",isDelimiter:true},{v:this.value=="-1"?"True":"False"}];}else{return[];}}};break;default:S={scriptClass:"mstrmojo.Pulldown",itemIdField:"did",items:U.items,popupToBody:true,popupZIndex:100,getTokens:function(){var V=this.data;return this.selectedIndex>0?[{v:V.n},{v:"=",isDelimiter:true},{v:this.selectedItem.n,oi:this.selectedItem,isNew:true}]:[];},postCreate:function(){var W=this;switch(U.dtp){case -1:var X=function(Y){if(Y){W.set("items",[{n:"(Nothing)",did:-1}].concat(Y.items));W.set("value",U.oi&&U.oi.did);}},V=function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getFacts({pattern:"*",blockBegin:1,blockCount:-1,rootFolderType:39},{success:X,failure:V});break;case -2:break;}}};break;}S.alias="inputWidget";return S;},colCss:"dtp"}],bindings:{items:function(){return this.parent.fctProps;}}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}],getTokens:function(){var V=this.fctPropsGrid;if(!V){return[];}var S=V&&V.ctxtBuilder.itemWidgets,X=[],Z=[],E,Y,U,T,W;for(U=0,W=S.length;U<W;U++){X.push(S[U].inputWidget.getTokens());}W=X.length;if(W>0){E=false;Z.push({v:"<",isDelimiter:true});for(U=0;U<W;U++){Y=X[U];l=Y.length;if(l===0){continue;}E=true;for(T=0;T<l;T++){Z.push(Y[T]);}Z.push({v:",",isDelimiter:true});}Z.pop();if(E){Z.push({v:">",isDelimiter:true});}}return Z;}},levelAdvRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9577,"Level Advanced Options"),help:"Level_Advanced_Options_dialog_box.htm",cssText:"width: 386px;",onOpen:function(){var E=this.opener;this.contentTable.ccCheckBox.set("checked",E.levelCanContinue);this.contentTable.frCheckBox.set("checked",E.levelFilterRest);},children:[{scriptClass:"mstrmojo.Table",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.CheckBox",alias:"ccCheckBox",slot:"0,0",label:mstrmojo.desc(9583,"Allow other users to add extra units to this definition")},{scriptClass:"mstrmojo.CheckBox",alias:"frCheckBox",slot:"1,0",label:mstrmojo.desc(9584,"Include filter attributes which are not in report or level in metric calculation")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveLevelOptions(E.contentTable.ccCheckBox.checked,E.contentTable.frCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},conditionAdvRef:{scriptClass:"mstrmojo.Editor",title:"Condition Advanced Options",help:"Condition_Advanced_Options_dialog_box.htm",cssText:"width: 286px;",onOpen:function(){var E=this.opener;this.contentTable.emPulldown.set("value",E.conditionEmbedMethod);this.contentTable.irfeCheckBox.set("checked",E.conditionIgnoreFilterElem);},children:[{scriptClass:"mstrmojo.Table",cssText:"margin-top:5px;",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(9585,"Interaction between metric filter and report filter:")},{scriptClass:"mstrmojo.Pulldown",alias:"emPulldown",itemField:"n",itemIdField:"did",slot:"1,0",value:2,items:[{n:mstrmojo.desc(9586,"Merge into new"),did:1},{n:mstrmojo.desc(9587,"Merge report filter into metric"),did:2},{n:mstrmojo.desc(9588,"Merge metric condition into report"),did:3}]},{scriptClass:"mstrmojo.CheckBox",alias:"irfeCheckBox",slot:"2,0",label:mstrmojo.desc(9589,"Ignore related report filter elements")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveConditionOptions(E.contentTable.emPulldown.value,E.contentTable.irfeCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},onLevelAdded:function(E){var S=this.metricContent2.levelInput;E.state=0;S.add([E],S.items.length-1);this.closePopup();this.onmetricModify();},onConditionAdded:function(S){var E=this.metricContent2.conditionInput;S.state=0;E.add([S],E.items.length-1);this.closePopup();this.onmetricModify();},onExpressionAdded:function(S){var E=this.metricContent1.metricEditBox.inputBox;E.add([{v:S.n,oi:S,isNew:true}]);this.closePopup();this.onmetricModify();},onTransformAdded:function(E){E.state=0;var T=this.metricContent2.transformationGrid;var S=A.indexOf(T.items,J);if(S>-1){T.items.pop();T.items.add([E],S);T.refresh();}else{T.add([E],T.items.length);}this.closePopup();this.onmetricModify();},handleValidation:function(E){this.metricContent1.metricEditBox.handleValidation(E);},children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-SME-content1",alias:"metricContent1",layout:[{cells:[{cssClass:"mstrmojo-SME-label"},{},{}]},{cells:[{cssClass:"mstrmojo-SME-label"},{cssText:"width:252px;padding-right:6px;"},{cssClass:"mstrmojo-ME-toolbar"}]}],cellPadding:3,children:B},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-SME-content2",alias:"metricContent2",layout:[{cells:[{colSpan:3}]},{cells:[{cssClass:"mstrmojo-SME-label"},{},{cssClass:"mstrmojo-ME-toolbar"}]},{cells:[{colSpan:3}]},{cells:[{cssClass:"mstrmojo-SME-label"},{},{cssClass:"mstrmojo-ME-toolbar"}]},{cells:[{colSpan:3}]},{cells:[{cssClass:"mstrmojo-SME-label"},{cssText:"width:252px;padding-right:6px;"},{cssClass:"mstrmojo-ME-toolbar"}]}],cellPadding:3,children:R},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FE-functionDesc",bindings:{text:"this.parent.fctDesc"},slot:"editorNode"},mstrmojo.ME._MetricEditorHelper.switchRef,mstrmojo.ME._MetricEditorHelper.buttonBarRef]});mstrmojo.ME.SimpleMetricEditor.EnumEditorComponents=O;})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Editor","mstrmojo.SaveAsEditor","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricFormatEditor","mstrmojo.ColorPicker","mstrmojo.ME.MetricEditBox","mstrmojo.InlineEditBox","mstrmojo.ME.FunctionSelector","mstrmojo.ME.FunctionWizard","mstrmojo.MenuButton","mstrmojo.ME.SimpleMetricEditor","mstrmojo.ME.OptionDialog","mstrmojo.ToolSeparator","mstrmojo.ME._MetricEditorHelper");var G=mstrmojo.expr,F={functionSelector:0,advanced:65536,simple:131072,func:196608},H=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS;function C(E,J){var I=[];E.oi.tks.met=F.functionSelector;E.oi.tks.items=I;J.clearTokens(I);}mstrmojo.ME.MetricEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper],{scriptClass:"mstrmojo.ME.MetricEditor",cssClass:"mstrmojo-MetricEditor",zIndex:10,title:mstrmojo.desc(517,"Metric"),help:"Metric_Formula_Editor.htm",onObjectInsert:function D(I){var J=this.metricEditBox.inputBox,E={v:mstrmojo.ME.MetricToken.brackets(I.n),oi:I,isNew:true};J.insertTokens([E]);this.closePopup();},onOpen:function B(){var I=this,E=this.oi,J=this.metricEditBox,K=J.inputBox;this._setupCandidatesCache(K);K.noCache=this.noCache;K.useKeyDelay=this.useKeyDelay;this.set("title",mstrmojo.desc(9559,"Formula Editor:")+" "+E.n);J.set("iStatus","");J.set("vStatus",this.vStatus||0);if(E&&E.tks){this.preprocessTokenStram(E.tks);K.set("items",E.tks.items);}},getMetricDefAsTokens:function(){return(this.oi.tks.items);},onClose:function A(){if(this._super){this._super();}this.metricEditBox.inputBox.set("items",[]);},handleValidation:function(E){this.metricEditBox.handleValidation(E);},children:[{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-toolBox mstrmojo-ME-toolBox",children:[{scriptClass:"mstrmojo.ToolBar",cssClass:"mstrmojo-oivmSprite grouped",cssText:"float: right",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(9560,"Insert function..."),iconClass:"tbFunction",onclick:function(E){var I=this.parent.parent.parent,J=I.metricEditBox.inputBox;I.openPopup("functionSelector",{functions:mstrmojo.ME.MetricDataService.getFunctionCatList(),zIndex:I.zIndex+1,openWizard:function(L){var K={zIndex:I.zIndex+1,insertMode:true,insertOnFinish:function(M){J.insertTokens(M);}};if(mstrmojo.ME.MetricDataService.isBasicAggMap(L.did)||L.did<-1){K.candidates=J.candidates;K.did=L.did;I.openPopup("simpleMetricRef",K);}else{K.fctOi=L;K.oi={did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};I.openPopup("wizard",K);}}});}},{scriptClass:"mstrmojo.ToolSeparator"},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(6571,"Browse..."),iconClass:"tbBrowse",onclick:function(E){var J=this.parent.parent.parent;J.openPopup("ob",{zIndex:J.zIndex+1});var I=J.ob.browser;I.browse({folderLinksContextId:25,onSelectCB:[J,"onObjectInsert"],browsableTypes:[G.TP.FOLDER,G.TP.FACT,G.TP.ATTR,G.TP.FUNCTION,G.TP.FILTER,G.STP.PROMPT_OBJECTS,G.TP.ATTR,G.TP.DIM,G.TP.METRIC,G.TP.ROLE].join(",")});}},{scriptClass:"mstrmojo.ToolSeparator"},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(9110,"Syntax Validation"),iconClass:"tbValidate",onclick:function(E){var I=this.parent.parent.parent,J=I.metricEditBox;J.set("vStatus",H.VALIDATING);I.tbValidate=this;I.validateSyntax(this);}},{scriptClass:"mstrmojo.ToolSeparator"},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(9561,"Clear Content"),iconClass:"tbClear",onclick:function(E){var I=this.parent.parent.parent,J=I.metricEditBox,K=J.inputBox;C(I,K);K.raiseChangeEvent({type:"clear"});}}]}]},{scriptClass:"mstrmojo.ME.MetricEditBox",alias:"metricEditBox",ontokensModify:function(E){this.parent.onmetricModify();},continueValidataion:function(){var E=this.parent;E.validateSyntax(E.tbValidate);}},{scriptClass:"mstrmojo.Button",alias:"btnSwitch",cssClass:"mstrmojo-ME-switch",text:mstrmojo.desc(9562,"Switch to Function Editor"),bindings:{enabled:function(){var I=this.parent.metricEditBox.vStatus==H.ERROR,E=this.parent.oi.tks.met,J=!I&&(!E||E&&E!=F.advanced);empty=this.parent.metricEditBox.inputBox.items.length==0;return J||empty;}},onclick:function(){var I=this.parent;var E=function(L){var M=L.oi,K=M.tks.met||F.functionSelector,J={zIndex:L.zIndex+1,candidates:L.candidates,oi:M,did:M.did,insertMode:false},N={0:"functionSelector",131072:"simpleMetricRef",196608:"wizard"}[K];if(K==F.functionSelector||K==F.func){J.functions=L.functions;}if(N){if(L.dirty){J.dirty=L.dirty;}L.openPopup(N,J);L.close();}};if(I.metricEditBox.inputBox.items.length==0){E(I);}else{I.cbSwtichEditor=E;I.tbValidate=this;I.validateSyntaxAndSwitch(this,"switch");}}},mstrmojo.ME._MetricEditorHelper.buttonBarRef]});})();