var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},now:function now(){return new Date().getTime();},usesFrames:false};mstrmojo.gmaps={};(function(){var F=mstrmojo;F.global=(function(){var G=function(){return this;};return G.call(null);}());F.dbg=F.emptyFn;F.dbg_stack=F.emptyFn;F.dbg_xhr=F.emptyFn;F.dbg_profile=F.emptyFn;F.platform={};F.prompt={};F.settings={};F.ui={};F.ACL={};F.storage={};F.utils={};F.maps={};F.maps.androidmap={};F.maps.jsmap={};F.graph={};F.IPA={};F.ME={};F.Architect={};F.plugins={};F.gmaps={};F.DI={};F.qb={};F.WH={};F.txEditor={};F.express={ui:{}};F.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{}},selectors:{},ui:{}};F.iphone={};F.winphone={};F.mstr={};F.err=function E(I){var H=I.name+': "'+I.message+'"';if(F.debug){if(I.fileName){H+=" at\n    "+I.fileName;}if(I.hasOwnProperty("lineNumber")){H+=": "+I.lineNumber;}else{if(I.hasOwnProperty("line")&&I.sourceURL){var G=I.sourceURL.split("/");H+="("+G[G.length>1?G.length-1:0]+":"+I.line+")";}}}this.dbg(H);if(F.Dialog){F.alert(I.message,null,I.name);}else{window.alert(H);}};F.confirm=function B(G){return window.confirm(G);};F.alert=function D(G){window.alert(G);};var C=!!(/return true/.test(function(){return true;}));F.mixin=function A(K,I){if(K){I=I||{};var J=/this\.\_super/;var H=function(O,N){return function M(){var Q=this._super;this._super=N;var P=O.apply(this,arguments||[]);this._super=Q;return P;};};var G=K.__onmixin__;if(G){delete K.__onmixin__;}var L;for(L in K){if((typeof K[L]==="function")&&(!C||J.test(K[L]))){I[L]=H(K[L],I[L]);}else{I[L]=K[L];}}if(G){K.__onmixin__=G;}}return I;};}());(function(){var _xhr;var _missing={};var _G=mstrmojo.global,_app=_G.mstrApp||{},_jsRoot=_app.jsRoot||"../javascript/",_jsMojoRoot=_app.jsMojoRoot||"../javascript/mojo/js/source/",_isIE=!!document.all;function _fqcn2File(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17));fqcn="../plugins/"+pluginName+"/javascript/"+_jsMojoRoot+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");}else{if(fqcn.match(/^mstrmojo\./)){fqcn=_jsMojoRoot+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=_jsRoot+fqcn.replace(/\./gm,"/");}}return fqcn+".js";}function _getXHR(){_xhr=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function _syncGet(file){var result=null;if(!_xhr){_getXHR();}if(_xhr){try{_xhr.open("GET",file,false);_xhr.send(null);result=_xhr.responseText||null;}catch(localerr){}if(!_isIE&&_xhr.abort){_xhr.abort();}}return result;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function _syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!_xhr){_getXHR();}if(_xhr){try{var config=mstrConfig,m=null;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(config&&config.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}_xhr.open(method,appendUrlParams(method,baseUrl,params),false);if(method!=="POST"){params=null;}else{params=encodeParams(params);_xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");}_xhr.send(params);result=_xhr.responseText||null;}catch(localerr){window.console.log(localerr);}}return result;}function _jsGet(file,nullCheck){var js=_syncGet(file);if(js){try{eval(js);return nullCheck?!!eval(nullCheck):true;}catch(localerr){window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var o;try{o=eval(fqcn);}catch(localerr){}if(o){this.loaded[fqcn]=true;}return !!o;},load:function ld(fqcn){if(_missing[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(_fqcn2File(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}_missing[fqcn]=true;return false;}};var _L=mstrmojo.loader,_LL=_L.loaded;var _reqCache={};mstrmojo.requiresCls=function reqCls(){var as=arguments,ns=[],len=as.length,i;for(i=0;i<len;i++){var n=as[i];if(!n||_LL[n]||_reqCache[n]||_missing[n]){continue;}if(!n.match(/^mstrmojo\.plugins\./)){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!_reqCache[s]){ns.push(s);_reqCache[s]=true;}}}ns.push(n);_reqCache[n]=true;}var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!_L.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}return true;};var _D=mstrmojo.descriptors,_dPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];_D[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;}if(typeof mstrApp!="undefined"){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}if(typeof mstrApp!="undefined"){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var _reqDesc=function(prefix,ids){var as=ids,ns=[],len=as.length,i;for(i=0;i<len;i++){var k=as[i];if(k&&!(_D.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=_syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=eval("("+response+")");populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var p=prefix,args=[].slice.call(arguments);args[0]=null;_reqDesc(p,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){_reqDesc(_dPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if(_D.hasOwnProperty(_dPrefix+descID)){return _D[_dPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";_D[_dPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if(_D.hasOwnProperty(prefix+descID)){return _D[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";_D[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){_LL[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){_reqCache[fqcn]=false;_LL[fqcn]=false;eval(fqcn+" = null");};var mx=mstrmojo.mixin;mstrmojo.declare=function dcl(SuperCls,mixins,config){function constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){constr.prototype=new SuperCls({dontInit:true});constr.prototype.constructor=constr;}var proto=constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){_LL[config.scriptClass]=true;}}return constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getVRN(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));if(!isSameWebApp){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>0){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};}());var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var A;var B;var C;try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");A=B.GetVariable("$version");}catch(C){}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");A="WIN 6,0,21,0";B.AllowScriptAccess="always";A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A="WIN 3,0,18,0";}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");A="WIN 2,0,0,11";}catch(C){A=-1;}}return A;}function GetSwfVer(){var G=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var F=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var A=navigator.plugins["Shockwave Flash"+F].description;var E=A.split(" ");var C=E[2].split(".");var H=C[0];var B=C[1];if(E[3]!=""){tempArrayMinor=E[3].split("r");}else{tempArrayMinor=E[4].split("r");}var D=tempArrayMinor[1]>0?tempArrayMinor[1]:0;var G=H+"."+B+"."+D;}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){G=4;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){G=3;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){G=2;}else{if(isIE&&isWin&&!isOpera){G=ControlVersion();}}}}}return G;}function DetectFlashVer(F,D,C){versionStr=GetSwfVer();if(versionStr==-1){return false;}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",");}else{versionArray=versionStr.split(".");}var E=versionArray[0];var A=versionArray[1];var B=versionArray[2];if(E>parseFloat(F)){return true;}else{if(E==parseFloat(F)){if(A>parseFloat(D)){return true;}else{if(A==parseFloat(D)){if(B>=parseFloat(C)){return true;}}}}}return false;}}}function AC_AddExtension(B,A){if(B.indexOf("?")!=-1){return B.replace(/\?/,A+"?");}else{return B+A;}}function AC_Generateobj(F,E,A,D){var C="";if(isIE&&isWin&&!isOpera){C+="<object ";for(var B in F){C+=B+'="'+F[B]+'" ';}for(var B in E){C+='><param name="'+B+'" value="'+E[B]+'" /> ';}C+="></object>";}else{C+="<embed ";for(var B in A){C+=B+'="'+A[B]+'" ';}C+="> </embed>";}if(typeof (D)!="undefined"){var G=(typeof D=="string")?document.getElementById(D):D;G.innerHTML=C;}else{document.write(C);}}function AC_FL_RunContent(){var A=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(A.objAttrs,A.params,A.embedAttrs,A.parentDiv);}function AC_GetArgs(B,E,G,D,H){var A=new Object();A.embedAttrs=new Object();A.params=new Object();A.objAttrs=new Object();for(var C=0;C<B.length;C=C+2){var F=B[C].toLowerCase();switch(F){case"classid":break;case"parentdiv":A.parentDiv=B[C+1];case"pluginspage":A.embedAttrs[B[C]]=B[C+1];break;case"src":case"movie":B[C+1]=AC_AddExtension(B[C+1],E);A.embedAttrs.src=B[C+1];A.params[G]=B[C+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":A.objAttrs[B[C]]=B[C+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":A.embedAttrs[B[C]]=A.objAttrs[B[C]]=B[C+1];break;default:A.embedAttrs[B[C]]=A.params[B[C]]=B[C+1];}}A.objAttrs.classid=D;if(H){A.embedAttrs.type=H;}return A;}AC_OETagsObj.prototype=new Object();function AC_OETagsObj(){}mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats();var I=J.toLowerCase();if(H&&I in H){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects={height:function A(){return B("Height",this);},width:function D(){return B("Width",this);},getMaxZIndex:function C(){var E=0;mstrmojo.array.forEach(this.children,function(F){E=Math.max(E,F.getFormats()["z-index"]);});return E;}};})();(function(){var R=Math;function AD(G,b){return b||(G||window).event;}var Ae=!!document.all,s=navigator.userAgent,h=!Ae&&!!s.match(/Firefox/),n=0,t=!!s.match(/Android/),AY=!!s.match(/iPad/),AS=!!document.createTouch||t,q=!!s.match(/PlayBook/),S=!!s.match(/Windows Phone/),V=Ae&&!!s.match(/MSIE 10/),Af=!Ae&&!!s.match(/Trident.*rv/),x=Ae&&!V,g=h?"-moz-":Ae?"":"-webkit-",AJ=h?"Moz":V?"":Ae?"ms":"webkit",AQ=(V?"t":"T"),AM=AJ+AQ+"ransition",Ac=AZ(),AV=AG(),AC=W(),A=Q(),o=i();function AZ(){return AJ+AQ+"ransform";}function AG(){return AM+"Property";}function W(){return AM+"Duration";}function Q(){return(V||h)?"transitionend":"webkitTransitionEnd";}function i(){return AJ+"BoxShadow";}function AP(){if(!n&&h){var G=s.match(/.*Firefox\/([\d|\.]*).*/);if(G){n=parseFloat(G[1],10);}}return n;}function Ad(){var Ah=0,Al=0,Ai=window,Aj=document,G=Aj.body,Ak=Aj.documentElement;if(typeof Ai.pageYOffset=="number"){Al=Ai.pageYOffset;Ah=Ai.pageXOffset;}else{if(G&&(G.scrollLeft||G.scrollTop)){Al=G.scrollTop;Ah=G.scrollLeft;}else{if(Ak&&(Ak.scrollLeft||Ak.scrollTop)){Al=Ak.scrollTop;Ah=Ak.scrollLeft;}}}return{x:Ah,y:Al};}function AH(G){G=G||0;G=String(G);return((G.indexOf("%",0))!=-1)?G:(G+"px");}function AN(w,Ak,Aj,Ai,Ah){if(!mstrmojo.dom.isWinPhone){Ai=(Ai||false||this.isHWAccelerated);}else{Ai=false;}var b=Ah+(Ai?"3d":"")+"(",G=Ai?(","+Aj+")"):")";return b+w+","+Ak+G;}var L=1,AW=2,Y=3,D=4,K=5;function AA(Ak,Aj,An){var Am=Ak.style,b=Am.display,Ai=this.windowDim(),Ah=Ad();Am.display="block";var Al=Ai.w-Ak.clientWidth,Ao=Ai.h-Ak.clientHeight,G={4:0,5:Al,3:Al/2},w={1:0,3:Ao/2,2:Ao};Am.left=G[Aj]+Ah.x+"px";Am.top=w[An]+Ah.y+"px";Am.display=b;}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:s,isIE:Ae,isIE6:Ae&&!!s.match(/MSIE 6/),isIE7:Ae&&!!s.match(/MSIE 7/),isIE8:Ae&&!!s.match(/MSIE 8/),isIE9:Ae&&!!s.match(/MSIE 9/),isIE10:V,isIEW3C:Af,isNSIE:Ae&&!V,isDXIE:x,isFF:h,isWK:!!s.match(/AppleWebKit/),isSafari:!!s.match(/Safari/)&&!s.match(/Chrome/),isHWAccelerated:!t,isAndroid:t,isIPad:AY,isPlayBook:q,isWinPhone:S,supportsTouches:AS,TOUCHSTART:AS?"touchstart":"mousedown",TOUCHMOVE:AS?"touchmove":"mousemove",TOUCHEND:AS?"touchend":"mouseup",TOUCHCANCEL:AS?"touchcancel":"",RESIZE:AS?"orientationchange":"resize",CSS3_PREFIX:g,CSS3_BOXSHADOW:o,CSS3_TRANSFORM:Ac,CSS3_TRANSITION:AM,CSS3_TRANSITION_PROPERTY:AV,CSS3_TRANSITION_DURATION:AC,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},supports:function B(b){var G=this.isFF&&AP();switch(b){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||G>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||G>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);}return false;},replace:function F(w,G){if(!w||!G){return ;}var b=w.parentNode;if(b){b.replaceChild(G,w);}},attachEvent:function z(w,b,Ah,G){if(w.addEventListener){return w.addEventListener(b,Ah,!!G);}else{return w.attachEvent("on"+b,Ah);}},detachEvent:function AT(w,b,Ah,G){if(!w){return ;}if(w.removeEventListener){w.removeEventListener(b,Ah,!!G);}else{w.detachEvent("on"+b,Ah);}},attachOneTimeEvent:function Z(Ah,b,Ai,G){var w=function(Aj){Ai(Aj);mstrmojo.dom.detachEvent(this,b,w,G);};this.attachEvent(Ah,b,w,G);Ah=null;return w;},captureDomEvent:function AL(Aj,Ah,b,Ai,w){var G=mstrmojo.all[Aj];if(G){G.captureDomEvent(Ah,b,Ai,w);}},translate:function O(w,b,Aj,Ai,G,Ah){G=(G&&" "+G)||"";w.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(b,Aj,Ai,Ah)+G;},createTranslateString:function T(G,Ah,w,b){G=AH(G);Ah=AH(Ah);w=AH(w);return AN(G,Ah,w,b,"translate");},createScaleString:function AB(G,Ah,w,b){G=G||0;Ah=Ah||0;w=w||0;return AN(G,Ah,w,b,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function E(w,G,Ah,Aj){var b=w.id+"-"+G,Ai=this._bufferConnects[b];if(!Ai){Ai=this._bufferConnects[b]={elId:w.id,eventName:G,timer:null,bufferSize:Aj,listeners:[],callback:function(Ak){mstrmojo.dom._callback(Ak,mstrmojo.global,b);return true;}};this.attachEvent(w,G,Ai.callback);}Ai.listeners.push(Ah);},_callback:function N(Ai,G,w){if(!Ai){Ai=G.event;}var Ah=this._bufferConnects[w],Aj=Ah&&Ah.timer;if(Ah&&!Aj){var b=(Ah.bufferSize===null)?this._bufferSize:Ah.bufferSize;if(Ah.bufferSize){Ah.timer=G.setTimeout(function(){mstrmojo.dom.updateBuffers(w);},b);}else{mstrmojo.dom.updateBuffers(w);}}},updateBuffers:function AX(Ah){var Ai=this._bufferConnects[Ah],b=Ai&&Ai.listeners;for(var w=0,G=b&&b.length||0;w<G;w++){b[w]();}if(Ai&&Ai.timer){delete Ai.timer;}},detachBufferedEvent:function a(Aj,w,Ak){if(!Aj){return ;}var Ai=Aj.id+"-"+w,Al=this._bufferConnects[Ai],b=Al&&Al.listeners,G=(b&&b.length)||0;if(G){for(var Ah=G-1;Ah>-1;Ah--){if(b[Ah]==Ak){b.splice(Ah,1);}}if(!b.length){this.detachEvent(Aj,w,Al.callback);delete this._bufferConnects[Ai];if(Al.timer){mstrmojo.global.clearTimeout(Al.timer);}}}},eventTarget:function AE(G,b){b=AD(G,b);return b.target||b.srcElement;},ctrlKey:function Aa(G,b){return AD(G,b).ctrlKey;},shiftKey:function AF(G,b){return AD(G,b).shiftKey;},getButton:function AR(G,b){return((AD(G,b)).button==2)?2:1;},getMousePosition:function j(Ai,Ah){Ah=Ah||window;var w,Al;if(mstrmojo.dom.isIE){Ai=Ai||Ah.event;var Aj=document,G=Aj.body,Ak=Aj.documentElement;w=Ai.clientX+G.scrollLeft+(Ak.scrollLeft||0);Al=Ai.clientY+G.scrollTop+(Ak.scrollTop||0);}else{w=Ai.pageX;Al=Ai.pageY;}return{x:w,y:Al};},position:function(b,w){var Aj={x:0,y:0};if(b&&b.getBoundingClientRect){try{Aj=b.getBoundingClientRect();}catch(Ai){Aj={left:0,top:0,right:0,bottom:0,height:0,width:0};}Aj={x:Aj.left,y:Aj.top,w:Aj.right-Aj.left,h:Aj.bottom-Aj.top};if(this.isIE6||this.isIE7){var G=b.ownerDocument;if(G){var Al=G.documentElement,Ak=Al.getBoundingClientRect();Aj.x-=Ak.left;Aj.y-=Ak.top;}}}if(w){var Ah=Ad();Aj.x+=Ah.x;Aj.y+=Ah.y;}return Aj;},delta:function J(w,G){G=G||document.body;var b=this.position(w),Ah=this.position(G);return{x:Math.round(b.x-Ah.x),y:Math.round(b.y-Ah.y)};},windowDim:function Ag(){var G=0,Ah=0,Ai=window,Aj=document,Ak=Aj.documentElement,b=Aj.body;if(typeof (Ai.innerWidth)=="number"){G=Ai.innerWidth;Ah=Ai.innerHeight;}else{if(Ak&&(Ak.clientWidth||Ak.clientHeight)){G=Ak.clientWidth;Ah=Ak.clientHeight;}else{if(b&&(b.clientWidth||b.clientHeight)){G=b.clientWidth;Ah=b.clientHeight;}}}return{w:G,h:Ah};},center:function AK(G){AA.call(this,G,Y,Y);},bottomCenter:function H(G){AA.call(this,G,Y,AW);},clearBrowserHighlights:function P(G){G=G||self;if(Ae){var Ak=G.document,Aj=Ak&&Ak.selection,Ah=Aj&&Aj.empty;if(Ah){try{Aj.empty();}catch(w){}}}else{var b=G.getSelection,Ai=b&&G.getSelection();if(Ai&&!Ai.isCollapsed){if(Ai.empty){Ai.empty();}else{if(Ai.removeAllRanges){Ai.removeAllRanges();}}}}},findAncestorByAttr:function AO(Ai,w,b,G){var Aj=b?Ai:Ai&&Ai.parentNode;while(Aj&&(Aj!=G)){var Ah=Aj.getAttribute&&Aj.getAttribute(w);if(Ah!=null){return{node:Aj,value:Ah};}Aj=Aj.parentNode;}return null;},findAncestorByName:function Ab(w,Aj,b,G){Aj=Aj&&Aj.toLowerCase();var Ah=b?w:w&&w.parentNode;while(Ah&&(Ah!=G)){var Ai=Ah.nodeName;if(Ai&&(Ai.toLowerCase()==Aj)){return Ah;}Ah=Ah.parentNode;}return null;},contains:function M(Ah,Ai,b,G){var w=Ai;if(!b){w=w.parentNode;}while(w){if(w==Ah){return true;}if(w===G){break;}w=w.parentNode;}return false;},preventDefault:function AU(G,b){if(!b){b=G.event;}if(b.preventDefault){b.preventDefault();}else{b.returnValue=false;}},stopPropogation:function k(G,b){if(!b){b=G.event;}if(b.stopPropogation){b.stopPropogation();}else{b.cancelBubble=true;}},firstTouch:function C(G,b){return b&&b.touches&&b.touches.length?b.touches[0]:(b||G.event);},firstChangedTouch:function I(G,b){return b&&b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:(b||G.event);},isLandscape:function X(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function(G){while(G){var b=G.mstrmojoId;if(b!=null){return mstrmojo.all[b];}G=G.parentNode;}return null;},setCaret:function(G,w){if(G.setSelectionRange){G.focus();G.setSelectionRange(w,w);}else{if(G.createTextRange){var b=G.createTextRange();b.move("character",w);b.select();}}}});var AI=mstrmojo.dom,f=window,l=document,U=l&&l.documentElement,p=l&&l.body;if(f.innerWidth){AI.getHorizontalScroll=function(){return f.pageXOffset;};AI.getVerticalScroll=function(){return f.pageYOffset;};}else{if(U&&U.clientWidth){AI.getHorizontalScroll=function(){return U.scrollLeft;};AI.getVerticalScroll=function(){return U.scrollTop;};}else{if(p.clientWidth){AI.getHorizontalScroll=function(){return p.scrollLeft;};AI.getVerticalScroll=function(){return p.scrollTop;};}}}})();mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function rqMth(B){if(!B){return ;}if(typeof (this[B])==="function"){return true;}else{var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof (A)==="string"){this.requiresCls(A);return typeof (this[B])==="function";}return false;}},requiresCls:function req(mixins,callback){if(mixins){if(typeof (mixins)=="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin;for(var i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof (A)=="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresES(E,F,B){if(E&&E instanceof Array){if(E.length==0){F&&F.call(B);return ;}if(E[0].forceReload&&E[0].forceReload==false&&mstrmojo.LoadedExternalJSURLs[E[0].url]){E.splice(0,1);return this.requiresExternalScripts(E,F,B);}var A=document.createElement("script"),C=!!document.all;A.type="text/javascript";A.src=E[0].url;if(!E[0].callbackParamName){if(C){A.onreadystatechange=function(){if(A.readyState=="loaded"||A.readyState=="complete"){A.onreadystatechange=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}}};}else{A.onload=function(){A.onload=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}};}}else{if(E[0].callbackParamName.length!=0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy==true){var D=this;window.setTimeout(function(){D.requiresExternalScripts(E,F,B);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+E[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=E;mstrmojo._LoadsScript.callback=F;mstrmojo._LoadsScript.esScritsContext=B;}}document.getElementsByTagName("head")[0].appendChild(A);}}});(function(){mstrmojo._IsSelectorTarget={_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(B){var C=((B)?"add":"remove")+"DirtyKey";if(this.parent&&this.parent[C]){this.parent[C](this.k);}}};})();(function(){var A={};mstrmojo.NumberFormat={getInstance:function B(F,G){var E=F+"--"+G;if(E in A){return A[E];}var C={parse:function(H){},format:function(H){}};if(F==="."&&G===","){C.parse=function(H){if(!H){return NaN;}var I=H.replace(/,/g,"");return Number(I);};C.format=function(H){return Number(H).toString();};}else{var D=new RegExp("\\"+G,"g");C.parse=function(I){if(!I){return NaN;}var H=I.replace(D,"").replace(F,".");return Number(H);};C.format=function(I){var H=Number(I).toString();return H.replace(".",F);};}A[E]=C;return C;}};})();(function(){function B(I,J,H){var F=0,G=0,E=(H&&H.length)||0;if(!I||!H){return F;}for(;G<E;G++){F+=H[G][J]();}return F;}function D(E,F){if(F===undefined||isNaN(F)){return E;}return(E&&[E[F-1]]);}mstrmojo._CanMeasureChildren={height:function A(E){return B(this.domNode,"height",D(this.children,E));},width:function C(E){return B(this.domNode,"width",D(this.children,E));}};}());(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function A(N,M){if(N){M=M||{};for(var O in N){M[O]=N[O];}}return M;},copyProps:function C(P,Q,N){N=N||{};if(Q){for(var O=0,M=(P&&P.length)||0;O<M;O++){var R=P[O];if(R in Q){N[R]=Q[R];}}}return N;},forEach:function F(P,O,N){if(P){for(var M in P){if(N){if(O.call(N,P[M],M,P)===false){break;}}else{if(O(P[M],M,P)===false){break;}}}}},walk:function J(Q,O){if(!O){O=mstrmojo.global;}var P=Q.split(".");if(P.length==1){return O[Q];}for(var N=0,M=P&&P.length||0;N<M;N++){O=O[P[N]];if(!O){break;}}return O;},isEmpty:function(N){if(!N){return true;}for(var M in N){if(N[M]!=null){return false;}}return true;},clear:function L(N){if(N){for(var M in N){delete N[M];}}return N;},any:function(N,O){if(N){for(var M in N){return O?M:N[M];}}return undefined;},clone:function B(Q){if(!Q){return null;}var S;if(Q.constructor===Array){S=Q.concat();var R=S[0];if(R&&typeof (R)==="object"){for(var P=0,M=S.length;P<M;P++){S[P]=this.clone(Q[P]);}}}else{S={};for(var O in Q){var N=Q[O];if(N&&typeof (N)=="object"){S[O]=this.clone(N);}else{S[O]=N;}}}return S;},cloneArray:function I(N){var O=[];for(var P=0,M=(N&&N.length)||0;P<M;P++){O[P]=this.clone(N[P]);}return O;},keyarray:function G(O,P){var M=[];if(O){for(var N in O){M.push(P?Number(N):N);}}return M;},valarray:function H(O){var M=[];if(O){for(var N in O){M.push(O[N]);}}return M;},equals:function K(S,R){var T=mstrmojo.hash,N=S&&R||(!S&&!R&&(S===R));if(N&&S){N=(S.constructor===R.constructor);if(N){if(S.constructor===Array){var Q=S.length;N=(Q===R.length);if(N&&Q){for(var O=0;O<Q;O++){N=N&&T.equals(S[O],R[O]);}}}else{if(typeof (S)==="object"){var U=T.keyarray(S),P=T.keyarray(R);N=U.length===P.length;if(N){for(var M in S){N=N&&(T.equals(S[M],R[M]));}}}else{N=(S===R);}}}}return N;},obj2array:function(Q){for(var R in Q){var P=Q[R];if(P&&typeof (P)=="object"){Q[R]=this.obj2array(P);}}if("isArray" in Q&&(Q.isArray===true)){var O=[];for(var N=0,M=Q.length;N<M;N++){O.push(Q[N]);}return O;}else{return Q;}},min:function D(P,Q,R){var M;if(P){for(var O in P){var N=Q?P[O]:O;if(R){N=Number(N);}if((M==null)||(N<M)){M=N;}}}return M;},make:function E(N,O,M){if(!N||!O){return null;}if(N.attachEventListener){return N;}if(O.makeObservable){N=O.makeObservable(N,M)||N;}else{this.copy(O.prototype,N);if(N.init){N=N.init(M)||N;}}return N;}});})();(function(){var F="#000000";mstrmojo.color=mstrmojo.provide("mstrmojo.color",{hexChars:"0123456789ABCDEF",toHex:function J(L){L=L||0;L=Math.max(Math.min(isNaN(L)?0:parseInt(L,10),255),0);return this.hexChars.charAt((L-L%16)/16)+this.hexChars.charAt(L%16);},toDec:function K(L){return this.hexChars.indexOf(L.toUpperCase());},rgbStr2rgb:function G(L){var M=[0,0,0];L=L.replace(/ /g,"");var N=L.indexOf("rgb");if(N>=0){L=L.substring(N+4,L.length-1);M=L.split(",");}return M;},rgbStr2hex:function B(L){if(L.indexOf("rgb")>=0){var M=this.rgbStr2rgb(L);return"#"+this.rgb2hex(M[0],M[1],M[2]);}return L;},rgb2hex:function C(N,M,L){return this.toHex(N)+this.toHex(M)+this.toHex(L);},rgb2hsv:function E(L,Q,U){var S=[L,Q,U];S.sort(function(Z,Y){return Z-Y;});var P,X,W=0;var O=S[0];var T=S[2];W=T/255;X=(T!=0)?(parseFloat(T)-parseFloat(O))/parseFloat(T):0;if(X==0){P=0;}else{var R=T-O;var M=(T-L)/R;var N=(T-Q)/R;var V=(T-U)/R;if(L==T){P=V-N;}else{if(Q==T){P=2+M-V;}else{P=4+N-M;}}P=P/6;if(P<0){P=P+1;}}return[Math.round(P*360),Math.round(X*100),Math.round(W*100)];},hex2rgb:function H(O){var M=(O.charAt(0)=="#")?O.substr(1):O;var L=M.length!==3;var N=[0,0,0];if(L){N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(1,1)));N[1]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(3,1)));N[2]=(this.toDec(M.substr(4,1))*16)+(this.toDec(M.substr(5,1)));}else{N[0]=(this.toDec(M.substr(0,1))*16)+(this.toDec(M.substr(0,1)));N[1]=(this.toDec(M.substr(1,1))*16)+(this.toDec(M.substr(1,1)));N[2]=(this.toDec(M.substr(2,1))*16)+(this.toDec(M.substr(2,1)));}return N;},hex2hsv:function(M){var L=this.hex2rgb(M);return this.rgb2hsv(L[0],L[1],L[2]);},hsv2rgb:function(S,Y,W){S=S/360;Y=Y/100;W=W/100;var L,T,V;if(Y==0){L=W*255;T=W*255;V=W*255;}else{var O=S*6;if(O==6){O=0;}var R=Math.floor(O);var N=W*(1-Y);var M=W*(1-Y*(O-R));var X=W*(1-Y*(1-(O-R)));var U,P,Q;switch(R){case 0:U=W;P=X;Q=N;break;case 1:U=M;P=W;Q=N;break;case 2:U=N;P=W;Q=X;break;case 3:U=N;P=M;Q=W;break;case 4:U=X;P=N;Q=W;break;default:U=W;P=N;Q=M;break;}L=U*255;T=P*255;V=Q*255;}return[Math.round(L),Math.round(T),Math.round(V)];},hsv2hex:function(O,N,L){var M=this.hsv2rgb(O,N,L);return this.rgb2hex(M[0],M[1],M[2]);},getContrastingColor:function A(N,L){var M=this.hex2rgb(N);return(((M[0]*299)+(M[1]*587)+(M[2]*114))/1000<125)?L[0]:L[1];},getHighlightColor:function D(S,Q){var L,R,T,U,V=this.hex2rgb(!Q?"#FFCE7F":"#EFE6D8"),P=parseInt(S[0],10),N=parseInt(S[1],10),X=parseInt(S[2],10),O=parseInt(V[0],10),M=parseInt(V[1],10),W=parseInt(V[2],10);L=(P*O)/255;R=(N*M)/255;T=(X*W)/255;U=P*0.3+N*0.59+X*0.11;if(U<85){L=L+(63*(85-U)/85);L=L>255?255:L;R=R+(63*(85-U)/85);R=R>255?255:R;T=T+(63*(85-U)/85);T=T>255?255:T;}return"#"+this.rgb2hex(Math.round(L),Math.round(R),Math.round(T));},get3DBorderColor:function I(N,Q){var M=parseInt(N[0],10)*0.3+parseInt(N[1],10)*0.59+parseInt(N[2],10)*0.11;var P=parseInt(N[0],10);var O=parseInt(N[1],10);var L=parseInt(N[2],10);switch(Q){case"light":if(M>150){P=P*0.9;O=O*0.9;L=L*0.9;}else{P=P*0.6+102;O=O*0.6+102;L=L*0.6+102;}break;case"dark":if(M>10){P=P*0.4;O=O*0.4;L=L*0.4;}else{P=P*0.8+30;O=O*0.8+30;L=L*0.8+30;}}return"#"+this.rgb2hex(Math.round(P),Math.round(O),Math.round(L));},encodeColor:function(L,M){if(M!=undefined&&(L==null||L.length==0||L=="undefined")){L=M;}if(L=="transparent"){return -1;}else{if(L==-2){return -2;}else{if(L.substring(0,1)=="#"){L=L.substring(1);}return parseInt(L.substring(4)+L.substring(2,4)+L.substring(0,2),16);}}},decodeColor:function(N){var L=parseInt(N,10);if(L==0){return F;}var M=16777216+(L&255)*65536+(L&65280)+(L&16711680)/65536;return"#"+M.toString(16).substring(1).toUpperCase();}});})();mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){function G(S,V,U){var W=this._layoutWidgets[V],Z=S.slot,X=W.f,Y=W.p,T=(X&&X[Z]!==undefined),R=(Y&&Y[Z]!==undefined);if(Z&&((!U&&T)||R)){return T?X[Z]:(W.x*parseInt(Y[Z],10)/100)+"px";}return S[(V==="h")?"height":"width"];}function Q(T,S,R){if(T.ignoreLayout){return ;}if(T.setDimensions){T.setDimensions(S,R);}else{if(T.set){T.set("height",S);T.set("width",R);}}}function I(U){var S=this.children,W,Y;for(W=0,Y=(S&&S.length)||0;W<Y;W++){var T=S[W],Z=T.slot;if(Z){var X=G.call(this,T,"h",U),a=G.call(this,T,"w",U);this.setSlotDimensions(Z,X,a);Q(T,X,a);var R=G.call(this,T,"h",U),V=G.call(this,T,"w",U);if(R!==X||V!==a){Q(T,R,V);}this.setSlotDimensions(Z,R,V);}}this.afterLayout();}function F(X,T,V){var W=X.slot,U=T&&T.a;if(!U||U[W]===undefined){return ;}var R=this[W]["offset"+V],S=U[W];if(R===S){return ;}T.x-=(R-S);U[W]=R;}function N(R){this.beforeLayout();var S=this._layoutWidgets,T=R.src;F.call(this,T,S.h,"Height");F.call(this,T,S.w,"Width");I.call(this,true);}function E(T,W){if(!T){return null;}var R=this.children,g=W.toLowerCase(),X=parseInt(this[g],10),a,b,V,S,Y,Z,U,h,f;for(f in T){h=T[f];if(h.match(/px$/)){X-=parseInt(h,10);a=a||{};a[f]=h;}else{if(h.match(/\%$/)){b=b||{};b[f]=h;}else{V=V||{};V[f]=h;}}}if(V&&b){for(Y=0,Z=(R&&R.length)||0;Y<Z;Y++){U=R[Y];f=U.slot;if(U.slot&&V[f]&&!U.ignoreLayout){S=S||{};if(U.hasRendered){S[f]=this[U.slot]["offset"+W];X-=S[f];}else{S[f]=0;U.attachEventListener((U instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,N);}}}}return{f:a,p:b,a:S,x:X};}mstrmojo._HasLayout={_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function O(R){this._super(R);this.layoutConfig=mstrmojo.hash.clone(this.layoutConfig);},preBuildRendering:function M(){var T=this.cssText||"";var R=this.height;if(R&&R!=="auto"){T+="height:"+this.height+";";}var S=this.width;if(S&&S!=="auto"){T+="width:"+this.width+";";}this.cssText=T;return(this._super)?this._super():true;},postBuildRendering:function B(){this.doLayout();return this._super();},doLayout:function A(){var R=this.layoutConfig;if(!R){return ;}this.beforeLayout();this._layoutWidgets={h:E.call(this,R.h,"Height"),w:E.call(this,R.w,"Width")};I.call(this,false);},browserResized:function L(R){this.setDimensions(R.h,R.w);return true;},onwidthChange:function P(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.width=this.width;this.doLayout();},onheightChange:function D(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.height=this.height;this.doLayout();},adjustParentDimensions:function C(){var S=this.parent,R=S&&S._layoutWidgets;if(R){F.call(S,this,R.h,"Height");F.call(S,this,R.w,"Width");}},setDimensions:function K(T,S){if(this.height!==T||this.width!==S){this.height=T;this.width=S;var R=this.domNode;if(R){R.style.height=T;R.style.width=S;this.doLayout();}return true;}return false;},setSlotDimensions:function H(U,T,S){var R=this[U]&&this[U].style;if(!R){return ;}if(T!==undefined&&R.height!==T){R.height=T;}if(S!==undefined&&R.width!==S){R.width=S;}}};mstrmojo._HasLayout.getSlotSize=function J(U,V){var S=U&&U.prototype.layoutConfig;if(S){var T=S.h,R=S.w;return{h:(T&&T[V])||undefined,w:(R&&R[V])||undefined};}return null;};}());(function(){mstrmojo._HasDrillLinks=mstrmojo.provide("mstrmojo._HasDrillLinks",{_mixinName:"mstrmojo._HasDrillLinks",update:function A(E){this._super(E);var B=E.defn.dl,F=E.data.dl,D=this.drillLinkItems=((B&&B.items)||[]).concat((F&&F.items)||[]).sort(function(H,G){return H.index-G.index;}),C;for(C=D.length-1;C>=0;C--){if(C&&D[C].index===D[C-1].index){D.splice(C,1);}}if(B&&B.target){for(C=0;C<D.length;C++){D[C].target=B.target;}}}});}());(function(){mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function C(D){if(!D||!D.length){return function(){};}return function(){for(var F=0,E=D.length;F<E;F++){D[F].apply(this,arguments);}};},wrapMethods:function B(E,D){D=D||{};mstrmojo.hash.forEach(E,function(F,G){D[G]=(G in D&&typeof (F)=="function")?mstrmojo.func.composite([F,D[G]]):F;});return D;},addMethods:function A(E,D){D=D||{};mstrmojo.hash.forEach(E,function(F,G){if(!(G in D)&&typeof (F)=="function"){D[G]=F;}});return D;}});})();(function(){mstrmojo.FlexHelper=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.FlexHelper",getWidget:function C(D){var E=D.split("x");return mstrApp.docModel.getUnitInstance(E[0],E[1]);},getZoomFactor:function A(){return mstrApp.docModel.zf*100;}});var B=new mstrmojo.FlexHelper();window.getFlexHelper=function(){return B;};})();(function(){function L(N,T,S,P,R,O,Q){if(T>O){return false;}return(!Q)||(N===0)||((N<P)&&(T>=R-(O-R)));}function H(Q,N,U,T,P,S,O,R){if(U>O){return false;}return(!R)||((N<P)&&(U>=S-Q.height()));}function F(N,P,O){N.renderMode="scroll";N.render();N.numChildrenRendered=0;P.numChildrenRendered++;if(O&&!N.builtChildren){N.buildChildren();}}function E(){return this.useScrollBuffer?this.scrollBuffer:0;}mstrmojo._CanRenderDocOnScroll=mstrmojo.provide("mstrmojo._CanRenderDocOnScroll",{_mixinName:"mstrmojo._CanRenderDocOnScroll",renderMode:"scroll",scrollBuffer:0,postBuildRendering:function B(){if(this.renderMode===null){return this._super();}else{this.renderChildren();return true;}},childRenderOnAddCheck:function(N){if(this.renderMode===null){return this._super(N);}else{return false;}},renderChildren:function M(){var O;if(this.renderMode==="scroll"){var P=this;while(P){if(P.scrollboxNode&&(P.scrollboxWidthFixed||P.scrollboxHeightFixed)&&P.connectScrollbox){O=P;break;}P=P.parent;}}if((this.renderMode!=="scroll")||!O){this._super();return ;}if(this.containerNode){this.scrollboxOwner=O;O.connectScrollbox(this);this.numChildrenRendered=0;var N=this.numChildren;if(N===undefined){this.numChildren=N=this._getModelChildNodes(this.node,false,0,0,true).total;}this.sectionsToRender=N;this.subsectionsToRender=0;if(N){this._startSubsectionThread(false);}}if(this.resizeOrReposition){this.resizeOrReposition();}},onscroll:function J(){if(!this.renderingSubsections){this.useScrollBuffer=true;this._startSubsectionThread(true);}},_startSubsectionThread:function A(Q){var O=this;var P=function(S,R){if(O[S]){if(R){self.clearTimeout(O[S]);}else{self.clearInterval(O[S]);}delete O[S];}};var N=function(S){O.renderingSubsections=false;var R=function(){P("renderCtlsTimer");O.showRenderStatus(false);O.renderCtrlsInViewport();O.raiseEvent({name:"afterScroll"});O=null;};if(S){O.renderCtlsTimer=self.setTimeout(R,O.scrollboxOwner.scrollInterval+1);}else{R();}};P("renderSubsTimer");P("renderCtlsTimer",true);this.renderingSubsections=true;if((this.sectionsToRender||this.subsectionsToRender)&&!this._renderSubsectionsToScroll()){this.showRenderStatus(true);this.renderSubsTimer=self.setInterval(function(){if(O._renderSubsectionsToScroll()){P("renderSubsTimer");N(Q);}else{O.showRenderStatus(true);}},this.scrollboxOwner.scrollInterval);}else{N(Q);}},showRenderStatus:function G(O,T){var S=this.parent;if(!S||!S.showStatus){return ;}var N=T,P;if(O){var Q=this.numChildrenRendered,R=this.numChildren;P=R&&parseInt(100*Q/R,10);N="*Rendering section "+Q+" of "+R+".*";}S.showStatus(O,N,P);},_renderSubsectionsToScroll:function K(){var Y=this.scrollboxOwner,Z=Y.scrollboxTop,Q=Y.scrollboxLeft,T=Y.scrollboxBottom+E.call(this),n=Y.scrollboxRight,a=T-Z,W=0,V=0,U=null,b=null,X,j;function o(){U=V;b=U+a;}var N=this.numChildren,S=this.children||[],P=this.model,h=this.node,g=false;for(j=0;j<N;j++){var l=S[j];if(!l){l=this.addChildren(this.builder.build(this._getModelChildNodes(h,false,j,1,true).nodes,P))[0];S=this.children||[];}var O=g;g=!!l.defn.horiz;X=(j>0&&l.node.data.bh);if((!g&&O)||(X&&O)){W=0;V+=S[j-1].height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}if(!l.hasRendered){if(!L(W,V,Q,n,Z,T,g)){if(g){continue;}else{return true;}}this._renderSection(l,j);this.sectionsToRender--;this.subsectionsToRender+=(l.children&&l.children.length)||0;if(U===null){o();}}var R=l.children||[],i=null,f,k;for(f=0,k=R.length;f<k;f++){i=R[f];if(!i.hasRendered){if(!H(i,W,V,Q,n,Z,T,g)){if(g){break;}else{return true;}}F(i,l);this.subsectionsToRender--;if(U===null){o();}}if(g){W+=i.width();if(W>n){break;}}else{V+=i.height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}}}return true;},_renderSection:function I(N,O){F(N,this,true);},_getModelChildNodes:function(P,O,R,N,Q){return this.model.getChildren(P,O,R,N,Q);},renderCtrlsInViewport:function D(){var W=this.scrollboxOwner,Y=W.scrollboxTop,O=W.scrollboxLeft,R=W.scrollboxBottom+E.call(this),p=W.scrollboxRight,T=0,S=0,f=false,Q=this.children||[],N,U,j,X;var b=function(i){if(f){T+=i.width();}else{S+=i.height();}};var n=function(x,i,w,z,t){i=parseInt(i,10)||0;w=parseInt(w,10);return(isNaN(w))?(x+i<=t):mstrmojo.boxmodel.rangeIntersect(x+i,x+i+w,z,t);};for(j=0,X=(Q&&Q.length)||0;j<X;j++){var q=Q[j];N=f;f=!!q.defn.horiz;U=(j>0&&q.node.data.bh);if((!f&&N)||(U&&N)){T=0;S+=Q[j-1].height();if(S>R){return ;}}if(!q.hasRendered){if(!f){return ;}else{continue;}}var l=q.children,P=(l&&l.length)||0,a,h;for(a=0;a<P;a++){h=l[a];if(!h.hasRendered){break;}if(h.builtChildren&&(h.numChildrenRendered===((h.children&&h.children.length)||0))){b(h);}else{if((S+h.height()>=Y)&&(!f||(T+h.width()>=O))){var s=h.children,Z=(s&&s.length)||0;if(!Z&&!h.builtChildren){h.buildChildren();s=h.children;Z=(s&&s.length)||0;}var g=[],k;for(k=0;k<Z;k++){var o=s[k];if(o.hasRendered){continue;}var V=o.getFormats()||{};if(n(S,V.top,V.height,Y,R)&&n(T,V.left,V.width,O,p)){o.render();g.push(o);}}h.performCanGrowCanShrink(g,true);}b(h);}if((f&&T>p)||(!f&&S>R)){break;}}}},unrender:function C(O){var N=this.scrollboxOwner;if(N){N.disconnectScrollbox(this);}this._super(O);}});}());(function(){mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,tooltipNode:null,postBuildRendering:function(){var B;if(this._super){B=this._super();}if(this.useRichTooltip){var D=this.tooltipNode||this.domNode,C=mstrmojo.dom,A=D&&D.getAttribute("title");if(A){D.setAttribute("title","");}if(!this._ontooltipover){var E=this.id;this._ontooltipover=function(G){var F=mstrmojo.all[E];F.showTooltip(G,self);};this._ontooltipout=function(G){var F=mstrmojo.all[E];F.hideTooltip(G,self);};}C.attachEvent(D,"mouseover",this._ontooltipover);C.attachEvent(D,"mouseout",this._ontooltipout);}return B;},showTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.open(this,B,A);},hideTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.close();},unrender:function(A){var C=this.tooltipNode||this.domNode,B=mstrmojo.dom;if(C&&this._ontooltipover){B.detachEvent(C,"mouseover",this._ontooltipover);}if(C&&this._ontooltipout){B.detachEvent(C,"mouseout",this._ontooltipout);}if(this._super){this._super(A);}}});})();mstrmojo.DynamicClassFactory={newComponent:function(B,A,F){var C=B.prototype.scriptClass.replace(/^mstrmojo./,"");for(var E=0,D=A&&A.length||0;E<D;E++){if(!A[E]._mixinName){alert("Need mixin have '_mixinName' to be used in DynamicClassFactory");return null;}C+="_"+A[E]._mixinName.replace(/^mstrmojo./,"");}var G=mstrmojo[C];if(!G){G=mstrmojo.declare(B,A,F);mstrmojo[C]=G;}return G;}};(function(){var B="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var D=String.fromCharCode;function A(F){F=F.replace(/\r\n/g,"\n");var E="";for(var H=0;H<F.length;H++){var G=F.charCodeAt(H);if(G<128){E+=D(G);}else{if((G>127)&&(G<2048)){E+=D((G>>6)|192);E+=D((G&63)|128);}else{E+=D((G>>12)|224);E+=D(((G>>6)&63)|128);E+=D((G&63)|128);}}}return E;}function C(E){var F="",H=0,J=0,I=0,G=0;while(H<E.length){J=E.charCodeAt(H);if(J<128){F+=D(J);H++;}else{if((J>191)&&(J<224)){I=E.charCodeAt(H+1);F+=D(((J&31)<<6)|(I&63));H+=2;}else{I=E.charCodeAt(H+1);G=E.charCodeAt(H+2);F+=D(((J&15)<<12)|((I&63)<<6)|(G&63));H+=3;}}}return F;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function(H){var F=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(H&&H.indexOf("=?UTF-8?B?")===0){var G="",E;while((E=F.exec(H))!==null){G+=mstrmojo.base64.decode(E[1]);}return G;}return H;},encode:function(G){var E="";var N,L,J,M,K,I,H;var F=0;G=A(G);while(F<G.length){N=G.charCodeAt(F++);L=G.charCodeAt(F++);J=G.charCodeAt(F++);M=N>>2;K=((N&3)<<4)|(L>>4);I=((L&15)<<2)|(J>>6);H=J&63;if(isNaN(L)){I=H=64;}else{if(isNaN(J)){H=64;}}E+=B.charAt(M)+B.charAt(K)+B.charAt(I)+B.charAt(H);}return E;},decode:function(G){var E="",F=0;var N,L,J,M,K,I,H;G=G.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(F<G.length){M=B.indexOf(G.charAt(F++));K=B.indexOf(G.charAt(F++));I=B.indexOf(G.charAt(F++));H=B.indexOf(G.charAt(F++));N=(M<<2)|(K>>4);L=((K&15)<<4)|(I>>2);J=((I&3)<<6)|H;E+=D(N);if(I!=64){E+=D(L);}if(H!=64){E+=D(J);}}E=C(E);return E;}});})();(function(){mstrmojo._IsPopup={visible:false,opener:null,onOpen:null,onClose:null,open:function B(E,D){if(this.updatePopupConfig){this.updatePopupConfig(D,E);}else{if(D){for(var C in D){this.set(C,D[C]);}}}this.set("opener",E);if(!this.hasRendered){this.render();}if(this.nudge){this.domNode.style.top="-10000px";}this.set("visible",true);if(this.nudge){this.nudge();}if(this.onOpen){this.onOpen();}},close:function A(C){if(this.onClose){this.onClose(C);}this.set("visible",false);this.set("opener",null);}};})();(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}else{if(D.visible){return this._super(D);}else{var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;}}},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});})();(function(){mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function K(R,T){var S=0,Q=(R&&R.length)||0;for(;S<Q;S++){if(R[S]==T){return S;}}return -1;},indexOfMulti:function N(U,X){if(!X){return{indices:null,map:{},count:0};}var V=X.length,W=new Array(V),Q={},Y=0;for(var T=0,S=(U&&U.length)||0;T<S;T++){var Z=U[T];for(var R=0;R<V;R++){if(X[R]===Z){W[R]=T;Q[R]=T;Y++;break;}}}return{indices:W,map:Q,count:Y};},forEach:function G(R,U,T){for(var S=0,Q=(R&&R.length)||0;S<Q;S++){if(T){if(U.call(T,R[S],S,R)===false){break;}}else{if(U(R[S],S,R)===false){break;}}}},filter:function B(S,V,T){var R=[],W=0;for(var U=0,Q=S&&S.length||0;U<Q;U++){if(V(S[U])){R[W]=S[U];W++;if(T&&T.max&&(W>=T.max)){break;}}}return R;},find:function H(R,V,S){for(var T=0,Q=R&&R.length||0;T<Q;T++){var U=R[T];if(U&&U[V]==S){return T;}}return -1;},findBin:function E(S,W,X,R){var V=R?R:S.length,T=-1,Q,U=W[X];while(V-T>1){if(S[Q=V+T>>1][X]<U){T=Q;}else{V=Q;}}return S[V][X]===U?V:-1;},search:function P(X,T,V){var U=X.length,S=-1,R,W=T.toUpperCase(),Q=T.length;while(U-S>1){if(X[R=U+S>>1][V].substr(0,Q).toUpperCase()<W){S=R;}else{U=R;}}return U;},findMulti:function N(V,R,Y){if(!Y){return{indices:null,map:{},count:0};}var W=Y.length,X=[],Q={},Z=0;for(var U=0,T=(V&&V.length)||0;U<T;U++){var b=V[U][R];for(var S=0;S<W;S++){if(Y[S][R]===b){X[S]=U;Q[S]=U;Z++;break;}}}return{indices:X,map:Q,count:Z};},removeItem:function I(Q,S){var R=this.indexOf(Q,S);if(R>-1){this.removeIndices(Q,R,1);}return R;},removeItems:function C(Q,V,R){var T=this.findMulti(Q,V,R);if(T.count){var S=T.indices.concat().sort(this.numSorter).slice(0,T.count);for(var U=S.length-1;U>-1;U--){Q.splice(S[U],1);}}},numSorter:function J(R,Q){return Number(R)-Number(Q);},stringSorter:function O(S,R){var Q=S.toLowerCase();var T=R.toLowerCase();if(Q<T){return -1;}else{if(Q>T){return 1;}else{return 0;}}},removeIndices:function M(Q,S,R){Q.splice(S,R);},insert:function F(R,Q,S){if(!R){R=[];}if(Q==null){Q=R.length;}Array.prototype.splice.apply(R,[Q,0].concat(S));return R;},hash:function L(R){var T={};for(var S=0,Q=(R&&R.length)||0;S<Q;S++){T[R[S]]=true;}return T;},get:function A(R,T){if(!T){return null;}var S=[];for(var U=0,Q=T.length;U<Q;U++){S[U]=R[T[U]];}return S;},deepSortArr:function D(R,T,Q,S){return R.sort(function(V,U){return(!S?(V[Q][T]<=U[Q][T]):(V[Q][T]>U[Q][T]))?-1:1;});}});})();mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function shwSts(C,B,D){var E=this._STATUS;if(!this.hasRendered||!E){return ;}if(!C){if(this.showingStatus){E.style.display="none";}}else{if(E){var A=this._STATUS_TXT&&(this._STATUS_TXT.innerHTML=B||"");A=this._STATUS_BAR&&(this._STATUS_BAR.style.width=(D||0)+"%");if(!this.isStatusBarPositioned){E.style.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.style.display="block";}}}this.showingStatus=C;},updateStatus:function updSts(A,B){this.showStatus(this.showingStatus,A,B);}});(function(){var L=/\{\@([^\}]+)\}/gm,H=/\</gm,P=/\>/gm,D=/\S/,O=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],E=new RegExp("(\\"+O.join("|\\")+")","g"),Q={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'};var J=function(S){if(S==null){return"null";}var T=typeof (S);if(T!="object"){return T;}else{if(S.length===undefined){return"object";}else{return"array";}}};var R={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function F(T,V){if(!T){return"";}var U=[];for(var S in V){U.push(S.k||S);}return T.replace(new RegExp(U.join("|"),"g"),function(W){var X=V[W];return X.v||X;});},trim:function N(S){return(S&&S.replace)?S.replace(/^\s+/,"").replace(/\s+$/,""):S;},ellipsize:function A(U,T){var S=this.trim(U.substr(0,(T||1)-1));if(S!==U){S+="&hellip;";}return S;},isEmpty:function I(S){return(S==null)||!(D.test(S));},regEscape:function M(S){return S.replace(E,"\\$1");},encodeXMLAttribute:function(S){return mstrmojo.string.multiReplace(S,Q);},encodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,C);},decodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,K);},htmlAngles:function(S){S=String(S);if(S!=null){return S.replace(H,"&lt;").replace(P,"&gt;");}return S;},apply:function G(S,T){if(!S){return"";}return S.replace(L,function U(V,W){return(W in T&&T[W]!==null)?T[W]:"";});},json2xml:function(h,b,V){if(!(b instanceof Array)){b=[b];}var T=V&&V.isSerializable,Z=(V.convertBoolean===false)?false:true;var f=[],S=[],U,j,o;for(var Y=0,k=b.length;Y<k;Y++){var l=b[Y];for(U in l){if(T){var a=T(U,b,Y);if(a!==true){if(a===false){continue;}else{if(a.att){f.push(a.att);}if(a.child){S.push(a.child);}continue;}}}j=l[U];o=J(j);switch(o){case"array":S.push("<"+U+">");for(var W=0,X=j.length;W<X;W++){var g=V.getArrItemName(U,j,W)||W;S.push(this.json2xml(g,j[W],V));}S.push("</"+U+">");break;case"object":S.push(this.json2xml(U,j,V));break;case"string":f.push(U+'="'+mstrmojo.string.encodeXMLAttribute(j)+'"');break;case"boolean":f.push(U+'="'+((Z)?(j?"-1":"0"):j)+'"');break;case"null":if(!V.skipNull){f.push(U+'="'+V.nullValue+'"');}break;default:f.push(U+'="'+j+'"');break;}}}return"<"+h+" "+f.join(" ")+">"+S.join("")+"</"+h+">";},escape4HTMLText:function B(Z){if(!Z||!Z.replace){return Z;}var W=/\"/gm;var U="&quot;";var a=/\&/gm;var Y="&amp;";var X=/\</gm;var S="&lt;";var V=/\>/gm;var T="&gt;";return Z.replace(a,Y).replace(W,U).replace(X,S).replace(V,T);},parseUri:function(W,T){T=T||R;var S=T.parser[((T.strictMode)?"strict":"loose")].exec(W),V={},U=14;while(U--){V[T.key[U]]=S[U]||"";}V[T.q.name]={};V[T.key[12]].replace(T.q.parser,function(Y,X,Z){if(X){V[T.q.name][X]=Z;}});return V;}});})();(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};})();(function(){mstrmojo.all={};var _A=mstrmojo.all;var _freeIdCounter=0;function _freeId(){for(;_freeIdCounter++;){if(!_A["mstr"+_freeIdCounter]){break;}}return"mstr"+_freeIdCounter;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function add(obj){if(!obj){return ;}var id=obj.id;if(id==null){id=_freeId();obj.id=id;}else{if(_A[id]){throw new Error("Tried to register 2 objects with same id: "+id);}}_A[id]=obj;},remove:function rmv(obj){if(obj&&obj.id!=null){delete _A[obj.id];}},dumpAll:function(){for(var o in _A){if(_A[o].id!=null){mstrmojo.dbg(_A[o].id+"("+(_A[o].scriptClass||"[unknown class]")+")");}}},ref:function ref(config,flags){if(!config){return null;}if(!flags){flags={};}var C=config;while(C){switch(typeof (C)){case"string":if(flags.skipLoadChecks!==true){mstrmojo.requiresCls(config);}C=eval(C);break;case"function":return(flags.dontInst!==true)?new C():C;case"object":if(C.constructor===Object){var sc=C.scriptClass;if(sc){if(flags.skipLoadChecks!==true){mstrmojo.requiresCls(sc);}var cls=eval(sc);if(cls){return new cls((flags.clone===true)?mstrmojo.hash.clone(C):C);}return null;}else{return C;}}else{return C;}break;default:return null;}}}});mstrmojo.insert=mstrmojo.registry.ref;})();mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){mstrmojo.boxmodel={rangeIntersect:function C(H,F,G,E){if(H<G){return G<=F;}else{if(H>G){return H<=E;}else{return true;}}},px2Inches:function A(F,E){E=parseInt(E,10);return parseFloat((E/F.zf/F.dpi).toFixed(4),10);},offset:function D(G,F){var I=G,E=0,H=0;while(G){E+=G.offsetLeft;H+=G.offsetTop;G=G.offsetParent;if(G===F){break;}}for(e=I&&I.parentNode;e&&e!=F;e=e.parentNode){if(e.scrollTop){H-=e.scrollTop;}if(e.scrollLeft){E-=e.scrollLeft;}}return{left:E,top:H};},convert2px:function B(H,F){if(!/px$/.test(F)){var E=document.createElement("img"),G;E.style.zIndex=-1;E.style.left=F;H.appendChild(E);G=E.style.pixelLeft;H.removeChild(E);return G+"px";}else{return F;}}};})();(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var B=false,D="mstrmojo.Binding",A="bindings",C=mstrmojo.registry;function E(K){for(var L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function F(K,M){if(!B){mstrmojo.requiresCls(D);B=true;}for(var N in K){var J=K[N];if(J==null){continue;}var L=typeof (J);if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=C.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function G(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[A]);if(K){delete this[A];this._set_bindings(A,K,true);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children;if(M){for(var L=0,J=M.length;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function I(){var J=this.bindings;if(J){E(J);delete this.bindings;}},_set_bindings:function H(L,J){var K=this[A];if(J!==K){if(K){E(K);}this[A]=J;if(J){F(J,this);}return true;}return false;}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasDrillLinks","mstrmojo.registry","mstrmojo.hash","mstrmojo.dom");var B=mstrmojo.dom;function D(F){var E=F;while(E){if(E.openDrillLinkMenu){return E;}E=E.parent;}return null;}mstrmojo._HasHoverButton=mstrmojo.provide("mstrmojo._HasHoverButton",mstrmojo.hash.copy(mstrmojo._HasDrillLinks,{_mixinName:"mstrmojo._HasHoverButton",buttonNodeMarkup:'<div class="mstrmojo-LinkInfo-buttonNode"></div>',init:function C(E){this._super(E);this.markupSlots.buttonNode=function(){return this.domNode.lastChild;};},postBuildRendering:function A(){if(!this.hoverBtn){this.addChildren(mstrmojo.registry.ref({scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"hoverBtn",onclick:function H(){this.openPopup();},openPopup:function E(){var J=D(this);if(J){J.openDrillLinkMenu({openerButton:this,drillLinkItems:this.parent.drillLinkItems,cmPos:this.cmPos});}},closePopup:function F(){var J=D(this);if(J){J.closeDrillLinkMenu();}}}));}var G=this._super();var I=this.id;B.attachEvent(this.domNode,"contextmenu",function(J){mstrmojo.all[I].oncontextmenu(J,self);});return G;},oncontextmenu:function(G,E){var F=this.hoverBtn;F.cmPos=B.getMousePosition(G,E);F.openPopup();F.cmPos=null;B.preventDefault(E,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer");var Q=mstrmojo.dom,O=mstrmojo.hash,T=mstrmojo.array;function U(){O.forEach(this.ifwMap,function(X){X.destroy();});this.ifwMap={};}function A(){var X=[],Z=null,Y=null;O.forEach(this.ifwMap,function(a){if(a.visible){X.push({psId:a.psId,psKey:a.psKey,anchorPos:a.anchorPosition||Q.position(a.anchor,true),anchorOrn:a.anchorOrientation});}});if(X.length>0){Z=this.getSelectedLayoutWidget();Y=Z&&Z.getScrollPos();}return{ifwRecords:X,docScrollRecord:Y};}function L(b){var X=(b&&b.ifwRecords)||[],Y=b&&b.docScrollRecord,Z=this.getSelectedLayoutWidget(),a=this,f={};if(X.length>0){if(Y&&Z){Z.scrollTo(Y);}T.forEach(X,function(g){a.showInfoWindow(g.psId,g.psKey,f,null,g.anchorOrn,g.anchorPos);});}}function I(){mstrmojo.DICPopup&&mstrmojo.DICPopup.cancel&&mstrmojo.DICPopup.cancel();}function N(){if(this.xtabStyleSheets){var Z,Y,X;for(Y=0;Z=this.xtabStyleSheets[Y];Y++){X=Z.parentNode;if(X){X.removeChild(Z);}}}}function W(Y,b){var Z=this.getLayout(Y),X=Z.docGroupBy,a=this.controller;if(X){X.set("data",b.groupbys);Z.gb=b;}if(a.getPageByTree){a.getPageByTree(true);}}mstrmojo._IsRwDocument={_mixinName:"mstrmojo._IsRwDocument",updateXtabStyles:function K(g,Z){var n=this.xtabStyleSheets&&this.xtabStyleSheets[0],l=this.styleList||{},Y=function(t,q){var s;for(s in q){var p=q[s].css||"";if(q[s].app){p=(t[s]||"")+p;}t[s]=p;}return t;},o=document;if(!l[g]){l[g]=Y({},this.model.getSelectedXtabStyles(g));}Y(l[g],Z);if(!n){this.xtabStyleSheets=[];n=this.xtabStyleSheets[0]=o.getElementsByTagName("head")[0].appendChild(o.createElement("style"));}var a=new mstrmojo.StringBuffer(),b,f;for(b in l){for(f in l[b]){a.append(l[b][f]);}a.append("\n");}a=a.toString();if(n&&a){n=n.styleSheet||n;if(Q.isWK){var k=n.firstChild;if(k){k.nodeValue=a;}else{n.appendChild(o.createTextNode(a));}}else{if(Q.isIE){n.cssText=a;var j,i,X,h;for(j=1;n.rules.length===4095&&o.styleSheets.length<31;j++){i=n.rules[4094];X=new RegExp(i.selectorText,"i");h=a.search(X);if(h===-1){break;}h=a.indexOf("}",h+1);a=a.slice(h+1);if(!this.xtabStyleSheets[j]){this.xtabStyleSheets[j]=o.getElementsByTagName("head")[0].appendChild(o.createElement("style"));}n=this.xtabStyleSheets[j].styleSheet;n.cssText=a;}}else{n.innerHTML=a;}}}this.styleList=l;},postBuildRendering:function S(){if(this.xtabStyleSheets){for(var Y,X=0;Y=this.xtabStyleSheets[X];X++){if(!Y.parentNode){document.getElementsByTagName("head")[0].appendChild(Y);}}}return this._super();},buildChildren:function B(b){var i;try{var f=this.model;if(f){var g=this.buildSubs||{},o=f.id+"-partialUpdate",Y=f.id+"-rebuildLayout",k=f.id+"-updateStyles",a=f.id+"-showInfoWin",Z=this.id;var j=this,n=function(){T.forEach(j.getLayouts(),function(p){if(p.k!==f.currlaykey){p.defn.loaded=false;}});};if(g[o]===undefined){var l=function X(AA){var s=this.model,q=s&&s.getLayoutDataCache(s.getCurrentLayoutKey()),p=AA&&AA.ids;if(O.isEmpty(q)||!p){return ;}T.forEach(AA.tree.layouts,function(AC){if(AC.k===s.currlaykey){this.updateXtabStyles(AC.k,AC.xtabStyles);if(AC.gbys){W.call(this,AC.k,AC.gbys);}return false;}},this);var w=O.forEach,AB=false,x={update:p.upd,refresh:p.tgts,adjustSectionSize:p.secs};w(p.ifws,function(AE,AD){var AC=mstrmojo.all[AE+"_ifw"];if(AC&&AC.visible){this.updateInfoWindowPS(AE,AD);}},this);w(x,function(AD,AC){w(AD,function(AF,AH){var AE=mstrmojo.all[AH],AG;if(AE&&AE[AC]!==undefined){AG=AE[AC](AC==="update"?q[AH]:null);if(AC==="adjustSectionSize"&&AG){AB=AB||(!!AG.heightReduced);}}},this);},this);var t=this.getSelectedLayoutWidget();if(AB){t.notifyScrollListeners();}var z=t.docLayout;if(z){z.resizeOrReposition();}if(AA&&AA.unloadCache){n();}};g[o]=f.attachEventListener("partialUpdate",Z,l);}g[Y]=g[Y]||f.attachEventListener("rebuildLayout",Z,function(p){var s=p&&p.restoreIW,q;if(s){q=A.call(this);this.model.aws=null;}this.onLayoutRebuilt(this.rebuildLayout(p.src.currlaykey,this.getLayouts()));if(p&&p.unloadCache){n();}if(s){L.call(this,q);}});g[k]=g[k]||f.attachEventListener("updateStyles",Z,function(p){this.updateXtabStyles(p.key,p.updatedStyles);});g[a]=g[a]||f.attachEventListener("showInfoWin",Z,function(p){this.showInfoWindow(p.psId,p.psKey,p.anchor,p.invalidate,p.anchorOrientation,p.anchorPosition);});this.updateXtabStyles(f.getCurrentLayoutKey());f.attachEventListener("refresh",this.id,function(){this.refresh();});}i=this._super(b);}catch(h){mstrmojo.err(h);}return i;},updateInfoWindowPS:mstrmojo.emptyFn,showInfoWindow:function H(Y,t,j,l,p,q){var a=this.model,g=a.getLayoutDataCache(a.getCurrentLayoutKey()),z=this.builder,X=g[Y]&&g[Y].defn,f=X&&X.iwpl,x=Y+"_ifw",AD=mstrmojo.all[x],AA=this.domNode,Z=mstrmojo.DocInfoWindow.PLACEMENT.FIXED,AB=function(AE,AF,AG,AI,AH){if(f===Z){if(AF){var AJ=Q.delta(AF,AA);AE.popPosition={left:(AJ&&AJ.x)?AI+AJ.x:AI,top:(AJ&&AJ.y)?AH+AJ.y:AH};}else{if(AG){AE.popPosition={left:(AG.scrollboxLeft)?AI-AG.scrollboxLeft:AI,top:(AG.scrollboxTop)?AH-AG.scrollboxTop:AH};}else{AE.popPosition={left:AI,top:AH};}}}};var o=this.getLayout(a.getCurrentLayoutKey());if(AD){if(l){AD.refresh();}AD.anchorOrientation=p;AD.anchorPosition=q;AB(AD,AD._ifwpdn,o,AD._ifwfl,AD._ifwft);AD.open(this,{anchor:j,boundary:AA});}else{var h={opener:this,anchor:j,anchorOrientation:p,boundary:AA,parent:this,builder:z,model:this.model,psKey:t,psId:Y,id:x,autoCloses:true,locksHover:true,closeOnClick:false,anchorPosition:q};if(f){f=parseInt(f,10);h.placement=f;if(f===Z){var i=X.fmts,b=h._ifwfl=i&&i.left&&parseInt(i.left.replace("px",""),10),w=h._ifwft=i&&i.top&&parseInt(i.top.replace("px",""),10),k=g[Y]&&g[Y].p,s=k&&a.getUnitInstance(k.k,k.wid),n=h._ifwpdn=s&&s.domNode;AB(h,n,o,b,w);}}AD=z.newInfoWindow(h);this.renderInfoWindow(AD);var AC=this.ifwMap=(this.ifwMap||{});AC[Y]=AD;}},renderInfoWindow:function J(X){X.render();},_lockInfoWinContainer:function G(Y){var b=this.ifwMap,X;for(X in b){var Z=b[X],a=Y.xtab;if(Z&&a&&Q.contains(Z.infoNode,a.domNode,true,document.body)){Z.autoCloseLocked=true;Y.onClose=function(){Z.autoCloseLocked=false;};break;}}},unrender:function R(X){U.call(this);this._super(X);N.call(this);},getLayouts:function M(){return this._layouts;},getLayout:function P(X){X=X||this.model.getCurrentLayoutKey();var Y=this.getLayouts();return Y[T.find(Y,"k",X)];},getNewLayout:function E(Y,g,X,j){var b=this,Z=b.model,f=Z.getDataService(),i=Y.layoutKey,a=g[T.find(g,"k",i)];if(a.defn&&(Y.reload||a.defn.loaded===false||(Z.zt&&(window.mstrMobileApp!==undefined)&&(a.defn.lastOrientation!==mstrMobileApp.getOrientation())))){var h=j.success;j.success=function(k){Z.replaceLayout(i,k);Z.currlaykey=i;if(X){a.zf=k.zf;b.selectLayout(a,false);}var l=b.rebuildLayout(i,g);if(b.controller.getPageByTree){b.controller.getPageByTree(true);}h(l);};f.loadDocLayout(Y,j);}else{j.success(a);if(X){this.selectLayout(a,true,{success:function(k){O.copyProps(["bs"],k,Z);}});}}},selectLayout:function D(a,b,f){var X=this.model,Y=a.k,Z=(Y!==X.currlaykey);X.currlaykey=Y;this.restoreLayoutState(a);if(b&&Z){X.getDataService().setCurrentDocLayout(Y,f);}else{if(f&&f.complete){f.complete();}}return a;},rebuildLayout:function C(Y,g){var a=this.model,Z=T.find,b=g[Z(g,"k",Y)],X=a.getChildren(this.node,false);var f=X[Z(X,"k",Y)];if(window.mstrMobileApp!==undefined){f.defn.lastOrientation=mstrMobileApp.getOrientation();}var h=this.replaceLayout(b,f);this.updateXtabStyles(Y,a.getSelectedXtabStyles(Y));U.call(this);I();return h;},destroy:function V(){U.call(this);if(this._super){this._super();}N.call(this);},replaceLayout:mstrmojo.emptyFn,restoreLayoutState:mstrmojo.emptyFn,onLayoutRebuilt:mstrmojo.emptyFn,unloadGbLayuts:function F(Z){var h=this.getLayouts(),b=this.model.getCurrentLayoutKey(),g,f,j,Y,a,X;g=this.getLayout();Y=g.gb&&g.gb.groupbys;for(a=0;a<Y.length;a++){j=Y[a];if(j.k===Z){X=j.unit.target.did;break;}}for(f=0;f<h.length;f++){g=h[f];if(g.k===b){continue;}Y=g.gb&&g.gb.groupbys;if(Y&&Y.length){for(a=0;a<Y.length;a++){j=Y[a];if(j.unit.target.did===X){g.defn.loaded=false;break;}}}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom");var M=mstrmojo.string,T=mstrmojo.dom;var N=mstrmojo.useFrames?null:document.createElement("span");var B=/\mstrAttach\:([\w\,]+)/g;var R;function O(X){if(R===undefined){R=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return X.replace(B,function W(f,h){var Z=h.split(","),a=[],Y=Z.length,b;for(b=0;b<Y;b++){var g=Z[b];if(g){if(R){if(g.indexOf("mouse")>-1){continue;}else{if(g==="click"){g="touchend";}}}a.push("on"+g+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+g+"', self, event)\"");}}return a.join(" ");});}var P="preBuildRendering",D="buildRendering",A="postBuildRendering";function E(Y){var X=Y.markupString;if(X.match(/mstrAttach:/)){X=O(X);if(Y.markupString===Y.constructor.prototype.markupString){Y.constructor.prototype.markupString=X;}}var W=M.apply(X,Y);if(W){if(mstrmojo.useFrames){var Z=(Y.domNode&&Y.domNode.ownerDocument)||self.document;if(!N||N.ownerDocument!==Z){N=Z.createElement("span");}}N.innerHTML=W;var a=N.firstChild;a.mstrmojoId=Y.id;return a;}return null;}function J(Y){var X=Y.markupSlots,W,Z;if(X){W={};for(Z in X){W[Z]=X[Z].apply(Y,[]);}}return W;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function G(){if((this[P]&&this[P]()===false)||(this[D]()===false)||(this[A]&&this[A]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var W="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,W)){this.raiseEvent({name:W});}return true;},buildDom:function S(){return E(this);},preBuildRendering:mstrmojo.emptyFn,buildRendering:function C(){var W=this.domNode,X=this.buildDom();this.domNode=X;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(J(this));this.paint();if(X){var a=W;if(!a){a=this.placeholder;if(a){if(typeof a==="string"){a=document.getElementById(a);}delete this.placeholder;}}if(a){T.replace(a,X);}}var Y="onchildRenderingChange",Z=this.parent;if(Z&&Z[Y]){Z[Y](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function Q(Y){if(this.hasRendered){if(!Y){try{var W=this.domNode;if(W.parentNode){W.parentNode.removeChild(W);}if(mstrmojo.dom.isIE&&W.outerHTML!=="undefined"){W.outerHTML="";}}catch(X){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function V(){var X=this.markupMethods;if(!X){return ;}var a=this,b=function(i){var g=X[i];if(g){try{g.apply(a,[true]);}catch(h){throw new Error(["Error in markup method.","Widget id: "+a.id,"Method name: "+i,"Err: "+h.message].join("\n\n"));}}};var Z=X.sequence,W,Y,f;if(Z){W=Z.length||0;for(Y=0;Y<W;Y++){b(Z[Y]);}}else{for(f in X){b(f);}}},refresh:function F(W){if(this.hasRendered){var X=this.domNode;this.unrender(true);this.placeholder=X;if(W){W();}this.render();}},set:function L(Z,W){this._super(Z,W);if(this.domNode){var X=this.markupMethods,Y=X&&X["on"+Z+"Change"];if(Y){Y.apply(this);}}return this;},slotNames:null,addSlots:function I(X){var W=this.slotNames,Y;if(!W){W={};this.slotNames=W;}for(Y in X){this[Y]=X[Y];W[Y]=true;}},removeSlots:function K(W){if(W){var X=this.slotNames,Y;for(Y in W){delete this[Y];if(X){delete X[Y];}}}},captureDomEvent:function H(Y,W,Z,X){if(this.enabled!==false){this.raiseEvent({name:Y,hWin:W,e:Z||W.event,config:X});}},playEffect:function U(X){var W=this[X];if(W&&W.constructor===Object){W=mstrmojo.insert(mstrmojo.hash.clone(W));W.widget=this;this[X]=W;}if(W){W.play();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var F=mstrmojo.dom,L=mstrmojo.string;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:F.isNSIE?"block":"table",DISPLAY_CELL:F.isNSIE?"block":"table-cell",MINHEIGHT:F.isIE6?"height":"minHeight",addClass:function H(V,U){if(!V){return ;}if(U.constructor!==Array){U=[U];}var R=V.className||"",X=" "+R+" ",S=false;for(var T=0,Q=U.length;T<Q;T++){var W=U[T];if(!X.match(new RegExp("\\s"+W+"\\s"))){R+=" "+W;S=true;}}if(S){V.className=L.trim(R);}},removeClass:function M(U,T){if(!U){return ;}if(T.constructor!==Array){T=[T];}var R=" "+(U.className||"")+" ";for(var S=0,Q=T.length;S<Q;S++){R=R.replace(new RegExp("\\s"+T[S]+"\\s","g")," ");}U.className=L.trim(R);},addWidgetCssClass:function G(T,R){var Q=T.cssClass,S=(Q&&Q.split(" "))||[];if(R.constructor!==Array){R=[R];}T.cssClass=S.concat(R).join(" ");},toggleClass:function N(S,R,Q){if(Q){this.addClass(S,R);}else{this.removeClass(S,R);}},applyShadow:function D(U,V,T,S,Q){var R=U.style;if(F.isDXIE){R.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+V+"px, OffY="+T+"px, Color='"+Q+"')";}else{if(F.isFF||F.isWK||F.isIE10){R[F.CSS3_BOXSHADOW]=V+"px "+T+"px "+S+"px "+Q;}}},removeShadow:function O(R){var Q=R.style;if(F.isDXIE){}else{if(F.isFF||F.isWK||F.isIE10){Q[F.CSS3_BOXSHADOW]="";}}},setOpacity:function A(R,T){if(F.isDXIE&&!F.isIE9){var U=R.currentStyle.filter;var Q=null;if(U.length>0){Q=R.filters["DXImageTransform.Microsoft.Alpha"];}if(Q){Q.opacity=T;Q.enabled=(T!=100);}else{if(T<100){var S="progid:DXImageTransform.Microsoft.Alpha(Opacity="+T+")";R.style.filter=(U?U:"")+" "+S;}}}else{R.style.opacity=T/100-(F.isIE9?0.00001:0);}},buildGradient:function C(R,T,Q){if(F.supports(F.cssFeatures.GRADIENTS)){var S={};if(F.isDXIE){S.n="filter";S.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+R+",StartColorStr='"+T+"',EndColorStr='"+Q+"')";}else{if(F.isFF){S.n="background-image";S.v="-moz-linear-gradient("+((R===0)?"top":"left")+","+T+","+Q+")";}else{if(F.isWK){S.n="background";S.v="-webkit-gradient(linear,"+((R===0)?"left top, left bottom":"left top, right top")+",from("+T+"),to("+Q+"))";}else{if(F.isIE10||F.isIEW3C){S.n="background";S.v="linear-gradient("+((R===0)?"to bottom":"to right")+","+T+","+Q+")";}}}}return S;}return null;},buildRoundCorners:function K(V,U){if(F.supports(F.cssFeatures.ROUND_CORNERS)){var R=V+"px";var X=R+((U)?" "+R+" 0 0":"")+";";if(F.isFF){return"-moz-border-radius:"+X;}else{if(F.isWinPhone||F.isIE10){return"border-radius:"+X;}else{if(F.isWK){if(!U){return"-webkit-border-radius:"+R+";";}else{var W=["left","right"],T=[],Q=-1;for(var S=0;S<2;S++){T[++Q]="-webkit-border-top-"+W[S]+"-radius:"+R;T[++Q]="-webkit-border-bottom-"+W[S]+"-radius:0";}return T.join(";");}}}}}return"";},getBorderWidthsOrPaddings:function E(R,U){var V={t:0,r:0,b:0,l:0,h:0,w:0};if(!R){return V;}var S=R.split(" "),Q=S.length;for(var T=0;T<Q;T++){S[T]=Math.round(U*parseFloat(S[T],10)/72);}if(Q<4){if(Q===1){S[1]=S[2]=S[3]=S[0];}else{S[3]=S[1];if(Q===2){S[2]=S[0];}}}V.t=S[0];V.r=S[1];V.b=S[2];V.l=S[3];V.h=V.t+V.b;V.w=V.l+V.r;return V;},getBorderWidths:function I(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},getPaddings:function J(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},parkAfterFade:function P(Q){var R=Q.target.style;if(R.opacity==0){R.left="-10000px";window.setTimeout(function(){R.opacity=0.99;},0);return true;}return false;},getStyleValue:function B(Q,S){if(Q.currentStyle){S=S=="float"?"styleFloat":S;value=Q.currentStyle[S];}else{if(document.defaultView&&document.defaultView.getComputedStyle){S=S=="float"?"cssFloat":S;var R=document.defaultView.getComputedStyle(Q,null);value=R?R[S]:null;}}return value;},getComputedStyle:function(Q,S){var R=(window.getComputedStyle)?function(T,U){return window.getComputedStyle(T,U||null);}:function(T){return T.currentStyle||{};};mstrmojo.css.getComputedStyle=R;return R(Q,S);}});})();(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",H="";var N=/\+/g;for(var I=0,F=M.length;I<F;I++){var E=M[I].split("=");L=E[0];H=E[1];if(H){H=decodeURIComponent(H.replace(N," "));}var G=document.createElement("INPUT");G.type="HIDDEN";G.name=L;G.value=H;K.appendChild(G);}return false;}mstrmojo.form={createDynamicForm:function A(E){var G=document.createElement("FORM"),H=E.indexOf("?")>0;G.name="dynamic_form";G.method="POST";var F=((H)?E.substring(0,E.indexOf("?")):E);G.action=F;if(H){B(G,E);}document.body.appendChild(G);return G;},send:function D(J,K,E,M,H,F){var O=((H&&H.hWin)||window).document,L=O.createElement("form"),I=mstrApp;L.method=E||"GET";if(M){L.target=M;}L.action=K||I.name;F=(F!==undefined)?F:!(L.action&&L.action.indexOf("aspx")>0);if(I.sessionId){L.action+=";jsessionid="+I.sessionId;}if(F){L.action+=";uxts"+mstrmojo.now();}L.appendChild(C(O,"xts",mstrmojo.now()));for(var P in I.persistTaskParams){J[P]=I.persistTaskParams[P];}if(I.servletState&&I.name){J[I.name]=I.servletState;}if(J){for(var G in J){if(J[G].constructor==Array){mstrmojo.array.forEach(J[G],function(Q){L.appendChild(C(O,G,Q));});}else{L.appendChild(C(O,G,J[G]));}}}O.body.appendChild(L);try{L.submit();}catch(N){if(M&&N.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}O.body.removeChild(L);}};})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.array");var C=mstrmojo.array;mstrmojo._BindTargetChildren={target:null,targetProps:null,addTabButtons:null,removeTabButtons:null,clearButtons:null,ontargetChange:function E(L){var M=L&&L.valueWas;if(M){var J=this._targetSubs;if(J){M.detachEventListener(J.add);M.detachEventListener(J.rem);M.detachEventListener(J.sel);}this.clearButtons();}var N=this.target;if(N){var I=this.targetProps,H=I&&I.children||"children",F=N[H];this.addTabButtons(F,0);this._onTargetSelChg();if(N.attachEventListener){var G=this.id,K="attachEventListener";this._targetSubs={add:N[K]("addChild",G,"_onTargetAddChild"),rem:N[K]("removeChild",G,"_onTargetRemoveChild"),sel:N[K]("selectedChange",G,"_onTargetSelChg")};}}if(this._ontargetChange){this._ontargetChange();}},_onTargetAddChild:function A(F){var G=F&&F.value;if(G&&G.length){this.addTabButtons(G,F.index);}if(this._postTargetAddChild){this._postTargetAddChild();}},_onTargetRemoveChild:function B(G){var F=G&&G.value;for(var H=((F&&F.length)||0)-1;H>-1;H--){this.removeTabButton(F[H]);}if(this._postTargetRemoveChild){this._postTargetRemoveChild();}},_onTargetSelChg:function D(L){var G=this.targetProps||{},F=this[G.names||"children"],J=function(O,P){if(O.set){O.set("selected",P);}else{O.selected=P;}};if(L){var H=L.valueWas,K=H?C.find(F,"target",H):-1;if(K>-1){J(F[K],false);}}var M=this.target,N=M&&M.selected,I=N?C.find(F,"target",N):-1;if(I>-1){J(F[I],true);}if(this._postTargetSelChg){this._postTargetSelChg();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,D=mstrmojo.hash;function C(X,V){if(!V){return ;}var Y=[],O=X.selectedIndices,N=X.allIdx,T=X.noneIdx,P=X.parent&&X.parent.include;if(X.multiSelect&&(T>-1)&&(G.indexOf(V,T)>-1)){return Y;}var R,S,W=X.items,U=X.itemIdField,Q=X.selectedItems,a;if(X.multiSelect&&(N>-1)&&(G.indexOf(V,X.allIdx)>-1)){for(R=0,S=W.length;R<S;R++){if(!O[R]){Y.push(R);O[R]=true;X.selectedIndex=R;X.selectedItem=W[R];}}}else{for(R=0,S=V.length;R<S;R++){var Z=V[R];if(!O[Z]){O[Z]=true;Y.push(Z);X.selectedIndex=Z;a=X.selectedItem=W[Z];if(Q){Q[a[U]]=a;}}}}return Y;}function A(P){var O=[],Q=P.selectedIndices,R=P.selectedItems;for(var N in Q){delete Q[N];O.push(parseInt(N,10));}P.selectedIndex=-1;P.selectedItem=null;if(R){P.selectedItems={};}return O;}function L(W,V){if(!V){return ;}var S=[],O=W.selectedIndices,Y=G.indexOf,N=W.allIdx,T=W.noneIdx,U=W.itemIdField,P=W.selectedItems;if(W.multiSelect&&(((N>-1)&&(Y(V,N)>-1))||((T>-1)&&(Y(V,T)>-1)))){return A(W);}if(V.length>0&&O[N]){if(Y(V,N)<0){V.push(N);}}for(var Q=0,R=V.length;Q<R;Q++){var X=V[Q];if(O[X]){delete O[X];S.push(X);if(P){delete P[W.items[X][U]];}if(W.selectedIndex==X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function F(Q,P,R,N){if(Q.raiseEvent){Q.raiseEvent({name:"select",idxs:N||[]});if((P&&P.length)||(R&&R.length)){try{Q.raiseEvent({name:"selectionChange",added:P,removed:R});}catch(O){L(Q,P);C(Q,R);throw O;}}}}function I(P,O){if(O==null){return -1;}var N=typeof (O)=="object",Q=P.itemIdField;if(N&&Q!=null){return G.find(P.items,Q,O[Q]);}else{return G.indexOf(P.items,O);}}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(N){this._super(N);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function M(W){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this.items,N=this.items.length,Q=this.selectedItems,S=[],P;U=this.items=U.concat(W);P=U.length;if(Q){var O=this.selectedIndices,T=this.itemIdField,R,V;for(R=N;R<U.length;R++){V=U[R];if(Q[V[T]]){S.push(R);}}}if(S&&S.length){C(this,S);}if(P>N){this.itemsContainerNode.innerHTML+=this._buildItemsMarkup(N,P-1).join("");}},addSelectedItems:function H(N){this.selectItems(N,false);},setSelectedItems:function K(N){this.selectItems(N,true);},selectItems:function J(W,Y){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this;if(Y&&U.selectedItems){U.selectedItems={};}var P=U.selectedItems,T=U.itemIdField,X,V,Q,N=[],S=U.items.length,R=[],O=U.allowUnlistedValues;for(Q=0;Q<W.length;Q++){X=W[Q];V=I(this,X);if(V===-1){if(P===null){if(O){N.push(v);V=S++;}}else{P[X[T]]=X;}}if(V!==-1){R.push(V);}}if(N.length>0){U.addItems(N);}if(R.length>0){if(Y){U.select(R);}else{U.addSelect(R);}}},unselectItems:function J(O){if(!O){return ;}if(O.constructor!=Array){O=[O];}var S=this,U=S.selectedItems,P=[],T=S.itemIdField,R,N,Q;if(U===null){return ;}for(Q=0;Q<O.length;Q++){R=O[Q];if(U){delete U[R[T]];}N=I(this,R);if(N!==-1){P.push(N);}}if(P.length>0){S.removeSelect(P);}},getSelectedItems:function B(){if(this.selectedItems!=null){return D.valarray(this.selectedItems);}else{return G.get(this.items,D.keyarray(this.selectedIndices,true));}},singleSelect:function(N,O){if(N!==-1){this.select([N],O);}},singleSelectByField:function E(O,P,N){this.singleSelect(G.find(this.items,P,O),N);},toggleSelect:function(N){var P,O;if(this.selectedIndices[N]){O=L(this,[N]);}else{P=C(this,[N]);}F(this,P,O,[N]);},rangeSelect:function(N){},select:function(O,N){if(O==null){return ;}if(O.constructor!=Array){O=[O];}var Q=A(this),S=C(this,O),P=Q.length-1;if(this.selectionPolicy!=="reselect"){for(;P>=0;P--){var R=G.indexOf(S,Q[P]);if(R>-1){Q.splice(P,1);S.splice(R,1);}}}if(!N){F(this,S,Q,O);}},clearSelect:function(N){var O=A(this);if(N!==true){F(this,null,O,[]);}},addSelect:function(P,N){if(P==null){return ;}if(P.constructor!=Array){P=[P];}var O=C(this,P);var R=null,Q=this.noneIdx;if(this.multiSelect&&(Q>-1&&G.indexOf(P,Q)>-1)){R=L(this,P);}if(N!==true){F(this,O,R,P);}},removeSelect:function(N){if(N==null){return ;}if(N.constructor!=Array){N=[N];}F(this,null,L(this,N),N);},_set_selectedIndices:function(P,W,N){var S=this,O=S.selectedIndices;if(S.selectedItems){S.selectedItems={};}var O=S.selectedIndices;if(O==W){return false;}if(!O){O={};S.selectedIndices=O;}if(!W){W={};}var U=S.selectedIndex,T=[],V;for(V in O){if(!W[V]){V=parseInt(V,10);delete O[V];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var Z=[],X=S.items,R=S.itemIdField,Y;for(V in W){if(!O[V]){V=parseInt(V,10);O[V]=true;Z.push(V);S.selectedIndex=V;Y=S.selectedItem=X[V];if(S.selectedItems){S.selectedItems[Y[R]]=Y;}}}if(N!==true){var Q=[];for(V in W){if(O[V]){V=parseInt(V,10);Q.push(V);}}F(S,Z,T,Q);}return(Z.length||T.length);},_set_selectedIndex:function(Q,O,N){var P={};if(O>-1){P[O]=true;}return this._set_selectedIndices("selectedIndices",P,N);},_set_selectedItem:function(Q,P,O){var N=I(this,P);if((N===-1)&&(P!=null)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(P));N=this.items.length-1;}return this._set_selectedIndex("selectedIndex",N,O);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo._HasBuilder={postBuildRendering:function B(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function C(){return this.model.getChildren(this.node,false);},buildChildren:function A(E){if(!this.builder||!this.model){return false;}if(this.children&&this.children.length){this.set("children",[]);}var D=this.model,F=this.builder.build(this.getChildren(),D,this.buildConfig);if(!E){this.addChildren(F);}this.builtChildren=true;return(E)?F:true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,L=mstrmojo.hash;function F(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(C.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function B(R){var Q=[],S=R.selectedIndices;for(var P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function N(V,U){var S=[],Q=V.selectedIndices,X=C.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return B(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}for(var R=0,T=U.length;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex==W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V;for(var Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function H(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function O(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=B(this),S=F(this,[P]);if(Q!==true){H(this,S,R);}}},toggleSelect:function J(P,Q){var S,R;if(this.selectedIndices[P]){R=N(this,[P]);}else{S=F(this,[P]);}if(Q!==true){H(this,S,R);}},rangeSelect:function G(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=B(this);if(P!==true){H(this,null,Q);}},select:function E(R,P){var Q=A(this,C.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){H(this,Q.add,Q.rmv);}},addSelect:function M(R,P){if(R==null){return ;}if(R.constructor!==Array){R=[R];}var Q=F(this,R);if(P!==true){H(this,Q,null);}return Q;},removeSelect:function K(R,P){if(R==null){return ;}if(R.constructor!=Array){R=[R];}var Q=N(this,R);if(P!==true){H(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){H(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof (T)=="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=C.find(U,V,T[V]);}else{if(T!=null){Q=C.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function D(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!=null){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return L.keyarray(this.selectedIndices,true).sort(C.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return C.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,f){if(!Q||!Q.length){return ;}var S=this.items||[],x=this.itemIdField!=null?C.findMulti(S,this.itemIdField,Q):C.indexOfMulti(S,Q),V=Q.length,T=V-x.count,t=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(t&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],h=x.map;if(T&&t){var s=0;for(var g=0;g<V;g++){if(h[g]==null){R.push(Q[g]);U.push(b+s++);}}this.add(R,b);}var W=[];for(var o in h){var q=h[o];if(q>=b){q+=X;}W.push(q);}var w=W.concat(U),Y=this.addSelect(w,!f);if(!f){var Z=C.hash(Y),l=this.selectedIndices,a=[];for(var p in l){if(!Z[p]){a.push(parseInt(p,10));}}var P=this.removeSelect(a,true);H(this,Y,P);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo.requiresDescs(4891);var D=mstrmojo.array,C="u;",A="-1";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function E(F,I,K){var H;for(var G in F){H=F[G];if(H.v){var J=H.v.split(";");if(J&&J.length>1){J[1]=I;if(K&&J.length>2){J.pop();}H.v=J.join(";");}}}return F;},buildElemsCountStr:function B(I,G){if(!I||!I.length||!G||!G.length){return"";}var H=I.length,F=G.length;if(D.find(G,"v",C)>-1){F-=1;}if(D.find(G,"v",A)>-1){F-=1;}if(D.find(I,"v",C)>-1||D.indexOf(I,C)>-1){H=F;}if(H>=F){return"("+F+")";}else{return mstrmojo.desc("4891").replace("##",H).replace("###",F);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var G="*";var F=".";var I="-";var C="_";var A="<";var E=new RegExp("[\\"+G+"\\"+F+"\\"+I+"\\"+C+"\\"+A+"]","g");var H=G+"$&";mstrmojo.Serializer={scriptClass:"mstrmojo.Serializer",serializeValueGroup:function(B){mstrmojo.array.forEach(B,function(D,J){B[J]=mstrmojo.Serializer.serializeValues(D);});return I+this.serializeValues(B)+C;},serializeValues:function(D){var B=[];mstrmojo.array.forEach(D,function(J){if(typeof (J)==="Boolean"){J=(J)?"1":"0";}B.push(String(J).replace(E,H));});return B.join(F);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.shouldEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){if(this.shouldEllipsize){A(this);mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered&&this.shouldEllipsize){this.doEllipsize();}}},this.markupMethods);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._IsPanelStack=mstrmojo.provide("mstrmojo._IsPanelStack",{_mixinName:"mstrmojo._IsPanelStack",TTL_SRC_PANEL:0,init:function J(N){this._super(N);var M=this.defn;if(!M){M=this.defn=this.node&&this.node.defn;this.titleSrc=this.titleSrc||M.ttlSrc;}var L=this.selectedKey=this.defn.selKey=this.node.data.selKey;this.set("selectedIdx",E.find(this.node.data.panels,"k",L));M.attachEventListener("selKeyChange",this.id,function(O){this.set("selectedKey",O.value);});},addChildren:function K(O,L,N){var M=this.getFormats(),P=M&&M.overflow;if(P){E.forEach(O,function(Q){var R=Q.getFormats();if(R){R.overflow=P;}});}return this._super(O,L,N);},refresh:function F(){if(this.hasRendered){var L=this.defn.newSelKey||this.selectedKey;E.forEach(this.children,function(M){M._delayRefresh=(M.k!==L);if(!M._delayRefresh){M.refresh();}});}delete this.defn.newSelKey;},selectPanel:function B(L,M){if(L!==this.selectedKey){this.defn.set("selKeyChange",L);this.model.slice({type:3,tks:this.k,eid:L,sid:this.node.data.wid,ck:this.k,hasLoader:M});}},onselectedKeyChange:function G(M){var O,L,N;E.forEach(this.children,function(Q,P){var R=Q.k;if(M.value===R){L=Q;N=P;Q.set("selected",true);}else{if(M.valueWas===R){O=Q;Q.set("selected",false);}}if(L&&O){return false;}});if(this.titleSrc===this.TTL_SRC_PANEL&&this.title){this.set("title",L.title);this.defn.ttl=L.title;}this.prevSelectIdx=this.selectedIdx;this.set("selectedIdx",N);this.raiseEvent({name:"panelSelected",key:L.k});return{on:L,off:O};},setDirty:function D(L){if(L){this.setDirtyChildren(true);}this._super(L);},setDirtyChildren:function H(L){var M=this.selectedKey;E.forEach(this.children,function(O){var N=O.k;O[((L||N!==M)?"add":"remove")+"DirtyKey"](N);});},clearDirtyChild:function I(N){var M=this.children,L=M[E.find(M,"k",N)];if(L){L.removeDirtyKey(L.k);}},isPanelStack:true,checkRequiredObjects:function C(){var L=this.txWidgets||{},O,N,M=true;for(O in L){M&=!!L[O].checkRequiredObjects();}return M;},updateSelectedIdx:mstrmojo.emptyFn,switchToPanel:function A(L,M){if(M!==undefined){this.set("selectedIdx",M);}else{this.updateSelectedIdx(L);}this.children[this.selectedIdx]&&this.selectPanel(this.children[this.selectedIdx].k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.base64","mstrmojo.func","mstrmojo.hash");function decodeHeader(value){var rEncoded=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(value&&value.indexOf("=?UTF-8?B?")===0){var decMsg="",result;while((result=rEncoded.exec(value))!==null){decMsg+=mstrmojo.base64.decode(result[1]);}return decMsg;}return value;}function encodeParams(params){var x=-1;var url=[];if(params){for(var p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function sendXhr(xhr,method,baseUrl,params){method=method.toUpperCase();var app=mstrApp;m=null;if(typeof (microstrategy)!="undefined"&&microstrategy){m=microstrategy;}if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);params.taskContentType=params.taskContentType||"json";params.taskEnv=params.taskEnv||"xhr";params.xts=new Date().getTime();baseUrl=baseUrl||mstrConfig.taskURL;}if(params&&!params.sessionState&&app&&app.sessionState){params.sessionState=app.sessionState;}var ptp=app.persistTaskParams||m&&m.persistParams;if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}xhr.open(method,appendUrlParams(method,baseUrl,params),this.async);if(method!=="POST"){params=null;}else{params=encodeParams(params);xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");}xhr.send(params);if(this.async===false){xhr.onreadystatechange();}}function createXhr(){var methods=[function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}];for(var i=0,cnt=methods.length;i<cnt;i++){var xhr;try{xhr=methods[i]();}catch(e){continue;}createXhr=methods[i];return xhr;}throw new Error("mstrmojo.SimpleXHR: Could not create an XHR object.");}function evalResponse(rt){var _rtn=null;try{_rtn=eval("("+rt+")");}catch(ex){_rtn=rt&&mstrmojo.string.trim(rt);}return _rtn;}var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877;function isSessionExpiredError(res){var c=res&&res.getResponseHeader("X-MSTR-TaskErrorCode");c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;}function xhrSupportsProgress(xhr){return !!(xhr&&("upload" in xhr)&&("onprogress" in xhr.upload));}mstrmojo.SimpleXHR=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.SimpleXHR",isTask:true,async:true,init:function init(props){mstrmojo.hash.copy(props,this);},onreadystatechange:function onreadystatechange(xhr,callback){if(xhr.readyState!==4){return ;}if(typeof callback!=="object"){return ;}try{if((xhr.status===200)||(xhr.status===304)){this.response=callback.textResponse?xhr.responseText:evalResponse(xhr.responseText);if(typeof callback.success==="function"){callback.success(this.response);}}else{if(xhr.status==0){}else{var app=mstrApp,sessionExp=app&&app.onSessionExpired;if(sessionExp&&isSessionExpiredError(xhr)){sessionExp();}else{var _orig=xhr.getResponseHeader;xhr.getResponseHeader=function(name){return decodeHeader(_orig.apply?_orig.apply(xhr,[name]):_orig(name));};if(typeof callback.failure=="function"){callback.failure(xhr);}}}}}catch(ex){mstrmojo.err(ex);}finally{if(typeof callback.complete==="function"){callback.complete();}}},cancel:function(){var didCancel=false;var xhr=this.xhr;if(xhr){delete xhr.onreadystatechange;xhr.isAborted=true;if(xhr.readyState<4){xhr.abort();didCancel=true;}this.xhr=null;}return didCancel;},request:function request(method,baseUrl,callback,params,webSvrUrl,useResFeed,webSrvParams){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("GET",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{var xhr=createXhr();xhr.onreadystatechange=function(me,x,c){return function(){me.onreadystatechange.call(me,x,c);};}(this,xhr,callback);if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback);}this.xhr=xhr;sendXhr.call(this,xhr,method,baseUrl,params);}}});mstrmojo.QueuedXHR=mstrmojo.declare(mstrmojo.SimpleXHR,null,{scriptClass:"mstrmojo.QueuedXHR",queue:null,requestInProgress:false,retryDelay:1,lookup:null,cancel:function(){var didCancel=this._super();while(this.queue.length){var x=this.queue.pop();var cb=x.callback;if(cb&&cb.complete){cb.complete();}}this.queue=[];this.requestInProgress--;return didCancel;},init:function init(){this.queue=[];this.lookup=[];},request:function request(method,baseUrl,callback,params,override,webSvrUrl,useResFeed,webSrvParams,useCache){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("GET",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{if(this.requestInProgress&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params});}else{if(this.requestInProgress){this.cancel();}this.requestInProgress++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();callback=mstrmojo.func.wrapMethods(callback,{complete:function(ths){return function(){ths.advanceQueue.call(ths);};}(this),success:function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this)});xhr.onreadystatechange=function(me,x,c){return function(){me.onreadystatechange.call(me,x,c);};}(this,xhr,callback);if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback);}sendXhr.call(this,xhr,method,baseUrl,params);}}}},advanceQueue:function advanceQueue(){this.requestInProgress--;if(this.queue.length===0){return ;}var req=this.queue.shift();this.request(req.method,req.baseUrl,req.callback,req.params,true);},_searchForCacheRequest:function _searchForCacheRequest(params){for(var i in this.lookup){if(mstrmojo.hash.equals(params,this.lookup[i]["params"])){return this.lookup[i];}}return null;}});mstrmojo.xhr=new mstrmojo.QueuedXHR();mstrmojo.jsonp={jsc:new Date().getTime(),timeToWait:20000,request:function(url,params,callback){var head=document.getElementsByTagName("head")[0]||document.documentElement,jsonp="jsonp"+(this.jsc++),script=document.createElement("script");params.jsonp=jsonp+"(@R@);";params.taskContentType="jsonp";params.taskEnv="jsonp";params.xts=new Date().getTime();window[jsonp]=function(response){if(!response){if(callback.timeout){callback.timeout();}}else{if(response.status===200){callback.success(response.content);}else{var res={status:response.status,getResponseHeader:function(name){switch(name){case"X-MSTR-TaskFailureMsg":return response.errorMsg;case"X-MSTR-TaskErrorCode":return response.errorCode;}}};if(mstrApp.onSessionExpired&&isSessionExpiredError(res)){mstrApp.onSessionExpired();}else{callback.failure(res);}}}if(window[jsonp]){if(callback.complete){callback.complete();}window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}head.removeChild(script);}};head.insertBefore(script,head.firstChild);script.src=appendUrlParams("GET",url,params);setTimeout(function(){window[jsonp]&&window[jsonp]();},this.timeToWait);}};})();(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}else{F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);}this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?1:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}else{var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(J.bc==-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};}var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices",sessionState:mstrApp.sessionState};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,h,V,X){var W=b,Z;while(Z=W.match(h)){var f=Z[0],a=f.length,g=true;f=f.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===f){g=false;break;}else{if(f.indexOf(Y)===0){delete U[Y];}}}if(g){U[f]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var g=S.evt2idx,k=S.idx2evt,Z=S.parts;var h=(U>=0)?U:0,b=this.id,W=mstrmojo.all,f=(U>0)?W[k[h-1].context][Z[h-1]]:(S.host?W[S.host]:this.parent),T=Z[h];var V=mstrmojo.array;while(f&&T){if(f.attachEventListener){var j=f[T+"_bindEvents"]||(T+"Change");if(typeof (j)=="string"){j=[j];}var Y=[];for(var a=0,X=j.length;a<X;a++){Y[a]=f.attachEventListener(j[a],b,"_callback");}for(var a=0;a<j.length;a++){g[f.id+"_"+j[a]]=h;}k[h]={context:f.id,evts:j,subs:Y};}f=f[T];T=S.parts[++h];}},_detachChain:function G(S,T){var U=mstrmojo.all,n=S.idx2evt,g=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=n.length;if(Y<b){for(;Y<b;Y++){var Z=n[Y];if(!Z){break;}var W=Z.context,f=U[W],l=Z.evts;if(f&&f.detachEventListener){var o=Z.subs;for(var k=0,V=o.length;k<V;k++){f.detachEventListener(o[k]);}}n[Y]=null;for(var X=0,h=l.length;X<h;X++){delete g[W+"_"+l[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,9379,9380,9381,9382,9383,9384,9385,6078,7899,7900,7901,6079,6081,6080,6082,7902,7902,6076,6077,7903);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(B){var A=this;if(this.isLoaded){B();}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(C){mstrmojo.hash.copy(mstrmojo.hash.obj2array(C),A);B();if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(C){alert(C.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"getLocaleInfo"});}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:["S","M","T","W","T","F","S"],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:"Include"},{did:"2",n:"Exclude"}],BranchQual:[{did:"19",n:"AND"},{did:"20",n:"OR"},{did:"21",n:"NOT"},{did:"19_21",n:"AND NOT"},{did:"20_21",n:"OR NOT"}],RootOperator:[{did:"19",n:"All selections"},{did:"20",n:"Any selection"}],ExprType:[{did:"2",n:"Qualify"},{did:"5",n:"Select"}],DimtyLevels:[{did:"1",n:"Default"},{did:"2",n:"Metric"},{did:"3",n:"Report"}],Attribute:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1},{did:"1,44",n:"Not between",t:1},{did:"1,76",n:"Contains",t:1},{did:"1,79",n:"Does not contain",t:1},{did:"1,77",n:"Begins with",t:1},{did:"1,80",n:"Does not begin with",t:1},{did:"1,78",n:"Ends with",t:1},{did:"1,81",n:"Does not end with",t:1},{did:"1,18",n:"Like",t:1},{did:"1,43",n:"Not Like",t:1},{did:"1,54",n:"Is Null",t:1},{did:"1,55",n:"Is Not Null",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1}],Metric:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1},{did:"1,44",n:"Not between",t:1},{did:"1,54",n:"Is Null",t:1},{did:"1,55",n:"Is Not Null",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1},{did:"2,1",n:"Highest",t:2},{did:"2,2",n:"Lowest",t:2},{did:"3,1",n:"Highest%",t:3},{did:"3,2",n:"Lowest%",t:3}],MDXAttribute:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1},{did:"1,44",n:"Not between",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1}],MDXMetric:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1}],SAPAttribute:[{did:"1,6",n:"Equals",t:1},{did:"1,7",n:"Does not equal",t:1},{did:"1,22",n:"In",t:1},{did:"1,57",n:"Not In",t:1},{did:"1,8",n:"Greater than",t:1},{did:"1,10",n:"Greater than or equal to",t:1},{did:"1,9",n:"Less than",t:1},{did:"1,11",n:"Less than or equal to",t:1},{did:"1,17",n:"Between",t:1}],Element:[{did:"1,22",n:"In List",t:1},{did:"1,57",n:"Not In List",t:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo._HasPopup={openPopup:function B(G,D){var C=!!G&&(typeof (G)==="string")&&!G.match(/\./)&&!!this[G],I=mstrmojo.registry.ref(C?this[G]:G,true);if(I&&I.open){if(C){this[G]=I;}this.disposables.push(I);var F=I.slot&&this[I.slot];if(F){if(I.parent!==this){if(this.addChildren){this.addChildren(I);}else{var H=false,E=I.domNode||I.placeholder;if(E&&typeof (E)==="string"){E=document.getElementById(E);}if(!E){H=true;E=document.createElement("span");I.placeholder=E;}if(H||(E.parentNode!==F)){F.appendChild(E);}}}}I.open(this,D);this._lastOpened=I;}},closePopup:function A(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var R=mstrmojo.dom,P=mstrmojo.hash;var M=100;var E=R.supportsTouches?0.5:1;var F=1;var Q=100;var N={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var K=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[R.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[R.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[R.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[R.CSS3_TRANSITION]=this.decelerating?(R.CSS3_PREFIX+"transform 0.2s linear"):"";}},P.copy(N));var G=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},P.copy(N));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function L(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=P.copy(R.isSafari?K:G,P.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}R.attachEvent(U,R.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){R.detachEvent(T,R.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function I(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}R.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=R.getMousePosition(R.firstTouch(T,V),T);this.dragging=false;R.attachEvent(window,R.TOUCHMOVE,this._tmCallback);R.attachEvent(window,R.TOUCHEND,this._teCallback);},touchesMoved:function D(b,g){var Z=R.getMousePosition(R.firstTouch(b,g),b);R.preventDefault(b,g);if(!this.dragging){var T=5,j=Math.abs;if((this.scrollsHoriz&&j(Z.x-this.pos.x)>T)||(this.scrollsVert&&j(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},h={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=h;this.maxPos={x:Math.max(h.x-Y.x,0),y:Math.max(h.y-Y.y,0)};this.showScroll();}}if(this.dragging){R.stopPropogation(b,g);var f=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(f.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(f.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),i=this.lastDragTime;this.nextLastDragTime=i;this.lastDragTime=U;if((U-i)>Q){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function H(T,U){R.preventDefault(T,U);R.detachEvent(window,R.TOUCHMOVE,this._tmCallback);R.detachEvent(window,R.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;R.stopPropogation(T,U);if((new Date())-this.lastDragTime<=Q){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=R.getMousePosition(R.firstChangedTouch(Y,Z),Y),f=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-f.x,y:W.y-f.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),g=T?(new Date())-T:0,V={x:g?Number(b.x*M*E/g).toFixed(2):0,y:g?Number(b.y*M*E/g).toFixed(2):0};var a=this,U=function(h){return(a.scrollsHoriz&&Math.abs(h.x)>=F)||(a.scrollsVert&&Math.abs(h.y)>=F);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,M);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=(b)?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=(b)?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function J(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function O(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash;mstrmojo._CanSupportTransaction={_mixinName:"mstrmojo._CanSupportTransaction",updatedCellsMap:null,getUpdates:mstrmojo.emptyFn,getUpdateObject:mstrmojo.emptyFn,getKeyContext:mstrmojo.emptyFn,autoRefresh:mstrmojo.emptyFn,editNext:mstrmojo.emptyFn,dataChanged:function A(F,G,E,H){var D=this.updateValue(F,E);this.updatedCellsMap[F]={r:G,v:E};this.controller.onTransactionUpdates(this,this.getUpdateObject(),D);},postBuildRendering:function B(){if(this._super){this._super();}if(!this.txModel){this.txModel=this.model.docModel||this.model;}this.updatedCellsMap=this.updatedCellsMap||{};},updateValue:function(E,D){if(this.txModel.deltaUpdate){this.txModel.deltaUpdate(this);}return false;},getUpdatedValues:function(){var E=this.updatedCellsMap,F,D,G=[];for(F in E){if(E.hasOwnProperty(F)){D={};D.v=E[F].v.v;G.push(C.copy(this.getKeyContext(F),D));}}return G;},clear:function(){this.updatedCellsMap={};},registerTxWidget:function(){function E(F,H){var G=F.node.data.k;H.txWidgets=H.txWidgets||{};H.txWidgets[G]=F;return false;}var D=this.parent;while(D){if(D.isPanelStack===true){E(this,D);}D=D.parent;}}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash,A=null;function B(D){return mstrmojo.DICFactory.createDIC(C.copy({dic:this.dic,owner:this.owner,group:this},D));}mstrmojo.DICFactory=mstrmojo.provide("mstrmojo.DICFactory",{createDIC:function(G){var E=G.dic,F=mstrmojo.DICConfig.getDICClass(E),D;if(F){if(G.k===undefined){G.k=G.opener&&G.opener.id;}G.showByDefault=mstrmojo.DICConfig.showDICByDefault(G.dic,G.openerType);G.hasPreview=mstrmojo.DICConfig.hasDICPreview(G.dic,G.openerType);D=new F(G);}return D;},createDICPopup:function(D,E){return mstrmojo.DICPopup.getInstance(D,E);},createDICGroup:function(F){var I=C.copy(F,{scriptClass:"mstrmojo.Widget",widgetsMap:{},dic:null,owner:null,groupMembers:{},postCreate:function(){var L=this.dic,K=this.openerType,J=mstrmojo.DICConfig;this.showByDefault=J.showDICByDefault(L,K);this.hasPreview=J.hasDICPreview(L,K);},addDIC:function D(J,K){this.groupMembers[J]=K;},showPopupDIC:function H(K){if(!this.showByDefault){var J=this.widgetsMap[K],L=this.groupMembers[K];if(!L){return ;}if(!J){J=this.widgetsMap[K]=B.call(this,L);}J.showInPopup();}},render:function G(){if(this.showByDefault||this.hasPreview){var L=this.groupMembers,K=this,J;C.forEach(L,function(N,M){if(!N.hasRendered){K.widgetsMap[M]=J=B.call(K,N);if(K.showByDefault){J.render();}else{if(K.hasPreview){J.renderPreview();}}N.hasRendered=true;}});}},destroy:function E(){C.forEach(this.widgetsMap,function(J){J.destroy();});this.widgetsMap={};}});return mstrmojo.insert(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var G=mstrmojo.dom,H=Math;var D=1,F=2,I=3,K=4,E=5,A=6;function B(){var N=this.anchor;if(!N){return false;}var W=this.baseTipClass,X=this[this.tipNodeName];X.className=W+" top";var n=this[this.boundaryNodeName],AC=this[this.popupNodeName],k=this.anchorOffset,AA=this.anchorOrientation,x=this.hasScrollbars(),g=mstrmojo.hash.copy(this.anchorPosition||G.position(N,true)),Q=G.position(n,true),AG=Q.w,O=Q.h,o=AC.offsetWidth,S=AC.offsetHeight,a=o/2,L=S/2,f=G.position(X),t=H.min(f.h,f.w),U=H.max(f.h,f.w)/2,q=this.placement;if(x){AG-=15;O-=15;}var h=G.contains(n,AC),w=h?0:Q.y,AF=AG/2-a,V=O/2-L+w,AB=-1000,AH=-1000,P,s=["borderBottomColor","borderTopColor","borderRightColor","borderLeftColor"],AI=0;if(h){g.x=g.x-Q.x;g.y=g.y-Q.y;}var p=g.y+g.h,R=g.x+g.w,AD=((R+o)<AG),Y=g.y>S,z=((p+S)<O),b=function(i,AK,AJ){return H.min(H.max(i,AJ),H.max(AK,0));},T=function(){if((g.x<AG)&&(z||Y)){var i=g.x+(g.w/2),AJ=(q==K&&z)||!Y;if(AJ){P="top";AH=p;AI=0;V=p+t-k;}else{P="bottom";AH=g.y-t;AI=1;V=AH-S+k;}AF=b(0,AG-o,i-a);AB=b(g.x,R,i)-U;return true;}return false;},l=function(){if((g.y<O)&&(AD||g.x>o)){var i=g.y+(g.h/2),AJ=!(q==E&&g.x>o)&&AD;if(AJ){P="left";AB=R;AI=2;AF=R+t-k;}else{P="right";AB=g.x-t;AI=3;AF=AB-o+k;}V=b(w,O-S,i-L);AH=b(g.y,p,i)-U;return true;}return false;},Z=[T,l],AE=0;if(q==F){V=this.popPosition.top;AF=this.popPosition.left;AH=-1000;AB=-1000;P=null;}else{if(q==E||q==A||(q==D&&AA==="h")){Z.reverse();}for(;AE<2;AE++){if(Z[AE]()){break;}}V=H.round(V);AF=H.round(AF);AH=H.round(AH);AB=H.round(AB);}X.className=W+" "+(P||"hidden");var j=X.style,M=AC.style;j.top=AH+"px";j.left=AB+"px";if(this.tipNodeColor){mstrmojo.array.forEach(s,function(i){j[i]="";});j[s[AI]]=this.tipNodeColor;}M.top=V+"px";M.left=AF+"px";return true;}mstrmojo._IsAnchorable={anchor:null,anchorPosition:null,boundaryNodeName:"curtainNode",popupNodeName:"editorNode",tipNodeName:"tipNode",baseTipClass:"mstrmojo-Editor-tip",anchorOffset:25,anchorOrientation:"v",placement:D,popPosition:null,hasScrollbars:function C(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},prepareAnchor:mstrmojo.emptyFn,positionDialog:function J(){this.prepareAnchor();if(!B.apply(this,[])){if(typeof this._super==="function"){this._super();}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function A(){var I=this.getFormats(),G="",H=function H(J){if(I[J]){var K=this[J]||I[J];this[J]=K;if(this.isFullScreenWidget){I[J]=K;}this[J+"Limit"]=parseInt(K,10);}};H.call(this,"height");H.call(this,"width");var F=function(M,L){var J=I[M];if(J&&J.charAt(J.length-1)!=="%"){var K=parseInt(J,10);if(!isNaN(K)){if(L){K-=L;}G+=M+":"+K+"px;";}}return null;};F("height",0);F("width",0);this.scrollboxNodeCssText=G;return this._super();},resize:function(){this.clearCache();var I=this.getFormats(),G=parseInt(I.height,10),F=parseInt(I.width,10);if(F>0&&G>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}mstrmojo.array.forEach([this.scrollboxNode,this.viewport],function(K){var J=K.style;J.height=G+"px";J.width=F+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=G&&(G!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(G,10);this.scrollboxBottom=this.scrollboxTop+G;}if(this.lockHeadersCase){this.resizeScrollBox(B.isIE);}}var H=this.zones;if(H){if(H._BL){H._BL.onscroll();}if(H._BR){H._BR.onscroll();}}if(!(this.gridData&&this.gridData.eg)){this.onGridWidthChanged();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function D(){this.clearCache();this.unrender();this.render();},unrender:function E(){this.clearCache();if(this._super){this._super();}},defaultAction:function C(J,H){if(this._super(J,H)){var F=this.model.sti,G=F&&F.titleId,L=F&&F.deselectCurrent,M;this._currentSelectedTD=L?undefined:J;if(G){for(M in this.zones){var N=this.zones[M],K=N.domNode,I=K&&K.firstChild;if(I&&(J.offsetParent===I||J.offsetParent===K)){N.clearHilites(G);if(!L){N.setHilites(G,J);}N.hiliteKey=G;this.model.sti=null;return true;}}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var Y=5;var l=1;var V=2;var N=4;var k=0;var O=true;var I=0;var F=86400000;mstrmojo.VisChartUtils=mstrmojo.provide("mstrmojo.VisChartUtils",{getScreenZoomFactor:function Z(){if(I==0){if(mstrMobileApp){var q=mstrMobileApp.getDeviceDPI();console.log("dpi:"+q);I=q/160;}else{I=1;}}return I;},changeElementSize:function a(w,AB,AA){if(AB=="fontSize"||AB=="height"||AB=="line-height"){var z=mstrmojo.css.getStyleValue(w,AB);var t=Math.round(AA*parseInt(z));w.style[AB]=t+"px";}else{if(AB=="font"){var x=mstrmojo.css.getStyleValue(w,"fontSize");var t=Math.round(AA*parseInt(x));var s=mstrmojo.css.getStyleValue(w,"fontWeight");var q=mstrmojo.css.getStyleValue(w,"fontFamily");w.style.font=s+" "+t+"px "+q;}}},rgbaStr2rgba:function L(q){var t=null;q=q.replace(/ /g,"");var s=q.indexOf("rgba");if(s>=0){q=q.substring(s+5,q.length-1);t=q.split(",");}return t;},fillBackground:function b(z,s,AH,t,AB){var AA=t||z.context,x=s||z.canvas.width,AE=AH||z.canvas.height,AF=z.themeColor||"#000000",AD=null,AG=AB||1;if(!AA){AA=z.canvas.getContext("2d");if(!AA){return ;}}AA.save();if(z.noBackground){}else{if(!z.isAndroid&&!z.isTimeSeries){AD=AA.createLinearGradient(0,0,0,AE/2);AA.fillStyle=AF;AA.fillRect(0,0,x,AE);AA.globalAlpha=0.4;AD.addColorStop(0,"#fff");AD.addColorStop(0.1,"#fff");AD.addColorStop(1,AF);AA.fillStyle=AD;AA.rect(0,0,x,AE/2);AA.fill();AA.globalAlpha=0.1;AA.fillStyle="#fff";AA.fillRect(0,0,x,AE/2);}else{if(z.isTimeSeries){var AC=z.formatProp;AD=AA.createLinearGradient(0,0,0,AE);AA.globalAlpha=AC.backgroundAlpha;var q=this.rgb2rgbStr(AC.backgroundClr,0.83)||"#2c2c2c";var w=this.rgb2rgbStr(AC.backgroundClr)||"#000000";AD.addColorStop(0,q);AD.addColorStop(1,w);AA.fillStyle=AD;AA.rect(0,0,x,AE);AA.fill();}else{AA.globalAlpha=AG;AA.fillStyle=AF;AA.fillRect(0,0,x,AE);}}}AA.restore();},rgb2rgbStr:function W(s,t){var q="";if(!s||s.length!=3){return q;}if(t||t==0){q="rgba("+s[0]+","+s[1]+","+s[2]+","+t+")";}else{q="rgb("+s[0]+","+s[1]+","+s[2]+")";}return q;},getRGBWithOpacity:function R(s,q,t){if(isNaN(q)){return ;}if(!t){t=[255,255,255];}var w=[];for(color in s){w[color]=parseInt(s[color]*(1-q)+t[color]*q);}return w;},fillMasterChartBackground:function S(AD,t,q,x,AJ,AC,z){var AE=z||AD.context,AB=x||AD.canvas.width,AH=AJ||AD.canvas.height,AI=AD.themeColor,AG=null;var AF=AD.formatProp;AE.save();AE.globalAlpha=AF.backgroundAlpha;AE.fillStyle=this.rgb2rgbStr(AF.backgroundClr)||"#000000";AE.fillRect(0,0,AB,q);AG=AE.createLinearGradient(0,0,0,AH/2);var s=this.rgb2rgbStr(this.getRGBWithOpacity(AF.backgroundClr,0.45))||"#737373";var AA=this.rgb2rgbStr(this.getRGBWithOpacity(AF.backgroundClr,0.13))||"#222222";AG.addColorStop(0,s);AG.addColorStop(1,AA);AE.fillStyle=AG;AE.fillRect(t,q,AB,AH/2);AE.fillStyle=this.rgb2rgbStr(AF.backgroundClr)||"#000000";AE.fillRect(t,q+AH/2,AB,AH/2+AC);AE.globalAlpha=1;AE.strokeStyle=this.rgb2rgbStr(AD.formatProp.textClr,0.5);AE.lineWidth=1;var w=q+0.5;this.drawLineSet(this,[{x:t,y:w},{x:t+AB,y:w}],false,AE);w=q+AH-0.5;this.drawLineSet(this,[{x:t,y:w},{x:t+AB,y:w}],false,AE);AE.restore();},drawLineSetWithSplit:function(z,AD,AC,s,AA){var t=AD.length,AB=Math.ceil(t/AA),q,w;for(var x=0;x<AB;x++){q=x*AA;w=Math.min(q+AA+1,t);this.drawLineSet(z,AD.slice(q,w),AC,s);}},drawLineSet:function M(x,AE,AD,q){var z=null,t=AE.length,AC=null;if(q){z=q;}else{z=x.context;}var AA=null,s=false;z.beginPath();var w=0;while(w<t){if(AE[w]){z.moveTo(AE[w].x,AE[w].y);AA=AE[w];s=true;w++;break;}w++;}var AB=false;for(;w<t;w++){AC=AE[w];if(AC){if(!AB){z.lineTo(AC.x,AC.y);s=false;}else{z.moveTo(AC.x,AC.y);s=true;AA=AC;AB=false;}}else{if(!AB){AB=true;if(s){z.arc(AA.x,AA.y,1,0,Math.PI*2,false);}}}}if(AD){z.closePath();z.fill();}else{z.stroke();}},getMinYPosition:function H(s,x,q){var w=x,t;while(w<=q){if(s[w]){t=s[w].y;break;}w++;}for(w=x;w<=q;w++){if(s[w]){t=Math.min(t,s[w].y);}}return t;},drawLineAreaWithSplit:function(AA,AG,q,x,w,AB,s,AC){var t=x-q+1,AE=Math.ceil(t/AC),AF,AD;for(var z=0;z<AE;z++){AF=q+z*AC;AD=Math.min(AF+AC,q+t-1);this.drawLineArea(AA,AG,AF,AD,w,AB,s);}},drawLineArea:function M(z,q,AC,x,AB,AG,t){var AF=null,AJ=q.length,AE=null,AK=0,AD=0;if(t){AF=t;}else{AF=z.context;}var w=null,AI=false;AF.save();AF.lineWidth=0;AF.beginPath();var AM=AC,AA;while(AM<=x){if(q[AM]){AK=q[AM].x;AF.moveTo(AK,AB);w=q[AM];AI=true;break;}AM++;}AA=AM;var AH=false;for(;AM<=x;AM++){AE=q[AM];if(AE){if(!AH){AF.lineTo(AE.x,AE.y);AI=false;AD=AE.x;}else{AK=AE.x;AF.moveTo(AK,AB);if(AM+1<=x&&q[AM+1]){AF.lineTo(AE.x,AE.y);}w=AE;AH=false;AA=AM;}}else{if(!AH){AH=true;if(!AI){AF.lineTo(AD,AB);AF.lineTo(AK,AB);var s=this.getMinYPosition(q,AA,AM)||0;var AL=AF.createLinearGradient(0,s,0,AB);AL.addColorStop(1,this.rgb2rgbStr(AG,0));AL.addColorStop(0,this.rgb2rgbStr(AG,1));AF.fillStyle=AL;AF.globalAlpha=0.8;AF.fill();}}}}if(!AI){AF.lineTo(AD,AB);AF.lineTo(AK,AB);var s=this.getMinYPosition(q,AA,x)||0;AF.closePath();var AL=AF.createLinearGradient(0,s,0,AB);AL.addColorStop(1,this.rgb2rgbStr(AG,0));AL.addColorStop(0,this.rgb2rgbStr(AG,1));AF.fillStyle=AL;AF.globalAlpha=0.8;AF.fill();}AF.restore();},drawRectangle:function n(AB,q,AD,t,AA,AC,z){var s=null;if(z){s=z;}else{s=AB.context;}if(AC){s.fillRect(q,AD,t,AA);}else{s.strokeRect(q,AD,t,AA);}},drawArc:function Q(w,AD,AC,AA,AB,s,t,AE,q){var z=null;if(q){z=q;}else{z=w.context;}z.beginPath();z.arc(AD,AC,AA,AB,s,t);if(AE){z.fill();}else{z.stroke();}},drawRoundRect:function K(t,q,AC,s,z,AA,AB){AA=Math.min(s/2,z/2,AA);t.beginPath();t.moveTo(q+AA,AC);t.arcTo(q+s,AC,q+s,AC+z,AA);t.arcTo(q+s,AC+z,q,AC+z,AA);t.arcTo(q,AC+z,q,AC,AA);t.arcTo(q,AC,q+s,AC,AA);t.closePath();if(AB){t.fill();}else{t.stroke();}},drawHalfRoundedRectangle:function p(t,AC,AB,AD,z,q,AE,s){var AA=null;if(s){AA=s;}else{AA=t.context;}AA.beginPath();AA.moveTo(AC+AD,AB);AA.lineTo(AC+q,AB);AA.arcTo(AC,AB,AC,AB+q,q);AA.lineTo(AC,AB+z-q);AA.arcTo(AC,AB+z,AC+q,AB+z,q);AA.lineTo(AC+AD,AB+z);if(AE){AA.fill();}else{AA.stroke();}},drawStartEndPoints:function X(AB,AH,t,x){var w=AH.length;var AC=null,q=AB.startEndPointRadius;if(t){AC=t;}else{AC=AB.context;}AC.save();var AE="#f0f43e",AD="#f0f43e",AF="#663300";if(AB.startPointColor){AE=AB.startPointColor;}if(AB.endPointColor){AD=AB.endPointColor;}else{var AG=AH[0].y,AA=AH[w-1].y;if(AG>AA){AD="#008000";}else{if(AG<AA){AD="#8d1616";}else{AD=AE;}}}if(AB.otherPointColor){AF=AB.otherPointColor;}if(x&l&&AH[0]){AC.strokeStyle=AE;AC.fillStyle=AE;this.drawArc(this,AH[0].x,AH[0].y,q,0,Math.PI*2,true,true,AC);}if(x&V&&AH[w-1]){AC.strokeStyle=AD;AC.fillStyle=AD;this.drawArc(this,AH[w-1].x,AH[w-1].y,q,0,Math.PI*2,true,true,AC);}if(x&N){AC.strokeStyle=AF;AC.fillStyle=AF;for(var z=1;z<w-1;z++){if(AH[z]){this.drawArc(this,AH[z].x,AH[z].y,q,0,Math.PI*2,true,true,AC);}}}AC.restore();},getColor:function T(q){return(parseInt(q.themeColor.substr(1),16)>8388607)?"#000000":"#ffffff";},drawHighlightLine:function f(s,AA){var q=s.context,z=s.margin,x=z.l,t=s.isTimeSeries?s.chartWidth+z.l:s.getWidth()-z.r;q.save();q.globalAlpha=1;q.strokeStyle=this.rgb2rgbStr(s.formatProp.textClr,0.35);q.lineWidth=1;q.lineCap="round";while(x<t){q.beginPath();q.moveTo(x,AA);x+=2;q.lineTo(x,AA);q.stroke();x+=3;}q.restore();},addLabel:function o(AK,AL,AJ,AH,s,AD,AE){var AG=document.createElement("div");AG.className="mstrmojo-Chart-lbl";AG.style.color=this.rgb2rgbStr(AK.formatProp.textClr,0.8);AG.innerHTML=AL;if(s){AG.style.width=s+"px";}var AA=null;var AF=0;if(AK.isTimeSeries){if(AE.w>=0){AA=AK.xdiv;AF=AK.animationCanvas.width;}else{AA=AK.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(!AA){AA=document.createElement("div");AA.id="mstrmojo-chart-ylbl-div";AA.className="mstrmojo-chart-ylbl-div";AK.domNode.appendChild(AA);}AA.style.width=AK.margin.l-1+"px";}}else{AA=AK.domNode;AF=AK.getWidth();}AA.appendChild(AG);var z=AG.offsetWidth||(AK.getTextWidth&&AK.getTextWidthByElem(AL,AG));var AI=AG.offsetHeight||22*(I||1);var t=s||z||100;var AC=AK.xLabelPadding/2;var AB=AK.yLabelPadding/2;if(AE.w>=0&&AK.isTimeSeries&&AK._scroller.origin){var AM=AJ-AK._scroller.origin.x;if(AM<=0&&(AM+z/2>-AK.maxYLblWidth)){AK.needRedrawVerticalLine=true;AA.removeChild(AG);return null;}var q=AM-AK.getChartWidthOnScreen();if((q-z/2)<=0&&q>=0){AK.needRedrawVerticalLine=true;AA.removeChild(AG);return null;}}if(AE.w>=0){AJ=AJ-t/2;}if(AE.h>=0&&((AH>=AE.y-AB&&AH<=AE.y+AE.h)||(AH+AI>=AE.y-AB&&AH+AI<=AE.y+AE.h)||(AH+AI>=AK.canvas.height-AK.margin.b))){AA.removeChild(AG);return null;}if(AE.w>=0&&(((AJ>=AE.x&&AJ<AE.x+AE.w+AC))||AJ<AE.x||AJ<AK.margin.l||AJ+t>AF)){AA.removeChild(AG);return null;}if(AK.isTimeSeries&&AE.h>=0){AA.style.top=(AK.margin.t-AI/2)+"px";AA.style.height=(AK.canvas.height-AK.margin.t-AK.margin.b-1+AI/2)+"px";this.translateCSS(AJ,(AH-AK.margin.t)+AI/2,AD,AG);}else{this.translateCSS(AJ,AH,AD,AG);AG.style.maxHeight=AI+"px";}AE.x=AJ;AE.y=AH;if(AE.h>=0){AE.h=AI;}if(AE.w>=0){AE.w=t;AG.style.textAlign="center";}return AG;},addDataLabel:function o(s,x,AA,t){var q=(s.margin.l>s.margin.r)?Y:s.getWidth()-s.margin.r+Y,z=(s.margin.l>s.margin.r)?s.margin.l:s.margin.r;return this.addLabel(s,x,q,AA-10,z-Y*2,false,t);},translateCSS:function h(q,z,s,w){var t="translate("+q+"px,"+z+"px)";if(s){t+=" rotate(45deg)";}w.style[J.CSS3_TRANSFORM]=t;},getTouchXYOnWidget:function B(s,q,x){var w=mstrmojo.TouchScroller,t=(w&&x.parent&&w.getScrollPositionTotals(x.parent))||{x:0,y:0};s=s-x.offsetLeft+t.x;q=q-x.offsetTop+t.y;return{touchX:s,touchY:q};},getYValue:function A(x,s){var q=x.canvas.height,w=x.margin,t=x.model.mvalues;return q-w.b-4-((parseFloat(s)-t[0])*x.RTY);},getMasterYValue:function g(w,s,x){var q=w.masterCanvas.height,t=w.model.mvalues;return q-x.b-3-((parseFloat(s)-t[0])*w.MRTY);},getSeriesIndexAndYValue:function C(AD,q,AE){var AF=AD.model.series,z=AF.length,AB=0;y=this.getYValue(AD,AF[AB].rv[q])||0;var AC=AE-y<0?-(AE-y):AE-y,t=AC;for(var AA=1;AA<z;AA++){var x=this.getYValue(AD,AF[AA].rv[q])||0;AC=AE-x<0?-(AE-x):AE-x;if(AC<t){y=x;t=AC;AB=AA;}}return{y:y,si:AB};},getLabelWidthForMargin:function j(q,x){var t=document.createElement("div");t.className="mstrmojo-Chart-lbl";t.innerHTML=x;q.domNode.appendChild(t);var s=t.offsetWidth||60;q.domNode.removeChild(t);return s+Y*2;},animateLineSet:function U(AF,t,AD,AB){var AG=[],AE=AF.animationContext,z=AD.length;AE.clearRect(0,0,AF.getWidth(),AF.canvas.height);if(!AB.index){AB.index=0;}else{if(AB.index>=AB.rate){this.drawLineSet(AF,AD,false,AE);AF.drawLabels();if(AF.isFillLinesArea){this.fillLinesArea(AF,AD.slice(0));}if(AF.isDrawStartEndPoints){this.drawStartEndPoints(AF,AD,AE,AF.isDrawStartEndPoints);}return ;}}for(var AA=0;AA<z;AA++){var s=AD[AA],q=t[AA];AG[AA]={x:(AB.index*(s.x-q.x)/AB.rate)+q.x,y:(AB.index*(s.y-q.y)/AB.rate)+q.y};}this.drawLineSet(AF,AG,false,AE);var AC=this;AB.index++;window.setTimeout(function(){AC.animateLineSet(AF,t,AD,AB);},40);},fillLinesArea:function G(s,z){var t=s.canvas.height;z.push({x:s.getWidth()-s.margin.r,y:t-s.margin.b});z.push({x:s.margin.l,y:t-s.margin.b});var AA=new Array();if(s.fillinColor){mstrmojo.requiresCls("mstrmojo.color");var x=mstrmojo.color.hex2rgb(s.fillinColor).join(",");AA[0]="rgba("+x+", 0.8)";AA[1]="rgba("+x+", 0.2)";}else{AA=["rgba(255,128,0,0.8)","rgba(255,128,0,0.2)"];}var q=s.animationContext;var x=q.createLinearGradient(0,0,0,t);x.addColorStop(0,AA[0]);x.addColorStop(0.75,AA[1]);q.fillStyle=x;this.drawLineSet(s,z,true,q);},convertRawValueToMilliseconds:function i(t){var w=Number(t),q=w-((new Date("1/1/1970").getTime()-new Date("12/30/1899").getTime())/F)-k,s=new Date(q*F);return new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()).getTime();},getAncestorBgColor:function D(t){var AB=null,AA=t,w=AA.model,AE=null;if(AA.hasOwnProperty("xtabModel")&&AA.xtabModel.hasOwnProperty("docModel")){AE=AA.xtabModel.docModel;}if(AE&&AE.defn&&AE.defn.layouts&&AE.defn.layouts.length>0){var AD=AE.defn.layouts,x;var s;for(s in AD){if(AD[s].loaded){x=AD[s];}}if(x&&x.hasOwnProperty("units")){var z=x.units;var AC=w.parent;while(AC){var q=AC.k||null;if(z[q]&&z[q].fmts&&z[q].fmts["background-color"]){AB=z[q].fmts["background-color"];break;}else{AC=AC.parent||null;}}if(!AB){if(x.fmts&&x.fmts["background-color"]){AB=x.fmts["background-color"];}}}}return AB;},getPointDistanceSquare:function E(s,q){return(s.x-q.x)*(s.x-q.x)+(s.y-q.y)*(s.y-q.y);},truncateTextToLine:function(s,AF,AJ){AF.className=s.className;AF.style.whiteSpace="nowrap";var AA=AF.innerHTML=s.innerHTML;var w=parseInt(s.offsetWidth)-parseInt(s.style.width);var AH=AJ*parseInt(s.style.width)+w;var x=AA;if(AF.offsetWidth>AH){var AB=0,t=AA.length-1;while(AB<=t){var AE=Math.round((AB+t)/2);var AI=AA.substr(0,AE+1);var AG=AA.substr(0,AE+2);AF.innerHTML=AI;var AD=AF.offsetWidth;AF.innerHTML=AG;var z=AF.offsetWidth;if(AD<=AH&&z>AH){break;}else{if(AD>AH){t=AE-1;}else{if(z<=AH){AB=AE+1;}}}}x=AA.substr(0,AE+1);if(x.length<AA.length){if(x.charAt(x.length-1)===" "){x=x.substr(0,x.length-1);}var AC=x.lastIndexOf(" ");var q=x.length-1-AC;if(q>=2&&q<=8){x=x.substr(0,x.length-q-1)+"...";}else{x=x.substr(0,x.length-3)+"...";}}}s.innerHTML=x;},getLen:function(w,t,s,q){t.innerHTML=w;var x=t.offsetWidth+s-q;return x;},splitWordIfTooLong:function(x,AI,AF,AB,AD){var AH=x.split(" ");var AC=[];var AE=AH.length;var z=0;var w=0;for(z=0;z<AE;z++){var s=AH[z];while(true){var AJ=this.getLen(s,AI,AD,AB);if(AJ>AF){var AG=(AF/AJ)*s.length;var q=Math.round(AG);while(q>0){var AA=s.substr(0,q);var t=this.getLen(AA,AI,AD,AB);if(t<=AF){AC.push(AA);break;}else{q--;}}s=s.substr(q,s.length-q);}else{AC.push(s);break;}}}return AC.join(" ");},truncateTextToLineWithWordWrap:function(AS,AO,AL){AO.className=AS.className;AO.style.whiteSpace="nowrap";var AK=7;var AC=-1;if(AS.style&&AS.style.width&&AS.style.width.length>0){AC=parseFloat(AS.style.width);}if(AC<0){AC=parseFloat(mstrmojo.css.getComputedStyle(AS).width);}var AM=AS.innerHTML;var AR=parseFloat(AS.offsetWidth)-AC;AM=this.splitWordIfTooLong(AM,AO,AC,AR,AK);var AE=AM.split(" ");var x=[];var AH=[];var AQ=0;var q=0;var AJ=AE.length;AO.innerHTML="&nbsp;";var AT=AO.offsetWidth-AR;AH.push(0);for(AQ=0;AQ<AJ;AQ++){var s=this.getLen(AE[AQ],AO,AK,AR);if(s>AC){var AD=AE[AQ];var AP=(AC/s)*AD.length;AE[AQ]=AD.substr(0,parseInt(AP));s=AC;}x.push(s);q+=s;AH.push(q);if(AQ!==AJ-1){q+=AT;}}var AG=0,AN=0;var AF=AL;for(;AN<AH.length;){var AB=AH[AN]-AH[AG];if(AG>0&&AN!=AG){AB-=AT;}var AA=AH[AN+1]-AH[AG];if(AG>0&&AN+1!=AG){AA-=AT;}if(AB<=AC&&((AN+1==AH.length)||(AA>AC))){AF--;if(AF==0||AN===AJ){break;}else{AG=AN;AN++;}}else{AN++;}}if(AN>AJ){AN=AJ;}var AI=AH[AN]-AH[AG];if(AG>0&&AN!=AG){AI-=AT;}var AU;if(AN>=AJ&&AI<AC){AU=AE.join(" ");}else{AU=AE.slice(0,AN).join(" ");var w=this.getLen("...",AO,AK,AR);if(AI+w<=AC){AU+="...";}else{if(AU.charAt(AU.length-1)===" "){AU=AU.substr(0,AU.length-1);}var z=AU.lastIndexOf(" ");var t=AU.length-1-z;if(t===3){AU=AU.substr(0,AU.length-3)+" ...";}else{AU=AU.substr(0,AU.length-3)+"...";}}}AS.innerHTML=AU;},getLen2:function(AA,s,q){var t=q;var w=t.getContext("2d");w.font=s;w.textAlign="center";w.fillStyle="blue";var z=w.measureText(AA);var x=z.width;return x;},splitWordIfTooLong2:function(z,AF,x,AA){var AH=z.split(" ");var AD=[];var AE=AH.length;var AB=0;var w=0;for(AB=0;AB<AE;AB++){var s=AH[AB];while(true){var AI=this.getLen2(s,x,AA);if(AI>AF){var AG=(AF/AI)*s.length;var q=Math.max(Math.round(AG),1);while(q>0){var AC=s.substr(0,q);var t=this.getLen2(AC,x,AA);if(t<=AF||q==1){AD.push(AC);break;}else{q--;}}s=s.substr(q,s.length-q);}else{AD.push(s);break;}}}return AD.join(" ");},getComputedFontStyle:function P(q){var s=q.fontStyle+" "+q.fontWeight+" "+q.fontSize+"/"+q.fontVariant+" "+q.fontFamily;return s;},truncateTextToLineWithWordWrap2:function(AV,AF,AN){var AE=-1;if(AV.style&&AV.style.width&&AV.style.width.length>0){var AS=0;var AU=mstrmojo.css.getComputedStyle(AV);if(AU.paddingLeft){AS+=parseFloat(AU.paddingLeft);}if(AU.paddingRight){AS+=parseFloat(AU.paddingRight);}var AT=AV.offsetWidth;AE=AT?AT-AS:parseInt(AV.style.width);}if(AE<0){AV.innerHTML="...";return ;}var AO=AV.innerHTML;var AB=mstrmojo.css.getComputedStyle(AV);var t=this.getComputedFontStyle(AB);AO=this.splitWordIfTooLong2(AO,AE,t,AF);var AH=AO.split(" ");var z=[];var AK=[];var AR=0;var q=0;var AM=AH.length;var AW=this.getLen2(" ",t,AF);AK.push(0);for(AR=0;AR<AM;AR++){var s=this.getLen2(AH[AR],t,AF);if(s>AE){var AG=AH[AR];var AQ=(AE/s)*AG.length;AH[AR]=AG.substr(0,parseInt(AQ));s=AE;}z.push(s);q+=s;AK.push(q);if(AR!==AM-1){q+=AW;}}var AJ=0,AP=0;var AI=AN;for(;AP<AK.length;){var AD=AK[AP]-AK[AJ];if(AJ>0&&AP!=AJ){AD-=AW;}var AC=AK[AP+1]-AK[AJ];if(AJ>0&&AP+1!=AJ){AC-=AW;}if(AD<=AE&&((AP+1==AK.length)||(AC>AE))){AI--;if(AI==0||AP===AM){break;}else{AJ=AP;AP++;}}else{AP++;}}if(AP>AM){AP=AM;}var AL=AK[AP]-AK[AJ];if(AJ>0&&AP!=AJ){AL-=AW;}var AX;if(AP>=AM&&AL<AE){AX=AH.join(" ");}else{AX=AH.slice(0,AP).join(" ");var x=this.getLen2("...",t,AF);if(AL+x<=AE){AX+="...";}else{if(AX.charAt(AX.length-1)===" "){AX=AX.substr(0,AX.length-1);}var AA=AX.lastIndexOf(" ");var w=AX.length-1-AA;if(w===3){AX=AX.substr(0,AX.length-3)+" ...";}else{AX=AX.substr(0,AX.length-3)+"...";}}}AV.innerHTML=AX;return AX.indexOf("...")>-1;},truncateDivContent:function(z,AD,t){AD.innerHTML=z;if(AD.offsetHeight>t){var AA=0,s=z.length-1;while(AA<=s){var AE=Math.round((AA+s)/2);var AG=z.substr(0,AE+1);var AF=z.substr(0,AE+2);AD.innerHTML=AG;var AC=AD.offsetHeight;AD.innerHTML=AF;var x=AD.offsetHeight;if(AC<=t&&x>t){break;}else{if(AC>t){s=AE-1;}else{if(x<=t){AA=AE+1;}}}}var w=z.substr(0,AE+1);if(w.length<z.length){if(w.charAt(w.length-1)===" "){w=w.substr(0,w.length-1);}var AB=w.lastIndexOf(" ");var q=w.length-1-AB;if(q>=2&&q<=8){w=w.substr(0,w.length-q-1)+"...";}else{w=w.substr(0,w.length-3)+"...";}}return w;}else{return z;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=false,P=mstrmojo.dom,S=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(T){return false;},queryEnabled:function(T){return true;},queryVisible:function(T){return true;},executeCommand:function O(T){},item2textCss:function E(T){return T.cssClass||T.cmdId||("cmd"+T[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var Z=this._subMenu,X=this.getMenuPosition();if(!Z){var b=(this.menuZIndex||this.zIndex||10)+1,V={left:X.x+"px",top:X.y+"px",zIndex:b,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};Z=new mstrmojo.ContextMenu(V);Z.render();this._subMenu=Z;}else{Z.set("left",X.x+"px");Z.set("top",X.y+"px");}if(this.dynamicUpdate){var U=Z.ctxtBuilder.itemWidgets,W=U&&U.length,T,Y,a=this.getContextMenuSource();for(T=0;T<W;T++){Y=U[T];if(a.queryVisible){Y.set("visible",a.queryVisible(Y.data));}if(a.queryChecked){Y.set("checked",a.queryChecked(Y.data));}if(a.queryEnabled){Y.set("enabled",a.queryEnabled(Y.data));}}}Z.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var T=this._subMenu;if(T&&T.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function N(){var T=this._subMenu,W=this._subMenu.domNode,V=W.offsetHeight,U=W.offsetWidth,Z=P.windowDim(),Y=P.position(W,false),X=P.position(W,true);if((Y.x+U+S)>Z.w){T.set("left",(Z.w-U-S+(X.x-Y.x))+"px");}if((Y.y+V+S)>Z.h){T.set("top",(Z.h-V-S+(X.y-Y.y))+"px");}},attachMousedownEvent:function L(){var T=this;if(!this._close_handler){this._close_handler=function(){if(!T.isOnMySubmenu(P.eventTarget(self,arguments[0]))){T.closeMenuTree();}};}P.attachEvent(document.body,"mousedown",this._close_handler);},isOnMySubmenu:function M(X){var U=this._subMenu;if(!U){return false;}if(P.contains(U.domNode,X,true,document.body)){return true;}var Y=U.ctxtBuilder.itemWidgets,T=Y&&Y.length,W,V;for(W=0;W<T;W++){V=Y[W];if(V.isOnMySubmenu(X)){return true;}}return false;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function R(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var T=P.position(this.domNode,true);return{x:Math.round(T.x),y:Math.round(T.y+T.h)};},isSeparatorItem:function G(T){return T[this.itemIdField]===-1||T[this.itemField]==="-";},hasSubmenu:function K(T){return !!T[this.itemChildrenField];},closeMenuTree:function Q(V){var U=this.activeMenuItem,T=this._cmSource||this;if(!U){if(V){this.activeMenuItem=V;}else{T.hideContextMenu();}return ;}if(U===V){return ;}if(V){this.activeMenuItem=V;if(V.parent.parent===U){return ;}if(V.parent===U.parent){U.hideContextMenu();return ;}}else{V=T;this.activeMenuItem=null;}U.hideContextMenu();while(U!==T){U=U.parent.parent;if(U!==V||T===V){U.hideContextMenu();if(T===V){P.detachEvent(document.body,"mousedown",this._close_handler);}}if(U.parent===V.parent){break;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var I=1,C=2;function E(P){var Q=this.defn,R=Q.vc,S=Q.hc;if(!P||P.length===0||(!R&&!S)){return{};}return{v:!!R,h:!!S};}function B(P){return parseInt(this.getFormats()[(P===I)?"height":"width"],10);}function H(Q){var P=this.getFormats()["max-"+((Q===I)?"height":"width")];return P&&parseInt(P,10);}function G(T,S){var Q=this.defn,R=T&&(T.dimNode||T.domNode),P=Q.ck&&Q.ck[T&&(T.k||T.content.k)];if(R&&P&&(P&S)){return R;}return null;}function F(Q,T,S,Y){var P=parseInt(S.style[(T===I)?"top":"left"],10);if(!!Y){return P+Y;}var R=(Q.fmts&&Q.fmts.fx)||{},U=(!J.isIE7&&(R.rt===1||R.rt===3))?((T===I)?C:I):T,W=(U===I)?"Height":"Width";Y=S["offset"+W]+(R.ds||0);var V=P+Y;if(J.isIE7&&W==="Width"&&Q instanceof mstrmojo.XtabBase){var X=Q.contentNode.offsetWidth;if(V<X){V+=X;}}return V;}function L(P,Q,R){if(P>Q){if(R){P=Math.min(P,R);}return P;}return Q;}function D(V,T,U){var P=this.getCanGrowShrinkNode(),R=(V===I)?"Height":"Width",Q=R.toLowerCase(),S=parseInt(P.style[Q],10);if(T&&T!==S&&!(T<S&&!!U)){S=T;P.style[Q]=S+"px";this.afterCanGrowShrink();}this["_fixed"+R]=S;}function A(Q,T,V){var W=H.call(this,T),X=B.call(this,T),U=Q.length,R;for(R=0;R<U;R++){var P=Q[R],S=G.call(this,P,T);if(!S){continue;}X=L(F.call(this,P,T,S),X,W);if(X===W){break;}}D.call(this,T,X,V);}function O(U,T,Q,S){var R=G.call(this,U,T);if(!R){return ;}var P=F.call(this,U,T,R,Q);D.call(this,T,L(P,B.call(this,T),H.call(this,T)),S);}mstrmojo._CanGrowOrShrink=mstrmojo.provide("mstrmojo._CanGrowOrShrink",{getCanGrowShrinkNode:function N(){return this.domNode;},performCanGrowCanShrink:function M(Q,R){var P=E.call(this,Q);if(P.v){A.call(this,Q,I,R);}if(P.h){A.call(this,Q,C,R);}},fixedSizeCanGrowShrink:function K(T,P,R,S){var Q=E.call(this,T&&[T]);P=parseInt(P,10);R=parseInt(R,10);if(Q.v&&!isNaN(P)){O.call(this,T,I,P,S);}if(Q.h&&!isNaN(R)){O.call(this,T,C,R,S);}},afterCanGrowShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof (W)=="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget.apply(this,[]);}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children;for(var Y=0,W=(X&&X.length)||0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);for(var X=0,W=(Y&&Y.length)||0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props;for(var Z in Y){var X=Y[Z],W=X.ease;if(typeof (W)=="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props;for(var a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}else{return parseInt(W*Y,10)/W;}}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}else{if(X===0){return W;}else{return W+Z*I(X,Y);}}},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}else{return W+Z*Math.sin((Math.PI/2)*X/Y);}},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}else{return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}else{if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}else{if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}else{return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;}}}},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}else{return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,E=false;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function(){var F=C.windowDim(),J=(C.isFF||C.isWK)?0:2;var G=F.w,I=F.h;if(E){var H=I;I=G;G=H;}return{w:Math.max(G,0)+"px",h:Math.max(I-J,0)+"px"};},simulateOrientationChange:function A(){E=!E;this.monitorWindow();},preBuildRendering:function B(){var G=true;if(this._super){G=this._super();}var H=this.getBrowserDimensions();if(!("browserResized" in this)||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return G;},destroy:function D(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function(F){var H=F.currentTarget,I=this.getBrowserDimensions(),G={w:(H?H.innerWidth+"px":I.w),h:(H?H.innerHeight+"px":I.h)};if(G.h===this.height&&G.w===this.width){return ;}if(!("browserResized" in this)||this.browserResized(G)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox={_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount==1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L!=null&&J in L){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners;for(var O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},scrollTo:function F(K){var J=this.scrollboxNode;if(J&&K){J.scrollLeft=K.x;J.scrollTop=K.y;}},scrollInterval:50,_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=(L)?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=(L)?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=mstrmojo.dom;function E(J,I){var G=[];if(J){for(var F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function D(L,F,N){var I=N.hWin,J=N.e,G=A.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=A.ctrlKey(I,J),O=A.shiftKey(I,J);if(K||O){A.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}},premouseup:function C(H,K,G){var F=G.hWin,J=G.e,L=A.ctrlKey(F,J),I=A.shiftKey(F,J);if(L||I){A.clearBrowserHighlights(F);}},onadd:function B(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=E(K,G);for(var J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function B(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){for(var H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);for(var J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var I=mstrmojo.dom;var L="mousedown";function P(S){var R=S[S.hotSlot||"domNode"];if(R){if(!S._closeCallback){var U=S.id,T=function(V){return function(X){var W=mstrmojo.all[U];if(W&&!W.ignoreHover){W["auto"+V](X,self);}};};S._uncloseCallback=T("Unclose");S._closeCallback=T("Close");}I.attachEvent(R,"mouseover",S._uncloseCallback);I.attachEvent(R,"mouseout",S._closeCallback);}}function C(S){if(S._closeCallback){var R=S[S.hotSlot||"domNode"];if(R){I.detachEvent(R,"mouseover",S._uncloseCallback);I.detachEvent(R,"mouseout",S._closeCallback);}}}function N(T,S){var R=T;while(R){if(R.open||R.openPopup){if(R.set){R.set("ignoreHover",S);}else{R.ignoreHover=S;}}R=R.opener||R.parent;}}function A(){var R=this._lockHoverCallback;if(R){I.detachEvent(document.body,L,R,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose={autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function B(){this._super();if(this.autoCloses){P(this);}this.oncloseOnClickChange();},onautoClosesChange:function D(){var R=(this.autoCloses)?P:C;R(this);},oncloseOnClickChange:function O(){if(!this.curtainNode){return ;}var T=this,S="click",R=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(R){S="touchstart";}I.attachEvent(T.curtainNode,S,function(){T.close();if(R){mstrmojo.touchManager.notify([]);}});},autoUnclose:function H(){var R=this._autoCloseTimer;if(R){self.clearTimeout(R);delete this._autoCloseTimer;}},autoClose:function F(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var R=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[R].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function M(R){A.call(this);this._super(R);},lockHover:function K(){N(this,true);if(!this._lockHoverCallback){var S=this.id,R=this._lockHoverCallback=function(T){mstrmojo.all[S]._unlockHoverCheck(T,self);};if((I.isIE7||I.isIE8)&&window.event&&(window.event.type==L)&&this.opener){this.opener._ignoreMousedown=true;}I.attachEvent(document.body,L,R,true);}},unlockHover:function E(){N(this,false);A.call(this);},_unlockHoverCheck:function J(T,R){var S=this.opener;if(S&&S._ignoreMousedown){delete S._ignoreMousedown;return ;}if(!I.contains(this.domNode,I.eventTarget(R,T),true,document.body)){this.close();}},open:function G(S,R){if(this.autoCloses){this.autoUnclose();}this._super(S,R);if(this.locksHover){this.lockHover();}},close:function Q(R){if(this.locksHover){this.unlockHover();}this._super(R);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B="mstrmojo-floating-toolbar-lightbox";var G="mstrmojo-floating-toolbar";var M="mstrmojo-floating-toolbar-cell";var I="mstrmojo-fixed-toolbar-lightbox";var A="mstrmojo-fixed-toolbar";var N="mstrmojo-fixed-toolbar-cell";var H=" hasToolBar";var E="mstrmojo-Button mstrmojo-InteractiveButton mstrmojo-oivmSprite ";var D="mstrmojo-Button-text";var L=27;mstrmojo._HasToolbar={_mixinName:"mstrmojo._HasToolbar",postBuildRendering:function C(){this._super();var O=this.getToolbarCfg();if(!O||this.defn.ttl){return ;}var S=this.containerNode;if(S){var Q=this._createToolbar(G,M);Q.className=B;S.className+=H;S.insertBefore(Q,S.firstChild);var P=this.domNode,R=mstrmojo.boxmodel.offset(P,this.parent&&this.parent.domNode);if(R.top<L){Q.style.top=(L-R.top)+"px";}}},_createToolbar:function F(V,Z){var S=this.getToolbarCfg(),Y=this,W=document,P=W.createElement("div"),U=W.createElement("table"),X=W.createElement("tr"),R=W.createElement("td");P.appendChild(U);U.className=V;R.className=Z;X.appendChild(R);U.appendChild(X);for(var T in S){var O=W.createElement("div");O.className=E+S[T].css[0];var Q=W.createElement("div");Q.className=D;Q.nodeValue="&nbsp;";Q.setAttribute("ix",T);Q.setAttribute("cix",0);O.appendChild(Q);R.appendChild(O);O.onclick=function(a){Y.onClick(a);};}return P;},renderToolbar:function K(Q){if(!this.getToolbarCfg()){return ;}var P=Q.firstChild,O=this._createToolbar(A,N);O.className=I;if(P){Q.insertBefore(O,P);}else{Q.appendChild(O);}},onClick:function J(U,P){var V=mstrmojo.dom,O=V.eventTarget(P,U),S=O.getAttribute("cix"),R=O.getAttribute("ix");var Q=this.toolbarCfg[R],T=Q.callback;if(T&&this[T]&&this[T]()){S=++S%Q.css.length;O.parentNode.className=E+Q.css[S];O.setAttribute("cix",S);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=(F)?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var B=mstrmojo.EnumReadystate;function D(F){return(F.getKey&&F.getKey())||F.k;}mstrmojo._IsDocController={_mixinName:"mstrmojo._IsDocController",_getXtabCallback:function(J){var F={},H=F[D(J)]=J.defn,I=this,G=I.model;return G.newCallback({submission:function(){if(H.set){H.set("readyState",B.WAITING);}},success:function(K){if(K.pukeys){F=G.getUnitDefinitions(K.pukeys);}G.partialUpdate(K.data,F);},failure:function(K){mstrmojo.alert(K.code+": "+K.message);},complete:function(){if(H.set){H.set("readyState",B.IDLE);}I.docRequestComplete();}});},_addNodeKeyToAction:function(F,G){G.nodeKey=D(F);return G;},onGridSelector:function(G,J){var F=this.model,I=F.getTargetInfoWin(J.tks);if(I&&I.length){for(var H=0;H<I.length;H++){F.showInfoWin(I[H],J.anchor,"h",true);}}J.sid=G.sid;F.slice(J);},onVisSelector:function(G,I){if(I.anchor){var F=this.model,H=F.getTargetInfoWin(I.tks);if(H&&H.length){F.showInfoWin(H[0],I.anchor,"h",true);}}if(G.xtabModel&&G.xtabModel.docModel&&G.xtabModel.docModel.slice){G.xtabModel.docModel.slice(I);}},isInRequest:function C(){var F=!!this._inProcess;if(!F){this._inProcess=true;}return F;},docRequestComplete:function E(){this._inProcess=false;},nudgeWidget:mstrmojo.emptyFn,getGroupByElements:function A(H){var L=[],K;while(H){var K=H.node&&H.node.data&&H.node.data.pbes;if(K){break;}H=H.parent;}if(K){var I=this.model.data.elems;for(var J=0,G=K.length;J<G;J++){var F=K[J];L.push(isNaN(F)?F:I&&I[F]);}}return L;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function A(E,H,D){var C=D.hWin,G=D.e,F=mstrmojo.dom.eventTarget(C,G),B=E.listMapper.findIndex(E,H,F);if(B>-1){E.toggleSelect(B);}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom,B=A.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function C(E,I,D){var G=E&&E.tree||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.DICFactory");var L=3,R=2,T=2,P=mstrmojo.css,A="********",O=mstrmojo.hash;var H=null;function F(X,W){if(X){var U=this.dicWidget;if(U&&U.setDirtyFlag){U.setDirtyFlag(X,W);}else{if(X.className!=="flag-container"){var V=document.createElement("div");V.className="flag-container";V.style.right="10px";V.innerHTML='<div class="dirty-cell"/>';W.insertBefore(V,X);}}}}mstrmojo._IsEditableTextfield={_mixinName:"mstrmojo._IsEditableTextfield",preBuildRendering:function Q(){if(!this.edb){var W=this.node.data,U=this.node.defn,V=W.dic||U.txi.dic,X=(this.rv==="")?this.value:this.rv;if(V.psw){this.v=A;X=this.rv="";}if(V.ipt===T){V.vls=this.vls||[];this.dk=V.k;}this.req=V.req;this.dt=V.dt;this.dicWidget=mstrmojo.DICFactory.createDIC({dic:V,owner:this,k:0,dv:this.value,value:X,openerType:R,popupTitle:U.n});if(this.shouldReplaceValueNode()){if(!H){H=O.clone(this.formatHandlers);}this.formatHandlers.domNode=["T","z-index","D","B","F","P","text-align","background-color","fx","white-space","overflow"];delete this.formatHandlers.valueNode;}}this.set("cssClass",this.edb?"":"editable-field");this._super();},shouldReplaceValueNode:function N(){return this.dicWidget.showByDefault||this.dicWidget.hasPreview;},postBuildRendering:function J(){this._super();if(this.edb){return ;}var U=this.dicWidget,W=this.valueNode.innerHTML;if(mstrmojo.string.isEmpty(W)){this.valueNode.innerHTML=W+"1";this.valueNode.style.height=this.valueNode.clientHeight+"px";this.valueNode.innerHTML=W;}if(U.showByDefault){U.render();}else{if(U.hasPreview){U.openerNode=this.domNode;U.renderPreview(this.value);}else{U.openerNode=this.valueNode;}mstrmojo.dom.attachEvent(U.openerNode,mstrApp.isMobile?mstrmojo.dom.TOUCHEND:"click",function(){U.showInPopup();});}if(this.shouldReplaceValueNode()){O.copy(H,this.formatHandlers);}this.registerTxWidget();this.addToTraversalList();if(this.mdf&&this.sci){var V=this.domNode;F.call(this,V.firstChild,V);}},getKeyContext:function D(){return{dt:this.dt||0,k:this.dk||undefined};},getUpdates:function C(){var V=this.getUpdatedValues()[0],U=V.k?('rw_control_key="'+V.k+'" element_id="'+this.vls[mstrmojo.array.find(this.vls,"v",V.v)].eid+'" '):"";return'<rwf rw_tree_type="'+this.tt+'" rw_node_key="'+this.fgk+'" rw_field_key="'+this.k+'" key="'+this.key+'" columns="'+this.cls+'" types="'+L+'" '+U+'value="'+mstrmojo.string.encodeXMLAttribute(String(V.v))+'" dt="'+V.dt+'" />';},updateValue:function K(U,X){if(this._super){this._super(U,X);}var Z=this.valueNode,a=this.domNode,V=this.dicWidget,W=X.v,Y=X.dv;if(this.rv!==W){if(this.req){P.removeClass(a,"required");}this.rv=W;this.v=Y;this.mdf=1;if(!V.showByDefault){if(V.hasPreview){V.renderPreview();}else{Z[Z.innerText!==undefined?"innerText":"textContent"]=this.psw?A:Y;}}if(this.req){P.removeClass(a,"required");}if(this.sci){F.call(this,a.firstChild,a);}}return false;},applyPasswordMask:function M(){this.psw=true;this.v=A;this.rv="";},getUpdateObject:function G(){var V={fieldKey:this.k,wid:this.wid,newValue:mstrmojo.string.encodeXMLAttribute(String(this.rv)),dataType:this.dt},U=this.getUpdatedValues()[0];if(U.k!==undefined){V.controlKey=U.k;V.elementId=this.vls[mstrmojo.array.find(this.vls,"v",U.v)].eid;}return{nodeKey:this.fgk,cells:[V],retrieveData:false,autoRefresh:false};},update:function I(U){if(this._super){this._super(U);}var W=U.data,V=U.defn;if(W.vls){this.vls=W.vls;}else{delete this.vls;}this.cell=U.data;this.value=W.v||"";this.rv=(W.rv===undefined)?this.value:W.rv;this.tca=W.tca||0;this.dt=W.dt;this.key=W.key||"";this.cls=W.cls||"";this.wid=W.wid;this.edb=W.edb;this.mdf=W.mdf;this.req=W.req;this.sci=V.txi.sci;this.tt=V.tt;this.fgk=V.fgk;},addToTraversalList:function S(){if(mstrmojo.DICConfig.isKeyNavigable(this.dicWidget.dic)){var U=this.parent.traversalList,V=this.domNode;if(!U){U=this.parent.traversalList=[];}U.push({x:V.offsetLeft,y:V.offsetTop,h:V.offsetHeight,refField:this});}},editNext:function E(){var Z=this.parent.traversalList,X,U,W,Y=0;if(!Z){return false;}if(!Z.isSorted){for(X=0,U=Z.length;X<U;X++){Y+=Z[X].h;}W=Y/U;Z.sort(function(h,f){var i=Math.floor(h.y/W),g=Math.floor(f.y/W);if(i<g){return -1;}if(i>g){return 1;}if(h.x<f.x){return -1;}if(h.x>f.x){return 1;}return(h.y<f.y)?-1:1;});Z.isSorted=true;}for(X=0,U=Z.length;X<U;X++){if(Z[X].refField.k===this.k){break;}}if(X<U){do{X++;if(X>=U){X%=U;}if(X===parseInt(this.k,10)){return false;}var V=Z[X].refField.dicWidget;if(V){if(!V.showByDefault){V.showInPopup();}else{V.focus();}return true;}}while(true);}},checkRequiredObjects:function B(){if(this.req&&!this.mdf&&!this.edb){P.addClass(this.domNode,"required");return false;}return true;}};}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string");var K=mstrmojo.locales,D=mstrmojo.string,M=window.mstrConfig,E=function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},F=function(){return mstrmojo.locales.number.DECIMALSEPARATOR;},I=M.units,L={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},C={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var N=96;String.prototype.reverse=function(){var P="";for(var O=this.length;O>0;--O){P+=this.charAt(O-1);}return P;};mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function G(O){var R=E(),Q=new RegExp("^(-)?[0-9]{1,3}(\\"+R+"[0-9]{3})*$"),P=new RegExp("^(-)?[0-9]+$");return(String(O).indexOf(R)&&Q.test(O))||P.test(O);},isNumeric:function A(R,S){var Q=F(),T=E(),P=new RegExp("^(-)?[0-9]{1,3}(\\"+T+"[0-9]{3})*(\\"+Q+"[0-9]+)?$"),O=new RegExp("^(-)?[0-9]*(\\"+Q+")?[0-9]+$");return(String(R).indexOf(T)&&P.test(R))||O.test(R);},parseInteger:function B(O,P){if(!this.isInt(O)){return Number.NaN;}return parseInt(String(O).replace(E(),""),P);},parseNumeric:function J(O){if(!this.isNumeric(O)){return Number.NaN;}return parseFloat(String(O).replace(E(),"").replace(F(),"."));},inNumericRange:function H(P,Q,O){P=this.parseNumeric(P);O=(O!=null)?this.parseNumeric(String(O)):Number.NaN;Q=(Q!=null)?this.parseNumeric(String(Q)):Number.NaN;if(O!=Number.NaN&&(P>O||isNaN(P))){return 1;}if(Q!=Number.NaN&&(P<Q||isNaN(P))){return -1;}return 0;},convertToUSUnits:function(R,Q,P){var O=R;Q=Q||I;switch(parseInt(Q,10)){case L.CM:O=parseFloat(this.toString(R))/2.54+"";break;case L.MM:O=parseFloat(this.toString(R))/25.4+"";break;case L.PT:O=parseFloat(this.toString(R))/72+"";break;case L.PC:O=parseFloat(this.toString(R))/6+"";break;case L.PX:O=parseFloat(this.toString(R))/N+"";break;}return P?O:this.toLocaleString(O);},convertToLocalUnits:function(R,Q,P){var O;Q=Q||I;switch(parseInt(Q,10)){case L.CM:O=(parseFloat(this.toString(R))*2.54).toFixed(4)+"";break;case L.MM:O=(parseFloat(this.toString(R))*25.4).toFixed(4)+"";break;case L.PT:O=(parseFloat(this.toString(R))*72).toFixed(4)+"";break;case L.PC:O=(parseFloat(this.toString(R))*6).toFixed(4)+"";break;case L.PX:O=(parseFloat(this.toString(R))*N)+"";break;default:O=parseFloat(this.toString(R)).toFixed(4)+"";}return P?O:this.toLocaleString(O);},convertUnits:function(P,Q,O){return this.convertToLocalUnits(Q,this.convertToUSUnits(P,O,true),true);},toLocaleString:function(O){return(O+"").replace(".",F());},toString:function(Q,O){if(O===true){var P=this.getThousandSepRegex();if(P){Q=String(Q).replace(P,"");}}return String(Q).replace(F(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(E().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(Q,P){var O=P;if(P=="."||P=="*"||P=="\\"){O="\\"+P;}return Q.reverse().replace(/(\d{3})/g,"$1"+P).reverse().replace(new RegExp("^(-)?"+O),"$1");},format:function(S,R,V,O){var U="",T=(R>0)?".":"",P=[];V=(V)?V:"";for(var Q=0;Q<R;Q++){P.push("0");}P=P.join("");switch(S){case C.PERCENT:U="0"+T+P+"%";break;case C.SCIENTIFIC:U="0"+T+P+"E+00";break;default:U='"'+V+'"#,##0'+T+P;}return this.formatByMask(U,O);},formatByMask:function(q,AF){var g=String(q).split(";"),Z="",Q=g[0],X="\u00A4";if(isNaN(AF)){return AF;}var w=Q.indexOf("E+"),W=Q.indexOf("%"),k=Q.match(/\".*\"/),l=Q.indexOf("?/?")>-1,o=(w!=-1)?C.SCIENTIFIC:((W!=-1)?C.PERCENT:((k)?C.CURR:l?C.FRACTION:C.FIXED)),f="",AC="",a=false,O=new String(AF),V=parseFloat(AF);if(k){f=Q.replace(/\".*\"/,k[0].substring(1,k[0].length-1)).replace(Q.replace(k[0],""),X);}if(V<0){O=O.substring(1,O.length);V=-V,a=true;if(g.length>1){var T=g[1].replace(/\[.*\]/,"");AC=T.replace(g[0],X);}}var U=function(j,i){return(i)?i.replace(X,j):"-"+j;};if(o==C.FRACTION){var AA,z,AE,b=10,n,h=0,s,AB,R,P=false,p;if(q.indexOf("# ")>-1){P=true;}for(AA=5;AA>0;AA--){p="/";for(z=0;z<AA;z++){p+="?";}if(q.indexOf(p)>-1){for(z=1;z<AA;z++){b*=10;}break;}}if(P){h=Number(Number(V).toFixed(0));V-=h;}AB=b/2;AE=-1;s=V*b;for(AA=b;AA>=2;AA--){R=(s*AA)/b;R=R-Math.floor(R);R=R*b;if(Math.abs(R-b)<R){R=Math.abs(R-b);}R=R/AA;if(R<AB){AB=R;AE=AA;}else{if((R==AB)&&(R==0)){AB=R;AE=AA;}}}n=Math.round(AE*s/b);for(AA=AE;AA>=2;AA--){if((n%AA==0)&&(AE%AA==0)){n=n/AA;AE=AE/AA;break;}}if(AE==b){AE=1;n=0;}if(n==0){AE=1;}if(n==AE){if(P){Z=""+(h+1);}else{Z="1";}}else{if(P&&h>0){Z=h+" "+n+"/"+AE;}else{Z=n+"/"+AE;}}}else{if(o==C.SCIENTIFIC){var AG=Math.floor(Math.log(V)/Math.LN10),x=V/Math.pow(10,AG),AH=Q.substring(0,w),Y=AH.indexOf(".");Z+=Number(x).toFixed((Y!=-1)?AH.length-Y-1:0);Z=((a)?U(Z,AC):Z)+"E"+((AG>0)?"+":"")+AG;}else{if(o==C.PERCENT){Q=Q.substring(0,Q.length-1);O=String(V*100);}var Y=Q.indexOf("."),S=0;if(Y!=-1){var AI=Q.substr(Y+1,Q.length).match(/\d+/);if(AI&&AI.length>0){S=AI[0].length;}}Z=String(Number(parseFloat(O).toFixed(S)));var AD=Z.split(".");var t=Q.match(/#.+##/);if(t!==null){AD[0]=this.addSeparators(AD[0],E());}Z=AD.join(F());if(o==C.CURR){Z=f.replace(X,Z);}if(o==C.PERCENT){Z+="%";}if(a){Z=U(Z,AC);}}}return Z;},generateUniqueID:function(O){var Q="0123456789ABCDEF".split(""),R=[];for(var P=0;P<O;P++){R[P]=Q[0|Math.random()*16];}return R.join("");},countOfDecimals:function(P,Q){var O=String(P);return O.length-(O.indexOf(Q!==undefined?Q:F())+1);}});})();(function(){mstrmojo.requiresCls("mstrmojo.locales");var V=function(){return mstrmojo.locales.datetime;},J=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},isDate:function W(Z,g,Y){var b=this.parseDate(Z,Y);var f=!!(b&&this.doesDateExist(b.month,b.day,b.year));if(g){if(f){var a=this.formatDateInfo(b,V().DATEOUTPUTFORMAT);if(Y){return{match:b.match,formatted:a};}else{return a;}}else{return null;}}else{return !!f;}},formatDateInfo:function P(b,g){if(!g){return"";}var Y=b.day,f=b.month,a=b.year;var Z=g.replace(/dd/g,this.formatInteger(Y,2)).replace(/d/g,Number(Y)).replace(/yyyy/g,Number(a)).replace(/yy/g,this.formatInteger(Number(a)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,V().MONTHNAME_FULL[Number(f)-1]).replace(/\~\~\~\~/g,V().MONTHNAME_SHORT[Number(f)-1]).replace(/\@\@/g,this.formatInteger(f,2)).replace(/\^/g,Number(b.month));return Z;},parseDate:function X(n,g,k){if(n==null){return false;}if(typeof (n)!="string"){n=String(n);}n=J.trim(n);var Y=this.CACHE.PARSEDATE[g?"CONTAINS":"EQUALS"],a=Y[n];if(a||(a===null)){return a;}var Z=null;var j;if(k){j=[k];}else{j=[].concat(V().DATEINPUTFORMATS);j.unshift(V().DATEOUTPUTFORMAT);}for(var b=0,f=j.length;b<f;b++){var h=this._buildRegExp4DateFormat(j[b]),l=h&&n.match(g?h.reContains:h.reEquals);if(l){Z={match:l[0],year:h.yearIndex&&this.fourDigitYear(l[h.yearIndex]),day:h.dayIndex&&parseInt(Number(l[h.dayIndex])),month:h.monthIndex&&this.numericMonth(l[h.monthIndex])};break;}}Y[n]=Z;return Z;},isTime:function H(Z,f,Y){var g=this.parseTime(Z,Y);var b=!!(g&&this.doesTimeExist(g.hour,g.min,g.sec));if(f){if(b){var a=this.formatTimeInfo(g,V().TIMEOUTPUTFORMAT);if(Y){return{match:g.match,formatted:a};}else{return a;}}else{return null;}}else{return !!b;}},parseTime:function I(o,g,l){if(o==null){return false;}if(typeof (o)!="string"){o=String(o);}o=J.trim(o);var Y=this.CACHE.PARSETIME[g?"CONTAINS":"EQUALS"],a=Y[o];if(a||(a===null)){return a;}var Z=null;var k;if(l){k=[l];}else{k=[].concat(V().TIMEINPUTFORMATS);k.unshift(V().TIMEOUTPUTFORMAT);}for(var b=0,f=k.length;b<f;b++){var j=this._buildRegExp4TimeFormat(k[b]),n=j&&o.match(g?j.reContains:j.reEquals);if(n){var h=j.ampmIndex&&n[j.ampmIndex];Z={match:n[0],hour:j.hourIndex&&this.capitalHour(n[j.hourIndex],h),min:j.minIndex&&parseInt(Number(n[j.minIndex])),sec:j.secIndex&&parseInt(Number(n[j.secIndex]))};break;}}Y[o]=Z;return Z;},formatTimeInfo:function Q(b,Z){if(!Z){return"";}var a=!(Number(b.hour)%12)?12:(Number(b.hour)%12),Y=Z.replace(/HH/g,this.formatInteger(b.hour,2)).replace(/H/g,Number(b.hour)).replace(/hh/g,this.formatInteger(a,2)).replace(/h/g,a).replace(/mm/g,this.formatInteger(Number(b.min)||0,2)).replace(/m/g,Number(b.min)||0).replace(/ss/g,this.formatInteger(Number(b.sec)||0,2)).replace(/s/g,Number(b.sec)||0).replace(/a/g,(Number(b.hour)<12)?V().AM_NAME:V().PM_NAME);return Y;},doesTimeExist:function F(g,Z,f){var b=parseInt(g);if(b>=0&&b<=23){var Y=parseInt(Z);if(Y>=0&&Y<=59){if(!f){return true;}var a=parseInt(f);if(a>=0&&a<=59){return true;}}}return false;},capitalHour:function C(Y,Z){Y=parseInt(Number(Y));if(Z&&(Z.match(V().AM_NAME)||Z.match(/AM/i))){return Y%12;}else{if(Z&&(Z.match(V().PM_NAME)||Z.match(/PM/i))){return 12+(Y%12);}else{return Y;}}},isDateAndOrTime:function T(Y,Z){return this.isDateTime(Y,Z)||this.isDate(Y,Z)||this.isTime(Y,Z);},isDateTime:function B(k,Y){var f=this.parseDateAndOrTime(k),i=f&&f.date,b=f&&f.time,h=!!i&&!!b&&this.doesDateExist(i.month,i.day,i.year)&&this.doesTimeExist(b.hour,b.min,b.sec);if(Y){if(h){var Z=this.formatDateInfo(i,V().DATEOUTPUTFORMAT),a=this.formatTimeInfo(b,V().TIMEOUTPUTFORMAT),j=k.indexOf(i.match),g=k.indexOf(b.match);return(g<j)?a+" "+Z:Z+" "+a;}else{return null;}}else{return !!h;}},parseDateAndOrTime:function O(Z,Y,g){var a=this.parseDate(Z,true,Y);var b=J.trim((a&&a.match)?Z.replace(a.match,""):Z),f=this.parseTime(b,false,g);if(!a&&!f){return null;}else{return{date:a,time:f};}},inDateTimeRange:function N(a,f,i){var Z=this.parseDateAndOrTime(a),g=Z&&Z.date,j=Z&&Z.time;if(!g&&!j){return 0;}if(f!=null){var b=this.parseDateAndOrTime(f);if(g&&b&&b.date){var k=this.compareDate(g,b.date);if(k<0){return -1;}else{if(k==0){if(j&&b.time&&(this.compareTime(j,b.time)<0)){return -1;}}}}}if(i!=null){var Y=this.parseDateAndOrTime(i);if(g&&Y&&Y.date){var h=this.compareDate(g,Y.date);if(h>0){return 1;}else{if(h==0){if(j&&Y.time&&(this.compareTime(j,Y.time)>0)){return 1;}}}}}return 0;},compareDate:function A(a,Y){if(a==Y){return 0;}var b=typeof (a)=="string"?this.parseDate(a):a,Z=typeof (Y)=="string"?this.parseDate(Y):Y;if(!b){return -1;}if(!Z){return 1;}return(b.year-Z.year)||(b.month-Z.month)||(b.day-Z.day)||0;},compareTime:function K(Z,Y){if(Z==Y){return 0;}var b=typeof (Z)=="string"?this.parseTime(Z):Z,a=typeof (Y)=="string"?this.parseTime(Y):Y;if(!b){return -1;}if(!a){return 1;}return(b.hour-a.hour)||(b.min-a.min)||(b.sec-a.sec)||0;},compareDateTime:function S(Z,Y){return this.compareDate(Z,Y)||this.compareTime(Z,Y);},compareDateAndOrTime:function D(i,g){if(i==g){return 0;}var Z=typeof (i)=="string"?this.parseDateAndOrTime(i):i,Y=typeof (g)=="string"?this.parseDateAndOrTime(g):g;if(!Z){return -1;}if(!Y){return 1;}var h=Z.date,f=Y.date,b=Z.time,a=Y.time;return this.compareDate(h,f)||this.compareTime(b,a);},_buildRegExp4DateFormat:function M(a){if(!a){return null;}var f=this.REGEXPS.DATES[a];if(!f){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=V().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=V().MONTHNAME_SHORT.join("|");}f=this.REGEXPS.DATES[a]={};f.formatStr=a;var Z=f.reStr=a.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");f.reEquals=new RegExp("^"+Z+"$");f.reContains=new RegExp("^"+Z+"\\b");var g=[{key:"monthIndex",index:a.indexOf("M")},{key:"dayIndex",index:a.indexOf("d")},{key:"yearIndex",index:a.indexOf("y")}];g.sort(function(i,h){return i.index-h.index;});var Y=1;for(var b=0;b<3;b++){f[g[b].key]=g[b].index>-1?Y++:null;}}return f;},_buildRegExp4TimeFormat:function E(b){if(!b){return null;}var g=this.REGEXPS.TIMES[b];if(!g){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[V().AM_NAME,V().PM_NAME,String(V().AM_NAME).toLowerCase(),String(V().PM_NAME).toLowerCase()].join("|");}g=this.REGEXPS.TIMES[b]={};g.formatStr=b;var a=b.replace(/\'\'/g,'"');var h=a.match(/\'(.+?)\'/g);a.replace(/\'(.+?)\'/g,"*");a=a.replace(/([^H|h|m|s|z|Z|a|\s])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/gi,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");for(var f=1,Y=h&&h.length||0;f<Y;f++){a=a.replace(/\*/,h[f]);}a=a.replace(/\"/g,"'");g.reEquals=new RegExp("^"+a+"$");g.reContains=new RegExp(a);var j=[{key:"hourIndex",index:b.search(/h|H/)},{key:"minIndex",index:b.indexOf("m")},{key:"secIndex",index:b.indexOf("s")},{key:"ampmIndex",index:b.indexOf("a")},{key:"zoneIndex",index:b.search(/z|Z/)}];j.sort(function(k,i){return k.index-i.index;});var Z=1;for(var f=0;f<5;f++){g[j[f].key]=j[f].index>-1?Z++:null;}}return g;},doesDateExist:function L(b,Y,Z){var a=new Date(Z,b-1,Y);return Z==a.getFullYear()&&b==a.getMonth()+1&&Y==a.getDate();},fourDigitYear:function R(Z){Z=parseInt(Number(Z));if(!isNaN(Z)){var Y=(V().TWODIGITYEARSTART%100)||0;if(Z>=0&&Z<=Y){Z=2000+Z;}else{if(Z>Y&&Z<100){Z=1900+Z;}}}return Z;},numericMonth:function U(f){var b=parseInt(Number(f)),a=mstrmojo.array;if(!isNaN(b)){return b;}var Y=f&&f.length||0,Z=-1;if(Y){if(Y<=3){Z=a.indexOf(V().MONTHNAME_SHORT,f);}if(Z==-1){Z=a.indexOf(V().MONTHNAME_FULL,f);}}return Z+1;},formatInteger:function G(a,Z){var g=String(a),f=Math.max(Z-g.length,0);if(f>0){var Y=[g];for(var b=1;b<=f;b++){Y.push("0");}g=Y.reverse().join("");}return g;},getFirstDateOfMonth:function(Z,Y){return new Date(Z,Y-1,1);},getDateObject:function(g,Y,f,a,b,Z){g=g||0;Y=Y||1;f=f||1;a=a||0;b=b||0;Z=Z||0;return new Date(g,Y-1,f,a,b,Z);},getDateFromDateInfo:function(Y){return this.getDateObject(Y.date&&Y.date.year,Y.date&&Y.date.month,Y.date&&Y.date.day,Y.time&&Y.time.hour,Y.time&&Y.time.min,Y.time&&Y.time.sec);},getDateJson:function(Y){return{year:Y.getFullYear(),month:Y.getMonth()+1,day:Y.getDate(),hour:Y.getHours(),min:Y.getMinutes(),sec:Y.getSeconds()};},isLeapYear:function(Y){return !(Y%400)||(!(Y%4)&&!!(Y%100));},getDaysOfMonth:function(a,Y){var Z=[31,28,31,30,31,30,31,31,30,31,30,31];if(Y==2&&this.isLeapYear(a)){return 29;}return Z[Y-1];},getPreMonth:function(Z,Y){if(Y===1){return{y:Z-1,m:12};}return{y:Z,m:Y-1};},getNextMonth:function(Z,Y){if(Y===12){return{y:Z+1,m:1};}return{y:Z,m:Y+1};}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.locales");var X=mstrmojo.array,M=mstrmojo.meta.TP,L=mstrmojo.hash,D={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1},B={};for(var R in D){B[D[R]]=true;}var V={};V[D.AQ]="a";V[D.AL]="a";V[D.AC]="a";V[D.AE]="a";V[D.MQ]="m";V[D.MC]="m";V[D.F]="f";V[D.R]="r";V[D.XML]="p";var G={};G[D.MQ]=["not","m","fn","fnt","cs","dmy"];G[D.MC]=["not","m","fn","fnt","m2","m3","p","dmy"];G[D.AE]=["not","a","fn","es","a2","fm2","p"];G[D.AQ]=["not","a","fm","fn","cs"];G[D.AL]=["not","a","fm","fn","cs"];G[D.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];G[D.R]=["not","r"];G[D.F]=["not","f"];G[D.XML]=["not","n","p"];var J={};J[D.MQ]="METRIC_FNS";J[D.MC]="METRIC_FNS";J[D.AQ]="FORM_FNS";J[D.AL]="FORM_FNS";J[D.AC]="FORM_FNS";J[D.AE]="ELEM_FNS";var K={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43},W={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776},P={a:K.ATTR,a2:K.ATTR,m:K.METRIC,m2:K.METRIC,r:K.REPORT,f:K.FILTER,p:K.PROMPT};var Q={};Q[D.MQ]=K.METRIC;Q[D.MC]=K.METRIC;Q[D.AQ]=K.ATTR;Q[D.AL]=K.ATTR;Q[D.AC]=K.ATTR;Q[D.AE]=K.ATTR;Q[D.F]=K.FILTER;Q[D.R]=K.REPORT;var F=function(Y){var H=Y.length,a={};for(var Z=0;Z<H;Z++){var b=Y[Z];a[b.did]=b.n;}return a;},C=function(Z){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){Y.t=Y.tp;}}return Z;},S=function(Z,b){var H=Z.length;for(var a=0;a<H;a++){var Y=Z[a];if("tp" in Y){if(b){Y.t=b;}else{delete Y.t;}}}return Z;},U=function(Y,a){if(!a){a=[];}a.length=0;for(var Z=0,H=Y.length;Z<H;Z++){a[Z]=Y[Z];}return a;},I={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};METRIC_PROHIBITED={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:D,ETs:B,ET2TGT:V,ET2COND:G,ET2TP:Q,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:K,STP:W,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":W.PROMPT,1:W.PROMPT_LONG,2:W.PROMPT_LONG,3:W.PROMPT_LONG,4:W.PROMPT_DOUBLE,5:W.PROMPT_DOUBLE,6:W.PROMPT_DOUBLE,7:W.PROMPT_DOUBLE,8:W.PROMPT_STRING,9:W.PROMPT_STRING,10:W.PROMPT_STRING,14:W.PROMPT_DATE,15:W.PROMPT_DATE,16:W.PROMPT_DATE,21:W.PROMPT_LONG,22:W.PROMPT_LONG,23:W.PROMPT_STRING,24:W.PROMPT_BOOLEAN,30:W.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0},fnCstCount:function A(Y,H){var Z=this.FN;switch(Y){case Z.BETWEEN:case Z.NOT_BETWEEN:return 2;case Z.IS_NULL:case Z.IS_NOT_NULL:return 0;default:return 1;}},fn_List:function O(Y,H){var Z=this.FN;return Y==Z.IN_LIST||Y==Z.NOT_IN_LIST;},fn_AC_MC:function T(Y,H){var Z=this.FN;return(Y==Z.EQUAL)||(Y==Z.NOT_EQUAL)||(Y==Z.GREATER)||(Y==Z.LESS)||(Y==Z.GREATER_EQUAL)||(Y==Z.LESS_EQUAL);},fnName:function N(f,b,Y,a){var H=this[J[f]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[a]]||H["*"];}var Z=X.find(H,"did",(Y||1)+this.FN_SEP+b);if(Z>-1){return H[Z].n;}return"";},findTargets:function E(l,a,o){if(!o){o={};}if(l){for(var j in P){var z=l[j];if(z){if(!z[M]){z[M]=P[j];}o[z[a]]=z;}}if(l.dmy){var f=this.TP.ATTR,p=this.DMY_TP.ATTR,Z=l.dmy.uts;for(var x=0,Y=(Z&&Z.length)||0;x<Y;x++){var g=Z[x];if(g&&g.utp===p){var b=g.utgt;if(!b.t){b.t=f;}o[b[a]]=b;}}}var H=l.nds,n,s;for(n=0,s=(H&&H.length)||0;n<s;n++){this.findTargets(H[n],a,o);}var q=l.cs,w=q&&q.length;if(w){for(n=0;n<w;n++){this.findTargets(q[n],a,o);}}}return o;},onLocaleUpdated:function(){var Y=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=L.copy(F(Y.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=U(S(Y.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":S(X.filter(Y.Metric,function(Z){return Z.did&&(X.find(METRIC_PROHIBITED["0"],"did",Z.did)<0);}))};H.FORM_FNS={0:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0);})),1:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["1"],"did",Z.did)<0);})),2:S(X.filter(Y.Attribute,function(Z){return Z.did&&(X.find(I["0"],"did",Z.did)<0)&&(X.find(I["1"],"did",Z.did)<0);}))};H.DIMTYLEVELS=U(S(Y.DimtyLevels),H.DIMTYLEVELS);}});mstrmojo.expr.onLocaleUpdated();})();(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){E.response(G,true,J);},failure:function(J){E.response(G,false,{code:J.getResponseHeader("X-MSTR-TaskErrorCode"),message:J.getResponseHeader("X-MSTR-TaskFailureMsg")});},complete:function(){delete D[G];}},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;if(this.preHandleEvent){this.preHandleEvent(H);}var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){if(this.postHandleEvent){this.postHandleEvent(H);}C.publish(this.id,M,H);}return H;},attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var H=mstrmojo.registry,C=mstrmojo.array,K=mstrmojo.publisher;function M(O,P){if(P){P.parent=O;return H.ref(P);}return null;}function J(O,P){if(P&&P.alias!=null){O[P.alias]=P;}}function D(P,Q){var O=Q.alias;if(Q.parent===P){delete Q.parent;}if((O!=null)&&(P[O]===Q)){delete P[O];}}function E(S,P){var O=P&&P.length,R,Q;if(O){R=[];for(Q=0;Q<O;Q++){var T=M(S,P[Q]);if(!T){continue;}R.push(T);J(S,T);}}return R;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,initChildren:function I(){var O="children",P=this[O];if(!P){return ;}this[O]=null;this._set_children(O,P,true);if(this.postCreateChildren){this.postCreateChildren();}},_set_children:function A(R,P,O){var Q=this.children;if(P!==Q){if(Q){this.removeChildren(null,O);}this.addChildren(P,0,O);}return false;},destroyChildren:function N(R){var Q=this.children,O=(Q&&Q.length)||0,P;if(O){for(P=O-1;P>-1;P--){var S=Q[P];if(S&&S.destroy){S.destroy(R);if(!R){D(this,S);}}}if(!R){Q.length=0;}}},invalidateChildren:function F(){mstrmojo.array.forEach(this.children,function(O){O.invalidate();});},invalidate:function L(){this.invalidateChildren();},addChildren:function G(T,P,Q){if(!T){return T;}var S=T.constructor===Array,O=E(this,S?T:[T]);if(O&&O.length){var R=this.children||[];if(P==null){P=R.length;}this.children=C.insert(R,P,O);if(!Q&&(this.onaddChild||K.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:O,index:P});}}return S?O:(O&&O[0]);},removeChildren:function B(U,Q){var S=this.children,T=U?[U]:(this.children||[]).concat(),P=T.length,O=-1,R;if(P){for(R=P-1;R>-1;R--){D(this,T[R]);}if(U){O=C.removeItem(S,U);}else{if(S){S.length=0;O=0;}}if(!Q&&(this.onremoveChild||K.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:T,index:O});}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var E=mstrmojo.hash,H=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=E.clone(I);O.data=M;O.parent=N;return H.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length);for(var N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L;for(var O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}for(var M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array");var H=1,B=2;function J(M,L){return D(M,L)&&M.o===L.o;}function D(M,L){return M&&L&&M.ui===L.ui&&M.axis===L.axis&&M.mix===L.mix;}function A(P,M,N){var O=N.getCellTitleId(M),L=N.getCellUnitIndex(M);N.selections[O]=N.selections[O]||{};N.selections[O][L]=N.selections[O][L]||[];N.selections[O][L].push(P);C(P);}function K(M){var Q=M.selections;for(var P in Q){for(var O in Q[P]){for(var N=0,L=Q[P][O].length;N<L;N++){G(Q[P][O][N]);}}}M.selections={};}function C(L){mstrmojo.css.setOpacity(L,50);}function G(L){mstrmojo.css.setOpacity(L,100);}function F(N,O){if(N.mix===undefined){var R=O.gridData.gts[N.axis===H?"row":"col"],M=R[N.tui||N.ui],Q=0;for(var P=0,L=R.length;P<L;P++){if(R[P].id===M.id){Q++;}}return Q;}return 0;}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelect:function E(M,U){var S=this.getCellForNode(M),b=M.parentNode;if(U){var R=this.getCellTitleId(S),X=this.getCellUnitIndex(S);selectedTitle=this.selections[R];selectedUnit=selectedTitle&&selectedTitle[X];if(selectedUnit){for(var T=0,V=selectedUnit.length;T<V;T++){G(selectedUnit[T]);}delete selectedTitle[X];return ;}}var Q=F(S,this);if(S.axis===H){for(var T=0,L=0,V=b.cells.length;T<V&&L<Q;T++){var O=b.cells[T],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;}}}else{if(S.axis===B){var Z=mstrmojo.dom.findAncestorByName(M,"table",false),a=Z.rows;for(var T=0,L=0,V=a.length;T<V&&L<Q;T++){var Y=a[T].cells;for(var P=0,N=Y.length;P<N;P++){var O=Y[P],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;break;}}}}else{A(M,S,this);}}},rangeSelect:function I(g,h){var a=this.getCellForNode(g),L=this.getCellForNode(h);if(D(a,L)){if(a.o>L.o||a._ei>L._ei){var n=g;g=h;a=this.getCellForNode(g);h=n;L=this.getCellForNode(h);}var W=F(a,this),M=a.axis,k=mstrmojo.dom.findAncestorByName(g,"table",false),T=k.rows,b=g.parentNode,o=b.rowIndex,V=b.cells,Y=h.parentNode.rowIndex;if(M===H){for(var Z=o;Z<=Y;Z++){var N=T[Z].cells,O=false;for(var X=0,f=N.length,P=0;X<f&&P<W;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);P++;}}}}else{if(M===B){for(var Z=0,f=T.length,l=0;Z<f&&l<W;Z++){var N=T[Z].cells,S=false;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(J(U,a)){S=true;}if(S){A(R,U,this);}if(J(U,L)){break;}}if(S){l++;}}}else{if(o==Y){for(var Z=g.cellIndex,f=h.cellIndex;Z<=f;Z++){var R=V[Z],U=this.getCellForNode(R);A(R,U,this);}}else{for(var Z=o,f=Y;Z<=f;Z++){var N=T[Z].cells;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);break;}}}}}}}},doSelection:function(S,R,P){var T=mstrmojo.dom,L=T.ctrlKey(R,S),M=T.shiftKey(R,S);if(!L){K(this);}var Q=this.getCellForNode(P);var N=Q&&(Q.mix===undefined&&Q.o!==undefined),O=Q&&(Q.mix!==undefined&&(Q._lp||Q._tp));if(N||O){if(M){this.rangeSelect(this.lastSelectedTD,P);}else{this.singleSelect(P,L);this.lastSelectedTD=P;}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,J="mstrmojo-itemwrap",I="&nbsp;",S=mstrmojo.array;function F(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}else{if(X===V){break;}}Y=X;X=Y.parentNode;}}return null;}function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=S.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;}function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function L(o,Z,n,t,W,f,x,s){if(!Z){return{start:0,end:0};}var j=this.wrapperNodes(o),l=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,k=n+t,g=j[0].offsetTop,b;for(var q=1;q<=Y;q++){b=j[l].offsetTop-g+s;if(b<n){X=l;}else{if(b>k){V=l;}}var a=Math.round(Z/Math.pow(2,q+1));l+=(b>n)?-a:a;l=Math.min(Math.max(0,l),Z-1);}return{start:X,end:V};},findWrapper:function K(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function E(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function R(f,V,X,b,W){var Y=this._nd2iw(f,V,X),g,a,i;if(Y){a=this._iw2idx(f,V,Y);g=a;i=this.itemOffsetTop(f,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+i+Z/2){g++;i+=Z;}}else{return f.dropCuePos;}return{left:0,top:i,idx:g,idxActual:a};},getWrapperCss:function(V){return J;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function O(h,b,n,g,a,o){var p=this.itemWrapperPrefix(n),l=this.itemWrapperSuffix,Z=p+this.itemWrapperPrefill+l,Y=[this.markupPrefix],W=1,V=n.selectedIndices||{},s=function q(k,j){for(var t=k;t<j;t++){Y[W++]=p;var w=b.build(n,g,h[t],t);if(V[t]){w=w.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=w;Y[W++]=l;}};var f=(h&&h.length)||0;a=a&&b?Math.min(a,f):0;if(a){s(0,a);}o=o&&b?Math.min(o,f-a):0;var i=f-o;for(var X=a;X<i;X++){Y[W++]=Z;}if(o){s(i,f);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,l,g,s,j,W,b,q){var h=(l&&l.length)||0,o=this.wrapperNodes(X),t=j.itemStatus,V=mstrmojo.css,Z=s.selectedIndices||{};for(var f=W,n=Math.min(b+1,h),a=0;f<n;f++){if(t[f]!==A){o[f].innerHTML=g.build(s,j,l[f],f);if(Z[f]){var Y=o[f].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===q){break;}}}return a;},onadd:function N(g,V,Z,h){if(V&&h){var a=h.value.length,b=this.wrapperNodes(V),f=b[h.index],Y=this.getWrapperCss(g);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=I;if(f){this.wrapperParentNode(V).insertBefore(W,f);}else{this.wrapperParentNode(V).appendChild(W);}}T(g,this);}},onremove:function P(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var f=X.value.length;for(var Z=X.index+f-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function Q(l,X,f,o){if(X&&o){var g=this.wrapperNodes(X);if(g){var W=mstrmojo.css,q=f.itemStatus,n;for(var b=0,V=o.removed,k=V&&V.length;b<k;b++){n=V[b];if(q[n]){W.removeClass(g[n].firstChild,["selected"]);}}for(var Z=0,h=o.added,Y=h&&h.length;Z<Y;Z++){n=h[Z];if(q[n]){W.addClass(g[n].firstChild,["selected"]);}}}}},_nd2iw:F,_iw2idx:M,toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,g=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=g.clientHeight,f=g.scrollTop,Y=f;if(V<f){Y=V;}else{if(f+W-b<V){Y=Math.min(V,V-W+b);}}g.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,B=mstrmojo.css,D="selected";function G(I,J,K,H,M){var L=M.listHooks[I];if(L&&L.call(M,J,K,H)){return ;}B[((I==="select")?"add":"remove")+"Class"](J,D);}function E(K,J,I){var L=this[K],H=(L)?L.split(J):[];H=H.concat(I.split(J));this[K]=H.join(J);return H.length-1;}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},getItemMarkup:function(I,H){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}">{@n}</{@tag}>';},getItemProps:function C(J,H){var I=!!this.selectedIndices[H];return{tag:"div",sel:I,cls:(I)?D:"",n:J.n||"",style:"",idx:H,addCls:function(K){E.call(this,"cls"," ",K);},addStyle:function(K){E.call(this,"style",";",K);}};},itemRenderer:{render:function(I,H,J){I._renderIdx=H;return mstrmojo.string.apply(J.getItemMarkup(I,H),J.getItemProps(I,H));},select:function(I,J,H,K){G("select",I,J,H,K);},unselect:function(I,J,H,K){G("unselect",I,J,H,K);}},onclick:function A(J){try{var M=J.target||F.eventTarget(J.hWin,J.e),L=F.findAncestorByAttr(M,"idx",true,this.domNode),I=L&&parseInt(L.value,10);if(I!==null&&!isNaN(I)){if(!this.multiSelect){this.singleSelect(I);}else{var H=(this.selectedIndices[I])?"remove":"add";this[H+"Select"](I);}}}catch(K){mstrApp.onerror(K);}}});mstrmojo._IsList.SELECTED_CLS=D;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"]};J.RW=["z-index"].concat(J.T.concat(J.D));var E=mstrmojo.dom;function D(N,P,M){var O=N[P]||[];O.push(M);N[P]=O;}mstrmojo._Formattable={_mixinName:"mstrmojo._Formattable",formatHandlers:null,getCacheKey:function B(M){return"csscache"+(M.thresholdId||"");},update:function C(M){this.invisible=!!(M&&M.data&&M.data.invisible);if(this._super){this._super(M);}},preBuildRendering:function K(){if(this._super){this._super();}var M=this.defn;if(!M){M=this.defn={};}var Q=this.getCacheKey(this),Z=M[Q];if(!Z){Z=M[Q]={};var Y=this.getFormats();if(Y){var U=this.formatHandlers;for(var P in U){var i=U[P];var S=i.src?Y[i.src]:Y;if(!S){return ;}var X=[];var W=-1;var R=P+"CssText";var O=i.props||i;if(!O){continue;}for(var j=O.length-1;j>=0;j--){var a=O[j];var h=J[a]||[a];for(var V=h.length-1;V>=0;V--){a=h[V];if(a in S){if(a==="fx"){var g=S[a],N={};if("gd" in g){this.formatGradient(g.gd,N);}if("rt" in g){if(g.rt==1||g.rt==3){this.formatTextRotation(g.rt,N);}}if("ds" in g){this.formatDropShadow(g,N);}for(var T in N){X[++W]=T+":"+N[T].join(" ");}}else{X[++W]=a+":"+S[a];}}}}if(this.invisible){X.push("visibility:hidden");}this[R]=Z[R]=X.join(";")+";";}}}else{for(var b in Z){this[b]=Z[b];}}return true;},formatGradient:function G(M,O){var N=mstrmojo.css.buildGradient(M.t,M.sc,M.ec);if(N){D(O,N.n,N.v);}},formatDropShadow:function L(P,N){if(E.supports(E.cssFeatures.DROP_SHADOW)){var O=P.ds;if(E.isDXIE){D(N,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+O+",OffY="+O+")");}else{var M=[O,O];if(P.rt==1||P.rt==3){M[((P.rt===1)?1:0)]=-O;}D(N,(E.isWK?"-webkit-":"")+"box-shadow",M.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function A(N,M){if(E.supports(E.cssFeatures.TEXT_ROTATION)){if(E.isDXIE){D(M,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+N+")");}else{var O=(N===1)?90:-90;D(M,E.CSS3_PREFIX+"transform-origin","top left");D(M,E.CSS3_PREFIX+"transform","rotate("+O+"deg)");}}},getFormats:function I(){if(!this.fmts){this.fmts=this.formatResolver.getFormat(this.defn,this.thresholdId);}return this.fmts;},clearCache:function F(){delete this.defn[this.getCacheKey(this)];},unrender:function H(M){if(this.thresholdId){this.fmts=null;}this._super(M);}};mstrmojo._Formattable.getBorderWidths=function(N){var P=N.getFormats(),M=("border" in P)?P.border.match(/(\d*|\d*\.\d*)pt/)[0]:P["border-width"],O=N.model.docModel?N.model.docModel.dpi:N.model.dpi;return mstrmojo.css.getBorderWidths(M,O);};})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");mstrmojo._HasDocLink=mstrmojo.provide("mstrmojo._HasDocLink",{_mixinName:"mstrmojo._HasDocLink",url:"",target:"",linkEnabled:true,ifw:"",update:function C(D){var E=D.defn;this.url=D.data.url||E.url;if(E.target){this.target=E.target;}if(E.ifw){this.ifw=E.ifw;}this._super(D);},postBuildRendering:function A(){if(this.url||this.ifw){mstrmojo.css.addClass(this.domNode,"hasLink");}var E=this.controller.view,D=E&&E.getCurrentLayout();if(D&&D.addLinkInfo){D.addLinkInfo(this.id,{url:this.url,target:this.target,src:this});}return this._super();},setLinkEnabled:function B(H){this.linkEnabled=H;var G=this.domNode;if(!G){return ;}var I=G.childNodes,F=I[I.length-1],D=this.id+"_mask",E=(F.id===D)?F:null;if(H){if(E){G.removeChild(E);delete this._mask;}}else{if(!E){E=document.createElement("div");E.className="mstrmojo-DocLinkMask";E.id=D;E.innerHTML="&nbsp;";G.appendChild(E);}}},onclick:function(){if(this.linkEnabled){var E=this.drillLinkItems,D=E&&E[0];url=this.url||(D&&D.url);if(this.ifw){this.model.showInfoWin(this.ifw,(this.getAnchor&&this.getAnchor())||this.domNode,"v",true);}else{if(url){this.model.executeLink(url,this.target,this);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var G=mstrmojo.hash,A=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",init:function E(H){this.disposables=[];G.copy(H,this);if(this.postApplyProperties){this.postApplyProperties();}A.add(this);if(this.postCreate){this.postCreate();}},destroy:function B(H){this._super(H);F.forEach(this.disposables,function(I){if(I.destroy){I.destroy(H);}else{if(I.clear){I.clear();}}});this.disposables=[];A.remove(this);}});var C=mstrmojo.Obj;C.free=function D(H){if(H instanceof C){H.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9\_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')},VALIDATOR:{DEMO:function L(f){var b=parseInt(f,10),g=mstrmojo.validation.STATUSCODE;if(b===0||b===1||b>10){return{code:g.VALID};}return{code:g.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function H(b){var g=this.dtp,f=String(b).replace(/[^\d]/g,"");if(f.length<10){return{code:E.INVALID,msg:mstrmojo.desc(9203)};}if(!J.REGEXP.PHONE_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9204)};}return{code:E.VALID};},VALIDATE_ZIPCODE:function G(b){var g="",f=this.dtp;if(!J.REGEXP.US_ZIP.test(b)){if(J.isNumeric(f)||J.isInt(f)){g=mstrmojo.desc(9208);}else{if(J.isString(f)){g=mstrmojo.desc(9206);}}return{code:E.INVALID,msg:g};}return{code:E.VALID};},VALIDATE_EMAIL:function P(b){var f=b.indexOf("@");if(f===-1){return{code:E.INVALID,msg:mstrmojo.desc(9197)};}if(b.substring(f).indexOf(".")===-1){return{code:E.INVALID,msg:mstrmojo.desc(9198)};}return J.REGEXP.EMAIL_ADDRESS.test(b)?{code:E.VALID}:{code:E.INVALID,msg:mstrmojo.desc(9207)};},VALIDATE_SSN:function O(b){var g=this.dtp,f;if(J.isNumeric(g)||J.isInt(g)){f=String(b).replace(/[^\d]/g,"");if(f.length!=9){return{code:E.INVALID,msg:mstrmojo.desc(9209)};}}if(!J.REGEXP.SOCIAL_SECURITY_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9210)};}return{code:E.VALID};}},isInt:function(b){return B[b]==1;},isNumeric:function(b){return B[b]==2||B[b]==5;},isString:function(b){return B[b]==3;}};var V=window.mstrConfig,I=V.listSep,W=mstrmojo.expr,K=W.DTP,J=mstrmojo.validation,F=J.TRIGGER,E=J.STATUSCODE,X=mstrmojo.css,Q=mstrmojo.num,N=mstrmojo.string,a=mstrmojo.date,B={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,21:2,22:2,23:3,24:4,25:3,30:5};function D(l,n){var i=l.dtp,k=l.constraints,p=k.allowedFormatChars?k.allowedFormatChars:"",h=(B[i]==1),b=(B[i]==2),f=(B[i]==6),o=mstrmojo.locales.number.THOUSANDSEPARATOR,g=mstrmojo.locales.number.DECIMALSEPARATOR,j;if(h){if(!l._intRegExp){p+="0-9-"+(l.isList?I:"")+o;l._intRegExp=new RegExp("[^"+p+"]");}j=l._intRegExp;}if(b){if(!l._numericRegExp){p+="0-9-"+(l.isList?I:"")+g+o;l._numericRegExp=new RegExp("[^"+p+"]");}j=l._numericRegExp;}if(f){}return !!j&&j.test(n);}function Y(l,o){var i=l.dtp,k=l.constraints,h=(B[i]==1),b=(B[i]==2),f=(B[i]==6),g=k.min,n=k.max,j;if(g==undefined&&n==undefined){return false;}if(h||b){return Q.inNumericRange(o,g,n)!==0;}if(f){return a.inDateTimeRange(o,g,n)!==0;}return false;}function Z(f,b){return !Q.isNumeric(b);}function A(h,f){var g=(h.dtp===K.DATE),b=(h.dtp===K.TIME);return(g?!a.isDate(f):(b?!a.isTime(f):!a.isDateAndOrTime(f)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:K.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function S(b){this._super(b);if(!this.constraints){this.constraints={};}var f=this.constraints;if(!("trigger" in f)){f.trigger=F.NONE;}},_set_value:function(j,g){var h=this.value,f=(h!==g);if(f){this.value=g;var i=this.constraints.trigger,b=(i&F.VALUESET)>0;if(b){this.validate(g);}}return f;},validate:function M(){var g=(this.value!==null&&this.value!==undefined)?this.value:"",k=this.isList?g.split(I):[g],j,f,l;for(var h=0,b=k.length;h<b;h++){j=this.doValidation(k[h]);f=(j.code>E.VALID);if(f){if(b>1){j.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",k[h]?k[h]:" ");}break;}}l=f?"onInvalid":"onValid";if(!f&&this.autoFormat){this.format();}this.set("validationStatus",j);if(this[l]){this[l](j);}},format:function T(){var k=this.dtp,g=(B[k]==6);if(!g){return ;}var n=mstrConfig.listSep,q=this.value||"",f=this.isList?q.split(n):[q],p=k===14,o=[],b,h=mstrmojo.locales.datetime;for(var j=0,l=f.length;j<l;j++){q=f[j];b=a.parseDateAndOrTime(q);if(b){if(p&&b.date){o.push(a.formatDateInfo(b.date,h.DATEOUTPUTFORMAT));}else{o.push((b.date?a.formatDateInfo(b.date,h.DATEOUTPUTFORMAT):"")+" "+(b.time?a.formatTimeInfo(b.time,h.TIMEOUTPUTFORMAT):""));}}}this.set("value",o.join(n));},isValid:function R(){var b=this.validationStatus;if(!b){this.validate();}return this.validationStatus.code===E.VALID;},clearValidation:function U(){this.set("validationStatus",{code:E.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function C(q){var n=this.constraints,o=n.regExp,g=n.validator,b={id:this.id,code:E.VALID,msg:""},l=this.dtp,k=(B[l]==1),f=(B[l]==2||B[l]==5),h=(B[l]==3),i=(B[l]==6),j=N.isEmpty(q),p=String(q).length;err="",_VAL=mstrmojo.locales.validation;if(this.required&&j){b.code=E.INVALID_EMPTY;b.msg=_VAL.requiredFieldError;return b;}q=N.trim(q);if(!j&&D(this,q)){if(k){err=_VAL.integerDataType;}if(f){err=_VAL.numericDataType;}if(i){err=_VAL.dateDataType;}b.code=E.INVALID_CHAR;b.msg=_VAL.invalidCharError.replace("#",err);return b;}if(!j&&i&&A(this,q)){b.code=E.INVALID_BAD_DATESTRING;b.msg=_VAL.invalidDateStringError;return b;}if(!j&&(f||k)&&Z(this,q)){b.code=E.INVALID_BAD_NUMERICFORMAT;b.msg=_VAL.invalidNumericFormatError;return b;}if(!j&&(k||f||i)&&Y(this,q)){b.code=E.INVALID_OUTOFRANGE;if(n.min!=null&&n.max!=null){err=_VAL.outofRangeError.replace("#","").replace("##",n.min).replace("###",n.max);}else{if(n.min!=null){err=_VAL.noLessMinError.replace("##",n.min).replace("#","");}else{if(n.max!=null){err=_VAL.noGreaterMaxError.replace("###",n.max).replace("#","");}}}b.msg=err;return b;}if(h&&n.minLen!=null&&n.maxLen!=null){if(p<n.minLen||p>n.maxLen){b.code=E.INVALID;b.msg=mstrmojo.desc(9211).replace(/#/,n.minLen).replace(/##/,n.maxLen);return b;}}if(o&&!o.test(q)){b.code=E.INVALID_REGEX;b.msg=mstrmojo.desc(9205);return b;}var s=g&&g.apply(this,[q]);if(s){b.code=s.code;b.msg=s.msg;return b;}return b;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.num","mstrmojo.array","mstrmojo.DICFactory");var F=1,J=0,L=1,N=2,G=".",I=mstrmojo.dom,K=mstrmojo.css,E=mstrmojo.hash,D=mstrmojo.Enum_Keys.TAB,H=function(Q){return(Q>=1&&Q<=7)||Q==21||Q==22||Q==30;},C=function(T,R){if(I.isIE&&!/px$/.test(R)){var Q=document.createElement("img"),S;Q.style.zIndex=-1;Q.style.left=R;T.appendChild(Q);S=Q.style.pixelLeft;T.removeChild(Q);return S+"px";}return R;},B=function(Q,R){return parseInt(C(Q,K.getStyleValue(Q,R)),10)||0;},M=function(Q){return{lp:B(Q,"paddingLeft"),rp:B(Q,"paddingRight"),tp:B(Q,"paddingTop"),bp:B(Q,"paddingBottom")};},P=function(R){var Q=R.currentStyle;if(!Q){Q=document.defaultView.getComputedStyle(R,null);}return{fontFamily:Q.fontFamily,fontSize:C(R,Q.fontSize),fontStyle:Q.fontStyle,fontVariant:Q.fontVariant,fontWeight:Q.fontWeight,textAlign:Q.textAlign};},O=function(S,Q){var R=mstrmojo.findAncestor(S,"scriptClass","mstrmojo.DocInfoWindow");if(!!R){R.autoCloseLocked=Q;}};mstrmojo._IsInputControl={_mixinName:"_IsInputControl",dic:null,owner:null,openerNode:null,popupStyle:J,items:null,applyOnEnter:true,lv:null,init:function(T){if(this._super){this._super(T);}var V=this.dic,U=V.dt,S=mstrmojo.expr.DTP,R,Q=[];if(mstrApp.useBinaryFormat){if(U==S.DATE||U==S.TIME||U==S.TIMESTAMP){R=mstrmojo.date.parseDateAndOrTime(this.value);if(R){if(U!=S.TIME){Q.push(mstrmojo.date.formatDateInfo(R.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}if(U!=S.DATE){Q.push(mstrmojo.date.formatTimeInfo(R.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}this.value=Q.join(" ");}}}this.lv=this.value;if(V.wm&&V.w===undefined){V.wm=0;}},showByDefault:false,hasPreview:false,getItems:function(){var X=this.dic,R=[],V,T,Q=0,U=String(X.itv),S=U&&U.indexOf(G),W=H(X.dt);if(S>=0){Q=U.substring(S+1).length;}if(parseInt(X.ipt,10)===0){for(V=0,T=X.min;T<X.max+0.00001;V++,T+=X.itv){R[V]={n:mstrmojo.num.toLocaleString(Q>0?T.toFixed(Q):T),v:T};}}else{R=X.vls;mstrmojo.array.forEach(R,function(Y){if(Y.n===undefined){Y.n=W?mstrmojo.num.toLocaleString(Y.v):Y.v;}});}return R;},font:null,onfontChange:function(){if(this.getInputNode){var Q=this.getInputNode(),R=this.font;E.forEach(R,function(T,S){Q.style[S]=T;});}},getOpenerNodeStyle:function(){var Q=this.group&&this.group.ons,R=this.openerNode;if(!Q){Q=M(R);Q.hp=Q.lp+Q.rp;Q.vp=Q.tp+Q.bp;Q.iw=Math.max(0,R.clientWidth-Q.hp);Q.ih=Math.max(0,R.clientHeight-Q.vp);if(this.group){this.group.ons=Q;}}return Q;},onvalueChange:function(){if(this._super){this._super();}this.dicChanged=true;if(this.showByDefault){this.applyChanges();}else{if(this.popupStyle!==J&&this.popup&&this.popup.enableApply){this.popup.enableApply();}}},preBuildRendering:function(){if(this._super){this._super();}this.openerNode=this.openerNode||this.owner.domNode;if(this.showByDefault){this.openerStyle=this.getOpenerNodeStyle();if(this.inlineExtraCssText){this.cssText+=" "+this.inlineExtraCssText;}}if(!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}},postBuildRendering:function(){var Q=this.openerNode;if(this._super){this._super();}if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault){Q.replaceChild(this.domNode,Q.lastChild);}else{this.set("font",P(Q));}}if(mstrmojo.DICConfig.isKeyNavigable(this.dic)){this.registerKeyEvents(this.domNode);}},applyChanges:function(){var W=this.lv,Q=this.getCurValue?this.getCurValue():this.value,V=this.openerNode,S=this.getDisplayValue?this.getDisplayValue():Q,U=this.dic.dt,R=mstrmojo.expr.DTP,T=mstrmojo.locales.datetime;if(String(Q)!==String(W)){if(mstrApp.useBinaryFormat){if(U==R.TIME||U==R.TIMESTAMP){Q=Q.replace(new RegExp(T.AM_NAME),"AM").replace(new RegExp(T.PM_NAME),"PM");}}this.lv=Q;this.dv=S;if(this.owner&&this.owner.dataChanged){this.owner.dataChanged(this.k,W,{dv:S,v:Q},V);}}return true;},cancelChanges:function A(){this.value=this.lv;},showInPopup:function(){this.popup=mstrmojo.DICFactory.createDICPopup(this.owner,this);if(this.focus){this.focus();}this.setInfoWindowLock(true);},lockPopup:function(){this.setInfoWindowLock(false);},renderPreview:null,onTabDown:function(Q){mstrmojo.dom.preventDefault(window,Q);if(this.applyChanges()!==false){if(this.popup){this.popup.close();}this.owner.editNext(this.k);this.cleanup();}},cleanup:mstrmojo.emptyFn,registerKeyEvents:function(R){var Q=this;I.attachEvent(R,"keydown",function(S){var T=S||window.event;if(T.keyCode===D){Q.onTabDown(S);}});if(I.isIE){I.attachEvent(R,"keyup",function(S){var T=S||window.event;if(T.keyCode===D){Q.focus();}});}},setInfoWindowLock:function(Q){O(this.owner,Q);}};}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,toXml:function A(){var J=this,D=function(P,Q){return" "+P+'="'+Q+'"';},C=function(P,Q){return D(P,mstrmojo.string.encodeXMLAttribute(Q));},F=new mstrmojo.StringBuffer();var H=this.prms,B=H&&H.length;if(B||J.aopam!=J.DO_NOT_ANSWER){F.append("<hl"+D("mid",J.mid)+D("srct",J.srct)+D("aopam",J.aopam)+">");if(B){F.append("<prms>");for(var E=0;E<B;E++){var O=H[E];F.append("<prm"+D("id",O.id)+D("am",O.am)+D("pt",O.pt));if(O.orid){F.append(D("orid",O.orid)+D("ortp",O.ortp));}F.append(">");switch(O.am){case J.DO_NOT_ANSWER:case J.CLOSE:case J.USE_DEFAULT_ANSWER:case J.SAME_PROMPT:break;case J.STATIC:F.append('<pa ia="1"><es>');var N=O.pa.es,M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es></pa>");break;case J.DYNAMIC:case J.ALL_VALID_UNITS:case J.CURRENT_UNIT:var L=O.pa;if(L){F.append('<pa ia="1">');var K=L.a;if(K){F.append("<a"+D("id",K.id)+C("n",K.n)+">");}if(O.pt===1){F.append(mstrmojo.string.encodeXMLAttribute(L.v));}else{F.append("<es"+D("dispForms",K&&K.dispForms>=0?K.dispForms:"")+">");var N=L.es;M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es>");if(K){F.append("</a>");}}F.append("</pa>");}break;}F.append("</prm>");}F.append("</prms>");}F.append("</hl>");}return F.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var D=mstrmojo.hash;var E=0;var M=[];var P={};var B=false;function H(R){var S=R.callback;if(S.submission){S.submission(this.userInteractionRequired(R));}this.submitRequest(R);}function K(){if(M.length&&!B){H.call(this,M.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function I(b,Y,S,T){if(S){this.cancelRequests();}var V=this.id,W=this.transport,R=mstrmojo.now()+Y.taskId+E++,U=b.canceled||mstrmojo.emptyFn;b.canceled=function(f){U();b.complete(true);return W.cancelRequest(f);};b=mstrmojo.func.wrapMethods(b,{complete:function(f){mstrmojo.all[V].deleteRequest(f);}});var X=!D.isEmpty(this._requests),Z=this.createRequest(R,b,Y,T),a=(B||X)&&!T.doNotHold;if(a){M.push(Z);}else{H.call(this,Z);}},createRequest:function C(U,W,V,R){var S=this._requests;if(!S){S=this._requests={};}var T=S[U]={id:U,callback:W,params:V,config:R};return T;},submitRequest:function F(R){this.transport.serverRequest(this.id,R.id,R);},cancelRequests:function O(){var R=false;D.forEach(this._requests,function(S){if(typeof S.gotResponse==="undefined"){R|=S.callback.canceled(S.id);}});this._requests={};M=[];return R;},response:function G(V,R,T){$MAPF(false,"AndroidServerTransport","transportRequest");var U=this.getRequest(V);if(U){U.gotResponse=true;var W=U.callback,S=(R&&!T.mstrerr)?"success":"failure";try{if(W[S]){W[S](T,U);}}finally{W.complete(V);}}K.call(this);},deleteRequest:function Q(S){var R=this._requests;delete R[S];},getRequest:function A(S){var R=this._requests;return R&&R[S];},userInteractionRequired:function L(R){return false;},addLoadingGraph:function J(R){P[R]=true;B=true;},removeLoadingGraph:function N(R){delete P[R];if(D.isEmpty(P)){B=false;K.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip");var B=mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",init:function A(D){this._super(D);var E=this.parent;if(!E||E.hasInitBindings){this.initBindings();}},destroy:function C(D){if(this.hasRendered){this.unrender(D);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn});B.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};B.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};B.heightMarkupMethod=function(){this.domNode.style.height=this.height||"";};B.widthMarkupMethod=function(){this.domNode.style.width=this.width||"";};}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func");mstrmojo.requiresDescs(8445);var O=mstrmojo.hash;var J=mstrmojo.dom;var Q=[mstrmojo.desc(8445,"Loading")];var G=0;function j(z,AA,t){var w=G++,x=this.getTxUpdates(w);t=t||{};t.src=arguments.callee.caller.name;if(!mstrmojo.string.isEmpty(x)){z.updateChanges=x;}mstrApp.serverRequest(z,this.wrapCallback(AA,w),t);}function H(t){var w=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(w){t.styleName="RWDocumentMobileStyle";t.availableWidth=w.w;t.availableHeight=w.h;}}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService],{scriptClass:"mstrmojo.DocDataService",wrapCallback:function s(x,t){var w=this;return mstrmojo.func.wrapMethods({success:function(z){if(z){w.rwb=z.bs||w.rwb;w.msgId=z.mid||w.msgId;}w.clearTxUpdates(t);},failure:function(z){w.resetTxUpdates(t);}},x);},refresh:function q(x,z){var w=!!x.useRefreshProgress,t=w?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:Q;delete x.useRefreshProgress;j.call(this,O.copy(x,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false}),z,{showProgress:true,hideProgress:true,progressStateText:t,useRefreshProgress:w});},getTxUpdates:function Z(x){var w=this.model;return w&&w.getTransactionUpdates&&w.getTransactionUpdates(x);},clearTxUpdates:function M(x){var w=this.model;if(w&&w.clearTransactionUpdates){w.clearTransactionUpdates(x);}},resetTxUpdates:function D(x){var w=this.model;if(w&&w.resetTransactionUpdates){w.resetTransactionUpdates(x);}},loadDocLayout:function V(w,x){var t=O.copy(w,{taskId:"loadDocLayout",rwb:this.rwb});H.call(this,t);j.call(this,t,x,{showProgress:true,hideProgress:true,progressStateText:Q});},setCurrentDocLayout:function T(t,w){w=w||null;j.call(this,{taskId:"setDocLayout",rwb:this.rwb,layoutKey:t},w,{silent:(w===null)});if(typeof mstrMobileApp!=="undefined"){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function b(t,w){j.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:t},w);},setCurrentPanel:function i(z,x,t,w){j.call(this,{taskId:"setCurrentPanel",rwb:this.rwb,key:z,panelStackKey:x,selectorKeyContext:t},w,{silent:true});},requestNewPanel:function k(AB,AA,x,t,w,z){j.call(this,{taskId:"requestNewPanel",rwb:this.rwb,key:AB,panelStackKey:AA,selectorKeyContext:x,dirtyKeys:t},z,{showProgress:w,hideProgress:w,progressStateText:Q});},applyGraphSelectorAction:function E(AB,AA,z,t,AD,AC,w){j.call(this,{taskId:"applyGraphSelectorAction",rwb:this.rwb,selectorKeyContext:AB,ctrlKeys:AA,sliceID:z,x:t,y:AD,zoomFactor:w},AC);},setDocSelectorElements:function L(AB,AD,AG,AC,AE,x,t,AA,AF,w){var z={taskId:"setDocSelectorElements",rwb:this.rwb,selectorKeyContext:AB,elemList:AD,ctlKey:AG,zoomFactor:x};if(J.isAndroid||t){z.taskId="androidSetDocSelectorElements";}if(AC!==null&&AC!==undefined){z.include=AC;}if(AA){z.sdpKeys=AA;}if(AF){z.tks=AF;}if(w){z.usePartialUpdate="0";}j.call(this,z,AE,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setDocVisSelectorElements:function p(AA,AC,AF,AB,AD,w,t,z,AE){var x={taskId:"setDocVisSelectorElements",rwb:this.rwb,selectorKeyContext:AA,elemList:AC,ctlKey:AF,zoomFactor:w};if(J.isAndroid||t){x.taskId="androidSetDocSelectorElements";}if(AB!==null&&AB!==undefined){x.include=AB;}if(z){x.sdpKeys=z;}if(AE){x.tks=AE;}j.call(this,x,AD,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setMultiDocSelectorElements:function W(t,x,AA,w){var z={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:x,selectorObjects:t,zoomFactor:w};j.call(this,z,AA,{showWait:true,hideWait:true,delay:true});},setDocSelectorExpression:function X(x,AI,AC,t,AG,AB,AA,AE,AD,AF,w,AH){var z={taskId:"setDocSelectorExpression"+(AH?"Unset":""),rwb:this.rwb,unitKeyContext:x,ctlKey:AI,objectId:AC,objType:t,expFunction:AG,expFunctionType:AB,zoomFactor:w};if(AA!==null&&AA!==undefined){z.include=AA;}if(AE!==null&&AE!==undefined){z.expConstants=AE;}if(AD!==null&&AD!==undefined){z.dataType=AD;}j.call(this,z,AF);},setDocSelectorInclude:function N(x,w,AC,AB,t,z){var AA={taskId:"setDocSelectorInclude",rwb:this.rwb,include:w,ctlKey:x,zoomFactor:z};if(AB){AA.objectID=AB;}if(t){AA.objType=t;}j.call(this,AA,AC);},setDocUnsetSelector:function S(w,t,z,x){j.call(this,{taskId:"unsetSelector",rwb:this.rwb,unitKeyContext:w,ctlKey:t,zoomFactor:x},z);},getRWGraphImage:function h(AB,AD){var AA=mstrApp,AC=this.id,z={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:AB.k,sliceID:parseInt(AB.sid,10),width:parseInt(AB.w,10),height:parseInt(AB.h,10)};if(AA.onMobileDevice()&&AA.useBinaryFormat){window.setTimeout(function(){j.call(mstrmojo.all[AC],z,AD);},0);}else{if(AB.encodeImage){z.taskContentEncoding="base64";delete z.taskEnv;j.call(this,z,{success:function(AE){AD.success("data:image/png;base64,"+AE);},failure:function(AE){(AD.failure||AA.onerror)(AE);}});}else{var t=AA.getConfiguration(),x=AA.getCurrentProjectId(),w=new mstrmojo.StringBuffer();z.__ts__=new Date().getTime();z.sessionState=AA.getSessionState(x);O.forEach(z,function(AE,AF){w.append(AF+"="+encodeURIComponent(AE));});AD.success(t.getTaskUrlByProject(x)+"?"+w.toString("&"));}}},getImage:function A(w){var x=mstrApp,t=x.getConfiguration();if(t&&w&&w.indexOf("://")===-1){w=t.getHostUrlByProject(x.getCurrentProjectId())+w;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(w)):w;},getDocImage:function n(t){return this.getImage(t);},setQuickSwitchViewMode:function C(t,w){j.call(this,{taskId:"setDisplayMode",gridKeyContext:t,messageID:this.msgId,displayMode:w},null,{silent:true});},setRWUnitProperties:function a(t,x,z,w,AA){j.call(this,{taskId:"setRWUnitProperties",rwb:this.rwb,nodeKey:t,props:x,formatType:z,returnData:w},AA,{silent:true});},setDocZoom:function B(t,w){j.call(this,{taskId:"setDocZoom",rwb:this.rwb,zoomType:t.zoomType,zoomFactor:t.zoomFactor},w);},sort:function l(t,w){j.call(this,O.copy(t,{taskId:"DocSort",rwb:this.rwb}),w);},pivot:function K(w,x){var t=O.copy(w,{messageID:this.msgId,rwb:this.rwb});t.key=w.nodeKey;delete t.nodeKey;t.taskId=w.formID?"docPivotForm":"docPivot";j.call(this,t,x);},drillGrid:function U(t,w){j.call(this,{taskId:"DocDrill",messageID:this.msgId,nodeKey:t.nodeKey,drillPathIndex:t.drillPathIndex,drillPathKey:t.drillPathKey,elementList:t.drillElements},w,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},changeDocGroupBy:function F(x,z,t){var w={taskId:"changeDocGroupBy",rwb:this.rwb,messageID:this.msgId,treesToRender:3};if(x.flags){w.flags=x.flags;}if(x.groupbyKey){w.groupByKey=x.groupbyKey;w.elementID=x.elementId;}else{w.gbUnits=x.gbUnits;}H.call(this,w);j.call(this,w,z,t);},downloadGridData:function f(t,w){j.call(this,{taskId:"DocXtabIncrementalFetch",rwb:this.rwb,nodeKey:t.nodeKey,rowPosition:t.rowPosition,maxRows:t.maxRows,colPosition:t.colPosition,sliceId:t.sliceId,maxColumns:t.maxColumns},w);},txMarkRows:function g(t,w){j.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:t.nodeKey,sliceId:t.sliceId,rowOrdinal:t.rowOrdinal,actionType:t.actionType},w);},txChangeData:function I(t,w){j.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:t.nodeKey,sliceId:t.sliceId,cells:t.cells,autoRefresh:t.autoRefresh},w);},sendTransactionActions:function R(w,x){var t={taskId:"DocTransaction",rwb:this.rwb,keyContext:w.keyContext,actions:w.actions,messageID:this.msgId};if(w.txrcd){t.isPending=w.txrcd.pending;t.timestamp=w.txrcd.timestamp;}j.call(this,t,x,{silent:!!x});},RWEventsTask:function o(t,w){j.call(this,{taskId:"RWEventsTask",rwb:this.rwb,messageID:t.messageID,styleName:t.styleName,events:t.events},w);},getPageByTree:function Y(t){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},t);},resetSelections:function P(w,t,x){j.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:w||"",usePartDisplay:t?"0":"1"},x);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.form","mstrmojo._IsDocController");var H=3;mstrmojo.OIVMDocController=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsDocController],{scriptClass:"mstrmojo.OIVMDocController",onSort:function B(K,L){L.treeType=K.treeType;K.model.sort(this._addNodeKeyToAction(K,L),this._getXtabCallback.call(this,K));},onPivot:function G(K,L){K.model.pivot(this._addNodeKeyToAction(K,L),this._getXtabCallback.call(this,K));},onDrill:function I(K,O){if(O.isWithin){if(!this.isInRequest()){K.model.drillGrid(this._addNodeKeyToAction(K,O),this._getXtabCallback.call(this,K));}}else{var M=this.model,L=this.model.prefs,P=L.rtprnt,N=L.rtthld;mstrmojo.form.send({evt:3125,displayMode:-1,drillPathKey:O.drillPathKey,elementList:O.drillElements,rwMesageID:M.mid,retainParent:isNaN(P)?"":P,retainThresh:isNaN(N)?"":N,rwGroupByElements:this.getGroupByElements(K).join(","),sliceId:K.sid||0},null,null,((L.drillnw)?"_blank":null));}},onExecuteNewObject:function J(L,M){if(M){var K={};if(M.objType===H){K.evt=4001;K.reportID=M.did;K.reportViewMode=1;if(M.forceExec){K.execFlags=1;K.doNotUpdateCaches=true;}}else{K.evt=2048001;K.objectID=M.did;if(M.forceExec){K.freshExec=true;K.doNotUpdateCaches=true;}}if(M.linkAnswers){K.linkAnswers=M.linkAnswers;}mstrmojo.form.send(K,null,"POST",null);}},onReExecute:function(K,N){var L=K.model,M={evt:2048030,src:L.bp+".2048030",rwb:L.bs};if(N){M.ignoreStatus=true;mstrmojo.form.send(M,null,"POST",null);}else{mstrmojo.form.send(M,null,"POST",null);}},isAutoRefreshEnabled:function(){return this.autoRefreshHandler;},startAutoRefresh:function(){var K=this.model,L=K.rf,M=this;this.autoRefreshHandler&&this.stopAutoRefresh();this.autoRefreshHandler=setTimeout(function(){K.getDataService().refresh({},{success:function(N){K.loadLayout(N);M.autoRefreshHandler&&M.startAutoRefresh();}});},L*1000);},stopAutoRefresh:function(){clearTimeout(this.autoRefreshHandler);this.autoRefreshHandler=null;},offlineTransactionsSubmitted:function(K){},transactionDiscarded:function(K){},openOfflineTransactions:function(){},invalidClientCache:function(){},confirmMsgBeforeSubmit:function D(){},onLink:function E(K,N){if(N.link){var L=N.link.toXml();if(L){N.linkAnswers=L;}delete N.link;}if(N.linkInfo&&N.linkInfo.so>0){N.originMessageID=this.model.mid;if(!N.linkAnswers){N.promptAnswerMode="0";}N.selectorMode=N.linkInfo.so;}var O=N.target||N.linkTarget||"_self";if(N.url){if(N.url.length>2083){var M=mstrmojo.form.createDynamicForm(N.url);M.target=O;M.submit();}else{window.open(N.url,O);}}else{mstrmojo.form.send(N,null,"POST",O);}},onTransactionUpdates:function A(K,M,L){if(L){K.autoRefresh();}},onDownloadGridData:function C(K,L){this.model.downloadGridData(this._addNodeKeyToAction(K,L));},onGroupBy:function F(K,Q,N){var O=this,M=K.model,L=Q.groupbyKey,P=false;Q.flags=M.agb==2?2:0;P=!!Q.flags;M.getDataService().changeDocGroupBy(Q,{submission:function(){N(true);},success:function(R){if(P){K.parent.parent.unloadGbLayuts(L);}M.loadLayout(R);},complete:function(){N(false);}});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.Model");var P=mstrmojo.dom;var K=1,E=2,J=4,M=8,N=16;function C(V,X){var R=V.getCellForNode(X),Q=R&&R.at,W=0;if(Q){W=(Q&E)||(Q&J)||(Q&K);}if(W===J){var T=V.model.getCellLinksInfo(R);if(isNaN(T.di)){return"";}var S=T.links[T.di];return S.n;}if(W===K){return(mstrmojo.desc(183,"Drill to")+" "+V.model.getCellDrillsInfo(R).n);}if(R){var U=("mix" in R)?R._e:R;if(U&&U.desc){return U.desc;}}return V.tooltip||"";}function O(V,X){var S=V.getCellForNode(X),R=S&&S.at;if(R&M||R&N){return true;}var W=0;if(R&K){W++;}if(R&J){W++;}if(R&E){W++;}if(W>1){return true;}if(R&J){var U=V.model.getCellLinksInfo(S),T=U&&U.links;var Q=(T&&T.length)||0;if(U&&!isNaN(U.di)){Q--;}if(Q>0){return true;}}else{return false;}}function A(R,S){var Q=S.mstrShowPopup;if(Q!==undefined){return Q;}Q=O(R,S);S.mstrShowPopup=Q;return Q;}function D(Q,R){if(R&&A(Q,R)){if(!Q.openPopup){Q.requiresCls(["mstrmojo._HasPopup"]);}return true;}return false;}function B(U,Q,T,S){var R=S||P.eventTarget(Q,U);return R&&P.findAncestorByName(R,"td",true,T.viewport);}function I(Q){return Q.lockHeadersCase<2?Q.viewport.clientWidth-(Q.scrollboxNode.offsetWidth-Q.scrollboxNode.clientWidth):(parseInt(Q.getFormats().width,10)||Q.viewport.clientWidth);}mstrmojo._XtabCellHoverMgr=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo._XtabCellHoverMgr",parent:null,td:null,audibles:{"*":false},startup:function G(){var V=this.parent;if(V&&V.getCellForNode){var X=this.id,T=this.fCtxMenu=function(Y){mstrmojo.all[X].oncontextmenu(Y,self);},R=this.fOver=function(Y){mstrmojo.all[X].onhover(Y,self);},Q=this.fOut=function(Y){mstrmojo.all[X].onunhover(Y,self);},U=V.zones,W;for(W in U){var S=U[W].tableNode;if(S){P.attachEvent(S,"mouseover",R);P.attachEvent(S,"mouseout",Q);P.attachEvent(S,"contextmenu",T);}}if(!this._sub_ihc){this._sub_ihc=V.attachEventListener("ignoreHoverChange",this.id,"onChangeIgnoreHover");}window.setTimeout(function(){V._pl=I(V);},0);}},shutdown:function F(){var R=this.parent&&this.parent.zones,S;for(S in R){var Q=R[S].tableNode;if(Q){P.detachEvent(Q,"mouseover",this.fOver);P.detachEvent(Q,"mouseout",this.fOut);P.detachEvent(Q,"contextmenu",this.fCtxMenu);}}},onXtabWidthChanged:function(){var Q=this.parent;Q._pl=I(Q);},onChangeIgnoreHover:function(){var Q=this.parent;if(!Q.ignoreHover&&this._ignored){this.onhover(null,null,this._ignored);}},onhover:function H(T,Q,S){if(this.parent.ignoreHover){this._ignored=P.eventTarget(Q,T);return ;}var R=this.parent,U=B(T,Q,R,S);if(U&&R){U.title=C(R,U);}if(D(R,U)){this.td=U;if(!R._pl){R._pl=I(R);}R.openPopup("cellHoverPopupRef",{xtab:R,td:U});}else{this.onunhover(T,Q,S);}},onunhover:function L(U,Q,T){if(this.parent.ignoreHover){return ;}var S=this.parent,R=S._lastOpened;if(!R){return ;}if(R.autoCloses){R.autoClose();}else{S.closePopup();}},oncontextmenu:function H(T,Q,S){var R=this.parent,U=B(T,Q,R,S);if(D(R,U)){R.openPopup("cellHoverPopupRef",{xtab:R,td:U,cmPos:P.getMousePosition(T,Q)});R.cellHoverPopupRef.btn.openPopup();R.closePopup();P.preventDefault(Q,T);}}});}());(function(){mstrmojo.ToolBarModel=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo.ToolBarModel",getChildren:function A(C,B){return(C||this.n||this).items;}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Model","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.StringBuffer","mstrmojo.EnumReadystate");var p=mstrmojo.EnumRWUnitType,J=mstrmojo.EnumReadystate,t=mstrmojo.hash.forEach,O=mstrmojo.func.wrapMethods,a=mstrmojo.array;var AE={isObservable:function(AK){var AJ=AK&&AK.t;if(!AJ||!(AJ in this)||AK.scriptClass){return false;}return(AJ!==p.SUBSECTION||!AK.dt);},makeObservable:function(AJ){AJ.audibles=this[AJ.t]||{};if("readyState" in AJ.audibles){AJ.readyState=J.IDLE;}return new mstrmojo.Model(AJ);}};AE[p.PANELSTACK]={"*":false,selKey:true,readyState:true};AE[p.GRID]={"*":false,readyState:true,ds:true};AE[p.GRAPH]={"*":false,readyState:true,ds:true};AE[p.GRIDGRAPH]={"*":false,qsm:true,ds:true};AE[p.SUBSECTION]={"*":false,resize:true,adjustSize:true};AE[p.VISUALIZATION]={"*":false,ds:true};AE[p.SELECTOR]={"*":false,cek:true,ds:true};AE[p.MOJOVISUALIZATION]={"*":false,ds:true};function G(AN,AO){var AK=AN.layoutMap&&AN.layoutMap[AO];if(AK){return AK;}var AJ=AN.layouts,AM=(AJ&&AJ.length)||0,AL=0;for(AL=0;AL<AM;AL++){if(AJ[AL].k==AO){return AJ[AL];}}return null;}function H(AL,AN,AK){var AJ=G(AL,AN);if(AK==AN){AJ._lkz=AN;return AJ;}else{if(AJ){var AM=AJ.units[AK];if(AM){if(AM.t==p.GRIDGRAPH){if(!AJ.units[AK+"_0"]){AJ.units[AK+"_0"]={ck:AM.ck,fmts:AM.fmts.gd,txi:AM.txi,t:p.GRID};AJ.units[AK+"_1"]={ck:AM.ck,fmts:AM.fmts.gp,t:p.GRAPH};}}if(AE.isObservable(AM)){AM=AJ.units[AK]=AE.makeObservable(AM);}AM._lkz=AN;}}}return AJ&&AJ.units[AK];}function AI(AN,AM,AL,AJ){var AK=this.getChildren(AN,AM,0);return(mstrApp.isMobile?(mstrmojo.array.filter(AK,function(AQ){var AO=AL&&AL.indexOf(AQ.defn.t),AP=AQ.defn.dk;return AJ?(AO>-1&&AP===-1):(AO<0||AP!==-1);})):(AJ?[]:AK));}var l=function(AJ,AK){var AL=new mstrmojo.StringBuffer();if(AK){AL.append("*l"+AK);}AL.append("*k"+AJ.k);if("wid" in AJ){AL.append("*x"+AJ.wid);}AL.append("*t"+this.buildTime);return AL.toString();};function i(AL){var AK,AJ,AO=this.delta,AM=this.pendingUpdate,AN=[];if(!AM){AM=this.pendingUpdate={};}if(!mstrmojo.hash.isEmpty(AO)){AN.push("<updates>");for(AK in AO){if(AO.hasOwnProperty(AK)){AJ=AO[AK];AN.push(AJ.getUpdates());}}AM[AL]=AO;this.delta={};AN.push("</updates>");}return AN.join("");}function f(AM,AN){var AJ;if(AM){AM=AM.split(AN||"\u001E");for(var AL=0,AK=AM.length;AL<AK;AL++){AJ=AJ||{};AJ[AM[AL]]=H.call(this,this.defn,this.currlaykey,AM[AL]);}}return AJ;}function A(AL,AM){var AJ=AM.ulkeys,AK=AL.controller.view;if(AK&&AK.unloadLayouts&&AJ&&AJ.length){AK.unloadLayouts(AJ);}}function P(AK,AJ){var AL=this.getLayoutUnitDefn(AK,AJ);return(AL&&AL.t===p.PANELSTACK&&AL.ifw);}function n(AK,AJ){return !AJ||(AK.wid==AJ);}function K(){var AK=this.data&&this.data.layouts,AJ=AK[a.find(AK,"k",this.getCurrentLayoutKey())],AM=AJ&&AJ.gbys&&AJ.gbys.groupbys,AL=false;a.forEach(AM,function(AN){if(AN.unit&&AN.unit.elms&&AN.unit.elms[AN.unit.idx].v==="u;"){AL=true;return false;}});return AL;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true},features:null,dataCache:null,controller:null,sdp:null,init:function x(AJ){this._super(AJ);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();this.buildTime=mstrmojo.now();},makeObservable:function U(AJ){return AE.makeObservable(AJ);},getTargetDefn:function(AJ){return f.call(this,AJ);},getTargetInfoWin:function(AK){var AJ=[],AL=f.call(this,AK);if(AL){var AM;for(AM in AL){if(AL[AM]&&AL[AM].ifw){AJ.push(AM);}}}return AJ;},getUnitDefinitions:function(AJ,AK){return f.call(this,AJ,AK);},hasFeatures:function s(AN){var AL=this.features;if(!AL){return false;}var AK=AN.split(",");for(var AM=0,AJ=AK.length;AM<AJ;AM++){var AO=AK[AM],AP=AO.match(/^\!/);if(AP){AO=AO.replace("!","");}if(AP?this.features[AO]:!this.features[AO]){return false;}}return true;},ondefnChange:function j(){var AO=this.defn,AL=AO&&AO.layouts,AK={};if(AO){AO.layoutMap=AK;for(var AN=0,AM=AL&&AL.length||0;AN<AM;AN++){var AJ=AL[AN];AK[AJ.k]=AJ;}}},formatResolver:{getFormat:function L(AN,AM){var AL=((AN&&AN.fmts)||null);if(AM){var AP=AN.thresholds,AK=AP&&AP[AM];if(AK){var AO={},AQ;for(AQ in AL){AO[AQ]=AK[AQ]||AL[AQ];}for(AQ in AK){var AJ=AK[AQ];AO[AQ]=(typeof (AJ)==="string")?(AJ+" !important"):AJ;}AL=AO;}}return AL;}},getSelectedXtabStyles:function W(AL){var AK=AL||this.currlaykey;var AN={};var AJ=this.data&&this.data.layouts;for(var AM in AJ){if(AJ[AM].k===AK){AN=AJ[AM].xtabStyles;break;}}return AN;},getChildren:function z(AZ,AJ,AQ,AR,AP){var AU=this.currlaykey;if(AZ){var AM=AZ.defn;AU=(AM&&AM._lkz)||AZ.k;}var Ak=this.getLayoutDataCache(AU),Aa=(!AJ&&!mstrmojo.hash.isEmpty(Ak)),Ag;if(!AZ){Ag=this.data;}else{var AS=AZ.data||AZ;if(Aa){Ag=Ak[l.call(this,AS,AU)];Ag=(Ag&&Ag.data)||Ag||AS;}else{Ag=AS;}}var AK=Ag?(Ag.sections||Ag.subsections||Ag.objects||Ag.panels||Ag.layouts||Ag.children):[],AV=[];var Ad=(AK&&AK.length)||0;if(Ad){var AM=this.defn,AX=!AZ,AT=AZ?AU:null,AO=(AZ&&((AZ.defn)?AZ.defn.t:H.call(this,AM,AT,AZ.k).t));var AL=(AO===p.GRIDGRAPH),Ae=(AO===p.DETAILS);for(var Ac=AQ||0,Ab=(isNaN(AR))?Ad:Ac+AR;Ac<Ab;Ac++){var Ai=AK[Ac];if(AL){Ai.k=AZ.k;Ai.wid=AZ.data.wid;}var Al=Ai.k,AY=l.call(this,Ai,AT),Ah;if(!AX&&!AJ&&P.call(this,Al,AT)){var Af=this.getLayoutUnitDefn(Al),AW={data:Ai,defn:Af,id:AY,k:Al,p:Ag};Ak[AY]=AW;if(!this.infoWinByKey||!this.infoWinByKey[Al]){var AN=this.infoWindows=this.infoWindows||{};var Aj=this.infoWinByKey=this.infoWinByKey||{};AN[Af.n]=Aj[Al]=AW;}continue;}if(AL){AY+="_"+Ac;Ah=H.call(this,AM,AT,Ai.k+"_"+Ac);}else{Ah=H.call(this,AM,AT||Ai.k,Ai.k);}if(Ae){Ah.dt=true;}AV.push({k:Ai.k,id:AY,defn:Ah,data:Aa?(Ak[AY]&&Ak[AY].data)||Ai:Ai});}}return AP?{nodes:AV,total:Ad}:AV;},getInfoWindow:function q(AK){var AJ=this.infoWindows;return AJ&&AJ[AK];},getFixedHeaders:function(AK,AJ){return AI.call(this,AK,AJ,[p.PAGEHEADER],true);},getFixedFooters:function(AK,AJ){return AI.call(this,AK,AJ,[p.PAGEFOOTER],true);},getNonFixedSections:function(AK,AJ){return AI.call(this,AK,AJ,[p.PAGEHEADER,p.PAGEFOOTER],false);},getLayoutUnitDefn:function E(AK,AJ){return H.call(this,this.defn,AJ||this.currlaykey,AK);},getUnitInstance:function S(AJ,AK){return mstrmojo.all[l.call(this,{k:AJ,wid:AK},this.currlaykey)];},getFirstUnitInstanceByName:function o(AL){var AJ=G(this.defn,this.currlaykey);if(AJ){var AK=AJ.units;for(u in AK){var AM=AK[u];if(AM.n===AL){return this.getUnitInstance(u,1);}}}return null;},getSelectedKey:function AF(AJ){return(!AJ&&this.currlaykey)||null;},getCurrentLayoutKey:function AA(){return this.currlaykey;},getCurrentLayoutDef:function AC(){var AJ=this.defn&&this.defn.layouts;return AJ&&AJ[a.find(AJ,"k",this.currlaykey)];},replaceLayout:function C(AM,AN){var AK=this.dataCache;if(AK&&AK[AM]){AK[AM]={};}var AJ=(this.data&&this.data.layouts)||(this.defn&&this.defn.layouts);for(var AL=(AJ&&AJ.length-1)||0;AL>=0;AL--){if(AJ[AL].k===AM){break;}}this.bs=AN.bs;this.zf=AN.zf;if(AN.data){this.data.layouts[AL]=AN.data.layouts[AL];this.data.elems=AN.data.elems;}if(AN.defn){this.defn.layouts[AL]=AN.defn.layouts[AL];this.ondefnChange();}},loadLayout:function h(AJ,AL,AK){this.replaceLayout(AJ.currlaykey,AJ);this.raiseEvent({name:"rebuildLayout",unloadCache:!!AL,restoreIW:!!AK});},getTransactionUpdates:function AH(AJ){return this.txDiscardTargets?"":i.call(this,AJ);},clearTransactionUpdates:function AB(AJ){this.clearTxDeltaUpdate(AJ);},resetTransactionUpdates:function B(AJ){var AK=this.pendingUpdate,AL=this.delta;if(AK&&AK[AJ]){t(AK[AJ],function(AM,AN){if(AL&&!AL[AN]){AL[AN]=AM;}});delete AK[AJ];}},getDataService:function N(){var AL=this.dataService,AJ=this;if(!AL){var AK={rwb:this.bs,msgId:this.mid,model:this};if(mstrApp.modelFactory){AL=mstrApp.modelFactory.newDataService("Document",AK);}else{AL=mstrApp.viewFactory.newDocDataService(AK);}this.dataService=AL;this.disposables.push(AL);}return AL;},partialUpdate:function T(AL,AJ){var AK=this.updateDataCache(AL,AJ);this.raiseEvent({name:"partialUpdate",tree:AL,ids:AK});return AK;},transactionUpdate:function(AL,AK){if(!AL.data){return ;}var AN=this,AO;if(AK&&AK.tks){AO=f.call(this,AK.tks);}if(AL.pukeys){AO=f.call(this,AL.pukeys);var AP;for(AP in AO){if(AO[AP]&&AO[AP].cek){AO[AP].cek=null;}}}if(AL.txrcd){this.txrcd=AL.txrcd;}else{delete this.txrcd;}var AM=this.updateDataCache(AL.data,AO,AK&&AK.sid),AJ={name:"partialUpdate",tree:AL.data,ids:AM};if(!mstrmojo.hash.isEmpty(AM.ifws)){if(AK&&AK.type===p.GRID){AJ.anchor=AK.anchor;}else{AM.ifws={};}}this.raiseEvent(AJ);return AM;},deltaUpdate:function AG(AJ){var AK=this.delta;if(!AK){AK=this.delta={};}AK[AJ.id]=AJ;},clearTxDeltaUpdate:function V(AK){var AN=this.txDiscardTargets,AJ=!AN,AM=this.pendingUpdate,AL=this,AO;if(!AJ){t(AN,function(AP,AQ){if(AL.delta&&AL.delta[AQ]){AL.delta[AQ].clear();delete AL.delta[AQ];}});}if(AM&&AM[AK]){t(AM[AK],function(AP){AP.clear();});delete this.pendingUpdate[AK];}},sendTransactionActions:function w(AK,AJ,AM){var AL=this,AN;if(!AM){AM={success:function(AO){AL.transactionUpdate(AO);}};}AL.getDataService().sendTransactionActions({keyContext:AK,actions:AJ,txrcd:this.txrcd},AM);},addSDP:function D(AK,AJ){if(!AK||!AJ){return ;}if(!this.sdp){this.sdp={};}this.sdp[AK]={k:AJ.k,visName:AJ.visName};},removeSDP:function Z(AJ){if(!AJ||!this.sdp[AJ]){return ;}delete this.sdp[AJ];},slice:function R(AW){try{if(!AW||(!mstrmojo.dom.isAndroid&&!AW.tks&&!AW.multiSelect&&(AW.type===3||(AW.type===p.GRAPH&&AW.tty!=1)))){return ;}var AL=null,Ae=this,AZ=this.getDataService(),Af=AW.tks?f.call(this,AW.tks):null,AY=Af,Ad=function(Ag){t(AY,function(Ah,Ai){if(Ah&&Ah.set){Ah.set("readyState",Ag);}});},Ac=function(Ag,Ah){return mstrmojo.all[l.call(Ae,{k:Ag,wid:Ah},Ae.currlaykey)];},AP=this.newCallback({method:"slice",submission:function(){Ad(J.WAITING);},success:function(Ah){if(AW.disablePU){Ae.loadLayout(Ah,AW.isUConDS,AW.restoreIW);return ;}if(Ah.pukeys){Af=f.call(Ae,Ah.pukeys);}A(Ae,Ah);AL=Ae.updateDataCache(Ah.data,Af,AW&&AW.sid);if(typeof (Ah)=="object"){mstrmojo.hash.copyProps(["bs","exopt","dty"],Ah,Ae);}var Ag={name:"partialUpdate",tree:Ah.data,ids:AL};if(!mstrmojo.hash.isEmpty(Ag.ids.ifws)){if(AW&&!AW.suppressIW&&(AW.type===p.GRID||AW.type===p.GRAPH)){Ag.anchor=AW.anchor;}else{Ag.ids.ifws={};}}Ae.raiseEvent(Ag);},complete:function(){Ad(J.IDLE);}});if(AW.type==3){var AX=AW.tks,AR=AW.eid;if(!AX){return ;}var AV=H(this.defn,this.currlaykey,AR);if(!AV){return ;}var AS=AR,AJ=Af[AX],AO=function(){AJ.set("selKey",AR);},AN;AJ.newSelKey=AR;if(AV.l){var Aa=AV.dirtyKeys;if(!!Aa){AS=mstrmojo.hash.keyarray(Aa).join(",");AY=Af=f.call(this,AS,",");AN=function(){AO();t(AL.upd,function(Ag,Ah){var Ai=mstrmojo.all[Ah];if(Ai&&Ai.setDirty){Ai.setDirty(false);}});};}else{AZ.setCurrentPanel(AR,AW.tks,AW.ck,this.newCallback({method:"slice",success:AO}));return ;}}else{AN=function(){AO();AV.l=true;};}var AT=AP.success;AP.success=function(Ak){var Ai=G(Ak.defn,Ae.currlaykey),Ao=G(Ae.defn,Ae.currlaykey),Al=function(Ap,Aq){for(var Ar in Aq){if(Ap[Ar]===undefined){Ap[Ar]=Aq[Ar];}}},An=Ai&&Ai.units,Am=Ao&&Ao.units,Ah=Ai&&Ai.cgbMap,Ag=Ao&&Ao.cgbMap;if(An){Al(Am,An);}if(Ah){Al(Ag,Ah);Ae.raiseEvent({name:"CGBMapChange",cgbMap:Ag});}AT(Ak);AN();var Aj=Ac(AW.tks,0);if(Aj){Aj.clearDirtyChild(AR);}};AZ.requestNewPanel(AR,AW.tks,AW.ck,AS,!AW.hasLoader,AP);}else{AP=O(AP,{success:function(Ag){t(AY,function(Ak,Ai){var Aj=Ac(Ai,1);if(!Aj){if(!!Ae.sdp&&!!Ae.sdp[Ai]){var Ah=Ae.getLayoutDataCache(Ae.getCurrentLayoutKey());var Al=l.call(Ae,{k:Ai,wid:1},Ae.currlaykey);Ae.raiseEvent({name:"secondaryDataSliced",key:Ai,data:Ah[Al].data});}return ;}if(AL&&!(Ai in AL.def)){if(Aj.setDirty){Aj.setDirty(true);}}else{if(Ak.t==p.PANELSTACK){Aj.setDirtyChildren();}}});}});var AM,AU;if(AW.type==p.GRAPH){AU="applyGraphSelectorAction";AM=[AW.ck,AW.cks,AW.sid,AW.x,AW.y,AP,Ae.zf];}else{if(AW.isMultipleEvents){AU="RWEventsTask";params={messageID:this.mid,styleName:"RWDocumentMojoStyle",events:AW.events};AM=[params,AP];}else{if("eid" in AW){AU=AW.isDocVis?"setDocVisSelectorElements":"setDocSelectorElements";AM=[AW.ck,AW.eid,AW.ctlKey,AW.include,AP,Ae.zf];var AQ=K.call(this);if(AW.isUConDS||AQ){AW.disablePU=true;AM=AM.concat([null,0,null,true]);}if(AQ){AW.restoreIW=true;}if(Ae.sdp){var AK={};t(Ae.sdp,function(Ah,Ag){if(Ae.sdp[Ag]){AK[Ag]=Ah.visName;}});AM[7]=JSON.stringify(AK);}AM[8]=AW.tks;}else{if(AW.multiSelect){if(AW.selectorObjects.length>0){AU="setMultiDocSelectorElements";AM=[AW.selectorObjects,AW.multiSelect,AP,Ae.zf];}}else{if("srct" in AW&&AW.srct==4){if(AW.onlyInclude){AU="setDocSelectorInclude";AM=[AW.ckey,AW.include,AP,AW.srcid,AW.srct,Ae.zf];}else{AU="setDocSelectorExpression";AM=[AW.ck,AW.ckey,AW.srcid,AW.srct,AW.f,AW.ft,AW.include,AW.cs,5,AP,Ae.zf];if(!AW.cs){AM[7]=null;AM[8]=null;if(AW.changeQual){AZ.setRWUnitProperties(AW.ckey,AW.ckey+"\u001FFormattingSelector\u001FMetricConditionType\u001F"+AW.qt,1,false,null);AM.push(AW.unset);}}}}else{if(AW.unset){AU="setDocUnsetSelector";AM=[AW.ck,AW.ckey,AP,Ae.zf];}else{AU="setDocSelectorInclude";AM=[AW.ckey,AW.include,AP,null,null,Ae.zf];}}}}}}if(AU){AZ[AU].apply(AZ,AM);}}}catch(Ab){mstrmojo.err(Ab);}},getLayoutDataCache:function F(AK){if(!AK){return null;}var AJ=this.dataCache;if(!AJ){AJ=this.dataCache={};}if(!AJ[AK]){AJ[AK]={};}return AJ[AK];},updateDataCache:function X(AK,AP,AM){var AO=this,AL=this.getLayoutDataCache(this.getCurrentLayoutKey()),AN={ifws:{},upd:{},tgts:{},def:{},secs:{}};function AJ(AX,AU,Ac){var AR=false,Ad=AO.getChildren(AX,true),Ae;if(!Ad.length){return ;}if(AU){Ae=mstrmojo.all[AX.id];AR=!AX.id||!!Ae;}var AY=AX.defn,AT=AX.data,Ab;if(AY&&AY.t===p.PANELSTACK&&AY.od){Ab=AT.selKey;}for(var AW in Ad){var AQ=Ad[AW],AV=AQ.k,AS=AQ.id,Aa=null;if(mstrmojo.all[AS]){AR=true;}if(AV in AP){if(P.call(AO,AV)&&n(AQ.data,AM)){AL[AS]=AQ;if(!Ac){AN.ifws[AV]=AO.infoWinByKey[AV].id;}}Aa=AV;if(AR){if(Ab&&Ab!==AV){continue;}if(!Ac){AN.tgts[AS]=true;}var Af=Ae&&Ae.defn,AZ=Af&&Af.t,Ag=Af&&Af.ck;if(AZ===p.SUBSECTION&&(Ag&&(AV in Ag))){AN.secs[Ae.id]=true;}}}if((Ac||Aa)&&(!Ab||Ab===AV)){AL[AS]=AQ;AN.def[AV]=true;if(AR){AN.upd[AS]=true;}}AJ(AQ,AR,Ac||Aa);}}if(AK&&AK.layouts&&AP){AJ(mstrmojo.array.filter(AK.layouts,function(AQ){return(AQ.loaded);},{max:1})[0],true);}return AN;},getCGBMap:function b(){var AJ=G(this.defn,this.currlaykey);return AJ&&AJ.cgbMap;},executeLink:function Q(AJ,AL,AM){if(AJ.indexOf("prevMsgID")>0){var AK="prevMsgID="+this.mid;AJ=AJ.replace(/prevMsgID=0($|&)/g,function(AN,AO){if(AO=="&"){return AK+="&";}else{return AK;}});if(mstrmojo.dom.isIE){AJ+="&cb"+mstrmojo.now()+"=1";}}AJ=mstrmojo.addCSRFTokenToURL(AJ);this.controller.onLink(this,{url:AJ,target:AL,src:AM||null});},showInfoWin:function Y(AM,AL,AJ,AN,AO){var AK=this.infoWinByKey&&this.infoWinByKey[AM];if(AK===undefined){return ;}this.raiseEvent({name:"showInfoWin",psId:AK.id,psKey:AK.k,anchor:AL,anchorOrientation:AJ,anchorPosition:AO,invalidate:AN});},downloadGridData:function k(AO){var AM=this,AL=AO.xtabId,AK=AO.memo,AJ=mstrmojo.all[AL],AN=this.getDataService();var AP=this.newCallback({success:function(AT){function AX(Ac,Ad){var Aa=AM.getChildren(Ac,true);for(var AZ in Aa){var Ab=Aa[AZ];if(Ad==Ab.id){return Ab;}var AY=AX(Ab,Ad);if(AY){return AY;}}return null;}var AQ=AT.data,AW=null,AV,AR=AQ&&G(AQ,AM.currlaykey);if(AR){AW=AX(AR,AL);}if(AW&&AJ){AJ.dataDownloaded(AW,AK);}if(AR&&AR.xtabStyles){AM.raiseEvent({name:"updateStyles",key:AR.k,updatedStyles:AR.xtabStyles});}AV=H.call(AM,AM.defn,AM.currlaykey,AO.nodeKey);if(AV&&AV.t===p.GRIDGRAPH&&AK.recalculating){var AS=AJ.parent,AU=AS&&AS.getGraphWidget();if(AS&&AU&&AS.updateGraph){AS.updateGraph(AX(AR,AU.id));}}},failure:function(){if(AJ.dataDownloadErr){AJ.dataDownloadErr();}}});AN.downloadGridData(AO,AP);},saveRWProps:function AD(AK,AO,AP,AM,AR){var AJ=[],AN="\u001F";t(AO,function(AT,AS){t(AT,function(AU,AV){AJ.push(AS+AN+AV+AN+AU);});});if(!AJ.length){return ;}if(AM){var AL=H.call(this,this.defn,this.currlaykey,AK),AQ=function(AS){AL.set("readyState",AS);};AR=O(AR,{submission:function(){AQ(J.WAITING);},complete:function(){AQ(J.IDLE);}});}this.getDataService().setRWUnitProperties(AK,AJ.join("\u001E"),AP||1,AM,AR);},loadPartialData:function I(AO,AK){var AM={};AM[AK]=H.call(this,this.defn,this.currlaykey,AK);var AL=this.updateDataCache(AO,AM),AJ=this.getLayoutDataCache(this.getCurrentLayoutKey()),AN=this;mstrmojo.array.forEach(AO.layouts,function(AP){if(AP&&AP.xtabStyles){AN.raiseEvent({name:"updateStyles",key:AP.k,updatedStyles:AP.xtabStyles});}});t(AL,function(AQ,AP){if(AP==="upd"){t(AQ,function(AS,AT){var AR=mstrmojo.all[AT];if(AR&&AR.update){AR.update(AJ[AT]);}});}});},addAutoWidthID:function g(AL){var AK=this.aws||{},AJ=AK[this.currlaykey]||[];AJ.push(AL);AK[this.currlaykey]=AJ;this.aws=AK;},getAutoWidthIDs:function M(){var AL=this.aws,AJ=this.currlaykey;var AK=AL&&AL[AJ];if(AK){delete AL[AJ];}return AK;}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocDataService");mstrmojo.OIVMViewFactory=mstrmojo.declare(mstrmojo.OIVMViewFactory,null,{scriptClass:"mstrmojo.OIVMViewFactory",newDocDataService:function A(B){return new mstrmojo.DocDataService(B);}});}());(function(){var Q="<tr>";var Y=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var T="&nbsp;";var I="fsbp_1 ";var X="fsbp_2 ";var B="fsbp_3 ";var V=1,W=2,F=3,K=4,A=5,S={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" no-stack",5:" stack-full"};var Z=mstrmojo.css;var L=4;function E(g,f){for(var h=0,b=g.length;h<b;h++){var k=g[h];var j=f.rows[k.rows].cells[k.cells];if(j){mstrmojo.css.addClass(j,I);}}}mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function J(b){this._super(b);},numColumnCanMerge:0,preBuildRendering:function D(b){var f=this.cp;if(!f){return ;}f.initContent();this.rc=f.rc||0;this.cws=f.colWidths||[];this.cc=this.cws.length;this.tdWidths=f.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=f.getNumAutoHeightRows&&f.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function H(f){var b=this._super(f);this.renderGrid();return b;},renderGrid:function R(f){var b=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(b,f);this.postBuildGridTable();},getGridContainer:function a(){return this.gridContainerNode;},buildGridTable:function G(g,b){var f=this.getTableStartMarkup();var n=this.getTableEndMarkup();if(b){this.mergeHdrsAcrossBlks=true;}var k=this.buildTableRowsMarkup(this.start,this.end,f,n).join("");if(b){var i=document.createElement("div");i.innerHTML=k;var l=g.firstChild,o=l&&l.tBodies,h=i.firstChild.tBodies[0],j=this.matchedHdrsAcrossBlks;l.appendChild(h);if(j&&j.length>0){E(j,o[o.length-2]);}}else{g.innerHTML=k;}},getTableStartMarkup:function O(){var f=this._getGridWidths(),b=Y;b[1]=f.tableLayout;b[3]=f.totalColWidths;b[5]=this.tableCssClass?"class="+this.tableCssClass:"";b[7]="<colgroup>"+f.colgroup+"</colgroup>";if(this.tbodyStyle){b[8]='<tbody style="'+this.tbodyStyle+'">';}return b.join("");},getTableEndMarkup:function N(){return"</tbody></table>";},_getGridWidths:function U(){var o={};var j="",g=[],n="fixed",f=this.cws,k=f.length;if(k){j=0;g=[];for(var h=0;h<k;h++){if(f[h].w!==""){j+=parseInt(f[h].w,10);}}for(h=0;h<k;h++){var b=f[h];if(b.w!==""){var l=parseInt(b.w,10);if(mstrmojo.dom.isIE7){if(l===0){g.push('<col style="width:0%;display:none"></col>');}else{g.push('<col style="width:'+(l/j*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&l===0){g.push('<col style="width:-1px"></col>');}else{g.push('<col style="width:'+b.w+'"></col>');}}}else{g.push("<col />");n="auto";}}this.totalColWidth=j;}o.colgroup=g.join("");n=this.tableLayout||n;if(this.autoFitWindow){n=this.tableLayout||n||"fixed";j="100%";}else{if(n=="fixed"){j+="px";}else{j="auto";}}o.totalColWidths=j;o.tableLayout=n;return o;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function P(z,k,AX,f){var AL=[],AV=0;AL[AV++]=AX||"<table><tbody>";var AA=this.cp,AF=AA.getRowHeight(),AT=this._CELL_MARKUP,AK=AF?'<tr style="height:'+(AF?AF+"px":"")+'">':Q;var h=true,w=true,AR=[],AN;this.matchedHdrsAcrossBlks=[];for(var AO=z;AO<=k;AO++){AN=AV++;AL[AN]=AO<this.numAutoHeightRows?Q:AK;var o=AA.getRowCells(AO);var AJ=k+1-AO;var AI=0;if(!this.mergeHdrsAcrossBlks){if(h&&z>0&&o.length<AA.colWidths.length){var AH=AA.getUnmergedCells(z);if(AH){AI=AH.length;}for(var AU in AH){var AQ=AH[AU];if(AQ.rs>AJ){AT[1]=AJ;AT[5]=X+AQ.css;}else{AT[1]=AQ.rs||1;AT[5]=B+AQ.css;}if(AQ.cet){AT[5]+=" mstrmojo-selected-cell";this.addHilitePosition(AQ.cet,AO,AU);}if(AQ._ei){this.addExtraInfoMap(AQ._ei,AO,AU);AT[5]+=" pt";}AT[9]="";AT[13]=T;AT[3]=AQ.cs;AT[7]=AQ._ei!==undefined?AQ._ei:"";AL[AV++]=AT.join("");}h=false;}}for(var AW=0,l=o.length;AW<l;AW++){var AD=o[AW],AE;if(AD.rs&&AD.rs>AJ){AT[1]=AJ;AT[5]=I+AD.css;if(AD._ei){this.addExtraInfoMap(AD._ei,AO,AW);}}else{AT[1]=AD.rs||1;AT[5]=AD.css;}if(AD.rowType!==V){AT[5]+=" xtab-td ";}if(AD.cet){AT[5]+="sc_"+this.parent.k;this.addHilitePosition(AD.cet,AO,AW);}AE=AD.rowType;if(AE){AT[5]+=S[AE]||"";var n=AA.getRowHeight(AE);if(n){AL[AN]='<tr style="height:'+(n?n+"px":"")+'">';}}AT[3]=AD.cs||1;AT[7]=AD._ei!==undefined?AD._ei:"";if(AD.fs||AD._e){this.addTitleHeaderPositionMap(AO,AW+AI,AD);}if(AD._ei!=null){this.addPositionMap(AD._ei,AO,AW+AI);}AT[11]=AO;if(AD.ts===L){var s=AD.v;if(this.imgCacheMap){var AS=this.imgCacheMap,AM=s&&s.replace(/\\/g,"/");if(AS.cachedImg[AM]){AD.v=s=AS.baseURL+AS.cachedImg[AM];}else{if(AM&&!AS.unCachedImg[AM]){AS.unCachedImg[AM]=AM;}}}else{var g=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(g&&g.getImage){s=g.getImage(s);}}if(AD.rowType){var b=(AA.getRowHeight(AD.rowType)||AA.rh||AF),AP=b,x=this.tdWidths,AG=AD.colIdx,AB=0;if(AG!=="undefined"&&AG>-1&&x&&x.length>AG){var q=x[AG]&&x[AG].w;if(q!=="undefined"){AB=parseInt(q,10);}}var t=AB>30?(AB-30):0;AT[13]='<div><div style="top:'+(-parseInt(AP/2,10))+"px;height:"+b+"px;line-height:"+b+'px !important;">&nbsp;<img style="max-height:'+b+"px; max-width: "+t+'px;" src="'+s+'"></img></div></div>';}else{if(this.parent.gridData.lhv){AT[9]="background-image:url('"+s+"');background-repeat:no-repeat;background-position:center "+(AD.rs>1?"top":"center")+";";AT[13]=T;}else{AT[9]="";AT[13]='<img src="'+s+'"></img>';if(AD.css&&AD.css.indexOf("hl")>-1){AT[13]="<span>"+AT[13]+"</span>";}}}}else{AT[9]="";AT[13]=AD.v||AD.n||T;if(AD.css&&AD.css.indexOf("hl")>-1){AT[13]="<span>"+AT[13]+"</span>";}}if(AW<this.numColumnCanMerge){if(AO===z&&this.mergeHdrsAcrossBlks){var AC=this.rowHdsAcrossBlks;if(w&&AD.v&&AC&&AC[AW]){if(AD.v===AC[AW].v){AT[1]=AD.rs||1;AT[5]=B+AD.css;AT[13]="";this.matchedHdrsAcrossBlks.push(AC[AW]);}else{w=false;}}}if(AT[1]>=AJ&&AD.v){AR.push({rows:AO-z,cells:AW,v:AD.v});}}AL[AV++]=AT.join("");}AL[AV++]="</tr>";}AL[AV++]=f||"</tbody></table>";this.rowHdsAcrossBlks=AR;return AL;},addHilitePosition:function(f,g,b){var h=this.hiliteCellsMap[f];if(!h){this.hiliteCellsMap[f]={pos:[],nodes:[]};}this.hiliteCellsMap[f].pos.push({row:g,cell:b,page:0});},addExtraInfoMap:function(f,b,g){if(!this.eiMap[f]){this.eiMap[f]=[];}this.eiMap[f].push({row:b,cell:g,page:0});},addPositionMap:function(f,b,g){if(!this.posMap[f]){this.posMap[f]={row:b,cell:g,page:0};}},addTitleHeaderPositionMap:function(b,g,f){this.thPosMap.push({row:b,cell:g,page:0,obj:f});},clearHilites:function(o){var h=this.hiliteCellsMap[o],j=h&&h.nodes,l=this.parent;if(j){if(j.length==0&&h.pos){j=this.getNodesByPositions(h.pos);}for(var g=0,b=j.length;g<b;g++){var f=j[g],k=f.className,n=l.getCellForNode(f);if(n){delete n.cet;}Z.removeClass(f,"sc_"+l.k);}this.hiliteCellsMap[o].nodes=[];}},setHilites:function(f,g){Z.addClass(g,"sc_"+this.parent.k);if(!this.hiliteCellsMap[f]){this.hiliteCellsMap[f]={pos:[],nodes:[]};}this.hiliteCellsMap[f].nodes.push(g);var b=this.parent.getCellForNode(g);if(b){b.cet=f;}},getNodesByPositions:function(j){var h=this.tableNode,b=[];for(var g in j){var f=j[g];b.push(h.tBodies[0].rows[f.row].cells[f.cell]);}return b;},preBuildGridTable:function C(){},postBuildGridTable:function M(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});}});})();(function(){var regExH=/"height", "[0-9.]+"/g;var regExW=/"width", "[0-9.]+"/g;var regExH1=/height="?[0-9.]+"?/g;var regExW1=/width="?[0-9.]+"?/g;mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._IsSelectorTarget");mstrmojo.DocVisualization=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocVisualization",markupString:'<div id={@id} class="mstrmojo-docvisualization" title="{@tooltip}" style="{@domNodeCssText}">{@htmlText}</div>',formatHandlers:{domNode:["RW","T","B","fx"]},update:function update(node){if(this._super){this._super(node);}var d=node.data;this.htmlText=d.htmlText;this.jsText=d.jsText;this.selData=d.selData;this.ctrLink=d.ctrLink;this.vp=d.vp;this.eg=d.eg;if(this.eg){this.htmlText=this.eg;}},preBuildRendering:function(){if(this._super){this._super();}var fmts=this.getFormats();if(!fmts){return ;}var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(this.jsText){this.jsText=this.jsText.replace(regExH,'"height", "'+h+'"').replace(regExW,'"width", "'+w+'"');}},postBuildRendering:function pstBldRnd(){if(this._super){this._super();}eval(this.jsText);},resize:function(){if(this.eg){return ;}var embedNode=this.domNode.firstChild.firstChild.firstChild;if(!embedNode){return ;}var fmts=this.getFormats();var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(mstrmojo.dom.isIE){embedNode.firstChild.setAttribute("height",h);embedNode.firstChild.setAttribute("width",w);}else{embedNode.innerHTML=embedNode.innerHTML.replace(regExH1,'height="'+h+'"').replace(regExW1,'width="'+w+'"');}},makeSelections:function(selections){var shuffledData={},i,j,attId,e;for(i=0;i<selections.length;i++){var attIdI=selections[i].attId;if(!shuffledData[attIdI]){shuffledData[attIdI]=[];}shuffledData[attIdI]=shuffledData[attIdI].concat(selections[i].values);}var sep="\u001E",sep1="\u001F";var ckJoined="",eidJoined="",cklJoined="";var tksArray=[];for(attId in shuffledData){var sd=this.getSelectionData(attId);if(!sd){continue;}var ctrLink=this.ctrLink[attId];var values=shuffledData[attId];if(sd&&values&&values.length>0){sd.sel=values;sd.ias=false;for(e in values){if(e==="u;"){sd.ias=true;break;}}}if(ctrLink.gbTargets){var t=ctrLink.targets=[],gbt=ctrLink.gbTargets,cgbmap=this.model.getCGBMap();for(j=0;j<gbt.length;j++){var targetKey=cgbmap[gbt[j]];if(targetKey){t.push(targetKey);}}delete ctrLink.gbTargets;}ckJoined+=ctrLink.ctxt+sep1;eidJoined+=values.join(sep)+sep1;cklJoined+=ctrLink.ck+sep1;tksArray=tksArray.concat(ctrLink.targets);}ckJoined=ckJoined.substring(0,ckJoined.length-1);eidJoined=eidJoined.substring(0,eidJoined.length-1);cklJoined=cklJoined.substring(0,cklJoined.length-1);if(tksArray.length==0){return ;}var evt={ck:ckJoined,eid:eidJoined,src:this.k,tks:tksArray.join(sep),type:this.defn.t,ctlKey:cklJoined,include:true,isDocVis:true};this.model.slice(evt);},getAllSelectionData:function(){return this.selData;},getSelectionData:function(attId){var selData=this.selData,k;if(selData&&selData.attl){var attl=selData.attl;if(attId){return attl[attId];}else{for(k in attl){return attl[k];}}}},saveVisProps:function(widgetPropsXml){var props={};props[this.k]={FormattingWidget:"WidgetProps\u001F"+widgetPropsXml};mstrApp.docModel.saveRWProps(this.k,props,1,false,{success:function(){}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRoundRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRoundRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRoundRectangle" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocRoundRectangle-l1" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div style="{@rectNodeCssText}{@rectNodeGradCssText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l1" style="{@bCornersCssText}{@bCornersCssGradText}"></div></div>',markupSlots:{rectNode:function(){return this.domNode.childNodes[3];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["top","left","width","z-index","fx"],rectNode:["height","background-color"],tCorners:["background-color"],bCorners:["background-color"]},update:function C(D){if(this.thresholdId||D.data.tid){delete this.fmts;}this.thresholdId=D.data.tid;this.set("visible",!D.data.hidden);},preBuildRendering:function B(){var F=this._super();var G=this.getFormats(),D=!!this.defn.topc,I=(D)?4:8,H="(\\d*px)",E=Math.max(parseInt(G.height,10)-I,0);if(G.height==="100%"){H="(100%)";E=this.parent.height()-I;}this.rectNodeCssText=this.rectNodeCssText.replace(new RegExp("(.*height:)"+H+"(.*)"),"$1"+E+"px$3");if(D){this.bCornersCssText="display:none;";}return F;},formatGradient:function A(E,H){var F=mstrmojo.css.buildGradient(E.t,E.sc,E.ec);if(!F){return ;}var D=F.n+":"+F.v+";",G="background-color:";this.rectNodeGradCssText=D;if(E.t===0){this.tCornersCssGradText=G+E.sc+";";this.bCornersCssGradText=G+E.ec+";";}else{this.tCornersCssGradText=this.bCornersCssGradText=D;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onidxChange:function(){var B=this.domNode.getElementsByTagName("select");if(B&&B.length){B[0].selectedIndex=this.idx;}},onvalueChange:function(D){var H=this.selectNode,F=H.options,E=this.value,C;for(var G=0;G<F.length;G++){var B=F[G].value==E;if(B){C=G;if(E!=""){mstrmojo.css.toggleClass(F[G],"selected",B);}break;}}if(H.length>0&&C>0&&this.unset){H.remove(0);C--;this.unset=false;}this.set("idx",C);},onwidthChange:function(){if(this.width>=0){this.selectNode.style.width=this.width+"px";}}},onselectedChange:function(){var B=this.selectNode;if(B){this.set("value",B.value);}},preBuildRendering:function A(){var C=[];var B=-1;if(this.unset){this.idx=0;}var G=this.options;for(var E=0,D=(G&&G.length)||0;E<D;E++){var H=G[E];var F="";if(this.idx==E){this.selected=H.v;this.value=H.v;F=' selected="true" class="selected"';}C[++B]='<option value="'+H.v+'"'+F+">"+H.n;}this.renderedOptions=C.join("</option>");return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",text:null,markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" mstrAttach:click></div>',cssDisplay:"block",markupMethods:{ontextChange:function(){this.domNode.innerHTML=(this.text!=null)?this.text:"";},oncssTextChange:function(){this.domNode.style.cssText=(this.cssText!=null)?this.cssText:"";},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},autoHide:false,_set_text:function A(D,B){if(this.autoHide){this.set("visible",(B!=null)&&(B!==""));}var C=this.text;this.text=B;return C!=B;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var F=mstrmojo.array,C=mstrmojo.css,G=mstrmojo.string,B=mstrmojo.dom,A="unselected",D="inline-block";mstrmojo.ImageToggle=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ImageToggle",unset:null,useAnimation:true,markupString:'<div class="mstrmojo-ImageToggle {@cssClass}" style="{@cssText}" tabindex="{@tabIndex}"  mstrAttach:click,blur,keydown ></div>',tabIndex:0,markupMethods:{onimageListChange:function(){var O=this.imageList&&this.imageList.slice(),L=this,M=this.unset,K,N,J;if(!G.isEmpty(M)&&O){O.push({n:M,v:M,_ust:true});}if(this.domNode&&O){L.domNode.innerHTML="";L.domNode.style.minHeight=Math.min(20,L.height)+"px";L.domNode.style.minWidth=Math.min(20,L.width)+"px";L._loadedImgs=O.length;mstrmojo.array.forEach(O,function(Q,P){N=document.createElement("div");N.style.cssText="display:none;font-size:0px !important;line-height:"+L.height+"px !important;";J=document.createElement("img");J.alt=J.title=Q.v;J.style.verticalAlign="middle";J.style.maxHeight=L.height+"px";J.style.maxWidth=(L.width-1)+"px";if(!mstrmojo.dom.isIE){J.onerror=function(){this.src="../images/image_not_found.jpg";};}N.appendChild(J);L.domNode.appendChild(N);J.src=Q.n||"../images/image_not_found.jpg";if(Q._ust){L.ustImgIdx=P;}L._imgs[P]=N;});this._setSelectedValue();}},onvalueChange:function(){this._setSelectedValue();}},imageList:null,value:null,selectedIndex:-1,preBuildRendering:function E(){if(this._super){this._super();}this._imgs=[];},_setSelectedValue:function H(){var L=this,K=this.selectedIndex,N=this.imageList;if(N){if(N[K]){L._imgs[K].style.display="none";}F.forEach(this.imageList,function(O,P){if(O.v==L.value){C.removeClass(L.domNode,A);L.selectedIndex=P;L._imgs[P].style.display=D;return ;}});if(this.selectedIndex===-1){if(!this.unset){C.addClass(this.domNode,A);}else{var M=this._imgs[this.ustImgIdx],J=M.lastChild;J.alt=J.title=this.value;M.style.display=D;}}}},onclick:function I(){var L=this.imageList,M=L&&L.length,N=300,T=this.selectedIndex,K=T,J=this.domNode,R,Q,P,S,O=this;P=(T===-1&&this.ustImgIdx!==null)?this._imgs[this.ustImgIdx]:this._imgs[T];T=(T+1)%M;S=this._imgs[T];C.removeClass(J,A);this.selectedIndex=T;if(this.useAnimation){Q=new mstrmojo.fx.FadeIn({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:S,preStart:function(){this.target.style.display=D;}});R=new mstrmojo.fx.FadeOut({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:P,onEnd:function(){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}Q.play();}});if(P){R.play();}else{Q.play();}}else{if(P){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}}S.style.display=D;}this.value=this.imageList[T].v;},onkeydown:function(K){var J=K.hWin,L=K.e||J.event;if(L.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(J,L);this.onclick();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.css");var n=function(){return mstrmojo.locales.datetime;},W=mstrmojo.dom,U=mstrmojo.expr,k=U.DTP,P=mstrmojo.date,G=mstrmojo.publisher,R=mstrmojo.hash,Y=mstrmojo.array,J=Y.removeIndices,X=mstrmojo.css;var E='<table border="0" cellpadding="0" cellspacing="0">',h="</table>";function K(p){return'<table border="0" cellpadding="0" cellspacing="0" style="'+p+'">';}function F(t,p,q){var s=P.getFirstDateOfMonth(t,p);return(s.getDay()-q+8)%7;}function Z(w){var s=P.parseDateAndOrTime(w),x,p,q;if(s){q={};x=s.date;p=s.time;if(x){R.copy(x,q);}if(p){R.copy(p,q);}}return q;}function D(q,w,t,s,p){var x=P.formatDateInfo({day:q,month:w,year:t},n().DATEOUTPUTFORMAT);return P.inDateTimeRange(x,s,p)==0;}function N(w,t,s){var q=w.decreaseButton,p=w.increaseButton,z="mstrmojo-Calendar",x=function(AD,AC,AA){var AB=!D(AA.d,AA.m,AA.y,w.min,w.max);AD.className=(z+AC)+(AB?" disabled":"");AD.disabled=AB;};x(q,"-decrease",t);x(p,"-increase",s);}function O(w,q,z,t){var s=0,p=w.length,x;for(s=0;s<p;s++){x=w[s];if(x&&x.day===q&&x.month===z&&x.year===t){return s;}}return -1;}function b(p,s,q){var t=new Date();return(t.getFullYear()==q)&&((t.getMonth()+1)==s)&&(t.getDate()==p);}function g(AA,AB){var AF=AA.dayView.getElementsByTagName("div"),AD=AA.selectedDates,s=AD[AB],AE=AA.browseYear,q=AA.browseMonth,w=P.getDaysOfMonth(AE,q),t=P.getPreMonth(AE,q),z=P.getDaysOfMonth(t.y,t.m),p=F(AE,q,AA.firstDayOfWeek),x=((s.month==q)?s.day+p-1:(s.month>q?s.day+p+w-1:p-z+s.day-1)),AC=AF[x];if(AC){Q(AC,AA,false);}J(AD,AB,1);}function A(p){var q=p.selectedDates;while(q.length){g(p,0);}}function o(s,p){var q=H(s,p),t=s.selectedDates;t.push({day:q.d,month:q.m,year:q.y});Q(p,s,true);}function a(s,t){if(!t||!t.length){return null;}var x=s.selectedDates;for(var q=0,p=t.length;q<p;q++){var w=t[q],z=f(s,w);x.push({day:w.d,month:w.m,year:w.y});if(z){Q(z,s,true);}}}function f(AB,AD){var AF=AB.dayView.getElementsByTagName("div"),t=AF.length,AE=AB.browseYear,q=AB.browseMonth,w=P.getPreMonth(AE,q),x=P.getDaysOfMonth(w.y,w.m),AJ=P.getNextMonth(AE,q),s=P.getDaysOfMonth(AE,q),p=F(AE,q,AB.firstDayOfWeek);var z=p>0?{y:w.y,m:w.m,d:AF[0].innerHTML}:{y:AE,m:q,d:AF[0].innerHTML},AH=(AF.length-s-p)>0?{y:AJ.y,m:AJ.m,d:AF[t-1].innerHTML}:{y:AE,m:q,d:AF[t-1].innerHTML},AI=M(z,AD),AA=M(AD,AH),AC=null;if(AI>=0&&AA>=0){var AG=0;if(AI<p){AG=-1;}if(AA<(AF.length-p-s)){AG=1;}AC=((AG==0)?AD.d+p-1:(AG==1?AD.d+p+s-1:p-x+AD.d-1));return AF[AC];}else{return null;}}function T(AB,p){var AD=AB.selectedDates,s=AD.length;if(!s){return null;}var q=AD[s-1],t=H(AB,p),AG=M({y:q.year,m:q.month,d:q.day},t),AH=[],x=AG>0,AE=Math.abs(AG);for(var AA=0;AA<=AE;AA++){var z=new Date(t.y,t.m-1,t.d);z.setDate(z.getDate()+(x?-AA:AA));var AF=z.getFullYear(),w=z.getMonth()+1,AC=z.getDate();if(AB.isDateDisabled(AC,w,AF,AB.min,AB.max)){continue;}AH.push({y:AF,m:w,d:AC});}return AH;}function M(t,s){var p=new Date(t.y,t.m-1,t.d),q=new Date(s.y,s.m-1,s.d);return(q-p)/1000/3600/24;}function H(q,p){var s=q.browseYear,w=q.browseMonth,t=parseInt(p.innerHTML,10),x=parseInt(p.getAttribute("m"),10);ymd=null;ymd=(x===0)?{y:s,m:w}:(x===1?P.getNextMonth(s,w):P.getPreMonth(s,w));ymd.d=t;return ymd;}function V(p){var s=p.selectedDates,q=s.length;return(q===0)?null:s[q-1];}function Q(q,s,p){var t=s.selectedColor;X.toggleClass(q,["selected",s.selectedCssStyle],p);q.parentNode.style.backgroundColor=p?t:"";q.style.backgroundColor=p?t:"";}function j(p){return p.selectedColor?('style="background-color:'+p.selectedColor+';"'):"";}function L(p){return(p.tagName.toLowerCase()=="td")?p.firstChild:p;}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:"day",duration:600,timeDelimiter:":",dtp:k.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,okLabel:mstrmojo.desc(1442,"OK"),monthNames:function(p){return n().MONTHNAME_SHORT[p];},dayNames:function(p){return n().dayShortNames[p];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-comma">,</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span></div><div class="mstrmojo-Calendar-tools"><div class="mstrmojo-Calendar-ok"> {@okLabel} </div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===k.TIMESTAMP||this.dtp===k.TIME)?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:function(){this.tools.style.display=(this.changeValueOnOK?"block":"none");}},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].childNodes[1];},yearView:function(){return this.domNode.childNodes[1].lastChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},tools:function(){return this.domNode.childNodes[3];},okButton:function(){return this.domNode.childNodes[3].firstChild;}},init:function l(p){if(this._super){this._super(p);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};},getSelectedDatesAsString:function C(q){var p=[];Y.forEach(this.selectedDates,function(s){p.push(P.formatDateInfo(s,q||n().DATEOUTPUTFORMAT));});return p;},updateSelectedDate:function I(){var p=this.value,q=this.timeVal,t=this.selectedDates,s,w=function(z,x){z.set("browseYear",x.year);z.set("browseMonth",x.month);z.updateTimePart();z.updateView(z.currentView);};if(t.length===0){if(p){s=Z(p);if(s&&s.hour!==undefined){q.hour=s.hour;q.min=s.min;q.sec=s.sec;}}if(!s){s=P.getDateJson(new Date());}if(this.isDateDisabled(s.day,s.month,s.year,this.min,this.max)){if(this.min&&P.compareDate(s,this.min)<0){s=Z(this.min);}else{if(this.max&&P.compareDate(s,this.max)>0){s=Z(this.max);}}}t.push(s);w(this,s);}else{s=t[0];if(this.value!=null){w(this,s);}}},updateValue:function S(){var q=V(this),p="";if(q){p=P.formatDateInfo(q,n().DATEOUTPUTFORMAT);if(this.dtp!==k.DATE){p+=" "+P.formatTimeInfo(this.timeVal,n().TIMEOUTPUTFORMAT);}}this.lastValue=p;this.set("value",p);if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function i(){var q=this.timeVal,p=q.hour||0,s=(p%12===0)?12:(p%12);this.hourLabel.innerHTML=p<12?s+n().AM_NAME:s+n().PM_NAME;this.minuteLabel.innerHTML=P.formatInteger(q.min||0,2);this.secondLabel.innerHTML=P.formatInteger(q.sec||0,2);},premousedown:function(p){var s=p.e,q=W.eventTarget(p.hWin,s);if(q===this.decreaseButton||q===this.increaseButton){if(W.isFF){W.stopPropogation(window,s);}return true;}else{return this.processEvent(q,s);}},premouseup:function(p){var s=p.e;if(s.ctrlKey||s.shiftKey){W.clearBrowserHighlights();}var q=W.eventTarget(p.hWin,s);if(q===this.decreaseButton&&!q.disabled){this.decrease();return true;}if(q===this.increaseButton&&!q.disabled){this.increase();return true;}},processEvent:function(AG,AN){var x=this.currentView,z=this.selectedDates,p=V(this),AD,AI,AO,q,AF;if(AG===this.okButton&&this.changeValueOnOK){this.updateValue();}if(AG===this.monthLabel){if(x!=="month"){this.switchViewTo("month");}return true;}if(AG===this.yearLabel){if(x!=="year"){this.adjustYearStart();this.switchViewTo("year");return true;}}if(AG===this.hourLabel){if(x!=="hour"){this.switchViewTo("hour");}return true;}if(AG===this.minuteLabel){if(x!=="minute"){this.switchViewTo("minute");}return true;}if(AG===this.secondLabel){if(x!=="second"){this.switchViewTo("second");}return true;}if(W.contains(this.hourView,AG,false,this.domNode)){var AB=AG.getAttribute("h");AF=parseInt(AG.innerHTML,10);if(!isNaN(AB)&&!isNaN(AF)){AB=parseInt(AB,10);this.timeVal.hour=AF%12+AB*12;this.updateTimePart();this.switchViewTo("day");if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.minuteView,AG,false,this.domNode)){AF=parseInt(AG.innerHTML,10);if(!isNaN(AF)){this.timeVal.min=AF;this.updateTimePart();this.switchViewTo("day");if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.secondView,AG,false,this.domNode)){AF=parseInt(AG.innerHTML,10);if(!isNaN(AF)){this.timeVal.sec=AF;this.updateTimePart();this.switchViewTo("day");if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.dayView,AG,false,this.domNode)){var AM=this.browseYear,s=this.browseMonth,w;AG=L(AG);AO=parseInt(AG.innerHTML,10);q=parseInt(AG.getAttribute("m"),10);if(!isNaN(AO)&&!isNaN(q)){w=(q===0)?{y:AM,m:s}:(q===1?P.getNextMonth(AM,s):P.getPreMonth(AM,s));if(this.isDateDisabled(AO,w.m,w.y,this.min,this.max)||AN.button==2){return true;}var AJ=O(z,AO,s,AM),AH=z.length>1,AE=this.forceNonEmptySelection,AK=this.isMultiSelect,AC=AK&&AN.ctrlKey,AL=AK&&AN.shiftKey,AA=null;if(AL){AA=T(this,AG);A(this);a(this,AA);}else{if(AC){if(AJ===-1){o(this,AG);}else{if(!AE||AH){g(this,AJ);}}}else{A(this);if(AH||AJ===-1||AE){o(this,AG);}}}if(this.onselect||G.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(q===1){this.increase();}else{if(q===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}}return true;}if(W.contains(this.monthView,AG,false,this.domNode)){AG=L(AG);AI=parseInt(AG.getAttribute("m"),10);if(!isNaN(AI)){this.set("browseMonth",AI+1);this.switchViewTo("day");}return true;}if(W.contains(this.yearView,AG,false,this.domNode)){AG=L(AG);AD=parseInt(AG.innerHTML,10);if(!isNaN(AD)){this.set("browseYear",AD);this.switchViewTo("day");}return true;}return true;},decrease:function(){var s=this.currentView,x=s,w=this.browseYear,p=this.browseMonth,q=this.yearRangStart,t;switch(s){case"day":t=P.getPreMonth(w,p);this.set("browseMonth",t.m);this.set("browseYear",t.y);break;case"month":this.set("browseYear",w-1);break;case"year":this.yearRangStart=q-this.yearViewSize*this.yearViewSize;break;case"hour":x="second";break;case"minute":x="hour";break;case"second":x="minute";break;}this.switchViewTo(x,"right");},increase:function(){var s=this.currentView,x=s,w=this.browseYear,p=this.browseMonth,q=this.yearRangStart,t;switch(s){case"day":t=P.getNextMonth(w,p);this.set("browseMonth",t.m);this.set("browseYear",t.y);break;case"month":this.set("browseYear",w+1);break;case"year":this.yearRangStart=q+this.yearViewSize*this.yearViewSize;break;case"hour":x="minute";break;case"minute":x="second";break;case"second":x="hour";break;}this.switchViewTo(x,"left");},updateView:function(p){var q=this[p+"ViewHTML"]();this[p+"View"].innerHTML=q;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(q,t){var AA="mstrmojo-Calendar-"+q+"View",z=document.createElement("div"),p=this[this.currentView+"View"],w=q+"ViewHTML",x=this[this.currentView+"Label"],s=this[q+"Label"];if(!this.supportedViews[q]){return ;}if(!t){t=this.sDirMatrix[this.currentView][q];}z.className=AA;z.innerHTML=this[w]();this.currentView=q;if(x){mstrmojo.css.removeClass(x,["highlight"]);}if(s){mstrmojo.css.addClass(s,["highlight"]);}this[q+"View"]=z;this._slideIntoView(p,z,t);},_slideIntoView:function(z,AD,w){var q=this.bodyContainer,AB=(w==="left"||w==="right")?z.offsetWidth:z.offsetHeight,s=(w==="left"||w==="right")?"left":"top",AC=(w==="left"||w==="up")?AB:-AB,AA=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:z,onEnd:function(){q.removeChild(z);}}),x=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AD});AD.style[s]=AC+"px";q.appendChild(AD);AA.props[s]={start:0,stop:-AC,suffix:"px"};x.props[s]={start:AC,stop:0,suffix:"px"};AA.play();x.play();},dayViewHTML:function(){var x=this.browseYear,AB=this.browseMonth,AG=P.getDaysOfMonth(x,AB),AK=P.getPreMonth(x,AB),s=P.getDaysOfMonth(AK.y,AK.m),q=P.getNextMonth(x,AB),AC=F(x,AB,this.firstDayOfWeek),z=[],t=j(this),AM=0,p=this.selectedDates,AE=this.min,AI=this.max,AN,AF,AJ,AH,AL=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";N(this,{d:s,m:AK.m,y:AK.y},{d:1,m:q.m,y:q.y});z.push(K(this.cssTextDay));z.push(this._dayViewTHead());z.push("<tr>");for(AJ=0;AJ<AC;AJ++){AN=s-AC+AJ+1;AF=this.isDateDisabled(AN,AK.m,AK.y,AE,AI)?"disabled":"";z.push("<td "+AL+'><div class="mstrmojo-Calendar-day-pre '+AF+'" m="-1">');z.push(AN);z.push("</div></td>");AM++;}for(AJ=0;AJ<AG;AJ++){AN=AJ+1;AF=this.isDateDisabled(AN,AB,x,AE,AI)?" disabled":"";var w=b(AN,AB,x),AA=w?" today":"",AD=O(p,AN,AB,x)!==-1;AA=(this.hilightToday&&w)?" hilightToday":AA;z.push("<td "+(w?('class="'+AA+'" '):" ")+(AD?t:"")+'><div class="mstrmojo-Calendar-day-cur'+(AD?(" selected "):"")+AF+'" m="0"'+(AD?t:"")+">");z.push(AJ+1);z.push("</div></td>");if((++AM)%7===0){z.push("</tr><tr>");}}for(AH=AM;AH<42;AH++){AN=AM-AG-AC+1;AF=this.isDateDisabled(AN,q.m,q.y,AE,AI)?"disabled":"";z.push("<td "+AL+'><div class="mstrmojo-Calendar-day-next '+AF+'" m="1">');z.push(AN);z.push("</div></td>");if((++AM)%7===0&&AM!==42){z.push("</tr><tr>");}}z.push("</tr>");z.push(h);return z.join("");},_dayViewTHead:function(){var t=[],w='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',s="</tr></thead>",q=this.firstDayOfWeek-1,x=this.dayNames,p;t.push(w);for(p=q;p<q+7;p++){t.push("<td>");t.push(x(p%7));t.push("</td>");}t.push(s);return t.join("");},monthViewHTML:function(){var q=[],t=this.browseMonth-1,s=this.browseYear,p;N(this,{d:31,m:12,y:s-1},{d:1,m:1,y:s+1});q.push(K(this.cssTextMonth));q.push("<tr>");for(p=0;p<12;p++){q.push("<td "+((p===t)?j(this):"")+'><div class="mstrmojo-Calendar-month'+((p===t)?" selected":"")+'" m="');q.push(String(p));q.push('">');q.push(this.monthNames(p));q.push("</div></td>");if(p%3===2){q.push("</tr><tr>");}}q.pop();q.push("</tr>");q.push(h);return q.join("");},yearViewHTML:function(){var x=this.yearRangStart,q=[],t=this.browseYear,w,p,s=this.yearViewSize;N(this,{d:31,m:12,y:x-1},{d:1,m:1,y:x+s*s});q.push(K(this.cssTextYear));q.push("<tr>");for(p=0;p<s*s;p++){w=x+p;q.push("<td "+((t===w)?j(this):"")+'><div class="mstrmojo-Calendar-year'+((t===w)?" selected":"")+'">');q.push(w);q.push("</div></td>");if(p%s===(s-1)){q.push("</tr><tr>");}}q.pop();q.push("</tr>");q.push(h);return q.join("");},hourViewHTML:function(){var s=[],q=this.timeVal.hour,p;s.push(E);s.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');s.push(n().AM_NAME);s.push("</div></td></tr>");for(p=0;p<12;p++){s.push('<td><div class="mstrmojo-Calendar-hour'+((p===q)?" selected":"")+'" h="0">');s.push((p===0)?12:p);s.push("</div></td>");if(p===5){s.push("</tr><tr>");}}s.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');s.push(n().PM_NAME);s.push("</div></td></tr>");for(p=0;p<12;p++){s.push('<td><div class="mstrmojo-Calendar-hour'+(((12+p)===q)?" selected":"")+'" h="1">');s.push((p===0)?12:p);s.push("</div></td>");if(p===5){s.push("</tr><tr>");}}s.push("</tr>");s.push(h);return s.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(t,w){var q=[],p;q.push(E);q.push("<tr>");for(p=0;p<60;p++){q.push('<td><div class="');q.push(w);q.push((p===t)?' selected">':'">');q.push(p);q.push("</div></td>");if(p%10===9){q.push("</tr><tr>");}}q.pop();q.push("</tr>");q.push(h);return q.join("");},isDateDisabled:function(p,s,q){var t=P.formatDateInfo({day:p,month:s,year:q},n().DATEOUTPUTFORMAT);return !D(p,s,q,this.min,this.max);},unrender:function B(p){delete this.lastValue;this._super(p);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Widget");var A=mstrmojo.css;mstrmojo.TabButton=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.TabButton",markupString:'<span id="{@id}" class="mstrmojo-TabButton {@cssClass}" style="{@cssText}" mstrAttach:click></span>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},ontitleChange:function(){this.domNode.innerHTML=this.title||"";},onbackgroundColorChange:function(){this.domNode.style.backgroundColor=this.backgroundColor||"";},onselectedChange:function(){A.toggleClass(this.domNode,["selected"],!!this.selected);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRectangle" title="{@tooltip}" style="{@domNodeCssText}"></div>',markupMethods:{onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width+"px";}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["RW","B","background-color","fx"]},preBuildRendering:function A(){var D=this._super(),C=this.defn;if(C.r){this.domNodeCssText+=mstrmojo.css.buildRoundCorners(C.r,C.topc);}return D;},postBuildRendering:function(){var E=this._super();var D=this.fmts;if(D){var C=D.border||D["border-width"],F=C&&(parseInt(C,10)/72*this.model.dpi);if(F){if(D.height=="100%"){this.set("height",this.domNode.clientHeight-2*F);}if(D.width=="100%"){this.set("width",this.domNode.clientWidth-2*F);}}}return E;},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocLine=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocLine",markupString:'<div id="{@id}" class="mstrmojo-DocLine" title="{@tooltip}" style="{@domNodeCssText}"></div>',formatHandlers:{domNode:["RW","border-top","border-left","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}},getFormats:function A(){var C=this._super();if(C&&parseInt(C.height,10)===0){C.height="1px";}return C;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var P=mstrmojo.dom,B=mstrmojo.css,M=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var U=document.createElement("tr"),V=this.data,Y=this._cmSource,R,S;U.id=this.id;U.className="mstrmojo-ContextMenuItem "+(Y.isSeparatorItem(V)?"separator":Y.item2textCss(V));var W=this,X=function(){W.handleMouseOver();},T=function(){W.handleMouseOut();},Q=function(){W.handleClick();};P.attachEvent(U,"mouseover",X);P.attachEvent(U,"mouseout",T);P.attachEvent(U,"click",Q);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-text";if(Y.isSeparatorItem(V)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=V.itemWidget?"&nbsp":V[this.itemField];}R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return U;},buildRendering:function K(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){B.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){B.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=P.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function C(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function E(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function L(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function O(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,T=this._subMenu.domNode,S=T.offsetHeight,R=T.offsetWidth,W=P.windowDim(),V=P.position(T,false),U=P.position(T,true);if((V.x+R+M)>W.w){Q.set("left",(P.position(this.domNode,true).x-R)+"px");}if((V.y+S+M)>W.h){Q.set("top",(W.h-S-M+(U.y-V.y))+"px");}},handleMouseOver:function N(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function D(){this._cmSource.closeMenuTree();},handleClick:function F(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}else{}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var D=mstrmojo.dom,E=mstrmojo.hash,B=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){B[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){B[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.textNode.innerHTML=this.text;},onwidthChange:function(){var F=this.width;if(F){this.domNode.style.width=F;}}},oniconClassChange:function C(G){if(this.hasRendered&&this.domNode){var F=G.valueWas,H=G.value;this.domNode.className=this.domNode.className.replace(F,"")+" "+H;}},onclick:mstrmojo.emptyFn,ontouchend:function A(F){this.onclick(F);}});mstrmojo.Button.newIconButton=function(H,K,I,F,J){var G={scriptClass:"mstrmojo.Button",title:H,cssClass:K,text:"",onclick:I};if(F){G.bindings=F;}E.copy(J,G);return G;};mstrmojo.Button.newInteractiveButton=function(G,H,J,I){var F={scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",text:G,glowClass:"glow"};if(H){F.onclick=H;}if(J&&(D.isFF||D.isWK)){E.copy({onmousedown:function(){B.applyShadow(this.domNode,0,0,10,J);},onmouseup:function(){B.removeShadow(this.domNode);}},F);}E.copy(I,F);return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._ListSelections");mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onheightChange:function(){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width;}}},buildRendering:function E(){this.itemsHtml="";var F=this.items&&this.items.length;if(F){this.itemsHtml=this._buildItemsMarkup(0,F-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,_buildItemsMarkup:function(F,I,R,G,U,H){var V=[],N=0;V[N++]=R||"";var L=this.itemRenderer,Q=L&&L.render;if(Q&&typeof (Q)=="function"){var T=U||"",S=H||"",K=this.items,M=(K&&K.length)||0,O=this;for(var J=F,P=Math.min(I+1,M);J<P;J++){V[N++]=T;V[N++]=Q(K[J],J,O);V[N++]=S;}}V[N++]=G||"";return V;},onselectionChange:function A(P){if(!P){return ;}var M=this.itemRenderer;if(!M){return ;}var I=M.unselect,L=this.items||[],Q=P.removed,H,G;if(I&&Q){for(var J=0,R=Q.length;J<R;J++){H=Q[J];G=this._getItemNode(H);if(G){I(G,L[H],H,this);}}}var F=M.select,O=P.added;if(F&&O){for(var K=0,N=O.length;K<N;K++){H=O[K];G=this._getItemNode(H);if(G){F(G,L[H],H,this);}}}if(this.onchange){this.onchange();}},onselect:function B(F){if(this.makeSelection&&F.idxs&&F.idxs.length){var G=this._getItemNode(F.idxs[0]);this.makeSelection({selIdx:F.idxs[0],selItem:G});}},autoHide:false,init:function D(F){this._super(F);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},_getItemNode:function(F){var G=this.itemsContainerNode;return(G&&G.childNodes[F])||null;},_set_items:function C(I,F){if(this.autoHide){this.set("visible",!!(F&&F.length));}var H=this.items;this.items=F;if(H!=F){var G=this.hasRendered;if(G){this.unrender();}this.clearSelect();if(G){this.render();}return true;}else{return false;}return H!=F;}});})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl");mstrmojo.DefaultDIC=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DefaultDIC",isDummy:true,showInPopup:function(){mstrmojo.alert("The control style has not been supported yet.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo._HasChildren");var F=mstrmojo.publisher;mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",init:function I(L){this._super(L);if(this.children){this.initChildren();}var M=this.parent;if(!M||M.hasInitBindings){this.initBindings();}},destroy:function G(L){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(L);},unrender:function J(N){var O=this.children,L=(O&&O.length)||0,M;for(M=L-1;M>-1;M--){O[M].unrender(true);}this._super(N);},postBuildRendering:function K(){var L=this._super?this._super():undefined;if(L!==false){this.renderChildren();L=true;}return L;},renderChildren:function C(){var N=this.children,L=(N&&N.length)||0,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render(null);}}},childRenderCheck:function H(M){if(M&&!M.hasRendered){var L=M.slot||this.defaultChildSlot;return !!this[L];}return false;},addChildren:function E(O,M,N){var L=this._super(O,M,N);if(L){this.childRenderOnAddCheck(L);}return L;},removeChildren:function A(S,O){var R=S?[S]:(this.children||[]),L=R.length,P;for(P=L-1;P>-1;P--){var N=R[P],M=N&&N.domNode;if(M){var Q=this[(N.slot||this.defaultChildSlot)];if(M.parentNode===Q){Q.removeChild(M);}}}return this._super(S,O);},childRenderOnAddCheck:function B(N){if(this.hasRendered&&N){var L=N.length,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render();}else{if(O&&O.hasRendered){this.onchildRenderingChange(O);}}}}},preserveChildDomOrder:true,onchildRenderingChange:function D(M){var T=M&&M.domNode;if(!T){return ;}var N=this.defaultChildSlot,W=M.slot||N,O=this[W],L=this.children;if(!O){if(T.parentNode){T.parentNode.removeChild(T);}}else{if(T.parentNode===O){return ;}if(!this.preserveChildDomOrder){O.appendChild(T);}else{var P,R;for(R=L.length-1;R>=0;R--){var U=L[R];if(U===M){break;}if(W===(U.slot||N)){var V=U.domNode;if(V&&V.parentNode===O){P=V;}}}if(P){O.insertBefore(T,P);}else{O.appendChild(T);}}}if(F.hasSubs(this.id,"childrenRendered")){var S=L.length,Q;for(Q=0;Q<S;Q++){if(!L[Q].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}}});}());mstrmojo.ToolSeparator=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ToolSeparator",markupString:'<div class="mstrmojo-ToolSeparator {@cssClass}" style="{@cssText}"></div>',markupSlots:{},markupMethods:{}});(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.ProgressBar=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ProgressBar",markupString:'<div class="mstrmojo-ProgressBar {@cssClass}" style="{@cssText}"><div class="bar"><div class="indicator" style="display:inline-block"></div></div><div class="text">{@progressText}</div></div>',markupSlots:{barNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.lastChild;}},markupMethods:{onprogressTextChange:function(){this.textNode.innerHTML=this.progressText||"";}},updateProgress:function A(C,B){if(this.hasRendered){this.barNode.firstChild.style.width=Math.min(100,Math.max(0,parseInt(C,10)))+"%";if(B!==undefined){this.set("progressText",B);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocHTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocHTMLContainer",scrolling:"auto",markupString:'<iframe id="{@id}" class="mstrmojo-DocHTMLContainer" title="{@tooltip}" style="{@domNodeCssText}" src="{@v}" scrolling="{@scrolling}"></iframe>',formatHandlers:{domNode:["RW","B","F","background-color","text-align","white-space","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function A(B){this.v=B.data.v;if(mstrApp&&mstrApp.isTouchApp()){this.scrolling="no";}if(this.thresholdId||B.data.tid){delete this.fmts;}this.thresholdId=B.data.tid;this.set("visible",!B.data.hidden);}});})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var Z=mstrmojo.hash,h=mstrmojo.array,g=mstrmojo.boxmodel,b=mstrmojo.dom;function A(k,n,j){var l=k.listSelector;if(l){l[n](k,k.itemsContainerNode,j);}}function K(k,j){var l=k.lastPagePos;if(!l||l.dragId!==j){l=g.offset(k.itemsContainerNode);l.dragId=j;k.lastPagePos=l;var n=k.scrollboxNode;k.lastScrollPos={left:n.scrollLeft,top:n.scrollTop,width:n.clientWidth,height:n.clientHeight};}}function N(n,q,k){var l=q&&q.node;if(l===n.dropCueNode||l===n.dropCueNode.firstChild){return n.dropCuePos;}var o=n.listMapper;var j=o&&o.whereDrop(n,n.itemsContainerNode,l,q.pos,{left:n.lastPagePos.left-n.lastScrollPos.left,top:n.lastPagePos.top-n.lastScrollPos.top,width:n.lastScrollPos.width,height:n.lastScrollPos.height});var p=n.dropCuePos;return((k!==false)&&p&&j&&(p.idx===j.idx)&&(p.left===j.left)&&(p.top===j.top))?p:j;}var i="attachEventListener";function C(k,j){if(k.makeObservable){j=j||[];if(!j[i]){mstrmojo.hash.make(j,k.itemsScriptClass||mstrmojo.Arr);}}return j;}function G(k,j){if(j&&j[i]){k._sub_its=j;k._sub_add=j[i]("add",k.id,"preadd");k._sub_rmv=j[i]("remove",k.id,"preremove");}}function F(j){if(j._sub_its){var k=mstrmojo.publisher;k.unsubscribe(j._sub_add);k.unsubscribe(j._sub_rmv);delete j._sub_add;delete j._sub_rmv;delete j._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var k=this.dropCueNode,j=k&&k.style;if(!j){return ;}var n=this.dropCuePos,l=!!n;if(l){j.left=n.left+"px";j.top=n.top+"px";}j.display=l?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Y(n){this._super(n);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,p=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||p){this.initSelections(l,j,k,p);}if(this.postInitItems){this.postInitItems();}},initItems:function H(j){return C(this,j);},preBuildRendering:function V(){var o=this.listBuilder,s=o.newContext(this);this.ctxtBuilder=s;var k=this.markupSlots,n=!!(this.renderOnScroll&&this.renderBlockSize&&k&&k.scrollboxNode),l=this.items,j=(l&&l.length)||0,p=n?this.firstRenderBlockSize:j,q=n?this.firstRenderBlockSize:0;this._eros=n;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(l,o,this,s,p,q).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function D(){delete this.itemsHtml;var p=this.listMapper;if(p&&p.postBuildRendering){p.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}G(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var s=this.id;this._cb_scroll=function(){var n=mstrmojo.all[s];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],j=k.length;l<j;l++){var q=k[l],o=this[q];if(o&&o.constructor===Object){o=mstrmojo.insert(mstrmojo.hash.clone(o));o.widget=this;this[q]=o;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function W(n){F(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],j=l.length;k<j;k++){var o=this[l[k]];if(o&&o.isPlaying){o.cancel();}}this._super(n);},pauseScrollRendering:function O(l,j,k){if(l!==false){l=true;}if(this.paused===!!l){return ;}this.paused=!!l;if(l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(j,k);}},onscroll:function J(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var j=this;this._fillTmr=self.setTimeout(function(){j.fill();j=null;},50);}}if(this._super){this._super();}},fill:function a(j,o){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var p=(this.items&&this.items.length)||0;if(!p){if(o){o();}}else{var l=this.scrollboxNode,q=this.itemsContainerNode,n=mstrmojo.boxmodel.offset(q,l),t=this.listMapper,s=t.findScrollRange(q,p,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||l.scrollTop,l.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||l.scrollLeft,l.clientWidth,n.left,n.top);if(this.fillAt(s.start,s.end)){if(j){j();}var k=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[k].fill(j,o);},100);}else{if(o){o();}}}},fillAt:function L(l,k){var j=this.listMapper;if(j){return j.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,l,k,this.renderBlockSize);}else{return false;}},add:function Q(k,j){if(!k||!k.length){return -1;}var l=this.items;if(j==null){j=Z.min(this.selectedIndices,false,true);if(j!==null&&j!==undefined){j++;}}if(j==null||j===-1){j=(l&&l.length)||0;}if(l&&l.add){l.add(k,j);}else{this.set("items",l?h.insert(l.concat(),j,k):k);}return j;},preadd:function B(l){if(this.hasRendered){var p=this.listMapper;if(p){p.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var o=this.listBuilder;if(o){o.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var n=l.index,j=l.value.length;this.fillAt(n,n+j-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function T(j){if(j==null){return -1;}if(j.constructor!==Array){return this._remove(j);}var l=this.items;if(l){var k;if(l.remove){for(k=j.length-1;k>-1;k--){l.remove(j[k],1);}}else{l=l.concat();for(k=j.length-1;k>-1;k--){l.splice(j[k],1);}this.set("items",l);}return j[0];}return -1;},_remove:function T(l){var k=this.items;if(!k||(l==null)){return -1;}var j;if(!isNaN(l)){j=l;}else{j=this.itemIndex(l);}if(j>-1){if(k.remove){k.remove(j,1);}else{k=k.concat();k.splice(j,1);this.set("items",k);}}return j;},duplicate:function X(p,k,l){var n=this.items,j=-1;if(!n||(p==null)){return -1;}if(!isNaN(p)){if(k===null||k===undefined){k=p+1;}p=n[p];}else{if(k===null||k===undefined){k=this.itemIndex(p)+1;}}if(p){var o;o=Z.copy(l,Z.clone(p));j=this.add([o],k);}return j;},preremove:function M(k){if(this.hasRendered){var n=this.listMapper;if(n){n.onremove(this,this.itemsContainerNode,this.ctxtBuilder,k);}var l=this.listBuilder;if(l){l.onremove(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onremove(this,k);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(k);}if(this._super){this._super(k);}},move:function R(n,t){function q(x,w){return(t>=x)&&(t<=x+w);}var s=(this.items&&this.items.length)||0;if(t===-1||t==null||isNaN(t)){t=s;}else{t=Math.min(t,s);}var l,j,p,o;if(n.constructor===Array){j=n;p=n;o=(j&&j.length)||0;if(q(n[0],n.length)){return false;}l=h.get(this.items,n);}else{if(typeof (n)==="object"){l=[n];o=1;j=this.itemIndex(l[0]);p=[j];if(q(j,1)){return false;}}else{j=n;p=[n];o=1;if(q(j,1)){return false;}l=[this.items[j]];}}for(var k=0;k<o;k++){if(p[k]<=t){t--;}}if(l[0]!=null){this.remove(j);this.add(l,t);}return true;},itemIndex:function E(j){if(j==null){return -1;}var k=this.itemIdField;return k?h.find(this.items,k,j[k]):h.indexOf(this.items,j);},prechange:function S(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var n=0,j=k.length;n<j;n++){var p=k[n];if(p&&p.onchange){p.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function I(q,j){var p=this.items;j=this.initItems(j);this.items=j;if(p!==j){var o=this,l=function(){if(o.autoHide){o.set("visible",!!(j&&j.length));}o=null;},k=this.hasRendered;if(k){this.refresh(l);}else{l();}}return p!==j;},premousedown:function f(j){A(this,"premousedown",j);},premouseup:function P(j){A(this,"premouseup",j);},scrollTo:function U(k){var j,l=this.listMapper;if(l&&l.toItem){if(!isNaN(k)){j=k;}else{j=this.itemIndex(k);}if(j>=0){l.toItem(this,j);}}},draggable:false,getDragData:function(o){K(this,o.id);var l=N(this,o.src),k=l&&l.idxActual;if((k>-1)&&this.selectedIndices[k]){var n=this.sortSelectedIndices(),j=h.get(this.items,n)||[];switch(j.length){case 1:return Z.copy(j[0],{html:j[0][this.itemDisplayField],index:n[0]});case 0:return null;default:return Z.copy({html:j.length+" selections",indices:n},j);}}},dropZone:false,ondragenter:function(j){K(this,j.id);this.set("dropCuePos",N(this,j.tgt));},ondragover:function(j){this.set("dropCuePos",N(this,j.tgt));},ondragleave:function(j){this.set("dropCuePos",null);},ondragstart:function(j){if(!(j&&j.src&&j.src.data)){return false;}},allowCopy:false,ondragend:function(n){var k=n&&n.tgt,j=k&&k.widget;if(j===this){}else{if(this.tree&&j&&j.tree===this.tree){if(!this.allowCopy||!b.ctrlKey(k.hWin,k.e)){var l=n.src&&n.src.data;if(l&&(l.indices||(l.index!==null))){this.remove(l.indices||l.index);}}}}},ondrop:function(t){var z=t&&t.src,q=z&&z.data;if(q){var k=N(this,t.tgt,false),w=k&&k.idx,l=(q&&q.constructor===Array);var o=this.items;w=Math.min(w,(o&&o.length)||0);var x=true;if(z.widget===this){x=this.move(this.sortSelectedIndices(),w);}else{this.add(l?q:[q],w);}if(x){var p=l?q.length:1,j={};for(var n=0;n<p;n++){j[w+n]=true;}this.set("selectedIndices",j);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var a=1,P=2;var C=2,H=4;var S=1,K=4;function F(b,f){return b[((f===a)?"row":"col")];}function A(b,g){var f=g.lm;return f&&f[b.mix||0];}function G(b,g){var f=g.dp;return f&&f[b.mix||0];}function V(x,o,f){var q=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:o.daMode});var l=o.ans,k=l&&l.length;if(k){var t=q.prms=[],AG=0;for(AG=0;AG<k;AG++){var AE=l[AG];var AD=AE.pid,AF=parseInt(AE.m,10),AA={id:AD,am:AF,pt:AE.pt};t.push(AA);if(AE.po){AA.orid=AE.po.did;AA.ortp=AE.po.t;}switch(AF){case q.DO_NOT_ANSWER:case q.CLOSE:case q.USE_DEFAULT_ANSWER:case q.SAME_PROMPT:break;case q.STATIC:var AH=AE.es,p=(AH&&AH.length)||0,s;AA.pa={es:[]};for(s=p-1;s>=0;--s){var AB=AH[s];AA.pa.es.push({ei:AB.id,disp_n:AB.n,emt:1});}break;case q.DYNAMIC:case q.ALL_VALID_UNITS:case q.CURRENT_UNIT:var g=AE.dunits;if(g&&g.length&&f){var b=AA.pa={};var w=f,n=(f.mix!==undefined)&&(f._lp||f._tp);if(n){w=f._lp||f._tp;}var j=parseInt(w.axis,10);while(w){var AI=this.getPTitle(w,j);if(AI&&mstrmojo.array.find(g,"id",AI.id)>=0){if(AF!==q.DYNAMIC){b.a={id:AI.id,n:AI.n,dispForms:AI.dfi};}if(AE.pt===1){b.v=w.v;break;}else{var AC=w._e.id,h=w._e.n;b.es=[];b.es.push({ei:AC,emt:1,disp_n:h});}if(AF===q.CURRENT_UNIT){break;}}w=this.getPCellParentNode(w,j);if(n&&!w&&j===a){j=P;w=f._tp;}}}break;}}}return q;}function N(g){var f=this.getCellTitleInfo(g[0]),j=[],l=function(i){if(i){if(mstrApp.useBinaryFormat){if(i._e){j.push(i.axis+"A"+(i.ui+1)+"A"+i._e.id);}l(i._p);}else{j.push(i.axis+"A"+(i.ui+1)+"A"+i.o);}}},h,b;if(!f.isSrcTitle){for(h=0,b=g.length;h<b;h++){var k=g[h];if(k.mix!==undefined&&(k._lp||k._tp)){l(k._lp);l(k._tp);}else{l(k);}}}return(mstrApp.useBinaryFormat)?j:j.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function O(){return this.data.mid;},getCellTitleInfo:function W(f,i){var g=i?i.gts:this.data.gts;var h=null;if(f.mix===undefined){h=F(g,f.axis)[f.tui||f.ui];}else{var b=function(l){var j=(l&&l.length)||0,k;for(k=j-1;k>=0;--k){if(parseInt(l[k].otp,10)===-1){return l[k];}}return null;};h=b(g.col)||b(g.row);}return{isSrcTitle:(f.o===undefined),title:h};},getCellLinksInfo:function Y(f,g){if(!g){var b=this.getCellTitleInfo(f);g=b&&b.title;}return A(f,g);},getCellDrillsInfo:function E(f,g){if(!g){var b=this.getCellTitleInfo(f);g=b&&b.title;}return G(f,g);},getLinkDrillAction:function L(b){return this.getActionObject(b);},getAction:function R(b){return this.getActionObject(b);},getActionObject:function I(f){var b=f[0]&&f[0].at,g=null;if(b){if(b&K){g={h:"onLink",a:this.getLinkAction(f[0])};}else{if(b&S){g={h:"onDrill",a:this.getDrillAction(f)};}}}return g;},getSortAction:function D(t,l){var h=this.getCellTitleInfo(t),p=h.title,s=this.data.gts[((t.axis===a)?"row":"col")+"SubPos"],b=[],g=p.axis,j,o,n,q;l=(l===null||l===undefined)?!(t&&t.so):l;if(h.isSrcTitle){j=C;o=p.id;n=p.otp;q=p.fid;}else{j=H;n=4;g=a;s=this.data.gts.rowSubPos;do{var k=t._e;if(k){if(k.oid){o=k.oid;}else{b.push(k.id);}}t=t._p;}while(t);}var i={sortType:j,axis:g,isAsc:l,unitID:o,unitType:n,elementList:b.join("\u001E"),subTotalsPos:s};if(o){i.unitID=o;}if(q){i.formId=q;}var f;if(j===H){f=["","",i.elementList||"",i.axis];}else{f=[i.formId,"21"];}f=[i.unitType,i.unitID].concat(f);i.sortKey=f.join("!");return i;},getPivotAction:function J(t,g){var q=false,w=t.hasOwnProperty("mix"),b=(w)?null:t.axis,s=((w)?t.mix:t.ui)+1,f=(t.otp===-1);if(!isNaN(g)){b=g;s=1;if(w){w=false;f=true;}}else{var k=(g==="u"||g==="l");if(!w){var j=F(this.data.gts,b),i=0,h={},n=false;mstrmojo.array.forEach(j,function(x){if(h[x.id]){h[x.id].frm++;}else{i++;h[x.id]={pos:i,frm:1};if(x.id===t.id){n=true;}else{if(n){return false;}}}});s=h[t.id].pos;var o=t.fix;if(o){if(!k||o>1){if(k||o!==h[t.id].frm){s=o;q=true;}}}}s=s+((k)?-1:1);}var l={pos:s};if(q){l.formID=t.fid;}else{if(!w){l.axis=b;}}if(!f){var p=(w)?t._e:t;if(!q){l.objectType=p.otp;}l.objectId=(w)?p.oid:t.id;}return l;},isPvtButtonVisible:function X(l,g){var i=l.axis,h=F(this.data.gts,i),f=l.hasOwnProperty("mix");if(!isNaN(g)){if(parseInt(g,10)===i){return false;}if(f){return !!h[l.ui]._hid;}return true;}var j=h[l.ui].es,k=l.ui,b=(f)?j.length:h.length;if(b===1){return false;}if(i===((f)?P:a)){if(g==="u"||g==="d"){return false;}}else{if(g==="l"||g==="r"){return false;}}if((f)?l._e===j[0]:k===0){if(g==="l"||g==="u"){return false;}}if(f?l._e===j[b-1]:k===b-1){if(g==="r"||g==="d"){return false;}}return true;},getDrillAction:function B(f){var b=this.getCellTitleInfo(f[0]),h=b.title,g=h.dp[f[0].mix||0];return{srcMsgId:this.data.mid,isWithin:g.within,drillPathKey:g.k,drillPathIndex:g.dpi,drillElements:N.call(this,f)};},getPTitle:function Z(g,f){var b=this.data.gts;return F(b,f)[g.tui];},getPCellParentNode:function M(f,b){return f._p;},getLinkAction:function Q(g,f){var b=this.getCellTitleInfo(g),h=b.title;return this.getLinkActionImpl(g,h,f);},getLinkActionImpl:function U(s,n,p){var g=A(s,n),o=g&&g.links,t=(g.onw)?"_blank":"";if(p===null||p===undefined){p=(g&&g.di)||0;}var j=o&&o[p];if(!j){return null;}var h={linkInfo:j,linkTarget:t};var b=j.url;if(b){var i="&CurrentElement";if(s&&n&&b.indexOf(i)>-1){b=b.replace(i,s._e.id);}h.url=b;}else{var k=j.target,q,f;switch(parseInt(k&&k.t,10)){case 55:if(parseInt(k.st,10)===14081){q=2048001;f="objectID";}else{q=32001;f="documentID";}break;case 3:q=4001;f="reportID";h.reportViewMode=((parseInt(k.st,10)===769)?2:1);break;default:return null;}h.evt=q;h[f]=k.did;h.srcMsgId=this.getMessageId();var l=V.call(this,g,j,s);if(l){h.link=l;}return h;}},getDownloadAction:function T(h,f,j,g,i,b){return{xtabId:i,rowPosition:h,maxRows:f,colPosition:j,maxColumns:g,memo:b};}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func");var F="Metrics",D=2;function B(a){if(!a){return ;}var Y=this.scm,T="\u001E",V=0,S=null,W=null,U=null,X=null,R=null,Z=false;for(S in Y){W=Y[S];U=W.cgb;for(V in U){cgKey=U[V];R=a[cgKey];if(R){if(!W.tks){W.tks=R;Z=true;}else{if(W.tks&&(W.tks.indexOf(R)<0)){W.tks+=T+R;Z=true;}}}}}return Z;}function Q(){var S=this.data,R=S.gts;if(!R){return ;}var T;mstrmojo.array.forEach([R.row,R.col],function(W){for(var V=0,U=W.length;V<U;V++){var X=W[V];if(X.sc){T=T||{};T[X.id||F]=X.sc;if(X.fid){T[X.id+"_"+X.fid]=X.sc;}}}});this.scm=T;B.call(this,this.docModel.getCGBMap());}function I(R,S){var T=this.getDataService();T[R].apply(T,S);}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function P(R){this._super(R);this.docModel.attachEventListener("CGBMapChange",this.id,function(S){});},ondataChange:function E(R){Q.call(this);},getMessageId:function C(){return this.docModel.mid;},getDataService:function H(){return this.docModel.getDataService();},getAction:function M(h,V,Z){var f=h[0],S=f&&f.at;var U;if(S){if(S&D){var T=this.getCellTitleInfo(f),a=T&&T.title,R=a&&a.id,b=this.scm;this.sti={titleId:R||F};var Y=(R&&b[R])||b[F];if(Y){var g=this.xtab,W=(g.allowToggleSelections&&Y.all&&Z),X=(T.isSrcTitle||W);this.sti.deselectCurrent=W;U={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:V,ck:Y.ck,tks:Y.tks,eid:X?"OA:(All)":f._e.id,ctlKey:Y.ckey,sliceId:g.sid,isUConDS:Y.isUConDS}};}}}if(!U){var U=this._super(h);}if(U&&U.a){U.a.sliceId=this.xtab.sid;}return U;},getDownloadAction:function A(U,S,W,T,V,R){var X=this._super(U,S,W,T,V,R);X.sliceId=this.xtab.sid;return X;},getDrillAction:function K(R){var S=this._super(R);S.srcMsgId=this.docModel.mid;return S;},sort:function G(R,S){I.call(this,"sort",arguments);},pivot:function L(R,S){I.call(this,"pivot",arguments);},drillGrid:function O(R,S){I.call(this,"drillGrid",arguments);},downloadGridData:function N(R,S){I.call(this,"downloadGridData",arguments);},loadLayout:function J(R){this.docModel.loadLayout(R);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DropDownList");function D(){var E=new mstrmojo.WaitIcon(),H=function(K){this.controller.onGroupBy(this,{groupbyKey:K.src.k,elementId:K.value},function(L){E.set("visible",L);});};for(var G=0,F=this.data.length;G<F;G++){var I=this.data[G];var J=this.addChildren(new mstrmojo.DropDownList({k:I.k,title:I.unit.target.n+":",idx:I.unit.idx,cssClass:"mstrmojo-DocGroupBy-unit",selectCssClass:"mstrmojo-DocGroupBy-unit-select"}));J.options=I.unit.elms;J.attachEventListener("selectedChange",this.id,H);}this.addChildren(E);}function B(){var H=this.data,G=this.children;if(H.length===G.length-1){for(var F=0,E=H.length;F<E;F++){var I=H[F].unit,J=G[F];J.idx=I.idx;J.options=I.elms;J.refresh();}}}mstrmojo.DocGroupBy=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DocGroupBy",markupString:'<div id="{@id}" class="mstrmojo-DocGroupBy {@cssClass}"><div style="padding-top: 5px;"><span class="mstrmojo-DocGroupBy-title">{@title}</span></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function C(E){this._super(E);this.ondataChange();},ondataChange:function A(){if(!this.data||!this.data.length){return ;}if(!this.hasRendered){D.apply(this);}else{B.apply(this);}},areUnitsSetToAll:function(){var E=true;mstrmojo.array.forEach(this.data,function(F){if(F.unit.elms[F.unit.idx].v!=="u;"){E=false;return false;}});return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._Formattable","mstrmojo._HasToolbar");var B="\u001E";var F=1;var H=2;var I={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3,vert:["height","width","top"],horiz:["width","height","left"],updateStyle:function(K){var N=K.defn.qsm;if(!N){return ;}if(K.getFormats().width){return ;}var O=null;if(N==F){O=K.containerNode.firstChild;}else{O=K.containerNode.lastChild;}if(!O){return ;}var L=O.clientHeight+"px";var J=O.clientWidth+"px";var M=K.domNode.style;M.height=L;M.width=J;if(K.parent.updateStyle){K.parent.updateStyle(L,J);}},repositionChildren:function(P){var O=P.getFormats(),N=parseInt(O.height,10),S=parseInt(O.width,10);var J=P.children,M=J[0].getFormats(),U=J[1].getFormats();var K=(P.defn.gp<this.LEFT),R=(K)?N:S,Q=(K)?S:N,T=this[((K)?"vert":"horiz")];var L=Math.round(R*(P.defn.ga/100));M[T[0]]=L+"px";M[T[1]]=Q+"px";U[T[0]]=(R-L)+"px";U[T[1]]=Q+"px";if((P.defn.gp%2)===0){U[T[2]]=L+"px";}else{M[T[2]]=(R-L)+"px";}this.resizeChildren(J[0],J[1]);},stackChildren:function(J){var M=J.children,N=J.getFormats(),L;for(var K=M.length-1;K>=0;K--){L=M[K].getFormats();L.width=N.width;L.height=N.height;}this.resizeChildren(M[0],M[1]);},resizeChildren:function(L,J){L.renderPortalState();var K=J.getFormats();J.resizeForDisplayState(parseInt(K.height,10),parseInt(K.width,10),true);},changeVisibility:function(L,J){var O=L.children,N=L.defn.qsm,K=J&&(!N||L.viewMode===F),M=J&&(!N||L.viewMode===H);if(O&&O.length>0){if(O[0].visible!==K){O[0].set("visible",K);}if(O[1].visible!==M){O[1].set("visible",M);}}L.visible=J;},setViewMode:function G(K){var L=K.children,M=K.visible;if(K.defn.qsm&&L&&L.length>0){var J=K.viewMode;L[0].set("visible",(J==F)&&M);L[1].set("visible",(J==H)&&M);}},clearFormatCache:function C(K){var M=K.children;for(var L=0,J=M&&M.length||0;L<J;L++){M[L].clearCache();}}};mstrmojo.DocGridGraph=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocGridGraph",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocGridGraph" style="{@domNodeCssText}"><div class="mstrmojo-DocGridGraph-msg"></div><div class="mstrmojo-DocGridGraph-container"></div></div>',markupSlots:{msgNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW","B","background-color","fx","font"]},viewMode:null,visible:true,resize:function D(){this.clearCache();I.clearFormatCache(this);var L=this.getFormats(),J=parseInt(L.width,10),K=parseInt(L.height,10);if(J>0&&K>0){I.changeVisibility(this,true);if(!this.defn.qsm){I.repositionChildren(this);}else{I.stackChildren(this);}}else{I.changeVisibility(this,false);}},postBuildRendering:function A(){this._super();var L=this.node.data.eg;if(L===undefined){this.msgNode.style.display="none";this.containerNode.style.display="block";}else{this.msgNode.innerHTML=L;this.msgNode.style.display="block";this.containerNode.style.display="none";}var K=this.defn.qsm;if(!this.viewMode&&K){this.viewMode=K;}var J=this.node.defn;J.attachEventListener("qsmChange",this.id,function(M){this.viewMode=M.value;I.setViewMode(this);this.model.getDataService().setQuickSwitchViewMode(this.defn.tt+B+this.k,this.viewMode);I.updateStyle(this);});I.setViewMode(this);I.updateStyle(this);if(!K){this.resize();}},getGridWidget:function(){return this.children[0];},getGraphWidget:function(){return this.children[1];},updateGraph:function(K){var J=this.getGraphWidget();if(J){J.update(K);J.refresh();}},quickSwitch:function E(){var J=this.viewMode!=H;this.defn.set("qsm",(J?H:F));return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo._IsPanelStack","mstrmojo._HasBuilder","mstrmojo.array","mstrmojo.css","mstrmojo.Serializer");function E(J,I){var H=mstrmojo.array.find(J.node.data.panels,"k",J.selectedKey);H+=(I||0);J.set("selectedIdx",H);}function F(H){H.set("hasNextPanel",(H.selectedIdx<(H.node.data.panels.length-1)));H.set("hasPreviousPanel",(H.selectedIdx>0));}mstrmojo.DocPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget,mstrmojo._HasBuilder,mstrmojo._IsPanelStack],{scriptClass:"mstrmojo.DocPanelStack",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocPanelStack {@cssClass}" style="{@domNodeCssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","overflow"]},hasNextPanel:false,hasPreviousPanel:false,applyEnabled:false,renderMode:"onshow",init:function G(H){this._super(H);E(this);this.node.sw=(this.node.data.panels.length>1&&this.defn.sw);},addChildren:function D(K,H,I){var N=0,M=K.length;this._super(K,H,I);for(N=0;N<M;N++){var L=K[N],J=(L.k===this.selectedKey);L.selected=L.visible=J;if(J){break;}}return true;},onselectedKeyChange:function C(I){var J=this._super(I),H=J.on;if(H._delayRefresh){if(!H.defn.dirtyKeys){H.refresh();}delete H._delayRefresh;}E(this);},updateSelectedIdx:function B(H){E(this,H);},onselectedIdxChange:function A(){F(this);},_bufferedSlices:null,bufferSlice:function(I){this._bufferedSlices=this._bufferedSlices||{};var H=this._bufferedSlices;if(I.ctlKey){H[I.ctlKey]=I;this.set("applyEnabled",true);}},applyBufferedSlices:function(){var J=this._bufferedSlices;if(!J){return ;}var H=this.model,M=mstrmojo.Serializer,I,N,L,K=[];for(L in J){I=J[L];if("eid" in I){N=[2048084,"mstrWeb.rwb.2048084","selectorKeyContext",I.ck,"elemList",I.eid,"ctlKey",I.ctlKey,"applyNow",false];if(I.include!==null&&I.include!==undefined){N.push("include");N.push(I.include);}if(I.disablePU){N.push("usePartDisplay");N.push(0);N.push("treesToRender");N.push(3);}else{N.push("usePartDisplay");N.push(1);N.push("treesToRender");N.push(2);}}else{if("srct" in I&&I.srct===4){N=[2048132,"mstrWeb.rwb.2048132","unitKeyContext",I.ck,"ctlKey",I.ctlKey,"objectID",I.srcid,"objType",I.srct,"expFunction",I.f,"expFunctionType",I.ft,"applyNow",false,"usePartDisplay",1];if(I.cs){N.push("expConstants");N.push(I.cs);N.push("dataType");N.push(I.dtp);}}else{if(I.unset){N=[2048128,"mstrWeb.rwb.2048128","unitKeyContext",I.ck,"ctlKey",I.ctlKey];}else{N=[2048133,"mstrWeb.rwb.2048133","include",I.include,"ctlKey",I.ctlKey];}}}if(N){K.push(N);}}if(!K.length){return ;}K=M&&M.serializeValueGroup(K);this.clearBuffSlices();H.slice({isMultipleEvents:true,tks:I.tks,events:K});},clearBuffSlices:function(){this._bufferedSlices=null;this.set("applyEnabled",false);},update:function(I){if(this._super){this._super(I);}var H=I.data&&I.data.selKey;if(H&&H!==this.selectedKey){this.defn.newSelKey=H;}},postBuildRendering:function(){this._super();if(this.defn.itb){mstrmojo.css.addClass(this.domNode,"tableControl");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TabStripBase=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TabStripBase",target:null,targetProps:null,isStrip:true,ontargetChange:function A(I){var J=I&&I.valueWas;if(J){var G=this._targetSubs;if(G){J.detachEventListener(G.add);J.detachEventListener(G.rem);J.detachEventListener(G.sel);}this.removeChildren();}var K=this.target;if(K){var E=this.targetProps,D=(E&&E.children)||"children",B=K[D];this.addTabButtons(B,0);var H="attachEventListener",C=this.id,F;if(K[H]){this._targetSubs={add:K[H]("addChild",C,function(L){var M=L&&L.value;if(M&&M.length){this.addTabButtons(M,L.index);}}),rem:K[H]("removeChild",C,function(M){var L=M&&M.value;for(F=((L&&L.length)||0)-1;F>-1;F--){this.removeTabButton(L[F]);}}),sel:K[H]("selectedChange",C,function(L){this.selectionChange(L);})};}}},addTabButtons:mstrmojo.emptyFn,removeTabButton:mstrmojo.emptyFn,selectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.css;function I(R){var Q=R.inputNode;var P=(R.value!=null)?String(R.value):"";if(P!==Q.value){Q.value=P;}if(Q.mstrmojoEmpty){C.removeClass(Q,[R.emptyClass]);Q.mstrmojoEmpty=null;}}function E(Q){var P=Q.inputNode;P.value=Q.emptyText||"";C.addClass(P,[Q.emptyClass]);P.mstrmojoEmpty=true;}function G(Q){var P=Q.inputNode;if(P){Q.readingDom=true;Q.set("value",P.value);Q.readingDom=false;}}var M={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",autoComplete:true,autoCorrect:true,autoCapitalize:true,placeholderText:"",markupString:'<input id="{@id}" placeholder="{@placeholderText}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css.toggleClass(this.inputNode,"disabled",!this.enabled);},onvalueChange:function(){var P=this.value,Q=(P===null)||(P==="");if(Q){if(!this.hasFocus){E(this);}else{this.inputNode.value="";}}else{I(this);}},ontooltipChange:function(){this.domNode.title=this.tooltip;},onreadOnlyChange:function(){this.inputNode.readOnly=this.readOnly;}},emptyText:"",emptyClass:"mstrmojo-empty",postBuildRendering:function B(){this._super();var P=this.inputNode;P.setAttribute("autocomplete",this.autoComplete?"on":"off");P.setAttribute("autocorrect",this.autoCorrect?"on":"off");P.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function O(){this.inputNode.focus();},prefocus:function J(){this.hasFocus=true;I(this);},preblur:function D(){window.setTimeout(function(){},200);this.hasFocus=false;G(this);var P=this.value;if((P===null||P==="")&&this.emptyText){E(this);}},prekeyup:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);var S=M[R.keyCode];if(this["on"+S]){this["on"+S](Q);}},preinput:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);},prepaste:function N(){this.delaySetValue(this);},precut:function L(){this.delaySetValue(this);},delaySetValue:function K(P){window.setTimeout(function(){G(P);},100);},setInvalidState:function H(P){mstrmojo.css.addClass(this.inputNode,["err"]);if(P){this.domNode.setAttribute("title",P);}},cleanUp:function F(){this.inputNode.value="";mstrmojo.css.removeClass(this.domNode,["err"]);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K[I].slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout");mstrmojo.OIVMPage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout],{scriptClass:"mstrmojo.OIVMPage",markupString:'<div id="{@id}" class="mstrmojo-OIVMPage {@cssClass}" style="{@cssText}"><div class="mstrmojo-OIVMPage-toolbar"></div><div class="mstrmojo-OIVMPage-layout"></div></div>',markupSlots:{toolbar:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.lastChild;}},onError:function(B){d=B.detail,app=mstrApp,btnHalo="#666",c=B.code;if(c){var A=mstrmojo.Button.newInteractiveButton;switch(c){case -2147468986:case -2147467618:B.btns=[A(mstrmojo.desc(3758,"Re-run Document"),function(){mstrmojo.form.send({evt:2048001,src:app.name+"."+app.pageName+".2048001",documentID:d.dssid,currentViewMedia:1});},btnHalo),A(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.form.send({evt:3010,src:mstrApp.name});},btnHalo)];break;default:B.btns=[A(mstrmojo.desc(212,"Continue"),function(){mstrmojo.form.send({evt:3026,src:app.name+"."+app.pageName+".3026"});},btnHalo)];}}},renderPageLoadError:function(){var A=this.error;this.onError(A);if(!A.btns||!A.btns.length){mstrmojo.alert(A.message,null,A.title);}else{mstrmojo.confirm(A.message,A.btns,A.title);}},render:function(){if(this.error){this.renderPageLoadError();}else{this._super();}},layoutConfig:{h:{toolbar:"30px",layout:"100%"},w:{layout:"100%"}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo.css","mstrmojo.array");var K=mstrmojo.css;var C=2;function N(Q,O,P){var R=Q.parent.parent;if(R&&R instanceof mstrmojo.DocPanel){R[O+"DirtyKey"](P);}}function E(P,O,Q){if(P===O.k){mstrmojo.array.forEach(O.children,function(R){if(R.setDirtyChildren){R.setDirtyChildren(Q);}});}}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,cssDisplay:"block",topStart:C,contentWidth:0,markupString:'<div id="{@id}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="height:100%;width:100%;position:absolute;{@containerNodeCssText}"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx"]},title:"",init:function M(O){this._super(O);if(!this.title){this.title=this.node.defn.ttl||"";}},childRenderCheck:function D(O){return(this._super(O)&&this.selected);},postBuildRendering:function A(){var O=K.addClass;if(!this.defn.l&&!this._forceRender){O(this.domNode,"placeholder");}return this._super();},onselectedChange:function F(O){this.set("visible",!!O.value);if(O.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!O.value});},refresh:function J(){if(!this.hasRendered){return ;}if(!this.selected){if(!this.children){this.builtChildren=false;}this._forceRender=true;this._super();delete this._forceRender;}else{var P=this.children||[],O;for(O=P.length-1;O>=0;O--){P[O].refresh();}if(this._isFP()){this.refreshFP();}}},setDirty:function H(O){var P=((O)?"add":"remove")+"DirtyKey";this[P](this.k);},addDirtyKey:function L(O){var Q=this.defn,P=Q.dirtyKeys||{};P[O]=true;Q.dirtyKeys=P;E(O,this,true);N(this,"add",O);},removeDirtyKey:function G(P){N(this,"remove",P);E(P,this,false);var Q=this.defn,O=Q.dirtyKeys;if(!O){return ;}delete O[P];if(!mstrmojo.hash.isEmpty(O)){return ;}delete Q.dirtyKeys;},renderChildren:function B(){var T=this.children;if(T&&(this._isFP()||this._isFSP())){for(var S=0,O=T&&T.length||0;S<O;S++){T[S].orgPos=S;}T.sort(function(W,Z){var X=(W.getFormats()&&W.getFormats()["z-index"])||0,Y=(Z.getFormats()&&Z.getFormats()["z-index"])||0;return X-Y||W.orgPos-Z.orgPos;});}if(this._isFP()){if(T){var U=this.domNode.clientWidth-2*C;this.topStart=C+1;for(var S=0,O=T&&T.length||0;S<O;S++){var Q=this.domNode.clientWidth-2*C;this.contentWidth=(Q>0)?Q:0;if(Q!=U){this.topStart=C;for(var R=0;R<S;R++){var P=T[R];P.refresh();if(P.getContainerHeight){this.topStart+=P.getContainerHeight()+C;}}}var V=T[S];if(this.childRenderCheck(V)){V.render(null);if(V.getContainerHeight){this.topStart+=V.getContainerHeight()+C;}}}}}else{this._super();}},refreshFP:function(){if(!this.hasRendered){return ;}var R=this.children;this.topStart=C;var P=this.domNode.clientWidth-2*C;this.contentWidth=(P>0)?P:0;for(var Q=0,O=R&&R.length||0;Q<O;Q++){var S=R[Q];if(S.relocate){S.relocate(this.topStart,this.contentWidth);}if(S.getContainerHeight){this.topStart+=S.getContainerHeight()+C;}}},getChildren:function I(){var Q=this.model.getChildren(this.node,false);if(this._isFP()||this._isFSP()){for(var P=0,O=Q&&Q.length||0;P<O;P++){var R=Q[P];if(this._isFP()&&!R.defn.iifp){R.defn.iifp=true;}if(this._isFSP()&&!R.defn.iifs){R.defn.iifs=true;}}}return Q;},_isFP:function(){return this.parent.defn.ifp;},_isFSP:function(){return this.parent.defn.ifsp;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}" ><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},buildRendering:function A(){var C=this.placeholder;if(this._super()){if(!this.parent&&!C){var B=this.placeNode||document.body;B.appendChild(this.domNode);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo._HasLayout","mstrmojo._ShowsStatus");function E(J){var I=this.domNode,H=parseInt(this[J.toLowerCase()],10);return(isNaN(H))?I["offset"+J]:H;}mstrmojo.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasScrollbox,mstrmojo._HasLayout,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-DocLayoutViewer {@cssClass}" style="{@domNodeCssText}"><div></div><div><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_fh"></div><div id="{@id}_scrollboxNode" class="mstrmojo-DocLayoutViewer-layout" style="{@_scrollCssText}"></div><div id="{@id}_ff"></div></div><div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}}},markupSlots:{groupBy:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.childNodes[1].childNodes[2];},scrollboxNode:function(){return this.domNode.childNodes[1].childNodes[2];},containerNode:function(){return this.domNode.childNodes[1].childNodes[2];},incFetchNode:function(){return this.domNode.lastChild;},fixedHeaderNode:function(){return this.domNode.childNodes[1].childNodes[1];},fixedFooterNode:function(){return this.domNode.childNodes[1].childNodes[3];},_STATUS:function(){return this.domNode.childNodes[1].firstChild;},_STATUS_TXT:function(){return this.domNode.childNodes[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;}},layoutConfig:{h:{groupBy:"auto",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"auto"},w:{layout:"100%"}},scrollboxHeightFixed:true,scrollboxWidthFixed:true,getHeight:function G(){return E.call(this,"Height");},getWidth:function B(){return E.call(this,"Width");},afterLayout:function A(){this._super();this.notifyScrollListeners();},preBuildRendering:function D(){if(this.parent){var J=this.parent[this.slot].style,I=this.height,H=this.width;this.height=(I!=="auto")?I:J.height;this.width=(H!=="auto")?H:J.width;}this.zf=this.model.zf;this.bs=this.model.bs;return this._super?this._super():true;},setSlotDimensions:function F(J,I,H){if(J==="layout"){this.scrollboxHeight=parseInt(I,10);this.scrollboxWidth=parseInt(H,10);}this._super(J,I,H);},onaddChild:function C(H){if(!isNaN(H.index)){var I=this.children[H.index];if(I&&I.slot==="groupBy"){this.docGroupBy=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Container","mstrmojo._Formattable","mstrmojo.EnumRWUnitType");var HTML_CONTAINER=mstrmojo.EnumRWUnitType.HTMLCONTAINER;mstrmojo.DocTextfield=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocTextfield",markupString:'<div id="{@id}" class="mstrmojo-DocTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@v}</div>{@buttonNodeMarkup}</div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","P","background-color","fx","text-align","white-space","overflow"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function update(node){var d=node.data,v=d.v||"";if(node.defn.t===HTML_CONTAINER){var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value;div=null;}this.v=v;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.set("visible",!node.data.hidden);if(this._super){this._super(node);}},postBuildRendering:function postBuildRendering(){var $D=mstrmojo.dom,f=this.getFormats(),rotateValue=f.fx&&f.fx.rt,i,len;if(rotateValue&&!$D.isIE&&$D.supports($D.cssFeatures.TEXT_ROTATION)){var dn=this.domNode;switch(rotateValue){case 1:dn.style.left=(parseInt(f.left,10)+dn.offsetHeight)+"px";break;case 3:dn.style.top=(parseInt(f.top,10)+dn.offsetWidth)+"px";break;}}if(this.defn.t===HTML_CONTAINER){var scripts=this.domNode.getElementsByTagName("script");for(i=0,len=scripts.length;i<len;i++){eval(scripts[i].innerHTML);}}return this._super();},getAnchor:function getAnchor(){return this.valueNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren","mstrmojo._CanRenderDocOnScroll","mstrmojo.dom");mstrmojo.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren,mstrmojo._CanRenderDocOnScroll],{scriptClass:"mstrmojo.DocLayout",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},popupNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["B","background-color","D","min-height","width"]},alias:"docLayout",markupMethods:{onminHeightChange:function(){var N=this.minHeight;if(!N){var M=this.getFormats();N=M&&M["min-height"];}if(N){this.containerNode.style[mstrmojo.css.MINHEIGHT]=N;}}},getHeight:function E(){var M=0;mstrmojo.array.forEach(this.children,function(N){M+=N.height();});return M||this.containerNode.offsetHeight;},getWidth:function I(){var M=this.children;return(M&&M.length)?M[0].width():this.containerNode.offsetWidth;},preBuildRendering:function K(){var M=this.getFormats();if(M&&M["min-width"]!==undefined){M.width=M["min-width"];}this._super();},renderChildren:function L(){this._super();this.resizeOrReposition();},resizeOrReposition:function D(){var O=this.containerNode;if(!!this.defn.aw){var U=this.model.getAutoWidthIDs(),S=(U&&U.length)||0,Y=0,X=mstrmojo.all,P;if(!S){return ;}for(P=0;P<S;P++){Y=Math.max(this._getWidgetRightMostPosition(X[U[P]]),Y);}Y=Math.max(this.getLayoutMinWidth(),Y);if(Y>parseInt(this.getFormats().width,10)){O.style.width=Y+"px";}}var W=this.model.zt;if(mstrApp.isMobile&&W){var M=this.parent.domNode;if(M){var Q=this.model.controller,N=!!Q.orientation,Z=0,V=this.parent,R=V.getHeight()-V.fixedHeaderNode.clientHeight-V.fixedFooterNode.clientHeight;if(W===2){if(!Q.toolBarDelegated){R-=Q.getBottomToolBarHeight();}Z=Math.round(N?Math.max((R-this.getHeight()),0)/2:0)+"px";}O.style.margin=Z+" auto";var T=this;window.setTimeout(function(){Q.nudgeWidget(T.id,{left:O.offsetLeft,top:O.offsetTop});},0);}}},getLayoutMinWidth:function F(){return 0;},_getWidgetRightMostPosition:function F(M){return parseInt(M.getFormats().left,10)+(M.getDim&&M.getDim().w||M.domNode.offsetWidth);},renderCtrlsInViewport:function C(){this._super();this.resizeOrReposition();},adjustAutoWidth:function H(M){if(!this.defn.aw||!M){return ;}var O=this.containerNode.style,N=parseInt(O.width,10)||0;var P=this;window.setTimeout(function(){var Q=P._getWidgetRightMostPosition(M);if(Q>N){O.width=Q+"px";}},1);},_getModelChildNodes:function B(P,O,S,N,R){var Q=this.model.getNonFixedSections(P,O);var M=Q.length;N=isNaN(N)?M:N;S=S||0;if(S>0||N<M){Q=Q.slice(S,S+N);}return R?{nodes:Q,total:M}:Q;},getChildren:function G(O,N,Q,M,P){return this._getModelChildNodes(O||this.node,N||false,Q,M,P);},getCaptureDimensions:function J(){var N=this.domNode,M={};if(!this.domNode){return ;}M=mstrmojo.dom.position(N);M.w=Math.min(N.offsetWidth,M.w);M.h=Math.min(N.offsetHeight,M.h);return M;},preserveChildDomOrder:false,postBuildRendering:function A(){if(window.mstrMobileApp!==undefined){this.defn.lastOrientation=mstrMobileApp.getOrientation();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._CanGrowOrShrink","mstrmojo.boxmodel");mstrmojo.DocSubsection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._CanGrowOrShrink],{scriptClass:"mstrmojo.DocSubsection",markupString:'<div id="{@id}" class="mstrmojo-DocSubsection" style="{@domNodeCssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},formatHandlers:{domNode:["D","B","background-color","fx"]},update:function G(H){if(this.thresholdId||H.data.tid){delete this.fmts;}this.thresholdId=H.data.tid;if(this._super){this._super(H);}},postBuildRendering:function E(){var L=this.defn;if(L.hc||L.vc){var H=this.domNode,K=this.getFormats(),M=this.id,J=K.height,I=K.width;L.attachEventListener("resized",M,function(){if("height" in K){H.style.height=K.height;}if("width" in K){H.style.width=K.width;}});L.attachEventListener("adjustSize",M,function(P){var O=H.style,N=O.height;if(L.hc&&O.width!==I){O.width=I;}if(L.vc&&O.height!==J){O.height=J;}this.performCanGrowCanShrink(this.children);P.heightReduced=(parseInt(N,10)>parseInt(O.height,10));});}return(this.renderMode!=="scroll")?this._super():true;},childRenderOnAddCheck:function C(H){return(this.renderMode!=="scroll")?this._super(H):false;},onchildRenderingChange:function B(J){this._super(J);if(this.renderMode!=="scroll"){var H=this.parent.slot,I=H==="fixedHeaderNode"||H==="fixedFooterNode";this.performCanGrowCanShrink([(J&&J.src)||J],I);}},portalMaximized:function D(){var K=this.defn,L=K.vc,I=K.hc;if(!I&&!L){return{};}delete K.vc;delete K.hc;delete K.ck;var J=this.getFormats(),H=this.model,P=this.domNode,M=this;var N={HideIfEmpty:-1};var O=function(T,R,S){var U=T.toLowerCase(),Q=parseInt(P.style[U],10);R=((R===undefined)?Q:Math.max(parseInt(R,10),Q))+"px";if(J[U]!==R){J[U]=R;N[T]=mstrmojo.boxmodel.px2Inches(H,R);delete M["_fixed"+T];}S=S||"";N["Max"+T]=0;N["CanGrow"+S]=0;N["CanShrink"+S]=0;};if(L){O("Height",J.normHeight);}if(I){O("Width",J.normWidth,"Horizontal");}K.raiseEvent({name:"resized"});return N;},adjustSectionSize:function A(){var H=this.defn;if(H.vc||H.hc){return H.raiseEvent({name:"adjustSize"});}return null;},refresh:function F(){if(!this.hasRendered){return ;}var I=this.children||[];for(var H=I.length-1;H>=0;H--){I[H].refresh&&I[H].refresh();}},preserveChildDomOrder:false});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.css");var A=mstrmojo.boxmodel,J=mstrmojo.dom,G=20;function F(M,K){var L=M&&M.parent;while(L){if(L.connectScrollbox){L.connectScrollbox(K);}L=L.parent;}}function I(M,K){var L=M&&M.parent;while(L){if(L.disconnectScrollbox){L.disconnectScrollbox(K);}L=L.parent;}}var D=function(V){if(V.visible){var M=V.refNode,S=M?A.offset(M,document.body):{left:J.getHorizontalScroll(),top:J.getVerticalScroll()},Y=V.domNode.style,U=V.containerNode,O=V.left,X=V.top,L=V.posType,R=mstrmojo.tooltip,Q=(L===R.POS_TOPRIGHT)||(L===R.POS_BOTTOMRIGHT),K=(L===R.POS_BOTTOMLEFT)||(L===R.POS_BOTTOMRIGHT)||(L===R.POS_BOTTOMCENTER),N=S.left,P=S.top,W=U.offsetWidth;if(O!==null){Y.left=Math.max(parseInt(O,10)+N-(Q?(W):((L===R.POS_BOTTOMCENTER)?(W/2):0)),0)+"px";}if(X!==null){Y.top=Math.max(parseInt(X,10)+P-((K)?(U.offsetHeight):0),0)+"px";}}};var C=function(K){K.containerNode.className=("mstrmojo-Tooltip-content "+K.contentNodeCssClass);K.containerNode.style.cssText=K.contentNodeCssText;K.containerNode.innerHTML=K.content;if(!K.content){K.set("_tempVis",false);}else{K.set("_tempVis",true);}D(K);if(K.optimizePos){K.optimizePos();}};function B(K){if(!K._dp){K._dp=window.setTimeout(function(){K._dp=null;C(K);},50);}}var H=function(Q,R,O,N){var K=R&&(R.richTooltip||R.tooltip),L=O?J.getMousePosition(O,N||self):null,P=K&&(typeof (K)==="string"),M=P?null:(K&&K.left||0),S=P?null:(K&&K.top||0);Q.set("contentNodeCssClass",P?"":(K&&K.contentNodeCssClass||""));Q.set("contentNodeCssText",P?"":(K&&K.contentNodeCssText||""));Q.set("content",(P)?K:(K&&K.content||""));Q.set("refNode",P?null:K&&K.refNode||null);Q.set("posType",P?1:K&&K.posType||1);Q.set("left",(P||M===undefined||M===null)?(L&&L.x||Q.left):M);Q.set("top",(P||K===undefined||K===null)?(L&&(L.y+G)||Q.top):S);};mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,posType:1,markupString:'<div id="{@id}" class="mstrmojo-Tooltip {@cssClass}" style="{@cssText}"><div class="mstrmojo-Tooltip-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Tooltip-content {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){if(this.visible){var K=this.domNode.style;K.visibility="hidden";K.display="block";D(this);K.visibility=this.content?"visible":"hidden";}else{this.domNode.style.display="none";}},on_tempVisChange:function(){this.domNode.style.visibility=this._tempVis?"visible":"hidden";},onleftChange:function(){B(this);},ontopChange:function(){B(this);},onrefNodeChange:function(){B(this);},onposTypeChange:function(){B(this);},oncontentNodeCssClassChange:function(){B(this);},oncontentNodeCssTextChange:function(){B(this);},oncontentChange:function(){B(this);}},preBuildRendering:function(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}if(this._super){this._super();}},_on_tooltip_change:function(K){H(this,K&&K.src);},_set_opener:function(M,K){var L=this.opener;if((K!==L)){if(K){F(K,this);}if(L){I(L,this);}if(L&&L.detachEventListener){L.detachEventListener(this._richSubs);L.detachEventListener(this._ttpSubs);}if(K&&K.attachEventListener){this._richSubs=K.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=K.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=K;return true;}return false;},updatePopupConfig:function(K,L){H(this,L,K&&K.e,K&&K.win);},onscroll:function(){if(this.visible&&this.nudge){this.nudge();}}});var E=null;mstrmojo.tooltip={POS_TOPLEFT:1,POS_BOTTOMLEFT:2,POS_TOPRIGHT:3,POS_BOTTOMRIGHT:4,POS_BOTTOMCENTER:5,open:function(L,N,M,K){if(!E||!mstrmojo.all[E.id]){E=new mstrmojo.Tooltip();}if(!K){K={};}K.e=N;K.win=M;E.open(L,K);},close:function(){if(E){E.close();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable");mstrmojo.DocImage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocImage",markupString:'<div id="{@id}" class="mstrmojo-DocImage" title="{@tooltip}" style="{@domNodeCssText}"><div style="{@shadowNodeCssText}"><img src="{@v}" style="{@imgNodeCssText}" mstrAttach:click></div>{@buttonNodeMarkup}</div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function C(E){var F=this.model.getDataService(),D=E.data.v;this.v=(F&&F.getDocImage&&F.getDocImage(D))||D;if(this.thresholdId||E.data.tid){delete this.fmts;}this.thresholdId=E.data.tid;this.set("visible",!E.data.hidden);if(this._super){this._super(E);}},formatHandlers:{domNode:["left","top","z-index"],shadowNode:["width","height","B","fx"],imgNode:["height","width"]},preBuildRendering:function B(){if(this._super){this._super();}if(!mstrmojo.dom.isIE7){var D=this.getFormats(),F=(D.fx&&D.fx.ds)||0,E=mstrmojo._Formattable.getBorderWidths(this);this.domNodeCssText+="width:"+((parseInt(D.width,10)||0)+F+E.w)+"px; height: "+((parseInt(D.height,10)||0)+F+E.h)+"px;";}},getAnchor:function A(){return this.imgNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change >{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(E,D){if(!A){var F=this.itemField;A=this._super(E).replace(">{@n}<",' title="{@'+F+'}">{@'+F+"}<");}return A;},getItemProps:function C(F,D){var E=this._super(F,D),G=this.itemField;E[G]=F[G];return E;},onclick:function B(D){this._super(D);var E=this.parent,G=E.opener;G.suggestionShown=false;var F=this.selectedItem;if(F){G.handleSuggestionItemSelect(F);}E.close();},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems"}});}());(function(){mstrmojo.DivItemRenderer={render:function(D,B,E){var C=(E.getItemName?E.getItemName(D,B):(E.itemDisplayField&&D[E.itemDisplayField]));return'<div mstridx="'+B+'" class="'+E.itemCssClass+(E.selectedIndices[B]?" "+E.itemSelectedCssClass:"")+" lb"+C+'" style="'+E.itemCssText+'">'+C+"</div>";},select:function(C,D,B,E){C.className+=" selected";},unselect:function(C,D,B,E){C.className=C.className.replace(/selected/g,"");},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,_findMatch:function(B,C){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(B,C),"mstridx",true,this.itemsNode);},preclick:function A(J){var F=J.hWin,G=J.e,E=this._findMatch(F,G);if(E){var D=E.node,I=parseInt(E.value),H=mstrmojo.dom,B=H.ctrlKey(F,G),C=H.shiftKey(F,G);if(B||C){H.clearBrowserHighlights(F);}if(this.multiSelect&&(this.selectionPolicy=="toggle"||B)){this.toggleSelect(I);}else{if(this.multiSelect&&C){this.singleSelect(I);}else{this.singleSelect(I);}}}}};mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._RendersItemDivs");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var B=this.itemRenderer;return(B&&B.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var B=this.itemRenderer;return(B&&B.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var B=this.itemRenderer;return(B&&B.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var B=this.itemRenderer;return(B&&B.itemSuffix)||"</td></tr>";},_getItemNode:function(B){var D=this.itemsNode,C=D&&D.rows,E=C&&C[B];return E&&E.cells[0].firstChild;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.MenuItem=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.MenuItem",markupString:'<div id="{@id}" class="mstrmojo-MenuItem {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-MenuItem-text"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.date","mstrmojo.dom","mstrmojo.Calendar");var B=mstrmojo.date,C=mstrmojo.dom,A=function(){return mstrmojo.locales.datetime;},D=mstrmojo.array;function G(H){return H.year+"_"+H.month+"_"+H.day;}function F(I,K,H){var L=I.e,J=C.eventTarget(I.hWin,L);if(C.contains(K.dayView,J,false,K.domNode)||C.contains(K.monthView,J,false,K.domNode)||C.contains(K.yearView,J,false,K.domNode)){J=J.tagName.toUpperCase()=="TD"?J:J.parentNode;if(J&&J.tagName.toUpperCase()=="TD"){J.style.borderColor=H?K.rollColor:"transparent";}}}mstrmojo.VisCalendar=mstrmojo.declare(mstrmojo.Calendar,null,{scriptClass:"mstrmojo.VisCalendar",cssClass:"mstrmojo-visCalendar",availableDates:null,rollColor:"",monthNames:function(H){return A().MONTHNAME_FULL[H];},yearViewSize:4,isDateDisabled:function(I,L,J){var K=this._super(I,L,J),H=this.availableDates;if(!K&&H){K=!H[J+"_"+L+"_"+I];}return K;},premouseover:function(H){F(H,this,true);},premouseout:function(H){F(H,this,false);},adjustYearStart:function(){if(!this.yearRangStart){this._super();}},updateSelectedDate:function E(){var H=this.value,I=this.timeVal,K=this.selectedDates,J,L=function(N,M){N.set("browseYear",M.year);N.set("browseMonth",M.month);N.updateTimePart();N.updateView(N.currentView);};if(K.length===0){J=(this.availableDates&&this.availableDates.length>0)?this.availableDates.max:B.getDateJson(new Date());if(this.isDateDisabled(J.day,J.month,J.year,this.min,this.max)){if(this.min&&B.compareDate(J,this.min)<0){J=parseDateAndTimeToJSON(this.min);}else{if(this.max&&B.compareDate(J,this.max)>0){J=parseDateAndTimeToJSON(this.max);}}}L(this,J);}else{J=K[0];D.forEach(K,function(M){if(B.compareDate(J,M)<=0){J=M;}});L(this,J);}},onselect:function(P){var M=this.selectedDates,I=this.availableDates,J=this.container,L=J.docModel,K=J.model,O=J.dfm&&J.dfm.sc,N=[];if(O){D.forEach(M,function(R){var Q=I[G(R)];if(Q){N.push(Q);}});if(!N.length){N[0]="u;";}if(window.microstrategy&&window.microstrategy.findBone){var H=microstrategy.findBone(J.domNode);if(H&&H.makeSelections){H.makeSelections([{attId:J.dfm.id,values:N}]);}}else{if(L&&L.slice){L.slice({ck:O.ck,eid:N.join("\u001E"),src:K.k,tks:O.tks,ctlKey:O.ckey,include:true});}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.ImageToggle","mstrmojo._IsInputControl");mstrmojo.ToggleDIC=mstrmojo.declare(mstrmojo.ImageToggle,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ToggleDIC",init:function(A){this._super(A);this.unset=this.dic.ust;},focus:function(){this.domNode.focus();},onvalueChange:function(){},onblur:function(B){var A=B.e||B,C=this.domNode,D=mstrmojo.boxmodel.offset(C,document.body);if(A.clientX>D.left&&A.clientX<D.left+C.offsetWidth&&A.clientY>D.top&&A.clientY<D.top+C.offsetHeight){this.domNode.focus();}else{this.applyChanges();}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var A=this.openerStyle;this.width=A.iw;this.height=A.ih;this.set("imageList",this.dic.vls);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.GridBase");var V=mstrmojo.css,M=mstrmojo.color;function C(b,f){var g=b&&b.parent;while(g&&g.scriptClass.indexOf("DocPanelStack")===-1){if(f in g){return g;}g=g.parent;}return null;}function B(f){var b=document.createElement("img");f.appendChild(b);f.removeChild(b);}function E(b,f){var g=Math.floor(b/f.rowsPerPage),i=b%f.rowsPerPage,h=f.tableNode.tBodies[g];r=h.rows[i].cells;return r;}function H(){var b=this._renderTimer;if(b){self.clearInterval(b);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:15,defaultRowsPerPage:100,minRowsPerPage:50,init:function G(b){this._super(b);this.forceFixedSizes=true;},initPageSettings:function N(){var f=this.parent,b=this.defaultRowsPerPage;this.effectiveRh=this.rh||this.rhMin||1;if(f&&f.numRowFixed){b=this.cp.getAvailableRowsCount();}else{if(f&&f.scrollboxHeightFixed){b=Math.ceil(f.scrollboxHeight/this.effectiveRh);b=Math.max(b,this.minRowsPerPage);}}this.pageStatus=[];this.rowsPerPage=b;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function X(j){var h=this.rowsPerPage;this.totalPages=h&&Math.ceil(this.cp.rc/h)||0;j=j||this.pageStatus;for(var f=0;f<this.totalPages;++f){var k=f*h,g=k+h-1,b=this.cp.isDataAvailable(k,g);if(!j[f]){j[f]={};}j[f].onDemand=!b;}},buildRendering:function F(j){if(this.renderMode=="vscroll"){this.initPageSettings();var i=this.pageStatus[0],b=i&&i.onDemand;this.start=0;this.end=-1;if(!b){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!b);}this._super();if(this.renderMode=="vscroll"){var h=this.parent,g=this,k=function(){g.gridContainerNode.style[mstrmojo.css.MINHEIGHT]=(g.cp.rc*g.effectiveRh)+"px";};if(mstrmojo.dom.isIE7){this.gridContainerNode.style.zoom="1";window.setTimeout(k,10);}else{k();}if(!this.connectedScrollbox){if(h&&h.connectScrollbox){h.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!b);this.postRenderPages();var f=h&&!h.scrollboxHeightFixed&&!h.numRowFixed;if(f&&this.numPagesRendered>=this.totalPages&&!b){this.postRenderingCleanup();}else{if(b||f){this.onscroll();}}}else{this.configureActions();}},preRenderPages:function Q(){},postRenderPages:function Z(){this.configureActions();},configureActions:function L(){var b=this.parent;if(b&&b.configureActions){b.configureActions();}},preRenderPage:function O(b,f){this.pageNum=b;},postRenderPage:function J(f,h,i){if(f+1>this.numPagesRendered){this.numPagesRendered=f+1;}var b=this.pageStatus,g=b[f];if(!g){g=b[f]={};}if(h){g.filled=true;g.dirty=false;}var j=this.gridContainerNode.style;if(f==this.totalPages-1&&j){j[mstrmojo.css.MINHEIGHT]="";}},invalidAllPages:function(){for(var b=0;b<this.totalPages;++b){var f=this.pageStatus[b];if(f.filled){f.dirty=true;}f.onDemand=true;f.filled=false;f.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function a(){var b=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var h=mstrmojo.all[b];if(!h){return ;}var f=h.getPagesToRender();if(f.length>0){h.preRenderPages();h.renderPages(f);h.postRenderPages();h._postPagesClearup=true;}else{if(h._postPagesClearup){h.postRenderPagesCleanup();h._postPagesClearup=false;}H.call(h);if(h.isRenderingComplete()){h.postRenderingCleanup();}}}catch(g){H.call(mstrmojo.all[b]);throw g;}},this.renderPause);},onscroll:function Y(b){if(!this.renderingRows){if(b===true){var f=this.parent;if(f&&f.maskNode){V.addClass(f.maskNode,"wait");}}this._startPageRenderThread();}},isRenderingComplete:function P(){if(this.end>=this.cp.rc-1){for(var b=this.pageStatus,f=this.totalPages-1;f>-1;f--){if(!b[f]||!b[f].filled){return false;}}return true;}return false;},renderPages:function D(f){for(var g=0,b=f.length;g<b;++g){this.renderPage(f[g].idx,f[g].fill);}},renderPage:function W(k,f){var o=this.pageStatus,h=(this.numPagesRendered>=k+1);if(h){if(!f||(o[k]&&o[k].filled)){return ;}}var n=this.rowsPerPage,i=this.domNode;this.start=k*n;this.end=Math.min(this.start+n,this.cp.rc)-1;this.preRenderPage(k,f);var b=this.tempTable;if(!b){b=this.tempTable=i.ownerDocument.createElement("div");}var j=f?this.buildTableRowsMarkup(this.start,this.end,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>").join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(this.effectiveRh*(this.end-this.start+1))+'px">&nbsp;</td></tr></tbody></table>';b.innerHTML=j;var g=b.firstChild.tBodies[0],l=this.tableNode;if(!h){l.appendChild(g);}else{l.replaceChild(g,l.tBodies[k]);}this.postRenderPage(k,f,g);},getPagesToRender:function S(){var t=[],z=this.parent,AJ=this._defaultPageHeight,k=null,AK=this.pageStatus,AL=this;function q(i){var j=AK[i];if(j&&(j.filled||j.dirty)){if(!j.height){if(!k){k=AL.tableNode.tBodies;}j.height=k[i].offsetHeight;}return j.height;}else{return AJ;}}var o=0,l=null,w=null,f=z.scrollboxTop;for(var AF=0,AG=this.totalPages,b=this.pageStatus;AF<AG;AF++){o+=q(AF);if(o>=f){l=AF;break;}}if(l===null){l=w=AG-1;}else{var x=z.scrollboxBottom;if(isNaN(x)&&z.numRowFixed){x=f;}for(var AD=l+1;AD<AG;AD++){if(o>x){w=AD-1;break;}o+=q(AD);}}if(w===null){w=AG-1;}for(var AA=this.numPagesRendered;AA<l;++AA){t.push({idx:AA,fill:false});}var AE=this.pageStatus,AC=0,AH=this.rowsPerPage,s=false;for(var AB=l;AB<=w;++AB){var AI=AK[AB];if(!AI||!AI.filled){if(AI&&AI.onDemand){s=true;if(!AI.isDownloading&&!this.isDownloading){AC+=AH;AI.isDownloading=true;this.isDownloading=true;var h=AB*AH,g=h+AH-1;this.cp.download(h,g);}t.push({idx:AB,fill:false});}else{t.push({idx:AB,fill:true});}}}if(s){this.parent.showDownloadStatus(AC);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return t;},addHilitePosition:function(f,h,b){var i=this.hiliteCellsMap[f];if(!i){this.hiliteCellsMap[f]={pos:[],nodes:[]};}var g=h-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[f].pos.push({row:g,cell:b,page:this.pageNum});},setHilites:function(h,j){var k=j.getAttribute("ei"),l=this.eiMap[k],b=this.getNodesByPositions(l);if(!b.length){this._super(h,j);return ;}for(var g=0,f=b.length;g<f;g++){this._super(h,b[g]);}},addExtraInfoMap:function(f,g,b){if(!this.eiMap[f]){this.eiMap[f]=[];}this.eiMap[f].push(this.getPosObj(g,b));},addPositionMap:function(f,g,b){if(!this.posMap[f]){this.posMap[f]=this.getPosObj(g,b);}},addTitleHeaderPositionMap:function(g,b,f){var h=this.getPosObj(g,b);h.obj=f;this.thPosMap.push(h);},getPosObj:function(b,f){return{row:b-this.pageNum*this.rowsPerPage,cell:f,page:this.pageNum};},getNodeByPosition:function(b){return this.tableNode.tBodies[b.page].rows[b.row].cells[b.cell];},getRowIdxByCell:function(b){var f=this.posMap[b._ei];return f.page*this.rowsPerPage+f.row;},getNodesByPositions:function(l){var b=[];for(var g in l){var f=l[g],j=(f&&f.page)||0,h=f&&f.row,k=f&&f.cell;b.push(this.tableNode.tBodies[j].rows[h].cells[k]);}return b;},getPageHeight:function R(b){var f=this.tableNode.tBodies;return(f&&f[b]&&f[b].offsetHeight)||0;},getTargetCell:function(o,n){var k=0,f=0;for(var l=this.totalPages;f<l;f++){k+=this.getPageHeight(f);if(n<=k){break;}}var g=this.tableNode.tBodies[f];if(g){for(var f=0,l=g.rows.length;f<l;f++){var s=g.rows[f];for(var b=0,q=s.cells.length;b<q;b++){var p=s.cells[b];if(p.offsetTop+p.offsetHeight>=n){if(o>=p.offsetLeft&&o<=p.offsetLeft+p.offsetWidth){return p;}}else{break;}}}}},postRenderPagesCleanup:function I(){var g=this.parent;if(g&&g.gridData&&g.gridData.afc){var f=this.tableNode;if(f&&(this.lastWidth!=f.offsetWidth)){if(g.onGridWidthChanged){g.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(h){delete h.height;});this.lastWidth=f.offsetWidth;}var b=C(g,"adjustAutoWidth");if(b){b.adjustAutoWidth(g);}}if(g.gridPagesRendered){g.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(g&&g.maskNode){V.removeClass(g.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function K(){var o=this.cp.getUpdatedRows(),j=this,n,b,l,p,g,h,k,f=[];if(o){mstrmojo.hash.forEach(o,function(q,i){k=parseInt(i,10);n=j.cp.getRowCells(k);b=E(k,j);l=b.length;p=n.length-1;if(p>=0){for(g=l-1;g>=0;g--){h=b[g];if(p<0){break;}if(n[g]._d){var t=h.style.backgroundColor,s=h.style.color;f.push({dom:h,bgcolor:t,ftcolor:s});h.style.backgroundColor=M.getHighlightColor(M.rgbStr2rgb(mstrmojo.css.getStyleValue(h,"backgroundColor"),true));h.style.color=M.getContrastingColor(M.rgbStr2hex(mstrmojo.css.getStyleValue(h,"backgroundColor")),["#ffffff","#000000"]);delete n[g]._d;}p--;}}});if(f.length>0){window.setTimeout(function(){mstrmojo.array.forEach(f,function(i){i.dom.style.backgroundColor=i.bgcolor;i.dom.style.color=i.ftcolor;});},300);}}},getRowInfoByPosition:function(b){return this.cp.getRowCellInfo(b);},postRenderingCleanup:function A(){var b=this.parent;if(b&&this.connectedScrollbox){b.disconnectScrollbox(this);}this.connectedScrollbox=false;if(b&&!b.scrollboxHeightFixed){var f=C(b,"performCanGrowCanShrink");if(f){f.performCanGrowCanShrink([b],true);}}},unrender:function U(b){H.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this._super(b);},dataDownloaded:function T(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function I(J){mstrmojo.hash.copy(J,this);},initContent:function D(L){this.startIndexInContainer=L||this.startIndexInContainer||0;var K=this.base.show,J=this.base.items;this.rc=K&&J?J.length:0;this.colWidths=K&&this.base.cws||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function B(K,J){return !this.invalidData;},download:function A(K,J){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function C(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function H(){return this.rc;},getUpdatedRows:function G(){return this.updatedRows;},getRowCells:function(U){var N=this.base.items,V=N[U],O=V.items,X=this.lookupBase,Q=this.interactiveCellsArray,W=this.gridData.css,a=null,Z=false,h,P,S,M;if(this.oldGridData){h=this.oldGridData;P=this.oldBase;S=P&&P.items;M=S[U]&&S[U].items;}for(var R=0,Y=O&&O.length||0;R<Y;R++){var L=O[R];if(L){L.v=L.v||L.n;if(X&&!L._e){var T=X[L.tui];a=T&&T.es[L.idx];if(a){L.v=L.v||a.n;if(a.rv){L.rv=a.rv;}L._e=a;}}if(!L.css){L.css=W[L.cni].n;}if(!L._d&&M&&this.preServeUpdatedRows){var K=M[R];if(!K||(K.rs!==L.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((K.v&&L.v!==K.v)){data={};if(L.v!==K.v){data.v=K.v;}if(L.css!==K.css){data.css=K.css;}L._d=data;this.updatedRows[this.startIndexInContainer+U]=true;}}}L._gd=this.gridData._bidx||0;if(L.at>0&&Q){if(L._ei===undefined||Q[L._ei]!==L){L._ei=Q.push(L)-1;}}if(this.axis){L.axis=this.axis;}var b=L.pi;if(b){if(b.ri!==undefined&&b.ci!==undefined){L._p=N[b.ri].items[b.ci];}else{var g=this.gridData.ghs,f=b.left,J=b.top;if(f){L._lp=g.rhs.items[f.ri].items[f.ci];}if(J){L._tp=g.chs.items[J.ri].items[J.ci];}}}}}return O;},getUnmergedCells:function F(O){var Q=[],R=this.base.items,L=this.gridData.css,P=R[O].items[0],K=P&&P.pi,J=K&&K.ri,N=K&&K.ci;while(K&&J>-1&&N>-1){P=P._p||R[J].items[N];var M={};mstrmojo.hash.copy(P,M);if(!M.css){M.css=L[M.cni].n;}M.rs=P.rs-O+J;Q.splice(0,0,M);K=P&&P.pi;J=K&&K.ri;N=K&&K.ci;}return Q;}});})();(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];for(var J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getRowCells(I);},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K);for(var I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0;for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){for(var I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={};for(var J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(K.getUpdatedRows(),I);}}this.updatedRows=I;return I;},download:function B(M,L){var K=this._getCPs(M,L);for(var I=0;I<K.length;++I){var J=K[I];J.download(M,L);}}});})();(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];for(var I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowCells:function(I){var M=this.cps,J=[];for(var L=0,H=M.length;L<H;L++){if(M[L].getAvailableRowsCount()>0&&M[L].rc>I){var K=M[L].getRowCells(I);if(K){J=J.concat(K);}}}return J;},getRowHeight:function C(){return this.cps[0].getRowHeight();},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={};for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(J.getUpdatedRows(),H);}}this.updatedRows=H;return H;},download:function B(J,H){var I=this.cps[1];I.download(J,H);}});})();(function(){mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function E(G){this._super(G);},download:function A(H,G){},initContent:function D(N){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var H=this.gridData.gts,X=(this.gridData.lhv!==0),J=H.row||[],G=H.col||[],P=H.show,M=H.rec,V=this.cts||[],U=J.length,O=V.length,R=this.gridData.css;this.base={items:[]};this.rc=P&&V.length||0;if(this.rc===0&&P){this.rc=U>0?1:0;}this.colWidths=P&&H.cws||[];if(!this.rc){return ;}var L={items:[]},I=1,Q,T;for(T=0;T<U;++T){J[T].axis=1;J[T].ui=T;L.items.push(J[T]);}if(O>0){V[0].axis=2;V[0].ui=0;G[0].axis=2;G[0].ui=0;I=V[0].rs||1;if(X&&I>1){V[0].rs=1;Q=mstrmojo.hash.clone(V[0],{});Q.n="&nbsp;";V[0].cni=R.push({n:(R[V[0].cni].n||"")+" fsbp_1"})-1;}L.items.push(V[0]);}var K=this.base.items;K.push(L);for(T=1;T<O;++T){if(I>1){var S=I;while(S-->1){if(X){var W=mstrmojo.hash.clone(Q,{});W.cni=R.push({n:(R[W.cni].n||"")+" fsbp_"+((S==1)?"3":"2")})-1;K.push({items:[W]});}else{K.push({items:[]});}}}V[T].axis=2;V[T].ui=T;G[T].axis=2;G[T].ui=T;I=V[T].rs||1;if(X&&I>1){V[T].rs=1;Q=mstrmojo.hash.clone(V[T],{});Q.n="&nbsp;";V[T].cni=R.push({n:(R[V[T].cni].n||"")+" fsbp_1"})-1;}K.push({items:[V[T]]});}this.rc=K.length;if(M){this._removeExtraColumn(J,V);}},getAvailableRowsCount:function C(){return this.rc;},isDataAvailable:function B(H,G){return true;},_removeExtraColumn:function F(J,Z){var X=J&&J.length,O=Z&&Z.length,G=this.gridData.gts,R=G.row||[],M=G.col||[],H=R.length,V=M.length;if(!X||!O){if(O===1){var a=Z[O-1];if(a.otp==-1){if(V>0){M[V-1]._hid=true;}this.base.items=[];this.rc=0;}}return ;}var I=J[X-1],S=this.rc,K=this.base.items;if(I){if(I.otp==-1){if(H>0){R[H-1]._hid=true;}K[0].items.splice(X-1,1);}else{var P=S>1?S-1:0,Q=K[P],Y=Q.items.length;if(Y>0&&V>0){M[V-1]._hid=true;}var L=I.fix;if(L){for(var W=0;W<L;W++){Q.items[Y-1+W]=J[X-L+W];}}else{Q.items[Y-1]=I;}for(var U=0,T=O-1;U<T;U++){Z[U].cs=L?L:I.cs;}var N=L?L:1;K[0].items.splice(X-N,N);}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var Y=1,b=2,o=4,U=8,g=1,h=2,F=3,n=4,S=5,K=6,j=7,D={},X={120:0.75,240:1,320:1.5},l={1:30,2:26,3:20,4:70,5:40,6:34,7:40},H=4,P=1,I={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},R=mstrmojo.hash,T=mstrmojo.array;function W(w,s){var t=w[0],p=s.gts,q=p.cws.length;return(s.vp.gr==="1"&&(q>1));}function i(q,z){var w=function(AA,AB){if(AB&&AA&&AA.css&&AA.css.indexOf(AB)<0){AA.css+=" "+AB;}};var t=z.type,s=z.col,x=(s&&s.cl)||0,p=(t===b||t===Y);if(t===b||t===U){w(q,I.RIGHT_ALIGN);}else{if(t===Y||t===o){w(q,I.LEFT_ALIGN);}}if(p){if(s&&s.tg&&x>1){if(!q._v){q._v=q.v;q.v="<span class='toggleHeader'>"+q.v+"</span>";}}w(q,I.TITLE);}T.forEach(z.extraCss,function(AA){w(q,AA);});}function A(p){return 0;}function k(w){var s,t=w.cg,p=t&&t.cgc,q=1;for(s=0;s<p;s++){if(t&&t[s]&&!t[s].tg&&t[s].cl>q){q=t[s].cl;}}return q;}function L(q,p){var s=n;if(p>1){if(q===0){s=g;}else{if(q===p-1){s=F;}else{s=h;}}}return s;}function J(p,w,s,q){var z=q&&q.cols&&q.cols.cg,t,AA=0,x=0;if(z){for(t=0;t<w;t++){if(p[t]){AA+=p[t].length;}}AA+=(s+1);for(t=0;t<z.cgc;t++){x+=z[t].cl;if(x>=AA){return t;}}}return -1;}function N(AA,t,q,p){var z=[],x,s,w,AB;for(s=0,w=AA.length;s<w;s++){if(AA[s].length===1){x=AA[s][0];x.rowType=(x.rowType!==j)?L(t,q):j;x.singleStack=(q>1);x=R.copy(x);if(x.ts===H){if(q===1){x.rowType=n;x.colIdx=J(AA,s,t,p);}else{if(!t){x.colIdx=J(AA,s,t,p);}else{delete x.ts;x.v="";}}}else{if(t){x.v="";}}}else{x=AA[s][t];if(!x){AB=AA[s].length;x=R.copy(AA[s][AB-1],{});x.v="";if(x.hasOwnProperty("ts")){delete x.ts;}}else{if(x.ts===H){x.colIdx=J(AA,s,t,p);}}x.rowType=(x.rowType!==j)?L(t,q):j;}z.push(x);}return z;}function O(p){if(p===0){return 0;}var q=this.sectionMap[p-1]||0;return Math.floor((p-q)/this.stackLevels);}function C(AA){var x,z,w=this.sectionInfo,p=w.length,t=this.srh,q=this.lastSectionIndex;z=w[q];if(AA>=z.rs&&AA<(z.rs+t)){return z;}if(AA<z.rs){x=q-1;if(x<=0){this.lastSectionIndex=0;return null;}do{z=w[x];if(AA>z.rs&&AA<=(z.rs+t)){this.lastSectionIndex=x;return z;}}while(AA<z.rs&&--x>0);this.lastSectionIndex=x;return z;}else{x=q+1;if(x>=p){this.lastSectionIndex=p-1;return null;}do{z=w[x];if(AA>z.rs&&AA<=(z.rs+t)){this.lastSectionIndex=x;return z;}}while(AA>(z.rs+t)&&++x<p);this.lastSectionIndex=x-1;return null;}}function a(AB,s,p,AA){var z=AB[0],w,x=AB.length,q=z&&z.rowType,t={v:"",css:"empty-igcell",rowType:q};if(p!==undefined&&z&&(q===g||q===n||q===S)){t={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+AA+"px;top:-"+(0.5*D[q])+'px;"></div></div>',css:"IG-ActionArrow",_ei:p};}for(w=x-1;w>=x-s;w--){z=AB&&AB[w];if(z){z.css+=" IG-lastdatacolumn";}}AB.push(t);}function Q(AO,AJ,s){var AF=AO.cols,AG=AF.cg,p=[{w:"0px"}];if(AF&&AJ){var AP=AF.cws,q=[],AN=AP.length,AR=0,AB=(parseInt(AO.ar,10)===1)?(AJ/AN):-1,AE,t,AD=false,x=0,AH=AJ,AI=0,AM;for(AM=0;AM<AN;AM++){t=q[AM]=AP[AM];AE=t.w;if(AE===""){AD=true;}else{if(t.xc){AR+=parseInt(AE);AH-=AR;x++;}else{AI+=parseFloat(AE,10);}}}if(AD||AI<100){AB=AH/(AN-x);}for(AM=0;AM<AN;AM++){t=AP[AM];if(t.xc){continue;}else{if(AB===-1){AE=parseInt(t.w,10)*AH/100;if(!AE&&AE!==0){AE=parseInt(AH/AG.cgc,10);}}else{AE=(parseInt(t.w,10)<0)?0:AB;}}q[AM]={w:AE+"px"};}if(s){return q;}var AC=[],AL=0;for(AM=0;AM<AN;AM++){var AQ=AG[AM],AA=AQ.tg?AQ.cl:1,AK=0;for(AK=0;AK<AA;AK++){var z="0px";if(AK===AQ.cc){z=q[AM].w;}AC[AL+AK]={w:z};}AL+=AA;}return AC.concat(p);}else{if(s){return null;}else{return cp.cws.concat(p);}}}function B(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function M(){var AC=this.cps,AB=this.cps[0],AH=Math.max(AC[0].rc,AC[1].rc);if(AB.type!==Y){var AM=this.gridData,AG=function(AP,AS){var AO=AP.base.items,AQ=AP.lookupBase[0].es,AR=AO[AS].items[0],AN=AQ&&AQ[AR.idx];return(AN&&AN.n)||((AR.pi&&AQ[AR.pi.ri||0])||"");},AK,AJ,p=1,z,q,AE,t=0,s=-1,AF,AL,AI=0,AD=this.groupEnabled;for(AF=0,AK=0,AL=AB.cps?AB.cps.length:1;AF<AL;AF++){var x=AB.cps?AB.cps[AF]:AB,AA=x.rc;t=s+1;s=t+AA-1;if(x.isDataAvailable(t,s)){if(x.lastRow){AI=x.lastRow;q=x.lastSection;}else{AK=AI||0;for(AJ=0,p=this.sectionMap[AK-1]||0;AJ<AA;AJ++){var w=this.stackLevels;AE=AG(x,AJ);if(AD&&AE!==q){q=AE;this.sectionInfo.push({sn:AE,rs:this.srh*p+this.stackedRh*Math.floor((AK-p)/this.stackLevels)});this.sectionMap[AK]=++p;AK++;}while(w){this.sectionMap[AK]=p;w--;AK++;}}AI=x.lastRow=AK;x.lastSection=AE;}}else{break;}}this.rc=(this.stackLevels>1?AH*this.stackLevels:AH)+(AD?p:0);}},onDemandDataReady:function Z(){this.adjustCPMaps();},initContent:function V(AC){var AB=this.cps,AN=this.gridData=AB[0].gridData||AB[0].cps[0].gridData,AJ=AN.vp=this.gridVp=this.gridVp||AN.vp,s=AJ.daf&&AJ.daf.split(":"),AD=AJ.cols,AE=AD.cg,AK=AD.cws,AA=AB[A(AE)],AH=AN.gts.row,q=AN.gts,AL=W(AB,AN),z=AA.type!==Y,AG,AI,w,p,AF,x,AM,t=mstrApp.isTablet()?240:mstrMobileApp.getDeviceDPI();R.forEach(l,function(AP,AO){D[AO]=AP*X[t];});if(z){if(AJ.dafIdx===undefined&&s){for(AG=0;AG<AH.length;AG++){if(AH[AG].id===s[0]&&AH[AG].fid===s[1]){AJ.dafIdx=AG;break;}}}}for(AG=0;AG<AE.cgc;AG++){if(AE[AG]&&AE[AG].tg){break;}}if(AG===AE.cgc){AN.gts.show=false;AN.ghs.chs.show=false;}this._super(AC);this.colWidths=Q(AJ,this.gridWidth);this.tdWidths=Q(AJ,this.gridWidth,true);if(z){this.stackLevels=k(AD);if(this.stackLevels>1){this.srh=D[K];this.rh=D[n];this.mrh=D[F];this.stackedRh=D[g]+(this.stackLevels-2)*D[h]+D[F];}else{this.srh=D[K];this.rh=this.stackedRh=this.mrh=D[n];}if(AL||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AL;this.adjustCPMaps();p=this.cps[0].cps;if(p){AM=this;for(AG=0,AI=p.length;AG<AI;AG++){x=p[AG];if(x&&x.addCPListener){x.addCPListener(AM);}}}}}},getUnmergedCells:function(p){return ;},getResolvedGroupHeader:function(s,w){var q=this.gridData,t=q.gts.row[w].es,p=q.ghs.rhs.items[s].items[w];if(p){if(!p.css){p.css=q.css[p.cni].n+" iggroup";p.n=t[p.idx].n;}}else{return{css:" iggroup",n:""};}return p;},getRowCells:function(AL){var AG=this.cps,z=[],AZ=this.gridData,AV=AZ.vp,AJ=AV.cols.cg,AE=AG[A(AJ)],AI=this.groupEnabled,s=AV.bn==="1",AW=[],AK=O.call(this,AL),AA,t,AM=1,AF,q,AC,AS,AR,AU,AY,AD;if(AI&&(this.sectionMap[AL]!==this.sectionMap[AL-1])){var w=R.copy(AE.getRowCells(AK)[0],{});w.cs=this.colWidths.length;w.rowType=K;i(w,{col:null,type:AE.type,extraCss:[I.GROUPING]});return[w];}if(!AL){B.call(this);}this.lastAttRow=this.lastAttRow||(AG[0].rc?AG[0].getRowCells(AK):[]);this.lastMtxRow=this.lastMtxRow||(AG[1].rc?AG[1].getRowCells(AK):[]);AC=this.lastAttRow;AU=AC.length;if(AU>0&&AC[0].stt){AF=true;for(AS=0;AS<AU;AS++){AY=AC[AS];if(AY.stt===P){q=AY;break;}}}if(!this.lastStackCols){T.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AS=0;AS<p.length;AS++){if(p[AS]._ei!==undefined){if(AV.dafIdx>=0){AD=AE.getRowCells(AK)[AV.dafIdx];}AA=(AV.dafIdx>=0)?(AD&&AD._ei):"";return false;}}},this);var AQ=function(p,Aa){if(p&&(Aa.type===Y||Aa.type===b)){if(AO.tg===false){p.n=p.v="";}p.rowType=j;}i(p,{col:AO,type:Aa.type,extraCss:[((Aa.type===U||Aa.type===o)&&s&&(AK%2===1))?I.BANDING:null,AF?I.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AV.dafIdx!==undefined){p._ei=AA;}}};this.lastRowIndex=0;for(AR=0;AR<AJ.cgc;AR++){var AO=AJ[AR],AT=AO["mix"+AO.cc],x=AT!==undefined,AB=AG[x?1:0],AP,AN,AH,AX={n:"",stt:P,css:"xtab-td"};arr=[];if(AO.tg){for(var AS=0;AS<AO.cl;AS++){arr=[];AH=x?AO["mix"+AS]:AO.attForms[AS].idx;var AC=x?this.lastMtxRow:this.lastAttRow;AY=AC[AH];if(AF){if(!AY){AY=AX;}else{if(AY&&AY.stt===P){AY=R.copy(q,AX);}else{AY=R.copy(AY,{});}}}else{AY=R.copy(AY,{});}AQ(AY,AB);arr.push(AY);AW.push(arr);}if(AR+1===AJ.cgc){AM=AO.cl;}}else{for(AP=0,AU=AO.cl;AP<AU;AP++){if(x){AN=AO["mix"+AP];if(AN!==undefined){AY=this.lastMtxRow[AN];}}else{AN=AO.attForms[AP];if(AN){AY=this.lastAttRow[AN.idx];}if(AF&&!AY){AY=AX;}}AQ(AY,AB);arr.push(AY);}AW.push(arr);}}this.lastStackCols=AW;}z=N(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AV);if(this.lastRowIndex>=this.stackLevels){B.call(this);}return z;},getRowHeight:function E(q){var p=D[n];return D[q]||p;},isDataAvailable:function f(q,p){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var w=this.sectionMap.length,t;if(!w){return this.cps[1].isDataAvailable(q,p);}if(p>w){if(q<w){t=O.call(this,q);return this.cps[1].isDataAvailable(t,t+(p-q));}else{return false;}}else{return this.cps[1].isDataAvailable(O.call(this,q),O.call(this,p));}}},download:function G(AA,w){var p=O.call(this,AA),z=p+Math.ceil((w-AA)/this.stackLevels),x=this.cps[0],q,s,t=!x.cps?[x]:this.cps[0]._getCPs(p,z);for(q=0;q<t.length;++q){s=t[q];s.download(p,z);}},getRowCellInfo:function(t){var s=C.call(this,t+this.srh),p,q=this.lastSectionIndex;if(s){p=this.sectionInfo[q-1];return{rowStart:s.rs,isNextRowNewSection:true,sectionName:p&&p.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[q].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TristateCheckBox","mstrmojo._IsInputControl");mstrmojo.CheckBoxDIC=mstrmojo.declare(mstrmojo.TristateCheckBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CheckBoxDIC",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" tabindex="1" mstrAttach:click,keydown></div>',cssText:"width: 0; margin:0 auto; max-height: 18px; cursor: pointer;",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);this.set("checked",true);}else{this.set("checked",!this.checked);}},oncheckedChange:function(A){this.set("value",this[this.checked?"onValue":"offValue"]);},preBuildRendering:function(){this._super();var A=this.dic.vls;this.offValue=A[0].v;this.onValue=A[1].v;this.grayed=(this.onValue!==this.value)&&(this.offValue!==this.value);this.checked=(this.onValue===this.value);},postBuildRendering:function(){this._super();this.domNode.style.height=this.openerStyle.ih+"px";},onkeydown:function(B){var A=B.hWin,C=B.e||A.event;if(C.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(A,C);this.onclick();}},focus:function(){this.domNode.focus();}});})();(function(){var D="mstrXtabCellMenu",M="mstrmojo.all['"+D+"'].selectedData",E="mstrmojo.all['"+D+"'].xtab",F="mstrmojo-InteractiveButton",H="mstrmojo.Box",B="mstrmojo-Menu-Box",G="mstrmojo.MenuItem";function K(R,O){var Q=mstrmojo.all[D],P=Q.xtab,N=[Q.selectedData].concat(O||[]);Q.close();P[R].apply(P,N);}function J(){K("link",[this.index]);}function A(P,R,Q,N){var O={scriptClass:G,text:P,iconClass:"mstrmojo-oivmSprite "+R,cssClass:F,onclick:Q};if(N){O.bindings=N;}return O;}function C(O,Q,P){var N=A(O,"tbPivot"+Q,function(){K("pivot",[P]);});N.bid=P;return N;}function I(O,P,N){return A(O,"tbSort"+P,function(){K("sort",[(N==="true")]);},{selected:"mstrmojo.all['"+D+"Sort'].so === "+N});}function L(Q,P,O){if(!Q){return null;}var N=P.model.getCellDrillsInfo(O);if(!N||!N.k){return null;}return A(mstrmojo.desc(183,"Drill to")+" "+(N.n||""),"tbDrill",function(){K("drill");});}mstrmojo.XtabCellMenu=mstrmojo.registry.ref({id:D,slot:"popupNode",scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-Menu",shadowNodeCssClass:mstrmojo.dom.isIE?"mstrmojo-Menu-shadow":"",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,updatePopupConfig:function(O){O=O||{};this.xtab=O.xtab;this.selectedNode=O.td;var R=this.selectedData=O.xtab&&O.td&&O.xtab.getCellForNode(O.td);this.onClose=O.onClose;var N=this.sortOptions;N.set("visible",((R&&R.at)||0)&8);N.set("so",R&&R.so);N=this.pivotOptions;var S=((R&&R.at)||0)&16;if(S){for(var Q=0;Q<6;Q++){var T=N.children[Q];T.set("visible",this.xtab.model.isPvtButtonVisible(R,T.bid));}}N.set("visible",S);N=this.linkOptions;N.set("visible",((R&&R.at)||0)&4);N=this.drillOptions;var P=((R&&R.at)||0)&1;N.set("visible",P);N.set("children",[L(P,this.xtab,R)]);this.cfg=O;},onOpen:function(){var T=this.cfg,S=T.opener,a=S&&S.domNode&&mstrmojo.dom.position(S.domNode),b=a.y||0,V=T.cmPos,X,U;if(V){X=V.x;U=V.y-b;}else{var O=T.btn&&T.btn.domNode;var Z=mstrmojo.boxmodel.offset(O,S&&S[this.slot]);X=Z.left;U=Z.top+((O&&O.offsetHeight)||0);}var R=mstrmojo.dom.windowDim(),P=this.domNode;var Q=P.offsetHeight,W=R.h-b,Z=Math.max(0,U+Q-W);this.set("top",U-Z+"px");var Y=P.offsetWidth,N=R.w,Z=Math.max(0,X+Y-N);this.set("left",X-Z+"px");},children:[{id:D+"Links",alias:"linkOptions",scriptClass:H,cssClass:B,visible:false,children:[{scriptClass:"mstrmojo.WidgetList",autoHide:true,itemFunction:function(O,N){if(N===0){mstrmojo.requiresCls(G);}return new mstrmojo.MenuItem({text:O.n||O.url||(O.target&&(O.target.n||O.target.did)),cssClass:F,cssText:(N===this.itemsInfo&&this.itemsInfo.di)?"font-weight: bold":"",index:N,onclick:J});},bindings:{itemsInfo:"this.parent.parent.visible ? "+E+".model.getCellLinksInfo("+M+") : null",items:"this.itemsInfo.links"}}]},{id:D+"Drill",alias:"drillOptions",scriptClass:H,cssClass:B,visible:false},{id:D+"Sort",alias:"sortOptions",scriptClass:H,cssClass:B,children:[I(mstrmojo.desc(7974,"Sort Ascending"),"Asc","true"),I(mstrmojo.desc(7975,"Sort Descending"),"Desc","false")]},{id:D+"Pivot",alias:"pivotOptions",scriptClass:H,cssClass:B,children:[C(mstrmojo.desc(5362,"Move Left"),"Left","l"),C(mstrmojo.desc(5363,"Move Right"),"Right","r"),C(mstrmojo.desc(7978,"Move Up"),"Up","u"),C(mstrmojo.desc(7979,"Move Down"),"Down","d"),C(mstrmojo.desc(7976,"Move to Columns"),"Cols","2"),C(mstrmojo.desc(7977,"Move to Rows"),"Rows","1")]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var L=this;this._renderTimer=self.setInterval(function(){var M=L.getPagesToRender();if(M.length>0){L.renderPages(M);}else{L.renderingRows=false;self.clearInterval(L._renderTimer);delete L._renderTimer;if(L.isRenderingComplete()){L.postRenderingCleanup();}L=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],Z=this._pageHeight,b=null,W=this._pageStatus,Y=this;function R(f){var g=W[f];if(g&&g.filled){if(!g.height){if(!b){b=Y.itemsNode.tBodies;}g.height=b[f].offsetHeight;}return g.height;}else{return Z;}}var a=0,S=null,O=null,M=this.scrollboxTop;for(var V=0,X=this._totalPages;V<X;V++){a+=R(V);if(a>=M){S=V;break;}}if(S==null){S=O=X-1;}else{var L=this.scrollboxBottom;for(var T=S+1;T<X;T++){if(a>=L){O=T-1;break;}a+=R(T);}}if(O==null){O=X-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var U=W[Q];if(!U||!U.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var V=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(V[R]&&V[R].filled)){return ;}}var U=this._rowsPerPage,L=R*U,N=Math.min(L+U,this._rc)-1;var T=this.tempTableCont;if(!T){T=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';T.innerHTML=Q;var O=T.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList");var A=function(O,P){var N=O.parent.opener,F=N&&N.showDesc,M=N&&N.showPath,E=P[O.itemField];var L=mstrmojo.string.escape4HTMLText,Q="";if(M){var I=P.anc&&P.anc.items,K=I&&I.length;if(K>0){for(var H=0;H<K-1;H++){Q+=I[H].n+" > ";}Q+=L(I[K-1].n);}else{if(P.path){Q+=P.path;}}}Q+=(Q.length==0?"":" > ")+L(E);if(F){var J=P[O.itemDescField],G=120;if(J){Q+="\r\n\r\n"+L(J.substring(0,G)+(J.length>G?"...":""));}}return Q;};var C=function(E,F,G){if(!F||!G){return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var H=F.path||F.getAttribute("path");if(H){return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(I){var J=D(I.toString())||"";G.path=J;F.path=1;F.title=A(E,G);}},{taskId:"getObjectDetails",objectID:G.did,objectType:G.t,sessionState:mstrApp.sessionState},undefined);},200);};var D=function(G){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(G,"text/xml");}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(G);}var K=xmlDoc.getElementsByTagName("path")[0],H=K.childNodes,J="";if(H){for(var F=0,E=H.length;F<E;F++){var I=H[F].childNodes&&H[F].childNodes[0];if(I){J+=mstrmojo.string.escape4HTMLText(I.nodeValue)+(F<E-2?"> ":"");}}}return J;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",itemDescField:"desc",getItemMarkup:function(G,E){var F=this.parent.opener,H=A(this,G);return'<div class="mstrmojo-suggest-text '+((F&&F.item2textCss(G))||"")+'" idx="'+E+'" title="'+H+'">'+F.getHighlightedText(F.getSearchPattern(),mstrmojo.string.escape4HTMLText(G[this.itemField]))+"</div>";},getItemProps:function B(F,E){return{};},onmouseover:function(F){var I=this.parent.opener;if(I&&I.showPath){var G=mstrmojo.dom.eventTarget(F.hWin,F.e),E=G.getAttribute("idx"),H=E!=null?this.items[E]:null;if(H&&H.t>-1){C(this,G,H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate");mstrmojo.MCSUtil=mstrmojo.provide("mstrmojo.MCSUtil",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],getQuaByFunc:function(U,V){var R=this.F,Q=this.Q,T=mstrmojo.array;var S=function(W){if(T.indexOf(R[1],W)!==-1){return true;}else{return false;}};if(V===undefined||V==this._GENERIC){return Q._G;}else{if(S(U)){return(V==this._RANK)?Q._RT:Q._PT;}else{return(V==this._RANK)?Q._RB:Q._PB;}}},getFuncInfo:function(Q,R){var T,S;switch(R){case this.Q._G:T=this._GENERIC;S=0;break;case this.Q._RT:T=this._RANK;S=1;break;case this.Q._RB:T=this._RANK;S=2;break;case this.Q._PT:T=this._PERCENT;S=1;break;case this.Q._PB:T=this._PERCENT;S=2;break;default:return{};}return{ft:T,f:this.F[S][Q]};},getOpIdxByfunc:function(U,V){if(!U||!V){return -1;}var R=this.F,Q=this.Q,T=mstrmojo.array,S=-1;switch(V){case this._GENERIC:S=T.indexOf(R[0],U);break;case this._RANK:case this._PERCENT:S=T.indexOf(R[1],U);if(S==-1){S=T.indexOf(R[2],U);}break;}return S;},getIncludeByOp:function(R){var Q=this.OP;switch(R){case Q._EQUALS:case Q._GREATER_EQUAL:case Q._LESS_EQUAL:case Q._BETWEEN:case Q._IN:return true;}return false;},formatNumber:function(T,R,Q){if(T==B.Q._G){var S=mstrmojo.num;return(Q.fm)?S.formatByMask(Q.fm,R):S.format(Q.cat,Q.dp,Q.curr,R);}else{if(T==B.Q._RB||T==B.Q._RT){return parseInt(R);}else{if(T==B.Q._PB||T==B.Q._PT){return parseFloat(R)+"%";}}}}});var B=mstrmojo.MCSUtil,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,F=[{n:mstrmojo.desc(2795,"Equals"),v:B.OP._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:B.OP._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:B.OP._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:B.OP._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:B.OP._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:B.OP._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:B.OP._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:B.OP._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:B.OP._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:B.OP._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:B.OP._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:B.OP._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var D=function(Y,Q,S,U,T){if(T==2){return Q;}var Z=String(Y).split(";"),W=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(U&&Z&&Z.length>1){Q.code=W;}else{for(var V=0;V<Z.length;V++){var X=parseFloat(Z[V],10);if(isNaN(X)||(S&&((Z[V].match(/^\d+(\.\d+)?%$/)==null&&Z[V].match(/^\d+(\.\d+)?$/)==null)||X<0||X>100))||(!S&&Z[V].match(/\d+$/)==null)){Q.code=W;}if(Q.code!=R){break;}}}if(Q.code!=R){Q.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return Q;};var M=function(Q){Q=parseFloat(Q);if(isNaN(Q)){return"54px";}else{return(Q*72/16)+"pt;";}},P=function(S){if(S.hasRendered){var R=S.domNode.style;R.font=S.font;R.width=M(R.fontSize);}else{var Q=S.font.match(/[^\s]*?pt/)||[];S.cssText=S.cssText+" font:"+S.font+"; width:"+M(Q[0]);}},I=function(Q){if((Q>=8&&Q<=16)||(Q>=23&&Q<=25)||Q==30){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function O(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(Q){if(this._super){this._super(Q);}this._init();},_init:function(T){switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(T){this.cs=[];this.f=this.ft=null;}var U=B.getOpIdxByfunc(this.f,this.ft),Q;if(this.qua==0||this.dt==30){Q=(U==B.OP._IS_NOT_NULL||I(this.dt))?(U==-1)?B.OP._GREATER_EQUAL:U:B.OP._IS_NULL;}else{Q=(U==-1)?B.OP._GREATER_EQUAL:U;}this.set("opId",Q);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId==B.OP._IN||this.opId==B.OP._NOT_IN){for(var S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function C(Q,R){this.da=Q;this.updateExpr(R);},updateExpr:function A(Q){if(Q){this.cs=Q.cs;this.f=Q.f;this.ft=Q.ft;this.qua=Q.qua;}this._init();},onquaChange:function N(Q){this._init(true);this.func.items=(this.qua!=0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!=0)?L:I(this.parent.dt)?F:H;},onchange:function(){var Q=this.parent,R=this.selectedItem;if(R&&R.v!==null&&R.v!==undefined){Q.set("opId",R.v);}if(mstrApp.isMobile&&(R.v===B.OP._IS_NULL||R.v==B.OP._IS_NOT_NULL)){if(Q.onchange){Q.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){var R=this.parent,Q=this.domNode;R.set("cs1",this.value);if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(R){var Q=R.hWin,U=R.e||Q.event,T=this.parent,S=R.src.domNode;if(U.keyCode===13&&T.apply&&T.apply.enabled){T.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){this.parent.set("cs2",this.value);var Q=this.domNode;if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(R){var Q=R.hWin,T=R.e||Q.event,S=this.parent;if(T.keyCode===13&&S.apply&&S.apply.enabled){S.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var S=this.parent,V=(S.qua==B.Q._PT||S.qua==B.Q._PB);S.cs=[];var T=function(W){return W+((V&&!String(W).match(/^\d+%$/))?"%":"");};var R=function(W,X){return((W==2||W==3)&&X==0)?14:5;};if(S.opId==B.OP._IN||S.opId==B.OP._NOT_IN){var U=String(S.cs1).split(";");for(var Q=0;Q<U.length;Q++){if(!mstrmojo.string.isEmpty(U[Q])){S.cs.push({dtp:5,v:T(U[Q])});}}}else{if(S.vldTbL.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs1)});}if(S.vldTbH.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs2)});}}if(S.onchange){S.onchange();}if(S.makeSelection){S.makeSelection();}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(F,D){var E=this.items;this.items=D||[];return E!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var E=this.value,D=this.selectedIndex,G=this.items||[],H,F;if(D===undefined||(E!==null&&(D===-1||(D!==-1&&G[D]&&G[D][this.itemIdField]!==E)))){D=mstrmojo.array.find(G,this.itemIdField,E);D=(D>-1)?D:this.defaultSelection;this.selectedIndex=D;}else{if(E===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=H=G[this.selectedIndex];if(H){F=H[this.itemField];}else{F=this.defaultText||"";}this.set("text",F);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function(E){var F=this.value,D=-1;if(F!==null){D=mstrmojo.array.find(this.items,this.itemIdField,F);}if(D>-1){this.selectedItem=this.items[D];this.selectedIndex=D;}},togglePopup:function C(){if(this.popupToBody){var G=mstrmojo.dom.position(this.popupNode,true),F=this.popupRef,D={left:Math.round(G.x)+"px",top:Math.round(G.y)+"px"};if(!F.hasRendered){delete F.slot;D.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(D,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var E=this.popupRef.domNode;if(E){if(this.fixWidth){E.style.width=(this.domNode.offsetWidth-2)+"px";}else{E.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(D){this.togglePopup();},unrender:function B(D){var E=this.popupRef;if(this.popupToBody&&E.hasRendered){E.unrender(false);}if(this._super){this._super(D);}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var F=this.opener,E=F&&F.popupZIndex,G=F&&F.popupCssClass||"",D=this.domNode;if(E){D.style.zIndex=E;}if(G){mstrmojo.css.addClass(D,[G]);}if(F&&F.fixWidth){mstrmojo.css.addClass(D,["fix-width"]);}if(F&&F.fixHeight){mstrmojo.css.addClass(D,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(F,D,E){return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+(F[E.itemCSS]||"")+'" title="'+F[E.itemField]+'">'+(F[E.itemField]||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var F=this.parent,G=F.visible,D=F.opener,E=this.selectedItem;if(!D||!E||!G){return ;}D.set("value",E[this.itemIdField]);}}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip","mstrmojo.HBox");var B=mstrmojo.dom,C=mstrmojo.css,A=1,G=2,F=3,E=function(I){var H=C.getStyleValue(I,"verticalAlign");return{top:A,bottom:F,middle:G}[H]||A;};mstrmojo.SliderBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SliderBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table></div>',markupSlots:{valuePartNode:function(){return this.domNode.firstChild;},valueLabelNode:function(){return this.domNode.firstChild.firstChild;},valueTextNode:function(){return this.domNode.firstChild.lastChild;},sliderPartNode:function(){return this.domNode.lastChild;},minTextNode:function(){return this.domNode.lastChild.rows[0].cells[0];},maxTextNode:function(){return this.domNode.lastChild.rows[0].cells[2];},sliderNode:function(){return this.domNode.lastChild.rows[0].cells[1];}},markupMethods:{onmaxChange:function(){this.maxTextNode.innerHTML=this.max;},onminChange:function(){this.minTextNode.innerHTML=this.min;},onvalueTextChange:function(){this.valueTextNode.innerHTML=this.valueText;},onunsetChange:function(){var H=this.sliderBar.domNode;if(H){mstrmojo.css.toggleClass(H,"unset",this.unset);}}},tabIndex:-1,sliderRef:null,valueLabel:mstrmojo.desc(4104,"Value:"),valueText:"",min:"",max:"",interval:0,isSequential:false,unset:false,cssClass:"mstrmojo-SliderGroup",postCreate:function D(){if(!this.sliderRef){this.sliderRef={scriptClass:"mstrmojo.Slider",isHoriz:true,ontitleChange:function(){if(this.domNode&&this.title){this.domNode.setAttribute("title",this.title);}},onselectionChange:function(){if(!this.hasRendered){return ;}var I=this.items[this.selectedIndex]&&this.items[this.selectedIndex].n,H=this.parent;if(H.unset){H.unset=false;C.removeClass(this.domNode,"unset");}H.set("valueText",I);H.set("value",I);this.typeHelper.updateThumb();}};}this.sliderRef.slot="sliderNode";this.sliderRef.alias="sliderBar";this.addChildren(this.sliderRef);},preBuildRendering:function(){this._super();var M=this.min,I=this.max,K=mstrmojo.num.parseNumeric(this.value),J=this.items,H,L=this.sliderBar;if(this.isSequential){H=Math.floor((Math.max(Math.min(K,I),M)-M)/this.interval);if(isNaN(K)||K<M||K>I){this.unset=true;}}else{H=mstrmojo.array.find(J,"v",String(K));if(H==-1){this.unset=true;H=0;}}L.set("items",J);L.select(H||0);},postBuildRendering:function(){this._super();if(this.unset){C.addClass(this.sliderBar.domNode,"unset");}},alignSlider:function(K,H){var J=E(K),I,L;if(!this.valuePartNode){L=this.valueCssText||"";I=this.sliderCssText||"";if(J===A){this.valueCssText="top:0;"+L;this.sliderCssText="top:0;"+I;}else{if(J===F){this.valueCssText="bottom:0;"+L;this.sliderCssText="bottom:0;"+I;}else{this.valueCssText="height: 100%; line-height: "+H+"px;"+L;this.sliderCssText="height: 100%;"+I;}}}else{I=this.sliderPartNode.style;L=this.valuePartNode.style;if(J){if(J===A){I.top=L.top="0";}else{if(J===F){I.bottom=L.bottom="0";}else{L.height=I.height="100%";L.lineHeight=inlineHeight+"px";}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip");var T=mstrmojo.dom;var K=mstrmojo.all;mstrmojo._HasDnD={postBuildRendering:function V(){if(this._super){this._super();}var Y=this.id;this.dnd=new mstrmojo._DnDComponent({target:this});this.__mouseDownEvt=function(Z){K[Y].dnd.onmousedown(Z);return true;};T.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);},unrender:function U(){if(this.__mouseDownEvt&&this.dndNode){T.detachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);}this.min=0;this.max=(this.items&&this.items.length-1)||0;this.dnd&&this.dnd.clearListeners();this._super();}};mstrmojo._DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo._DnDComponent",isDragging:null,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,_mousemoveCounter:0,init:function J(Y){mstrmojo.hash.copy(Y,this);},onmousedown:function X(Y){if(Y&&Y.preventDefault){Y.preventDefault();}if(this.dragging){return true;}var Z=this.target.id;if(!this._mousemoveCallback){this._mousemoveCallback=function(a){K[Z].dnd.onmousemove(a);return true;};}this._mousemoveCounter=0;this.startE=mstrmojo.hash.copy(Y);T.attachEvent(document.body,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(a){K[Z].dnd.ondragcancel(a);return true;};}T.attachEvent(document.body,"mouseup",this._cancelCallback);},ondragcancel:function H(Y){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);if(this.afterDragCancel){this.afterDragCancel.apply(this.target,[Y]);}},onmousemove:function D(Y){if(this.dragging){return ;}this._mousemoveCounter++;if(this._mousemoveCounter>this.mousemoveBuffer){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);this.initDrag(Y);}},initDrag:function S(Y){this.dragging=true;var Z=this.target.id;if(!this._dragCallback){this._dragCallback=function(a){K[Z].dnd.ondrag(a);return true;};}T.attachEvent(document.body,"mousemove",this._dragCallback);if(!this._dragEndCallback){this._dragEndCallback=function(a){K[Z].dnd.ondragend(a);return true;};}T.attachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragStart){this.afterDragStart.apply(this.target,[Y]);}this._dragCallback(Y);},ondrag:function F(Y){if(this.duringDrag){this.duringDrag.apply(this.target,[Y]);}},ondragend:function E(Y){this.dragging=false;T.detachEvent(document.body,"mousemove",this._dragCallback);T.detachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragEnd){this.afterDragEnd.apply(this.target,[Y]);}},clearListeners:function I(){if(this._mousemoveCallback){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._cancelCallback){T.detachEvent(document.body,"mouseup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){T.detachEvent(document.body,"mousemove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){T.detachEvent(document.body,"mouseup",this._dragEndCallback);delete this._dragEndCallback;}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasDnD","mstrmojo._ListSelections");function B(Y){this.getUnit=function Z(){return Y._effLen/(Y.items.length-1)||1;};this.calcMinMax=function(b,a){var f=Math.round((b/Y.unit+a/Y.unit)/2);return{min:f,max:f};};this.preUpdateThumb=function(){Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";";};this.updateThumb=function(){Y.containerNode.style[Y.orCfg.posCssP]=Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";};}function P(Y){this.getUnit=function(){return Y._effLen/Y.items.length;};this.calcMinMax=function(a,Z){return{min:Math.floor(a/Y.unit+0.5),max:Math.floor(Z/Y.unit-0.5)};};this.preUpdateThumb=function(){Y.start=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),0)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";"+Y.orCfg.lenCssP+":"+Y.length+";";};this.updateThumb=function(){Y.start=Y.min*Y.unit+"px";Y.containerNode.style[Y.orCfg.posCssP]=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),1)+"px";Y.containerNode.style[Y.orCfg.lenCssP]=Y.length;};}var L="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasDnD,mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:0,useRichTooltip:true,init:function R(Y){this._super(Y);if(Y.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(Y.multiSelect){this.typeHelper=new P(this);}else{this.clsType="sc1";this.typeHelper=new B(this);}},markupSlots:{dndNode:function(){return this.domNode.childNodes[0];},bgNode:function(){return this.domNode.childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0];},frontNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[0];},thumbNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[1];},endNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[2];},tooltipNode:function(){return this.domNode.childNodes[0].childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,preBuildRendering:function A(){var f=this.orCfg.lenCssP,a=this[f],Z=parseInt(a);this._effLen=isNaN(Z)?0:(Z-this._exRoom);if(a){this.bkCssText=f+":"+Math.max(parseInt(a,10)-(2*this.cssBkBW),0)+"px;";this.sdcCssText=f+":"+this._effLen+";"+this.orCfg.posCssP+":"+this._exRoom/2+"px;"+this.orCfg.opPosCssP+":0px;";}var Y=this.selectedIndices;if(!mstrmojo.hash.isEmpty(Y)){this.min=this.items.length-1;this.max=0;for(var b in Y){if(Y[b]){this.min=Math.min(this.min,b);this.max=Math.max(this.max,b);}}}this.unit=this.typeHelper.getUnit();this.typeHelper.preUpdateThumb();},postBuildRendering:function V(){if(this._super){this._super();}if(this.items.length>1&&this.dnd){this.dnd.afterDragStart=this.initDrag;this.dnd.duringDrag=this.ondrag;this.dnd.afterDragEnd=this.ondrop;this.dnd.afterDragCancel=this.cancelDrag;}},_initGhost:function O(){if(!this.ghost){var b=this.containerNode.cloneNode(true);mstrmojo.css.addClass(b,["gh"]);this.ghost={containerNode:b,frontNode:b.childNodes[0],thumbNode:b.childNodes[1],endNode:b.childNodes[2]};this.sdcNode.appendChild(b);}var Z=this.ghost.containerNode.style,a=this.containerNode.style,Y=this.orCfg;Z[Y.posCssP]=a[Y.posCssP];Z[Y.lenCssP]=a[Y.lenCssP];Z.display="block";return this.ghost;},initDrag:function S(b,Y){Y=Y||window;var a=this._initGhost(),Z=this.orCfg;this.dnd.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:a.containerNode[Z.lenP],offset:T.getMousePosition(this.dnd.startE,Y)[Z.offsetP]};this.dnd.initD.td=T.eventTarget(Y,this.dnd.startE);},ondrag:function F(j,h){h=h||window;var k=this.dnd.initD,i=this.ghost,n=i.containerNode,p,a,Z,f=this.min,l=this.max,Y=this.orCfg;var o=T.getMousePosition(j,h)[Y.offsetP]-k.offset;switch(k.td){case this.thumbNode:p=Math.max(Math.min(k.tP+o,k.sL-k.contL),0);a=p+k.contL;n.style[Y.posCssP]=p+"px";var b=this.typeHelper.calcMinMax(p,a);f=b.min;l=b.max;break;case this.frontNode:p=Math.max(Math.min(k.tP+o,k.tP+k.contL),0);Z=Math.max(Math.min(k.contL-o,k.tP+k.contL),0);n.style[Y.posCssP]=p+"px";n.style[Y.lenCssP]=Z+"px";f=Math.min(Math.floor(p/this.unit+0.5),this.max);break;case this.endNode:Z=Math.max(Math.min(k.contL+o,k.sL-k.tP),0);a=k.tP+Z;n.style[Y.lenCssP]=Z+"px";l=Math.max(Math.floor(a/this.unit-0.5),this.min);break;default:return ;}if(f!==this.min||l!==this.max){this.min=f;this.max=l;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function W(a){this.typeHelper.updateThumb();if(this.ghost){this.ghost.containerNode.style.display="none";}this.hideTooltip();if(this.items&&this.items.length){var Z=[];for(var Y=this.min;Y<=this.max;Y++){Z.push(Y);}this.select(Z);}this.dnd.initD=null;},cancelDrag:function Q(Z,Y){if(this.makeSelection){Y=Y||window;var a=T.eventTarget(Y,this.dnd.startE);this.makeSelection({selItem:a});}},showTooltip:function C(Z,Y){this._updateTooltip();this._super(Z,Y);},hideTooltip:function G(Z,Y){if(this.dnd&&this.dnd.dragging){return ;}this._super(Z,Y);},_updateTooltip:function N(){var Z=this.orCfg,b={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},f=(this.ghost)?this.ghost.containerNode:this.containerNode;b[Z.opPosCssP]=0;b[Z.posCssP]=f.style[Z.posCssP];if(this.items&&this.items.length){var a=this.getItemTooltip(this.items[this.min]);var Y;if(this.min===this.max){Y=a;}else{Y=mstrmojo.desc(146,"From:")+" '"+a+"' "+mstrmojo.desc(147,"To:")+" '"+this.getItemTooltip(this.items[this.max])+"'";}b.content=L.replace(/\{@content\}/g,Y);}else{b.content="";}this.set("richTooltip",b);},getItemTooltip:function(Y){return"'"+(Y?Y.n:"")+"'";},unrender:function U(Y){this.ghost=null;this.dnd&&(this.dnd.dragging=false);this.hideTooltip();this._super(Y);},onselectionChange:function M(Y){if(this.onchange){this.onchange();}if(this.makeSelection&&this.dnd&&this.dnd.initD){this.makeSelection({selItem:this.dnd.initD.td});}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo.tooltip","mstrmojo.string","mstrmojo.array");var J=0,H=mstrmojo.array,M=mstrmojo.string;function C(){var Q=this.textNode,S=this.imgNode;if(this.eg!=null){S.style.display="none";Q.innerHTML=this.eg||"";Q.style.display="block";}else{Q.style.display="none";S.style.display="block";if(this.tooltip){S.setAttribute("ttl",this.tooltip);}var R=this.getFormats();this.retrieveGraphSrc(R.height,R.width);}}var N={6:"poly",7:"rect",100:"circle"};function I(){var Z=this.as,V=Z&&Z.length;if(!V){return ;}var U=this.id,Y=U+"_map"+J++,S=[],X=-1,T;for(T=0;T<V;T++){var R=Z[T];R.id=U;R.aid=T;R.tooltip=M.multiReplace(R.tooltip||"",{"&#13":"<br />","&#32":" "});if(!isNaN(R.shape)){R.shape=this.getAreaShapeName(R.shape);}if(R.tks||R.tks===""||R.tty===1){R.extra=' href="#" ';}S[++X]=M.apply(this.areaMarkup,R);}var W='<map id="'+Y+'" name="'+Y+'">'+S.join("")+"</map>";if(!this.domNode){this.att='usemap="#'+Y+'" ';this.map=W;}else{var Q=document.createElement("div");Q.innerHTML=W;if(this.mapNode){Q=Q.firstChild;this.mapNode.innerHTML=Q.innerHTML;}else{this.imgNode.setAttribute("usemap","#"+Y);this.mapNode=this.domNode.appendChild(Q.firstChild);}}}var D=mstrmojo.GraphBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GraphBase",cssClassPrefix:"mstrmojo-GraphBase",markupString:'<div id="{@id}" class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><img {@att}src="../images/1ptrans.gif" class="{@cssClassPrefix} {@cssImageClass}"/>{@map}</div>',att:"",map:"",cAreaIdx:-1,useRichTooltip:true,markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},preBuildRendering:function K(){I.call(this);return this._super();},postBuildRendering:function A(){C.call(this);return this._super();},setModel:function P(Q){this.model=Q;},updatingTooltipHelper:function B(U,f,X){var R=U&&U.getAttribute("aid"),Q=U&&U.getAttribute("ttl"),T=U.getAttribute("SC"),W={refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,contentNodeCssClass:"gp-tooltip"},b=(this.model.zf||1)+"em";if(R==this.cAreaIdx){return ;}this.cAreaIdx=R;W.content=Q;var S="font-size:"+b+";";if(T){S+="border-color:#"+T;}W.contentNodeCssText=S;var Y=U.getAttribute("coords"),a=99999,Z=99999;if(!X){if(Y&&Y.length>0){Y=Y.split(",");var V=0;while(V+1<Y.length){a=Math.min(a,parseInt(Y[V++],10));Z=Math.min(Z,parseInt(Y[V++],10));}}}if(a===99999){a=f.x;}if(Z===99999){Z=f.y;}W.top=Z;W.left=a;this.richTooltip=null;this.set("richTooltip",W);},refresh:function G(){if(!this.hasRendered){return ;}C.call(this);var Q=this.getFormats();if(Q.height&&Q.width){this.refreshMap();}},refreshMap:function O(){I.call(this);},getAreaShapeName:function F(Q){return N[parseInt(Q,10)]||"default";}});var E=D.tooltipCLS="mstrmojo-mobileGraph-Tooltip-content",L=D.canvasCLS="mobile-graph-highlight-canvas";D.hideTooltips=function(){H.forEach(document.getElementsByClassName(E),function(Q){Q.style.display="none";});H.forEach(document.getElementsByClassName(L),function(Q){Q.getContext("2d").clearRect(0,0,Q.width,Q.height);Q.width=Q.width;});};}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayout");function F(P){var N=-1,O=P.children,M,L,K,I,J=[],H=function(){var R;for(R in J){var Q=J[R];if(Q._fixedHeight!==N){Q._fixedHeight=N;if(Q.domNode){Q.domNode.style.height=N+"px";}}}N=-1;J=[];};for(L in O){M=O[L];if(M.node.data.bh&&N>-1){H();}if(M.defn.horiz){for(K in M.children){I=M.children[K];N=Math.max(I._fixedHeight||0,N);J[J.length]=I;}}}H();}mstrmojo.DocLayoutHoriz=mstrmojo.declare(mstrmojo.DocLayout,null,{scriptClass:"mstrmojo.DocLayoutHoriz",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},getWidth:function A(){return this.containerNode.offsetWidth;},getHeight:function G(){return this.containerNode.offsetHeight;},_renderSection:function C(L,I){if(L.node.data.bh){var M=document.createElement("div");M.className="mstrmojo-DocLayout-HBox";var J=document.createElement("table");J.className="mstrmojo-DocLayout-HBox-HorizContainerTable";this._hRow=J.insertRow(-1);M.appendChild(J);this.containerNode.appendChild(M);}if(L.defn.horiz){var H="hi"+I;L.slot=H;var N=this._hRow.insertCell(-1);N.vAlign="top";var K={};K[H]=N;this.addSlots(K);}this._super(L,I);},getLayoutMinWidth:function B(){var I=0,Q=0,J=this.children,P=J.length,N,M;for(N=0;N<P;N++){var O=J[N],L=O&&O.node,H=L&&L.data,K=H&&(String(H.bh)==="true"||String(H.bv)==="true");if(K){I=Math.max(I,Q);Q=0;}if(O.children){for(M in O.children){Q+=O.children[M].width();}}else{Q+=10;break;}}return Math.max(I,Q);},resizeOrReposition:function E(){if(this._super){this._super();}F(this);},renderCtrlsInViewport:function D(){this._super();F(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.DocTextfield");var I=mstrmojo.dom,K=mstrmojo.css,L=1,Q=2,A=3,N=4,P=5,E=6,B=1,D=["","CaptionOnly","IconOnly","IconLeft","IconRight","IconTop","Custom"];var M=[];M[L]=M[Q]=M[E]={minsp:0,mincs:0};M[A]=M[N]={minsp:10,mincs:5};M[P]={minsp:4,mincs:5};function F(V,S,X,R,T){var Y=I.position(V),U=I.position(V.parentElement),W=V.style;R=R||{};R={t:R.t||0,r:R.r||0,b:R.b||0,l:R.l||0};R.h=U.h-R.t-R.b;R.w=U.w-R.l-R.r;if(T){if(Y.h>R.h){W.height=R.h+"px";}if(Y.w>R.w){W.width=R.w+"px";}Y=I.position(V);}if(S){W.top=((R.h-Y.h)/2+R.t)+"px";}if(X){W.left=((R.w-Y.w)/2+R.l)+"px";}}function J(U,V,T){var S=document.createElement("img"),R=S.style;U.appendChild(S);I.attachEvent(S,"load",function(){var W=R.display;R.display="block";F(S,true,true);R.display=W;},true);S.className=T;S.src=V;}mstrmojo.DocButton=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocButton",pressed:false,markupString:'<div id="{@id}" class="mstrmojo-DocButton {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocButton-Container" mstrAttach:click,mousedown><div class="mstrmojo-DocButton-IconNode"></div><div class="mstrmojo-DocButton-ValueNode" style="{@valueNodeCssText}">{@v}</div></div><div class="mstrmojo-DocButton-EffectOverlay"></div>{@buttonNodeMarkup}</div>',markupSlots:{iconNode:function(){return this.domNode.firstChild.firstChild;},valueNode:function(){return this.domNode.firstChild.lastChild;},buttonContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{onpressedChange:function(){var R=!!this.pressed,U=this.defn,T=this.domNode,S=this.fmts;K.toggleClass(T,"pressed",R);this.setBackgroundColor();this.valueNode.style.color=R?U.fhlc:(S.color||"");},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["T","z-index","D","B","P","background-color"],valueNode:["font","fx","color","white-space","overflow"]},setBackgroundColor:function H(){this.domNode.style.backgroundColor=(!!this.pressed)?this.defn.bhlc:(this.fmts["background-color"]||"");},getAnchor:function O(){return this.domNode;},getDPI:function C(){return this.model.dpi;},buildRendering:function G(){this._super();var S=this.defn,l=this.domNode,V=this.buttonContainerNode,k=this.iconNode,p=this.valueNode,g=parseInt((S&&S.dpst)||1,10),i="px";K.toggleClass(l,D[g],true);l.onselectstart=l.ondragstart=function(){return false;};var b=this.getFormats(),X=parseInt(K.getComputedStyle(V).borderWidth,10)*2;if(isNaN(X)){X=0;}var Z=parseFloat(b.width)-X,n=parseFloat(b.height)-X,W=M[g],a=W.minsp,s=W.mincs,f,Y=k.style,j=p.style;function U(h){Y.height=Y.width=h+i;}var q=V.style;q.height=n+i;q.width=Z+i;switch(g){case P:var T=this.getDPI(),R=n+K.getBorderWidths(b["border-width"],T).h+K.getPaddings(b.padding,T).h;f=Math.max(0,Math.min(Z,n-a-s,R*0.6));U(f);F(k,false,true);F(p,true,false,{t:f+a},true);break;case A:case N:f=Math.max(0,Math.min(n,Z-a-s));U(f);F(k,true,false);j[(g===A)?"left":"right"]=(f+a)+i;F(p,true,false);break;case L:F(p,true,false);break;case Q:case E:break;}if(B===parseInt(S.fe,10)){K.addClass(l,"gloss");}J(k,S.nmurl,"normal");J(k,S.hlurl||S.nmurl,"hilight");var o=document.createElement("div");K.addClass(o,"mstrmojo-DocButton-IconMaskNode");k.appendChild(o);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.StackContainer");mstrmojo.TabContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.TabContainer",markupString:'<div id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><div class="mstrmojo-tabcontainer-tabs"></div><div class="mstrmojo-tabcontainer-stack"></div><div></div></div>',markupMethods:{onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{top:function(){return this.domNode.childNodes[0];},stack:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1];},bottom:function(){return this.domNode.childNodes[2];}},addChildren:function A(D,K,H){var G=this._super(D,K,H);var B=this.children,F=B.length;if(F>=2){var L,I,E;for(E=0;E<F;E++){var C=B[E],J=C&&C.slot;if(!L&&C.isStrip){L=C;}else{if(!I&&(!J||J==="stack")){I=C;}}if(L&&I){L.set("target",I);break;}}}return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo._HasBuilder","mstrmojo._IsAnchorable","mstrmojo.dom");var P="mstrmojo-DocInfoWindow-tip",O=1,G=mstrmojo.dom;function C(S,T){var R=G.findWidget(S)||(S&&S.w);while(R){if(R.autoCloseLocked!==undefined){R.autoCloseLocked=T;}R=R.parent;}}function H(S){var R=S.model;return R.getLayoutDataCache(R.getCurrentLayoutKey())[S.psId];}mstrmojo.DocInfoWindow=mstrmojo.declare(mstrmojo.Popup,[mstrmojo._HasBuilder,mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.DocInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div><div class="'+P+' top"></div><div class="mstrmojo-DocInfoWindow-curtain" mstrAttach:click></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.firstChild;}},boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:P,anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,closeOnClick:true,autoCloseLocked:false,tipNodeColor:"",ontouchstart:function J(){this.close();},close:function N(){if(this.autoCloseLocked){return ;}this.model.raiseEvent({name:"infoWindowClosed",psKey:this.psKey});var R=this;window.setTimeout(function(){if(R.anchor){C(R.anchor,false);}},0);if(this._super){this._super();}this.clearAnchorHilites();G.detachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",this.mw);G.attachEvent(document,"scroll",R.mw);},clearAnchorHilites:function B(){var R=mstrmojo.dom.findWidget(this.anchor);if(R&&R.clearHilites){R.clearHilites(R.hiliteKey);delete R.hiliteKey;}},prepareAnchor:function M(){if(this.children&&this.children[0]){var S=this.infoNode.style,T=this.children[0],U=T.dimNode||T.domNode,V=U.offsetWidth,R=U.offsetHeight;S.width=(V+2*O)+"px";S.height=(R+2*O)+"px";}},nudge:function E(){this.positionDialog();this.model.raiseEvent({name:"infoWindowRendered",id:this.id});},onRender:function Q(){this.open(this.opener);},open:function F(X,T){var R=mstrmojo.all[this.psId];if(R){var U=R.defn.sfp,Z=R.selectedIdx;if(U&&Z!==0){R.switchToPanel(0,0);R.children[Z].set("selected",false);}}if(this._super){this._super(X,T);}if(this.anchor){C(this.anchor,true);}if(mstrApp.isTablet&&mstrApp.isTablet()){var Y=mstrmojo.touchManager,S=this.id,W=this.domNode;this._tchHandler=Y.attachEventListener("touchesBegin",S,function(f){if(this.autoCloseLocked){return ;}var b=mstrmojo.dom.contains(W,f.touch.target,true);var h=document.getElementsByClassName("heatmap-infobox"),a=(h&&h.length)||0,g,k=f.touch.target,j=false;for(g=0;g<a;g++){if(mstrmojo.dom.contains(h[g],k,true)){j=true;break;}}if(!b&&!mstrApp.hasOpenDialog()&&!j){this.closeOnTablet();}});}var V=this;V.mw=V.mw||function(a){if(V.autoCloses&&!G.contains(V.domNode,G.eventTarget(self,a),true,document.body)){V.close();}};G.attachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",V.mw);G.attachEvent(document,"scroll",V.mw);},getChildren:function I(){return[H(this)];},preBuildRendering:function K(){var T=H(this),S=T.defn.fmts;S.left=O+"px";S.top=O+"px";if(S.border){var R=S.border.split(" ");if(R.length>=3){this.tipNodeColor=R[2];}}if(this._super){this._super();}},postBuildRendering:function A(){this.set("visible",true);if(this._super){this._super();}if(!this.closeOnClick){this.curtainNode.style.display="none";}},closeOnTablet:function L(){this.close();if(this._tchHandler){this._tchHandler.clear();}}});var D=mstrmojo.DocInfoWindow;D.PLACEMENT={AUTO:1,FIXED:2,ABOVE:3,BELOW:4,LEFT:5,RIGHT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom");var F=mstrmojo.dom,H=mstrmojo.css,E=mstrmojo.Button.newIconButton,B="mstrmojo-oivmSprite ",G=0,K=1,L=2,J={0:"inline",1:"above",2:"below"};function C(M){var N=mstrmojo.boxmodel.offset(M,document.body);return{left:N.left,top:N.top,width:M.offsetWidth,height:M.offsetHeight};}mstrmojo.OIVMDICPopup=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.OIVMDICPopup",autoCloses:false,cssClass:"inline",markupString:'<div dic="1" id={@id} class="mstrmojo-OIVMDICPopup {@cssClass}" style="{@cssText}" mstrAttach:keyup><div class="toolbar"></div><div class="dataInputControl"></div><div class="boxtip"></div></div>',markupSlots:{toolbarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.children[1];},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";},ontopChange:function(){this.domNode.style.top=this.top||"";},onleftChange:function(){this.domNode.style.left=this.left||"";},oncssClassChange:function(){this.domNode.className="mstrmojo-OIVMDICPopup "+this.cssClass;}},setStyle:function(){var U=this.widget,b=U.dic,N=U.popupStyle,W=C(U.openerNode),V=this.domNode,Q=V.style,X=U.domNode.style,M=this.tipNode,O=b.wm?b.w:W.width,a=b.hm?b.h:W.height,T;this.set("cssClass",J[N]);if(N===G){for(T in W){Q[T]=W[T]+"px";}U.set("width",O-2);X.width=(O-8)+"px";X.height=(a>8)?(a-8)+"px":"auto";}else{if(N===K){var Z=O,R=W.left+W.width/2-21,Y=W.top,S=Y<76;Y=S?Y+W.height+15:Y-76;M.className=S?"boxtip up":"boxtip";Q.left=R+"px";Q.top=Y+"px";Q.width=U.domNode.scrollWidth+"px";Q.height="44px";Z=Z>100?(Z+70):200;var P=document.body.offsetWidth-R-Z-parseInt(H.getStyleValue(V,"paddingLeft"),10)-parseInt(H.getStyleValue(V,"paddingRight"),10);P=P>0?0:P;Q.left=R+P+"px";M.style.left=15-P+"px";}else{if(N===L){Q.top=W.top+"px";Q.left=W.left+"px";Q.height=X.height;Q.width=X.width;}}}},onOpen:function D(){var M=this.widget,O=this.lastwidget;if(O!=M){if(O){this.removeChildren(O);}this.lastwidget=M;}if(M.hasRendered){M.unrender();}this.addChildren([M]);this.setStyle();var N=this;this.md=this.md||function(Q){var R=F.eventTarget(self,Q),P=F.findAncestorByAttr(R,"dic",true);if(!P){N.onBlur();F.preventDefault(self,Q);}};this.mw=this.mw||function(P){N.onBlur();};F.attachEvent(document,"mousedown",this.md);F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",this.mw);},onBlur:function(){if(this.widget.popupStyle===G){this.onApply();}else{this.onCancel();}},onClose:function(){F.detachEvent(document,"mousedown",this.md);F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",this.mw);this.toolbar.apply.set("enabled",false);this.set("hasInvalidData",false);if(this.widget&&this.widget.hasRendered){this.widget.lockPopup();}},onApply:function(){if(this.widget.applyChanges()!==false){this.close();}},onCancel:function(){if(this.widget&&this.widget.hasRendered){this.widget.cancelChanges();}this.close();},onkeyup:function A(N){var M=N.hWin,O=N.e||M.event;if(this.widget.applyOnEnter&&O.keyCode===13){this.onApply();}else{if(O.keyCode===27){this.onCancel();}}},enableApply:function(){this.toolbar.apply.set("enabled",true);},preBuildRendering:function I(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}if(this._super){return this._super();}else{return true;}},onhasInvalidDataChange:function(){var M=this.invalidCurtain;if(!M){M=this.invalidCurtain=document.createElement("div");M.className="mstrmojo-fullscreen-curtain";document.body.appendChild(M);}M.style.display=this.hasInvalidData?"block":"none";},children:[{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"toolbar",children:[E(mstrmojo.desc(134,"Apply"),B+"tbApply greyed",function(){this.parent.parent.onApply();},null,{enabled:false,alias:"apply",onenabledChange:function(){H.toggleClass(this.domNode,"greyed",!this.enabled);}}),E(mstrmojo.desc(221,"Cancel"),B+"tbCancel",function(){this.parent.parent.onCancel();})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ExpressDocPanel=mstrmojo.declare(mstrmojo.DocPanel,null,{scriptClass:"mstrmojo.ExpressDocPanel",preBuildRendering:function A(){if(this.getFormats().overflow==="auto"){B.addWidgetCssClass(this,"scroll");}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ListBase","mstrmojo._IsList");var F=",";mstrmojo.TableLayoutList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.TableLayoutList",cssClass:"mstrmojo-TableLayoutList",styleCssClass:"",itemIdField:"v",allowUnlistedValues:false,tableLayoutCssStyle:"auto",multiSelect:false,titleItems:null,items:null,itemsPerRow:0,getLeftEndTitle:function E(G){return"";},getRightEndTitle:function D(G){return"";},getTitleRowMarkup:function A(){var K=this.titleItems;if(K){var H='<tr><td class="left_text">'+this.getLeftEndTitle(-1)+"</td>",G=K.length,J=0,I;for(;J<G;J++){I=K[J];H+='<td class="item_title" title="'+I+'">'+I+"</td>";}H+='<td class="left_text">'+this.getRightEndTitle(-1)+"</td></tr>";return H;}return"";},_markupPrefix:function(){return'<table class="tableLayoutList" style="table-layout:'+this.tableLayoutCssStyle+'" cellspacing="0" cellpadding="0"><tbody>'+this.getTitleRowMarkup();},_markupSuffix:function(){return"</tbody></table>";},getItemMarkup:function(K,H){var J='<{@tag} class="item {@cls}" idx="{@idx}" title="{@n}" style="{@style}">{@n}</{@tag}>',G=this.getLeftEndTitle(H),I=this.getRightEndTitle(H),L=this.itemsPerRow;G='<td class="left_text" title="'+G+'">'+G+"</id>",I='<td class="right_text" title="'+I+'">'+I+"</id>",L=this.itemsPerRow;if(L>0){J=(H%L===0?"<tr>"+G:"")+"<td>"+J+"</td>"+((H+1)%L===0?I+"</tr>":"");}else{J='<td><div class="item_wrapper" idx="'+H+'">'+J+"</div></td>";if(!H){J="<tr>"+G+J;}else{if(H===this.items.length-1){J=J+I+"</tr>";}}}return J;},_getItemNode:function(G){var H=this.itemsNode,J=this.itemsPerRow,I=(this.titleItems?1:0)+((J>0)?parseInt(G/J,10):0),K=1+((J>0)?(G%J):G);return H.rows[I].cells[K].firstChild;},init:function(G){this._super(G);mstrmojo.css.addWidgetCssClass(this,this.styleCssClass);},onchange:function B(){var I,H=[];if(!this.multiSelect){I=this.selectedItem.v;}else{for(var G in this.selectedIndices){H.push(this.items[G].v);}I=H.join(this.delim||F);}this.set("value",I);},postBuildRendering:function C(){this._super();var G=[];if(this.multiSelect){var I=this.value.split(F);for(var H=0;H<I.length;H++){G.push({v:I[H]});}}else{G.push({v:this.value});}this.setSelectedItems(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var H=mstrmojo.func.composite,F=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(O){if(O){return ;}var M=this.visible,N=M?"block":"none";this.editorNode.style.display=N;if(this.modal){this.curtainNode.style.display=N;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function I(){var M;var N=this.buttons;if(N&&!this.btnHbox){for(M in N){N[M].cssClass="mstrmojo-Editor-button";}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:N},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function D(){var M=this.placeholder;if(this._super()){if(!this.parent&&!M){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function G(){var M=this.id;return function(){var N=mstrmojo.all[M];N.resizeDialog();N.positionDialog();};},postBuildRendering:function B(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var M=this._resizeHandler=this.getResizeHandler();F.attachEvent(window,"resize",M);}this.resizeDialog();this.positionDialog();this.domNode.focus();return true;},resizeDialog:function J(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function E(){var N=this,R=N.curtainNode,M=document.body,P=document.documentElement,Q=R.style,O=N.curtainPosition;Q.width=Math.max(M.clientWidth,P.scrollWidth)+"px";if(O&&O.h){Q.height=O.h+"px";}else{Q.height=Math.max(M.clientHeight,P.scrollHeight)+"px";}if(O&&O.y){Q.top=O.y+"px";}N.raiseEvent({name:"resizeCurtain"});},positionDialog:function K(){if(!this.left||!this.top){var M=this.editorNode;F.center(M);if(this.alignment==="top"){M.style.top="10px";}}},destroy:function(N){var M=this._resizeHandler;if(M){F.detachEvent(window,"resize",M);}this._super(N);}});if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.confirm=function A(P,N,O){var Q="mojoConfirmx9",M=function(){mstrmojo.all[Q].destroy();};mstrmojo.array.forEach(N,function(R){var S=R.onclick;R.onclick=S?H([M,S]):M;});mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:N,children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.alert=function C(P,M,O){var Q="mojoAlertx9";try{mstrmojo.all[Q].destroy();}catch(N){}mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),function(){mstrmojo.all.mojoAlertx9.destroy();if(M){M();}},"#666666")],children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.toast=function L(Q,O){var R="mojoToast9",P,N=O||3000;try{mstrmojo.all[R].destroy();}catch(M){}mstrmojo.insert({id:R,scriptClass:"mstrmojo.Label",cssClass:"toastCss",text:Q}).render();P=mstrmojo.all[R].domNode;document.body.appendChild(P);F.bottomCenter(P);window.setTimeout(function(){mstrmojo.all[R].destroy();},N);};mstrmojo.mask={};mstrmojo.mask.show=function(){mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});mstrmojo.mask.win.render();document.body.appendChild(mstrmojo.mask.win.domNode);};mstrmojo.mask.hide=function(){mstrmojo.mask.win.destroy();};}}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.HBox","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren");var F={postBuildRendering:function C(){return(this.renderMode!="scroll")?this._super():true;},childRenderOnAddCheck:function(G){return(this.renderMode!="scroll")?this._super(G):false;},preserveChildDomOrder:false};function B(H){if(!H.hasRendered){return ;}var I=H.children||[];for(var G=I.length-1;G>=0;G--){I[G].refresh&&I[G].refresh();}}mstrmojo.DocSection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSection",markupString:'<div id="{@id}" class="mstrmojo-DocSection"></div>',markupSlots:{containerNode:function(){return this.domNode;}},width:function E(G){return this._super(1);},refresh:function D(){B(this);}});mstrmojo.DocSectionHoriz=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSectionHoriz",height:function A(G){return this._super(1);},refresh:function D(){B(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.date","mstrmojo.dom","mstrmojo.HBox","mstrmojo.VBox");var Q=mstrmojo.date,J=mstrmojo.dom,L=mstrmojo.boxmodel,F=function(){return mstrmojo.locales.datetime;},D=Math.PI/6,O=1,P=2,M=3,A=F().AM_NAME,N=F().PM_NAME;function E(S,R){if(S===0){return"00";}else{if(S<10){return R?S.toString():"0"+S;}else{return S.toString();}}}function H(U){if(!U){return null;}var S=Q.parseTime(U),T=/.*\ [a|p]m/i.test(U);if(!S){var R=Q.parseDateAndOrTime(U);S=R&&R.time;if(!S){return null;}}if(T){S.h12=/.*\ am/i.test(U)?A:N;}return S;}function C(h,T){var f=this,S=L.offset(T,document.body),Y=(f._hh%12)*(Math.PI/6)+(Math.PI/360)*f._mm,Z=(Math.PI/30)*f._mm,a=0,b=0,W=S.left+80,V=S.top+80,U=0,X=0,R=function(n,k,i,q){var o=0,p=0,l=i-n,j=k-q;if(j===0){if(l>=0){p=Math.PI/2;}else{p=3*Math.PI/2;}}else{if(l===0){if(j>=0){p=0;}else{p=Math.PI/2;}}else{o=l/j;if(o>0&&l>0){p=Math.atan(o);}else{if(o>0&&l<0){p=Math.PI+Math.atan(o);}else{if(o<0&&l>0){p=Math.PI+Math.atan(o);}else{p=2*Math.PI+Math.atan(o);}}}}}return p;},g=function(j){var k=R(W,V,j.pageX,j.pageY),i;if(X===O){i=f._hh;f._hh=Math.floor(k*6/Math.PI);if(f._hh===0){if(i===23){f._hh=0;}else{if(i===11||i===12){f._hh=12;}else{if(i>12){f._hh+=12;}}}}else{if(f._hh===11){if(i===0){f._hh=23;}else{if(i===13||i===12){f._hh=11;}else{if(i>12){f._hh+=12;}}}}else{if(i>=12){f._hh+=12;}}}f._updateValue();}else{i=f._mm;f._mm=Math.floor(k*30/Math.PI);if(f._mm<15&&i>45){if(f._hh===23){f._hh=-1;}f._hh+=1;}else{if(f._mm>45&&i<15){if(f._hh===0){f._hh=24;}f._hh-=1;}}f._updateValue();}};U=R(W,V,h.pageX,h.pageY);a=Math.abs(Y-U);a=Math.min(a,2*Math.PI-a);b=Math.abs(Z-U);b=Math.min(b,2*Math.PI-b);if(a<D||b<D){if(b<a){X=P;f.active=P;}else{X=O;f.active=O;}J.attachEvent(T,"mousemove",g);J.attachEvent(T,"mouseup",function(i){J.detachEvent(T,"mousemove",g);});}}function G(V,S){var R=S.getContext("2d"),U=V.hour,T=V.min;R.save();R.clearRect(0,0,160,160);if(V.h12){R.save();R.fillStyle=U<12?"rgba(191, 223, 255, 1)":"rgba(246, 200, 126, .5)";R.fillRect(68,100,26,14);R.font="bold 14px sans-serif";R.fillStyle="black";R.fillText(U<12?"AM":"PM",70,112);R.restore();}R.translate(80,80);R.scale(0.3,0.3);R.rotate(-Math.PI/2);R.fillStyle="rgb(90, 158, 198)";R.save();R.rotate(U*(Math.PI/6)+(Math.PI/360)*T);R.lineWidth=12;R.beginPath();R.moveTo(-28,0);R.lineTo(105,0);R.stroke();R.restore();R.save();R.rotate((Math.PI/30)*T);R.lineWidth=10;R.beginPath();R.moveTo(-35,0);R.lineTo(162,0);R.stroke();R.restore();R.restore();}function I(T,S){var V=L.offset(S,document.body),R=V.left,U=V.top;if(T.pageX<R+68||T.pageX>R+94||T.pageY<U+100||T.pageY>U+114){return false;}return true;}mstrmojo.TimePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TimePicker",markupString:'<div class="mstrmojo-TimePicker {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-Clock-time"><canvas width="157" height="157"></canvas></div></div>',cssText:"width:158px; height:"+(J.isIE?28:180)+"px",markupSlots:{hbNode:function(){return this.domNode.firstChild;},canvasNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onintervalChange:function(){this.interval=parseInt(this.interval,10);},onvalueChange:function(){if(this.domNode){var R,T;R=H(this.value);if(!R){var U=new Date(),S=Q.getDateJson(U);this.set("value",Q.formatTimeInfo(S,F().TIMEINPUTFORMATS[0]));return ;}this._hh=R.hour;this._mm=R.min;T=this.ctn.hb&&this.ctn.hb.tf;if(R.h12){T.set("visible",true);this.set("_tf",R.h12);this.set("_HH",E(R.hour>12?R.hour-12:(R.hour===0?12:R.hour),true));}else{T.set("visible",false);this.set("_HH",E(R.hour,true));}this.set("_MM",E(R.min));if(!J.isIE){G(R,this.canvasNode.firstChild);}}}},active:P,value:null,_hh:null,_HH:null,_mm:null,_MM:null,_tf:null,interval:5,children:[{scriptClass:"mstrmojo.HBox",alias:"ctn",slot:"hbNode",children:[{scriptClass:"mstrmojo.HBox",alias:"hb",cssText:"border: 1px solid #CECBCE;margin-left: 5px;background-color:#FFFFCC;",children:[{scriptClass:"mstrmojo.TextBox",alias:"hh",cssText:"width:15px;border:none;text-align:right;",bindings:{value:"this.parent.parent.parent._HH"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=O;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=23){this.parent.parent.parent.updateHours(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>23){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.Label",cssText:"width:5px;",text:":"},{scriptClass:"mstrmojo.TextBox",alias:"mm",cssText:"width:16px;border:none;",bindings:{value:"this.parent.parent.parent._MM"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=P;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=60){this.parent.parent.parent.updateMinutes(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>60){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.TextBox",cssText:"width:24px;padding-right:2px;border:none;",alias:"tf",visible:false,onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=M;},onkeyup:function(){var R=this.value&&this.value.toUpperCase(),S=this.parent.parent.parent;if((R===F().AM_NAME||R===F().PM_NAME)&&(R!==this.ov)){S._hh+=S._hh<12?12:-12;this.value=this.ov=R;S._updateValue();}},onblur:function(){var R=this.value&&this.value.toUpperCase();if(R!==F().AM_NAME&&R!==F().PM_NAME){this.set("value",this.ov);}},value:"AM",bindings:{value:"this.parent.parent.parent._tf"}}]},{scriptClass:"mstrmojo.VBox",alias:"stepper",slot:"stepperNode",cssText:"padding-left: 2px; padding-top: 0px;",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8314,"Increase"),cssClass:"stepper up",text:"",onclick:function(){this.parent.parent.parent.incr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.incr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8315,"Decrease"),cssClass:"stepper down",text:"",onclick:function(){this.parent.parent.parent.decr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.decr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}}]}]}],init:function(R){if(this._super){this._super(R);}this._hh=0;this._HH="";this._mm=0;this._MM="";},focus:function B(){var R=this.ctn,S=R&&R.hb;if(!S||!this.visible){return ;}if(this.active===O){S.hh.focus();}else{if(this.active===M){S.tf.focus();}else{S.mm.focus();}}},postBuildRendering:function K(){var S=this.canvasNode.firstChild,R=this;if(this._super){this._super();}if(!this.value){this.value="12:00 AM";}if(J.isIE){this.canvasNode.style.display="none";}else{G({hour:this._hh,min:this._mm},S);S.onmousedown=function(T){C.call(R,T,S);};S.onclick=function(T){if(!I(T,S)){return ;}R.active=M;R._hh+=R._hh<12?12:-12;R._updateValue();};}},_updateValue:function(){var R;if(this._tf){R=F().TIMEINPUTFORMATS[0];}else{R=F().TIMEINPUTFORMATS[1];}this.set("value",Q.formatTimeInfo({hour:this._hh,min:this._mm},R));},incr:function(){var R;if(this.active===O){R=this._hh;if(R===23){R=-1;}this._hh=R+1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)+this.interval;if(R>=60){if(this._hh===23){this._hh=-1;}this._hh+=1;R=R-60;}this._mm=R;}}this._updateValue();},decr:function(){var R;if(this.active===O){R=this._hh;R=(R===0)?24:R;this._hh=R-1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)-this.interval;if(R<0){if(this._hh===0){this._hh=24;}this._hh-=1;R+=60;}this._mm=R;}}this._updateValue();},updateHours:function(S){var R=parseInt(S,10);if(this._tf){if(this._hh>=12&&R<12){this._hh=R+12;}else{this._hh=R;}}else{this._hh=R;}this._updateValue();},updateMinutes:function(R){this._mm=parseInt(R,10);this._updateValue();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.PickerButton=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.PickerButton",cssClass:"mstrmojo-PickerButton",cellCssClass:"mstrmojo-PickerButton-cell",enabled:true,postCreate:function(){var A=function(B){mstrmojo.css.removeClass(B.domNode,B.selectedItemCssClass);mstrmojo.css.addClass(B.domNode,B.selectedItemCssClass=((B.parent.items&&B.parent.items[B.parent.selectedIndex])?"tb"+B.parent.items[B.parent.selectedIndex][B.parent.itemDisplayField]:""));};this.children=[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",selectedItemCssClass:"",bindings:{title:"this.parent.title",iconClass:"this.parent.iconClass",selectedIndex:"this.parent.selectedIndex",enabled:"this.parent.enabled"},onclick:function(){this.parent.onchange();},onselectedIndexChange:function(){A(this);},onRender:function(){A(this);}},{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-PickerButton-DropDownButton",bindings:{enabled:"this.parent.enabled"},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Menu",shadowNodeCssClass:"mstrmojo-Menu-shadow",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.ListBox",itemCssClass:"mstrmojo-ListBox-item mstrmojo-InteractiveText",bindings:{itemDisplayField:"this.parent.opener.parent.itemDisplayField",itemIdField:"this.parent.opener.parent.itemIdField",items:"this.parent.opener.parent.items"},onchange:function(){if(this._closing){return ;}var C=this.selectedIndex,B=this.parent.opener;if((C>-1)&&B){this._closing=true;B.closePopup();B.parent.selectedItem=this.selectedItem;B.parent.set("selectedIndex",C);B.parent.onchange();this._closing=false;}}}]}}];}});})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.num","mstrmojo.HBox","mstrmojo.Container");var E=mstrmojo.expr.DTP,P="mstrmojo.Button",G=mstrmojo.num,N=mstrmojo.validation.TRIGGER,D=50,B=500,L=10;function F(Q){var R=this;this._holdTimer=setInterval(function(){R.onclick(Q);},D);}function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}}function K(Q){var R=this;if(!this._holdTimer&&!this._startHoldTimer){this._startHoldTimer=setTimeout(function(){delete R._startHoldTimer;F.call(R,Q);},B);}}function A(){if(this._startHoldTimer){clearTimeout(this._startHoldTimer);delete this._startHoldTimer;}H.call(this);}function M(Q){A.call(this);}function C(Q){return Q?parseFloat(Q.toFixed(L)):Q;}function I(T){var Q=T.max,S=T.min,R=T.itv;return{scriptClass:"mstrmojo.HBox",alias:"hBox",children:[{scriptClass:P,alias:"minus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var V=this.parent.parent.numericValue;if(V<=S){A.call(this);return false;}return true;}},onclick:function(V){var X=this.parent.parent,W=X.numericValue;if(!isNaN(W)){if(Q!==undefined&&W-R>Q){X.set("numericValue",Q);}else{if(S===undefined||W-R>=S){X.set("numericValue",C(W-R));}else{if(W>S&&W-R<S){X.set("numericValue",S);}}}}},onmouseup:M,onmousedown:K,text:"-"},{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-DataInputControl",dtp:E.DOUBLE,required:true,alias:"textInput",constraints:{trigger:N.ONKEYUP|N.ONBLUR,max:Q,min:S},bindings:{value:"this.parent.parent.numericValue"},onValid:function(){this.parent.parent.set("numericValue",parseFloat(this.value));},onblur:function U(V){var X=this,W=this.parent.parent,Y=G.parseNumeric(this.value);if(!W.active&&!isNaN(Y)&&Y>=S&&Y<=Q){W.set("value",G.toLocaleString(W.numericValue));}if(this._super){this._super(V);}}},{scriptClass:P,alias:"plus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var V=this.parent.parent.numericValue;if(V>=Q){A.call(this);return false;}return true;}},onclick:function(V){var X=this.parent.parent,W=X.numericValue;if(!isNaN(W)){if(S!==undefined&&W+R<S){X.set("numericValue",S);}else{if(Q===undefined||W+R<=Q){X.set("numericValue",C(W+R));}else{if(W<Q&&W+R>Q){X.set("numericValue",Q);}}}}},onmouseup:M,onmousedown:K,text:"+"}]};}mstrmojo.StepperDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.StepperDIC",cssClass:"mstrmojo-StepperDIC",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" mstrAttach:mouseup,mousedown></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},init:function O(R){if(this._super){this._super(R);}var Q=parseFloat(this.value);this.set("numericValue",isNaN(Q)?(this.dic.min||0):Q);this.set("children",I(this.dic));this.textInput=this.hBox&&this.hBox.textInput;this.plus=this.hBox&&this.hBox.plus;this.minus=this.hBox&&this.hBox.minus;},onmousedown:function(Q){this.active=true;},onmouseup:function(Q){this.active=false;this.textInput&&this.textInput.domNode.focus();},unrender:function J(Q){this.plus&&A.call(this.plus);this.minus&&A.call(this.minus);this._super(Q);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox");mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur ></textarea>',maxLength:256,markupSlots:{inputNode:function(){return this.domNode;}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncssClassChange=function(){this.domNode.className="mstrmojo-TextArea "+(this.cssClass||"");};},onkeydown:function(D){var C=(this.value&&this.value.length)||0;if(this.maxLength<=C){this.isDeleteKeys=D.e.keyCode===8||D.e.keyCode===46;this.isArrowKeys=D.e.keyCode===37||D.e.keyCode===38||D.e.keyCode===39||D.e.keyCode===40;var B=(this.domNode.selectionEnd!==undefined)?(this.domNode.selectionEnd-this.domNode.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!B){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var A=this.domNode;A.blur();window.setTimeout(function(){A.focus();},1);}mstrmojo.dom.preventDefault(window,D.e);return false;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate");var A=mstrmojo.css,D=mstrmojo.validation,H=D.TRIGGER,G=D.STATUSCODE,E=mstrmojo.TextBox.prototype.markupMethods;mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,markupMethods:{onvisibleChange:E.onvisibleChange,onvalueChange:E.onvalueChange,onenabledChange:E.onenabledChange,onreadOnlyChange:E.onreadOnlyChange,ontooltipChange:E.ontooltipChange,onvalidationStatusChange:function(){var M=this.validationStatus;if(!M){return ;}var L=this.inputNode,J=(M.code>G.VALID),K=this.constraints.invalidCssClass;A.toggleClass(L,K?K:["mstrmojo-TextBox-ErrValidation"],J);if(J){L.setAttribute("title",M.msg);}else{if(this._original_tooltip!==undefined&&this._original_tooltip!==null){L.setAttribute("title",this._original_tooltip);}}}},postBuildRendering:function I(){if(this._super){this._super();}this._original_tooltip=this.inputNode.title;},prekeyup:function B(J){if(this._super){this._super(J);}var L=(this.constraints.trigger&H.ONKEYUP)>0;if(L){if(this.validationDelay>0){if(this._valDelayTimer){window.clearTimeout(this._valDelayTimer);}if(!this._validateHandler){var K=this;this._validateHandler=function(){K.validate();if(K._valDelayTimer){window.clearTimeout(K._valDelayTimer);delete K._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(this._validateHandler,this.validationDelay);}else{this.validate();}}},preinput:function(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONKEYUP)>0;if(K){this.validate();}},preblur:function F(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONBLUR)>0;if(K){this.validate();}},clearValidation:function C(){if(this._super){this._super();}var K=this.inputNode,J=this.constraints.invalidCssClass;A.removeClass(K,J?J:["mstrmojo-TextBox-ErrValidation"]);K.title=this._original_tooltip;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._BindTargetChildren","mstrmojo.TabButton","mstrmojo.TabStripBase");var E=mstrmojo.array;function D(G,F){if(G.autoHide){G.set("visible",F);}}mstrmojo.TabStrip=mstrmojo.declare(mstrmojo.TabStripBase,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},autoHide:true,tabButtonClass:"TabButton",init:function C(F){if(F&&F.autoHide){F.visible=false;}this._super(F);},addTabButtons:function B(G,N){var J=this.targetProps||{},S=J.childTitle||"n",O=J.childColor||"tbc",R=this.tabButtonClass,K=[],Q=this.target,F=function(T){Q.set("selected",this.target);};mstrmojo.requiresCls("mstrmojo."+R);for(var L=0,M=(G&&G.length)||0;L<M;L++){var P=G[L],I=P[S];if(I){var H=mstrmojo.insert({scriptClass:"mstrmojo."+R,title:I,backgroundColor:P[O],target:P,onclick:F});K.push(H);}}if(K.length){D(this,K.length);this.addChildren(K,N);}this.selectionChange();},removeTabButton:function A(G){var F=mstrmojo.array.filter(this.children,function(H){return(H.target===G);},{max:1});if(F&&F[0]){D(this,F.length-1);this.removeChildren(F[0]);F[0].destroy();}},clearButtons:function(){this.removeChildren();}});})();(function(){mstrmojo.requiresCls("mstrmojo.List");var B=mstrmojo.dom,E=mstrmojo.array,C=mstrmojo.css,G=",";function F(){var K,I,J=this.items,L=[];for(K=0,I=J.length;K<I;K++){L.push(J[K].v);}this.set("value",L.join(G));}function H(){var I=this.itemsContainerNode;if(I){E.forEach(I.children,function(J){if(J&&J.firstChild){C.removeClass(J.firstChild,"selected");}});}}mstrmojo.RankDIC=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RankDIC",cssClass:"mstrmojo-RankDIC",draggable:true,dropZone:true,allowCopy:false,multiSelect:false,renderOnScroll:false,itemDisplayField:"n",itemIdField:"v",containerResizable:false,itemMarkupFunction:function(M,J,K){var I=J===0,O=J===K.items.length-1,L='<div class="moveup '+(!I?"":"disabled")+'" or="1" idx="'+J+'">&nbsp;</div>',N='<div class="movedown '+(!O?"":"disabled")+'" or="-1" idx="'+J+'">&nbsp;</div>';return'<div class="mstrmojo-RankOption'+(I?" first":(O?" last":""))+'"><div class="index" contentEditable="true" onfocus="return mstrmojo.all[\''+K.id+"'].selectText(this);\" onblur=\"return mstrmojo.all['"+K.id+"'].indexChanged(this, "+J+');" onkeyup="return mstrmojo.all[\''+K.id+"'].keyPressed(event, this, "+J+');">'+J+'</div><div class="text">'+M.n+"</div>"+N+L+"</div>";},allowDrop:function(K){var J=K&&K.src,I=J&&J.widget;return(I===this);},ondrop:function(L){var J=this.domNode.parentNode,K=J.style,I=false;if(!K.height){K.height=J.offsetHeight+"px";I=true;}this._super(L);H.call(this);F.call(this);if(I){K.height="";}},selectText:function D(K){var I=document.createRange();I.selectNodeContents(K);var J=window.getSelection();J.removeAllRanges();J.addRange(I);},indexChanged:function(M,J){var L=parseInt(M[M.innerText!==undefined?"innerText":"textContent"],10),K=parseInt(J,10),I=this.items.length;if(isNaN(L)){M[M.innerText!==undefined?"innerText":"textContent"]=J;return false;}L=Math.min(Math.max(0,L),I);if(L!==K){this.move([K],L);F.call(this);return true;}else{return true;}},keyPressed:function A(J,K,I){if(J.keyCode===mstrmojo.Enum_Keys.ESCAPE){K[K.innerText!==undefined?"innerText":"textContent"]=I;if(K.blur){K.blur();}}else{if(J.keyCode===mstrmojo.Enum_Keys.ENTER){this.indexChanged(K,I);}}return true;},onmouseup:function(L){var M=B.eventTarget(L.hWin,L.e),K=parseInt(M.getAttribute("or"),10),J=M&&parseInt(M.getAttribute("idx"),10),I=this.items.length;if(K===1&&J!==0){this.move([J],0);F.call(this);return true;}else{if(K===-1&&J!==(I-1)){this.move([J],I);F.call(this);return true;}else{mstrmojo.dom.preventDefault(window,L.e);return true;}}},init:function(I){this._super(I);this.items=this.getItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.array","mstrmojo.func");var H=2;var G=1,B=2;mstrmojo.DocVisModel=mstrmojo.declare(mstrmojo.DocXtabModel,null,{scriptClass:"mstrmojo.DocVisModel",getAction:function F(K){var I=K[0],J=I&&I.at;var L;if(J){if(J&H){L={h:"onVisSelector",a:this.getSelectAction(I)};}}if(!L){L=this.getActionObject(K);}return L;},getSelectAction:function D(N){var Q=N.scObjList,P=Q.length,J=null;if(P>1){J={multiSelect:true,type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,anchor:N.anchor,selectorObjects:[]};var I={};var M="";for(var L=0;L<P;L++){var R=Q[L];var S=R.sc.tks.split("\x1E");for(var K=0;K<S.length;K++){var O=S[K];if(!I[O]){I[O]=true;if(M.length>0){M=M+"\x1E"+O;}else{M=O;}}}}for(var L=0;L<P;L++){var R=Q[L];J.selectorObjects.push({ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid});}if(!J.tks){J.tks=M;}}else{if(P==1){var R=Q[0];J={type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid,anchor:N.anchor};}}return J;},getLinkAction:function E(J,I){var K=J.node,L=K&&K.titleInfo;return this.getLinkActionImpl(K,L,I);},getPCellParentNode:function A(J,I){return(I==G)?J._lp:J._tp;},getPTitle:function C(J,I){return J.titleInfo;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd");function W(a){var f=document.createElement("div"),b=f.style,Z=a.domNode;f.className="mstrmojo-DataGrid-avatar";b.height=Z.clientHeight+"px";Z.appendChild(f);a.avatar=f;return f;}function N(Z){var a=mstrmojo.dom.position(Z.domNode,true);return a.x;}function L(Z){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+Z+'"></div>';}function X(b){var a=b.getAttribute("rh"),Z=a&&parseInt(a,10);return Z;}function U(a,g,Z){var f=Z.src,h=f&&f.data,b=h&&h.resizingIdx;if(!(b&&b>0)){return g&&g.apply(a,[Z]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function E(f,b){var Z=f.colSizeArray;var a=[-Z[b-1]+f.minColWidth,(b==Z.length-1)?Z[b]-f.resizeHandleWidth-f.minColWidth:Z[b]-f.minColWidth];return a;},updateSize:function D(f,b,a){var Z=f.colSizeArray;Z[b-1]=Z[b-1]+a;Z[b]=Z[b]-a;},updateColumnWidth:function Q(f,a,g,b){var Z=f.colSizeArray;a[b-1].style.width=Z[b-1]+"px";g[b-1].style.width=Z[b-1]+"px";a[b].style.width=Z[b]+"px";g[b].style.width=Z[b]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function E(h,g){var j=h.minColWidth+h.resizeHandleWidth,Z=h.colSizeArray,b=0;for(var f=g;f<Z.length;++f){b+=Z[f]-j;}var a=[-Z[g-1]+j,b];return a;},updateSize:function D(f,k,a){var j=f.minColWidth+f.resizeHandleWidth,g=f.colSizeArray;g[k-1]=g[k-1]+a;var Z=[];for(var b=0;b<g.length-k;++b){Z[b]=k+b;}Z.sort(function(i,n){return g[i]-g[n];});for(var b=0;b<Z.length;++b){var l=a/(Z.length-b);var h=g[Z[b]];a-=(h>=l+j)?l:h-j;g[Z[b]]=(h>=l+j)?h-l:j;}},updateColumnWidth:function Q(g,a,h,f){var Z=g.colSizeArray;for(var b=f-1;b<Z.length;++b){a[b].style.width=Z[b]+"px";h[b].style.width=Z[b]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,postBuildRendering:function S(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function C(Z){var b=Z.src,f=b.node,a=X(f);if(a&&a>0){return{resizingIdx:a,startingX:b.pos.x,baseX:N(this)};}else{if(this._super){return this.dropZone&&this._super(Z);}}return null;},allowDrop:function I(Z){var b=Z.src,f=b&&b.data,a=f&&f.resizingIdx;if(a&&a>0){return true;}else{return this.dropZone;}},ondragenter:function O(Z){U(this,this._super,Z);},ondragover:function P(Z){U(this,this._super,Z);},ondragleave:function A(Z){U(this,this._super,Z);},ondrop:function T(Z){U(this,this._super,Z);},ondragstart:function V(g){var p=g.src,h=p&&p.data,o=h&&h.resizingIdx;if(o&&o>0){var k=this.avatar||W(this);this.ownAvatar=true;k.style.left=(h.startingX-h.baseX)+"px";k.style.display="block";document.body.style.cursor="col-resize";var l=this.colSizeArray;if(!l){var b=this.headerContainerNode,j=b&&b.getElementsByTagName("table")[0],n=j.rows[0].cells;l=[];for(var Z=0,f=n.length;Z<f;Z++){l.push(n[Z].offsetWidth);}this.colSizeArray=l;this._firstTimeResize=true;}h.resizingRange=this.resizeColumnBehavior.getRange(this,o);return true;}else{if(this._super){return this._super(g);}}},ondragmove:function M(b){var l=b.src,f=l&&l.data,j=f&&f.resizingIdx;if(j&&j>0){var k=b.tgt,g=this.avatar,i=f.resizingRange,h=k.pos.x-f.startingX,Z=Math.min(i[1],Math.max(h,i[0]));f.deltaX=Z;if(g){g.style.left=(f.startingX-f.baseX+Z)+"px";}}else{if(this._super){this._super(b);}}},ondragend:function J(g){var p=g.src,h=p&&p.data,n=h&&h.resizingIdx;if(n&&n>0){var Z=this.titleColGroup,o=Z&&Z.childNodes,k=this.dataColGroup,l=k&&k.childNodes,f=o.length,j=this.colSizeArray,a=h.deltaX;this.resizeColumnBehavior.updateSize(this,n,a);if(this._firstTimeResize){for(var b=0;b<f;b++){o[b].style.width=j[b]+"px";l[b].style.width=j[b]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,o,l,n);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(g);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function H(b){var h=document.createElement("colgroup"),Z=b.length,a;for(var g=0;g<Z;g++){var f=document.createElement("col");a=b[g];if(a.colWidth){f.style.width=a.colWidth+"px";}f.className=a.colCss||("col"+g);h.appendChild(f);}return h;}function G(a){var b=a._headerWidgets_,Z=b&&b.length;if(Z>0){for(var f=0;f<Z;f++){b[f].destroy(true);}}}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},itemFunction:function(b,Z,a){var f=new mstrmojo.DataRow({columns:a.columns,data:b,idx:Z,dataGrid:a});return f;},preBuildRendering:function B(){var f=this.columns,Z=f.length,g=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],b,a;this._headerWidgets=[];for(var h=0;h<Z;h++){b=f[h];a=b.headerWidget;g.push("<td>");if(h>0&&this.resizableColumns){g.push(L(h));}g.push('<div class="mstrmojo-DataGrid-headerText');g.push(b.headerCss?" "+b.headerCss:"");if(a){this._headerWidgets.push(mstrmojo.hash.copy(a));g.push('" w="1">');}else{g.push('">');}g.push(b.headerText?b.headerText:"&nbsp");g.push("</div>");g.push("</td>");}g.push("</tr></table>");this.headerHtml=g.join("");if(this._super){this._super();}},postBuildRendering:function S(){if(this._super){this._super();}var f=this._headerWidgets,j=f.length;if(j>0){this._headerWidgets_=[];var k=this.headerContainerNode.getElementsByTagName("div"),b=mstrmojo.array.filter(k,function(i){return i.getAttribute("w")=="1";}),o;for(var g=0;g<j;g++){f[g].placeholder=b[g].firstChild;f[g].dataGrid=this;o=mstrmojo.registry.ref(f[g]);o.render();this._headerWidgets_.push(o);}}var Z=H(this.columns),n=Z.cloneNode(true),h=this.headerContainerNode,l=h&&h.getElementsByTagName("table")[0],p=this.itemsContainerNode,a=p&&p.getElementsByTagName("table")[0];this.titleColGroup=Z;this.dataColGroup=n;if(l&&a){l.insertBefore(Z,l.firstChild);a.insertBefore(n,a.firstChild);}},refresh:function F(Z){G(this);if(this._super){this._super(Z);}},destroy:function Y(Z){G(this);this._super();},unrender:function R(g){var b=this._headerWidgets_,a=b&&b.length,Z;if(a>0){for(var f=0;f<a;f++){Z=b[f];if(Z&&Z.hasRendered){Z.unrender(true);}}}this._super(g);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var h=document.createElement("tr"),n=this.data,q=this.idx,a=this.dataGrid,j=this.cssClass,t=this.columns,Z=this.children,b,o=-1,s,p;h.setAttribute("id",this.id);if(a.banding){j+=(q%2==1)?" odd":" even";}h.className=j+(mstrmojo.string.isEmpty(n[a.itemDisplayField||"n"])?" empty-row":"");for(var g=0,l=t.length;g<l;g++){s=t[g];p=(s.dataWidgetBuilder&&s.dataWidgetBuilder(n))||s.dataWidget;b=document.createElement("td");h.appendChild(b);if(p){b.setAttribute("w","1");o++;Z.push(mstrmojo.hash.copy(p,{slot:"slot"+o,data:n,idx:q,dataGrid:a}));}else{if(s.dataFunction){b.innerHTML=s.dataFunction(n,q,a);}else{var f=mstrmojo.string.htmlAngles(n[s.dataField||"n"])||"&nbsp",k=s.tooltip?' title="'+f+'"':"";b.innerHTML='<div class="mstrmojo-DataRow-text" '+k+">"+f+"</div>";}}}this.initChildren();return h;},buildRendering:function K(){this._super();var g=this.domNode.childNodes,Z=g.length,f={},b=0,h;for(var a=0;a<Z;a++){h=g[a];if(h.getAttribute("w")=="1"){f["slot"+b]=h;b++;}}this.addSlots(f);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var A=mstrmojo.dom,B={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(B[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=A.eventTarget(D.hWin,D.e);if(F==this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.Container","mstrmojo.TabStrip");mstrmojo.ScrollingTabStrip=mstrmojo.declare(mstrmojo.TabStrip,null,{scriptClass:"mstrmojo.ScrollingTabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip mstrmojo-ScrollingTabStrip {@cssClass}" style="{@cssText}"><span></span><div class="c" style="position:relative; display:inline-block;"><div style="position:absolute;"></div></div><span></span></div>',markupSlots:{containerNode:function(){return this.domNode.childNodes[1].firstChild;},scrollNode:function(){return this.domNode.childNodes[1];},stripNode:function(){return this.domNode.childNodes[1].firstChild;},btnLeftNode:function(){return this.domNode.childNodes[0];},btnRightNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible){this.set("width",parseInt(this.width,10));}},onleftChange:function(){if(this.stripNode&&this.left!=null){this.stripNode.style.left=this.left+"px";}},onwidthChange:function(C){var E=this.scrollNode,B=this.stripNode;if(E&&B){var D=this,A=parseInt(this.width,10);window.setTimeout(function(){if(A<B.clientWidth){D.createScrBtn();A-=(D.btnsWidth||0);}D.updateScrBtn();if(mstrmojo.dom.isIE7&&B.clientWidth>0){B.style.width=B.clientWidth+7+"px";}E.style.width=A+"px";},0);}}},step:50,scroll:function(B){B=B||1;var D=this.scrollNode,A=this.stripNode,E=Math.abs(parseInt(this.left,10)||0),C=Math.max(A.clientWidth-E-D.clientWidth,0),F=Math.min(this.step,(B==-1?C:E));this.set("right",C);this.set("left",-(E-B*F));this.updateScrBtn();},createScrBtn:function(){if(this.btnLeft&&this.btnRight){return ;}var A=this;this.addChildren([{scriptClass:"mstrmojo.Button",cssClass:"l",alias:"btnLeft",visible:false,enabled:false,scrollInterval:null,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(1);if(A.left>=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnLeftNode"},{scriptClass:"mstrmojo.Button",cssClass:"r",alias:"btnRight",visible:false,enabled:false,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(-1);if(A.right<=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnRightNode"}]);this.renderChildren();this.btnsWidth=50;},updateScrBtn:function(){var F=this.scrollNode,B=this.stripNode,D=this.btnLeft,E=this.btnRight;if(F&&B&&D&&E){var H=Math.abs(parseInt(this.left,10)||0),G=B.clientWidth;E.set("enabled",G-H>F.clientWidth);D.set("enabled",H>0);var A=parseInt(this.width,10),C=A<G;this.btnLeft.set("visible",C);this.btnRight.set("visible",C);if(!C){this.set("left",0);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.string");var A=mstrmojo.ValidationTextBox.prototype.markupMethods,B=mstrmojo.string;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,isList:false,dtp:14,autoFormat:true,markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:A.onvalueChange,onenabledChange:A.onenabledChange,onvalidationStatusChange:A.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var F=this.opener,E=F&&F.calendarZIndex,G=this.cal,C=F&&F.calConfig;if(E){this.domNode.style.zIndex=E;}for(var D in C){G.set(D,C[D]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",changeValueOnOK:function(){var D=this.parent.opener.dtp,C=this.parent.opener.changeValueOnOK;return D===15||D===16||C;}},onValueUpdate:function(D){var F=this.parent&&this.parent.opener;if(F){var E=F.value,C=window.mstrConfig&&window.mstrConfig.listSep||";";if(F.isList&&!B.isEmpty(E)){F.set("value",F.value+C+this.value);}else{F.set("value",this.value);}F.closePopup();}}}]},onclick:function(C){var D=this._lastOpened,E=this._calendarConfig;if(!E){E={};if(this.calendarToBody){delete this.calendar.slot;E.placeholder=document.body.appendChild(document.createElement("div"));E.nudge=function(){var H=this.opener;if(H){var G=mstrmojo.dom.position(H.popupNode,true),F=this.domNode.style;F.left=G.x+"px";F.top=G.y+"px";}};}this._calendarConfig=E;}if(D&&D.visible){this.closePopup();}else{this.openPopup("calendar",E);}},unrender:function(){this._super();if(this.calendar.hasRendered){this.calendar.unrender();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricQualification","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var a=mstrmojo.dom,R=mstrmojo.hash,S=mstrmojo.MCSUtil,K=mstrmojo.desc,f=mstrmojo.css,g=mstrmojo.num,U=Math,E=U.max,C=U.min,B=U.floor,H=U.round;function M(n,z,AD,AA){var AG="px",q=n._length,AE=n.handleSize,p=n.orCfg,t=p.posCssP,o=p.lenCssP;AD=E(AD,-1);AA=C(AA,q);var s=C(AD,AA),x=E(AD,AA),AC=x-s,AF=E(parseInt(n[o],10)-(2*n.cssBkBW)-(x+AE),0);if(n.hasRendered){z.handle1Node.style[t]=AD+AG;z.handle2Node.style[t]=AA+AG;var w=z.lowerRange.style,AB=z.thumbNode.style,l=z.upperRange.style;w[t]=0;AB[t]=(s+AE)+AG;l[t]=(x+AE)+AG;w[o]=E(s,0)+AG;AB[o]=AC+AG;l[o]=AF+AG;}else{AG+=";";t+=":";o+=":";n.handle1CssText=t+AD+AG;n.handel2CssText=t+AA+AG;n.lowerRangeCssText=o+E(s,0)+AG;n.thumbCssText=t+(s+AE)+AG+o+AC+AG;n.upperRangeCssText=t+(x+AE)+AG+o+AF+AG;}return{handle1:AD,handle2:AA};}function Y(l){this.getUnit=function(){return l._length/E((l.items.length-1),1);};this.calcMinMax=function(p,o){var q=l.unit;return{min:B(p/q+0.5),max:B(o/q+0.5)};};this.calcPxIdx=function(o){return B(o/l.unit+0.5);};this.getStep=function(){var p=l.high-l.low,o=parseInt(l.numFmts.cat,10),q=(o===4)?2:(o===5)?4:0;p=(p===0)?1:p;if(p>1){return(p>(l._length-2))?Number(Number(p/(l._length-2)).toFixed(l.numFmts.dp+q)):1;}return p/(l._length-2);};this.getIdx=function(o){return C(E(H((o-l.low)/l.step),0),l.items.length-1);};this.initialMetricSlider=function n(){var t=function(AI){return AI!==undefined&&AI!==null;},q=function(AI){return(t(AI.da)&&t(AI.da.low)&&t(AI.da.high)&&t(AI.da.cnt)&&t(AI.f)&&t(AI.ft)&&t(AI.qua));},p=function(AI){var AK=true,AJ=true;if(AI.ft==S._GENERIC){AK=AI.f!=S.FN.ISNULL&&AI.f!=S.FN.ISNOTNULL&&AI.f!=S.FN.NOTIN&&AI.f!=S.FN.IN;}else{if(AI.ft==S._PERCENT||AI.ft==S._RANK){AJ=AI.f!=S.MRPFN.INASCENDING&&AI.f!=S.MRPFN.INDESCENDING&&AI.f!=S.MRPFN.NOTINDESCENDING&&AI.f!=S.MRPFN.NOTINASCENDING;}}return !AK||!AJ;},AF=0;l.include=l.parent.include;l.clsType="scm ";l.staticStatus=!(t(l.da)&&t(l.da.low)&&t(l.da.high)&&t(l.da.cnt)&&t(l.qua));if(l.staticStatus){l.da.low=1;l.da.high=7;l.ft=S._GENERIC;l.f=S.FN.BETWEEN;l.qua=S.Q._G;l.cs=[{n:"",v:1},{n:"",v:7}];l.numFmts={cat:9,dp:0,fm:""};}switch(l.qua){case 0:var AE=l.numFmts.cat;AF=AE==4?2:AE==5?4:0;l.low=Number(Number(l.da.low).toFixed(l.numFmts.dp+AF));l.high=Number(Number(l.da.high).toFixed(l.numFmts.dp+AF));break;case 1:case 2:l.low=1;l.high=l.da.cnt;break;case 3:case 4:l.low=0;l.high=100;break;}var AH=!l.staticStatus&&!l.da.nov&&l.dt!=30;l.set("lowText",AH?S.formatNumber(l.qua,l.low,l.numFmts):"");l.set("highText",AH?S.formatNumber(l.qua,l.high,l.numFmts):"");l.step=(l.qua==1||l.qua==2)?1:this.getStep();l.low-=l.step;l.high+=l.step;l.cs1Vl=l.low;l.cs2Vl=l.high;var s=l.low,AB=l.high,AG=[],AD=0;if(t(s)&&t(AB)&&l.dt!=30){for(var AA=0,x=s;x<=AB;AA++,x+=l.step){AG[AA]={n:S.formatNumber(l.qua,x,l.numFmts),v:Number(Number(x).toFixed(l.numFmts.dp+AF))};}AD=AG.length;if(AD>0&&AG[AD-1].v!=AB){AG[AD-1]={n:S.formatNumber(l.qua,AB,l.numFmts),v:AB};}}AD=AG.length;if(AD>=2){AG[0].n=AG[AD-1].n=K(7622);}l.items=AG;var o=S.OP,AC=l.cs,z=(AC&&AC.length>0)?g.parseNumeric(String(AC[0].v).replace("%","")):s,w=(AC&&AC.length>1)?g.parseNumeric(String(AC[1].v).replace("%","")):AB;if(z<l.low){l.frtUst=true;}if(w>l.high){l.ndUst=true;}l.opId=(l.f!=null&&l.ft!=null)?S.getOpIdxByfunc(l.f,l.ft):o._BETWEEN;switch(l.opId){case o._EQUALS:case o._NOT_EQUALS:l.cs1Vl=l.cs2Vl=z;break;case o._LESS_EQUAL:case o._GREATER:l.cs1Vl=s;l.cs2Vl=z;break;case o._GREATER_EQUAL:case o._LESS:l.cs1Vl=z;l.cs2Vl=AB;break;case o._IN:case o._NOT_IN:case o._IS_NULL:case o._IS_NOT_NULL:break;default:l.cs1Vl=z;l.cs2Vl=w;break;}l.cs1Idx=this.getIdx(l.cs1Vl);l.cs2Idx=this.getIdx(l.cs2Vl);if(l.dt!=30){l.cs1Nm=t(l.cs1Vl)?S.formatNumber(l.qua,l.cs1Vl,l.numFmts):l.items[l.cs1Idx].n;l.cs2Nm=t(l.cs2Vl)?S.formatNumber(l.qua,l.cs2Vl,l.numFmts):l.items[l.cs2Idx].n;}l.unit=this.getUnit();l.set("unSet",(l.dt==30||!q(l)||p(l)||(!l.cs||l.cs.length==0))&&!l.staticStatus);};this.updateOpCs=function(){var s=(l.cs1Vl>l.cs2Vl)?l.cs2Vl:l.cs1Vl,z=(l.cs1Vl>l.cs2Vl)?l.cs1Vl:l.cs2Vl,q=l.low,t=l.high,x=l.include,o=S.OP,p=(l.qua==S.Q._PT||l.qua==S.Q._PB),AA,w=[];if((s>=q&&z<=t)||s<q||z>t){l.opId=(x)?o._BETWEEN:o._NOT_BETWEEN;}if(s==z){l.opId=(x)?o._EQUALS:o._NOT_EQUALS;}if(s==q&&z<t){l.opId=(x)?o._LESS_EQUAL:o._GREATER;}if(s>q&&z==t){l.opId=(x)?o._GREATER_EQUAL:o._LESS;}AA=q==s&&z==t;if(!AA){switch(l.opId){case o._BETWEEN:case o._NOT_BETWEEN:w.push({dtp:5,v:g.toLocaleString(s)+(p?"%":"")});case o._EQUALS:case o._NOT_EQUALS:w.push({dtp:5,v:g.toLocaleString(z)+(p?"%":"")});break;default:if(s>q){w.push({dtp:5,v:g.toLocaleString(s)+(p?"%":"")});}if(z<t){w.push({dtp:5,v:g.toLocaleString(z)+(p?"%":"")});}}}l.cs=w;l.parent.node.data.cs=w;l.set("unSet",AA);};this.updateThumb=function(){var o=l.cs1Idx,s=l.cs2Idx;if(o!==undefined&&s!==undefined){var p=l.unit,q=l.gap;R.copy(M(l,l,H(o*p-q),H(s*p-q)),l);}};this.joinConst=function(){var q=l.cs;if(q){var o=[],p;for(p in q){o.push(q[p].v);}return o.join(",");}};}var i="<span {@ttpCssText}>{@content}</span>";function Z(){if(this.staticStatus){return null;}var p=this.ghost;if(!p){var t=this.containerNode.cloneNode(true),s=t.childNodes;f.addClass(t,["gh"]);p=this.ghost={containerNode:t,lowerRange:s[0],handle1Node:s[1],thumbNode:s[2],handle2Node:s[3],upperRange:s[4]};this.sdcNode.appendChild(t);}var n=this.orCfg,l=n.posCssP,o=n.lenCssP,q=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(AB,w){var AA=mstrmojo.all[q],z=AA[AB].style,x=p[AB].style;if(w){x[l]=z[l];}x[o]=z[o];});p.containerNode.style.display="block";return p;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style="position:absolute;"><div class="bk" style="margin-top: 2px;{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:5px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:5px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},bgNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[3];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);},onunSetChange:function(){f.toggleClass(this.domNode.childNodes[1],"invalid",this.unSet);}},init:function X(l){this._super(l);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new Y(this);this.useRichTooltip=false;},unSet:false,preBuildRendering:function D(){var p=this.orCfg,o=this.isHoriz;p.cPosCssP=(o)?"right":"bottom";p.cLenCssP=(o)?"height":"width";var t=p.lenCssP,s=this[t],q=parseInt(s,10),n=this.handleSize;var l=this._length=(isNaN(q))?0:(q-n);if(l<=0){l=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-n;}if(s){this.bkCssText=t+":"+E(q-(2*this.cssBkBW),0)+"px;";this.sdcCssText=p.posCssP+":0px;"+t+":"+l+"px;"+p.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function b(){this._super();if(!this.staticStatus&&!this.da.nov){var n=this.lowNode,l=parseInt(n.style.fontSize,10);n.style.fontSize=this.highNode.style.fontSize=H((isNaN(l)?8:l)*this.parent.model.zf)+"pt";this.updateSummary();}},onmouseover:function J(l){this.showTooltip(l.e,self);},onmouseout:function G(l){this.hideTooltip(l.e,self);},summaryLabels:{db:K(8153,"Between ## and ###"),dnb:K(8154,"Not between ## and ###"),din:K(587,"In"),dnin:K(2204,"Not in"),dnull:K(2202,"Is Null"),dnnull:K(2203,"Is not Null"),req:K(8155,"Rank ="),rneq:K(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:K(8157,"Rank exclude bottom"),rext:K(8158,"Rank exclude top"),rb:K(8159,"Rank bottom"),rt:K(8160,"Rank top"),rbt:K(8161,"Rank between ## and ###"),rnbt:K(8162,"Rank not between ## and ###"),rin:K(8163,"Rank in"),rnin:K(8164,"Rank not in"),peq:K(8165,"Percent ="),pneq:K(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:K(8167,"Exclude bottom"),pext:K(8168,"Exclude top"),pb:K(7576,"Bottom"),pt:K(7575,"Top"),pbt:K(8153,"Between ## and ###"),pnbt:K(8154,"Not between ## and ###"),pin:K(8169,"Percent in"),pnin:K(8170,"Percent not in")},updateSummary:function A(){if(this.summaryNode&&!this.staticStatus){var AB=this.f,AA=this.ft,x=S,p=S.FN,o=S.MRPFN,z="",AD=(this.cs1Vl<this.cs2Vl)?this.cs1Nm:this.cs2Nm,AC=(this.cs1Vl>this.cs2Vl)?this.cs1Nm:this.cs2Nm,n=this.typeHelper,AE=this.summaryLabels,w=(AA==x._GENERIC&&(AB==p.ISNULL||AB==p.ISNOTNULL||AB==p.NOTIN||AB==p.IN))||((AA==x._PERCENT||AA==x._RANK)&&(AB==o.INASCENDING||AB==o.INDESCENDING||AB==o.NOTINDESCENDING||AB==o.NOTINASCENDING));if(!this.unSet||w){switch(AA){case x._GENERIC:switch(AB){case p.EQUALS:z="= "+AD;break;case p.NOTEQUALS:z=String.fromCharCode(8800)+" "+AD;break;case p.GREATERTHAN:z="> "+AC;break;case p.GREATERTHANEQUALS:z=String.fromCharCode(8805)+" "+AD;break;case p.LESSTHAN:z="< "+AD;break;case p.LESSTHANEQUALS:z=String.fromCharCode(8804)+" "+AC;break;case p.BETWEEN:z=AE.db.replace("##",AD).replace("###",AC);break;case p.NOTBETWEEN:z=AE.dnb.replace("##",AD).replace("###",AC);break;case p.ISNULL:z=AE.dnull;break;case p.ISNOTNULL:z=AE.dnnull;break;case p.IN:z=AE.din+" "+n.joinConst();break;case p.NOTIN:z=AE.dnin+" "+n.joinConst();break;}break;case x._PERCENT:case x._RANK:var l="r";if(AA==x._PERCENT){l="p";}switch(AB){case o.EQUALSDESCENDING:case o.EQUALSASCENDING:z=AE[l+"eq"]+" "+AD;break;case o.NOTEQUALSDESCENDING:case o.NOTEQUALSASCENDING:z=AE[l+"neq"]+" "+AD;break;case o.GREATERTHANEQUALSASCENDING:z=AE[l+"exb"]+" "+AD;break;case o.GREATERTHANASCENDING:z=AE[l+"exb"]+" "+AC;break;case o.GREATERTHANEQUALSDESCENDING:z=AE[l+"ext"]+" "+AD;break;case o.GREATERTHANDESCENDING:z=AE[l+"ext"]+" "+AC;break;case o.LESSTHANASCENDING:z=AE[l+"b"]+" "+AD;break;case o.LESSTHANEQUALSASCENDING:z=AE[l+"b"]+" "+AC;break;case o.LESSTHANDESCENDING:z=AE[l+"t"]+" "+AD;break;case o.LESSTHANEQUALSDESCENDING:z=AE[l+"t"]+" "+AC;break;case o.BETWEENDESCENDING:case o.BETWEENASCENDING:z=AE[l+"bt"].replace("##",AD).replace("###",AC);break;case o.NOTBETWEENASCENDING:case o.NOTBETWEENDESCENDING:z=AE[l+"nbt"].replace("##",AD).replace("###",AC);break;case o.INASCENDING:case o.INDESCENDING:z=AE[l+"in"]+" "+n.joinConst();break;case o.NOTINDESCENDING:case o.NOTINASCENDING:z="";z=AE[l+"nin"]+" "+n.joinConst();break;}break;}}var q=this.summaryNode,t=(z!=="")?"":0;q.innerHTML=z;q.style.margin=t;if(this.hasRendered&&this.height==null){this.parent.updateHeight();}}},getClientHeight:function W(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function V(q,l){if(!this.staticStatus&&!this.da.nov){l=l||window;var s=a.eventTarget(l,this.dnd.startE);if(s===this.handle1Node||s===this.handle2Node){var p=Z.call(this),n=this.orCfg,o=this.dnd;o.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10),length:this._length,contL:p.containerNode[n.lenP],offset:a.getMousePosition(this.dnd.startE,l)[n.offsetP]};o.initD.td=s;f.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function I(w,t){if(!this.staticStatus){t=t||window;var z=this.dnd.initD;if(z){var AE=this.ghost,AF=z.handle1,p=z.handle2,s=this.cs1Idx,o=this.cs2Idx,AD=this.unit,AB=this.gap,n=z.length;var AC=a.getMousePosition(w,t)[this.orCfg.offsetP]-z.offset;switch(z.td){case this.handle1Node:AF=E(C(E(z.handle1+AC,0),n)-AB,-1);s=E(B(AF/AD+0.5),0);break;case this.handle2Node:p=E(C(E(z.handle2+AC,0),n)-AB,-1);o=E(U.ceil(p/AD+0.5),0);break;default:return ;}M(this,AE,AF,p);var x=this.items,l=(x&&x.length)||0;if(l&&s>=0&&s<l&&o>=0&&o<l){var q=false;if(s!==this.cs1Idx){this.cs1Idx=s;var AA=this.items[s];this.cs1Vl=AA.v;this.cs1Nm=AA.n;q=true;}if(o!==this.cs2Idx){this.cs2Idx=o;var AA=this.items[o];this.cs2Vl=AA.v;this.cs2Nm=AA.n;q=true;}if(q){this.typeHelper.updateThumb();this._updateTooltip(z.td);}}}}},ondrop:function h(n){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var l=this.ghost;if(l){l.containerNode.style.display="none";}this.hideTooltip(n,self);if(this.items&&this.items.length){this[(a.eventTarget(self,n)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function O(l,z,AA){var p=this.typeHelper,t=this.cs1Vl,s=this.cs2Vl,n=this.qua,o=this.numFmts;this.cs1Idx=p.getIdx(t);this.cs2Idx=p.getIdx(s);var x=function(q,AC){var AB=AC||[];return q==0||q==AB.length-1;},w=K(7622);this.cs1Nm=x(this.cs1Idx,this.items)&&!this.frtUst?w:S.formatNumber(n,t,o);this.cs2Nm=x(this.cs2Idx,this.items)&&!this.ndUst?w:S.formatNumber(n,s,o);p.updateOpCs();this.onlyInclude=!!l;this.changeQual=!!z;this.unSet=!!AA||this.unSet;this.updateSummary();this.onselectionChange();},onincludeChange:function N(){if(!this.staticStatus){this.selectRange(true);}},showTooltip:function F(n,l){var o=a.eventTarget(l,n);this._updateTooltip(o);mstrmojo.tooltip.open(this,n,l);},_updateTooltip:function T(q){var n=this.orCfg,p=n.posCssP,l,o={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};o[n.opPosCssP]=-parseInt(this.font)/2;o[p]=q.style[p];if(this.unSet){l=K(7622);}else{l=String((q===this.handle1Node)?this.cs1Nm:this.cs2Nm);}o.content=i.replace(/\{@content\}/g,l);this.set("richTooltip",o);},onclick:function k(l){if(!this.staticStatus&&!this.da.nov){var n=a.eventTarget(l.hWin||window,l.e);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((n===this.handle1Node)?this.handle1Node:((n===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(n===this.handle1Node),tgt:n});if(this._onThumb){this._onThumb(l);}}},onselectionChange:function Q(l){this._super(l);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function P(l){var o=mstrmojo.MCSUtil.getFuncInfo(this.opId,l.valueWas),p=mstrmojo.MCSUtil.getFuncInfo(this.opId,l.value),n;if(o.ft!=p.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();n=true;}}else{this.f=mstrmojo.MCSUtil.getFuncInfo(this.opId,l.value).f;n=false;}this.selectRange(false,true,n);},updateData:function j(l,n){this.da=l;this.updateExpr(n);},updateExpr:function L(l){if(l){this.cs=l.cs;this.f=l.f;this.ft=l.ft;this.qua=l.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",C(E(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var o=this.opener,n=this.children[0];if(o){var l=this.isfrt?o.cs1Vl:o.cs2Vl;if(this.isfrt){if((o.cs1Vl<=o.low||o.cs1Vl>=o.high)&&!o.frtUst){l="";}}else{if((o.cs2Vl<=o.low||o.cs2Vl>=o.high)&&!o.ndUst){l="";}}n.edt.set("value",g.toLocaleString(l));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!=0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(n){if(this.parent.apply.enabled){var l=n.hWin,o=n.e||l.event;if(o.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var n=this.parent.parent,o=n.opener,l=this.parent.edt.value;if(n&&o&&String(l).length>0){o[n.isfrt?"cs1Nm":"cs2Nm"]=l;l=g.parseNumeric(l);o[n.isfrt?"cs1Vl":"cs2Vl"]=l;}o[n.isfrt?"frtUst":"ndUst"]=true;o.selectRange();o.typeHelper.updateThumb();n.close();}}]}]},openEditValue:function(l){this.openPopup("editValueRef",l);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo._IsInputControl","mstrmojo.dom","mstrmojo.num");var J=mstrmojo.validation,C=J.STATUSCODE,F=J.VALIDATOR,D=mstrmojo.expr.DTP,B=0,A=1,I=2,H=3,G=4,E=5;mstrmojo.TextFieldDIC=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",dtp:D.VARCHAR,validationDelay:0,getInputNode:function(){return this.inputNode;},focus:function(){this.validate();mstrmojo.dom.setCaret(this.domNode,(this.value&&this.value.length||0));},init:function(K){if(this._super){this._super(K);}this.constraints=mstrmojo.hash.copy();var M=K.dic,N=this.constraints={trigger:mstrmojo.validation.TRIGGER.ONKEYUP},L=M.dt;if(M.ml){this.maxLength=M.ml;}if(M.psw){this.type="password";this.value=this.lv="";this.owner.applyPasswordMask&&this.owner.applyPasswordMask();}if(J.isNumeric(L)||J.isInt(L)||J.isString(L)){this.dtp=L;}switch(M.vm){case A:N.validator=F.VALIDATE_PHONENO;break;case I:N.validator=F.VALIDATE_EMAIL;break;case H:N.validator=F.VALIDATE_ZIPCODE;break;case G:N.validator=F.VALIDATE_SSN;break;case E:N.regExp=new RegExp("^"+M.rgx+"$");break;}N.min=M.emin?M.min:null;N.max=M.emax?M.max:null;N.maxLen=(M.ml!==undefined)?M.ml:null;N.minLen=(M.mnl!==undefined)?M.mnl:null;if(M.req||M.emin){this.required=true;}},onInvalid:function(){if(this.popup){this.popup.set("hasInvalidData",true);}},onValid:function(){if(this.popup){this.popup.set("hasInvalidData",false);}},applyChanges:function(){this.validate();if(this.isValid()){this._super();}else{this.handleInvalid();return false;}return true;},handleInvalid:function(){if(mstrmojo.all.mojoConfirmx9){return ;}var K=this;mstrmojo.confirm(this.validationStatus.msg+"<br>("+mstrmojo.desc(9199)+")",[{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1442),onclick:function(){K.focus();}},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(221),onclick:function(){K.popup.onCancel();}}],mstrmojo.desc(7548));},cancelChanges:function(){this.inputNode.blur();this.value=this.lv;this.clearValidation();}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.fx","mstrmojo.css","mstrmojo.DropDownButton");var E=1,L=2,B=null,A=null,F=mstrmojo.dom,G=mstrmojo.css;var C=400;function H(V,R,N,O,U,M,Q,T){var S={duration:C,target:R,onEnd:function(){if(M){M();}},props:{}};S.props[N]={ease:Q||mstrmojo.ease.sin,start:parseInt(O,10),stop:parseInt(U,10),suffix:"px"};S=mstrmojo.hash.copy(T,S);var P=new mstrmojo.fx.AnimateProp(S);P.play();return P;}mstrmojo.ElasticTextArea=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ElasticTextArea",markupString:'<div id="{@id}" class="mstrmojo-ElasticTextArea {@cssClass}" style="{@cssText}" mstrAttach:blur ><div class="mstrmojo-ElasticTextAreaContent " style="height: 100%;"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvalueChange:function(){if(this.textNode&&this.value!==this.textNode.textArea.value){this.textNode.textArea.set("value",this.value);this.adjustStatusBar();}},onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onwidthChange:function(){if(this.domNode&&this.width){this.domNode.style.width=this.width+"px";}},ontopChange:function(){if(this.domNode&&this.top){this.domNode.style.top=this.top+"px";}},onleftChange:function(){if(this.domNode&&this.left){this.domNode.style.left=this.left+"px";}}},width:200,height:30,resize:"none",maxLength:256,value:"",postCreate:function(){this.minHeight=this.height;var M=this;this.children=[{scriptClass:"mstrmojo.Box",alias:"textNode",cssText:"width:100%;",onheightChange:function(O){var P=this.parent.minHeight,Q=Math.max(P,O.valueWas||0),N=Math.max(P,O.value);if(Q!==N){if(F.isIE7){this.textArea.domNode.style.height=this.domNode.style.height=N+"px";}else{if(this._slidingFx&&this._slidingFx.isPlaying){this._slidingFx.props.height.stop=N;}else{this._slidingFx=H(true,this.domNode,"height",Q,N);}}}},children:[{scriptClass:"mstrmojo.TextArea",alias:"textArea",cssClass:"eta-text",cssText:"width:100%;height:100%;",rows:1,bindings:{maxLength:"this.parent.parent.maxLength"},onblur:function(N){if(M.onblur){M.onblur(N);}},onkeyup:function(P){var Q=this.maxLength,N=this.value.length;if(Q<=N&&!this.isArrowKeys&&!this.isDeleteKeys){if(F.isIE7||F.isIE8){this.value=this.domNode.value=this.value.substr(0,Math.min(N,Q));}return false;}var O=this.parent.parent;O.set("value",this.value);O.adjustStatusBar();}},{scriptClass:"mstrmojo.Label",cssClass:"eta-text ghost",alias:"ghost",cssText:"visibility: hidden; z-index:-1; position:absolute;left:0; top:0;  word-wrap:break-word; border:1px solid red; none; margin:0; padding:2; width:100%;",bindings:{text:"this.parent.parent.value"},_setHeight:function(O){var N=Math.max(O||0,this.domNode.clientHeight);this.parent.set("height",N);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.ontextChange=function(N){if(this.domNode&&this.text){this.domNode.innerHTML=this.text.replace(/<br \/>&nbsp;/,"<br />").replace(/<|>/g," ").replace(/&/g,"&amp;").replace(/\n/g,"<br />&nbsp;");}this._setHeight();};},postBuildRendering:function(N){if(this._super){this._super(N);}this._setHeight(this.parent.parent.height);}}]},{scriptClass:"mstrmojo.Label",alias:"statusBar",cssClass:"eta-bar",text:""},{scriptClass:"mstrmojo.Label",alias:"msgBoxTip",cssClass:"eta-tip",cssText:F.isIE8?"bottom: -4px;":""}];},preBuildRendering:function D(){this._super();this.textNode.height=0;},postBuildRendering:function J(){if(this._super){this._super();}this.textNode.textArea.set("value",this.value);this.adjustStatusBar();},onmaxLengthChange:function(M){if(M.value){this.adjustStatusBar();}},onfontChange:function(M){var P=this.textNode.textArea,O=this.textNode.ghost,N;for(N in this.font){this.domNode.style[N]=this.font[N];if(F.isIE7){P.domNode.style[N]=this.font[N];O.domNode.style[N]=this.font[N];this.statusBar.domNode.style[N]=this.font[N];}}if(F.isIE9){P.refresh();}O._setHeight();},adjustStatusBar:function(){if(!this.msgBoxTip.domNode){return ;}var P=this,S=this.maxLength,T=this.textNode.textArea,R=(T.value&&T.value.length)||0,Q=R/S,N=this.statusBar,M=this.msgBoxTip;var O=Q*this.width;M.domNode.style.left=Math.min(Math.ceil(O-M.domNode.offsetWidth/2),this.width-3)+"px";N.set("text",mstrmojo.desc(4891,R+" of "+S).replace("##",R).replace("###",S));},focus:function(){F.setCaret(this.textNode.textArea.domNode,((this.value&&this.value.length)||0));}});mstrmojo.ElasticTextAreaButton=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.ElasticTextAreaButton",cssClass:"mstrmojo-ElasticTextAreaButton",popupToBody:false,popupWidth:200,maxLength:256,unrender:function I(M){var N=this.popupRef;if(this.popupToBody&&N.hasRendered){N.unrender(false);}if(this._super){this._super(M);}},postBuildRendering:function J(){if(this._super){this._super();}if(this.value&&this.value.length>0){G.addClass(this.domNode,"filled");}},premousedown:function K(N){if(this.popupToBody){var Q=F.position(this.popupNode,true),P=this.popupRef,M={left:Math.round(Q.x)+"px",top:Math.round(Q.y)+"px"};if(!P.hasRendered){delete P.slot;M.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(M,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this.popupRef.eta){this.popupRef.eta.set("value",this.value);}else{this.popupRef.children[0].value=this.value;}if(this._super){this._super();}var O=this.popupRef.domNode;if(O){O.style.minWidth=(this.domNode.offsetWidth-2)+"px";}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-ElasticTextAreaPopup",shadowNodeCssClass:"mstrmojo-ElasticTextAreaPopup-shadow",contentNodeCssClass:"mstrmojo-ElasticTextAreaPopup-content",autoCloses:false,locksHover:true,visible:true,onOpen:function(){var N=this.eta,O=N.domNode.firstChild,P=0,M;this.eta.set("font",this.opener.font);O.parentNode.style.display="block";G.addClass(this.opener.domNode,"editing");O.parentNode.style.overflow="hidden";M=this._h||(O.offsetHeight);H(false,O,"height",P,M,function(){O.style.height="100%";O.parentNode.style.overflow="visible";N.focus();});},onClose:function(){this.visible=false;var O=this.eta.domNode,N=O.firstChild,P=N.offsetHeight,M=0;this._h=P;this.opener.set("value",this.eta.value);G.removeClass(this.opener.domNode,"editing");N.style.height=N.offsetHeight+"px";O.style.overflow="hidden";H(false,N,"height",P,M,function(){O.style.display="none";});},children:[{scriptClass:"mstrmojo.ElasticTextArea",alias:"eta",bindings:{width:function(){return this.parent.opener.popupWidth;},maxLength:function(){return this.parent.opener.maxLength;}}}]}});}());(function(){var BUILDER_METHOD={BUTTON:"newButton",PICKERBUTTON:"newPickerButton",LIST:"newList",SEPARATOR:"newSeparator",TEXT:"newCustom"};function cmdMethodName(cmdid){return(cmdid==="export")?cmdid+"Cmd":cmdid;}function bindEnabled(enabledFeatures){var arr=enabledFeatures.split(","),txt=[],i,len;for(i=0,len=arr.length;i<len;i++){var s=arr[i],neg=s.match(/^\!/);if(neg){s=s.replace("!","");}txt.push((neg?"!":"")+"this.target.model.features['"+s+"']");}return txt.join(" && ");}function bindItems(cmdid){return"var t = this.target, c = this.cmdid; if (t && c) {if (t.requiresMethod) t.requiresMethod(c); return this.target."+cmdid+"Options;}";}function bindSelectedItem(cmdid){return"var x = this.items; var t = this.target, c = this.cmdid; if (t && c){ if (t.requiresMethod) t.requiresMethod(c); return this.target."+cmdid+"Value;}";}function openLink(json){var link=json.link,h=link&&link.href,t=link&&link.target,xtraUrl=json["extra-url"];if(!link||!h){return ;}if(xtraUrl){h+="&"+xtraUrl;}if(link["use-window-open"]){t="_blank";}window.open(h,t?t:"_self");}mstrmojo.ToolBarBuilder={scriptClass:"mstrmojo.ToolBarBuilder",build:function build(nodes,model,config){var arr=[],i,len;for(i=0,len=(nodes&&nodes.length)||0;i<len;i++){var json=nodes[i],n=BUILDER_METHOD[(json&&json.type)||"SEPARATOR"],w=this[n]&&this[n](json,config);if(w){arr.push(w);}}return arr;},newButton:function nwBtn(json,config){if(json["on-click"]||json.link){return this.newCustom(json,config);}var c=cmdMethodName(json.cmdid);return new mstrmojo.Button({title:json.tooltip,iconClass:json.id,cssClass:"mstrmojo-InteractiveButton",target:config&&config.target,cmdid:c,onclick:function(e){var t=this.target,ci=this.cmdid;t.requiresMethod(ci);t[ci](e);},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null});},newPickerButton:function nwPkrBtn(json,config){var c=cmdMethodName(json.cmdid);var bs;if(!json.items){bs={};bs.items=bindItems(c);}if(json.enabledFeatures){bs=bs||{};bs.enabled=bindEnabled(json.enabledFeatures);}function oc(){var t=this.target,ci=this.cmdid,its=this.items,idx=this.selectedIndex;t.requiresMethod(ci);t[ci](its[idx].dssid);}return new mstrmojo.PickerButton({title:json.title||"",iconClass:json.id,items:json.items,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,size:1,selectedIndex:parseInt(json.selectedIndicesList,10)||0,target:config&&config.target,cmdid:c,onchange:oc,bindings:bs});},newList:function nwLst(json,config){var c=cmdMethodName(json.cmdid),bs={selectedItem:bindSelectedItem(c)};if(!json.items){bs.items=bindItems(c);}if(json.enabledFeatures){bs.enabledFeatures=bindEnabled(json.enabledFeatures);}return new mstrmojo.SelectBox({size:1,tooltip:json.title||"",iconClass:json.id,cmdid:c,target:config&&config.target,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,onchange:function(){var t=this.target,ci=this.cmdid,itm=this.selectedItem;t.requiresMethod(ci);t[ci](itm&&itm.dssid);},items:json.items,bindings:bs});},newSeparator:function nwSep(json,config){return new mstrmojo.ToolSeparator(json);},newCustom:function newCstm(json,config){var b=new mstrmojo.Button({markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass}" title="{@title}" style="{@cssText}" mstrAttach:click,mousedown,mouseup><div id="{@iconClass}" class="mstrmojo-Button-text"></div></div>',title:json.tooltip,cssClass:"mstrmojo-InteractiveButton",onclick:function(){if(json.link){openLink(json);}if(json["on-click"]){eval(json["on-click"]);}},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null}),v=json.value;b.text=v||"";b.cssText=v?"width:auto;margin-top:4px;":"";b.title=json.tooltip||"";b.iconClass=json.id||"";return b;}};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var O=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],V=["width","height"],n="p_fmts";var k="px";var i={getContentHeight:function(q,t){var s=t.ttl&&t.ttl.height;if(q&&s&&!this.floatingToolbar){return Math.max(parseInt(q,10)-parseInt(s,10),0)+k;}return"";},getPortletMinHeight:function(q){return q.ttl.height;},adjustTitleCss:function(q){return ;}};var g={getContentHeight:function(q,s){return q;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(q){q.titlebarNodeClass+=" floating";return ;}};function A(w,s){var t=this.parent,q=w+"DirtyKey";if(t[q]){t[q](s);}}function N(){var q=this.title;if(this.count){q+=" "+this.count;}this.toolbarTitleTextNode.innerHTML=q;}function h(){var s=this.parent,w=s&&s.defn;if(w&&parseInt(w.t,10)===mstrmojo.EnumRWUnitType.PANEL){var q=s.parent,t=q.defn;if(t&&t.ifp){return q;}}return null;}var P=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;">{@title} {@count}</div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){N.call(this);},oncountChange:function(){N.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B"],shadowNode:["RW","B","fx","background-color"],titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]},buttonbarNode:{src:"ttl",props:["background-color"]}},fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:i,getCacheKey:function F(q){return this._super(q)+"-portlet";},getFormats:function L(){var s=this.content,q=s&&s.getFormats();return q&&q[n];},updateContentHeight:function b(x){var q=this.getFormats(),s=this.content,w=s.dimNode||s.domNode,t=((q.ttl&&parseInt(q.ttl.height,10))||0);if(w){if(!x){t+=((this.fc||this.isInFilterPanel())?w.offsetHeight:(q.height?parseInt(q.height,10):0));}this.containerNode.style.height=t+k;this.shadowNode.style.height=t+k;}},init:function o(q){this._super(q);var s=this.content;if(s&&s.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var s=this._ts=(this.floatingTitle)?g:i;this._super();s.adjustTitleCss(this);var q="display:none;";if(this.isInFilterPanel()){var t=P.clone(this.formatHandlers);t.portletContainerNode=["z-index","height","B","backgroud-color"];t.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=t;}if(!this.leftToolbar){this.leftToolbarNodeCssText+=q;}if(!this.toolbar){this.toolbarNodeCssText+=q;}var w=mstrmojo._Formattable.getBorderWidths(this);if(w.l||w.t||w.r){this.borderCss="has-border";}},postBuildRendering:function W(){var w=mstrmojo.dom,x=mstrmojo.css,AA=this.contentNode,AD=this.titleNode,AB=this;if(this.titleNode){if(this.floatingTitle){document.body.appendChild(this.titleNode);if(!this._onhover){this._onhovertt=function(){x.addClass(AB.titleNode,["visible"]);AB._onflt=true;return true;};this._onhoverofftt=function(){x.removeClass(AB.titleNode,["visible"]);AB._onflt=false;return true;};this._onhover=function(){var AE=AB.titleNode;x.addClass(AE,["visible"]);var AF=w.position(AB.contentNode,true);AE.style.top=(AF.y-AE.clientHeight+2)+k;AE.style.left=AF.x+k;return true;};this._onhoveroff=function(){x.removeClass(AB.titleNode,["visible"]);return true;};}w.attachEvent(AA,"mouseover",this._onhover);w.attachEvent(AA,"mouseout",this._onhoveroff);w.attachEvent(AD,"mouseover",this._onhovertt);w.attachEvent(AD,"mouseout",this._onhoverofftt);}if(this.attachContextMenuEvent){this._oncontextmenu=function(AF,t){var AE=AB.rightToolbar&&AB.rightToolbar.btnMenu;if(AE){AE.cmPos=w.getMousePosition(AF,t);AE.openPopupMenu();AE.cmPos=null;w.preventDefault(t,AF);}};w.attachEvent(AD,"contextmenu",this._oncontextmenu);}}if(this._super){this._super();}var z=this.getFormats();this.set("fc",z&&!z.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var q=this.portletContainerNode.style,s=this.shadowNode.style,AC=this.parent;q.width=s.width="99%";q.top=s.top=AC.topStart+k;q.left=s.left=G+k;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(z.left)+G*this.orgPos+k;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}},adjustFPHeight2Fit:function(){var t=mstrmojo.dom,q=t.position(this.titleNode),s=t.position(this.contentNode).y-q.y-q.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height)-s+"px";},unrender:function E(s){if(this.floatingTitle&&this.titleNode){var x=this.domNode,q=this.titleNode,w=mstrmojo.dom;if(x&&this._onhover){w.detachEvent(x,"mouseover",this._onhover);}if(x&&this._onhoveroff){w.detachEvent(x,"mouseout",this._onhoveroff);}if(q&&this._onhovertt){w.detachEvent(q,"mouseover",this._onhovertt);}if(q&&this._onhoverofftt){w.detachEvent(q,"mouseout",this._onhoverofftt);}if(q&&this._oncontextmenu){w.detachEvent(q,"contextmenu",this._oncontextmenu);}if(q){document.body.removeChild(q);}}if(this._super){this._super(s);}},updateStyle:function(s,q){var x=this.shadowNode.style,t=this.containerNode.style;x.height=t.height=s;x.width=t.width=q;},_createFormats:function T(){var w=this.content&&this.content.getFormats(),s;s=w.p_fmts={};var q,t;for(q in O){t=O[q];if(t in w){s[t]=w[t];delete w[t];}}for(q in V){t=V[q];if(t in w){s[t]=w[t];}}w.height=this._ts.getContentHeight(w.height,s);if(mstrmojo.dom.isIE&&s.fx&&s.fx.ds&&!s["background-color"]){s["background-color"]="#ffffff";}},refresh:function p(){if(!this.hasRendered){return ;}var s=this.children,q;for(q=s.length-1;q>=0;q--){s[q].refresh();}},isInFilterPanel:function K(){return(h.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var q=this.getFilterPanel();return q&&q.defn&&q.defn.fds==2;}else{return false;}},getFilterPanel:function H(){return h.call(this);},getContainerHeight:function a(){return this.containerNode.clientHeight;},relocate:function C(s,q){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=s+k;}},setInfoWindowDimensions:function l(x){var s=this.domNode.style,q=this.shadowNode.style,t=this.portletContainerNode.style,w=mstrmojo._Formattable.getBorderWidths(this);x.h-=w.h;x.w-=w.w;q.height=t.height=s.height=x.h+k;q.width=t.width=s.width=x.w+k;x.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function J(q){A.call(this,"add",q);},removeDirtyKey:function I(q){A.call(this,"remove",q);},setDirtyChildren:function X(){var q=this.content;if(q&&q.setDirtyChildren){q.setDirtyChildren.apply(q,arguments);}}});var U=0,M=1,j=2;function Y(AG,AE,q,AH){var AD=this.content,AF=AD.k,AC=mstrmojo.boxmodel.px2Inches,t=AD.model.docModel||AD.model,x=this.getFormats(),AI={},AB=this,z=function(){var w=AB.content&&AB.content.defn;if(w){w.set("ds",AG);}},s={ZIndex:x["z-index"],WindowState:AG},AA={};AA[AF]=s;if(AE!==undefined&&q!==undefined){P.copy({OldHeight:AC(t,AE),OldWidth:AC(t,q),Height:AC(t,parseInt(x.height,10)),Width:AC(t,parseInt(x.width,10))},s);AI.success=function(w){var AJ=w&&w.data;if(AJ){AD.model.loadPartialData(AJ,AF);}z();var AK=AB.parent;if("adjustSectionSize" in AK){AK.adjustSectionSize();}};t.saveRWProps(AF,AA,1,this.loadDataOnResize,AI,true);}else{z();if(!(AH&&AH.all)){t.saveRWProps(AF,AA,1,this.loadDataOnResize,AI,true);}}return AA;}function R(){var AA=this.content;if(!AA){return ;}var x=function(AE){mstrmojo.array.forEach(AE,function(AF){if("ds" in AF){AF.set("visible",(AF.ds!==AA.defn.ds));}});},AB;if(this.isInFilterPanel()){var t=(parseInt(this.defn.ds,10)===U);AA.set("visible",t);this.updateContentHeight(!t);AB=this.leftToolbar;x(AB&&AB.children);var w=this.parent;if(w.refreshFP){w.refreshFP();}}else{var q=AA.getFormats(),AC=this.getFormats(),s=this.portletContainerNode.style,AD=this.shadowNode.style,z=this.contentNode.firstChild.style;z.height=q.height;z.width=q.width;AD.height=s.height=AC.height;AD.width=s.width=AC.width;AD.top=s.top=AC.top;AD.left=s.left=AC.left;if("z-index" in AC){AD.zIndex=s.zIndex=AC["z-index"];}AB=this.rightToolbar;x(AB&&AB.children);if(AA.resize){AA.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function T(){this._super();var s=this.getFormats();var q=parseInt(this.defn.ds,10);if(q===U){s.normHeight=s.height;s.normWidth=s.width;if(s["z-index"]!==null&&s["z-index"]!==undefined){s.normZIndex=s["z-index"];}}if(q!==j){s.normTop=s.top;s.normLeft=s.left;}},onmaximize:function f(){var w=this.parent,AA=this.content,z=AA&&AA.getFormats(),t=this.getFormats(),s=t.height,q=t.width,x=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();AA.clearCache();t.height=(parseInt(w.height(),10)-x.h)+k;z.height=this._ts.getContentHeight(t.height,t);t.width=z.width=(w.width()-x.w)+k;t.top=t.left=0;t["z-index"]=w.getMaxZIndex()+1;Y.call(this,j,s,q);},onminimize:function Z(){var z=this.content,s=z.dimNode||z.domNode,x=z&&z.getFormats(),w=this.getFormats(),t=w.height||s.offsetHeight,q=w.width;this.clearCache();z.clearCache();w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}x.height=0;w.height=this._ts.getPortletMinHeight(w);Y.call(this,M,t,q);},onrestore:function Q(){var x=this.content,w=x&&x.getFormats(),t=this.getFormats(),s=t.height,q=t.width;this.clearCache();x.clearCache();t.height=t.normHeight;w.height=this._ts.getContentHeight(t.height,t);t.width=w.width=t.normWidth;t.top=t.normTop;t.left=t.normLeft;if(t.normZIndex!==null&&t.normZIndex!==undefined){t["z-index"]=t.normZIndex;}Y.call(this,U,s,q);},oncollapse:function S(q){return Y.call(this,M,undefined,undefined,q);},onexpand:function D(q){return Y.call(this,U,undefined,undefined,q);},postBuildRendering:function W(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,R);}this._super();if(this.isInFilterPanel()){var q=(parseInt(this.defn.ds,10)===U);this.updateContentHeight(!q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TimePicker","mstrmojo._IsInputControl");var A=2,B=mstrmojo.date;mstrmojo.TimePickerDIC=mstrmojo.declare(mstrmojo.TimePicker,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TimePickerDIC",popupStyle:2,init:function(C){if(this._super){this._super(C);}this.set("interval",this.dic.itv);this.set("active",A);},getCurValue:function(){if(this.dic.dt==mstrmojo.expr.DTP.TIMESTAMP){var F=B.parseDateAndOrTime(this.value),G=F&&F.time,D=F&&F.date,C,E;if(G&&!D){C=B.parseDateAndOrTime(this.lv),D=C&&C.date;if(!D){E=new Date();D={day:E.getDate(),month:E.getMonth()+1,year:E.getFullYear()};}return B.formatDateInfo(D,mstrmojo.locales.datetime.DATEOUTPUTFORMAT)+" "+B.formatTimeInfo(G,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}}return this.value;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList");mstrmojo._IsTableLayoutListDIC=mstrmojo.provide("mstrmojo._IsTableLayoutListDIC",{_mixinName:"mstrmojo._IsTableLayoutListDIC",icnCss:"dicContainer",tableLayoutCssStyle:"fixed",setDirtyFlag:function(D,C){if(D.className!=="flag-container"){var B=document.createElement("div"),A=this.itemsNode&&this.itemsNode.clientWidth-8;B.className="flag-container";B.style.left=(A>0?A:0)+"px";B.innerHTML='<div class="dirty-cell"/>';C.insertBefore(B,D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.DocButton");var B=mstrmojo.dom;mstrmojo.express.ui.DocButton=mstrmojo.declare(mstrmojo.DocButton,null,{scriptClass:"mstrmojo.express.ui.DocButton",premousedown:function A(C){if(B.getButton(C.hWin,C.e)===1){var E=this.id,D="pressed";this.set(D,true);B.attachOneTimeEvent(document,"mouseup",function(){var F=mstrmojo.all[E];if(F){F.set(D,false);}},true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.GraphBase","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo.tooltip");var F=mstrmojo.dom;function M(P){var Q=P.getFormats();if(!Q.width&&"gp" in Q){Q=Q.gp;}P.resizeForDisplayState(parseInt(Q.height,10),parseInt(Q.width,10),false);}function A(Q){var P=F.position(this.domNode),R=F.getMousePosition(Q);return{x:parseInt(R.x-P.x,10),y:parseInt(R.y-P.y,10)};}function O(V,U){var R=F.eventTarget(U,V),T=R&&R.parentNode,W=T&&T.children,P=[],S=R.getAttribute("coords");if(W&&!!S){for(var Q=0;Q<W.length;++Q){if(W[Q]&&W[Q].getAttribute&&W[Q].getAttribute("coords")==S){P.push(W[Q]);}}}return P;}mstrmojo.DocXtabGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocXtabGraph",cssClassPrefix:"mstrmojo-DocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" onclick="mstrmojo.all[\'{@id}\'].onClickArea(this, event);" onmousemove="mstrmojo.all[\'{@id}\']._updateTooltip(event, self);" {@extra}/>',_att:"",markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","background-color","fx"]},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},onClickArea:function B(R,T){T=T||window.event;var Y=A.apply(this,[T]),U=this.defn,P=F.position(this.domNode),Q=this.as[R.getAttribute("aid")],X=this.k,W=Y.x,V=Y.y,S={getBoundingClientRect:function(){var a=P.x+W,Z=P.y+V;return{left:a,top:Z,right:a+1,bottom:Z+1};},w:this};this.showInfoWin(Q.tks,S);this.model.slice({type:parseInt(U.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:X,ck:U.ck,gk:X,tks:Q.tks,cks:Q.cks,sid:this.node.data.sid,x:W,y:V,anchor:S,tty:Q.tty});},showInfoWin:function G(T,Q){var P=this.model,S=T&&P.getTargetInfoWin(T);if(S&&S.length){for(var R=0;R<S.length;R++){P.showInfoWin(S[R],Q,"h");}}},showTooltip:function N(R,Q){this._updateTooltip(R,Q);var P=O(R,Q);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.open(this,R,Q,P);}else{this._super(R,Q);}},_updateTooltip:function L(P,Q){this.updatingTooltipHelper(F.eventTarget(Q,P),A.apply(this,[P]));},hideTooltip:function J(S,R){var Q=F.eventTarget(R,S);if(Q.getAttribute("aid")===this.cAreaIdx){this.cAreaIdx=-1;var P=O(S,R);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.close(this,S,R,P);}else{this._super(S,R);}}},update:function D(P){this.node.data=P.data;this.as=P.data.as;var b="\u001E",R=this.model,X=R.getCGBMap&&R.getCGBMap(),Q=this.as||[],V,T;for(V=0;V<Q.length;V++){var Y=Q[V],U=Y&&Y.tgbs;if(U){var W=U.split(b);var Z={};for(T=0;T<W.length;T++){var S=X&&X[W[T]];if(S){Z[S]=true;}else{Z[W[T]]=true;}}Y.tks=mstrmojo.hash.keyarray(Z).join(b);}}this.eg=P.data.eg;},retrieveGraphSrc:function I(Q,P){var S=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(P,10)+"&height="+parseInt(Q,10)+"&sessionState="+mstrApp.sessionState,R=this.imgNode;if(R.src!==S){R.src=S;}},resize:function(){M(this);},resizeForDisplayState:function E(R,Q,U){var T=this.getFormats(),S=this.imgNode;if(U){var P=this.domNode.style;P.top=T.top;P.left=T.left;P.height=T.height;P.width=T.width;}if(S){S.style.height=R+"px";}if(!this.eg){this.retrieveGraphSrc(R,Q);if(R){this.refreshMap();}}}});function H(P){if(P&&P.getAttribute){var Q=P.getAttribute("coords");Q=Q&&Q.split(",");if(Q&&Q.length>=3){return Q[2]-Q[0];}}return 0;}function C(R){var Q=[],V=document.body.offsetWidth,P=document.body.offsetHeight,W=0,T=0,Y=K[0]&&K[0].domNode?K[0].domNode.offsetLeft:0,X=K[0]&&K[0].domNode?K[0].domNode.offsetTop:0,b=Math.ceil(K.length/2),S=5,a=function(g,f){if(g+R+f+S>V){return V-R-f-S;}else{if(K.length>1&&g-f-S<0){return f+S;}}return g;},Z=function(i,g,f){i+=g;var h=f==1?g:(f*g+(f-1)*S)/2;if(h>i){return 0;}else{if(h+i>P){return P-h*2;}else{return i-h;}}};for(var U=0;U<K.length;++U){W=Math.max(W,K[U].containerNode.offsetWidth);T=Math.max(T,K[U].containerNode.offsetHeight);}Y=a(Y,W);X=Z(X,T,b);for(var U=0;U<K.length;++U){if(U%2==0){Q.push({l:Y+R+S,t:X});}else{Q.push({l:Y-K[U].containerNode.offsetWidth-S,t:X});X+=T+S;}}return Q;}var K=[];mstrmojo.DocXtabGraph.multiTooltip={_posMultiTp:function(Q){for(var P=0;P<K.length;++P){K[P].domNode.style.left=Q[P].l+"px";K[P].domNode.style.top=Q[P].t+"px";}},open:function(Y,V,U,Q,P){if(!P){P={};}P.e=V;P.win=U;var S=0;if(Q&&Q.length){S=H(Q[0]);}for(var R=0;R<Q.length;++R){var X=K[R];if(!X||!mstrmojo.all[X.id]){X=new mstrmojo.Tooltip();var T=0,W=this;X.optimizePos=function(){T++;if(T>=K.length){T=0;W._posMultiTp(C(S));}};K.push(X);}Y.richTooltip.content=Q[R]&&Q[R].getAttribute("ttl");X.open(Y,P);}},close:function(){for(var P=K.length-1;P>=0;--P){K[P].close();}K=[];}};}());(function(){mstrmojo.requiresCls("mstrmojo.SliderBox","mstrmojo._IsInputControl","mstrmojo.Box");var C=mstrmojo.css,B=mstrmojo.dom,A=1;mstrmojo.SliderDIC=mstrmojo.declare(mstrmojo.SliderBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.SliderDIC",popupStyle:1,tabIndex:0,init:function(D){if(this._super){this._super(D);}this.cssClass=this.showByDefault?"mstrmojo-SliderGroup":"mstrmojo-PopupSlider";this.items=this.getItems();if(this.dic.ipt!==A){this.isSequential=true;this.max=this.dic.max;this.min=this.dic.min;this.interval=this.dic.itv;}},focus:function(){if(mstrmojo.dom.isIE){var D=this;setTimeout(function(){D.domNode.focus();},10);}else{this.domNode.focus();}},preBuildRendering:function(){this._super();var G=this.dic,D=(G.ldw!=null)?G.ldw/100:0.4,E,F=this.openerStyle;if(this.showByDefault){E=F.iw*(1-D)-F.rp-3;this.alignSlider(this.openerNode,F.ih);}else{E=G.w;}this.sliderBar.set("width",E);this.valueText=this.showByDefault?this.dv:this.value;if(!this.showByDefault&&this.unset&&this.isSequential){this.valueText+=" "+mstrmojo.desc(8316,"(out of range)");}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var H=this.dic,F=this.value,D=(H.ldw!=null)?H.ldw:40,G=this.openerStyle,E=G.ih;this.domNode.style.width=G.iw+"px";this.domNode.style.height=G.ih+"px";this.valuePartNode.style.width=this.sliderPartNode.style.left=D+"%";if(this.isSequential){this.sliderBar.set("title",mstrmojo.desc(5441,"Minimum value")+": "+this.min+"   "+mstrmojo.desc(5442,"Maximum value")+": "+this.max);}}}});})();(function(){function G(N,O){var I,L,H,J=[],K,P;try{K=new RegExp(N,"i");}catch(M){return J;}for(I=0,L=O.length;I<L;I++){H=O[I].n;K.lastIndex=0;if(K.test(H)){J.push(O[I]);}}return J;}function E(H){if(this.searchEnabled){this.iconNode.style.display="none";this.inputBar.style.display="";if(H){this.inputNode.focus();this.inputNode.select();}}else{this.hideInputNode();if(H){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var I=this;window.setTimeout(function(){try{I.iconNode.focus();}catch(J){}},100);}else{this.iconNode.focus();}}}}var A={8:"BackSpace",9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchableDropDownList=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearableDropDownList",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" mstrAttach:keyup,blur/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupSlots,{inputBar:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.firstChild.lastChild.rows[0].cells[0].firstChild;}}),markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.iconNode.innerHTML=this.text;this.inputNode.value=this.text;},onheightChange:function(){var H=parseInt(this.height,10);if(H>=0){this.domNode.style.height=H+"px";this.inputBar.style.height=H+"px";}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),popupToBody:true,searchEnabled:false,selectedIndex:-1,prevalueChange:mstrmojo.emptyFn,allItems:null,focus:function(){E.call(this,true);},hideInputNode:function B(){this.inputBar.style.display="none";this.iconNode.style.display="block";},postBuildRendering:function D(){if(!this.allItems){this.allItems=this.items;}this._super();E.call(this);},onkeyup:function F(P){var I=this.getSearchPattern(),N=[],K,O=this.inputNode,M=P.e,H,J,L=this.items.length;if(A[M.keyCode]==="Enter"){if(this.items.length>0){this.set("selectedIndex",this.selectedIndex===-1?0:this.selectedIndex);}this.onEnter&&this.onEnter();this.closePopup();return ;}else{if(A[M.keyCode]==="Esc"){this.onEsc&&this.onEsc();if(this.popupRef.visible){this.popupRef.close();}return ;}else{if(A[M.keyCode]==="ArrowDown"){if(!this.popupRef.visible){this.togglePopup();}this.set("selectedIndex",(this.selectedIndex+1)%L);}else{if(A[M.keyCode]==="ArrowUp"){if(this.popupRef.visible&&L>0){this.set("selectedIndex",(this.selectedIndex+L-1)%L);}}else{if(this.searchEnabled){if(I&&I.length>0&&I.indexOf(this.lastSearchPattern)>-1){N=G(I,this.items);}else{N=G(I,this.allItems);}this.set("selectedIndex",-1);this.set("items",N);L=N.length;if(L===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}if(I&&I.length>0){this.set("selectedIndex",mstrmojo.array.find(N,this.itemIdField,O.value));}}}}}}this.lastSearchPattern=I;},getSearchPattern:function C(){return mstrmojo.string.trim(this.inputNode.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.css","mstrmojo.Pulldown","mstrmojo.ProgressBar");var E=mstrmojo.dom,G=mstrmojo.css,H="disabled";function D(){var O=this.selected;if(O===this.panels.length-1){G.addClass(this.nextBtnNode,H);}else{G.removeClass(this.nextBtnNode,H);}if(O===0){G.addClass(this.prevBtnNode,H);}else{G.removeClass(this.prevBtnNode,H);}}mstrmojo.PageNavigationPanel=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.PageNavigationPanel",markupString:'<div class="mstrmojo-PageNavPanel {@cssClass}" style="{@cssText}" mstrAttach:click><div class="header"><div class="titles"><div class="title">{@title}</div><div class="subtitle">{@subtitle}</div></div><div class="progress"></div><div class="navigation"></div></div><div class="content"></div><div class="footer"><div class="prev"><div class="btn" btnv="pre">{@prevText}</div></div><div class="pges"></div><div class="next"><div class="btn" btnv="nxt">{@nextText}</div></div></div></div>',markupSlots:{headerNode:function(){return this.domNode.firstChild;},progressBarNode:function(){return this.domNode.firstChild.childNodes[1];},navigationNode:function(){return this.domNode.firstChild.childNodes[2];},containerNode:function(){return this.domNode.childNodes[1];},footerNode:function(){return this.domNode.lastChild;},prevBtnNode:function(){return this.domNode.lastChild.firstChild;},pagesNode:function(){return this.domNode.lastChild.childNodes[1];},nextBtnNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{onsubtitleChange:function(){this.headerNode.firstChild.lastChild.innerHTML=this.subtitle||"";},onheaderVisibleChange:function(){this.headerNode.style.display=this.headerVisible?"":"none";},ontitleVisibleChange:function(){this.headerNode.firstChild.style.display=this.titleVisible?"":"none";},onsubtitleVisibleChange:function(){this.headerNode.lastChild.style.display=this.subtitleVisible?"":"none";},onheightChange:function(){var P=this.headerHeight,O=this.footerHeight;if(this.height){if(!P||!O){P=this.headerHeight=this.headerNode.offsetHeight||0;O=this.headerHeight=this.footerNode.offsetHeight||0;}this.containerNode.style.height=(parseInt(this.height,10)-P-O)+"px";}}},title:"",subtitle:"",prevText:"Prev",nextText:"Next",selected:0,headerVisible:true,titleVisible:true,subtitleVisible:true,panels:null,renderedPanels:0,init:function M(O){this.panels=[];this._super(O);},onselectedChange:function F(){var Q=this.selected,O=this._lastSelected,R=this.panels[Q],P=this.panels[O];if(P){P.set("visible",false);}if(R){R.set("visible",true);}this.set("subtitle",R.title);this._lastSelected=this.selected;D.call(this);if(this.navlst){this.navlst.set("value",Q);}this.updatePageNode();},onrenderedPanelsChange:function I(){var O=this.panels.length,P=this.renderedPanels;if(O>0){this.updateProgressNode(Math.floor(100*P/O));}else{this.updateProgressNode(0);}},updateProgressNode:function C(O){if(this.prgbar){this.prgbar.updateProgress(O,O+"% completed");}},updatePageNode:function B(){this.pagesNode.innerHTML=(this.selected+1)+"/"+this.panels.length;},showNextPanel:function N(){var O=this.selected,P=this.panels[O];if(!P.viewed){P.viewed=true;this.set("renderedPanels",this.renderedPanels+1);}this.set("selected",O+1);},showPreviousPanel:function K(){this.set("selected",this.selected-1);},preBuildRendering:function J(){var P,O,U=this.panels||[],T=[],S=0,Q=this;if(U.length>0){for(P=0,O=U.length;P<O;P++){if(P!==this.selected){U[P].visible=false;}else{S=P;}T.push({n:U[P].title,v:P,css:(S===P)?"enabled":"disabled"});}this.set("children",[{scriptClass:"mstrmojo.ProgressBar",alias:"prgbar",slot:"progressBarNode"},{scriptClass:"mstrmojo.Pulldown",alias:"navlst",slot:"navigationNode",items:T,itemIdField:"v",defaultSelection:S,onvalueChange:function V(){Q.set("selected",this.value);this.items[this.value].css="enabled";},prevalueChange:function R(){if(this.value>Q.renderedPanels){this.value=Q._lastSelected;}}}].concat(U));this.set("subtitle",U[0].title);this._lastSelected=this.selected;}this._super();},postBuildRendering:function A(){this._super();this.updateProgressNode(0);this.updatePageNode();D.call(this);},onclick:function L(Q){var P=E.eventTarget(window,Q.e),O=P.getAttribute("btnv");if(O){if(O==="pre"&&this.selected>0){this.showPreviousPanel();}else{if(O==="nxt"&&this.selected<this.panels.length-1){this.showNextPanel();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.color");var C=[127,206,255];var D=[216,230,239];var B=function(H,K){if(!H||H=="transparent"){H="#FFFFFF";}var G=mstrmojo.color.hex2rgb(H),J,I,E;if(!K){J=Math.round((3/5)*parseInt(G[0])+110);I=Math.round((3/5)*parseInt(G[1])+110);E=Math.round((3/5)*parseInt(G[2])+110);}else{J=G[0]*K[0]/255;I=G[1]*K[1]/255;E=G[2]*K[2]/255;var F=G[0]*0.3+G[1]*0.59+G[2]*0.11;if(F<85){J=J+(63*((85-F)/85));if(J>255){J=255;}I=I+(63*((85-F)/85));if(I>255){I=255;}E=E+(96*((85-F)/85));if(E>255){E=255;}}}return"#"+mstrmojo.color.rgb2hex(J,I,E);};var A=function(F,G,E){if(F&&F.style){F.style.backgroundColor=G["bg"+E+"Color"]||"";F.style.color=G["text"+E+"Color"]||"";}};mstrmojo.LinkItemRenderer=mstrmojo.hash.copy({render:function(G,E,H){var F=G.v!="u;"?" nAll":"";return'<input mstridx="'+E+'" class="'+H.itemCssClass+(H.selectedIndices[E]?" "+H.itemSelectedCssClass:"")+F+'" style="'+H.itemCssText+" color:"+(H.selectedIndices[E]?H.textSelectedColor:H.textNormalColor)+"; background-color:"+(H.selectedIndices[E]?H.bgSelectedColor:H.bgNormalColor)+';" type="button"  value="'+G[H.itemDisplayField]+'"  onmouseover="mstrmojo.all.'+H.id+".onmouseover(self, "+E+')" onmouseout="mstrmojo.all.'+H.id+".onmouseout(self, "+E+')"/>';},select:function(F,G,E,H){F.className+=" selected";A(F,H,"Selected");},unselect:function(F,G,E,H){F.className=F.className.replace(/selected/g,"");A(F,H,"Normal");},highlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Highlighted";A(G,I,F);},unhighlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Normal";A(G,I,F);}},mstrmojo.hash.copy(mstrmojo.DivItemRenderer));mstrmojo._RendersItemLinks=mstrmojo.hash.copy({onmouseover:function(G,E){if(!E||isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.highlight(F,this.items[E],E,this);},onmouseout:function(G,E){if(!E||isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.unhighlight(F,this.items[E],E,this);},preBuildRendering:function(){this.bgNormalColor=this["background-color"]||this.parent&&this.parent["background-color"];this.bgSelectedColor=this.parent&&this.parent.defn&&this.parent.defn.ssc;if(this.bgSelectedColor!=null){this.bgHighlightedColor=B(this.bgSelectedColor);}else{this.bgSelectedColor=B(this.bgNormalColor,C);this.bgHighlightedColor=B(this.bgNormalColor,D);}this.textNormalColor=this.color;this.textSelectedColor=mstrmojo.color.getContrastingColor(this.bgSelectedColor,["#ffffff","#000000"]);this.textHighlightedColor=mstrmojo.color.getContrastingColor(this.bgHighlightedColor,["#ffffff","#000000"]);if(this._super){this._super();}}},mstrmojo.hash.copy(mstrmojo._RendersItemDivs));mstrmojo._RendersItemLinks.itemRenderer=mstrmojo.LinkItemRenderer;mstrmojo.requiresCls("mstrmojo.ListBox");mstrmojo.LinkList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkList",cssClass:"mstrmojo-LinkList",itemCssClass:"mstrmojo-LinkList-item",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.LinkListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkListHoriz",cssClass:"mstrmojo-LinkListHoriz",itemCssClass:"mstrmojo-LinkListHoriz-item",selectionPolicy:"toggle"});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz");var A={render:function(F,B,G){var H=(G.htmlName+B),D=G.selectedIndices[B]?"checked ":"",E=D?" selected":"",C=F.v!="u;"?" nAll":"";return'<div class="'+G.itemCssClass+E+C+'"><input type="'+G.inputType+'" name="'+G.htmlName+'" id="'+H+'" value="'+B+'" '+D+'/><label for="'+H+'" title="'+(F[G.itemTitleField]||"")+'" style="'+G.labelCssText+'">'+F[G.itemDisplayField||"n"]+"</label></div>";},select:function(D,E,B,F){var C=D&&D.firstChild;if(C&&!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);},unselect:function(D,E,B,F){var C=D&&D.firstChild;if(C&&C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);},rowHeight:23};mstrmojo._RendersInputItems={inputType:null,htmlName:null,itemRenderer:A,init:function(B){this._super(B);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(E){var D=E.hWin,G=E.e,F=mstrmojo.dom.eventTarget(D,G);if(F&&F.nodeName.match(/input/i)){var C=parseInt(F.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(C);}else{var B=(F.checked)?"add":"remove";this[B+"Select"](C);}}}};mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});})();(function(){mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(C,A,D){var B=C.v!="u;"?" nAll":"";return'<input mstridx="'+A+'" class="'+D.itemCssClass+(D.selectedIndices[A]?" "+D.itemSelectedCssClass:"")+B+'" style="'+D.itemCssText+'" type="button"  value="'+C[D.itemDisplayField]+'" />';};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.requiresCls("mstrmojo.ListBox");mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ListSelectorItemRenderer=A.clone(mstrmojo.DivItemRenderer);mstrmojo.ListSelectorItemRenderer.render=function(D,B,E){var C=D.v!="u;"?" nAll":"";return'<div mstridx="'+B+'" class="'+E.itemCssClass+(E.selectedIndices[B]?" "+E.itemSelectedCssClass:"")+C+'" style="'+E.itemCssText+'">'+(E.getItemName?E.getItemName(D,B):(E.itemDisplayField&&D[E.itemDisplayField]))+"</div>";};mstrmojo.ListBoxSelector=mstrmojo.declare(mstrmojo.ListBox,null,{itemRenderer:mstrmojo.ListSelectorItemRenderer});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.CheckBoxDIC");var B=mstrmojo.css,A=mstrmojo.dom;mstrmojo.MarkRowDIC=mstrmojo.declare(mstrmojo.CheckBoxDIC,null,{scriptClass:"mstrmojo.MarkRowDIC",cssClass:"mstrmojo-MarkRowDIC",onclick:function(){if(this.grayed){this.set("grayed",false);}this.set("checked",!this.checked);var E=this.group&&this.group.widgetsMap,D,C;if(this.markAll){for(D in E){if(E.hasOwnProperty(D)){C=E[D];if(C.checked!==this.checked){C.set("checked",this.checked);}}}}else{for(D in E){C=E[D];if(C.markAll&&C.checked!==this.checked){C.set("grayed",true);break;}}}},postBuildRendering:function(){if(this._super){this._super();}var C=this.openerNode;if(!this.markAll){A.attachEvent(this.domNode,"mouseover",function(D){B.addClass(C.parentNode,"markSelection");});A.attachEvent(this.domNode,"mouseout",function(D){B.removeClass(C.parentNode,"markSelection");});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo.dom");var Q=1;var W=2;var X=0;var A=1;var AC=2;var M=3;var L=1;var AE=2;var G=4;var h=8;var b=mstrmojo.dom,t;function AI(AJ){var AK=null;if(AJ&&AJ.length>1){AK=new mstrmojo.XtabVACP();AK.cps=AJ;}return AK;}function P(AK){var AJ=document.createElement("img");AK.appendChild(AJ);AK.removeChild(AJ);}function I(AK,AJ){if(b.isIE){return mstrmojo.boxmodel.convert2px(AK,AJ);}return AJ;}function H(AK){if(!AK||this._onDemandCP){return ;}var AR=AK.bc,AP=AK.tc,AL=AP-AR,AQ=Math.ceil(AL/AR),AM=[],AO=[],AN;for(AN=0;AN<AQ;++AN){var AJ=Math.min(AL,AR);AM.push(this.createOnDemandCP(AN+1,AJ,G));AO.push(this.createOnDemandCP(AN+1,AJ,h));AL-=AR;}this._onDemandCP={rhs:AM,vls:AO};return this._onDemandCP;}mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasScrollbox,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",handleClicks:function F(){return true;},markupString:'<div id="{@id}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div>&nbsp;</div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart><table cellspacing="0" cellpadding="0"><tr trType="title"><td style="vertical-align:top;padding:0px"></td><td class="xtab-tr" style="vertical-align:top;padding:0px;"></td></tr><tr trType="content"><td class="xtab-bl" style="vertical-align:top;padding:0px;"></td><td class="xtab-br" style="vertical-align:top;padding:0px"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_TL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];},_TR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[1];},_BL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[0];},_BR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_T_ROW:function(){return this.domNode.lastChild.firstChild.rows[0];},_B_ROW:function(){return this.domNode.lastChild.firstChild.rows[1];},_BR_CELL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1];},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.firstChild.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zones:null,lockHeadersCase:M,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function p(AJ){return(AJ.o!==undefined)?AJ.o:AJ._ei;},getCellTitleId:function f(AJ){var AK="";if(AJ.axis&&AJ.ui!==undefined){AK=AJ.axis+"A"+(AJ.ui+1);}else{if(AJ.mix!==undefined){AK="0A"+AJ.mix;}}return AK;},update:function l(AK){if(this._super){this._super(AK);}this.set("gridData",AK.data[0]||AK.data);var AJ=this.defn||AK.defn;this.sid=this.gridData.sid;this.treeType=(AJ&&AJ.tt)||1;this.interactiveCellsArray=[];},initCP:function D(AL,AK,AQ,AN,AP,AM,AO){var AJ={gridData:AL,type:AQ,interactiveCellsArray:AK};AJ.base=AN||AJ.base;AJ.lookupBase=AP||AJ.lookupBase;AJ.axis=AM||AJ.axis;if(!AO){if(AQ===L){AO=new mstrmojo.XtabTitlesCP(AJ);}else{AO=new mstrmojo.XtabCP(AJ);}}else{mstrmojo.hash.copy(AJ,AO);}return AO;},preBuildRendering:function B(){var AJ=this.gridData;this.lockHeadersCase=parseInt(AJ.lhv,10);this.selections={};this.cssDefault=(this.lockHeadersCase===X||!this.k)?"":"r-cssDefault"+(this.k?"_"+this.k:"");this.numRowFixed=!!(!this.height&&AJ.rw&&AJ.rw.row&&(AJ.rw.row.bc<AJ.rw.row.tc));this.rw=AJ.rw;this._onDemandCP=null;if(this.width){this.widthLimit=parseInt(this.width,10);}if(this.height){this.heightLimit=parseInt(this.height,10);}return(this._super)?this._super():true;},renderEmptyGrid:function w(){var AL=this.gridData,AK=this.msgNode,AJ=this.viewport;AK.firstChild.innerHTML=AL.eg;AK.style.display="block";AK.style.overflow="hidden";AK.className="mstrmojo-message";AJ.style.display="none";return(this._super)?this._super():true;},postBuildRendering:function q(){var AR=this.gridData,AN=!!this._BR&&AR,AJ=this.msgNode,AO=this.viewport,AP;if(AR.eg===undefined){if(AJ.style.display==="block"){AJ.style.display="none";AO.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AN){this._setupZones(AR);this._setupCPs(AR);var AM=this.zones,AK;for(AK in AM){var AQ=AM[AK];if(AQ.parent!==this){this.addChildren(this.zones[AK]);}}if(this.scrollboxNode){var AL=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AL)&&(AL>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AL;}this.scrollboxLeft=this.scrollboxTop=0;if(this.lockHeadersCase){this.connectScrollbox(this);}}}this.renderChildren();AP=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zones._BR.getPageHeight(0)+(this._TR?this._TR.offsetHeight:0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if((this.lockHeadersCase&&AN&&this.scrollboxNode)||this.numRowFixed){this.resizeScrollBox(b.isIE);}this.onGridWidthChanged(true);if(b.isIE7&&!this.scrollboxHeightFixed&&this.scrollboxNode&&this.scrollboxNode.scrollWidth>this.scrollboxNode.offsetWidth){this.scrollboxNode.style.height=this.scrollboxNode.offsetHeight+17+"px";}return AP;},onclick:function s(AN,AK){if(!this.interactiveCellsArray.length){this.isSelectingText=false;return ;}AN=AN.e||AN;var AL=mstrmojo.dom,AO=AL.eventTarget(AK,AN),AM=AO&&AL.findAncestorByName(AO,"td",true,this.viewport);if(AO.nodeName.toLowerCase()==="a"&&AM.getAttribute("ei")){try{var AP=this.interactiveCellsArray[parseInt(AM.getAttribute("ei"),10)];var AJ=7;if(AP&&AP.ts===AJ){AO.href=mstrmojo.addCSRFTokenToURL(AO.href);}}catch(AR){}}if(AM){var AQ=AL.findAncestorByName(AO,"span",true,AM);if(AQ&&!AL.shiftKey(AK,AN)&&!AL.ctrlKey(AK,AN)){this.defaultAction(AM);}else{this.doSelection(AN,AK,AM);if(!this.isSelectingText){AL.clearBrowserHighlights();}}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function i(AK,AJ){this.onclick(AK,AJ);},onselectstart:function x(){this.isSelectingText=true;return false;},onscroll:function z(){this._alignHeaders();},resizeScrollBox:function J(AL){var AJ=this.scrollboxNode,AU=AJ&&AJ.style,Aa=this._B_ROW,AZ=this._BR_CELL;if(!AU||!Aa||!AZ){return ;}var AT=this.widthLimit,AS=this.heightLimit;if(!AT||!AS){if(!AT){AU.width="auto";}if(!AS){AU.height="auto";this.scrollboxHeightFixed=false;}}if(AS){var AR=(this.zones._TR&&this.zones._TR.cp.rc)?Aa.offsetTop:0,AW=AS-AR;if(AW>0){AU.height=AW+"px";this.scrollboxHeight=AW;this.scrollboxHeightFixed=true;if((this.lockHeadersCase!==X)&&this.numRowFixed){this.viewport.style.height=this.overlayNode.style.height=(AW+AR)+"px";}}}if(!this.useTouchScrolling){var AK=(this.zones._BL&&this.zones._BL.cp.rc)?AZ.offsetLeft:0;var AY=0;if(this.lockHeadersCase!==X){var AX=this.viewport,AM=mstrmojo.css.getComputedStyle(AX),AV=["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"];if(AM){mstrmojo.array.forEach(AV,function(Ab){AY+=parseFloat(I(AX,AM[Ab]));});}if(this.width){this.viewport.style.width=(parseFloat(this.width)-(AY||0))+"px";}}var AN=(this.widthLimit&&(this.widthLimit-AK))||(mstrmojo.dom.isIE7?AZ.scrollWidth+1:(AZ.scrollWidth+(AJ.offsetWidth-AJ.clientWidth)));if(AN&&(AN>0)){AN-=AY;AU.width=AN+"px";}this._alignHeaders(AL);}var AQ=AU.height,AP=AU.width;if(AQ||AP){var AO=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection);if(AO){AO.fixedSizeCanGrowShrink(this,AQ,AP);}}},_resizeScrollBoxWidth:function U(){var AO=this.scrollboxNode,AL=AO&&AO.style,AK=this._B_ROW,AJ=this._BR_CELL;if(this.useTouchScrolling||!AL||!AK||!AJ){return ;}var AM=this.widthLimit;if(!AM){AL.width="auto";}var AN=function(){var AP=(mstrmojo.dom.isIE7?AJ.scrollWidth+1:(AJ.scrollWidth+(AO.offsetWidth-AO.clientWidth)));if((AP&&(AP>0))&&(!AM||(AM&&(AP<AM)))&&(AO.firstChild.firstChild.offsetWidth>=AO.clientWidth)){AL.width=AP+"px";}};if(mstrmojo.dom.isIE7){window.setTimeout(function(){AN();},1);}else{AN();}},onGridWidthChanged:function Z(AL){if(this.lockHeadersCase===X&&!AL){this._resizeScrollBoxWidth();}var AK=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AJ=this.widthLimit;if(!AJ){this.width=t;if(AK){AK.performCanGrowCanShrink([this],true);}}else{if(AK){AK.fixedSizeCanGrowShrink(this,null,AJ);}}},getGridDimension:function R(AM){var AK=1,AL=AM===AK?"Height":"Width",AN=AL.toLowerCase(),AJ=this[AN+"Limit"];if(!AJ&&(this[AN]===t||this[AN]===0)){AJ=this.viewport["offset"+AL];this[AN]=AJ+"px";return AJ;}return AJ||parseInt(this[AN],10);},_alignHeaders:function o(AK){if(this.lockHeadersCase===X||this.useTouchScrolling){return ;}var AN=this.scrollboxLeft,AM=this.scrollboxTop,AL=this.zones,AJ=AL._TR,AO=AL._BL;function AP(AQ,AU,AR){var AT=AQ&&AQ.domNode,AS=AT&&AT.style;if(!AS){return ;}AS[AU]=-AR+"px";}if(AJ&&AJ.rc){AP(AJ,"left",AN);}if(AO&&AO.rc){AP(AO,"top",AM);}if(AK){P(this._BL);}},defaultAction:function S(AO,AK){var AJ=AK||this.getCellForNode(AO),AN=AO&&AO.className.indexOf("sc_")>0,AM=this.model.getAction(this.getActionCells(AJ),AO,AN),AL=AM&&AM.h;this._currentSelectedTD=AO;if(AL&&this.controller[AL]){this.controller[AL](this,AM.a);return true;}return false;},createZone:function n(AJ){return new mstrmojo.XtabZone(AJ||{});},_setupZones:function k(AM){var AK=this.zones;this.zones={};var AO=this.zones,AJ=this.lockHeadersCase,AQ="z-index:";var AL=this;function AP(AU,AT,AV,AS){var AR=(AS&&AS[AV])||AL.createZone({renderMode:AU,cssText:AT,slot:AV});AO[AV]=AR;AR.rh=AM.rh;}AP(this.dataRenderMode,AQ+"1;","_BR",AK);if(AJ&A){AP(this.dataRenderMode,AQ+"3;","_BL",AK);}if(AJ&AC){AP(null,AQ+"3;","_TR",AK);}if(AJ===M){AP(null,AQ+"4;","_TL",AK);}if(AJ===X){this.zones._BR.autoFitWindow=!!AM.afw;this.zones._BR.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}if(mstrmojo.dom.isIE7){if(AJ&A||AJ&AC||AJ===M){this._T_ROW.style.display="block";}else{if(AJ===X){this._T_ROW.style.display="none";}}}var AN=AO._BL||AO._BR;if(AN){AN.numColumnCanMerge=AM.gts.cws.length-1;}},getHACP:function AH(){return(this._super&&this._super())||new mstrmojo.XtabHACP();},_setupCPs:function V(AR){var AM=this.titlesCP=this.getTitleCP(AR),AO=this.chsCP=this.getColumnHeadersCP(AR),AK=this.rhsCP=this.getRowHeadersCP(AR),AL=this.valuesCP=this.getValuesCP(AR);AM.forceAutoRowHeight=AO.forceAutoRowHeight=AR.rh;var AP=this.zones;switch(this.lockHeadersCase){case X:var AV=new mstrmojo.XtabVACP();var AJ=this.getHACP();AJ.cps=[AM,AO];AV.cps=[AJ];var AT=this.getHACP();AT.cps=[AK,AL];AV.cps.push(AT);AP._BR.cp=AV;break;case A:var AS=new mstrmojo.XtabVACP();var AN=new mstrmojo.XtabVACP();AS.cps=[AM,AK];AN.cps=[AO,AL];AP._BL.cp=AS;AP._BR.cp=AN;break;case AC:var AQ=this.getHACP();var AU=this.getHACP();AQ.cps=[AM,AO];AU.cps=[AK,AL];AP._TR.cp=AQ;AP._BR.cp=AU;break;case M:AP._TL.cp=AM;AP._TR.cp=AO;AP._BL.cp=AK;AP._BR.cp=AL;break;}},ongridDataChange:function Y(){var AJ=this.model;if(AJ){AJ.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:mstrmojo.emptyFn,getTitleCP:function E(AJ){return this.initCP(AJ,this.interactiveCellsArray,L);},getColumnHeadersCP:function AD(AJ){return this.initCP(AJ,this.interactiveCellsArray,AE,AJ.ghs.chs,AJ.gts.col,W);},getRowHeadersCP:function AF(AJ){var AK=this.initCP(AJ,this.interactiveCellsArray,G,AJ.ghs.rhs,AJ.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AK].concat(this._onDemandCP.rhs);return AI(this.rhsCPList)||AK;}return AK;},getValuesCP:function a(AK){var AJ=this.initCP(AK,this.interactiveCellsArray,h,AK.gvs);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AJ].concat(this._onDemandCP.vls);return AI(this.valuesCPList)||AJ;}return AJ;},createOnDemandCP:function g(AK,AL,AJ){var AM=new mstrmojo.XtabOnDemandCP();AM.dataSource=this;AM.blockNum=AK;AM.rc=AL;return AM;},dataDownloaded:function T(AL,AO){var AQ=AO.blockNum,AJ=this.rhsCPList[AQ],AM=this.valuesCPList[AQ],AP=AL.data;AP._bidx=AQ;this.dataBlocks[AQ]=AP;if(!AJ||!AM){return ;}this.initCP(AP,this.interactiveCellsArray,G,AP.ghs.rhs,AP.gts.row,Q,AJ);this.initCP(AP,this.interactiveCellsArray,h,AP.gvs,null,null,AM);AJ.initContent();AM.initContent();this.numRowsDownloaded+=parseInt(AJ.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AN=this.zones,AK=AN&&AN._BL,AR=AN&&AN._BR;if(AK){AK.dataDownloaded();}if(AR){AR.dataDownloaded();}},showDownloadStatus:function O(AJ){if(!AJ){return ;}if(this.showingStatus){this.numRowsToDownload+=AJ;}else{this.numRowsToDownload=AJ;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function j(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function K(AL){var AN=this.gridData.rw,AK=AN.row,AM=AN.col,AJ=AK.bc;this.rhsCPList[AL].isDownloading=this.valuesCPList[AL].isDownloading=true;if(AJ){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AL*AJ+1,AJ,AM.bb,AM.bc,this.id,{blockNum:AL}));}},unrender:function C(AJ){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AJ);},getCellForNode:function AB(AL){var AJ=AL&&AL.getAttribute("ei");if(isNaN(AJ)){return null;}var AK=this.interactiveCellsArray[parseInt(AJ,10)];return AK;},getActionCells:function N(AJ){var AK=[],AM=this.selections;var AN=AJ.axis+"A"+(AJ.ui+1),AO=AM[AN],AL;if(AO&&AO[AJ.o]){for(AL in AO){var AP=this.getCellForNode(AO[AL][0]);AK.push(AP);}}else{AK.push(AJ);}return AK;},setModel:function AG(AJ){this.model=AJ;if(AJ.data){this.set("gridData",AJ.data);}},destroy:function AA(){var AJ=this.model;if(AJ&&AJ.destroy){AJ.destroy();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.XtabZone","mstrmojo.DICFactory","mstrmojo.DynamicClassFactory");var AI=102,Q=1,J=2,o=mstrmojo.css,n=mstrmojo.dom,j=mstrmojo.hash,f=mstrmojo.DynamicClassFactory.newComponent,K=1,AK=2,H=4,g=2,V=1,B=2,AG=1,G=2,x=1,t=2,b=2,k=1,I=function(AN){if(AN){return AN.tui>=0?("h_"+AN.tui+"_"+AN.fi+"_"+AN.axis):("m_"+AN.mix);}return"";};function w(AT,AP,AQ){var AS=this.nm[AP],AO=AQ.v,AR=AQ.dv;AT.rv=AO;AT.v=AR;AT.mdf=1;if(AT._src){AT._src.rv=AO;AT._src.v=AR;AT._src.mdf=1;}var AN=this.dicGroupMap[I(AT)].widgetsMap[AT._ei];if(!AN.showByDefault){if(AN.hasPreview){AN.renderPreview();}else{if(n.isIE7&&mstrmojo.string.isEmpty(AO)){AO=" ";}AS[AS.innerText!==undefined?"innerText":"textContent"]=AO;}}return AS;}function Y(AQ,AR,AN){if(AN[AR]===0){return true;}if(AQ&&AN[AR]===undefined){try{var AO=AQ.getRowCells(AR),AS=AO&&AO[0];if(AS&&AS.o===AR){if(AS.sst){AN[AR]=0;}return !!AS.stt;}if(AS&&AS.o){return Y(AQ,AR+AR-AS.o,AN);}return false;}catch(AP){return false;}}else{return false;}}function L(AO,AN){mstrmojo.array.forEach(AO,function(AP){AN[AP.o]=1;});}function AJ(AN){if(AN.mgh&&(AN.mgh&Q)){this.mghMarks={};}}function z(AP,AR){var AO=AR.bb-1,AN=Math.min(AO+AR.bc,AR.tc),AQ;j.forEach(AP,function(AT,AS){AQ=Number(AS);if(AQ!==NaN&&AQ>=AO&&AQ<AN){delete AP[AS];}});}function AD(AQ,AP){var AN=this.editing?1:(AQ.rs||1),AO;for(AO=0;AO<AN;AO++){this.dirtyRows[AP+AO]=1;}}function AM(AN){return AN&&parseInt(AN.ipt,10)===b;}function AH(AN){var AP=this.zones._BR,AO=this.zones._BL;if(!AO){return AP.getRowIdxByCell(AN);}else{if(AP.posMap&&AP.posMap[AN._ei]){return AP.getRowIdxByCell(AN);}else{return AO.getRowIdxByCell(AN);}}}mstrmojo._IsEditableGridCP={_mixinName:"mstrmojo._IsEditableGridCP",initContent:function AE(AQ){this._super(AQ);var AW=this.gridData,AO=AW&&AW.vp,AU,AT,AV,AY,AN,AX,AP,AS;if(((this.type===K)||(this.type===H))&&AO&&AO.cols&&!AO._adjusted){AN=AO.cols.cg;AP=AO.cols.cws;if(AN&&AN.cgc>0){for(AU=AN.cgc;AU>0;AU--){AN[AU]=j.copy(AN[AU-1],{});AX=AN[AU];var AR=AX.attForms;if(AR){for(AT=0,AY=AR.length;AT<AY;AT++){AV=AR[AT];AV.idx+=1;}}}AN[0]={tg:false,cc:0,cl:1,attForms:[{n:"",idx:0}]};AN.cgc+=1;}if(AP){AP.splice(0,0,{w:"60px",xc:true});}if(AO.dafIdx!==undefined){AO.dafIdx+=1;}AS=AW.gts.row;for(AU=0,AY=AS.length;AU<AY;AU++){AS[AU].ci=AU+1;}AO._adjusted=true;}this.colWidths=[{w:""}].concat(this.colWidths);this.unmergedCells=[];},getUnmergedCells:function Z(){return null;},getRowCells:function AB(AX){var AP=this._super(AX),AN=AP[0],Ab=(AN&&AN.o)||0,AY=(this.tp===K),AS=this.interactiveCellsArray,Aa={css:"",v:""},Ae=[],AO=[],Af,Ag;if(!AY){var AU=this.base.items,Ad=this.lookupBase,Ac=this.gridData.css,Aj=AN&&AN.pi,AZ=Aj&&Aj.ri,Ai=Aj&&Aj.ci,AV=AN.stt>0;while(Aj&&AZ>-1&&Ai>-1){AN=AN._p||AU[AZ].items[Ai];var AQ=j.copy(AN,{});AQ._src=AN;if(!AQ.css){AQ.css=Ac[AQ.cni].n;}var AW=Ad[AN.tui],Ah=AW&&AW.es[AN.idx];if(Ah){AQ.v=AN.v||Ah.n;AQ._e=Ah;}AQ.rs=1;if(AV){AQ.at&=~32;}if(Ab>-1){AQ.o=Ab;}if(!AQ.axis&&this.axis){AQ.axis=this.axis;}AQ._ei=AS.push(AQ)-1;Ae.splice(0,0,AQ);Aj=AN&&AN.pi;AZ=Aj&&Aj.ri;Ai=Aj&&Aj.ci;}for(Af=0,Ag=AP.length;Af<Ag;Af++){var AR=AP[Af];if(AR.rs>1){var AT=j.copy(AR,{});AT.rs=1;AR=AT;}AO.push(AR);}}else{AO=AP;if(AX>0){return AP;}}if(AO[0]){Aa=j.copy(AO[0],{});Aa.rv=Aa.v="";if(this.tp===K){Aa.n=Aa.v="";Aa.markAll=true;}else{Aa.n="";}Aa._ei=AS.push(Aa)-1;Aa.at=32;Aa.cs=1;Aa.mark=true;Aa.mix="x";Aa.css=(Ae[0]&&Ae[0].css)||Aa.css;delete Aa.ui;delete Aa.tui;delete Aa.fs;delete Aa.mdf;}return[Aa].concat(Ae.concat(AO));}};mstrmojo._IsEditableXtab={_mixinName:"mstrmojo._IsEditableXtab",update:function AA(AP){var AN,AO=AP.data;if(this._super){this._super(AP);}this.kc={};this.rs={};this.rsDelta={};AJ.call(this,AO);if(AO.eg!==undefined){return ;}AN=AP.data.marked;if(AN){L(AN,this.rs);}if(!AO.rw){var AQ=AO.gvs.items.length;AO.rw={row:{bb:1,bc:AQ,tc:AQ},col:{bb:-1,bc:-1,tc:0}};}},initCP:function E(AP,AO,AU,AR,AT,AQ,AS){var AN={gridData:AP,type:AU,interactiveCellsArray:AO};AN.base=AR||AN.base;AN.lookupBase=AT||AN.lookupBase;AN.axis=AQ||AN.axis;AN.dataSource=this;if(!AS){if(this.tca===J&&this.editing){if(AU===K){mstrmojo.EditableXtabTitlesCP=f(mstrmojo.XtabTitlesCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabTitlesCP",tp:K});AS=new mstrmojo.EditableXtabTitlesCP(AN);}else{if(AU===H){mstrmojo.EditableXtabCP=f(mstrmojo.XtabCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabCP"});AS=new mstrmojo.EditableXtabCP(AN);}else{AS=new mstrmojo.XtabCP(AN);}}}else{if(AU===K){AS=new mstrmojo.XtabTitlesCP(AN);}else{AS=new mstrmojo.XtabCP(AN);}}}else{j.copy(AN,AS);}return AS;},createOnDemandCP:function p(AO,AP,AN){var AQ;if(this.tca===J&&this.editing&&AN===H){mstrmojo.EditableXtabOnDemandCP=f(mstrmojo.XtabOnDemandCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabOnDemandCP"});AQ=new mstrmojo.EditableXtabOnDemandCP();}else{AQ=new mstrmojo.XtabOnDemandCP();}AQ.dataSource=this;AQ.blockNum=AO;AQ.rc=AP;return AQ;},preBuildRendering:function C(){var AN=this.defn.txi;if(this._super){this._super();}this.txar=AN.txar;this.sci=AN.sci;this.tca=AN.tca;if(this.tca!==J){this.editing=false;}else{if(mstrApp.isMobile){this.editing=this.alwaysEditing=true;}}this.nm={};this.ko={};this.dirtyRows={};this.requiredCellsMap={};this.dicGroupMap={};this.lastIndex=0;this.lastHeaderIndex=0;this.columnNames={};},postBuildRendering:function X(){if(this._super){this._super();}if(this.tca===J&&this.gridData.eg===undefined){var AP=Math.max(-16,-this.domNode.offsetTop),AQ=this;if(!this.alwaysEditing){var AN=mstrmojo.Button.newIconButton(mstrmojo.desc(8324,"Mark rows"),"mstrmojo-EditButton",function(){if(!AQ.recalculating){AQ.editing=!AQ.editing;AQ.refresh();}}),AO=new mstrmojo.Button(mstrmojo.hash.copy({cssText:"top:"+AP+"px;"},AN));AO.render();this.domNode.appendChild(AO.domNode);if(this.editing){this.domNode.style.zIndex=1000;o.addClass(AO.domNode,"close");}else{o.removeClass(AO.domNode,"close");}}}},dataDownloadErr:function M(){if(this.txar&&this.recalculating){var AN=this.zones;if(AN._BL){AN._BL.isDownloading=false;}AN._BR.isDownloading=false;this.rhsCP.initContent();this.valuesCP.initContent();o.removeClass(this.maskNode,"wait");this.recalculating=false;}},dataDownloaded:function T(AR,AP){var AQ=AR.data;if(this.txar){var AN=AP.blockNum,AO=this.zones,AS;if(this.recalculating){AP.recalculating=true;this.interactiveCellsArray=[];this.requiredCellsMap={};this.dirtyRows={};this.lastIndex=0;this.lastHeaderIndex=0;this.kc={};this.nm={};this.updatedCellsMap={};this.recalculating=false;this.destroyDICs();}else{AP.recalculating=false;}if(AN===0){this.gridData=AQ;}if(AQ.eg){this.refresh();return ;}AS=this.interactiveCellsArray;this.initCP(AQ,AS,K,null,null,null,this.titlesCP);this.initCP(AQ,AS,AK,AQ.ghs.chs,AQ.gts.col,g,this.chsCP);this.titlesCP.initContent();this.chsCP.initContent();if(AS&&AS.length===0){if(AO._TR){AO._TR.refresh();}if(AO._TL){AO._TL.refresh();}}}if(this._super){this._super(AR,AP);}AJ.call(this,AQ);z(this.rs,AQ.rw.row);if(AQ.marked){L(AQ.marked,this.rs);this.rsDelta={};}},closeDownloadStatus:function W(){if(this._super){this._super();}mstrmojo.css.removeClass(this._STATUS,"recalculate");},kc:null,ko:null,nm:null,rs:null,dicGroupMap:null,lastIndex:0,lastHeaderIndex:0,columnNames:null,getDataInputInfo:function i(Ab,AZ){var AQ=Ab._ei,AO,AT=this.node.defn,AR=this.gridData;if(Ab.mark){AO=Ab.o;if(Ab.stt){this.rs[AO]=0;return ;}this.ko[AO]=AQ;Ab.rv=Ab.v=this.rs[AO]||-1;this.kc[AQ]={rowop:true};return{key:AQ,t:AI,vls:[{v:-1},{v:1}],wm:1,w:22,hm:1,h:16,dm:1};}var AP=this.model.getCellTitleInfo(Ab,this.dataBlocks[Ab._gd]),AY=AP&&AP.title,Aa=AY&&AY.es,AX=(Ab.mti!==undefined)?Ab.mti:Ab.mix,AN=(Ab.mix!==undefined),Ac=AT.txi.dic,AU;AU=!AN?Ac.att&&AY&&Ac.att[AY.id]&&Ac.att[AY.id][AY.fs[Ab.fi].id]:Ac.mtx&&Ac.mtx[Aa[AX].oid];if(!AU){return null;}if(this.columnNames[AZ]===undefined){this.columnNames[AZ]=!AN?AY.n:Aa[AX].n;}if(AM(AU)){AU.vls=(AR.dcv&&AR.dcv[AU.k])||[];}if(AQ>=0&&!this.kc[AQ]){var AV=!Ab.axis,Ad={isMv:AV};if(AV){var AS=Ab.pi,AW=AS&&AS.top;Ad.co=(AW&&AW.ci)||0;Ad.metric_id=Aa[AX].oid;Ab.o=Ad.o=(Ab._lp&&Ab._lp.o)||0;Ad.tp=B;}else{Ad.ax=Ab.axis;Ad.atid=AY.id;Ad.form_id=AY.fs[Ab.fi].id;Ad.o=Ab.o;Ad.tp=V;Ad.fi=Ab.fi;Ad.ui=Ab.ui;Ad.tui=Ab.tui;Ad.rs=Ab.rs;}Ad.dt=AU.dt;if(AM(AU)){Ad.vls=AU.vls;Ad.k=AU.k;}this.kc[AQ]=Ad;}AU.key=AQ;if(AU.dm){AU.dm=parseInt(AU.dm,10);}return AU;},isEditableHeader:function F(AN){var AO=this.node.defn,AP=AO.txi.dic;if(AN.sst||!AP){return false;}if(AN.id!==undefined&&AP.att){return !!(AP.att[AN.id]&&(AN.fix?AP.att[AN.id][AN.fid]:AP.att[AN.id]));}if(AN.tui!==undefined&&AN.mix!==undefined&&AP.mtx){return !!(AP.mtx[AN._e.oid]);}return false;},dataChanged:function P(AO,AP,AN,AQ){if(!this.recalculating){if(AQ){this.nm[AO]=AQ;}if(this._super){this._super(AO,AP,AN,AQ);}}},updateValue:function h(AQ,AO){if(this._super){this._super(AQ,AO);}var AU=this.interactiveCellsArray[AQ],AY=AO.v,AZ,AN=AH.call(this,AU);this.lmr=null;AZ=w.call(this,AU,AQ,AO);if(AU.r!==AY){if(!AU.mark){AU.mdf=1;mstrmojo.css.removeClass(AZ,"required");AD.apply(this,[AU,AN]);this.flagDirtyUnit(AZ);}}else{this.clearDirtyUnit(AZ);}if(this.tca===J){if(AU.mark){var AS=AU.markAll?-1:AU.o,AW=this.rsDelta;this.rs[AS]=AY;this.lmr={r:AS,v:AY};if(AU.markAll){AW=this.rsDelta={};AW[AS]=AY;this.mghMarks={};}else{if(AW[AS]&&AW[AS]!==AY){delete AW[AS];}else{if(AW[-1]!==AY){AW[AS]=AY;}}}}else{if(this.rs[AU.o]!==0){this.rs[AU.o]=1;}if(!this.editing&&this.mghMarks&&(AU.mix===undefined)){if(!this.mghMarks[AU.o]||this.mghMarks[AU.o].rs<AU.rs){this.mghMarks[AU.o]={o:AU.o,rs:AU.rs,k:AQ};}var AR,AV,AT=this;j.forEach(this.rsDelta,function(Aa,Ab){AR=parseInt(Ab,10);AV=parseInt(AU.o,10);if(AR>=AV&&AR<=(AV+AU.rs)){delete AT.rsDelta[Ab];}});}else{this.rsDelta[AU.o]=1;}if(!this.editing&&AU.rs>1){var AP=AU.o+1;while(AP-AU.o<AU.rs){if(!Y(this.rhsCP,AP,this.rs)){this.rs[AP]=1;}AP+=1;}}if(this.editing){var AX=this.dicGroupMap.m_x.widgetsMap[this.ko[AU.o]];if(AX){AX.set("checked",true);}}}}if(this.txar&&!AU.mark){return true;}return false;},autoRefresh:function AC(){var AN=this.zones;if(AN._BL){AN._BL.invalidAllPages();}AN._BR.invalidAllPages();this.rhsCP.invalid();this.valuesCP.invalid();o.addClass(this._STATUS,"recalculate");AN._BR.onscroll(true);this.recalculating=true;},getKeyContext:function O(AN){return this.kc[AN];},getUpdateObject:function R(){var AR=[],AP,AS,AT,AN=this.lmr,AO,AQ={};if(AN){this.lmr=null;return{manipulation:AG,actionType:(AN.v===-1)?x:t,rowOrdinal:AN.r,nodeKey:this.k,sliceId:this.sid};}AS=this.getUpdatedValues();for(AP=0;AP<(AS&&AS.length);AP++){if(!AS[AP].rowop){AT=AS[AP];break;}}if(AT){AO=mstrmojo.string.encodeXMLAttribute(String(AT.v));if(AT.k!==undefined&&AT.vls){AQ={controlKey:AT.k,elementId:AT.vls[mstrmojo.array.find(AT.vls,"v",AT.v)].eid};}if(!!AT.isMv){AR.push(j.copy(AQ,{rowOrdinal:AT.o,colOrdinal:AT.co,newValue:AO,dataType:AT.dt}));}else{AR.push(j.copy(AQ,{rowOrdinal:AT.o,attId:AT.atid,formId:AT.form_id,unitIndex:AT.tui||AT.ui,newValue:AO,dataType:AT.dt}));}}return{manipulation:G,nodeKey:this.k,sliceId:this.sid,cells:AR,autoRefresh:this.txar};},getUpdates:function S(){var AX=this,AS,AT,AN=AX.getUpdatedValues(),AQ=this.rsDelta,AR=[],AW=[],AU=false,AP="";AR.push('<gr rw_tree_type="'+AX.treeType+'" rw_node_key="'+AX.k+'" slice_id="'+AX.sid+'">');for(AS in AN){if(AN.hasOwnProperty(AS)){AT=AN[AS];if(!AT.rowop){var AY=mstrmojo.string.encodeXMLAttribute(String(AT.v));if(AT.k&&AT.vls){var AO=mstrmojo.array.find(AT.vls,"v",AT.v);AP='rw_control_key="'+AT.k+'" element_id="'+AT.vls[AO].eid+'" ';}if(!!AT.isMv){AW.push('<cli cordinal="'+AT.co+'" metric_id="'+AT.metric_id+'"><updt types="'+AT.tp+'" rordinal="'+AT.o+'" '+AP+'value="'+AY+'" dt="'+AT.dt+'"/></cli>');}else{AW.push('<cli ax="'+AT.ax+'" attribute_id="'+AT.atid+'" form_id="'+AT.form_id+'"><updt types="'+AT.tp+'" ordinal="'+AT.o+'" '+AP+'value="'+AY+'" dt="'+AT.dt+'"'+(this.mghMarks?' flags="1"':"")+"/></cli>");}AU=true;}}}if(!j.isEmpty(this.mghMarks)){var AV=this;j.forEach(this.mghMarks,function(AZ,Aa){AP=AV.getKeyContext(AZ.k);AW.push('<mark rordinal="'+Aa+'" types="4" flags="1" attribute_id="'+AP.atid+'" form_id="'+AP.form_id+'"/>');});}if(AQ&&!j.isEmpty(AQ)){AU=true;j.forEach(AQ,function(AZ,Aa){if(AZ===1){AW.push('<mark rordinal="'+Aa+'" types="4"/>');}else{AW.push('<mark rordinal="'+Aa+'" types="5"/>');}});}AR.push(AW.join(""));AR.push("</gr>");if(!AU){AR=[];}return AR.join("");},flagDirtyUnit:function a(AO){if(AO&&this.sci){if(this._super){this._super(AO);return ;}var AN=document.createElement("div"),AS,AP=false,AR=o.getStyleValue(this.domNode,n.CSS3_TRANSFORM),AQ;AN.className="flag-container";AN.innerHTML='<div class="dirty-cell"/>';if(AO.insertBefore){AO.insertBefore(AN,AO.firstChild);AQ=(AN.offsetParent===AO);}AP=mstrmojo.string.isEmpty(AR)||AR==="none";AS=AN.firstChild;AS.style.top=((!AP||AQ)?(-AN.offsetTop):(AO.offsetTop-AN.offsetTop))+"px";AS.style.left=(AO.clientWidth+((!AP||AQ)?(-AN.offsetLeft):(AO.offsetLeft-AN.offsetLeft))-8)+"px";}},clearDirtyUnit:function AL(AN){if(this._super){this._super(AN);return ;}var AO=AN.firstChild;if(AN){if(AO&&AO.className&&AO.className==="flag-container"){AN.removeChild(AO);}}},onvisibleChange:function q(){if(this.visible===true){var AN=this;setTimeout(function(){AN.configureActions();},10);}},configureActions:function U(){if(this.visible===false){return ;}var Ah="_BR",AN=this.zones[Ah],AW=!!this.zones._BL,AZ=AN.posMap,AS=AN.thPosMap,AV=this.interactiveCellsArray,Ab=this.dicGroupMap,Aa=[],AQ,Ag,Af,Ae,AO,AU,Ac,AT,AP,Al,Aj,Ai,Ak=this,AX=function(Am){var Ao=Am.length,An;for(An=0;An<Ao;An++){Ak.flagDirtyUnit(Am[An]);}};for(AQ=this.lastIndex,Ag=AV.length;AV[AQ]&&AQ<Ag;AQ++){AO=AV[AQ];AU=AZ&&AZ[AQ];if(!AU&&AW){Ah=(Ah==="_BR")?"_BL":"_BR";AN=this.zones[Ah];AZ=AN&&AN.posMap;AS=AN&&AN.thPosMap;AU=AZ&&AZ[AQ];}if(AU&&((AO.at&32)>0)){Ac=AN.getNodeByPosition(AU);AO.at=32;if(AO.rv==null){AO.rv=isNaN(AO.mix)?AO._e.n:AO.v;}AT=I(AO);Aj=this.getDataInputInfo(AO,AT);Ai=this.dicGroupMap[AT];if(Aj){if(!Ai){Ai=Ab[AT]=mstrmojo.DICFactory.createDICGroup({gk:AT,dic:Aj,owner:this,openerType:k});}var Ad={value:(AO.rv===undefined)?(AO.v||AO.n):(typeof AO.rv==="string"?mstrmojo.string.decodeHtmlString(AO.rv):AO.rv),dv:AO.v||AO.n,ts:AO.ts,markAll:AO.markAll,openerNode:Ac,k:AO._ei,ownerCell:AO,popupTitle:this.columnNames[AT]},AR=AN.cp.stackedRh;if(AR&&AO.singleStack&&(mstrmojo.DICConfig.showDICByDefault(Aj,1)||mstrmojo.DICConfig.hasDICPreview(Aj,1))){var AY=Ac.offsetHeight;Ac.className+=" igDIC";Ac.style.cssText="height:"+AY+"px;";mstrmojo.hash.copy({inlineExtraCssText:"position:absolute;top:"+parseInt(AR/2-AY/2+1,10)+"px;"},Ad);}Ai.addDIC(AO._ei,Ad);AP=AU.page*AN.rowsPerPage+AU.row;if(Aj.req){for(Ae=0;Ae<(this.editing?1:(AO.rs||1));Ae++){Al=this.requiredCellsMap[AP+Ae];if(!Al){this.requiredCellsMap[AP+Ae]=Al=[];}Al.push(AO);}}if(AO.mdf){Aa.push(Ac);AD.apply(this,[AO,AP]);}}}}this.lastIndex=AQ;for(AT in Ab){Ab[AT].render();}setTimeout(function(){AX(Aa);},25);for(Af=this.lastHeaderIndex,Ag=AS.length;Af<Ag;Af++){AU=AS[Af];Ac=AN.getNodeByPosition(AU);AO=AU.obj;if(this.isEditableHeader(AO)){Ac.innerHTML='<div class="editable-column">'+Ac.innerHTML+"</div>";}}this.lastHeaderIndex=Af;this.registerTxWidget();if(this._super){this._super();}},showPopupDIC:function A(AQ){var AO=AQ&&n.findAncestorByAttr(AQ,"ei",true,this.viewport);if(AO){var AR=AO.node,AN=this.getCellForNode(AR),AP=this.dicGroupMap[I(AN)];if(AP){AP.showPopupDIC(AN._ei);return true;}}return false;},onclick:function AF(AO){var AN=mstrmojo.dom.eventTarget(window,AO.e);if(!this.showPopupDIC(AN)&&this._super){this._super(AO);}},unrender:function D(){if(this._super){this._super();}this.destroyDICs();},destroyDICs:function s(){var AN=this.dicGroupMap;this.dicGroupMap={};setTimeout(function(){var AO;for(AO in AN){AN[AO].destroy();}},10);},checkRequiredObjects:function N(){if(this.hasRendered&&!(this.isInteractiveGrid&&this.isInteractiveGrid())&&!this.gridData.eg){var AP=this.zones._BR,AR=AP.posMap,AT,AQ=this,AO=this.rs,AN=true,AS=function(AZ,AV){var AY=true,AW=AQ.requiredCellsMap[AZ],AU=(AW&&AW.length)||0,AX;for(AX=0;AX<AU;AX++){if(!AW[AX].mdf){o.toggleClass(AP.getNodeByPosition(AR[AW[AX]._ei]),"required",AV);AY=!AV;}}return AY;};if(this.tca===J){for(AT in AO){AN=AS(parseInt(AT,10)+1,AO[AT]>0)&&AN;}}else{for(AT in this.dirtyRows){AN=AS(AT,true)&&AN;}}return AN;}return true;},editNext:function l(AP){if(this.recalculating){return false;}var AQ=this.interactiveCellsArray,AN=AQ.length,AR=AP+1,AS,AO;do{if(AR>=AN){AR%=AN;}if(AR===AP){return false;}AS=AQ[AR];var AT=this.dicGroupMap[I(AS)];if(AT){if(mstrmojo.DICConfig.isKeyNavigable(AT.dic)){if(!AT.showByDefault){AT.showPopupDIC(AR);}else{AO=AT.widgetsMap[AR];AO.focus();}return true;}}AR++;}while(true);}};}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo._IsDocXtab","mstrmojo._XtabSelections","mstrmojo._XtabCellHoverMgr");var F=0,A="overflow:auto",N="overflow:hidden",K=mstrmojo.dom,H="mstrmojo.DocPanelStack";var E=function C(Q,R){var S=Q&&Q.parent;while(S&&S.scriptClass!==H){if(S.scriptClass===R){return S;}S=S.parent;}return S;};mstrmojo.Xtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab,mstrmojo._XtabSelections],{scriptClass:"mstrmojo.Xtab",cellHoverMgr:"mstrmojo._XtabCellHoverMgr",cellHoverPopupRef:"mstrmojo.XtabCellHoverPopup",preBuildRendering:function O(){var S=this._super();var R=this.gridData;var Q=this.lockHeadersCase===F&&R.co;this.scrollboxNodeOverflow=Q&&!this.numRowFixed?N:A;var T=this.getFormats();if(mstrmojo.dom.isIE8&&!R.co&&this.lockHeadersCase===F&&(!R.rw||R.rw&&(R.rw.row.bc>=R.rw.row.tc))&&mstrmojo.string.isEmpty(T.height)&&mstrmojo.string.isEmpty(T.width)){this.scrollboxNodeOverflow="";}this._useFilter=this._useFilter||R.cssflt||false;return S;},postBuildRendering:function G(){var S=this.gridData,R=this._super();if(!K.supportsTouches){var U=this;if(this.contentNode){this.contentNode.onmouseover=function(){U.requiresContrib("cellHoverMgr",true);U.contentNode.onmouseover=null;};}}if(!this.getFormats().width&&this.model.docModel.addAutoWidthID){this.model.docModel.addAutoWidthID(this.id);S=this.gridData;var Q=S&&S.afc;if(Q&&mstrmojo.dom.isIE7){var T=E(this,H);if(T&&T.scriptClass===H){this.viewport.style.width=this.contentNode.offsetWidth+(this.scrollboxNode.offsetWidth-this.scrollboxNode.clientWidth)+"px";}}}if(K.isIE&&!K.isIE8&&this._useFilter&&!this.lockHeadersCase){var V=this.scrollboxNode;window.setTimeout(function(){var W=document.createElement("img");V.appendChild(W);V.removeChild(W);},0);}return R;},createZone:function(Q){return new mstrmojo.XtabZone(Q||{});},onCGBMapChange:function(R){var Q=this._resolveCGBToTKS(R.cgbMap);if(Q){this.defaultAction(this._currentSelectedTD);}},_resolveCGBToTKS:function D(Y){if(!Y){return ;}var W=this.model.scm,S="\u001E",U=0,R=null,V=null,T=null,Q=null,X=false;for(R in W){V=W[R];T=V.cgb;for(U in T){Q=Y[T[U]];if(Q){if(!V.tks){V.tks=Q;X=true;}else{if(V.tks&&(V.tks.indexOf(Q)<0)){V.tks+=S+Q;X=true;}}}}}return X;},onGridWidthChanged:function J(Q){if(this.cellHoverMgr.onXtabWidthChanged){this.cellHoverMgr.onXtabWidthChanged();}if(this._super){this._super(Q);}},getDim:function(){var Q=this.contentNode;return{w:Q.scrollWidth,h:Q.scrollHeight};},unrender:function L(Q){var R=this.cellHoverMgr;if(R&&R.shutdown){R.shutdown();}this._super(Q);},link:function M(R,Q){this.controller.onLink(this,this.model.getLinkAction(R,Q));},sort:function I(Q,R){this.controller.onSort(this,this.model.getSortAction(Q,R));},pivot:function P(Q,R){this.controller.onPivot(this,this.model.getPivotAction(Q,R));},drill:function B(Q){this.controller.onDrill(this,this.model.getDrillAction(this.getActionCells(Q)));}});}());(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.requiresCls("mstrmojo._InputListHoriz");mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.dom","mstrmojo.SearchableDropDownList","mstrmojo._IsTableLayoutListDIC","mstrmojo.TableLayoutList","mstrmojo._IsInputControl","mstrmojo.DynamicClassFactory");var H=mstrmojo.DynamicClassFactory.newComponent,C=mstrmojo.hash,E=mstrmojo.dom;mstrmojo.SearchableDropDownListForListDIC=mstrmojo.declare(mstrmojo.SearchableDropDownList,null,{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",init:function I(J){this._super(J);this.popupRef.children[0].onmousedown=function(){var L=this.parent,K=L.opener;L.close();if(K){K.onPopupClosed();}};},onmousedown:function B(J){this._super&&this._super(J);if(E.isIE||E.isIEW3C){this.focus();}},openPopup:function(K,J){this._super(K,J);this.parent.setInfoWindowLock(true);},popupRef:C.copy({onvisibleChange:function(){var J=this.opener.parent.showByDefault;if(!this.visible&&J){this.opener.parent.setInfoWindowLock(false);}}},C.clone(mstrmojo.SearchableDropDownList.prototype.popupRef)),onPopupClosed:mstrmojo.emptyFn});function G(K){var J=[];mstrmojo.array.forEach(K,function(L){J.push(L.n);});return J;}mstrmojo.TableLayoutListForListDIC=H(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC],{scriptClass:"mstrmojo.TableLayoutListForListDIC"});function F(M,N,K){var O=N.ipr||0,L=N.mint||"",J=N.maxt||"";return{0:{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",cssDisplay:"block",searchEnabled:K.length>=10,itemIdField:"v",fixWidth:true,fixHeight:true,postCreate:function(){var Q=this.value,R=N.ust||"",P=mstrmojo.array.find(K,"v",Q);if(P==-1){K=[{n:R,v:Q}].concat(K);P=0;this.unset=true;}this.items=K;this.selectedIndex=P;this.set("value",K[P].v);if(this.parent.showByDefault&&this.searchEnabled){this.applyChange=function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}else{this.items=this.allItems;this.set("text",this.text);}};this.onvalueChange=function(){};if(E.isIE||E.isIEW3C){this.onPopupClosed=function(){this.applyChange&&this.applyChange();};}}},onblur:function(P){this.applyChange&&this.applyChange();},onEnter:function(){this.applyChange&&this.applyChange();},onEsc:function(){this.items=this.allItems;this.set("value",this.parent.value);},getDisplayValue:function(){return this.items.length&&this.items[this.selectedIndex===-1?0:this.selectedIndex].n;},isPopupClosed:function(){return !(this.popupRef&&this.popupRef.visible);}},1:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"radio",itemsPerRow:O,items:K,getDisplayValue:function(){return this.items[this.selectedIndex].n;}},2:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"check",delim:",",multiSelect:true,itemsPerRow:O,items:K,getDisplayValue:function(){return"";}}}[M||0];}mstrmojo.ListDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ListDIC",tabIndex:0,markupString:'<div class="mstrmojo-ListDIC {@cssClass}" tabIndex="{@tabIndex}" mstrAttach:focus></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onwidthChange:function(){if(this.dicWidget&&this.width){this.dicWidget.set("width",this.width);}},onheightChange:function(){if(this.dicWidget&&this.height){this.dicWidget.set("height",this.height);}}},init:function(J){this._super(J);this.style=this.dic.st;this.items=this.getItems();this.set("children",[mstrmojo.hash.copy(F(this.style,this.dic,this.items),{alias:"dicWidget",value:this.value,onvalueChange:function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}}})]);if(this.dicWidget.setDirtyFlag){this.setDirtyFlag=function(L,K){this.dicWidget.setDirtyFlag(L,K);};}},getDisplayValue:function D(){return this.dicWidget.getDisplayValue()||this.dv;},onfocus:function(J){this.focus();},focus:function(){var J=this;if(mstrmojo.dom.isIE){setTimeout(function(){J.dicWidget.focus&&J.dicWidget.focus();},10);}else{J.dicWidget.focus&&J.dicWidget.focus();}},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.dicWidget.set("height",(this.openerStyle.ih||0)+"px");this.dicWidget.set("width",(this.openerStyle.iw||0)+"px");}},applyChanges:function(){var J=this._super();return this.style?J:this.dicWidget.isPopupClosed();},cleanup:function A(){if(!this.style){this.dicWidget.closePopup();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocXtabGraph");var B=mstrmojo.dom;mstrmojo.OIVMDocXtabGraph=mstrmojo.declare(mstrmojo.DocXtabGraph,null,{scriptClass:"mstrmojo.OIVMDocXtabGraph",postBuildRendering:function C(){if(!this.preLoader){this.preLoader=document.createElement("img");}return this._super();},retrieveGraphSrc:function A(J,M){var D=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(M,10)+"&height="+parseInt(J,10)+"&sessionState="+escape(mstrApp.sessionState),O=this.preLoader,P=this.imgNode,E=this.id;D=mstrmojo.addCSRFTokenToURL(D);if(O.src!==D){mstrApp.addLoadingGraph(E);var I=function(){mstrApp.removeLoadingGraph(E);},N="load",H="error",L,G,K,F;G=B.attachOneTimeEvent(O,N,function(){F=B.attachOneTimeEvent(P,N,function(){I();P.style.background="none";mstrmojo.all[E].defn.set("readyState",mstrmojo.EnumReadystate.IDLE);B.detachEvent(P,H,K);});K=B.attachOneTimeEvent(P,H,function(){I();B.detachEvent(P,N,F);});B.detachEvent(O,H,L);P.src=O.src;});L=B.attachOneTimeEvent(O,"error",function(){I();B.detachEvent(O,N,G);});O.src=D;}}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,C={0:"default",1:"stars_dots"};mstrmojo.RatingDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RatingDIC",styleCssClass:"rate",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover,mouseout><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',lastIdx:null,init:function(D){this._super(D);this.items=this.getItems();this.starCount=this.items&&this.items.length;B.addWidgetCssClass(this,C[this.dic.stl||0]);},setRating:function(D){var F=0,G=this.starCount,E="less_equal";if(this.lastIdx==undefined||this.lastIdx!=D){for(;F<G;F++){if(F<=D){B.addClass(this._getItemNode(F),E);}else{B.removeClass(this._getItemNode(F),E);}}this.lastIdx=D;}},onvalueChange:function(){this._super&&this._super();var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},onmouseover:function(E){this._super&&this._super(E);var F=E.target||A.eventTarget(E.hWin,E.e),D=F&&F.getAttribute("idx");if(D!=undefined){this.setRating(D);}},onmouseout:function(E){this._super&&this._super(E);var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}var D=mstrmojo.array.find(this.items,"v",this.value);if(D>-1){this.setRating(D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl");function A(E){var D=[];mstrmojo.array.forEach(E,function(F){D.push(F.n);});return D;}mstrmojo.LikertScaleDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.LikertScaleDIC",styleCssClass:"scale",init:function(D){this._super(D);this.items=this.getItems();this.titleItems=A(this.items);},getDisplayValue:function B(){return(this.selectedIndex>=0)?this.items[this.selectedIndex].n:this.dv;},getLeftEndTitle:function C(D){return D>=0?(this.dic.mint||""):"";},getRightEndTitle:function(D){return D>=0?(this.dic.maxt||""):"";},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=(Y)?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=(Y)?0:U-1;}else{V+=(Y)?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(k){var f=this.candidates,a=f&&f.items,X=f&&f.isComplete,j=this._last_hit;if(!this.noCache&&(f||j)){var h=this.filterCandidates(a,k,this.REQUEST_THRESHOLD),b=h.length,g=this.suggestCount,U=false;if(!X&&b<g){var V=j&&j.pattern;if(j&&V&&(k.indexOf(V)>-1)){U=true;var n=this.filterCandidates(j.items,k,this.REQUEST_THRESHOLD),Y=n&&n.length,W=mstrmojo.array,l=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(h,l,n[Z][l])===-1){h.push(n[Z]);}}b=h.length;}}if(!X&&((k.length>2&&b<this.REQUEST_THRESHOLD)||(b<g))){this.requestCandidates(k);return -1;}return(b<g)?h:h.slice(0,g);}this.requestCandidates(k);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(g){if(!g){return ;}var f=X.getSuggestionTarget();if(!f||(V!==f)){return ;}var l=f.getSearchPattern(),a=g.items;X._last_hit={items:a,pattern:U};X.sz=g.sz;if(!X.noCache&&a){var h=X.candidates&&X.candidates.items||[],j=[].concat(a);for(var Z=0,b=a.length;Z<b;Z++){var Y=j[Z];if(mstrmojo.array.indexOf(h,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=h.concat(a);}}if(l&&l.indexOf(U)>-1){var k=X.filterCandidates(a,l);X.updateSuggestion(k);}},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:((V)?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var V=this.zIndex;this.openPopup("ob",{zIndex:(V&&(V+10))||110});this.ob.browser.browse({folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes});this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopup:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInputBox-suggest",showTitle:false,modal:false,autoClose:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U&&U.autoSelect){this.list.singleSelect(0);}},onClose:function F(){this.list.clearSelect();if(this.opener){this.opener.suggestionShown=false;}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){var N,J;mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DocPortlet");var Q={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};mstrmojo.Vis=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,updated:false,reRenderOnDimensionChg:true,getFormats:function(){return this.fmts;},isVis:function(){return true;},setModel:function L(V){this.set("model",V);if(V.data){this.set("model",V.data);}this.xtabModel=V;if(typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function S(){this._super();var V=this.xtabModel;if(V&&V.destroy){V.destroy();delete this.xtabModel;}},setDimensions:function O(X,W){var V=this._super(X,W);if(V&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return V;},reRender:function F(){this.unrender();this.render();},getWidth:function B(){return parseInt(this.width,10);},getHeight:function I(){return parseInt(this.height,10);},buildRendering:function H(){if(!this.updated){this.update();}if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function E(){N=this.width;J=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function A(){var V=this.domNode,W={top:0,left:0};if(typeof (mstr)!="undefined"){W.top=mstr.utils.BoxModel.getElementSumOffsetTop(V);W.left=mstr.utils.BoxModel.getElementSumOffsetLeft(V);}else{if(typeof (mstrmojo)!="undefined"){W=mstrmojo.boxmodel.offset(V);}}this.offsetTop=W.top;this.offsetLeft=W.left;},initFromVisProps:function R(V){},update:function G(X){X=X||this.node;if(X){if(X.data){this.set("model",X.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",X.data);}this.model=X.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(X.data.extProps,this);}this.fmts=X.defn.fmts||X.defn.units[this.model.k].fmts;var V=this.fmts;if(V){for(var W in Q){v=Q[W];if(W in V){this[v]=V[W];}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;},getModel:function M(W){if(W){var V=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,W);if(V){return V.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));}}else{return this.model;}},getDataParser:function K(V){return new mstrmojo.Vis.DataParser(this.getModel(V));},renderErrorMessage:function T(V){this.domNode.innerHTML='<div class="mstrmojo-message">'+V+"</div>";},getMessageID:function D(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function U(Y){var k=this.xtabModel,h=(k&&k.docModel);var l=false;if(h){var g=h.defn&&h.defn.layouts,X=null;var W;if(g){for(W in g){if(g[W].loaded){X=g[W];break;}}}var Z=X&&X.units;this.selectorTargets={};if(Z&&Y.scObjList){for(var W=0;W<Y.scObjList.length;W++){var a=Y.scObjList[W];var b=a.sc.tks.split("\x1E");for(var V=0;V<b.length;V++){var f=Z[b[V]];if(f){this.selectorTargets[b[V]]=f;if(!this.isChildOfIfw(Z,f)){l=true;}}}}}}return l;},isChildOfIfw:function C(V,W){while(W){if(W.ifw){return true;}W=V[W.pnk];}return false;},performAction:function P(V){var X=this.xtabModel.getAction(V),W=X&&X.h;if(W&&this.controller[W]){this.controller[W](this,X.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(V,f,W){var a=f;var Y=V.getChildren(f,false);for(var X=0;X<Y.length;X++){var b=Y[X];if(b.k==W){return b;}else{var Z=mstrmojo.Vis.getVisGrid(V,b,W);if(Z){f=a;return Z;}}}};mstrmojo.Vis.DataParser=function(X){var h=mstrmojo.Vis;return{getRowTitles:function(){return new h.Titles(X,true);},getColTitles:function(){return new h.Titles(X,false);},findMetricValue:function(l,q){var p=X.ghs.rhs.items;for(var n in p){var o=p[n].items;var k=true;for(var j in l){if(l[j]!=o[j].idx){k=false;break;}}if(k){return new mstrmojo.Vis.MetricValue(X.gvs.items[n].items[q]);}}},getTotalRows:function a(){return X.eg?0:X.ghs.rhs.items.length;},getTotalColHeaderRows:function Y(){return(!X.ghs.chs.items?0:X.ghs.chs.items.length);},getTotalCols:function V(){return this.getColHeaders(0).size();},getRowHeaders:function g(i){return new h.Headers(X,i,true);},getColHeaders:function f(i){return new h.Headers(X,i,false);},getMetricValue:function b(j,i){return new h.MetricValue(X,X.gvs.items[j].items[i]);},getColumnHeaderCount:function Z(){return X.gvs.items[0].items.length;},getCSSString:function W(){return X.cssString;}};};mstrmojo.Vis.Titles=function(V,a){var Z=(a)?V.gts.row:V.gts.col;return{size:function Y(){return Z.length;},getTitle:function X(b){return new mstrmojo.Vis.Title(Z[b]);},getCSS:function W(b){return V.css[Z[b].cni].n;}};};mstrmojo.Vis.Headers=function(W,X,b){var f=(b)?W.gts.row:W.gts.col;var a=(b)?W.ghs.rhs:W.ghs.chs;var Y=a.items&&a.items[X].items;return{size:function g(){return(!Y?0:Y.length);},getHeader:function V(h){return Y&&Y[h]&&new mstrmojo.Vis.Header(Y[h],b?f[h]:f[X]);},getCSS:function Z(h){return Y&&W.css[Y[h].cni].n;},getHeaderCell:function(h){return Y&&Y[h];}};};mstrmojo.Vis.Title=function(W){return{getActionType:function(){return W.at;},getDrillPath:function(){return W.dp;},getHeaderValues:function V(){return W.es;},getHeaderName:function X(Z){return W.es[Z].n;},getHeaderId:function X(Z){return W.es[Z].id;},getForms:function Y(){return W.fs;},getFormId:function(){return W.fid;},getFormType:function(){return W.ftp;},getUnitId:function(){return W.id;},getLinkMap:function(){return W.lm;},getName:function(){return W.n;},getUnitDssType:function(){return W.otp;},getSelectorControl:function(){return W.sc;}};};mstrmojo.Vis.Header=function(X,V){return{getName:function Z(){return(X.idx===-1)?"":V.es[X.idx].n;},getElementId:function f(){return(X.idx===-1)?"":V.es[X.idx].id;},getObjectId:function Y(){return(X.idx===-1)?"":V.es[X.idx].oid;},getElementIndex:function W(){return X.idx;},getActionType:function b(){return X.at;},isTotal:function a(){return X.otr===1;}};};mstrmojo.Vis.MetricValue=function(V,f){var b=f;return{getValue:function W(){return b.v;},getThresholdType:function X(){return b.ty;},getRawValue:function a(){return b.rv;},getCSS:function Y(){return V.css[b.cni].n;},getThresholdValue:function g(h){if(b.ti==undefined){return h;}return V.th[b.ti].n;},getFillColor:function Z(h){if(b.ci==undefined){return h;}return V.fc[b.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.Box","mstrmojo.ElasticTextArea","mstrmojo.hash","mstrmojo.css");var G=4,F=5,E=6,C=7,B=10;var D=mstrmojo.hash,A=mstrmojo.css;mstrmojo.TextAreaDIC=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextAreaDIC",applyOnEnter:false,onfontChange:function(){var H=this.font;if(this.etab){this.etab.set("font",H);}else{if(this.eta){this.eta.set("font",H);}}},focus:function(){if(this.eta){this.eta.focus();}else{if(this.etab){this.etab.premousedown();}}},init:function(I){if(this._super){this._super(I);}if(this.showByDefault){var H,J=this.dic;if(J.siwc){H={cssText:"position:relative;min-height:18px;",ontextChange:function(){this.preview.set("text",this.text);},onvalueChange:function(){if(J.sp){var K=this.value,L=this.dv||"",N="",M="";switch(this.ts){case E:M="mailto:";case F:N=K.substring(0,J.pl);this.dv=N=L.replace(/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i,"$1"+M+K+"$3"+N+"$5");break;default:N=L.substring(0,J.pl);break;}this.preview.set("text",J.pl>0&&N.length>0?N+"...&nbsp;&nbsp;&nbsp;":"");}if(this.etab.domNode){if(this.value&&this.value.length!==0){A.addClass(this.etab.domNode,"filled");}else{A.removeClass(this.etab.domNode,"filled");}}this.etab.value=this.value;this.applyChanges();},onpopupwidthChange:function(){this.etab.set("popupWidth",this.popupwidth||200);},onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}}};}else{H={cssText:"position:relative",onpopupwidthChange:function(){this.eta.set("width",(this.popupwidth-4)||200);},onheightChange:function(){if(this.domNode&&this.height){this.domNode.style.height=this.height+"px";this.eta.set("height",this.height-4);}}};}D.copy(H,this);if(J.siwc){this.addChildren([{alias:"preview",scriptClass:"mstrmojo.Label"},{alias:"etab",popupToBody:true,maxLength:J.ml||250,cssText:"position:absolute;right:0;top:0px",onvalueChange:function(){if(this.value!==this.parent.value){var L=this.parent,K="";switch(L.ts){case E:K="mailto:";case F:if(!L.dv){L.dv='<a href="mailto:"></a>';}var M=/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i;L.set("dv",L.dv.replace(M,"$1"+K+this.value+"$3"+this.value+"$5"));break;default:L.set("dv",this.value);break;}L.set("value",this.value);}},premousedown:function(){var L=!this.popupRef.hasRendered;mstrmojo.ElasticTextAreaButton.prototype.premousedown.apply(this,arguments);if(L){var K=this.popupRef,M=this.parent;mstrmojo.dom.attachEvent(K.domNode,"keydown",function(N){var O=N||window.event;if(O.keyCode==9){K.close();M.onTabDown(N);}});}},scriptClass:"mstrmojo.ElasticTextAreaButton"}]);}else{this.addChildren({alias:"eta",maxLength:J.ml||250,onheightChange:function(){if(this.hasRendered&&this.height){this.domNode.style.height=this.height+"px";}},onblur:function(){this.parent.set("value",this.value);},onwidthChange:function(){if(this.hasRendered&&this.width){this.domNode.style.width=this.width+"px";}},placeholderText:this.placeholderText,bindings:{value:"this.parent.value"},scriptClass:"mstrmojo.TextArea"});}this.onvalueChange();}else{this.addChildren({alias:"eta",scriptClass:"mstrmojo.ElasticTextArea",maxLength:this.dic.ml,value:this.value,onvalueChange:function(){this.parent.set("value",this.value);}});this.onpopupwidthChange=function(){this.eta.set("width",(this.popupwidth-4)||200);};}},postBuildRendering:function(){this._super();var H=this.dic;if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault&&!H.siwc){this.set("height",this.openerStyle.ih);this.set("popupwidth",this.openerStyle.iw);}else{if(H.wm&&H.w){this.set("popupwidth",H.w);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.date","mstrmojo.DateTextBox","mstrmojo._IsInputControl");var B=mstrmojo.css,A=mstrmojo.expr.DTP;mstrmojo.CalendarDIC=mstrmojo.declare(mstrmojo.DateTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CalendarDIC",autoFormat:false,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onvalueChange:function(){if(!this.showByDefault){var F=this.calendar.cal,D=mstrmojo.date,E=this.dic.min,C=this.dic.max;this.invalid=mstrmojo.string.trim(this.value||"").length===0||this.validationStatus.code>mstrmojo.validation.STATUSCODE.VALID;if(F.value!==this.value){F.set("value",this.value);}else{if(E&&D.compareDateAndOrTime(E,F.value)>0){this.value=E;}else{if(C&&D.compareDateAndOrTime(F.value,C)>0){this.value=C;}}}}},getInputNode:function(){return this.inputNode;},init:function(C){this._super(C);this.dtp=this.dic.ict?A.TIMESTAMP:A.DATE;},focus:function(){mstrmojo.dom.setCaret(this.inputNode,((this.value&&this.value.length)||0));this.openPopup("calendar");this.adjustCalendarPopup();},adjustCalendarPopup:function(){var F=this.domNode,E=this.calendar.domNode,D=E.scrollWidth,I=mstrmojo.boxmodel.offset(this.openerNode,document.body),H=I.left,G,C=(document.body.offsetWidth-H-D-parseInt(B.getStyleValue(F,"paddingLeft"),10)-parseInt(B.getStyleValue(F,"paddingRight"),10));if(C<0){E.style.left=C+"px";}G=parseInt(I.top,10);if(G+this.inputNode.offsetHeight+E.offsetHeight<=mstrmojo.dom.windowDim().h){E.style.top=this.inputNode.offsetHeight+"px";}else{E.style.top=-E.offsetHeight+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.TreeNode");var I=mstrmojo.dom;mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:mstrmojo.hash.copy({checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,onstateChange:function H(){if(!this.contentRetrieved&&(this.state==1)){this.set("items",[this.tree.loadingItemCreaterFunc()]);this.tree.getContent(this,this.blockBegin);}},toggleState:function F(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function G(J){I.clearBrowserHighlights(J.hWin);return false;},predblclick:function D(J){I.clearBrowserHighlights(J.hWin);return false;},premousedown:function B(K){var P=mstrmojo.dom,M=mstrmojo.dom.eventTarget(K.hWin,K.e),J=this.tree,L=(this.state==2),O=P.contains(this.itemsContainerNode,P.eventTarget(K.hWin,K.e),true,this.domNode),N=(J.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if(this.isSpecialNode()||!(M==this.checkBoxNode||(M==this.textNode&&(L||!N)))){P.stopPropogation(K.hWin,K.e);}if((M==this.stateNode)||(M==this.textNode&&!L&&N)){if(!L){this.toggleState();}}else{if(M==this.checkBoxNode||O){if(this._super){this._super(K);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var J=this.data&&this.data.st;return(J<0);},handleNodeClicked:function E(){var J=this.tree,K=this.parent,L=this.data;switch(L&&L.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin-J.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin+J.blockCount);break;case"-1":case"-2":break;default:if(J.handleNodeClicked){J.handleNodeClicked(L);}}},init:function(J){this._super(J);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var J=function(K){I.preventDefault(window,K||window.event);return false;};I.attachEvent(this.domNode,"mousedown",J);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st];},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc());}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){this.getContent(this);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new mstrmojo.TreeBrowserNode({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}else{var J=this.selectionParentNode;return J&&J.getSelectedItems();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.OIVMDICPopup","mstrmojo.SliderDIC","mstrmojo.TextFieldDIC","mstrmojo.CheckBoxDIC","mstrmojo.ListDIC","mstrmojo.CalendarDIC","mstrmojo.TimePickerDIC","mstrmojo.ToggleDIC","mstrmojo.TextAreaDIC","mstrmojo.MarkRowDIC","mstrmojo.DefaultDIC","mstrmojo.RatingDIC","mstrmojo.RankDIC","mstrmojo.StepperDIC","mstrmojo.LikertScaleDIC");var C=null,B=1,I=2,G=3,A=4,J=5,L=6,F=7,K=8,D=10,E=11,H=13;mstrmojo.OIVMDICConfig=mstrmojo.provide("mstrmojo.OIVMDICConfig",{DICList:{1:mstrmojo.TextFieldDIC,2:mstrmojo.CheckBoxDIC,3:mstrmojo.ListDIC,4:mstrmojo.SliderDIC,5:mstrmojo.CalendarDIC,6:mstrmojo.TimePickerDIC,7:mstrmojo.ToggleDIC,8:mstrmojo.TextAreaDIC,9:mstrmojo.DefaultDIC,10:mstrmojo.RatingDIC,11:mstrmojo.RankDIC,12:mstrmojo.StepperDIC,13:mstrmojo.DefaultDIC,14:mstrmojo.LikertScaleDIC,102:mstrmojo.MarkRowDIC},getDICClass:function(M){if(M.t===H){if(!!M.em){return mstrmojo.ListDIC;}else{return mstrmojo.TextFieldDIC;}}return this.DICList[M.t];},showDICByDefault:function(N,M){if(N.sbd===undefined){if(N.t==K&&N.dm==0&&N.siwc){N.sbd=true;}else{if(N.t==H){N.sbd=false;}else{if(this.DICList[N.t]==mstrmojo.DefaultDIC){N.sbd=0;}else{N.sbd=N.dm===1;}}}}return N.sbd;},hasDICPreview:function(N,M){if(N.hpp===undefined){N.hpp=false;}return N.hpp;},isKeyNavigable:function(M){if(M.ikn===undefined){switch(M.t){case B:case J:case G:case I:case F:case A:case L:case K:M.ikn=true;break;default:M.ikn=false;}}return M.ikn;},DICPopup:{getInstance:function(M,N){if(!C){C=new mstrmojo.OIVMDICPopup();C.render();}C.open(M,{widget:N});return C;},cancel:function(){if(C){C.onCancel();}}}});mstrmojo.DICConfig=mstrmojo.OIVMDICConfig;mstrmojo.DICList=mstrmojo.DICConfig.DICList;mstrmojo.DICPopup=mstrmojo.DICConfig.DICPopup;})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo._CanSupportTransaction","mstrmojo.Box","mstrmojo._Formattable","mstrmojo.PageNavigationPanel","mstrmojo.Label","mstrmojo.Table");var l=0,Q=1,S=2,j=3,D=4,w=5,n=6,U=7,o=8,Z=9,N=10,Y=11;var p={1:"gray",2:"black"};var C=0,A=1,h=2;var s=1,E=2,O=3;var X=mstrmojo.hash,f=mstrmojo.array,b=mstrmojo.css;var t=1,I=2;function R(AA,x){var AB=AA.getRowTitles(),AG=AA.getColHeaders(0),AC,AF,z,AE,AD={};for(AC=0,AF=AB.size();AC<AF;AC++){z=AB.getTitle(AC);AE=z&&z.getUnitId();X.forEach(x,function(AI,AH){if(AE===AI){AD[AH]=AC;if(AH==="sel"){AD.fid=z.getFormId();}return false;}});}if(x.sel){for(AC=0,AF=AG.size();AC<AF;AC++){AE=AG.getHeader(AC).getObjectId(AC);if(AE===x.sel){AD.sel=AC;AD.aoa=I;break;}}}return AD;}function k(AA,z){var AB=[],AC,x;if(AA.length===1&&z){for(AC=1;AC<=z;AC++){AB.push({n:AC,v:AC,o:AA[0].o});}}else{for(AC=0,x=AA.length;AC<x;AC++){if(AA[AC]){AB.push({n:AA[AC].title,v:AA[AC].value,o:AA[AC].o});}}}return AB.sort(function(AE,AD){return AE.o-AD.o;});}function T(z){if(z.type===1){return{placeholderText:(z.required===A)?mstrmojo.desc(661,"Required"):""};}else{if(z.type===2){return{placeholderText:mstrmojo.desc(10001,"Click to edit")};}else{if(z.type===6){var x=z.answers[z.gai||0].sort(function(AB,AA){return AB.value-AA.value;});if(x.length>0){return{mint:x[0].title,maxt:x[x.length-1].title};}}}}return{};}function g(z){var AA=[],x=this;X.forEach(z.answers,function(AC,AE){var AF=z.type,AG=AE||0,AE=z.id+"."+(AE||0),AD=k(AC),AI={2:{t:8,dm:1,vls:AD||[],ipt:1},3:{t:3,dm:1,st:1,stl:1,vls:AD||[],ipr:1,ipt:1,ms:1},4:{t:3,dm:1,st:2,stl:3,vls:AD||[],ipr:1,ipt:1,ms:1},5:{t:3,dm:1,vls:AD||[],ipt:1,ms:1},6:{t:14,dm:1,stl:2,vls:AD||[],ipr:0,ipt:1,ms:1},9:{t:11,dm:1,vls:AD||[],ipt:1,ms:1},10:{t:10,dm:1,vls:k(AC,5)}}[AF]||{t:1,dm:1,wm:0,w:12,ml:256,dt:10},AH=mstrmojo.DICFactory.createDIC(X.copy(T(z),{dic:AI,k:AE,dv:"",value:z.dftAns[AG]||""})),AB={scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Answers",children:[AH]};AA.push(AB);AH.owner=x;x.dics.push({k:AE,w:AH,s:z.sid,r:z.required});x.ko[AE]={vls:AD,qtp:AF};});return AA;}function B(AI,AP){var AM,AL,AK,AN,AH,AF,AG,AC,AE=0,z=[],AA=[],AO=[],x=0;if(!AI){return z;}for(AM=0,AN=AI.length;AM<AN;AM++){var AD=AI[AM],AB=(AP?"  "+AD.title:(this.qId++)+". "+AD.title),AJ={scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-QuestionTitle",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-SurveyVis-QuestionTitleText",cssDisplay:"inline",text:AB},{scriptClass:"mstrmojo.Label",cssClass:"required",cssDisplay:"inline",text:"*",visible:AD.required===A}]},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-SurveyVis-Description",text:AD.description||""}]};if(AD.type===Y){if(AD.groupStyle===O){AA=[];x=AD.answers[AD.gai].length||0;for(AL=0,AH=x;AL<AH;AL++){AA.push({scriptClass:"mstrmojo.Label",cssClass:"colHeader",slot:"0,"+(AL+1),text:AD.answers[AD.gai][AL].title});}AO=B.call(this,AD.group,true);for(AL=0,AH=AO.length;AL<AH;AL++){AC=AO[AL];if(AC&&AC.cssClass==="groupBreak"){continue;}if(AC&&AC.children&&AC.children.length){for(AK=0,AF=AC.children.length;AK<AF;AK++){AG=AC.children[AK];AG.slot=(AL+1)+","+AK;if(AL==0){AG.cssClass+=" topRow";}AA.push(AG);}AE++;}}z.push({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Question",children:[AJ].concat({scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-SurveyVis-Group Table",rows:AE+1,cols:x+1,children:[{scriptClass:"mstrmojo.Label",text:"",slot:"0,0"}].concat(AA)})});}else{z.push({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Group Regular",children:[AJ].concat(B.call(this,AD.group,true).concat([{scriptClass:"mstrmojo.Box",cssClass:"groupBreak"}]))});}}else{z.push({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Question",children:AD.type===l?[AJ]:[AJ].concat(g.call(this,AD))});}if(AD.groupBreak){z.push({scriptClass:"mstrmojo.Box",cssClass:"groupBreak"});}}return z;}function H(AB){var AA=AB.sections,z,x,AC=[];if(!AA){return AC;}for(z=0,x=AA.length;z<x;z++){AC.push(mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Section",title:AA[z].title,children:B.call(this,AA[z].questions)}));}return AC;}function L(x){return parseInt(x,10)>0||!!x;}function J(AO,AH){var AJ={},AV=-1,AG,AE,AI,AD=-1,AK,AN=-1,AB,AC=0,AT=0,AR=0,AQ,AS,AP,z=true,x,AM,AA;for(AQ=0,AS=AO.getTotalRows();AQ<AS;AQ++){x=AO.getRowHeaders(AQ);if(AH.t&&AH.t!==-1&&!AJ.title){AJ.title=x.getHeader(AH.t).getName();}else{if(AJ.title===undefined){AJ.title="";}}if(AH.sid&&AH.sid!==-1){if(!AJ.sections){AJ.sections=[];}AP=parseInt(x.getHeader(AH.sid).getName(),10);if(AV!==AP){AV=AP;AG={questions:[]};AJ.sections.push(AG);if(AH.st&&AH.st!==-1){AG.title=x.getHeader(AH.st).getName();}AE=AG.questions;AI=null;}}else{if(!AJ.questions){AE=AJ.questions=[];}}if(AH.qid&&AH.qid!==-1&&AE){if(AH.qn&&AH.qn!==-1){AC=parseInt(x.getHeader(AH.qn).getName(),10);}else{AC++;}AP=parseInt(x.getHeader(AH.qid).getName(),10);if(AD!==AP){z=true;AD=AP;AK={required:0,type:1,answers:{},sid:AV};AK.id=AP;if(AH.qt&&AH.qt!=-1){AK.title=x.getHeader(AH.qt).getName();}else{if(AK.title===undefined){AK.title="";}}if(AH.qd&&AH.qd!=-1){AK.description=x.getHeader(AH.qd).getName();}else{if(AK.description===undefined){AK.description="";}}if(AH.rq&&AH.rq!=-1){AK.required=parseInt(x.getHeader(AH.rq).getName(),10)||0;}if(AH.ran&&AH.ran!=-1){AK.randomize=x.getHeader(AH.ran).getName();}if(AH.qtp&&AH.qtp!=-1){AK.type=parseInt(x.getHeader(AH.qtp).getName(),10)||0;}AK.qn=AC;if(AH.gai&&AH.gai!=-1){AK.gai=parseInt(x.getHeader(AH.gai).getName(),10)||0;}if(AH.gb&&AH.gb!==-1){AK.groupBreak=parseInt(x.getHeader(AH.gb).getName(),10)||0;}if(AT!==AC){if(AI){AE=AI;AI=null;}AE.push(AK);if(AK.type===Y){AK.group=[];if(AH.gs&&AH.gs!==-1){AK.groupStyle=parseInt(x.getHeader(AH.gs).getName(),10);}AI=AE;AE=AK.group;}AT=AC;}else{AE.push(AK);}}else{z=false;}}if(AH.aid&&AH.aid!=-1&&AK){if(AH.gai&&AH.gai!=-1){AR=parseInt(x.getHeader(AH.gai).getName(),10)||0;}AP=parseInt(x.getHeader(AH.aid).getName(),10);if(AN!==AP||AR!==AK.gai||z){var AW={};AN=AP;if(AH.aid&&AH.aid!==-1){AW.id=parseInt(x.getHeader(AH.aid).getName(),10)||0;}if(AH.at&&AH.at!==-1){AW.title=x.getHeader(AH.at).getName();}else{if(AW.title===undefined){AW.title="";}}if(AH.av&&AH.av!==-1){AW.value=x.getHeader(AH.av).getName();}if(AH.ao&&AH.ao!==-1){AW.order=parseInt(x.getHeader(AH.ao).getName(),10)||0;}AW.o=AQ;if(!AK.answers[AR]){AK.answers[AR]=[];}if(!AK.dftAns){AK.dftAns={};}if(AH.sel>-1&&AH.aoa===I){var AL=AO.getMetricValue(AQ,AH.sel),AF=AL&&AL.getValue(),AU=L(AF);if(AK.type===Q||AK.type===S){AK.dftAns[AR]=AF;}else{if((AK.type===j||AK.type===w||AK.type===n||AK.type===N)&&AU){AK.dftAns[AR]=AW.value;}else{if(AK.type===D&&AU){AK.dftAns[AR]=!AK.dftAns[AR]?AW.value:AK.dftAns[AR]+","+AW.value;}}}}AK.answers[AR].push(AW);}}}return AJ;}function V(z,AA,x){var AB;if(z.isMetrics){AB='<cli cordinal="'+z.writeBackCol+'" metric_id="'+z.writeBackId+'"><updt types="2" rordinal="'+AA+'" value="'+mstrmojo.string.encodeXMLAttribute(String(x))+'" dt="9"/></cli>';}else{AB='<cli ax="1" attribute_id="'+z.writeBackId+'" form_id="'+z.writeBackFid+'"><updt types="1" ordinal="'+AA+'" value="'+mstrmojo.string.encodeXMLAttribute(String(x))+'" dt="9"/></cli>';}return AB;}mstrmojo.SurveyVis=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._Formattable,mstrmojo._CanSupportTransaction],{scriptClass:"mstrmojo.SurveyVis",markupString:'<div class="{@className} mstrmojo-SurveyVis" style="{@domNodeCssText}"><div class="body"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW"]},ko:null,dics:null,qId:1,update:function i(z){this._super(z);var AC=this.getDataParser(),x=this.model.vp,AA=R(AC,x),AB=J(AC,AA);this.ko={};this.dics=[];this.sec=parseInt(x.sec,10)>0;this.qId=1;this.stv=parseInt(x.suvt,10)>0;if(this.sec){this.set("children",[{scriptClass:"mstrmojo.PageNavigationPanel",title:AB.title,cssClass:"compact "+(p[x.cs]||""),headerVisible:this.stv,alias:"pageNav",prevText:"",nextText:"",panels:H.call(this,AB)}]);}else{if(this.stv){this.set("children",[{scriptClass:"mstrmojo.Box",alias:"pageNav",cssClass:"mstrmojo-PageNavPanel compact "+(p[x.cs]||""),onheightChange:function(){if(this.height){this.content.domNode.style.height=(parseInt(this.height,10)-this.header.domNode.offsetHeight)+"px";}},children:[{scriptClass:"mstrmojo.Box",cssClass:"header",alias:"header",children:[{scriptClass:"mstrmojo.Label",cssClass:"title",text:AB.title}]},{scriptClass:"mstrmojo.Box",cssClass:"content end",alias:"content",children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Section",children:B.call(this,AB.questions)}]}]}]);}else{this.set("children",B.call(this,AB.questions));}}this.cellInfo={writeBackId:x.sel,writeBackCol:AA.sel,writeBackFid:AA.fid,isMetrics:!!AA.aoa};},setModel:function q(x){this.set("model",x);this.txModel=x&&x.docModel;},getKeyContext:function G(x){return this.ko[x];},getUpdateObject:function K(){},postBuildRendering:function P(){this._super();if(this.height){if(this.pageNav){this.pageNav.set("height",this.height);}else{this.containerNode.style.maxHeight=this.height||"";this.containerNode.style.overflow="auto";}}},checkRequiredObjects:function F(){var z=this.dics,x=true;f.forEach(z,function(AA){if(AA.r===A&&AA.mdf!==1){x=false;b.addClass(AA.w.domNode,"required");}});return x;},updateValue:function W(z,AA){if(this._super){this._super(z,AA);}var AB=this.dics,x=f.find(AB,"k",z);if(x>-1){AB[x].mdf=1;b.removeClass(AB[x].w.domNode,"required");}},editNext:function a(AB){var AD=this.dics,x,AC,AA,z;x=f.find(AD,"k",AB);AC=this.dics[x];z=AC&&AC.s;if(x!==-1&&x<AD.length-1){AC=this.dics[x+1];AA=AC&&AC.w;if(AC&&(AC.s===z)&&AA&&AA.focus){AA.focus();}}},getUpdates:function M(){var AD=[],x=[],AH=this,AJ,z=0,AI,AB,AE,AC,AG=false,AA=this.getUpdatedValues(),AF,AK=this.cellInfo;AD.push('<gr rw_tree_type="'+this.defn.tt+'" rw_node_key="'+AH.k+'" slice_id="'+(AH.sid||0)+'">');for(AC in AA){if(AA.hasOwnProperty(AC)){AF=AA[AC];if(AF.qtp===Q||AF.qtp===S||(AF.qtp===N&&AF.vls.length===1)){AB=AF.vls[0].o;AD.push(V(AK,AB,AF.v));x.push('<mark rordinal="'+AB+'" types="4"/>');}else{if(AF.qtp===Z){AJ=AF.v.split(",");z=0;f.forEach(AJ,function(AL){AI=f.find(AF.vls,"v",AL)||0;AB=AF.vls[AI].o;z++;AD.push(V(AK,AB,z));x.push('<mark rordinal="'+AB+'" types="4"/>');});}else{if(AF.qtp===D){AJ=AF.v.split(",");f.forEach(AJ,function(AL){AI=f.find(AF.vls,"v",AL)||0;AB=AF.vls[AI].o;AD.push(V(AK,AB,AL));x.push('<mark rordinal="'+AB+'" types="4"/>');});}else{AI=f.find(AF.vls,"v",AF.v)||0;AB=AF.vls[AI].o;AD.push(V(AK,AB,AF.v));x.push('<mark rordinal="'+AB+'" types="4"/>');}}}AG=true;}}AD.push(x.join(""));AD.push("</gr>");if(!AG){AD=[];}return AD.join("");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo._Formattable","mstrmojo.VisChartUtils","mstrmojo.array","mstrmojo.date","mstrmojo.VisCalendar");var B=mstrmojo.date,E=mstrmojo.array,D=mstrmojo.dom,A=function(){return mstrmojo.locales.datetime;};function F(G){return G.getFullYear()+"_"+(G.getMonth()+1)+"_"+G.getDate();}function C(G){return{year:G.getFullYear(),month:G.getMonth()+1,day:G.getDate()};}mstrmojo.VisDateSelection=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._Formattable],{scriptClass:"mstrmojo.VisDateSelection",markupString:'<div id="{@id}" class="mstrmojo-Chart mstrmojo-visDateSelection {@cssClass}" style="{@domNodeCssText}"  mstrAttach:mouseover,mousemove><div></div><div class="mstrmojo-visDateSelection-msg"></div></div>',markupSlots:{calendarNode:function(){return this.domNode.firstChild;},msgNode:function(){return this.domNode.lastChild;}},markupMethods:{onerrMsgChange:function(){var G=this.msgNode,H=this.errMsg;G.style.display=H?"block":"none";G.innerHTML=H||"";}},formatHandlers:{domNode:["z-index","P","B","F","T","D"]},fmts:{},dfm:null,firstDayOfWeek:1,hilightToday:false,selectedColor:"#7FCEFF",update:function(G){if(!this.docModel){this.docModel=this.model.docModel?this.model.docModel:this.model;}this._super(G);},initFromVisProps:function(G){var J={Color:1,Boolean:2,Integer:3,FontIndex:4},K=["Arial","Arial Black","Comic Sans","Courier","Georgia","Impact","Monaco","Palatino","Tahoma","Times New Roman","Trebuchet MS","Verdana"],L={bgColor:{df:"0xFFFFFF",tp:J.Color},borderColor:{df:"0xAFAFAF",tp:J.Color},fDayType:{df:"8",tp:J.FontIndex},fDaySize:{df:"11",tp:J.Integer},fDayColor:{df:"0x000000",tp:J.Color},daybold:{df:"false",tp:J.Boolean},dayitalic:{df:"false",tp:J.Boolean},fHeaderType:{df:"8",tp:J.FontIndex},fHeaderSize:{df:"11",tp:J.Integer},fHeaderColor:{df:"0x000000",tp:J.Color},headerbold:{df:"false",tp:J.Boolean},headeritalic:{df:"false",tp:J.Boolean},fWeekDayType:{df:"8",tp:J.FontIndex},fWeekDaySize:{df:"11",tp:J.Integer},fWeekDayColor:{df:"0x000000",tp:J.Color},weekDaybold:{df:"true",tp:J.Boolean},weekDayitalic:{df:"false",tp:J.Boolean},rollColor:{df:"0x7fceff",tp:J.Color},selctedColor:{df:"0x98d8ff",tp:J.Color,p:"selectedColor"},fDayOfWeek:{df:"1",tp:J.Integer,p:"firstDayOfWeek"},showToday:{df:"false",tp:J.Boolean,p:"hilightToday"},inhSelectorFormat:{df:"false",tp:J.Boolean}},N=function(P,Q){if(Q==J.Boolean){P=(P.toUpperCase()=="TRUE");}else{if(Q==J.Integer){P=parseInt(P);}else{if(Q==J.Color){P="#"+(parseInt(P)+16777216).toString(16).substring(1);}else{if(Q==J.FontIndex){P=K[P];}}}}return P;};for(var I in L){var M=L[I],O=(G&&G[I])||M.df,H=M.p||I;this.set(H,N(O,M.tp));}},_resolveCGBToTKS:function(H){var L=this.dfm.sc,K=L&&L.cgb;for(var I in K){var J=K[I],G=H[J];if(G){if(!L.tks){L.tks=G;}else{if(L.tks&&(L.tks.indexOf(G)<0)){L.tks+="\u001E"+G;}}}}},onCGBMapChange:function(G){this._resolveCGBToTKS(G.cgbMap);},postBuildRendering:function(){this.dfm=null;var I=this.model.gts;if(I){var K=(I.row||[]).concat(I.col||[]);var Y=0,M=0,L=0,Z=K&&K.length,Q=null,T=null;for(;Y<Z;Y++){Q=K[Y];if(Q.otp!=-1){M++;if(Q.es){L++;T=Q;}}}this.dfm=(L==1&&M==1)?T:null;}this.set("errMsg",this.model.eg||(this.dfm?"":"The Date Selection widget requires exactly one attribute with a Date form"));if(!this.dfm){return ;}var W=this.docModel;if(W){if(W.getCGBMap){this._resolveCGBToTKS(this.docModel.getCGBMap());}if(W.attachEventListener){W.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");}}var P=this.dfm,b=P.es,T={},G=[],H=P.sc,V=H&&H.ces,O=function(g){return new Date(mstrmojo.VisChartUtils.convertRawValueToMilliseconds(g));},R=(b&&b.length)||0,X=(R&&b[0].rv)?O(b[0].rv):null,U=X;for(var Y=0;Y<R;Y++){var a=O(b[Y].rv),f=C(a);T[F(a)]=b[Y].id||true;if(B.compareDate(X,f)<=0){X=f;}if(B.compareDate(U,f)>=0){U=f;}if(E.find(V,"id",b[Y].id)>=0){G.push(f);}}T.length=b&&b.length;if(X){T.max=X;}var N=this.docModel.zf||this.zoomFactor||1,J=function(k,j,g,h,i){return"font:"+(k?"italic ":"")+(j?"bold ":"")+(g*N)+"px "+h+";color:"+i+";";},S=J(this.headeritalic,this.headerbold,this.fHeaderSize,this.fHeaderType,this.fHeaderColor);mstrmojo.insert({scriptClass:"mstrmojo.VisCalendar",placeholder:this.calendarNode,availableDates:T,isMultiSelect:true,forceNonEmptySelection:!(H&&H.all),selectedDates:G,selectedColor:this.selectedColor,rollColor:this.rollColor,hilightToday:this.hilightToday,firstDayOfWeek:this.firstDayOfWeek+1,min:B.formatDateInfo(U,A().DATEOUTPUTFORMAT),max:B.formatDateInfo(X,A().DATEOUTPUTFORMAT),showCurMonthDatesOnly:true,cssTextHeader:S+"line-height:"+198*0.1414*N+"px;",cssTextMonthYearLabel:"padding-bottom:"+3*N+"px;border-bottom-width:"+N+"px;line-height:"+this.fHeaderSize*N+"px;background-size:"+N+"px;",cssTextDay:J(this.dayitalic,this.daybold,this.fDaySize,this.fDayType,this.fDayColor),cssTextMonth:S,cssTextYear:S,cssTextWeekDay:J(this.weekDayitalic,this.weekDaybold,this.fWeekDaySize,this.fWeekDayType,this.fWeekDayColor),cssTextBody:"border-top-color:"+this.borderColor+";",cssText:"width:"+198*N+"px;height:"+198*N+"px;background-color:"+this.bgColor+";border-color:"+this.borderColor+";",container:this}).render();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});},ENUM_STATES:{UNDETERMINED:F,VALID:E,INVALID:D}}));}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.Enum_Keys","mstrmojo.hash","mstrmojo.dom");var E=mstrmojo.dom,B=mstrmojo.Enum_Keys,H=200,M;var L={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var N="mstrmojo-SimpleObjectInputBox-del";function I(){var V=this.inputBox,W=V.value;if(W!==this._lastPattern){this.showSuggestion(W);}this._lastPattern=W;delete this._timerHandle;}function U(){var V=this._timerHandle;if(V){window.clearTimeout(V);delete this._timerHandle;}}function P(){var X=this.maxObjectCount,V=(this.items&&this.items.length)||0,W=(X!=null&&V>=X);this.set("state",!V?L.EMPTY:(W?L.FULL:L.DEFAULT));}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur style="display: none;" /></div><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@emptyText}</div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;},emptyTextNode:function(){return this.domNode.childNodes[1];},inputBox:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function Q(){var V=this.maxItemWidth;if(!isNaN(V)){V+="px";}this.emptyTextNode.style.maxWidth=V;}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,maxObjectCount:null,getItemMarkup:function(V){if(!M){var W=this.itemField;M=this._super(V).replace(">{@n}<",' title="{@'+W+'}"><div class="elem">{@'+W+'}<div class="'+N+'"></div></div><');}return M;},getItemProps:function R(Y,V){var W=this._super(Y,V),Z=this.itemField;W[Z]=Y[Z];var X=this.maxItemWidth;if(!isNaN(X)){X=(X-24)+"px";}W.addStyle("max-width:"+X);return W;},getSuggestionPos:function K(){var V=this._inputPos;return{target:this.inputBox,left:V.x,top:V.y+V.h,zIndex:100};},getSearchPattern:function T(){return this.inputBox.value;},onSuggestionItemSelect:function F(V){U.call(this);this.set("items",this.items.concat(V));this._super();var W=this.id;window.setTimeout(function(){var X=mstrmojo.all[W];if(X.state!=L.FULL){X.set("state",L.ADDING);}},0);},onstateChange:function A(W){var X=W.value;this.emptyTextNode.style.display=(X===L.EMPTY)?"block":"none";var V=this.inputBox,Y=V.style,Z=this.itemsContainerNode;if(X===L.ADDING){Y.display="";V.focus();this._inputPos=E.position(V,true);}else{U.call(this);Y.display="none";V.value="";this._lastPattern="";}},postBuildRendering:function O(){P.call(this);return this._super();},preitemsChange:function J(){P.call(this);},onclick:function S(W){var Z=E.eventTarget(W.hWin,W.e);if(Z&&Z.className===N){var Y=E.findAncestorByAttr(Z,"idx",true,this.domNode),V=Y&&parseInt(Y.value,10);if(V!==null&&!isNaN(V)){var X=this.items.concat();X.splice(V,1);this.set("items",X);}return ;}if(this.state!=L.FULL){this.set("state",L.ADDING);}},onblur:function D(){U.call(this);if(!this.suggestionShown){P.call(this);}},prekeydown:function C(V){var Y=V.e;switch(parseInt(Y.keyCode||Y.charCode,10)){case B.DOWN_ARROW:this.nextHighlight();break;case B.UP_ARROW:this.preHighlight();break;case B.TAB:case B.ENTER:E.preventDefault(V.hWin,Y);var X=this.getSelected();if(X){this.handleSuggestionItemSelect(X);}else{this.hideSuggestion();P.call(this);}break;case B.ESCAPE:U.call(this);this.hideSuggestion();P.call(this);break;case B.BACKSPACE:if(!this.getSearchPattern()){E.preventDefault(V.hWin,Y);var W=this.items&&this.items.concat();if(W&&W.length){W.splice(W.length-1,1);this.set("items",W);var Z=this.id;window.setTimeout(function(){mstrmojo.all[Z].set("state",L.ADDING);},0);}}break;}},prekeyup:function G(){if(this.useKeyDelay){var V=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){I.call(mstrmojo.all[V]);},H);}}else{I.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox");var I=mstrmojo.array,G=mstrmojo.dom,C=mstrConfig.thousandsSep;if(C===undefined){C=",";}var B=2147762227,D=2147762262,J=2147762269,E=140;var N;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{getItemMarkup:function(Q,P){if(!N){N=this._super(Q,P).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return N;},getItemProps:function K(R,P){var Q=this._super(R,P),S=R.wt;Q.weight=(S)?"<em>("+mstrmojo.num.addSeparators(S,C)+" likes)</em>":"";return Q;}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-SearchBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",suggestionListClass:"mstrmojo.SearchBoxSelectorList",postCreate:function M(){var P=this.suggestionPopup;P.cssClass="mstrmojo-SearchBoxSelector-suggest";P.nudge=function(){var R=this.editorNode;if(!R){return ;}var Q=Math.min(R.offsetHeight,E),T=R.offsetWidth,W=G.windowDim(),V=this.left,U=this.top;if(U+Q>=W.h){U-=Q;}if(V+T>=W.w){V-=T;}var S=R.style;S.top=U+"px";S.left=V+"px";};},preBuildRendering:function L(){this.set("maxItemWidth",this.parent.contentNode.offsetWidth);this._super();},postBuildRendering:function A(){var P=this.parent.defn.fmts;if(!P.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function H(Q,T,P){var U=Q,R=this.suggestCount;if(!this.noCache){P=P||R;T=mstrmojo.string.regEscape(T);var V=this.itemField,S=new RegExp("^"+T,"i");U=I.filter(Q,function(W){return S.test(W[V]);},{max:P});}if(U.length){I.forEach(this.items,function(X){var W=I.find(U,"v",X.v);if(W>-1){U.splice(W,1);}});}if(U.length>=R){U=U.slice(0,R);}return U;},getCandidatesThroughTaskCall:function O(S,V){var P=this.id,R=this.getSuggestionTarget(),Q=S.pattern||"",X=this.parent,W=this.srcid;Q=Q.replace(/"/,"");if(W){var T={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:W,dataSourcesXML:this.dsrc||"",blockCount:this.REQUEST_THRESHOLD,searchPattern:Q,browseFlags:1};var U=X.defn;if(U.dsid){T.datasetID=U.dsid;T.messageID=X.model.mid;T.ctlKey=X.ckey;}if(U.sfid){T.searchForms=U.sfid;if(parseInt(U.sfdt,10)===8){T.searchPattern+="*";}}V.success=function(b){if(b&&b.es){var g=mstrmojo.all[P],h=g.getSuggestionTarget(),Y=b.es.length;if(!b||!h||(R!==h)){return ;}if(Y&&(Y>g.suggestCount)){return ;}var a=h.getSearchPattern(),Z=b.es;if(W){Z=mstrmojo.elementHelper.buildElemsTerseID(Z,W,true);}var f=S.pattern;g._last_hit={items:Z,pattern:f};if(a&&a.indexOf(f)>-1){g.updateSuggestion(g.filterCandidates(Z,a));}}};V.failure=function(Z){var Y=parseInt(Z.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296;if(Y!==B&&Y!==D&&Y!==J){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,T,false,null,true);}},onsuggestionItemsChange:function F(){var U=this.suggestionItems,R=this.suggestionPopup,Q=R.editorNode,S=U&&(U.length>8),P="",T="";if(S){P=E;T="px";}if(Q){Q.style.height=P+T;}else{if(S){T+=";";R.cssText=(R.cssText||"")+"height:"+P+T;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AE=mstrmojo.Enum_OIB_States,AD={},AF;for(AF in AE){if(AE.hasOwnProperty(AF)){AD[String(AE[AF])]=AF;}}return AD;}());var P=mstrmojo.dom,R=mstrmojo.hash,X=mstrmojo.Enum_OIB_States,I=0,Z="_did_",AA=mstrmojo.Enum_Keys,AC=80,T=200;function O(){return I++;}function h(AD){return(AD&&AD.state===X.ADDING);}function p(AD){var AE={n:AD||"",state:X.EMPTY};AE[Z]=-2;return AE;}function N(AD){return(AD&&AD.state===X.EMPTY);}function w(AE){var AF=AE.items,AD=AF&&AF.length;if(!AD){return true;}return(AD===1&&h(AF[0]))||(AD===2&&N(AF[0])&&h(AF[1]));}function k(){var AE=this.ctxtBuilder.itemWidgets,AD=AE[AE.length-1];if(AD&&AD.isAdding){return AD;}return null;}function K(){var AD=this.editingIdx;if(AD!==null){return this.ctxtBuilder.itemWidgets[AD];}return k.call(this);}function D(){this.isActive=false;var AE=this.emptyText||"",AF=this.items;if(w(this)&&!N(AF[0])&&(AE.length>0)){this.add([p(AE)],0);var AG=this.ctxtBuilder.itemWidgets[0];AG.set("shouldEllipsize",true);AG.doEllipsize();}var AD=K.call(this);if(AD){if(h(AD)){AD.domNode.style.display="none";}this.scrollTo(this.items[0]);AD.blur();}P.detachEvent(document.body,"mousedown",this._mousedownHandler);}function M(){this.isActive=true;if(N(this.items[0])){this.remove(0);}var AD=K.call(this);if(AD){if(h(AD)&&!this.isFull){AD.domNode.style.display="block";}this.scrollTo(AD.data);AD.focus();}P.attachEvent(document.body,"mousedown",this._mousedownHandler);}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,getSearchPattern:function(){var AD=K.call(this);if(AD){return AD.getSearchPattern();}return"";},getSuggestionTarget:function l(){return this.suggestTarget;},onsuggestTargetChanged:function o(AD){this._request_pattern=null;},getSuggestionPos:function a(){return this._pop_cfg;},onSuggestionItemSelect:function x(AD){this.suggestTarget.setItem(AD[this.itemField],AD,false);this.hideSuggestion();},hideEditButton:function(AD){return !!this.noEditButton;},_set_items:function j(AI,AF){AF=AF||[];var AH=this.maxObjectCount;this.set("isFull",(AH&&AF.length>=AH));if(AF.length===0){var AE=this.emptyText||"";if(AE.length>0){AF.push(p(AE));}}var AG={n:"",state:X.ADDING};AG[Z]=-1;AF.push(AG);var AD=AF[AF.length-1];if(AD&&h(AD)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=Z;return this._super(AI,AF);},add:function E(AE,AD){var AF=k.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AE,AD);}if(!w(this)&&N(this.items[0])){this.remove(0);}if(AF){AF.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);}}AF.domNode.style.display="none";},remove:function Y(AD){this._super(AD);var AE=k.call(this);if(AE){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AE.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function W(){this._super();var AE=this,AD=k.call(AE);if(AD){AD.domNode.style.display="none";}this._clickHandler=function(){M.call(AE);};this._mousedownHandler=function(AF){if(!AE.isActive||AE.browserShown){return ;}var AG=P.eventTarget(self,AF);if(AG&&AG.parentNode&&!P.contains(AE.domNode,AG,false,document.body)&&!P.contains(AE.suggestionPopup.domNode,AG,false,document.body)){D.call(AE);}};P.attachEvent(this.domNode,"click",this._clickHandler);},nextId:O,item2textCss:function L(AD){return AD.cssClass||"";},itemFunction:function G(AI,AE,AG){AI[AG.itemIdField]=O();var AJ=new mstrmojo.ObjectItem({parent:AG,itemField:AG.itemField,cssClass:AG.item2textCss(AI),data:AI});var AF=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AD=AF.length,AH;for(AH=0;AH<AD;AH++){AJ.attachEventListener(AF[AH],AG.id,"_itemChangeHandler");}return AJ;},getSelectedObjects:function i(){if(w(this)){return[];}var AD=this.items,AE=AD.length-1;if((AE>-1)&&h(AD[AE])){return AD.slice(0,AE);}return AD.concat();},isValid:function C(){var AE=this.ctxtBuilder.itemWidgets,AD=AE&&AE.length,AF;for(AF=0;AF<AD;AF++){if(!AE[AF].isValid()){return false;}}return true;},_itemChangeHandler:function(AG){var AI=AG.name,AJ=AG.d,AE,AD=this.items.length,AF;switch(AI){case"ItemEditBegin":if(this.editingIdx!==null){AF=K.call(this);if(AF){AF.blur();}}AE=this.itemIndex(AJ);this.editingIdx=AE;M.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AG.deactivate){D.call(this);}else{M.call(this);}AF=k.call(this);if(AF){AF.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AF=K.call(this);if(AF){AF.blur();}this.editingIdx=null;}AE=this.itemIndex(AJ);this.remove(AE);if(!AG.deactivate){this.editingIdx=null;M.call(this);}else{if(!this.isActive){D.call(this);}else{M.call(this);}}break;case"ItemDeletePrev":if(AD>1){this.remove(AD-2);}break;case"ItemAdd":var AH=R.copy(AG.d);this.add([AH],AD-1);if(AG.deactivate){D.call(this);}else{M.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AG.target);this._pop_cfg={target:AG.target,left:AG.l,top:AG.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AG.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AI==="ItemEditEnd"||AI==="ItemAdd"||AI==="ItemDelete"||AI==="ItemDeletePrev"||AI==="ItemEditing")){this.onitemchange();}},unrender:function B(AE){var AD=this.suggestionPopup;if(AD.hasRendered){AD.unrender(false);}if(this._super){this._super(AE);}},destroy:function t(AE){var AD=this.suggestionPopup;if(AD&&AD.hasRendered){AD.destroy(false);}if(this._super){this._super(AE);}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var q="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span class="'+q+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=q+" "+this.cssClass;},onstateChange:function(){var AG=this.state,AF=mstrmojo.Enum_OIB_States_CSS[AG],AE=this.domNode;if(AG===X.EMPTY){AE.innerHTML='<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>";}else{if(AG===X.EDITING){var AD=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AD-4+"px";this.inputNode.style.width=AD-9+"px";}}AE.className="mstrmojo-ObjectItem "+AF;if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},state:X.VALID,onstateChange:function f(AD){this.data.state=this.state;},ontextChange:function H(AD){this.data[this.itemField]=this.text;},updateData:function F(AD){R.copy(AD,this.data);this.set("state",X.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function z(AE){this._super(AE);var AG=this.data,AD=AG.state,AF=this.parent;if(typeof AD==="undefined"){AD=AF.dynamicVerify?AF.verifyObject(AG[this.itemField],this):X.UNDETERMINED;AG.state=AD;}this.cssClass=AF.item2textCss(AG);this.text=AG[this.itemField];this.state=AD;this.isAdding=h(AG);this.useRichTooltip=true;},isValid:function C(){var AD=parseInt(this.state,10);return(AD!==X.INVALID&&AD!==X.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AG=this.inputNode.style;AG.width=AC+"px";var AF=this.domNode.parentNode,AD=AF.parentNode.offsetWidth,AE=Math.max(AD-AF.offsetLeft-20,AC);if(!isNaN(AE)){AG.width=AE+"px";}}},blur:function S(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AF=this.inputNode,AD=AF.value,AE=this.parent;window.setTimeout(function(){try{AF.blur();}catch(AG){}},0);if(!AD){return ;}if(AE.acptSugItemOnly){this.set("text",AD);this.set("text","");this._tWas_=null;return ;}this.setItem(AD,null,true);},focus:function s(){var AE=this.inputNode,AD=this.isActive;window.setTimeout(function(){try{AE.focus();if(AE.createTextRange&&!AD){var AG=AE.createTextRange(),AF=AE.value.length;AG.move("character",AF);AG.select();}}catch(AH){}},0);this.isActive=true;},prekeydown:function J(AD){var AF=this.inputNode.value,AE=parseInt(AD.e.keyCode||AD.e.charCode,10),AH=this.parent;if(!AF){return ;}if(AE===AA.TAB||AE===AA.ENTER){P.preventDefault(AD.hWin,AD.e);var AG=AH.getSelected();if(AG){AH.handleSuggestionItemSelect(AG);}else{this.hideSuggestion();if(!AH.acptSugItemOnly){this.setItem(AF,null,false);}else{this.set("text",AF);this.set("text","");}}}else{if(AE===AA.DOWN_ARROW){if(!AH.noCache){this.showSuggestion(AF);}AH.nextHighlight();}else{if(AE===AA.UP_ARROW){AH.preHighlight();}}}},prekeyup:function AB(AD){var AF=this.inputNode.value,AE=parseInt(AD.e.keyCode||AD.e.charCode,10),AI=this.isAdding,AH=this.parent;if(!AF){if(AI){if(AE===AA.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});P.preventDefault(AD.hWin,AD.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AE===AA.ESCAPE){this.hideSuggestion();if(AH.acptSugItemOnly){this.set("text",AF);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AF){this.raiseEvent({name:"ItemEditing",d:this.data});if(AH.useKeyDelay){if(!this._timerID){var AG=this;this._timerID=window.setTimeout(function(){var AJ=AG.inputNode.value;if(AJ){AG.showSuggestion(AJ);}AG._timerID=null;},T);}}else{this.showSuggestion(AF);}}}this._tWas_=AF;},setItem:function(AD,AF,AE){var AH=this.isAdding,AG=this.parent;AE=AE||false;this.set("text",AD);this._tWas_=null;if(AH){this.set("text","");if(!AF){AF={};AF[this.itemField]=AD;}else{AF.state=X.VALID;}this.raiseEvent({name:"ItemAdd",d:AF,deactivate:AE});}else{this.set("text",AD);if(AF){this.updateData(AF);}else{this.set("state",AG.verifyObject(AD,this));this.set("cssClass",AG.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AF,deactivate:AE});}},getSearchPattern:function U(){return this.inputNode.value;},showSuggestion:function n(AD){var AE=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AE.x)+"px",t:Math.round(AE.y+AE.h)+"px",pattern:AD,target:this});},hideSuggestion:function g(){this.raiseEvent({name:"SuggestionOff"});},del:function Q(AD){AD=AD||self.event;P.stopPropogation(self,AD);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function V(){this.showSuggestion(this.text);this.set("state",X.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});},doEllipsize:function b(){if(!this.shouldEllipsize){return ;}var AE=this.maxItemWidth,AD;if(AE){this.domNode.style.maxWidth=AE;switch(parseInt(this.state,10)){case X.VALID:case X.UNDETERMINED:case X.INVALID:AD=this.textNode;break;case X.EMPTY:AD=this.domNode.firstChild;break;}if(AD){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AD,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DynamicClassFactory","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo.SurveyVis","mstrmojo.VisDateSelection");var B={SurveyVisualizationStyle:{s:"VisualizationDataStyle",c:"SurveyVis"},visAjaxDatePicker:{s:"AjaxDatePickerReportStyle",c:"VisDateSelection"}};mstrmojo.ExpressVisList=mstrmojo.provide("mstrmojo.ExpressVisList",{getVis:function C(D){return B[D]||null;},getVisClass:function A(D,E){if(E.txi&&E.t===115){D=mstrmojo.DynamicClassFactory.newComponent(D,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getContentThroughTaskCall:function C(F,D){var E=mstrmojo.ACL.UserDataService;if(F.isRoot){E.getTopLevelGroups(F,D);}else{E.getMembers(F,D);}},isBranch:function B(D){return D.isGroup;},item2textCss:function A(D){return(this._super&&this._super(D))||{8704:"u",8705:"ug"}[D.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{item2textCss:function A(C){return(this._super&&this._super(C))||{8704:"u",8705:"ug"}[C.st]||"";},getCandidatesThroughTaskCall:function B(D,C){mstrmojo.ACL.UserDataService.searchUserCandidates(D.pattern,!D.isVerify,D.blockCount,C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.Label","mstrmojo.hash","mstrmojo.array");var O=mstrmojo.hash,L=mstrmojo.array,C=mstrmojo.emptyFn;var B=0,R=1,Q=2,W=3,I=4,S=5,F=6,M=7,Y=8,U=9;var E=2;var V=1,X=3;var K="u;";var P={};P[M]="MetricSlider";P[Y]="MetricQualification";P[U]="SearchBoxSelector";function A(b,a,l,n,o,Z){switch(a){case B:b.idx=O.any(o,true);var g=(typeof (b.idx)==="undefined"||b.idx<0);if(g){if(L.find(Z,"v","-1")<0){Z=[{v:"-1",n:""}].concat(Z);}b.idx="0";}b.unset=!!g;b.options=Z;break;case Y:case M:if(b.updateData){b.updateData({low:l.min,high:l.max,cnt:l.cnt,nov:l.nov},{cs:l.cs,f:l.f,ft:l.ft,qua:l.qt});}b.items=Z;b.selectedIndices=o;break;case U:if(Z&&!n.sos){b.candidates={isComplete:true,items:n.srcid?Z:[]};}if(n.srcid){var h=[],j=l.ces;if(j&&j.constructor===Array){if(n.dfm==V){for(var k=0;k<j.length;k++){if(j[k]["t"]!=X){h.push(j[k]);}}}else{h=j.concat();}}if(!n.sos){var f=mstrmojo.array,p=[];f.forEach(h,function(i){if(f.find(b.candidates.items,"v",i.v)>-1){p.push(i);}});h=p;}b.items=h;}break;default:b.items=Z;b.selectedIndices=o;break;}}mstrmojo.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocSelectorViewFactory",newPulldown:C,attachTargetListeners:C,getSelectorClass:function J(b,a){var Z=P[b];if(Z.constructor===Array){Z=Z[(a)?0:1];}return Z;},isSelectorSupported:function T(){return true;},newSelector:function H(s){var f=s.children,b=f&&f[0],n=s.style,k=s.selIdx,g=s.node,p=g.defn,l=g.data,Z=l.elms,a;if(!this.isSelectorSupported(s)){return null;}if(!b){if(!b){var i=s._cekEvtListener,t=s.id,q;if(i){p.detachEventListener(i);delete s._cekEvtListener;}if(n===B){b=this.newPulldown(s);q=function(w){a=this.options;if(L.find(a,"v",w.value)<0){if(L.find(a,"v","-1")<0){a.unshift({v:"-1",n:""});}b.idx="0";b.options=a;b.unset=true;s._inSyncPhase=true;b.refresh();s._inSyncPhase=false;}else{b.set("value",w.value);}};t=b.id;}else{var o=this.getSelectorCtrlConfig(s,n,p,Z),j=o.scriptClass;if(!j){b=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{delete o.scriptClass;var h=O.walk(j,mstrmojo);b=new h(o);if(n===M){s.attachEventListener("includeChange",b.id,function(w){this.set("include",w.value);this.selectRange();});}if(n===M||n===Y){s.attachEventListener("quaChange",b.id,function(w){this.set("qua",w.value);});q=function(w){if(s.id!==w.value.id){s._inSyncPhase=true;b.updateExpr(w.value);if(s.style===M){s.set("include",w.value.include);}s._inSyncPhase=false;}};}else{q=function(w){var x=[];a=this.node.data.elms;L.forEach(w.value,function(AA){var z=L.find(a,"v",AA);if(z>-1){x.push(z);}});this._inSyncPhase=true;b.select(x);this._inSyncPhase=false;};}}}if(q){s._cekEvtListener=p.attachEventListener("cekChange",t,q);}}s.addChildren(b);}A(b,s.style,l,p,k,Z);return b;},getSelectorCtrlConfig:function N(j,f,h,Z){var k=h.horiz,i=j.getFormats(),l=i&&i.height,a=O.copyProps,b=j.node.data,g={scriptClass:this.getSelectorClass(f,k),multiSelect:h.multi,isHoriz:k,include:h.include,itemWidthMode:h.iwm,allIdx:L.find(Z,"v",K),noneIdx:h.include?-1:L.find(Z,"v",K),renderAllItems:!l,onchange:function(){if(!j._inSyncPhase){j.selectorControlChange(this);}},makeSelection:function(n){if(!j._inSyncPhase){j.showInfoWin(n&&n.selItem);}}};if(g.noneIdx!==-1){g.allIdx=-1;}if(f===R||f===M){j.extCls="extSlider";if(h.cek){h.include=h.cek.include;b.cs=h.cek.cs;b.f=h.cek.f;b.ft=h.cek.ft;j.qua=h.cek.qua;}}if(f===R){a(["height","width"],i,g);}else{if(f===Y||f===M){if(f===M){g.isHoriz=true;g.include=h.include;}a(["height","width","font"],i,g);a(["cs","ft"],h,g);g.fmts=h.f;g.qua=j.qua;g.numFmts=h.numFmts;}else{if(f===U){g={scriptClass:g.scriptClass,cssText:i.height?"height: "+i.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(h.ttl||""),items:h.srcid?(b.ces?b.ces.concat():[]):[],REQUEST_THRESHOLD:55,suggestCount:50,srcid:h.srcid||"",dsrc:h.dsrc||"",onitemsChange:function(){if(!j._inSyncPhase){j.showInfoWin();j.selectorControlChange(this);}}};if(Z&&!h.sos){g.candidates={isComplete:true,items:h.srcid?Z:[]};}else{g.useKeyDelay=true;g.noCache=true;}if(!h.multi){g.maxObjectCount=1;}}}}return g;},updateControlStyles:function D(a){if(a.isInFilterPanel()&&!a.isHorizFP()){var Z=a.style;if(Z===R||Z===Y||M){a.children[0].width=a.parent.parent.contentWidth;}}}});var G=mstrmojo.DocSelectorViewFactory;G.STYLES={PULLDOWN:B,SCROLLER:R,LIST:Q,RADIO:W,CHECKBOX:I,BUTTON:S,LINK:F,METRIC_SLIDER:M,METRIC_QUAL:Y,SEARCH_BOX:U};G.ELEM_ALL=K;G.UC_ON_DS=E;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.DocSelectorViewFactory","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper");var L=mstrmojo.array,P=mstrmojo.hash,V=mstrmojo.dom,Y=mstrmojo.DocSelectorViewFactory.STYLES,S=mstrmojo.DocSelectorViewFactory.ELEM_ALL,M=mstrmojo.elementHelper;var F=mstrmojo.DocSelectorViewFactory.UC_ON_DS;function H(){return{type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,disablePU:(parseInt(this.defn.subTp,10)===F)};}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" class="mstrmojo-DocSelector {@extCls}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100; position:absolute; top:0px; left:0px; width:100%; height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onincludeChange:function(){mstrmojo.css.toggleClass(this.domNode,"strikeout",!this.include);},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwaitChange:function(){this.wIconNode.style.display=((this.wait)?"block":"none");}},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",bGetElems:false,init:function U(b){this._super(b);var a=this.node.defn.style;this.spm=(a===Y.METRIC_QUAL||a===Y.METRIC_SLIDER);},initControlInfo:function I(){var g=this.node,h=g.data,k=g.defn,a=h.elms,i=h.ces,b=k.style;var l=["include","ckey","ck","tks","style","multi","showall"];if(!this.bGetElems&&parseInt(k.subTp,10)===F&&b!==Y.SEARCH_BOX){this._fetchAllElems();a=h.elms;}if(b===Y.METRIC_QUAL||b===Y.METRIC_SLIDER){l=l.concat(["srcid","srct"]);this.qua=h.qt;this.dt=h.dt;}this.type=k.ct;var n=k.fmts;if(n){var o=n.width;if(!o||parseInt(o,10)<=0){n.width="95px";}}P.copyProps(l,k,this);var f=this.selIdx={},j=k.multi;if(this.include&&j&&L.find(i,"v",S)>-1){i=a;}if(i){L.forEach(a,function(q,p){if(L.find(i,"v",q.v)>=0){f[p]=true;}});}},resetFormatHandlers:function A(){this.formatHandlers={contentNode:["RW"]};},selectorControlChange:function O(b){var AE=H.call(this),AF="\u001E",f=[],AC=this.style,z=this.defn.sec,AA;switch(AC){case Y.PULLDOWN:var w=b.value,t=null;if(b.selectNode){var AD=b.selectNode;t=AD.options[AD.selectedIndex].text;}AE.eid=w;if(parseInt(AE.type,10)===1&&t!==null){AE.eid=AE.eid+";"+t;}this.defn.set("cek",w);this.currSelValue=w;if(z){this.parent.set("count",M.buildElemsCountStr([w],this.node.data.elms));}break;case Y.SEARCH_BOX:L.forEach(b.items,function(i){f.push(i.v+";"+i.n);});if(!f.length&&this.showall){f.push("u;");}AE.eid=f.join(AF);if(z){this.parent.set("count",M.buildElemsCountStr(f,this.node.data.elms));}break;case Y.METRIC_QUAL:case Y.METRIC_SLIDER:if(this.srcid===undefined){return ;}var g=[];L.forEach(b.cs,function(i){g.push(i.v);if(AE.dtp===undefined){AE.dtp=i.dtp;}});if(g.length){AE.cs=g.join(AF);}var a=mstrmojo.MCSUtil.getFuncInfo(b.opId,b.qua);AE.f=b.f=a.f;AE.ft=b.ft=a.ft;AE.include=b.include=this.include;AE.ckey=this.ckey;AE.srcid=this.srcid;AE.srct=this.srct;AE.unset=b.unSet;AE.onlyInclude=b.onlyInclude;AE.changeQual=b.changeQual;AE.qt=b.qua;this.node.defn.set("cek",{id:this.id,f:b.f,ft:b.ft,cs:b.cs,qua:b.qua,include:b.include});break;default:var x=this.node,q=x.data.elms,h=b.selectedIndices,p=b.allIdx,l=!!h[p],k=[],o=this.include;if(l){f=[q[p].v];k=[q[p].v];}else{if(h[p]){h[p]=false;}var AB=P.keyarray(h,true).sort(L.numSorter),s={};for(AA in AB){s[AB[AA]]=h[AB[AA]];}h=s;P.forEach(h,function(n,i){if(n){f.push(q[i].v);k.push(q[i].v+";"+q[i].n);}});}AE.eid=((parseInt(AE.type,10)===1)?k:f).join(AF);var j=mstrmojo.dom.position(b.domNode,true);if(j){AE.left=j.x;AE.top=j.y;}if(l&&this.multi&&o){L.forEach(q,function(n){var i=n.v;if(f[0]!==i){f.push(i);}});}x.defn.set("cek",f);if(z&&AC!==Y.SCROLLER){this.parent.set("count",M.buildElemsCountStr(f,q));}break;}var AG=this;window.setTimeout(function(){AG.slice(AE);},0);},showInfoWin:function Q(h){var b=this.model,f=b.getTargetInfoWin(this.tks);if(f&&f.length){var n=this.defn.horiz,a=h||this.contentNode,j=V.position(a),l=V.position(this.contentNode),k=(n||this.defn.style==Y.SCROLLER)?null:{x:l.x,y:j.y,w:l.w,h:j.h};for(var g=0;g<f.length;g++){b.showInfoWin(f[g],a,n?"v":"h",false,P.copy(k));}}},preBuildRendering:function G(){var g=true,h=this.node.defn.style,f=P.clone(this.formatHandlers),b=f.contentNode;if(b){if((h===Y.RADIO||h===Y.CHECKBOX)&&f.filterNode){b.push("fx");b.push("background-color");delete f.filterNode;}if(h===Y.LIST){delete b.height;}if(h===Y.SEARCH_BOX){var i=f.domNode;L.removeItem(i,"color");var a=L.indexOf(i,"F");if(a>-1){L.removeIndices(i,a,1);i.push("font");}}}this.formatHandlers=f;g=this._super();this.builder.selectorFactory.updateControlStyles(this);return g;},postBuildRendering:function X(){var g=this.node.defn.style,i=this.filterNode.style,a=this.contentNode,b=this.node.defn;this._super();if(this.formatHandlers.filterNode){var h=this.getFormats();if(!h.width){i.width=a.clientWidth+"px";}if(!h.height){i.height=a.clientHeight+"px";if(g===Y.METRIC_QUAL||g===Y.METRIC_SLIDER){this.updateHeight();}}else{if(g===Y.METRIC_QUAL){a.style.height=h.height;}}}else{i.display="none";}if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(b.ds,10)===0);}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");this.builder.selectorFactory.attachTargetListeners(this);if(V.isAndroid&&g===Y.SCROLLER){a.style.overflow="visible";}return true;},_fetchAllElems:function J(){var a=this.node.defn,g=this.node.data;var h={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:a.srcid||"",dataSourcesXML:a.dsrc||"",browseFlags:1};var f=this,b={success:function(i){f.bGetElems=true;f.set("wait",false);if(i&&i.es){g.elms=(a.srcid)?M.buildElemsTerseID(i.es,a.srcid,true):i.es;var j=f.parent,k=j&&j.parent;if(g.ces&&g.elms&&g.elms.length>0&&j){j.set("count",M.buildElemsCountStr(g.ces,g.elms));}if(f.hasRendered){f.refresh();if(f.isInFilterPanel()){if(j&&j.defn.ttl){j.updateContentHeight();}if(k&&k.refreshFP){k.refreshFP();}}}}},failure:function(i){mstrmojo.alert(i.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.set("wait",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,b,h,false,null,true);},updateHeight:function B(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var a=this.parent;if(a&&(a.defn.ttl!==undefined)&&a.updateContentHeight){a.updateContentHeight();}},onCGBMapChange:function D(b){var a=b.cgbMap;if(!a){return ;}var f=this.tks;P.forEach(this.defn.cgb,function(h){var g=a[h];if(g&&f.indexOf(g)<0){f+="\u001E"+g;}});this.tks=f;},update:function K(h){this.node=h;var k=this.node.defn,b=k.style,a=this.node.data.elms,l=this.parent,g=(b===Y.SCROLLER);if(g&&k.multi){var f=L.find(a,"v",S);if(f>-1){L.removeIndices(a,f,1);}}if(k.sec&&!g&&!k.sos){var i=h.data.ces;if(l&&l.count){if(i&&a&&a.length){l.set("count",M.buildElemsCountStr(i,a));}}}this.initControlInfo();var j=this.content=this.builder.selectorFactory.newSelector(this);if(!j){this.set("visible",false);}},onincludeChange:function E(a){this.node.defn.include=this.include=a.value;if(this.style!==Y.METRIC_SLIDER){this.include=a.value;var b=H.call(this);b.ckey=this.ckey;this.slice(b);}},slice:function R(f){var a=this.model;if(this.isInFilterPanel()){var b=this.getFilterPanel();if(b&&!b.defn.cas){b.bufferSlice(f);return ;}}a.slice(f);},onquaChange:function T(a){this.node.data.qt=a.value;},isInFilterPanel:function N(){var a=this.parent;return(a&&a.isInFilterPanel&&a.isInFilterPanel())||false;},isHorizFP:function Z(){var a=this.parent;return(a&&a.isHorizFP&&a.isHorizFP())||false;},getFilterPanel:function W(){var a=this.parent;return(a&&a.getFilterPanel&&a.getFilterPanel())||null;}});if(!mstrmojo.dom.isIE){var C=mstrmojo.DocSelector.prototype.formatHandlers;C.contentNode=C.filterNode;delete C.filterNode;}}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelectorViewFactory","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.ListBoxHoriz","mstrmojo.ListBoxSelector","mstrmojo.LinkList","mstrmojo.ButtonList","mstrmojo.DropDownList","mstrmojo.Slider");var C=mstrmojo.DocSelectorViewFactory.STYLES;var A={};A[C.RADIO]=["RadioListHoriz","RadioList"];A[C.CHECKBOX]=["CheckListHoriz","CheckList"];A[C.LIST]=["ListBoxHoriz","ListBoxSelector"];A[C.LINK]=["LinkListHoriz","LinkList"];A[C.BUTTON]=["ButtonListHoriz","ButtonList"];A[C.SCROLLER]="Slider";A[C.METRIC_SLIDER]="MetricSlider";A[C.METRIC_QUAL]="MetricQualification";mstrmojo.OIVMDocSelectorViewFactory=mstrmojo.declare(mstrmojo.DocSelectorViewFactory,null,{scriptClass:"mstrmojo.OIVMDocSelectorViewFactory",newPulldown:function E(F){return new mstrmojo.DropDownList({k:F.ck,cssDisplay:"block",cssClass:"mstrmojo-DocSelector-DropDownList",selectCssClass:"mstrmojo-DocSelector-DropDownList-select",onvalueChange:function(){if(!F._inSyncPhase){F.showInfoWin();F.selectorControlChange(this);}}});},updateControlStyles:function D(M){var I=M.style,F=M.children[0],G=M.node,J=G.defn,N=J.horiz,K=M.getFormats(),H,O,L;if(I===C.SEARCH_BOX&&J.ttl){M.contentNodeCssText+="overflow:hidden";}else{if(J.hm===0&&I!==C.SCROLLER&&I!==C.METRIC_SLIDER){M.contentNodeCssText+="overflow-"+((N)?"x":"y")+":hidden;";}}if(K){F.color=H=K.color;O=K.height;L=K["background-color"]||(K.p_fmts&&K.p_fmts["background-color"]);}if(I===C.PULLDOWN){if(K){if(H){M.itemCssText+="color:"+H+";";}}F.cssText=M.itemCssText;}else{F.cellCssClass="";F.tableCssText="table-layout:"+((J.iwm===0)?"fixed":"auto")+";";if(I===C.METRIC_QUAL){F.cssText="";}else{if(O!==undefined){if(I===C.SEARCH_BOX){F.height=(parseInt(O,10)-2)+"px";}else{F.cssText="height:"+O+";";}}}if(I===C.LIST&&L){F.cssText+="background-color:"+L+";";}switch(I){case C.RADIO:case C.CHECKBOX:F.labelCssText=M.itemCssText;break;case C.BUTTON:case C.LINK:case C.LIST:if(I===C.BUTTON){if(H){M.itemCssText+="color:"+H+";";}}if(N){M.itemCssText+="height:"+O+";";}F.itemCssText=M.itemCssText;M["background-color"]=L;break;}this._super(M);}},getSelectorClass:function B(H,G){var F=A[H];if(F){if(F.constructor===Array){F=F[(G)?0:1];}return F;}return this._super(H,G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.StackContainer","mstrmojo.CheckList");var Y=mstrmojo.css,K=mstrmojo.array,L=[],H="sharingEditor",A=199,C="294DEDC011D2F1D56000D98E67019608",j="C82C6B1011D2894CC0009D9F29718E4F",E=[1,4,8,16,32,64,128],b=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],h=["B","R","W","D","C","U","E"],T=false,O=true,M=257,i=1024,S=772,P=776,B=777;function f(k){return(k&&k.t===8);}function Z(k){return k&&k.st!=M&&k.st!=i&&k.st!=S&&k.st!=P&&k.st!=B;}function R(k){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[k]||k;}function J(k){return{"253000":255000,"253":255,"32221":223,"56197":199}[k]||k;}function W(s){var q=s.acls,k=s.inhs,p=[],w,n,t,l,o;if(f(s)){q=q.concat(mstrmojo.hash.valarray(k));}for(l=0,o=q.length;l<o;l++){w=q[l];t=w.rgt;if(t>1000){n=mstrmojo.hash.copy(w);n.den=true;n.rgt=Math.floor(t/1000);p.push(n);}if((t%1000)>0){n=mstrmojo.hash.copy(w);n.den=false;n.rgt=t%1000;p.push(n);}}s.acls=p;return s;}function Q(l){var k={isSerializable:function(p,o,n){switch(p){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(q,o,p){if(q==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",l,k);}function F(o,n){var l=o&&o.oi,k;if(l){l=W(l);k=Q(l);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(p){if(n){o.close();}},failure:function(p){mstrmojo.alert(p.getResponseHeader("X-MSTR-TaskFailureMsg"));if(n){o.close();}}},{taskId:"saveObjectACL",objectXML:k,sessionState:mstrApp.sessionState,objectType:l.t,objectID:l.did,propagateToChildren:o.childrenAccessPulldown.value});}}function a(w){var AC=w.aclList,AD=w.objectInputer,x=w.rightPulldown,o=AD.getSelectedObjects(),q=o.length,z=[],n,AB=x.value,l,AA,k;if(!AD.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,w.alertTitle);return false;}for(l=0;l<q;l++){n=o[l];if(n.did===C||n.did===j){var p=mstrmojo.all[H];if(AB===p.currentPublicRight){if(O){Y.removeClass(p.userMessage.domNode,"hideMsg");}}}AA=K.find(AC.items,"did",n.did);if(AA!==-1){k=AC.items[AA];if(w.uneditableRights[k.rgt]){continue;}}z.push(new mstrmojo.Obj({n:n.n,did:n.did,st:n.st,rgt:AB,newItem:true}));}if(z.length>0){var t=K.findMulti(AC.items,"did",z);if(t.count){var s=t.indices.concat().sort(K.numSorter).slice(0,t.count);for(l=s.length-1;l>-1;l--){AC.remove(s[l]);}}AC.add(z);w.set("hasChanged",true);}AD.set("items",[]);return true;}function g(k){var n=[],q=Math.floor(k/1000),o=k%1000,t=E,w=b,p=t.length,x,l;for(l=0;l<p;l++){n.push(w[l]);n.push(" ");if((o&t[l])>0){n.push(mstrmojo.desc(8083,"Granted"));}else{if((q&t[l])>0){n.push(mstrmojo.desc(8084,"Denied"));}else{n.push(mstrmojo.desc(959,"Default"));}}n.push(",");}x=n.join("");return x.substring(x,x.length-1);}function D(w){var p=[],t=w%1000,n=E,q=h,k=n.length,o,l;for(l=0;l<k;l++){if((t&n[l])>0){p.push(q[l]);p.push(",");}}o=p.join("");return o.substring(o,o.length-1);}function X(n,o){var p=n.items,l=K.find(p,n.itemIdField,o),s=n.customItem,k=p.length-2;if(l===-1){var q={n:D(o),rgt:o};if(s){p.splice(k,1);}k=p.length-1;p.splice(k,0,q);n.customItem=q;}else{if(s&&l!==k){p.splice(k,1);n.customItem=null;}}n.set("title",g(o));n.value=o;}function I(k){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[k]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function V(s,q){var p="";if(q){var l=this.widthInput.value,t=this.heightInput.value,k=' src="'+s,w="",n=this.checkBoxList.items,o;for(o=0;o<n.length;o++){if(!this.checkBoxList.selectedIndices.hasOwnProperty(o)){if(w==""){w="&hiddensections="+n[o].alias;}else{w+=","+n[o].alias;}}}p='<iframe width="'+l+'" ';p+='height="'+t+'" ';p+=k;p+=w;p+='"></iframe>';}else{p='<iframe width="640" height="480" src="';p+=s;p+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return p;}function G(l){var o=mstrmojo.string.parseUri(l).queryKey,p=l.indexOf("?"),k=p>0?l.substring(0,p):l;if(o.hasOwnProperty("iframe")){delete o.iframe;}if(o.hasOwnProperty("validateRandNum")){delete o.validateRandNum;}if(!o.hasOwnProperty("server")){o.server=encodeURIComponent(mstrApp.serverName);}if(!o.hasOwnProperty("Project")){o.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!o.hasOwnProperty("port")){o.port=mstrApp.serverPort;}if(T){o.connmode=8;o.ru=1;}o.share=1;k+="?";for(var n in o){k+=n+"="+o[n]+"&";}k=k.substring(0,k.length-1);return k;}function U(o){var k=new Date(),n=this.objectName+" "+k.toLocaleDateString()+" "+k.toLocaleTimeString(),l=this,p={success:function(t){var s=G(t.url);l.linkBox.set("value",s);l.url=s;l.htmlPanel.htmlBox.set("value",V(s));var q=l.tabDock.emailLink;q.set("url",window.escape(s));q.set("name",l.objectName);},failure:function(q){mstrmojo.alert(q.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){l.hideWait();if(o){window.open("mailto:?body="+window.escape(l.url)+"&subject="+l.objectName,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,p,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:n,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function N(o){var l=I(this.oi.st),k=l.length,n;for(n=0;n<k;n++){if(l[n].rgt===o){return l[n].n;}}return mstrmojo.desc(2056,"Custom");}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",hasChanged:false,help:"sharing_dialog_box.htm",zIndex:1000,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),onShowLink:function(l){var k={htmlCode:"showLink",showLink:"htmlCode"};this.tabDock[k[l]].set("selected",false);},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var t=this.oi.acls,n,z=K.find(t,"did",j),q=this.aclList.itemsContainerNode,s=this.publicAccessSection.publicLabel,p,x=false,k=K.find(t,"did",C),w;if(z!==-1&&T&&k!==-1){var l=t[z].rgt,o=t[k].rgt;if(l===o){x=true;w=o;}}if(z!==-1&&!T){x=true;w=t[z].rgt;}p=q.children[0].tBodies;if(T&&p[k]){Y.toggleClass(p[k].rows[0],"hide",x);}if(p[z]){Y.toggleClass(p[z].rows[0],"hide",x);}s.set("checked",x);if(w){this.set("currentPublicRight",w);}},oncurrentPublicRightChange:function(){var k=this.publicAccessSection.publicMouseOver;k.publicRight.set("value",this.currentPublicRight);k.publicRightLabel.set("text",N.call(this,this.currentPublicRight));},onOpen:function(){var l=this.oi.n,t=this.oi.acls;this.objectName=l;this.set("showACL",!!t);T=this.guestModeEnabled;if(this.href&&!this.isLinkDirty){var n=G(this.href),q=this.tabDock.emailLink;this.url=n;q.set("url",window.escape(n));q.set("name",l);this.htmlPanel.htmlBox.set("value",V(n));this.linkBox.set("value",n);}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(l)));var p=this.tabDock;p.showLink.set("selected",false);p.htmlCode.set("selected",false);if(t){this.checkPublicAccess();var s=this.rightPulldown;s.set("items",this.getAvailableRightsForSelection());s.set("value",A);var w=this.objectInputer,o=this.userSelector,k=o&&o.userBrowser;w.zIndex=this.zIndex;if(k&&k.hasRendered){k.set("items",[]);k.getContent(k);}this.set("hasChanged",false);}},_set_hasChanged:function(o,k){var l=(k!==this.hasChanged);this.hasChanged=k;if(k===true){this.checkPublicAccess();}return l;},_set_oi:function(l,k){this.oi=this.preProcessACLs(k);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return I(this.oi.st);},preProcessACLs:function(t){if(t&&t.acls){var q=t.acls,p=q&&q.length,s=f(t),l={},w,k,n,o;if(s){n={};t.inhs=n;}for(o=0;o<p;o++){w=new mstrmojo.Obj(q[o]);if(s&&w.inh){n[w.n]=mstrmojo.hash.copy(w);continue;}k=l[w.n];if(!k){k=mstrmojo.hash.copy(w);k.rgt=0;delete k.den;l[w.n]=k;}k.rgt+=w.den?w.rgt*1000:w.rgt;}q=mstrmojo.hash.valarray(l);t.acls=q;}return t;},onClose:function(){var k=this.objectInputer;k.set("items",[]);this.aclList.clearSelect();},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",updateTreeContent:function(l,o){l.contentRetrieved=true;var n=o[l.itemChildrenField],k=l.tree||l,q=o.bc,p=o.sz,s=o.bb;if(q!==-1){if(s+q<=p){n.push(k.nextItemCreaterFunc());}if((s-q)>-1){n.unshift(k.prevItemCreaterFunc());}}l.blockBegin=s;k.initializing=true;l.clearSelect(false);l.set("items",n);l.setSelectedItems(k.getTotalSelections(),true);k.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(l){var k=this.parent.parent,q=k.opener,p=q.objectInputer,o=k.userBrowser,n=o.getTotalSelections();if(n&&n.length>0){p.add(n,p.items.length-1);}k.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(k){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var s=this.rgt,t=Math.floor(s/1000),q=s%1000,n=this.children,o,p,l,k;for(l=0,k=n.length;l<k;l++){o=n[l];p=o.right;if(this.twoStates){o.set("grayed",false);o.set("checked",false);}else{o.set("grayed",true);o.set("checked",true);}if((t&p)>0){o.set("checked",false);o.set("grayed",false);}if((q&p)>0){o.set("checked",true);o.set("grayed",false);}}},getACLValue:function(){var p=0,q=0,n=this.children,o,l,k;for(l=0,k=n.length;l<k;l++){o=n[l];if(o.grayed||!o.right){continue;}if(o.checked){p+=o.right;}else{q+=o.right;}}return q*1000+p;},children:[{scriptClass:"mstrmojo.TristateCheckBox",alias:"browse",right:1,text:mstrmojo.desc(1825,"Browse")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"read",right:4,text:mstrmojo.desc(8078,"Read")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"write",right:8,text:mstrmojo.desc(8079,"Write")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"delete",right:16,text:mstrmojo.desc(629,"Delete")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"control",right:32,text:mstrmojo.desc(8080,"Control")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"use",right:64,text:mstrmojo.desc(8081,"Use")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"execute",right:128,text:mstrmojo.desc(8082,"Execute")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(k){var l=this.parent.parent;if(l.onOK){l.onOK();}l.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(k){var l=this.parent.parent;if(l.onCancel){l.onCancel();}l.close();}}]}]},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9811,"Sharing Options"),bindings:{visible:function(){return Z(this.parent.oi);}},cssClass:"SharingEditor-title"},{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return Z(this.parent.oi);}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink style="{@cssText} mstrAttach:click>'+mstrmojo.desc(9772,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var k=this.parent.parent;if(!this.url||k.isLinkDirty){U.call(k,true);k.set("isLinkDirty",false);}else{window.open("mailto:?body="+window.escape(k.url)+"&subject="+k.objectName,"mailtoIframe");}}},{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Show Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(k){var l=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!l.url||l.isLinkDirty){U.call(l);l.set("isLinkDirty",false);}l.onShowLink(this.alias);this.set("selected",true);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(k){var l=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!l.url||l.isLinkDirty){U.call(l);l.set("isLinkDirty",false);}l.onShowLink(this.alias);this.set("selected",true);}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(2985,"Width"),value:640,onvalueChange:function(k){var l=this.parent,n=mstrmojo.all[H];l.htmlBox.set("value",V.call(l,n.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(2983,"Height"),alias:"heightInput",value:480,onvalueChange:function(){var k=this.parent,l=mstrmojo.all[H];k.htmlBox.set("value",V.call(k,l.url,true));}},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation Bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools Panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(k){var l=this.parent,n=mstrmojo.all[H];l.htmlBox.set("value",V.call(l,n.url,true));}}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.TextBox",alias:"linkBox",cssClass:"SharingEditor-Link",bindings:{visible:"this.parent.tabDock.showLink.selected"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"[Who has access]"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");}},oncheckedChange:function(){Y.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(T){this.getUserGroupFromTaskCall(C);}this.getUserGroupFromTaskCall(j);},getUserGroupFromTaskCall:function(s){var n=mstrmojo.all[H],o=n.aclList,p=mstrmojo.ACL.UserDataService,q=function(w){var t=new mstrmojo.Obj({n:w.n,did:w.did,st:w.st,rgt:A,newItem:true});L.push(t);},l=function(t){},k=function(){if(!T||(T&&L.length==2)){o.add(L);n.set("hasChanged",true);}};p.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:s}},{success:q,failure:l,complete:k});},onclick:function(){var l=mstrmojo.all[H];var n=l.aclList.items;var o=K.find(n,"did",j);if(o!==-1){n.remove(o);}var k=K.find(n,"did",C);if(T&&k!==-1){n.remove(k);}if(this.checked===true){if(L.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(L,function(p){p.rgt=A;});n.add(L);l.set("hasChanged",true);}}else{l.set("currentPublicRight",A);l.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",bindings:{visible:"this.parent.publicLabel.checked"},children:[{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var k=this.parent.parent.parent;return N.call(k,k.currentPublicRight);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight"},selectionPolicy:"reselect",onvalueChange:function(){var k=this.parent;var l=k.parent.parent;k.publicRightLabel.set("text",N.call(l,this.value));},_set_value:function(s,l){var o=this.value,k=(o!==l);if(k){if(l===-1){var q=this.parent.parent.parent,p=this;q.openPopup("customACL",{zIndex:q.zIndex+10,rgt:o,twoStates:true,onOK:function(){p.set("value",this.getACLValue());},onCancel:function(){p.set("value",o);}});return false;}l=J(l);X(this,l);this.updatePublicRight(l);return true;}return true;},updatePublicRight:function(l){var n=this.parent.parent.parent;if(n.aclList){var o=n.aclList.items;var k=K.find(o,"did",C);var p=K.find(o,"did",j);if(T&&k!==-1){o[k].rgt=l;}if(p!==-1){o[p].rgt=l;}n.set("hasChanged",true);n.set("currentPublicRight",l);}}}]}]},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){Y.addClass(this.domNode,"hideMsg");O=false;}},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(l){var q=this.parent.oi;if(!f(q)){return ;}var s=q.inhs,p=l.value,k=p&&p.length,t,o;for(o=0;o<k;o++){t=p[o].n;delete s[t];}},onadd:function(l){var q=this.parent.oi;if(!f(q)){return ;}var s=q.inhs,p=l.value,k=p&&p.length,t,o;for(o=0;o<k;o++){t=p[o].n;s[t]=mstrmojo.hash.copy(p[o]);s[t].inh=true;}},onACLChanged:function(l){var k=this.parent.oi;this.parent.set("hasChanged",true);if(!f(k)){return ;}k.inhs[l.n]=mstrmojo.hash.copy(l);k.inhs[l.n].inh=true;},columns:[{dataFunction:function(n,k,l){return'<div class="mstrmojo-ACLEditor-user '+(n.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(n.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",children:[{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){return N.call(mstrmojo.all[H],this.parent.parent.data.rgt);}}},{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var k=this.parent.parent.data;this.set("value",k[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(s,l){var o=this.value,k=(o!==l);if(k){if(l===-1){var q=this.parent.parent.dataGrid.parent,p=this;q.openPopup("customACL",{zIndex:q.zIndex+10,rgt:o,twoStates:!!this.parent.parent.data.newItem,onOK:function(){p.set("value",this.getACLValue());},onCancel:function(){p.set("value",o);}});return false;}l=R(l);X(this,l);this.parent.parent.data.set(this.itemIdField,l);if(o!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(k){var l=this.parent.parent.dataGrid;l.remove(this.parent.parent.data);l.parent.set("hasChanged",true);}}]}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.UserInputBox",emptyText:mstrmojo.desc(9151,"Type users or groups here."),noCache:true,onRender:function(){var k=this.parent.parent.parent;if(k){k.objectInputer=this;}}},{scriptClass:"mstrmojo.Pulldown",itemIdField:"rgt",value:199,defaultSelection:0,selectionPolicy:"reselect",onRender:function(){var k=this.parent.parent.parent;if(k){k.rightPulldown=this;}},postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},_set_value:function(s,l){var o=this.value,k=(o!==l);if(k){if(l===-1){var q=this.parent.parent.parent,p=this;q.openPopup("customACL",{zIndex:q.zIndex+10,rgt:o,twoStates:true,onOK:function(){p.set("value",this.getACLValue());},onCancel:function(){p.set("value",o);}});return false;}l=J(l);X(this,l);return true;}return true;}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",onclick:function(k){var l=this.parent.parent.parent;a(l);},text:mstrmojo.desc(2156,"Add")},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-ACLEditor-chooseLabel",onclick:function(k){var l=this.parent.parent.parent;l.openPopup("userSelector",{zIndex:l.zIndex+10});},text:mstrmojo.desc(1825,"Browse")}]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&f(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&f(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),bindings:{enabled:function(){var k=this.parent.parent.oi;return(k.acg&32)>0&&this.parent.parent.hasChanged;}},onclick:function(k){var l=this.parent.parent;if(a(l)){F(l,true);}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Close",onclick:function(k){var l=this.parent.parent;l.close();l.set("hasChanged",false);},bindings:{iconClass:function(){var k=this.parent.parent;if(k.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){var k=this.parent.parent;if(!k.showButtonText){return"";}if(k.hasChanged){return mstrmojo.desc(2140,"Cancel");}return mstrmojo.desc(2102,"Close");}}}]}]});mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch){this.set("selected",this.children[1]);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.children[0]);}},preBuildRendering:function(){this.set("selected",this.children[0]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.NumberFormat","mstrmojo.Button");var O=mstrmojo.desc,K=mstrmojo.Button.newInteractiveButton,b=mstrmojo.date,AC=function(){return mstrmojo.locales.datetime;};function W(AE,AF){mstrmojo.form.send(AF,null,"post");}function AB(AG,AF){var AE=AG.model;W(AG,{evt:3124,src:mstrApp.name+"."+mstrApp.pageName+".3124",relativePageNumber:AF,messageID:AE.mid,rwb:AE.bs});}function g(AG,AH){var AE=AG.model;var AF={evt:2048001,messageID:AE.mid,rwb:AE.bs};if(AH<50||AH===2048){AF.visMode=0;AF.currentViewMedia=AH;}else{AF.visMode=AH;AF.currentViewMedia=1;}W(AG,AF);}function J(AF){var AE=mstrApp.prevViewMedia;if((!AE&&AE!==0)||AE===-1){AB(AF,-1);}else{if(AE===0){AF.designViewMode();}else{g(AF,AE);}}}function AD(AI,AF,AH,AG){var AE=AI.model;W(AI,{evt:2048030,src:AE.bp+".2048030",rePrompt:AF,fresh:AH,regenerate:AG,rwb:AE.bs});}function Q(AM,AF){var AI=AM.model,AJ=(AI&&AI.ztp)||0,AG=(AI&&AI.zf)||1,AE=AJ+":"+AG,AH=AM.zoomOptions,AK;if(AH){var AL=mstrmojo.array.find(AH,"dssid",AE);if(AL>-1){AK=AH[AL];}}if(!AK){AK={n:parseInt(AG*100,10)+"%",dssid:AE,f:AG,tp:AJ};}if(AF===true){AM.zoomValue=AK;}else{AM.set("zoomValue",AK);}}function M(AK,AM,AG,AL,AI,AJ){var AH=AK.model,AE=AH&&AH.dty;if(!AE){AL(AK,AI);return ;}var AF="#666";mstrmojo.confirm(AG,[K(O(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");AK.save(AJ);},AF),K(O(2140),null,AF)],AM);}function q(AF){var AE=AF.model;AE.showDialogBeforeSave=false;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){},failure:function(AG){mstrmojo.alert(AG.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"askBeforeSaveChanges\u001E2"});}var x=-1,Z=3,n=4,G=7;mstrmojo._DocOIVMMethods={staticViewMode:function B(){g(this,1);},interactiveViewMode:function H(){g(this,2);},editableMode:function l(){g(this,4);},flashViewMode:function f(){g(this,8);},IVEMode:function N(){g(this,2048);},IVEHelp:function N(){var AE=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/MicroStrategy_Web_Help.htm#";window.open(AE+"about_interactive_visual_data_exploration.htm","_blank");return true;},remainExpressViewMode:function L(){},designViewMode:function s(){W(this,{evt:3104,rwDesignMode:1,messageID:this.model.mid,rwb:this.model.bs});},convertToDoc:function k(){var AE=this;mstrmojo.confirm(O(8127),[K(O(1442),function(){AE.designViewMode();},null),K(O(2140),null,null)]);},saveAs:function(AE){this.save();},save:function U(AF){var AE=this.model;W(this,mstrmojo.hash.copy(AF,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:AE.sfid||AE.pfid,saveFromDesignMode:false,rwb:AE.bs}));},dSave:function AA(){var AK=this,AG=AK.model,AI=AG&&AG.isnew,AF=AG&&AG.isRWReadonly;maxLen=60;truncateName=AG.n;if(truncateName.length>maxLen){truncateName=truncateName.substr(0,maxLen-1)+"...";}if(AI||AF){this.save();}else{var AH=mstrApp.features["ask-before-save-changes"],AJ="#666";if(AH){var AL="dialogBeforeSave",AE=function(){mstrmojo.all.dialogBeforeSave.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:AL,title:O(5728),cssText:"min-width:475px;max-width:600px;",btnAlignment:"right",buttons:[K(O(1442),function(){var AM=mstrmojo.all[AL];if(AM.t.ctrlChk.checked){AK.setDontAskAgain();mstrApp.features["ask-before-save-changes"]=false;}AK.directSave();AE();},AJ),K(O(218),function(){var AM=mstrmojo.all[AL];if(AM.t.ctrlChk.checked){q(AK);}AK.save();AE();},AJ),K(O(2140),AE,AJ)],children:[{scriptClass:"mstrmojo.Table",alias:"t",rows:2,cols:1,children:[{scriptClass:"mstrmojo.Label",text:O(11165).replace(/##/,"<b>"+truncateName+"</b>"),visible:true,cssText:"height:60px;",slot:"0,0"},{scriptClass:"mstrmojo.CheckBox",label:O(211),alias:"ctrlChk",visible:true,checked:false,slot:"1,0"}]}]}).render();}else{AK.directSave();}}},setDontAskAgain:function F(){var AF=this,AE=AF.model;AE.showDialogBeforeSave=false;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){},failure:function(AG){mstrmojo.alert(AG.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"askBeforeSaveChanges\u001E0"});},directSave:function P(){var AG=this,AE=AG.model;var AF=mstrmojo.string.decodeHtmlString(AE.n);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){mstrmojo.alert(O(3336).replace("##",AE.n));},failure:function(){mstrmojo.alert(O(4107));}},{taskId:"saveRW",msgID:AE.mid,folderID:AE.sfid||AE.pfid,objName:AF,objDesc:AE.desc,saveAsFlags:1,taskEnv:"xhr",taskContentType:"json"});},browseParent:function p(){var AE=this.model,AF={evt:3010};if(!AE.pfh){AF.evt=2001;AF.folderID=AE.pfid;if(AE.sysFolder){AF.systemFolder=AE.sysFolder;}}W(this,AF);},close:function h(){J(this);},openPage:function V(AE){AB(this,AE);},saveToInbox:function i(){var AE=this;mstrApp.serverRequest({taskId:"addDocToHistoryList",rwb:AE.model.bs},{success:function(){var AF=AE.model.features;if(AF){if(AF.set){AF.set("enable-add-history-list",false);}else{AF["enable-add-history-list"]=false;}}mstrmojo.alert(O(8047));}});},ShowSharingEditor:function T(){var AI="sharingEditor",AJ=mstrmojo.all[AI],AK=this,AG=AK.model,AM=11,AL=AG.isBlankDocument,AE=function(AN){if(AJ){AJ.set("oi",AN);AJ.objectName=AG.n;AJ.href=null;AJ.mid=AG.n;}else{AJ=new mstrmojo.SharingEditor({guestModeEnabled:mstrApp.guestModeEnabled,mid:AG.mid,id:AI,oi:AN,href:null,isLinkDirty:true,viewMode:1,lastState:0});}AJ.open();},AH={success:function(AN){AE(AN.objects[0]);},failure:function(AN){mstrmojo.alert(AN.getResponseHeader("X-MSTR-TaskFailureMsg"));}};if(AL){var AF="#666";mstrmojo.confirm(mstrmojo.desc(9932),[K(O(1442),function(){AK.save({saveAsOrigin:AM});},AF),K(O(2140),null,AF)],mstrmojo.desc(8101));}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,AH,{taskId:"getObjectInfo",objectIDs:AG.oid,objectTypes:55,includeACL:!!mstrApp.features["web-use-sharing-editor"],sessionState:mstrApp.sessionState});}},createPersonalView:function I(){var AM=this,AG=AM.model,AJ=AG&&AG.isnew;if(AJ){var AF="#666";mstrmojo.confirm(mstrmojo.desc(2510),[K(O(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");AM.save({saveAsOrigin:10});},AF),K(O(2140),null,AF)],mstrmojo.desc(9173));}else{var AE=AG.n,AI="mstrPVD",AH={scriptClass:"mstrmojo.PersonalViewSaveAs",id:AI,objectType:55,objectSubType:14081},AL=mstrmojo.all[AI]||mstrmojo.insert(AH);if(AE){var AK=b.getDateJson(new Date());AE+=" "+b.formatDateInfo(AK,AC().DATEOUTPUTFORMAT)+" "+b.formatTimeInfo(AK,AC().TIMEOUTPUTFORMAT);AL.set("name",AE);}AL.msgID=this.model.mid;AL.open();}},reprompt:function S(){AD(this,true,false,false);},refresh:function R(){AD(this,false,false,false);},rerun:function o(){AD(this,false,true,false);},toggleAutoRefresh:function(AH){var AG=AH.src,AE=this.model.controller,AF=AE.isAutoRefreshEnabled();AE[(AF?"stop":"start")+"AutoRefresh"]();AG.set("iconClass",(AF?"tbStart":"tbStop")+"AutoRefresh");AG.domNode.setAttribute("title",AF?"*Resume Auto Refresh*":"*Pause Auto Refresh*");},docVisualizationModeAJAX:function j(){g(this,51);},docVisualizationModeFlash:function t(){g(this,50);},sendNow:function w(){M(this,mstrmojo.desc(2331,"Send Now"),mstrmojo.desc(2513,"You must save the report/document before you can send it."),W,{evt:3037,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:2});},scheduleHL:function Y(){M(this,O(5017,"Subscribe to History List"),O(2510,"You must save the report/document before you can subscribe to it."),W,{evt:3128,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3});},zoomValue:null,zoom:function z(AO){var AK=mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep);var AN=(AO!==null)?String(AO).split(":"):[],AL=parseInt(AN[0],10),AQ=AN[1],AG=AK.parse(AQ);if(isNaN(AL)||(!AL&&isNaN(AG))){return ;}var AP=this.model;if(AL===1||AL===2){var AJ=this.selected,AI=(AJ&&AJ.docLayout)||null,AR=AI&&(AI.containerNode||AI.domNode),AH=AR&&AR.ownerDocument.documentElement,AM=(AP&&AP.zf)||1;var AE=function(AV){var AT=AR&&AR["offset"+AV];if(!AT){return 1;}var AU=Math.max(1,AH["client"+AV]);return Math.min(4,Math.max(0.1,Number(AM*AU/AT).toFixed(2)));};AG=AE("Width");if(AL===2){AG=Math.min(AG,AE("Height"));}AQ=AK.format(AG);}var AF=AL+":"+AQ;if(AF!==(this.zoomValue&&this.zoomValue.dssid)){var AS=this;AP.getDataService().setDocZoom({zoomType:AL,zoomFactor:AQ},{success:function(AT){AP.zf=AT.zf;AP.ztp=AT.ztp;AP.replaceLayout(AT.currlaykey,AT);AP.raiseEvent({name:"rebuildLayout"});Q(AS,false);AS=null;},failureName:"zoom.set"});}},exportCmd:function C(AL,AN){var AH=this.model,AR=(parseInt(AL,10)===x)?3130:3132,AP=AH.exopt,AQ=AH.huc&&AL===G,AM=AP.s&&(AL===n||AL===Z)&&!AN,AG=false,AK=false;if(AM){if(!!(AH.defn&&AH.defn.layouts&&AH.defn.layouts.length>1)){AK=true;}else{var AJ=this.selected,AS=AJ&&AJ.gb&&AJ.children[1];AG=(!AS||AS.areUnitsSetToAll());if(AG){AM=false;}}}var AI=function(){var AW={evt:AR,src:mstrApp.name+"."+AR};if(AR===3132){AW.executionMode=AL;if(AN!=null){AW.gridKey=AN;}}if(!AM){AW.rwb=AH.bs;}else{var AV=mstrmojo.Serializer;var AT=[[2048062,AH.bp+".2048062","mode",AP.m,"range",AP.r],[]];mstrmojo.hash.forEach(AW,function(AY,AX){if(AX==="executionMode"){AT[1]=AT[1].concat([AX,AY]);}else{AT[1].push(AY);}});AW.evt=1024001;AW.src=AH.bp+".1024001";AW.events=AV.serializeValueGroup(AT);AW["1024001"]=1;AW.messageId=AH.mid;}AW.name=Date.parse(new Date());var AU=function(){mstrmojo.form.send(AW,null,null,(AP.n)?"_blank":"mstrExportWindow");};if(!mstrmojo.dom.isIE||AL!==G){AU();}else{mstrmojo.alert(AP.ds[5873],AU);}};var AF=AP.ds,AE="#666",AO;if(AM||AQ){AO=function(){var AU="mojoExOpx9",AT=function(){mstrmojo.all.mojoExOpx9.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:AU,title:AF[971],cssText:"min-width:225px;max-width:325px;",btnAlignment:"right",buttons:[K(AF[1442],function(){mstrmojo.requiresCls("mstrmojo.Serializer");var AV=mstrmojo.all[AU];if(AK){AP.r=AV.ctrlLyt.selected;}if(!AG){AP.m=(AV.ctrlChk.checked)?0:1;}AT();AI();},AE),K(AF[2140],AT,AE)],children:[{scriptClass:"mstrmojo.Label",text:AF[7482],visible:AQ},{scriptClass:"mstrmojo.DropDownList",title:AF[246],cssClass:"field",cssDisplay:"block",alias:"ctrlLyt",visible:!!AK,idx:AP.r,options:[{n:AF[5137],v:0},{n:AF[5138],v:1}]},{scriptClass:"mstrmojo.CheckBox",label:AF[5165],cssClass:"field",cssDisplay:"block",alias:"ctrlChk",visible:!!!AG&&AM,checked:(AP.m===0)}]}).render();};}if(AL===n&&AF["3809"]!==undefined&&!AN){mstrmojo.confirm(AF["3809"],[K(AF[1442],AO||AI,AE),K(AF[2140],null,AE)]);}else{if(AO){AO();}else{AI();}}},printPDF:function X(){this.exportCmd(Z);},openHome:function D(AE){W(AE,{evt:3010,src:mstrApp.name});},updateZoom:function A(){Q(this,false);},__onmixin__:function E(){Q(this,true);},resetSelections:function a(){var AF=this,AE=AF.model;AE.getDataService().resetSelections(null,false,{success:function(AJ){if(AJ.disablePU){AE.loadLayout(AJ);return ;}if(AJ.pukeys){var AL=AE.partialUpdate(AJ.data,AE.getUnitDefinitions(AJ.pukeys)),AH=AE.getLayoutDataCache(AE.getCurrentLayoutKey());mstrmojo.hash.forEach(AL.upd,function(AQ,AS){var AP=mstrmojo.all[AS];if(AP&&AP.defn&&AP.defn.t==mstrmojo.EnumRWUnitType.PANELSTACK){var AO=AH&&AH[AS]&&AH[AS].data,AR=AO&&AO.selKey;if(AR&&AP.selectedKey!=AR){AP.defn.set("selKey",AR);}AP.setDirtyChildren();}});}var AM=AF.getLayouts(),AG=(AM&&AM.length)||0,AN=AE.getCurrentLayoutKey();for(var AI=0;AI<AG;AI++){var AK=AM[AI];if(AK.defn&&AK.defn.loaded&&AN!=AK.k){AK.defn.loaded=false;}}}});}};}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.base64","mstrmojo.Dialog");mstrmojo.requiresDescs(1442,2140,5369,8233,8232,8313,8322);var V=8,P=16,W=4,T=1,R=8,B=16,O=268435456,I=536870912,A=1073741824,F=window.mstrConfig&&!window.mstrConfig.simpleDialog,L=2147755235,J=2147755236;var S=mstrmojo.Button.newInteractiveButton;function C(g,b,a,Y,Z){if(F){var f=[S(Y||mstrmojo.desc(1442),b||null,null),S(Z||mstrmojo.desc(2140),a||null,null)];mstrmojo.confirm(g,mstrApp.useBinaryFormat?f.reverse():f);}else{if(mstrmojo.confirm(g)){if(b){b();}}else{if(a){a();}}}}function X(Z,Y){if(F){mstrmojo.alert(Z,Y);}else{mstrmojo.alert(Z);if(Y){Y();}}}mstrmojo.DocActionSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.DocActionSelector",extCls:"mstrmojo-ActionSelector",type:V,targets:null,initControlInfo:function E(){var Y=this.node.defn;this.aa=parseInt(Y.aa,10);this.dpTxt=Y.dpTxt||{8:mstrmojo.desc(5369),4:mstrmojo.desc(8233),16:mstrmojo.desc(8232)}[this.aa]||"";this.dpCfm=Y.dpCfm;this.sac=parseInt(Y.sac,10);this.msg=Y.msg;this.rsid=Y.rsid;this.rst=Y.rst;this.node.data.elms=[{n:this.dpTxt,v:this.dpTxt}];this._super();},selectorControlChange:function K(Y){if(Y.selectedIndex!==0){return ;}this.executeAction();Y.select([]);},executeAction:function N(){var Z=this.aa,Y=this;if(Z===V){if(this.dpCfm){C(mstrmojo.desc(8313),function(){Y.onControllerCheck();});}else{Y.onControllerCheck();}}else{if(Z===W){if(this.dpCfm){C(mstrmojo.desc(8322),function(){Y.onDiscard();});}else{Y.onDiscard();}}else{this.onRecalculate();}}},onControllerCheck:function H(){this.onCommit();},onCommit:function M(){var b=this,f=this.model,Z=b.controller,Y=mstrApp.useBinaryFormat;if(!Y&&!this.validateRequiredObjects()){X(mstrmojo.desc(9200));return ;}var a=function(g){if((b.sac&I)>0){Z.invalidClientCache();}if((b.sac&B)>0){var h={did:b.rsid,objType:b.rst,forceExec:(b.sac&O)>0};if((b.sac&A)>0){h.linkAnswers='<hl mid="'+f.mid+'" srct="2" aopam="1"><prms></prms></hl>';}Z.onExecuteNewObject(b,h);}else{if((b.sac&R)>0){Z.onReExecute(b);}else{if(mstrApp.isMobile){Z.generateActionToolbar();}f.transactionUpdate(g);}}};mstrmojo.mask.show("Running");f.sendTransactionActions(this.ck,V,f.newCallback({success:function(g){mstrmojo.mask.hide();if(f.txrcd||g.offln){Z.offlineTransactionsSubmitted(b.ck);}if(g.offln){if(Y&&!b.networkToastShowed){b.networkToastShowed=true;mstrmojo.toast(mstrmojo.desc(9258,"No Network Connectivity")+". "+mstrmojo.desc(9259,"Transaction will be submitted when connectivity is resumed."));}f.transactionUpdate(g);}else{if((b.sac&T)>0&&b.msg){if(Y){mstrmojo.toast(b.msg);window.setTimeout(function(){a(g);},100);}else{X(b.msg,function(){a(g);});}}else{a(g);}}},failure:function(i){var g=mstrmojo.all.mojoAlertx9;if(g){g.destroy();}mstrmojo.mask.hide();if(f.txrcd){Z.offlineTransactionsSubmitted(b.ck);}var h=4294967296+parseInt(i.code,10);if(h===L){if(Y){b.validateRequiredObjects();}X(mstrmojo.desc(9200,"You have some required inputs that are not modified."));}else{if(h===J){var j=mstrmojo.desc(9201,"You haven't made any changes to submit.");if(Y){mstrmojo.toast(j);}else{X(j);}}else{X(mstrmojo.base64.decodeHttpHeader(i.message),function(){if(!Y){b.controller.onReExecute(b,true);}});}}}}));},onDiscard:function D(){var Z=this,a=this.model,Y=Z.controller;a.txDiscardTargets=this.getTxTargets();a.sendTransactionActions(this.ck,W,{success:function(b){a.transactionUpdate(b);Y.transactionDiscarded(Z.ck);},complete:function(){delete a.txDiscardTargets;if(mstrApp.isMobile){Y.generateActionToolbar();}}});},onRecalculate:function G(){this.model.sendTransactionActions(this.ck,P);},getTxTargets:function U(){var h=this.tks.split("\u001E"),g,Y,f,k,Z,a,b={};for(g=0,Y=h.length;g<Y;g++){f=h[g];k=1;do{Z=this.model.getUnitInstance(f,k++);if(Z&&Z.checkRequiredObjects){if(Z.isPanelStack){for(a in Z.txWidgets){b[Z.txWidgets[a].id]=1;}}else{b[Z.id]=1;}}else{break;}}while(true);}return b;},validateRequiredObjects:function Q(){var Y=true,Z;for(Z in this.getTxTargets()){Y=mstrmojo.all[Z].checkRequiredObjects()&&Y;}return Y;}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.DocLayout","mstrmojo.DocLayoutHoriz","mstrmojo.DocSection","mstrmojo.DocSubsection","mstrmojo.DocTextfield","mstrmojo.DocXtabModel","mstrmojo.DocVisModel","mstrmojo.XtabBase","mstrmojo.DocPortlet","mstrmojo.DocResizablePortlet","mstrmojo.DocXtabGraph","mstrmojo.DocGridGraph","mstrmojo.DocLine","mstrmojo.DocImage","mstrmojo.DocHTMLContainer","mstrmojo.DocRectangle","mstrmojo.DocRoundRectangle","mstrmojo.DocPanel","mstrmojo.DocSelector","mstrmojo.DocActionSelector","mstrmojo._HasDocLink","mstrmojo.DocVisualization","mstrmojo.DynamicClassFactory","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo._IsSelectorTarget","mstrmojo.DocInfoWindow","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo._IsEditableTextfield","mstrmojo.DocSelectorViewFactory","mstrmojo._HasHoverButton","mstrmojo.hash");var N=mstrmojo.hash;var A=mstrmojo.EnumRWUnitType,C={};C[A.LAYOUT]={n:"Layout"};C[A.HEADER]=C[A.FOOTER]=C[A.PAGEHEADER]=C[A.PAGEFOOTER]=C[A.DETAILS]={n:"Section",scriptClass:"mstrmojo.DocSection"};C[A.SUBSECTION]={n:"SubSection",scriptClass:"mstrmojo.DocSubsection"};C[A.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.DocTextfield"};C[A.GRID]={n:"Xtab",scriptClass:"mstrmojo.DocXtab"};C[A.GRAPH]={n:"XtabGraph",scriptClass:"mstrmojo.DocXtabGraph"};C[A.GRIDGRAPH]={n:"GridGraph",scriptClass:"mstrmojo.DocGridGraph"};C[A.SELECTOR]={n:"Selector",scriptClass:"mstrmojo.DocSelector"};C[A.LINE]={n:"Line",scriptClass:"mstrmojo.DocLine"};C[A.IMAGE]={n:"Image",scriptClass:"mstrmojo.DocImage"};C[A.HTMLCONTAINER]={n:"HTMLContainer",scriptClass:"mstrmojo.HTMLContainer"};C[A.RECTANGLE]={n:"Rectangle",scriptClass:"mstrmojo.DocRectangle"};C[A.ROUNDEDRECTANGLE]={n:"RoundedRectangle",scriptClass:"mstrmojo.DocRoundRectangle"};C[A.PANEL]={n:"Panel",scriptClass:"mstrmojo.DocPanel"};C[A.VISUALIZATION]={n:"Visualization",scriptClass:"mstrmojo.DocVisualization"};C[A.MOJOVISUALIZATION]={n:"MojoVisualization"};var R={};var S=mstrmojo.DynamicClassFactory.newComponent;var K=mstrmojo.elementHelper;function Q(a){return function(){return this.parent.parent["on"+a]();};}var B=Q("maximize"),V=Q("restore"),F=Q("minimize"),U=Q("collapse"),G=Q("expand");mstrmojo.DocXtab=S(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab"});var H=function(f,b){var a=f&&f.parent;while(a){if(a[b]){return a;}a=a.parent;}return null;};function Z(b,h,f,a,g){return mstrmojo.Button.newIconButton(b,h,f,null,{ds:a,visible:(g!==a)});}function O(a,g,f){var b=C[g].n+(f?"Hover":""),h=R[b];if(!h){h=R[b]=S(a,[mstrmojo._HasDocLink].concat(this.getLinkDrillMixins(f)));}return h;}mstrmojo.DocBuilder=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocBuilder",visList:null,destroy:function W(){var a=this.selectorFactory;if(a){a.destroy();}this._super();},classMap:C,build:function M(x,g){var f=[],s=this.classMap,AB=((x&&x.length)||0),AA;for(AA=0;AA<AB;AA++){var z=x[AA],h=z&&z.defn,b=z&&z.data,o=(h&&h.t)||mstrmojo.EnumRWUnitType.LAYOUT,AC=s[o];var n=(o===A.TEXTFIELD&&((h&&h.dpst)));if(n){AC=s[o+"B"];}var k=(AC&&AC.n)?"new"+AC.n:"",l;if(this[k]){l=this[k](g,z);}else{if(AC&&AC.scriptClass){var j=AC.cls;if(!j){j=N.walk(AC.scriptClass,window);}if(o===A.TEXTFIELD||o===A.IMAGE){var a=b.dl,p=h.dl,q=(a&&a.items&&a.items.length)||(p&&p.items&&p.items.length>0);if(q||b.url||h.url||h.ifw){j=O.call(this,j,o+(n?"B":""),q);}else{if((o===A.TEXTFIELD)&&h.txi){j=S(j,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableTextfield]);}}}if(j){l=new j({id:z.id,node:z,controller:this.parent.controller,model:g});}}}if(l){l.k=z.k;l.formatResolver=g.formatResolver;l.builder=this;l.tooltip=b.tooltip||h.tooltip||"";if(!l.defn){l.defn=h;}l.disposables.push(l.defn);if(l.update){l.update(z);}if((h.ttl!==undefined&&o!==A.PANEL)||h.qsm){l=this.createPortlet(o,z,l);}f.push(l);}}return f;},createPortlet:function E(AC,AJ,AA){var h=AJ.defn,AG=h.ds,q=(h.iifp||!(AC===A.PANELSTACK||(h.ttl===undefined&&h.qsm)||AC===A.SELECTOR)),AH=(AC===A.GRAPH||AC===A.GRIDGRAPH),n=[],AR=mstrmojo.Button.newIconButton,AI="",AK="",f="",AF=(AC===A.GRID||AH||AC===A.VISUALIZATION)&&parseInt(h.eo,10)!==2,AM=[],AD="mstrmojo-oivmSprite ",g=false;if(h.qsm){AI="qks";var AB=function(AT,t,w){return AR(AT,AD+t,function(){return this.parent.parent.content.quickSwitch();},{visible:"this.parent.parent.defn.qsm !== this.qsm"},{qsm:w});};n.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",cssClass:(!q)?"grouped":"",children:[AB(mstrmojo.desc(3547,"View: Grid"),"tbGrid",1),AB(mstrmojo.desc(3548,"View: Graph"),"tbGraph",2)]});}if(AF){var x=this.getPortletExportGridToolbar(AA.k);if(x){AK=x.css;AM=x.node;n.push(AM);}}if(q){if(h.iifp){AI="wrap";n.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:[Z(mstrmojo.desc(8973,"Collapse"),"co",U,1,AG),Z(mstrmojo.desc(8972,"Expand"),"ex",G,0,AG)]});}else{var AO=[Z(mstrmojo.desc(4539,"Minimize"),"mn",F,1,AG),Z(mstrmojo.desc(4540,"Restore"),"rs",V,0,AG),Z(mstrmojo.desc(4541,"Maximize"),"mx",B,2,AG)];if(AF){AM.children=(AM.children||[]).concat(AO);}else{AK="resize";n.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AO});}}}AA.slot="contentNode";AA.alias="content";AA.title=h.ttl||"";if(h.sec){if(h.style!==mstrmojo.DocSelectorViewFactory.STYLES.SCROLLER&&!h.sos){var a=AJ.data,AQ=a.elms,AL=a.ces;if(AL&&AQ&&AQ.length){AA.count=K.buildElemsCountStr(AL,AQ);}}}n.push(AA);if(AC===A.PANELSTACK){var j=function(AU,w,AT,t){return AR(AU,AD+w,function(){return this.parent.parent.content.switchToPanel(t);},{enabled:"this.parent.parent."+AT});},AE=[],o=[],AN=!!AJ.sw,z=!!h.ifw,k=!!h.ifp;if(AN){o.push(j(mstrmojo.desc(1058,"Previous"),"tbPrev","prevEnabled",-1));AE.push(j(mstrmojo.desc(2917,"Next"),"tbNext","nextEnabled",1));}if(z){AE.push(AR(mstrmojo.desc(2102,"Close"),AD+"mstrmojo-DocInfoWindow-close",function(){this.parent.parent.parent.close();}));}if(k){f="ifp";n.push({scriptClass:"mstrmojo.HBox",slot:"buttonbarNode",alias:"buttonbar",cssClass:"buttonBox",children:[{scriptClass:"mstrmojo.Button",alias:"applyNow",title:mstrmojo.desc(2164,"Apply"),text:mstrmojo.desc(2164,"Apply"),cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !h.cas;},enabled:function(){return this.parent.parent.applyEnabled;}},onclick:function AS(){if(AA&&AA.applyBufferedSlices){AA.applyBufferedSlices();}}}]});AE.push({scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AS(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.FilterPanelMenu",{openerButton:this,fps:AA,cmPos:this.cmPos});}}});g=true;}if(z||k){var b=[];if(AN){b[0]="pst-l";}if(k){b.push("ifp");}o.push({scriptClass:"mstrmojo.Box",cssClass:b.join(" ")});}if(z||AN||k){var p=z?"ifw ":"",l=k?"ifp ":"",AP=!h.cas?"cas ":"";AK=(AN?"pst-r ":"")+p+l+AP;AI=(AN?"pst-l ":"")+p+l+AP;n.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:o});n.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AE});}}if(AC===A.SELECTOR&&AA.spm){AK="spm";n.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AS(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.SelectorMenu",{openerButton:this,selector:AA,cmPos:this.cmPos});}}}]});g=true;}var s="Doc"+(q?"Resizable":"")+"Portlet",i={defn:AA.defn,model:AA.model,children:n,title:AA.title,count:AA.count,floatingTitle:(h.ttl===undefined&&h.qsm),leftToolbarNodeClass:AI,loadDataOnResize:AH,toolbarNodeClass:AK,buttonbarNodeClass:f,attachContextMenuEvent:g};if(AC===A.PANELSTACK){i.bindings={title:"this.children[0].title"};if(AJ.sw){i.bindings.prevEnabled=function(){return this.children[0].hasPreviousPanel;};i.bindings.nextEnabled=function(){return this.children[0].hasNextPanel;};}if(h.ifp){i.bindings.applyEnabled=function(){return this.children[0].applyEnabled;};}}return new mstrmojo[s](i);},getPortletExportGridToolbar:mstrmojo.emptyFn,getLayoutViewerClass:function D(a){return mstrmojo.DocLayoutViewer;},newLayout:function Y(k,h){var j=[],f=h.data,i=h.defn,b=this.getLayoutViewerClass(h),a=new b({n:i.title,model:k,node:h,controller:this.parent.controller,tbc:i.tbc,slot:"containerNode",visible:false,ifs:f.ifs,gb:f.gbys});var l=a.defn=N.copy(i);l.fmts=N.copy(i.fmts);var g=function(s,t){var o=s.length;if(o){var p,q;for(p=0;p<o;p++){q=this.build([s[p]],k)[0];q.slot=t;j.push(q);}}};g.call(this,k.getFixedHeaders(h),"fixedHeaderNode");var n=mstrmojo["DocLayout"+((i.horiz)?"Horiz":"")];j.push(new n({slot:"layout",id:h.id,k:h.k,minHeight:f.mh,formatResolver:k.formatResolver,rules:i.rules,builder:this,node:h,defn:i,model:k}));g.call(this,k.getFixedFooters(h),"fixedFooterNode");a.addChildren(j);return a;},newSection:function(b,f){var a=(f.defn.horiz&&f.data.subsections.length>1)?"DocSectionHoriz":"DocSection";return new mstrmojo[a]({id:f.id,node:f,model:b});},newHTMLContainer:function(b,f){var a=(f.defn.ht===0)?"DocHTMLContainer":"DocTextfield";return new mstrmojo[a]({id:f.id,node:f,model:b});},adjustMojoVisualizationClass:function L(a){return a;},newMojoVisualization:function(j,g){var h=this.visList,b=g.data,p=h.getVis(b.visName);if(!p){var n=b.className;if(!n){return this.newXtab(j,g);}p={dc:n};}var k=(p.dc!==undefined)?p.dc:p.c;k=this.adjustMojoVisualizationClass(k);mstrmojo.requiresCls("mstrmojo."+k);var o=N.walk(k,mstrmojo),l=N.walk(p.m||"DocVisModel",mstrmojo);if(!o||!l){throw new Error("Missing visualization class.");}o=h.getVisClass(o,g.defn);var a=new o(N.copy(b.extProps,{id:g.id,node:g,n:g.defn.title,controller:this.parent.controller,gb:b.gbys}));a.setModel(new l({xtab:a,controller:this.parent.controller,docModel:j}));a.model.set("data",b);if(!!g.data.sdp){var f;for(f in g.data.sdp){g.data.sdp[f].defn={};var i=this.newXtab(j,g.data.sdp[f]);i.setModel(new l({xtab:i,controller:this.parent.controller,docModel:j,data:g.data.sdp[f]}));i.k=f;}}return a;},newInfoWindow:function X(a){return new mstrmojo.DocInfoWindow(a);},newRoundedRectangle:function P(f,g){var b=mstrmojo.dom,a=(b.supports(b.cssFeatures.ROUND_CORNERS))?"DocRectangle":"DocRoundRectangle";return new mstrmojo[a]({id:g.id,node:g,model:f});},newSelector:function J(b,f){var a=(f.defn.ct==="4"?"DocActionSelector":"DocSelector");return new mstrmojo[a]({id:f.id,node:f,controller:this.parent.controller,model:b});},newXtab:function I(b,f){var a=f.defn.txi,h,g=mstrmojo.DocXtab;if(a){g=S(mstrmojo.DocXtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.DocXtab"});}h=new g({id:f.id,node:f,controller:this.parent.controller});h.model=new mstrmojo.DocXtabModel({xtab:h,docModel:b});return h;},getLinkDrillMixins:function T(a){return a?[mstrmojo._HasHoverButton]:[];}});}());(function(){mstrmojo.requiresCls("mstrmojo.StackContainer","mstrmojo._IsRwDocument","mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo._DocOIVMMethods","mstrmojo.array","mstrmojo.css");mstrmojo.Doc=mstrmojo.declare(mstrmojo.StackContainer,[mstrmojo._HasBuilder,mstrmojo._IsRwDocument,mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.Doc",cssClass:"mstrmojo-Doc",methods:{"*":"mstrmojo._DocOIVMMethods"},markupSlots:{containerNode:function(){return this.domNode;},popupNode:function(){return this.domNode;},drillLinkMenuNode:function(){return this.domNode;}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},getLayouts:function(){return this.children;},buildChildren:function A(M){if(this._super(false)){var L=this.model.getSelectedKey(this.node),N=(L!==null)?mstrmojo.array.find(this.children,"k",L):-1,O=(N>-1)?this.children[N]:null;if(O){this.set("selected",O);}return true;}return false;},restoreLayoutState:function K(M){this._super(M);var L=M.zf;if((this.zf!==L||this.model.zf!==L)&&this.updateZoom){this.zf=this.model.zf=L;this.updateZoom();}},_set_selected:function F(P,N){if(!this.selected){return this._super(P,N);}if(N){var M=this,L=this._super,O=N.k;this.getNewLayout({layoutKey:O},this.children,(O!==this.model.currlaykey),{success:function(R){var Q=M.selected;L.call(M,P,R);M.raiseEvent({name:"selectedChange",prop:"selected",value:R,valueWas:Q});}});}return true;},onLayoutRebuilt:function J(L){this._set_selected("selected",L,true);},replaceLayout:function G(N,M){var L=this.removeChildren(N);N.destroy();var O=this.builder.build([M],this.model);this.addChildren(O,L);return O[0];},getSelectedLayoutWidget:function C(){return this.selected;},xtabCellMenuRef:"mstrmojo.XtabCellMenu",openXtabCellMenu:function(L){if(L){L.opener=this;if(this._lockInfoWinContainer){this._lockInfoWinContainer(L);}}this.openPopup("xtabCellMenuRef",L);},closeXtabCellMenu:function E(){this.closePopup();},drillLinkMenuRef:"mstrmojo.DrillLinkMenu",openDrillLinkMenu:function D(L){if(L){L.opener=this;}this.openPopup("drillLinkMenuRef",L);},closeDrillLinkMenu:function H(){this.closePopup();},goToLink:function I(L){if(L){window.open(L.url,(L.target||"_self"));}},selectorMenuRef:"mstrmojo.SelectorMenu",fpMenuRef:"mstrmojo.FilterPanelMenu",openPopupMenu:function B(M,L){if(L){L.opener=this;}this.openPopup(M,L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayoutViewer","mstrmojo.DocGroupBy","mstrmojo.Xtab","mstrmojo.IncFetch","mstrmojo.DocPanelStack","mstrmojo.express.ui.DocButton","mstrmojo.ExpressDocPanel","mstrmojo._IsEditableXtab","mstrmojo._CanSupportTransaction","mstrmojo.ExpressVisList","mstrmojo.OIVMDICConfig","mstrmojo.OIVMDocSelectorViewFactory","mstrmojo.OIVMDocXtabGraph","mstrmojo.MenuButton","mstrmojo.ToolBar");mstrmojo.requiresDescs(5212,5213);var D=mstrmojo.EnumRWUnitType,I=mstrmojo.DynamicClassFactory.newComponent,H=mstrmojo.desc;mstrmojo.DocXtab=I(mstrmojo.Xtab,[mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab"});var C=3,G=4;var A=function(M,L){var K=M;while(K){if(K.requiresMethod){K.requiresMethod(L);}if(K[L]){return K;}K=K.parent;}return null;};mstrmojo.ExpressDocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,null,{scriptClass:"mstrmojo.ExpressDocBuilder",visList:mstrmojo.ExpressVisList,init:function J(L){this._super(L);var K=this.classMap;this.selectorFactory=new mstrmojo.OIVMDocSelectorViewFactory();K[D.GRAPH]={n:"OIVMDocXtabGraph",scriptClass:"mstrmojo.OIVMDocXtabGraph"};K[D.PANELSTACK]={n:"PanelStack",scriptClass:"mstrmojo.DocPanelStack"};K[D.PANEL]={n:"Panel",scriptClass:"mstrmojo.ExpressDocPanel"};K[D.TEXTFIELD+"B"]={n:"Button",scriptClass:"mstrmojo.express.ui.DocButton"};},newLayout:function F(K,M){var L=this._super(K,M);var N=M.data.gbys;if(N){L.addChildren(new mstrmojo.DocGroupBy({id:N.k,slot:"groupBy",title:N.title,model:K,node:M,data:N.groupbys,controller:this.parent.controller}));}if(M.data.ifs){var O=new mstrmojo.IncFetch(mstrmojo.hash.copy(M.data.ifs,{slot:"incFetchNode",model:K}));O.attachEventListener("fetch",L.id,function(P){var Q=function(R){if(P.iWait){P.iWait.set("visible",R);}};K.getDataService().fetchDocPage((P.v-1)*O.ps+1,{submission:function(){Q(true);},success:function(R){K.loadLayout(R);},complete:function(){Q(false);}});});L.addChildren(O);}return L;},newXtab:function E(M,N){var K=N.defn.txi,L=mstrmojo.DocXtab;if(K){mstrmojo.EditableXtab=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.Xtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.EditableXtab"});L=mstrmojo.EditableXtab;}var O=mstrmojo.all[N.id];if(!O){O=new L({id:N.id,node:N,controller:this.parent.controller});O.model=new mstrmojo.DocXtabModel({xtab:O,docModel:M});}else{O.set("node",N);O.model.set("docModel",M);}return O;},getPortletExportGridToolbar:function B(K){return{css:"grid-menu",node:{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.MenuButton",iconClass:"mstrmojo-oivmSprite tbDown",itemIdField:"did",itemField:"n",itemChildrenField:"subItms",executeCommand:function(M){var L=A(this,"exportCmd");if(L){L.exportCmd(M.did,K);}},cm:[{n:H(5212,"Export to PDF"),did:C},{n:H(5213,"Export to Excel"),did:G}]}]}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.Doc","mstrmojo.ExpressDocBuilder","mstrmojo.ToolBar","mstrmojo.OIVMPage","mstrmojo.ToolBarBuilder","mstrmojo.TabContainer","mstrmojo.ScrollingTabStrip","mstrmojo.ToolBarModel","mstrmojo.OIVMDocController","mstrmojo.DocModel");function G(L,J){var K=((J)?"add":"remove")+"LoadingGraph";this.serverProxy[K](L);}mstrmojo.OIVMApp=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.OIVMApp",serverProxy:null,init:function I(J){this._super(J);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}},start:function B(){var N=new mstrmojo.Doc({slot:"stack"});N.builder=new mstrmojo.ExpressDocBuilder({parent:N});this.docId=N.id;var L=new mstrmojo.ToolBar({slot:"toolbar",cssClass:"mstrmojo-oivmSprite grouped",builder:mstrmojo.ToolBarBuilder});var K=new mstrmojo.OIVMPage({placeholder:this.placeholder,error:this.error,children:[L,new mstrmojo.TabContainer({slot:"layout",layoutConfig:{h:{top:"auto",stack:"100%"},w:{top:"100%",stack:"100%"}},children:[new mstrmojo.ScrollingTabStrip({slot:"top",cssClass:"mstrmojo-layout-tabs",visible:false,bindings:{width:"this.parent.width"}}),N]})]});if(this.hasHiddenSections){K.layoutConfig.h.toolbar="0px";}K.render();var O=this.docModelData;if(O&&O.mstrerr){mstrmojo.err(O);}else{if(!this.error){L.model=new mstrmojo.ToolBarModel(this.tbModelData);L.target=N;var J=N.model=new mstrmojo.DocModel(O);N.controller=J.controller=new mstrmojo.OIVMDocController({model:J});mstrApp.docModel=J;mstrApp.onSessionExpired=function(){var Q=mstrApp,P=Q.docModel;mstrmojo.requiresCls("mstrmojo.form");mstrmojo.form.send({evt:5005,src:Q.name+"."+Q.pageName+".5005",rwb:P.bs});};mstrmojo.hash.copy(L.model.features,L.target.model.features);mstrmojo.locales.load(function(){L.buildChildren();N.buildChildren();});if(mstrApp.pendingMojoEditor&&mstrApp.pendingMojoEditor!=""){N["show"+mstrApp.pendingMojoEditor]();delete mstrApp.pendingMojoEditor;}var M=N.model.rf;if(M>0){N.model.controller.startAutoRefresh();}}}},onMobileDevice:function C(){return false;},isTouchApp:function E(){return false;},getContentDimensions:function F(J){return null;},getConfiguration:mstrmojo.emptyFn,addLoadingGraph:function D(J){G.call(this,J,true);},removeLoadingGraph:function H(J){G.call(this,J);},serverRequest:function A(O,Q,J){try{Q=Q||{};J=J||{};var M=J.src||(arguments.calle&&arguments.calle.caller.name),L=!J.silent&&J.fnWait,P=!J.silent&&J.fnHideWait,N=this;Q=mstrmojo.func.wrapMethods(Q,{submission:function(){if(L){L();}},failure:function(R){if(!J.silent){R.method=M;mstrmojo.err(R);}},complete:function(){if(P){P();}}});window.setTimeout(function(){N.serverProxy.request(Q,O,!!J.override,J);},0);}catch(K){mstrmojo.err(K);}}});window.$MAPF=function(){return false;};}());