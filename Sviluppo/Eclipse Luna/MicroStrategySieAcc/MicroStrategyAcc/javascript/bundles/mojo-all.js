var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var A;var B;var C;try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");A=B.GetVariable("$version");}catch(C){}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");A="WIN 6,0,21,0";B.AllowScriptAccess="always";A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A="WIN 3,0,18,0";}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");A="WIN 2,0,0,11";}catch(C){A=-1;}}return A;}function GetSwfVer(){var G=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var F=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var A=navigator.plugins["Shockwave Flash"+F].description;var E=A.split(" ");var C=E[2].split(".");var H=C[0];var B=C[1];if(E[3]!=""){tempArrayMinor=E[3].split("r");}else{tempArrayMinor=E[4].split("r");}var D=tempArrayMinor[1]>0?tempArrayMinor[1]:0;var G=H+"."+B+"."+D;}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){G=4;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){G=3;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){G=2;}else{if(isIE&&isWin&&!isOpera){G=ControlVersion();}}}}}return G;}function DetectFlashVer(F,D,C){versionStr=GetSwfVer();if(versionStr==-1){return false;}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",");}else{versionArray=versionStr.split(".");}var E=versionArray[0];var A=versionArray[1];var B=versionArray[2];if(E>parseFloat(F)){return true;}else{if(E==parseFloat(F)){if(A>parseFloat(D)){return true;}else{if(A==parseFloat(D)){if(B>=parseFloat(C)){return true;}}}}}return false;}}}function AC_AddExtension(B,A){if(B.indexOf("?")!=-1){return B.replace(/\?/,A+"?");}else{return B+A;}}function AC_Generateobj(F,E,A,D){var C="";if(isIE&&isWin&&!isOpera){C+="<object ";for(var B in F){C+=B+'="'+F[B]+'" ';}for(var B in E){C+='><param name="'+B+'" value="'+E[B]+'" /> ';}C+="></object>";}else{C+="<embed ";for(var B in A){C+=B+'="'+A[B]+'" ';}C+="> </embed>";}if(typeof (D)!="undefined"){var G=(typeof D=="string")?document.getElementById(D):D;G.innerHTML=C;}else{document.write(C);}}function AC_FL_RunContent(){var A=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(A.objAttrs,A.params,A.embedAttrs,A.parentDiv);}function AC_GetArgs(B,E,G,D,H){var A=new Object();A.embedAttrs=new Object();A.params=new Object();A.objAttrs=new Object();for(var C=0;C<B.length;C=C+2){var F=B[C].toLowerCase();switch(F){case"classid":break;case"parentdiv":A.parentDiv=B[C+1];case"pluginspage":A.embedAttrs[B[C]]=B[C+1];break;case"src":case"movie":B[C+1]=AC_AddExtension(B[C+1],E);A.embedAttrs.src=B[C+1];A.params[G]=B[C+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":A.objAttrs[B[C]]=B[C+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":A.embedAttrs[B[C]]=A.objAttrs[B[C]]=B[C+1];break;default:A.embedAttrs[B[C]]=A.params[B[C]]=B[C+1];}}A.objAttrs.classid=D;if(H){A.embedAttrs.type=H;}return A;}AC_OETagsObj.prototype=new Object();function AC_OETagsObj(){}mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats();var I=J.toLowerCase();if(H&&I in H){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects={height:function A(){return B("Height",this);},width:function D(){return B("Width",this);},getMaxZIndex:function C(){var E=0;mstrmojo.array.forEach(this.children,function(F){E=Math.max(E,F.getFormats()["z-index"]);});return E;}};})();(function(){mstrmojo._IsSelectorTarget={_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(B){var C=((B)?"add":"remove")+"DirtyKey";if(this.parent&&this.parent[C]){this.parent[C](this.k);}}};})();(function(){var A={};mstrmojo.NumberFormat={getInstance:function B(F,G){var E=F+"--"+G;if(E in A){return A[E];}var C={parse:function(H){},format:function(H){}};if(F==="."&&G===","){C.parse=function(H){if(!H){return NaN;}var I=H.replace(/,/g,"");return Number(I);};C.format=function(H){return Number(H).toString();};}else{var D=new RegExp("\\"+G,"g");C.parse=function(I){if(!I){return NaN;}var H=I.replace(D,"").replace(F,".");return Number(H);};C.format=function(I){var H=Number(I).toString();return H.replace(".",F);};}A[E]=C;return C;}};})();(function(){function B(I,J,H){var F=0,G=0,E=(H&&H.length)||0;if(!I||!H){return F;}for(;G<E;G++){F+=H[G][J]();}return F;}function D(E,F){if(F===undefined||isNaN(F)){return E;}return(E&&[E[F-1]]);}mstrmojo._CanMeasureChildren={height:function A(E){return B(this.domNode,"height",D(this.children,E));},width:function C(E){return B(this.domNode,"width",D(this.children,E));}};}());(function(){mstrmojo._HasDrillLinks=mstrmojo.provide("mstrmojo._HasDrillLinks",{_mixinName:"mstrmojo._HasDrillLinks",update:function A(E){this._super(E);var B=E.defn.dl,F=E.data.dl,D=this.drillLinkItems=((B&&B.items)||[]).concat((F&&F.items)||[]).sort(function(H,G){return H.index-G.index;}),C;for(C=D.length-1;C>=0;C--){if(C&&D[C].index===D[C-1].index){D.splice(C,1);}}if(B&&B.target){for(C=0;C<D.length;C++){D[C].target=B.target;}}}});}());(function(){mstrmojo.FlexHelper=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.FlexHelper",getWidget:function C(D){var E=D.split("x");return mstrApp.docModel.getUnitInstance(E[0],E[1]);},getZoomFactor:function A(){return mstrApp.docModel.zf*100;}});var B=new mstrmojo.FlexHelper();window.getFlexHelper=function(){return B;};})();(function(){function L(N,T,S,P,R,O,Q){if(T>O){return false;}return(!Q)||(N===0)||((N<P)&&(T>=R-(O-R)));}function H(Q,N,U,T,P,S,O,R){if(U>O){return false;}return(!R)||((N<P)&&(U>=S-Q.height()));}function F(N,P,O){N.renderMode="scroll";N.render();N.numChildrenRendered=0;P.numChildrenRendered++;if(O&&!N.builtChildren){N.buildChildren();}}function E(){return this.useScrollBuffer?this.scrollBuffer:0;}mstrmojo._CanRenderDocOnScroll=mstrmojo.provide("mstrmojo._CanRenderDocOnScroll",{_mixinName:"mstrmojo._CanRenderDocOnScroll",renderMode:"scroll",scrollBuffer:0,postBuildRendering:function B(){if(this.renderMode===null){return this._super();}else{this.renderChildren();return true;}},childRenderOnAddCheck:function(N){if(this.renderMode===null){return this._super(N);}else{return false;}},renderChildren:function M(){var O;if(this.renderMode==="scroll"){var P=this;while(P){if(P.scrollboxNode&&(P.scrollboxWidthFixed||P.scrollboxHeightFixed)&&P.connectScrollbox){O=P;break;}P=P.parent;}}if((this.renderMode!=="scroll")||!O){this._super();return ;}if(this.containerNode){this.scrollboxOwner=O;O.connectScrollbox(this);this.numChildrenRendered=0;var N=this.numChildren;if(N===undefined){this.numChildren=N=this._getModelChildNodes(this.node,false,0,0,true).total;}this.sectionsToRender=N;this.subsectionsToRender=0;if(N){this._startSubsectionThread(false);}}if(this.resizeOrReposition){this.resizeOrReposition();}},onscroll:function J(){if(!this.renderingSubsections){this.useScrollBuffer=true;this._startSubsectionThread(true);}},_startSubsectionThread:function A(Q){var O=this;var P=function(S,R){if(O[S]){if(R){self.clearTimeout(O[S]);}else{self.clearInterval(O[S]);}delete O[S];}};var N=function(S){O.renderingSubsections=false;var R=function(){P("renderCtlsTimer");O.showRenderStatus(false);O.renderCtrlsInViewport();O.raiseEvent({name:"afterScroll"});O=null;};if(S){O.renderCtlsTimer=self.setTimeout(R,O.scrollboxOwner.scrollInterval+1);}else{R();}};P("renderSubsTimer");P("renderCtlsTimer",true);this.renderingSubsections=true;if((this.sectionsToRender||this.subsectionsToRender)&&!this._renderSubsectionsToScroll()){this.showRenderStatus(true);this.renderSubsTimer=self.setInterval(function(){if(O._renderSubsectionsToScroll()){P("renderSubsTimer");N(Q);}else{O.showRenderStatus(true);}},this.scrollboxOwner.scrollInterval);}else{N(Q);}},showRenderStatus:function G(O,T){var S=this.parent;if(!S||!S.showStatus){return ;}var N=T,P;if(O){var Q=this.numChildrenRendered,R=this.numChildren;P=R&&parseInt(100*Q/R,10);N="*Rendering section "+Q+" of "+R+".*";}S.showStatus(O,N,P);},_renderSubsectionsToScroll:function K(){var Y=this.scrollboxOwner,Z=Y.scrollboxTop,Q=Y.scrollboxLeft,T=Y.scrollboxBottom+E.call(this),l=Y.scrollboxRight,a=T-Z,W=0,V=0,U=null,b=null,X,i;function m(){U=V;b=U+a;}var N=this.numChildren,S=this.children||[],P=this.model,g=this.node,f=false;for(i=0;i<N;i++){var k=S[i];if(!k){k=this.addChildren(this.builder.build(this._getModelChildNodes(g,false,i,1,true).nodes,P))[0];S=this.children||[];}var O=f;f=!!k.defn.horiz;X=(i>0&&k.node.data.bh);if((!f&&O)||(X&&O)){W=0;V+=S[i-1].height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}if(!k.hasRendered){if(!L(W,V,Q,l,Z,T,f)){if(f){continue;}else{return true;}}this._renderSection(k,i);this.sectionsToRender--;this.subsectionsToRender+=(k.children&&k.children.length)||0;if(U===null){m();}}var R=k.children||[],h=null,e,j;for(e=0,j=R.length;e<j;e++){h=R[e];if(!h.hasRendered){if(!H(h,W,V,Q,l,Z,T,f)){if(f){break;}else{return true;}}F(h,k);this.subsectionsToRender--;if(U===null){m();}}if(f){W+=h.width();if(W>l){break;}}else{V+=h.height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}}}return true;},_renderSection:function I(N,O){F(N,this,true);},_getModelChildNodes:function(P,O,R,N,Q){return this.model.getChildren(P,O,R,N,Q);},renderCtrlsInViewport:function D(){var W=this.scrollboxOwner,Y=W.scrollboxTop,O=W.scrollboxLeft,R=W.scrollboxBottom+E.call(this),n=W.scrollboxRight,T=0,S=0,e=false,Q=this.children||[],N,U,h,X;var b=function(i){if(e){T+=i.width();}else{S+=i.height();}};var l=function(w,i,t,x,q){i=parseInt(i,10)||0;t=parseInt(t,10);return(isNaN(t))?(w+i<=q):mstrmojo.boxmodel.rangeIntersect(w+i,w+i+t,x,q);};for(h=0,X=(Q&&Q.length)||0;h<X;h++){var o=Q[h];N=e;e=!!o.defn.horiz;U=(h>0&&o.node.data.bh);if((!e&&N)||(U&&N)){T=0;S+=Q[h-1].height();if(S>R){return ;}}if(!o.hasRendered){if(!e){return ;}else{continue;}}var k=o.children,P=(k&&k.length)||0,a,g;for(a=0;a<P;a++){g=k[a];if(!g.hasRendered){break;}if(g.builtChildren&&(g.numChildrenRendered===((g.children&&g.children.length)||0))){b(g);}else{if((S+g.height()>=Y)&&(!e||(T+g.width()>=O))){var p=g.children,Z=(p&&p.length)||0;if(!Z&&!g.builtChildren){g.buildChildren();p=g.children;Z=(p&&p.length)||0;}var f=[],j;for(j=0;j<Z;j++){var m=p[j];if(m.hasRendered){continue;}var V=m.getFormats()||{};if(l(S,V.top,V.height,Y,R)&&l(T,V.left,V.width,O,n)){m.render();f.push(m);}}g.performCanGrowCanShrink(f,true);}b(g);}if((e&&T>n)||(!e&&S>R)){break;}}}},unrender:function C(O){var N=this.scrollboxOwner;if(N){N.disconnectScrollbox(this);}this._super(O);}});}());(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}else{if(D.visible){return this._super(D);}else{var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;}}},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});})();(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};})();mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasDrillLinks","mstrmojo.registry","mstrmojo.hash","mstrmojo.dom");var B=mstrmojo.dom;function D(F){var E=F;while(E){if(E.openDrillLinkMenu){return E;}E=E.parent;}return null;}mstrmojo._HasHoverButton=mstrmojo.provide("mstrmojo._HasHoverButton",mstrmojo.hash.copy(mstrmojo._HasDrillLinks,{_mixinName:"mstrmojo._HasHoverButton",buttonNodeMarkup:'<div class="mstrmojo-LinkInfo-buttonNode"></div>',init:function C(E){this._super(E);this.markupSlots.buttonNode=function(){return this.domNode.lastChild;};},postBuildRendering:function A(){if(!this.hoverBtn){this.addChildren(mstrmojo.registry.ref({scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"hoverBtn",onclick:function H(){this.openPopup();},openPopup:function E(){var J=D(this);if(J){J.openDrillLinkMenu({openerButton:this,drillLinkItems:this.parent.drillLinkItems,cmPos:this.cmPos});}},closePopup:function F(){var J=D(this);if(J){J.closeDrillLinkMenu();}}}));}var G=this._super();var I=this.id;B.attachEvent(this.domNode,"contextmenu",function(J){mstrmojo.all[I].oncontextmenu(J,self);});return G;},oncontextmenu:function(G,E){var F=this.hoverBtn;F.cmPos=B.getMousePosition(G,E);F.openPopup();F.cmPos=null;B.preventDefault(E,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer");var Q=mstrmojo.dom,O=mstrmojo.hash,T=mstrmojo.array;function U(){O.forEach(this.ifwMap,function(X){X.destroy();});this.ifwMap={};}function A(){var X=[],Z=null,Y=null;O.forEach(this.ifwMap,function(a){if(a.visible){X.push({psId:a.psId,psKey:a.psKey,anchorPos:a.anchorPosition||Q.position(a.anchor,true),anchorOrn:a.anchorOrientation});}});if(X.length>0){Z=this.getSelectedLayoutWidget();Y=Z&&Z.getScrollPos();}return{ifwRecords:X,docScrollRecord:Y};}function L(b){var X=(b&&b.ifwRecords)||[],Y=b&&b.docScrollRecord,Z=this.getSelectedLayoutWidget(),a=this,e={};if(X.length>0){if(Y&&Z){Z.scrollTo(Y);}T.forEach(X,function(f){a.showInfoWindow(f.psId,f.psKey,e,null,f.anchorOrn,f.anchorPos);});}}function I(){mstrmojo.DICPopup&&mstrmojo.DICPopup.cancel&&mstrmojo.DICPopup.cancel();}function N(){if(this.xtabStyleSheets){var Z,Y,X;for(Y=0;Z=this.xtabStyleSheets[Y];Y++){X=Z.parentNode;if(X){X.removeChild(Z);}}}}function W(Y,b){var Z=this.getLayout(Y),X=Z.docGroupBy,a=this.controller;if(X){X.set("data",b.groupbys);Z.gb=b;}if(a.getPageByTree){a.getPageByTree(true);}}mstrmojo._IsRwDocument={_mixinName:"mstrmojo._IsRwDocument",updateXtabStyles:function K(f,Z){var l=this.xtabStyleSheets&&this.xtabStyleSheets[0],k=this.styleList||{},Y=function(q,o){var p;for(p in o){var n=o[p].css||"";if(o[p].app){n=(q[p]||"")+n;}q[p]=n;}return q;},m=document;if(!k[f]){k[f]=Y({},this.model.getSelectedXtabStyles(f));}Y(k[f],Z);if(!l){this.xtabStyleSheets=[];l=this.xtabStyleSheets[0]=m.getElementsByTagName("head")[0].appendChild(m.createElement("style"));}var a=new mstrmojo.StringBuffer(),b,e;for(b in k){for(e in k[b]){a.append(k[b][e]);}a.append("\n");}a=a.toString();if(l&&a){l=l.styleSheet||l;if(Q.isWK){var j=l.firstChild;if(j){j.nodeValue=a;}else{l.appendChild(m.createTextNode(a));}}else{if(Q.isIE){l.cssText=a;var i,h,X,g;for(i=1;l.rules.length===4095&&m.styleSheets.length<31;i++){h=l.rules[4094];X=new RegExp(h.selectorText,"i");g=a.search(X);if(g===-1){break;}g=a.indexOf("}",g+1);a=a.slice(g+1);if(!this.xtabStyleSheets[i]){this.xtabStyleSheets[i]=m.getElementsByTagName("head")[0].appendChild(m.createElement("style"));}l=this.xtabStyleSheets[i].styleSheet;l.cssText=a;}}else{l.innerHTML=a;}}}this.styleList=k;},postBuildRendering:function S(){if(this.xtabStyleSheets){for(var Y,X=0;Y=this.xtabStyleSheets[X];X++){if(!Y.parentNode){document.getElementsByTagName("head")[0].appendChild(Y);}}}return this._super();},buildChildren:function B(b){var h;try{var e=this.model;if(e){var f=this.buildSubs||{},n=e.id+"-partialUpdate",Y=e.id+"-rebuildLayout",j=e.id+"-updateStyles",a=e.id+"-showInfoWin",Z=this.id;var i=this,l=function(){T.forEach(i.getLayouts(),function(m){if(m.k!==e.currlaykey){m.defn.loaded=false;}});};if(f[n]===undefined){var k=function X(z){var q=this.model,p=q&&q.getLayoutDataCache(q.getCurrentLayoutKey()),o=z&&z.ids;if(O.isEmpty(p)||!o){return ;}T.forEach(z.tree.layouts,function(m){if(m.k===q.currlaykey){this.updateXtabStyles(m.k,m.xtabStyles);if(m.gbys){W.call(this,m.k,m.gbys);}return false;}},this);var t=O.forEach,AA=false,w={update:o.upd,refresh:o.tgts,adjustSectionSize:o.secs};t(o.ifws,function(AC,AB){var m=mstrmojo.all[AC+"_ifw"];if(m&&m.visible){this.updateInfoWindowPS(AC,AB);}},this);t(w,function(AB,m){t(AB,function(AD,AF){var AC=mstrmojo.all[AF],AE;if(AC&&AC[m]!==undefined){AE=AC[m](m==="update"?p[AF]:null);if(m==="adjustSectionSize"&&AE){AA=AA||(!!AE.heightReduced);}}},this);},this);var s=this.getSelectedLayoutWidget();if(AA){s.notifyScrollListeners();}var x=s.docLayout;if(x){x.resizeOrReposition();}if(z&&z.unloadCache){l();}};f[n]=e.attachEventListener("partialUpdate",Z,k);}f[Y]=f[Y]||e.attachEventListener("rebuildLayout",Z,function(m){var p=m&&m.restoreIW,o;if(p){o=A.call(this);this.model.aws=null;}this.onLayoutRebuilt(this.rebuildLayout(m.src.currlaykey,this.getLayouts()));if(m&&m.unloadCache){l();}if(p){L.call(this,o);}});f[j]=f[j]||e.attachEventListener("updateStyles",Z,function(m){this.updateXtabStyles(m.key,m.updatedStyles);});f[a]=f[a]||e.attachEventListener("showInfoWin",Z,function(m){this.showInfoWindow(m.psId,m.psKey,m.anchor,m.invalidate,m.anchorOrientation,m.anchorPosition);});this.updateXtabStyles(e.getCurrentLayoutKey());e.attachEventListener("refresh",this.id,function(){this.refresh();});}h=this._super(b);}catch(g){mstrmojo.err(g);}return h;},updateInfoWindowPS:mstrmojo.emptyFn,showInfoWindow:function H(Y,q,i,k,n,o){var a=this.model,f=a.getLayoutDataCache(a.getCurrentLayoutKey()),w=this.builder,X=f[Y]&&f[Y].defn,e=X&&X.iwpl,t=Y+"_ifw",AB=mstrmojo.all[t],x=this.domNode,Z=mstrmojo.DocInfoWindow.PLACEMENT.FIXED,z=function(AC,AD,AE,AG,AF){if(e===Z){if(AD){var AH=Q.delta(AD,x);AC.popPosition={left:(AH&&AH.x)?AG+AH.x:AG,top:(AH&&AH.y)?AF+AH.y:AF};}else{if(AE){AC.popPosition={left:(AE.scrollboxLeft)?AG-AE.scrollboxLeft:AG,top:(AE.scrollboxTop)?AF-AE.scrollboxTop:AF};}else{AC.popPosition={left:AG,top:AF};}}}};var m=this.getLayout(a.getCurrentLayoutKey());if(AB){if(k){AB.refresh();}AB.anchorOrientation=n;AB.anchorPosition=o;z(AB,AB._ifwpdn,m,AB._ifwfl,AB._ifwft);AB.open(this,{anchor:i,boundary:x});}else{var g={opener:this,anchor:i,anchorOrientation:n,boundary:x,parent:this,builder:w,model:this.model,psKey:q,psId:Y,id:t,autoCloses:true,locksHover:true,closeOnClick:false,anchorPosition:o};if(e){e=parseInt(e,10);g.placement=e;if(e===Z){var h=X.fmts,b=g._ifwfl=h&&h.left&&parseInt(h.left.replace("px",""),10),s=g._ifwft=h&&h.top&&parseInt(h.top.replace("px",""),10),j=f[Y]&&f[Y].p,p=j&&a.getUnitInstance(j.k,j.wid),l=g._ifwpdn=p&&p.domNode;z(g,l,m,b,s);}}AB=w.newInfoWindow(g);this.renderInfoWindow(AB);var AA=this.ifwMap=(this.ifwMap||{});AA[Y]=AB;}},renderInfoWindow:function J(X){X.render();},_lockInfoWinContainer:function G(Y){var b=this.ifwMap,X;for(X in b){var Z=b[X],a=Y.xtab;if(Z&&a&&Q.contains(Z.infoNode,a.domNode,true,document.body)){Z.autoCloseLocked=true;Y.onClose=function(){Z.autoCloseLocked=false;};break;}}},unrender:function R(X){U.call(this);this._super(X);N.call(this);},getLayouts:function M(){return this._layouts;},getLayout:function P(X){X=X||this.model.getCurrentLayoutKey();var Y=this.getLayouts();return Y[T.find(Y,"k",X)];},getNewLayout:function E(Y,f,X,i){var b=this,Z=b.model,e=Z.getDataService(),h=Y.layoutKey,a=f[T.find(f,"k",h)];if(a.defn&&(Y.reload||a.defn.loaded===false||(Z.zt&&(window.mstrMobileApp!==undefined)&&(a.defn.lastOrientation!==mstrMobileApp.getOrientation())))){var g=i.success;i.success=function(j){Z.replaceLayout(h,j);Z.currlaykey=h;if(X){a.zf=j.zf;b.selectLayout(a,false);}var k=b.rebuildLayout(h,f);if(b.controller.getPageByTree){b.controller.getPageByTree(true);}g(k);};e.loadDocLayout(Y,i);}else{i.success(a);if(X){this.selectLayout(a,true,{success:function(j){O.copyProps(["bs"],j,Z);}});}}},selectLayout:function D(a,b,e){var X=this.model,Y=a.k,Z=(Y!==X.currlaykey);X.currlaykey=Y;this.restoreLayoutState(a);if(b&&Z){X.getDataService().setCurrentDocLayout(Y,e);}else{if(e&&e.complete){e.complete();}}return a;},rebuildLayout:function C(Y,f){var a=this.model,Z=T.find,b=f[Z(f,"k",Y)],X=a.getChildren(this.node,false);var e=X[Z(X,"k",Y)];if(window.mstrMobileApp!==undefined){e.defn.lastOrientation=mstrMobileApp.getOrientation();}var g=this.replaceLayout(b,e);this.updateXtabStyles(Y,a.getSelectedXtabStyles(Y));U.call(this);I();return g;},destroy:function V(){U.call(this);if(this._super){this._super();}N.call(this);},replaceLayout:mstrmojo.emptyFn,restoreLayoutState:mstrmojo.emptyFn,onLayoutRebuilt:mstrmojo.emptyFn,unloadGbLayuts:function F(Z){var g=this.getLayouts(),b=this.model.getCurrentLayoutKey(),f,e,h,Y,a,X;f=this.getLayout();Y=f.gb&&f.gb.groupbys;for(a=0;a<Y.length;a++){h=Y[a];if(h.k===Z){X=h.unit.target.did;break;}}for(e=0;e<g.length;e++){f=g[e];if(f.k===b){continue;}Y=f.gb&&f.gb.groupbys;if(Y&&Y.length){for(a=0;a<Y.length;a++){h=Y[a];if(h.unit.target.did===X){f.defn.loaded=false;break;}}}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",H="";var N=/\+/g;for(var I=0,F=M.length;I<F;I++){var E=M[I].split("=");L=E[0];H=E[1];if(H){H=decodeURIComponent(H.replace(N," "));}var G=document.createElement("INPUT");G.type="HIDDEN";G.name=L;G.value=H;K.appendChild(G);}return false;}mstrmojo.form={createDynamicForm:function A(E){var G=document.createElement("FORM"),H=E.indexOf("?")>0;G.name="dynamic_form";G.method="POST";var F=((H)?E.substring(0,E.indexOf("?")):E);G.action=F;if(H){B(G,E);}document.body.appendChild(G);return G;},send:function D(J,K,E,M,H,F){var O=((H&&H.hWin)||window).document,L=O.createElement("form"),I=mstrApp;L.method=E||"GET";if(M){L.target=M;}L.action=K||I.name;F=(F!==undefined)?F:!(L.action&&L.action.indexOf("aspx")>0);if(I.sessionId){L.action+=";jsessionid="+I.sessionId;}if(F){L.action+=";uxts"+mstrmojo.now();}L.appendChild(C(O,"xts",mstrmojo.now()));for(var P in I.persistTaskParams){J[P]=I.persistTaskParams[P];}if(I.servletState&&I.name){J[I.name]=I.servletState;}if(J){for(var G in J){if(J[G].constructor==Array){mstrmojo.array.forEach(J[G],function(Q){L.appendChild(C(O,G,Q));});}else{L.appendChild(C(O,G,J[G]));}}}O.body.appendChild(L);try{L.submit();}catch(N){if(M&&N.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}O.body.removeChild(L);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var C=mstrmojo.array;mstrmojo._BindTargetChildren={target:null,targetProps:null,addTabButtons:null,removeTabButtons:null,clearButtons:null,ontargetChange:function E(L){var M=L&&L.valueWas;if(M){var J=this._targetSubs;if(J){M.detachEventListener(J.add);M.detachEventListener(J.rem);M.detachEventListener(J.sel);}this.clearButtons();}var N=this.target;if(N){var I=this.targetProps,H=I&&I.children||"children",F=N[H];this.addTabButtons(F,0);this._onTargetSelChg();if(N.attachEventListener){var G=this.id,K="attachEventListener";this._targetSubs={add:N[K]("addChild",G,"_onTargetAddChild"),rem:N[K]("removeChild",G,"_onTargetRemoveChild"),sel:N[K]("selectedChange",G,"_onTargetSelChg")};}}if(this._ontargetChange){this._ontargetChange();}},_onTargetAddChild:function A(F){var G=F&&F.value;if(G&&G.length){this.addTabButtons(G,F.index);}if(this._postTargetAddChild){this._postTargetAddChild();}},_onTargetRemoveChild:function B(G){var F=G&&G.value;for(var H=((F&&F.length)||0)-1;H>-1;H--){this.removeTabButton(F[H]);}if(this._postTargetRemoveChild){this._postTargetRemoveChild();}},_onTargetSelChg:function D(L){var G=this.targetProps||{},F=this[G.names||"children"],J=function(O,P){if(O.set){O.set("selected",P);}else{O.selected=P;}};if(L){var H=L.valueWas,K=H?C.find(F,"target",H):-1;if(K>-1){J(F[K],false);}}var M=this.target,N=M&&M.selected,I=N?C.find(F,"target",N):-1;if(I>-1){J(F[I],true);}if(this._postTargetSelChg){this._postTargetSelChg();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo._HasBuilder={postBuildRendering:function B(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function C(){return this.model.getChildren(this.node,false);},buildChildren:function A(E){if(!this.builder||!this.model){return false;}if(this.children&&this.children.length){this.set("children",[]);}var D=this.model,F=this.builder.build(this.getChildren(),D,this.buildConfig);if(!E){this.addChildren(F);}this.builtChildren=true;return(E)?F:true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,L=mstrmojo.hash;function F(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(C.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function B(R){var Q=[],S=R.selectedIndices;for(var P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function N(V,U){var S=[],Q=V.selectedIndices,X=C.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return B(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}for(var R=0,T=U.length;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex==W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V;for(var Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function H(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function O(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=B(this),S=F(this,[P]);if(Q!==true){H(this,S,R);}}},toggleSelect:function J(P,Q){var S,R;if(this.selectedIndices[P]){R=N(this,[P]);}else{S=F(this,[P]);}if(Q!==true){H(this,S,R);}},rangeSelect:function G(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=B(this);if(P!==true){H(this,null,Q);}},select:function E(R,P){var Q=A(this,C.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){H(this,Q.add,Q.rmv);}},addSelect:function M(R,P){if(R==null){return ;}if(R.constructor!==Array){R=[R];}var Q=F(this,R);if(P!==true){H(this,Q,null);}return Q;},removeSelect:function K(R,P){if(R==null){return ;}if(R.constructor!=Array){R=[R];}var Q=N(this,R);if(P!==true){H(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){H(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof (T)=="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=C.find(U,V,T[V]);}else{if(T!=null){Q=C.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function D(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!=null){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return L.keyarray(this.selectedIndices,true).sort(C.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return C.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,e){if(!Q||!Q.length){return ;}var S=this.items||[],w=this.itemIdField!=null?C.findMulti(S,this.itemIdField,Q):C.indexOfMulti(S,Q),V=Q.length,T=V-w.count,s=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(s&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],g=w.map;if(T&&s){var q=0;for(var f=0;f<V;f++){if(g[f]==null){R.push(Q[f]);U.push(b+q++);}}this.add(R,b);}var W=[];for(var l in g){var p=g[l];if(p>=b){p+=X;}W.push(p);}var t=W.concat(U),Y=this.addSelect(t,!e);if(!e){var Z=C.hash(Y),h=this.selectedIndices,a=[];for(var o in h){if(!Z[o]){a.push(parseInt(o,10));}}var P=this.removeSelect(a,true);H(this,Y,P);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo.requiresDescs(4891);var D=mstrmojo.array,C="u;",A="-1";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function E(F,I,K){var H;for(var G in F){H=F[G];if(H.v){var J=H.v.split(";");if(J&&J.length>1){J[1]=I;if(K&&J.length>2){J.pop();}H.v=J.join(";");}}}return F;},buildElemsCountStr:function B(I,G){if(!I||!I.length||!G||!G.length){return"";}var H=I.length,F=G.length;if(D.find(G,"v",C)>-1){F-=1;}if(D.find(G,"v",A)>-1){F-=1;}if(D.find(I,"v",C)>-1||D.indexOf(I,C)>-1){H=F;}if(H>=F){return"("+F+")";}else{return mstrmojo.desc("4891").replace("##",H).replace("###",F);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.shouldEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){if(this.shouldEllipsize){A(this);mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered&&this.shouldEllipsize){this.doEllipsize();}}},this.markupMethods);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._IsPanelStack=mstrmojo.provide("mstrmojo._IsPanelStack",{_mixinName:"mstrmojo._IsPanelStack",TTL_SRC_PANEL:0,init:function J(N){this._super(N);var M=this.defn;if(!M){M=this.defn=this.node&&this.node.defn;this.titleSrc=this.titleSrc||M.ttlSrc;}var L=this.selectedKey=this.defn.selKey=this.node.data.selKey;this.set("selectedIdx",E.find(this.node.data.panels,"k",L));M.attachEventListener("selKeyChange",this.id,function(O){this.set("selectedKey",O.value);});},addChildren:function K(O,L,N){var M=this.getFormats(),P=M&&M.overflow;if(P){E.forEach(O,function(Q){var R=Q.getFormats();if(R){R.overflow=P;}});}return this._super(O,L,N);},refresh:function F(){if(this.hasRendered){var L=this.defn.newSelKey||this.selectedKey;E.forEach(this.children,function(M){M._delayRefresh=(M.k!==L);if(!M._delayRefresh){M.refresh();}});}delete this.defn.newSelKey;},selectPanel:function B(L,M){if(L!==this.selectedKey){this.defn.set("selKeyChange",L);this.model.slice({type:3,tks:this.k,eid:L,sid:this.node.data.wid,ck:this.k,hasLoader:M});}},onselectedKeyChange:function G(M){var O,L,N;E.forEach(this.children,function(Q,P){var R=Q.k;if(M.value===R){L=Q;N=P;Q.set("selected",true);}else{if(M.valueWas===R){O=Q;Q.set("selected",false);}}if(L&&O){return false;}});if(this.titleSrc===this.TTL_SRC_PANEL&&this.title){this.set("title",L.title);this.defn.ttl=L.title;}this.prevSelectIdx=this.selectedIdx;this.set("selectedIdx",N);this.raiseEvent({name:"panelSelected",key:L.k});return{on:L,off:O};},setDirty:function D(L){if(L){this.setDirtyChildren(true);}this._super(L);},setDirtyChildren:function H(L){var M=this.selectedKey;E.forEach(this.children,function(O){var N=O.k;O[((L||N!==M)?"add":"remove")+"DirtyKey"](N);});},clearDirtyChild:function I(N){var M=this.children,L=M[E.find(M,"k",N)];if(L){L.removeDirtyKey(L.k);}},isPanelStack:true,checkRequiredObjects:function C(){var L=this.txWidgets||{},O,N,M=true;for(O in L){M&=!!L[O].checkRequiredObjects();}return M;},updateSelectedIdx:mstrmojo.emptyFn,switchToPanel:function A(L,M){if(M!==undefined){this.set("selectedIdx",M);}else{this.updateSelectedIdx(L);}this.children[this.selectedIdx]&&this.selectPanel(this.children[this.selectedIdx].k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}else{F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);}this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?1:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}else{var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(J.bc==-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};}var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices",sessionState:mstrApp.sessionState};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var R=mstrmojo.dom,P=mstrmojo.hash;var M=100;var E=R.supportsTouches?0.5:1;var F=1;var Q=100;var N={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var K=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[R.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[R.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[R.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[R.CSS3_TRANSITION]=this.decelerating?(R.CSS3_PREFIX+"transform 0.2s linear"):"";}},P.copy(N));var G=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},P.copy(N));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function L(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=P.copy(R.isSafari?K:G,P.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}R.attachEvent(U,R.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){R.detachEvent(T,R.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function I(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}R.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=R.getMousePosition(R.firstTouch(T,V),T);this.dragging=false;R.attachEvent(window,R.TOUCHMOVE,this._tmCallback);R.attachEvent(window,R.TOUCHEND,this._teCallback);},touchesMoved:function D(b,g){var Z=R.getMousePosition(R.firstTouch(b,g),b);R.preventDefault(b,g);if(!this.dragging){var T=5,j=Math.abs;if((this.scrollsHoriz&&j(Z.x-this.pos.x)>T)||(this.scrollsVert&&j(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},h={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=h;this.maxPos={x:Math.max(h.x-Y.x,0),y:Math.max(h.y-Y.y,0)};this.showScroll();}}if(this.dragging){R.stopPropogation(b,g);var f=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(f.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(f.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),i=this.lastDragTime;this.nextLastDragTime=i;this.lastDragTime=U;if((U-i)>Q){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function H(T,U){R.preventDefault(T,U);R.detachEvent(window,R.TOUCHMOVE,this._tmCallback);R.detachEvent(window,R.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;R.stopPropogation(T,U);if((new Date())-this.lastDragTime<=Q){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=R.getMousePosition(R.firstChangedTouch(Y,Z),Y),f=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-f.x,y:W.y-f.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),g=T?(new Date())-T:0,V={x:g?Number(b.x*M*E/g).toFixed(2):0,y:g?Number(b.y*M*E/g).toFixed(2):0};var a=this,U=function(e){return(a.scrollsHoriz&&Math.abs(e.x)>=F)||(a.scrollsVert&&Math.abs(e.y)>=F);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,M);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=(b)?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=(b)?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function J(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function O(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash;mstrmojo._CanSupportTransaction={_mixinName:"mstrmojo._CanSupportTransaction",updatedCellsMap:null,getUpdates:mstrmojo.emptyFn,getUpdateObject:mstrmojo.emptyFn,getKeyContext:mstrmojo.emptyFn,autoRefresh:mstrmojo.emptyFn,editNext:mstrmojo.emptyFn,dataChanged:function A(F,G,E,H){var D=this.updateValue(F,E);this.updatedCellsMap[F]={r:G,v:E};this.controller.onTransactionUpdates(this,this.getUpdateObject(),D);},postBuildRendering:function B(){if(this._super){this._super();}if(!this.txModel){this.txModel=this.model.docModel||this.model;}this.updatedCellsMap=this.updatedCellsMap||{};},updateValue:function(E,D){if(this.txModel.deltaUpdate){this.txModel.deltaUpdate(this);}return false;},getUpdatedValues:function(){var E=this.updatedCellsMap,F,D,G=[];for(F in E){if(E.hasOwnProperty(F)){D={};D.v=E[F].v.v;G.push(C.copy(this.getKeyContext(F),D));}}return G;},clear:function(){this.updatedCellsMap={};},registerTxWidget:function(){function E(F,H){var G=F.node.data.k;H.txWidgets=H.txWidgets||{};H.txWidgets[G]=F;return false;}var D=this.parent;while(D){if(D.isPanelStack===true){E(this,D);}D=D.parent;}}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash,A=null;function B(D){return mstrmojo.DICFactory.createDIC(C.copy({dic:this.dic,owner:this.owner,group:this},D));}mstrmojo.DICFactory=mstrmojo.provide("mstrmojo.DICFactory",{createDIC:function(G){var E=G.dic,F=mstrmojo.DICConfig.getDICClass(E),D;if(F){if(G.k===undefined){G.k=G.opener&&G.opener.id;}G.showByDefault=mstrmojo.DICConfig.showDICByDefault(G.dic,G.openerType);G.hasPreview=mstrmojo.DICConfig.hasDICPreview(G.dic,G.openerType);D=new F(G);}return D;},createDICPopup:function(D,E){return mstrmojo.DICPopup.getInstance(D,E);},createDICGroup:function(F){var I=C.copy(F,{scriptClass:"mstrmojo.Widget",widgetsMap:{},dic:null,owner:null,groupMembers:{},postCreate:function(){var L=this.dic,K=this.openerType,J=mstrmojo.DICConfig;this.showByDefault=J.showDICByDefault(L,K);this.hasPreview=J.hasDICPreview(L,K);},addDIC:function D(J,K){this.groupMembers[J]=K;},showPopupDIC:function H(K){if(!this.showByDefault){var J=this.widgetsMap[K],L=this.groupMembers[K];if(!L){return ;}if(!J){J=this.widgetsMap[K]=B.call(this,L);}J.showInPopup();}},render:function G(){if(this.showByDefault||this.hasPreview){var L=this.groupMembers,K=this,J;C.forEach(L,function(N,M){if(!N.hasRendered){K.widgetsMap[M]=J=B.call(K,N);if(K.showByDefault){J.render();}else{if(K.hasPreview){J.renderPreview();}}N.hasRendered=true;}});}},destroy:function E(){C.forEach(this.widgetsMap,function(J){J.destroy();});this.widgetsMap={};}});return mstrmojo.insert(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var G=mstrmojo.dom,H=Math;var D=1,F=2,I=3,K=4,E=5,A=6;function B(){var N=this.anchor;if(!N){return false;}var W=this.baseTipClass,X=this[this.tipNodeName];X.className=W+" top";var l=this[this.boundaryNodeName],AA=this[this.popupNodeName],j=this.anchorOffset,x=this.anchorOrientation,t=this.hasScrollbars(),f=mstrmojo.hash.copy(this.anchorPosition||G.position(N,true)),Q=G.position(l,true),AE=Q.w,O=Q.h,m=AA.offsetWidth,S=AA.offsetHeight,a=m/2,L=S/2,e=G.position(X),q=H.min(e.h,e.w),U=H.max(e.h,e.w)/2,o=this.placement;if(t){AE-=15;O-=15;}var g=G.contains(l,AA),s=g?0:Q.y,AD=AE/2-a,V=O/2-L+s,z=-1000,AF=-1000,P,p=["borderBottomColor","borderTopColor","borderRightColor","borderLeftColor"],AG=0;if(g){f.x=f.x-Q.x;f.y=f.y-Q.y;}var n=f.y+f.h,R=f.x+f.w,AB=((R+m)<AE),Y=f.y>S,w=((n+S)<O),b=function(i,AI,AH){return H.min(H.max(i,AH),H.max(AI,0));},T=function(){if((f.x<AE)&&(w||Y)){var i=f.x+(f.w/2),AH=(o==K&&w)||!Y;if(AH){P="top";AF=n;AG=0;V=n+q-j;}else{P="bottom";AF=f.y-q;AG=1;V=AF-S+j;}AD=b(0,AE-m,i-a);z=b(f.x,R,i)-U;return true;}return false;},k=function(){if((f.y<O)&&(AB||f.x>m)){var i=f.y+(f.h/2),AH=!(o==E&&f.x>m)&&AB;if(AH){P="left";z=R;AG=2;AD=R+q-j;}else{P="right";z=f.x-q;AG=3;AD=z-m+j;}V=b(s,O-S,i-L);AF=b(f.y,n,i)-U;return true;}return false;},Z=[T,k],AC=0;if(o==F){V=this.popPosition.top;AD=this.popPosition.left;AF=-1000;z=-1000;P=null;}else{if(o==E||o==A||(o==D&&x==="h")){Z.reverse();}for(;AC<2;AC++){if(Z[AC]()){break;}}V=H.round(V);AD=H.round(AD);AF=H.round(AF);z=H.round(z);}X.className=W+" "+(P||"hidden");var h=X.style,M=AA.style;h.top=AF+"px";h.left=z+"px";if(this.tipNodeColor){mstrmojo.array.forEach(p,function(i){h[i]="";});h[p[AG]]=this.tipNodeColor;}M.top=V+"px";M.left=AD+"px";return true;}mstrmojo._IsAnchorable={anchor:null,anchorPosition:null,boundaryNodeName:"curtainNode",popupNodeName:"editorNode",tipNodeName:"tipNode",baseTipClass:"mstrmojo-Editor-tip",anchorOffset:25,anchorOrientation:"v",placement:D,popPosition:null,hasScrollbars:function C(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},prepareAnchor:mstrmojo.emptyFn,positionDialog:function J(){this.prepareAnchor();if(!B.apply(this,[])){if(typeof this._super==="function"){this._super();}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function A(){var I=this.getFormats(),G="",H=function H(J){if(I[J]){var K=this[J]||I[J];this[J]=K;if(this.isFullScreenWidget){I[J]=K;}this[J+"Limit"]=parseInt(K,10);}};H.call(this,"height");H.call(this,"width");var F=function(M,L){var J=I[M];if(J&&J.charAt(J.length-1)!=="%"){var K=parseInt(J,10);if(!isNaN(K)){if(L){K-=L;}G+=M+":"+K+"px;";}}return null;};F("height",0);F("width",0);this.scrollboxNodeCssText=G;return this._super();},resize:function(){this.clearCache();var I=this.getFormats(),G=parseInt(I.height,10),F=parseInt(I.width,10);if(F>0&&G>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}mstrmojo.array.forEach([this.scrollboxNode,this.viewport],function(K){var J=K.style;J.height=G+"px";J.width=F+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=G&&(G!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(G,10);this.scrollboxBottom=this.scrollboxTop+G;}if(this.lockHeadersCase){this.resizeScrollBox(B.isIE);}}var H=this.zones;if(H){if(H._BL){H._BL.onscroll();}if(H._BR){H._BR.onscroll();}}if(!(this.gridData&&this.gridData.eg)){this.onGridWidthChanged();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function D(){this.clearCache();this.unrender();this.render();},unrender:function E(){this.clearCache();if(this._super){this._super();}},defaultAction:function C(J,H){if(this._super(J,H)){var F=this.model.sti,G=F&&F.titleId,L=F&&F.deselectCurrent,M;this._currentSelectedTD=L?undefined:J;if(G){for(M in this.zones){var N=this.zones[M],K=N.domNode,I=K&&K.firstChild;if(I&&(J.offsetParent===I||J.offsetParent===K)){N.clearHilites(G);if(!L){N.setHilites(G,J);}N.hiliteKey=G;this.model.sti=null;return true;}}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var Y=5;var k=1;var V=2;var N=4;var j=0;var O=true;var I=0;var F=86400000;mstrmojo.VisChartUtils=mstrmojo.provide("mstrmojo.VisChartUtils",{getScreenZoomFactor:function Z(){if(I==0){if(mstrMobileApp){var o=mstrMobileApp.getDeviceDPI();console.log("dpi:"+o);I=o/160;}else{I=1;}}return I;},changeElementSize:function a(s,z,x){if(z=="fontSize"||z=="height"||z=="line-height"){var w=mstrmojo.css.getStyleValue(s,z);var q=Math.round(x*parseInt(w));s.style[z]=q+"px";}else{if(z=="font"){var t=mstrmojo.css.getStyleValue(s,"fontSize");var q=Math.round(x*parseInt(t));var p=mstrmojo.css.getStyleValue(s,"fontWeight");var o=mstrmojo.css.getStyleValue(s,"fontFamily");s.style.font=p+" "+q+"px "+o;}}},rgbaStr2rgba:function L(o){var q=null;o=o.replace(/ /g,"");var p=o.indexOf("rgba");if(p>=0){o=o.substring(p+5,o.length-1);q=o.split(",");}return q;},fillBackground:function b(w,p,AF,q,z){var x=q||w.context,t=p||w.canvas.width,AC=AF||w.canvas.height,AD=w.themeColor||"#000000",AB=null,AE=z||1;if(!x){x=w.canvas.getContext("2d");if(!x){return ;}}x.save();if(w.noBackground){}else{if(!w.isAndroid&&!w.isTimeSeries){AB=x.createLinearGradient(0,0,0,AC/2);x.fillStyle=AD;x.fillRect(0,0,t,AC);x.globalAlpha=0.4;AB.addColorStop(0,"#fff");AB.addColorStop(0.1,"#fff");AB.addColorStop(1,AD);x.fillStyle=AB;x.rect(0,0,t,AC/2);x.fill();x.globalAlpha=0.1;x.fillStyle="#fff";x.fillRect(0,0,t,AC/2);}else{if(w.isTimeSeries){var AA=w.formatProp;AB=x.createLinearGradient(0,0,0,AC);x.globalAlpha=AA.backgroundAlpha;var o=this.rgb2rgbStr(AA.backgroundClr,0.83)||"#2c2c2c";var s=this.rgb2rgbStr(AA.backgroundClr)||"#000000";AB.addColorStop(0,o);AB.addColorStop(1,s);x.fillStyle=AB;x.rect(0,0,t,AC);x.fill();}else{x.globalAlpha=AE;x.fillStyle=AD;x.fillRect(0,0,t,AC);}}}x.restore();},rgb2rgbStr:function W(p,q){var o="";if(!p||p.length!=3){return o;}if(q||q==0){o="rgba("+p[0]+","+p[1]+","+p[2]+","+q+")";}else{o="rgb("+p[0]+","+p[1]+","+p[2]+")";}return o;},getRGBWithOpacity:function R(p,o,q){if(isNaN(o)){return ;}if(!q){q=[255,255,255];}var s=[];for(color in p){s[color]=parseInt(p[color]*(1-o)+q[color]*o);}return s;},fillMasterChartBackground:function S(AB,q,o,t,AH,AA,w){var AC=w||AB.context,z=t||AB.canvas.width,AF=AH||AB.canvas.height,AG=AB.themeColor,AE=null;var AD=AB.formatProp;AC.save();AC.globalAlpha=AD.backgroundAlpha;AC.fillStyle=this.rgb2rgbStr(AD.backgroundClr)||"#000000";AC.fillRect(0,0,z,o);AE=AC.createLinearGradient(0,0,0,AF/2);var p=this.rgb2rgbStr(this.getRGBWithOpacity(AD.backgroundClr,0.45))||"#737373";var x=this.rgb2rgbStr(this.getRGBWithOpacity(AD.backgroundClr,0.13))||"#222222";AE.addColorStop(0,p);AE.addColorStop(1,x);AC.fillStyle=AE;AC.fillRect(q,o,z,AF/2);AC.fillStyle=this.rgb2rgbStr(AD.backgroundClr)||"#000000";AC.fillRect(q,o+AF/2,z,AF/2+AA);AC.globalAlpha=1;AC.strokeStyle=this.rgb2rgbStr(AB.formatProp.textClr,0.5);AC.lineWidth=1;var s=o+0.5;this.drawLineSet(this,[{x:q,y:s},{x:q+z,y:s}],false,AC);s=o+AF-0.5;this.drawLineSet(this,[{x:q,y:s},{x:q+z,y:s}],false,AC);AC.restore();},drawLineSetWithSplit:function(w,AB,AA,p,x){var q=AB.length,z=Math.ceil(q/x),o,s;for(var t=0;t<z;t++){o=t*x;s=Math.min(o+x+1,q);this.drawLineSet(w,AB.slice(o,s),AA,p);}},drawLineSet:function M(t,AC,AB,o){var w=null,q=AC.length,AA=null;if(o){w=o;}else{w=t.context;}var x=null,p=false;w.beginPath();var s=0;while(s<q){if(AC[s]){w.moveTo(AC[s].x,AC[s].y);x=AC[s];p=true;s++;break;}s++;}var z=false;for(;s<q;s++){AA=AC[s];if(AA){if(!z){w.lineTo(AA.x,AA.y);p=false;}else{w.moveTo(AA.x,AA.y);p=true;x=AA;z=false;}}else{if(!z){z=true;if(p){w.arc(x.x,x.y,1,0,Math.PI*2,false);}}}}if(AB){w.closePath();w.fill();}else{w.stroke();}},getMinYPosition:function H(p,t,o){var s=t,q;while(s<=o){if(p[s]){q=p[s].y;break;}s++;}for(s=t;s<=o;s++){if(p[s]){q=Math.min(q,p[s].y);}}return q;},drawLineAreaWithSplit:function(x,AE,o,t,s,z,p,AA){var q=t-o+1,AC=Math.ceil(q/AA),AD,AB;for(var w=0;w<AC;w++){AD=o+w*AA;AB=Math.min(AD+AA,o+q-1);this.drawLineArea(x,AE,AD,AB,s,z,p);}},drawLineArea:function M(w,o,AA,t,z,AE,q){var AD=null,AH=o.length,AC=null,AI=0,AB=0;if(q){AD=q;}else{AD=w.context;}var s=null,AG=false;AD.save();AD.lineWidth=0;AD.beginPath();var AK=AA,x;while(AK<=t){if(o[AK]){AI=o[AK].x;AD.moveTo(AI,z);s=o[AK];AG=true;break;}AK++;}x=AK;var AF=false;for(;AK<=t;AK++){AC=o[AK];if(AC){if(!AF){AD.lineTo(AC.x,AC.y);AG=false;AB=AC.x;}else{AI=AC.x;AD.moveTo(AI,z);if(AK+1<=t&&o[AK+1]){AD.lineTo(AC.x,AC.y);}s=AC;AF=false;x=AK;}}else{if(!AF){AF=true;if(!AG){AD.lineTo(AB,z);AD.lineTo(AI,z);var p=this.getMinYPosition(o,x,AK)||0;var AJ=AD.createLinearGradient(0,p,0,z);AJ.addColorStop(1,this.rgb2rgbStr(AE,0));AJ.addColorStop(0,this.rgb2rgbStr(AE,1));AD.fillStyle=AJ;AD.globalAlpha=0.8;AD.fill();}}}}if(!AG){AD.lineTo(AB,z);AD.lineTo(AI,z);var p=this.getMinYPosition(o,x,t)||0;AD.closePath();var AJ=AD.createLinearGradient(0,p,0,z);AJ.addColorStop(1,this.rgb2rgbStr(AE,0));AJ.addColorStop(0,this.rgb2rgbStr(AE,1));AD.fillStyle=AJ;AD.globalAlpha=0.8;AD.fill();}AD.restore();},drawRectangle:function l(z,o,AB,q,t,AA,s){var p=null;if(s){p=s;}else{p=z.context;}if(AA){p.fillRect(o,AB,q,t);}else{p.strokeRect(o,AB,q,t);}},drawArc:function Q(s,AB,AA,w,z,p,q,AC,o){var t=null;if(o){t=o;}else{t=s.context;}t.beginPath();t.arc(AB,AA,w,z,p,q);if(AC){t.fill();}else{t.stroke();}},drawRoundRect:function K(q,o,AA,p,s,t,z){t=Math.min(p/2,s/2,t);q.beginPath();q.moveTo(o+t,AA);q.arcTo(o+p,AA,o+p,AA+s,t);q.arcTo(o+p,AA+s,o,AA+s,t);q.arcTo(o,AA+s,o,AA,t);q.arcTo(o,AA,o+p,AA,t);q.closePath();if(z){q.fill();}else{q.stroke();}},drawHalfRoundedRectangle:function n(q,AA,z,AB,s,o,AC,p){var t=null;if(p){t=p;}else{t=q.context;}t.beginPath();t.moveTo(AA+AB,z);t.lineTo(AA+o,z);t.arcTo(AA,z,AA,z+o,o);t.lineTo(AA,z+s-o);t.arcTo(AA,z+s,AA+o,z+s,o);t.lineTo(AA+AB,z+s);if(AC){t.fill();}else{t.stroke();}},drawStartEndPoints:function X(z,AF,p,t){var q=AF.length;var AA=null,o=z.startEndPointRadius;if(p){AA=p;}else{AA=z.context;}AA.save();var AC="#f0f43e",AB="#f0f43e",AD="#663300";if(z.startPointColor){AC=z.startPointColor;}if(z.endPointColor){AB=z.endPointColor;}else{var AE=AF[0].y,x=AF[q-1].y;if(AE>x){AB="#008000";}else{if(AE<x){AB="#8d1616";}else{AB=AC;}}}if(z.otherPointColor){AD=z.otherPointColor;}if(t&k&&AF[0]){AA.strokeStyle=AC;AA.fillStyle=AC;this.drawArc(this,AF[0].x,AF[0].y,o,0,Math.PI*2,true,true,AA);}if(t&V&&AF[q-1]){AA.strokeStyle=AB;AA.fillStyle=AB;this.drawArc(this,AF[q-1].x,AF[q-1].y,o,0,Math.PI*2,true,true,AA);}if(t&N){AA.strokeStyle=AD;AA.fillStyle=AD;for(var w=1;w<q-1;w++){if(AF[w]){this.drawArc(this,AF[w].x,AF[w].y,o,0,Math.PI*2,true,true,AA);}}}AA.restore();},getColor:function T(o){return(parseInt(o.themeColor.substr(1),16)>8388607)?"#000000":"#ffffff";},drawHighlightLine:function e(p,x){var o=p.context,t=p.margin,s=t.l,q=p.isTimeSeries?p.chartWidth+t.l:p.getWidth()-t.r;o.save();o.globalAlpha=1;o.strokeStyle=this.rgb2rgbStr(p.formatProp.textClr,0.35);o.lineWidth=1;o.lineCap="round";while(s<q){o.beginPath();o.moveTo(s,x);s+=2;o.lineTo(s,x);o.stroke();s+=3;}o.restore();},addLabel:function m(AI,AJ,AH,AF,p,AB,AC){var AE=document.createElement("div");AE.className="mstrmojo-Chart-lbl";AE.style.color=this.rgb2rgbStr(AI.formatProp.textClr,0.8);AE.innerHTML=AJ;if(p){AE.style.width=p+"px";}var t=null;var AD=0;if(AI.isTimeSeries){if(AC.w>=0){t=AI.xdiv;AD=AI.animationCanvas.width;}else{t=AI.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(!t){t=document.createElement("div");t.id="mstrmojo-chart-ylbl-div";t.className="mstrmojo-chart-ylbl-div";AI.domNode.appendChild(t);}t.style.width=AI.margin.l-1+"px";}}else{t=AI.domNode;AD=AI.getWidth();}t.appendChild(AE);var s=AE.offsetWidth||(AI.getTextWidth&&AI.getTextWidthByElem(AJ,AE));var AG=AE.offsetHeight||22*(I||1);var q=p||s||100;var AA=AI.xLabelPadding/2;var z=AI.yLabelPadding/2;if(AC.w>=0&&AI.isTimeSeries&&AI._scroller.origin){var AK=AH-AI._scroller.origin.x;if(AK<=0&&(AK+s/2>-AI.maxYLblWidth)){AI.needRedrawVerticalLine=true;t.removeChild(AE);return null;}var o=AK-AI.getChartWidthOnScreen();if((o-s/2)<=0&&o>=0){AI.needRedrawVerticalLine=true;t.removeChild(AE);return null;}}if(AC.w>=0){AH=AH-q/2;}if(AC.h>=0&&((AF>=AC.y-z&&AF<=AC.y+AC.h)||(AF+AG>=AC.y-z&&AF+AG<=AC.y+AC.h)||(AF+AG>=AI.canvas.height-AI.margin.b))){t.removeChild(AE);return null;}if(AC.w>=0&&(((AH>=AC.x&&AH<AC.x+AC.w+AA))||AH<AC.x||AH<AI.margin.l||AH+q>AD)){t.removeChild(AE);return null;}if(AI.isTimeSeries&&AC.h>=0){t.style.top=(AI.margin.t-AG/2)+"px";t.style.height=(AI.canvas.height-AI.margin.t-AI.margin.b-1+AG/2)+"px";this.translateCSS(AH,(AF-AI.margin.t)+AG/2,AB,AE);}else{this.translateCSS(AH,AF,AB,AE);AE.style.maxHeight=AG+"px";}AC.x=AH;AC.y=AF;if(AC.h>=0){AC.h=AG;}if(AC.w>=0){AC.w=q;AE.style.textAlign="center";}return AE;},addDataLabel:function m(p,s,x,q){var o=(p.margin.l>p.margin.r)?Y:p.getWidth()-p.margin.r+Y,t=(p.margin.l>p.margin.r)?p.margin.l:p.margin.r;return this.addLabel(p,s,o,x-10,t-Y*2,false,q);},translateCSS:function g(o,t,p,s){var q="translate("+o+"px,"+t+"px)";if(p){q+=" rotate(45deg)";}s.style[J.CSS3_TRANSFORM]=q;},getTouchXYOnWidget:function B(p,o,t){var s=mstrmojo.TouchScroller,q=(s&&t.parent&&s.getScrollPositionTotals(t.parent))||{x:0,y:0};p=p-t.offsetLeft+q.x;o=o-t.offsetTop+q.y;return{touchX:p,touchY:o};},getYValue:function A(t,p){var o=t.canvas.height,s=t.margin,q=t.model.mvalues;return o-s.b-4-((parseFloat(p)-q[0])*t.RTY);},getMasterYValue:function f(s,p,t){var o=s.masterCanvas.height,q=s.model.mvalues;return o-t.b-3-((parseFloat(p)-q[0])*s.MRTY);},getSeriesIndexAndYValue:function C(AB,o,AC){var AD=AB.model.series,t=AD.length,z=0;y=this.getYValue(AB,AD[z].rv[o])||0;var AA=AC-y<0?-(AC-y):AC-y,p=AA;for(var x=1;x<t;x++){var q=this.getYValue(AB,AD[x].rv[o])||0;AA=AC-q<0?-(AC-q):AC-q;if(AA<p){y=q;p=AA;z=x;}}return{y:y,si:z};},getLabelWidthForMargin:function i(o,s){var q=document.createElement("div");q.className="mstrmojo-Chart-lbl";q.innerHTML=s;o.domNode.appendChild(q);var p=q.offsetWidth||60;o.domNode.removeChild(q);return p+Y*2;},animateLineSet:function U(AD,q,AB,z){var AE=[],AC=AD.animationContext,s=AB.length;AC.clearRect(0,0,AD.getWidth(),AD.canvas.height);if(!z.index){z.index=0;}else{if(z.index>=z.rate){this.drawLineSet(AD,AB,false,AC);AD.drawLabels();if(AD.isFillLinesArea){this.fillLinesArea(AD,AB.slice(0));}if(AD.isDrawStartEndPoints){this.drawStartEndPoints(AD,AB,AC,AD.isDrawStartEndPoints);}return ;}}for(var t=0;t<s;t++){var p=AB[t],o=q[t];AE[t]={x:(z.index*(p.x-o.x)/z.rate)+o.x,y:(z.index*(p.y-o.y)/z.rate)+o.y};}this.drawLineSet(AD,AE,false,AC);var AA=this;z.index++;window.setTimeout(function(){AA.animateLineSet(AD,q,AB,z);},40);},fillLinesArea:function G(p,t){var q=p.canvas.height;t.push({x:p.getWidth()-p.margin.r,y:q-p.margin.b});t.push({x:p.margin.l,y:q-p.margin.b});var x=new Array();if(p.fillinColor){mstrmojo.requiresCls("mstrmojo.color");var s=mstrmojo.color.hex2rgb(p.fillinColor).join(",");x[0]="rgba("+s+", 0.8)";x[1]="rgba("+s+", 0.2)";}else{x=["rgba(255,128,0,0.8)","rgba(255,128,0,0.2)"];}var o=p.animationContext;var s=o.createLinearGradient(0,0,0,q);s.addColorStop(0,x[0]);s.addColorStop(0.75,x[1]);o.fillStyle=s;this.drawLineSet(p,t,true,o);},convertRawValueToMilliseconds:function h(q){var s=Number(q),o=s-((new Date("1/1/1970").getTime()-new Date("12/30/1899").getTime())/F)-j,p=new Date(o*F);return new Date(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()).getTime();},getAncestorBgColor:function D(q){var z=null,x=q,s=x.model,AC=null;if(x.hasOwnProperty("xtabModel")&&x.xtabModel.hasOwnProperty("docModel")){AC=x.xtabModel.docModel;}if(AC&&AC.defn&&AC.defn.layouts&&AC.defn.layouts.length>0){var AB=AC.defn.layouts,t;var p;for(p in AB){if(AB[p].loaded){t=AB[p];}}if(t&&t.hasOwnProperty("units")){var w=t.units;var AA=s.parent;while(AA){var o=AA.k||null;if(w[o]&&w[o].fmts&&w[o].fmts["background-color"]){z=w[o].fmts["background-color"];break;}else{AA=AA.parent||null;}}if(!z){if(t.fmts&&t.fmts["background-color"]){z=t.fmts["background-color"];}}}}return z;},getPointDistanceSquare:function E(p,o){return(p.x-o.x)*(p.x-o.x)+(p.y-o.y)*(p.y-o.y);},truncateTextToLine:function(p,AD,AH){AD.className=p.className;AD.style.whiteSpace="nowrap";var x=AD.innerHTML=p.innerHTML;var s=parseInt(p.offsetWidth)-parseInt(p.style.width);var AF=AH*parseInt(p.style.width)+s;var t=x;if(AD.offsetWidth>AF){var z=0,q=x.length-1;while(z<=q){var AC=Math.round((z+q)/2);var AG=x.substr(0,AC+1);var AE=x.substr(0,AC+2);AD.innerHTML=AG;var AB=AD.offsetWidth;AD.innerHTML=AE;var w=AD.offsetWidth;if(AB<=AF&&w>AF){break;}else{if(AB>AF){q=AC-1;}else{if(w<=AF){z=AC+1;}}}}t=x.substr(0,AC+1);if(t.length<x.length){if(t.charAt(t.length-1)===" "){t=t.substr(0,t.length-1);}var AA=t.lastIndexOf(" ");var o=t.length-1-AA;if(o>=2&&o<=8){t=t.substr(0,t.length-o-1)+"...";}else{t=t.substr(0,t.length-3)+"...";}}}p.innerHTML=t;},getLen:function(s,q,p,o){q.innerHTML=s;var t=q.offsetWidth+p-o;return t;},splitWordIfTooLong:function(t,AG,AD,z,AB){var AF=t.split(" ");var AA=[];var AC=AF.length;var w=0;var s=0;for(w=0;w<AC;w++){var p=AF[w];while(true){var AH=this.getLen(p,AG,AB,z);if(AH>AD){var AE=(AD/AH)*p.length;var o=Math.round(AE);while(o>0){var x=p.substr(0,o);var q=this.getLen(x,AG,AB,z);if(q<=AD){AA.push(x);break;}else{o--;}}p=p.substr(o,p.length-o);}else{AA.push(p);break;}}}return AA.join(" ");},truncateTextToLineWithWordWrap:function(AQ,AM,AJ){AM.className=AQ.className;AM.style.whiteSpace="nowrap";var AI=7;var AA=-1;if(AQ.style&&AQ.style.width&&AQ.style.width.length>0){AA=parseFloat(AQ.style.width);}if(AA<0){AA=parseFloat(mstrmojo.css.getComputedStyle(AQ).width);}var AK=AQ.innerHTML;var AP=parseFloat(AQ.offsetWidth)-AA;AK=this.splitWordIfTooLong(AK,AM,AA,AP,AI);var AC=AK.split(" ");var t=[];var AF=[];var AO=0;var o=0;var AH=AC.length;AM.innerHTML="&nbsp;";var AR=AM.offsetWidth-AP;AF.push(0);for(AO=0;AO<AH;AO++){var p=this.getLen(AC[AO],AM,AI,AP);if(p>AA){var AB=AC[AO];var AN=(AA/p)*AB.length;AC[AO]=AB.substr(0,parseInt(AN));p=AA;}t.push(p);o+=p;AF.push(o);if(AO!==AH-1){o+=AR;}}var AE=0,AL=0;var AD=AJ;for(;AL<AF.length;){var z=AF[AL]-AF[AE];if(AE>0&&AL!=AE){z-=AR;}var x=AF[AL+1]-AF[AE];if(AE>0&&AL+1!=AE){x-=AR;}if(z<=AA&&((AL+1==AF.length)||(x>AA))){AD--;if(AD==0||AL===AH){break;}else{AE=AL;AL++;}}else{AL++;}}if(AL>AH){AL=AH;}var AG=AF[AL]-AF[AE];if(AE>0&&AL!=AE){AG-=AR;}var AS;if(AL>=AH&&AG<AA){AS=AC.join(" ");}else{AS=AC.slice(0,AL).join(" ");var s=this.getLen("...",AM,AI,AP);if(AG+s<=AA){AS+="...";}else{if(AS.charAt(AS.length-1)===" "){AS=AS.substr(0,AS.length-1);}var w=AS.lastIndexOf(" ");var q=AS.length-1-w;if(q===3){AS=AS.substr(0,AS.length-3)+" ...";}else{AS=AS.substr(0,AS.length-3)+"...";}}}AQ.innerHTML=AS;},getLen2:function(x,p,o){var q=o;var s=q.getContext("2d");s.font=p;s.textAlign="center";s.fillStyle="blue";var w=s.measureText(x);var t=w.width;return t;},splitWordIfTooLong2:function(w,AD,t,x){var AF=w.split(" ");var AB=[];var AC=AF.length;var z=0;var s=0;for(z=0;z<AC;z++){var p=AF[z];while(true){var AG=this.getLen2(p,t,x);if(AG>AD){var AE=(AD/AG)*p.length;var o=Math.max(Math.round(AE),1);while(o>0){var AA=p.substr(0,o);var q=this.getLen2(AA,t,x);if(q<=AD||o==1){AB.push(AA);break;}else{o--;}}p=p.substr(o,p.length-o);}else{AB.push(p);break;}}}return AB.join(" ");},getComputedFontStyle:function P(o){var p=o.fontStyle+" "+o.fontWeight+" "+o.fontSize+"/"+o.fontVariant+" "+o.fontFamily;return p;},truncateTextToLineWithWordWrap2:function(AT,AD,AL){var AC=-1;if(AT.style&&AT.style.width&&AT.style.width.length>0){var AQ=0;var AS=mstrmojo.css.getComputedStyle(AT);if(AS.paddingLeft){AQ+=parseFloat(AS.paddingLeft);}if(AS.paddingRight){AQ+=parseFloat(AS.paddingRight);}var AR=AT.offsetWidth;AC=AR?AR-AQ:parseInt(AT.style.width);}if(AC<0){AT.innerHTML="...";return ;}var AM=AT.innerHTML;var z=mstrmojo.css.getComputedStyle(AT);var q=this.getComputedFontStyle(z);AM=this.splitWordIfTooLong2(AM,AC,q,AD);var AF=AM.split(" ");var w=[];var AI=[];var AP=0;var o=0;var AK=AF.length;var AU=this.getLen2(" ",q,AD);AI.push(0);for(AP=0;AP<AK;AP++){var p=this.getLen2(AF[AP],q,AD);if(p>AC){var AE=AF[AP];var AO=(AC/p)*AE.length;AF[AP]=AE.substr(0,parseInt(AO));p=AC;}w.push(p);o+=p;AI.push(o);if(AP!==AK-1){o+=AU;}}var AH=0,AN=0;var AG=AL;for(;AN<AI.length;){var AB=AI[AN]-AI[AH];if(AH>0&&AN!=AH){AB-=AU;}var AA=AI[AN+1]-AI[AH];if(AH>0&&AN+1!=AH){AA-=AU;}if(AB<=AC&&((AN+1==AI.length)||(AA>AC))){AG--;if(AG==0||AN===AK){break;}else{AH=AN;AN++;}}else{AN++;}}if(AN>AK){AN=AK;}var AJ=AI[AN]-AI[AH];if(AH>0&&AN!=AH){AJ-=AU;}var AV;if(AN>=AK&&AJ<AC){AV=AF.join(" ");}else{AV=AF.slice(0,AN).join(" ");var t=this.getLen2("...",q,AD);if(AJ+t<=AC){AV+="...";}else{if(AV.charAt(AV.length-1)===" "){AV=AV.substr(0,AV.length-1);}var x=AV.lastIndexOf(" ");var s=AV.length-1-x;if(s===3){AV=AV.substr(0,AV.length-3)+" ...";}else{AV=AV.substr(0,AV.length-3)+"...";}}}AT.innerHTML=AV;return AV.indexOf("...")>-1;},truncateDivContent:function(w,AB,q){AB.innerHTML=w;if(AB.offsetHeight>q){var x=0,p=w.length-1;while(x<=p){var AC=Math.round((x+p)/2);var AE=w.substr(0,AC+1);var AD=w.substr(0,AC+2);AB.innerHTML=AE;var AA=AB.offsetHeight;AB.innerHTML=AD;var t=AB.offsetHeight;if(AA<=q&&t>q){break;}else{if(AA>q){p=AC-1;}else{if(t<=q){x=AC+1;}}}}var s=w.substr(0,AC+1);if(s.length<w.length){if(s.charAt(s.length-1)===" "){s=s.substr(0,s.length-1);}var z=s.lastIndexOf(" ");var o=s.length-1-z;if(o>=2&&o<=8){s=s.substr(0,s.length-o-1)+"...";}else{s=s.substr(0,s.length-3)+"...";}}return s;}else{return w;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=false,P=mstrmojo.dom,S=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(T){return false;},queryEnabled:function(T){return true;},queryVisible:function(T){return true;},executeCommand:function O(T){},item2textCss:function E(T){return T.cssClass||T.cmdId||("cmd"+T[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var Z=this._subMenu,X=this.getMenuPosition();if(!Z){var b=(this.menuZIndex||this.zIndex||10)+1,V={left:X.x+"px",top:X.y+"px",zIndex:b,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};Z=new mstrmojo.ContextMenu(V);Z.render();this._subMenu=Z;}else{Z.set("left",X.x+"px");Z.set("top",X.y+"px");}if(this.dynamicUpdate){var U=Z.ctxtBuilder.itemWidgets,W=U&&U.length,T,Y,a=this.getContextMenuSource();for(T=0;T<W;T++){Y=U[T];if(a.queryVisible){Y.set("visible",a.queryVisible(Y.data));}if(a.queryChecked){Y.set("checked",a.queryChecked(Y.data));}if(a.queryEnabled){Y.set("enabled",a.queryEnabled(Y.data));}}}Z.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var T=this._subMenu;if(T&&T.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function N(){var T=this._subMenu,W=this._subMenu.domNode,V=W.offsetHeight,U=W.offsetWidth,Z=P.windowDim(),Y=P.position(W,false),X=P.position(W,true);if((Y.x+U+S)>Z.w){T.set("left",(Z.w-U-S+(X.x-Y.x))+"px");}if((Y.y+V+S)>Z.h){T.set("top",(Z.h-V-S+(X.y-Y.y))+"px");}},attachMousedownEvent:function L(){var T=this;if(!this._close_handler){this._close_handler=function(){if(!T.isOnMySubmenu(P.eventTarget(self,arguments[0]))){T.closeMenuTree();}};}P.attachEvent(document.body,"mousedown",this._close_handler);},isOnMySubmenu:function M(X){var U=this._subMenu;if(!U){return false;}if(P.contains(U.domNode,X,true,document.body)){return true;}var Y=U.ctxtBuilder.itemWidgets,T=Y&&Y.length,W,V;for(W=0;W<T;W++){V=Y[W];if(V.isOnMySubmenu(X)){return true;}}return false;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function R(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var T=P.position(this.domNode,true);return{x:Math.round(T.x),y:Math.round(T.y+T.h)};},isSeparatorItem:function G(T){return T[this.itemIdField]===-1||T[this.itemField]==="-";},hasSubmenu:function K(T){return !!T[this.itemChildrenField];},closeMenuTree:function Q(V){var U=this.activeMenuItem,T=this._cmSource||this;if(!U){if(V){this.activeMenuItem=V;}else{T.hideContextMenu();}return ;}if(U===V){return ;}if(V){this.activeMenuItem=V;if(V.parent.parent===U){return ;}if(V.parent===U.parent){U.hideContextMenu();return ;}}else{V=T;this.activeMenuItem=null;}U.hideContextMenu();while(U!==T){U=U.parent.parent;if(U!==V||T===V){U.hideContextMenu();if(T===V){P.detachEvent(document.body,"mousedown",this._close_handler);}}if(U.parent===V.parent){break;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var I=1,C=2;function E(P){var Q=this.defn,R=Q.vc,S=Q.hc;if(!P||P.length===0||(!R&&!S)){return{};}return{v:!!R,h:!!S};}function B(P){return parseInt(this.getFormats()[(P===I)?"height":"width"],10);}function H(Q){var P=this.getFormats()["max-"+((Q===I)?"height":"width")];return P&&parseInt(P,10);}function G(T,S){var Q=this.defn,R=T&&(T.dimNode||T.domNode),P=Q.ck&&Q.ck[T&&(T.k||T.content.k)];if(R&&P&&(P&S)){return R;}return null;}function F(Q,T,S,Y){var P=parseInt(S.style[(T===I)?"top":"left"],10);if(!!Y){return P+Y;}var R=(Q.fmts&&Q.fmts.fx)||{},U=(!J.isIE7&&(R.rt===1||R.rt===3))?((T===I)?C:I):T,W=(U===I)?"Height":"Width";Y=S["offset"+W]+(R.ds||0);var V=P+Y;if(J.isIE7&&W==="Width"&&Q instanceof mstrmojo.XtabBase){var X=Q.contentNode.offsetWidth;if(V<X){V+=X;}}return V;}function L(P,Q,R){if(P>Q){if(R){P=Math.min(P,R);}return P;}return Q;}function D(V,T,U){var P=this.getCanGrowShrinkNode(),R=(V===I)?"Height":"Width",Q=R.toLowerCase(),S=parseInt(P.style[Q],10);if(T&&T!==S&&!(T<S&&!!U)){S=T;P.style[Q]=S+"px";this.afterCanGrowShrink();}this["_fixed"+R]=S;}function A(Q,T,V){var W=H.call(this,T),X=B.call(this,T),U=Q.length,R;for(R=0;R<U;R++){var P=Q[R],S=G.call(this,P,T);if(!S){continue;}X=L(F.call(this,P,T,S),X,W);if(X===W){break;}}D.call(this,T,X,V);}function O(U,T,Q,S){var R=G.call(this,U,T);if(!R){return ;}var P=F.call(this,U,T,R,Q);D.call(this,T,L(P,B.call(this,T),H.call(this,T)),S);}mstrmojo._CanGrowOrShrink=mstrmojo.provide("mstrmojo._CanGrowOrShrink",{getCanGrowShrinkNode:function N(){return this.domNode;},performCanGrowCanShrink:function M(Q,R){var P=E.call(this,Q);if(P.v){A.call(this,Q,I,R);}if(P.h){A.call(this,Q,C,R);}},fixedSizeCanGrowShrink:function K(T,P,R,S){var Q=E.call(this,T&&[T]);P=parseInt(P,10);R=parseInt(R,10);if(Q.v&&!isNaN(P)){O.call(this,T,I,P,S);}if(Q.h&&!isNaN(R)){O.call(this,T,C,R,S);}},afterCanGrowShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,E=false;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function(){var F=C.windowDim(),J=(C.isFF||C.isWK)?0:2;var G=F.w,I=F.h;if(E){var H=I;I=G;G=H;}return{w:Math.max(G,0)+"px",h:Math.max(I-J,0)+"px"};},simulateOrientationChange:function A(){E=!E;this.monitorWindow();},preBuildRendering:function B(){var G=true;if(this._super){G=this._super();}var H=this.getBrowserDimensions();if(!("browserResized" in this)||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return G;},destroy:function D(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function(F){var H=F.currentTarget,I=this.getBrowserDimensions(),G={w:(H?H.innerWidth+"px":I.w),h:(H?H.innerHeight+"px":I.h)};if(G.h===this.height&&G.w===this.width){return ;}if(!("browserResized" in this)||this.browserResized(G)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=mstrmojo.dom;function E(J,I){var G=[];if(J){for(var F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function D(L,F,N){var I=N.hWin,J=N.e,G=A.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=A.ctrlKey(I,J),O=A.shiftKey(I,J);if(K||O){A.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}},premouseup:function C(H,K,G){var F=G.hWin,J=G.e,L=A.ctrlKey(F,J),I=A.shiftKey(F,J);if(L||I){A.clearBrowserHighlights(F);}},onadd:function B(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=E(K,G);for(var J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function B(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){for(var H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);for(var J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var B="mstrmojo-floating-toolbar-lightbox";var G="mstrmojo-floating-toolbar";var M="mstrmojo-floating-toolbar-cell";var I="mstrmojo-fixed-toolbar-lightbox";var A="mstrmojo-fixed-toolbar";var N="mstrmojo-fixed-toolbar-cell";var H=" hasToolBar";var E="mstrmojo-Button mstrmojo-InteractiveButton mstrmojo-oivmSprite ";var D="mstrmojo-Button-text";var L=27;mstrmojo._HasToolbar={_mixinName:"mstrmojo._HasToolbar",postBuildRendering:function C(){this._super();var O=this.getToolbarCfg();if(!O||this.defn.ttl){return ;}var S=this.containerNode;if(S){var Q=this._createToolbar(G,M);Q.className=B;S.className+=H;S.insertBefore(Q,S.firstChild);var P=this.domNode,R=mstrmojo.boxmodel.offset(P,this.parent&&this.parent.domNode);if(R.top<L){Q.style.top=(L-R.top)+"px";}}},_createToolbar:function F(V,Z){var S=this.getToolbarCfg(),Y=this,W=document,P=W.createElement("div"),U=W.createElement("table"),X=W.createElement("tr"),R=W.createElement("td");P.appendChild(U);U.className=V;R.className=Z;X.appendChild(R);U.appendChild(X);for(var T in S){var O=W.createElement("div");O.className=E+S[T].css[0];var Q=W.createElement("div");Q.className=D;Q.nodeValue="&nbsp;";Q.setAttribute("ix",T);Q.setAttribute("cix",0);O.appendChild(Q);R.appendChild(O);O.onclick=function(a){Y.onClick(a);};}return P;},renderToolbar:function K(Q){if(!this.getToolbarCfg()){return ;}var P=Q.firstChild,O=this._createToolbar(A,N);O.className=I;if(P){Q.insertBefore(O,P);}else{Q.appendChild(O);}},onClick:function J(U,P){var V=mstrmojo.dom,O=V.eventTarget(P,U),S=O.getAttribute("cix"),R=O.getAttribute("ix");var Q=this.toolbarCfg[R],T=Q.callback;if(T&&this[T]&&this[T]()){S=++S%Q.css.length;O.parentNode.className=E+Q.css[S];O.setAttribute("cix",S);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=(F)?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var B=mstrmojo.EnumReadystate;function D(F){return(F.getKey&&F.getKey())||F.k;}mstrmojo._IsDocController={_mixinName:"mstrmojo._IsDocController",_getXtabCallback:function(J){var F={},H=F[D(J)]=J.defn,I=this,G=I.model;return G.newCallback({submission:function(){if(H.set){H.set("readyState",B.WAITING);}},success:function(K){if(K.pukeys){F=G.getUnitDefinitions(K.pukeys);}G.partialUpdate(K.data,F);},failure:function(K){mstrmojo.alert(K.code+": "+K.message);},complete:function(){if(H.set){H.set("readyState",B.IDLE);}I.docRequestComplete();}});},_addNodeKeyToAction:function(F,G){G.nodeKey=D(F);return G;},onGridSelector:function(G,J){var F=this.model,I=F.getTargetInfoWin(J.tks);if(I&&I.length){for(var H=0;H<I.length;H++){F.showInfoWin(I[H],J.anchor,"h",true);}}J.sid=G.sid;F.slice(J);},onVisSelector:function(G,I){if(I.anchor){var F=this.model,H=F.getTargetInfoWin(I.tks);if(H&&H.length){F.showInfoWin(H[0],I.anchor,"h",true);}}if(G.xtabModel&&G.xtabModel.docModel&&G.xtabModel.docModel.slice){G.xtabModel.docModel.slice(I);}},isInRequest:function C(){var F=!!this._inProcess;if(!F){this._inProcess=true;}return F;},docRequestComplete:function E(){this._inProcess=false;},nudgeWidget:mstrmojo.emptyFn,getGroupByElements:function A(H){var L=[],K;while(H){var K=H.node&&H.node.data&&H.node.data.pbes;if(K){break;}H=H.parent;}if(K){var I=this.model.data.elems;for(var J=0,G=K.length;J<G;J++){var F=K[J];L.push(isNaN(F)?F:I&&I[F]);}}return L;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function A(E,H,D){var C=D.hWin,G=D.e,F=mstrmojo.dom.eventTarget(C,G),B=E.listMapper.findIndex(E,H,F);if(B>-1){E.toggleSelect(B);}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom,B=A.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function C(E,I,D){var G=E&&E.tree||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.DICFactory");var L=3,R=2,T=2,P=mstrmojo.css,A="********",O=mstrmojo.hash;var H=null;function F(X,W){if(X){var U=this.dicWidget;if(U&&U.setDirtyFlag){U.setDirtyFlag(X,W);}else{if(X.className!=="flag-container"){var V=document.createElement("div");V.className="flag-container";V.style.right="10px";V.innerHTML='<div class="dirty-cell"/>';W.insertBefore(V,X);}}}}mstrmojo._IsEditableTextfield={_mixinName:"mstrmojo._IsEditableTextfield",preBuildRendering:function Q(){if(!this.edb){var W=this.node.data,U=this.node.defn,V=W.dic||U.txi.dic,X=(this.rv==="")?this.value:this.rv;if(V.psw){this.v=A;X=this.rv="";}if(V.ipt===T){V.vls=this.vls||[];this.dk=V.k;}this.req=V.req;this.dt=V.dt;this.dicWidget=mstrmojo.DICFactory.createDIC({dic:V,owner:this,k:0,dv:this.value,value:X,openerType:R,popupTitle:U.n});if(this.shouldReplaceValueNode()){if(!H){H=O.clone(this.formatHandlers);}this.formatHandlers.domNode=["T","z-index","D","B","F","P","text-align","background-color","fx","white-space","overflow"];delete this.formatHandlers.valueNode;}}this.set("cssClass",this.edb?"":"editable-field");this._super();},shouldReplaceValueNode:function N(){return this.dicWidget.showByDefault||this.dicWidget.hasPreview;},postBuildRendering:function J(){this._super();if(this.edb){return ;}var U=this.dicWidget,W=this.valueNode.innerHTML;if(mstrmojo.string.isEmpty(W)){this.valueNode.innerHTML=W+"1";this.valueNode.style.height=this.valueNode.clientHeight+"px";this.valueNode.innerHTML=W;}if(U.showByDefault){U.render();}else{if(U.hasPreview){U.openerNode=this.domNode;U.renderPreview(this.value);}else{U.openerNode=this.valueNode;}mstrmojo.dom.attachEvent(U.openerNode,mstrApp.isMobile?mstrmojo.dom.TOUCHEND:"click",function(){U.showInPopup();});}if(this.shouldReplaceValueNode()){O.copy(H,this.formatHandlers);}this.registerTxWidget();this.addToTraversalList();if(this.mdf&&this.sci){var V=this.domNode;F.call(this,V.firstChild,V);}},getKeyContext:function D(){return{dt:this.dt||0,k:this.dk||undefined};},getUpdates:function C(){var V=this.getUpdatedValues()[0],U=V.k?('rw_control_key="'+V.k+'" element_id="'+this.vls[mstrmojo.array.find(this.vls,"v",V.v)].eid+'" '):"";return'<rwf rw_tree_type="'+this.tt+'" rw_node_key="'+this.fgk+'" rw_field_key="'+this.k+'" key="'+this.key+'" columns="'+this.cls+'" types="'+L+'" '+U+'value="'+mstrmojo.string.encodeXMLAttribute(String(V.v))+'" dt="'+V.dt+'" />';},updateValue:function K(U,X){if(this._super){this._super(U,X);}var Z=this.valueNode,a=this.domNode,V=this.dicWidget,W=X.v,Y=X.dv;if(this.rv!==W){if(this.req){P.removeClass(a,"required");}this.rv=W;this.v=Y;this.mdf=1;if(!V.showByDefault){if(V.hasPreview){V.renderPreview();}else{Z[Z.innerText!==undefined?"innerText":"textContent"]=this.psw?A:Y;}}if(this.req){P.removeClass(a,"required");}if(this.sci){F.call(this,a.firstChild,a);}}return false;},applyPasswordMask:function M(){this.psw=true;this.v=A;this.rv="";},getUpdateObject:function G(){var V={fieldKey:this.k,wid:this.wid,newValue:mstrmojo.string.encodeXMLAttribute(String(this.rv)),dataType:this.dt},U=this.getUpdatedValues()[0];if(U.k!==undefined){V.controlKey=U.k;V.elementId=this.vls[mstrmojo.array.find(this.vls,"v",U.v)].eid;}return{nodeKey:this.fgk,cells:[V],retrieveData:false,autoRefresh:false};},update:function I(U){if(this._super){this._super(U);}var W=U.data,V=U.defn;if(W.vls){this.vls=W.vls;}else{delete this.vls;}this.cell=U.data;this.value=W.v||"";this.rv=(W.rv===undefined)?this.value:W.rv;this.tca=W.tca||0;this.dt=W.dt;this.key=W.key||"";this.cls=W.cls||"";this.wid=W.wid;this.edb=W.edb;this.mdf=W.mdf;this.req=W.req;this.sci=V.txi.sci;this.tt=V.tt;this.fgk=V.fgk;},addToTraversalList:function S(){if(mstrmojo.DICConfig.isKeyNavigable(this.dicWidget.dic)){var U=this.parent.traversalList,V=this.domNode;if(!U){U=this.parent.traversalList=[];}U.push({x:V.offsetLeft,y:V.offsetTop,h:V.offsetHeight,refField:this});}},editNext:function E(){var Z=this.parent.traversalList,X,U,W,Y=0;if(!Z){return false;}if(!Z.isSorted){for(X=0,U=Z.length;X<U;X++){Y+=Z[X].h;}W=Y/U;Z.sort(function(g,e){var h=Math.floor(g.y/W),f=Math.floor(e.y/W);if(h<f){return -1;}if(h>f){return 1;}if(g.x<e.x){return -1;}if(g.x>e.x){return 1;}return(g.y<e.y)?-1:1;});Z.isSorted=true;}for(X=0,U=Z.length;X<U;X++){if(Z[X].refField.k===this.k){break;}}if(X<U){do{X++;if(X>=U){X%=U;}if(X===parseInt(this.k,10)){return false;}var V=Z[X].refField.dicWidget;if(V){if(!V.showByDefault){V.showInPopup();}else{V.focus();}return true;}}while(true);}},checkRequiredObjects:function B(){if(this.req&&!this.mdf&&!this.edb){P.addClass(this.domNode,"required");return false;}return true;}};}());(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){E.response(G,true,J);},failure:function(J){E.response(G,false,{code:J.getResponseHeader("X-MSTR-TaskErrorCode"),message:J.getResponseHeader("X-MSTR-TaskFailureMsg")});},complete:function(){delete D[G];}},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var E=mstrmojo.hash,H=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=E.clone(I);O.data=M;O.parent=N;return H.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length);for(var N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L;for(var O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}for(var M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array");var H=1,B=2;function J(M,L){return D(M,L)&&M.o===L.o;}function D(M,L){return M&&L&&M.ui===L.ui&&M.axis===L.axis&&M.mix===L.mix;}function A(P,M,N){var O=N.getCellTitleId(M),L=N.getCellUnitIndex(M);N.selections[O]=N.selections[O]||{};N.selections[O][L]=N.selections[O][L]||[];N.selections[O][L].push(P);C(P);}function K(M){var Q=M.selections;for(var P in Q){for(var O in Q[P]){for(var N=0,L=Q[P][O].length;N<L;N++){G(Q[P][O][N]);}}}M.selections={};}function C(L){mstrmojo.css.setOpacity(L,50);}function G(L){mstrmojo.css.setOpacity(L,100);}function F(N,O){if(N.mix===undefined){var R=O.gridData.gts[N.axis===H?"row":"col"],M=R[N.tui||N.ui],Q=0;for(var P=0,L=R.length;P<L;P++){if(R[P].id===M.id){Q++;}}return Q;}return 0;}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelect:function E(M,U){var S=this.getCellForNode(M),b=M.parentNode;if(U){var R=this.getCellTitleId(S),X=this.getCellUnitIndex(S);selectedTitle=this.selections[R];selectedUnit=selectedTitle&&selectedTitle[X];if(selectedUnit){for(var T=0,V=selectedUnit.length;T<V;T++){G(selectedUnit[T]);}delete selectedTitle[X];return ;}}var Q=F(S,this);if(S.axis===H){for(var T=0,L=0,V=b.cells.length;T<V&&L<Q;T++){var O=b.cells[T],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;}}}else{if(S.axis===B){var Z=mstrmojo.dom.findAncestorByName(M,"table",false),a=Z.rows;for(var T=0,L=0,V=a.length;T<V&&L<Q;T++){var Y=a[T].cells;for(var P=0,N=Y.length;P<N;P++){var O=Y[P],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;break;}}}}else{A(M,S,this);}}},rangeSelect:function I(f,g){var a=this.getCellForNode(f),L=this.getCellForNode(g);if(D(a,L)){if(a.o>L.o||a._ei>L._ei){var l=f;f=g;a=this.getCellForNode(f);g=l;L=this.getCellForNode(g);}var W=F(a,this),M=a.axis,h=mstrmojo.dom.findAncestorByName(f,"table",false),T=h.rows,b=f.parentNode,m=b.rowIndex,V=b.cells,Y=g.parentNode.rowIndex;if(M===H){for(var Z=m;Z<=Y;Z++){var N=T[Z].cells,O=false;for(var X=0,e=N.length,P=0;X<e&&P<W;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);P++;}}}}else{if(M===B){for(var Z=0,e=T.length,k=0;Z<e&&k<W;Z++){var N=T[Z].cells,S=false;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(J(U,a)){S=true;}if(S){A(R,U,this);}if(J(U,L)){break;}}if(S){k++;}}}else{if(m==Y){for(var Z=f.cellIndex,e=g.cellIndex;Z<=e;Z++){var R=V[Z],U=this.getCellForNode(R);A(R,U,this);}}else{for(var Z=m,e=Y;Z<=e;Z++){var N=T[Z].cells;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);break;}}}}}}}},doSelection:function(S,R,P){var T=mstrmojo.dom,L=T.ctrlKey(R,S),M=T.shiftKey(R,S);if(!L){K(this);}var Q=this.getCellForNode(P);var N=Q&&(Q.mix===undefined&&Q.o!==undefined),O=Q&&(Q.mix!==undefined&&(Q._lp||Q._tp));if(N||O){if(M){this.rangeSelect(this.lastSelectedTD,P);}else{this.singleSelect(P,L);this.lastSelectedTD=P;}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,J="mstrmojo-itemwrap",I="&nbsp;",S=mstrmojo.array;function F(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}else{if(X===V){break;}}Y=X;X=Y.parentNode;}}return null;}function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=S.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;}function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function L(m,Z,l,q,W,e,s,o){if(!Z){return{start:0,end:0};}var g=this.wrapperNodes(m),k=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,j=l+q,f=g[0].offsetTop,b;for(var n=1;n<=Y;n++){b=g[k].offsetTop-f+o;if(b<l){X=k;}else{if(b>j){V=k;}}var a=Math.round(Z/Math.pow(2,n+1));k+=(b>l)?-a:a;k=Math.min(Math.max(0,k),Z-1);}return{start:X,end:V};},findWrapper:function K(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function E(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function R(e,V,X,b,W){var Y=this._nd2iw(e,V,X),f,a,g;if(Y){a=this._iw2idx(e,V,Y);f=a;g=this.itemOffsetTop(e,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+g+Z/2){f++;g+=Z;}}else{return e.dropCuePos;}return{left:0,top:g,idx:f,idxActual:a};},getWrapperCss:function(V){return J;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function O(g,b,l,f,a,m){var n=this.itemWrapperPrefix(l),i=this.itemWrapperSuffix,Z=n+this.itemWrapperPrefill+i,Y=[this.markupPrefix],W=1,V=l.selectedIndices||{},p=function o(k,j){for(var q=k;q<j;q++){Y[W++]=n;var t=b.build(l,f,g[q],q);if(V[q]){t=t.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=t;Y[W++]=i;}};var e=(g&&g.length)||0;a=a&&b?Math.min(a,e):0;if(a){p(0,a);}m=m&&b?Math.min(m,e-a):0;var h=e-m;for(var X=a;X<h;X++){Y[W++]=Z;}if(m){p(h,e);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,j,f,o,h,W,b,n){var g=(j&&j.length)||0,m=this.wrapperNodes(X),q=h.itemStatus,V=mstrmojo.css,Z=o.selectedIndices||{};for(var e=W,l=Math.min(b+1,g),a=0;e<l;e++){if(q[e]!==A){m[e].innerHTML=f.build(o,h,j[e],e);if(Z[e]){var Y=m[e].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===n){break;}}}return a;},onadd:function N(f,V,Z,g){if(V&&g){var a=g.value.length,b=this.wrapperNodes(V),e=b[g.index],Y=this.getWrapperCss(f);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=I;if(e){this.wrapperParentNode(V).insertBefore(W,e);}else{this.wrapperParentNode(V).appendChild(W);}}T(f,this);}},onremove:function P(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var e=X.value.length;for(var Z=X.index+e-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function Q(k,X,e,m){if(X&&m){var f=this.wrapperNodes(X);if(f){var W=mstrmojo.css,n=e.itemStatus,l;for(var b=0,V=m.removed,h=V&&V.length;b<h;b++){l=V[b];if(n[l]){W.removeClass(f[l].firstChild,["selected"]);}}for(var Z=0,g=m.added,Y=g&&g.length;Z<Y;Z++){l=g[Z];if(n[l]){W.addClass(f[l].firstChild,["selected"]);}}}}},_nd2iw:F,_iw2idx:M,toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,f=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=f.clientHeight,e=f.scrollTop,Y=e;if(V<e){Y=V;}else{if(e+W-b<V){Y=Math.min(V,V-W+b);}}f.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,B=mstrmojo.css,D="selected";function G(I,J,K,H,M){var L=M.listHooks[I];if(L&&L.call(M,J,K,H)){return ;}B[((I==="select")?"add":"remove")+"Class"](J,D);}function E(K,J,I){var L=this[K],H=(L)?L.split(J):[];H=H.concat(I.split(J));this[K]=H.join(J);return H.length-1;}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},getItemMarkup:function(I,H){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}">{@n}</{@tag}>';},getItemProps:function C(J,H){var I=!!this.selectedIndices[H];return{tag:"div",sel:I,cls:(I)?D:"",n:J.n||"",style:"",idx:H,addCls:function(K){E.call(this,"cls"," ",K);},addStyle:function(K){E.call(this,"style",";",K);}};},itemRenderer:{render:function(I,H,J){I._renderIdx=H;return mstrmojo.string.apply(J.getItemMarkup(I,H),J.getItemProps(I,H));},select:function(I,J,H,K){G("select",I,J,H,K);},unselect:function(I,J,H,K){G("unselect",I,J,H,K);}},onclick:function A(J){try{var M=J.target||F.eventTarget(J.hWin,J.e),L=F.findAncestorByAttr(M,"idx",true,this.domNode),I=L&&parseInt(L.value,10);if(I!==null&&!isNaN(I)){if(!this.multiSelect){this.singleSelect(I);}else{var H=(this.selectedIndices[I])?"remove":"add";this[H+"Select"](I);}}}catch(K){mstrApp.onerror(K);}}});mstrmojo._IsList.SELECTED_CLS=D;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"]};J.RW=["z-index"].concat(J.T.concat(J.D));var E=mstrmojo.dom;function D(N,P,M){var O=N[P]||[];O.push(M);N[P]=O;}mstrmojo._Formattable={_mixinName:"mstrmojo._Formattable",formatHandlers:null,getCacheKey:function B(M){return"csscache"+(M.thresholdId||"");},update:function C(M){this.invisible=!!(M&&M.data&&M.data.invisible);if(this._super){this._super(M);}},preBuildRendering:function K(){if(this._super){this._super();}var M=this.defn;if(!M){M=this.defn={};}var Q=this.getCacheKey(this),Z=M[Q];if(!Z){Z=M[Q]={};var Y=this.getFormats();if(Y){var U=this.formatHandlers;for(var P in U){var h=U[P];var S=h.src?Y[h.src]:Y;if(!S){return ;}var X=[];var W=-1;var R=P+"CssText";var O=h.props||h;if(!O){continue;}for(var i=O.length-1;i>=0;i--){var a=O[i];var g=J[a]||[a];for(var V=g.length-1;V>=0;V--){a=g[V];if(a in S){if(a==="fx"){var e=S[a],N={};if("gd" in e){this.formatGradient(e.gd,N);}if("rt" in e){if(e.rt==1||e.rt==3){this.formatTextRotation(e.rt,N);}}if("ds" in e){this.formatDropShadow(e,N);}for(var T in N){X[++W]=T+":"+N[T].join(" ");}}else{X[++W]=a+":"+S[a];}}}}if(this.invisible){X.push("visibility:hidden");}this[R]=Z[R]=X.join(";")+";";}}}else{for(var b in Z){this[b]=Z[b];}}return true;},formatGradient:function G(M,O){var N=mstrmojo.css.buildGradient(M.t,M.sc,M.ec);if(N){D(O,N.n,N.v);}},formatDropShadow:function L(P,N){if(E.supports(E.cssFeatures.DROP_SHADOW)){var O=P.ds;if(E.isDXIE){D(N,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+O+",OffY="+O+")");}else{var M=[O,O];if(P.rt==1||P.rt==3){M[((P.rt===1)?1:0)]=-O;}D(N,(E.isWK?"-webkit-":"")+"box-shadow",M.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function A(N,M){if(E.supports(E.cssFeatures.TEXT_ROTATION)){if(E.isDXIE){D(M,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+N+")");}else{var O=(N===1)?90:-90;D(M,E.CSS3_PREFIX+"transform-origin","top left");D(M,E.CSS3_PREFIX+"transform","rotate("+O+"deg)");}}},getFormats:function I(){if(!this.fmts){this.fmts=this.formatResolver.getFormat(this.defn,this.thresholdId);}return this.fmts;},clearCache:function F(){delete this.defn[this.getCacheKey(this)];},unrender:function H(M){if(this.thresholdId){this.fmts=null;}this._super(M);}};mstrmojo._Formattable.getBorderWidths=function(N){var P=N.getFormats(),M=("border" in P)?P.border.match(/(\d*|\d*\.\d*)pt/)[0]:P["border-width"],O=N.model.docModel?N.model.docModel.dpi:N.model.dpi;return mstrmojo.css.getBorderWidths(M,O);};})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");mstrmojo._HasDocLink=mstrmojo.provide("mstrmojo._HasDocLink",{_mixinName:"mstrmojo._HasDocLink",url:"",target:"",linkEnabled:true,ifw:"",update:function C(D){var E=D.defn;this.url=D.data.url||E.url;if(E.target){this.target=E.target;}if(E.ifw){this.ifw=E.ifw;}this._super(D);},postBuildRendering:function A(){if(this.url||this.ifw){mstrmojo.css.addClass(this.domNode,"hasLink");}var E=this.controller.view,D=E&&E.getCurrentLayout();if(D&&D.addLinkInfo){D.addLinkInfo(this.id,{url:this.url,target:this.target,src:this});}return this._super();},setLinkEnabled:function B(H){this.linkEnabled=H;var G=this.domNode;if(!G){return ;}var I=G.childNodes,F=I[I.length-1],D=this.id+"_mask",E=(F.id===D)?F:null;if(H){if(E){G.removeChild(E);delete this._mask;}}else{if(!E){E=document.createElement("div");E.className="mstrmojo-DocLinkMask";E.id=D;E.innerHTML="&nbsp;";G.appendChild(E);}}},onclick:function(){if(this.linkEnabled){var E=this.drillLinkItems,D=E&&E[0];url=this.url||(D&&D.url);if(this.ifw){this.model.showInfoWin(this.ifw,(this.getAnchor&&this.getAnchor())||this.domNode,"v",true);}else{if(url){this.model.executeLink(url,this.target,this);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9\_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')},VALIDATOR:{DEMO:function L(e){var b=parseInt(e,10),f=mstrmojo.validation.STATUSCODE;if(b===0||b===1||b>10){return{code:f.VALID};}return{code:f.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function H(b){var f=this.dtp,e=String(b).replace(/[^\d]/g,"");if(e.length<10){return{code:E.INVALID,msg:mstrmojo.desc(9203)};}if(!J.REGEXP.PHONE_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9204)};}return{code:E.VALID};},VALIDATE_ZIPCODE:function G(b){var f="",e=this.dtp;if(!J.REGEXP.US_ZIP.test(b)){if(J.isNumeric(e)||J.isInt(e)){f=mstrmojo.desc(9208);}else{if(J.isString(e)){f=mstrmojo.desc(9206);}}return{code:E.INVALID,msg:f};}return{code:E.VALID};},VALIDATE_EMAIL:function P(b){var e=b.indexOf("@");if(e===-1){return{code:E.INVALID,msg:mstrmojo.desc(9197)};}if(b.substring(e).indexOf(".")===-1){return{code:E.INVALID,msg:mstrmojo.desc(9198)};}return J.REGEXP.EMAIL_ADDRESS.test(b)?{code:E.VALID}:{code:E.INVALID,msg:mstrmojo.desc(9207)};},VALIDATE_SSN:function O(b){var f=this.dtp,e;if(J.isNumeric(f)||J.isInt(f)){e=String(b).replace(/[^\d]/g,"");if(e.length!=9){return{code:E.INVALID,msg:mstrmojo.desc(9209)};}}if(!J.REGEXP.SOCIAL_SECURITY_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9210)};}return{code:E.VALID};}},isInt:function(b){return B[b]==1;},isNumeric:function(b){return B[b]==2||B[b]==5;},isString:function(b){return B[b]==3;}};var V=window.mstrConfig,I=V.listSep,W=mstrmojo.expr,K=W.DTP,J=mstrmojo.validation,F=J.TRIGGER,E=J.STATUSCODE,X=mstrmojo.css,Q=mstrmojo.num,N=mstrmojo.string,a=mstrmojo.date,B={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,21:2,22:2,23:3,24:4,25:3,30:5};function D(k,l){var h=k.dtp,j=k.constraints,n=j.allowedFormatChars?j.allowedFormatChars:"",g=(B[h]==1),b=(B[h]==2),e=(B[h]==6),m=mstrmojo.locales.number.THOUSANDSEPARATOR,f=mstrmojo.locales.number.DECIMALSEPARATOR,i;if(g){if(!k._intRegExp){n+="0-9-"+(k.isList?I:"")+m;k._intRegExp=new RegExp("[^"+n+"]");}i=k._intRegExp;}if(b){if(!k._numericRegExp){n+="0-9-"+(k.isList?I:"")+f+m;k._numericRegExp=new RegExp("[^"+n+"]");}i=k._numericRegExp;}if(e){}return !!i&&i.test(l);}function Y(k,m){var h=k.dtp,j=k.constraints,g=(B[h]==1),b=(B[h]==2),e=(B[h]==6),f=j.min,l=j.max,i;if(f==undefined&&l==undefined){return false;}if(g||b){return Q.inNumericRange(m,f,l)!==0;}if(e){return a.inDateTimeRange(m,f,l)!==0;}return false;}function Z(e,b){return !Q.isNumeric(b);}function A(g,e){var f=(g.dtp===K.DATE),b=(g.dtp===K.TIME);return(f?!a.isDate(e):(b?!a.isTime(e):!a.isDateAndOrTime(e)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:K.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function S(b){this._super(b);if(!this.constraints){this.constraints={};}var e=this.constraints;if(!("trigger" in e)){e.trigger=F.NONE;}},_set_value:function(i,f){var g=this.value,e=(g!==f);if(e){this.value=f;var h=this.constraints.trigger,b=(h&F.VALUESET)>0;if(b){this.validate(f);}}return e;},validate:function M(){var f=(this.value!==null&&this.value!==undefined)?this.value:"",j=this.isList?f.split(I):[f],h,e,k;for(var g=0,b=j.length;g<b;g++){h=this.doValidation(j[g]);e=(h.code>E.VALID);if(e){if(b>1){h.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",j[g]?j[g]:" ");}break;}}k=e?"onInvalid":"onValid";if(!e&&this.autoFormat){this.format();}this.set("validationStatus",h);if(this[k]){this[k](h);}},format:function T(){var j=this.dtp,f=(B[j]==6);if(!f){return ;}var l=mstrConfig.listSep,o=this.value||"",e=this.isList?o.split(l):[o],n=j===14,m=[],b,g=mstrmojo.locales.datetime;for(var h=0,k=e.length;h<k;h++){o=e[h];b=a.parseDateAndOrTime(o);if(b){if(n&&b.date){m.push(a.formatDateInfo(b.date,g.DATEOUTPUTFORMAT));}else{m.push((b.date?a.formatDateInfo(b.date,g.DATEOUTPUTFORMAT):"")+" "+(b.time?a.formatTimeInfo(b.time,g.TIMEOUTPUTFORMAT):""));}}}this.set("value",m.join(l));},isValid:function R(){var b=this.validationStatus;if(!b){this.validate();}return this.validationStatus.code===E.VALID;},clearValidation:function U(){this.set("validationStatus",{code:E.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function C(o){var l=this.constraints,m=l.regExp,f=l.validator,b={id:this.id,code:E.VALID,msg:""},k=this.dtp,j=(B[k]==1),e=(B[k]==2||B[k]==5),g=(B[k]==3),h=(B[k]==6),i=N.isEmpty(o),n=String(o).length;err="",_VAL=mstrmojo.locales.validation;if(this.required&&i){b.code=E.INVALID_EMPTY;b.msg=_VAL.requiredFieldError;return b;}o=N.trim(o);if(!i&&D(this,o)){if(j){err=_VAL.integerDataType;}if(e){err=_VAL.numericDataType;}if(h){err=_VAL.dateDataType;}b.code=E.INVALID_CHAR;b.msg=_VAL.invalidCharError.replace("#",err);return b;}if(!i&&h&&A(this,o)){b.code=E.INVALID_BAD_DATESTRING;b.msg=_VAL.invalidDateStringError;return b;}if(!i&&(e||j)&&Z(this,o)){b.code=E.INVALID_BAD_NUMERICFORMAT;b.msg=_VAL.invalidNumericFormatError;return b;}if(!i&&(j||e||h)&&Y(this,o)){b.code=E.INVALID_OUTOFRANGE;if(l.min!=null&&l.max!=null){err=_VAL.outofRangeError.replace("#","").replace("##",l.min).replace("###",l.max);}else{if(l.min!=null){err=_VAL.noLessMinError.replace("##",l.min).replace("#","");}else{if(l.max!=null){err=_VAL.noGreaterMaxError.replace("###",l.max).replace("#","");}}}b.msg=err;return b;}if(g&&l.minLen!=null&&l.maxLen!=null){if(n<l.minLen||n>l.maxLen){b.code=E.INVALID;b.msg=mstrmojo.desc(9211).replace(/#/,l.minLen).replace(/##/,l.maxLen);return b;}}if(m&&!m.test(o)){b.code=E.INVALID_REGEX;b.msg=mstrmojo.desc(9205);return b;}var p=f&&f.apply(this,[o]);if(p){b.code=p.code;b.msg=p.msg;return b;}return b;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.num","mstrmojo.array","mstrmojo.DICFactory");var F=1,J=0,L=1,N=2,G=".",I=mstrmojo.dom,K=mstrmojo.css,E=mstrmojo.hash,D=mstrmojo.Enum_Keys.TAB,H=function(Q){return(Q>=1&&Q<=7)||Q==21||Q==22||Q==30;},C=function(T,R){if(I.isIE&&!/px$/.test(R)){var Q=document.createElement("img"),S;Q.style.zIndex=-1;Q.style.left=R;T.appendChild(Q);S=Q.style.pixelLeft;T.removeChild(Q);return S+"px";}return R;},B=function(Q,R){return parseInt(C(Q,K.getStyleValue(Q,R)),10)||0;},M=function(Q){return{lp:B(Q,"paddingLeft"),rp:B(Q,"paddingRight"),tp:B(Q,"paddingTop"),bp:B(Q,"paddingBottom")};},P=function(R){var Q=R.currentStyle;if(!Q){Q=document.defaultView.getComputedStyle(R,null);}return{fontFamily:Q.fontFamily,fontSize:C(R,Q.fontSize),fontStyle:Q.fontStyle,fontVariant:Q.fontVariant,fontWeight:Q.fontWeight,textAlign:Q.textAlign};},O=function(S,Q){var R=mstrmojo.findAncestor(S,"scriptClass","mstrmojo.DocInfoWindow");if(!!R){R.autoCloseLocked=Q;}};mstrmojo._IsInputControl={_mixinName:"_IsInputControl",dic:null,owner:null,openerNode:null,popupStyle:J,items:null,applyOnEnter:true,lv:null,init:function(T){if(this._super){this._super(T);}var V=this.dic,U=V.dt,S=mstrmojo.expr.DTP,R,Q=[];if(mstrApp.useBinaryFormat){if(U==S.DATE||U==S.TIME||U==S.TIMESTAMP){R=mstrmojo.date.parseDateAndOrTime(this.value);if(R){if(U!=S.TIME){Q.push(mstrmojo.date.formatDateInfo(R.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}if(U!=S.DATE){Q.push(mstrmojo.date.formatTimeInfo(R.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}this.value=Q.join(" ");}}}this.lv=this.value;if(V.wm&&V.w===undefined){V.wm=0;}},showByDefault:false,hasPreview:false,getItems:function(){var X=this.dic,R=[],V,T,Q=0,U=String(X.itv),S=U&&U.indexOf(G),W=H(X.dt);if(S>=0){Q=U.substring(S+1).length;}if(parseInt(X.ipt,10)===0){for(V=0,T=X.min;T<X.max+0.00001;V++,T+=X.itv){R[V]={n:mstrmojo.num.toLocaleString(Q>0?T.toFixed(Q):T),v:T};}}else{R=X.vls;mstrmojo.array.forEach(R,function(Y){if(Y.n===undefined){Y.n=W?mstrmojo.num.toLocaleString(Y.v):Y.v;}});}return R;},font:null,onfontChange:function(){if(this.getInputNode){var Q=this.getInputNode(),R=this.font;E.forEach(R,function(T,S){Q.style[S]=T;});}},getOpenerNodeStyle:function(){var Q=this.group&&this.group.ons,R=this.openerNode;if(!Q){Q=M(R);Q.hp=Q.lp+Q.rp;Q.vp=Q.tp+Q.bp;Q.iw=Math.max(0,R.clientWidth-Q.hp);Q.ih=Math.max(0,R.clientHeight-Q.vp);if(this.group){this.group.ons=Q;}}return Q;},onvalueChange:function(){if(this._super){this._super();}this.dicChanged=true;if(this.showByDefault){this.applyChanges();}else{if(this.popupStyle!==J&&this.popup&&this.popup.enableApply){this.popup.enableApply();}}},preBuildRendering:function(){if(this._super){this._super();}this.openerNode=this.openerNode||this.owner.domNode;if(this.showByDefault){this.openerStyle=this.getOpenerNodeStyle();if(this.inlineExtraCssText){this.cssText+=" "+this.inlineExtraCssText;}}if(!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}},postBuildRendering:function(){var Q=this.openerNode;if(this._super){this._super();}if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault){Q.replaceChild(this.domNode,Q.lastChild);}else{this.set("font",P(Q));}}if(mstrmojo.DICConfig.isKeyNavigable(this.dic)){this.registerKeyEvents(this.domNode);}},applyChanges:function(){var W=this.lv,Q=this.getCurValue?this.getCurValue():this.value,V=this.openerNode,S=this.getDisplayValue?this.getDisplayValue():Q,U=this.dic.dt,R=mstrmojo.expr.DTP,T=mstrmojo.locales.datetime;if(String(Q)!==String(W)){if(mstrApp.useBinaryFormat){if(U==R.TIME||U==R.TIMESTAMP){Q=Q.replace(new RegExp(T.AM_NAME),"AM").replace(new RegExp(T.PM_NAME),"PM");}}this.lv=Q;this.dv=S;if(this.owner&&this.owner.dataChanged){this.owner.dataChanged(this.k,W,{dv:S,v:Q},V);}}return true;},cancelChanges:function A(){this.value=this.lv;},showInPopup:function(){this.popup=mstrmojo.DICFactory.createDICPopup(this.owner,this);if(this.focus){this.focus();}this.setInfoWindowLock(true);},lockPopup:function(){this.setInfoWindowLock(false);},renderPreview:null,onTabDown:function(Q){mstrmojo.dom.preventDefault(window,Q);if(this.applyChanges()!==false){if(this.popup){this.popup.close();}this.owner.editNext(this.k);this.cleanup();}},cleanup:mstrmojo.emptyFn,registerKeyEvents:function(R){var Q=this;I.attachEvent(R,"keydown",function(S){var T=S||window.event;if(T.keyCode===D){Q.onTabDown(S);}});if(I.isIE){I.attachEvent(R,"keyup",function(S){var T=S||window.event;if(T.keyCode===D){Q.focus();}});}},setInfoWindowLock:function(Q){O(this.owner,Q);}};}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,toXml:function A(){var J=this,D=function(P,Q){return" "+P+'="'+Q+'"';},C=function(P,Q){return D(P,mstrmojo.string.encodeXMLAttribute(Q));},F=new mstrmojo.StringBuffer();var H=this.prms,B=H&&H.length;if(B||J.aopam!=J.DO_NOT_ANSWER){F.append("<hl"+D("mid",J.mid)+D("srct",J.srct)+D("aopam",J.aopam)+">");if(B){F.append("<prms>");for(var E=0;E<B;E++){var O=H[E];F.append("<prm"+D("id",O.id)+D("am",O.am)+D("pt",O.pt));if(O.orid){F.append(D("orid",O.orid)+D("ortp",O.ortp));}F.append(">");switch(O.am){case J.DO_NOT_ANSWER:case J.CLOSE:case J.USE_DEFAULT_ANSWER:case J.SAME_PROMPT:break;case J.STATIC:F.append('<pa ia="1"><es>');var N=O.pa.es,M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es></pa>");break;case J.DYNAMIC:case J.ALL_VALID_UNITS:case J.CURRENT_UNIT:var L=O.pa;if(L){F.append('<pa ia="1">');var K=L.a;if(K){F.append("<a"+D("id",K.id)+C("n",K.n)+">");}if(O.pt===1){F.append(mstrmojo.string.encodeXMLAttribute(L.v));}else{F.append("<es"+D("dispForms",K&&K.dispForms>=0?K.dispForms:"")+">");var N=L.es;M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es>");if(K){F.append("</a>");}}F.append("</pa>");}break;}F.append("</prm>");}F.append("</prms>");}F.append("</hl>");}return F.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var D=mstrmojo.hash;var E=0;var M=[];var P={};var B=false;function H(R){var S=R.callback;if(S.submission){S.submission(this.userInteractionRequired(R));}this.submitRequest(R);}function K(){if(M.length&&!B){H.call(this,M.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function I(b,Y,S,T){if(S){this.cancelRequests();}var V=this.id,W=this.transport,R=mstrmojo.now()+Y.taskId+E++,U=b.canceled||mstrmojo.emptyFn;b.canceled=function(e){U();b.complete(true);return W.cancelRequest(e);};b=mstrmojo.func.wrapMethods(b,{complete:function(e){mstrmojo.all[V].deleteRequest(e);}});var X=!D.isEmpty(this._requests),Z=this.createRequest(R,b,Y,T),a=(B||X)&&!T.doNotHold;if(a){M.push(Z);}else{H.call(this,Z);}},createRequest:function C(U,W,V,R){var S=this._requests;if(!S){S=this._requests={};}var T=S[U]={id:U,callback:W,params:V,config:R};return T;},submitRequest:function F(R){this.transport.serverRequest(this.id,R.id,R);},cancelRequests:function O(){var R=false;D.forEach(this._requests,function(S){if(typeof S.gotResponse==="undefined"){R|=S.callback.canceled(S.id);}});this._requests={};M=[];return R;},response:function G(V,R,T){$MAPF(false,"AndroidServerTransport","transportRequest");var U=this.getRequest(V);if(U){U.gotResponse=true;var W=U.callback,S=(R&&!T.mstrerr)?"success":"failure";try{if(W[S]){W[S](T,U);}}finally{W.complete(V);}}K.call(this);},deleteRequest:function Q(S){var R=this._requests;delete R[S];},getRequest:function A(S){var R=this._requests;return R&&R[S];},userInteractionRequired:function L(R){return false;},addLoadingGraph:function J(R){P[R]=true;B=true;},removeLoadingGraph:function N(R){delete P[R];if(D.isEmpty(P)){B=false;K.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func");mstrmojo.requiresDescs(8445);var O=mstrmojo.hash;var J=mstrmojo.dom;var Q=[mstrmojo.desc(8445,"Loading")];var G=0;function i(w,x,q){var s=G++,t=this.getTxUpdates(s);q=q||{};q.src=arguments.callee.caller.name;if(!mstrmojo.string.isEmpty(t)){w.updateChanges=t;}mstrApp.serverRequest(w,this.wrapCallback(x,s),q);}function H(q){var s=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(s){q.styleName="RWDocumentMobileStyle";q.availableWidth=s.w;q.availableHeight=s.h;}}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService],{scriptClass:"mstrmojo.DocDataService",wrapCallback:function p(t,q){var s=this;return mstrmojo.func.wrapMethods({success:function(w){if(w){s.rwb=w.bs||s.rwb;s.msgId=w.mid||s.msgId;}s.clearTxUpdates(q);},failure:function(w){s.resetTxUpdates(q);}},t);},refresh:function o(t,w){var s=!!t.useRefreshProgress,q=s?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:Q;delete t.useRefreshProgress;i.call(this,O.copy(t,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false}),w,{showProgress:true,hideProgress:true,progressStateText:q,useRefreshProgress:s});},getTxUpdates:function Z(s){var q=this.model;return q&&q.getTransactionUpdates&&q.getTransactionUpdates(s);},clearTxUpdates:function M(s){var q=this.model;if(q&&q.clearTransactionUpdates){q.clearTransactionUpdates(s);}},resetTxUpdates:function D(s){var q=this.model;if(q&&q.resetTransactionUpdates){q.resetTransactionUpdates(s);}},loadDocLayout:function V(s,t){var q=O.copy(s,{taskId:"loadDocLayout",rwb:this.rwb});H.call(this,q);i.call(this,q,t,{showProgress:true,hideProgress:true,progressStateText:Q});},setCurrentDocLayout:function T(q,s){s=s||null;i.call(this,{taskId:"setDocLayout",rwb:this.rwb,layoutKey:q},s,{silent:(s===null)});if(typeof mstrMobileApp!=="undefined"){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function b(q,s){i.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:q},s);},setCurrentPanel:function h(w,t,q,s){i.call(this,{taskId:"setCurrentPanel",rwb:this.rwb,key:w,panelStackKey:t,selectorKeyContext:q},s,{silent:true});},requestNewPanel:function j(z,x,t,q,s,w){i.call(this,{taskId:"requestNewPanel",rwb:this.rwb,key:z,panelStackKey:x,selectorKeyContext:t,dirtyKeys:q},w,{showProgress:s,hideProgress:s,progressStateText:Q});},applyGraphSelectorAction:function E(z,w,t,q,AB,AA,s){i.call(this,{taskId:"applyGraphSelectorAction",rwb:this.rwb,selectorKeyContext:z,ctrlKeys:w,sliceID:t,x:q,y:AB,zoomFactor:s},AA);},setDocSelectorElements:function L(z,AB,AE,AA,AC,t,q,x,AD,s){var w={taskId:"setDocSelectorElements",rwb:this.rwb,selectorKeyContext:z,elemList:AB,ctlKey:AE,zoomFactor:t};if(J.isAndroid||q){w.taskId="androidSetDocSelectorElements";}if(AA!==null&&AA!==undefined){w.include=AA;}if(x){w.sdpKeys=x;}if(AD){w.tks=AD;}if(s){w.usePartialUpdate="0";}i.call(this,w,AC,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setDocVisSelectorElements:function n(x,AA,AD,z,AB,s,q,w,AC){var t={taskId:"setDocVisSelectorElements",rwb:this.rwb,selectorKeyContext:x,elemList:AA,ctlKey:AD,zoomFactor:s};if(J.isAndroid||q){t.taskId="androidSetDocSelectorElements";}if(z!==null&&z!==undefined){t.include=z;}if(w){t.sdpKeys=w;}if(AC){t.tks=AC;}i.call(this,t,AB,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setMultiDocSelectorElements:function W(q,t,x,s){var w={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:t,selectorObjects:q,zoomFactor:s};i.call(this,w,x,{showWait:true,hideWait:true,delay:true});},setDocSelectorExpression:function X(t,AG,AA,q,AE,z,x,AC,AB,AD,s,AF){var w={taskId:"setDocSelectorExpression"+(AF?"Unset":""),rwb:this.rwb,unitKeyContext:t,ctlKey:AG,objectId:AA,objType:q,expFunction:AE,expFunctionType:z,zoomFactor:s};if(x!==null&&x!==undefined){w.include=x;}if(AC!==null&&AC!==undefined){w.expConstants=AC;}if(AB!==null&&AB!==undefined){w.dataType=AB;}i.call(this,w,AD);},setDocSelectorInclude:function N(t,s,AA,z,q,w){var x={taskId:"setDocSelectorInclude",rwb:this.rwb,include:s,ctlKey:t,zoomFactor:w};if(z){x.objectID=z;}if(q){x.objType=q;}i.call(this,x,AA);},setDocUnsetSelector:function S(s,q,w,t){i.call(this,{taskId:"unsetSelector",rwb:this.rwb,unitKeyContext:s,ctlKey:q,zoomFactor:t},w);},getRWGraphImage:function g(z,AB){var x=mstrApp,AA=this.id,w={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:z.k,sliceID:parseInt(z.sid,10),width:parseInt(z.w,10),height:parseInt(z.h,10)};if(x.onMobileDevice()&&x.useBinaryFormat){window.setTimeout(function(){i.call(mstrmojo.all[AA],w,AB);},0);}else{if(z.encodeImage){w.taskContentEncoding="base64";delete w.taskEnv;i.call(this,w,{success:function(AC){AB.success("data:image/png;base64,"+AC);},failure:function(AC){(AB.failure||x.onerror)(AC);}});}else{var q=x.getConfiguration(),t=x.getCurrentProjectId(),s=new mstrmojo.StringBuffer();w.__ts__=new Date().getTime();w.sessionState=x.getSessionState(t);O.forEach(w,function(AC,AD){s.append(AD+"="+encodeURIComponent(AC));});AB.success(q.getTaskUrlByProject(t)+"?"+s.toString("&"));}}},getImage:function A(s){var t=mstrApp,q=t.getConfiguration();if(q&&s&&s.indexOf("://")===-1){s=q.getHostUrlByProject(t.getCurrentProjectId())+s;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(s)):s;},getDocImage:function l(q){return this.getImage(q);},setQuickSwitchViewMode:function C(q,s){i.call(this,{taskId:"setDisplayMode",gridKeyContext:q,messageID:this.msgId,displayMode:s},null,{silent:true});},setRWUnitProperties:function a(q,t,w,s,x){i.call(this,{taskId:"setRWUnitProperties",rwb:this.rwb,nodeKey:q,props:t,formatType:w,returnData:s},x,{silent:true});},setDocZoom:function B(q,s){i.call(this,{taskId:"setDocZoom",rwb:this.rwb,zoomType:q.zoomType,zoomFactor:q.zoomFactor},s);},sort:function k(q,s){i.call(this,O.copy(q,{taskId:"DocSort",rwb:this.rwb}),s);},pivot:function K(s,t){var q=O.copy(s,{messageID:this.msgId,rwb:this.rwb});q.key=s.nodeKey;delete q.nodeKey;q.taskId=s.formID?"docPivotForm":"docPivot";i.call(this,q,t);},drillGrid:function U(q,s){i.call(this,{taskId:"DocDrill",messageID:this.msgId,nodeKey:q.nodeKey,drillPathIndex:q.drillPathIndex,drillPathKey:q.drillPathKey,elementList:q.drillElements},s,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},changeDocGroupBy:function F(t,w,q){var s={taskId:"changeDocGroupBy",rwb:this.rwb,messageID:this.msgId,treesToRender:3};if(t.flags){s.flags=t.flags;}if(t.groupbyKey){s.groupByKey=t.groupbyKey;s.elementID=t.elementId;}else{s.gbUnits=t.gbUnits;}H.call(this,s);i.call(this,s,w,q);},downloadGridData:function e(q,s){i.call(this,{taskId:"DocXtabIncrementalFetch",rwb:this.rwb,nodeKey:q.nodeKey,rowPosition:q.rowPosition,maxRows:q.maxRows,colPosition:q.colPosition,sliceId:q.sliceId,maxColumns:q.maxColumns},s);},txMarkRows:function f(q,s){i.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:q.nodeKey,sliceId:q.sliceId,rowOrdinal:q.rowOrdinal,actionType:q.actionType},s);},txChangeData:function I(q,s){i.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:q.nodeKey,sliceId:q.sliceId,cells:q.cells,autoRefresh:q.autoRefresh},s);},sendTransactionActions:function R(s,t){var q={taskId:"DocTransaction",rwb:this.rwb,keyContext:s.keyContext,actions:s.actions,messageID:this.msgId};if(s.txrcd){q.isPending=s.txrcd.pending;q.timestamp=s.txrcd.timestamp;}i.call(this,q,t,{silent:!!t});},RWEventsTask:function m(q,s){i.call(this,{taskId:"RWEventsTask",rwb:this.rwb,messageID:q.messageID,styleName:q.styleName,events:q.events},s);},getPageByTree:function Y(q){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},q);},resetSelections:function P(s,q,t){i.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:s||"",usePartDisplay:q?"0":"1"},t);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.form","mstrmojo._IsDocController");var H=3;mstrmojo.OIVMDocController=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsDocController],{scriptClass:"mstrmojo.OIVMDocController",onSort:function B(K,L){L.treeType=K.treeType;K.model.sort(this._addNodeKeyToAction(K,L),this._getXtabCallback.call(this,K));},onPivot:function G(K,L){K.model.pivot(this._addNodeKeyToAction(K,L),this._getXtabCallback.call(this,K));},onDrill:function I(K,O){if(O.isWithin){if(!this.isInRequest()){K.model.drillGrid(this._addNodeKeyToAction(K,O),this._getXtabCallback.call(this,K));}}else{var M=this.model,L=this.model.prefs,P=L.rtprnt,N=L.rtthld;mstrmojo.form.send({evt:3125,displayMode:-1,drillPathKey:O.drillPathKey,elementList:O.drillElements,rwMesageID:M.mid,retainParent:isNaN(P)?"":P,retainThresh:isNaN(N)?"":N,rwGroupByElements:this.getGroupByElements(K).join(","),sliceId:K.sid||0},null,null,((L.drillnw)?"_blank":null));}},onExecuteNewObject:function J(L,M){if(M){var K={};if(M.objType===H){K.evt=4001;K.reportID=M.did;K.reportViewMode=1;if(M.forceExec){K.execFlags=1;K.doNotUpdateCaches=true;}}else{K.evt=2048001;K.objectID=M.did;if(M.forceExec){K.freshExec=true;K.doNotUpdateCaches=true;}}if(M.linkAnswers){K.linkAnswers=M.linkAnswers;}mstrmojo.form.send(K,null,"POST",null);}},onReExecute:function(K,N){var L=K.model,M={evt:2048030,src:L.bp+".2048030",rwb:L.bs};if(N){M.ignoreStatus=true;mstrmojo.form.send(M,null,"POST",null);}else{mstrmojo.form.send(M,null,"POST",null);}},isAutoRefreshEnabled:function(){return this.autoRefreshHandler;},startAutoRefresh:function(){var K=this.model,L=K.rf,M=this;this.autoRefreshHandler&&this.stopAutoRefresh();this.autoRefreshHandler=setTimeout(function(){K.getDataService().refresh({},{success:function(N){K.loadLayout(N);M.autoRefreshHandler&&M.startAutoRefresh();}});},L*1000);},stopAutoRefresh:function(){clearTimeout(this.autoRefreshHandler);this.autoRefreshHandler=null;},offlineTransactionsSubmitted:function(K){},transactionDiscarded:function(K){},openOfflineTransactions:function(){},invalidClientCache:function(){},confirmMsgBeforeSubmit:function D(){},onLink:function E(K,N){if(N.link){var L=N.link.toXml();if(L){N.linkAnswers=L;}delete N.link;}if(N.linkInfo&&N.linkInfo.so>0){N.originMessageID=this.model.mid;if(!N.linkAnswers){N.promptAnswerMode="0";}N.selectorMode=N.linkInfo.so;}var O=N.target||N.linkTarget||"_self";if(N.url){if(N.url.length>2083){var M=mstrmojo.form.createDynamicForm(N.url);M.target=O;M.submit();}else{window.open(N.url,O);}}else{mstrmojo.form.send(N,null,"POST",O);}},onTransactionUpdates:function A(K,M,L){if(L){K.autoRefresh();}},onDownloadGridData:function C(K,L){this.model.downloadGridData(this._addNodeKeyToAction(K,L));},onGroupBy:function F(K,Q,N){var O=this,M=K.model,L=Q.groupbyKey,P=false;Q.flags=M.agb==2?2:0;P=!!Q.flags;M.getDataService().changeDocGroupBy(Q,{submission:function(){N(true);},success:function(R){if(P){K.parent.parent.unloadGbLayuts(L);}M.loadLayout(R);},complete:function(){N(false);}});}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.Model");var P=mstrmojo.dom;var K=1,E=2,J=4,M=8,N=16;function C(V,X){var R=V.getCellForNode(X),Q=R&&R.at,W=0;if(Q){W=(Q&E)||(Q&J)||(Q&K);}if(W===J){var T=V.model.getCellLinksInfo(R);if(isNaN(T.di)){return"";}var S=T.links[T.di];return S.n;}if(W===K){return(mstrmojo.desc(183,"Drill to")+" "+V.model.getCellDrillsInfo(R).n);}if(R){var U=("mix" in R)?R._e:R;if(U&&U.desc){return U.desc;}}return V.tooltip||"";}function O(V,X){var S=V.getCellForNode(X),R=S&&S.at;if(R&M||R&N){return true;}var W=0;if(R&K){W++;}if(R&J){W++;}if(R&E){W++;}if(W>1){return true;}if(R&J){var U=V.model.getCellLinksInfo(S),T=U&&U.links;var Q=(T&&T.length)||0;if(U&&!isNaN(U.di)){Q--;}if(Q>0){return true;}}else{return false;}}function A(R,S){var Q=S.mstrShowPopup;if(Q!==undefined){return Q;}Q=O(R,S);S.mstrShowPopup=Q;return Q;}function D(Q,R){if(R&&A(Q,R)){if(!Q.openPopup){Q.requiresCls(["mstrmojo._HasPopup"]);}return true;}return false;}function B(U,Q,T,S){var R=S||P.eventTarget(Q,U);return R&&P.findAncestorByName(R,"td",true,T.viewport);}function I(Q){return Q.lockHeadersCase<2?Q.viewport.clientWidth-(Q.scrollboxNode.offsetWidth-Q.scrollboxNode.clientWidth):(parseInt(Q.getFormats().width,10)||Q.viewport.clientWidth);}mstrmojo._XtabCellHoverMgr=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo._XtabCellHoverMgr",parent:null,td:null,audibles:{"*":false},startup:function G(){var V=this.parent;if(V&&V.getCellForNode){var X=this.id,T=this.fCtxMenu=function(Y){mstrmojo.all[X].oncontextmenu(Y,self);},R=this.fOver=function(Y){mstrmojo.all[X].onhover(Y,self);},Q=this.fOut=function(Y){mstrmojo.all[X].onunhover(Y,self);},U=V.zones,W;for(W in U){var S=U[W].tableNode;if(S){P.attachEvent(S,"mouseover",R);P.attachEvent(S,"mouseout",Q);P.attachEvent(S,"contextmenu",T);}}if(!this._sub_ihc){this._sub_ihc=V.attachEventListener("ignoreHoverChange",this.id,"onChangeIgnoreHover");}window.setTimeout(function(){V._pl=I(V);},0);}},shutdown:function F(){var R=this.parent&&this.parent.zones,S;for(S in R){var Q=R[S].tableNode;if(Q){P.detachEvent(Q,"mouseover",this.fOver);P.detachEvent(Q,"mouseout",this.fOut);P.detachEvent(Q,"contextmenu",this.fCtxMenu);}}},onXtabWidthChanged:function(){var Q=this.parent;Q._pl=I(Q);},onChangeIgnoreHover:function(){var Q=this.parent;if(!Q.ignoreHover&&this._ignored){this.onhover(null,null,this._ignored);}},onhover:function H(T,Q,S){if(this.parent.ignoreHover){this._ignored=P.eventTarget(Q,T);return ;}var R=this.parent,U=B(T,Q,R,S);if(U&&R){U.title=C(R,U);}if(D(R,U)){this.td=U;if(!R._pl){R._pl=I(R);}R.openPopup("cellHoverPopupRef",{xtab:R,td:U});}else{this.onunhover(T,Q,S);}},onunhover:function L(U,Q,T){if(this.parent.ignoreHover){return ;}var S=this.parent,R=S._lastOpened;if(!R){return ;}if(R.autoCloses){R.autoClose();}else{S.closePopup();}},oncontextmenu:function H(T,Q,S){var R=this.parent,U=B(T,Q,R,S);if(D(R,U)){R.openPopup("cellHoverPopupRef",{xtab:R,td:U,cmPos:P.getMousePosition(T,Q)});R.cellHoverPopupRef.btn.openPopup();R.closePopup();P.preventDefault(Q,T);}}});}());(function(){mstrmojo.ToolBarModel=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo.ToolBarModel",getChildren:function A(C,B){return(C||this.n||this).items;}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Model","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.StringBuffer","mstrmojo.EnumReadystate");var n=mstrmojo.EnumRWUnitType,J=mstrmojo.EnumReadystate,q=mstrmojo.hash.forEach,O=mstrmojo.func.wrapMethods,a=mstrmojo.array;var AC={isObservable:function(AI){var AH=AI&&AI.t;if(!AH||!(AH in this)||AI.scriptClass){return false;}return(AH!==n.SUBSECTION||!AI.dt);},makeObservable:function(AH){AH.audibles=this[AH.t]||{};if("readyState" in AH.audibles){AH.readyState=J.IDLE;}return new mstrmojo.Model(AH);}};AC[n.PANELSTACK]={"*":false,selKey:true,readyState:true};AC[n.GRID]={"*":false,readyState:true,ds:true};AC[n.GRAPH]={"*":false,readyState:true,ds:true};AC[n.GRIDGRAPH]={"*":false,qsm:true,ds:true};AC[n.SUBSECTION]={"*":false,resize:true,adjustSize:true};AC[n.VISUALIZATION]={"*":false,ds:true};AC[n.SELECTOR]={"*":false,cek:true,ds:true};AC[n.MOJOVISUALIZATION]={"*":false,ds:true};function G(AL,AM){var AI=AL.layoutMap&&AL.layoutMap[AM];if(AI){return AI;}var AH=AL.layouts,AK=(AH&&AH.length)||0,AJ=0;for(AJ=0;AJ<AK;AJ++){if(AH[AJ].k==AM){return AH[AJ];}}return null;}function H(AJ,AL,AI){var AH=G(AJ,AL);if(AI==AL){AH._lkz=AL;return AH;}else{if(AH){var AK=AH.units[AI];if(AK){if(AK.t==n.GRIDGRAPH){if(!AH.units[AI+"_0"]){AH.units[AI+"_0"]={ck:AK.ck,fmts:AK.fmts.gd,txi:AK.txi,t:n.GRID};AH.units[AI+"_1"]={ck:AK.ck,fmts:AK.fmts.gp,t:n.GRAPH};}}if(AC.isObservable(AK)){AK=AH.units[AI]=AC.makeObservable(AK);}AK._lkz=AL;}}}return AH&&AH.units[AI];}function AG(AL,AK,AJ,AH){var AI=this.getChildren(AL,AK,0);return(mstrApp.isMobile?(mstrmojo.array.filter(AI,function(AO){var AM=AJ&&AJ.indexOf(AO.defn.t),AN=AO.defn.dk;return AH?(AM>-1&&AN===-1):(AM<0||AN!==-1);})):(AH?[]:AI));}var k=function(AH,AI){var AJ=new mstrmojo.StringBuffer();if(AI){AJ.append("*l"+AI);}AJ.append("*k"+AH.k);if("wid" in AH){AJ.append("*x"+AH.wid);}AJ.append("*t"+this.buildTime);return AJ.toString();};function h(AJ){var AI,AH,AM=this.delta,AK=this.pendingUpdate,AL=[];if(!AK){AK=this.pendingUpdate={};}if(!mstrmojo.hash.isEmpty(AM)){AL.push("<updates>");for(AI in AM){if(AM.hasOwnProperty(AI)){AH=AM[AI];AL.push(AH.getUpdates());}}AK[AJ]=AM;this.delta={};AL.push("</updates>");}return AL.join("");}function e(AK,AL){var AH;if(AK){AK=AK.split(AL||"\u001E");for(var AJ=0,AI=AK.length;AJ<AI;AJ++){AH=AH||{};AH[AK[AJ]]=H.call(this,this.defn,this.currlaykey,AK[AJ]);}}return AH;}function A(AJ,AK){var AH=AK.ulkeys,AI=AJ.controller.view;if(AI&&AI.unloadLayouts&&AH&&AH.length){AI.unloadLayouts(AH);}}function P(AI,AH){var AJ=this.getLayoutUnitDefn(AI,AH);return(AJ&&AJ.t===n.PANELSTACK&&AJ.ifw);}function l(AI,AH){return !AH||(AI.wid==AH);}function K(){var AI=this.data&&this.data.layouts,AH=AI[a.find(AI,"k",this.getCurrentLayoutKey())],AK=AH&&AH.gbys&&AH.gbys.groupbys,AJ=false;a.forEach(AK,function(AL){if(AL.unit&&AL.unit.elms&&AL.unit.elms[AL.unit.idx].v==="u;"){AJ=true;return false;}});return AJ;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true},features:null,dataCache:null,controller:null,sdp:null,init:function t(AH){this._super(AH);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();this.buildTime=mstrmojo.now();},makeObservable:function U(AH){return AC.makeObservable(AH);},getTargetDefn:function(AH){return e.call(this,AH);},getTargetInfoWin:function(AI){var AH=[],AJ=e.call(this,AI);if(AJ){var AK;for(AK in AJ){if(AJ[AK]&&AJ[AK].ifw){AH.push(AK);}}}return AH;},getUnitDefinitions:function(AH,AI){return e.call(this,AH,AI);},hasFeatures:function p(AL){var AJ=this.features;if(!AJ){return false;}var AI=AL.split(",");for(var AK=0,AH=AI.length;AK<AH;AK++){var AM=AI[AK],AN=AM.match(/^\!/);if(AN){AM=AM.replace("!","");}if(AN?this.features[AM]:!this.features[AM]){return false;}}return true;},ondefnChange:function i(){var AM=this.defn,AJ=AM&&AM.layouts,AI={};if(AM){AM.layoutMap=AI;for(var AL=0,AK=AJ&&AJ.length||0;AL<AK;AL++){var AH=AJ[AL];AI[AH.k]=AH;}}},formatResolver:{getFormat:function L(AL,AK){var AJ=((AL&&AL.fmts)||null);if(AK){var AN=AL.thresholds,AI=AN&&AN[AK];if(AI){var AM={},AO;for(AO in AJ){AM[AO]=AI[AO]||AJ[AO];}for(AO in AI){var AH=AI[AO];AM[AO]=(typeof (AH)==="string")?(AH+" !important"):AH;}AJ=AM;}}return AJ;}},getSelectedXtabStyles:function W(AJ){var AI=AJ||this.currlaykey;var AL={};var AH=this.data&&this.data.layouts;for(var AK in AH){if(AH[AK].k===AI){AL=AH[AK].xtabStyles;break;}}return AL;},getChildren:function w(AX,AH,AO,AP,AN){var AS=this.currlaykey;if(AX){var AK=AX.defn;AS=(AK&&AK._lkz)||AX.k;}var Ai=this.getLayoutDataCache(AS),AY=(!AH&&!mstrmojo.hash.isEmpty(Ai)),Ae;if(!AX){Ae=this.data;}else{var AQ=AX.data||AX;if(AY){Ae=Ai[k.call(this,AQ,AS)];Ae=(Ae&&Ae.data)||Ae||AQ;}else{Ae=AQ;}}var AI=Ae?(Ae.sections||Ae.subsections||Ae.objects||Ae.panels||Ae.layouts||Ae.children):[],AT=[];var Ab=(AI&&AI.length)||0;if(Ab){var AK=this.defn,AV=!AX,AR=AX?AS:null,AM=(AX&&((AX.defn)?AX.defn.t:H.call(this,AK,AR,AX.k).t));var AJ=(AM===n.GRIDGRAPH),Ac=(AM===n.DETAILS);for(var Aa=AO||0,AZ=(isNaN(AP))?Ab:Aa+AP;Aa<AZ;Aa++){var Ag=AI[Aa];if(AJ){Ag.k=AX.k;Ag.wid=AX.data.wid;}var Aj=Ag.k,AW=k.call(this,Ag,AR),Af;if(!AV&&!AH&&P.call(this,Aj,AR)){var Ad=this.getLayoutUnitDefn(Aj),AU={data:Ag,defn:Ad,id:AW,k:Aj,p:Ae};Ai[AW]=AU;if(!this.infoWinByKey||!this.infoWinByKey[Aj]){var AL=this.infoWindows=this.infoWindows||{};var Ah=this.infoWinByKey=this.infoWinByKey||{};AL[Ad.n]=Ah[Aj]=AU;}continue;}if(AJ){AW+="_"+Aa;Af=H.call(this,AK,AR,Ag.k+"_"+Aa);}else{Af=H.call(this,AK,AR||Ag.k,Ag.k);}if(Ac){Af.dt=true;}AT.push({k:Ag.k,id:AW,defn:Af,data:AY?(Ai[AW]&&Ai[AW].data)||Ag:Ag});}}return AN?{nodes:AT,total:Ab}:AT;},getInfoWindow:function o(AI){var AH=this.infoWindows;return AH&&AH[AI];},getFixedHeaders:function(AI,AH){return AG.call(this,AI,AH,[n.PAGEHEADER],true);},getFixedFooters:function(AI,AH){return AG.call(this,AI,AH,[n.PAGEFOOTER],true);},getNonFixedSections:function(AI,AH){return AG.call(this,AI,AH,[n.PAGEHEADER,n.PAGEFOOTER],false);},getLayoutUnitDefn:function E(AI,AH){return H.call(this,this.defn,AH||this.currlaykey,AI);},getUnitInstance:function S(AH,AI){return mstrmojo.all[k.call(this,{k:AH,wid:AI},this.currlaykey)];},getFirstUnitInstanceByName:function m(AJ){var AH=G(this.defn,this.currlaykey);if(AH){var AI=AH.units;for(u in AI){var AK=AI[u];if(AK.n===AJ){return this.getUnitInstance(u,1);}}}return null;},getSelectedKey:function AD(AH){return(!AH&&this.currlaykey)||null;},getCurrentLayoutKey:function x(){return this.currlaykey;},getCurrentLayoutDef:function AA(){var AH=this.defn&&this.defn.layouts;return AH&&AH[a.find(AH,"k",this.currlaykey)];},replaceLayout:function C(AK,AL){var AI=this.dataCache;if(AI&&AI[AK]){AI[AK]={};}var AH=(this.data&&this.data.layouts)||(this.defn&&this.defn.layouts);for(var AJ=(AH&&AH.length-1)||0;AJ>=0;AJ--){if(AH[AJ].k===AK){break;}}this.bs=AL.bs;this.zf=AL.zf;if(AL.data){this.data.layouts[AJ]=AL.data.layouts[AJ];this.data.elems=AL.data.elems;}if(AL.defn){this.defn.layouts[AJ]=AL.defn.layouts[AJ];this.ondefnChange();}},loadLayout:function g(AH,AJ,AI){this.replaceLayout(AH.currlaykey,AH);this.raiseEvent({name:"rebuildLayout",unloadCache:!!AJ,restoreIW:!!AI});},getTransactionUpdates:function AF(AH){return this.txDiscardTargets?"":h.call(this,AH);},clearTransactionUpdates:function z(AH){this.clearTxDeltaUpdate(AH);},resetTransactionUpdates:function B(AH){var AI=this.pendingUpdate,AJ=this.delta;if(AI&&AI[AH]){q(AI[AH],function(AK,AL){if(AJ&&!AJ[AL]){AJ[AL]=AK;}});delete AI[AH];}},getDataService:function N(){var AJ=this.dataService,AH=this;if(!AJ){var AI={rwb:this.bs,msgId:this.mid,model:this};if(mstrApp.modelFactory){AJ=mstrApp.modelFactory.newDataService("Document",AI);}else{AJ=mstrApp.viewFactory.newDocDataService(AI);}this.dataService=AJ;this.disposables.push(AJ);}return AJ;},partialUpdate:function T(AJ,AH){var AI=this.updateDataCache(AJ,AH);this.raiseEvent({name:"partialUpdate",tree:AJ,ids:AI});return AI;},transactionUpdate:function(AJ,AI){if(!AJ.data){return ;}var AL=this,AM;if(AI&&AI.tks){AM=e.call(this,AI.tks);}if(AJ.pukeys){AM=e.call(this,AJ.pukeys);var AN;for(AN in AM){if(AM[AN]&&AM[AN].cek){AM[AN].cek=null;}}}if(AJ.txrcd){this.txrcd=AJ.txrcd;}else{delete this.txrcd;}var AK=this.updateDataCache(AJ.data,AM,AI&&AI.sid),AH={name:"partialUpdate",tree:AJ.data,ids:AK};if(!mstrmojo.hash.isEmpty(AK.ifws)){if(AI&&AI.type===n.GRID){AH.anchor=AI.anchor;}else{AK.ifws={};}}this.raiseEvent(AH);return AK;},deltaUpdate:function AE(AH){var AI=this.delta;if(!AI){AI=this.delta={};}AI[AH.id]=AH;},clearTxDeltaUpdate:function V(AI){var AL=this.txDiscardTargets,AH=!AL,AK=this.pendingUpdate,AJ=this,AM;if(!AH){q(AL,function(AN,AO){if(AJ.delta&&AJ.delta[AO]){AJ.delta[AO].clear();delete AJ.delta[AO];}});}if(AK&&AK[AI]){q(AK[AI],function(AN){AN.clear();});delete this.pendingUpdate[AI];}},sendTransactionActions:function s(AI,AH,AK){var AJ=this,AL;if(!AK){AK={success:function(AM){AJ.transactionUpdate(AM);}};}AJ.getDataService().sendTransactionActions({keyContext:AI,actions:AH,txrcd:this.txrcd},AK);},addSDP:function D(AI,AH){if(!AI||!AH){return ;}if(!this.sdp){this.sdp={};}this.sdp[AI]={k:AH.k,visName:AH.visName};},removeSDP:function Z(AH){if(!AH||!this.sdp[AH]){return ;}delete this.sdp[AH];},slice:function R(AU){try{if(!AU||(!mstrmojo.dom.isAndroid&&!AU.tks&&!AU.multiSelect&&(AU.type===3||(AU.type===n.GRAPH&&AU.tty!=1)))){return ;}var AJ=null,Ac=this,AX=this.getDataService(),Ad=AU.tks?e.call(this,AU.tks):null,AW=Ad,Ab=function(Ae){q(AW,function(Af,Ag){if(Af&&Af.set){Af.set("readyState",Ae);}});},Aa=function(Ae,Af){return mstrmojo.all[k.call(Ac,{k:Ae,wid:Af},Ac.currlaykey)];},AN=this.newCallback({method:"slice",submission:function(){Ab(J.WAITING);},success:function(Af){if(AU.disablePU){Ac.loadLayout(Af,AU.isUConDS,AU.restoreIW);return ;}if(Af.pukeys){Ad=e.call(Ac,Af.pukeys);}A(Ac,Af);AJ=Ac.updateDataCache(Af.data,Ad,AU&&AU.sid);if(typeof (Af)=="object"){mstrmojo.hash.copyProps(["bs","exopt","dty"],Af,Ac);}var Ae={name:"partialUpdate",tree:Af.data,ids:AJ};if(!mstrmojo.hash.isEmpty(Ae.ids.ifws)){if(AU&&!AU.suppressIW&&(AU.type===n.GRID||AU.type===n.GRAPH)){Ae.anchor=AU.anchor;}else{Ae.ids.ifws={};}}Ac.raiseEvent(Ae);},complete:function(){Ab(J.IDLE);}});if(AU.type==3){var AV=AU.tks,AP=AU.eid;if(!AV){return ;}var AT=H(this.defn,this.currlaykey,AP);if(!AT){return ;}var AQ=AP,AH=Ad[AV],AM=function(){AH.set("selKey",AP);},AL;AH.newSelKey=AP;if(AT.l){var AY=AT.dirtyKeys;if(!!AY){AQ=mstrmojo.hash.keyarray(AY).join(",");AW=Ad=e.call(this,AQ,",");AL=function(){AM();q(AJ.upd,function(Ae,Af){var Ag=mstrmojo.all[Af];if(Ag&&Ag.setDirty){Ag.setDirty(false);}});};}else{AX.setCurrentPanel(AP,AU.tks,AU.ck,this.newCallback({method:"slice",success:AM}));return ;}}else{AL=function(){AM();AT.l=true;};}var AR=AN.success;AN.success=function(Ai){var Ag=G(Ai.defn,Ac.currlaykey),Am=G(Ac.defn,Ac.currlaykey),Aj=function(An,Ao){for(var Ap in Ao){if(An[Ap]===undefined){An[Ap]=Ao[Ap];}}},Al=Ag&&Ag.units,Ak=Am&&Am.units,Af=Ag&&Ag.cgbMap,Ae=Am&&Am.cgbMap;if(Al){Aj(Ak,Al);}if(Af){Aj(Ae,Af);Ac.raiseEvent({name:"CGBMapChange",cgbMap:Ae});}AR(Ai);AL();var Ah=Aa(AU.tks,0);if(Ah){Ah.clearDirtyChild(AP);}};AX.requestNewPanel(AP,AU.tks,AU.ck,AQ,!AU.hasLoader,AN);}else{AN=O(AN,{success:function(Ae){q(AW,function(Ai,Ag){var Ah=Aa(Ag,1);if(!Ah){if(!!Ac.sdp&&!!Ac.sdp[Ag]){var Af=Ac.getLayoutDataCache(Ac.getCurrentLayoutKey());var Aj=k.call(Ac,{k:Ag,wid:1},Ac.currlaykey);Ac.raiseEvent({name:"secondaryDataSliced",key:Ag,data:Af[Aj].data});}return ;}if(AJ&&!(Ag in AJ.def)){if(Ah.setDirty){Ah.setDirty(true);}}else{if(Ai.t==n.PANELSTACK){Ah.setDirtyChildren();}}});}});var AK,AS;if(AU.type==n.GRAPH){AS="applyGraphSelectorAction";AK=[AU.ck,AU.cks,AU.sid,AU.x,AU.y,AN,Ac.zf];}else{if(AU.isMultipleEvents){AS="RWEventsTask";params={messageID:this.mid,styleName:"RWDocumentMojoStyle",events:AU.events};AK=[params,AN];}else{if("eid" in AU){AS=AU.isDocVis?"setDocVisSelectorElements":"setDocSelectorElements";AK=[AU.ck,AU.eid,AU.ctlKey,AU.include,AN,Ac.zf];var AO=K.call(this);if(AU.isUConDS||AO){AU.disablePU=true;AK=AK.concat([null,0,null,true]);}if(AO){AU.restoreIW=true;}if(Ac.sdp){var AI={};q(Ac.sdp,function(Af,Ae){if(Ac.sdp[Ae]){AI[Ae]=Af.visName;}});AK[7]=JSON.stringify(AI);}AK[8]=AU.tks;}else{if(AU.multiSelect){if(AU.selectorObjects.length>0){AS="setMultiDocSelectorElements";AK=[AU.selectorObjects,AU.multiSelect,AN,Ac.zf];}}else{if("srct" in AU&&AU.srct==4){if(AU.onlyInclude){AS="setDocSelectorInclude";AK=[AU.ckey,AU.include,AN,AU.srcid,AU.srct,Ac.zf];}else{AS="setDocSelectorExpression";AK=[AU.ck,AU.ckey,AU.srcid,AU.srct,AU.f,AU.ft,AU.include,AU.cs,5,AN,Ac.zf];if(!AU.cs){AK[7]=null;AK[8]=null;if(AU.changeQual){AX.setRWUnitProperties(AU.ckey,AU.ckey+"\u001FFormattingSelector\u001FMetricConditionType\u001F"+AU.qt,1,false,null);AK.push(AU.unset);}}}}else{if(AU.unset){AS="setDocUnsetSelector";AK=[AU.ck,AU.ckey,AN,Ac.zf];}else{AS="setDocSelectorInclude";AK=[AU.ckey,AU.include,AN,null,null,Ac.zf];}}}}}}if(AS){AX[AS].apply(AX,AK);}}}catch(AZ){mstrmojo.err(AZ);}},getLayoutDataCache:function F(AI){if(!AI){return null;}var AH=this.dataCache;if(!AH){AH=this.dataCache={};}if(!AH[AI]){AH[AI]={};}return AH[AI];},updateDataCache:function X(AI,AN,AK){var AM=this,AJ=this.getLayoutDataCache(this.getCurrentLayoutKey()),AL={ifws:{},upd:{},tgts:{},def:{},secs:{}};function AH(AV,AS,Aa){var AP=false,Ab=AM.getChildren(AV,true),Ac;if(!Ab.length){return ;}if(AS){Ac=mstrmojo.all[AV.id];AP=!AV.id||!!Ac;}var AW=AV.defn,AR=AV.data,AZ;if(AW&&AW.t===n.PANELSTACK&&AW.od){AZ=AR.selKey;}for(var AU in Ab){var AO=Ab[AU],AT=AO.k,AQ=AO.id,AY=null;if(mstrmojo.all[AQ]){AP=true;}if(AT in AN){if(P.call(AM,AT)&&l(AO.data,AK)){AJ[AQ]=AO;if(!Aa){AL.ifws[AT]=AM.infoWinByKey[AT].id;}}AY=AT;if(AP){if(AZ&&AZ!==AT){continue;}if(!Aa){AL.tgts[AQ]=true;}var Ad=Ac&&Ac.defn,AX=Ad&&Ad.t,Ae=Ad&&Ad.ck;if(AX===n.SUBSECTION&&(Ae&&(AT in Ae))){AL.secs[Ac.id]=true;}}}if((Aa||AY)&&(!AZ||AZ===AT)){AJ[AQ]=AO;AL.def[AT]=true;if(AP){AL.upd[AQ]=true;}}AH(AO,AP,Aa||AY);}}if(AI&&AI.layouts&&AN){AH(mstrmojo.array.filter(AI.layouts,function(AO){return(AO.loaded);},{max:1})[0],true);}return AL;},getCGBMap:function b(){var AH=G(this.defn,this.currlaykey);return AH&&AH.cgbMap;},executeLink:function Q(AH,AJ,AK){if(AH.indexOf("prevMsgID")>0){var AI="prevMsgID="+this.mid;AH=AH.replace(/prevMsgID=0($|&)/g,function(AL,AM){if(AM=="&"){return AI+="&";}else{return AI;}});if(mstrmojo.dom.isIE){AH+="&cb"+mstrmojo.now()+"=1";}}AH=mstrmojo.addCSRFTokenToURL(AH);this.controller.onLink(this,{url:AH,target:AJ,src:AK||null});},showInfoWin:function Y(AK,AJ,AH,AL,AM){var AI=this.infoWinByKey&&this.infoWinByKey[AK];if(AI===undefined){return ;}this.raiseEvent({name:"showInfoWin",psId:AI.id,psKey:AI.k,anchor:AJ,anchorOrientation:AH,anchorPosition:AM,invalidate:AL});},downloadGridData:function j(AM){var AK=this,AJ=AM.xtabId,AI=AM.memo,AH=mstrmojo.all[AJ],AL=this.getDataService();var AN=this.newCallback({success:function(AR){function AV(Aa,Ab){var AY=AK.getChildren(Aa,true);for(var AX in AY){var AZ=AY[AX];if(Ab==AZ.id){return AZ;}var AW=AV(AZ,Ab);if(AW){return AW;}}return null;}var AO=AR.data,AU=null,AT,AP=AO&&G(AO,AK.currlaykey);if(AP){AU=AV(AP,AJ);}if(AU&&AH){AH.dataDownloaded(AU,AI);}if(AP&&AP.xtabStyles){AK.raiseEvent({name:"updateStyles",key:AP.k,updatedStyles:AP.xtabStyles});}AT=H.call(AK,AK.defn,AK.currlaykey,AM.nodeKey);if(AT&&AT.t===n.GRIDGRAPH&&AI.recalculating){var AQ=AH.parent,AS=AQ&&AQ.getGraphWidget();if(AQ&&AS&&AQ.updateGraph){AQ.updateGraph(AV(AP,AS.id));}}},failure:function(){if(AH.dataDownloadErr){AH.dataDownloadErr();}}});AL.downloadGridData(AM,AN);},saveRWProps:function AB(AI,AM,AN,AK,AP){var AH=[],AL="\u001F";q(AM,function(AR,AQ){q(AR,function(AS,AT){AH.push(AQ+AL+AT+AL+AS);});});if(!AH.length){return ;}if(AK){var AJ=H.call(this,this.defn,this.currlaykey,AI),AO=function(AQ){AJ.set("readyState",AQ);};AP=O(AP,{submission:function(){AO(J.WAITING);},complete:function(){AO(J.IDLE);}});}this.getDataService().setRWUnitProperties(AI,AH.join("\u001E"),AN||1,AK,AP);},loadPartialData:function I(AM,AI){var AK={};AK[AI]=H.call(this,this.defn,this.currlaykey,AI);var AJ=this.updateDataCache(AM,AK),AH=this.getLayoutDataCache(this.getCurrentLayoutKey()),AL=this;mstrmojo.array.forEach(AM.layouts,function(AN){if(AN&&AN.xtabStyles){AL.raiseEvent({name:"updateStyles",key:AN.k,updatedStyles:AN.xtabStyles});}});q(AJ,function(AO,AN){if(AN==="upd"){q(AO,function(AQ,AR){var AP=mstrmojo.all[AR];if(AP&&AP.update){AP.update(AH[AR]);}});}});},addAutoWidthID:function f(AJ){var AI=this.aws||{},AH=AI[this.currlaykey]||[];AH.push(AJ);AI[this.currlaykey]=AH;this.aws=AI;},getAutoWidthIDs:function M(){var AJ=this.aws,AH=this.currlaykey;var AI=AJ&&AJ[AH];if(AI){delete AJ[AH];}return AI;}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocDataService");mstrmojo.OIVMViewFactory=mstrmojo.declare(mstrmojo.OIVMViewFactory,null,{scriptClass:"mstrmojo.OIVMViewFactory",newDocDataService:function A(B){return new mstrmojo.DocDataService(B);}});}());(function(){var Q="<tr>";var Y=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var T="&nbsp;";var I="fsbp_1 ";var X="fsbp_2 ";var B="fsbp_3 ";var V=1,W=2,F=3,K=4,A=5,S={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" no-stack",5:" stack-full"};var Z=mstrmojo.css;var L=4;function E(f,e){for(var g=0,b=f.length;g<b;g++){var j=f[g];var h=e.rows[j.rows].cells[j.cells];if(h){mstrmojo.css.addClass(h,I);}}}mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function J(b){this._super(b);},numColumnCanMerge:0,preBuildRendering:function D(b){var e=this.cp;if(!e){return ;}e.initContent();this.rc=e.rc||0;this.cws=e.colWidths||[];this.cc=this.cws.length;this.tdWidths=e.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=e.getNumAutoHeightRows&&e.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function H(e){var b=this._super(e);this.renderGrid();return b;},renderGrid:function R(e){var b=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(b,e);this.postBuildGridTable();},getGridContainer:function a(){return this.gridContainerNode;},buildGridTable:function G(f,b){var e=this.getTableStartMarkup();var l=this.getTableEndMarkup();if(b){this.mergeHdrsAcrossBlks=true;}var j=this.buildTableRowsMarkup(this.start,this.end,e,l).join("");if(b){var h=document.createElement("div");h.innerHTML=j;var k=f.firstChild,m=k&&k.tBodies,g=h.firstChild.tBodies[0],i=this.matchedHdrsAcrossBlks;k.appendChild(g);if(i&&i.length>0){E(i,m[m.length-2]);}}else{f.innerHTML=j;}},getTableStartMarkup:function O(){var e=this._getGridWidths(),b=Y;b[1]=e.tableLayout;b[3]=e.totalColWidths;b[5]=this.tableCssClass?"class="+this.tableCssClass:"";b[7]="<colgroup>"+e.colgroup+"</colgroup>";if(this.tbodyStyle){b[8]='<tbody style="'+this.tbodyStyle+'">';}return b.join("");},getTableEndMarkup:function N(){return"</tbody></table>";},_getGridWidths:function U(){var m={};var h="",f=[],l="fixed",e=this.cws,j=e.length;if(j){h=0;f=[];for(var g=0;g<j;g++){if(e[g].w!==""){h+=parseInt(e[g].w,10);}}for(g=0;g<j;g++){var b=e[g];if(b.w!==""){var k=parseInt(b.w,10);if(mstrmojo.dom.isIE7){if(k===0){f.push('<col style="width:0%;display:none"></col>');}else{f.push('<col style="width:'+(k/h*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&k===0){f.push('<col style="width:-1px"></col>');}else{f.push('<col style="width:'+b.w+'"></col>');}}}else{f.push("<col />");l="auto";}}this.totalColWidth=h;}m.colgroup=f.join("");l=this.tableLayout||l;if(this.autoFitWindow){l=this.tableLayout||l||"fixed";h="100%";}else{if(l=="fixed"){h+="px";}else{h="auto";}}m.totalColWidths=h;m.tableLayout=l;return m;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function P(x,h,AW,e){var AK=[],AU=0;AK[AU++]=AW||"<table><tbody>";var z=this.cp,AE=z.getRowHeight(),AS=this._CELL_MARKUP,AJ=AE?'<tr style="height:'+(AE?AE+"px":"")+'">':Q;var g=true,t=true,AQ=[],AM;this.matchedHdrsAcrossBlks=[];for(var AN=x;AN<=h;AN++){AM=AU++;AK[AM]=AN<this.numAutoHeightRows?Q:AJ;var n=z.getRowCells(AN);var AI=h+1-AN;var AH=0;if(!this.mergeHdrsAcrossBlks){if(g&&x>0&&n.length<z.colWidths.length){var AG=z.getUnmergedCells(x);if(AG){AH=AG.length;}for(var AT in AG){var AP=AG[AT];if(AP.rs>AI){AS[1]=AI;AS[5]=X+AP.css;}else{AS[1]=AP.rs||1;AS[5]=B+AP.css;}if(AP.cet){AS[5]+=" mstrmojo-selected-cell";this.addHilitePosition(AP.cet,AN,AT);}if(AP._ei){this.addExtraInfoMap(AP._ei,AN,AT);AS[5]+=" pt";}AS[9]="";AS[13]=T;AS[3]=AP.cs;AS[7]=AP._ei!==undefined?AP._ei:"";AK[AU++]=AS.join("");}g=false;}}for(var AV=0,k=n.length;AV<k;AV++){var AC=n[AV],AD;if(AC.rs&&AC.rs>AI){AS[1]=AI;AS[5]=I+AC.css;if(AC._ei){this.addExtraInfoMap(AC._ei,AN,AV);}}else{AS[1]=AC.rs||1;AS[5]=AC.css;}if(AC.rowType!==V){AS[5]+=" xtab-td ";}if(AC.cet){AS[5]+="sc_"+this.parent.k;this.addHilitePosition(AC.cet,AN,AV);}AD=AC.rowType;if(AD){AS[5]+=S[AD]||"";var l=z.getRowHeight(AD);if(l){AK[AM]='<tr style="height:'+(l?l+"px":"")+'">';}}AS[3]=AC.cs||1;AS[7]=AC._ei!==undefined?AC._ei:"";if(AC.fs||AC._e){this.addTitleHeaderPositionMap(AN,AV+AH,AC);}if(AC._ei!=null){this.addPositionMap(AC._ei,AN,AV+AH);}AS[11]=AN;if(AC.ts===L){var q=AC.v;if(this.imgCacheMap){var AR=this.imgCacheMap,AL=q&&q.replace(/\\/g,"/");if(AR.cachedImg[AL]){AC.v=q=AR.baseURL+AR.cachedImg[AL];}else{if(AL&&!AR.unCachedImg[AL]){AR.unCachedImg[AL]=AL;}}}else{var f=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(f&&f.getImage){q=f.getImage(q);}}if(AC.rowType){var b=(z.getRowHeight(AC.rowType)||z.rh||AE),AO=b,w=this.tdWidths,AF=AC.colIdx,AA=0;if(AF!=="undefined"&&AF>-1&&w&&w.length>AF){var o=w[AF]&&w[AF].w;if(o!=="undefined"){AA=parseInt(o,10);}}var s=AA>30?(AA-30):0;AS[13]='<div><div style="top:'+(-parseInt(AO/2,10))+"px;height:"+b+"px;line-height:"+b+'px !important;">&nbsp;<img style="max-height:'+b+"px; max-width: "+s+'px;" src="'+q+'"></img></div></div>';}else{if(this.parent.gridData.lhv){AS[9]="background-image:url('"+q+"');background-repeat:no-repeat;background-position:center "+(AC.rs>1?"top":"center")+";";AS[13]=T;}else{AS[9]="";AS[13]='<img src="'+q+'"></img>';if(AC.css&&AC.css.indexOf("hl")>-1){AS[13]="<span>"+AS[13]+"</span>";}}}}else{AS[9]="";AS[13]=AC.v||AC.n||T;if(AC.css&&AC.css.indexOf("hl")>-1){AS[13]="<span>"+AS[13]+"</span>";}}if(AV<this.numColumnCanMerge){if(AN===x&&this.mergeHdrsAcrossBlks){var AB=this.rowHdsAcrossBlks;if(t&&AC.v&&AB&&AB[AV]){if(AC.v===AB[AV].v){AS[1]=AC.rs||1;AS[5]=B+AC.css;AS[13]="";this.matchedHdrsAcrossBlks.push(AB[AV]);}else{t=false;}}}if(AS[1]>=AI&&AC.v){AQ.push({rows:AN-x,cells:AV,v:AC.v});}}AK[AU++]=AS.join("");}AK[AU++]="</tr>";}AK[AU++]=e||"</tbody></table>";this.rowHdsAcrossBlks=AQ;return AK;},addHilitePosition:function(e,f,b){var g=this.hiliteCellsMap[e];if(!g){this.hiliteCellsMap[e]={pos:[],nodes:[]};}this.hiliteCellsMap[e].pos.push({row:f,cell:b,page:0});},addExtraInfoMap:function(e,b,f){if(!this.eiMap[e]){this.eiMap[e]=[];}this.eiMap[e].push({row:b,cell:f,page:0});},addPositionMap:function(e,b,f){if(!this.posMap[e]){this.posMap[e]={row:b,cell:f,page:0};}},addTitleHeaderPositionMap:function(b,f,e){this.thPosMap.push({row:b,cell:f,page:0,obj:e});},clearHilites:function(m){var g=this.hiliteCellsMap[m],h=g&&g.nodes,k=this.parent;if(h){if(h.length==0&&g.pos){h=this.getNodesByPositions(g.pos);}for(var f=0,b=h.length;f<b;f++){var e=h[f],j=e.className,l=k.getCellForNode(e);if(l){delete l.cet;}Z.removeClass(e,"sc_"+k.k);}this.hiliteCellsMap[m].nodes=[];}},setHilites:function(e,f){Z.addClass(f,"sc_"+this.parent.k);if(!this.hiliteCellsMap[e]){this.hiliteCellsMap[e]={pos:[],nodes:[]};}this.hiliteCellsMap[e].nodes.push(f);var b=this.parent.getCellForNode(f);if(b){b.cet=e;}},getNodesByPositions:function(h){var g=this.tableNode,b=[];for(var f in h){var e=h[f];b.push(g.tBodies[0].rows[e.row].cells[e.cell]);}return b;},preBuildGridTable:function C(){},postBuildGridTable:function M(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});}});})();(function(){var regExH=/"height", "[0-9.]+"/g;var regExW=/"width", "[0-9.]+"/g;var regExH1=/height="?[0-9.]+"?/g;var regExW1=/width="?[0-9.]+"?/g;mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._IsSelectorTarget");mstrmojo.DocVisualization=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocVisualization",markupString:'<div id={@id} class="mstrmojo-docvisualization" title="{@tooltip}" style="{@domNodeCssText}">{@htmlText}</div>',formatHandlers:{domNode:["RW","T","B","fx"]},update:function update(node){if(this._super){this._super(node);}var d=node.data;this.htmlText=d.htmlText;this.jsText=d.jsText;this.selData=d.selData;this.ctrLink=d.ctrLink;this.vp=d.vp;this.eg=d.eg;if(this.eg){this.htmlText=this.eg;}},preBuildRendering:function(){if(this._super){this._super();}var fmts=this.getFormats();if(!fmts){return ;}var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(this.jsText){this.jsText=this.jsText.replace(regExH,'"height", "'+h+'"').replace(regExW,'"width", "'+w+'"');}},postBuildRendering:function pstBldRnd(){if(this._super){this._super();}eval(this.jsText);},resize:function(){if(this.eg){return ;}var embedNode=this.domNode.firstChild.firstChild.firstChild;if(!embedNode){return ;}var fmts=this.getFormats();var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(mstrmojo.dom.isIE){embedNode.firstChild.setAttribute("height",h);embedNode.firstChild.setAttribute("width",w);}else{embedNode.innerHTML=embedNode.innerHTML.replace(regExH1,'height="'+h+'"').replace(regExW1,'width="'+w+'"');}},makeSelections:function(selections){var shuffledData={},i,j,attId,e;for(i=0;i<selections.length;i++){var attIdI=selections[i].attId;if(!shuffledData[attIdI]){shuffledData[attIdI]=[];}shuffledData[attIdI]=shuffledData[attIdI].concat(selections[i].values);}var sep="\u001E",sep1="\u001F";var ckJoined="",eidJoined="",cklJoined="";var tksArray=[];for(attId in shuffledData){var sd=this.getSelectionData(attId);if(!sd){continue;}var ctrLink=this.ctrLink[attId];var values=shuffledData[attId];if(sd&&values&&values.length>0){sd.sel=values;sd.ias=false;for(e in values){if(e==="u;"){sd.ias=true;break;}}}if(ctrLink.gbTargets){var t=ctrLink.targets=[],gbt=ctrLink.gbTargets,cgbmap=this.model.getCGBMap();for(j=0;j<gbt.length;j++){var targetKey=cgbmap[gbt[j]];if(targetKey){t.push(targetKey);}}delete ctrLink.gbTargets;}ckJoined+=ctrLink.ctxt+sep1;eidJoined+=values.join(sep)+sep1;cklJoined+=ctrLink.ck+sep1;tksArray=tksArray.concat(ctrLink.targets);}ckJoined=ckJoined.substring(0,ckJoined.length-1);eidJoined=eidJoined.substring(0,eidJoined.length-1);cklJoined=cklJoined.substring(0,cklJoined.length-1);if(tksArray.length==0){return ;}var evt={ck:ckJoined,eid:eidJoined,src:this.k,tks:tksArray.join(sep),type:this.defn.t,ctlKey:cklJoined,include:true,isDocVis:true};this.model.slice(evt);},getAllSelectionData:function(){return this.selData;},getSelectionData:function(attId){var selData=this.selData,k;if(selData&&selData.attl){var attl=selData.attl;if(attId){return attl[attId];}else{for(k in attl){return attl[k];}}}},saveVisProps:function(widgetPropsXml){var props={};props[this.k]={FormattingWidget:"WidgetProps\u001F"+widgetPropsXml};mstrApp.docModel.saveRWProps(this.k,props,1,false,{success:function(){}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRoundRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRoundRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRoundRectangle" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocRoundRectangle-l1" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div style="{@rectNodeCssText}{@rectNodeGradCssText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l1" style="{@bCornersCssText}{@bCornersCssGradText}"></div></div>',markupSlots:{rectNode:function(){return this.domNode.childNodes[3];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["top","left","width","z-index","fx"],rectNode:["height","background-color"],tCorners:["background-color"],bCorners:["background-color"]},update:function C(D){if(this.thresholdId||D.data.tid){delete this.fmts;}this.thresholdId=D.data.tid;this.set("visible",!D.data.hidden);},preBuildRendering:function B(){var F=this._super();var G=this.getFormats(),D=!!this.defn.topc,I=(D)?4:8,H="(\\d*px)",E=Math.max(parseInt(G.height,10)-I,0);if(G.height==="100%"){H="(100%)";E=this.parent.height()-I;}this.rectNodeCssText=this.rectNodeCssText.replace(new RegExp("(.*height:)"+H+"(.*)"),"$1"+E+"px$3");if(D){this.bCornersCssText="display:none;";}return F;},formatGradient:function A(E,H){var F=mstrmojo.css.buildGradient(E.t,E.sc,E.ec);if(!F){return ;}var D=F.n+":"+F.v+";",G="background-color:";this.rectNodeGradCssText=D;if(E.t===0){this.tCornersCssGradText=G+E.sc+";";this.bCornersCssGradText=G+E.ec+";";}else{this.tCornersCssGradText=this.bCornersCssGradText=D;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onidxChange:function(){var B=this.domNode.getElementsByTagName("select");if(B&&B.length){B[0].selectedIndex=this.idx;}},onvalueChange:function(D){var H=this.selectNode,F=H.options,E=this.value,C;for(var G=0;G<F.length;G++){var B=F[G].value==E;if(B){C=G;if(E!=""){mstrmojo.css.toggleClass(F[G],"selected",B);}break;}}if(H.length>0&&C>0&&this.unset){H.remove(0);C--;this.unset=false;}this.set("idx",C);},onwidthChange:function(){if(this.width>=0){this.selectNode.style.width=this.width+"px";}}},onselectedChange:function(){var B=this.selectNode;if(B){this.set("value",B.value);}},preBuildRendering:function A(){var C=[];var B=-1;if(this.unset){this.idx=0;}var G=this.options;for(var E=0,D=(G&&G.length)||0;E<D;E++){var H=G[E];var F="";if(this.idx==E){this.selected=H.v;this.value=H.v;F=' selected="true" class="selected"';}C[++B]='<option value="'+H.v+'"'+F+">"+H.n;}this.renderedOptions=C.join("</option>");return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var F=mstrmojo.array,C=mstrmojo.css,G=mstrmojo.string,B=mstrmojo.dom,A="unselected",D="inline-block";mstrmojo.ImageToggle=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ImageToggle",unset:null,useAnimation:true,markupString:'<div class="mstrmojo-ImageToggle {@cssClass}" style="{@cssText}" tabindex="{@tabIndex}"  mstrAttach:click,blur,keydown ></div>',tabIndex:0,markupMethods:{onimageListChange:function(){var O=this.imageList&&this.imageList.slice(),L=this,M=this.unset,K,N,J;if(!G.isEmpty(M)&&O){O.push({n:M,v:M,_ust:true});}if(this.domNode&&O){L.domNode.innerHTML="";L.domNode.style.minHeight=Math.min(20,L.height)+"px";L.domNode.style.minWidth=Math.min(20,L.width)+"px";L._loadedImgs=O.length;mstrmojo.array.forEach(O,function(Q,P){N=document.createElement("div");N.style.cssText="display:none;font-size:0px !important;line-height:"+L.height+"px !important;";J=document.createElement("img");J.alt=J.title=Q.v;J.style.verticalAlign="middle";J.style.maxHeight=L.height+"px";J.style.maxWidth=(L.width-1)+"px";if(!mstrmojo.dom.isIE){J.onerror=function(){this.src="../images/image_not_found.jpg";};}N.appendChild(J);L.domNode.appendChild(N);J.src=Q.n||"../images/image_not_found.jpg";if(Q._ust){L.ustImgIdx=P;}L._imgs[P]=N;});this._setSelectedValue();}},onvalueChange:function(){this._setSelectedValue();}},imageList:null,value:null,selectedIndex:-1,preBuildRendering:function E(){if(this._super){this._super();}this._imgs=[];},_setSelectedValue:function H(){var L=this,K=this.selectedIndex,N=this.imageList;if(N){if(N[K]){L._imgs[K].style.display="none";}F.forEach(this.imageList,function(O,P){if(O.v==L.value){C.removeClass(L.domNode,A);L.selectedIndex=P;L._imgs[P].style.display=D;return ;}});if(this.selectedIndex===-1){if(!this.unset){C.addClass(this.domNode,A);}else{var M=this._imgs[this.ustImgIdx],J=M.lastChild;J.alt=J.title=this.value;M.style.display=D;}}}},onclick:function I(){var L=this.imageList,M=L&&L.length,N=300,T=this.selectedIndex,K=T,J=this.domNode,R,Q,P,S,O=this;P=(T===-1&&this.ustImgIdx!==null)?this._imgs[this.ustImgIdx]:this._imgs[T];T=(T+1)%M;S=this._imgs[T];C.removeClass(J,A);this.selectedIndex=T;if(this.useAnimation){Q=new mstrmojo.fx.FadeIn({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:S,preStart:function(){this.target.style.display=D;}});R=new mstrmojo.fx.FadeOut({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:P,onEnd:function(){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}Q.play();}});if(P){R.play();}else{Q.play();}}else{if(P){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}}S.style.display=D;}this.value=this.imageList[T].v;},onkeydown:function(K){var J=K.hWin,L=K.e||J.event;if(L.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(J,L);this.onclick();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Widget");var A=mstrmojo.css;mstrmojo.TabButton=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.TabButton",markupString:'<span id="{@id}" class="mstrmojo-TabButton {@cssClass}" style="{@cssText}" mstrAttach:click></span>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},ontitleChange:function(){this.domNode.innerHTML=this.title||"";},onbackgroundColorChange:function(){this.domNode.style.backgroundColor=this.backgroundColor||"";},onselectedChange:function(){A.toggleClass(this.domNode,["selected"],!!this.selected);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRectangle" title="{@tooltip}" style="{@domNodeCssText}"></div>',markupMethods:{onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width+"px";}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["RW","B","background-color","fx"]},preBuildRendering:function A(){var D=this._super(),C=this.defn;if(C.r){this.domNodeCssText+=mstrmojo.css.buildRoundCorners(C.r,C.topc);}return D;},postBuildRendering:function(){var E=this._super();var D=this.fmts;if(D){var C=D.border||D["border-width"],F=C&&(parseInt(C,10)/72*this.model.dpi);if(F){if(D.height=="100%"){this.set("height",this.domNode.clientHeight-2*F);}if(D.width=="100%"){this.set("width",this.domNode.clientWidth-2*F);}}}return E;},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocLine=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocLine",markupString:'<div id="{@id}" class="mstrmojo-DocLine" title="{@tooltip}" style="{@domNodeCssText}"></div>',formatHandlers:{domNode:["RW","border-top","border-left","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}},getFormats:function A(){var C=this._super();if(C&&parseInt(C.height,10)===0){C.height="1px";}return C;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var P=mstrmojo.dom,B=mstrmojo.css,M=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var U=document.createElement("tr"),V=this.data,Y=this._cmSource,R,S;U.id=this.id;U.className="mstrmojo-ContextMenuItem "+(Y.isSeparatorItem(V)?"separator":Y.item2textCss(V));var W=this,X=function(){W.handleMouseOver();},T=function(){W.handleMouseOut();},Q=function(){W.handleClick();};P.attachEvent(U,"mouseover",X);P.attachEvent(U,"mouseout",T);P.attachEvent(U,"click",Q);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-text";if(Y.isSeparatorItem(V)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=V.itemWidget?"&nbsp":V[this.itemField];}R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return U;},buildRendering:function K(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){B.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){B.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=P.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function C(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function E(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function L(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function O(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,T=this._subMenu.domNode,S=T.offsetHeight,R=T.offsetWidth,W=P.windowDim(),V=P.position(T,false),U=P.position(T,true);if((V.x+R+M)>W.w){Q.set("left",(P.position(this.domNode,true).x-R)+"px");}if((V.y+S+M)>W.h){Q.set("top",(W.h-S-M+(U.y-V.y))+"px");}},handleMouseOver:function N(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function D(){this._cmSource.closeMenuTree();},handleClick:function F(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}else{}}});})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl");mstrmojo.DefaultDIC=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DefaultDIC",isDummy:true,showInPopup:function(){mstrmojo.alert("The control style has not been supported yet.");}});}());mstrmojo.ToolSeparator=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ToolSeparator",markupString:'<div class="mstrmojo-ToolSeparator {@cssClass}" style="{@cssText}"></div>',markupSlots:{},markupMethods:{}});(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.ProgressBar=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ProgressBar",markupString:'<div class="mstrmojo-ProgressBar {@cssClass}" style="{@cssText}"><div class="bar"><div class="indicator" style="display:inline-block"></div></div><div class="text">{@progressText}</div></div>',markupSlots:{barNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.lastChild;}},markupMethods:{onprogressTextChange:function(){this.textNode.innerHTML=this.progressText||"";}},updateProgress:function A(C,B){if(this.hasRendered){this.barNode.firstChild.style.width=Math.min(100,Math.max(0,parseInt(C,10)))+"%";if(B!==undefined){this.set("progressText",B);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocHTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocHTMLContainer",scrolling:"auto",markupString:'<iframe id="{@id}" class="mstrmojo-DocHTMLContainer" title="{@tooltip}" style="{@domNodeCssText}" src="{@v}" scrolling="{@scrolling}"></iframe>',formatHandlers:{domNode:["RW","B","F","background-color","text-align","white-space","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function A(B){this.v=B.data.v;if(mstrApp&&mstrApp.isTouchApp()){this.scrolling="no";}if(this.thresholdId||B.data.tid){delete this.fmts;}this.thresholdId=B.data.tid;this.set("visible",!B.data.hidden);}});})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var Z=mstrmojo.hash,g=mstrmojo.array,f=mstrmojo.boxmodel,b=mstrmojo.dom;function A(j,l,i){var k=j.listSelector;if(k){k[l](j,j.itemsContainerNode,i);}}function K(j,i){var k=j.lastPagePos;if(!k||k.dragId!==i){k=f.offset(j.itemsContainerNode);k.dragId=i;j.lastPagePos=k;var l=j.scrollboxNode;j.lastScrollPos={left:l.scrollLeft,top:l.scrollTop,width:l.clientWidth,height:l.clientHeight};}}function N(l,o,j){var k=o&&o.node;if(k===l.dropCueNode||k===l.dropCueNode.firstChild){return l.dropCuePos;}var m=l.listMapper;var i=m&&m.whereDrop(l,l.itemsContainerNode,k,o.pos,{left:l.lastPagePos.left-l.lastScrollPos.left,top:l.lastPagePos.top-l.lastScrollPos.top,width:l.lastScrollPos.width,height:l.lastScrollPos.height});var n=l.dropCuePos;return((j!==false)&&n&&i&&(n.idx===i.idx)&&(n.left===i.left)&&(n.top===i.top))?n:i;}var h="attachEventListener";function C(j,i){if(j.makeObservable){i=i||[];if(!i[h]){mstrmojo.hash.make(i,j.itemsScriptClass||mstrmojo.Arr);}}return i;}function G(j,i){if(i&&i[h]){j._sub_its=i;j._sub_add=i[h]("add",j.id,"preadd");j._sub_rmv=i[h]("remove",j.id,"preremove");}}function F(i){if(i._sub_its){var j=mstrmojo.publisher;j.unsubscribe(i._sub_add);j.unsubscribe(i._sub_rmv);delete i._sub_add;delete i._sub_rmv;delete i._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var j=this.dropCueNode,i=j&&j.style;if(!i){return ;}var l=this.dropCuePos,k=!!l;if(k){i.left=l.left+"px";i.top=l.top+"px";}i.display=k?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Y(m){this._super(m);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,n=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||n){this.initSelections(l,j,k,n);}if(this.postInitItems){this.postInitItems();}},initItems:function H(i){return C(this,i);},preBuildRendering:function V(){var m=this.listBuilder,p=m.newContext(this);this.ctxtBuilder=p;var j=this.markupSlots,l=!!(this.renderOnScroll&&this.renderBlockSize&&j&&j.scrollboxNode),k=this.items,i=(k&&k.length)||0,n=l?this.firstRenderBlockSize:i,o=l?this.firstRenderBlockSize:0;this._eros=l;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(k,m,this,p,n,o).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function D(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}G(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var i=mstrmojo.all[q];i.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var l=0,k=["itemsEffect","scrollEffect"],j=k.length;l<j;l++){var p=k[l],m=this[p];if(m&&m.constructor===Object){m=mstrmojo.insert(mstrmojo.hash.clone(m));m.widget=this;this[p]=m;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function W(m){F(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var k=0,l=["itemsEffect","scrollEffect"],j=l.length;k<j;k++){var n=this[l[k]];if(n&&n.isPlaying){n.cancel();}}this._super(m);},pauseScrollRendering:function O(k,i,j){if(k!==false){k=true;}if(this.paused===!!k){return ;}this.paused=!!k;if(k){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(i,j);}},onscroll:function J(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var i=this;this._fillTmr=self.setTimeout(function(){i.fill();i=null;},50);}}if(this._super){this._super();}},fill:function a(i,m){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var n=(this.items&&this.items.length)||0;if(!n){if(m){m();}}else{var k=this.scrollboxNode,o=this.itemsContainerNode,l=mstrmojo.boxmodel.offset(o,k),q=this.listMapper,p=q.findScrollRange(o,n,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||k.scrollTop,k.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||k.scrollLeft,k.clientWidth,l.left,l.top);if(this.fillAt(p.start,p.end)){if(i){i();}var j=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[j].fill(i,m);},100);}else{if(m){m();}}}},fillAt:function L(k,j){var i=this.listMapper;if(i){return i.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,k,j,this.renderBlockSize);}else{return false;}},add:function Q(j,i){if(!j||!j.length){return -1;}var k=this.items;if(i==null){i=Z.min(this.selectedIndices,false,true);if(i!==null&&i!==undefined){i++;}}if(i==null||i===-1){i=(k&&k.length)||0;}if(k&&k.add){k.add(j,i);}else{this.set("items",k?g.insert(k.concat(),i,j):j);}return i;},preadd:function B(l){if(this.hasRendered){var o=this.listMapper;if(o){o.onadd(this,this.itemsContainerNode,this.ctxtBuilder,l);}var n=this.listBuilder;if(n){n.onadd(this,this.ctxtBuilder,l);}var k=this.listSelector;if(k){k.onadd(this,l);}if(this._eros){this.onscroll();}else{var m=l.index,j=l.value.length;this.fillAt(m,m+j-1);}}if(this.onadd){this.onadd(l);}if(this._super){this._super(l);}},remove:function T(j){if(j==null){return -1;}if(j.constructor!==Array){return this._remove(j);}var l=this.items;if(l){var k;if(l.remove){for(k=j.length-1;k>-1;k--){l.remove(j[k],1);}}else{l=l.concat();for(k=j.length-1;k>-1;k--){l.splice(j[k],1);}this.set("items",l);}return j[0];}return -1;},_remove:function T(k){var j=this.items;if(!j||(k==null)){return -1;}var i;if(!isNaN(k)){i=k;}else{i=this.itemIndex(k);}if(i>-1){if(j.remove){j.remove(i,1);}else{j=j.concat();j.splice(i,1);this.set("items",j);}}return i;},duplicate:function X(n,j,k){var l=this.items,i=-1;if(!l||(n==null)){return -1;}if(!isNaN(n)){if(j===null||j===undefined){j=n+1;}n=l[n];}else{if(j===null||j===undefined){j=this.itemIndex(n)+1;}}if(n){var m;m=Z.copy(k,Z.clone(n));i=this.add([m],j);}return i;},preremove:function M(j){if(this.hasRendered){var l=this.listMapper;if(l){l.onremove(this,this.itemsContainerNode,this.ctxtBuilder,j);}var k=this.listBuilder;if(k){k.onremove(this,this.ctxtBuilder,j);}var i=this.listSelector;if(i){i.onremove(this,j);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(j);}if(this._super){this._super(j);}},move:function R(m,s){function p(t,i){return(s>=t)&&(s<=t+i);}var q=(this.items&&this.items.length)||0;if(s===-1||s==null||isNaN(s)){s=q;}else{s=Math.min(s,q);}var l,j,o,n;if(m.constructor===Array){j=m;o=m;n=(j&&j.length)||0;if(p(m[0],m.length)){return false;}l=g.get(this.items,m);}else{if(typeof (m)==="object"){l=[m];n=1;j=this.itemIndex(l[0]);o=[j];if(p(j,1)){return false;}}else{j=m;o=[m];n=1;if(p(j,1)){return false;}l=[this.items[j]];}}for(var k=0;k<n;k++){if(o[k]<=s){s--;}}if(l[0]!=null){this.remove(j);this.add(l,s);}return true;},itemIndex:function E(i){if(i==null){return -1;}var j=this.itemIdField;return j?g.find(this.items,j,i[j]):g.indexOf(this.items,i);},prechange:function S(l){if(this.hasRendered){var k=[this.listBuilder,this.listMapper];for(var m=0,j=k.length;m<j;m++){var n=k[m];if(n&&n.onchange){n.onchange(this,this.itemsContainerNode,this.ctxtBuilder,l);}}}},makeObservable:false,_set_items:function I(o,i){var m=this.items;i=this.initItems(i);this.items=i;if(m!==i){var l=this,k=function(){if(l.autoHide){l.set("visible",!!(i&&i.length));}l=null;},j=this.hasRendered;if(j){this.refresh(k);}else{k();}}return m!==i;},premousedown:function e(i){A(this,"premousedown",i);},premouseup:function P(i){A(this,"premouseup",i);},scrollTo:function U(j){var i,k=this.listMapper;if(k&&k.toItem){if(!isNaN(j)){i=j;}else{i=this.itemIndex(j);}if(i>=0){k.toItem(this,i);}}},draggable:false,getDragData:function(m){K(this,m.id);var k=N(this,m.src),j=k&&k.idxActual;if((j>-1)&&this.selectedIndices[j]){var l=this.sortSelectedIndices(),i=g.get(this.items,l)||[];switch(i.length){case 1:return Z.copy(i[0],{html:i[0][this.itemDisplayField],index:l[0]});case 0:return null;default:return Z.copy({html:i.length+" selections",indices:l},i);}}},dropZone:false,ondragenter:function(i){K(this,i.id);this.set("dropCuePos",N(this,i.tgt));},ondragover:function(i){this.set("dropCuePos",N(this,i.tgt));},ondragleave:function(i){this.set("dropCuePos",null);},ondragstart:function(i){if(!(i&&i.src&&i.src.data)){return false;}},allowCopy:false,ondragend:function(l){var j=l&&l.tgt,i=j&&j.widget;if(i===this){}else{if(this.tree&&i&&i.tree===this.tree){if(!this.allowCopy||!b.ctrlKey(j.hWin,j.e)){var k=l.src&&l.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}}}}},ondrop:function(q){var x=q&&q.src,p=x&&x.data;if(p){var k=N(this,q.tgt,false),t=k&&k.idx,l=(p&&p.constructor===Array);var n=this.items;t=Math.min(t,(n&&n.length)||0);var w=true;if(x.widget===this){w=this.move(this.sortSelectedIndices(),t);}else{this.add(l?p:[p],t);}if(w){var o=l?p.length:1,j={};for(var m=0;m<o;m++){j[t+m]=true;}this.set("selectedIndices",j);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var a=1,P=2;var C=2,H=4;var S=1,K=4;function F(b,e){return b[((e===a)?"row":"col")];}function A(b,f){var e=f.lm;return e&&e[b.mix||0];}function G(b,f){var e=f.dp;return e&&e[b.mix||0];}function V(t,m,e){var o=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:m.daMode});var k=m.ans,j=k&&k.length;if(j){var q=o.prms=[],AE=0;for(AE=0;AE<j;AE++){var AC=k[AE];var AB=AC.pid,AD=parseInt(AC.m,10),w={id:AB,am:AD,pt:AC.pt};q.push(w);if(AC.po){w.orid=AC.po.did;w.ortp=AC.po.t;}switch(AD){case o.DO_NOT_ANSWER:case o.CLOSE:case o.USE_DEFAULT_ANSWER:case o.SAME_PROMPT:break;case o.STATIC:var AF=AC.es,n=(AF&&AF.length)||0,p;w.pa={es:[]};for(p=n-1;p>=0;--p){var x=AF[p];w.pa.es.push({ei:x.id,disp_n:x.n,emt:1});}break;case o.DYNAMIC:case o.ALL_VALID_UNITS:case o.CURRENT_UNIT:var f=AC.dunits;if(f&&f.length&&e){var b=w.pa={};var s=e,l=(e.mix!==undefined)&&(e._lp||e._tp);if(l){s=e._lp||e._tp;}var h=parseInt(s.axis,10);while(s){var AG=this.getPTitle(s,h);if(AG&&mstrmojo.array.find(f,"id",AG.id)>=0){if(AD!==o.DYNAMIC){b.a={id:AG.id,n:AG.n,dispForms:AG.dfi};}if(AC.pt===1){b.v=s.v;break;}else{var AA=s._e.id,g=s._e.n;b.es=[];b.es.push({ei:AA,emt:1,disp_n:g});}if(AD===o.CURRENT_UNIT){break;}}s=this.getPCellParentNode(s,h);if(l&&!s&&h===a){h=P;s=e._tp;}}}break;}}}return o;}function N(f){var e=this.getCellTitleInfo(f[0]),h=[],k=function(i){if(i){if(mstrApp.useBinaryFormat){if(i._e){h.push(i.axis+"A"+(i.ui+1)+"A"+i._e.id);}k(i._p);}else{h.push(i.axis+"A"+(i.ui+1)+"A"+i.o);}}},g,b;if(!e.isSrcTitle){for(g=0,b=f.length;g<b;g++){var j=f[g];if(j.mix!==undefined&&(j._lp||j._tp)){k(j._lp);k(j._tp);}else{k(j);}}}return(mstrApp.useBinaryFormat)?h:h.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function O(){return this.data.mid;},getCellTitleInfo:function W(e,h){var f=h?h.gts:this.data.gts;var g=null;if(e.mix===undefined){g=F(f,e.axis)[e.tui||e.ui];}else{var b=function(l){var j=(l&&l.length)||0,k;for(k=j-1;k>=0;--k){if(parseInt(l[k].otp,10)===-1){return l[k];}}return null;};g=b(f.col)||b(f.row);}return{isSrcTitle:(e.o===undefined),title:g};},getCellLinksInfo:function Y(e,f){if(!f){var b=this.getCellTitleInfo(e);f=b&&b.title;}return A(e,f);},getCellDrillsInfo:function E(e,f){if(!f){var b=this.getCellTitleInfo(e);f=b&&b.title;}return G(e,f);},getLinkDrillAction:function L(b){return this.getActionObject(b);},getAction:function R(b){return this.getActionObject(b);},getActionObject:function I(e){var b=e[0]&&e[0].at,f=null;if(b){if(b&K){f={h:"onLink",a:this.getLinkAction(e[0])};}else{if(b&S){f={h:"onDrill",a:this.getDrillAction(e)};}}}return f;},getSortAction:function D(s,l){var h=this.getCellTitleInfo(s),o=h.title,q=this.data.gts[((s.axis===a)?"row":"col")+"SubPos"],b=[],g=o.axis,j,n,m,p;l=(l===null||l===undefined)?!(s&&s.so):l;if(h.isSrcTitle){j=C;n=o.id;m=o.otp;p=o.fid;}else{j=H;m=4;g=a;q=this.data.gts.rowSubPos;do{var k=s._e;if(k){if(k.oid){n=k.oid;}else{b.push(k.id);}}s=s._p;}while(s);}var i={sortType:j,axis:g,isAsc:l,unitID:n,unitType:m,elementList:b.join("\u001E"),subTotalsPos:q};if(n){i.unitID=n;}if(p){i.formId=p;}var f;if(j===H){f=["","",i.elementList||"",i.axis];}else{f=[i.formId,"21"];}f=[i.unitType,i.unitID].concat(f);i.sortKey=f.join("!");return i;},getPivotAction:function J(q,f){var o=false,s=q.hasOwnProperty("mix"),b=(s)?null:q.axis,p=((s)?q.mix:q.ui)+1,e=(q.otp===-1);if(!isNaN(f)){b=f;p=1;if(s){s=false;e=true;}}else{var j=(f==="u"||f==="l");if(!s){var i=F(this.data.gts,b),h=0,g={},l=false;mstrmojo.array.forEach(i,function(t){if(g[t.id]){g[t.id].frm++;}else{h++;g[t.id]={pos:h,frm:1};if(t.id===q.id){l=true;}else{if(l){return false;}}}});p=g[q.id].pos;var m=q.fix;if(m){if(!j||m>1){if(j||m!==g[q.id].frm){p=m;o=true;}}}}p=p+((j)?-1:1);}var k={pos:p};if(o){k.formID=q.fid;}else{if(!s){k.axis=b;}}if(!e){var n=(s)?q._e:q;if(!o){k.objectType=n.otp;}k.objectId=(s)?n.oid:q.id;}return k;},isPvtButtonVisible:function X(k,f){var h=k.axis,g=F(this.data.gts,h),e=k.hasOwnProperty("mix");if(!isNaN(f)){if(parseInt(f,10)===h){return false;}if(e){return !!g[k.ui]._hid;}return true;}var i=g[k.ui].es,j=k.ui,b=(e)?i.length:g.length;if(b===1){return false;}if(h===((e)?P:a)){if(f==="u"||f==="d"){return false;}}else{if(f==="l"||f==="r"){return false;}}if((e)?k._e===i[0]:j===0){if(f==="l"||f==="u"){return false;}}if(e?k._e===i[b-1]:j===b-1){if(f==="r"||f==="d"){return false;}}return true;},getDrillAction:function B(e){var b=this.getCellTitleInfo(e[0]),g=b.title,f=g.dp[e[0].mix||0];return{srcMsgId:this.data.mid,isWithin:f.within,drillPathKey:f.k,drillPathIndex:f.dpi,drillElements:N.call(this,e)};},getPTitle:function Z(f,e){var b=this.data.gts;return F(b,e)[f.tui];},getPCellParentNode:function M(e,b){return e._p;},getLinkAction:function Q(f,e){var b=this.getCellTitleInfo(f),g=b.title;return this.getLinkActionImpl(f,g,e);},getLinkActionImpl:function U(p,l,n){var f=A(p,l),m=f&&f.links,q=(f.onw)?"_blank":"";if(n===null||n===undefined){n=(f&&f.di)||0;}var i=m&&m[n];if(!i){return null;}var g={linkInfo:i,linkTarget:q};var b=i.url;if(b){var h="&CurrentElement";if(p&&l&&b.indexOf(h)>-1){b=b.replace(h,p._e.id);}g.url=b;}else{var j=i.target,o,e;switch(parseInt(j&&j.t,10)){case 55:if(parseInt(j.st,10)===14081){o=2048001;e="objectID";}else{o=32001;e="documentID";}break;case 3:o=4001;e="reportID";g.reportViewMode=((parseInt(j.st,10)===769)?2:1);break;default:return null;}g.evt=o;g[e]=j.did;g.srcMsgId=this.getMessageId();var k=V.call(this,f,i,p);if(k){g.link=k;}return g;}},getDownloadAction:function T(g,e,i,f,h,b){return{xtabId:h,rowPosition:g,maxRows:e,colPosition:i,maxColumns:f,memo:b};}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func");var F="Metrics",D=2;function B(a){if(!a){return ;}var Y=this.scm,T="\u001E",V=0,S=null,W=null,U=null,X=null,R=null,Z=false;for(S in Y){W=Y[S];U=W.cgb;for(V in U){cgKey=U[V];R=a[cgKey];if(R){if(!W.tks){W.tks=R;Z=true;}else{if(W.tks&&(W.tks.indexOf(R)<0)){W.tks+=T+R;Z=true;}}}}}return Z;}function Q(){var S=this.data,R=S.gts;if(!R){return ;}var T;mstrmojo.array.forEach([R.row,R.col],function(W){for(var V=0,U=W.length;V<U;V++){var X=W[V];if(X.sc){T=T||{};T[X.id||F]=X.sc;if(X.fid){T[X.id+"_"+X.fid]=X.sc;}}}});this.scm=T;B.call(this,this.docModel.getCGBMap());}function I(R,S){var T=this.getDataService();T[R].apply(T,S);}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function P(R){this._super(R);this.docModel.attachEventListener("CGBMapChange",this.id,function(S){});},ondataChange:function E(R){Q.call(this);},getMessageId:function C(){return this.docModel.mid;},getDataService:function H(){return this.docModel.getDataService();},getAction:function M(g,V,Z){var e=g[0],S=e&&e.at;var U;if(S){if(S&D){var T=this.getCellTitleInfo(e),a=T&&T.title,R=a&&a.id,b=this.scm;this.sti={titleId:R||F};var Y=(R&&b[R])||b[F];if(Y){var f=this.xtab,W=(f.allowToggleSelections&&Y.all&&Z),X=(T.isSrcTitle||W);this.sti.deselectCurrent=W;U={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:V,ck:Y.ck,tks:Y.tks,eid:X?"OA:(All)":e._e.id,ctlKey:Y.ckey,sliceId:f.sid,isUConDS:Y.isUConDS}};}}}if(!U){var U=this._super(g);}if(U&&U.a){U.a.sliceId=this.xtab.sid;}return U;},getDownloadAction:function A(U,S,W,T,V,R){var X=this._super(U,S,W,T,V,R);X.sliceId=this.xtab.sid;return X;},getDrillAction:function K(R){var S=this._super(R);S.srcMsgId=this.docModel.mid;return S;},sort:function G(R,S){I.call(this,"sort",arguments);},pivot:function L(R,S){I.call(this,"pivot",arguments);},drillGrid:function O(R,S){I.call(this,"drillGrid",arguments);},downloadGridData:function N(R,S){I.call(this,"downloadGridData",arguments);},loadLayout:function J(R){this.docModel.loadLayout(R);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DropDownList");function D(){var E=new mstrmojo.WaitIcon(),H=function(K){this.controller.onGroupBy(this,{groupbyKey:K.src.k,elementId:K.value},function(L){E.set("visible",L);});};for(var G=0,F=this.data.length;G<F;G++){var I=this.data[G];var J=this.addChildren(new mstrmojo.DropDownList({k:I.k,title:I.unit.target.n+":",idx:I.unit.idx,cssClass:"mstrmojo-DocGroupBy-unit",selectCssClass:"mstrmojo-DocGroupBy-unit-select"}));J.options=I.unit.elms;J.attachEventListener("selectedChange",this.id,H);}this.addChildren(E);}function B(){var H=this.data,G=this.children;if(H.length===G.length-1){for(var F=0,E=H.length;F<E;F++){var I=H[F].unit,J=G[F];J.idx=I.idx;J.options=I.elms;J.refresh();}}}mstrmojo.DocGroupBy=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DocGroupBy",markupString:'<div id="{@id}" class="mstrmojo-DocGroupBy {@cssClass}"><div style="padding-top: 5px;"><span class="mstrmojo-DocGroupBy-title">{@title}</span></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function C(E){this._super(E);this.ondataChange();},ondataChange:function A(){if(!this.data||!this.data.length){return ;}if(!this.hasRendered){D.apply(this);}else{B.apply(this);}},areUnitsSetToAll:function(){var E=true;mstrmojo.array.forEach(this.data,function(F){if(F.unit.elms[F.unit.idx].v!=="u;"){E=false;return false;}});return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._Formattable","mstrmojo._HasToolbar");var B="\u001E";var F=1;var H=2;var I={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3,vert:["height","width","top"],horiz:["width","height","left"],updateStyle:function(K){var N=K.defn.qsm;if(!N){return ;}if(K.getFormats().width){return ;}var O=null;if(N==F){O=K.containerNode.firstChild;}else{O=K.containerNode.lastChild;}if(!O){return ;}var L=O.clientHeight+"px";var J=O.clientWidth+"px";var M=K.domNode.style;M.height=L;M.width=J;if(K.parent.updateStyle){K.parent.updateStyle(L,J);}},repositionChildren:function(P){var O=P.getFormats(),N=parseInt(O.height,10),S=parseInt(O.width,10);var J=P.children,M=J[0].getFormats(),U=J[1].getFormats();var K=(P.defn.gp<this.LEFT),R=(K)?N:S,Q=(K)?S:N,T=this[((K)?"vert":"horiz")];var L=Math.round(R*(P.defn.ga/100));M[T[0]]=L+"px";M[T[1]]=Q+"px";U[T[0]]=(R-L)+"px";U[T[1]]=Q+"px";if((P.defn.gp%2)===0){U[T[2]]=L+"px";}else{M[T[2]]=(R-L)+"px";}this.resizeChildren(J[0],J[1]);},stackChildren:function(J){var M=J.children,N=J.getFormats(),L;for(var K=M.length-1;K>=0;K--){L=M[K].getFormats();L.width=N.width;L.height=N.height;}this.resizeChildren(M[0],M[1]);},resizeChildren:function(L,J){L.renderPortalState();var K=J.getFormats();J.resizeForDisplayState(parseInt(K.height,10),parseInt(K.width,10),true);},changeVisibility:function(L,J){var O=L.children,N=L.defn.qsm,K=J&&(!N||L.viewMode===F),M=J&&(!N||L.viewMode===H);if(O&&O.length>0){if(O[0].visible!==K){O[0].set("visible",K);}if(O[1].visible!==M){O[1].set("visible",M);}}L.visible=J;},setViewMode:function G(K){var L=K.children,M=K.visible;if(K.defn.qsm&&L&&L.length>0){var J=K.viewMode;L[0].set("visible",(J==F)&&M);L[1].set("visible",(J==H)&&M);}},clearFormatCache:function C(K){var M=K.children;for(var L=0,J=M&&M.length||0;L<J;L++){M[L].clearCache();}}};mstrmojo.DocGridGraph=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocGridGraph",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocGridGraph" style="{@domNodeCssText}"><div class="mstrmojo-DocGridGraph-msg"></div><div class="mstrmojo-DocGridGraph-container"></div></div>',markupSlots:{msgNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW","B","background-color","fx","font"]},viewMode:null,visible:true,resize:function D(){this.clearCache();I.clearFormatCache(this);var L=this.getFormats(),J=parseInt(L.width,10),K=parseInt(L.height,10);if(J>0&&K>0){I.changeVisibility(this,true);if(!this.defn.qsm){I.repositionChildren(this);}else{I.stackChildren(this);}}else{I.changeVisibility(this,false);}},postBuildRendering:function A(){this._super();var L=this.node.data.eg;if(L===undefined){this.msgNode.style.display="none";this.containerNode.style.display="block";}else{this.msgNode.innerHTML=L;this.msgNode.style.display="block";this.containerNode.style.display="none";}var K=this.defn.qsm;if(!this.viewMode&&K){this.viewMode=K;}var J=this.node.defn;J.attachEventListener("qsmChange",this.id,function(M){this.viewMode=M.value;I.setViewMode(this);this.model.getDataService().setQuickSwitchViewMode(this.defn.tt+B+this.k,this.viewMode);I.updateStyle(this);});I.setViewMode(this);I.updateStyle(this);if(!K){this.resize();}},getGridWidget:function(){return this.children[0];},getGraphWidget:function(){return this.children[1];},updateGraph:function(K){var J=this.getGraphWidget();if(J){J.update(K);J.refresh();}},quickSwitch:function E(){var J=this.viewMode!=H;this.defn.set("qsm",(J?H:F));return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo._IsPanelStack","mstrmojo._HasBuilder","mstrmojo.array","mstrmojo.css","mstrmojo.Serializer");function E(J,I){var H=mstrmojo.array.find(J.node.data.panels,"k",J.selectedKey);H+=(I||0);J.set("selectedIdx",H);}function F(H){H.set("hasNextPanel",(H.selectedIdx<(H.node.data.panels.length-1)));H.set("hasPreviousPanel",(H.selectedIdx>0));}mstrmojo.DocPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget,mstrmojo._HasBuilder,mstrmojo._IsPanelStack],{scriptClass:"mstrmojo.DocPanelStack",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocPanelStack {@cssClass}" style="{@domNodeCssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","overflow"]},hasNextPanel:false,hasPreviousPanel:false,applyEnabled:false,renderMode:"onshow",init:function G(H){this._super(H);E(this);this.node.sw=(this.node.data.panels.length>1&&this.defn.sw);},addChildren:function D(K,H,I){var N=0,M=K.length;this._super(K,H,I);for(N=0;N<M;N++){var L=K[N],J=(L.k===this.selectedKey);L.selected=L.visible=J;if(J){break;}}return true;},onselectedKeyChange:function C(I){var J=this._super(I),H=J.on;if(H._delayRefresh){if(!H.defn.dirtyKeys){H.refresh();}delete H._delayRefresh;}E(this);},updateSelectedIdx:function B(H){E(this,H);},onselectedIdxChange:function A(){F(this);},_bufferedSlices:null,bufferSlice:function(I){this._bufferedSlices=this._bufferedSlices||{};var H=this._bufferedSlices;if(I.ctlKey){H[I.ctlKey]=I;this.set("applyEnabled",true);}},applyBufferedSlices:function(){var J=this._bufferedSlices;if(!J){return ;}var H=this.model,M=mstrmojo.Serializer,I,N,L,K=[];for(L in J){I=J[L];if("eid" in I){N=[2048084,"mstrWeb.rwb.2048084","selectorKeyContext",I.ck,"elemList",I.eid,"ctlKey",I.ctlKey,"applyNow",false];if(I.include!==null&&I.include!==undefined){N.push("include");N.push(I.include);}if(I.disablePU){N.push("usePartDisplay");N.push(0);N.push("treesToRender");N.push(3);}else{N.push("usePartDisplay");N.push(1);N.push("treesToRender");N.push(2);}}else{if("srct" in I&&I.srct===4){N=[2048132,"mstrWeb.rwb.2048132","unitKeyContext",I.ck,"ctlKey",I.ctlKey,"objectID",I.srcid,"objType",I.srct,"expFunction",I.f,"expFunctionType",I.ft,"applyNow",false,"usePartDisplay",1];if(I.cs){N.push("expConstants");N.push(I.cs);N.push("dataType");N.push(I.dtp);}}else{if(I.unset){N=[2048128,"mstrWeb.rwb.2048128","unitKeyContext",I.ck,"ctlKey",I.ctlKey];}else{N=[2048133,"mstrWeb.rwb.2048133","include",I.include,"ctlKey",I.ctlKey];}}}if(N){K.push(N);}}if(!K.length){return ;}K=M&&M.serializeValueGroup(K);this.clearBuffSlices();H.slice({isMultipleEvents:true,tks:I.tks,events:K});},clearBuffSlices:function(){this._bufferedSlices=null;this.set("applyEnabled",false);},update:function(I){if(this._super){this._super(I);}var H=I.data&&I.data.selKey;if(H&&H!==this.selectedKey){this.defn.newSelKey=H;}},postBuildRendering:function(){this._super();if(this.defn.itb){mstrmojo.css.addClass(this.domNode,"tableControl");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TabStripBase=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TabStripBase",target:null,targetProps:null,isStrip:true,ontargetChange:function A(I){var J=I&&I.valueWas;if(J){var G=this._targetSubs;if(G){J.detachEventListener(G.add);J.detachEventListener(G.rem);J.detachEventListener(G.sel);}this.removeChildren();}var K=this.target;if(K){var E=this.targetProps,D=(E&&E.children)||"children",B=K[D];this.addTabButtons(B,0);var H="attachEventListener",C=this.id,F;if(K[H]){this._targetSubs={add:K[H]("addChild",C,function(L){var M=L&&L.value;if(M&&M.length){this.addTabButtons(M,L.index);}}),rem:K[H]("removeChild",C,function(M){var L=M&&M.value;for(F=((L&&L.length)||0)-1;F>-1;F--){this.removeTabButton(L[F]);}}),sel:K[H]("selectedChange",C,function(L){this.selectionChange(L);})};}}},addTabButtons:mstrmojo.emptyFn,removeTabButton:mstrmojo.emptyFn,selectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout");mstrmojo.OIVMPage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout],{scriptClass:"mstrmojo.OIVMPage",markupString:'<div id="{@id}" class="mstrmojo-OIVMPage {@cssClass}" style="{@cssText}"><div class="mstrmojo-OIVMPage-toolbar"></div><div class="mstrmojo-OIVMPage-layout"></div></div>',markupSlots:{toolbar:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.lastChild;}},onError:function(B){d=B.detail,app=mstrApp,btnHalo="#666",c=B.code;if(c){var A=mstrmojo.Button.newInteractiveButton;switch(c){case -2147468986:case -2147467618:B.btns=[A(mstrmojo.desc(3758,"Re-run Document"),function(){mstrmojo.form.send({evt:2048001,src:app.name+"."+app.pageName+".2048001",documentID:d.dssid,currentViewMedia:1});},btnHalo),A(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.form.send({evt:3010,src:mstrApp.name});},btnHalo)];break;default:B.btns=[A(mstrmojo.desc(212,"Continue"),function(){mstrmojo.form.send({evt:3026,src:app.name+"."+app.pageName+".3026"});},btnHalo)];}}},renderPageLoadError:function(){var A=this.error;this.onError(A);if(!A.btns||!A.btns.length){mstrmojo.alert(A.message,null,A.title);}else{mstrmojo.confirm(A.message,A.btns,A.title);}},render:function(){if(this.error){this.renderPageLoadError();}else{this._super();}},layoutConfig:{h:{toolbar:"30px",layout:"100%"},w:{layout:"100%"}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo.css","mstrmojo.array");var K=mstrmojo.css;var C=2;function N(Q,O,P){var R=Q.parent.parent;if(R&&R instanceof mstrmojo.DocPanel){R[O+"DirtyKey"](P);}}function E(P,O,Q){if(P===O.k){mstrmojo.array.forEach(O.children,function(R){if(R.setDirtyChildren){R.setDirtyChildren(Q);}});}}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,cssDisplay:"block",topStart:C,contentWidth:0,markupString:'<div id="{@id}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="height:100%;width:100%;position:absolute;{@containerNodeCssText}"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx"]},title:"",init:function M(O){this._super(O);if(!this.title){this.title=this.node.defn.ttl||"";}},childRenderCheck:function D(O){return(this._super(O)&&this.selected);},postBuildRendering:function A(){var O=K.addClass;if(!this.defn.l&&!this._forceRender){O(this.domNode,"placeholder");}return this._super();},onselectedChange:function F(O){this.set("visible",!!O.value);if(O.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!O.value});},refresh:function J(){if(!this.hasRendered){return ;}if(!this.selected){if(!this.children){this.builtChildren=false;}this._forceRender=true;this._super();delete this._forceRender;}else{var P=this.children||[],O;for(O=P.length-1;O>=0;O--){P[O].refresh();}if(this._isFP()){this.refreshFP();}}},setDirty:function H(O){var P=((O)?"add":"remove")+"DirtyKey";this[P](this.k);},addDirtyKey:function L(O){var Q=this.defn,P=Q.dirtyKeys||{};P[O]=true;Q.dirtyKeys=P;E(O,this,true);N(this,"add",O);},removeDirtyKey:function G(P){N(this,"remove",P);E(P,this,false);var Q=this.defn,O=Q.dirtyKeys;if(!O){return ;}delete O[P];if(!mstrmojo.hash.isEmpty(O)){return ;}delete Q.dirtyKeys;},renderChildren:function B(){var T=this.children;if(T&&(this._isFP()||this._isFSP())){for(var S=0,O=T&&T.length||0;S<O;S++){T[S].orgPos=S;}T.sort(function(W,Z){var X=(W.getFormats()&&W.getFormats()["z-index"])||0,Y=(Z.getFormats()&&Z.getFormats()["z-index"])||0;return X-Y||W.orgPos-Z.orgPos;});}if(this._isFP()){if(T){var U=this.domNode.clientWidth-2*C;this.topStart=C+1;for(var S=0,O=T&&T.length||0;S<O;S++){var Q=this.domNode.clientWidth-2*C;this.contentWidth=(Q>0)?Q:0;if(Q!=U){this.topStart=C;for(var R=0;R<S;R++){var P=T[R];P.refresh();if(P.getContainerHeight){this.topStart+=P.getContainerHeight()+C;}}}var V=T[S];if(this.childRenderCheck(V)){V.render(null);if(V.getContainerHeight){this.topStart+=V.getContainerHeight()+C;}}}}}else{this._super();}},refreshFP:function(){if(!this.hasRendered){return ;}var R=this.children;this.topStart=C;var P=this.domNode.clientWidth-2*C;this.contentWidth=(P>0)?P:0;for(var Q=0,O=R&&R.length||0;Q<O;Q++){var S=R[Q];if(S.relocate){S.relocate(this.topStart,this.contentWidth);}if(S.getContainerHeight){this.topStart+=S.getContainerHeight()+C;}}},getChildren:function I(){var Q=this.model.getChildren(this.node,false);if(this._isFP()||this._isFSP()){for(var P=0,O=Q&&Q.length||0;P<O;P++){var R=Q[P];if(this._isFP()&&!R.defn.iifp){R.defn.iifp=true;}if(this._isFSP()&&!R.defn.iifs){R.defn.iifs=true;}}}return Q;},_isFP:function(){return this.parent.defn.ifp;},_isFSP:function(){return this.parent.defn.ifsp;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo._HasLayout","mstrmojo._ShowsStatus");function E(J){var I=this.domNode,H=parseInt(this[J.toLowerCase()],10);return(isNaN(H))?I["offset"+J]:H;}mstrmojo.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasScrollbox,mstrmojo._HasLayout,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-DocLayoutViewer {@cssClass}" style="{@domNodeCssText}"><div></div><div><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_fh"></div><div id="{@id}_scrollboxNode" class="mstrmojo-DocLayoutViewer-layout" style="{@_scrollCssText}"></div><div id="{@id}_ff"></div></div><div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}}},markupSlots:{groupBy:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.childNodes[1].childNodes[2];},scrollboxNode:function(){return this.domNode.childNodes[1].childNodes[2];},containerNode:function(){return this.domNode.childNodes[1].childNodes[2];},incFetchNode:function(){return this.domNode.lastChild;},fixedHeaderNode:function(){return this.domNode.childNodes[1].childNodes[1];},fixedFooterNode:function(){return this.domNode.childNodes[1].childNodes[3];},_STATUS:function(){return this.domNode.childNodes[1].firstChild;},_STATUS_TXT:function(){return this.domNode.childNodes[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;}},layoutConfig:{h:{groupBy:"auto",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"auto"},w:{layout:"100%"}},scrollboxHeightFixed:true,scrollboxWidthFixed:true,getHeight:function G(){return E.call(this,"Height");},getWidth:function B(){return E.call(this,"Width");},afterLayout:function A(){this._super();this.notifyScrollListeners();},preBuildRendering:function D(){if(this.parent){var J=this.parent[this.slot].style,I=this.height,H=this.width;this.height=(I!=="auto")?I:J.height;this.width=(H!=="auto")?H:J.width;}this.zf=this.model.zf;this.bs=this.model.bs;return this._super?this._super():true;},setSlotDimensions:function F(J,I,H){if(J==="layout"){this.scrollboxHeight=parseInt(I,10);this.scrollboxWidth=parseInt(H,10);}this._super(J,I,H);},onaddChild:function C(H){if(!isNaN(H.index)){var I=this.children[H.index];if(I&&I.slot==="groupBy"){this.docGroupBy=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Container","mstrmojo._Formattable","mstrmojo.EnumRWUnitType");var HTML_CONTAINER=mstrmojo.EnumRWUnitType.HTMLCONTAINER;mstrmojo.DocTextfield=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocTextfield",markupString:'<div id="{@id}" class="mstrmojo-DocTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@v}</div>{@buttonNodeMarkup}</div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","P","background-color","fx","text-align","white-space","overflow"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function update(node){var d=node.data,v=d.v||"";if(node.defn.t===HTML_CONTAINER){var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value;div=null;}this.v=v;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.set("visible",!node.data.hidden);if(this._super){this._super(node);}},postBuildRendering:function postBuildRendering(){var $D=mstrmojo.dom,f=this.getFormats(),rotateValue=f.fx&&f.fx.rt,i,len;if(rotateValue&&!$D.isIE&&$D.supports($D.cssFeatures.TEXT_ROTATION)){var dn=this.domNode;switch(rotateValue){case 1:dn.style.left=(parseInt(f.left,10)+dn.offsetHeight)+"px";break;case 3:dn.style.top=(parseInt(f.top,10)+dn.offsetWidth)+"px";break;}}if(this.defn.t===HTML_CONTAINER){var scripts=this.domNode.getElementsByTagName("script");for(i=0,len=scripts.length;i<len;i++){eval(scripts[i].innerHTML);}}return this._super();},getAnchor:function getAnchor(){return this.valueNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren","mstrmojo._CanRenderDocOnScroll","mstrmojo.dom");mstrmojo.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren,mstrmojo._CanRenderDocOnScroll],{scriptClass:"mstrmojo.DocLayout",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},popupNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["B","background-color","D","min-height","width"]},alias:"docLayout",markupMethods:{onminHeightChange:function(){var N=this.minHeight;if(!N){var M=this.getFormats();N=M&&M["min-height"];}if(N){this.containerNode.style[mstrmojo.css.MINHEIGHT]=N;}}},getHeight:function E(){var M=0;mstrmojo.array.forEach(this.children,function(N){M+=N.height();});return M||this.containerNode.offsetHeight;},getWidth:function I(){var M=this.children;return(M&&M.length)?M[0].width():this.containerNode.offsetWidth;},preBuildRendering:function K(){var M=this.getFormats();if(M&&M["min-width"]!==undefined){M.width=M["min-width"];}this._super();},renderChildren:function L(){this._super();this.resizeOrReposition();},resizeOrReposition:function D(){var O=this.containerNode;if(!!this.defn.aw){var U=this.model.getAutoWidthIDs(),S=(U&&U.length)||0,Y=0,X=mstrmojo.all,P;if(!S){return ;}for(P=0;P<S;P++){Y=Math.max(this._getWidgetRightMostPosition(X[U[P]]),Y);}Y=Math.max(this.getLayoutMinWidth(),Y);if(Y>parseInt(this.getFormats().width,10)){O.style.width=Y+"px";}}var W=this.model.zt;if(mstrApp.isMobile&&W){var M=this.parent.domNode;if(M){var Q=this.model.controller,N=!!Q.orientation,Z=0,V=this.parent,R=V.getHeight()-V.fixedHeaderNode.clientHeight-V.fixedFooterNode.clientHeight;if(W===2){if(!Q.toolBarDelegated){R-=Q.getBottomToolBarHeight();}Z=Math.round(N?Math.max((R-this.getHeight()),0)/2:0)+"px";}O.style.margin=Z+" auto";var T=this;window.setTimeout(function(){Q.nudgeWidget(T.id,{left:O.offsetLeft,top:O.offsetTop});},0);}}},getLayoutMinWidth:function F(){return 0;},_getWidgetRightMostPosition:function F(M){return parseInt(M.getFormats().left,10)+(M.getDim&&M.getDim().w||M.domNode.offsetWidth);},renderCtrlsInViewport:function C(){this._super();this.resizeOrReposition();},adjustAutoWidth:function H(M){if(!this.defn.aw||!M){return ;}var O=this.containerNode.style,N=parseInt(O.width,10)||0;var P=this;window.setTimeout(function(){var Q=P._getWidgetRightMostPosition(M);if(Q>N){O.width=Q+"px";}},1);},_getModelChildNodes:function B(P,O,S,N,R){var Q=this.model.getNonFixedSections(P,O);var M=Q.length;N=isNaN(N)?M:N;S=S||0;if(S>0||N<M){Q=Q.slice(S,S+N);}return R?{nodes:Q,total:M}:Q;},getChildren:function G(O,N,Q,M,P){return this._getModelChildNodes(O||this.node,N||false,Q,M,P);},getCaptureDimensions:function J(){var N=this.domNode,M={};if(!this.domNode){return ;}M=mstrmojo.dom.position(N);M.w=Math.min(N.offsetWidth,M.w);M.h=Math.min(N.offsetHeight,M.h);return M;},preserveChildDomOrder:false,postBuildRendering:function A(){if(window.mstrMobileApp!==undefined){this.defn.lastOrientation=mstrMobileApp.getOrientation();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._CanGrowOrShrink","mstrmojo.boxmodel");mstrmojo.DocSubsection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._CanGrowOrShrink],{scriptClass:"mstrmojo.DocSubsection",markupString:'<div id="{@id}" class="mstrmojo-DocSubsection" style="{@domNodeCssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},formatHandlers:{domNode:["D","B","background-color","fx"]},update:function G(H){if(this.thresholdId||H.data.tid){delete this.fmts;}this.thresholdId=H.data.tid;if(this._super){this._super(H);}},postBuildRendering:function E(){var L=this.defn;if(L.hc||L.vc){var H=this.domNode,K=this.getFormats(),M=this.id,J=K.height,I=K.width;L.attachEventListener("resized",M,function(){if("height" in K){H.style.height=K.height;}if("width" in K){H.style.width=K.width;}});L.attachEventListener("adjustSize",M,function(P){var O=H.style,N=O.height;if(L.hc&&O.width!==I){O.width=I;}if(L.vc&&O.height!==J){O.height=J;}this.performCanGrowCanShrink(this.children);P.heightReduced=(parseInt(N,10)>parseInt(O.height,10));});}return(this.renderMode!=="scroll")?this._super():true;},childRenderOnAddCheck:function C(H){return(this.renderMode!=="scroll")?this._super(H):false;},onchildRenderingChange:function B(J){this._super(J);if(this.renderMode!=="scroll"){var H=this.parent.slot,I=H==="fixedHeaderNode"||H==="fixedFooterNode";this.performCanGrowCanShrink([(J&&J.src)||J],I);}},portalMaximized:function D(){var K=this.defn,L=K.vc,I=K.hc;if(!I&&!L){return{};}delete K.vc;delete K.hc;delete K.ck;var J=this.getFormats(),H=this.model,P=this.domNode,M=this;var N={HideIfEmpty:-1};var O=function(T,R,S){var U=T.toLowerCase(),Q=parseInt(P.style[U],10);R=((R===undefined)?Q:Math.max(parseInt(R,10),Q))+"px";if(J[U]!==R){J[U]=R;N[T]=mstrmojo.boxmodel.px2Inches(H,R);delete M["_fixed"+T];}S=S||"";N["Max"+T]=0;N["CanGrow"+S]=0;N["CanShrink"+S]=0;};if(L){O("Height",J.normHeight);}if(I){O("Width",J.normWidth,"Horizontal");}K.raiseEvent({name:"resized"});return N;},adjustSectionSize:function A(){var H=this.defn;if(H.vc||H.hc){return H.raiseEvent({name:"adjustSize"});}return null;},refresh:function F(){if(!this.hasRendered){return ;}var I=this.children||[];for(var H=I.length-1;H>=0;H--){I[H].refresh&&I[H].refresh();}},preserveChildDomOrder:false});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable");mstrmojo.DocImage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocImage",markupString:'<div id="{@id}" class="mstrmojo-DocImage" title="{@tooltip}" style="{@domNodeCssText}"><div style="{@shadowNodeCssText}"><img src="{@v}" style="{@imgNodeCssText}" mstrAttach:click></div>{@buttonNodeMarkup}</div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function C(E){var F=this.model.getDataService(),D=E.data.v;this.v=(F&&F.getDocImage&&F.getDocImage(D))||D;if(this.thresholdId||E.data.tid){delete this.fmts;}this.thresholdId=E.data.tid;this.set("visible",!E.data.hidden);if(this._super){this._super(E);}},formatHandlers:{domNode:["left","top","z-index"],shadowNode:["width","height","B","fx"],imgNode:["height","width"]},preBuildRendering:function B(){if(this._super){this._super();}if(!mstrmojo.dom.isIE7){var D=this.getFormats(),F=(D.fx&&D.fx.ds)||0,E=mstrmojo._Formattable.getBorderWidths(this);this.domNodeCssText+="width:"+((parseInt(D.width,10)||0)+F+E.w)+"px; height: "+((parseInt(D.height,10)||0)+F+E.h)+"px;";}},getAnchor:function A(){return this.imgNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(E,D){if(!A){var F=this.itemField;A=this._super(E).replace(">{@n}<",' title="{@'+F+'}">{@'+F+"}<");}return A;},getItemProps:function C(F,D){var E=this._super(F,D),G=this.itemField;E[G]=F[G];return E;},onclick:function B(D){this._super(D);var E=this.parent,G=E.opener;G.suggestionShown=false;var F=this.selectedItem;if(F){G.handleSuggestionItemSelect(F);}E.close();},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems"}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.MenuItem=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.MenuItem",markupString:'<div id="{@id}" class="mstrmojo-MenuItem {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-MenuItem-text"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.date","mstrmojo.dom","mstrmojo.Calendar");var B=mstrmojo.date,C=mstrmojo.dom,A=function(){return mstrmojo.locales.datetime;},D=mstrmojo.array;function G(H){return H.year+"_"+H.month+"_"+H.day;}function F(I,K,H){var L=I.e,J=C.eventTarget(I.hWin,L);if(C.contains(K.dayView,J,false,K.domNode)||C.contains(K.monthView,J,false,K.domNode)||C.contains(K.yearView,J,false,K.domNode)){J=J.tagName.toUpperCase()=="TD"?J:J.parentNode;if(J&&J.tagName.toUpperCase()=="TD"){J.style.borderColor=H?K.rollColor:"transparent";}}}mstrmojo.VisCalendar=mstrmojo.declare(mstrmojo.Calendar,null,{scriptClass:"mstrmojo.VisCalendar",cssClass:"mstrmojo-visCalendar",availableDates:null,rollColor:"",monthNames:function(H){return A().MONTHNAME_FULL[H];},yearViewSize:4,isDateDisabled:function(I,L,J){var K=this._super(I,L,J),H=this.availableDates;if(!K&&H){K=!H[J+"_"+L+"_"+I];}return K;},premouseover:function(H){F(H,this,true);},premouseout:function(H){F(H,this,false);},adjustYearStart:function(){if(!this.yearRangStart){this._super();}},updateSelectedDate:function E(){var H=this.value,I=this.timeVal,K=this.selectedDates,J,L=function(N,M){N.set("browseYear",M.year);N.set("browseMonth",M.month);N.updateTimePart();N.updateView(N.currentView);};if(K.length===0){J=(this.availableDates&&this.availableDates.length>0)?this.availableDates.max:B.getDateJson(new Date());if(this.isDateDisabled(J.day,J.month,J.year,this.min,this.max)){if(this.min&&B.compareDate(J,this.min)<0){J=parseDateAndTimeToJSON(this.min);}else{if(this.max&&B.compareDate(J,this.max)>0){J=parseDateAndTimeToJSON(this.max);}}}L(this,J);}else{J=K[0];D.forEach(K,function(M){if(B.compareDate(J,M)<=0){J=M;}});L(this,J);}},onselect:function(P){var M=this.selectedDates,I=this.availableDates,J=this.container,L=J.docModel,K=J.model,O=J.dfm&&J.dfm.sc,N=[];if(O){D.forEach(M,function(R){var Q=I[G(R)];if(Q){N.push(Q);}});if(!N.length){N[0]="u;";}if(window.microstrategy&&window.microstrategy.findBone){var H=microstrategy.findBone(J.domNode);if(H&&H.makeSelections){H.makeSelections([{attId:J.dfm.id,values:N}]);}}else{if(L&&L.slice){L.slice({ck:O.ck,eid:N.join("\u001E"),src:K.k,tks:O.tks,ctlKey:O.ckey,include:true});}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.ImageToggle","mstrmojo._IsInputControl");mstrmojo.ToggleDIC=mstrmojo.declare(mstrmojo.ImageToggle,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ToggleDIC",init:function(A){this._super(A);this.unset=this.dic.ust;},focus:function(){this.domNode.focus();},onvalueChange:function(){},onblur:function(B){var A=B.e||B,C=this.domNode,D=mstrmojo.boxmodel.offset(C,document.body);if(A.clientX>D.left&&A.clientX<D.left+C.offsetWidth&&A.clientY>D.top&&A.clientY<D.top+C.offsetHeight){this.domNode.focus();}else{this.applyChanges();}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var A=this.openerStyle;this.width=A.iw;this.height=A.ih;this.set("imageList",this.dic.vls);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.GridBase");var V=mstrmojo.css,M=mstrmojo.color;function C(b,e){var f=b&&b.parent;while(f&&f.scriptClass.indexOf("DocPanelStack")===-1){if(e in f){return f;}f=f.parent;}return null;}function B(e){var b=document.createElement("img");e.appendChild(b);e.removeChild(b);}function E(b,e){var f=Math.floor(b/e.rowsPerPage),h=b%e.rowsPerPage,g=e.tableNode.tBodies[f];r=g.rows[h].cells;return r;}function H(){var b=this._renderTimer;if(b){self.clearInterval(b);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:15,defaultRowsPerPage:100,minRowsPerPage:50,init:function G(b){this._super(b);this.forceFixedSizes=true;},initPageSettings:function N(){var e=this.parent,b=this.defaultRowsPerPage;this.effectiveRh=this.rh||this.rhMin||1;if(e&&e.numRowFixed){b=this.cp.getAvailableRowsCount();}else{if(e&&e.scrollboxHeightFixed){b=Math.ceil(e.scrollboxHeight/this.effectiveRh);b=Math.max(b,this.minRowsPerPage);}}this.pageStatus=[];this.rowsPerPage=b;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function X(h){var g=this.rowsPerPage;this.totalPages=g&&Math.ceil(this.cp.rc/g)||0;h=h||this.pageStatus;for(var e=0;e<this.totalPages;++e){var j=e*g,f=j+g-1,b=this.cp.isDataAvailable(j,f);if(!h[e]){h[e]={};}h[e].onDemand=!b;}},buildRendering:function F(i){if(this.renderMode=="vscroll"){this.initPageSettings();var h=this.pageStatus[0],b=h&&h.onDemand;this.start=0;this.end=-1;if(!b){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!b);}this._super();if(this.renderMode=="vscroll"){var g=this.parent,f=this,j=function(){f.gridContainerNode.style[mstrmojo.css.MINHEIGHT]=(f.cp.rc*f.effectiveRh)+"px";};if(mstrmojo.dom.isIE7){this.gridContainerNode.style.zoom="1";window.setTimeout(j,10);}else{j();}if(!this.connectedScrollbox){if(g&&g.connectScrollbox){g.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!b);this.postRenderPages();var e=g&&!g.scrollboxHeightFixed&&!g.numRowFixed;if(e&&this.numPagesRendered>=this.totalPages&&!b){this.postRenderingCleanup();}else{if(b||e){this.onscroll();}}}else{this.configureActions();}},preRenderPages:function Q(){},postRenderPages:function Z(){this.configureActions();},configureActions:function L(){var b=this.parent;if(b&&b.configureActions){b.configureActions();}},preRenderPage:function O(b,e){this.pageNum=b;},postRenderPage:function J(e,g,h){if(e+1>this.numPagesRendered){this.numPagesRendered=e+1;}var b=this.pageStatus,f=b[e];if(!f){f=b[e]={};}if(g){f.filled=true;f.dirty=false;}var i=this.gridContainerNode.style;if(e==this.totalPages-1&&i){i[mstrmojo.css.MINHEIGHT]="";}},invalidAllPages:function(){for(var b=0;b<this.totalPages;++b){var e=this.pageStatus[b];if(e.filled){e.dirty=true;}e.onDemand=true;e.filled=false;e.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function a(){var b=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var g=mstrmojo.all[b];if(!g){return ;}var e=g.getPagesToRender();if(e.length>0){g.preRenderPages();g.renderPages(e);g.postRenderPages();g._postPagesClearup=true;}else{if(g._postPagesClearup){g.postRenderPagesCleanup();g._postPagesClearup=false;}H.call(g);if(g.isRenderingComplete()){g.postRenderingCleanup();}}}catch(f){H.call(mstrmojo.all[b]);throw f;}},this.renderPause);},onscroll:function Y(b){if(!this.renderingRows){if(b===true){var e=this.parent;if(e&&e.maskNode){V.addClass(e.maskNode,"wait");}}this._startPageRenderThread();}},isRenderingComplete:function P(){if(this.end>=this.cp.rc-1){for(var b=this.pageStatus,e=this.totalPages-1;e>-1;e--){if(!b[e]||!b[e].filled){return false;}}return true;}return false;},renderPages:function D(e){for(var f=0,b=e.length;f<b;++f){this.renderPage(e[f].idx,e[f].fill);}},renderPage:function W(j,e){var m=this.pageStatus,g=(this.numPagesRendered>=j+1);if(g){if(!e||(m[j]&&m[j].filled)){return ;}}var l=this.rowsPerPage,h=this.domNode;this.start=j*l;this.end=Math.min(this.start+l,this.cp.rc)-1;this.preRenderPage(j,e);var b=this.tempTable;if(!b){b=this.tempTable=h.ownerDocument.createElement("div");}var i=e?this.buildTableRowsMarkup(this.start,this.end,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>").join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(this.effectiveRh*(this.end-this.start+1))+'px">&nbsp;</td></tr></tbody></table>';b.innerHTML=i;var f=b.firstChild.tBodies[0],k=this.tableNode;if(!g){k.appendChild(f);}else{k.replaceChild(f,k.tBodies[j]);}this.postRenderPage(j,e,f);},getPagesToRender:function S(){var s=[],x=this.parent,AI=this._defaultPageHeight,h=null,AJ=this.pageStatus,AK=this;function o(i){var j=AJ[i];if(j&&(j.filled||j.dirty)){if(!j.height){if(!h){h=AK.tableNode.tBodies;}j.height=h[i].offsetHeight;}return j.height;}else{return AI;}}var l=0,k=null,t=null,e=x.scrollboxTop;for(var AE=0,AF=this.totalPages,b=this.pageStatus;AE<AF;AE++){l+=o(AE);if(l>=e){k=AE;break;}}if(k===null){k=t=AF-1;}else{var w=x.scrollboxBottom;if(isNaN(w)&&x.numRowFixed){w=e;}for(var AC=k+1;AC<AF;AC++){if(l>w){t=AC-1;break;}l+=o(AC);}}if(t===null){t=AF-1;}for(var z=this.numPagesRendered;z<k;++z){s.push({idx:z,fill:false});}var AD=this.pageStatus,AB=0,AG=this.rowsPerPage,q=false;for(var AA=k;AA<=t;++AA){var AH=AJ[AA];if(!AH||!AH.filled){if(AH&&AH.onDemand){q=true;if(!AH.isDownloading&&!this.isDownloading){AB+=AG;AH.isDownloading=true;this.isDownloading=true;var g=AA*AG,f=g+AG-1;this.cp.download(g,f);}s.push({idx:AA,fill:false});}else{s.push({idx:AA,fill:true});}}}if(q){this.parent.showDownloadStatus(AB);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return s;},addHilitePosition:function(e,g,b){var h=this.hiliteCellsMap[e];if(!h){this.hiliteCellsMap[e]={pos:[],nodes:[]};}var f=g-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[e].pos.push({row:f,cell:b,page:this.pageNum});},setHilites:function(g,h){var j=h.getAttribute("ei"),k=this.eiMap[j],b=this.getNodesByPositions(k);if(!b.length){this._super(g,h);return ;}for(var f=0,e=b.length;f<e;f++){this._super(g,b[f]);}},addExtraInfoMap:function(e,f,b){if(!this.eiMap[e]){this.eiMap[e]=[];}this.eiMap[e].push(this.getPosObj(f,b));},addPositionMap:function(e,f,b){if(!this.posMap[e]){this.posMap[e]=this.getPosObj(f,b);}},addTitleHeaderPositionMap:function(f,b,e){var g=this.getPosObj(f,b);g.obj=e;this.thPosMap.push(g);},getPosObj:function(b,e){return{row:b-this.pageNum*this.rowsPerPage,cell:e,page:this.pageNum};},getNodeByPosition:function(b){return this.tableNode.tBodies[b.page].rows[b.row].cells[b.cell];},getRowIdxByCell:function(b){var e=this.posMap[b._ei];return e.page*this.rowsPerPage+e.row;},getNodesByPositions:function(k){var b=[];for(var f in k){var e=k[f],h=(e&&e.page)||0,g=e&&e.row,j=e&&e.cell;b.push(this.tableNode.tBodies[h].rows[g].cells[j]);}return b;},getPageHeight:function R(b){var e=this.tableNode.tBodies;return(e&&e[b]&&e[b].offsetHeight)||0;},getTargetCell:function(m,l){var g=0,e=0;for(var k=this.totalPages;e<k;e++){g+=this.getPageHeight(e);if(l<=g){break;}}var f=this.tableNode.tBodies[e];if(f){for(var e=0,k=f.rows.length;e<k;e++){var p=f.rows[e];for(var b=0,o=p.cells.length;b<o;b++){var n=p.cells[b];if(n.offsetTop+n.offsetHeight>=l){if(m>=n.offsetLeft&&m<=n.offsetLeft+n.offsetWidth){return n;}}else{break;}}}}},postRenderPagesCleanup:function I(){var f=this.parent;if(f&&f.gridData&&f.gridData.afc){var e=this.tableNode;if(e&&(this.lastWidth!=e.offsetWidth)){if(f.onGridWidthChanged){f.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(g){delete g.height;});this.lastWidth=e.offsetWidth;}var b=C(f,"adjustAutoWidth");if(b){b.adjustAutoWidth(f);}}if(f.gridPagesRendered){f.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(f&&f.maskNode){V.removeClass(f.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function K(){var m=this.cp.getUpdatedRows(),h=this,l,b,k,n,f,g,j,e=[];if(m){mstrmojo.hash.forEach(m,function(o,i){j=parseInt(i,10);l=h.cp.getRowCells(j);b=E(j,h);k=b.length;n=l.length-1;if(n>=0){for(f=k-1;f>=0;f--){g=b[f];if(n<0){break;}if(l[f]._d){var q=g.style.backgroundColor,p=g.style.color;e.push({dom:g,bgcolor:q,ftcolor:p});g.style.backgroundColor=M.getHighlightColor(M.rgbStr2rgb(mstrmojo.css.getStyleValue(g,"backgroundColor"),true));g.style.color=M.getContrastingColor(M.rgbStr2hex(mstrmojo.css.getStyleValue(g,"backgroundColor")),["#ffffff","#000000"]);delete l[f]._d;}n--;}}});if(e.length>0){window.setTimeout(function(){mstrmojo.array.forEach(e,function(i){i.dom.style.backgroundColor=i.bgcolor;i.dom.style.color=i.ftcolor;});},300);}}},getRowInfoByPosition:function(b){return this.cp.getRowCellInfo(b);},postRenderingCleanup:function A(){var b=this.parent;if(b&&this.connectedScrollbox){b.disconnectScrollbox(this);}this.connectedScrollbox=false;if(b&&!b.scrollboxHeightFixed){var e=C(b,"performCanGrowCanShrink");if(e){e.performCanGrowCanShrink([b],true);}}},unrender:function U(b){H.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this._super(b);},dataDownloaded:function T(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function I(J){mstrmojo.hash.copy(J,this);},initContent:function D(L){this.startIndexInContainer=L||this.startIndexInContainer||0;var K=this.base.show,J=this.base.items;this.rc=K&&J?J.length:0;this.colWidths=K&&this.base.cws||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function B(K,J){return !this.invalidData;},download:function A(K,J){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function C(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function H(){return this.rc;},getUpdatedRows:function G(){return this.updatedRows;},getRowCells:function(U){var N=this.base.items,V=N[U],O=V.items,X=this.lookupBase,Q=this.interactiveCellsArray,W=this.gridData.css,a=null,Z=false,h,P,S,M;if(this.oldGridData){h=this.oldGridData;P=this.oldBase;S=P&&P.items;M=S[U]&&S[U].items;}for(var R=0,Y=O&&O.length||0;R<Y;R++){var L=O[R];if(L){L.v=L.v||L.n;if(X&&!L._e){var T=X[L.tui];a=T&&T.es[L.idx];if(a){L.v=L.v||a.n;if(a.rv){L.rv=a.rv;}L._e=a;}}if(!L.css){L.css=W[L.cni].n;}if(!L._d&&M&&this.preServeUpdatedRows){var K=M[R];if(!K||(K.rs!==L.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((K.v&&L.v!==K.v)){data={};if(L.v!==K.v){data.v=K.v;}if(L.css!==K.css){data.css=K.css;}L._d=data;this.updatedRows[this.startIndexInContainer+U]=true;}}}L._gd=this.gridData._bidx||0;if(L.at>0&&Q){if(L._ei===undefined||Q[L._ei]!==L){L._ei=Q.push(L)-1;}}if(this.axis){L.axis=this.axis;}var b=L.pi;if(b){if(b.ri!==undefined&&b.ci!==undefined){L._p=N[b.ri].items[b.ci];}else{var g=this.gridData.ghs,f=b.left,J=b.top;if(f){L._lp=g.rhs.items[f.ri].items[f.ci];}if(J){L._tp=g.chs.items[J.ri].items[J.ci];}}}}}return O;},getUnmergedCells:function F(O){var Q=[],R=this.base.items,L=this.gridData.css,P=R[O].items[0],K=P&&P.pi,J=K&&K.ri,N=K&&K.ci;while(K&&J>-1&&N>-1){P=P._p||R[J].items[N];var M={};mstrmojo.hash.copy(P,M);if(!M.css){M.css=L[M.cni].n;}M.rs=P.rs-O+J;Q.splice(0,0,M);K=P&&P.pi;J=K&&K.ri;N=K&&K.ci;}return Q;}});})();(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];for(var J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getRowCells(I);},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K);for(var I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0;for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){for(var I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={};for(var J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(K.getUpdatedRows(),I);}}this.updatedRows=I;return I;},download:function B(M,L){var K=this._getCPs(M,L);for(var I=0;I<K.length;++I){var J=K[I];J.download(M,L);}}});})();(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];for(var I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowCells:function(I){var M=this.cps,J=[];for(var L=0,H=M.length;L<H;L++){if(M[L].getAvailableRowsCount()>0&&M[L].rc>I){var K=M[L].getRowCells(I);if(K){J=J.concat(K);}}}return J;},getRowHeight:function C(){return this.cps[0].getRowHeight();},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={};for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(J.getUpdatedRows(),H);}}this.updatedRows=H;return H;},download:function B(J,H){var I=this.cps[1];I.download(J,H);}});})();(function(){mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function E(G){this._super(G);},download:function A(H,G){},initContent:function D(N){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var H=this.gridData.gts,X=(this.gridData.lhv!==0),J=H.row||[],G=H.col||[],P=H.show,M=H.rec,V=this.cts||[],U=J.length,O=V.length,R=this.gridData.css;this.base={items:[]};this.rc=P&&V.length||0;if(this.rc===0&&P){this.rc=U>0?1:0;}this.colWidths=P&&H.cws||[];if(!this.rc){return ;}var L={items:[]},I=1,Q,T;for(T=0;T<U;++T){J[T].axis=1;J[T].ui=T;L.items.push(J[T]);}if(O>0){V[0].axis=2;V[0].ui=0;G[0].axis=2;G[0].ui=0;I=V[0].rs||1;if(X&&I>1){V[0].rs=1;Q=mstrmojo.hash.clone(V[0],{});Q.n="&nbsp;";V[0].cni=R.push({n:(R[V[0].cni].n||"")+" fsbp_1"})-1;}L.items.push(V[0]);}var K=this.base.items;K.push(L);for(T=1;T<O;++T){if(I>1){var S=I;while(S-->1){if(X){var W=mstrmojo.hash.clone(Q,{});W.cni=R.push({n:(R[W.cni].n||"")+" fsbp_"+((S==1)?"3":"2")})-1;K.push({items:[W]});}else{K.push({items:[]});}}}V[T].axis=2;V[T].ui=T;G[T].axis=2;G[T].ui=T;I=V[T].rs||1;if(X&&I>1){V[T].rs=1;Q=mstrmojo.hash.clone(V[T],{});Q.n="&nbsp;";V[T].cni=R.push({n:(R[V[T].cni].n||"")+" fsbp_1"})-1;}K.push({items:[V[T]]});}this.rc=K.length;if(M){this._removeExtraColumn(J,V);}},getAvailableRowsCount:function C(){return this.rc;},isDataAvailable:function B(H,G){return true;},_removeExtraColumn:function F(J,Z){var X=J&&J.length,O=Z&&Z.length,G=this.gridData.gts,R=G.row||[],M=G.col||[],H=R.length,V=M.length;if(!X||!O){if(O===1){var a=Z[O-1];if(a.otp==-1){if(V>0){M[V-1]._hid=true;}this.base.items=[];this.rc=0;}}return ;}var I=J[X-1],S=this.rc,K=this.base.items;if(I){if(I.otp==-1){if(H>0){R[H-1]._hid=true;}K[0].items.splice(X-1,1);}else{var P=S>1?S-1:0,Q=K[P],Y=Q.items.length;if(Y>0&&V>0){M[V-1]._hid=true;}var L=I.fix;if(L){for(var W=0;W<L;W++){Q.items[Y-1+W]=J[X-L+W];}}else{Q.items[Y-1]=I;}for(var U=0,T=O-1;U<T;U++){Z[U].cs=L?L:I.cs;}var N=L?L:1;K[0].items.splice(X-N,N);}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var Y=1,b=2,m=4,U=8,f=1,g=2,F=3,l=4,S=5,K=6,i=7,D={},X={120:0.75,240:1,320:1.5},k={1:30,2:26,3:20,4:70,5:40,6:34,7:40},H=4,P=1,I={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},R=mstrmojo.hash,T=mstrmojo.array;function W(s,p){var q=s[0],n=p.gts,o=n.cws.length;return(p.vp.gr==="1"&&(o>1));}function h(o,w){var s=function(x,z){if(z&&x&&x.css&&x.css.indexOf(z)<0){x.css+=" "+z;}};var q=w.type,p=w.col,t=(p&&p.cl)||0,n=(q===b||q===Y);if(q===b||q===U){s(o,I.RIGHT_ALIGN);}else{if(q===Y||q===m){s(o,I.LEFT_ALIGN);}}if(n){if(p&&p.tg&&t>1){if(!o._v){o._v=o.v;o.v="<span class='toggleHeader'>"+o.v+"</span>";}}s(o,I.TITLE);}T.forEach(w.extraCss,function(x){s(o,x);});}function A(n){return 0;}function j(s){var p,q=s.cg,n=q&&q.cgc,o=1;for(p=0;p<n;p++){if(q&&q[p]&&!q[p].tg&&q[p].cl>o){o=q[p].cl;}}return o;}function L(o,n){var p=l;if(n>1){if(o===0){p=f;}else{if(o===n-1){p=F;}else{p=g;}}}return p;}function J(n,s,p,o){var w=o&&o.cols&&o.cols.cg,q,x=0,t=0;if(w){for(q=0;q<s;q++){if(n[q]){x+=n[q].length;}}x+=(p+1);for(q=0;q<w.cgc;q++){t+=w[q].cl;if(t>=x){return q;}}}return -1;}function N(x,q,o,n){var w=[],t,p,s,z;for(p=0,s=x.length;p<s;p++){if(x[p].length===1){t=x[p][0];t.rowType=(t.rowType!==i)?L(q,o):i;t.singleStack=(o>1);t=R.copy(t);if(t.ts===H){if(o===1){t.rowType=l;t.colIdx=J(x,p,q,n);}else{if(!q){t.colIdx=J(x,p,q,n);}else{delete t.ts;t.v="";}}}else{if(q){t.v="";}}}else{t=x[p][q];if(!t){z=x[p].length;t=R.copy(x[p][z-1],{});t.v="";if(t.hasOwnProperty("ts")){delete t.ts;}}else{if(t.ts===H){t.colIdx=J(x,p,q,n);}}t.rowType=(t.rowType!==i)?L(q,o):i;}w.push(t);}return w;}function O(n){if(n===0){return 0;}var o=this.sectionMap[n-1]||0;return Math.floor((n-o)/this.stackLevels);}function C(x){var t,w,q=this.sectionInfo,n=q.length,p=this.srh,o=this.lastSectionIndex;w=q[o];if(x>=w.rs&&x<(w.rs+p)){return w;}if(x<w.rs){t=o-1;if(t<=0){this.lastSectionIndex=0;return null;}do{w=q[t];if(x>w.rs&&x<=(w.rs+p)){this.lastSectionIndex=t;return w;}}while(x<w.rs&&--t>0);this.lastSectionIndex=t;return w;}else{t=o+1;if(t>=n){this.lastSectionIndex=n-1;return null;}do{w=q[t];if(x>w.rs&&x<=(w.rs+p)){this.lastSectionIndex=t;return w;}}while(x>(w.rs+p)&&++t<n);this.lastSectionIndex=t-1;return null;}}function a(z,p,n,x){var w=z[0],s,t=z.length,o=w&&w.rowType,q={v:"",css:"empty-igcell",rowType:o};if(n!==undefined&&w&&(o===f||o===l||o===S)){q={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+x+"px;top:-"+(0.5*D[o])+'px;"></div></div>',css:"IG-ActionArrow",_ei:n};}for(s=t-1;s>=t-p;s--){w=z&&z[s];if(w){w.css+=" IG-lastdatacolumn";}}z.push(q);}function Q(AM,AH,p){var AD=AM.cols,AE=AD.cg,n=[{w:"0px"}];if(AD&&AH){var AN=AD.cws,o=[],AL=AN.length,AP=0,z=(parseInt(AM.ar,10)===1)?(AH/AL):-1,AC,q,AB=false,s=0,AF=AH,AG=0,AK;for(AK=0;AK<AL;AK++){q=o[AK]=AN[AK];AC=q.w;if(AC===""){AB=true;}else{if(q.xc){AP+=parseInt(AC);AF-=AP;s++;}else{AG+=parseFloat(AC,10);}}}if(AB||AG<100){z=AF/(AL-s);}for(AK=0;AK<AL;AK++){q=AN[AK];if(q.xc){continue;}else{if(z===-1){AC=parseInt(q.w,10)*AF/100;if(!AC&&AC!==0){AC=parseInt(AF/AE.cgc,10);}}else{AC=(parseInt(q.w,10)<0)?0:z;}}o[AK]={w:AC+"px"};}if(p){return o;}var AA=[],AJ=0;for(AK=0;AK<AL;AK++){var AO=AE[AK],x=AO.tg?AO.cl:1,AI=0;for(AI=0;AI<x;AI++){var t="0px";if(AI===AO.cc){t=o[AK].w;}AA[AJ+AI]={w:t};}AJ+=x;}return AA.concat(n);}else{if(p){return null;}else{return cp.cws.concat(n);}}}function B(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function M(){var AA=this.cps,z=this.cps[0],AF=Math.max(AA[0].rc,AA[1].rc);if(z.type!==Y){var AK=this.gridData,AE=function(AN,AQ){var AM=AN.base.items,AO=AN.lookupBase[0].es,AP=AM[AQ].items[0],AL=AO&&AO[AP.idx];return(AL&&AL.n)||((AP.pi&&AO[AP.pi.ri||0])||"");},AI,AH,n=1,w,o,AC,q=0,p=-1,AD,AJ,AG=0,AB=this.groupEnabled;for(AD=0,AI=0,AJ=z.cps?z.cps.length:1;AD<AJ;AD++){var t=z.cps?z.cps[AD]:z,x=t.rc;q=p+1;p=q+x-1;if(t.isDataAvailable(q,p)){if(t.lastRow){AG=t.lastRow;o=t.lastSection;}else{AI=AG||0;for(AH=0,n=this.sectionMap[AI-1]||0;AH<x;AH++){var s=this.stackLevels;AC=AE(t,AH);if(AB&&AC!==o){o=AC;this.sectionInfo.push({sn:AC,rs:this.srh*n+this.stackedRh*Math.floor((AI-n)/this.stackLevels)});this.sectionMap[AI]=++n;AI++;}while(s){this.sectionMap[AI]=n;s--;AI++;}}AG=t.lastRow=AI;t.lastSection=AC;}}else{break;}}this.rc=(this.stackLevels>1?AF*this.stackLevels:AF)+(AB?n:0);}},onDemandDataReady:function Z(){this.adjustCPMaps();},initContent:function V(AA){var z=this.cps,AL=this.gridData=z[0].gridData||z[0].cps[0].gridData,AH=AL.vp=this.gridVp=this.gridVp||AL.vp,p=AH.daf&&AH.daf.split(":"),AB=AH.cols,AC=AB.cg,AI=AB.cws,x=z[A(AC)],AF=AL.gts.row,o=AL.gts,AJ=W(z,AL),w=x.type!==Y,AE,AG,s,n,AD,t,AK,q=mstrApp.isTablet()?240:mstrMobileApp.getDeviceDPI();R.forEach(k,function(AN,AM){D[AM]=AN*X[q];});if(w){if(AH.dafIdx===undefined&&p){for(AE=0;AE<AF.length;AE++){if(AF[AE].id===p[0]&&AF[AE].fid===p[1]){AH.dafIdx=AE;break;}}}}for(AE=0;AE<AC.cgc;AE++){if(AC[AE]&&AC[AE].tg){break;}}if(AE===AC.cgc){AL.gts.show=false;AL.ghs.chs.show=false;}this._super(AA);this.colWidths=Q(AH,this.gridWidth);this.tdWidths=Q(AH,this.gridWidth,true);if(w){this.stackLevels=j(AB);if(this.stackLevels>1){this.srh=D[K];this.rh=D[l];this.mrh=D[F];this.stackedRh=D[f]+(this.stackLevels-2)*D[g]+D[F];}else{this.srh=D[K];this.rh=this.stackedRh=this.mrh=D[l];}if(AJ||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AJ;this.adjustCPMaps();n=this.cps[0].cps;if(n){AK=this;for(AE=0,AG=n.length;AE<AG;AE++){t=n[AE];if(t&&t.addCPListener){t.addCPListener(AK);}}}}}},getUnmergedCells:function(n){return ;},getResolvedGroupHeader:function(p,s){var o=this.gridData,q=o.gts.row[s].es,n=o.ghs.rhs.items[p].items[s];if(n){if(!n.css){n.css=o.css[n.cni].n+" iggroup";n.n=q[n.idx].n;}}else{return{css:" iggroup",n:""};}return n;},getRowCells:function(AJ){var AE=this.cps,w=[],AX=this.gridData,AT=AX.vp,AH=AT.cols.cg,AC=AE[A(AH)],AG=this.groupEnabled,o=AT.bn==="1",AU=[],AI=O.call(this,AJ),x,q,AK=1,AD,n,AA,AQ,AP,AS,AW,AB;if(AG&&(this.sectionMap[AJ]!==this.sectionMap[AJ-1])){var s=R.copy(AC.getRowCells(AI)[0],{});s.cs=this.colWidths.length;s.rowType=K;h(s,{col:null,type:AC.type,extraCss:[I.GROUPING]});return[s];}if(!AJ){B.call(this);}this.lastAttRow=this.lastAttRow||(AE[0].rc?AE[0].getRowCells(AI):[]);this.lastMtxRow=this.lastMtxRow||(AE[1].rc?AE[1].getRowCells(AI):[]);AA=this.lastAttRow;AS=AA.length;if(AS>0&&AA[0].stt){AD=true;for(AQ=0;AQ<AS;AQ++){AW=AA[AQ];if(AW.stt===P){n=AW;break;}}}if(!this.lastStackCols){T.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AQ=0;AQ<p.length;AQ++){if(p[AQ]._ei!==undefined){if(AT.dafIdx>=0){AB=AC.getRowCells(AI)[AT.dafIdx];}x=(AT.dafIdx>=0)?(AB&&AB._ei):"";return false;}}},this);var AO=function(p,AY){if(p&&(AY.type===Y||AY.type===b)){if(AM.tg===false){p.n=p.v="";}p.rowType=i;}h(p,{col:AM,type:AY.type,extraCss:[((AY.type===U||AY.type===m)&&o&&(AI%2===1))?I.BANDING:null,AD?I.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AT.dafIdx!==undefined){p._ei=x;}}};this.lastRowIndex=0;for(AP=0;AP<AH.cgc;AP++){var AM=AH[AP],AR=AM["mix"+AM.cc],t=AR!==undefined,z=AE[t?1:0],AN,AL,AF,AV={n:"",stt:P,css:"xtab-td"};arr=[];if(AM.tg){for(var AQ=0;AQ<AM.cl;AQ++){arr=[];AF=t?AM["mix"+AQ]:AM.attForms[AQ].idx;var AA=t?this.lastMtxRow:this.lastAttRow;AW=AA[AF];if(AD){if(!AW){AW=AV;}else{if(AW&&AW.stt===P){AW=R.copy(n,AV);}else{AW=R.copy(AW,{});}}}else{AW=R.copy(AW,{});}AO(AW,z);arr.push(AW);AU.push(arr);}if(AP+1===AH.cgc){AK=AM.cl;}}else{for(AN=0,AS=AM.cl;AN<AS;AN++){if(t){AL=AM["mix"+AN];if(AL!==undefined){AW=this.lastMtxRow[AL];}}else{AL=AM.attForms[AN];if(AL){AW=this.lastAttRow[AL.idx];}if(AD&&!AW){AW=AV;}}AO(AW,z);arr.push(AW);}AU.push(arr);}}this.lastStackCols=AU;}w=N(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AT);if(this.lastRowIndex>=this.stackLevels){B.call(this);}return w;},getRowHeight:function E(o){var n=D[l];return D[o]||n;},isDataAvailable:function e(o,n){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var q=this.sectionMap.length,p;if(!q){return this.cps[1].isDataAvailable(o,n);}if(n>q){if(o<q){p=O.call(this,o);return this.cps[1].isDataAvailable(p,p+(n-o));}else{return false;}}else{return this.cps[1].isDataAvailable(O.call(this,o),O.call(this,n));}}},download:function G(x,s){var n=O.call(this,x),w=n+Math.ceil((s-x)/this.stackLevels),t=this.cps[0],o,p,q=!t.cps?[t]:this.cps[0]._getCPs(n,w);for(o=0;o<q.length;++o){p=q[o];p.download(n,w);}},getRowCellInfo:function(q){var p=C.call(this,q+this.srh),n,o=this.lastSectionIndex;if(p){n=this.sectionInfo[o-1];return{rowStart:p.rs,isNextRowNewSection:true,sectionName:n&&n.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[o].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TristateCheckBox","mstrmojo._IsInputControl");mstrmojo.CheckBoxDIC=mstrmojo.declare(mstrmojo.TristateCheckBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CheckBoxDIC",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" tabindex="1" mstrAttach:click,keydown></div>',cssText:"width: 0; margin:0 auto; max-height: 18px; cursor: pointer;",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);this.set("checked",true);}else{this.set("checked",!this.checked);}},oncheckedChange:function(A){this.set("value",this[this.checked?"onValue":"offValue"]);},preBuildRendering:function(){this._super();var A=this.dic.vls;this.offValue=A[0].v;this.onValue=A[1].v;this.grayed=(this.onValue!==this.value)&&(this.offValue!==this.value);this.checked=(this.onValue===this.value);},postBuildRendering:function(){this._super();this.domNode.style.height=this.openerStyle.ih+"px";},onkeydown:function(B){var A=B.hWin,C=B.e||A.event;if(C.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(A,C);this.onclick();}},focus:function(){this.domNode.focus();}});})();(function(){var D="mstrXtabCellMenu",M="mstrmojo.all['"+D+"'].selectedData",E="mstrmojo.all['"+D+"'].xtab",F="mstrmojo-InteractiveButton",H="mstrmojo.Box",B="mstrmojo-Menu-Box",G="mstrmojo.MenuItem";function K(R,O){var Q=mstrmojo.all[D],P=Q.xtab,N=[Q.selectedData].concat(O||[]);Q.close();P[R].apply(P,N);}function J(){K("link",[this.index]);}function A(P,R,Q,N){var O={scriptClass:G,text:P,iconClass:"mstrmojo-oivmSprite "+R,cssClass:F,onclick:Q};if(N){O.bindings=N;}return O;}function C(O,Q,P){var N=A(O,"tbPivot"+Q,function(){K("pivot",[P]);});N.bid=P;return N;}function I(O,P,N){return A(O,"tbSort"+P,function(){K("sort",[(N==="true")]);},{selected:"mstrmojo.all['"+D+"Sort'].so === "+N});}function L(Q,P,O){if(!Q){return null;}var N=P.model.getCellDrillsInfo(O);if(!N||!N.k){return null;}return A(mstrmojo.desc(183,"Drill to")+" "+(N.n||""),"tbDrill",function(){K("drill");});}mstrmojo.XtabCellMenu=mstrmojo.registry.ref({id:D,slot:"popupNode",scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-Menu",shadowNodeCssClass:mstrmojo.dom.isIE?"mstrmojo-Menu-shadow":"",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,updatePopupConfig:function(O){O=O||{};this.xtab=O.xtab;this.selectedNode=O.td;var R=this.selectedData=O.xtab&&O.td&&O.xtab.getCellForNode(O.td);this.onClose=O.onClose;var N=this.sortOptions;N.set("visible",((R&&R.at)||0)&8);N.set("so",R&&R.so);N=this.pivotOptions;var S=((R&&R.at)||0)&16;if(S){for(var Q=0;Q<6;Q++){var T=N.children[Q];T.set("visible",this.xtab.model.isPvtButtonVisible(R,T.bid));}}N.set("visible",S);N=this.linkOptions;N.set("visible",((R&&R.at)||0)&4);N=this.drillOptions;var P=((R&&R.at)||0)&1;N.set("visible",P);N.set("children",[L(P,this.xtab,R)]);this.cfg=O;},onOpen:function(){var T=this.cfg,S=T.opener,a=S&&S.domNode&&mstrmojo.dom.position(S.domNode),b=a.y||0,V=T.cmPos,X,U;if(V){X=V.x;U=V.y-b;}else{var O=T.btn&&T.btn.domNode;var Z=mstrmojo.boxmodel.offset(O,S&&S[this.slot]);X=Z.left;U=Z.top+((O&&O.offsetHeight)||0);}var R=mstrmojo.dom.windowDim(),P=this.domNode;var Q=P.offsetHeight,W=R.h-b,Z=Math.max(0,U+Q-W);this.set("top",U-Z+"px");var Y=P.offsetWidth,N=R.w,Z=Math.max(0,X+Y-N);this.set("left",X-Z+"px");},children:[{id:D+"Links",alias:"linkOptions",scriptClass:H,cssClass:B,visible:false,children:[{scriptClass:"mstrmojo.WidgetList",autoHide:true,itemFunction:function(O,N){if(N===0){mstrmojo.requiresCls(G);}return new mstrmojo.MenuItem({text:O.n||O.url||(O.target&&(O.target.n||O.target.did)),cssClass:F,cssText:(N===this.itemsInfo&&this.itemsInfo.di)?"font-weight: bold":"",index:N,onclick:J});},bindings:{itemsInfo:"this.parent.parent.visible ? "+E+".model.getCellLinksInfo("+M+") : null",items:"this.itemsInfo.links"}}]},{id:D+"Drill",alias:"drillOptions",scriptClass:H,cssClass:B,visible:false},{id:D+"Sort",alias:"sortOptions",scriptClass:H,cssClass:B,children:[I(mstrmojo.desc(7974,"Sort Ascending"),"Asc","true"),I(mstrmojo.desc(7975,"Sort Descending"),"Desc","false")]},{id:D+"Pivot",alias:"pivotOptions",scriptClass:H,cssClass:B,children:[C(mstrmojo.desc(5362,"Move Left"),"Left","l"),C(mstrmojo.desc(5363,"Move Right"),"Right","r"),C(mstrmojo.desc(7978,"Move Up"),"Up","u"),C(mstrmojo.desc(7979,"Move Down"),"Down","d"),C(mstrmojo.desc(7976,"Move to Columns"),"Cols","2"),C(mstrmojo.desc(7977,"Move to Rows"),"Rows","1")]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList");var A=function(O,P){var N=O.parent.opener,F=N&&N.showDesc,M=N&&N.showPath,E=P[O.itemField];var L=mstrmojo.string.escape4HTMLText,Q="";if(M){var I=P.anc&&P.anc.items,K=I&&I.length;if(K>0){for(var H=0;H<K-1;H++){Q+=I[H].n+" > ";}Q+=L(I[K-1].n);}else{if(P.path){Q+=P.path;}}}Q+=(Q.length==0?"":" > ")+L(E);if(F){var J=P[O.itemDescField],G=120;if(J){Q+="\r\n\r\n"+L(J.substring(0,G)+(J.length>G?"...":""));}}return Q;};var C=function(E,F,G){if(!F||!G){return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var H=F.path||F.getAttribute("path");if(H){return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(I){var J=D(I.toString())||"";G.path=J;F.path=1;F.title=A(E,G);}},{taskId:"getObjectDetails",objectID:G.did,objectType:G.t,sessionState:mstrApp.sessionState},undefined);},200);};var D=function(G){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(G,"text/xml");}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(G);}var K=xmlDoc.getElementsByTagName("path")[0],H=K.childNodes,J="";if(H){for(var F=0,E=H.length;F<E;F++){var I=H[F].childNodes&&H[F].childNodes[0];if(I){J+=mstrmojo.string.escape4HTMLText(I.nodeValue)+(F<E-2?"> ":"");}}}return J;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",itemDescField:"desc",getItemMarkup:function(G,E){var F=this.parent.opener,H=A(this,G);return'<div class="mstrmojo-suggest-text '+((F&&F.item2textCss(G))||"")+'" idx="'+E+'" title="'+H+'">'+F.getHighlightedText(F.getSearchPattern(),mstrmojo.string.escape4HTMLText(G[this.itemField]))+"</div>";},getItemProps:function B(F,E){return{};},onmouseover:function(F){var I=this.parent.opener;if(I&&I.showPath){var G=mstrmojo.dom.eventTarget(F.hWin,F.e),E=G.getAttribute("idx"),H=E!=null?this.items[E]:null;if(H&&H.t>-1){C(this,G,H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate");mstrmojo.MCSUtil=mstrmojo.provide("mstrmojo.MCSUtil",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],getQuaByFunc:function(U,V){var R=this.F,Q=this.Q,T=mstrmojo.array;var S=function(W){if(T.indexOf(R[1],W)!==-1){return true;}else{return false;}};if(V===undefined||V==this._GENERIC){return Q._G;}else{if(S(U)){return(V==this._RANK)?Q._RT:Q._PT;}else{return(V==this._RANK)?Q._RB:Q._PB;}}},getFuncInfo:function(Q,R){var T,S;switch(R){case this.Q._G:T=this._GENERIC;S=0;break;case this.Q._RT:T=this._RANK;S=1;break;case this.Q._RB:T=this._RANK;S=2;break;case this.Q._PT:T=this._PERCENT;S=1;break;case this.Q._PB:T=this._PERCENT;S=2;break;default:return{};}return{ft:T,f:this.F[S][Q]};},getOpIdxByfunc:function(U,V){if(!U||!V){return -1;}var R=this.F,Q=this.Q,T=mstrmojo.array,S=-1;switch(V){case this._GENERIC:S=T.indexOf(R[0],U);break;case this._RANK:case this._PERCENT:S=T.indexOf(R[1],U);if(S==-1){S=T.indexOf(R[2],U);}break;}return S;},getIncludeByOp:function(R){var Q=this.OP;switch(R){case Q._EQUALS:case Q._GREATER_EQUAL:case Q._LESS_EQUAL:case Q._BETWEEN:case Q._IN:return true;}return false;},formatNumber:function(T,R,Q){if(T==B.Q._G){var S=mstrmojo.num;return(Q.fm)?S.formatByMask(Q.fm,R):S.format(Q.cat,Q.dp,Q.curr,R);}else{if(T==B.Q._RB||T==B.Q._RT){return parseInt(R);}else{if(T==B.Q._PB||T==B.Q._PT){return parseFloat(R)+"%";}}}}});var B=mstrmojo.MCSUtil,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,F=[{n:mstrmojo.desc(2795,"Equals"),v:B.OP._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:B.OP._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:B.OP._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:B.OP._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:B.OP._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:B.OP._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:B.OP._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:B.OP._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:B.OP._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:B.OP._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:B.OP._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:B.OP._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var D=function(Y,Q,S,U,T){if(T==2){return Q;}var Z=String(Y).split(";"),W=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(U&&Z&&Z.length>1){Q.code=W;}else{for(var V=0;V<Z.length;V++){var X=parseFloat(Z[V],10);if(isNaN(X)||(S&&((Z[V].match(/^\d+(\.\d+)?%$/)==null&&Z[V].match(/^\d+(\.\d+)?$/)==null)||X<0||X>100))||(!S&&Z[V].match(/\d+$/)==null)){Q.code=W;}if(Q.code!=R){break;}}}if(Q.code!=R){Q.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return Q;};var M=function(Q){Q=parseFloat(Q);if(isNaN(Q)){return"54px";}else{return(Q*72/16)+"pt;";}},P=function(S){if(S.hasRendered){var R=S.domNode.style;R.font=S.font;R.width=M(R.fontSize);}else{var Q=S.font.match(/[^\s]*?pt/)||[];S.cssText=S.cssText+" font:"+S.font+"; width:"+M(Q[0]);}},I=function(Q){if((Q>=8&&Q<=16)||(Q>=23&&Q<=25)||Q==30){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function O(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(Q){if(this._super){this._super(Q);}this._init();},_init:function(T){switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(T){this.cs=[];this.f=this.ft=null;}var U=B.getOpIdxByfunc(this.f,this.ft),Q;if(this.qua==0||this.dt==30){Q=(U==B.OP._IS_NOT_NULL||I(this.dt))?(U==-1)?B.OP._GREATER_EQUAL:U:B.OP._IS_NULL;}else{Q=(U==-1)?B.OP._GREATER_EQUAL:U;}this.set("opId",Q);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId==B.OP._IN||this.opId==B.OP._NOT_IN){for(var S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function C(Q,R){this.da=Q;this.updateExpr(R);},updateExpr:function A(Q){if(Q){this.cs=Q.cs;this.f=Q.f;this.ft=Q.ft;this.qua=Q.qua;}this._init();},onquaChange:function N(Q){this._init(true);this.func.items=(this.qua!=0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!=0)?L:I(this.parent.dt)?F:H;},onchange:function(){var Q=this.parent,R=this.selectedItem;if(R&&R.v!==null&&R.v!==undefined){Q.set("opId",R.v);}if(mstrApp.isMobile&&(R.v===B.OP._IS_NULL||R.v==B.OP._IS_NOT_NULL)){if(Q.onchange){Q.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){var R=this.parent,Q=this.domNode;R.set("cs1",this.value);if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(R){var Q=R.hWin,U=R.e||Q.event,T=this.parent,S=R.src.domNode;if(U.keyCode===13&&T.apply&&T.apply.enabled){T.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){this.parent.set("cs2",this.value);var Q=this.domNode;if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(R){var Q=R.hWin,T=R.e||Q.event,S=this.parent;if(T.keyCode===13&&S.apply&&S.apply.enabled){S.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var S=this.parent,V=(S.qua==B.Q._PT||S.qua==B.Q._PB);S.cs=[];var T=function(W){return W+((V&&!String(W).match(/^\d+%$/))?"%":"");};var R=function(W,X){return((W==2||W==3)&&X==0)?14:5;};if(S.opId==B.OP._IN||S.opId==B.OP._NOT_IN){var U=String(S.cs1).split(";");for(var Q=0;Q<U.length;Q++){if(!mstrmojo.string.isEmpty(U[Q])){S.cs.push({dtp:5,v:T(U[Q])});}}}else{if(S.vldTbL.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs1)});}if(S.vldTbH.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs2)});}}if(S.onchange){S.onchange();}if(S.makeSelection){S.makeSelection();}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(F,D){var E=this.items;this.items=D||[];return E!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var E=this.value,D=this.selectedIndex,G=this.items||[],H,F;if(D===undefined||(E!==null&&(D===-1||(D!==-1&&G[D]&&G[D][this.itemIdField]!==E)))){D=mstrmojo.array.find(G,this.itemIdField,E);D=(D>-1)?D:this.defaultSelection;this.selectedIndex=D;}else{if(E===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=H=G[this.selectedIndex];if(H){F=H[this.itemField];}else{F=this.defaultText||"";}this.set("text",F);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function(E){var F=this.value,D=-1;if(F!==null){D=mstrmojo.array.find(this.items,this.itemIdField,F);}if(D>-1){this.selectedItem=this.items[D];this.selectedIndex=D;}},togglePopup:function C(){if(this.popupToBody){var G=mstrmojo.dom.position(this.popupNode,true),F=this.popupRef,D={left:Math.round(G.x)+"px",top:Math.round(G.y)+"px"};if(!F.hasRendered){delete F.slot;D.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(D,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var E=this.popupRef.domNode;if(E){if(this.fixWidth){E.style.width=(this.domNode.offsetWidth-2)+"px";}else{E.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(D){this.togglePopup();},unrender:function B(D){var E=this.popupRef;if(this.popupToBody&&E.hasRendered){E.unrender(false);}if(this._super){this._super(D);}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var F=this.opener,E=F&&F.popupZIndex,G=F&&F.popupCssClass||"",D=this.domNode;if(E){D.style.zIndex=E;}if(G){mstrmojo.css.addClass(D,[G]);}if(F&&F.fixWidth){mstrmojo.css.addClass(D,["fix-width"]);}if(F&&F.fixHeight){mstrmojo.css.addClass(D,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(F,D,E){return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+(F[E.itemCSS]||"")+'" title="'+F[E.itemField]+'">'+(F[E.itemField]||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var F=this.parent,G=F.visible,D=F.opener,E=this.selectedItem;if(!D||!E||!G){return ;}D.set("value",E[this.itemIdField]);}}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip","mstrmojo.HBox");var B=mstrmojo.dom,C=mstrmojo.css,A=1,G=2,F=3,E=function(I){var H=C.getStyleValue(I,"verticalAlign");return{top:A,bottom:F,middle:G}[H]||A;};mstrmojo.SliderBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SliderBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table></div>',markupSlots:{valuePartNode:function(){return this.domNode.firstChild;},valueLabelNode:function(){return this.domNode.firstChild.firstChild;},valueTextNode:function(){return this.domNode.firstChild.lastChild;},sliderPartNode:function(){return this.domNode.lastChild;},minTextNode:function(){return this.domNode.lastChild.rows[0].cells[0];},maxTextNode:function(){return this.domNode.lastChild.rows[0].cells[2];},sliderNode:function(){return this.domNode.lastChild.rows[0].cells[1];}},markupMethods:{onmaxChange:function(){this.maxTextNode.innerHTML=this.max;},onminChange:function(){this.minTextNode.innerHTML=this.min;},onvalueTextChange:function(){this.valueTextNode.innerHTML=this.valueText;},onunsetChange:function(){var H=this.sliderBar.domNode;if(H){mstrmojo.css.toggleClass(H,"unset",this.unset);}}},tabIndex:-1,sliderRef:null,valueLabel:mstrmojo.desc(4104,"Value:"),valueText:"",min:"",max:"",interval:0,isSequential:false,unset:false,cssClass:"mstrmojo-SliderGroup",postCreate:function D(){if(!this.sliderRef){this.sliderRef={scriptClass:"mstrmojo.Slider",isHoriz:true,ontitleChange:function(){if(this.domNode&&this.title){this.domNode.setAttribute("title",this.title);}},onselectionChange:function(){if(!this.hasRendered){return ;}var I=this.items[this.selectedIndex]&&this.items[this.selectedIndex].n,H=this.parent;if(H.unset){H.unset=false;C.removeClass(this.domNode,"unset");}H.set("valueText",I);H.set("value",I);this.typeHelper.updateThumb();}};}this.sliderRef.slot="sliderNode";this.sliderRef.alias="sliderBar";this.addChildren(this.sliderRef);},preBuildRendering:function(){this._super();var M=this.min,I=this.max,K=mstrmojo.num.parseNumeric(this.value),J=this.items,H,L=this.sliderBar;if(this.isSequential){H=Math.floor((Math.max(Math.min(K,I),M)-M)/this.interval);if(isNaN(K)||K<M||K>I){this.unset=true;}}else{H=mstrmojo.array.find(J,"v",String(K));if(H==-1){this.unset=true;H=0;}}L.set("items",J);L.select(H||0);},postBuildRendering:function(){this._super();if(this.unset){C.addClass(this.sliderBar.domNode,"unset");}},alignSlider:function(K,H){var J=E(K),I,L;if(!this.valuePartNode){L=this.valueCssText||"";I=this.sliderCssText||"";if(J===A){this.valueCssText="top:0;"+L;this.sliderCssText="top:0;"+I;}else{if(J===F){this.valueCssText="bottom:0;"+L;this.sliderCssText="bottom:0;"+I;}else{this.valueCssText="height: 100%; line-height: "+H+"px;"+L;this.sliderCssText="height: 100%;"+I;}}}else{I=this.sliderPartNode.style;L=this.valuePartNode.style;if(J){if(J===A){I.top=L.top="0";}else{if(J===F){I.bottom=L.bottom="0";}else{L.height=I.height="100%";L.lineHeight=inlineHeight+"px";}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip");var T=mstrmojo.dom;var K=mstrmojo.all;mstrmojo._HasDnD={postBuildRendering:function V(){if(this._super){this._super();}var Y=this.id;this.dnd=new mstrmojo._DnDComponent({target:this});this.__mouseDownEvt=function(Z){K[Y].dnd.onmousedown(Z);return true;};T.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);},unrender:function U(){if(this.__mouseDownEvt&&this.dndNode){T.detachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);}this.min=0;this.max=(this.items&&this.items.length-1)||0;this.dnd&&this.dnd.clearListeners();this._super();}};mstrmojo._DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo._DnDComponent",isDragging:null,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,_mousemoveCounter:0,init:function J(Y){mstrmojo.hash.copy(Y,this);},onmousedown:function X(Y){if(Y&&Y.preventDefault){Y.preventDefault();}if(this.dragging){return true;}var Z=this.target.id;if(!this._mousemoveCallback){this._mousemoveCallback=function(a){K[Z].dnd.onmousemove(a);return true;};}this._mousemoveCounter=0;this.startE=mstrmojo.hash.copy(Y);T.attachEvent(document.body,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(a){K[Z].dnd.ondragcancel(a);return true;};}T.attachEvent(document.body,"mouseup",this._cancelCallback);},ondragcancel:function H(Y){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);if(this.afterDragCancel){this.afterDragCancel.apply(this.target,[Y]);}},onmousemove:function D(Y){if(this.dragging){return ;}this._mousemoveCounter++;if(this._mousemoveCounter>this.mousemoveBuffer){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);this.initDrag(Y);}},initDrag:function S(Y){this.dragging=true;var Z=this.target.id;if(!this._dragCallback){this._dragCallback=function(a){K[Z].dnd.ondrag(a);return true;};}T.attachEvent(document.body,"mousemove",this._dragCallback);if(!this._dragEndCallback){this._dragEndCallback=function(a){K[Z].dnd.ondragend(a);return true;};}T.attachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragStart){this.afterDragStart.apply(this.target,[Y]);}this._dragCallback(Y);},ondrag:function F(Y){if(this.duringDrag){this.duringDrag.apply(this.target,[Y]);}},ondragend:function E(Y){this.dragging=false;T.detachEvent(document.body,"mousemove",this._dragCallback);T.detachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragEnd){this.afterDragEnd.apply(this.target,[Y]);}},clearListeners:function I(){if(this._mousemoveCallback){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._cancelCallback){T.detachEvent(document.body,"mouseup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){T.detachEvent(document.body,"mousemove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){T.detachEvent(document.body,"mouseup",this._dragEndCallback);delete this._dragEndCallback;}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasDnD","mstrmojo._ListSelections");function B(Y){this.getUnit=function Z(){return Y._effLen/(Y.items.length-1)||1;};this.calcMinMax=function(b,a){var e=Math.round((b/Y.unit+a/Y.unit)/2);return{min:e,max:e};};this.preUpdateThumb=function(){Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";";};this.updateThumb=function(){Y.containerNode.style[Y.orCfg.posCssP]=Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";};}function P(Y){this.getUnit=function(){return Y._effLen/Y.items.length;};this.calcMinMax=function(a,Z){return{min:Math.floor(a/Y.unit+0.5),max:Math.floor(Z/Y.unit-0.5)};};this.preUpdateThumb=function(){Y.start=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),0)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";"+Y.orCfg.lenCssP+":"+Y.length+";";};this.updateThumb=function(){Y.start=Y.min*Y.unit+"px";Y.containerNode.style[Y.orCfg.posCssP]=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),1)+"px";Y.containerNode.style[Y.orCfg.lenCssP]=Y.length;};}var L="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasDnD,mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:0,useRichTooltip:true,init:function R(Y){this._super(Y);if(Y.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(Y.multiSelect){this.typeHelper=new P(this);}else{this.clsType="sc1";this.typeHelper=new B(this);}},markupSlots:{dndNode:function(){return this.domNode.childNodes[0];},bgNode:function(){return this.domNode.childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0];},frontNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[0];},thumbNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[1];},endNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[2];},tooltipNode:function(){return this.domNode.childNodes[0].childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,preBuildRendering:function A(){var e=this.orCfg.lenCssP,a=this[e],Z=parseInt(a);this._effLen=isNaN(Z)?0:(Z-this._exRoom);if(a){this.bkCssText=e+":"+Math.max(parseInt(a,10)-(2*this.cssBkBW),0)+"px;";this.sdcCssText=e+":"+this._effLen+";"+this.orCfg.posCssP+":"+this._exRoom/2+"px;"+this.orCfg.opPosCssP+":0px;";}var Y=this.selectedIndices;if(!mstrmojo.hash.isEmpty(Y)){this.min=this.items.length-1;this.max=0;for(var b in Y){if(Y[b]){this.min=Math.min(this.min,b);this.max=Math.max(this.max,b);}}}this.unit=this.typeHelper.getUnit();this.typeHelper.preUpdateThumb();},postBuildRendering:function V(){if(this._super){this._super();}if(this.items.length>1&&this.dnd){this.dnd.afterDragStart=this.initDrag;this.dnd.duringDrag=this.ondrag;this.dnd.afterDragEnd=this.ondrop;this.dnd.afterDragCancel=this.cancelDrag;}},_initGhost:function O(){if(!this.ghost){var b=this.containerNode.cloneNode(true);mstrmojo.css.addClass(b,["gh"]);this.ghost={containerNode:b,frontNode:b.childNodes[0],thumbNode:b.childNodes[1],endNode:b.childNodes[2]};this.sdcNode.appendChild(b);}var Z=this.ghost.containerNode.style,a=this.containerNode.style,Y=this.orCfg;Z[Y.posCssP]=a[Y.posCssP];Z[Y.lenCssP]=a[Y.lenCssP];Z.display="block";return this.ghost;},initDrag:function S(b,Y){Y=Y||window;var a=this._initGhost(),Z=this.orCfg;this.dnd.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:a.containerNode[Z.lenP],offset:T.getMousePosition(this.dnd.startE,Y)[Z.offsetP]};this.dnd.initD.td=T.eventTarget(Y,this.dnd.startE);},ondrag:function F(j,h){h=h||window;var k=this.dnd.initD,i=this.ghost,m=i.containerNode,o,a,Z,f=this.min,l=this.max,Y=this.orCfg;var n=T.getMousePosition(j,h)[Y.offsetP]-k.offset;switch(k.td){case this.thumbNode:o=Math.max(Math.min(k.tP+n,k.sL-k.contL),0);a=o+k.contL;m.style[Y.posCssP]=o+"px";var b=this.typeHelper.calcMinMax(o,a);f=b.min;l=b.max;break;case this.frontNode:o=Math.max(Math.min(k.tP+n,k.tP+k.contL),0);Z=Math.max(Math.min(k.contL-n,k.tP+k.contL),0);m.style[Y.posCssP]=o+"px";m.style[Y.lenCssP]=Z+"px";f=Math.min(Math.floor(o/this.unit+0.5),this.max);break;case this.endNode:Z=Math.max(Math.min(k.contL+n,k.sL-k.tP),0);a=k.tP+Z;m.style[Y.lenCssP]=Z+"px";l=Math.max(Math.floor(a/this.unit-0.5),this.min);break;default:return ;}if(f!==this.min||l!==this.max){this.min=f;this.max=l;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function W(a){this.typeHelper.updateThumb();if(this.ghost){this.ghost.containerNode.style.display="none";}this.hideTooltip();if(this.items&&this.items.length){var Z=[];for(var Y=this.min;Y<=this.max;Y++){Z.push(Y);}this.select(Z);}this.dnd.initD=null;},cancelDrag:function Q(Z,Y){if(this.makeSelection){Y=Y||window;var a=T.eventTarget(Y,this.dnd.startE);this.makeSelection({selItem:a});}},showTooltip:function C(Z,Y){this._updateTooltip();this._super(Z,Y);},hideTooltip:function G(Z,Y){if(this.dnd&&this.dnd.dragging){return ;}this._super(Z,Y);},_updateTooltip:function N(){var Z=this.orCfg,b={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},e=(this.ghost)?this.ghost.containerNode:this.containerNode;b[Z.opPosCssP]=0;b[Z.posCssP]=e.style[Z.posCssP];if(this.items&&this.items.length){var a=this.getItemTooltip(this.items[this.min]);var Y;if(this.min===this.max){Y=a;}else{Y=mstrmojo.desc(146,"From:")+" '"+a+"' "+mstrmojo.desc(147,"To:")+" '"+this.getItemTooltip(this.items[this.max])+"'";}b.content=L.replace(/\{@content\}/g,Y);}else{b.content="";}this.set("richTooltip",b);},getItemTooltip:function(Y){return"'"+(Y?Y.n:"")+"'";},unrender:function U(Y){this.ghost=null;this.dnd&&(this.dnd.dragging=false);this.hideTooltip();this._super(Y);},onselectionChange:function M(Y){if(this.onchange){this.onchange();}if(this.makeSelection&&this.dnd&&this.dnd.initD){this.makeSelection({selItem:this.dnd.initD.td});}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;})();(function(){mstrmojo.requiresCls("mstrmojo.DocLayout");function F(P){var N=-1,O=P.children,M,L,K,I,J=[],H=function(){var R;for(R in J){var Q=J[R];if(Q._fixedHeight!==N){Q._fixedHeight=N;if(Q.domNode){Q.domNode.style.height=N+"px";}}}N=-1;J=[];};for(L in O){M=O[L];if(M.node.data.bh&&N>-1){H();}if(M.defn.horiz){for(K in M.children){I=M.children[K];N=Math.max(I._fixedHeight||0,N);J[J.length]=I;}}}H();}mstrmojo.DocLayoutHoriz=mstrmojo.declare(mstrmojo.DocLayout,null,{scriptClass:"mstrmojo.DocLayoutHoriz",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},getWidth:function A(){return this.containerNode.offsetWidth;},getHeight:function G(){return this.containerNode.offsetHeight;},_renderSection:function C(L,I){if(L.node.data.bh){var M=document.createElement("div");M.className="mstrmojo-DocLayout-HBox";var J=document.createElement("table");J.className="mstrmojo-DocLayout-HBox-HorizContainerTable";this._hRow=J.insertRow(-1);M.appendChild(J);this.containerNode.appendChild(M);}if(L.defn.horiz){var H="hi"+I;L.slot=H;var N=this._hRow.insertCell(-1);N.vAlign="top";var K={};K[H]=N;this.addSlots(K);}this._super(L,I);},getLayoutMinWidth:function B(){var I=0,Q=0,J=this.children,P=J.length,N,M;for(N=0;N<P;N++){var O=J[N],L=O&&O.node,H=L&&L.data,K=H&&(String(H.bh)==="true"||String(H.bv)==="true");if(K){I=Math.max(I,Q);Q=0;}if(O.children){for(M in O.children){Q+=O.children[M].width();}}else{Q+=10;break;}}return Math.max(I,Q);},resizeOrReposition:function E(){if(this._super){this._super();}F(this);},renderCtrlsInViewport:function D(){this._super();F(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.DocTextfield");var I=mstrmojo.dom,K=mstrmojo.css,L=1,Q=2,A=3,N=4,P=5,E=6,B=1,D=["","CaptionOnly","IconOnly","IconLeft","IconRight","IconTop","Custom"];var M=[];M[L]=M[Q]=M[E]={minsp:0,mincs:0};M[A]=M[N]={minsp:10,mincs:5};M[P]={minsp:4,mincs:5};function F(V,S,X,R,T){var Y=I.position(V),U=I.position(V.parentElement),W=V.style;R=R||{};R={t:R.t||0,r:R.r||0,b:R.b||0,l:R.l||0};R.h=U.h-R.t-R.b;R.w=U.w-R.l-R.r;if(T){if(Y.h>R.h){W.height=R.h+"px";}if(Y.w>R.w){W.width=R.w+"px";}Y=I.position(V);}if(S){W.top=((R.h-Y.h)/2+R.t)+"px";}if(X){W.left=((R.w-Y.w)/2+R.l)+"px";}}function J(U,V,T){var S=document.createElement("img"),R=S.style;U.appendChild(S);I.attachEvent(S,"load",function(){var W=R.display;R.display="block";F(S,true,true);R.display=W;},true);S.className=T;S.src=V;}mstrmojo.DocButton=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocButton",pressed:false,markupString:'<div id="{@id}" class="mstrmojo-DocButton {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocButton-Container" mstrAttach:click,mousedown><div class="mstrmojo-DocButton-IconNode"></div><div class="mstrmojo-DocButton-ValueNode" style="{@valueNodeCssText}">{@v}</div></div><div class="mstrmojo-DocButton-EffectOverlay"></div>{@buttonNodeMarkup}</div>',markupSlots:{iconNode:function(){return this.domNode.firstChild.firstChild;},valueNode:function(){return this.domNode.firstChild.lastChild;},buttonContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{onpressedChange:function(){var R=!!this.pressed,U=this.defn,T=this.domNode,S=this.fmts;K.toggleClass(T,"pressed",R);this.setBackgroundColor();this.valueNode.style.color=R?U.fhlc:(S.color||"");},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["T","z-index","D","B","P","background-color"],valueNode:["font","fx","color","white-space","overflow"]},setBackgroundColor:function H(){this.domNode.style.backgroundColor=(!!this.pressed)?this.defn.bhlc:(this.fmts["background-color"]||"");},getAnchor:function O(){return this.domNode;},getDPI:function C(){return this.model.dpi;},buildRendering:function G(){this._super();var S=this.defn,k=this.domNode,V=this.buttonContainerNode,j=this.iconNode,n=this.valueNode,f=parseInt((S&&S.dpst)||1,10),g="px";K.toggleClass(k,D[f],true);k.onselectstart=k.ondragstart=function(){return false;};var b=this.getFormats(),X=parseInt(K.getComputedStyle(V).borderWidth,10)*2;if(isNaN(X)){X=0;}var Z=parseFloat(b.width)-X,l=parseFloat(b.height)-X,W=M[f],a=W.minsp,p=W.mincs,e,Y=j.style,i=n.style;function U(h){Y.height=Y.width=h+g;}var o=V.style;o.height=l+g;o.width=Z+g;switch(f){case P:var T=this.getDPI(),R=l+K.getBorderWidths(b["border-width"],T).h+K.getPaddings(b.padding,T).h;e=Math.max(0,Math.min(Z,l-a-p,R*0.6));U(e);F(j,false,true);F(n,true,false,{t:e+a},true);break;case A:case N:e=Math.max(0,Math.min(l,Z-a-p));U(e);F(j,true,false);i[(f===A)?"left":"right"]=(e+a)+g;F(n,true,false);break;case L:F(n,true,false);break;case Q:case E:break;}if(B===parseInt(S.fe,10)){K.addClass(k,"gloss");}J(j,S.nmurl,"normal");J(j,S.hlurl||S.nmurl,"hilight");var m=document.createElement("div");K.addClass(m,"mstrmojo-DocButton-IconMaskNode");j.appendChild(m);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.StackContainer");mstrmojo.TabContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.TabContainer",markupString:'<div id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><div class="mstrmojo-tabcontainer-tabs"></div><div class="mstrmojo-tabcontainer-stack"></div><div></div></div>',markupMethods:{onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{top:function(){return this.domNode.childNodes[0];},stack:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1];},bottom:function(){return this.domNode.childNodes[2];}},addChildren:function A(D,K,H){var G=this._super(D,K,H);var B=this.children,F=B.length;if(F>=2){var L,I,E;for(E=0;E<F;E++){var C=B[E],J=C&&C.slot;if(!L&&C.isStrip){L=C;}else{if(!I&&(!J||J==="stack")){I=C;}}if(L&&I){L.set("target",I);break;}}}return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo._HasBuilder","mstrmojo._IsAnchorable","mstrmojo.dom");var P="mstrmojo-DocInfoWindow-tip",O=1,G=mstrmojo.dom;function C(S,T){var R=G.findWidget(S)||(S&&S.w);while(R){if(R.autoCloseLocked!==undefined){R.autoCloseLocked=T;}R=R.parent;}}function H(S){var R=S.model;return R.getLayoutDataCache(R.getCurrentLayoutKey())[S.psId];}mstrmojo.DocInfoWindow=mstrmojo.declare(mstrmojo.Popup,[mstrmojo._HasBuilder,mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.DocInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div><div class="'+P+' top"></div><div class="mstrmojo-DocInfoWindow-curtain" mstrAttach:click></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.firstChild;}},boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:P,anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,closeOnClick:true,autoCloseLocked:false,tipNodeColor:"",ontouchstart:function J(){this.close();},close:function N(){if(this.autoCloseLocked){return ;}this.model.raiseEvent({name:"infoWindowClosed",psKey:this.psKey});var R=this;window.setTimeout(function(){if(R.anchor){C(R.anchor,false);}},0);if(this._super){this._super();}this.clearAnchorHilites();G.detachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",this.mw);G.attachEvent(document,"scroll",R.mw);},clearAnchorHilites:function B(){var R=mstrmojo.dom.findWidget(this.anchor);if(R&&R.clearHilites){R.clearHilites(R.hiliteKey);delete R.hiliteKey;}},prepareAnchor:function M(){if(this.children&&this.children[0]){var S=this.infoNode.style,T=this.children[0],U=T.dimNode||T.domNode,V=U.offsetWidth,R=U.offsetHeight;S.width=(V+2*O)+"px";S.height=(R+2*O)+"px";}},nudge:function E(){this.positionDialog();this.model.raiseEvent({name:"infoWindowRendered",id:this.id});},onRender:function Q(){this.open(this.opener);},open:function F(X,T){var R=mstrmojo.all[this.psId];if(R){var U=R.defn.sfp,Z=R.selectedIdx;if(U&&Z!==0){R.switchToPanel(0,0);R.children[Z].set("selected",false);}}if(this._super){this._super(X,T);}if(this.anchor){C(this.anchor,true);}if(mstrApp.isTablet&&mstrApp.isTablet()){var Y=mstrmojo.touchManager,S=this.id,W=this.domNode;this._tchHandler=Y.attachEventListener("touchesBegin",S,function(e){if(this.autoCloseLocked){return ;}var b=mstrmojo.dom.contains(W,e.touch.target,true);var g=document.getElementsByClassName("heatmap-infobox"),a=(g&&g.length)||0,f,j=e.touch.target,h=false;for(f=0;f<a;f++){if(mstrmojo.dom.contains(g[f],j,true)){h=true;break;}}if(!b&&!mstrApp.hasOpenDialog()&&!h){this.closeOnTablet();}});}var V=this;V.mw=V.mw||function(a){if(V.autoCloses&&!G.contains(V.domNode,G.eventTarget(self,a),true,document.body)){V.close();}};G.attachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",V.mw);G.attachEvent(document,"scroll",V.mw);},getChildren:function I(){return[H(this)];},preBuildRendering:function K(){var T=H(this),S=T.defn.fmts;S.left=O+"px";S.top=O+"px";if(S.border){var R=S.border.split(" ");if(R.length>=3){this.tipNodeColor=R[2];}}if(this._super){this._super();}},postBuildRendering:function A(){this.set("visible",true);if(this._super){this._super();}if(!this.closeOnClick){this.curtainNode.style.display="none";}},closeOnTablet:function L(){this.close();if(this._tchHandler){this._tchHandler.clear();}}});var D=mstrmojo.DocInfoWindow;D.PLACEMENT={AUTO:1,FIXED:2,ABOVE:3,BELOW:4,LEFT:5,RIGHT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom");var F=mstrmojo.dom,H=mstrmojo.css,E=mstrmojo.Button.newIconButton,B="mstrmojo-oivmSprite ",G=0,K=1,L=2,J={0:"inline",1:"above",2:"below"};function C(M){var N=mstrmojo.boxmodel.offset(M,document.body);return{left:N.left,top:N.top,width:M.offsetWidth,height:M.offsetHeight};}mstrmojo.OIVMDICPopup=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.OIVMDICPopup",autoCloses:false,cssClass:"inline",markupString:'<div dic="1" id={@id} class="mstrmojo-OIVMDICPopup {@cssClass}" style="{@cssText}" mstrAttach:keyup><div class="toolbar"></div><div class="dataInputControl"></div><div class="boxtip"></div></div>',markupSlots:{toolbarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.children[1];},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";},ontopChange:function(){this.domNode.style.top=this.top||"";},onleftChange:function(){this.domNode.style.left=this.left||"";},oncssClassChange:function(){this.domNode.className="mstrmojo-OIVMDICPopup "+this.cssClass;}},setStyle:function(){var U=this.widget,b=U.dic,N=U.popupStyle,W=C(U.openerNode),V=this.domNode,Q=V.style,X=U.domNode.style,M=this.tipNode,O=b.wm?b.w:W.width,a=b.hm?b.h:W.height,T;this.set("cssClass",J[N]);if(N===G){for(T in W){Q[T]=W[T]+"px";}U.set("width",O-2);X.width=(O-8)+"px";X.height=(a>8)?(a-8)+"px":"auto";}else{if(N===K){var Z=O,R=W.left+W.width/2-21,Y=W.top,S=Y<76;Y=S?Y+W.height+15:Y-76;M.className=S?"boxtip up":"boxtip";Q.left=R+"px";Q.top=Y+"px";Q.width=U.domNode.scrollWidth+"px";Q.height="44px";Z=Z>100?(Z+70):200;var P=document.body.offsetWidth-R-Z-parseInt(H.getStyleValue(V,"paddingLeft"),10)-parseInt(H.getStyleValue(V,"paddingRight"),10);P=P>0?0:P;Q.left=R+P+"px";M.style.left=15-P+"px";}else{if(N===L){Q.top=W.top+"px";Q.left=W.left+"px";Q.height=X.height;Q.width=X.width;}}}},onOpen:function D(){var M=this.widget,O=this.lastwidget;if(O!=M){if(O){this.removeChildren(O);}this.lastwidget=M;}if(M.hasRendered){M.unrender();}this.addChildren([M]);this.setStyle();var N=this;this.md=this.md||function(Q){var R=F.eventTarget(self,Q),P=F.findAncestorByAttr(R,"dic",true);if(!P){N.onBlur();F.preventDefault(self,Q);}};this.mw=this.mw||function(P){N.onBlur();};F.attachEvent(document,"mousedown",this.md);F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",this.mw);},onBlur:function(){if(this.widget.popupStyle===G){this.onApply();}else{this.onCancel();}},onClose:function(){F.detachEvent(document,"mousedown",this.md);F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",this.mw);this.toolbar.apply.set("enabled",false);this.set("hasInvalidData",false);if(this.widget&&this.widget.hasRendered){this.widget.lockPopup();}},onApply:function(){if(this.widget.applyChanges()!==false){this.close();}},onCancel:function(){if(this.widget&&this.widget.hasRendered){this.widget.cancelChanges();}this.close();},onkeyup:function A(N){var M=N.hWin,O=N.e||M.event;if(this.widget.applyOnEnter&&O.keyCode===13){this.onApply();}else{if(O.keyCode===27){this.onCancel();}}},enableApply:function(){this.toolbar.apply.set("enabled",true);},preBuildRendering:function I(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}if(this._super){return this._super();}else{return true;}},onhasInvalidDataChange:function(){var M=this.invalidCurtain;if(!M){M=this.invalidCurtain=document.createElement("div");M.className="mstrmojo-fullscreen-curtain";document.body.appendChild(M);}M.style.display=this.hasInvalidData?"block":"none";},children:[{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"toolbar",children:[E(mstrmojo.desc(134,"Apply"),B+"tbApply greyed",function(){this.parent.parent.onApply();},null,{enabled:false,alias:"apply",onenabledChange:function(){H.toggleClass(this.domNode,"greyed",!this.enabled);}}),E(mstrmojo.desc(221,"Cancel"),B+"tbCancel",function(){this.parent.parent.onCancel();})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ExpressDocPanel=mstrmojo.declare(mstrmojo.DocPanel,null,{scriptClass:"mstrmojo.ExpressDocPanel",preBuildRendering:function A(){if(this.getFormats().overflow==="auto"){B.addWidgetCssClass(this,"scroll");}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ListBase","mstrmojo._IsList");var F=",";mstrmojo.TableLayoutList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.TableLayoutList",cssClass:"mstrmojo-TableLayoutList",styleCssClass:"",itemIdField:"v",allowUnlistedValues:false,tableLayoutCssStyle:"auto",multiSelect:false,titleItems:null,items:null,itemsPerRow:0,getLeftEndTitle:function E(G){return"";},getRightEndTitle:function D(G){return"";},getTitleRowMarkup:function A(){var K=this.titleItems;if(K){var H='<tr><td class="left_text">'+this.getLeftEndTitle(-1)+"</td>",G=K.length,J=0,I;for(;J<G;J++){I=K[J];H+='<td class="item_title" title="'+I+'">'+I+"</td>";}H+='<td class="left_text">'+this.getRightEndTitle(-1)+"</td></tr>";return H;}return"";},_markupPrefix:function(){return'<table class="tableLayoutList" style="table-layout:'+this.tableLayoutCssStyle+'" cellspacing="0" cellpadding="0"><tbody>'+this.getTitleRowMarkup();},_markupSuffix:function(){return"</tbody></table>";},getItemMarkup:function(K,H){var J='<{@tag} class="item {@cls}" idx="{@idx}" title="{@n}" style="{@style}">{@n}</{@tag}>',G=this.getLeftEndTitle(H),I=this.getRightEndTitle(H),L=this.itemsPerRow;G='<td class="left_text" title="'+G+'">'+G+"</id>",I='<td class="right_text" title="'+I+'">'+I+"</id>",L=this.itemsPerRow;if(L>0){J=(H%L===0?"<tr>"+G:"")+"<td>"+J+"</td>"+((H+1)%L===0?I+"</tr>":"");}else{J='<td><div class="item_wrapper" idx="'+H+'">'+J+"</div></td>";if(!H){J="<tr>"+G+J;}else{if(H===this.items.length-1){J=J+I+"</tr>";}}}return J;},_getItemNode:function(G){var H=this.itemsNode,J=this.itemsPerRow,I=(this.titleItems?1:0)+((J>0)?parseInt(G/J,10):0),K=1+((J>0)?(G%J):G);return H.rows[I].cells[K].firstChild;},init:function(G){this._super(G);mstrmojo.css.addWidgetCssClass(this,this.styleCssClass);},onchange:function B(){var I,H=[];if(!this.multiSelect){I=this.selectedItem.v;}else{for(var G in this.selectedIndices){H.push(this.items[G].v);}I=H.join(this.delim||F);}this.set("value",I);},postBuildRendering:function C(){this._super();var G=[];if(this.multiSelect){var I=this.value.split(F);for(var H=0;H<I.length;H++){G.push({v:I[H]});}}else{G.push({v:this.value});}this.setSelectedItems(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.HBox","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren");var F={postBuildRendering:function C(){return(this.renderMode!="scroll")?this._super():true;},childRenderOnAddCheck:function(G){return(this.renderMode!="scroll")?this._super(G):false;},preserveChildDomOrder:false};function B(H){if(!H.hasRendered){return ;}var I=H.children||[];for(var G=I.length-1;G>=0;G--){I[G].refresh&&I[G].refresh();}}mstrmojo.DocSection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSection",markupString:'<div id="{@id}" class="mstrmojo-DocSection"></div>',markupSlots:{containerNode:function(){return this.domNode;}},width:function E(G){return this._super(1);},refresh:function D(){B(this);}});mstrmojo.DocSectionHoriz=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSectionHoriz",height:function A(G){return this._super(1);},refresh:function D(){B(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.date","mstrmojo.dom","mstrmojo.HBox","mstrmojo.VBox");var Q=mstrmojo.date,J=mstrmojo.dom,L=mstrmojo.boxmodel,F=function(){return mstrmojo.locales.datetime;},D=Math.PI/6,O=1,P=2,M=3,A=F().AM_NAME,N=F().PM_NAME;function E(S,R){if(S===0){return"00";}else{if(S<10){return R?S.toString():"0"+S;}else{return S.toString();}}}function H(U){if(!U){return null;}var S=Q.parseTime(U),T=/.*\ [a|p]m/i.test(U);if(!S){var R=Q.parseDateAndOrTime(U);S=R&&R.time;if(!S){return null;}}if(T){S.h12=/.*\ am/i.test(U)?A:N;}return S;}function C(g,T){var e=this,S=L.offset(T,document.body),Y=(e._hh%12)*(Math.PI/6)+(Math.PI/360)*e._mm,Z=(Math.PI/30)*e._mm,a=0,b=0,W=S.left+80,V=S.top+80,U=0,X=0,R=function(l,j,h,o){var m=0,n=0,k=h-l,i=j-o;if(i===0){if(k>=0){n=Math.PI/2;}else{n=3*Math.PI/2;}}else{if(k===0){if(i>=0){n=0;}else{n=Math.PI/2;}}else{m=k/i;if(m>0&&k>0){n=Math.atan(m);}else{if(m>0&&k<0){n=Math.PI+Math.atan(m);}else{if(m<0&&k>0){n=Math.PI+Math.atan(m);}else{n=2*Math.PI+Math.atan(m);}}}}}return n;},f=function(i){var j=R(W,V,i.pageX,i.pageY),h;if(X===O){h=e._hh;e._hh=Math.floor(j*6/Math.PI);if(e._hh===0){if(h===23){e._hh=0;}else{if(h===11||h===12){e._hh=12;}else{if(h>12){e._hh+=12;}}}}else{if(e._hh===11){if(h===0){e._hh=23;}else{if(h===13||h===12){e._hh=11;}else{if(h>12){e._hh+=12;}}}}else{if(h>=12){e._hh+=12;}}}e._updateValue();}else{h=e._mm;e._mm=Math.floor(j*30/Math.PI);if(e._mm<15&&h>45){if(e._hh===23){e._hh=-1;}e._hh+=1;}else{if(e._mm>45&&h<15){if(e._hh===0){e._hh=24;}e._hh-=1;}}e._updateValue();}};U=R(W,V,g.pageX,g.pageY);a=Math.abs(Y-U);a=Math.min(a,2*Math.PI-a);b=Math.abs(Z-U);b=Math.min(b,2*Math.PI-b);if(a<D||b<D){if(b<a){X=P;e.active=P;}else{X=O;e.active=O;}J.attachEvent(T,"mousemove",f);J.attachEvent(T,"mouseup",function(h){J.detachEvent(T,"mousemove",f);});}}function G(V,S){var R=S.getContext("2d"),U=V.hour,T=V.min;R.save();R.clearRect(0,0,160,160);if(V.h12){R.save();R.fillStyle=U<12?"rgba(191, 223, 255, 1)":"rgba(246, 200, 126, .5)";R.fillRect(68,100,26,14);R.font="bold 14px sans-serif";R.fillStyle="black";R.fillText(U<12?"AM":"PM",70,112);R.restore();}R.translate(80,80);R.scale(0.3,0.3);R.rotate(-Math.PI/2);R.fillStyle="rgb(90, 158, 198)";R.save();R.rotate(U*(Math.PI/6)+(Math.PI/360)*T);R.lineWidth=12;R.beginPath();R.moveTo(-28,0);R.lineTo(105,0);R.stroke();R.restore();R.save();R.rotate((Math.PI/30)*T);R.lineWidth=10;R.beginPath();R.moveTo(-35,0);R.lineTo(162,0);R.stroke();R.restore();R.restore();}function I(T,S){var V=L.offset(S,document.body),R=V.left,U=V.top;if(T.pageX<R+68||T.pageX>R+94||T.pageY<U+100||T.pageY>U+114){return false;}return true;}mstrmojo.TimePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TimePicker",markupString:'<div class="mstrmojo-TimePicker {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-Clock-time"><canvas width="157" height="157"></canvas></div></div>',cssText:"width:158px; height:"+(J.isIE?28:180)+"px",markupSlots:{hbNode:function(){return this.domNode.firstChild;},canvasNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onintervalChange:function(){this.interval=parseInt(this.interval,10);},onvalueChange:function(){if(this.domNode){var R,T;R=H(this.value);if(!R){var U=new Date(),S=Q.getDateJson(U);this.set("value",Q.formatTimeInfo(S,F().TIMEINPUTFORMATS[0]));return ;}this._hh=R.hour;this._mm=R.min;T=this.ctn.hb&&this.ctn.hb.tf;if(R.h12){T.set("visible",true);this.set("_tf",R.h12);this.set("_HH",E(R.hour>12?R.hour-12:(R.hour===0?12:R.hour),true));}else{T.set("visible",false);this.set("_HH",E(R.hour,true));}this.set("_MM",E(R.min));if(!J.isIE){G(R,this.canvasNode.firstChild);}}}},active:P,value:null,_hh:null,_HH:null,_mm:null,_MM:null,_tf:null,interval:5,children:[{scriptClass:"mstrmojo.HBox",alias:"ctn",slot:"hbNode",children:[{scriptClass:"mstrmojo.HBox",alias:"hb",cssText:"border: 1px solid #CECBCE;margin-left: 5px;background-color:#FFFFCC;",children:[{scriptClass:"mstrmojo.TextBox",alias:"hh",cssText:"width:15px;border:none;text-align:right;",bindings:{value:"this.parent.parent.parent._HH"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=O;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=23){this.parent.parent.parent.updateHours(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>23){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.Label",cssText:"width:5px;",text:":"},{scriptClass:"mstrmojo.TextBox",alias:"mm",cssText:"width:16px;border:none;",bindings:{value:"this.parent.parent.parent._MM"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=P;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=60){this.parent.parent.parent.updateMinutes(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>60){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.TextBox",cssText:"width:24px;padding-right:2px;border:none;",alias:"tf",visible:false,onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=M;},onkeyup:function(){var R=this.value&&this.value.toUpperCase(),S=this.parent.parent.parent;if((R===F().AM_NAME||R===F().PM_NAME)&&(R!==this.ov)){S._hh+=S._hh<12?12:-12;this.value=this.ov=R;S._updateValue();}},onblur:function(){var R=this.value&&this.value.toUpperCase();if(R!==F().AM_NAME&&R!==F().PM_NAME){this.set("value",this.ov);}},value:"AM",bindings:{value:"this.parent.parent.parent._tf"}}]},{scriptClass:"mstrmojo.VBox",alias:"stepper",slot:"stepperNode",cssText:"padding-left: 2px; padding-top: 0px;",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8314,"Increase"),cssClass:"stepper up",text:"",onclick:function(){this.parent.parent.parent.incr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.incr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8315,"Decrease"),cssClass:"stepper down",text:"",onclick:function(){this.parent.parent.parent.decr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.decr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}}]}]}],init:function(R){if(this._super){this._super(R);}this._hh=0;this._HH="";this._mm=0;this._MM="";},focus:function B(){var R=this.ctn,S=R&&R.hb;if(!S||!this.visible){return ;}if(this.active===O){S.hh.focus();}else{if(this.active===M){S.tf.focus();}else{S.mm.focus();}}},postBuildRendering:function K(){var S=this.canvasNode.firstChild,R=this;if(this._super){this._super();}if(!this.value){this.value="12:00 AM";}if(J.isIE){this.canvasNode.style.display="none";}else{G({hour:this._hh,min:this._mm},S);S.onmousedown=function(T){C.call(R,T,S);};S.onclick=function(T){if(!I(T,S)){return ;}R.active=M;R._hh+=R._hh<12?12:-12;R._updateValue();};}},_updateValue:function(){var R;if(this._tf){R=F().TIMEINPUTFORMATS[0];}else{R=F().TIMEINPUTFORMATS[1];}this.set("value",Q.formatTimeInfo({hour:this._hh,min:this._mm},R));},incr:function(){var R;if(this.active===O){R=this._hh;if(R===23){R=-1;}this._hh=R+1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)+this.interval;if(R>=60){if(this._hh===23){this._hh=-1;}this._hh+=1;R=R-60;}this._mm=R;}}this._updateValue();},decr:function(){var R;if(this.active===O){R=this._hh;R=(R===0)?24:R;this._hh=R-1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)-this.interval;if(R<0){if(this._hh===0){this._hh=24;}this._hh-=1;R+=60;}this._mm=R;}}this._updateValue();},updateHours:function(S){var R=parseInt(S,10);if(this._tf){if(this._hh>=12&&R<12){this._hh=R+12;}else{this._hh=R;}}else{this._hh=R;}this._updateValue();},updateMinutes:function(R){this._mm=parseInt(R,10);this._updateValue();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.PickerButton=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.PickerButton",cssClass:"mstrmojo-PickerButton",cellCssClass:"mstrmojo-PickerButton-cell",enabled:true,postCreate:function(){var A=function(B){mstrmojo.css.removeClass(B.domNode,B.selectedItemCssClass);mstrmojo.css.addClass(B.domNode,B.selectedItemCssClass=((B.parent.items&&B.parent.items[B.parent.selectedIndex])?"tb"+B.parent.items[B.parent.selectedIndex][B.parent.itemDisplayField]:""));};this.children=[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",selectedItemCssClass:"",bindings:{title:"this.parent.title",iconClass:"this.parent.iconClass",selectedIndex:"this.parent.selectedIndex",enabled:"this.parent.enabled"},onclick:function(){this.parent.onchange();},onselectedIndexChange:function(){A(this);},onRender:function(){A(this);}},{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-PickerButton-DropDownButton",bindings:{enabled:"this.parent.enabled"},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Menu",shadowNodeCssClass:"mstrmojo-Menu-shadow",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.ListBox",itemCssClass:"mstrmojo-ListBox-item mstrmojo-InteractiveText",bindings:{itemDisplayField:"this.parent.opener.parent.itemDisplayField",itemIdField:"this.parent.opener.parent.itemIdField",items:"this.parent.opener.parent.items"},onchange:function(){if(this._closing){return ;}var C=this.selectedIndex,B=this.parent.opener;if((C>-1)&&B){this._closing=true;B.closePopup();B.parent.selectedItem=this.selectedItem;B.parent.set("selectedIndex",C);B.parent.onchange();this._closing=false;}}}]}}];}});})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.num","mstrmojo.HBox","mstrmojo.Container");var E=mstrmojo.expr.DTP,P="mstrmojo.Button",G=mstrmojo.num,N=mstrmojo.validation.TRIGGER,D=50,B=500,L=10;function F(Q){var R=this;this._holdTimer=setInterval(function(){R.onclick(Q);},D);}function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}}function K(Q){var R=this;if(!this._holdTimer&&!this._startHoldTimer){this._startHoldTimer=setTimeout(function(){delete R._startHoldTimer;F.call(R,Q);},B);}}function A(){if(this._startHoldTimer){clearTimeout(this._startHoldTimer);delete this._startHoldTimer;}H.call(this);}function M(Q){A.call(this);}function C(Q){return Q?parseFloat(Q.toFixed(L)):Q;}function I(T){var Q=T.max,S=T.min,R=T.itv;return{scriptClass:"mstrmojo.HBox",alias:"hBox",children:[{scriptClass:P,alias:"minus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var V=this.parent.parent.numericValue;if(V<=S){A.call(this);return false;}return true;}},onclick:function(V){var X=this.parent.parent,W=X.numericValue;if(!isNaN(W)){if(Q!==undefined&&W-R>Q){X.set("numericValue",Q);}else{if(S===undefined||W-R>=S){X.set("numericValue",C(W-R));}else{if(W>S&&W-R<S){X.set("numericValue",S);}}}}},onmouseup:M,onmousedown:K,text:"-"},{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-DataInputControl",dtp:E.DOUBLE,required:true,alias:"textInput",constraints:{trigger:N.ONKEYUP|N.ONBLUR,max:Q,min:S},bindings:{value:"this.parent.parent.numericValue"},onValid:function(){this.parent.parent.set("numericValue",parseFloat(this.value));},onblur:function U(V){var X=this,W=this.parent.parent,Y=G.parseNumeric(this.value);if(!W.active&&!isNaN(Y)&&Y>=S&&Y<=Q){W.set("value",G.toLocaleString(W.numericValue));}if(this._super){this._super(V);}}},{scriptClass:P,alias:"plus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var V=this.parent.parent.numericValue;if(V>=Q){A.call(this);return false;}return true;}},onclick:function(V){var X=this.parent.parent,W=X.numericValue;if(!isNaN(W)){if(S!==undefined&&W+R<S){X.set("numericValue",S);}else{if(Q===undefined||W+R<=Q){X.set("numericValue",C(W+R));}else{if(W<Q&&W+R>Q){X.set("numericValue",Q);}}}}},onmouseup:M,onmousedown:K,text:"+"}]};}mstrmojo.StepperDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.StepperDIC",cssClass:"mstrmojo-StepperDIC",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" mstrAttach:mouseup,mousedown></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},init:function O(R){if(this._super){this._super(R);}var Q=parseFloat(this.value);this.set("numericValue",isNaN(Q)?(this.dic.min||0):Q);this.set("children",I(this.dic));this.textInput=this.hBox&&this.hBox.textInput;this.plus=this.hBox&&this.hBox.plus;this.minus=this.hBox&&this.hBox.minus;},onmousedown:function(Q){this.active=true;},onmouseup:function(Q){this.active=false;this.textInput&&this.textInput.domNode.focus();},unrender:function J(Q){this.plus&&A.call(this.plus);this.minus&&A.call(this.minus);this._super(Q);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox");mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur ></textarea>',maxLength:256,markupSlots:{inputNode:function(){return this.domNode;}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncssClassChange=function(){this.domNode.className="mstrmojo-TextArea "+(this.cssClass||"");};},onkeydown:function(D){var C=(this.value&&this.value.length)||0;if(this.maxLength<=C){this.isDeleteKeys=D.e.keyCode===8||D.e.keyCode===46;this.isArrowKeys=D.e.keyCode===37||D.e.keyCode===38||D.e.keyCode===39||D.e.keyCode===40;var B=(this.domNode.selectionEnd!==undefined)?(this.domNode.selectionEnd-this.domNode.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!B){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var A=this.domNode;A.blur();window.setTimeout(function(){A.focus();},1);}mstrmojo.dom.preventDefault(window,D.e);return false;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate");var A=mstrmojo.css,D=mstrmojo.validation,H=D.TRIGGER,G=D.STATUSCODE,E=mstrmojo.TextBox.prototype.markupMethods;mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,markupMethods:{onvisibleChange:E.onvisibleChange,onvalueChange:E.onvalueChange,onenabledChange:E.onenabledChange,onreadOnlyChange:E.onreadOnlyChange,ontooltipChange:E.ontooltipChange,onvalidationStatusChange:function(){var M=this.validationStatus;if(!M){return ;}var L=this.inputNode,J=(M.code>G.VALID),K=this.constraints.invalidCssClass;A.toggleClass(L,K?K:["mstrmojo-TextBox-ErrValidation"],J);if(J){L.setAttribute("title",M.msg);}else{if(this._original_tooltip!==undefined&&this._original_tooltip!==null){L.setAttribute("title",this._original_tooltip);}}}},postBuildRendering:function I(){if(this._super){this._super();}this._original_tooltip=this.inputNode.title;},prekeyup:function B(J){if(this._super){this._super(J);}var L=(this.constraints.trigger&H.ONKEYUP)>0;if(L){if(this.validationDelay>0){if(this._valDelayTimer){window.clearTimeout(this._valDelayTimer);}if(!this._validateHandler){var K=this;this._validateHandler=function(){K.validate();if(K._valDelayTimer){window.clearTimeout(K._valDelayTimer);delete K._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(this._validateHandler,this.validationDelay);}else{this.validate();}}},preinput:function(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONKEYUP)>0;if(K){this.validate();}},preblur:function F(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONBLUR)>0;if(K){this.validate();}},clearValidation:function C(){if(this._super){this._super();}var K=this.inputNode,J=this.constraints.invalidCssClass;A.removeClass(K,J?J:["mstrmojo-TextBox-ErrValidation"]);K.title=this._original_tooltip;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._BindTargetChildren","mstrmojo.TabButton","mstrmojo.TabStripBase");var E=mstrmojo.array;function D(G,F){if(G.autoHide){G.set("visible",F);}}mstrmojo.TabStrip=mstrmojo.declare(mstrmojo.TabStripBase,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},autoHide:true,tabButtonClass:"TabButton",init:function C(F){if(F&&F.autoHide){F.visible=false;}this._super(F);},addTabButtons:function B(G,N){var J=this.targetProps||{},S=J.childTitle||"n",O=J.childColor||"tbc",R=this.tabButtonClass,K=[],Q=this.target,F=function(T){Q.set("selected",this.target);};mstrmojo.requiresCls("mstrmojo."+R);for(var L=0,M=(G&&G.length)||0;L<M;L++){var P=G[L],I=P[S];if(I){var H=mstrmojo.insert({scriptClass:"mstrmojo."+R,title:I,backgroundColor:P[O],target:P,onclick:F});K.push(H);}}if(K.length){D(this,K.length);this.addChildren(K,N);}this.selectionChange();},removeTabButton:function A(G){var F=mstrmojo.array.filter(this.children,function(H){return(H.target===G);},{max:1});if(F&&F[0]){D(this,F.length-1);this.removeChildren(F[0]);F[0].destroy();}},clearButtons:function(){this.removeChildren();}});})();(function(){mstrmojo.requiresCls("mstrmojo.List");var B=mstrmojo.dom,E=mstrmojo.array,C=mstrmojo.css,G=",";function F(){var K,I,J=this.items,L=[];for(K=0,I=J.length;K<I;K++){L.push(J[K].v);}this.set("value",L.join(G));}function H(){var I=this.itemsContainerNode;if(I){E.forEach(I.children,function(J){if(J&&J.firstChild){C.removeClass(J.firstChild,"selected");}});}}mstrmojo.RankDIC=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RankDIC",cssClass:"mstrmojo-RankDIC",draggable:true,dropZone:true,allowCopy:false,multiSelect:false,renderOnScroll:false,itemDisplayField:"n",itemIdField:"v",containerResizable:false,itemMarkupFunction:function(M,J,K){var I=J===0,O=J===K.items.length-1,L='<div class="moveup '+(!I?"":"disabled")+'" or="1" idx="'+J+'">&nbsp;</div>',N='<div class="movedown '+(!O?"":"disabled")+'" or="-1" idx="'+J+'">&nbsp;</div>';return'<div class="mstrmojo-RankOption'+(I?" first":(O?" last":""))+'"><div class="index" contentEditable="true" onfocus="return mstrmojo.all[\''+K.id+"'].selectText(this);\" onblur=\"return mstrmojo.all['"+K.id+"'].indexChanged(this, "+J+');" onkeyup="return mstrmojo.all[\''+K.id+"'].keyPressed(event, this, "+J+');">'+J+'</div><div class="text">'+M.n+"</div>"+N+L+"</div>";},allowDrop:function(K){var J=K&&K.src,I=J&&J.widget;return(I===this);},ondrop:function(L){var J=this.domNode.parentNode,K=J.style,I=false;if(!K.height){K.height=J.offsetHeight+"px";I=true;}this._super(L);H.call(this);F.call(this);if(I){K.height="";}},selectText:function D(K){var I=document.createRange();I.selectNodeContents(K);var J=window.getSelection();J.removeAllRanges();J.addRange(I);},indexChanged:function(M,J){var L=parseInt(M[M.innerText!==undefined?"innerText":"textContent"],10),K=parseInt(J,10),I=this.items.length;if(isNaN(L)){M[M.innerText!==undefined?"innerText":"textContent"]=J;return false;}L=Math.min(Math.max(0,L),I);if(L!==K){this.move([K],L);F.call(this);return true;}else{return true;}},keyPressed:function A(J,K,I){if(J.keyCode===mstrmojo.Enum_Keys.ESCAPE){K[K.innerText!==undefined?"innerText":"textContent"]=I;if(K.blur){K.blur();}}else{if(J.keyCode===mstrmojo.Enum_Keys.ENTER){this.indexChanged(K,I);}}return true;},onmouseup:function(L){var M=B.eventTarget(L.hWin,L.e),K=parseInt(M.getAttribute("or"),10),J=M&&parseInt(M.getAttribute("idx"),10),I=this.items.length;if(K===1&&J!==0){this.move([J],0);F.call(this);return true;}else{if(K===-1&&J!==(I-1)){this.move([J],I);F.call(this);return true;}else{mstrmojo.dom.preventDefault(window,L.e);return true;}}},init:function(I){this._super(I);this.items=this.getItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.array","mstrmojo.func");var H=2;var G=1,B=2;mstrmojo.DocVisModel=mstrmojo.declare(mstrmojo.DocXtabModel,null,{scriptClass:"mstrmojo.DocVisModel",getAction:function F(K){var I=K[0],J=I&&I.at;var L;if(J){if(J&H){L={h:"onVisSelector",a:this.getSelectAction(I)};}}if(!L){L=this.getActionObject(K);}return L;},getSelectAction:function D(N){var Q=N.scObjList,P=Q.length,J=null;if(P>1){J={multiSelect:true,type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,anchor:N.anchor,selectorObjects:[]};var I={};var M="";for(var L=0;L<P;L++){var R=Q[L];var S=R.sc.tks.split("\x1E");for(var K=0;K<S.length;K++){var O=S[K];if(!I[O]){I[O]=true;if(M.length>0){M=M+"\x1E"+O;}else{M=O;}}}}for(var L=0;L<P;L++){var R=Q[L];J.selectorObjects.push({ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid});}if(!J.tks){J.tks=M;}}else{if(P==1){var R=Q[0];J={type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid,anchor:N.anchor};}}return J;},getLinkAction:function E(J,I){var K=J.node,L=K&&K.titleInfo;return this.getLinkActionImpl(K,L,I);},getPCellParentNode:function A(J,I){return(I==G)?J._lp:J._tp;},getPTitle:function C(J,I){return J.titleInfo;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd");function W(a){var e=document.createElement("div"),b=e.style,Z=a.domNode;e.className="mstrmojo-DataGrid-avatar";b.height=Z.clientHeight+"px";Z.appendChild(e);a.avatar=e;return e;}function N(Z){var a=mstrmojo.dom.position(Z.domNode,true);return a.x;}function L(Z){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+Z+'"></div>';}function X(b){var a=b.getAttribute("rh"),Z=a&&parseInt(a,10);return Z;}function U(a,f,Z){var e=Z.src,g=e&&e.data,b=g&&g.resizingIdx;if(!(b&&b>0)){return f&&f.apply(a,[Z]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function E(e,b){var Z=e.colSizeArray;var a=[-Z[b-1]+e.minColWidth,(b==Z.length-1)?Z[b]-e.resizeHandleWidth-e.minColWidth:Z[b]-e.minColWidth];return a;},updateSize:function D(e,b,a){var Z=e.colSizeArray;Z[b-1]=Z[b-1]+a;Z[b]=Z[b]-a;},updateColumnWidth:function Q(e,a,f,b){var Z=e.colSizeArray;a[b-1].style.width=Z[b-1]+"px";f[b-1].style.width=Z[b-1]+"px";a[b].style.width=Z[b]+"px";f[b].style.width=Z[b]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function E(g,f){var h=g.minColWidth+g.resizeHandleWidth,Z=g.colSizeArray,b=0;for(var e=f;e<Z.length;++e){b+=Z[e]-h;}var a=[-Z[f-1]+h,b];return a;},updateSize:function D(e,j,a){var h=e.minColWidth+e.resizeHandleWidth,f=e.colSizeArray;f[j-1]=f[j-1]+a;var Z=[];for(var b=0;b<f.length-j;++b){Z[b]=j+b;}Z.sort(function(i,l){return f[i]-f[l];});for(var b=0;b<Z.length;++b){var k=a/(Z.length-b);var g=f[Z[b]];a-=(g>=k+h)?k:g-h;f[Z[b]]=(g>=k+h)?g-k:h;}},updateColumnWidth:function Q(f,a,g,e){var Z=f.colSizeArray;for(var b=e-1;b<Z.length;++b){a[b].style.width=Z[b]+"px";g[b].style.width=Z[b]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,postBuildRendering:function S(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function C(Z){var b=Z.src,e=b.node,a=X(e);if(a&&a>0){return{resizingIdx:a,startingX:b.pos.x,baseX:N(this)};}else{if(this._super){return this.dropZone&&this._super(Z);}}return null;},allowDrop:function I(Z){var b=Z.src,e=b&&b.data,a=e&&e.resizingIdx;if(a&&a>0){return true;}else{return this.dropZone;}},ondragenter:function O(Z){U(this,this._super,Z);},ondragover:function P(Z){U(this,this._super,Z);},ondragleave:function A(Z){U(this,this._super,Z);},ondrop:function T(Z){U(this,this._super,Z);},ondragstart:function V(f){var n=f.src,g=n&&n.data,m=g&&g.resizingIdx;if(m&&m>0){var j=this.avatar||W(this);this.ownAvatar=true;j.style.left=(g.startingX-g.baseX)+"px";j.style.display="block";document.body.style.cursor="col-resize";var k=this.colSizeArray;if(!k){var b=this.headerContainerNode,h=b&&b.getElementsByTagName("table")[0],l=h.rows[0].cells;k=[];for(var Z=0,e=l.length;Z<e;Z++){k.push(l[Z].offsetWidth);}this.colSizeArray=k;this._firstTimeResize=true;}g.resizingRange=this.resizeColumnBehavior.getRange(this,m);return true;}else{if(this._super){return this._super(f);}}},ondragmove:function M(b){var k=b.src,e=k&&k.data,i=e&&e.resizingIdx;if(i&&i>0){var j=b.tgt,f=this.avatar,h=e.resizingRange,g=j.pos.x-e.startingX,Z=Math.min(h[1],Math.max(g,h[0]));e.deltaX=Z;if(f){f.style.left=(e.startingX-e.baseX+Z)+"px";}}else{if(this._super){this._super(b);}}},ondragend:function J(f){var n=f.src,g=n&&n.data,l=g&&g.resizingIdx;if(l&&l>0){var Z=this.titleColGroup,m=Z&&Z.childNodes,j=this.dataColGroup,k=j&&j.childNodes,e=m.length,h=this.colSizeArray,a=g.deltaX;this.resizeColumnBehavior.updateSize(this,l,a);if(this._firstTimeResize){for(var b=0;b<e;b++){m[b].style.width=h[b]+"px";k[b].style.width=h[b]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,m,k,l);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(f);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function H(b){var g=document.createElement("colgroup"),Z=b.length,a;for(var f=0;f<Z;f++){var e=document.createElement("col");a=b[f];if(a.colWidth){e.style.width=a.colWidth+"px";}e.className=a.colCss||("col"+f);g.appendChild(e);}return g;}function G(a){var b=a._headerWidgets_,Z=b&&b.length;if(Z>0){for(var e=0;e<Z;e++){b[e].destroy(true);}}}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},itemFunction:function(b,Z,a){var e=new mstrmojo.DataRow({columns:a.columns,data:b,idx:Z,dataGrid:a});return e;},preBuildRendering:function B(){var e=this.columns,Z=e.length,f=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],b,a;this._headerWidgets=[];for(var g=0;g<Z;g++){b=e[g];a=b.headerWidget;f.push("<td>");if(g>0&&this.resizableColumns){f.push(L(g));}f.push('<div class="mstrmojo-DataGrid-headerText');f.push(b.headerCss?" "+b.headerCss:"");if(a){this._headerWidgets.push(mstrmojo.hash.copy(a));f.push('" w="1">');}else{f.push('">');}f.push(b.headerText?b.headerText:"&nbsp");f.push("</div>");f.push("</td>");}f.push("</tr></table>");this.headerHtml=f.join("");if(this._super){this._super();}},postBuildRendering:function S(){if(this._super){this._super();}var e=this._headerWidgets,h=e.length;if(h>0){this._headerWidgets_=[];var j=this.headerContainerNode.getElementsByTagName("div"),b=mstrmojo.array.filter(j,function(i){return i.getAttribute("w")=="1";}),m;for(var f=0;f<h;f++){e[f].placeholder=b[f].firstChild;e[f].dataGrid=this;m=mstrmojo.registry.ref(e[f]);m.render();this._headerWidgets_.push(m);}}var Z=H(this.columns),l=Z.cloneNode(true),g=this.headerContainerNode,k=g&&g.getElementsByTagName("table")[0],n=this.itemsContainerNode,a=n&&n.getElementsByTagName("table")[0];this.titleColGroup=Z;this.dataColGroup=l;if(k&&a){k.insertBefore(Z,k.firstChild);a.insertBefore(l,a.firstChild);}},refresh:function F(Z){G(this);if(this._super){this._super(Z);}},destroy:function Y(Z){G(this);this._super();},unrender:function R(f){var b=this._headerWidgets_,a=b&&b.length,Z;if(a>0){for(var e=0;e<a;e++){Z=b[e];if(Z&&Z.hasRendered){Z.unrender(true);}}}this._super(f);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var g=document.createElement("tr"),l=this.data,o=this.idx,a=this.dataGrid,h=this.cssClass,q=this.columns,Z=this.children,b,m=-1,p,n;g.setAttribute("id",this.id);if(a.banding){h+=(o%2==1)?" odd":" even";}g.className=h+(mstrmojo.string.isEmpty(l[a.itemDisplayField||"n"])?" empty-row":"");for(var f=0,k=q.length;f<k;f++){p=q[f];n=(p.dataWidgetBuilder&&p.dataWidgetBuilder(l))||p.dataWidget;b=document.createElement("td");g.appendChild(b);if(n){b.setAttribute("w","1");m++;Z.push(mstrmojo.hash.copy(n,{slot:"slot"+m,data:l,idx:o,dataGrid:a}));}else{if(p.dataFunction){b.innerHTML=p.dataFunction(l,o,a);}else{var e=mstrmojo.string.htmlAngles(l[p.dataField||"n"])||"&nbsp",j=p.tooltip?' title="'+e+'"':"";b.innerHTML='<div class="mstrmojo-DataRow-text" '+j+">"+e+"</div>";}}}this.initChildren();return g;},buildRendering:function K(){this._super();var f=this.domNode.childNodes,Z=f.length,e={},b=0,g;for(var a=0;a<Z;a++){g=f[a];if(g.getAttribute("w")=="1"){e["slot"+b]=g;b++;}}this.addSlots(e);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var A=mstrmojo.dom,B={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(B[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=A.eventTarget(D.hWin,D.e);if(F==this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.Container","mstrmojo.TabStrip");mstrmojo.ScrollingTabStrip=mstrmojo.declare(mstrmojo.TabStrip,null,{scriptClass:"mstrmojo.ScrollingTabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip mstrmojo-ScrollingTabStrip {@cssClass}" style="{@cssText}"><span></span><div class="c" style="position:relative; display:inline-block;"><div style="position:absolute;"></div></div><span></span></div>',markupSlots:{containerNode:function(){return this.domNode.childNodes[1].firstChild;},scrollNode:function(){return this.domNode.childNodes[1];},stripNode:function(){return this.domNode.childNodes[1].firstChild;},btnLeftNode:function(){return this.domNode.childNodes[0];},btnRightNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible){this.set("width",parseInt(this.width,10));}},onleftChange:function(){if(this.stripNode&&this.left!=null){this.stripNode.style.left=this.left+"px";}},onwidthChange:function(C){var E=this.scrollNode,B=this.stripNode;if(E&&B){var D=this,A=parseInt(this.width,10);window.setTimeout(function(){if(A<B.clientWidth){D.createScrBtn();A-=(D.btnsWidth||0);}D.updateScrBtn();if(mstrmojo.dom.isIE7&&B.clientWidth>0){B.style.width=B.clientWidth+7+"px";}E.style.width=A+"px";},0);}}},step:50,scroll:function(B){B=B||1;var D=this.scrollNode,A=this.stripNode,E=Math.abs(parseInt(this.left,10)||0),C=Math.max(A.clientWidth-E-D.clientWidth,0),F=Math.min(this.step,(B==-1?C:E));this.set("right",C);this.set("left",-(E-B*F));this.updateScrBtn();},createScrBtn:function(){if(this.btnLeft&&this.btnRight){return ;}var A=this;this.addChildren([{scriptClass:"mstrmojo.Button",cssClass:"l",alias:"btnLeft",visible:false,enabled:false,scrollInterval:null,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(1);if(A.left>=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnLeftNode"},{scriptClass:"mstrmojo.Button",cssClass:"r",alias:"btnRight",visible:false,enabled:false,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(-1);if(A.right<=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnRightNode"}]);this.renderChildren();this.btnsWidth=50;},updateScrBtn:function(){var F=this.scrollNode,B=this.stripNode,D=this.btnLeft,E=this.btnRight;if(F&&B&&D&&E){var H=Math.abs(parseInt(this.left,10)||0),G=B.clientWidth;E.set("enabled",G-H>F.clientWidth);D.set("enabled",H>0);var A=parseInt(this.width,10),C=A<G;this.btnLeft.set("visible",C);this.btnRight.set("visible",C);if(!C){this.set("left",0);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.string");var A=mstrmojo.ValidationTextBox.prototype.markupMethods,B=mstrmojo.string;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,isList:false,dtp:14,autoFormat:true,markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:A.onvalueChange,onenabledChange:A.onenabledChange,onvalidationStatusChange:A.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var F=this.opener,E=F&&F.calendarZIndex,G=this.cal,C=F&&F.calConfig;if(E){this.domNode.style.zIndex=E;}for(var D in C){G.set(D,C[D]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",changeValueOnOK:function(){var D=this.parent.opener.dtp,C=this.parent.opener.changeValueOnOK;return D===15||D===16||C;}},onValueUpdate:function(D){var F=this.parent&&this.parent.opener;if(F){var E=F.value,C=window.mstrConfig&&window.mstrConfig.listSep||";";if(F.isList&&!B.isEmpty(E)){F.set("value",F.value+C+this.value);}else{F.set("value",this.value);}F.closePopup();}}}]},onclick:function(C){var D=this._lastOpened,E=this._calendarConfig;if(!E){E={};if(this.calendarToBody){delete this.calendar.slot;E.placeholder=document.body.appendChild(document.createElement("div"));E.nudge=function(){var H=this.opener;if(H){var G=mstrmojo.dom.position(H.popupNode,true),F=this.domNode.style;F.left=G.x+"px";F.top=G.y+"px";}};}this._calendarConfig=E;}if(D&&D.visible){this.closePopup();}else{this.openPopup("calendar",E);}},unrender:function(){this._super();if(this.calendar.hasRendered){this.calendar.unrender();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricQualification","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var a=mstrmojo.dom,R=mstrmojo.hash,S=mstrmojo.MCSUtil,K=mstrmojo.desc,e=mstrmojo.css,f=mstrmojo.num,U=Math,E=U.max,C=U.min,B=U.floor,H=U.round;function M(l,w,AB,x){var AE="px",o=l._length,AC=l.handleSize,n=l.orCfg,q=n.posCssP,m=n.lenCssP;AB=E(AB,-1);x=C(x,o);var p=C(AB,x),t=E(AB,x),AA=t-p,AD=E(parseInt(l[m],10)-(2*l.cssBkBW)-(t+AC),0);if(l.hasRendered){w.handle1Node.style[q]=AB+AE;w.handle2Node.style[q]=x+AE;var s=w.lowerRange.style,z=w.thumbNode.style,k=w.upperRange.style;s[q]=0;z[q]=(p+AC)+AE;k[q]=(t+AC)+AE;s[m]=E(p,0)+AE;z[m]=AA+AE;k[m]=AD+AE;}else{AE+=";";q+=":";m+=":";l.handle1CssText=q+AB+AE;l.handel2CssText=q+x+AE;l.lowerRangeCssText=m+E(p,0)+AE;l.thumbCssText=q+(p+AC)+AE+m+AA+AE;l.upperRangeCssText=q+(t+AC)+AE+m+AD+AE;}return{handle1:AB,handle2:x};}function Y(k){this.getUnit=function(){return k._length/E((k.items.length-1),1);};this.calcMinMax=function(n,m){var o=k.unit;return{min:B(n/o+0.5),max:B(m/o+0.5)};};this.calcPxIdx=function(m){return B(m/k.unit+0.5);};this.getStep=function(){var n=k.high-k.low,m=parseInt(k.numFmts.cat,10),o=(m===4)?2:(m===5)?4:0;n=(n===0)?1:n;if(n>1){return(n>(k._length-2))?Number(Number(n/(k._length-2)).toFixed(k.numFmts.dp+o)):1;}return n/(k._length-2);};this.getIdx=function(m){return C(E(H((m-k.low)/k.step),0),k.items.length-1);};this.initialMetricSlider=function l(){var q=function(AG){return AG!==undefined&&AG!==null;},o=function(AG){return(q(AG.da)&&q(AG.da.low)&&q(AG.da.high)&&q(AG.da.cnt)&&q(AG.f)&&q(AG.ft)&&q(AG.qua));},n=function(AG){var AI=true,AH=true;if(AG.ft==S._GENERIC){AI=AG.f!=S.FN.ISNULL&&AG.f!=S.FN.ISNOTNULL&&AG.f!=S.FN.NOTIN&&AG.f!=S.FN.IN;}else{if(AG.ft==S._PERCENT||AG.ft==S._RANK){AH=AG.f!=S.MRPFN.INASCENDING&&AG.f!=S.MRPFN.INDESCENDING&&AG.f!=S.MRPFN.NOTINDESCENDING&&AG.f!=S.MRPFN.NOTINASCENDING;}}return !AI||!AH;},AD=0;k.include=k.parent.include;k.clsType="scm ";k.staticStatus=!(q(k.da)&&q(k.da.low)&&q(k.da.high)&&q(k.da.cnt)&&q(k.qua));if(k.staticStatus){k.da.low=1;k.da.high=7;k.ft=S._GENERIC;k.f=S.FN.BETWEEN;k.qua=S.Q._G;k.cs=[{n:"",v:1},{n:"",v:7}];k.numFmts={cat:9,dp:0,fm:""};}switch(k.qua){case 0:var AC=k.numFmts.cat;AD=AC==4?2:AC==5?4:0;k.low=Number(Number(k.da.low).toFixed(k.numFmts.dp+AD));k.high=Number(Number(k.da.high).toFixed(k.numFmts.dp+AD));break;case 1:case 2:k.low=1;k.high=k.da.cnt;break;case 3:case 4:k.low=0;k.high=100;break;}var AF=!k.staticStatus&&!k.da.nov&&k.dt!=30;k.set("lowText",AF?S.formatNumber(k.qua,k.low,k.numFmts):"");k.set("highText",AF?S.formatNumber(k.qua,k.high,k.numFmts):"");k.step=(k.qua==1||k.qua==2)?1:this.getStep();k.low-=k.step;k.high+=k.step;k.cs1Vl=k.low;k.cs2Vl=k.high;var p=k.low,z=k.high,AE=[],AB=0;if(q(p)&&q(z)&&k.dt!=30){for(var x=0,t=p;t<=z;x++,t+=k.step){AE[x]={n:S.formatNumber(k.qua,t,k.numFmts),v:Number(Number(t).toFixed(k.numFmts.dp+AD))};}AB=AE.length;if(AB>0&&AE[AB-1].v!=z){AE[AB-1]={n:S.formatNumber(k.qua,z,k.numFmts),v:z};}}AB=AE.length;if(AB>=2){AE[0].n=AE[AB-1].n=K(7622);}k.items=AE;var m=S.OP,AA=k.cs,w=(AA&&AA.length>0)?f.parseNumeric(String(AA[0].v).replace("%","")):p,s=(AA&&AA.length>1)?f.parseNumeric(String(AA[1].v).replace("%","")):z;if(w<k.low){k.frtUst=true;}if(s>k.high){k.ndUst=true;}k.opId=(k.f!=null&&k.ft!=null)?S.getOpIdxByfunc(k.f,k.ft):m._BETWEEN;switch(k.opId){case m._EQUALS:case m._NOT_EQUALS:k.cs1Vl=k.cs2Vl=w;break;case m._LESS_EQUAL:case m._GREATER:k.cs1Vl=p;k.cs2Vl=w;break;case m._GREATER_EQUAL:case m._LESS:k.cs1Vl=w;k.cs2Vl=z;break;case m._IN:case m._NOT_IN:case m._IS_NULL:case m._IS_NOT_NULL:break;default:k.cs1Vl=w;k.cs2Vl=s;break;}k.cs1Idx=this.getIdx(k.cs1Vl);k.cs2Idx=this.getIdx(k.cs2Vl);if(k.dt!=30){k.cs1Nm=q(k.cs1Vl)?S.formatNumber(k.qua,k.cs1Vl,k.numFmts):k.items[k.cs1Idx].n;k.cs2Nm=q(k.cs2Vl)?S.formatNumber(k.qua,k.cs2Vl,k.numFmts):k.items[k.cs2Idx].n;}k.unit=this.getUnit();k.set("unSet",(k.dt==30||!o(k)||n(k)||(!k.cs||k.cs.length==0))&&!k.staticStatus);};this.updateOpCs=function(){var p=(k.cs1Vl>k.cs2Vl)?k.cs2Vl:k.cs1Vl,w=(k.cs1Vl>k.cs2Vl)?k.cs1Vl:k.cs2Vl,o=k.low,q=k.high,t=k.include,m=S.OP,n=(k.qua==S.Q._PT||k.qua==S.Q._PB),x,s=[];if((p>=o&&w<=q)||p<o||w>q){k.opId=(t)?m._BETWEEN:m._NOT_BETWEEN;}if(p==w){k.opId=(t)?m._EQUALS:m._NOT_EQUALS;}if(p==o&&w<q){k.opId=(t)?m._LESS_EQUAL:m._GREATER;}if(p>o&&w==q){k.opId=(t)?m._GREATER_EQUAL:m._LESS;}x=o==p&&w==q;if(!x){switch(k.opId){case m._BETWEEN:case m._NOT_BETWEEN:s.push({dtp:5,v:f.toLocaleString(p)+(n?"%":"")});case m._EQUALS:case m._NOT_EQUALS:s.push({dtp:5,v:f.toLocaleString(w)+(n?"%":"")});break;default:if(p>o){s.push({dtp:5,v:f.toLocaleString(p)+(n?"%":"")});}if(w<q){s.push({dtp:5,v:f.toLocaleString(w)+(n?"%":"")});}}}k.cs=s;k.parent.node.data.cs=s;k.set("unSet",x);};this.updateThumb=function(){var m=k.cs1Idx,p=k.cs2Idx;if(m!==undefined&&p!==undefined){var n=k.unit,o=k.gap;R.copy(M(k,k,H(m*n-o),H(p*n-o)),k);}};this.joinConst=function(){var o=k.cs;if(o){var m=[],n;for(n in o){m.push(o[n].v);}return m.join(",");}};}var h="<span {@ttpCssText}>{@content}</span>";function Z(){if(this.staticStatus){return null;}var n=this.ghost;if(!n){var q=this.containerNode.cloneNode(true),p=q.childNodes;e.addClass(q,["gh"]);n=this.ghost={containerNode:q,lowerRange:p[0],handle1Node:p[1],thumbNode:p[2],handle2Node:p[3],upperRange:p[4]};this.sdcNode.appendChild(q);}var l=this.orCfg,k=l.posCssP,m=l.lenCssP,o=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(z,s){var x=mstrmojo.all[o],w=x[z].style,t=n[z].style;if(s){t[k]=w[k];}t[m]=w[m];});n.containerNode.style.display="block";return n;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style="position:absolute;"><div class="bk" style="margin-top: 2px;{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:5px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:5px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},bgNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[3];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);},onunSetChange:function(){e.toggleClass(this.domNode.childNodes[1],"invalid",this.unSet);}},init:function X(k){this._super(k);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new Y(this);this.useRichTooltip=false;},unSet:false,preBuildRendering:function D(){var n=this.orCfg,m=this.isHoriz;n.cPosCssP=(m)?"right":"bottom";n.cLenCssP=(m)?"height":"width";var q=n.lenCssP,p=this[q],o=parseInt(p,10),l=this.handleSize;var k=this._length=(isNaN(o))?0:(o-l);if(k<=0){k=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-l;}if(p){this.bkCssText=q+":"+E(o-(2*this.cssBkBW),0)+"px;";this.sdcCssText=n.posCssP+":0px;"+q+":"+k+"px;"+n.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function b(){this._super();if(!this.staticStatus&&!this.da.nov){var l=this.lowNode,k=parseInt(l.style.fontSize,10);l.style.fontSize=this.highNode.style.fontSize=H((isNaN(k)?8:k)*this.parent.model.zf)+"pt";this.updateSummary();}},onmouseover:function J(k){this.showTooltip(k.e,self);},onmouseout:function G(k){this.hideTooltip(k.e,self);},summaryLabels:{db:K(8153,"Between ## and ###"),dnb:K(8154,"Not between ## and ###"),din:K(587,"In"),dnin:K(2204,"Not in"),dnull:K(2202,"Is Null"),dnnull:K(2203,"Is not Null"),req:K(8155,"Rank ="),rneq:K(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:K(8157,"Rank exclude bottom"),rext:K(8158,"Rank exclude top"),rb:K(8159,"Rank bottom"),rt:K(8160,"Rank top"),rbt:K(8161,"Rank between ## and ###"),rnbt:K(8162,"Rank not between ## and ###"),rin:K(8163,"Rank in"),rnin:K(8164,"Rank not in"),peq:K(8165,"Percent ="),pneq:K(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:K(8167,"Exclude bottom"),pext:K(8168,"Exclude top"),pb:K(7576,"Bottom"),pt:K(7575,"Top"),pbt:K(8153,"Between ## and ###"),pnbt:K(8154,"Not between ## and ###"),pin:K(8169,"Percent in"),pnin:K(8170,"Percent not in")},updateSummary:function A(){if(this.summaryNode&&!this.staticStatus){var z=this.f,x=this.ft,t=S,n=S.FN,m=S.MRPFN,w="",AB=(this.cs1Vl<this.cs2Vl)?this.cs1Nm:this.cs2Nm,AA=(this.cs1Vl>this.cs2Vl)?this.cs1Nm:this.cs2Nm,l=this.typeHelper,AC=this.summaryLabels,q=(x==t._GENERIC&&(z==n.ISNULL||z==n.ISNOTNULL||z==n.NOTIN||z==n.IN))||((x==t._PERCENT||x==t._RANK)&&(z==m.INASCENDING||z==m.INDESCENDING||z==m.NOTINDESCENDING||z==m.NOTINASCENDING));if(!this.unSet||q){switch(x){case t._GENERIC:switch(z){case n.EQUALS:w="= "+AB;break;case n.NOTEQUALS:w=String.fromCharCode(8800)+" "+AB;break;case n.GREATERTHAN:w="> "+AA;break;case n.GREATERTHANEQUALS:w=String.fromCharCode(8805)+" "+AB;break;case n.LESSTHAN:w="< "+AB;break;case n.LESSTHANEQUALS:w=String.fromCharCode(8804)+" "+AA;break;case n.BETWEEN:w=AC.db.replace("##",AB).replace("###",AA);break;case n.NOTBETWEEN:w=AC.dnb.replace("##",AB).replace("###",AA);break;case n.ISNULL:w=AC.dnull;break;case n.ISNOTNULL:w=AC.dnnull;break;case n.IN:w=AC.din+" "+l.joinConst();break;case n.NOTIN:w=AC.dnin+" "+l.joinConst();break;}break;case t._PERCENT:case t._RANK:var k="r";if(x==t._PERCENT){k="p";}switch(z){case m.EQUALSDESCENDING:case m.EQUALSASCENDING:w=AC[k+"eq"]+" "+AB;break;case m.NOTEQUALSDESCENDING:case m.NOTEQUALSASCENDING:w=AC[k+"neq"]+" "+AB;break;case m.GREATERTHANEQUALSASCENDING:w=AC[k+"exb"]+" "+AB;break;case m.GREATERTHANASCENDING:w=AC[k+"exb"]+" "+AA;break;case m.GREATERTHANEQUALSDESCENDING:w=AC[k+"ext"]+" "+AB;break;case m.GREATERTHANDESCENDING:w=AC[k+"ext"]+" "+AA;break;case m.LESSTHANASCENDING:w=AC[k+"b"]+" "+AB;break;case m.LESSTHANEQUALSASCENDING:w=AC[k+"b"]+" "+AA;break;case m.LESSTHANDESCENDING:w=AC[k+"t"]+" "+AB;break;case m.LESSTHANEQUALSDESCENDING:w=AC[k+"t"]+" "+AA;break;case m.BETWEENDESCENDING:case m.BETWEENASCENDING:w=AC[k+"bt"].replace("##",AB).replace("###",AA);break;case m.NOTBETWEENASCENDING:case m.NOTBETWEENDESCENDING:w=AC[k+"nbt"].replace("##",AB).replace("###",AA);break;case m.INASCENDING:case m.INDESCENDING:w=AC[k+"in"]+" "+l.joinConst();break;case m.NOTINDESCENDING:case m.NOTINASCENDING:w="";w=AC[k+"nin"]+" "+l.joinConst();break;}break;}}var o=this.summaryNode,p=(w!=="")?"":0;o.innerHTML=w;o.style.margin=p;if(this.hasRendered&&this.height==null){this.parent.updateHeight();}}},getClientHeight:function W(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function V(o,k){if(!this.staticStatus&&!this.da.nov){k=k||window;var p=a.eventTarget(k,this.dnd.startE);if(p===this.handle1Node||p===this.handle2Node){var n=Z.call(this),l=this.orCfg,m=this.dnd;m.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10),length:this._length,contL:n.containerNode[l.lenP],offset:a.getMousePosition(this.dnd.startE,k)[l.offsetP]};m.initD.td=p;e.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function I(s,q){if(!this.staticStatus){q=q||window;var w=this.dnd.initD;if(w){var AC=this.ghost,AD=w.handle1,n=w.handle2,p=this.cs1Idx,m=this.cs2Idx,AB=this.unit,z=this.gap,l=w.length;var AA=a.getMousePosition(s,q)[this.orCfg.offsetP]-w.offset;switch(w.td){case this.handle1Node:AD=E(C(E(w.handle1+AA,0),l)-z,-1);p=E(B(AD/AB+0.5),0);break;case this.handle2Node:n=E(C(E(w.handle2+AA,0),l)-z,-1);m=E(U.ceil(n/AB+0.5),0);break;default:return ;}M(this,AC,AD,n);var t=this.items,k=(t&&t.length)||0;if(k&&p>=0&&p<k&&m>=0&&m<k){var o=false;if(p!==this.cs1Idx){this.cs1Idx=p;var x=this.items[p];this.cs1Vl=x.v;this.cs1Nm=x.n;o=true;}if(m!==this.cs2Idx){this.cs2Idx=m;var x=this.items[m];this.cs2Vl=x.v;this.cs2Nm=x.n;o=true;}if(o){this.typeHelper.updateThumb();this._updateTooltip(w.td);}}}}},ondrop:function g(l){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var k=this.ghost;if(k){k.containerNode.style.display="none";}this.hideTooltip(l,self);if(this.items&&this.items.length){this[(a.eventTarget(self,l)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function O(k,w,x){var n=this.typeHelper,p=this.cs1Vl,o=this.cs2Vl,l=this.qua,m=this.numFmts;this.cs1Idx=n.getIdx(p);this.cs2Idx=n.getIdx(o);var t=function(q,AA){var z=AA||[];return q==0||q==z.length-1;},s=K(7622);this.cs1Nm=t(this.cs1Idx,this.items)&&!this.frtUst?s:S.formatNumber(l,p,m);this.cs2Nm=t(this.cs2Idx,this.items)&&!this.ndUst?s:S.formatNumber(l,o,m);n.updateOpCs();this.onlyInclude=!!k;this.changeQual=!!w;this.unSet=!!x||this.unSet;this.updateSummary();this.onselectionChange();},onincludeChange:function N(){if(!this.staticStatus){this.selectRange(true);}},showTooltip:function F(l,k){var m=a.eventTarget(k,l);this._updateTooltip(m);mstrmojo.tooltip.open(this,l,k);},_updateTooltip:function T(o){var l=this.orCfg,n=l.posCssP,k,m={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};m[l.opPosCssP]=-parseInt(this.font)/2;m[n]=o.style[n];if(this.unSet){k=K(7622);}else{k=String((o===this.handle1Node)?this.cs1Nm:this.cs2Nm);}m.content=h.replace(/\{@content\}/g,k);this.set("richTooltip",m);},onclick:function j(k){if(!this.staticStatus&&!this.da.nov){var l=a.eventTarget(k.hWin||window,k.e);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((l===this.handle1Node)?this.handle1Node:((l===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(l===this.handle1Node),tgt:l});if(this._onThumb){this._onThumb(k);}}},onselectionChange:function Q(k){this._super(k);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function P(k){var m=mstrmojo.MCSUtil.getFuncInfo(this.opId,k.valueWas),n=mstrmojo.MCSUtil.getFuncInfo(this.opId,k.value),l;if(m.ft!=n.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();l=true;}}else{this.f=mstrmojo.MCSUtil.getFuncInfo(this.opId,k.value).f;l=false;}this.selectRange(false,true,l);},updateData:function i(k,l){this.da=k;this.updateExpr(l);},updateExpr:function L(k){if(k){this.cs=k.cs;this.f=k.f;this.ft=k.ft;this.qua=k.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",C(E(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var m=this.opener,l=this.children[0];if(m){var k=this.isfrt?m.cs1Vl:m.cs2Vl;if(this.isfrt){if((m.cs1Vl<=m.low||m.cs1Vl>=m.high)&&!m.frtUst){k="";}}else{if((m.cs2Vl<=m.low||m.cs2Vl>=m.high)&&!m.ndUst){k="";}}l.edt.set("value",f.toLocaleString(k));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!=0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(l){if(this.parent.apply.enabled){var k=l.hWin,m=l.e||k.event;if(m.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var l=this.parent.parent,m=l.opener,k=this.parent.edt.value;if(l&&m&&String(k).length>0){m[l.isfrt?"cs1Nm":"cs2Nm"]=k;k=f.parseNumeric(k);m[l.isfrt?"cs1Vl":"cs2Vl"]=k;}m[l.isfrt?"frtUst":"ndUst"]=true;m.selectRange();m.typeHelper.updateThumb();l.close();}}]}]},openEditValue:function(k){this.openPopup("editValueRef",k);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo._IsInputControl","mstrmojo.dom","mstrmojo.num");var J=mstrmojo.validation,C=J.STATUSCODE,F=J.VALIDATOR,D=mstrmojo.expr.DTP,B=0,A=1,I=2,H=3,G=4,E=5;mstrmojo.TextFieldDIC=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",dtp:D.VARCHAR,validationDelay:0,getInputNode:function(){return this.inputNode;},focus:function(){this.validate();mstrmojo.dom.setCaret(this.domNode,(this.value&&this.value.length||0));},init:function(K){if(this._super){this._super(K);}this.constraints=mstrmojo.hash.copy();var M=K.dic,N=this.constraints={trigger:mstrmojo.validation.TRIGGER.ONKEYUP},L=M.dt;if(M.ml){this.maxLength=M.ml;}if(M.psw){this.type="password";this.value=this.lv="";this.owner.applyPasswordMask&&this.owner.applyPasswordMask();}if(J.isNumeric(L)||J.isInt(L)||J.isString(L)){this.dtp=L;}switch(M.vm){case A:N.validator=F.VALIDATE_PHONENO;break;case I:N.validator=F.VALIDATE_EMAIL;break;case H:N.validator=F.VALIDATE_ZIPCODE;break;case G:N.validator=F.VALIDATE_SSN;break;case E:N.regExp=new RegExp("^"+M.rgx+"$");break;}N.min=M.emin?M.min:null;N.max=M.emax?M.max:null;N.maxLen=(M.ml!==undefined)?M.ml:null;N.minLen=(M.mnl!==undefined)?M.mnl:null;if(M.req||M.emin){this.required=true;}},onInvalid:function(){if(this.popup){this.popup.set("hasInvalidData",true);}},onValid:function(){if(this.popup){this.popup.set("hasInvalidData",false);}},applyChanges:function(){this.validate();if(this.isValid()){this._super();}else{this.handleInvalid();return false;}return true;},handleInvalid:function(){if(mstrmojo.all.mojoConfirmx9){return ;}var K=this;mstrmojo.confirm(this.validationStatus.msg+"<br>("+mstrmojo.desc(9199)+")",[{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1442),onclick:function(){K.focus();}},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(221),onclick:function(){K.popup.onCancel();}}],mstrmojo.desc(7548));},cancelChanges:function(){this.inputNode.blur();this.value=this.lv;this.clearValidation();}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.fx","mstrmojo.css","mstrmojo.DropDownButton");var E=1,L=2,B=null,A=null,F=mstrmojo.dom,G=mstrmojo.css;var C=400;function H(V,R,N,O,U,M,Q,T){var S={duration:C,target:R,onEnd:function(){if(M){M();}},props:{}};S.props[N]={ease:Q||mstrmojo.ease.sin,start:parseInt(O,10),stop:parseInt(U,10),suffix:"px"};S=mstrmojo.hash.copy(T,S);var P=new mstrmojo.fx.AnimateProp(S);P.play();return P;}mstrmojo.ElasticTextArea=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ElasticTextArea",markupString:'<div id="{@id}" class="mstrmojo-ElasticTextArea {@cssClass}" style="{@cssText}" mstrAttach:blur ><div class="mstrmojo-ElasticTextAreaContent " style="height: 100%;"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvalueChange:function(){if(this.textNode&&this.value!==this.textNode.textArea.value){this.textNode.textArea.set("value",this.value);this.adjustStatusBar();}},onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onwidthChange:function(){if(this.domNode&&this.width){this.domNode.style.width=this.width+"px";}},ontopChange:function(){if(this.domNode&&this.top){this.domNode.style.top=this.top+"px";}},onleftChange:function(){if(this.domNode&&this.left){this.domNode.style.left=this.left+"px";}}},width:200,height:30,resize:"none",maxLength:256,value:"",postCreate:function(){this.minHeight=this.height;var M=this;this.children=[{scriptClass:"mstrmojo.Box",alias:"textNode",cssText:"width:100%;",onheightChange:function(O){var P=this.parent.minHeight,Q=Math.max(P,O.valueWas||0),N=Math.max(P,O.value);if(Q!==N){if(F.isIE7){this.textArea.domNode.style.height=this.domNode.style.height=N+"px";}else{if(this._slidingFx&&this._slidingFx.isPlaying){this._slidingFx.props.height.stop=N;}else{this._slidingFx=H(true,this.domNode,"height",Q,N);}}}},children:[{scriptClass:"mstrmojo.TextArea",alias:"textArea",cssClass:"eta-text",cssText:"width:100%;height:100%;",rows:1,bindings:{maxLength:"this.parent.parent.maxLength"},onblur:function(N){if(M.onblur){M.onblur(N);}},onkeyup:function(P){var Q=this.maxLength,N=this.value.length;if(Q<=N&&!this.isArrowKeys&&!this.isDeleteKeys){if(F.isIE7||F.isIE8){this.value=this.domNode.value=this.value.substr(0,Math.min(N,Q));}return false;}var O=this.parent.parent;O.set("value",this.value);O.adjustStatusBar();}},{scriptClass:"mstrmojo.Label",cssClass:"eta-text ghost",alias:"ghost",cssText:"visibility: hidden; z-index:-1; position:absolute;left:0; top:0;  word-wrap:break-word; border:1px solid red; none; margin:0; padding:2; width:100%;",bindings:{text:"this.parent.parent.value"},_setHeight:function(O){var N=Math.max(O||0,this.domNode.clientHeight);this.parent.set("height",N);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.ontextChange=function(N){if(this.domNode&&this.text){this.domNode.innerHTML=this.text.replace(/<br \/>&nbsp;/,"<br />").replace(/<|>/g," ").replace(/&/g,"&amp;").replace(/\n/g,"<br />&nbsp;");}this._setHeight();};},postBuildRendering:function(N){if(this._super){this._super(N);}this._setHeight(this.parent.parent.height);}}]},{scriptClass:"mstrmojo.Label",alias:"statusBar",cssClass:"eta-bar",text:""},{scriptClass:"mstrmojo.Label",alias:"msgBoxTip",cssClass:"eta-tip",cssText:F.isIE8?"bottom: -4px;":""}];},preBuildRendering:function D(){this._super();this.textNode.height=0;},postBuildRendering:function J(){if(this._super){this._super();}this.textNode.textArea.set("value",this.value);this.adjustStatusBar();},onmaxLengthChange:function(M){if(M.value){this.adjustStatusBar();}},onfontChange:function(M){var P=this.textNode.textArea,O=this.textNode.ghost,N;for(N in this.font){this.domNode.style[N]=this.font[N];if(F.isIE7){P.domNode.style[N]=this.font[N];O.domNode.style[N]=this.font[N];this.statusBar.domNode.style[N]=this.font[N];}}if(F.isIE9){P.refresh();}O._setHeight();},adjustStatusBar:function(){if(!this.msgBoxTip.domNode){return ;}var P=this,S=this.maxLength,T=this.textNode.textArea,R=(T.value&&T.value.length)||0,Q=R/S,N=this.statusBar,M=this.msgBoxTip;var O=Q*this.width;M.domNode.style.left=Math.min(Math.ceil(O-M.domNode.offsetWidth/2),this.width-3)+"px";N.set("text",mstrmojo.desc(4891,R+" of "+S).replace("##",R).replace("###",S));},focus:function(){F.setCaret(this.textNode.textArea.domNode,((this.value&&this.value.length)||0));}});mstrmojo.ElasticTextAreaButton=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.ElasticTextAreaButton",cssClass:"mstrmojo-ElasticTextAreaButton",popupToBody:false,popupWidth:200,maxLength:256,unrender:function I(M){var N=this.popupRef;if(this.popupToBody&&N.hasRendered){N.unrender(false);}if(this._super){this._super(M);}},postBuildRendering:function J(){if(this._super){this._super();}if(this.value&&this.value.length>0){G.addClass(this.domNode,"filled");}},premousedown:function K(N){if(this.popupToBody){var Q=F.position(this.popupNode,true),P=this.popupRef,M={left:Math.round(Q.x)+"px",top:Math.round(Q.y)+"px"};if(!P.hasRendered){delete P.slot;M.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(M,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this.popupRef.eta){this.popupRef.eta.set("value",this.value);}else{this.popupRef.children[0].value=this.value;}if(this._super){this._super();}var O=this.popupRef.domNode;if(O){O.style.minWidth=(this.domNode.offsetWidth-2)+"px";}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-ElasticTextAreaPopup",shadowNodeCssClass:"mstrmojo-ElasticTextAreaPopup-shadow",contentNodeCssClass:"mstrmojo-ElasticTextAreaPopup-content",autoCloses:false,locksHover:true,visible:true,onOpen:function(){var N=this.eta,O=N.domNode.firstChild,P=0,M;this.eta.set("font",this.opener.font);O.parentNode.style.display="block";G.addClass(this.opener.domNode,"editing");O.parentNode.style.overflow="hidden";M=this._h||(O.offsetHeight);H(false,O,"height",P,M,function(){O.style.height="100%";O.parentNode.style.overflow="visible";N.focus();});},onClose:function(){this.visible=false;var O=this.eta.domNode,N=O.firstChild,P=N.offsetHeight,M=0;this._h=P;this.opener.set("value",this.eta.value);G.removeClass(this.opener.domNode,"editing");N.style.height=N.offsetHeight+"px";O.style.overflow="hidden";H(false,N,"height",P,M,function(){O.style.display="none";});},children:[{scriptClass:"mstrmojo.ElasticTextArea",alias:"eta",bindings:{width:function(){return this.parent.opener.popupWidth;},maxLength:function(){return this.parent.opener.maxLength;}}}]}});}());(function(){var BUILDER_METHOD={BUTTON:"newButton",PICKERBUTTON:"newPickerButton",LIST:"newList",SEPARATOR:"newSeparator",TEXT:"newCustom"};function cmdMethodName(cmdid){return(cmdid==="export")?cmdid+"Cmd":cmdid;}function bindEnabled(enabledFeatures){var arr=enabledFeatures.split(","),txt=[],i,len;for(i=0,len=arr.length;i<len;i++){var s=arr[i],neg=s.match(/^\!/);if(neg){s=s.replace("!","");}txt.push((neg?"!":"")+"this.target.model.features['"+s+"']");}return txt.join(" && ");}function bindItems(cmdid){return"var t = this.target, c = this.cmdid; if (t && c) {if (t.requiresMethod) t.requiresMethod(c); return this.target."+cmdid+"Options;}";}function bindSelectedItem(cmdid){return"var x = this.items; var t = this.target, c = this.cmdid; if (t && c){ if (t.requiresMethod) t.requiresMethod(c); return this.target."+cmdid+"Value;}";}function openLink(json){var link=json.link,h=link&&link.href,t=link&&link.target,xtraUrl=json["extra-url"];if(!link||!h){return ;}if(xtraUrl){h+="&"+xtraUrl;}if(link["use-window-open"]){t="_blank";}window.open(h,t?t:"_self");}mstrmojo.ToolBarBuilder={scriptClass:"mstrmojo.ToolBarBuilder",build:function build(nodes,model,config){var arr=[],i,len;for(i=0,len=(nodes&&nodes.length)||0;i<len;i++){var json=nodes[i],n=BUILDER_METHOD[(json&&json.type)||"SEPARATOR"],w=this[n]&&this[n](json,config);if(w){arr.push(w);}}return arr;},newButton:function nwBtn(json,config){if(json["on-click"]||json.link){return this.newCustom(json,config);}var c=cmdMethodName(json.cmdid);return new mstrmojo.Button({title:json.tooltip,iconClass:json.id,cssClass:"mstrmojo-InteractiveButton",target:config&&config.target,cmdid:c,onclick:function(e){var t=this.target,ci=this.cmdid;t.requiresMethod(ci);t[ci](e);},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null});},newPickerButton:function nwPkrBtn(json,config){var c=cmdMethodName(json.cmdid);var bs;if(!json.items){bs={};bs.items=bindItems(c);}if(json.enabledFeatures){bs=bs||{};bs.enabled=bindEnabled(json.enabledFeatures);}function oc(){var t=this.target,ci=this.cmdid,its=this.items,idx=this.selectedIndex;t.requiresMethod(ci);t[ci](its[idx].dssid);}return new mstrmojo.PickerButton({title:json.title||"",iconClass:json.id,items:json.items,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,size:1,selectedIndex:parseInt(json.selectedIndicesList,10)||0,target:config&&config.target,cmdid:c,onchange:oc,bindings:bs});},newList:function nwLst(json,config){var c=cmdMethodName(json.cmdid),bs={selectedItem:bindSelectedItem(c)};if(!json.items){bs.items=bindItems(c);}if(json.enabledFeatures){bs.enabledFeatures=bindEnabled(json.enabledFeatures);}return new mstrmojo.SelectBox({size:1,tooltip:json.title||"",iconClass:json.id,cmdid:c,target:config&&config.target,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,onchange:function(){var t=this.target,ci=this.cmdid,itm=this.selectedItem;t.requiresMethod(ci);t[ci](itm&&itm.dssid);},items:json.items,bindings:bs});},newSeparator:function nwSep(json,config){return new mstrmojo.ToolSeparator(json);},newCustom:function newCstm(json,config){var b=new mstrmojo.Button({markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass}" title="{@title}" style="{@cssText}" mstrAttach:click,mousedown,mouseup><div id="{@iconClass}" class="mstrmojo-Button-text"></div></div>',title:json.tooltip,cssClass:"mstrmojo-InteractiveButton",onclick:function(){if(json.link){openLink(json);}if(json["on-click"]){eval(json["on-click"]);}},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null}),v=json.value;b.text=v||"";b.cssText=v?"width:auto;margin-top:4px;":"";b.title=json.tooltip||"";b.iconClass=json.id||"";return b;}};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var O=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],V=["width","height"],l="p_fmts";var j="px";var h={getContentHeight:function(o,q){var p=q.ttl&&q.ttl.height;if(o&&p&&!this.floatingToolbar){return Math.max(parseInt(o,10)-parseInt(p,10),0)+j;}return"";},getPortletMinHeight:function(o){return o.ttl.height;},adjustTitleCss:function(o){return ;}};var f={getContentHeight:function(o,p){return o;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(o){o.titlebarNodeClass+=" floating";return ;}};function A(s,p){var q=this.parent,o=s+"DirtyKey";if(q[o]){q[o](p);}}function N(){var o=this.title;if(this.count){o+=" "+this.count;}this.toolbarTitleTextNode.innerHTML=o;}function g(){var p=this.parent,s=p&&p.defn;if(s&&parseInt(s.t,10)===mstrmojo.EnumRWUnitType.PANEL){var o=p.parent,q=o.defn;if(q&&q.ifp){return o;}}return null;}var P=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;">{@title} {@count}</div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){N.call(this);},oncountChange:function(){N.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B"],shadowNode:["RW","B","fx","background-color"],titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]},buttonbarNode:{src:"ttl",props:["background-color"]}},fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:h,getCacheKey:function F(o){return this._super(o)+"-portlet";},getFormats:function L(){var p=this.content,o=p&&p.getFormats();return o&&o[l];},updateContentHeight:function b(t){var o=this.getFormats(),p=this.content,s=p.dimNode||p.domNode,q=((o.ttl&&parseInt(o.ttl.height,10))||0);if(s){if(!t){q+=((this.fc||this.isInFilterPanel())?s.offsetHeight:(o.height?parseInt(o.height,10):0));}this.containerNode.style.height=q+j;this.shadowNode.style.height=q+j;}},init:function m(o){this._super(o);var p=this.content;if(p&&p.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var p=this._ts=(this.floatingTitle)?f:h;this._super();p.adjustTitleCss(this);var o="display:none;";if(this.isInFilterPanel()){var q=P.clone(this.formatHandlers);q.portletContainerNode=["z-index","height","B","backgroud-color"];q.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=q;}if(!this.leftToolbar){this.leftToolbarNodeCssText+=o;}if(!this.toolbar){this.toolbarNodeCssText+=o;}var s=mstrmojo._Formattable.getBorderWidths(this);if(s.l||s.t||s.r){this.borderCss="has-border";}},postBuildRendering:function W(){var q=mstrmojo.dom,s=mstrmojo.css,x=this.contentNode,AB=this.titleNode,z=this;if(this.titleNode){if(this.floatingTitle){document.body.appendChild(this.titleNode);if(!this._onhover){this._onhovertt=function(){s.addClass(z.titleNode,["visible"]);z._onflt=true;return true;};this._onhoverofftt=function(){s.removeClass(z.titleNode,["visible"]);z._onflt=false;return true;};this._onhover=function(){var AC=z.titleNode;s.addClass(AC,["visible"]);var AD=q.position(z.contentNode,true);AC.style.top=(AD.y-AC.clientHeight+2)+j;AC.style.left=AD.x+j;return true;};this._onhoveroff=function(){s.removeClass(z.titleNode,["visible"]);return true;};}q.attachEvent(x,"mouseover",this._onhover);q.attachEvent(x,"mouseout",this._onhoveroff);q.attachEvent(AB,"mouseover",this._onhovertt);q.attachEvent(AB,"mouseout",this._onhoverofftt);}if(this.attachContextMenuEvent){this._oncontextmenu=function(AD,t){var AC=z.rightToolbar&&z.rightToolbar.btnMenu;if(AC){AC.cmPos=q.getMousePosition(AD,t);AC.openPopupMenu();AC.cmPos=null;q.preventDefault(t,AD);}};q.attachEvent(AB,"contextmenu",this._oncontextmenu);}}if(this._super){this._super();}var w=this.getFormats();this.set("fc",w&&!w.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var o=this.portletContainerNode.style,p=this.shadowNode.style,AA=this.parent;o.width=p.width="99%";o.top=p.top=AA.topStart+j;o.left=p.left=G+j;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(w.left)+G*this.orgPos+j;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}},adjustFPHeight2Fit:function(){var q=mstrmojo.dom,o=q.position(this.titleNode),p=q.position(this.contentNode).y-o.y-o.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height)-p+"px";},unrender:function E(p){if(this.floatingTitle&&this.titleNode){var s=this.domNode,o=this.titleNode,q=mstrmojo.dom;if(s&&this._onhover){q.detachEvent(s,"mouseover",this._onhover);}if(s&&this._onhoveroff){q.detachEvent(s,"mouseout",this._onhoveroff);}if(o&&this._onhovertt){q.detachEvent(o,"mouseover",this._onhovertt);}if(o&&this._onhoverofftt){q.detachEvent(o,"mouseout",this._onhoverofftt);}if(o&&this._oncontextmenu){q.detachEvent(o,"contextmenu",this._oncontextmenu);}if(o){document.body.removeChild(o);}}if(this._super){this._super(p);}},updateStyle:function(p,o){var s=this.shadowNode.style,q=this.containerNode.style;s.height=q.height=p;s.width=q.width=o;},_createFormats:function T(){var t=this.content&&this.content.getFormats(),q;q=t.p_fmts={};var o,s;for(o in O){s=O[o];if(s in t){q[s]=t[s];delete t[s];}}for(o in V){s=V[o];if(s in t){q[s]=t[s];}}t.height=this._ts.getContentHeight(t.height,q);if(mstrmojo.dom.isIE&&q.fx&&q.fx.ds&&!q["background-color"]){q["background-color"]="#ffffff";}},refresh:function n(){if(!this.hasRendered){return ;}var p=this.children,o;for(o=p.length-1;o>=0;o--){p[o].refresh();}},isInFilterPanel:function K(){return(g.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var o=this.getFilterPanel();return o&&o.defn&&o.defn.fds==2;}else{return false;}},getFilterPanel:function H(){return g.call(this);},getContainerHeight:function a(){return this.containerNode.clientHeight;},relocate:function C(p,o){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=p+j;}},setInfoWindowDimensions:function k(t){var p=this.domNode.style,o=this.shadowNode.style,q=this.portletContainerNode.style,s=mstrmojo._Formattable.getBorderWidths(this);t.h-=s.h;t.w-=s.w;o.height=q.height=p.height=t.h+j;o.width=q.width=p.width=t.w+j;t.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function J(o){A.call(this,"add",o);},removeDirtyKey:function I(o){A.call(this,"remove",o);},setDirtyChildren:function X(){var o=this.content;if(o&&o.setDirtyChildren){o.setDirtyChildren.apply(o,arguments);}}});var U=0,M=1,i=2;function Y(AE,AC,o,AF){var AB=this.content,AD=AB.k,AA=mstrmojo.boxmodel.px2Inches,q=AB.model.docModel||AB.model,s=this.getFormats(),AG={},z=this,t=function(){var w=z.content&&z.content.defn;if(w){w.set("ds",AE);}},p={ZIndex:s["z-index"],WindowState:AE},x={};x[AD]=p;if(AC!==undefined&&o!==undefined){P.copy({OldHeight:AA(q,AC),OldWidth:AA(q,o),Height:AA(q,parseInt(s.height,10)),Width:AA(q,parseInt(s.width,10))},p);AG.success=function(w){var AH=w&&w.data;if(AH){AB.model.loadPartialData(AH,AD);}t();var AI=z.parent;if("adjustSectionSize" in AI){AI.adjustSectionSize();}};q.saveRWProps(AD,x,1,this.loadDataOnResize,AG,true);}else{t();if(!(AF&&AF.all)){q.saveRWProps(AD,x,1,this.loadDataOnResize,AG,true);}}return x;}function R(){var z=this.content;if(!z){return ;}var w=function(p){mstrmojo.array.forEach(p,function(AD){if("ds" in AD){AD.set("visible",(AD.ds!==z.defn.ds));}});},AA;if(this.isInFilterPanel()){var s=(parseInt(this.defn.ds,10)===U);z.set("visible",s);this.updateContentHeight(!s);AA=this.leftToolbar;w(AA&&AA.children);var t=this.parent;if(t.refreshFP){t.refreshFP();}}else{var o=z.getFormats(),AB=this.getFormats(),q=this.portletContainerNode.style,AC=this.shadowNode.style,x=this.contentNode.firstChild.style;x.height=o.height;x.width=o.width;AC.height=q.height=AB.height;AC.width=q.width=AB.width;AC.top=q.top=AB.top;AC.left=q.left=AB.left;if("z-index" in AB){AC.zIndex=q.zIndex=AB["z-index"];}AA=this.rightToolbar;w(AA&&AA.children);if(z.resize){z.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function T(){this._super();var p=this.getFormats();var o=parseInt(this.defn.ds,10);if(o===U){p.normHeight=p.height;p.normWidth=p.width;if(p["z-index"]!==null&&p["z-index"]!==undefined){p.normZIndex=p["z-index"];}}if(o!==i){p.normTop=p.top;p.normLeft=p.left;}},onmaximize:function e(){var t=this.parent,z=this.content,x=z&&z.getFormats(),s=this.getFormats(),q=s.height,o=s.width,w=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();z.clearCache();s.height=(parseInt(t.height(),10)-w.h)+j;x.height=this._ts.getContentHeight(s.height,s);s.width=x.width=(t.width()-w.w)+j;s.top=s.left=0;s["z-index"]=t.getMaxZIndex()+1;Y.call(this,i,q,o);},onminimize:function Z(){var w=this.content,p=w.dimNode||w.domNode,t=w&&w.getFormats(),s=this.getFormats(),q=s.height||p.offsetHeight,o=s.width;this.clearCache();w.clearCache();s.width=t.width=s.normWidth;s.top=s.normTop;s.left=s.normLeft;if(s.normZIndex!==null&&s.normZIndex!==undefined){s["z-index"]=s.normZIndex;}t.height=0;s.height=this._ts.getPortletMinHeight(s);Y.call(this,M,q,o);},onrestore:function Q(){var t=this.content,s=t&&t.getFormats(),q=this.getFormats(),p=q.height,o=q.width;this.clearCache();t.clearCache();q.height=q.normHeight;s.height=this._ts.getContentHeight(q.height,q);q.width=s.width=q.normWidth;q.top=q.normTop;q.left=q.normLeft;if(q.normZIndex!==null&&q.normZIndex!==undefined){q["z-index"]=q.normZIndex;}Y.call(this,U,p,o);},oncollapse:function S(o){return Y.call(this,M,undefined,undefined,o);},onexpand:function D(o){return Y.call(this,U,undefined,undefined,o);},postBuildRendering:function W(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,R);}this._super();if(this.isInFilterPanel()){var o=(parseInt(this.defn.ds,10)===U);this.updateContentHeight(!o);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TimePicker","mstrmojo._IsInputControl");var A=2,B=mstrmojo.date;mstrmojo.TimePickerDIC=mstrmojo.declare(mstrmojo.TimePicker,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TimePickerDIC",popupStyle:2,init:function(C){if(this._super){this._super(C);}this.set("interval",this.dic.itv);this.set("active",A);},getCurValue:function(){if(this.dic.dt==mstrmojo.expr.DTP.TIMESTAMP){var F=B.parseDateAndOrTime(this.value),G=F&&F.time,D=F&&F.date,C,E;if(G&&!D){C=B.parseDateAndOrTime(this.lv),D=C&&C.date;if(!D){E=new Date();D={day:E.getDate(),month:E.getMonth()+1,year:E.getFullYear()};}return B.formatDateInfo(D,mstrmojo.locales.datetime.DATEOUTPUTFORMAT)+" "+B.formatTimeInfo(G,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}}return this.value;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList");mstrmojo._IsTableLayoutListDIC=mstrmojo.provide("mstrmojo._IsTableLayoutListDIC",{_mixinName:"mstrmojo._IsTableLayoutListDIC",icnCss:"dicContainer",tableLayoutCssStyle:"fixed",setDirtyFlag:function(D,C){if(D.className!=="flag-container"){var B=document.createElement("div"),A=this.itemsNode&&this.itemsNode.clientWidth-8;B.className="flag-container";B.style.left=(A>0?A:0)+"px";B.innerHTML='<div class="dirty-cell"/>';C.insertBefore(B,D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.DocButton");var B=mstrmojo.dom;mstrmojo.express.ui.DocButton=mstrmojo.declare(mstrmojo.DocButton,null,{scriptClass:"mstrmojo.express.ui.DocButton",premousedown:function A(C){if(B.getButton(C.hWin,C.e)===1){var E=this.id,D="pressed";this.set(D,true);B.attachOneTimeEvent(document,"mouseup",function(){var F=mstrmojo.all[E];if(F){F.set(D,false);}},true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.GraphBase","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo.tooltip");var F=mstrmojo.dom;function M(P){var Q=P.getFormats();if(!Q.width&&"gp" in Q){Q=Q.gp;}P.resizeForDisplayState(parseInt(Q.height,10),parseInt(Q.width,10),false);}function A(Q){var P=F.position(this.domNode),R=F.getMousePosition(Q);return{x:parseInt(R.x-P.x,10),y:parseInt(R.y-P.y,10)};}function O(V,U){var R=F.eventTarget(U,V),T=R&&R.parentNode,W=T&&T.children,P=[],S=R.getAttribute("coords");if(W&&!!S){for(var Q=0;Q<W.length;++Q){if(W[Q]&&W[Q].getAttribute&&W[Q].getAttribute("coords")==S){P.push(W[Q]);}}}return P;}mstrmojo.DocXtabGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocXtabGraph",cssClassPrefix:"mstrmojo-DocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" onclick="mstrmojo.all[\'{@id}\'].onClickArea(this, event);" onmousemove="mstrmojo.all[\'{@id}\']._updateTooltip(event, self);" {@extra}/>',_att:"",markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","background-color","fx"]},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},onClickArea:function B(R,T){T=T||window.event;var Y=A.apply(this,[T]),U=this.defn,P=F.position(this.domNode),Q=this.as[R.getAttribute("aid")],X=this.k,W=Y.x,V=Y.y,S={getBoundingClientRect:function(){var a=P.x+W,Z=P.y+V;return{left:a,top:Z,right:a+1,bottom:Z+1};},w:this};this.showInfoWin(Q.tks,S);this.model.slice({type:parseInt(U.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:X,ck:U.ck,gk:X,tks:Q.tks,cks:Q.cks,sid:this.node.data.sid,x:W,y:V,anchor:S,tty:Q.tty});},showInfoWin:function G(T,Q){var P=this.model,S=T&&P.getTargetInfoWin(T);if(S&&S.length){for(var R=0;R<S.length;R++){P.showInfoWin(S[R],Q,"h");}}},showTooltip:function N(R,Q){this._updateTooltip(R,Q);var P=O(R,Q);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.open(this,R,Q,P);}else{this._super(R,Q);}},_updateTooltip:function L(P,Q){this.updatingTooltipHelper(F.eventTarget(Q,P),A.apply(this,[P]));},hideTooltip:function J(S,R){var Q=F.eventTarget(R,S);if(Q.getAttribute("aid")===this.cAreaIdx){this.cAreaIdx=-1;var P=O(S,R);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.close(this,S,R,P);}else{this._super(S,R);}}},update:function D(P){this.node.data=P.data;this.as=P.data.as;var b="\u001E",R=this.model,X=R.getCGBMap&&R.getCGBMap(),Q=this.as||[],V,T;for(V=0;V<Q.length;V++){var Y=Q[V],U=Y&&Y.tgbs;if(U){var W=U.split(b);var Z={};for(T=0;T<W.length;T++){var S=X&&X[W[T]];if(S){Z[S]=true;}else{Z[W[T]]=true;}}Y.tks=mstrmojo.hash.keyarray(Z).join(b);}}this.eg=P.data.eg;},retrieveGraphSrc:function I(Q,P){var S=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(P,10)+"&height="+parseInt(Q,10)+"&sessionState="+mstrApp.sessionState,R=this.imgNode;if(R.src!==S){R.src=S;}},resize:function(){M(this);},resizeForDisplayState:function E(R,Q,U){var T=this.getFormats(),S=this.imgNode;if(U){var P=this.domNode.style;P.top=T.top;P.left=T.left;P.height=T.height;P.width=T.width;}if(S){S.style.height=R+"px";}if(!this.eg){this.retrieveGraphSrc(R,Q);if(R){this.refreshMap();}}}});function H(P){if(P&&P.getAttribute){var Q=P.getAttribute("coords");Q=Q&&Q.split(",");if(Q&&Q.length>=3){return Q[2]-Q[0];}}return 0;}function C(R){var Q=[],V=document.body.offsetWidth,P=document.body.offsetHeight,W=0,T=0,Y=K[0]&&K[0].domNode?K[0].domNode.offsetLeft:0,X=K[0]&&K[0].domNode?K[0].domNode.offsetTop:0,b=Math.ceil(K.length/2),S=5,a=function(f,e){if(f+R+e+S>V){return V-R-e-S;}else{if(K.length>1&&f-e-S<0){return e+S;}}return f;},Z=function(h,f,e){h+=f;var g=e==1?f:(e*f+(e-1)*S)/2;if(g>h){return 0;}else{if(g+h>P){return P-g*2;}else{return h-g;}}};for(var U=0;U<K.length;++U){W=Math.max(W,K[U].containerNode.offsetWidth);T=Math.max(T,K[U].containerNode.offsetHeight);}Y=a(Y,W);X=Z(X,T,b);for(var U=0;U<K.length;++U){if(U%2==0){Q.push({l:Y+R+S,t:X});}else{Q.push({l:Y-K[U].containerNode.offsetWidth-S,t:X});X+=T+S;}}return Q;}var K=[];mstrmojo.DocXtabGraph.multiTooltip={_posMultiTp:function(Q){for(var P=0;P<K.length;++P){K[P].domNode.style.left=Q[P].l+"px";K[P].domNode.style.top=Q[P].t+"px";}},open:function(Y,V,U,Q,P){if(!P){P={};}P.e=V;P.win=U;var S=0;if(Q&&Q.length){S=H(Q[0]);}for(var R=0;R<Q.length;++R){var X=K[R];if(!X||!mstrmojo.all[X.id]){X=new mstrmojo.Tooltip();var T=0,W=this;X.optimizePos=function(){T++;if(T>=K.length){T=0;W._posMultiTp(C(S));}};K.push(X);}Y.richTooltip.content=Q[R]&&Q[R].getAttribute("ttl");X.open(Y,P);}},close:function(){for(var P=K.length-1;P>=0;--P){K[P].close();}K=[];}};}());(function(){mstrmojo.requiresCls("mstrmojo.SliderBox","mstrmojo._IsInputControl","mstrmojo.Box");var C=mstrmojo.css,B=mstrmojo.dom,A=1;mstrmojo.SliderDIC=mstrmojo.declare(mstrmojo.SliderBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.SliderDIC",popupStyle:1,tabIndex:0,init:function(D){if(this._super){this._super(D);}this.cssClass=this.showByDefault?"mstrmojo-SliderGroup":"mstrmojo-PopupSlider";this.items=this.getItems();if(this.dic.ipt!==A){this.isSequential=true;this.max=this.dic.max;this.min=this.dic.min;this.interval=this.dic.itv;}},focus:function(){if(mstrmojo.dom.isIE){var D=this;setTimeout(function(){D.domNode.focus();},10);}else{this.domNode.focus();}},preBuildRendering:function(){this._super();var G=this.dic,D=(G.ldw!=null)?G.ldw/100:0.4,E,F=this.openerStyle;if(this.showByDefault){E=F.iw*(1-D)-F.rp-3;this.alignSlider(this.openerNode,F.ih);}else{E=G.w;}this.sliderBar.set("width",E);this.valueText=this.showByDefault?this.dv:this.value;if(!this.showByDefault&&this.unset&&this.isSequential){this.valueText+=" "+mstrmojo.desc(8316,"(out of range)");}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var H=this.dic,F=this.value,D=(H.ldw!=null)?H.ldw:40,G=this.openerStyle,E=G.ih;this.domNode.style.width=G.iw+"px";this.domNode.style.height=G.ih+"px";this.valuePartNode.style.width=this.sliderPartNode.style.left=D+"%";if(this.isSequential){this.sliderBar.set("title",mstrmojo.desc(5441,"Minimum value")+": "+this.min+"   "+mstrmojo.desc(5442,"Maximum value")+": "+this.max);}}}});})();(function(){function G(N,O){var I,L,H,J=[],K,P;try{K=new RegExp(N,"i");}catch(M){return J;}for(I=0,L=O.length;I<L;I++){H=O[I].n;K.lastIndex=0;if(K.test(H)){J.push(O[I]);}}return J;}function E(H){if(this.searchEnabled){this.iconNode.style.display="none";this.inputBar.style.display="";if(H){this.inputNode.focus();this.inputNode.select();}}else{this.hideInputNode();if(H){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var I=this;window.setTimeout(function(){try{I.iconNode.focus();}catch(J){}},100);}else{this.iconNode.focus();}}}}var A={8:"BackSpace",9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchableDropDownList=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearableDropDownList",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" mstrAttach:keyup,blur/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupSlots,{inputBar:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.firstChild.lastChild.rows[0].cells[0].firstChild;}}),markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.iconNode.innerHTML=this.text;this.inputNode.value=this.text;},onheightChange:function(){var H=parseInt(this.height,10);if(H>=0){this.domNode.style.height=H+"px";this.inputBar.style.height=H+"px";}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),popupToBody:true,searchEnabled:false,selectedIndex:-1,prevalueChange:mstrmojo.emptyFn,allItems:null,focus:function(){E.call(this,true);},hideInputNode:function B(){this.inputBar.style.display="none";this.iconNode.style.display="block";},postBuildRendering:function D(){if(!this.allItems){this.allItems=this.items;}this._super();E.call(this);},onkeyup:function F(P){var I=this.getSearchPattern(),N=[],K,O=this.inputNode,M=P.e,H,J,L=this.items.length;if(A[M.keyCode]==="Enter"){if(this.items.length>0){this.set("selectedIndex",this.selectedIndex===-1?0:this.selectedIndex);}this.onEnter&&this.onEnter();this.closePopup();return ;}else{if(A[M.keyCode]==="Esc"){this.onEsc&&this.onEsc();if(this.popupRef.visible){this.popupRef.close();}return ;}else{if(A[M.keyCode]==="ArrowDown"){if(!this.popupRef.visible){this.togglePopup();}this.set("selectedIndex",(this.selectedIndex+1)%L);}else{if(A[M.keyCode]==="ArrowUp"){if(this.popupRef.visible&&L>0){this.set("selectedIndex",(this.selectedIndex+L-1)%L);}}else{if(this.searchEnabled){if(I&&I.length>0&&I.indexOf(this.lastSearchPattern)>-1){N=G(I,this.items);}else{N=G(I,this.allItems);}this.set("selectedIndex",-1);this.set("items",N);L=N.length;if(L===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}if(I&&I.length>0){this.set("selectedIndex",mstrmojo.array.find(N,this.itemIdField,O.value));}}}}}}this.lastSearchPattern=I;},getSearchPattern:function C(){return mstrmojo.string.trim(this.inputNode.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo.css","mstrmojo.Pulldown","mstrmojo.ProgressBar");var E=mstrmojo.dom,G=mstrmojo.css,H="disabled";function D(){var O=this.selected;if(O===this.panels.length-1){G.addClass(this.nextBtnNode,H);}else{G.removeClass(this.nextBtnNode,H);}if(O===0){G.addClass(this.prevBtnNode,H);}else{G.removeClass(this.prevBtnNode,H);}}mstrmojo.PageNavigationPanel=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.PageNavigationPanel",markupString:'<div class="mstrmojo-PageNavPanel {@cssClass}" style="{@cssText}" mstrAttach:click><div class="header"><div class="titles"><div class="title">{@title}</div><div class="subtitle">{@subtitle}</div></div><div class="progress"></div><div class="navigation"></div></div><div class="content"></div><div class="footer"><div class="prev"><div class="btn" btnv="pre">{@prevText}</div></div><div class="pges"></div><div class="next"><div class="btn" btnv="nxt">{@nextText}</div></div></div></div>',markupSlots:{headerNode:function(){return this.domNode.firstChild;},progressBarNode:function(){return this.domNode.firstChild.childNodes[1];},navigationNode:function(){return this.domNode.firstChild.childNodes[2];},containerNode:function(){return this.domNode.childNodes[1];},footerNode:function(){return this.domNode.lastChild;},prevBtnNode:function(){return this.domNode.lastChild.firstChild;},pagesNode:function(){return this.domNode.lastChild.childNodes[1];},nextBtnNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{onsubtitleChange:function(){this.headerNode.firstChild.lastChild.innerHTML=this.subtitle||"";},onheaderVisibleChange:function(){this.headerNode.style.display=this.headerVisible?"":"none";},ontitleVisibleChange:function(){this.headerNode.firstChild.style.display=this.titleVisible?"":"none";},onsubtitleVisibleChange:function(){this.headerNode.lastChild.style.display=this.subtitleVisible?"":"none";},onheightChange:function(){var P=this.headerHeight,O=this.footerHeight;if(this.height){if(!P||!O){P=this.headerHeight=this.headerNode.offsetHeight||0;O=this.headerHeight=this.footerNode.offsetHeight||0;}this.containerNode.style.height=(parseInt(this.height,10)-P-O)+"px";}}},title:"",subtitle:"",prevText:"Prev",nextText:"Next",selected:0,headerVisible:true,titleVisible:true,subtitleVisible:true,panels:null,renderedPanels:0,init:function M(O){this.panels=[];this._super(O);},onselectedChange:function F(){var Q=this.selected,O=this._lastSelected,R=this.panels[Q],P=this.panels[O];if(P){P.set("visible",false);}if(R){R.set("visible",true);}this.set("subtitle",R.title);this._lastSelected=this.selected;D.call(this);if(this.navlst){this.navlst.set("value",Q);}this.updatePageNode();},onrenderedPanelsChange:function I(){var O=this.panels.length,P=this.renderedPanels;if(O>0){this.updateProgressNode(Math.floor(100*P/O));}else{this.updateProgressNode(0);}},updateProgressNode:function C(O){if(this.prgbar){this.prgbar.updateProgress(O,O+"% completed");}},updatePageNode:function B(){this.pagesNode.innerHTML=(this.selected+1)+"/"+this.panels.length;},showNextPanel:function N(){var O=this.selected,P=this.panels[O];if(!P.viewed){P.viewed=true;this.set("renderedPanels",this.renderedPanels+1);}this.set("selected",O+1);},showPreviousPanel:function K(){this.set("selected",this.selected-1);},preBuildRendering:function J(){var P,O,U=this.panels||[],T=[],S=0,Q=this;if(U.length>0){for(P=0,O=U.length;P<O;P++){if(P!==this.selected){U[P].visible=false;}else{S=P;}T.push({n:U[P].title,v:P,css:(S===P)?"enabled":"disabled"});}this.set("children",[{scriptClass:"mstrmojo.ProgressBar",alias:"prgbar",slot:"progressBarNode"},{scriptClass:"mstrmojo.Pulldown",alias:"navlst",slot:"navigationNode",items:T,itemIdField:"v",defaultSelection:S,onvalueChange:function V(){Q.set("selected",this.value);this.items[this.value].css="enabled";},prevalueChange:function R(){if(this.value>Q.renderedPanels){this.value=Q._lastSelected;}}}].concat(U));this.set("subtitle",U[0].title);this._lastSelected=this.selected;}this._super();},postBuildRendering:function A(){this._super();this.updateProgressNode(0);this.updatePageNode();D.call(this);},onclick:function L(Q){var P=E.eventTarget(window,Q.e),O=P.getAttribute("btnv");if(O){if(O==="pre"&&this.selected>0){this.showPreviousPanel();}else{if(O==="nxt"&&this.selected<this.panels.length-1){this.showNextPanel();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.color");var C=[127,206,255];var D=[216,230,239];var B=function(H,K){if(!H||H=="transparent"){H="#FFFFFF";}var G=mstrmojo.color.hex2rgb(H),J,I,E;if(!K){J=Math.round((3/5)*parseInt(G[0])+110);I=Math.round((3/5)*parseInt(G[1])+110);E=Math.round((3/5)*parseInt(G[2])+110);}else{J=G[0]*K[0]/255;I=G[1]*K[1]/255;E=G[2]*K[2]/255;var F=G[0]*0.3+G[1]*0.59+G[2]*0.11;if(F<85){J=J+(63*((85-F)/85));if(J>255){J=255;}I=I+(63*((85-F)/85));if(I>255){I=255;}E=E+(96*((85-F)/85));if(E>255){E=255;}}}return"#"+mstrmojo.color.rgb2hex(J,I,E);};var A=function(F,G,E){if(F&&F.style){F.style.backgroundColor=G["bg"+E+"Color"]||"";F.style.color=G["text"+E+"Color"]||"";}};mstrmojo.LinkItemRenderer=mstrmojo.hash.copy({render:function(G,E,H){var F=G.v!="u;"?" nAll":"";return'<input mstridx="'+E+'" class="'+H.itemCssClass+(H.selectedIndices[E]?" "+H.itemSelectedCssClass:"")+F+'" style="'+H.itemCssText+" color:"+(H.selectedIndices[E]?H.textSelectedColor:H.textNormalColor)+"; background-color:"+(H.selectedIndices[E]?H.bgSelectedColor:H.bgNormalColor)+';" type="button"  value="'+G[H.itemDisplayField]+'"  onmouseover="mstrmojo.all.'+H.id+".onmouseover(self, "+E+')" onmouseout="mstrmojo.all.'+H.id+".onmouseout(self, "+E+')"/>';},select:function(F,G,E,H){F.className+=" selected";A(F,H,"Selected");},unselect:function(F,G,E,H){F.className=F.className.replace(/selected/g,"");A(F,H,"Normal");},highlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Highlighted";A(G,I,F);},unhighlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Normal";A(G,I,F);}},mstrmojo.hash.copy(mstrmojo.DivItemRenderer));mstrmojo._RendersItemLinks=mstrmojo.hash.copy({onmouseover:function(G,E){if(!E||isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.highlight(F,this.items[E],E,this);},onmouseout:function(G,E){if(!E||isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.unhighlight(F,this.items[E],E,this);},preBuildRendering:function(){this.bgNormalColor=this["background-color"]||this.parent&&this.parent["background-color"];this.bgSelectedColor=this.parent&&this.parent.defn&&this.parent.defn.ssc;if(this.bgSelectedColor!=null){this.bgHighlightedColor=B(this.bgSelectedColor);}else{this.bgSelectedColor=B(this.bgNormalColor,C);this.bgHighlightedColor=B(this.bgNormalColor,D);}this.textNormalColor=this.color;this.textSelectedColor=mstrmojo.color.getContrastingColor(this.bgSelectedColor,["#ffffff","#000000"]);this.textHighlightedColor=mstrmojo.color.getContrastingColor(this.bgHighlightedColor,["#ffffff","#000000"]);if(this._super){this._super();}}},mstrmojo.hash.copy(mstrmojo._RendersItemDivs));mstrmojo._RendersItemLinks.itemRenderer=mstrmojo.LinkItemRenderer;mstrmojo.requiresCls("mstrmojo.ListBox");mstrmojo.LinkList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkList",cssClass:"mstrmojo-LinkList",itemCssClass:"mstrmojo-LinkList-item",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.LinkListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkListHoriz",cssClass:"mstrmojo-LinkListHoriz",itemCssClass:"mstrmojo-LinkListHoriz-item",selectionPolicy:"toggle"});})();(function(){mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(C,A,D){var B=C.v!="u;"?" nAll":"";return'<input mstridx="'+A+'" class="'+D.itemCssClass+(D.selectedIndices[A]?" "+D.itemSelectedCssClass:"")+B+'" style="'+D.itemCssText+'" type="button"  value="'+C[D.itemDisplayField]+'" />';};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.requiresCls("mstrmojo.ListBox");mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ListSelectorItemRenderer=A.clone(mstrmojo.DivItemRenderer);mstrmojo.ListSelectorItemRenderer.render=function(D,B,E){var C=D.v!="u;"?" nAll":"";return'<div mstridx="'+B+'" class="'+E.itemCssClass+(E.selectedIndices[B]?" "+E.itemSelectedCssClass:"")+C+'" style="'+E.itemCssText+'">'+(E.getItemName?E.getItemName(D,B):(E.itemDisplayField&&D[E.itemDisplayField]))+"</div>";};mstrmojo.ListBoxSelector=mstrmojo.declare(mstrmojo.ListBox,null,{itemRenderer:mstrmojo.ListSelectorItemRenderer});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.CheckBoxDIC");var B=mstrmojo.css,A=mstrmojo.dom;mstrmojo.MarkRowDIC=mstrmojo.declare(mstrmojo.CheckBoxDIC,null,{scriptClass:"mstrmojo.MarkRowDIC",cssClass:"mstrmojo-MarkRowDIC",onclick:function(){if(this.grayed){this.set("grayed",false);}this.set("checked",!this.checked);var E=this.group&&this.group.widgetsMap,D,C;if(this.markAll){for(D in E){if(E.hasOwnProperty(D)){C=E[D];if(C.checked!==this.checked){C.set("checked",this.checked);}}}}else{for(D in E){C=E[D];if(C.markAll&&C.checked!==this.checked){C.set("grayed",true);break;}}}},postBuildRendering:function(){if(this._super){this._super();}var C=this.openerNode;if(!this.markAll){A.attachEvent(this.domNode,"mouseover",function(D){B.addClass(C.parentNode,"markSelection");});A.attachEvent(this.domNode,"mouseout",function(D){B.removeClass(C.parentNode,"markSelection");});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo.dom");var Q=1;var W=2;var X=0;var A=1;var AA=2;var M=3;var L=1;var AC=2;var G=4;var g=8;var b=mstrmojo.dom,q;function AG(AH){var AI=null;if(AH&&AH.length>1){AI=new mstrmojo.XtabVACP();AI.cps=AH;}return AI;}function P(AI){var AH=document.createElement("img");AI.appendChild(AH);AI.removeChild(AH);}function I(AI,AH){if(b.isIE){return mstrmojo.boxmodel.convert2px(AI,AH);}return AH;}function H(AI){if(!AI||this._onDemandCP){return ;}var AP=AI.bc,AN=AI.tc,AJ=AN-AP,AO=Math.ceil(AJ/AP),AK=[],AM=[],AL;for(AL=0;AL<AO;++AL){var AH=Math.min(AJ,AP);AK.push(this.createOnDemandCP(AL+1,AH,G));AM.push(this.createOnDemandCP(AL+1,AH,g));AJ-=AP;}this._onDemandCP={rhs:AK,vls:AM};return this._onDemandCP;}mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasScrollbox,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",handleClicks:function F(){return true;},markupString:'<div id="{@id}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div>&nbsp;</div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart><table cellspacing="0" cellpadding="0"><tr trType="title"><td style="vertical-align:top;padding:0px"></td><td class="xtab-tr" style="vertical-align:top;padding:0px;"></td></tr><tr trType="content"><td class="xtab-bl" style="vertical-align:top;padding:0px;"></td><td class="xtab-br" style="vertical-align:top;padding:0px"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_TL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];},_TR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[1];},_BL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[0];},_BR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_T_ROW:function(){return this.domNode.lastChild.firstChild.rows[0];},_B_ROW:function(){return this.domNode.lastChild.firstChild.rows[1];},_BR_CELL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1];},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.firstChild.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zones:null,lockHeadersCase:M,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function n(AH){return(AH.o!==undefined)?AH.o:AH._ei;},getCellTitleId:function e(AH){var AI="";if(AH.axis&&AH.ui!==undefined){AI=AH.axis+"A"+(AH.ui+1);}else{if(AH.mix!==undefined){AI="0A"+AH.mix;}}return AI;},update:function k(AI){if(this._super){this._super(AI);}this.set("gridData",AI.data[0]||AI.data);var AH=this.defn||AI.defn;this.sid=this.gridData.sid;this.treeType=(AH&&AH.tt)||1;this.interactiveCellsArray=[];},initCP:function D(AJ,AI,AO,AL,AN,AK,AM){var AH={gridData:AJ,type:AO,interactiveCellsArray:AI};AH.base=AL||AH.base;AH.lookupBase=AN||AH.lookupBase;AH.axis=AK||AH.axis;if(!AM){if(AO===L){AM=new mstrmojo.XtabTitlesCP(AH);}else{AM=new mstrmojo.XtabCP(AH);}}else{mstrmojo.hash.copy(AH,AM);}return AM;},preBuildRendering:function B(){var AH=this.gridData;this.lockHeadersCase=parseInt(AH.lhv,10);this.selections={};this.cssDefault=(this.lockHeadersCase===X||!this.k)?"":"r-cssDefault"+(this.k?"_"+this.k:"");this.numRowFixed=!!(!this.height&&AH.rw&&AH.rw.row&&(AH.rw.row.bc<AH.rw.row.tc));this.rw=AH.rw;this._onDemandCP=null;if(this.width){this.widthLimit=parseInt(this.width,10);}if(this.height){this.heightLimit=parseInt(this.height,10);}return(this._super)?this._super():true;},renderEmptyGrid:function s(){var AJ=this.gridData,AI=this.msgNode,AH=this.viewport;AI.firstChild.innerHTML=AJ.eg;AI.style.display="block";AI.style.overflow="hidden";AI.className="mstrmojo-message";AH.style.display="none";return(this._super)?this._super():true;},postBuildRendering:function o(){var AP=this.gridData,AL=!!this._BR&&AP,AH=this.msgNode,AM=this.viewport,AN;if(AP.eg===undefined){if(AH.style.display==="block"){AH.style.display="none";AM.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AL){this._setupZones(AP);this._setupCPs(AP);var AK=this.zones,AI;for(AI in AK){var AO=AK[AI];if(AO.parent!==this){this.addChildren(this.zones[AI]);}}if(this.scrollboxNode){var AJ=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AJ)&&(AJ>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AJ;}this.scrollboxLeft=this.scrollboxTop=0;if(this.lockHeadersCase){this.connectScrollbox(this);}}}this.renderChildren();AN=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zones._BR.getPageHeight(0)+(this._TR?this._TR.offsetHeight:0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if((this.lockHeadersCase&&AL&&this.scrollboxNode)||this.numRowFixed){this.resizeScrollBox(b.isIE);}this.onGridWidthChanged(true);if(b.isIE7&&!this.scrollboxHeightFixed&&this.scrollboxNode&&this.scrollboxNode.scrollWidth>this.scrollboxNode.offsetWidth){this.scrollboxNode.style.height=this.scrollboxNode.offsetHeight+17+"px";}return AN;},onclick:function p(AL,AI){if(!this.interactiveCellsArray.length){this.isSelectingText=false;return ;}AL=AL.e||AL;var AJ=mstrmojo.dom,AM=AJ.eventTarget(AI,AL),AK=AM&&AJ.findAncestorByName(AM,"td",true,this.viewport);if(AM.nodeName.toLowerCase()==="a"&&AK.getAttribute("ei")){try{var AN=this.interactiveCellsArray[parseInt(AK.getAttribute("ei"),10)];var AH=7;if(AN&&AN.ts===AH){AM.href=mstrmojo.addCSRFTokenToURL(AM.href);}}catch(AP){}}if(AK){var AO=AJ.findAncestorByName(AM,"span",true,AK);if(AO&&!AJ.shiftKey(AI,AL)&&!AJ.ctrlKey(AI,AL)){this.defaultAction(AK);}else{this.doSelection(AL,AI,AK);if(!this.isSelectingText){AJ.clearBrowserHighlights();}}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function h(AI,AH){this.onclick(AI,AH);},onselectstart:function t(){this.isSelectingText=true;return false;},onscroll:function w(){this._alignHeaders();},resizeScrollBox:function J(AJ){var AH=this.scrollboxNode,AS=AH&&AH.style,AY=this._B_ROW,AX=this._BR_CELL;if(!AS||!AY||!AX){return ;}var AR=this.widthLimit,AQ=this.heightLimit;if(!AR||!AQ){if(!AR){AS.width="auto";}if(!AQ){AS.height="auto";this.scrollboxHeightFixed=false;}}if(AQ){var AP=(this.zones._TR&&this.zones._TR.cp.rc)?AY.offsetTop:0,AU=AQ-AP;if(AU>0){AS.height=AU+"px";this.scrollboxHeight=AU;this.scrollboxHeightFixed=true;if((this.lockHeadersCase!==X)&&this.numRowFixed){this.viewport.style.height=this.overlayNode.style.height=(AU+AP)+"px";}}}if(!this.useTouchScrolling){var AI=(this.zones._BL&&this.zones._BL.cp.rc)?AX.offsetLeft:0;var AW=0;if(this.lockHeadersCase!==X){var AV=this.viewport,AK=mstrmojo.css.getComputedStyle(AV),AT=["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"];if(AK){mstrmojo.array.forEach(AT,function(AZ){AW+=parseFloat(I(AV,AK[AZ]));});}if(this.width){this.viewport.style.width=(parseFloat(this.width)-(AW||0))+"px";}}var AL=(this.widthLimit&&(this.widthLimit-AI))||(mstrmojo.dom.isIE7?AX.scrollWidth+1:(AX.scrollWidth+(AH.offsetWidth-AH.clientWidth)));if(AL&&(AL>0)){AL-=AW;AS.width=AL+"px";}this._alignHeaders(AJ);}var AO=AS.height,AN=AS.width;if(AO||AN){var AM=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection);if(AM){AM.fixedSizeCanGrowShrink(this,AO,AN);}}},_resizeScrollBoxWidth:function U(){var AM=this.scrollboxNode,AJ=AM&&AM.style,AI=this._B_ROW,AH=this._BR_CELL;if(this.useTouchScrolling||!AJ||!AI||!AH){return ;}var AK=this.widthLimit;if(!AK){AJ.width="auto";}var AL=function(){var AN=(mstrmojo.dom.isIE7?AH.scrollWidth+1:(AH.scrollWidth+(AM.offsetWidth-AM.clientWidth)));if((AN&&(AN>0))&&(!AK||(AK&&(AN<AK)))&&(AM.firstChild.firstChild.offsetWidth>=AM.clientWidth)){AJ.width=AN+"px";}};if(mstrmojo.dom.isIE7){window.setTimeout(function(){AL();},1);}else{AL();}},onGridWidthChanged:function Z(AJ){if(this.lockHeadersCase===X&&!AJ){this._resizeScrollBoxWidth();}var AI=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AH=this.widthLimit;if(!AH){this.width=q;if(AI){AI.performCanGrowCanShrink([this],true);}}else{if(AI){AI.fixedSizeCanGrowShrink(this,null,AH);}}},getGridDimension:function R(AK){var AI=1,AJ=AK===AI?"Height":"Width",AL=AJ.toLowerCase(),AH=this[AL+"Limit"];if(!AH&&(this[AL]===q||this[AL]===0)){AH=this.viewport["offset"+AJ];this[AL]=AH+"px";return AH;}return AH||parseInt(this[AL],10);},_alignHeaders:function m(AI){if(this.lockHeadersCase===X||this.useTouchScrolling){return ;}var AL=this.scrollboxLeft,AK=this.scrollboxTop,AJ=this.zones,AH=AJ._TR,AM=AJ._BL;function AN(AO,AS,AP){var AR=AO&&AO.domNode,AQ=AR&&AR.style;if(!AQ){return ;}AQ[AS]=-AP+"px";}if(AH&&AH.rc){AN(AH,"left",AL);}if(AM&&AM.rc){AN(AM,"top",AK);}if(AI){P(this._BL);}},defaultAction:function S(AM,AI){var AH=AI||this.getCellForNode(AM),AL=AM&&AM.className.indexOf("sc_")>0,AK=this.model.getAction(this.getActionCells(AH),AM,AL),AJ=AK&&AK.h;this._currentSelectedTD=AM;if(AJ&&this.controller[AJ]){this.controller[AJ](this,AK.a);return true;}return false;},createZone:function l(AH){return new mstrmojo.XtabZone(AH||{});},_setupZones:function j(AK){var AI=this.zones;this.zones={};var AM=this.zones,AH=this.lockHeadersCase,AO="z-index:";var AJ=this;function AN(AS,AR,AT,AQ){var AP=(AQ&&AQ[AT])||AJ.createZone({renderMode:AS,cssText:AR,slot:AT});AM[AT]=AP;AP.rh=AK.rh;}AN(this.dataRenderMode,AO+"1;","_BR",AI);if(AH&A){AN(this.dataRenderMode,AO+"3;","_BL",AI);}if(AH&AA){AN(null,AO+"3;","_TR",AI);}if(AH===M){AN(null,AO+"4;","_TL",AI);}if(AH===X){this.zones._BR.autoFitWindow=!!AK.afw;this.zones._BR.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}if(mstrmojo.dom.isIE7){if(AH&A||AH&AA||AH===M){this._T_ROW.style.display="block";}else{if(AH===X){this._T_ROW.style.display="none";}}}var AL=AM._BL||AM._BR;if(AL){AL.numColumnCanMerge=AK.gts.cws.length-1;}},getHACP:function AF(){return(this._super&&this._super())||new mstrmojo.XtabHACP();},_setupCPs:function V(AP){var AK=this.titlesCP=this.getTitleCP(AP),AM=this.chsCP=this.getColumnHeadersCP(AP),AI=this.rhsCP=this.getRowHeadersCP(AP),AJ=this.valuesCP=this.getValuesCP(AP);AK.forceAutoRowHeight=AM.forceAutoRowHeight=AP.rh;var AN=this.zones;switch(this.lockHeadersCase){case X:var AT=new mstrmojo.XtabVACP();var AH=this.getHACP();AH.cps=[AK,AM];AT.cps=[AH];var AR=this.getHACP();AR.cps=[AI,AJ];AT.cps.push(AR);AN._BR.cp=AT;break;case A:var AQ=new mstrmojo.XtabVACP();var AL=new mstrmojo.XtabVACP();AQ.cps=[AK,AI];AL.cps=[AM,AJ];AN._BL.cp=AQ;AN._BR.cp=AL;break;case AA:var AO=this.getHACP();var AS=this.getHACP();AO.cps=[AK,AM];AS.cps=[AI,AJ];AN._TR.cp=AO;AN._BR.cp=AS;break;case M:AN._TL.cp=AK;AN._TR.cp=AM;AN._BL.cp=AI;AN._BR.cp=AJ;break;}},ongridDataChange:function Y(){var AH=this.model;if(AH){AH.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:mstrmojo.emptyFn,getTitleCP:function E(AH){return this.initCP(AH,this.interactiveCellsArray,L);},getColumnHeadersCP:function AB(AH){return this.initCP(AH,this.interactiveCellsArray,AC,AH.ghs.chs,AH.gts.col,W);},getRowHeadersCP:function AD(AH){var AI=this.initCP(AH,this.interactiveCellsArray,G,AH.ghs.rhs,AH.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AI].concat(this._onDemandCP.rhs);return AG(this.rhsCPList)||AI;}return AI;},getValuesCP:function a(AI){var AH=this.initCP(AI,this.interactiveCellsArray,g,AI.gvs);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AH].concat(this._onDemandCP.vls);return AG(this.valuesCPList)||AH;}return AH;},createOnDemandCP:function f(AI,AJ,AH){var AK=new mstrmojo.XtabOnDemandCP();AK.dataSource=this;AK.blockNum=AI;AK.rc=AJ;return AK;},dataDownloaded:function T(AJ,AM){var AO=AM.blockNum,AH=this.rhsCPList[AO],AK=this.valuesCPList[AO],AN=AJ.data;AN._bidx=AO;this.dataBlocks[AO]=AN;if(!AH||!AK){return ;}this.initCP(AN,this.interactiveCellsArray,G,AN.ghs.rhs,AN.gts.row,Q,AH);this.initCP(AN,this.interactiveCellsArray,g,AN.gvs,null,null,AK);AH.initContent();AK.initContent();this.numRowsDownloaded+=parseInt(AH.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AL=this.zones,AI=AL&&AL._BL,AP=AL&&AL._BR;if(AI){AI.dataDownloaded();}if(AP){AP.dataDownloaded();}},showDownloadStatus:function O(AH){if(!AH){return ;}if(this.showingStatus){this.numRowsToDownload+=AH;}else{this.numRowsToDownload=AH;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function i(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function K(AJ){var AL=this.gridData.rw,AI=AL.row,AK=AL.col,AH=AI.bc;this.rhsCPList[AJ].isDownloading=this.valuesCPList[AJ].isDownloading=true;if(AH){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AJ*AH+1,AH,AK.bb,AK.bc,this.id,{blockNum:AJ}));}},unrender:function C(AH){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AH);},getCellForNode:function z(AJ){var AH=AJ&&AJ.getAttribute("ei");if(isNaN(AH)){return null;}var AI=this.interactiveCellsArray[parseInt(AH,10)];return AI;},getActionCells:function N(AH){var AI=[],AK=this.selections;var AL=AH.axis+"A"+(AH.ui+1),AM=AK[AL],AJ;if(AM&&AM[AH.o]){for(AJ in AM){var AN=this.getCellForNode(AM[AJ][0]);AI.push(AN);}}else{AI.push(AH);}return AI;},setModel:function AE(AH){this.model=AH;if(AH.data){this.set("gridData",AH.data);}},destroy:function x(){var AH=this.model;if(AH&&AH.destroy){AH.destroy();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.XtabZone","mstrmojo.DICFactory","mstrmojo.DynamicClassFactory");var AG=102,Q=1,J=2,m=mstrmojo.css,l=mstrmojo.dom,i=mstrmojo.hash,e=mstrmojo.DynamicClassFactory.newComponent,K=1,AI=2,H=4,f=2,V=1,B=2,AE=1,G=2,t=1,q=2,b=2,j=1,I=function(AL){if(AL){return AL.tui>=0?("h_"+AL.tui+"_"+AL.fi+"_"+AL.axis):("m_"+AL.mix);}return"";};function s(AR,AN,AO){var AQ=this.nm[AN],AM=AO.v,AP=AO.dv;AR.rv=AM;AR.v=AP;AR.mdf=1;if(AR._src){AR._src.rv=AM;AR._src.v=AP;AR._src.mdf=1;}var AL=this.dicGroupMap[I(AR)].widgetsMap[AR._ei];if(!AL.showByDefault){if(AL.hasPreview){AL.renderPreview();}else{if(l.isIE7&&mstrmojo.string.isEmpty(AM)){AM=" ";}AQ[AQ.innerText!==undefined?"innerText":"textContent"]=AM;}}return AQ;}function Y(AO,AP,AL){if(AL[AP]===0){return true;}if(AO&&AL[AP]===undefined){try{var AM=AO.getRowCells(AP),AQ=AM&&AM[0];if(AQ&&AQ.o===AP){if(AQ.sst){AL[AP]=0;}return !!AQ.stt;}if(AQ&&AQ.o){return Y(AO,AP+AP-AQ.o,AL);}return false;}catch(AN){return false;}}else{return false;}}function L(AM,AL){mstrmojo.array.forEach(AM,function(AN){AL[AN.o]=1;});}function AH(AL){if(AL.mgh&&(AL.mgh&Q)){this.mghMarks={};}}function w(AN,AP){var AM=AP.bb-1,AL=Math.min(AM+AP.bc,AP.tc),AO;i.forEach(AN,function(AR,AQ){AO=Number(AQ);if(AO!==NaN&&AO>=AM&&AO<AL){delete AN[AQ];}});}function AB(AO,AN){var AL=this.editing?1:(AO.rs||1),AM;for(AM=0;AM<AL;AM++){this.dirtyRows[AN+AM]=1;}}function AK(AL){return AL&&parseInt(AL.ipt,10)===b;}function AF(AL){var AN=this.zones._BR,AM=this.zones._BL;if(!AM){return AN.getRowIdxByCell(AL);}else{if(AN.posMap&&AN.posMap[AL._ei]){return AN.getRowIdxByCell(AL);}else{return AM.getRowIdxByCell(AL);}}}mstrmojo._IsEditableGridCP={_mixinName:"mstrmojo._IsEditableGridCP",initContent:function AC(AO){this._super(AO);var AU=this.gridData,AM=AU&&AU.vp,AS,AR,AT,AW,AL,AV,AN,AQ;if(((this.type===K)||(this.type===H))&&AM&&AM.cols&&!AM._adjusted){AL=AM.cols.cg;AN=AM.cols.cws;if(AL&&AL.cgc>0){for(AS=AL.cgc;AS>0;AS--){AL[AS]=i.copy(AL[AS-1],{});AV=AL[AS];var AP=AV.attForms;if(AP){for(AR=0,AW=AP.length;AR<AW;AR++){AT=AP[AR];AT.idx+=1;}}}AL[0]={tg:false,cc:0,cl:1,attForms:[{n:"",idx:0}]};AL.cgc+=1;}if(AN){AN.splice(0,0,{w:"60px",xc:true});}if(AM.dafIdx!==undefined){AM.dafIdx+=1;}AQ=AU.gts.row;for(AS=0,AW=AQ.length;AS<AW;AS++){AQ[AS].ci=AS+1;}AM._adjusted=true;}this.colWidths=[{w:""}].concat(this.colWidths);this.unmergedCells=[];},getUnmergedCells:function Z(){return null;},getRowCells:function z(AV){var AN=this._super(AV),AL=AN[0],AZ=(AL&&AL.o)||0,AW=(this.tp===K),AQ=this.interactiveCellsArray,AY={css:"",v:""},Ac=[],AM=[],Ad,Ae;if(!AW){var AS=this.base.items,Ab=this.lookupBase,Aa=this.gridData.css,Ah=AL&&AL.pi,AX=Ah&&Ah.ri,Ag=Ah&&Ah.ci,AT=AL.stt>0;while(Ah&&AX>-1&&Ag>-1){AL=AL._p||AS[AX].items[Ag];var AO=i.copy(AL,{});AO._src=AL;if(!AO.css){AO.css=Aa[AO.cni].n;}var AU=Ab[AL.tui],Af=AU&&AU.es[AL.idx];if(Af){AO.v=AL.v||Af.n;AO._e=Af;}AO.rs=1;if(AT){AO.at&=~32;}if(AZ>-1){AO.o=AZ;}if(!AO.axis&&this.axis){AO.axis=this.axis;}AO._ei=AQ.push(AO)-1;Ac.splice(0,0,AO);Ah=AL&&AL.pi;AX=Ah&&Ah.ri;Ag=Ah&&Ah.ci;}for(Ad=0,Ae=AN.length;Ad<Ae;Ad++){var AP=AN[Ad];if(AP.rs>1){var AR=i.copy(AP,{});AR.rs=1;AP=AR;}AM.push(AP);}}else{AM=AN;if(AV>0){return AN;}}if(AM[0]){AY=i.copy(AM[0],{});AY.rv=AY.v="";if(this.tp===K){AY.n=AY.v="";AY.markAll=true;}else{AY.n="";}AY._ei=AQ.push(AY)-1;AY.at=32;AY.cs=1;AY.mark=true;AY.mix="x";AY.css=(Ac[0]&&Ac[0].css)||AY.css;delete AY.ui;delete AY.tui;delete AY.fs;delete AY.mdf;}return[AY].concat(Ac.concat(AM));}};mstrmojo._IsEditableXtab={_mixinName:"mstrmojo._IsEditableXtab",update:function x(AN){var AL,AM=AN.data;if(this._super){this._super(AN);}this.kc={};this.rs={};this.rsDelta={};AH.call(this,AM);if(AM.eg!==undefined){return ;}AL=AN.data.marked;if(AL){L(AL,this.rs);}if(!AM.rw){var AO=AM.gvs.items.length;AM.rw={row:{bb:1,bc:AO,tc:AO},col:{bb:-1,bc:-1,tc:0}};}},initCP:function E(AN,AM,AS,AP,AR,AO,AQ){var AL={gridData:AN,type:AS,interactiveCellsArray:AM};AL.base=AP||AL.base;AL.lookupBase=AR||AL.lookupBase;AL.axis=AO||AL.axis;AL.dataSource=this;if(!AQ){if(this.tca===J&&this.editing){if(AS===K){mstrmojo.EditableXtabTitlesCP=e(mstrmojo.XtabTitlesCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabTitlesCP",tp:K});AQ=new mstrmojo.EditableXtabTitlesCP(AL);}else{if(AS===H){mstrmojo.EditableXtabCP=e(mstrmojo.XtabCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabCP"});AQ=new mstrmojo.EditableXtabCP(AL);}else{AQ=new mstrmojo.XtabCP(AL);}}}else{if(AS===K){AQ=new mstrmojo.XtabTitlesCP(AL);}else{AQ=new mstrmojo.XtabCP(AL);}}}else{i.copy(AL,AQ);}return AQ;},createOnDemandCP:function n(AM,AN,AL){var AO;if(this.tca===J&&this.editing&&AL===H){mstrmojo.EditableXtabOnDemandCP=e(mstrmojo.XtabOnDemandCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabOnDemandCP"});AO=new mstrmojo.EditableXtabOnDemandCP();}else{AO=new mstrmojo.XtabOnDemandCP();}AO.dataSource=this;AO.blockNum=AM;AO.rc=AN;return AO;},preBuildRendering:function C(){var AL=this.defn.txi;if(this._super){this._super();}this.txar=AL.txar;this.sci=AL.sci;this.tca=AL.tca;if(this.tca!==J){this.editing=false;}else{if(mstrApp.isMobile){this.editing=this.alwaysEditing=true;}}this.nm={};this.ko={};this.dirtyRows={};this.requiredCellsMap={};this.dicGroupMap={};this.lastIndex=0;this.lastHeaderIndex=0;this.columnNames={};},postBuildRendering:function X(){if(this._super){this._super();}if(this.tca===J&&this.gridData.eg===undefined){var AN=Math.max(-16,-this.domNode.offsetTop),AO=this;if(!this.alwaysEditing){var AL=mstrmojo.Button.newIconButton(mstrmojo.desc(8324,"Mark rows"),"mstrmojo-EditButton",function(){if(!AO.recalculating){AO.editing=!AO.editing;AO.refresh();}}),AM=new mstrmojo.Button(mstrmojo.hash.copy({cssText:"top:"+AN+"px;"},AL));AM.render();this.domNode.appendChild(AM.domNode);if(this.editing){this.domNode.style.zIndex=1000;m.addClass(AM.domNode,"close");}else{m.removeClass(AM.domNode,"close");}}}},dataDownloadErr:function M(){if(this.txar&&this.recalculating){var AL=this.zones;if(AL._BL){AL._BL.isDownloading=false;}AL._BR.isDownloading=false;this.rhsCP.initContent();this.valuesCP.initContent();m.removeClass(this.maskNode,"wait");this.recalculating=false;}},dataDownloaded:function T(AP,AN){var AO=AP.data;if(this.txar){var AL=AN.blockNum,AM=this.zones,AQ;if(this.recalculating){AN.recalculating=true;this.interactiveCellsArray=[];this.requiredCellsMap={};this.dirtyRows={};this.lastIndex=0;this.lastHeaderIndex=0;this.kc={};this.nm={};this.updatedCellsMap={};this.recalculating=false;this.destroyDICs();}else{AN.recalculating=false;}if(AL===0){this.gridData=AO;}if(AO.eg){this.refresh();return ;}AQ=this.interactiveCellsArray;this.initCP(AO,AQ,K,null,null,null,this.titlesCP);this.initCP(AO,AQ,AI,AO.ghs.chs,AO.gts.col,f,this.chsCP);this.titlesCP.initContent();this.chsCP.initContent();if(AQ&&AQ.length===0){if(AM._TR){AM._TR.refresh();}if(AM._TL){AM._TL.refresh();}}}if(this._super){this._super(AP,AN);}AH.call(this,AO);w(this.rs,AO.rw.row);if(AO.marked){L(AO.marked,this.rs);this.rsDelta={};}},closeDownloadStatus:function W(){if(this._super){this._super();}mstrmojo.css.removeClass(this._STATUS,"recalculate");},kc:null,ko:null,nm:null,rs:null,dicGroupMap:null,lastIndex:0,lastHeaderIndex:0,columnNames:null,getDataInputInfo:function h(AZ,AX){var AO=AZ._ei,AM,AR=this.node.defn,AP=this.gridData;if(AZ.mark){AM=AZ.o;if(AZ.stt){this.rs[AM]=0;return ;}this.ko[AM]=AO;AZ.rv=AZ.v=this.rs[AM]||-1;this.kc[AO]={rowop:true};return{key:AO,t:AG,vls:[{v:-1},{v:1}],wm:1,w:22,hm:1,h:16,dm:1};}var AN=this.model.getCellTitleInfo(AZ,this.dataBlocks[AZ._gd]),AW=AN&&AN.title,AY=AW&&AW.es,AV=(AZ.mti!==undefined)?AZ.mti:AZ.mix,AL=(AZ.mix!==undefined),Aa=AR.txi.dic,AS;AS=!AL?Aa.att&&AW&&Aa.att[AW.id]&&Aa.att[AW.id][AW.fs[AZ.fi].id]:Aa.mtx&&Aa.mtx[AY[AV].oid];if(!AS){return null;}if(this.columnNames[AX]===undefined){this.columnNames[AX]=!AL?AW.n:AY[AV].n;}if(AK(AS)){AS.vls=(AP.dcv&&AP.dcv[AS.k])||[];}if(AO>=0&&!this.kc[AO]){var AT=!AZ.axis,Ab={isMv:AT};if(AT){var AQ=AZ.pi,AU=AQ&&AQ.top;Ab.co=(AU&&AU.ci)||0;Ab.metric_id=AY[AV].oid;AZ.o=Ab.o=(AZ._lp&&AZ._lp.o)||0;Ab.tp=B;}else{Ab.ax=AZ.axis;Ab.atid=AW.id;Ab.form_id=AW.fs[AZ.fi].id;Ab.o=AZ.o;Ab.tp=V;Ab.fi=AZ.fi;Ab.ui=AZ.ui;Ab.tui=AZ.tui;Ab.rs=AZ.rs;}Ab.dt=AS.dt;if(AK(AS)){Ab.vls=AS.vls;Ab.k=AS.k;}this.kc[AO]=Ab;}AS.key=AO;if(AS.dm){AS.dm=parseInt(AS.dm,10);}return AS;},isEditableHeader:function F(AL){var AM=this.node.defn,AN=AM.txi.dic;if(AL.sst||!AN){return false;}if(AL.id!==undefined&&AN.att){return !!(AN.att[AL.id]&&(AL.fix?AN.att[AL.id][AL.fid]:AN.att[AL.id]));}if(AL.tui!==undefined&&AL.mix!==undefined&&AN.mtx){return !!(AN.mtx[AL._e.oid]);}return false;},dataChanged:function P(AM,AN,AL,AO){if(!this.recalculating){if(AO){this.nm[AM]=AO;}if(this._super){this._super(AM,AN,AL,AO);}}},updateValue:function g(AO,AM){if(this._super){this._super(AO,AM);}var AS=this.interactiveCellsArray[AO],AW=AM.v,AX,AL=AF.call(this,AS);this.lmr=null;AX=s.call(this,AS,AO,AM);if(AS.r!==AW){if(!AS.mark){AS.mdf=1;mstrmojo.css.removeClass(AX,"required");AB.apply(this,[AS,AL]);this.flagDirtyUnit(AX);}}else{this.clearDirtyUnit(AX);}if(this.tca===J){if(AS.mark){var AQ=AS.markAll?-1:AS.o,AU=this.rsDelta;this.rs[AQ]=AW;this.lmr={r:AQ,v:AW};if(AS.markAll){AU=this.rsDelta={};AU[AQ]=AW;this.mghMarks={};}else{if(AU[AQ]&&AU[AQ]!==AW){delete AU[AQ];}else{if(AU[-1]!==AW){AU[AQ]=AW;}}}}else{if(this.rs[AS.o]!==0){this.rs[AS.o]=1;}if(!this.editing&&this.mghMarks&&(AS.mix===undefined)){if(!this.mghMarks[AS.o]||this.mghMarks[AS.o].rs<AS.rs){this.mghMarks[AS.o]={o:AS.o,rs:AS.rs,k:AO};}var AP,AT,AR=this;i.forEach(this.rsDelta,function(AY,AZ){AP=parseInt(AZ,10);AT=parseInt(AS.o,10);if(AP>=AT&&AP<=(AT+AS.rs)){delete AR.rsDelta[AZ];}});}else{this.rsDelta[AS.o]=1;}if(!this.editing&&AS.rs>1){var AN=AS.o+1;while(AN-AS.o<AS.rs){if(!Y(this.rhsCP,AN,this.rs)){this.rs[AN]=1;}AN+=1;}}if(this.editing){var AV=this.dicGroupMap.m_x.widgetsMap[this.ko[AS.o]];if(AV){AV.set("checked",true);}}}}if(this.txar&&!AS.mark){return true;}return false;},autoRefresh:function AA(){var AL=this.zones;if(AL._BL){AL._BL.invalidAllPages();}AL._BR.invalidAllPages();this.rhsCP.invalid();this.valuesCP.invalid();m.addClass(this._STATUS,"recalculate");AL._BR.onscroll(true);this.recalculating=true;},getKeyContext:function O(AL){return this.kc[AL];},getUpdateObject:function R(){var AP=[],AN,AQ,AR,AL=this.lmr,AM,AO={};if(AL){this.lmr=null;return{manipulation:AE,actionType:(AL.v===-1)?t:q,rowOrdinal:AL.r,nodeKey:this.k,sliceId:this.sid};}AQ=this.getUpdatedValues();for(AN=0;AN<(AQ&&AQ.length);AN++){if(!AQ[AN].rowop){AR=AQ[AN];break;}}if(AR){AM=mstrmojo.string.encodeXMLAttribute(String(AR.v));if(AR.k!==undefined&&AR.vls){AO={controlKey:AR.k,elementId:AR.vls[mstrmojo.array.find(AR.vls,"v",AR.v)].eid};}if(!!AR.isMv){AP.push(i.copy(AO,{rowOrdinal:AR.o,colOrdinal:AR.co,newValue:AM,dataType:AR.dt}));}else{AP.push(i.copy(AO,{rowOrdinal:AR.o,attId:AR.atid,formId:AR.form_id,unitIndex:AR.tui||AR.ui,newValue:AM,dataType:AR.dt}));}}return{manipulation:G,nodeKey:this.k,sliceId:this.sid,cells:AP,autoRefresh:this.txar};},getUpdates:function S(){var AV=this,AQ,AR,AL=AV.getUpdatedValues(),AO=this.rsDelta,AP=[],AU=[],AS=false,AN="";AP.push('<gr rw_tree_type="'+AV.treeType+'" rw_node_key="'+AV.k+'" slice_id="'+AV.sid+'">');for(AQ in AL){if(AL.hasOwnProperty(AQ)){AR=AL[AQ];if(!AR.rowop){var AW=mstrmojo.string.encodeXMLAttribute(String(AR.v));if(AR.k&&AR.vls){var AM=mstrmojo.array.find(AR.vls,"v",AR.v);AN='rw_control_key="'+AR.k+'" element_id="'+AR.vls[AM].eid+'" ';}if(!!AR.isMv){AU.push('<cli cordinal="'+AR.co+'" metric_id="'+AR.metric_id+'"><updt types="'+AR.tp+'" rordinal="'+AR.o+'" '+AN+'value="'+AW+'" dt="'+AR.dt+'"/></cli>');}else{AU.push('<cli ax="'+AR.ax+'" attribute_id="'+AR.atid+'" form_id="'+AR.form_id+'"><updt types="'+AR.tp+'" ordinal="'+AR.o+'" '+AN+'value="'+AW+'" dt="'+AR.dt+'"'+(this.mghMarks?' flags="1"':"")+"/></cli>");}AS=true;}}}if(!i.isEmpty(this.mghMarks)){var AT=this;i.forEach(this.mghMarks,function(AX,AY){AN=AT.getKeyContext(AX.k);AU.push('<mark rordinal="'+AY+'" types="4" flags="1" attribute_id="'+AN.atid+'" form_id="'+AN.form_id+'"/>');});}if(AO&&!i.isEmpty(AO)){AS=true;i.forEach(AO,function(AX,AY){if(AX===1){AU.push('<mark rordinal="'+AY+'" types="4"/>');}else{AU.push('<mark rordinal="'+AY+'" types="5"/>');}});}AP.push(AU.join(""));AP.push("</gr>");if(!AS){AP=[];}return AP.join("");},flagDirtyUnit:function a(AM){if(AM&&this.sci){if(this._super){this._super(AM);return ;}var AL=document.createElement("div"),AQ,AN=false,AP=m.getStyleValue(this.domNode,l.CSS3_TRANSFORM),AO;AL.className="flag-container";AL.innerHTML='<div class="dirty-cell"/>';if(AM.insertBefore){AM.insertBefore(AL,AM.firstChild);AO=(AL.offsetParent===AM);}AN=mstrmojo.string.isEmpty(AP)||AP==="none";AQ=AL.firstChild;AQ.style.top=((!AN||AO)?(-AL.offsetTop):(AM.offsetTop-AL.offsetTop))+"px";AQ.style.left=(AM.clientWidth+((!AN||AO)?(-AL.offsetLeft):(AM.offsetLeft-AL.offsetLeft))-8)+"px";}},clearDirtyUnit:function AJ(AL){if(this._super){this._super(AL);return ;}var AM=AL.firstChild;if(AL){if(AM&&AM.className&&AM.className==="flag-container"){AL.removeChild(AM);}}},onvisibleChange:function o(){if(this.visible===true){var AL=this;setTimeout(function(){AL.configureActions();},10);}},configureActions:function U(){if(this.visible===false){return ;}var Af="_BR",AL=this.zones[Af],AU=!!this.zones._BL,AX=AL.posMap,AQ=AL.thPosMap,AT=this.interactiveCellsArray,AZ=this.dicGroupMap,AY=[],AO,Ae,Ad,Ac,AM,AS,Aa,AR,AN,Aj,Ah,Ag,Ai=this,AV=function(Ak){var Am=Ak.length,Al;for(Al=0;Al<Am;Al++){Ai.flagDirtyUnit(Ak[Al]);}};for(AO=this.lastIndex,Ae=AT.length;AT[AO]&&AO<Ae;AO++){AM=AT[AO];AS=AX&&AX[AO];if(!AS&&AU){Af=(Af==="_BR")?"_BL":"_BR";AL=this.zones[Af];AX=AL&&AL.posMap;AQ=AL&&AL.thPosMap;AS=AX&&AX[AO];}if(AS&&((AM.at&32)>0)){Aa=AL.getNodeByPosition(AS);AM.at=32;if(AM.rv==null){AM.rv=isNaN(AM.mix)?AM._e.n:AM.v;}AR=I(AM);Ah=this.getDataInputInfo(AM,AR);Ag=this.dicGroupMap[AR];if(Ah){if(!Ag){Ag=AZ[AR]=mstrmojo.DICFactory.createDICGroup({gk:AR,dic:Ah,owner:this,openerType:j});}var Ab={value:(AM.rv===undefined)?(AM.v||AM.n):(typeof AM.rv==="string"?mstrmojo.string.decodeHtmlString(AM.rv):AM.rv),dv:AM.v||AM.n,ts:AM.ts,markAll:AM.markAll,openerNode:Aa,k:AM._ei,ownerCell:AM,popupTitle:this.columnNames[AR]},AP=AL.cp.stackedRh;if(AP&&AM.singleStack&&(mstrmojo.DICConfig.showDICByDefault(Ah,1)||mstrmojo.DICConfig.hasDICPreview(Ah,1))){var AW=Aa.offsetHeight;Aa.className+=" igDIC";Aa.style.cssText="height:"+AW+"px;";mstrmojo.hash.copy({inlineExtraCssText:"position:absolute;top:"+parseInt(AP/2-AW/2+1,10)+"px;"},Ab);}Ag.addDIC(AM._ei,Ab);AN=AS.page*AL.rowsPerPage+AS.row;if(Ah.req){for(Ac=0;Ac<(this.editing?1:(AM.rs||1));Ac++){Aj=this.requiredCellsMap[AN+Ac];if(!Aj){this.requiredCellsMap[AN+Ac]=Aj=[];}Aj.push(AM);}}if(AM.mdf){AY.push(Aa);AB.apply(this,[AM,AN]);}}}}this.lastIndex=AO;for(AR in AZ){AZ[AR].render();}setTimeout(function(){AV(AY);},25);for(Ad=this.lastHeaderIndex,Ae=AQ.length;Ad<Ae;Ad++){AS=AQ[Ad];Aa=AL.getNodeByPosition(AS);AM=AS.obj;if(this.isEditableHeader(AM)){Aa.innerHTML='<div class="editable-column">'+Aa.innerHTML+"</div>";}}this.lastHeaderIndex=Ad;this.registerTxWidget();if(this._super){this._super();}},showPopupDIC:function A(AO){var AM=AO&&l.findAncestorByAttr(AO,"ei",true,this.viewport);if(AM){var AP=AM.node,AL=this.getCellForNode(AP),AN=this.dicGroupMap[I(AL)];if(AN){AN.showPopupDIC(AL._ei);return true;}}return false;},onclick:function AD(AM){var AL=mstrmojo.dom.eventTarget(window,AM.e);if(!this.showPopupDIC(AL)&&this._super){this._super(AM);}},unrender:function D(){if(this._super){this._super();}this.destroyDICs();},destroyDICs:function p(){var AL=this.dicGroupMap;this.dicGroupMap={};setTimeout(function(){var AM;for(AM in AL){AL[AM].destroy();}},10);},checkRequiredObjects:function N(){if(this.hasRendered&&!(this.isInteractiveGrid&&this.isInteractiveGrid())&&!this.gridData.eg){var AN=this.zones._BR,AP=AN.posMap,AR,AO=this,AM=this.rs,AL=true,AQ=function(AX,AT){var AW=true,AU=AO.requiredCellsMap[AX],AS=(AU&&AU.length)||0,AV;for(AV=0;AV<AS;AV++){if(!AU[AV].mdf){m.toggleClass(AN.getNodeByPosition(AP[AU[AV]._ei]),"required",AT);AW=!AT;}}return AW;};if(this.tca===J){for(AR in AM){AL=AQ(parseInt(AR,10)+1,AM[AR]>0)&&AL;}}else{for(AR in this.dirtyRows){AL=AQ(AR,true)&&AL;}}return AL;}return true;},editNext:function k(AN){if(this.recalculating){return false;}var AO=this.interactiveCellsArray,AL=AO.length,AP=AN+1,AQ,AM;do{if(AP>=AL){AP%=AL;}if(AP===AN){return false;}AQ=AO[AP];var AR=this.dicGroupMap[I(AQ)];if(AR){if(mstrmojo.DICConfig.isKeyNavigable(AR.dic)){if(!AR.showByDefault){AR.showPopupDIC(AP);}else{AM=AR.widgetsMap[AP];AM.focus();}return true;}}AP++;}while(true);}};}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo._IsDocXtab","mstrmojo._XtabSelections","mstrmojo._XtabCellHoverMgr");var F=0,A="overflow:auto",N="overflow:hidden",K=mstrmojo.dom,H="mstrmojo.DocPanelStack";var E=function C(Q,R){var S=Q&&Q.parent;while(S&&S.scriptClass!==H){if(S.scriptClass===R){return S;}S=S.parent;}return S;};mstrmojo.Xtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab,mstrmojo._XtabSelections],{scriptClass:"mstrmojo.Xtab",cellHoverMgr:"mstrmojo._XtabCellHoverMgr",cellHoverPopupRef:"mstrmojo.XtabCellHoverPopup",preBuildRendering:function O(){var S=this._super();var R=this.gridData;var Q=this.lockHeadersCase===F&&R.co;this.scrollboxNodeOverflow=Q&&!this.numRowFixed?N:A;var T=this.getFormats();if(mstrmojo.dom.isIE8&&!R.co&&this.lockHeadersCase===F&&(!R.rw||R.rw&&(R.rw.row.bc>=R.rw.row.tc))&&mstrmojo.string.isEmpty(T.height)&&mstrmojo.string.isEmpty(T.width)){this.scrollboxNodeOverflow="";}this._useFilter=this._useFilter||R.cssflt||false;return S;},postBuildRendering:function G(){var S=this.gridData,R=this._super();if(!K.supportsTouches){var U=this;if(this.contentNode){this.contentNode.onmouseover=function(){U.requiresContrib("cellHoverMgr",true);U.contentNode.onmouseover=null;};}}if(!this.getFormats().width&&this.model.docModel.addAutoWidthID){this.model.docModel.addAutoWidthID(this.id);S=this.gridData;var Q=S&&S.afc;if(Q&&mstrmojo.dom.isIE7){var T=E(this,H);if(T&&T.scriptClass===H){this.viewport.style.width=this.contentNode.offsetWidth+(this.scrollboxNode.offsetWidth-this.scrollboxNode.clientWidth)+"px";}}}if(K.isIE&&!K.isIE8&&this._useFilter&&!this.lockHeadersCase){var V=this.scrollboxNode;window.setTimeout(function(){var W=document.createElement("img");V.appendChild(W);V.removeChild(W);},0);}return R;},createZone:function(Q){return new mstrmojo.XtabZone(Q||{});},onCGBMapChange:function(R){var Q=this._resolveCGBToTKS(R.cgbMap);if(Q){this.defaultAction(this._currentSelectedTD);}},_resolveCGBToTKS:function D(Y){if(!Y){return ;}var W=this.model.scm,S="\u001E",U=0,R=null,V=null,T=null,Q=null,X=false;for(R in W){V=W[R];T=V.cgb;for(U in T){Q=Y[T[U]];if(Q){if(!V.tks){V.tks=Q;X=true;}else{if(V.tks&&(V.tks.indexOf(Q)<0)){V.tks+=S+Q;X=true;}}}}}return X;},onGridWidthChanged:function J(Q){if(this.cellHoverMgr.onXtabWidthChanged){this.cellHoverMgr.onXtabWidthChanged();}if(this._super){this._super(Q);}},getDim:function(){var Q=this.contentNode;return{w:Q.scrollWidth,h:Q.scrollHeight};},unrender:function L(Q){var R=this.cellHoverMgr;if(R&&R.shutdown){R.shutdown();}this._super(Q);},link:function M(R,Q){this.controller.onLink(this,this.model.getLinkAction(R,Q));},sort:function I(Q,R){this.controller.onSort(this,this.model.getSortAction(Q,R));},pivot:function P(Q,R){this.controller.onPivot(this,this.model.getPivotAction(Q,R));},drill:function B(Q){this.controller.onDrill(this,this.model.getDrillAction(this.getActionCells(Q)));}});}());(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.dom","mstrmojo.SearchableDropDownList","mstrmojo._IsTableLayoutListDIC","mstrmojo.TableLayoutList","mstrmojo._IsInputControl","mstrmojo.DynamicClassFactory");var H=mstrmojo.DynamicClassFactory.newComponent,C=mstrmojo.hash,E=mstrmojo.dom;mstrmojo.SearchableDropDownListForListDIC=mstrmojo.declare(mstrmojo.SearchableDropDownList,null,{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",init:function I(J){this._super(J);this.popupRef.children[0].onmousedown=function(){var L=this.parent,K=L.opener;L.close();if(K){K.onPopupClosed();}};},onmousedown:function B(J){this._super&&this._super(J);if(E.isIE||E.isIEW3C){this.focus();}},openPopup:function(K,J){this._super(K,J);this.parent.setInfoWindowLock(true);},popupRef:C.copy({onvisibleChange:function(){var J=this.opener.parent.showByDefault;if(!this.visible&&J){this.opener.parent.setInfoWindowLock(false);}}},C.clone(mstrmojo.SearchableDropDownList.prototype.popupRef)),onPopupClosed:mstrmojo.emptyFn});function G(K){var J=[];mstrmojo.array.forEach(K,function(L){J.push(L.n);});return J;}mstrmojo.TableLayoutListForListDIC=H(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC],{scriptClass:"mstrmojo.TableLayoutListForListDIC"});function F(M,N,K){var O=N.ipr||0,L=N.mint||"",J=N.maxt||"";return{0:{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",cssDisplay:"block",searchEnabled:K.length>=10,itemIdField:"v",fixWidth:true,fixHeight:true,postCreate:function(){var Q=this.value,R=N.ust||"",P=mstrmojo.array.find(K,"v",Q);if(P==-1){K=[{n:R,v:Q}].concat(K);P=0;this.unset=true;}this.items=K;this.selectedIndex=P;this.set("value",K[P].v);if(this.parent.showByDefault&&this.searchEnabled){this.applyChange=function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}else{this.items=this.allItems;this.set("text",this.text);}};this.onvalueChange=function(){};if(E.isIE||E.isIEW3C){this.onPopupClosed=function(){this.applyChange&&this.applyChange();};}}},onblur:function(P){this.applyChange&&this.applyChange();},onEnter:function(){this.applyChange&&this.applyChange();},onEsc:function(){this.items=this.allItems;this.set("value",this.parent.value);},getDisplayValue:function(){return this.items.length&&this.items[this.selectedIndex===-1?0:this.selectedIndex].n;},isPopupClosed:function(){return !(this.popupRef&&this.popupRef.visible);}},1:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"radio",itemsPerRow:O,items:K,getDisplayValue:function(){return this.items[this.selectedIndex].n;}},2:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"check",delim:",",multiSelect:true,itemsPerRow:O,items:K,getDisplayValue:function(){return"";}}}[M||0];}mstrmojo.ListDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ListDIC",tabIndex:0,markupString:'<div class="mstrmojo-ListDIC {@cssClass}" tabIndex="{@tabIndex}" mstrAttach:focus></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onwidthChange:function(){if(this.dicWidget&&this.width){this.dicWidget.set("width",this.width);}},onheightChange:function(){if(this.dicWidget&&this.height){this.dicWidget.set("height",this.height);}}},init:function(J){this._super(J);this.style=this.dic.st;this.items=this.getItems();this.set("children",[mstrmojo.hash.copy(F(this.style,this.dic,this.items),{alias:"dicWidget",value:this.value,onvalueChange:function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}}})]);if(this.dicWidget.setDirtyFlag){this.setDirtyFlag=function(L,K){this.dicWidget.setDirtyFlag(L,K);};}},getDisplayValue:function D(){return this.dicWidget.getDisplayValue()||this.dv;},onfocus:function(J){this.focus();},focus:function(){var J=this;if(mstrmojo.dom.isIE){setTimeout(function(){J.dicWidget.focus&&J.dicWidget.focus();},10);}else{J.dicWidget.focus&&J.dicWidget.focus();}},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.dicWidget.set("height",(this.openerStyle.ih||0)+"px");this.dicWidget.set("width",(this.openerStyle.iw||0)+"px");}},applyChanges:function(){var J=this._super();return this.style?J:this.dicWidget.isPopupClosed();},cleanup:function A(){if(!this.style){this.dicWidget.closePopup();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocXtabGraph");var B=mstrmojo.dom;mstrmojo.OIVMDocXtabGraph=mstrmojo.declare(mstrmojo.DocXtabGraph,null,{scriptClass:"mstrmojo.OIVMDocXtabGraph",postBuildRendering:function C(){if(!this.preLoader){this.preLoader=document.createElement("img");}return this._super();},retrieveGraphSrc:function A(J,M){var D=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(M,10)+"&height="+parseInt(J,10)+"&sessionState="+escape(mstrApp.sessionState),O=this.preLoader,P=this.imgNode,E=this.id;D=mstrmojo.addCSRFTokenToURL(D);if(O.src!==D){mstrApp.addLoadingGraph(E);var I=function(){mstrApp.removeLoadingGraph(E);},N="load",H="error",L,G,K,F;G=B.attachOneTimeEvent(O,N,function(){F=B.attachOneTimeEvent(P,N,function(){I();P.style.background="none";mstrmojo.all[E].defn.set("readyState",mstrmojo.EnumReadystate.IDLE);B.detachEvent(P,H,K);});K=B.attachOneTimeEvent(P,H,function(){I();B.detachEvent(P,N,F);});B.detachEvent(O,H,L);P.src=O.src;});L=B.attachOneTimeEvent(O,"error",function(){I();B.detachEvent(O,N,G);});O.src=D;}}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,C={0:"default",1:"stars_dots"};mstrmojo.RatingDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RatingDIC",styleCssClass:"rate",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover,mouseout><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',lastIdx:null,init:function(D){this._super(D);this.items=this.getItems();this.starCount=this.items&&this.items.length;B.addWidgetCssClass(this,C[this.dic.stl||0]);},setRating:function(D){var F=0,G=this.starCount,E="less_equal";if(this.lastIdx==undefined||this.lastIdx!=D){for(;F<G;F++){if(F<=D){B.addClass(this._getItemNode(F),E);}else{B.removeClass(this._getItemNode(F),E);}}this.lastIdx=D;}},onvalueChange:function(){this._super&&this._super();var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},onmouseover:function(E){this._super&&this._super(E);var F=E.target||A.eventTarget(E.hWin,E.e),D=F&&F.getAttribute("idx");if(D!=undefined){this.setRating(D);}},onmouseout:function(E){this._super&&this._super(E);var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}var D=mstrmojo.array.find(this.items,"v",this.value);if(D>-1){this.setRating(D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl");function A(E){var D=[];mstrmojo.array.forEach(E,function(F){D.push(F.n);});return D;}mstrmojo.LikertScaleDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.LikertScaleDIC",styleCssClass:"scale",init:function(D){this._super(D);this.items=this.getItems();this.titleItems=A(this.items);},getDisplayValue:function B(){return(this.selectedIndex>=0)?this.items[this.selectedIndex].n:this.dv;},getLeftEndTitle:function C(D){return D>=0?(this.dic.mint||""):"";},getRightEndTitle:function(D){return D>=0?(this.dic.maxt||""):"";},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=(Y)?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=(Y)?0:U-1;}else{V+=(Y)?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(j){var e=this.candidates,a=e&&e.items,X=e&&e.isComplete,h=this._last_hit;if(!this.noCache&&(e||h)){var g=this.filterCandidates(a,j,this.REQUEST_THRESHOLD),b=g.length,f=this.suggestCount,U=false;if(!X&&b<f){var V=h&&h.pattern;if(h&&V&&(j.indexOf(V)>-1)){U=true;var l=this.filterCandidates(h.items,j,this.REQUEST_THRESHOLD),Y=l&&l.length,W=mstrmojo.array,k=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(g,k,l[Z][k])===-1){g.push(l[Z]);}}b=g.length;}}if(!X&&((j.length>2&&b<this.REQUEST_THRESHOLD)||(b<f))){this.requestCandidates(j);return -1;}return(b<f)?g:g.slice(0,f);}this.requestCandidates(j);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(f){if(!f){return ;}var e=X.getSuggestionTarget();if(!e||(V!==e)){return ;}var k=e.getSearchPattern(),a=f.items;X._last_hit={items:a,pattern:U};X.sz=f.sz;if(!X.noCache&&a){var g=X.candidates&&X.candidates.items||[],h=[].concat(a);for(var Z=0,b=a.length;Z<b;Z++){var Y=h[Z];if(mstrmojo.array.indexOf(g,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=g.concat(a);}}if(k&&k.indexOf(U)>-1){var j=X.filterCandidates(a,k);X.updateSuggestion(j);}},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:((V)?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var V=this.zIndex;this.openPopup("ob",{zIndex:(V&&(V+10))||110});this.ob.browser.browse({folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes});this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopup:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInputBox-suggest",showTitle:false,modal:false,autoClose:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U&&U.autoSelect){this.list.singleSelect(0);}},onClose:function F(){this.list.clearSelect();if(this.opener){this.opener.suggestionShown=false;}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){var N,J;mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DocPortlet");var Q={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};mstrmojo.Vis=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,updated:false,reRenderOnDimensionChg:true,getFormats:function(){return this.fmts;},isVis:function(){return true;},setModel:function L(V){this.set("model",V);if(V.data){this.set("model",V.data);}this.xtabModel=V;if(typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function S(){this._super();var V=this.xtabModel;if(V&&V.destroy){V.destroy();delete this.xtabModel;}},setDimensions:function O(X,W){var V=this._super(X,W);if(V&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return V;},reRender:function F(){this.unrender();this.render();},getWidth:function B(){return parseInt(this.width,10);},getHeight:function I(){return parseInt(this.height,10);},buildRendering:function H(){if(!this.updated){this.update();}if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function E(){N=this.width;J=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function A(){var V=this.domNode,W={top:0,left:0};if(typeof (mstr)!="undefined"){W.top=mstr.utils.BoxModel.getElementSumOffsetTop(V);W.left=mstr.utils.BoxModel.getElementSumOffsetLeft(V);}else{if(typeof (mstrmojo)!="undefined"){W=mstrmojo.boxmodel.offset(V);}}this.offsetTop=W.top;this.offsetLeft=W.left;},initFromVisProps:function R(V){},update:function G(X){X=X||this.node;if(X){if(X.data){this.set("model",X.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",X.data);}this.model=X.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(X.data.extProps,this);}this.fmts=X.defn.fmts||X.defn.units[this.model.k].fmts;var V=this.fmts;if(V){for(var W in Q){v=Q[W];if(W in V){this[v]=V[W];}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;},getModel:function M(W){if(W){var V=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,W);if(V){return V.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));}}else{return this.model;}},getDataParser:function K(V){return new mstrmojo.Vis.DataParser(this.getModel(V));},renderErrorMessage:function T(V){this.domNode.innerHTML='<div class="mstrmojo-message">'+V+"</div>";},getMessageID:function D(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function U(Y){var h=this.xtabModel,g=(h&&h.docModel);var k=false;if(g){var f=g.defn&&g.defn.layouts,X=null;var W;if(f){for(W in f){if(f[W].loaded){X=f[W];break;}}}var Z=X&&X.units;this.selectorTargets={};if(Z&&Y.scObjList){for(var W=0;W<Y.scObjList.length;W++){var a=Y.scObjList[W];var b=a.sc.tks.split("\x1E");for(var V=0;V<b.length;V++){var e=Z[b[V]];if(e){this.selectorTargets[b[V]]=e;if(!this.isChildOfIfw(Z,e)){k=true;}}}}}}return k;},isChildOfIfw:function C(V,W){while(W){if(W.ifw){return true;}W=V[W.pnk];}return false;},performAction:function P(V){var X=this.xtabModel.getAction(V),W=X&&X.h;if(W&&this.controller[W]){this.controller[W](this,X.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(V,e,W){var a=e;var Y=V.getChildren(e,false);for(var X=0;X<Y.length;X++){var b=Y[X];if(b.k==W){return b;}else{var Z=mstrmojo.Vis.getVisGrid(V,b,W);if(Z){e=a;return Z;}}}};mstrmojo.Vis.DataParser=function(X){var g=mstrmojo.Vis;return{getRowTitles:function(){return new g.Titles(X,true);},getColTitles:function(){return new g.Titles(X,false);},findMetricValue:function(k,o){var n=X.ghs.rhs.items;for(var l in n){var m=n[l].items;var j=true;for(var h in k){if(k[h]!=m[h].idx){j=false;break;}}if(j){return new mstrmojo.Vis.MetricValue(X.gvs.items[l].items[o]);}}},getTotalRows:function a(){return X.eg?0:X.ghs.rhs.items.length;},getTotalColHeaderRows:function Y(){return(!X.ghs.chs.items?0:X.ghs.chs.items.length);},getTotalCols:function V(){return this.getColHeaders(0).size();},getRowHeaders:function f(h){return new g.Headers(X,h,true);},getColHeaders:function e(h){return new g.Headers(X,h,false);},getMetricValue:function b(i,h){return new g.MetricValue(X,X.gvs.items[i].items[h]);},getColumnHeaderCount:function Z(){return X.gvs.items[0].items.length;},getCSSString:function W(){return X.cssString;}};};mstrmojo.Vis.Titles=function(V,a){var Z=(a)?V.gts.row:V.gts.col;return{size:function Y(){return Z.length;},getTitle:function X(b){return new mstrmojo.Vis.Title(Z[b]);},getCSS:function W(b){return V.css[Z[b].cni].n;}};};mstrmojo.Vis.Headers=function(W,X,b){var e=(b)?W.gts.row:W.gts.col;var a=(b)?W.ghs.rhs:W.ghs.chs;var Y=a.items&&a.items[X].items;return{size:function f(){return(!Y?0:Y.length);},getHeader:function V(g){return Y&&Y[g]&&new mstrmojo.Vis.Header(Y[g],b?e[g]:e[X]);},getCSS:function Z(g){return Y&&W.css[Y[g].cni].n;},getHeaderCell:function(g){return Y&&Y[g];}};};mstrmojo.Vis.Title=function(W){return{getActionType:function(){return W.at;},getDrillPath:function(){return W.dp;},getHeaderValues:function V(){return W.es;},getHeaderName:function X(Z){return W.es[Z].n;},getHeaderId:function X(Z){return W.es[Z].id;},getForms:function Y(){return W.fs;},getFormId:function(){return W.fid;},getFormType:function(){return W.ftp;},getUnitId:function(){return W.id;},getLinkMap:function(){return W.lm;},getName:function(){return W.n;},getUnitDssType:function(){return W.otp;},getSelectorControl:function(){return W.sc;}};};mstrmojo.Vis.Header=function(X,V){return{getName:function Z(){return(X.idx===-1)?"":V.es[X.idx].n;},getElementId:function e(){return(X.idx===-1)?"":V.es[X.idx].id;},getObjectId:function Y(){return(X.idx===-1)?"":V.es[X.idx].oid;},getElementIndex:function W(){return X.idx;},getActionType:function b(){return X.at;},isTotal:function a(){return X.otr===1;}};};mstrmojo.Vis.MetricValue=function(V,e){var b=e;return{getValue:function W(){return b.v;},getThresholdType:function X(){return b.ty;},getRawValue:function a(){return b.rv;},getCSS:function Y(){return V.css[b.cni].n;},getThresholdValue:function f(g){if(b.ti==undefined){return g;}return V.th[b.ti].n;},getFillColor:function Z(g){if(b.ci==undefined){return g;}return V.fc[b.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.Box","mstrmojo.ElasticTextArea","mstrmojo.hash","mstrmojo.css");var G=4,F=5,E=6,C=7,B=10;var D=mstrmojo.hash,A=mstrmojo.css;mstrmojo.TextAreaDIC=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextAreaDIC",applyOnEnter:false,onfontChange:function(){var H=this.font;if(this.etab){this.etab.set("font",H);}else{if(this.eta){this.eta.set("font",H);}}},focus:function(){if(this.eta){this.eta.focus();}else{if(this.etab){this.etab.premousedown();}}},init:function(I){if(this._super){this._super(I);}if(this.showByDefault){var H,J=this.dic;if(J.siwc){H={cssText:"position:relative;min-height:18px;",ontextChange:function(){this.preview.set("text",this.text);},onvalueChange:function(){if(J.sp){var K=this.value,L=this.dv||"",N="",M="";switch(this.ts){case E:M="mailto:";case F:N=K.substring(0,J.pl);this.dv=N=L.replace(/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i,"$1"+M+K+"$3"+N+"$5");break;default:N=L.substring(0,J.pl);break;}this.preview.set("text",J.pl>0&&N.length>0?N+"...&nbsp;&nbsp;&nbsp;":"");}if(this.etab.domNode){if(this.value&&this.value.length!==0){A.addClass(this.etab.domNode,"filled");}else{A.removeClass(this.etab.domNode,"filled");}}this.etab.value=this.value;this.applyChanges();},onpopupwidthChange:function(){this.etab.set("popupWidth",this.popupwidth||200);},onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}}};}else{H={cssText:"position:relative",onpopupwidthChange:function(){this.eta.set("width",(this.popupwidth-4)||200);},onheightChange:function(){if(this.domNode&&this.height){this.domNode.style.height=this.height+"px";this.eta.set("height",this.height-4);}}};}D.copy(H,this);if(J.siwc){this.addChildren([{alias:"preview",scriptClass:"mstrmojo.Label"},{alias:"etab",popupToBody:true,maxLength:J.ml||250,cssText:"position:absolute;right:0;top:0px",onvalueChange:function(){if(this.value!==this.parent.value){var L=this.parent,K="";switch(L.ts){case E:K="mailto:";case F:if(!L.dv){L.dv='<a href="mailto:"></a>';}var M=/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i;L.set("dv",L.dv.replace(M,"$1"+K+this.value+"$3"+this.value+"$5"));break;default:L.set("dv",this.value);break;}L.set("value",this.value);}},premousedown:function(){var L=!this.popupRef.hasRendered;mstrmojo.ElasticTextAreaButton.prototype.premousedown.apply(this,arguments);if(L){var K=this.popupRef,M=this.parent;mstrmojo.dom.attachEvent(K.domNode,"keydown",function(N){var O=N||window.event;if(O.keyCode==9){K.close();M.onTabDown(N);}});}},scriptClass:"mstrmojo.ElasticTextAreaButton"}]);}else{this.addChildren({alias:"eta",maxLength:J.ml||250,onheightChange:function(){if(this.hasRendered&&this.height){this.domNode.style.height=this.height+"px";}},onblur:function(){this.parent.set("value",this.value);},onwidthChange:function(){if(this.hasRendered&&this.width){this.domNode.style.width=this.width+"px";}},placeholderText:this.placeholderText,bindings:{value:"this.parent.value"},scriptClass:"mstrmojo.TextArea"});}this.onvalueChange();}else{this.addChildren({alias:"eta",scriptClass:"mstrmojo.ElasticTextArea",maxLength:this.dic.ml,value:this.value,onvalueChange:function(){this.parent.set("value",this.value);}});this.onpopupwidthChange=function(){this.eta.set("width",(this.popupwidth-4)||200);};}},postBuildRendering:function(){this._super();var H=this.dic;if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault&&!H.siwc){this.set("height",this.openerStyle.ih);this.set("popupwidth",this.openerStyle.iw);}else{if(H.wm&&H.w){this.set("popupwidth",H.w);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.date","mstrmojo.DateTextBox","mstrmojo._IsInputControl");var B=mstrmojo.css,A=mstrmojo.expr.DTP;mstrmojo.CalendarDIC=mstrmojo.declare(mstrmojo.DateTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CalendarDIC",autoFormat:false,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onvalueChange:function(){if(!this.showByDefault){var F=this.calendar.cal,D=mstrmojo.date,E=this.dic.min,C=this.dic.max;this.invalid=mstrmojo.string.trim(this.value||"").length===0||this.validationStatus.code>mstrmojo.validation.STATUSCODE.VALID;if(F.value!==this.value){F.set("value",this.value);}else{if(E&&D.compareDateAndOrTime(E,F.value)>0){this.value=E;}else{if(C&&D.compareDateAndOrTime(F.value,C)>0){this.value=C;}}}}},getInputNode:function(){return this.inputNode;},init:function(C){this._super(C);this.dtp=this.dic.ict?A.TIMESTAMP:A.DATE;},focus:function(){mstrmojo.dom.setCaret(this.inputNode,((this.value&&this.value.length)||0));this.openPopup("calendar");this.adjustCalendarPopup();},adjustCalendarPopup:function(){var F=this.domNode,E=this.calendar.domNode,D=E.scrollWidth,I=mstrmojo.boxmodel.offset(this.openerNode,document.body),H=I.left,G,C=(document.body.offsetWidth-H-D-parseInt(B.getStyleValue(F,"paddingLeft"),10)-parseInt(B.getStyleValue(F,"paddingRight"),10));if(C<0){E.style.left=C+"px";}G=parseInt(I.top,10);if(G+this.inputNode.offsetHeight+E.offsetHeight<=mstrmojo.dom.windowDim().h){E.style.top=this.inputNode.offsetHeight+"px";}else{E.style.top=-E.offsetHeight+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.TreeNode");var I=mstrmojo.dom;mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:mstrmojo.hash.copy({checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,onstateChange:function H(){if(!this.contentRetrieved&&(this.state==1)){this.set("items",[this.tree.loadingItemCreaterFunc()]);this.tree.getContent(this,this.blockBegin);}},toggleState:function F(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function G(J){I.clearBrowserHighlights(J.hWin);return false;},predblclick:function D(J){I.clearBrowserHighlights(J.hWin);return false;},premousedown:function B(K){var P=mstrmojo.dom,M=mstrmojo.dom.eventTarget(K.hWin,K.e),J=this.tree,L=(this.state==2),O=P.contains(this.itemsContainerNode,P.eventTarget(K.hWin,K.e),true,this.domNode),N=(J.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if(this.isSpecialNode()||!(M==this.checkBoxNode||(M==this.textNode&&(L||!N)))){P.stopPropogation(K.hWin,K.e);}if((M==this.stateNode)||(M==this.textNode&&!L&&N)){if(!L){this.toggleState();}}else{if(M==this.checkBoxNode||O){if(this._super){this._super(K);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var J=this.data&&this.data.st;return(J<0);},handleNodeClicked:function E(){var J=this.tree,K=this.parent,L=this.data;switch(L&&L.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin-J.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin+J.blockCount);break;case"-1":case"-2":break;default:if(J.handleNodeClicked){J.handleNodeClicked(L);}}},init:function(J){this._super(J);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var J=function(K){I.preventDefault(window,K||window.event);return false;};I.attachEvent(this.domNode,"mousedown",J);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st];},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc());}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){this.getContent(this);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new mstrmojo.TreeBrowserNode({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}else{var J=this.selectionParentNode;return J&&J.getSelectedItems();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.OIVMDICPopup","mstrmojo.SliderDIC","mstrmojo.TextFieldDIC","mstrmojo.CheckBoxDIC","mstrmojo.ListDIC","mstrmojo.CalendarDIC","mstrmojo.TimePickerDIC","mstrmojo.ToggleDIC","mstrmojo.TextAreaDIC","mstrmojo.MarkRowDIC","mstrmojo.DefaultDIC","mstrmojo.RatingDIC","mstrmojo.RankDIC","mstrmojo.StepperDIC","mstrmojo.LikertScaleDIC");var C=null,B=1,I=2,G=3,A=4,J=5,L=6,F=7,K=8,D=10,E=11,H=13;mstrmojo.OIVMDICConfig=mstrmojo.provide("mstrmojo.OIVMDICConfig",{DICList:{1:mstrmojo.TextFieldDIC,2:mstrmojo.CheckBoxDIC,3:mstrmojo.ListDIC,4:mstrmojo.SliderDIC,5:mstrmojo.CalendarDIC,6:mstrmojo.TimePickerDIC,7:mstrmojo.ToggleDIC,8:mstrmojo.TextAreaDIC,9:mstrmojo.DefaultDIC,10:mstrmojo.RatingDIC,11:mstrmojo.RankDIC,12:mstrmojo.StepperDIC,13:mstrmojo.DefaultDIC,14:mstrmojo.LikertScaleDIC,102:mstrmojo.MarkRowDIC},getDICClass:function(M){if(M.t===H){if(!!M.em){return mstrmojo.ListDIC;}else{return mstrmojo.TextFieldDIC;}}return this.DICList[M.t];},showDICByDefault:function(N,M){if(N.sbd===undefined){if(N.t==K&&N.dm==0&&N.siwc){N.sbd=true;}else{if(N.t==H){N.sbd=false;}else{if(this.DICList[N.t]==mstrmojo.DefaultDIC){N.sbd=0;}else{N.sbd=N.dm===1;}}}}return N.sbd;},hasDICPreview:function(N,M){if(N.hpp===undefined){N.hpp=false;}return N.hpp;},isKeyNavigable:function(M){if(M.ikn===undefined){switch(M.t){case B:case J:case G:case I:case F:case A:case L:case K:M.ikn=true;break;default:M.ikn=false;}}return M.ikn;},DICPopup:{getInstance:function(M,N){if(!C){C=new mstrmojo.OIVMDICPopup();C.render();}C.open(M,{widget:N});return C;},cancel:function(){if(C){C.onCancel();}}}});mstrmojo.DICConfig=mstrmojo.OIVMDICConfig;mstrmojo.DICList=mstrmojo.DICConfig.DICList;mstrmojo.DICPopup=mstrmojo.DICConfig.DICPopup;})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo._CanSupportTransaction","mstrmojo.Box","mstrmojo._Formattable","mstrmojo.PageNavigationPanel","mstrmojo.Label","mstrmojo.Table");var k=0,Q=1,S=2,i=3,D=4,s=5,l=6,U=7,m=8,Z=9,N=10,Y=11;var n={1:"gray",2:"black"};var C=0,A=1,g=2;var p=1,E=2,O=3;var X=mstrmojo.hash,e=mstrmojo.array,b=mstrmojo.css;var q=1,I=2;function R(x,t){var z=x.getRowTitles(),AE=x.getColHeaders(0),AA,AD,w,AC,AB={};for(AA=0,AD=z.size();AA<AD;AA++){w=z.getTitle(AA);AC=w&&w.getUnitId();X.forEach(t,function(AG,AF){if(AC===AG){AB[AF]=AA;if(AF==="sel"){AB.fid=w.getFormId();}return false;}});}if(t.sel){for(AA=0,AD=AE.size();AA<AD;AA++){AC=AE.getHeader(AA).getObjectId(AA);if(AC===t.sel){AB.sel=AA;AB.aoa=I;break;}}}return AB;}function j(x,w){var z=[],AA,t;if(x.length===1&&w){for(AA=1;AA<=w;AA++){z.push({n:AA,v:AA,o:x[0].o});}}else{for(AA=0,t=x.length;AA<t;AA++){if(x[AA]){z.push({n:x[AA].title,v:x[AA].value,o:x[AA].o});}}}return z.sort(function(AC,AB){return AC.o-AB.o;});}function T(w){if(w.type===1){return{placeholderText:(w.required===A)?mstrmojo.desc(661,"Required"):""};}else{if(w.type===2){return{placeholderText:mstrmojo.desc(10001,"Click to edit")};}else{if(w.type===6){var t=w.answers[w.gai||0].sort(function(z,x){return z.value-x.value;});if(t.length>0){return{mint:t[0].title,maxt:t[t.length-1].title};}}}}return{};}function f(w){var x=[],t=this;X.forEach(w.answers,function(AA,AC){var AD=w.type,AE=AC||0,AC=w.id+"."+(AC||0),AB=j(AA),AG={2:{t:8,dm:1,vls:AB||[],ipt:1},3:{t:3,dm:1,st:1,stl:1,vls:AB||[],ipr:1,ipt:1,ms:1},4:{t:3,dm:1,st:2,stl:3,vls:AB||[],ipr:1,ipt:1,ms:1},5:{t:3,dm:1,vls:AB||[],ipt:1,ms:1},6:{t:14,dm:1,stl:2,vls:AB||[],ipr:0,ipt:1,ms:1},9:{t:11,dm:1,vls:AB||[],ipt:1,ms:1},10:{t:10,dm:1,vls:j(AA,5)}}[AD]||{t:1,dm:1,wm:0,w:12,ml:256,dt:10},AF=mstrmojo.DICFactory.createDIC(X.copy(T(w),{dic:AG,k:AC,dv:"",value:w.dftAns[AE]||""})),z={scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Answers",children:[AF]};x.push(z);AF.owner=t;t.dics.push({k:AC,w:AF,s:w.sid,r:w.required});t.ko[AC]={vls:AB,qtp:AD};});return x;}function B(AH,AO){var AL,AK,AJ,AM,AG,AE,AF,AB,AD=0,x=[],z=[],AN=[],t=0;if(!AH){return x;}for(AL=0,AM=AH.length;AL<AM;AL++){var AC=AH[AL],AA=(AO?"  "+AC.title:(this.qId++)+". "+AC.title),AI={scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-QuestionTitle",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-SurveyVis-QuestionTitleText",cssDisplay:"inline",text:AA},{scriptClass:"mstrmojo.Label",cssClass:"required",cssDisplay:"inline",text:"*",visible:AC.required===A}]},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-SurveyVis-Description",text:AC.description||""}]};if(AC.type===Y){if(AC.groupStyle===O){z=[];t=AC.answers[AC.gai].length||0;for(AK=0,AG=t;AK<AG;AK++){z.push({scriptClass:"mstrmojo.Label",cssClass:"colHeader",slot:"0,"+(AK+1),text:AC.answers[AC.gai][AK].title});}AN=B.call(this,AC.group,true);for(AK=0,AG=AN.length;AK<AG;AK++){AB=AN[AK];if(AB&&AB.cssClass==="groupBreak"){continue;}if(AB&&AB.children&&AB.children.length){for(AJ=0,AE=AB.children.length;AJ<AE;AJ++){AF=AB.children[AJ];AF.slot=(AK+1)+","+AJ;if(AK==0){AF.cssClass+=" topRow";}z.push(AF);}AD++;}}x.push({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Question",children:[AI].concat({scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-SurveyVis-Group Table",rows:AD+1,cols:t+1,children:[{scriptClass:"mstrmojo.Label",text:"",slot:"0,0"}].concat(z)})});}else{x.push({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Group Regular",children:[AI].concat(B.call(this,AC.group,true).concat([{scriptClass:"mstrmojo.Box",cssClass:"groupBreak"}]))});}}else{x.push({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Question",children:AC.type===k?[AI]:[AI].concat(f.call(this,AC))});}if(AC.groupBreak){x.push({scriptClass:"mstrmojo.Box",cssClass:"groupBreak"});}}return x;}function H(z){var x=z.sections,w,t,AA=[];if(!x){return AA;}for(w=0,t=x.length;w<t;w++){AA.push(mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Section",title:x[w].title,children:B.call(this,x[w].questions)}));}return AA;}function L(t){return parseInt(t,10)>0||!!t;}function J(AM,AF){var AH={},AT=-1,AE,AC,AG,AB=-1,AI,AL=-1,z,AA=0,AR=0,AP=0,AO,AQ,AN,w=true,t,AK,x;for(AO=0,AQ=AM.getTotalRows();AO<AQ;AO++){t=AM.getRowHeaders(AO);if(AF.t&&AF.t!==-1&&!AH.title){AH.title=t.getHeader(AF.t).getName();}else{if(AH.title===undefined){AH.title="";}}if(AF.sid&&AF.sid!==-1){if(!AH.sections){AH.sections=[];}AN=parseInt(t.getHeader(AF.sid).getName(),10);if(AT!==AN){AT=AN;AE={questions:[]};AH.sections.push(AE);if(AF.st&&AF.st!==-1){AE.title=t.getHeader(AF.st).getName();}AC=AE.questions;AG=null;}}else{if(!AH.questions){AC=AH.questions=[];}}if(AF.qid&&AF.qid!==-1&&AC){if(AF.qn&&AF.qn!==-1){AA=parseInt(t.getHeader(AF.qn).getName(),10);}else{AA++;}AN=parseInt(t.getHeader(AF.qid).getName(),10);if(AB!==AN){w=true;AB=AN;AI={required:0,type:1,answers:{},sid:AT};AI.id=AN;if(AF.qt&&AF.qt!=-1){AI.title=t.getHeader(AF.qt).getName();}else{if(AI.title===undefined){AI.title="";}}if(AF.qd&&AF.qd!=-1){AI.description=t.getHeader(AF.qd).getName();}else{if(AI.description===undefined){AI.description="";}}if(AF.rq&&AF.rq!=-1){AI.required=parseInt(t.getHeader(AF.rq).getName(),10)||0;}if(AF.ran&&AF.ran!=-1){AI.randomize=t.getHeader(AF.ran).getName();}if(AF.qtp&&AF.qtp!=-1){AI.type=parseInt(t.getHeader(AF.qtp).getName(),10)||0;}AI.qn=AA;if(AF.gai&&AF.gai!=-1){AI.gai=parseInt(t.getHeader(AF.gai).getName(),10)||0;}if(AF.gb&&AF.gb!==-1){AI.groupBreak=parseInt(t.getHeader(AF.gb).getName(),10)||0;}if(AR!==AA){if(AG){AC=AG;AG=null;}AC.push(AI);if(AI.type===Y){AI.group=[];if(AF.gs&&AF.gs!==-1){AI.groupStyle=parseInt(t.getHeader(AF.gs).getName(),10);}AG=AC;AC=AI.group;}AR=AA;}else{AC.push(AI);}}else{w=false;}}if(AF.aid&&AF.aid!=-1&&AI){if(AF.gai&&AF.gai!=-1){AP=parseInt(t.getHeader(AF.gai).getName(),10)||0;}AN=parseInt(t.getHeader(AF.aid).getName(),10);if(AL!==AN||AP!==AI.gai||w){var AU={};AL=AN;if(AF.aid&&AF.aid!==-1){AU.id=parseInt(t.getHeader(AF.aid).getName(),10)||0;}if(AF.at&&AF.at!==-1){AU.title=t.getHeader(AF.at).getName();}else{if(AU.title===undefined){AU.title="";}}if(AF.av&&AF.av!==-1){AU.value=t.getHeader(AF.av).getName();}if(AF.ao&&AF.ao!==-1){AU.order=parseInt(t.getHeader(AF.ao).getName(),10)||0;}AU.o=AO;if(!AI.answers[AP]){AI.answers[AP]=[];}if(!AI.dftAns){AI.dftAns={};}if(AF.sel>-1&&AF.aoa===I){var AJ=AM.getMetricValue(AO,AF.sel),AD=AJ&&AJ.getValue(),AS=L(AD);if(AI.type===Q||AI.type===S){AI.dftAns[AP]=AD;}else{if((AI.type===i||AI.type===s||AI.type===l||AI.type===N)&&AS){AI.dftAns[AP]=AU.value;}else{if(AI.type===D&&AS){AI.dftAns[AP]=!AI.dftAns[AP]?AU.value:AI.dftAns[AP]+","+AU.value;}}}}AI.answers[AP].push(AU);}}}return AH;}function V(w,x,t){var z;if(w.isMetrics){z='<cli cordinal="'+w.writeBackCol+'" metric_id="'+w.writeBackId+'"><updt types="2" rordinal="'+x+'" value="'+mstrmojo.string.encodeXMLAttribute(String(t))+'" dt="9"/></cli>';}else{z='<cli ax="1" attribute_id="'+w.writeBackId+'" form_id="'+w.writeBackFid+'"><updt types="1" ordinal="'+x+'" value="'+mstrmojo.string.encodeXMLAttribute(String(t))+'" dt="9"/></cli>';}return z;}mstrmojo.SurveyVis=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._Formattable,mstrmojo._CanSupportTransaction],{scriptClass:"mstrmojo.SurveyVis",markupString:'<div class="{@className} mstrmojo-SurveyVis" style="{@domNodeCssText}"><div class="body"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW"]},ko:null,dics:null,qId:1,update:function h(w){this._super(w);var AA=this.getDataParser(),t=this.model.vp,x=R(AA,t),z=J(AA,x);this.ko={};this.dics=[];this.sec=parseInt(t.sec,10)>0;this.qId=1;this.stv=parseInt(t.suvt,10)>0;if(this.sec){this.set("children",[{scriptClass:"mstrmojo.PageNavigationPanel",title:z.title,cssClass:"compact "+(n[t.cs]||""),headerVisible:this.stv,alias:"pageNav",prevText:"",nextText:"",panels:H.call(this,z)}]);}else{if(this.stv){this.set("children",[{scriptClass:"mstrmojo.Box",alias:"pageNav",cssClass:"mstrmojo-PageNavPanel compact "+(n[t.cs]||""),onheightChange:function(){if(this.height){this.content.domNode.style.height=(parseInt(this.height,10)-this.header.domNode.offsetHeight)+"px";}},children:[{scriptClass:"mstrmojo.Box",cssClass:"header",alias:"header",children:[{scriptClass:"mstrmojo.Label",cssClass:"title",text:z.title}]},{scriptClass:"mstrmojo.Box",cssClass:"content end",alias:"content",children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-SurveyVis-Section",children:B.call(this,z.questions)}]}]}]);}else{this.set("children",B.call(this,z.questions));}}this.cellInfo={writeBackId:t.sel,writeBackCol:x.sel,writeBackFid:x.fid,isMetrics:!!x.aoa};},setModel:function o(t){this.set("model",t);this.txModel=t&&t.docModel;},getKeyContext:function G(t){return this.ko[t];},getUpdateObject:function K(){},postBuildRendering:function P(){this._super();if(this.height){if(this.pageNav){this.pageNav.set("height",this.height);}else{this.containerNode.style.maxHeight=this.height||"";this.containerNode.style.overflow="auto";}}},checkRequiredObjects:function F(){var w=this.dics,t=true;e.forEach(w,function(x){if(x.r===A&&x.mdf!==1){t=false;b.addClass(x.w.domNode,"required");}});return t;},updateValue:function W(w,x){if(this._super){this._super(w,x);}var z=this.dics,t=e.find(z,"k",w);if(t>-1){z[t].mdf=1;b.removeClass(z[t].w.domNode,"required");}},editNext:function a(AA){var AC=this.dics,t,AB,z,x;t=e.find(AC,"k",AA);AB=this.dics[t];x=AB&&AB.s;if(t!==-1&&t<AC.length-1){AB=this.dics[t+1];z=AB&&AB.w;if(AB&&(AB.s===x)&&z&&z.focus){z.focus();}}},getUpdates:function M(){var AC=[],t=[],AG=this,AI,x=0,AH,AA,AD,AB,AF=false,z=this.getUpdatedValues(),AE,AJ=this.cellInfo;AC.push('<gr rw_tree_type="'+this.defn.tt+'" rw_node_key="'+AG.k+'" slice_id="'+(AG.sid||0)+'">');for(AB in z){if(z.hasOwnProperty(AB)){AE=z[AB];if(AE.qtp===Q||AE.qtp===S||(AE.qtp===N&&AE.vls.length===1)){AA=AE.vls[0].o;AC.push(V(AJ,AA,AE.v));t.push('<mark rordinal="'+AA+'" types="4"/>');}else{if(AE.qtp===Z){AI=AE.v.split(",");x=0;e.forEach(AI,function(w){AH=e.find(AE.vls,"v",w)||0;AA=AE.vls[AH].o;x++;AC.push(V(AJ,AA,x));t.push('<mark rordinal="'+AA+'" types="4"/>');});}else{if(AE.qtp===D){AI=AE.v.split(",");e.forEach(AI,function(w){AH=e.find(AE.vls,"v",w)||0;AA=AE.vls[AH].o;AC.push(V(AJ,AA,w));t.push('<mark rordinal="'+AA+'" types="4"/>');});}else{AH=e.find(AE.vls,"v",AE.v)||0;AA=AE.vls[AH].o;AC.push(V(AJ,AA,AE.v));t.push('<mark rordinal="'+AA+'" types="4"/>');}}}AF=true;}}AC.push(t.join(""));AC.push("</gr>");if(!AF){AC=[];}return AC.join("");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo._Formattable","mstrmojo.VisChartUtils","mstrmojo.array","mstrmojo.date","mstrmojo.VisCalendar");var B=mstrmojo.date,E=mstrmojo.array,D=mstrmojo.dom,A=function(){return mstrmojo.locales.datetime;};function F(G){return G.getFullYear()+"_"+(G.getMonth()+1)+"_"+G.getDate();}function C(G){return{year:G.getFullYear(),month:G.getMonth()+1,day:G.getDate()};}mstrmojo.VisDateSelection=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._Formattable],{scriptClass:"mstrmojo.VisDateSelection",markupString:'<div id="{@id}" class="mstrmojo-Chart mstrmojo-visDateSelection {@cssClass}" style="{@domNodeCssText}"  mstrAttach:mouseover,mousemove><div></div><div class="mstrmojo-visDateSelection-msg"></div></div>',markupSlots:{calendarNode:function(){return this.domNode.firstChild;},msgNode:function(){return this.domNode.lastChild;}},markupMethods:{onerrMsgChange:function(){var G=this.msgNode,H=this.errMsg;G.style.display=H?"block":"none";G.innerHTML=H||"";}},formatHandlers:{domNode:["z-index","P","B","F","T","D"]},fmts:{},dfm:null,firstDayOfWeek:1,hilightToday:false,selectedColor:"#7FCEFF",update:function(G){if(!this.docModel){this.docModel=this.model.docModel?this.model.docModel:this.model;}this._super(G);},initFromVisProps:function(G){var J={Color:1,Boolean:2,Integer:3,FontIndex:4},K=["Arial","Arial Black","Comic Sans","Courier","Georgia","Impact","Monaco","Palatino","Tahoma","Times New Roman","Trebuchet MS","Verdana"],L={bgColor:{df:"0xFFFFFF",tp:J.Color},borderColor:{df:"0xAFAFAF",tp:J.Color},fDayType:{df:"8",tp:J.FontIndex},fDaySize:{df:"11",tp:J.Integer},fDayColor:{df:"0x000000",tp:J.Color},daybold:{df:"false",tp:J.Boolean},dayitalic:{df:"false",tp:J.Boolean},fHeaderType:{df:"8",tp:J.FontIndex},fHeaderSize:{df:"11",tp:J.Integer},fHeaderColor:{df:"0x000000",tp:J.Color},headerbold:{df:"false",tp:J.Boolean},headeritalic:{df:"false",tp:J.Boolean},fWeekDayType:{df:"8",tp:J.FontIndex},fWeekDaySize:{df:"11",tp:J.Integer},fWeekDayColor:{df:"0x000000",tp:J.Color},weekDaybold:{df:"true",tp:J.Boolean},weekDayitalic:{df:"false",tp:J.Boolean},rollColor:{df:"0x7fceff",tp:J.Color},selctedColor:{df:"0x98d8ff",tp:J.Color,p:"selectedColor"},fDayOfWeek:{df:"1",tp:J.Integer,p:"firstDayOfWeek"},showToday:{df:"false",tp:J.Boolean,p:"hilightToday"},inhSelectorFormat:{df:"false",tp:J.Boolean}},N=function(P,Q){if(Q==J.Boolean){P=(P.toUpperCase()=="TRUE");}else{if(Q==J.Integer){P=parseInt(P);}else{if(Q==J.Color){P="#"+(parseInt(P)+16777216).toString(16).substring(1);}else{if(Q==J.FontIndex){P=K[P];}}}}return P;};for(var I in L){var M=L[I],O=(G&&G[I])||M.df,H=M.p||I;this.set(H,N(O,M.tp));}},_resolveCGBToTKS:function(H){var L=this.dfm.sc,K=L&&L.cgb;for(var I in K){var J=K[I],G=H[J];if(G){if(!L.tks){L.tks=G;}else{if(L.tks&&(L.tks.indexOf(G)<0)){L.tks+="\u001E"+G;}}}}},onCGBMapChange:function(G){this._resolveCGBToTKS(G.cgbMap);},postBuildRendering:function(){this.dfm=null;var I=this.model.gts;if(I){var K=(I.row||[]).concat(I.col||[]);var Y=0,M=0,L=0,Z=K&&K.length,Q=null,T=null;for(;Y<Z;Y++){Q=K[Y];if(Q.otp!=-1){M++;if(Q.es){L++;T=Q;}}}this.dfm=(L==1&&M==1)?T:null;}this.set("errMsg",this.model.eg||(this.dfm?"":"The Date Selection widget requires exactly one attribute with a Date form"));if(!this.dfm){return ;}var W=this.docModel;if(W){if(W.getCGBMap){this._resolveCGBToTKS(this.docModel.getCGBMap());}if(W.attachEventListener){W.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");}}var P=this.dfm,b=P.es,T={},G=[],H=P.sc,V=H&&H.ces,O=function(f){return new Date(mstrmojo.VisChartUtils.convertRawValueToMilliseconds(f));},R=(b&&b.length)||0,X=(R&&b[0].rv)?O(b[0].rv):null,U=X;for(var Y=0;Y<R;Y++){var a=O(b[Y].rv),e=C(a);T[F(a)]=b[Y].id||true;if(B.compareDate(X,e)<=0){X=e;}if(B.compareDate(U,e)>=0){U=e;}if(E.find(V,"id",b[Y].id)>=0){G.push(e);}}T.length=b&&b.length;if(X){T.max=X;}var N=this.docModel.zf||this.zoomFactor||1,J=function(j,i,f,g,h){return"font:"+(j?"italic ":"")+(i?"bold ":"")+(f*N)+"px "+g+";color:"+h+";";},S=J(this.headeritalic,this.headerbold,this.fHeaderSize,this.fHeaderType,this.fHeaderColor);mstrmojo.insert({scriptClass:"mstrmojo.VisCalendar",placeholder:this.calendarNode,availableDates:T,isMultiSelect:true,forceNonEmptySelection:!(H&&H.all),selectedDates:G,selectedColor:this.selectedColor,rollColor:this.rollColor,hilightToday:this.hilightToday,firstDayOfWeek:this.firstDayOfWeek+1,min:B.formatDateInfo(U,A().DATEOUTPUTFORMAT),max:B.formatDateInfo(X,A().DATEOUTPUTFORMAT),showCurMonthDatesOnly:true,cssTextHeader:S+"line-height:"+198*0.1414*N+"px;",cssTextMonthYearLabel:"padding-bottom:"+3*N+"px;border-bottom-width:"+N+"px;line-height:"+this.fHeaderSize*N+"px;background-size:"+N+"px;",cssTextDay:J(this.dayitalic,this.daybold,this.fDaySize,this.fDayType,this.fDayColor),cssTextMonth:S,cssTextYear:S,cssTextWeekDay:J(this.weekDayitalic,this.weekDaybold,this.fWeekDaySize,this.fWeekDayType,this.fWeekDayColor),cssTextBody:"border-top-color:"+this.borderColor+";",cssText:"width:"+198*N+"px;height:"+198*N+"px;background-color:"+this.bgColor+";border-color:"+this.borderColor+";",container:this}).render();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});},ENUM_STATES:{UNDETERMINED:F,VALID:E,INVALID:D}}));}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.Enum_Keys","mstrmojo.hash","mstrmojo.dom");var E=mstrmojo.dom,B=mstrmojo.Enum_Keys,H=200,M;var L={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var N="mstrmojo-SimpleObjectInputBox-del";function I(){var V=this.inputBox,W=V.value;if(W!==this._lastPattern){this.showSuggestion(W);}this._lastPattern=W;delete this._timerHandle;}function U(){var V=this._timerHandle;if(V){window.clearTimeout(V);delete this._timerHandle;}}function P(){var X=this.maxObjectCount,V=(this.items&&this.items.length)||0,W=(X!=null&&V>=X);this.set("state",!V?L.EMPTY:(W?L.FULL:L.DEFAULT));}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur style="display: none;" /></div><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@emptyText}</div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;},emptyTextNode:function(){return this.domNode.childNodes[1];},inputBox:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function Q(){var V=this.maxItemWidth;if(!isNaN(V)){V+="px";}this.emptyTextNode.style.maxWidth=V;}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,maxObjectCount:null,getItemMarkup:function(V){if(!M){var W=this.itemField;M=this._super(V).replace(">{@n}<",' title="{@'+W+'}"><div class="elem">{@'+W+'}<div class="'+N+'"></div></div><');}return M;},getItemProps:function R(Y,V){var W=this._super(Y,V),Z=this.itemField;W[Z]=Y[Z];var X=this.maxItemWidth;if(!isNaN(X)){X=(X-24)+"px";}W.addStyle("max-width:"+X);return W;},getSuggestionPos:function K(){var V=this._inputPos;return{target:this.inputBox,left:V.x,top:V.y+V.h,zIndex:100};},getSearchPattern:function T(){return this.inputBox.value;},onSuggestionItemSelect:function F(V){U.call(this);this.set("items",this.items.concat(V));this._super();var W=this.id;window.setTimeout(function(){var X=mstrmojo.all[W];if(X.state!=L.FULL){X.set("state",L.ADDING);}},0);},onstateChange:function A(W){var X=W.value;this.emptyTextNode.style.display=(X===L.EMPTY)?"block":"none";var V=this.inputBox,Y=V.style,Z=this.itemsContainerNode;if(X===L.ADDING){Y.display="";V.focus();this._inputPos=E.position(V,true);}else{U.call(this);Y.display="none";V.value="";this._lastPattern="";}},postBuildRendering:function O(){P.call(this);return this._super();},preitemsChange:function J(){P.call(this);},onclick:function S(W){var Z=E.eventTarget(W.hWin,W.e);if(Z&&Z.className===N){var Y=E.findAncestorByAttr(Z,"idx",true,this.domNode),V=Y&&parseInt(Y.value,10);if(V!==null&&!isNaN(V)){var X=this.items.concat();X.splice(V,1);this.set("items",X);}return ;}if(this.state!=L.FULL){this.set("state",L.ADDING);}},onblur:function D(){U.call(this);if(!this.suggestionShown){P.call(this);}},prekeydown:function C(V){var Y=V.e;switch(parseInt(Y.keyCode||Y.charCode,10)){case B.DOWN_ARROW:this.nextHighlight();break;case B.UP_ARROW:this.preHighlight();break;case B.TAB:case B.ENTER:E.preventDefault(V.hWin,Y);var X=this.getSelected();if(X){this.handleSuggestionItemSelect(X);}else{this.hideSuggestion();P.call(this);}break;case B.ESCAPE:U.call(this);this.hideSuggestion();P.call(this);break;case B.BACKSPACE:if(!this.getSearchPattern()){E.preventDefault(V.hWin,Y);var W=this.items&&this.items.concat();if(W&&W.length){W.splice(W.length-1,1);this.set("items",W);var Z=this.id;window.setTimeout(function(){mstrmojo.all[Z].set("state",L.ADDING);},0);}}break;}},prekeyup:function G(){if(this.useKeyDelay){var V=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){I.call(mstrmojo.all[V]);},H);}}else{I.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox");var I=mstrmojo.array,G=mstrmojo.dom,C=mstrConfig.thousandsSep;if(C===undefined){C=",";}var B=2147762227,D=2147762262,J=2147762269,E=140;var N;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{getItemMarkup:function(Q,P){if(!N){N=this._super(Q,P).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return N;},getItemProps:function K(R,P){var Q=this._super(R,P),S=R.wt;Q.weight=(S)?"<em>("+mstrmojo.num.addSeparators(S,C)+" likes)</em>":"";return Q;}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-SearchBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",suggestionListClass:"mstrmojo.SearchBoxSelectorList",postCreate:function M(){var P=this.suggestionPopup;P.cssClass="mstrmojo-SearchBoxSelector-suggest";P.nudge=function(){var R=this.editorNode;if(!R){return ;}var Q=Math.min(R.offsetHeight,E),T=R.offsetWidth,W=G.windowDim(),V=this.left,U=this.top;if(U+Q>=W.h){U-=Q;}if(V+T>=W.w){V-=T;}var S=R.style;S.top=U+"px";S.left=V+"px";};},preBuildRendering:function L(){this.set("maxItemWidth",this.parent.contentNode.offsetWidth);this._super();},postBuildRendering:function A(){var P=this.parent.defn.fmts;if(!P.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function H(Q,T,P){var U=Q,R=this.suggestCount;if(!this.noCache){P=P||R;T=mstrmojo.string.regEscape(T);var V=this.itemField,S=new RegExp("^"+T,"i");U=I.filter(Q,function(W){return S.test(W[V]);},{max:P});}if(U.length){I.forEach(this.items,function(X){var W=I.find(U,"v",X.v);if(W>-1){U.splice(W,1);}});}if(U.length>=R){U=U.slice(0,R);}return U;},getCandidatesThroughTaskCall:function O(S,V){var P=this.id,R=this.getSuggestionTarget(),Q=S.pattern||"",X=this.parent,W=this.srcid;Q=Q.replace(/"/,"");if(W){var T={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:W,dataSourcesXML:this.dsrc||"",blockCount:this.REQUEST_THRESHOLD,searchPattern:Q,browseFlags:1};var U=X.defn;if(U.dsid){T.datasetID=U.dsid;T.messageID=X.model.mid;T.ctlKey=X.ckey;}if(U.sfid){T.searchForms=U.sfid;if(parseInt(U.sfdt,10)===8){T.searchPattern+="*";}}V.success=function(b){if(b&&b.es){var f=mstrmojo.all[P],g=f.getSuggestionTarget(),Y=b.es.length;if(!b||!g||(R!==g)){return ;}if(Y&&(Y>f.suggestCount)){return ;}var a=g.getSearchPattern(),Z=b.es;if(W){Z=mstrmojo.elementHelper.buildElemsTerseID(Z,W,true);}var e=S.pattern;f._last_hit={items:Z,pattern:e};if(a&&a.indexOf(e)>-1){f.updateSuggestion(f.filterCandidates(Z,a));}}};V.failure=function(Z){var Y=parseInt(Z.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296;if(Y!==B&&Y!==D&&Y!==J){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,T,false,null,true);}},onsuggestionItemsChange:function F(){var U=this.suggestionItems,R=this.suggestionPopup,Q=R.editorNode,S=U&&(U.length>8),P="",T="";if(S){P=E;T="px";}if(Q){Q.style.height=P+T;}else{if(S){T+=";";R.cssText=(R.cssText||"")+"height:"+P+T;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AC=mstrmojo.Enum_OIB_States,AB={},AD;for(AD in AC){if(AC.hasOwnProperty(AD)){AB[String(AC[AD])]=AD;}}return AB;}());var P=mstrmojo.dom,R=mstrmojo.hash,X=mstrmojo.Enum_OIB_States,I=0,Z="_did_",x=mstrmojo.Enum_Keys,AA=80,T=200;function O(){return I++;}function g(AB){return(AB&&AB.state===X.ADDING);}function n(AB){var AC={n:AB||"",state:X.EMPTY};AC[Z]=-2;return AC;}function N(AB){return(AB&&AB.state===X.EMPTY);}function s(AC){var AD=AC.items,AB=AD&&AD.length;if(!AB){return true;}return(AB===1&&g(AD[0]))||(AB===2&&N(AD[0])&&g(AD[1]));}function j(){var AC=this.ctxtBuilder.itemWidgets,AB=AC[AC.length-1];if(AB&&AB.isAdding){return AB;}return null;}function K(){var AB=this.editingIdx;if(AB!==null){return this.ctxtBuilder.itemWidgets[AB];}return j.call(this);}function D(){this.isActive=false;var AC=this.emptyText||"",AD=this.items;if(s(this)&&!N(AD[0])&&(AC.length>0)){this.add([n(AC)],0);var AE=this.ctxtBuilder.itemWidgets[0];AE.set("shouldEllipsize",true);AE.doEllipsize();}var AB=K.call(this);if(AB){if(g(AB)){AB.domNode.style.display="none";}this.scrollTo(this.items[0]);AB.blur();}P.detachEvent(document.body,"mousedown",this._mousedownHandler);}function M(){this.isActive=true;if(N(this.items[0])){this.remove(0);}var AB=K.call(this);if(AB){if(g(AB)&&!this.isFull){AB.domNode.style.display="block";}this.scrollTo(AB.data);AB.focus();}P.attachEvent(document.body,"mousedown",this._mousedownHandler);}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,getSearchPattern:function(){var AB=K.call(this);if(AB){return AB.getSearchPattern();}return"";},getSuggestionTarget:function k(){return this.suggestTarget;},onsuggestTargetChanged:function m(AB){this._request_pattern=null;},getSuggestionPos:function a(){return this._pop_cfg;},onSuggestionItemSelect:function t(AB){this.suggestTarget.setItem(AB[this.itemField],AB,false);this.hideSuggestion();},hideEditButton:function(AB){return !!this.noEditButton;},_set_items:function i(AG,AD){AD=AD||[];var AF=this.maxObjectCount;this.set("isFull",(AF&&AD.length>=AF));if(AD.length===0){var AC=this.emptyText||"";if(AC.length>0){AD.push(n(AC));}}var AE={n:"",state:X.ADDING};AE[Z]=-1;AD.push(AE);var AB=AD[AD.length-1];if(AB&&g(AB)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=Z;return this._super(AG,AD);},add:function E(AC,AB){var AD=j.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AC,AB);}if(!s(this)&&N(this.items[0])){this.remove(0);}if(AD){AD.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);}}AD.domNode.style.display="none";},remove:function Y(AB){this._super(AB);var AC=j.call(this);if(AC){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AC.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function W(){this._super();var AC=this,AB=j.call(AC);if(AB){AB.domNode.style.display="none";}this._clickHandler=function(){M.call(AC);};this._mousedownHandler=function(AD){if(!AC.isActive||AC.browserShown){return ;}var AE=P.eventTarget(self,AD);if(AE&&AE.parentNode&&!P.contains(AC.domNode,AE,false,document.body)&&!P.contains(AC.suggestionPopup.domNode,AE,false,document.body)){D.call(AC);}};P.attachEvent(this.domNode,"click",this._clickHandler);},nextId:O,item2textCss:function L(AB){return AB.cssClass||"";},itemFunction:function G(AG,AC,AE){AG[AE.itemIdField]=O();var AH=new mstrmojo.ObjectItem({parent:AE,itemField:AE.itemField,cssClass:AE.item2textCss(AG),data:AG});var AD=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AB=AD.length,AF;for(AF=0;AF<AB;AF++){AH.attachEventListener(AD[AF],AE.id,"_itemChangeHandler");}return AH;},getSelectedObjects:function h(){if(s(this)){return[];}var AB=this.items,AC=AB.length-1;if((AC>-1)&&g(AB[AC])){return AB.slice(0,AC);}return AB.concat();},isValid:function C(){var AC=this.ctxtBuilder.itemWidgets,AB=AC&&AC.length,AD;for(AD=0;AD<AB;AD++){if(!AC[AD].isValid()){return false;}}return true;},_itemChangeHandler:function(AE){var AG=AE.name,AH=AE.d,AC,AB=this.items.length,AD;switch(AG){case"ItemEditBegin":if(this.editingIdx!==null){AD=K.call(this);if(AD){AD.blur();}}AC=this.itemIndex(AH);this.editingIdx=AC;M.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AE.deactivate){D.call(this);}else{M.call(this);}AD=j.call(this);if(AD){AD.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AD=K.call(this);if(AD){AD.blur();}this.editingIdx=null;}AC=this.itemIndex(AH);this.remove(AC);if(!AE.deactivate){this.editingIdx=null;M.call(this);}else{if(!this.isActive){D.call(this);}else{M.call(this);}}break;case"ItemDeletePrev":if(AB>1){this.remove(AB-2);}break;case"ItemAdd":var AF=R.copy(AE.d);this.add([AF],AB-1);if(AE.deactivate){D.call(this);}else{M.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AE.target);this._pop_cfg={target:AE.target,left:AE.l,top:AE.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AE.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AG==="ItemEditEnd"||AG==="ItemAdd"||AG==="ItemDelete"||AG==="ItemDeletePrev"||AG==="ItemEditing")){this.onitemchange();}},unrender:function B(AC){var AB=this.suggestionPopup;if(AB.hasRendered){AB.unrender(false);}if(this._super){this._super(AC);}},destroy:function q(AC){var AB=this.suggestionPopup;if(AB&&AB.hasRendered){AB.destroy(false);}if(this._super){this._super(AC);}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var o="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span class="'+o+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=o+" "+this.cssClass;},onstateChange:function(){var AE=this.state,AD=mstrmojo.Enum_OIB_States_CSS[AE],AC=this.domNode;if(AE===X.EMPTY){AC.innerHTML='<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>";}else{if(AE===X.EDITING){var AB=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AB-4+"px";this.inputNode.style.width=AB-9+"px";}}AC.className="mstrmojo-ObjectItem "+AD;if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},state:X.VALID,onstateChange:function e(AB){this.data.state=this.state;},ontextChange:function H(AB){this.data[this.itemField]=this.text;},updateData:function F(AB){R.copy(AB,this.data);this.set("state",X.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function w(AC){this._super(AC);var AE=this.data,AB=AE.state,AD=this.parent;if(typeof AB==="undefined"){AB=AD.dynamicVerify?AD.verifyObject(AE[this.itemField],this):X.UNDETERMINED;AE.state=AB;}this.cssClass=AD.item2textCss(AE);this.text=AE[this.itemField];this.state=AB;this.isAdding=g(AE);this.useRichTooltip=true;},isValid:function C(){var AB=parseInt(this.state,10);return(AB!==X.INVALID&&AB!==X.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AE=this.inputNode.style;AE.width=AA+"px";var AD=this.domNode.parentNode,AB=AD.parentNode.offsetWidth,AC=Math.max(AB-AD.offsetLeft-20,AA);if(!isNaN(AC)){AE.width=AC+"px";}}},blur:function S(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AD=this.inputNode,AB=AD.value,AC=this.parent;window.setTimeout(function(){try{AD.blur();}catch(AE){}},0);if(!AB){return ;}if(AC.acptSugItemOnly){this.set("text",AB);this.set("text","");this._tWas_=null;return ;}this.setItem(AB,null,true);},focus:function p(){var AC=this.inputNode,AB=this.isActive;window.setTimeout(function(){try{AC.focus();if(AC.createTextRange&&!AB){var AE=AC.createTextRange(),AD=AC.value.length;AE.move("character",AD);AE.select();}}catch(AF){}},0);this.isActive=true;},prekeydown:function J(AB){var AD=this.inputNode.value,AC=parseInt(AB.e.keyCode||AB.e.charCode,10),AF=this.parent;if(!AD){return ;}if(AC===x.TAB||AC===x.ENTER){P.preventDefault(AB.hWin,AB.e);var AE=AF.getSelected();if(AE){AF.handleSuggestionItemSelect(AE);}else{this.hideSuggestion();if(!AF.acptSugItemOnly){this.setItem(AD,null,false);}else{this.set("text",AD);this.set("text","");}}}else{if(AC===x.DOWN_ARROW){if(!AF.noCache){this.showSuggestion(AD);}AF.nextHighlight();}else{if(AC===x.UP_ARROW){AF.preHighlight();}}}},prekeyup:function z(AB){var AD=this.inputNode.value,AC=parseInt(AB.e.keyCode||AB.e.charCode,10),AG=this.isAdding,AF=this.parent;if(!AD){if(AG){if(AC===x.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});P.preventDefault(AB.hWin,AB.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AC===x.ESCAPE){this.hideSuggestion();if(AF.acptSugItemOnly){this.set("text",AD);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AD){this.raiseEvent({name:"ItemEditing",d:this.data});if(AF.useKeyDelay){if(!this._timerID){var AE=this;this._timerID=window.setTimeout(function(){var AH=AE.inputNode.value;if(AH){AE.showSuggestion(AH);}AE._timerID=null;},T);}}else{this.showSuggestion(AD);}}}this._tWas_=AD;},setItem:function(AB,AD,AC){var AF=this.isAdding,AE=this.parent;AC=AC||false;this.set("text",AB);this._tWas_=null;if(AF){this.set("text","");if(!AD){AD={};AD[this.itemField]=AB;}else{AD.state=X.VALID;}this.raiseEvent({name:"ItemAdd",d:AD,deactivate:AC});}else{this.set("text",AB);if(AD){this.updateData(AD);}else{this.set("state",AE.verifyObject(AB,this));this.set("cssClass",AE.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AD,deactivate:AC});}},getSearchPattern:function U(){return this.inputNode.value;},showSuggestion:function l(AB){var AC=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AC.x)+"px",t:Math.round(AC.y+AC.h)+"px",pattern:AB,target:this});},hideSuggestion:function f(){this.raiseEvent({name:"SuggestionOff"});},del:function Q(AB){AB=AB||self.event;P.stopPropogation(self,AB);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function V(){this.showSuggestion(this.text);this.set("state",X.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});},doEllipsize:function b(){if(!this.shouldEllipsize){return ;}var AC=this.maxItemWidth,AB;if(AC){this.domNode.style.maxWidth=AC;switch(parseInt(this.state,10)){case X.VALID:case X.UNDETERMINED:case X.INVALID:AB=this.textNode;break;case X.EMPTY:AB=this.domNode.firstChild;break;}if(AB){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AB,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DynamicClassFactory","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo.SurveyVis","mstrmojo.VisDateSelection");var B={SurveyVisualizationStyle:{s:"VisualizationDataStyle",c:"SurveyVis"},visAjaxDatePicker:{s:"AjaxDatePickerReportStyle",c:"VisDateSelection"}};mstrmojo.ExpressVisList=mstrmojo.provide("mstrmojo.ExpressVisList",{getVis:function C(D){return B[D]||null;},getVisClass:function A(D,E){if(E.txi&&E.t===115){D=mstrmojo.DynamicClassFactory.newComponent(D,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getContentThroughTaskCall:function C(F,D){var E=mstrmojo.ACL.UserDataService;if(F.isRoot){E.getTopLevelGroups(F,D);}else{E.getMembers(F,D);}},isBranch:function B(D){return D.isGroup;},item2textCss:function A(D){return(this._super&&this._super(D))||{8704:"u",8705:"ug"}[D.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{item2textCss:function A(C){return(this._super&&this._super(C))||{8704:"u",8705:"ug"}[C.st]||"";},getCandidatesThroughTaskCall:function B(D,C){mstrmojo.ACL.UserDataService.searchUserCandidates(D.pattern,!D.isVerify,D.blockCount,C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.Label","mstrmojo.hash","mstrmojo.array");var O=mstrmojo.hash,L=mstrmojo.array,C=mstrmojo.emptyFn;var B=0,R=1,Q=2,W=3,I=4,S=5,F=6,M=7,Y=8,U=9;var E=2;var V=1,X=3;var K="u;";var P={};P[M]="MetricSlider";P[Y]="MetricQualification";P[U]="SearchBoxSelector";function A(b,a,k,l,m,Z){switch(a){case B:b.idx=O.any(m,true);var f=(typeof (b.idx)==="undefined"||b.idx<0);if(f){if(L.find(Z,"v","-1")<0){Z=[{v:"-1",n:""}].concat(Z);}b.idx="0";}b.unset=!!f;b.options=Z;break;case Y:case M:if(b.updateData){b.updateData({low:k.min,high:k.max,cnt:k.cnt,nov:k.nov},{cs:k.cs,f:k.f,ft:k.ft,qua:k.qt});}b.items=Z;b.selectedIndices=m;break;case U:if(Z&&!l.sos){b.candidates={isComplete:true,items:l.srcid?Z:[]};}if(l.srcid){var g=[],h=k.ces;if(h&&h.constructor===Array){if(l.dfm==V){for(var j=0;j<h.length;j++){if(h[j]["t"]!=X){g.push(h[j]);}}}else{g=h.concat();}}if(!l.sos){var e=mstrmojo.array,n=[];e.forEach(g,function(i){if(e.find(b.candidates.items,"v",i.v)>-1){n.push(i);}});g=n;}b.items=g;}break;default:b.items=Z;b.selectedIndices=m;break;}}mstrmojo.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocSelectorViewFactory",newPulldown:C,attachTargetListeners:C,getSelectorClass:function J(b,a){var Z=P[b];if(Z.constructor===Array){Z=Z[(a)?0:1];}return Z;},isSelectorSupported:function T(){return true;},newSelector:function H(p){var e=p.children,b=e&&e[0],l=p.style,j=p.selIdx,f=p.node,n=f.defn,k=f.data,Z=k.elms,a;if(!this.isSelectorSupported(p)){return null;}if(!b){if(!b){var h=p._cekEvtListener,q=p.id,o;if(h){n.detachEventListener(h);delete p._cekEvtListener;}if(l===B){b=this.newPulldown(p);o=function(s){a=this.options;if(L.find(a,"v",s.value)<0){if(L.find(a,"v","-1")<0){a.unshift({v:"-1",n:""});}b.idx="0";b.options=a;b.unset=true;p._inSyncPhase=true;b.refresh();p._inSyncPhase=false;}else{b.set("value",s.value);}};q=b.id;}else{var m=this.getSelectorCtrlConfig(p,l,n,Z),i=m.scriptClass;if(!i){b=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{delete m.scriptClass;var g=O.walk(i,mstrmojo);b=new g(m);if(l===M){p.attachEventListener("includeChange",b.id,function(s){this.set("include",s.value);this.selectRange();});}if(l===M||l===Y){p.attachEventListener("quaChange",b.id,function(s){this.set("qua",s.value);});o=function(s){if(p.id!==s.value.id){p._inSyncPhase=true;b.updateExpr(s.value);if(p.style===M){p.set("include",s.value.include);}p._inSyncPhase=false;}};}else{o=function(s){var t=[];a=this.node.data.elms;L.forEach(s.value,function(x){var w=L.find(a,"v",x);if(w>-1){t.push(w);}});this._inSyncPhase=true;b.select(t);this._inSyncPhase=false;};}}}if(o){p._cekEvtListener=n.attachEventListener("cekChange",q,o);}}p.addChildren(b);}A(b,p.style,k,n,j,Z);return b;},getSelectorCtrlConfig:function N(i,e,g,Z){var j=g.horiz,h=i.getFormats(),k=h&&h.height,a=O.copyProps,b=i.node.data,f={scriptClass:this.getSelectorClass(e,j),multiSelect:g.multi,isHoriz:j,include:g.include,itemWidthMode:g.iwm,allIdx:L.find(Z,"v",K),noneIdx:g.include?-1:L.find(Z,"v",K),renderAllItems:!k,onchange:function(){if(!i._inSyncPhase){i.selectorControlChange(this);}},makeSelection:function(l){if(!i._inSyncPhase){i.showInfoWin(l&&l.selItem);}}};if(f.noneIdx!==-1){f.allIdx=-1;}if(e===R||e===M){i.extCls="extSlider";if(g.cek){g.include=g.cek.include;b.cs=g.cek.cs;b.f=g.cek.f;b.ft=g.cek.ft;i.qua=g.cek.qua;}}if(e===R){a(["height","width"],h,f);}else{if(e===Y||e===M){if(e===M){f.isHoriz=true;f.include=g.include;}a(["height","width","font"],h,f);a(["cs","ft"],g,f);f.fmts=g.f;f.qua=i.qua;f.numFmts=g.numFmts;}else{if(e===U){f={scriptClass:f.scriptClass,cssText:h.height?"height: "+h.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(g.ttl||""),items:g.srcid?(b.ces?b.ces.concat():[]):[],REQUEST_THRESHOLD:55,suggestCount:50,srcid:g.srcid||"",dsrc:g.dsrc||"",onitemsChange:function(){if(!i._inSyncPhase){i.showInfoWin();i.selectorControlChange(this);}}};if(Z&&!g.sos){f.candidates={isComplete:true,items:g.srcid?Z:[]};}else{f.useKeyDelay=true;f.noCache=true;}if(!g.multi){f.maxObjectCount=1;}}}}return f;},updateControlStyles:function D(a){if(a.isInFilterPanel()&&!a.isHorizFP()){var Z=a.style;if(Z===R||Z===Y||M){a.children[0].width=a.parent.parent.contentWidth;}}}});var G=mstrmojo.DocSelectorViewFactory;G.STYLES={PULLDOWN:B,SCROLLER:R,LIST:Q,RADIO:W,CHECKBOX:I,BUTTON:S,LINK:F,METRIC_SLIDER:M,METRIC_QUAL:Y,SEARCH_BOX:U};G.ELEM_ALL=K;G.UC_ON_DS=E;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.DocSelectorViewFactory","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper");var L=mstrmojo.array,P=mstrmojo.hash,V=mstrmojo.dom,Y=mstrmojo.DocSelectorViewFactory.STYLES,S=mstrmojo.DocSelectorViewFactory.ELEM_ALL,M=mstrmojo.elementHelper;var F=mstrmojo.DocSelectorViewFactory.UC_ON_DS;function H(){return{type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,disablePU:(parseInt(this.defn.subTp,10)===F)};}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" class="mstrmojo-DocSelector {@extCls}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100; position:absolute; top:0px; left:0px; width:100%; height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onincludeChange:function(){mstrmojo.css.toggleClass(this.domNode,"strikeout",!this.include);},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwaitChange:function(){this.wIconNode.style.display=((this.wait)?"block":"none");}},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",bGetElems:false,init:function U(b){this._super(b);var a=this.node.defn.style;this.spm=(a===Y.METRIC_QUAL||a===Y.METRIC_SLIDER);},initControlInfo:function I(){var f=this.node,g=f.data,j=f.defn,a=g.elms,h=g.ces,b=j.style;var k=["include","ckey","ck","tks","style","multi","showall"];if(!this.bGetElems&&parseInt(j.subTp,10)===F&&b!==Y.SEARCH_BOX){this._fetchAllElems();a=g.elms;}if(b===Y.METRIC_QUAL||b===Y.METRIC_SLIDER){k=k.concat(["srcid","srct"]);this.qua=g.qt;this.dt=g.dt;}this.type=j.ct;var l=j.fmts;if(l){var m=l.width;if(!m||parseInt(m,10)<=0){l.width="95px";}}P.copyProps(k,j,this);var e=this.selIdx={},i=j.multi;if(this.include&&i&&L.find(h,"v",S)>-1){h=a;}if(h){L.forEach(a,function(o,n){if(L.find(h,"v",o.v)>=0){e[n]=true;}});}},resetFormatHandlers:function A(){this.formatHandlers={contentNode:["RW"]};},selectorControlChange:function O(b){var AC=H.call(this),AD="\u001E",e=[],AA=this.style,w=this.defn.sec,x;switch(AA){case Y.PULLDOWN:var s=b.value,q=null;if(b.selectNode){var AB=b.selectNode;q=AB.options[AB.selectedIndex].text;}AC.eid=s;if(parseInt(AC.type,10)===1&&q!==null){AC.eid=AC.eid+";"+q;}this.defn.set("cek",s);this.currSelValue=s;if(w){this.parent.set("count",M.buildElemsCountStr([s],this.node.data.elms));}break;case Y.SEARCH_BOX:L.forEach(b.items,function(i){e.push(i.v+";"+i.n);});if(!e.length&&this.showall){e.push("u;");}AC.eid=e.join(AD);if(w){this.parent.set("count",M.buildElemsCountStr(e,this.node.data.elms));}break;case Y.METRIC_QUAL:case Y.METRIC_SLIDER:if(this.srcid===undefined){return ;}var f=[];L.forEach(b.cs,function(i){f.push(i.v);if(AC.dtp===undefined){AC.dtp=i.dtp;}});if(f.length){AC.cs=f.join(AD);}var a=mstrmojo.MCSUtil.getFuncInfo(b.opId,b.qua);AC.f=b.f=a.f;AC.ft=b.ft=a.ft;AC.include=b.include=this.include;AC.ckey=this.ckey;AC.srcid=this.srcid;AC.srct=this.srct;AC.unset=b.unSet;AC.onlyInclude=b.onlyInclude;AC.changeQual=b.changeQual;AC.qt=b.qua;this.node.defn.set("cek",{id:this.id,f:b.f,ft:b.ft,cs:b.cs,qua:b.qua,include:b.include});break;default:var t=this.node,o=t.data.elms,g=b.selectedIndices,m=b.allIdx,k=!!g[m],j=[],l=this.include;if(k){e=[o[m].v];j=[o[m].v];}else{if(g[m]){g[m]=false;}var z=P.keyarray(g,true).sort(L.numSorter),p={};for(x in z){p[z[x]]=g[z[x]];}g=p;P.forEach(g,function(n,i){if(n){e.push(o[i].v);j.push(o[i].v+";"+o[i].n);}});}AC.eid=((parseInt(AC.type,10)===1)?j:e).join(AD);var h=mstrmojo.dom.position(b.domNode,true);if(h){AC.left=h.x;AC.top=h.y;}if(k&&this.multi&&l){L.forEach(o,function(n){var i=n.v;if(e[0]!==i){e.push(i);}});}t.defn.set("cek",e);if(w&&AA!==Y.SCROLLER){this.parent.set("count",M.buildElemsCountStr(e,o));}break;}var AE=this;window.setTimeout(function(){AE.slice(AC);},0);},showInfoWin:function Q(g){var b=this.model,e=b.getTargetInfoWin(this.tks);if(e&&e.length){var l=this.defn.horiz,a=g||this.contentNode,h=V.position(a),k=V.position(this.contentNode),j=(l||this.defn.style==Y.SCROLLER)?null:{x:k.x,y:h.y,w:k.w,h:h.h};for(var f=0;f<e.length;f++){b.showInfoWin(e[f],a,l?"v":"h",false,P.copy(j));}}},preBuildRendering:function G(){var f=true,g=this.node.defn.style,e=P.clone(this.formatHandlers),b=e.contentNode;if(b){if((g===Y.RADIO||g===Y.CHECKBOX)&&e.filterNode){b.push("fx");b.push("background-color");delete e.filterNode;}if(g===Y.LIST){delete b.height;}if(g===Y.SEARCH_BOX){var h=e.domNode;L.removeItem(h,"color");var a=L.indexOf(h,"F");if(a>-1){L.removeIndices(h,a,1);h.push("font");}}}this.formatHandlers=e;f=this._super();this.builder.selectorFactory.updateControlStyles(this);return f;},postBuildRendering:function X(){var e=this.node.defn.style,h=this.filterNode.style,a=this.contentNode,b=this.node.defn;this._super();if(this.formatHandlers.filterNode){var g=this.getFormats();if(!g.width){h.width=a.clientWidth+"px";}if(!g.height){h.height=a.clientHeight+"px";if(e===Y.METRIC_QUAL||e===Y.METRIC_SLIDER){this.updateHeight();}}else{if(e===Y.METRIC_QUAL){a.style.height=g.height;}}}else{h.display="none";}if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(b.ds,10)===0);}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");this.builder.selectorFactory.attachTargetListeners(this);if(V.isAndroid&&e===Y.SCROLLER){a.style.overflow="visible";}return true;},_fetchAllElems:function J(){var a=this.node.defn,f=this.node.data;var g={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:a.srcid||"",dataSourcesXML:a.dsrc||"",browseFlags:1};var e=this,b={success:function(h){e.bGetElems=true;e.set("wait",false);if(h&&h.es){f.elms=(a.srcid)?M.buildElemsTerseID(h.es,a.srcid,true):h.es;var i=e.parent,j=i&&i.parent;if(f.ces&&f.elms&&f.elms.length>0&&i){i.set("count",M.buildElemsCountStr(f.ces,f.elms));}if(e.hasRendered){e.refresh();if(e.isInFilterPanel()){if(i&&i.defn.ttl){i.updateContentHeight();}if(j&&j.refreshFP){j.refreshFP();}}}}},failure:function(h){mstrmojo.alert(h.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.set("wait",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,b,g,false,null,true);},updateHeight:function B(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var a=this.parent;if(a&&(a.defn.ttl!==undefined)&&a.updateContentHeight){a.updateContentHeight();}},onCGBMapChange:function D(b){var a=b.cgbMap;if(!a){return ;}var e=this.tks;P.forEach(this.defn.cgb,function(g){var f=a[g];if(f&&e.indexOf(f)<0){e+="\u001E"+f;}});this.tks=e;},update:function K(g){this.node=g;var j=this.node.defn,b=j.style,a=this.node.data.elms,k=this.parent,f=(b===Y.SCROLLER);if(f&&j.multi){var e=L.find(a,"v",S);if(e>-1){L.removeIndices(a,e,1);}}if(j.sec&&!f&&!j.sos){var h=g.data.ces;if(k&&k.count){if(h&&a&&a.length){k.set("count",M.buildElemsCountStr(h,a));}}}this.initControlInfo();var i=this.content=this.builder.selectorFactory.newSelector(this);if(!i){this.set("visible",false);}},onincludeChange:function E(a){this.node.defn.include=this.include=a.value;if(this.style!==Y.METRIC_SLIDER){this.include=a.value;var b=H.call(this);b.ckey=this.ckey;this.slice(b);}},slice:function R(e){var a=this.model;if(this.isInFilterPanel()){var b=this.getFilterPanel();if(b&&!b.defn.cas){b.bufferSlice(e);return ;}}a.slice(e);},onquaChange:function T(a){this.node.data.qt=a.value;},isInFilterPanel:function N(){var a=this.parent;return(a&&a.isInFilterPanel&&a.isInFilterPanel())||false;},isHorizFP:function Z(){var a=this.parent;return(a&&a.isHorizFP&&a.isHorizFP())||false;},getFilterPanel:function W(){var a=this.parent;return(a&&a.getFilterPanel&&a.getFilterPanel())||null;}});if(!mstrmojo.dom.isIE){var C=mstrmojo.DocSelector.prototype.formatHandlers;C.contentNode=C.filterNode;delete C.filterNode;}}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelectorViewFactory","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.ListBoxHoriz","mstrmojo.ListBoxSelector","mstrmojo.LinkList","mstrmojo.ButtonList","mstrmojo.DropDownList","mstrmojo.Slider");var C=mstrmojo.DocSelectorViewFactory.STYLES;var A={};A[C.RADIO]=["RadioListHoriz","RadioList"];A[C.CHECKBOX]=["CheckListHoriz","CheckList"];A[C.LIST]=["ListBoxHoriz","ListBoxSelector"];A[C.LINK]=["LinkListHoriz","LinkList"];A[C.BUTTON]=["ButtonListHoriz","ButtonList"];A[C.SCROLLER]="Slider";A[C.METRIC_SLIDER]="MetricSlider";A[C.METRIC_QUAL]="MetricQualification";mstrmojo.OIVMDocSelectorViewFactory=mstrmojo.declare(mstrmojo.DocSelectorViewFactory,null,{scriptClass:"mstrmojo.OIVMDocSelectorViewFactory",newPulldown:function E(F){return new mstrmojo.DropDownList({k:F.ck,cssDisplay:"block",cssClass:"mstrmojo-DocSelector-DropDownList",selectCssClass:"mstrmojo-DocSelector-DropDownList-select",onvalueChange:function(){if(!F._inSyncPhase){F.showInfoWin();F.selectorControlChange(this);}}});},updateControlStyles:function D(M){var I=M.style,F=M.children[0],G=M.node,J=G.defn,N=J.horiz,K=M.getFormats(),H,O,L;if(I===C.SEARCH_BOX&&J.ttl){M.contentNodeCssText+="overflow:hidden";}else{if(J.hm===0&&I!==C.SCROLLER&&I!==C.METRIC_SLIDER){M.contentNodeCssText+="overflow-"+((N)?"x":"y")+":hidden;";}}if(K){F.color=H=K.color;O=K.height;L=K["background-color"]||(K.p_fmts&&K.p_fmts["background-color"]);}if(I===C.PULLDOWN){if(K){if(H){M.itemCssText+="color:"+H+";";}}F.cssText=M.itemCssText;}else{F.cellCssClass="";F.tableCssText="table-layout:"+((J.iwm===0)?"fixed":"auto")+";";if(I===C.METRIC_QUAL){F.cssText="";}else{if(O!==undefined){if(I===C.SEARCH_BOX){F.height=(parseInt(O,10)-2)+"px";}else{F.cssText="height:"+O+";";}}}if(I===C.LIST&&L){F.cssText+="background-color:"+L+";";}switch(I){case C.RADIO:case C.CHECKBOX:F.labelCssText=M.itemCssText;break;case C.BUTTON:case C.LINK:case C.LIST:if(I===C.BUTTON){if(H){M.itemCssText+="color:"+H+";";}}if(N){M.itemCssText+="height:"+O+";";}F.itemCssText=M.itemCssText;M["background-color"]=L;break;}this._super(M);}},getSelectorClass:function B(H,G){var F=A[H];if(F){if(F.constructor===Array){F=F[(G)?0:1];}return F;}return this._super(H,G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.StackContainer","mstrmojo.CheckList");var Y=mstrmojo.css,K=mstrmojo.array,L=[],H="sharingEditor",A=199,C="294DEDC011D2F1D56000D98E67019608",i="C82C6B1011D2894CC0009D9F29718E4F",E=[1,4,8,16,32,64,128],b=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],g=["B","R","W","D","C","U","E"],T=false,O=true,M=257,h=1024,S=772,P=776,B=777;function e(j){return(j&&j.t===8);}function Z(j){return j&&j.st!=M&&j.st!=h&&j.st!=S&&j.st!=P&&j.st!=B;}function R(j){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[j]||j;}function J(j){return{"253000":255000,"253":255,"32221":223,"56197":199}[j]||j;}function W(p){var o=p.acls,j=p.inhs,n=[],s,l,q,k,m;if(e(p)){o=o.concat(mstrmojo.hash.valarray(j));}for(k=0,m=o.length;k<m;k++){s=o[k];q=s.rgt;if(q>1000){l=mstrmojo.hash.copy(s);l.den=true;l.rgt=Math.floor(q/1000);n.push(l);}if((q%1000)>0){l=mstrmojo.hash.copy(s);l.den=false;l.rgt=q%1000;n.push(l);}}p.acls=n;return p;}function Q(k){var j={isSerializable:function(n,m,l){switch(n){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(o,l,m){if(o==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",k,j);}function F(m,l){var k=m&&m.oi,j;if(k){k=W(k);j=Q(k);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(n){if(l){m.close();}},failure:function(n){mstrmojo.alert(n.getResponseHeader("X-MSTR-TaskFailureMsg"));if(l){m.close();}}},{taskId:"saveObjectACL",objectXML:j,sessionState:mstrApp.sessionState,objectType:k.t,objectID:k.did,propagateToChildren:m.childrenAccessPulldown.value});}}function a(s){var AA=s.aclList,AB=s.objectInputer,t=s.rightPulldown,m=AB.getSelectedObjects(),o=m.length,w=[],l,z=t.value,k,x,j;if(!AB.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,s.alertTitle);return false;}for(k=0;k<o;k++){l=m[k];if(l.did===C||l.did===i){var n=mstrmojo.all[H];if(z===n.currentPublicRight){if(O){Y.removeClass(n.userMessage.domNode,"hideMsg");}}}x=K.find(AA.items,"did",l.did);if(x!==-1){j=AA.items[x];if(s.uneditableRights[j.rgt]){continue;}}w.push(new mstrmojo.Obj({n:l.n,did:l.did,st:l.st,rgt:z,newItem:true}));}if(w.length>0){var q=K.findMulti(AA.items,"did",w);if(q.count){var p=q.indices.concat().sort(K.numSorter).slice(0,q.count);for(k=p.length-1;k>-1;k--){AA.remove(p[k]);}}AA.add(w);s.set("hasChanged",true);}AB.set("items",[]);return true;}function f(j){var l=[],o=Math.floor(j/1000),m=j%1000,p=E,q=b,n=p.length,t,k;for(k=0;k<n;k++){l.push(q[k]);l.push(" ");if((m&p[k])>0){l.push(mstrmojo.desc(8083,"Granted"));}else{if((o&p[k])>0){l.push(mstrmojo.desc(8084,"Denied"));}else{l.push(mstrmojo.desc(959,"Default"));}}l.push(",");}t=l.join("");return t.substring(t,t.length-1);}function D(q){var n=[],p=q%1000,l=E,o=g,j=l.length,m,k;for(k=0;k<j;k++){if((p&l[k])>0){n.push(o[k]);n.push(",");}}m=n.join("");return m.substring(m,m.length-1);}function X(l,m){var n=l.items,k=K.find(n,l.itemIdField,m),p=l.customItem,j=n.length-2;if(k===-1){var o={n:D(m),rgt:m};if(p){n.splice(j,1);}j=n.length-1;n.splice(j,0,o);l.customItem=o;}else{if(p&&k!==j){n.splice(j,1);l.customItem=null;}}l.set("title",f(m));l.value=m;}function I(j){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[j]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function V(p,o){var n="";if(o){var k=this.widthInput.value,q=this.heightInput.value,j=' src="'+p,s="",l=this.checkBoxList.items,m;for(m=0;m<l.length;m++){if(!this.checkBoxList.selectedIndices.hasOwnProperty(m)){if(s==""){s="&hiddensections="+l[m].alias;}else{s+=","+l[m].alias;}}}n='<iframe width="'+k+'" ';n+='height="'+q+'" ';n+=j;n+=s;n+='"></iframe>';}else{n='<iframe width="640" height="480" src="';n+=p;n+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return n;}function G(k){var m=mstrmojo.string.parseUri(k).queryKey,n=k.indexOf("?"),j=n>0?k.substring(0,n):k;if(m.hasOwnProperty("iframe")){delete m.iframe;}if(m.hasOwnProperty("validateRandNum")){delete m.validateRandNum;}if(!m.hasOwnProperty("server")){m.server=encodeURIComponent(mstrApp.serverName);}if(!m.hasOwnProperty("Project")){m.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!m.hasOwnProperty("port")){m.port=mstrApp.serverPort;}if(T){m.connmode=8;m.ru=1;}m.share=1;j+="?";for(var l in m){j+=l+"="+m[l]+"&";}j=j.substring(0,j.length-1);return j;}function U(m){var j=new Date(),l=this.objectName+" "+j.toLocaleDateString()+" "+j.toLocaleTimeString(),k=this,n={success:function(q){var p=G(q.url);k.linkBox.set("value",p);k.url=p;k.htmlPanel.htmlBox.set("value",V(p));var o=k.tabDock.emailLink;o.set("url",window.escape(p));o.set("name",k.objectName);},failure:function(o){mstrmojo.alert(o.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){k.hideWait();if(m){window.open("mailto:?body="+window.escape(k.url)+"&subject="+k.objectName,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,n,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:l,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function N(m){var k=I(this.oi.st),j=k.length,l;for(l=0;l<j;l++){if(k[l].rgt===m){return k[l].n;}}return mstrmojo.desc(2056,"Custom");}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",hasChanged:false,help:"sharing_dialog_box.htm",zIndex:1000,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),onShowLink:function(k){var j={htmlCode:"showLink",showLink:"htmlCode"};this.tabDock[j[k]].set("selected",false);},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var q=this.oi.acls,l,w=K.find(q,"did",i),o=this.aclList.itemsContainerNode,p=this.publicAccessSection.publicLabel,n,t=false,j=K.find(q,"did",C),s;if(w!==-1&&T&&j!==-1){var k=q[w].rgt,m=q[j].rgt;if(k===m){t=true;s=m;}}if(w!==-1&&!T){t=true;s=q[w].rgt;}n=o.children[0].tBodies;if(T&&n[j]){Y.toggleClass(n[j].rows[0],"hide",t);}if(n[w]){Y.toggleClass(n[w].rows[0],"hide",t);}p.set("checked",t);if(s){this.set("currentPublicRight",s);}},oncurrentPublicRightChange:function(){var j=this.publicAccessSection.publicMouseOver;j.publicRight.set("value",this.currentPublicRight);j.publicRightLabel.set("text",N.call(this,this.currentPublicRight));},onOpen:function(){var k=this.oi.n,q=this.oi.acls;this.objectName=k;this.set("showACL",!!q);T=this.guestModeEnabled;if(this.href&&!this.isLinkDirty){var l=G(this.href),o=this.tabDock.emailLink;this.url=l;o.set("url",window.escape(l));o.set("name",k);this.htmlPanel.htmlBox.set("value",V(l));this.linkBox.set("value",l);}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(k)));var n=this.tabDock;n.showLink.set("selected",false);n.htmlCode.set("selected",false);if(q){this.checkPublicAccess();var p=this.rightPulldown;p.set("items",this.getAvailableRightsForSelection());p.set("value",A);var s=this.objectInputer,m=this.userSelector,j=m&&m.userBrowser;s.zIndex=this.zIndex;if(j&&j.hasRendered){j.set("items",[]);j.getContent(j);}this.set("hasChanged",false);}},_set_hasChanged:function(l,j){var k=(j!==this.hasChanged);this.hasChanged=j;if(j===true){this.checkPublicAccess();}return k;},_set_oi:function(k,j){this.oi=this.preProcessACLs(j);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return I(this.oi.st);},preProcessACLs:function(q){if(q&&q.acls){var o=q.acls,n=o&&o.length,p=e(q),k={},s,j,l,m;if(p){l={};q.inhs=l;}for(m=0;m<n;m++){s=new mstrmojo.Obj(o[m]);if(p&&s.inh){l[s.n]=mstrmojo.hash.copy(s);continue;}j=k[s.n];if(!j){j=mstrmojo.hash.copy(s);j.rgt=0;delete j.den;k[s.n]=j;}j.rgt+=s.den?s.rgt*1000:s.rgt;}o=mstrmojo.hash.valarray(k);q.acls=o;}return q;},onClose:function(){var j=this.objectInputer;j.set("items",[]);this.aclList.clearSelect();},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",updateTreeContent:function(k,m){k.contentRetrieved=true;var l=m[k.itemChildrenField],j=k.tree||k,o=m.bc,n=m.sz,p=m.bb;if(o!==-1){if(p+o<=n){l.push(j.nextItemCreaterFunc());}if((p-o)>-1){l.unshift(j.prevItemCreaterFunc());}}k.blockBegin=p;j.initializing=true;k.clearSelect(false);k.set("items",l);k.setSelectedItems(j.getTotalSelections(),true);j.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(k){var j=this.parent.parent,o=j.opener,n=o.objectInputer,m=j.userBrowser,l=m.getTotalSelections();if(l&&l.length>0){n.add(l,n.items.length-1);}j.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(j){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var p=this.rgt,q=Math.floor(p/1000),o=p%1000,l=this.children,m,n,k,j;for(k=0,j=l.length;k<j;k++){m=l[k];n=m.right;if(this.twoStates){m.set("grayed",false);m.set("checked",false);}else{m.set("grayed",true);m.set("checked",true);}if((q&n)>0){m.set("checked",false);m.set("grayed",false);}if((o&n)>0){m.set("checked",true);m.set("grayed",false);}}},getACLValue:function(){var n=0,o=0,l=this.children,m,k,j;for(k=0,j=l.length;k<j;k++){m=l[k];if(m.grayed||!m.right){continue;}if(m.checked){n+=m.right;}else{o+=m.right;}}return o*1000+n;},children:[{scriptClass:"mstrmojo.TristateCheckBox",alias:"browse",right:1,text:mstrmojo.desc(1825,"Browse")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"read",right:4,text:mstrmojo.desc(8078,"Read")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"write",right:8,text:mstrmojo.desc(8079,"Write")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"delete",right:16,text:mstrmojo.desc(629,"Delete")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"control",right:32,text:mstrmojo.desc(8080,"Control")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"use",right:64,text:mstrmojo.desc(8081,"Use")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"execute",right:128,text:mstrmojo.desc(8082,"Execute")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(j){var k=this.parent.parent;if(k.onOK){k.onOK();}k.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(j){var k=this.parent.parent;if(k.onCancel){k.onCancel();}k.close();}}]}]},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9811,"Sharing Options"),bindings:{visible:function(){return Z(this.parent.oi);}},cssClass:"SharingEditor-title"},{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return Z(this.parent.oi);}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink style="{@cssText} mstrAttach:click>'+mstrmojo.desc(9772,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var j=this.parent.parent;if(!this.url||j.isLinkDirty){U.call(j,true);j.set("isLinkDirty",false);}else{window.open("mailto:?body="+window.escape(j.url)+"&subject="+j.objectName,"mailtoIframe");}}},{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Show Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(j){var k=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!k.url||k.isLinkDirty){U.call(k);k.set("isLinkDirty",false);}k.onShowLink(this.alias);this.set("selected",true);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(j){var k=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!k.url||k.isLinkDirty){U.call(k);k.set("isLinkDirty",false);}k.onShowLink(this.alias);this.set("selected",true);}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(2985,"Width"),value:640,onvalueChange:function(j){var k=this.parent,l=mstrmojo.all[H];k.htmlBox.set("value",V.call(k,l.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(2983,"Height"),alias:"heightInput",value:480,onvalueChange:function(){var j=this.parent,k=mstrmojo.all[H];j.htmlBox.set("value",V.call(j,k.url,true));}},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation Bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools Panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(j){var k=this.parent,l=mstrmojo.all[H];k.htmlBox.set("value",V.call(k,l.url,true));}}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.TextBox",alias:"linkBox",cssClass:"SharingEditor-Link",bindings:{visible:"this.parent.tabDock.showLink.selected"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"[Who has access]"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");}},oncheckedChange:function(){Y.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(T){this.getUserGroupFromTaskCall(C);}this.getUserGroupFromTaskCall(i);},getUserGroupFromTaskCall:function(p){var l=mstrmojo.all[H],m=l.aclList,n=mstrmojo.ACL.UserDataService,o=function(s){var q=new mstrmojo.Obj({n:s.n,did:s.did,st:s.st,rgt:A,newItem:true});L.push(q);},k=function(q){},j=function(){if(!T||(T&&L.length==2)){m.add(L);l.set("hasChanged",true);}};n.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:p}},{success:o,failure:k,complete:j});},onclick:function(){var k=mstrmojo.all[H];var l=k.aclList.items;var m=K.find(l,"did",i);if(m!==-1){l.remove(m);}var j=K.find(l,"did",C);if(T&&j!==-1){l.remove(j);}if(this.checked===true){if(L.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(L,function(n){n.rgt=A;});l.add(L);k.set("hasChanged",true);}}else{k.set("currentPublicRight",A);k.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",bindings:{visible:"this.parent.publicLabel.checked"},children:[{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var j=this.parent.parent.parent;return N.call(j,j.currentPublicRight);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight"},selectionPolicy:"reselect",onvalueChange:function(){var j=this.parent;var k=j.parent.parent;j.publicRightLabel.set("text",N.call(k,this.value));},_set_value:function(p,k){var l=this.value,j=(l!==k);if(j){if(k===-1){var o=this.parent.parent.parent,m=this;o.openPopup("customACL",{zIndex:o.zIndex+10,rgt:l,twoStates:true,onOK:function(){m.set("value",this.getACLValue());},onCancel:function(){m.set("value",l);}});return false;}k=J(k);X(this,k);this.updatePublicRight(k);return true;}return true;},updatePublicRight:function(k){var l=this.parent.parent.parent;if(l.aclList){var m=l.aclList.items;var j=K.find(m,"did",C);var n=K.find(m,"did",i);if(T&&j!==-1){m[j].rgt=k;}if(n!==-1){m[n].rgt=k;}l.set("hasChanged",true);l.set("currentPublicRight",k);}}}]}]},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){Y.addClass(this.domNode,"hideMsg");O=false;}},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(k){var o=this.parent.oi;if(!e(o)){return ;}var p=o.inhs,m=k.value,j=m&&m.length,q,l;for(l=0;l<j;l++){q=m[l].n;delete p[q];}},onadd:function(k){var o=this.parent.oi;if(!e(o)){return ;}var p=o.inhs,m=k.value,j=m&&m.length,q,l;for(l=0;l<j;l++){q=m[l].n;p[q]=mstrmojo.hash.copy(m[l]);p[q].inh=true;}},onACLChanged:function(k){var j=this.parent.oi;this.parent.set("hasChanged",true);if(!e(j)){return ;}j.inhs[k.n]=mstrmojo.hash.copy(k);j.inhs[k.n].inh=true;},columns:[{dataFunction:function(l,j,k){return'<div class="mstrmojo-ACLEditor-user '+(l.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(l.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",children:[{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){return N.call(mstrmojo.all[H],this.parent.parent.data.rgt);}}},{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var j=this.parent.parent.data;this.set("value",j[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(p,k){var l=this.value,j=(l!==k);if(j){if(k===-1){var o=this.parent.parent.dataGrid.parent,m=this;o.openPopup("customACL",{zIndex:o.zIndex+10,rgt:l,twoStates:!!this.parent.parent.data.newItem,onOK:function(){m.set("value",this.getACLValue());},onCancel:function(){m.set("value",l);}});return false;}k=R(k);X(this,k);this.parent.parent.data.set(this.itemIdField,k);if(l!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(j){var k=this.parent.parent.dataGrid;k.remove(this.parent.parent.data);k.parent.set("hasChanged",true);}}]}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.UserInputBox",emptyText:mstrmojo.desc(9151,"Type users or groups here."),noCache:true,onRender:function(){var j=this.parent.parent.parent;if(j){j.objectInputer=this;}}},{scriptClass:"mstrmojo.Pulldown",itemIdField:"rgt",value:199,defaultSelection:0,selectionPolicy:"reselect",onRender:function(){var j=this.parent.parent.parent;if(j){j.rightPulldown=this;}},postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},_set_value:function(p,k){var l=this.value,j=(l!==k);if(j){if(k===-1){var o=this.parent.parent.parent,m=this;o.openPopup("customACL",{zIndex:o.zIndex+10,rgt:l,twoStates:true,onOK:function(){m.set("value",this.getACLValue());},onCancel:function(){m.set("value",l);}});return false;}k=J(k);X(this,k);return true;}return true;}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",onclick:function(j){var k=this.parent.parent.parent;a(k);},text:mstrmojo.desc(2156,"Add")},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-ACLEditor-chooseLabel",onclick:function(j){var k=this.parent.parent.parent;k.openPopup("userSelector",{zIndex:k.zIndex+10});},text:mstrmojo.desc(1825,"Browse")}]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&e(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&e(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),bindings:{enabled:function(){var j=this.parent.parent.oi;return(j.acg&32)>0&&this.parent.parent.hasChanged;}},onclick:function(j){var k=this.parent.parent;if(a(k)){F(k,true);}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Close",onclick:function(j){var k=this.parent.parent;k.close();k.set("hasChanged",false);},bindings:{iconClass:function(){var j=this.parent.parent;if(j.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){var j=this.parent.parent;if(!j.showButtonText){return"";}if(j.hasChanged){return mstrmojo.desc(2140,"Cancel");}return mstrmojo.desc(2102,"Close");}}}]}]});mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch){this.set("selected",this.children[1]);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.children[0]);}},preBuildRendering:function(){this.set("selected",this.children[0]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.NumberFormat","mstrmojo.Button");var O=mstrmojo.desc,K=mstrmojo.Button.newInteractiveButton,b=mstrmojo.date,AA=function(){return mstrmojo.locales.datetime;};function W(AC,AD){mstrmojo.form.send(AD,null,"post");}function z(AE,AD){var AC=AE.model;W(AE,{evt:3124,src:mstrApp.name+"."+mstrApp.pageName+".3124",relativePageNumber:AD,messageID:AC.mid,rwb:AC.bs});}function f(AE,AF){var AC=AE.model;var AD={evt:2048001,messageID:AC.mid,rwb:AC.bs};if(AF<50||AF===2048){AD.visMode=0;AD.currentViewMedia=AF;}else{AD.visMode=AF;AD.currentViewMedia=1;}W(AE,AD);}function J(AD){var AC=mstrApp.prevViewMedia;if((!AC&&AC!==0)||AC===-1){z(AD,-1);}else{if(AC===0){AD.designViewMode();}else{f(AD,AC);}}}function AB(AG,AD,AF,AE){var AC=AG.model;W(AG,{evt:2048030,src:AC.bp+".2048030",rePrompt:AD,fresh:AF,regenerate:AE,rwb:AC.bs});}function Q(AK,AD){var AG=AK.model,AH=(AG&&AG.ztp)||0,AE=(AG&&AG.zf)||1,AC=AH+":"+AE,AF=AK.zoomOptions,AI;if(AF){var AJ=mstrmojo.array.find(AF,"dssid",AC);if(AJ>-1){AI=AF[AJ];}}if(!AI){AI={n:parseInt(AE*100,10)+"%",dssid:AC,f:AE,tp:AH};}if(AD===true){AK.zoomValue=AI;}else{AK.set("zoomValue",AI);}}function M(AI,AK,AE,AJ,AG,AH){var AF=AI.model,AC=AF&&AF.dty;if(!AC){AJ(AI,AG);return ;}var AD="#666";mstrmojo.confirm(AE,[K(O(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");AI.save(AH);},AD),K(O(2140),null,AD)],AK);}function o(AD){var AC=AD.model;AC.showDialogBeforeSave=false;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){},failure:function(AE){mstrmojo.alert(AE.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"askBeforeSaveChanges\u001E2"});}var t=-1,Z=3,l=4,G=7;mstrmojo._DocOIVMMethods={staticViewMode:function B(){f(this,1);},interactiveViewMode:function H(){f(this,2);},editableMode:function k(){f(this,4);},flashViewMode:function e(){f(this,8);},IVEMode:function N(){f(this,2048);},IVEHelp:function N(){var AC=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/MicroStrategy_Web_Help.htm#";window.open(AC+"about_interactive_visual_data_exploration.htm","_blank");return true;},remainExpressViewMode:function L(){},designViewMode:function p(){W(this,{evt:3104,rwDesignMode:1,messageID:this.model.mid,rwb:this.model.bs});},convertToDoc:function j(){var AC=this;mstrmojo.confirm(O(8127),[K(O(1442),function(){AC.designViewMode();},null),K(O(2140),null,null)]);},saveAs:function(AC){this.save();},save:function U(AD){var AC=this.model;W(this,mstrmojo.hash.copy(AD,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:AC.sfid||AC.pfid,saveFromDesignMode:false,rwb:AC.bs}));},dSave:function x(){var AI=this,AE=AI.model,AG=AE&&AE.isnew,AD=AE&&AE.isRWReadonly;maxLen=60;truncateName=AE.n;if(truncateName.length>maxLen){truncateName=truncateName.substr(0,maxLen-1)+"...";}if(AG||AD){this.save();}else{var AF=mstrApp.features["ask-before-save-changes"],AH="#666";if(AF){var AJ="dialogBeforeSave",AC=function(){mstrmojo.all.dialogBeforeSave.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:AJ,title:O(5728),cssText:"min-width:475px;max-width:600px;",btnAlignment:"right",buttons:[K(O(1442),function(){var AK=mstrmojo.all[AJ];if(AK.t.ctrlChk.checked){AI.setDontAskAgain();mstrApp.features["ask-before-save-changes"]=false;}AI.directSave();AC();},AH),K(O(218),function(){var AK=mstrmojo.all[AJ];if(AK.t.ctrlChk.checked){o(AI);}AI.save();AC();},AH),K(O(2140),AC,AH)],children:[{scriptClass:"mstrmojo.Table",alias:"t",rows:2,cols:1,children:[{scriptClass:"mstrmojo.Label",text:O(11165).replace(/##/,"<b>"+truncateName+"</b>"),visible:true,cssText:"height:60px;",slot:"0,0"},{scriptClass:"mstrmojo.CheckBox",label:O(211),alias:"ctrlChk",visible:true,checked:false,slot:"1,0"}]}]}).render();}else{AI.directSave();}}},setDontAskAgain:function F(){var AD=this,AC=AD.model;AC.showDialogBeforeSave=false;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){},failure:function(AE){mstrmojo.alert(AE.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"askBeforeSaveChanges\u001E0"});},directSave:function P(){var AE=this,AC=AE.model;var AD=mstrmojo.string.decodeHtmlString(AC.n);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){mstrmojo.alert(O(3336).replace("##",AC.n));},failure:function(){mstrmojo.alert(O(4107));}},{taskId:"saveRW",msgID:AC.mid,folderID:AC.sfid||AC.pfid,objName:AD,objDesc:AC.desc,saveAsFlags:1,taskEnv:"xhr",taskContentType:"json"});},browseParent:function n(){var AC=this.model,AD={evt:3010};if(!AC.pfh){AD.evt=2001;AD.folderID=AC.pfid;if(AC.sysFolder){AD.systemFolder=AC.sysFolder;}}W(this,AD);},close:function g(){J(this);},openPage:function V(AC){z(this,AC);},saveToInbox:function h(){var AC=this;mstrApp.serverRequest({taskId:"addDocToHistoryList",rwb:AC.model.bs},{success:function(){var AD=AC.model.features;if(AD){if(AD.set){AD.set("enable-add-history-list",false);}else{AD["enable-add-history-list"]=false;}}mstrmojo.alert(O(8047));}});},ShowSharingEditor:function T(){var AG="sharingEditor",AH=mstrmojo.all[AG],AI=this,AE=AI.model,AK=11,AJ=AE.isBlankDocument,AC=function(AL){if(AH){AH.set("oi",AL);AH.objectName=AE.n;AH.href=null;AH.mid=AE.n;}else{AH=new mstrmojo.SharingEditor({guestModeEnabled:mstrApp.guestModeEnabled,mid:AE.mid,id:AG,oi:AL,href:null,isLinkDirty:true,viewMode:1,lastState:0});}AH.open();},AF={success:function(AL){AC(AL.objects[0]);},failure:function(AL){mstrmojo.alert(AL.getResponseHeader("X-MSTR-TaskFailureMsg"));}};if(AJ){var AD="#666";mstrmojo.confirm(mstrmojo.desc(9932),[K(O(1442),function(){AI.save({saveAsOrigin:AK});},AD),K(O(2140),null,AD)],mstrmojo.desc(8101));}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,AF,{taskId:"getObjectInfo",objectIDs:AE.oid,objectTypes:55,includeACL:!!mstrApp.features["web-use-sharing-editor"],sessionState:mstrApp.sessionState});}},createPersonalView:function I(){var AK=this,AE=AK.model,AH=AE&&AE.isnew;if(AH){var AD="#666";mstrmojo.confirm(mstrmojo.desc(2510),[K(O(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");AK.save({saveAsOrigin:10});},AD),K(O(2140),null,AD)],mstrmojo.desc(9173));}else{var AC=AE.n,AG="mstrPVD",AF={scriptClass:"mstrmojo.PersonalViewSaveAs",id:AG,objectType:55,objectSubType:14081},AJ=mstrmojo.all[AG]||mstrmojo.insert(AF);if(AC){var AI=b.getDateJson(new Date());AC+=" "+b.formatDateInfo(AI,AA().DATEOUTPUTFORMAT)+" "+b.formatTimeInfo(AI,AA().TIMEOUTPUTFORMAT);AJ.set("name",AC);}AJ.msgID=this.model.mid;AJ.open();}},reprompt:function S(){AB(this,true,false,false);},refresh:function R(){AB(this,false,false,false);},rerun:function m(){AB(this,false,true,false);},toggleAutoRefresh:function(AF){var AE=AF.src,AC=this.model.controller,AD=AC.isAutoRefreshEnabled();AC[(AD?"stop":"start")+"AutoRefresh"]();AE.set("iconClass",(AD?"tbStart":"tbStop")+"AutoRefresh");AE.domNode.setAttribute("title",AD?"*Resume Auto Refresh*":"*Pause Auto Refresh*");},docVisualizationModeAJAX:function i(){f(this,51);},docVisualizationModeFlash:function q(){f(this,50);},sendNow:function s(){M(this,mstrmojo.desc(2331,"Send Now"),mstrmojo.desc(2513,"You must save the report/document before you can send it."),W,{evt:3037,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:2});},scheduleHL:function Y(){M(this,O(5017,"Subscribe to History List"),O(2510,"You must save the report/document before you can subscribe to it."),W,{evt:3128,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3});},zoomValue:null,zoom:function w(AM){var AI=mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep);var AL=(AM!==null)?String(AM).split(":"):[],AJ=parseInt(AL[0],10),AO=AL[1],AE=AI.parse(AO);if(isNaN(AJ)||(!AJ&&isNaN(AE))){return ;}var AN=this.model;if(AJ===1||AJ===2){var AH=this.selected,AG=(AH&&AH.docLayout)||null,AP=AG&&(AG.containerNode||AG.domNode),AF=AP&&AP.ownerDocument.documentElement,AK=(AN&&AN.zf)||1;var AC=function(AT){var AR=AP&&AP["offset"+AT];if(!AR){return 1;}var AS=Math.max(1,AF["client"+AT]);return Math.min(4,Math.max(0.1,Number(AK*AS/AR).toFixed(2)));};AE=AC("Width");if(AJ===2){AE=Math.min(AE,AC("Height"));}AO=AI.format(AE);}var AD=AJ+":"+AO;if(AD!==(this.zoomValue&&this.zoomValue.dssid)){var AQ=this;AN.getDataService().setDocZoom({zoomType:AJ,zoomFactor:AO},{success:function(AR){AN.zf=AR.zf;AN.ztp=AR.ztp;AN.replaceLayout(AR.currlaykey,AR);AN.raiseEvent({name:"rebuildLayout"});Q(AQ,false);AQ=null;},failureName:"zoom.set"});}},exportCmd:function C(AJ,AL){var AF=this.model,AP=(parseInt(AJ,10)===t)?3130:3132,AN=AF.exopt,AO=AF.huc&&AJ===G,AK=AN.s&&(AJ===l||AJ===Z)&&!AL,AE=false,AI=false;if(AK){if(!!(AF.defn&&AF.defn.layouts&&AF.defn.layouts.length>1)){AI=true;}else{var AH=this.selected,AQ=AH&&AH.gb&&AH.children[1];AE=(!AQ||AQ.areUnitsSetToAll());if(AE){AK=false;}}}var AG=function(){var AU={evt:AP,src:mstrApp.name+"."+AP};if(AP===3132){AU.executionMode=AJ;if(AL!=null){AU.gridKey=AL;}}if(!AK){AU.rwb=AF.bs;}else{var AT=mstrmojo.Serializer;var AR=[[2048062,AF.bp+".2048062","mode",AN.m,"range",AN.r],[]];mstrmojo.hash.forEach(AU,function(AW,AV){if(AV==="executionMode"){AR[1]=AR[1].concat([AV,AW]);}else{AR[1].push(AW);}});AU.evt=1024001;AU.src=AF.bp+".1024001";AU.events=AT.serializeValueGroup(AR);AU["1024001"]=1;AU.messageId=AF.mid;}AU.name=Date.parse(new Date());var AS=function(){mstrmojo.form.send(AU,null,null,(AN.n)?"_blank":"mstrExportWindow");};if(!mstrmojo.dom.isIE||AJ!==G){AS();}else{mstrmojo.alert(AN.ds[5873],AS);}};var AD=AN.ds,AC="#666",AM;if(AK||AO){AM=function(){var AS="mojoExOpx9",AR=function(){mstrmojo.all.mojoExOpx9.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:AS,title:AD[971],cssText:"min-width:225px;max-width:325px;",btnAlignment:"right",buttons:[K(AD[1442],function(){mstrmojo.requiresCls("mstrmojo.Serializer");var AT=mstrmojo.all[AS];if(AI){AN.r=AT.ctrlLyt.selected;}if(!AE){AN.m=(AT.ctrlChk.checked)?0:1;}AR();AG();},AC),K(AD[2140],AR,AC)],children:[{scriptClass:"mstrmojo.Label",text:AD[7482],visible:AO},{scriptClass:"mstrmojo.DropDownList",title:AD[246],cssClass:"field",cssDisplay:"block",alias:"ctrlLyt",visible:!!AI,idx:AN.r,options:[{n:AD[5137],v:0},{n:AD[5138],v:1}]},{scriptClass:"mstrmojo.CheckBox",label:AD[5165],cssClass:"field",cssDisplay:"block",alias:"ctrlChk",visible:!!!AE&&AK,checked:(AN.m===0)}]}).render();};}if(AJ===l&&AD["3809"]!==undefined&&!AL){mstrmojo.confirm(AD["3809"],[K(AD[1442],AM||AG,AC),K(AD[2140],null,AC)]);}else{if(AM){AM();}else{AG();}}},printPDF:function X(){this.exportCmd(Z);},openHome:function D(AC){W(AC,{evt:3010,src:mstrApp.name});},updateZoom:function A(){Q(this,false);},__onmixin__:function E(){Q(this,true);},resetSelections:function a(){var AD=this,AC=AD.model;AC.getDataService().resetSelections(null,false,{success:function(AH){if(AH.disablePU){AC.loadLayout(AH);return ;}if(AH.pukeys){var AJ=AC.partialUpdate(AH.data,AC.getUnitDefinitions(AH.pukeys)),AF=AC.getLayoutDataCache(AC.getCurrentLayoutKey());mstrmojo.hash.forEach(AJ.upd,function(AO,AQ){var AN=mstrmojo.all[AQ];if(AN&&AN.defn&&AN.defn.t==mstrmojo.EnumRWUnitType.PANELSTACK){var AM=AF&&AF[AQ]&&AF[AQ].data,AP=AM&&AM.selKey;if(AP&&AN.selectedKey!=AP){AN.defn.set("selKey",AP);}AN.setDirtyChildren();}});}var AK=AD.getLayouts(),AE=(AK&&AK.length)||0,AL=AC.getCurrentLayoutKey();for(var AG=0;AG<AE;AG++){var AI=AK[AG];if(AI.defn&&AI.defn.loaded&&AL!=AI.k){AI.defn.loaded=false;}}}});}};}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.base64","mstrmojo.Dialog");mstrmojo.requiresDescs(1442,2140,5369,8233,8232,8313,8322);var V=8,P=16,W=4,T=1,R=8,B=16,O=268435456,I=536870912,A=1073741824,F=window.mstrConfig&&!window.mstrConfig.simpleDialog,L=2147755235,J=2147755236;var S=mstrmojo.Button.newInteractiveButton;function C(f,b,a,Y,Z){if(F){var e=[S(Y||mstrmojo.desc(1442),b||null,null),S(Z||mstrmojo.desc(2140),a||null,null)];mstrmojo.confirm(f,mstrApp.useBinaryFormat?e.reverse():e);}else{if(mstrmojo.confirm(f)){if(b){b();}}else{if(a){a();}}}}function X(Z,Y){if(F){mstrmojo.alert(Z,Y);}else{mstrmojo.alert(Z);if(Y){Y();}}}mstrmojo.DocActionSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.DocActionSelector",extCls:"mstrmojo-ActionSelector",type:V,targets:null,initControlInfo:function E(){var Y=this.node.defn;this.aa=parseInt(Y.aa,10);this.dpTxt=Y.dpTxt||{8:mstrmojo.desc(5369),4:mstrmojo.desc(8233),16:mstrmojo.desc(8232)}[this.aa]||"";this.dpCfm=Y.dpCfm;this.sac=parseInt(Y.sac,10);this.msg=Y.msg;this.rsid=Y.rsid;this.rst=Y.rst;this.node.data.elms=[{n:this.dpTxt,v:this.dpTxt}];this._super();},selectorControlChange:function K(Y){if(Y.selectedIndex!==0){return ;}this.executeAction();Y.select([]);},executeAction:function N(){var Z=this.aa,Y=this;if(Z===V){if(this.dpCfm){C(mstrmojo.desc(8313),function(){Y.onControllerCheck();});}else{Y.onControllerCheck();}}else{if(Z===W){if(this.dpCfm){C(mstrmojo.desc(8322),function(){Y.onDiscard();});}else{Y.onDiscard();}}else{this.onRecalculate();}}},onControllerCheck:function H(){this.onCommit();},onCommit:function M(){var b=this,e=this.model,Z=b.controller,Y=mstrApp.useBinaryFormat;if(!Y&&!this.validateRequiredObjects()){X(mstrmojo.desc(9200));return ;}var a=function(f){if((b.sac&I)>0){Z.invalidClientCache();}if((b.sac&B)>0){var g={did:b.rsid,objType:b.rst,forceExec:(b.sac&O)>0};if((b.sac&A)>0){g.linkAnswers='<hl mid="'+e.mid+'" srct="2" aopam="1"><prms></prms></hl>';}Z.onExecuteNewObject(b,g);}else{if((b.sac&R)>0){Z.onReExecute(b);}else{if(mstrApp.isMobile){Z.generateActionToolbar();}e.transactionUpdate(f);}}};mstrmojo.mask.show("Running");e.sendTransactionActions(this.ck,V,e.newCallback({success:function(f){mstrmojo.mask.hide();if(e.txrcd||f.offln){Z.offlineTransactionsSubmitted(b.ck);}if(f.offln){if(Y&&!b.networkToastShowed){b.networkToastShowed=true;mstrmojo.toast(mstrmojo.desc(9258,"No Network Connectivity")+". "+mstrmojo.desc(9259,"Transaction will be submitted when connectivity is resumed."));}e.transactionUpdate(f);}else{if((b.sac&T)>0&&b.msg){if(Y){mstrmojo.toast(b.msg);window.setTimeout(function(){a(f);},100);}else{X(b.msg,function(){a(f);});}}else{a(f);}}},failure:function(h){var f=mstrmojo.all.mojoAlertx9;if(f){f.destroy();}mstrmojo.mask.hide();if(e.txrcd){Z.offlineTransactionsSubmitted(b.ck);}var g=4294967296+parseInt(h.code,10);if(g===L){if(Y){b.validateRequiredObjects();}X(mstrmojo.desc(9200,"You have some required inputs that are not modified."));}else{if(g===J){var i=mstrmojo.desc(9201,"You haven't made any changes to submit.");if(Y){mstrmojo.toast(i);}else{X(i);}}else{X(mstrmojo.base64.decodeHttpHeader(h.message),function(){if(!Y){b.controller.onReExecute(b,true);}});}}}}));},onDiscard:function D(){var Z=this,a=this.model,Y=Z.controller;a.txDiscardTargets=this.getTxTargets();a.sendTransactionActions(this.ck,W,{success:function(b){a.transactionUpdate(b);Y.transactionDiscarded(Z.ck);},complete:function(){delete a.txDiscardTargets;if(mstrApp.isMobile){Y.generateActionToolbar();}}});},onRecalculate:function G(){this.model.sendTransactionActions(this.ck,P);},getTxTargets:function U(){var g=this.tks.split("\u001E"),f,Y,e,h,Z,a,b={};for(f=0,Y=g.length;f<Y;f++){e=g[f];h=1;do{Z=this.model.getUnitInstance(e,h++);if(Z&&Z.checkRequiredObjects){if(Z.isPanelStack){for(a in Z.txWidgets){b[Z.txWidgets[a].id]=1;}}else{b[Z.id]=1;}}else{break;}}while(true);}return b;},validateRequiredObjects:function Q(){var Y=true,Z;for(Z in this.getTxTargets()){Y=mstrmojo.all[Z].checkRequiredObjects()&&Y;}return Y;}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.DocLayout","mstrmojo.DocLayoutHoriz","mstrmojo.DocSection","mstrmojo.DocSubsection","mstrmojo.DocTextfield","mstrmojo.DocXtabModel","mstrmojo.DocVisModel","mstrmojo.XtabBase","mstrmojo.DocPortlet","mstrmojo.DocResizablePortlet","mstrmojo.DocXtabGraph","mstrmojo.DocGridGraph","mstrmojo.DocLine","mstrmojo.DocImage","mstrmojo.DocHTMLContainer","mstrmojo.DocRectangle","mstrmojo.DocRoundRectangle","mstrmojo.DocPanel","mstrmojo.DocSelector","mstrmojo.DocActionSelector","mstrmojo._HasDocLink","mstrmojo.DocVisualization","mstrmojo.DynamicClassFactory","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo._IsSelectorTarget","mstrmojo.DocInfoWindow","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo._IsEditableTextfield","mstrmojo.DocSelectorViewFactory","mstrmojo._HasHoverButton","mstrmojo.hash");var N=mstrmojo.hash;var A=mstrmojo.EnumRWUnitType,C={};C[A.LAYOUT]={n:"Layout"};C[A.HEADER]=C[A.FOOTER]=C[A.PAGEHEADER]=C[A.PAGEFOOTER]=C[A.DETAILS]={n:"Section",scriptClass:"mstrmojo.DocSection"};C[A.SUBSECTION]={n:"SubSection",scriptClass:"mstrmojo.DocSubsection"};C[A.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.DocTextfield"};C[A.GRID]={n:"Xtab",scriptClass:"mstrmojo.DocXtab"};C[A.GRAPH]={n:"XtabGraph",scriptClass:"mstrmojo.DocXtabGraph"};C[A.GRIDGRAPH]={n:"GridGraph",scriptClass:"mstrmojo.DocGridGraph"};C[A.SELECTOR]={n:"Selector",scriptClass:"mstrmojo.DocSelector"};C[A.LINE]={n:"Line",scriptClass:"mstrmojo.DocLine"};C[A.IMAGE]={n:"Image",scriptClass:"mstrmojo.DocImage"};C[A.HTMLCONTAINER]={n:"HTMLContainer",scriptClass:"mstrmojo.HTMLContainer"};C[A.RECTANGLE]={n:"Rectangle",scriptClass:"mstrmojo.DocRectangle"};C[A.ROUNDEDRECTANGLE]={n:"RoundedRectangle",scriptClass:"mstrmojo.DocRoundRectangle"};C[A.PANEL]={n:"Panel",scriptClass:"mstrmojo.DocPanel"};C[A.VISUALIZATION]={n:"Visualization",scriptClass:"mstrmojo.DocVisualization"};C[A.MOJOVISUALIZATION]={n:"MojoVisualization"};var R={};var S=mstrmojo.DynamicClassFactory.newComponent;var K=mstrmojo.elementHelper;function Q(a){return function(){return this.parent.parent["on"+a]();};}var B=Q("maximize"),V=Q("restore"),F=Q("minimize"),U=Q("collapse"),G=Q("expand");mstrmojo.DocXtab=S(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab"});var H=function(e,b){var a=e&&e.parent;while(a){if(a[b]){return a;}a=a.parent;}return null;};function Z(b,g,e,a,f){return mstrmojo.Button.newIconButton(b,g,e,null,{ds:a,visible:(f!==a)});}function O(a,f,e){var b=C[f].n+(e?"Hover":""),g=R[b];if(!g){g=R[b]=S(a,[mstrmojo._HasDocLink].concat(this.getLinkDrillMixins(e)));}return g;}mstrmojo.DocBuilder=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocBuilder",visList:null,destroy:function W(){var a=this.selectorFactory;if(a){a.destroy();}this._super();},classMap:C,build:function M(q,f){var e=[],p=this.classMap,z=((q&&q.length)||0),x;for(x=0;x<z;x++){var s=q[x],g=s&&s.defn,b=s&&s.data,m=(g&&g.t)||mstrmojo.EnumRWUnitType.LAYOUT,AA=p[m];var l=(m===A.TEXTFIELD&&((g&&g.dpst)));if(l){AA=p[m+"B"];}var j=(AA&&AA.n)?"new"+AA.n:"",k;if(this[j]){k=this[j](f,s);}else{if(AA&&AA.scriptClass){var h=AA.cls;if(!h){h=N.walk(AA.scriptClass,window);}if(m===A.TEXTFIELD||m===A.IMAGE){var a=b.dl,n=g.dl,o=(a&&a.items&&a.items.length)||(n&&n.items&&n.items.length>0);if(o||b.url||g.url||g.ifw){h=O.call(this,h,m+(l?"B":""),o);}else{if((m===A.TEXTFIELD)&&g.txi){h=S(h,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableTextfield]);}}}if(h){k=new h({id:s.id,node:s,controller:this.parent.controller,model:f});}}}if(k){k.k=s.k;k.formatResolver=f.formatResolver;k.builder=this;k.tooltip=b.tooltip||g.tooltip||"";if(!k.defn){k.defn=g;}k.disposables.push(k.defn);if(k.update){k.update(s);}if((g.ttl!==undefined&&m!==A.PANEL)||g.qsm){k=this.createPortlet(m,s,k);}e.push(k);}}return e;},createPortlet:function E(AA,AH,x){var g=AH.defn,AE=g.ds,o=(g.iifp||!(AA===A.PANELSTACK||(g.ttl===undefined&&g.qsm)||AA===A.SELECTOR)),AF=(AA===A.GRAPH||AA===A.GRIDGRAPH),l=[],AP=mstrmojo.Button.newIconButton,AG="",AI="",e="",AD=(AA===A.GRID||AF||AA===A.VISUALIZATION)&&parseInt(g.eo,10)!==2,AK=[],AB="mstrmojo-oivmSprite ",f=false;if(g.qsm){AG="qks";var z=function(AR,t,w){return AP(AR,AB+t,function(){return this.parent.parent.content.quickSwitch();},{visible:"this.parent.parent.defn.qsm !== this.qsm"},{qsm:w});};l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",cssClass:(!o)?"grouped":"",children:[z(mstrmojo.desc(3547,"View: Grid"),"tbGrid",1),z(mstrmojo.desc(3548,"View: Graph"),"tbGraph",2)]});}if(AD){var q=this.getPortletExportGridToolbar(x.k);if(q){AI=q.css;AK=q.node;l.push(AK);}}if(o){if(g.iifp){AG="wrap";l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:[Z(mstrmojo.desc(8973,"Collapse"),"co",U,1,AE),Z(mstrmojo.desc(8972,"Expand"),"ex",G,0,AE)]});}else{var AM=[Z(mstrmojo.desc(4539,"Minimize"),"mn",F,1,AE),Z(mstrmojo.desc(4540,"Restore"),"rs",V,0,AE),Z(mstrmojo.desc(4541,"Maximize"),"mx",B,2,AE)];if(AD){AK.children=(AK.children||[]).concat(AM);}else{AI="resize";l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AM});}}}x.slot="contentNode";x.alias="content";x.title=g.ttl||"";if(g.sec){if(g.style!==mstrmojo.DocSelectorViewFactory.STYLES.SCROLLER&&!g.sos){var a=AH.data,AO=a.elms,AJ=a.ces;if(AJ&&AO&&AO.length){x.count=K.buildElemsCountStr(AJ,AO);}}}l.push(x);if(AA===A.PANELSTACK){var i=function(AS,w,AR,t){return AP(AS,AB+w,function(){return this.parent.parent.content.switchToPanel(t);},{enabled:"this.parent.parent."+AR});},AC=[],m=[],AL=!!AH.sw,s=!!g.ifw,j=!!g.ifp;if(AL){m.push(i(mstrmojo.desc(1058,"Previous"),"tbPrev","prevEnabled",-1));AC.push(i(mstrmojo.desc(2917,"Next"),"tbNext","nextEnabled",1));}if(s){AC.push(AP(mstrmojo.desc(2102,"Close"),AB+"mstrmojo-DocInfoWindow-close",function(){this.parent.parent.parent.close();}));}if(j){e="ifp";l.push({scriptClass:"mstrmojo.HBox",slot:"buttonbarNode",alias:"buttonbar",cssClass:"buttonBox",children:[{scriptClass:"mstrmojo.Button",alias:"applyNow",title:mstrmojo.desc(2164,"Apply"),text:mstrmojo.desc(2164,"Apply"),cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !g.cas;},enabled:function(){return this.parent.parent.applyEnabled;}},onclick:function AQ(){if(x&&x.applyBufferedSlices){x.applyBufferedSlices();}}}]});AC.push({scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AQ(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.FilterPanelMenu",{openerButton:this,fps:x,cmPos:this.cmPos});}}});f=true;}if(s||j){var b=[];if(AL){b[0]="pst-l";}if(j){b.push("ifp");}m.push({scriptClass:"mstrmojo.Box",cssClass:b.join(" ")});}if(s||AL||j){var n=s?"ifw ":"",k=j?"ifp ":"",AN=!g.cas?"cas ":"";AI=(AL?"pst-r ":"")+n+k+AN;AG=(AL?"pst-l ":"")+n+k+AN;l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:m});l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AC});}}if(AA===A.SELECTOR&&x.spm){AI="spm";l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AQ(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.SelectorMenu",{openerButton:this,selector:x,cmPos:this.cmPos});}}}]});f=true;}var p="Doc"+(o?"Resizable":"")+"Portlet",h={defn:x.defn,model:x.model,children:l,title:x.title,count:x.count,floatingTitle:(g.ttl===undefined&&g.qsm),leftToolbarNodeClass:AG,loadDataOnResize:AF,toolbarNodeClass:AI,buttonbarNodeClass:e,attachContextMenuEvent:f};if(AA===A.PANELSTACK){h.bindings={title:"this.children[0].title"};if(AH.sw){h.bindings.prevEnabled=function(){return this.children[0].hasPreviousPanel;};h.bindings.nextEnabled=function(){return this.children[0].hasNextPanel;};}if(g.ifp){h.bindings.applyEnabled=function(){return this.children[0].applyEnabled;};}}return new mstrmojo[p](h);},getPortletExportGridToolbar:mstrmojo.emptyFn,getLayoutViewerClass:function D(a){return mstrmojo.DocLayoutViewer;},newLayout:function Y(j,g){var i=[],e=g.data,h=g.defn,b=this.getLayoutViewerClass(g),a=new b({n:h.title,model:j,node:g,controller:this.parent.controller,tbc:h.tbc,slot:"containerNode",visible:false,ifs:e.ifs,gb:e.gbys});var k=a.defn=N.copy(h);k.fmts=N.copy(h.fmts);var f=function(p,q){var m=p.length;if(m){var n,o;for(n=0;n<m;n++){o=this.build([p[n]],j)[0];o.slot=q;i.push(o);}}};f.call(this,j.getFixedHeaders(g),"fixedHeaderNode");var l=mstrmojo["DocLayout"+((h.horiz)?"Horiz":"")];i.push(new l({slot:"layout",id:g.id,k:g.k,minHeight:e.mh,formatResolver:j.formatResolver,rules:h.rules,builder:this,node:g,defn:h,model:j}));f.call(this,j.getFixedFooters(g),"fixedFooterNode");a.addChildren(i);return a;},newSection:function(b,e){var a=(e.defn.horiz&&e.data.subsections.length>1)?"DocSectionHoriz":"DocSection";return new mstrmojo[a]({id:e.id,node:e,model:b});},newHTMLContainer:function(b,e){var a=(e.defn.ht===0)?"DocHTMLContainer":"DocTextfield";return new mstrmojo[a]({id:e.id,node:e,model:b});},adjustMojoVisualizationClass:function L(a){return a;},newMojoVisualization:function(i,f){var g=this.visList,b=f.data,n=g.getVis(b.visName);if(!n){var l=b.className;if(!l){return this.newXtab(i,f);}n={dc:l};}var j=(n.dc!==undefined)?n.dc:n.c;j=this.adjustMojoVisualizationClass(j);mstrmojo.requiresCls("mstrmojo."+j);var m=N.walk(j,mstrmojo),k=N.walk(n.m||"DocVisModel",mstrmojo);if(!m||!k){throw new Error("Missing visualization class.");}m=g.getVisClass(m,f.defn);var a=new m(N.copy(b.extProps,{id:f.id,node:f,n:f.defn.title,controller:this.parent.controller,gb:b.gbys}));a.setModel(new k({xtab:a,controller:this.parent.controller,docModel:i}));a.model.set("data",b);if(!!f.data.sdp){var e;for(e in f.data.sdp){f.data.sdp[e].defn={};var h=this.newXtab(i,f.data.sdp[e]);h.setModel(new k({xtab:h,controller:this.parent.controller,docModel:i,data:f.data.sdp[e]}));h.k=e;}}return a;},newInfoWindow:function X(a){return new mstrmojo.DocInfoWindow(a);},newRoundedRectangle:function P(e,f){var b=mstrmojo.dom,a=(b.supports(b.cssFeatures.ROUND_CORNERS))?"DocRectangle":"DocRoundRectangle";return new mstrmojo[a]({id:f.id,node:f,model:e});},newSelector:function J(b,e){var a=(e.defn.ct==="4"?"DocActionSelector":"DocSelector");return new mstrmojo[a]({id:e.id,node:e,controller:this.parent.controller,model:b});},newXtab:function I(b,e){var a=e.defn.txi,g,f=mstrmojo.DocXtab;if(a){f=S(mstrmojo.DocXtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.DocXtab"});}g=new f({id:e.id,node:e,controller:this.parent.controller});g.model=new mstrmojo.DocXtabModel({xtab:g,docModel:b});return g;},getLinkDrillMixins:function T(a){return a?[mstrmojo._HasHoverButton]:[];}});}());(function(){mstrmojo.requiresCls("mstrmojo.StackContainer","mstrmojo._IsRwDocument","mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo._DocOIVMMethods","mstrmojo.array","mstrmojo.css");mstrmojo.Doc=mstrmojo.declare(mstrmojo.StackContainer,[mstrmojo._HasBuilder,mstrmojo._IsRwDocument,mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.Doc",cssClass:"mstrmojo-Doc",methods:{"*":"mstrmojo._DocOIVMMethods"},markupSlots:{containerNode:function(){return this.domNode;},popupNode:function(){return this.domNode;},drillLinkMenuNode:function(){return this.domNode;}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},getLayouts:function(){return this.children;},buildChildren:function A(M){if(this._super(false)){var L=this.model.getSelectedKey(this.node),N=(L!==null)?mstrmojo.array.find(this.children,"k",L):-1,O=(N>-1)?this.children[N]:null;if(O){this.set("selected",O);}return true;}return false;},restoreLayoutState:function K(M){this._super(M);var L=M.zf;if((this.zf!==L||this.model.zf!==L)&&this.updateZoom){this.zf=this.model.zf=L;this.updateZoom();}},_set_selected:function F(P,N){if(!this.selected){return this._super(P,N);}if(N){var M=this,L=this._super,O=N.k;this.getNewLayout({layoutKey:O},this.children,(O!==this.model.currlaykey),{success:function(R){var Q=M.selected;L.call(M,P,R);M.raiseEvent({name:"selectedChange",prop:"selected",value:R,valueWas:Q});}});}return true;},onLayoutRebuilt:function J(L){this._set_selected("selected",L,true);},replaceLayout:function G(N,M){var L=this.removeChildren(N);N.destroy();var O=this.builder.build([M],this.model);this.addChildren(O,L);return O[0];},getSelectedLayoutWidget:function C(){return this.selected;},xtabCellMenuRef:"mstrmojo.XtabCellMenu",openXtabCellMenu:function(L){if(L){L.opener=this;if(this._lockInfoWinContainer){this._lockInfoWinContainer(L);}}this.openPopup("xtabCellMenuRef",L);},closeXtabCellMenu:function E(){this.closePopup();},drillLinkMenuRef:"mstrmojo.DrillLinkMenu",openDrillLinkMenu:function D(L){if(L){L.opener=this;}this.openPopup("drillLinkMenuRef",L);},closeDrillLinkMenu:function H(){this.closePopup();},goToLink:function I(L){if(L){window.open(L.url,(L.target||"_self"));}},selectorMenuRef:"mstrmojo.SelectorMenu",fpMenuRef:"mstrmojo.FilterPanelMenu",openPopupMenu:function B(M,L){if(L){L.opener=this;}this.openPopup(M,L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayoutViewer","mstrmojo.DocGroupBy","mstrmojo.Xtab","mstrmojo.IncFetch","mstrmojo.DocPanelStack","mstrmojo.express.ui.DocButton","mstrmojo.ExpressDocPanel","mstrmojo._IsEditableXtab","mstrmojo._CanSupportTransaction","mstrmojo.ExpressVisList","mstrmojo.OIVMDICConfig","mstrmojo.OIVMDocSelectorViewFactory","mstrmojo.OIVMDocXtabGraph","mstrmojo.MenuButton","mstrmojo.ToolBar");mstrmojo.requiresDescs(5212,5213);var D=mstrmojo.EnumRWUnitType,I=mstrmojo.DynamicClassFactory.newComponent,H=mstrmojo.desc;mstrmojo.DocXtab=I(mstrmojo.Xtab,[mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab"});var C=3,G=4;var A=function(M,L){var K=M;while(K){if(K.requiresMethod){K.requiresMethod(L);}if(K[L]){return K;}K=K.parent;}return null;};mstrmojo.ExpressDocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,null,{scriptClass:"mstrmojo.ExpressDocBuilder",visList:mstrmojo.ExpressVisList,init:function J(L){this._super(L);var K=this.classMap;this.selectorFactory=new mstrmojo.OIVMDocSelectorViewFactory();K[D.GRAPH]={n:"OIVMDocXtabGraph",scriptClass:"mstrmojo.OIVMDocXtabGraph"};K[D.PANELSTACK]={n:"PanelStack",scriptClass:"mstrmojo.DocPanelStack"};K[D.PANEL]={n:"Panel",scriptClass:"mstrmojo.ExpressDocPanel"};K[D.TEXTFIELD+"B"]={n:"Button",scriptClass:"mstrmojo.express.ui.DocButton"};},newLayout:function F(K,M){var L=this._super(K,M);var N=M.data.gbys;if(N){L.addChildren(new mstrmojo.DocGroupBy({id:N.k,slot:"groupBy",title:N.title,model:K,node:M,data:N.groupbys,controller:this.parent.controller}));}if(M.data.ifs){var O=new mstrmojo.IncFetch(mstrmojo.hash.copy(M.data.ifs,{slot:"incFetchNode",model:K}));O.attachEventListener("fetch",L.id,function(P){var Q=function(R){if(P.iWait){P.iWait.set("visible",R);}};K.getDataService().fetchDocPage((P.v-1)*O.ps+1,{submission:function(){Q(true);},success:function(R){K.loadLayout(R);},complete:function(){Q(false);}});});L.addChildren(O);}return L;},newXtab:function E(M,N){var K=N.defn.txi,L=mstrmojo.DocXtab;if(K){mstrmojo.EditableXtab=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.Xtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.EditableXtab"});L=mstrmojo.EditableXtab;}var O=mstrmojo.all[N.id];if(!O){O=new L({id:N.id,node:N,controller:this.parent.controller});O.model=new mstrmojo.DocXtabModel({xtab:O,docModel:M});}else{O.set("node",N);O.model.set("docModel",M);}return O;},getPortletExportGridToolbar:function B(K){return{css:"grid-menu",node:{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.MenuButton",iconClass:"mstrmojo-oivmSprite tbDown",itemIdField:"did",itemField:"n",itemChildrenField:"subItms",executeCommand:function(M){var L=A(this,"exportCmd");if(L){L.exportCmd(M.did,K);}},cm:[{n:H(5212,"Export to PDF"),did:C},{n:H(5213,"Export to Excel"),did:G}]}]}};}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.Doc","mstrmojo.ExpressDocBuilder","mstrmojo.ToolBar","mstrmojo.OIVMPage","mstrmojo.ToolBarBuilder","mstrmojo.TabContainer","mstrmojo.ScrollingTabStrip","mstrmojo.ToolBarModel","mstrmojo.OIVMDocController","mstrmojo.DocModel");function G(L,J){var K=((J)?"add":"remove")+"LoadingGraph";this.serverProxy[K](L);}mstrmojo.OIVMApp=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.OIVMApp",serverProxy:null,init:function I(J){this._super(J);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}},start:function B(){var N=new mstrmojo.Doc({slot:"stack"});N.builder=new mstrmojo.ExpressDocBuilder({parent:N});this.docId=N.id;var L=new mstrmojo.ToolBar({slot:"toolbar",cssClass:"mstrmojo-oivmSprite grouped",builder:mstrmojo.ToolBarBuilder});var K=new mstrmojo.OIVMPage({placeholder:this.placeholder,error:this.error,children:[L,new mstrmojo.TabContainer({slot:"layout",layoutConfig:{h:{top:"auto",stack:"100%"},w:{top:"100%",stack:"100%"}},children:[new mstrmojo.ScrollingTabStrip({slot:"top",cssClass:"mstrmojo-layout-tabs",visible:false,bindings:{width:"this.parent.width"}}),N]})]});if(this.hasHiddenSections){K.layoutConfig.h.toolbar="0px";}K.render();var O=this.docModelData;if(O&&O.mstrerr){mstrmojo.err(O);}else{if(!this.error){L.model=new mstrmojo.ToolBarModel(this.tbModelData);L.target=N;var J=N.model=new mstrmojo.DocModel(O);N.controller=J.controller=new mstrmojo.OIVMDocController({model:J});mstrApp.docModel=J;mstrApp.onSessionExpired=function(){var Q=mstrApp,P=Q.docModel;mstrmojo.requiresCls("mstrmojo.form");mstrmojo.form.send({evt:5005,src:Q.name+"."+Q.pageName+".5005",rwb:P.bs});};mstrmojo.hash.copy(L.model.features,L.target.model.features);mstrmojo.locales.load(function(){L.buildChildren();N.buildChildren();});if(mstrApp.pendingMojoEditor&&mstrApp.pendingMojoEditor!=""){N["show"+mstrApp.pendingMojoEditor]();delete mstrApp.pendingMojoEditor;}var M=N.model.rf;if(M>0){N.model.controller.startAutoRefresh();}}}},onMobileDevice:function C(){return false;},isTouchApp:function E(){return false;},getContentDimensions:function F(J){return null;},getConfiguration:mstrmojo.emptyFn,addLoadingGraph:function D(J){G.call(this,J,true);},removeLoadingGraph:function H(J){G.call(this,J);},serverRequest:function A(O,Q,J){try{Q=Q||{};J=J||{};var M=J.src||(arguments.calle&&arguments.calle.caller.name),L=!J.silent&&J.fnWait,P=!J.silent&&J.fnHideWait,N=this;Q=mstrmojo.func.wrapMethods(Q,{submission:function(){if(L){L();}},failure:function(R){if(!J.silent){R.method=M;mstrmojo.err(R);}},complete:function(){if(P){P();}}});window.setTimeout(function(){N.serverProxy.request(Q,O,!!J.override,J);},0);}catch(K){mstrmojo.err(K);}}});window.$MAPF=function(){return false;};}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.hash","mstrmojo.ListBuilder");var E=mstrmojo.string,G=1,B="mstrmojo-multicolitem";function D(I){var K=['<table class="'+B+'-table" cellspacing="0" cellpadding="0"><colgroup>'],M=I.cols,J=1;for(var L=0,H=(M&&M.length)||0;L<H;L++){var N=M[L];K[J++]='<col style="width:'+N.width;if(N.visible===false){K[J++]="; display: none";}K[J++]='" />';}K[J++]='</colgroup><tbody><tr class="'+B+'-tr">';return K.join("");}function C(H,I){var J=H||(I&&'<div class="mstrmojo-text">{@'+I+"}</div>");return J?function(L,K,M){return E.apply(J,L);}:null;}mstrmojo.MultiColListBuilder=mstrmojo.provide("mstrmojo.MultiColListBuilder",mstrmojo.hash.copy({newContext:function F(I){var L=[],K=I.cols;for(var J=0,H=(K&&K.length)||0;J<H;J++){var M=K[J];L[J]=M.markupFunction||C(M.markup,M.field);}return{itemStatus:[],tablePrefix:D(I),tableSuffix:"</tr></tbody></table>",itemFuncs:L,cs:(L&&L.length)||0};},build:function A(O,M,R,P){M.itemStatus[P]=G;var Q='<td class="'+B+'-td">',N="</td>",I=M.itemFuncs,L=M.cs,J=[M.tablePrefix],H=1;for(var K=0;K<L;K++){J[H++]=Q;J[H++]=I[K](R,P,O);J[H++]=N;}J[H++]=M.tableSuffix;return J.join("");}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.MultiColListBuilder");mstrmojo.MultiColList=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.MultiColList",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.MultiColListBuilder,cols:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.MultiColListBuilder");mstrmojo.MultiColListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.MultiColListHoriz",listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.MultiColListBuilder,cols:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");var C=1;mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin({buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=F.firstChild.rows[0].cells,S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.parent=R;G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;}},mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapperHoriz","mstrmojo.WidgetListBuilder");mstrmojo.WidgetListHoriz=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetListHoriz",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapperHoriz,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo.Callback=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Callback",init:function B(C,D){this.context=C;this.func=D;},fire:function A(){var E=this.context,C=this.func,D;if(!E){D=mstrmojo.global;}else{if(typeof (E)=="object"){D=E;}else{D=mstrmojo.all[E];}}if(!D){return undefined;}if(typeof (C)=="function"){return C.apply(D,arguments||[]);}else{return D[C].apply(D,arguments||[]);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo.CallbackList=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.CallbackList",_calls:null,add:function C(D){if(!D){return ;}if(!this._calls){this._calls=[];}this._calls.push(D);},remove:function A(D){if(this._calls){mstrmojo.array.removeItem(this._calls,D);}},fire:function B(){var E=this._calls,F=arguments||[];for(var H=0,G=E&&E.length||0;H<G;H++){var D=this._calls[H];D.fire.apply(D,F);}}});})();mstrmojo.EnumRenderMode={ALL:0,BACKGROUND:1,ONDEMAND:2};(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.FieldSet=mstrmojo.declare(mstrmojo.Container,null,{legend:null,scriptClass:"mstrmojo.FieldSet",markupString:'<fieldset id="{@id}" class="mstrmojo-FieldSet {@cssClass}" style="{@cssText}"><legend class="{@cssClass}-legend">{@legend}</legend></fieldset>',markupSlots:{legendNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode;}},markupMethods:{onlegendChange:function(){this.legendNode.innerHTML=mstrmojo.string.encodeHtmlString((this.legend!=null)?this.legend:"");},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}}});})();mstrmojo.requiresCls("mstrmojo.Popup");(function(){function B(D){var C=D;while(C){if(C.openXtabCellMenu){return C;}C=C.parent;}return null;}mstrmojo.XtabCellHoverPopup={cssClass:"mstrXtabCellHoverPopup",scriptClass:"mstrmojo.Popup",slot:"overlayNode",autoCloses:true,children:[{scriptClass:"mstrmojo.Button",alias:"btn",onclick:function(){this.openPopup();},openPopup:function(){var C=B(this.xtab);if(C){C.openXtabCellMenu({xtab:this.xtab,td:this.td,btn:this,cmPos:this.cmPos});}},closePopup:function(){var C=B(this.xtab);if(C){C.closeXtabCellMenu();}}}],updatePopupConfig:function A(E){var F=E&&E.td,M=E&&E.xtab,C=this.btn;var G=this._lastTd;if(G!=F){C.closePopup();this._lastTd=F;}C.xtab=M;C.td=F;C.cmPos=E&&E.cmPos;if(!F||!M){return ;}var H=mstrmojo.dom.findAncestorByName(F.parentNode,"table",false,M.viewport),I=M.zones,L="";if(H){for(var D in I){var J=I[D];if(J&&J.tableNode==H){L=J.slot;break;}}}var K=mstrmojo.boxmodel.offset(F,M.overlayNode);this.set("location",{left:0,top:K.top,width:Math.min(F.offsetWidth+K.left,M._pl),height:F.offsetHeight});},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onlocationChange:function(){var C=this.location;if(!C){return ;}var D=this.domNode.style;D.left=(C.left+Math.max(C.width-16,0))+"px";D.top=C.top+"px";}}};})();