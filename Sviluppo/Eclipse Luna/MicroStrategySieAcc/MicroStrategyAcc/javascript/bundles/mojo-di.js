mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function rqMth(B){if(!B){return ;}if(typeof (this[B])==="function"){return true;}else{var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof (A)==="string"){this.requiresCls(A);return typeof (this[B])==="function";}return false;}},requiresCls:function req(mixins,callback){if(mixins){if(typeof (mixins)=="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin;for(var i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof (A)=="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresES(E,F,B){if(E&&E instanceof Array){if(E.length==0){F&&F.call(B);return ;}if(E[0].forceReload&&E[0].forceReload==false&&mstrmojo.LoadedExternalJSURLs[E[0].url]){E.splice(0,1);return this.requiresExternalScripts(E,F,B);}var A=document.createElement("script"),C=!!document.all;A.type="text/javascript";A.src=E[0].url;if(!E[0].callbackParamName){if(C){A.onreadystatechange=function(){if(A.readyState=="loaded"||A.readyState=="complete"){A.onreadystatechange=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}}};}else{A.onload=function(){A.onload=null;if(E.length>1){mstrmojo.LoadedExternalJSURLs[E.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(E,F);}else{if(E.length==1){mstrmojo.LoadedExternalJSURLs[E[0].url]=true;if(F){F.call(B);}}}};}}else{if(E[0].callbackParamName.length!=0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy==true){var D=this;window.setTimeout(function(){D.requiresExternalScripts(E,F,B);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+E[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=E;mstrmojo._LoadsScript.callback=F;mstrmojo._LoadsScript.esScritsContext=B;}}document.getElementsByTagName("head")[0].appendChild(A);}}});(function(){mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,tooltipNode:null,postBuildRendering:function(){var B;if(this._super){B=this._super();}if(this.useRichTooltip){var D=this.tooltipNode||this.domNode,C=mstrmojo.dom,A=D&&D.getAttribute("title");if(A){D.setAttribute("title","");}if(!this._ontooltipover){var E=this.id;this._ontooltipover=function(G){var F=mstrmojo.all[E];F.showTooltip(G,self);};this._ontooltipout=function(G){var F=mstrmojo.all[E];F.hideTooltip(G,self);};}C.attachEvent(D,"mouseover",this._ontooltipover);C.attachEvent(D,"mouseout",this._ontooltipout);}return B;},showTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.open(this,B,A);},hideTooltip:function(B,A){mstrmojo.requiresCls("mstrmojo.tooltip");mstrmojo.tooltip.close();},unrender:function(A){var C=this.tooltipNode||this.domNode,B=mstrmojo.dom;if(C&&this._ontooltipover){B.detachEvent(C,"mouseover",this._ontooltipover);}if(C&&this._ontooltipout){B.detachEvent(C,"mouseout",this._ontooltipout);}if(this._super){this._super(A);}}});})();mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){function G(S,V,U){var W=this._layoutWidgets[V],Z=S.slot,X=W.f,Y=W.p,T=(X&&X[Z]!==undefined),R=(Y&&Y[Z]!==undefined);if(Z&&((!U&&T)||R)){return T?X[Z]:(W.x*parseInt(Y[Z],10)/100)+"px";}return S[(V==="h")?"height":"width"];}function Q(T,S,R){if(T.ignoreLayout){return ;}if(T.setDimensions){T.setDimensions(S,R);}else{if(T.set){T.set("height",S);T.set("width",R);}}}function I(U){var S=this.children,W,Y;for(W=0,Y=(S&&S.length)||0;W<Y;W++){var T=S[W],Z=T.slot;if(Z){var X=G.call(this,T,"h",U),a=G.call(this,T,"w",U);this.setSlotDimensions(Z,X,a);Q(T,X,a);var R=G.call(this,T,"h",U),V=G.call(this,T,"w",U);if(R!==X||V!==a){Q(T,R,V);}this.setSlotDimensions(Z,R,V);}}this.afterLayout();}function F(X,T,V){var W=X.slot,U=T&&T.a;if(!U||U[W]===undefined){return ;}var R=this[W]["offset"+V],S=U[W];if(R===S){return ;}T.x-=(R-S);U[W]=R;}function N(R){this.beforeLayout();var S=this._layoutWidgets,T=R.src;F.call(this,T,S.h,"Height");F.call(this,T,S.w,"Width");I.call(this,true);}function E(T,W){if(!T){return null;}var R=this.children,d=W.toLowerCase(),X=parseInt(this[d],10),a,b,V,S,Y,Z,U,f,c;for(c in T){f=T[c];if(f.match(/px$/)){X-=parseInt(f,10);a=a||{};a[c]=f;}else{if(f.match(/\%$/)){b=b||{};b[c]=f;}else{V=V||{};V[c]=f;}}}if(V&&b){for(Y=0,Z=(R&&R.length)||0;Y<Z;Y++){U=R[Y];c=U.slot;if(U.slot&&V[c]&&!U.ignoreLayout){S=S||{};if(U.hasRendered){S[c]=this[U.slot]["offset"+W];X-=S[c];}else{S[c]=0;U.attachEventListener((U instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,N);}}}}return{f:a,p:b,a:S,x:X};}mstrmojo._HasLayout={_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function O(R){this._super(R);this.layoutConfig=mstrmojo.hash.clone(this.layoutConfig);},preBuildRendering:function M(){var T=this.cssText||"";var R=this.height;if(R&&R!=="auto"){T+="height:"+this.height+";";}var S=this.width;if(S&&S!=="auto"){T+="width:"+this.width+";";}this.cssText=T;return(this._super)?this._super():true;},postBuildRendering:function B(){this.doLayout();return this._super();},doLayout:function A(){var R=this.layoutConfig;if(!R){return ;}this.beforeLayout();this._layoutWidgets={h:E.call(this,R.h,"Height"),w:E.call(this,R.w,"Width")};I.call(this,false);},browserResized:function L(R){this.setDimensions(R.h,R.w);return true;},onwidthChange:function P(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.width=this.width;this.doLayout();},onheightChange:function D(){var R=this.domNode;if(!R||!this.layoutConfig){return ;}R.style.height=this.height;this.doLayout();},adjustParentDimensions:function C(){var S=this.parent,R=S&&S._layoutWidgets;if(R){F.call(S,this,R.h,"Height");F.call(S,this,R.w,"Width");}},setDimensions:function K(T,S){if(this.height!==T||this.width!==S){this.height=T;this.width=S;var R=this.domNode;if(R){R.style.height=T;R.style.width=S;this.doLayout();}return true;}return false;},setSlotDimensions:function H(U,T,S){var R=this[U]&&this[U].style;if(!R){return ;}if(T!==undefined&&R.height!==T){R.height=T;}if(S!==undefined&&R.width!==S){R.width=S;}}};mstrmojo._HasLayout.getSlotSize=function J(U,V){var S=U&&U.prototype.layoutConfig;if(S){var T=S.h,R=S.w;return{h:(T&&T[V])||undefined,w:(R&&R[V])||undefined};}return null;};}());(function(){mstrmojo.DI.DIConstants=mstrmojo.provide("mstrmojo.DI.DIConstants",{requestFlag:{mapping:1,preview:2,sourceInfo:8,sheets:16},xdaType:{excel:272,text:288,salesforce:337,querybuilder:352,ffsql:304},sourceType:{file:1,salesforce:2},sourceSubtype:{localFile:1,url:2,salesforce:3},columnState:{reserved:0,unchanged:1,newColumn:2,missing:4,changed:8},baseFormType:{dtdateTime:1,number:2,dttext:3,picture:4,url:5,email:6,htmlTag:7,date:8,dttime:9,symbol:10,bigDecimal:11,phoneNumber:12},dataType:{reserved:0,integer:1,unsigned:2,numeric:3,decimal:4,real:5,dtdouble:6,dtfloat:7,dtchar:8,varChar:9,longVarChar:10,binary:11,varBin:12,longVarBin:13,date:14,dttime:15,timeStamp:16,nChar:17,nVarChar:18,bigDecimal:30,cellFormatData:31,utf8Char:33},operationMode:{create:0,edit:1,refresh:2},statusCode:{obtainSource:-2147071874,xformsError:-2147071872,mappingError:-2147071871,edit:1},pageType:{intro:0,file:1,preview:2,sfLogin:3,sfList:4},pageRedirect:{exit:0,report:1,dtdocument:2,analysis:3},backendError:{dataTypeConversion:-2147212544,overwriteObject:-2147212339,noPermission:-2147214579,invalidObjectName:-2147213715,unexpectedDataType:-2147212539,noExternalSession:-2147071844,noPrivilege:-2147212082,salesforceUnsavedReport:-2147212081,salesforceObsoleteReport:-2147212080,maxSizeExceeded:-2147212076,salesforceUnresolvedFilter:-2147212074,incrementalRefresh:-2147212287},application:{platform:"Platform",cloudPersonal:"Personal",cloudProfessional:"Professional"}});}());(function(){mstrmojo._IsPopup={visible:false,opener:null,onOpen:null,onClose:null,open:function B(E,D){if(this.updatePopupConfig){this.updatePopupConfig(D,E);}else{if(D){for(var C in D){this.set(C,D[C]);}}}this.set("opener",E);if(!this.hasRendered){this.render();}if(this.nudge){this.domNode.style.top="-10000px";}this.set("visible",true);if(this.nudge){this.nudge();}if(this.onOpen){this.onOpen();}},close:function A(C){if(this.onClose){this.onClose(C);}this.set("visible",false);this.set("opener",null);}};})();(function(){var R=Math;function y(G,b){return b||(G||window).event;}var AZ=!!document.all,p=navigator.userAgent,g=!AZ&&!!p.match(/Firefox/),l=0,q=!!p.match(/Android/),AT=!!p.match(/iPad/),AN=!!document.createTouch||q,o=!!p.match(/PlayBook/),S=!!p.match(/Windows Phone/),V=AZ&&!!p.match(/MSIE 10/),Aa=!AZ&&!!p.match(/Trident.*rv/),r=AZ&&!V,f=g?"-moz-":AZ?"":"-webkit-",AE=g?"Moz":V?"":AZ?"ms":"webkit",AL=(V?"t":"T"),AH=AE+AL+"ransition",AX=AU(),AQ=AB(),x=W(),A=Q(),m=h();function AU(){return AE+AL+"ransform";}function AB(){return AH+"Property";}function W(){return AH+"Duration";}function Q(){return(V||g)?"transitionend":"webkitTransitionEnd";}function h(){return AE+"BoxShadow";}function AK(){if(!l&&g){var G=p.match(/.*Firefox\/([\d|\.]*).*/);if(G){l=parseFloat(G[1],10);}}return l;}function AY(){var Ac=0,Ag=0,Ad=window,Ae=document,G=Ae.body,Af=Ae.documentElement;if(typeof Ad.pageYOffset=="number"){Ag=Ad.pageYOffset;Ac=Ad.pageXOffset;}else{if(G&&(G.scrollLeft||G.scrollTop)){Ag=G.scrollTop;Ac=G.scrollLeft;}else{if(Af&&(Af.scrollLeft||Af.scrollTop)){Ag=Af.scrollTop;Ac=Af.scrollLeft;}}}return{x:Ac,y:Ag};}function AC(G){G=G||0;G=String(G);return((G.indexOf("%",0))!=-1)?G:(G+"px");}function AI(d,Ae,Ad,Ac,w){if(!mstrmojo.dom.isWinPhone){Ac=(Ac||false||this.isHWAccelerated);}else{Ac=false;}var b=w+(Ac?"3d":"")+"(",G=Ac?(","+Ad+")"):")";return b+d+","+Ae+G;}var L=1,AR=2,Y=3,D=4,K=5;function t(Ae,Ad,Ah){var Ag=Ae.style,b=Ag.display,Ac=this.windowDim(),w=AY();Ag.display="block";var Af=Ac.w-Ae.clientWidth,Ai=Ac.h-Ae.clientHeight,G={4:0,5:Af,3:Af/2},d={1:0,3:Ai/2,2:Ai};Ag.left=G[Ad]+w.x+"px";Ag.top=d[Ah]+w.y+"px";Ag.display=b;}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:p,isIE:AZ,isIE6:AZ&&!!p.match(/MSIE 6/),isIE7:AZ&&!!p.match(/MSIE 7/),isIE8:AZ&&!!p.match(/MSIE 8/),isIE9:AZ&&!!p.match(/MSIE 9/),isIE10:V,isIEW3C:Aa,isNSIE:AZ&&!V,isDXIE:r,isFF:g,isWK:!!p.match(/AppleWebKit/),isSafari:!!p.match(/Safari/)&&!p.match(/Chrome/),isHWAccelerated:!q,isAndroid:q,isIPad:AT,isPlayBook:o,isWinPhone:S,supportsTouches:AN,TOUCHSTART:AN?"touchstart":"mousedown",TOUCHMOVE:AN?"touchmove":"mousemove",TOUCHEND:AN?"touchend":"mouseup",TOUCHCANCEL:AN?"touchcancel":"",RESIZE:AN?"orientationchange":"resize",CSS3_PREFIX:f,CSS3_BOXSHADOW:m,CSS3_TRANSFORM:AX,CSS3_TRANSITION:AH,CSS3_TRANSITION_PROPERTY:AQ,CSS3_TRANSITION_DURATION:x,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},supports:function B(b){var G=this.isFF&&AK();switch(b){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||G>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||G>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);}return false;},replace:function F(d,G){if(!d||!G){return ;}var b=d.parentNode;if(b){b.replaceChild(G,d);}},attachEvent:function s(d,b,w,G){if(d.addEventListener){return d.addEventListener(b,w,!!G);}else{return d.attachEvent("on"+b,w);}},detachEvent:function AO(d,b,w,G){if(!d){return ;}if(d.removeEventListener){d.removeEventListener(b,w,!!G);}else{d.detachEvent("on"+b,w);}},attachOneTimeEvent:function Z(w,b,Ac,G){var d=function(Ad){Ac(Ad);mstrmojo.dom.detachEvent(this,b,d,G);};this.attachEvent(w,b,d,G);w=null;return d;},captureDomEvent:function AG(Ad,w,b,Ac,d){var G=mstrmojo.all[Ad];if(G){G.captureDomEvent(w,b,Ac,d);}},translate:function O(d,b,Ad,Ac,G,w){G=(G&&" "+G)||"";d.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(b,Ad,Ac,w)+G;},createTranslateString:function T(G,w,d,b){G=AC(G);w=AC(w);d=AC(d);return AI(G,w,d,b,"translate");},createScaleString:function u(G,w,d,b){G=G||0;w=w||0;d=d||0;return AI(G,w,d,b,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function E(d,G,w,Ad){var b=d.id+"-"+G,Ac=this._bufferConnects[b];if(!Ac){Ac=this._bufferConnects[b]={elId:d.id,eventName:G,timer:null,bufferSize:Ad,listeners:[],callback:function(Ae){mstrmojo.dom._callback(Ae,mstrmojo.global,b);return true;}};this.attachEvent(d,G,Ac.callback);}Ac.listeners.push(w);},_callback:function N(Ac,G,d){if(!Ac){Ac=G.event;}var w=this._bufferConnects[d],Ad=w&&w.timer;if(w&&!Ad){var b=(w.bufferSize===null)?this._bufferSize:w.bufferSize;if(w.bufferSize){w.timer=G.setTimeout(function(){mstrmojo.dom.updateBuffers(d);},b);}else{mstrmojo.dom.updateBuffers(d);}}},updateBuffers:function AS(w){var Ac=this._bufferConnects[w],b=Ac&&Ac.listeners;for(var d=0,G=b&&b.length||0;d<G;d++){b[d]();}if(Ac&&Ac.timer){delete Ac.timer;}},detachBufferedEvent:function a(Ad,d,Ae){if(!Ad){return ;}var Ac=Ad.id+"-"+d,Af=this._bufferConnects[Ac],b=Af&&Af.listeners,G=(b&&b.length)||0;if(G){for(var w=G-1;w>-1;w--){if(b[w]==Ae){b.splice(w,1);}}if(!b.length){this.detachEvent(Ad,d,Af.callback);delete this._bufferConnects[Ac];if(Af.timer){mstrmojo.global.clearTimeout(Af.timer);}}}},eventTarget:function z(G,b){b=y(G,b);return b.target||b.srcElement;},ctrlKey:function AV(G,b){return y(G,b).ctrlKey;},shiftKey:function AA(G,b){return y(G,b).shiftKey;},getButton:function AM(G,b){return((y(G,b)).button==2)?2:1;},getMousePosition:function i(Ad,Ac){Ac=Ac||window;var w,Ag;if(mstrmojo.dom.isIE){Ad=Ad||Ac.event;var Ae=document,G=Ae.body,Af=Ae.documentElement;w=Ad.clientX+G.scrollLeft+(Af.scrollLeft||0);Ag=Ad.clientY+G.scrollTop+(Af.scrollTop||0);}else{w=Ad.pageX;Ag=Ad.pageY;}return{x:w,y:Ag};},position:function(b,d){var Ad={x:0,y:0};if(b&&b.getBoundingClientRect){try{Ad=b.getBoundingClientRect();}catch(Ac){Ad={left:0,top:0,right:0,bottom:0,height:0,width:0};}Ad={x:Ad.left,y:Ad.top,w:Ad.right-Ad.left,h:Ad.bottom-Ad.top};if(this.isIE6||this.isIE7){var G=b.ownerDocument;if(G){var Af=G.documentElement,Ae=Af.getBoundingClientRect();Ad.x-=Ae.left;Ad.y-=Ae.top;}}}if(d){var w=AY();Ad.x+=w.x;Ad.y+=w.y;}return Ad;},delta:function J(d,G){G=G||document.body;var b=this.position(d),w=this.position(G);return{x:Math.round(b.x-w.x),y:Math.round(b.y-w.y)};},windowDim:function Ab(){var G=0,Ac=0,Ad=window,Ae=document,Af=Ae.documentElement,b=Ae.body;if(typeof (Ad.innerWidth)=="number"){G=Ad.innerWidth;Ac=Ad.innerHeight;}else{if(Af&&(Af.clientWidth||Af.clientHeight)){G=Af.clientWidth;Ac=Af.clientHeight;}else{if(b&&(b.clientWidth||b.clientHeight)){G=b.clientWidth;Ac=b.clientHeight;}}}return{w:G,h:Ac};},center:function AF(G){t.call(this,G,Y,Y);},bottomCenter:function H(G){t.call(this,G,Y,AR);},clearBrowserHighlights:function P(G){G=G||self;if(AZ){var Ae=G.document,Ad=Ae&&Ae.selection,w=Ad&&Ad.empty;if(w){try{Ad.empty();}catch(d){}}}else{var b=G.getSelection,Ac=b&&G.getSelection();if(Ac&&!Ac.isCollapsed){if(Ac.empty){Ac.empty();}else{if(Ac.removeAllRanges){Ac.removeAllRanges();}}}}},findAncestorByAttr:function AJ(Ac,d,b,G){var Ad=b?Ac:Ac&&Ac.parentNode;while(Ad&&(Ad!=G)){var w=Ad.getAttribute&&Ad.getAttribute(d);if(w!=null){return{node:Ad,value:w};}Ad=Ad.parentNode;}return null;},findAncestorByName:function AW(d,Ad,b,G){Ad=Ad&&Ad.toLowerCase();var w=b?d:d&&d.parentNode;while(w&&(w!=G)){var Ac=w.nodeName;if(Ac&&(Ac.toLowerCase()==Ad)){return w;}w=w.parentNode;}return null;},contains:function M(w,Ac,b,G){var d=Ac;if(!b){d=d.parentNode;}while(d){if(d==w){return true;}if(d===G){break;}d=d.parentNode;}return false;},preventDefault:function AP(G,b){if(!b){b=G.event;}if(b.preventDefault){b.preventDefault();}else{b.returnValue=false;}},stopPropogation:function j(G,b){if(!b){b=G.event;}if(b.stopPropogation){b.stopPropogation();}else{b.cancelBubble=true;}},firstTouch:function C(G,b){return b&&b.touches&&b.touches.length?b.touches[0]:(b||G.event);},firstChangedTouch:function I(G,b){return b&&b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:(b||G.event);},isLandscape:function X(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function(G){while(G){var b=G.mstrmojoId;if(b!=null){return mstrmojo.all[b];}G=G.parentNode;}return null;},setCaret:function(G,d){if(G.setSelectionRange){G.focus();G.setSelectionRange(d,d);}else{if(G.createTextRange){var b=G.createTextRange();b.move("character",d);b.select();}}}});var AD=mstrmojo.dom,c=window,k=document,U=k&&k.documentElement,n=k&&k.body;if(c.innerWidth){AD.getHorizontalScroll=function(){return c.pageXOffset;};AD.getVerticalScroll=function(){return c.pageYOffset;};}else{if(U&&U.clientWidth){AD.getHorizontalScroll=function(){return U.scrollLeft;};AD.getVerticalScroll=function(){return U.scrollTop;};}else{if(n.clientWidth){AD.getHorizontalScroll=function(){return n.scrollLeft;};AD.getVerticalScroll=function(){return n.scrollTop;};}}}})();(function(){mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Object,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",callback:null,ob:null,item:null,path:mstrConfig.taskURL,fetchFolderContents:function(A,B,E){this.ob=A;this.item=B;this.callback=E;var C=this.ob.blockCount,D={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:C,includeAncestorInfo:true,includeObjectDesc:A.includeObjectDesc};if(A.folderLinksContextId){D.folderLinksContextId=A.folderLinksContextId;}if(A.sId){D.sessionState=A.sId;}if(B.fid){D.rootFolderID=B.fid;}else{if(B.fty){D.rootFolderType=B.fty;}}if(A.browsableTypes){D.objectType=A.browsableTypes;}if(B.blockBegin){D.blockBegin=B.blockBegin;}if(B.searchPattern){D.searchPattern=B.searchPattern;if(B.recursive){D.recursive=B.recursive;}}mstrmojo.xhr.request("POST",this.path,E,D,undefined,this.XServer,this.baseParams);},newFolder:function(D,E,C,A){var B={taskId:"createFolder",folderID:D,name:E,description:C};mstrmojo.xhr.request("POST",this.path,A,B,undefined,this.XServer,this.baseParams);}});})();(function(){mstrmojo.boxmodel={rangeIntersect:function C(H,F,G,E){if(H<G){return G<=F;}else{if(H>G){return H<=E;}else{return true;}}},px2Inches:function A(F,E){E=parseInt(E,10);return parseFloat((E/F.zf/F.dpi).toFixed(4),10);},offset:function D(G,F){var I=G,E=0,H=0;while(G){E+=G.offsetLeft;H+=G.offsetTop;G=G.offsetParent;if(G===F){break;}}for(e=I&&I.parentNode;e&&e!=F;e=e.parentNode){if(e.scrollTop){H-=e.scrollTop;}if(e.scrollLeft){E-=e.scrollLeft;}}return{left:E,top:H};},convert2px:function B(H,F){if(!/px$/.test(F)){var E=document.createElement("img"),G;E.style.zIndex=-1;E.style.left=F;H.appendChild(E);G=E.style.pixelLeft;H.removeChild(E);return G+"px";}else{return F;}}};})();(function(){var L=/\{\@([^\}]+)\}/gm,H=/\</gm,P=/\>/gm,D=/\S/,O=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],E=new RegExp("(\\"+O.join("|\\")+")","g"),Q={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'};var J=function(S){if(S==null){return"null";}var T=typeof (S);if(T!="object"){return T;}else{if(S.length===undefined){return"object";}else{return"array";}}};var R={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function F(T,V){if(!T){return"";}var U=[];for(var S in V){U.push(S.k||S);}return T.replace(new RegExp(U.join("|"),"g"),function(W){var X=V[W];return X.v||X;});},trim:function N(S){return(S&&S.replace)?S.replace(/^\s+/,"").replace(/\s+$/,""):S;},ellipsize:function A(U,T){var S=this.trim(U.substr(0,(T||1)-1));if(S!==U){S+="&hellip;";}return S;},isEmpty:function I(S){return(S==null)||!(D.test(S));},regEscape:function M(S){return S.replace(E,"\\$1");},encodeXMLAttribute:function(S){return mstrmojo.string.multiReplace(S,Q);},encodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,C);},decodeHtmlString:function(S){return mstrmojo.string.multiReplace(S,K);},htmlAngles:function(S){S=String(S);if(S!=null){return S.replace(H,"&lt;").replace(P,"&gt;");}return S;},apply:function G(S,T){if(!S){return"";}return S.replace(L,function U(V,W){return(W in T&&T[W]!==null)?T[W]:"";});},json2xml:function(f,b,V){if(!(b instanceof Array)){b=[b];}var T=V&&V.isSerializable,Z=(V.convertBoolean===false)?false:true;var c=[],S=[],U,g,k;for(var Y=0,h=b.length;Y<h;Y++){var j=b[Y];for(U in j){if(T){var a=T(U,b,Y);if(a!==true){if(a===false){continue;}else{if(a.att){c.push(a.att);}if(a.child){S.push(a.child);}continue;}}}g=j[U];k=J(g);switch(k){case"array":S.push("<"+U+">");for(var W=0,X=g.length;W<X;W++){var d=V.getArrItemName(U,g,W)||W;S.push(this.json2xml(d,g[W],V));}S.push("</"+U+">");break;case"object":S.push(this.json2xml(U,g,V));break;case"string":c.push(U+'="'+mstrmojo.string.encodeXMLAttribute(g)+'"');break;case"boolean":c.push(U+'="'+((Z)?(g?"-1":"0"):g)+'"');break;case"null":if(!V.skipNull){c.push(U+'="'+V.nullValue+'"');}break;default:c.push(U+'="'+g+'"');break;}}}return"<"+f+" "+c.join(" ")+">"+S.join("")+"</"+f+">";},escape4HTMLText:function B(Z){if(!Z||!Z.replace){return Z;}var W=/\"/gm;var U="&quot;";var a=/\&/gm;var Y="&amp;";var X=/\</gm;var S="&lt;";var V=/\>/gm;var T="&gt;";return Z.replace(a,Y).replace(W,U).replace(X,S).replace(V,T);},parseUri:function(W,T){T=T||R;var S=T.parser[((T.strictMode)?"strict":"loose")].exec(W),V={},U=14;while(U--){V[T.key[U]]=S[U]||"";}V[T.q.name]={};V[T.key[12]].replace(T.q.parser,function(Y,X,Z){if(X){V[T.q.name][X]=Z;}});return V;}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,L=mstrmojo.hash;function F(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(C.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function B(R){var Q=[],S=R.selectedIndices;for(var P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function N(V,U){var S=[],Q=V.selectedIndices,X=C.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return B(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}for(var R=0,T=U.length;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex==W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V;for(var Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function H(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function O(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=B(this),S=F(this,[P]);if(Q!==true){H(this,S,R);}}},toggleSelect:function J(P,Q){var S,R;if(this.selectedIndices[P]){R=N(this,[P]);}else{S=F(this,[P]);}if(Q!==true){H(this,S,R);}},rangeSelect:function G(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=B(this);if(P!==true){H(this,null,Q);}},select:function E(R,P){var Q=A(this,C.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){H(this,Q.add,Q.rmv);}},addSelect:function M(R,P){if(R==null){return ;}if(R.constructor!==Array){R=[R];}var Q=F(this,R);if(P!==true){H(this,Q,null);}return Q;},removeSelect:function K(R,P){if(R==null){return ;}if(R.constructor!=Array){R=[R];}var Q=N(this,R);if(P!==true){H(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){H(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof (T)=="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=C.find(U,V,T[V]);}else{if(T!=null){Q=C.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function D(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!=null){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return L.keyarray(this.selectedIndices,true).sort(C.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return C.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],t=this.itemIdField!=null?C.findMulti(S,this.itemIdField,Q):C.indexOfMulti(S,Q),V=Q.length,T=V-t.count,r=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(r&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],g=t.map;if(T&&r){var q=0;for(var f=0;f<V;f++){if(g[f]==null){R.push(Q[f]);U.push(b+q++);}}this.add(R,b);}var W=[];for(var l in g){var p=g[l];if(p>=b){p+=X;}W.push(p);}var s=W.concat(U),Y=this.addSelect(s,!d);if(!d){var Z=C.hash(Y),h=this.selectedIndices,a=[];for(var o in h){if(!Z[o]){a.push(parseInt(o,10));}}var P=this.removeSelect(a,true);H(this,Y,P);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var F=mstrmojo.dom,L=mstrmojo.string;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:F.isNSIE?"block":"table",DISPLAY_CELL:F.isNSIE?"block":"table-cell",MINHEIGHT:F.isIE6?"height":"minHeight",addClass:function H(V,U){if(!V){return ;}if(U.constructor!==Array){U=[U];}var R=V.className||"",X=" "+R+" ",S=false;for(var T=0,Q=U.length;T<Q;T++){var W=U[T];if(!X.match(new RegExp("\\s"+W+"\\s"))){R+=" "+W;S=true;}}if(S){V.className=L.trim(R);}},removeClass:function M(U,T){if(!U){return ;}if(T.constructor!==Array){T=[T];}var R=" "+(U.className||"")+" ";for(var S=0,Q=T.length;S<Q;S++){R=R.replace(new RegExp("\\s"+T[S]+"\\s","g")," ");}U.className=L.trim(R);},addWidgetCssClass:function G(T,R){var Q=T.cssClass,S=(Q&&Q.split(" "))||[];if(R.constructor!==Array){R=[R];}T.cssClass=S.concat(R).join(" ");},toggleClass:function N(S,R,Q){if(Q){this.addClass(S,R);}else{this.removeClass(S,R);}},applyShadow:function D(U,V,T,S,Q){var R=U.style;if(F.isDXIE){R.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+V+"px, OffY="+T+"px, Color='"+Q+"')";}else{if(F.isFF||F.isWK||F.isIE10){R[F.CSS3_BOXSHADOW]=V+"px "+T+"px "+S+"px "+Q;}}},removeShadow:function O(R){var Q=R.style;if(F.isDXIE){}else{if(F.isFF||F.isWK||F.isIE10){Q[F.CSS3_BOXSHADOW]="";}}},setOpacity:function A(R,T){if(F.isDXIE&&!F.isIE9){var U=R.currentStyle.filter;var Q=null;if(U.length>0){Q=R.filters["DXImageTransform.Microsoft.Alpha"];}if(Q){Q.opacity=T;Q.enabled=(T!=100);}else{if(T<100){var S="progid:DXImageTransform.Microsoft.Alpha(Opacity="+T+")";R.style.filter=(U?U:"")+" "+S;}}}else{R.style.opacity=T/100-(F.isIE9?0.00001:0);}},buildGradient:function C(R,T,Q){if(F.supports(F.cssFeatures.GRADIENTS)){var S={};if(F.isDXIE){S.n="filter";S.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+R+",StartColorStr='"+T+"',EndColorStr='"+Q+"')";}else{if(F.isFF){S.n="background-image";S.v="-moz-linear-gradient("+((R===0)?"top":"left")+","+T+","+Q+")";}else{if(F.isWK){S.n="background";S.v="-webkit-gradient(linear,"+((R===0)?"left top, left bottom":"left top, right top")+",from("+T+"),to("+Q+"))";}else{if(F.isIE10||F.isIEW3C){S.n="background";S.v="linear-gradient("+((R===0)?"to bottom":"to right")+","+T+","+Q+")";}}}}return S;}return null;},buildRoundCorners:function K(V,U){if(F.supports(F.cssFeatures.ROUND_CORNERS)){var R=V+"px";var X=R+((U)?" "+R+" 0 0":"")+";";if(F.isFF){return"-moz-border-radius:"+X;}else{if(F.isWinPhone||F.isIE10){return"border-radius:"+X;}else{if(F.isWK){if(!U){return"-webkit-border-radius:"+R+";";}else{var W=["left","right"],T=[],Q=-1;for(var S=0;S<2;S++){T[++Q]="-webkit-border-top-"+W[S]+"-radius:"+R;T[++Q]="-webkit-border-bottom-"+W[S]+"-radius:0";}return T.join(";");}}}}}return"";},getBorderWidthsOrPaddings:function E(R,U){var V={t:0,r:0,b:0,l:0,h:0,w:0};if(!R){return V;}var S=R.split(" "),Q=S.length;for(var T=0;T<Q;T++){S[T]=Math.round(U*parseFloat(S[T],10)/72);}if(Q<4){if(Q===1){S[1]=S[2]=S[3]=S[0];}else{S[3]=S[1];if(Q===2){S[2]=S[0];}}}V.t=S[0];V.r=S[1];V.b=S[2];V.l=S[3];V.h=V.t+V.b;V.w=V.l+V.r;return V;},getBorderWidths:function I(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},getPaddings:function J(R,Q){return this.getBorderWidthsOrPaddings(R,Q);},parkAfterFade:function P(Q){var R=Q.target.style;if(R.opacity==0){R.left="-10000px";window.setTimeout(function(){R.opacity=0.99;},0);return true;}return false;},getStyleValue:function B(Q,S){if(Q.currentStyle){S=S=="float"?"styleFloat":S;value=Q.currentStyle[S];}else{if(document.defaultView&&document.defaultView.getComputedStyle){S=S=="float"?"cssFloat":S;var R=document.defaultView.getComputedStyle(Q,null);value=R?R[S]:null;}}return value;},getComputedStyle:function(Q,S){var R=(window.getComputedStyle)?function(T,U){return window.getComputedStyle(T,U||null);}:function(T){return T.currentStyle||{};};mstrmojo.css.getComputedStyle=R;return R(Q,S);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,D=mstrmojo.hash;function C(X,V){if(!V){return ;}var Y=[],O=X.selectedIndices,N=X.allIdx,T=X.noneIdx,P=X.parent&&X.parent.include;if(X.multiSelect&&(T>-1)&&(G.indexOf(V,T)>-1)){return Y;}var R,S,W=X.items,U=X.itemIdField,Q=X.selectedItems,a;if(X.multiSelect&&(N>-1)&&(G.indexOf(V,X.allIdx)>-1)){for(R=0,S=W.length;R<S;R++){if(!O[R]){Y.push(R);O[R]=true;X.selectedIndex=R;X.selectedItem=W[R];}}}else{for(R=0,S=V.length;R<S;R++){var Z=V[R];if(!O[Z]){O[Z]=true;Y.push(Z);X.selectedIndex=Z;a=X.selectedItem=W[Z];if(Q){Q[a[U]]=a;}}}}return Y;}function A(P){var O=[],Q=P.selectedIndices,R=P.selectedItems;for(var N in Q){delete Q[N];O.push(parseInt(N,10));}P.selectedIndex=-1;P.selectedItem=null;if(R){P.selectedItems={};}return O;}function L(W,V){if(!V){return ;}var S=[],O=W.selectedIndices,Y=G.indexOf,N=W.allIdx,T=W.noneIdx,U=W.itemIdField,P=W.selectedItems;if(W.multiSelect&&(((N>-1)&&(Y(V,N)>-1))||((T>-1)&&(Y(V,T)>-1)))){return A(W);}if(V.length>0&&O[N]){if(Y(V,N)<0){V.push(N);}}for(var Q=0,R=V.length;Q<R;Q++){var X=V[Q];if(O[X]){delete O[X];S.push(X);if(P){delete P[W.items[X][U]];}if(W.selectedIndex==X){W.selectedIndex=-1;W.selectedItem=null;}}}return S;}function F(Q,P,R,N){if(Q.raiseEvent){Q.raiseEvent({name:"select",idxs:N||[]});if((P&&P.length)||(R&&R.length)){try{Q.raiseEvent({name:"selectionChange",added:P,removed:R});}catch(O){L(Q,P);C(Q,R);throw O;}}}}function I(P,O){if(O==null){return -1;}var N=typeof (O)=="object",Q=P.itemIdField;if(N&&Q!=null){return G.find(P.items,Q,O[Q]);}else{return G.indexOf(P.items,O);}}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(N){this._super(N);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function M(W){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this.items,N=this.items.length,Q=this.selectedItems,S=[],P;U=this.items=U.concat(W);P=U.length;if(Q){var O=this.selectedIndices,T=this.itemIdField,R,V;for(R=N;R<U.length;R++){V=U[R];if(Q[V[T]]){S.push(R);}}}if(S&&S.length){C(this,S);}if(P>N){this.itemsContainerNode.innerHTML+=this._buildItemsMarkup(N,P-1).join("");}},addSelectedItems:function H(N){this.selectItems(N,false);},setSelectedItems:function K(N){this.selectItems(N,true);},selectItems:function J(W,Y){if(!W){return ;}if(W.constructor!=Array){W=[W];}var U=this;if(Y&&U.selectedItems){U.selectedItems={};}var P=U.selectedItems,T=U.itemIdField,X,V,Q,N=[],S=U.items.length,R=[],O=U.allowUnlistedValues;for(Q=0;Q<W.length;Q++){X=W[Q];V=I(this,X);if(V===-1){if(P===null){if(O){N.push(v);V=S++;}}else{P[X[T]]=X;}}if(V!==-1){R.push(V);}}if(N.length>0){U.addItems(N);}if(R.length>0){if(Y){U.select(R);}else{U.addSelect(R);}}},unselectItems:function J(O){if(!O){return ;}if(O.constructor!=Array){O=[O];}var S=this,U=S.selectedItems,P=[],T=S.itemIdField,R,N,Q;if(U===null){return ;}for(Q=0;Q<O.length;Q++){R=O[Q];if(U){delete U[R[T]];}N=I(this,R);if(N!==-1){P.push(N);}}if(P.length>0){S.removeSelect(P);}},getSelectedItems:function B(){if(this.selectedItems!=null){return D.valarray(this.selectedItems);}else{return G.get(this.items,D.keyarray(this.selectedIndices,true));}},singleSelect:function(N,O){if(N!==-1){this.select([N],O);}},singleSelectByField:function E(O,P,N){this.singleSelect(G.find(this.items,P,O),N);},toggleSelect:function(N){var P,O;if(this.selectedIndices[N]){O=L(this,[N]);}else{P=C(this,[N]);}F(this,P,O,[N]);},rangeSelect:function(N){},select:function(O,N){if(O==null){return ;}if(O.constructor!=Array){O=[O];}var Q=A(this),S=C(this,O),P=Q.length-1;if(this.selectionPolicy!=="reselect"){for(;P>=0;P--){var R=G.indexOf(S,Q[P]);if(R>-1){Q.splice(P,1);S.splice(R,1);}}}if(!N){F(this,S,Q,O);}},clearSelect:function(N){var O=A(this);if(N!==true){F(this,null,O,[]);}},addSelect:function(P,N){if(P==null){return ;}if(P.constructor!=Array){P=[P];}var O=C(this,P);var R=null,Q=this.noneIdx;if(this.multiSelect&&(Q>-1&&G.indexOf(P,Q)>-1)){R=L(this,P);}if(N!==true){F(this,O,R,P);}},removeSelect:function(N){if(N==null){return ;}if(N.constructor!=Array){N=[N];}F(this,null,L(this,N),N);},_set_selectedIndices:function(P,W,N){var S=this,O=S.selectedIndices;if(S.selectedItems){S.selectedItems={};}var O=S.selectedIndices;if(O==W){return false;}if(!O){O={};S.selectedIndices=O;}if(!W){W={};}var U=S.selectedIndex,T=[],V;for(V in O){if(!W[V]){V=parseInt(V,10);delete O[V];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var Z=[],X=S.items,R=S.itemIdField,Y;for(V in W){if(!O[V]){V=parseInt(V,10);O[V]=true;Z.push(V);S.selectedIndex=V;Y=S.selectedItem=X[V];if(S.selectedItems){S.selectedItems[Y[R]]=Y;}}}if(N!==true){var Q=[];for(V in W){if(O[V]){V=parseInt(V,10);Q.push(V);}}F(S,Z,T,Q);}return(Z.length||T.length);},_set_selectedIndex:function(Q,O,N){var P={};if(O>-1){P[O]=true;}return this._set_selectedIndices("selectedIndices",P,N);},_set_selectedItem:function(Q,P,O){var N=I(this,P);if((N===-1)&&(P!=null)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(P));N=this.items.length-1;}return this._set_selectedIndex("selectedIndex",N,O);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",H="";var N=/\+/g;for(var I=0,F=M.length;I<F;I++){var E=M[I].split("=");L=E[0];H=E[1];if(H){H=decodeURIComponent(H.replace(N," "));}var G=document.createElement("INPUT");G.type="HIDDEN";G.name=L;G.value=H;K.appendChild(G);}return false;}mstrmojo.form={createDynamicForm:function A(E){var G=document.createElement("FORM"),H=E.indexOf("?")>0;G.name="dynamic_form";G.method="POST";var F=((H)?E.substring(0,E.indexOf("?")):E);G.action=F;if(H){B(G,E);}document.body.appendChild(G);return G;},send:function D(J,K,E,M,H,F){var O=((H&&H.hWin)||window).document,L=O.createElement("form"),I=mstrApp;L.method=E||"GET";if(M){L.target=M;}L.action=K||I.name;F=(F!==undefined)?F:!(L.action&&L.action.indexOf("aspx")>0);if(I.sessionId){L.action+=";jsessionid="+I.sessionId;}if(F){L.action+=";uxts"+mstrmojo.now();}L.appendChild(C(O,"xts",mstrmojo.now()));for(var P in I.persistTaskParams){J[P]=I.persistTaskParams[P];}if(I.servletState&&I.name){J[I.name]=I.servletState;}if(J){for(var G in J){if(J[G].constructor==Array){mstrmojo.array.forEach(J[G],function(Q){L.appendChild(C(O,G,Q));});}else{L.appendChild(C(O,G,J[G]));}}}O.body.appendChild(L);try{L.submit();}catch(N){if(M&&N.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}O.body.removeChild(L);}};})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom");var M=mstrmojo.string,T=mstrmojo.dom;var N=mstrmojo.useFrames?null:document.createElement("span");var B=/\mstrAttach\:([\w\,]+)/g;var R;function O(X){if(R===undefined){R=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return X.replace(B,function W(c,f){var Z=f.split(","),a=[],Y=Z.length,b;for(b=0;b<Y;b++){var d=Z[b];if(d){if(R){if(d.indexOf("mouse")>-1){continue;}else{if(d==="click"){d="touchend";}}}a.push("on"+d+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+d+"', self, event)\"");}}return a.join(" ");});}var P="preBuildRendering",D="buildRendering",A="postBuildRendering";function E(Y){var X=Y.markupString;if(X.match(/mstrAttach:/)){X=O(X);if(Y.markupString===Y.constructor.prototype.markupString){Y.constructor.prototype.markupString=X;}}var W=M.apply(X,Y);if(W){if(mstrmojo.useFrames){var Z=(Y.domNode&&Y.domNode.ownerDocument)||self.document;if(!N||N.ownerDocument!==Z){N=Z.createElement("span");}}N.innerHTML=W;var a=N.firstChild;a.mstrmojoId=Y.id;return a;}return null;}function J(Y){var X=Y.markupSlots,W,Z;if(X){W={};for(Z in X){W[Z]=X[Z].apply(Y,[]);}}return W;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function G(){if((this[P]&&this[P]()===false)||(this[D]()===false)||(this[A]&&this[A]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var W="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,W)){this.raiseEvent({name:W});}return true;},buildDom:function S(){return E(this);},preBuildRendering:mstrmojo.emptyFn,buildRendering:function C(){var W=this.domNode,X=this.buildDom();this.domNode=X;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(J(this));this.paint();if(X){var a=W;if(!a){a=this.placeholder;if(a){if(typeof a==="string"){a=document.getElementById(a);}delete this.placeholder;}}if(a){T.replace(a,X);}}var Y="onchildRenderingChange",Z=this.parent;if(Z&&Z[Y]){Z[Y](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function Q(Y){if(this.hasRendered){if(!Y){try{var W=this.domNode;if(W.parentNode){W.parentNode.removeChild(W);}if(mstrmojo.dom.isIE&&W.outerHTML!=="undefined"){W.outerHTML="";}}catch(X){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function V(){var X=this.markupMethods;if(!X){return ;}var a=this,b=function(h){var d=X[h];if(d){try{d.apply(a,[true]);}catch(g){throw new Error(["Error in markup method.","Widget id: "+a.id,"Method name: "+h,"Err: "+g.message].join("\n\n"));}}};var Z=X.sequence,W,Y,c;if(Z){W=Z.length||0;for(Y=0;Y<W;Y++){b(Z[Y]);}}else{for(c in X){b(c);}}},refresh:function F(W){if(this.hasRendered){var X=this.domNode;this.unrender(true);this.placeholder=X;if(W){W();}this.render();}},set:function L(Z,W){this._super(Z,W);if(this.domNode){var X=this.markupMethods,Y=X&&X["on"+Z+"Change"];if(Y){Y.apply(this);}}return this;},slotNames:null,addSlots:function I(X){var W=this.slotNames,Y;if(!W){W={};this.slotNames=W;}for(Y in X){this[Y]=X[Y];W[Y]=true;}},removeSlots:function K(W){if(W){var X=this.slotNames,Y;for(Y in W){delete this[Y];if(X){delete X[Y];}}}},captureDomEvent:function H(Y,W,Z,X){if(this.enabled!==false){this.raiseEvent({name:Y,hWin:W,e:Z||W.event,config:X});}},playEffect:function U(X){var W=this[X];if(W&&W.constructor===Object){W=mstrmojo.insert(mstrmojo.hash.clone(W));W.widget=this;this[X]=W;}if(W){W.play();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,E=false;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function(){var F=C.windowDim(),J=(C.isFF||C.isWK)?0:2;var G=F.w,I=F.h;if(E){var H=I;I=G;G=H;}return{w:Math.max(G,0)+"px",h:Math.max(I-J,0)+"px"};},simulateOrientationChange:function A(){E=!E;this.monitorWindow();},preBuildRendering:function B(){var G=true;if(this._super){G=this._super();}var H=this.getBrowserDimensions();if(!("browserResized" in this)||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return G;},destroy:function D(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function(F){var H=F.currentTarget,I=this.getBrowserDimensions(),G={w:(H?H.innerWidth+"px":I.w),h:(H?H.innerHeight+"px":I.h)};if(G.h===this.height&&G.w===this.width){return ;}if(!("browserResized" in this)||this.browserResized(G)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var I=mstrmojo.dom;var L="mousedown";function P(S){var R=S[S.hotSlot||"domNode"];if(R){if(!S._closeCallback){var U=S.id,T=function(V){return function(X){var W=mstrmojo.all[U];if(W&&!W.ignoreHover){W["auto"+V](X,self);}};};S._uncloseCallback=T("Unclose");S._closeCallback=T("Close");}I.attachEvent(R,"mouseover",S._uncloseCallback);I.attachEvent(R,"mouseout",S._closeCallback);}}function C(S){if(S._closeCallback){var R=S[S.hotSlot||"domNode"];if(R){I.detachEvent(R,"mouseover",S._uncloseCallback);I.detachEvent(R,"mouseout",S._closeCallback);}}}function N(T,S){var R=T;while(R){if(R.open||R.openPopup){if(R.set){R.set("ignoreHover",S);}else{R.ignoreHover=S;}}R=R.opener||R.parent;}}function A(){var R=this._lockHoverCallback;if(R){I.detachEvent(document.body,L,R,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose={autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function B(){this._super();if(this.autoCloses){P(this);}this.oncloseOnClickChange();},onautoClosesChange:function D(){var R=(this.autoCloses)?P:C;R(this);},oncloseOnClickChange:function O(){if(!this.curtainNode){return ;}var T=this,S="click",R=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(R){S="touchstart";}I.attachEvent(T.curtainNode,S,function(){T.close();if(R){mstrmojo.touchManager.notify([]);}});},autoUnclose:function H(){var R=this._autoCloseTimer;if(R){self.clearTimeout(R);delete this._autoCloseTimer;}},autoClose:function F(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var R=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[R].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function M(R){A.call(this);this._super(R);},lockHover:function K(){N(this,true);if(!this._lockHoverCallback){var S=this.id,R=this._lockHoverCallback=function(T){mstrmojo.all[S]._unlockHoverCheck(T,self);};if((I.isIE7||I.isIE8)&&window.event&&(window.event.type==L)&&this.opener){this.opener._ignoreMousedown=true;}I.attachEvent(document.body,L,R,true);}},unlockHover:function E(){N(this,false);A.call(this);},_unlockHoverCheck:function J(T,R){var S=this.opener;if(S&&S._ignoreMousedown){delete S._ignoreMousedown;return ;}if(!I.contains(this.domNode,I.eventTarget(R,T),true,document.body)){this.close();}},open:function G(S,R){if(this.autoCloses){this.autoUnclose();}this._super(S,R);if(this.locksHover){this.lockHover();}},close:function Q(R){if(this.locksHover){this.unlockHover();}this._super(R);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=mstrmojo.dom;function E(J,I){var G=[];if(J){for(var F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function D(L,F,N){var I=N.hWin,J=N.e,G=A.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=A.ctrlKey(I,J),O=A.shiftKey(I,J);if(K||O){A.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}},premouseup:function C(H,K,G){var F=G.hWin,J=G.e,L=A.ctrlKey(F,J),I=A.shiftKey(F,J);if(L||I){A.clearBrowserHighlights(F);}},onadd:function B(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=E(K,G);for(var J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function B(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){for(var H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);for(var J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof (W)=="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget.apply(this,[]);}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children;for(var Y=0,W=(X&&X.length)||0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);for(var X=0,W=(Y&&Y.length)||0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props;for(var Z in Y){var X=Y[Z],W=X.ease;if(typeof (W)=="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props;for(var a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}else{return parseInt(W*Y,10)/W;}}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}else{if(X===0){return W;}else{return W+Z*I(X,Y);}}},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}else{return W+Z*Math.sin((Math.PI/2)*X/Y);}},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}else{return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}else{if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}else{if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}else{return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;}}}},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}else{return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=false,P=mstrmojo.dom,S=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(T){return false;},queryEnabled:function(T){return true;},queryVisible:function(T){return true;},executeCommand:function O(T){},item2textCss:function E(T){return T.cssClass||T.cmdId||("cmd"+T[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var Z=this._subMenu,X=this.getMenuPosition();if(!Z){var b=(this.menuZIndex||this.zIndex||10)+1,V={left:X.x+"px",top:X.y+"px",zIndex:b,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};Z=new mstrmojo.ContextMenu(V);Z.render();this._subMenu=Z;}else{Z.set("left",X.x+"px");Z.set("top",X.y+"px");}if(this.dynamicUpdate){var U=Z.ctxtBuilder.itemWidgets,W=U&&U.length,T,Y,a=this.getContextMenuSource();for(T=0;T<W;T++){Y=U[T];if(a.queryVisible){Y.set("visible",a.queryVisible(Y.data));}if(a.queryChecked){Y.set("checked",a.queryChecked(Y.data));}if(a.queryEnabled){Y.set("enabled",a.queryEnabled(Y.data));}}}Z.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var T=this._subMenu;if(T&&T.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function N(){var T=this._subMenu,W=this._subMenu.domNode,V=W.offsetHeight,U=W.offsetWidth,Z=P.windowDim(),Y=P.position(W,false),X=P.position(W,true);if((Y.x+U+S)>Z.w){T.set("left",(Z.w-U-S+(X.x-Y.x))+"px");}if((Y.y+V+S)>Z.h){T.set("top",(Z.h-V-S+(X.y-Y.y))+"px");}},attachMousedownEvent:function L(){var T=this;if(!this._close_handler){this._close_handler=function(){if(!T.isOnMySubmenu(P.eventTarget(self,arguments[0]))){T.closeMenuTree();}};}P.attachEvent(document.body,"mousedown",this._close_handler);},isOnMySubmenu:function M(X){var U=this._subMenu;if(!U){return false;}if(P.contains(U.domNode,X,true,document.body)){return true;}var Y=U.ctxtBuilder.itemWidgets,T=Y&&Y.length,W,V;for(W=0;W<T;W++){V=Y[W];if(V.isOnMySubmenu(X)){return true;}}return false;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function R(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var T=P.position(this.domNode,true);return{x:Math.round(T.x),y:Math.round(T.y+T.h)};},isSeparatorItem:function G(T){return T[this.itemIdField]===-1||T[this.itemField]==="-";},hasSubmenu:function K(T){return !!T[this.itemChildrenField];},closeMenuTree:function Q(V){var U=this.activeMenuItem,T=this._cmSource||this;if(!U){if(V){this.activeMenuItem=V;}else{T.hideContextMenu();}return ;}if(U===V){return ;}if(V){this.activeMenuItem=V;if(V.parent.parent===U){return ;}if(V.parent===U.parent){U.hideContextMenu();return ;}}else{V=T;this.activeMenuItem=null;}U.hideContextMenu();while(U!==T){U=U.parent.parent;if(U!==V||T===V){U.hideContextMenu();if(T===V){P.detachEvent(document.body,"mousedown",this._close_handler);}}if(U.parent===V.parent){break;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox={_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount==1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L!=null&&J in L){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners;for(var O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},scrollTo:function F(K){var J=this.scrollboxNode;if(J&&K){J.scrollLeft=K.x;J.scrollTop=K.y;}},scrollInterval:50,_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=(L)?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=(L)?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var R=mstrmojo.dom,P=mstrmojo.hash;var M=100;var E=R.supportsTouches?0.5:1;var F=1;var Q=100;var N={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var K=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[R.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[R.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[R.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[R.CSS3_TRANSITION]=this.decelerating?(R.CSS3_PREFIX+"transform 0.2s linear"):"";}},P.copy(N));var G=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},P.copy(N));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function L(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=P.copy(R.isSafari?K:G,P.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}R.attachEvent(U,R.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){R.detachEvent(T,R.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function I(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}R.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=R.getMousePosition(R.firstTouch(T,V),T);this.dragging=false;R.attachEvent(window,R.TOUCHMOVE,this._tmCallback);R.attachEvent(window,R.TOUCHEND,this._teCallback);},touchesMoved:function D(b,d){var Z=R.getMousePosition(R.firstTouch(b,d),b);R.preventDefault(b,d);if(!this.dragging){var T=5,h=Math.abs;if((this.scrollsHoriz&&h(Z.x-this.pos.x)>T)||(this.scrollsVert&&h(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},f={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=f;this.maxPos={x:Math.max(f.x-Y.x,0),y:Math.max(f.y-Y.y,0)};this.showScroll();}}if(this.dragging){R.stopPropogation(b,d);var c=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(c.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(c.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),g=this.lastDragTime;this.nextLastDragTime=g;this.lastDragTime=U;if((U-g)>Q){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function H(T,U){R.preventDefault(T,U);R.detachEvent(window,R.TOUCHMOVE,this._tmCallback);R.detachEvent(window,R.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;R.stopPropogation(T,U);if((new Date())-this.lastDragTime<=Q){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=R.getMousePosition(R.firstChangedTouch(Y,Z),Y),c=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-c.x,y:W.y-c.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),d=T?(new Date())-T:0,V={x:d?Number(b.x*M*E/d).toFixed(2):0,y:d?Number(b.y*M*E/d).toFixed(2):0};var a=this,U=function(f){return(a.scrollsHoriz&&Math.abs(f.x)>=F)||(a.scrollsVert&&Math.abs(f.y)>=F);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,M);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=(b)?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=(b)?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function J(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function O(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var B=false,D="mstrmojo.Binding",A="bindings",C=mstrmojo.registry;function E(K){for(var L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function F(K,M){if(!B){mstrmojo.requiresCls(D);B=true;}for(var N in K){var J=K[N];if(J==null){continue;}var L=typeof (J);if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=C.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function G(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[A]);if(K){delete this[A];this._set_bindings(A,K,true);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children;if(M){for(var L=0,J=M.length;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function I(){var J=this.bindings;if(J){E(J);delete this.bindings;}},_set_bindings:function H(L,J){var K=this[A];if(J!==K){if(K){E(K);}this[A]=J;if(J){F(J,this);}return true;}return false;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,f,V,X){var W=b,Z;while(Z=W.match(f)){var c=Z[0],a=c.length,d=true;c=c.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===c){d=false;break;}else{if(c.indexOf(Y)===0){delete U[Y];}}}if(d){U[c]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var d=S.evt2idx,h=S.idx2evt,Z=S.parts;var f=(U>=0)?U:0,b=this.id,W=mstrmojo.all,c=(U>0)?W[h[f-1].context][Z[f-1]]:(S.host?W[S.host]:this.parent),T=Z[f];var V=mstrmojo.array;while(c&&T){if(c.attachEventListener){var g=c[T+"_bindEvents"]||(T+"Change");if(typeof (g)=="string"){g=[g];}var Y=[];for(var a=0,X=g.length;a<X;a++){Y[a]=c.attachEventListener(g[a],b,"_callback");}for(var a=0;a<g.length;a++){d[c.id+"_"+g[a]]=f;}h[f]={context:c.id,evts:g,subs:Y};}c=c[T];T=S.parts[++f];}},_detachChain:function G(S,T){var U=mstrmojo.all,k=S.idx2evt,d=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=k.length;if(Y<b){for(;Y<b;Y++){var Z=k[Y];if(!Z){break;}var W=Z.context,c=U[W],h=Z.evts;if(c&&c.detachEventListener){var l=Z.subs;for(var g=0,V=l.length;g<V;g++){c.detachEventListener(l[g]);}}k[Y]=null;for(var X=0,f=h.length;X<f;X++){delete d[W+"_"+h[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo._HasPopup={openPopup:function B(G,D){var C=!!G&&(typeof (G)==="string")&&!G.match(/\./)&&!!this[G],I=mstrmojo.registry.ref(C?this[G]:G,true);if(I&&I.open){if(C){this[G]=I;}this.disposables.push(I);var F=I.slot&&this[I.slot];if(F){if(I.parent!==this){if(this.addChildren){this.addChildren(I);}else{var H=false,E=I.domNode||I.placeholder;if(E&&typeof (E)==="string"){E=document.getElementById(E);}if(!E){H=true;E=document.createElement("span");I.placeholder=E;}if(H||(E.parentNode!==F)){F.appendChild(E);}}}}I.open(this,D);this._lastOpened=I;}},closePopup:function A(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}};})();(function(){mstrmojo.requiresCls("mstrmojo.locales");var V=function(){return mstrmojo.locales.datetime;},J=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},isDate:function W(Z,d,Y){var b=this.parseDate(Z,Y);var c=!!(b&&this.doesDateExist(b.month,b.day,b.year));if(d){if(c){var a=this.formatDateInfo(b,V().DATEOUTPUTFORMAT);if(Y){return{match:b.match,formatted:a};}else{return a;}}else{return null;}}else{return !!c;}},formatDateInfo:function P(b,d){if(!d){return"";}var Y=b.day,c=b.month,a=b.year;var Z=d.replace(/dd/g,this.formatInteger(Y,2)).replace(/d/g,Number(Y)).replace(/yyyy/g,Number(a)).replace(/yy/g,this.formatInteger(Number(a)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,V().MONTHNAME_FULL[Number(c)-1]).replace(/\~\~\~\~/g,V().MONTHNAME_SHORT[Number(c)-1]).replace(/\@\@/g,this.formatInteger(c,2)).replace(/\^/g,Number(b.month));return Z;},parseDate:function X(k,d,h){if(k==null){return false;}if(typeof (k)!="string"){k=String(k);}k=J.trim(k);var Y=this.CACHE.PARSEDATE[d?"CONTAINS":"EQUALS"],a=Y[k];if(a||(a===null)){return a;}var Z=null;var g;if(h){g=[h];}else{g=[].concat(V().DATEINPUTFORMATS);g.unshift(V().DATEOUTPUTFORMAT);}for(var b=0,c=g.length;b<c;b++){var f=this._buildRegExp4DateFormat(g[b]),j=f&&k.match(d?f.reContains:f.reEquals);if(j){Z={match:j[0],year:f.yearIndex&&this.fourDigitYear(j[f.yearIndex]),day:f.dayIndex&&parseInt(Number(j[f.dayIndex])),month:f.monthIndex&&this.numericMonth(j[f.monthIndex])};break;}}Y[k]=Z;return Z;},isTime:function H(Z,c,Y){var d=this.parseTime(Z,Y);var b=!!(d&&this.doesTimeExist(d.hour,d.min,d.sec));if(c){if(b){var a=this.formatTimeInfo(d,V().TIMEOUTPUTFORMAT);if(Y){return{match:d.match,formatted:a};}else{return a;}}else{return null;}}else{return !!b;}},parseTime:function I(l,d,j){if(l==null){return false;}if(typeof (l)!="string"){l=String(l);}l=J.trim(l);var Y=this.CACHE.PARSETIME[d?"CONTAINS":"EQUALS"],a=Y[l];if(a||(a===null)){return a;}var Z=null;var h;if(j){h=[j];}else{h=[].concat(V().TIMEINPUTFORMATS);h.unshift(V().TIMEOUTPUTFORMAT);}for(var b=0,c=h.length;b<c;b++){var g=this._buildRegExp4TimeFormat(h[b]),k=g&&l.match(d?g.reContains:g.reEquals);if(k){var f=g.ampmIndex&&k[g.ampmIndex];Z={match:k[0],hour:g.hourIndex&&this.capitalHour(k[g.hourIndex],f),min:g.minIndex&&parseInt(Number(k[g.minIndex])),sec:g.secIndex&&parseInt(Number(k[g.secIndex]))};break;}}Y[l]=Z;return Z;},formatTimeInfo:function Q(b,Z){if(!Z){return"";}var a=!(Number(b.hour)%12)?12:(Number(b.hour)%12),Y=Z.replace(/HH/g,this.formatInteger(b.hour,2)).replace(/H/g,Number(b.hour)).replace(/hh/g,this.formatInteger(a,2)).replace(/h/g,a).replace(/mm/g,this.formatInteger(Number(b.min)||0,2)).replace(/m/g,Number(b.min)||0).replace(/ss/g,this.formatInteger(Number(b.sec)||0,2)).replace(/s/g,Number(b.sec)||0).replace(/a/g,(Number(b.hour)<12)?V().AM_NAME:V().PM_NAME);return Y;},doesTimeExist:function F(d,Z,c){var b=parseInt(d);if(b>=0&&b<=23){var Y=parseInt(Z);if(Y>=0&&Y<=59){if(!c){return true;}var a=parseInt(c);if(a>=0&&a<=59){return true;}}}return false;},capitalHour:function C(Y,Z){Y=parseInt(Number(Y));if(Z&&(Z.match(V().AM_NAME)||Z.match(/AM/i))){return Y%12;}else{if(Z&&(Z.match(V().PM_NAME)||Z.match(/PM/i))){return 12+(Y%12);}else{return Y;}}},isDateAndOrTime:function T(Y,Z){return this.isDateTime(Y,Z)||this.isDate(Y,Z)||this.isTime(Y,Z);},isDateTime:function B(i,Y){var c=this.parseDateAndOrTime(i),g=c&&c.date,b=c&&c.time,f=!!g&&!!b&&this.doesDateExist(g.month,g.day,g.year)&&this.doesTimeExist(b.hour,b.min,b.sec);if(Y){if(f){var Z=this.formatDateInfo(g,V().DATEOUTPUTFORMAT),a=this.formatTimeInfo(b,V().TIMEOUTPUTFORMAT),h=i.indexOf(g.match),d=i.indexOf(b.match);return(d<h)?a+" "+Z:Z+" "+a;}else{return null;}}else{return !!f;}},parseDateAndOrTime:function O(Z,Y,d){var a=this.parseDate(Z,true,Y);var b=J.trim((a&&a.match)?Z.replace(a.match,""):Z),c=this.parseTime(b,false,d);if(!a&&!c){return null;}else{return{date:a,time:c};}},inDateTimeRange:function N(a,c,g){var Z=this.parseDateAndOrTime(a),d=Z&&Z.date,h=Z&&Z.time;if(!d&&!h){return 0;}if(c!=null){var b=this.parseDateAndOrTime(c);if(d&&b&&b.date){var i=this.compareDate(d,b.date);if(i<0){return -1;}else{if(i==0){if(h&&b.time&&(this.compareTime(h,b.time)<0)){return -1;}}}}}if(g!=null){var Y=this.parseDateAndOrTime(g);if(d&&Y&&Y.date){var f=this.compareDate(d,Y.date);if(f>0){return 1;}else{if(f==0){if(h&&Y.time&&(this.compareTime(h,Y.time)>0)){return 1;}}}}}return 0;},compareDate:function A(a,Y){if(a==Y){return 0;}var b=typeof (a)=="string"?this.parseDate(a):a,Z=typeof (Y)=="string"?this.parseDate(Y):Y;if(!b){return -1;}if(!Z){return 1;}return(b.year-Z.year)||(b.month-Z.month)||(b.day-Z.day)||0;},compareTime:function K(Z,Y){if(Z==Y){return 0;}var b=typeof (Z)=="string"?this.parseTime(Z):Z,a=typeof (Y)=="string"?this.parseTime(Y):Y;if(!b){return -1;}if(!a){return 1;}return(b.hour-a.hour)||(b.min-a.min)||(b.sec-a.sec)||0;},compareDateTime:function S(Z,Y){return this.compareDate(Z,Y)||this.compareTime(Z,Y);},compareDateAndOrTime:function D(g,d){if(g==d){return 0;}var Z=typeof (g)=="string"?this.parseDateAndOrTime(g):g,Y=typeof (d)=="string"?this.parseDateAndOrTime(d):d;if(!Z){return -1;}if(!Y){return 1;}var f=Z.date,c=Y.date,b=Z.time,a=Y.time;return this.compareDate(f,c)||this.compareTime(b,a);},_buildRegExp4DateFormat:function M(a){if(!a){return null;}var c=this.REGEXPS.DATES[a];if(!c){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=V().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=V().MONTHNAME_SHORT.join("|");}c=this.REGEXPS.DATES[a]={};c.formatStr=a;var Z=c.reStr=a.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");c.reEquals=new RegExp("^"+Z+"$");c.reContains=new RegExp("^"+Z+"\\b");var d=[{key:"monthIndex",index:a.indexOf("M")},{key:"dayIndex",index:a.indexOf("d")},{key:"yearIndex",index:a.indexOf("y")}];d.sort(function(g,f){return g.index-f.index;});var Y=1;for(var b=0;b<3;b++){c[d[b].key]=d[b].index>-1?Y++:null;}}return c;},_buildRegExp4TimeFormat:function E(b){if(!b){return null;}var d=this.REGEXPS.TIMES[b];if(!d){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[V().AM_NAME,V().PM_NAME,String(V().AM_NAME).toLowerCase(),String(V().PM_NAME).toLowerCase()].join("|");}d=this.REGEXPS.TIMES[b]={};d.formatStr=b;var a=b.replace(/\'\'/g,'"');var f=a.match(/\'(.+?)\'/g);a.replace(/\'(.+?)\'/g,"*");a=a.replace(/([^H|h|m|s|z|Z|a|\s])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/gi,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");for(var c=1,Y=f&&f.length||0;c<Y;c++){a=a.replace(/\*/,f[c]);}a=a.replace(/\"/g,"'");d.reEquals=new RegExp("^"+a+"$");d.reContains=new RegExp(a);var g=[{key:"hourIndex",index:b.search(/h|H/)},{key:"minIndex",index:b.indexOf("m")},{key:"secIndex",index:b.indexOf("s")},{key:"ampmIndex",index:b.indexOf("a")},{key:"zoneIndex",index:b.search(/z|Z/)}];g.sort(function(i,h){return i.index-h.index;});var Z=1;for(var c=0;c<5;c++){d[g[c].key]=g[c].index>-1?Z++:null;}}return d;},doesDateExist:function L(b,Y,Z){var a=new Date(Z,b-1,Y);return Z==a.getFullYear()&&b==a.getMonth()+1&&Y==a.getDate();},fourDigitYear:function R(Z){Z=parseInt(Number(Z));if(!isNaN(Z)){var Y=(V().TWODIGITYEARSTART%100)||0;if(Z>=0&&Z<=Y){Z=2000+Z;}else{if(Z>Y&&Z<100){Z=1900+Z;}}}return Z;},numericMonth:function U(c){var b=parseInt(Number(c)),a=mstrmojo.array;if(!isNaN(b)){return b;}var Y=c&&c.length||0,Z=-1;if(Y){if(Y<=3){Z=a.indexOf(V().MONTHNAME_SHORT,c);}if(Z==-1){Z=a.indexOf(V().MONTHNAME_FULL,c);}}return Z+1;},formatInteger:function G(a,Z){var d=String(a),c=Math.max(Z-d.length,0);if(c>0){var Y=[d];for(var b=1;b<=c;b++){Y.push("0");}d=Y.reverse().join("");}return d;},getFirstDateOfMonth:function(Z,Y){return new Date(Z,Y-1,1);},getDateObject:function(f,Y,c,a,b,Z){f=f||0;Y=Y||1;c=c||1;a=a||0;b=b||0;Z=Z||0;return new Date(f,Y-1,c,a,b,Z);},getDateFromDateInfo:function(Y){return this.getDateObject(Y.date&&Y.date.year,Y.date&&Y.date.month,Y.date&&Y.date.day,Y.time&&Y.time.hour,Y.time&&Y.time.min,Y.time&&Y.time.sec);},getDateJson:function(Y){return{year:Y.getFullYear(),month:Y.getMonth()+1,day:Y.getDate(),hour:Y.getHours(),min:Y.getMinutes(),sec:Y.getSeconds()};},isLeapYear:function(Y){return !(Y%400)||(!(Y%4)&&!!(Y%100));},getDaysOfMonth:function(a,Y){var Z=[31,28,31,30,31,30,31,31,30,31,30,31];if(Y==2&&this.isLeapYear(a)){return 29;}return Z[Y-1];},getPreMonth:function(Z,Y){if(Y===1){return{y:Z-1,m:12};}return{y:Z,m:Y-1};},getNextMonth:function(Z,Y){if(Y===12){return{y:Z+1,m:1};}return{y:Z,m:Y+1};}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function A(E,H,D){var C=D.hWin,G=D.e,F=mstrmojo.dom.eventTarget(C,G),B=E.listMapper.findIndex(E,H,F);if(B>-1){E.toggleSelect(B);}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom,B=A.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function C(E,I,D){var G=E&&E.tree||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var E=mstrmojo.hash,H=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=E.clone(I);O.data=M;O.parent=N;return H.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length);for(var N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L;for(var O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}for(var M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var H=mstrmojo.registry,C=mstrmojo.array,K=mstrmojo.publisher;function M(O,P){if(P){P.parent=O;return H.ref(P);}return null;}function J(O,P){if(P&&P.alias!=null){O[P.alias]=P;}}function D(P,Q){var O=Q.alias;if(Q.parent===P){delete Q.parent;}if((O!=null)&&(P[O]===Q)){delete P[O];}}function E(S,P){var O=P&&P.length,R,Q;if(O){R=[];for(Q=0;Q<O;Q++){var T=M(S,P[Q]);if(!T){continue;}R.push(T);J(S,T);}}return R;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,initChildren:function I(){var O="children",P=this[O];if(!P){return ;}this[O]=null;this._set_children(O,P,true);if(this.postCreateChildren){this.postCreateChildren();}},_set_children:function A(R,P,O){var Q=this.children;if(P!==Q){if(Q){this.removeChildren(null,O);}this.addChildren(P,0,O);}return false;},destroyChildren:function N(R){var Q=this.children,O=(Q&&Q.length)||0,P;if(O){for(P=O-1;P>-1;P--){var S=Q[P];if(S&&S.destroy){S.destroy(R);if(!R){D(this,S);}}}if(!R){Q.length=0;}}},invalidateChildren:function F(){mstrmojo.array.forEach(this.children,function(O){O.invalidate();});},invalidate:function L(){this.invalidateChildren();},addChildren:function G(T,P,Q){if(!T){return T;}var S=T.constructor===Array,O=E(this,S?T:[T]);if(O&&O.length){var R=this.children||[];if(P==null){P=R.length;}this.children=C.insert(R,P,O);if(!Q&&(this.onaddChild||K.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:O,index:P});}}return S?O:(O&&O[0]);},removeChildren:function B(U,Q){var S=this.children,T=U?[U]:(this.children||[]).concat(),P=T.length,O=-1,R;if(P){for(R=P-1;R>-1;R--){D(this,T[R]);}if(U){O=C.removeItem(S,U);}else{if(S){S.length=0;O=0;}}if(!Q&&(this.onremoveChild||K.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:T,index:O});}}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;if(this.preHandleEvent){this.preHandleEvent(H);}var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){if(this.postHandleEvent){this.postHandleEvent(H);}C.publish(this.id,M,H);}return H;},attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,J="mstrmojo-itemwrap",I="&nbsp;",S=mstrmojo.array;function F(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}else{if(X===V){break;}}Y=X;X=Y.parentNode;}}return null;}function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=S.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;}function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function L(l,Z,k,o,W,c,q,n){if(!Z){return{start:0,end:0};}var f=this.wrapperNodes(l),j=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,g=k+o,d=f[0].offsetTop,b;for(var m=1;m<=Y;m++){b=f[j].offsetTop-d+n;if(b<k){X=j;}else{if(b>g){V=j;}}var a=Math.round(Z/Math.pow(2,m+1));j+=(b>k)?-a:a;j=Math.min(Math.max(0,j),Z-1);}return{start:X,end:V};},findWrapper:function K(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function E(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function R(c,V,X,b,W){var Y=this._nd2iw(c,V,X),d,a,f;if(Y){a=this._iw2idx(c,V,Y);d=a;f=this.itemOffsetTop(c,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+f+Z/2){d++;f+=Z;}}else{return c.dropCuePos;}return{left:0,top:f,idx:d,idxActual:a};},getWrapperCss:function(V){return J;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function O(f,b,i,d,a,l){var m=this.itemWrapperPrefix(i),h=this.itemWrapperSuffix,Z=m+this.itemWrapperPrefill+h,Y=[this.markupPrefix],W=1,V=i.selectedIndices||{},o=function n(k,j){for(var p=k;p<j;p++){Y[W++]=m;var q=b.build(i,d,f[p],p);if(V[p]){q=q.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=q;Y[W++]=h;}};var c=(f&&f.length)||0;a=a&&b?Math.min(a,c):0;if(a){o(0,a);}l=l&&b?Math.min(l,c-a):0;var g=c-l;for(var X=a;X<g;X++){Y[W++]=Z;}if(l){o(g,c);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,h,d,n,g,W,b,m){var f=(h&&h.length)||0,l=this.wrapperNodes(X),o=g.itemStatus,V=mstrmojo.css,Z=n.selectedIndices||{};for(var c=W,j=Math.min(b+1,f),a=0;c<j;c++){if(o[c]!==A){l[c].innerHTML=d.build(n,g,h[c],c);if(Z[c]){var Y=l[c].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===m){break;}}}return a;},onadd:function N(f,V,Z,g){if(V&&g){var a=g.value.length,b=this.wrapperNodes(V),d=b[g.index],Y=this.getWrapperCss(f);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=I;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(f,this);}},onremove:function P(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function Q(h,X,c,l){if(X&&l){var d=this.wrapperNodes(X);if(d){var W=mstrmojo.css,m=c.itemStatus,k;for(var b=0,V=l.removed,g=V&&V.length;b<g;b++){k=V[b];if(m[k]){W.removeClass(d[k].firstChild,["selected"]);}}for(var Z=0,f=l.added,Y=f&&f.length;Z<Y;Z++){k=f[Z];if(m[k]){W.addClass(d[k].firstChild,["selected"]);}}}}},_nd2iw:F,_iw2idx:M,toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,f=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=f.clientHeight,d=f.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}f.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var G=mstrmojo.hash,A=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",init:function E(H){this.disposables=[];G.copy(H,this);if(this.postApplyProperties){this.postApplyProperties();}A.add(this);if(this.postCreate){this.postCreate();}},destroy:function B(H){this._super(H);F.forEach(this.disposables,function(I){if(I.destroy){I.destroy(H);}else{if(I.clear){I.clear();}}});this.disposables=[];A.remove(this);}});var C=mstrmojo.Obj;C.free=function D(H){if(H instanceof C){H.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip");var B=mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",init:function A(D){this._super(D);var E=this.parent;if(!E||E.hasInitBindings){this.initBindings();}},destroy:function C(D){if(this.hasRendered){this.unrender(D);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn});B.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};B.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};B.heightMarkupMethod=function(){this.domNode.style.height=this.height||"";};B.widthMarkupMethod=function(){this.domNode.style.width=this.width||"";};}());(function(){mstrmojo.requiresCls("mstrmojo.DI.DIConstants");var B=mstrmojo.DI.DIConstants;function A(G){switch(G){case B.dataType.decimal:case B.dataType.dtdouble:case B.dataType.dtfloat:case B.dataType.integer:case B.dataType.dtlong:case B.dataType.numeric:case B.dataType.real:case B.dataType.dtshort:case B.dataType.unsigned:return B.baseFormType.number;case B.dataType.dtchar:case B.dataType.varChar:case B.dataType.MBChar:case B.dataType.varChar:case B.dataType.nVarChar:case B.dataType.nChar:return B.baseFormType.dttext;case B.dataType.timeStamp:return B.baseFormType.dtdateTime;case B.dataType.date:return B.baseFormType.date;case B.dataType.dttime:return B.baseFormType.dttime;case B.dataType.binary:case B.dataType.varBin:case B.dataType.varBin:case B.dataType.reserved:case B.dataType.Dunknown:return B.baseFormType.number;case B.dataType.bigDecimal:return B.baseFormType.bigDecimal;default:return B.baseFormType.Dnumber;}}mstrmojo.DI.ImportSource=mstrmojo.declare(mstrmojo.Obj,null,{type:-1,subtype:-1,key:"",currentIndex:-1,previews:{},mappings:{},originalMappings:{},sourceInfo:null,sheets:null,transformations:null,currentPreview:null,currentMapping:null,reset:function(){this.currentIndex=-1;this.previews={};this.mappings={};this.originalMappings={};this.sourceInfo=null;this.transformations=null;this.sheets=null;this.currentPreview=null;this.currentMapping=null;},hasFetchedPreview:function(G){if(G===undefined){G=0;}if(!this.previews[G]){return false;}return true;},selectSheet:function(G){if(G===undefined){G=0;}this.set("currentIndex",G);this.currentPreview=this.previews[this.currentIndex];this.currentMapping=this.mappings[this.currentIndex];},init:function(I,G,H){this.type=I;this.subtype=G;this.key=H;},populate:function(H,G,I){if(this.sourceInfo.sheetIndex>=0){this.currentIndex=this.sourceInfo.sheetIndex;}else{this.currentIndex=0;}if((G&B.requestFlag.mapping)===B.requestFlag.mapping){this.populateMappings(H.datap.maps,this.currentIndex);this.currentMapping=this.mappings[this.currentIndex];}if((G&B.requestFlag.preview)===B.requestFlag.preview){this.populatePreview(H.datap.data,this.currentIndex);this.currentPreview=this.previews[this.currentIndex];}if((G&B.requestFlag.sheets)===B.requestFlag.sheets){this.populateSheets(H.datap.shts);}},getMappingChanges:function(){var H=this.currentMapping;var N=this.originalMappings[this.currentIndex];var G=[],K,J,L,I,M;for(J=0;J<H.length-1;J++){L=H[J];I=N[J];K={did:L.did};M=false;if(L.alias!==I.alias){K.alias=L.alias.replace(/[<]/g,"&lt;");M=true;}if(L.tp!==I.tp){K.ot=L.tp;M=true;}if(L.dtp!==I.dtp){K.bft=L.dtp;M=true;}if(L.selected!==I.selected){K.cmf=(L.selected?1:0);M=true;}if(M){G.push(mstrmojo.hash.copy(K));}}return G;},getMissingColumns:function E(){var J=this.currentMapping;var G=null;var I,H;if(J){for(H=0;H<J.length;H++){I=J[H];if((I.columnState&B.columnState.missing)===B.columnState.missing){if(!G){G=[];}G.push(I);}}}return G;},populatePreview:function D(I,O){if(!I.length){return ;}var L=I.length;var N=I[0].dvs.length;var K=[];var G=[];var J,H;for(J=0;J<L;J++){G.push(I[J].dcns.cln);}for(H=0;H<N;H++){K[H]=[];for(J=0;J<L;J++){K[H].push(I[J].dvs[H]);}}for(H=N;H<50;H++){K[H]=[];for(J=0;J<L;J++){K[H].push("");}}var M=this.previews[O];if(!M){M=new mstrmojo.Obj();}M.set("chs",G);M.set("data",K);M.set("hasNewHeaders",false);M.set("ignoredRows",0);this.previews[O]=M;},populateMappings:function C(P,U){var T=P.amps,R=P.mtmps;var K,I,M,S,J,L;var H=[];for(K=0,M=T.length;K<M;K++){var N=T[K],Q=N.aimp,O=N.afmps;S=O[0].col.oi;I={did:S.did,alias:Q.atnm,n:S.def.cln,isNew:false,columnState:S.def.dicl.ups,selected:(S.def.dicl.ups==2),dtp:A(S.def.dt.tp),ix:S.def.dicl.clix,tp:12,timeArr:[],georole:0,geoattrs:{0:false,1:false,2:false}};for(J=0,L=O.length;J<L;J++){I.afid=Q.atid+O[J].fmid;I.fmn=O[J].fmn;}H.push(I);}for(K=0,M=R.length;K<M;K++){var G=R[K];S=G.col.oi;I={did:S.did,alias:G.mtn,n:S.def.cln,isNew:false,columnState:S.def.dicl.ups,selected:(S.def.dicl.ups==2),dtp:A(S.def.dt.tp),ix:S.def.dicl.clix,tp:4,timeArr:[],georole:0,geoattrs:{0:false,1:false,2:false}};H.push(I);}H.sort(function(W,V){return W.ix-V.ix;});if(H.length>0){this.mappings[U]=H;this.originalMappings[U]=mstrmojo.hash.clone(H);}},populateSheets:function F(I){var H;var G=[];if(I){for(H=0;H<I.length;H++){if(I[H]!=="*"){G.push({index:H,name:I[H]});}}this.set("sheets",G);}}});}());(function(){mstrmojo.DI.OAuthSource=mstrmojo.declare(mstrmojo.Obj,null,{accessToken:"",clientId:"",clientSecret:"",redirectUrl:"",authUrl:"",refreshToken:"",revokeUrl:"",scope:"",sourceType:-1,state:"",getAuthorizationPostData:function(A){return"code="+A+"&grant_type=authorization_code&client_id="+this.clientId+"&client_secret="+this.clientSecret+"&redirect_uri="+this.redirectUrl;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.DI.OAuthSource");var B=function C(I,K){var J={taskId:"qBuilder.FetchSourceObjects",accessToken:I.oAuth.accessToken,flags:7,instanceURL:I.instanceUrl,refreshToken:I.oAuth.refreshToken,userDisplayName:I.userDisplayName,sessionState:mstrApp.sessionState};var H={success:function(L){K.success(L);},failure:function(L){K.failure(L);}};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,H,J);};var A=function G(I,K){var J={taskId:"flashProxyLoader",headerRequest:"Authorization=OAuth "+I.oAuth.accessToken,postData:I.oAuth.getAuthorizationPostData(I.code),sessionState:mstrApp.sessionState,url:"https://login.salesforce.com/services/oauth2/token"};var H={success:function(L){I.idUrl=L.id;I.instanceUrl=L.instance_url;I.signature=L.signature;I.oAuth.refreshToken=L.refresh_token;I.oAuth.accessToken=L.access_token;F(I,K);},failure:function(L){K.failure(L);}};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,H,J);};var F=function E(I,K){var J={taskId:"flashProxyLoader",headerRequest:"Authorization=OAuth "+I.oAuth.accessToken,sessionState:mstrApp.sessionState,url:I.idUrl};var H={success:function(L){I.userIdentity=L.id;I.userDisplayName=L.display_name;B(I,K);},failure:function(L){K.failure(L);}};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,H,J);};var D=new mstrmojo.DI.OAuthSource({});mstrmojo.DI.SalesforceModel=mstrmojo.declare(mstrmojo.Obj,null,{id:"SalesforceModel",code:"",idUrl:"",instanceUrl:"",oAuth:D,signature:"",userDisplayName:"",userIdentity:"",getReports:function C(H){A(this,H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo._HasChildren");var F=mstrmojo.publisher;mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",init:function I(L){this._super(L);if(this.children){this.initChildren();}var M=this.parent;if(!M||M.hasInitBindings){this.initBindings();}},destroy:function G(L){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(L);},unrender:function J(N){var O=this.children,L=(O&&O.length)||0,M;for(M=L-1;M>-1;M--){O[M].unrender(true);}this._super(N);},postBuildRendering:function K(){var L=this._super?this._super():undefined;if(L!==false){this.renderChildren();L=true;}return L;},renderChildren:function C(){var N=this.children,L=(N&&N.length)||0,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render(null);}}},childRenderCheck:function H(M){if(M&&!M.hasRendered){var L=M.slot||this.defaultChildSlot;return !!this[L];}return false;},addChildren:function E(O,M,N){var L=this._super(O,M,N);if(L){this.childRenderOnAddCheck(L);}return L;},removeChildren:function A(S,O){var R=S?[S]:(this.children||[]),L=R.length,P;for(P=L-1;P>-1;P--){var N=R[P],M=N&&N.domNode;if(M){var Q=this[(N.slot||this.defaultChildSlot)];if(M.parentNode===Q){Q.removeChild(M);}}}return this._super(S,O);},childRenderOnAddCheck:function B(N){if(this.hasRendered&&N){var L=N.length,M;for(M=0;M<L;M++){var O=N[M];if(this.childRenderCheck(O)){O.render();}else{if(O&&O.hasRendered){this.onchildRenderingChange(O);}}}}},preserveChildDomOrder:true,onchildRenderingChange:function D(M){var T=M&&M.domNode;if(!T){return ;}var N=this.defaultChildSlot,W=M.slot||N,O=this[W],L=this.children;if(!O){if(T.parentNode){T.parentNode.removeChild(T);}}else{if(T.parentNode===O){return ;}if(!this.preserveChildDomOrder){O.appendChild(T);}else{var P,R;for(R=L.length-1;R>=0;R--){var U=L[R];if(U===M){break;}if(W===(U.slot||N)){var V=U.domNode;if(V&&V.parentNode===O){P=V;}}}if(P){O.insertBefore(T,P);}else{O.appendChild(T);}}}if(F.hasSubs(this.id,"childrenRendered")){var S=L.length,Q;for(Q=0;Q<S;Q++){if(!L[Q].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var P=mstrmojo.dom,B=mstrmojo.css,M=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var U=document.createElement("tr"),V=this.data,Y=this._cmSource,R,S;U.id=this.id;U.className="mstrmojo-ContextMenuItem "+(Y.isSeparatorItem(V)?"separator":Y.item2textCss(V));var W=this,X=function(){W.handleMouseOver();},T=function(){W.handleMouseOut();},Q=function(){W.handleClick();};P.attachEvent(U,"mouseover",X);P.attachEvent(U,"mouseout",T);P.attachEvent(U,"click",Q);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-text";if(Y.isSeparatorItem(V)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=V.itemWidget?"&nbsp":V[this.itemField];}R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return U;},buildRendering:function K(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){B.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){B.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=P.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function C(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function E(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function L(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function O(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,T=this._subMenu.domNode,S=T.offsetHeight,R=T.offsetWidth,W=P.windowDim(),V=P.position(T,false),U=P.position(T,true);if((V.x+R+M)>W.w){Q.set("left",(P.position(this.domNode,true).x-R)+"px");}if((V.y+S+M)>W.h){Q.set("top",(W.h-S-M+(U.y-V.y))+"px");}},handleMouseOver:function N(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function D(){this._cmSource.closeMenuTree();},handleClick:function F(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}else{}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.FileUploadBox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.FileUploadBox",value:"",params:null,action:"taskProc",uploadTaskId:"uploadFile",browseLabel:"Browse...",fileFieldName:"myfile",multiple:"",status:"init",jsonp:"parent.mstrmojo.all.{@id}.uploadCallback(@R@)",markupString:'<div id={@id} class="mstrmojo-FileUploadBox {@cssClass}" style="{@cssText}"><form class="mstrmojo-FileUploadBox-form" target="{@id}_iframe" enctype="multipart/form-data" method="post" action="{@action}"><input class="mstrmojo-FileUploadBox-input" readonly="readonly" type="text" size="30"/><div class="mstrmojo-FileUploadBox-buttonDiv"><div class="mstrmojo-FileUploadBox-button">{@browseLabel}</div><input class="mstrmojo-FileUploadBox-file" type="file" {@multiple} size="30" style="font-size:4em;" name="{@fileFieldName}" onchange="mstrmojo.all.{@id}.synValue();"/></div><div style="display:none;"></div></form><iframe id="{@id}_iframe" + name="{@id}_iframe" style="display:none;" src="about:blank"></iframe></div>',markupSlots:{formNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},buttonNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},fileNode:function(){return this.domNode.firstChild.childNodes[1].lastChild;},paramsNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onstatusChange:function(){if(this.status==="init"){this.inputNode.value="";this.fileNode.value="";this.paramsNode.innerHTML="";}},onvalueChange:function(){this.inputNode.value=this.value;}},uploadCallback:function(B){var A=(B.status==200);this.set("status",A?"successful":"failed");if(A&&this.onSuccess){this.onSuccess(B);}if(!A&&this.onFailed){this.onFailed(B);}},synValue:function(){var B=this.fileNode.value,A=B.split(/[\/\\]/);B=A[A.length-1];this.set("value",B);},submit:function(E,C){var B=true;if(this.onsubmit){B=this.onsubmit();}if(B){E=E||{};E.fileFieldName=this.fileFieldName;E.taskEnv="jsonp2";E.taskId=this.uploadTaskId;E.jsonp=this.jsonp.replace("{@id}",this.id);var A=[],D;for(D in E){A.push('<input type="hidden" name="'+D+'" value="'+mstrmojo.string.encodeHtmlString(E[D])+'"/>');}if(this.params){E=this.params;for(D in E){A.push('<input type="hidden" name="'+D+'" value="'+mstrmojo.string.encodeHtmlString(E[D])+'"/>');}}this.paramsNode.innerHTML=A.join("");if(C){this.onSuccess=C.success;this.onFailed=C.failure;}this.formNode.submit();this.set("status","loading");}},reset:function(){this.set("status","init");}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var D=mstrmojo.dom,E=mstrmojo.hash,B=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){B[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){B[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.textNode.innerHTML=this.text;},onwidthChange:function(){var F=this.width;if(F){this.domNode.style.width=F;}}},oniconClassChange:function C(G){if(this.hasRendered&&this.domNode){var F=G.valueWas,H=G.value;this.domNode.className=this.domNode.className.replace(F,"")+" "+H;}},onclick:mstrmojo.emptyFn,ontouchend:function A(F){this.onclick(F);}});mstrmojo.Button.newIconButton=function(H,K,I,F,J){var G={scriptClass:"mstrmojo.Button",title:H,cssClass:K,text:"",onclick:I};if(F){G.bindings=F;}E.copy(J,G);return G;};mstrmojo.Button.newInteractiveButton=function(G,H,J,I){var F={scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",text:G,glowClass:"glow"};if(H){F.onclick=H;}if(J&&(D.isFF||D.isWK)){E.copy({onmousedown:function(){B.applyShadow(this.domNode,0,0,10,J);},onmouseup:function(){B.removeShadow(this.domNode);}},F);}E.copy(I,F);return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click /><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",text:null,markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" mstrAttach:click></div>',cssDisplay:"block",markupMethods:{ontextChange:function(){this.domNode.innerHTML=(this.text!=null)?this.text:"";},oncssTextChange:function(){this.domNode.style.cssText=(this.cssText!=null)?this.cssText:"";},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},autoHide:false,_set_text:function A(D,B){if(this.autoHide){this.set("visible",(B!=null)&&(B!==""));}var C=this.text;this.text=B;return C!=B;}});})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var Z=mstrmojo.hash,f=mstrmojo.array,d=mstrmojo.boxmodel,b=mstrmojo.dom;function A(i,k,h){var j=i.listSelector;if(j){j[k](i,i.itemsContainerNode,h);}}function K(i,h){var j=i.lastPagePos;if(!j||j.dragId!==h){j=d.offset(i.itemsContainerNode);j.dragId=h;i.lastPagePos=j;var k=i.scrollboxNode;i.lastScrollPos={left:k.scrollLeft,top:k.scrollTop,width:k.clientWidth,height:k.clientHeight};}}function N(k,n,i){var j=n&&n.node;if(j===k.dropCueNode||j===k.dropCueNode.firstChild){return k.dropCuePos;}var l=k.listMapper;var h=l&&l.whereDrop(k,k.itemsContainerNode,j,n.pos,{left:k.lastPagePos.left-k.lastScrollPos.left,top:k.lastPagePos.top-k.lastScrollPos.top,width:k.lastScrollPos.width,height:k.lastScrollPos.height});var m=k.dropCuePos;return((i!==false)&&m&&h&&(m.idx===h.idx)&&(m.left===h.left)&&(m.top===h.top))?m:h;}var g="attachEventListener";function C(i,h){if(i.makeObservable){h=h||[];if(!h[g]){mstrmojo.hash.make(h,i.itemsScriptClass||mstrmojo.Arr);}}return h;}function G(i,h){if(h&&h[g]){i._sub_its=h;i._sub_add=h[g]("add",i.id,"preadd");i._sub_rmv=h[g]("remove",i.id,"preremove");}}function F(h){if(h._sub_its){var i=mstrmojo.publisher;i.unsubscribe(h._sub_add);i.unsubscribe(h._sub_rmv);delete h._sub_add;delete h._sub_rmv;delete h._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var i=this.dropCueNode,h=i&&i.style;if(!h){return ;}var k=this.dropCuePos,j=!!k;if(j){h.left=k.left+"px";h.top=k.top+"px";}h.display=j?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Y(m){this._super(m);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,n=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||n){this.initSelections(l,j,k,n);}if(this.postInitItems){this.postInitItems();}},initItems:function H(h){return C(this,h);},preBuildRendering:function V(){var l=this.listBuilder,o=l.newContext(this);this.ctxtBuilder=o;var i=this.markupSlots,k=!!(this.renderOnScroll&&this.renderBlockSize&&i&&i.scrollboxNode),j=this.items,h=(j&&j.length)||0,m=k?this.firstRenderBlockSize:h,n=k?this.firstRenderBlockSize:0;this._eros=k;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(j,l,this,o,m,n).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function D(){delete this.itemsHtml;var m=this.listMapper;if(m&&m.postBuildRendering){m.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}G(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var p=this.id;this._cb_scroll=function(){var i=mstrmojo.all[p];i.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var k=0,j=["itemsEffect","scrollEffect"],h=j.length;k<h;k++){var o=j[k],l=this[o];if(l&&l.constructor===Object){l=mstrmojo.insert(mstrmojo.hash.clone(l));l.widget=this;this[o]=l;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function W(l){F(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var j=0,k=["itemsEffect","scrollEffect"],h=k.length;j<h;j++){var m=this[k[j]];if(m&&m.isPlaying){m.cancel();}}this._super(l);},pauseScrollRendering:function O(j,h,i){if(j!==false){j=true;}if(this.paused===!!j){return ;}this.paused=!!j;if(j){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(h,i);}},onscroll:function J(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var h=this;this._fillTmr=self.setTimeout(function(){h.fill();h=null;},50);}}if(this._super){this._super();}},fill:function a(h,l){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var m=(this.items&&this.items.length)||0;if(!m){if(l){l();}}else{var j=this.scrollboxNode,n=this.itemsContainerNode,k=mstrmojo.boxmodel.offset(n,j),p=this.listMapper,o=p.findScrollRange(n,m,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||j.scrollTop,j.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||j.scrollLeft,j.clientWidth,k.left,k.top);if(this.fillAt(o.start,o.end)){if(h){h();}var i=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[i].fill(h,l);},100);}else{if(l){l();}}}},fillAt:function L(j,i){var h=this.listMapper;if(h){return h.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,j,i,this.renderBlockSize);}else{return false;}},add:function Q(i,h){if(!i||!i.length){return -1;}var j=this.items;if(h==null){h=Z.min(this.selectedIndices,false,true);if(h!==null&&h!==undefined){h++;}}if(h==null||h===-1){h=(j&&j.length)||0;}if(j&&j.add){j.add(i,h);}else{this.set("items",j?f.insert(j.concat(),h,i):i);}return h;},preadd:function B(k){if(this.hasRendered){var n=this.listMapper;if(n){n.onadd(this,this.itemsContainerNode,this.ctxtBuilder,k);}var m=this.listBuilder;if(m){m.onadd(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onadd(this,k);}if(this._eros){this.onscroll();}else{var l=k.index,h=k.value.length;this.fillAt(l,l+h-1);}}if(this.onadd){this.onadd(k);}if(this._super){this._super(k);}},remove:function T(h){if(h==null){return -1;}if(h.constructor!==Array){return this._remove(h);}var k=this.items;if(k){var j;if(k.remove){for(j=h.length-1;j>-1;j--){k.remove(h[j],1);}}else{k=k.concat();for(j=h.length-1;j>-1;j--){k.splice(h[j],1);}this.set("items",k);}return h[0];}return -1;},_remove:function T(j){var i=this.items;if(!i||(j==null)){return -1;}var h;if(!isNaN(j)){h=j;}else{h=this.itemIndex(j);}if(h>-1){if(i.remove){i.remove(h,1);}else{i=i.concat();i.splice(h,1);this.set("items",i);}}return h;},duplicate:function X(m,i,j){var k=this.items,h=-1;if(!k||(m==null)){return -1;}if(!isNaN(m)){if(i===null||i===undefined){i=m+1;}m=k[m];}else{if(i===null||i===undefined){i=this.itemIndex(m)+1;}}if(m){var l;l=Z.copy(j,Z.clone(m));h=this.add([l],i);}return h;},preremove:function M(i){if(this.hasRendered){var k=this.listMapper;if(k){k.onremove(this,this.itemsContainerNode,this.ctxtBuilder,i);}var j=this.listBuilder;if(j){j.onremove(this,this.ctxtBuilder,i);}var h=this.listSelector;if(h){h.onremove(this,i);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(i);}if(this._super){this._super(i);}},move:function R(l,q){function o(r,i){return(q>=r)&&(q<=r+i);}var p=(this.items&&this.items.length)||0;if(q===-1||q==null||isNaN(q)){q=p;}else{q=Math.min(q,p);}var k,h,n,m;if(l.constructor===Array){h=l;n=l;m=(h&&h.length)||0;if(o(l[0],l.length)){return false;}k=f.get(this.items,l);}else{if(typeof (l)==="object"){k=[l];m=1;h=this.itemIndex(k[0]);n=[h];if(o(h,1)){return false;}}else{h=l;n=[l];m=1;if(o(h,1)){return false;}k=[this.items[h]];}}for(var j=0;j<m;j++){if(n[j]<=q){q--;}}if(k[0]!=null){this.remove(h);this.add(k,q);}return true;},itemIndex:function E(h){if(h==null){return -1;}var i=this.itemIdField;return i?f.find(this.items,i,h[i]):f.indexOf(this.items,h);},prechange:function S(k){if(this.hasRendered){var j=[this.listBuilder,this.listMapper];for(var l=0,h=j.length;l<h;l++){var m=j[l];if(m&&m.onchange){m.onchange(this,this.itemsContainerNode,this.ctxtBuilder,k);}}}},makeObservable:false,_set_items:function I(m,h){var l=this.items;h=this.initItems(h);this.items=h;if(l!==h){var k=this,j=function(){if(k.autoHide){k.set("visible",!!(h&&h.length));}k=null;},i=this.hasRendered;if(i){this.refresh(j);}else{j();}}return l!==h;},premousedown:function c(h){A(this,"premousedown",h);},premouseup:function P(h){A(this,"premouseup",h);},scrollTo:function U(i){var h,j=this.listMapper;if(j&&j.toItem){if(!isNaN(i)){h=i;}else{h=this.itemIndex(i);}if(h>=0){j.toItem(this,h);}}},draggable:false,getDragData:function(l){K(this,l.id);var j=N(this,l.src),i=j&&j.idxActual;if((i>-1)&&this.selectedIndices[i]){var k=this.sortSelectedIndices(),h=f.get(this.items,k)||[];switch(h.length){case 1:return Z.copy(h[0],{html:h[0][this.itemDisplayField],index:k[0]});case 0:return null;default:return Z.copy({html:h.length+" selections",indices:k},h);}}},dropZone:false,ondragenter:function(h){K(this,h.id);this.set("dropCuePos",N(this,h.tgt));},ondragover:function(h){this.set("dropCuePos",N(this,h.tgt));},ondragleave:function(h){this.set("dropCuePos",null);},ondragstart:function(h){if(!(h&&h.src&&h.src.data)){return false;}},allowCopy:false,ondragend:function(k){var i=k&&k.tgt,h=i&&i.widget;if(h===this){}else{if(this.tree&&h&&h.tree===this.tree){if(!this.allowCopy||!b.ctrlKey(i.hWin,i.e)){var j=k.src&&k.src.data;if(j&&(j.indices||(j.index!==null))){this.remove(j.indices||j.index);}}}}},ondrop:function(p){var t=p&&p.src,o=t&&t.data;if(o){var j=N(this,p.tgt,false),q=j&&j.idx,k=(o&&o.constructor===Array);var m=this.items;q=Math.min(q,(m&&m.length)||0);var r=true;if(t.widget===this){r=this.move(this.sortSelectedIndices(),q);}else{this.add(k?o:[o],q);}if(r){var n=k?o.length:1,h={};for(var l=0;l<n;l++){h[q+l]=true;}this.set("selectedIndices",h);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._ListSelections");mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onheightChange:function(){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width;}}},buildRendering:function E(){this.itemsHtml="";var F=this.items&&this.items.length;if(F){this.itemsHtml=this._buildItemsMarkup(0,F-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,_buildItemsMarkup:function(F,I,R,G,U,H){var V=[],N=0;V[N++]=R||"";var L=this.itemRenderer,Q=L&&L.render;if(Q&&typeof (Q)=="function"){var T=U||"",S=H||"",K=this.items,M=(K&&K.length)||0,O=this;for(var J=F,P=Math.min(I+1,M);J<P;J++){V[N++]=T;V[N++]=Q(K[J],J,O);V[N++]=S;}}V[N++]=G||"";return V;},onselectionChange:function A(P){if(!P){return ;}var M=this.itemRenderer;if(!M){return ;}var I=M.unselect,L=this.items||[],Q=P.removed,H,G;if(I&&Q){for(var J=0,R=Q.length;J<R;J++){H=Q[J];G=this._getItemNode(H);if(G){I(G,L[H],H,this);}}}var F=M.select,O=P.added;if(F&&O){for(var K=0,N=O.length;K<N;K++){H=O[K];G=this._getItemNode(H);if(G){F(G,L[H],H,this);}}}if(this.onchange){this.onchange();}},onselect:function B(F){if(this.makeSelection&&F.idxs&&F.idxs.length){var G=this._getItemNode(F.idxs[0]);this.makeSelection({selIdx:F.idxs[0],selItem:G});}},autoHide:false,init:function D(F){this._super(F);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},_getItemNode:function(F){var G=this.itemsContainerNode;return(G&&G.childNodes[F])||null;},_set_items:function C(I,F){if(this.autoHide){this.set("visible",!!(F&&F.length));}var H=this.items;this.items=F;if(H!=F){var G=this.hasRendered;if(G){this.unrender();}this.clearSelect();if(G){this.render();}return true;}else{return false;}return H!=F;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css;function E(F,H){var G={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[F];if(typeof H==="object"){mstrmojo.hash.copy(H,G);}return G;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",width:"100px",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}sbClear" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(1049,"Match case")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;},optionNode:function(){return this.domNode.rows[0].cells[3].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function D(F){var H=this;var G=H.searchTimer;if(G){window.clearTimeout(G);}H.searchTimer=window.setTimeout(function(){H.onkeyupDelayed(F);delete H._searchTimer;},parseInt(F.e.keyCode||F.e.charCode,10)===13?0:H.searchDelay);},onkeyupDelayed:function A(G){var F=G.hWin,I=G.e||F.event;var H=mstrmojo.string.trim(this.inputNode.value);if(this.clearNode){C.toggleClass(this.clearNode,["show"],H.length>0);}this.showTaskError=false;this.click2Search=false;if(H.length==0||this.autoSubmit||this.onEnter&&I.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(G){var F=G.hWin,I=G.e||F.event,K=I.target||I.srcElement,J=K&&K.id;switch(J.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var H=this.optionNode.parentNode.style;H.display=H.display=="block"?"none":"block";}break;case"sbSearch":if(this.onEnter&&I.keyCode===13){this.onEnter();}this.showTaskError=true;this.click2Search=true;this._onsearch();break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbClear":this.clearSearch();break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.clearNode,["show"]);var G=this.searchCache,F=this.rootID;if(G&&G[F]){G[F][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache();var G=this.searchCache[this.rootID];if(G){var F=G[B]||"";this.inputNode.value=F;if(F.length>0){if(F.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(G){var F=this.contentWidget||this;F.set("items",G[0]);if(this.supportIncFetch){var H=G[1],J=G[2],I=this.blockCount;F.set("ifs",{np:Math.floor(H/I)+((H%I>0)?1:0),cp:Math.floor(J/I)+((J%I>0)?1:0)});}},_onsearch:function(F){this.getRootID();this._setupCache();var I=mstrmojo.string.trim(this.inputNode.value);if(I.length===0){F=true;}var J=this.token[this.taskId];if(J.test(I)){}if(this.searchPattern==I&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var K=this.rootID,H=this.searchCache[K];if((I.length<this.minSearchLength&&!this.click2Search)&&!F){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(H[K]);this.searchPattern=I;}}else{this.searchPattern=I;H[B]=this.searchPattern;var G=this.filterCache(I,H,F);if((this.click2Search||G===null)&&!F){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(G);}}H[B]=I;},_setupCache:function(){var H=this.searchCache,G=this.rootID;if(H&&!H[G]){H[G]=H[G]||{};var F=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];H[G][G]=[F,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var F=this,G=E.apply(this,[this.taskId]);G.searchPattern=this.searchPattern;callback={success:function(H){var I=H.items||H.es||[];I=[I,H.totalSize||H.sz||0,H.blockBegin||H.bb];mstrmojo.all[F.id].searchCache[F.rootID][(G.searchPattern.length==0?F.rootID:F.buildIndex(G.searchPattern))]=I;F._notifyContentWidget(I);},failure:function(H){if(F.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+H.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(F.spinnerNode){F.spinnerNode.style.display="none";}if(F.postFetch){F.postFetch();}}};if(this.sessionState!==undefined){G.sessionState=this.sessionState;}mstrmojo.xhr.request(this.method,this.path,callback,G,undefined,this.XServer,this.baseParams);},fetchPage:function(F){this.blockBegin=F*this.blockCount+1;this.fetch();},filterCache:function(K,G,N){var J=G&&G[N?this.rootID:this.buildIndex(K)];if(J){return J;}var H=this.token[this.taskId];if(H.test(K)||this.totalSize>this.blockCount){return null;}var M=K.replace(/.$/,"");J=G&&G[this.buildIndex(M)];while(J===undefined&&(M=M.replace(/.$/,"")).length>0){J=G&&G[this.buildIndex(M)];}if(J!==undefined){if(J[1]>this.blockCount){return null;}var L=J[0],F=[];for(var I in L){if(L[I].n.search(new RegExp(K,this.matchCase?"":"i"))>-1){F.push(L[I]);}}this.totalSize=F.length;return(G[this.buildIndex(K)]=[F,F.length,this.blockBegin].concat());}return null;},buildIndex:function(F){if(F.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?F.toUpperCase():F+"::0";},init:function(F){if(this._super){this._super(F);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.clearNode,["show"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(J,M,F,K){var H=J.domNode,L=H.offsetWidth;var D=!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5,I=K?1:-1,E=parseInt(L,10)*I,G=D?500:0;A(0,-E,G,{target:F,duration:G,preStart:function(){this.target.style.overflowY="hidden";}});A(E,0,G,{target:M,preStart:function(){this.target.style.overflowY="auto";}});if(J.waiting){A(0,-E,G,{widget:J,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});})();(function(){mstrmojo.DivItemRenderer={render:function(D,B,E){var C=(E.getItemName?E.getItemName(D,B):(E.itemDisplayField&&D[E.itemDisplayField]));return'<div mstridx="'+B+'" class="'+E.itemCssClass+(E.selectedIndices[B]?" "+E.itemSelectedCssClass:"")+" lb"+C+'" style="'+E.itemCssText+'">'+C+"</div>";},select:function(C,D,B,E){C.className+=" selected";},unselect:function(C,D,B,E){C.className=C.className.replace(/selected/g,"");},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,_findMatch:function(B,C){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(B,C),"mstridx",true,this.itemsNode);},preclick:function A(J){var F=J.hWin,G=J.e,E=this._findMatch(F,G);if(E){var D=E.node,I=parseInt(E.value),H=mstrmojo.dom,B=H.ctrlKey(F,G),C=H.shiftKey(F,G);if(B||C){H.clearBrowserHighlights(F);}if(this.multiSelect&&(this.selectionPolicy=="toggle"||B)){this.toggleSelect(I);}else{if(this.multiSelect&&C){this.singleSelect(I);}else{this.singleSelect(I);}}}}};mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._RendersItemDivs");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var B=this.itemRenderer;return(B&&B.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var B=this.itemRenderer;return(B&&B.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var B=this.itemRenderer;return(B&&B.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var B=this.itemRenderer;return(B&&B.itemSuffix)||"</td></tr>";},_getItemNode:function(B){var D=this.itemsNode,C=D&&D.rows,E=C&&C[B];return E&&E.cells[0].firstChild;}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.css;function I(R){var Q=R.inputNode;var P=(R.value!=null)?String(R.value):"";if(P!==Q.value){Q.value=P;}if(Q.mstrmojoEmpty){C.removeClass(Q,[R.emptyClass]);Q.mstrmojoEmpty=null;}}function E(Q){var P=Q.inputNode;P.value=Q.emptyText||"";C.addClass(P,[Q.emptyClass]);P.mstrmojoEmpty=true;}function G(Q){var P=Q.inputNode;if(P){Q.readingDom=true;Q.set("value",P.value);Q.readingDom=false;}}var M={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",autoComplete:true,autoCorrect:true,autoCapitalize:true,placeholderText:"",markupString:'<input id="{@id}" placeholder="{@placeholderText}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css.toggleClass(this.inputNode,"disabled",!this.enabled);},onvalueChange:function(){var P=this.value,Q=(P===null)||(P==="");if(Q){if(!this.hasFocus){E(this);}else{this.inputNode.value="";}}else{I(this);}},ontooltipChange:function(){this.domNode.title=this.tooltip;},onreadOnlyChange:function(){this.inputNode.readOnly=this.readOnly;}},emptyText:"",emptyClass:"mstrmojo-empty",postBuildRendering:function B(){this._super();var P=this.inputNode;P.setAttribute("autocomplete",this.autoComplete?"on":"off");P.setAttribute("autocorrect",this.autoCorrect?"on":"off");P.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function O(){this.inputNode.focus();},prefocus:function J(){this.hasFocus=true;I(this);},preblur:function D(){window.setTimeout(function(){},200);this.hasFocus=false;G(this);var P=this.value;if((P===null||P==="")&&this.emptyText){E(this);}},prekeyup:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);var S=M[R.keyCode];if(this["on"+S]){this["on"+S](Q);}},preinput:function A(Q){var P=Q.hWin,R=Q.e||P.event;G(this);},prepaste:function N(){this.delaySetValue(this);},precut:function L(){this.delaySetValue(this);},delaySetValue:function K(P){window.setTimeout(function(){G(P);},100);},setInvalidState:function H(P){mstrmojo.css.addClass(this.inputNode,["err"]);if(P){this.domNode.setAttribute("title",P);}},cleanUp:function F(){this.inputNode.value="";mstrmojo.css.removeClass(this.domNode,["err"]);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K[I].slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}" ><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},buildRendering:function A(){var C=this.placeholder;if(this._super()){if(!this.parent&&!C){var B=this.placeNode||document.body;B.appendChild(this.domNode);}return true;}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var H=mstrmojo.func.composite,F=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(O){if(O){return ;}var M=this.visible,N=M?"block":"none";this.editorNode.style.display=N;if(this.modal){this.curtainNode.style.display=N;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function I(){var M;var N=this.buttons;if(N&&!this.btnHbox){for(M in N){N[M].cssClass="mstrmojo-Editor-button";}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:N},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function D(){var M=this.placeholder;if(this._super()){if(!this.parent&&!M){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function G(){var M=this.id;return function(){var N=mstrmojo.all[M];N.resizeDialog();N.positionDialog();};},postBuildRendering:function B(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var M=this._resizeHandler=this.getResizeHandler();F.attachEvent(window,"resize",M);}this.resizeDialog();this.positionDialog();this.domNode.focus();return true;},resizeDialog:function J(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function E(){var N=this,R=N.curtainNode,M=document.body,P=document.documentElement,Q=R.style,O=N.curtainPosition;Q.width=Math.max(M.clientWidth,P.scrollWidth)+"px";if(O&&O.h){Q.height=O.h+"px";}else{Q.height=Math.max(M.clientHeight,P.scrollHeight)+"px";}if(O&&O.y){Q.top=O.y+"px";}N.raiseEvent({name:"resizeCurtain"});},positionDialog:function K(){if(!this.left||!this.top){var M=this.editorNode;F.center(M);if(this.alignment==="top"){M.style.top="10px";}}},destroy:function(N){var M=this._resizeHandler;if(M){F.detachEvent(window,"resize",M);}this._super(N);}});if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.confirm=function A(P,N,O){var Q="mojoConfirmx9",M=function(){mstrmojo.all[Q].destroy();};mstrmojo.array.forEach(N,function(R){var S=R.onclick;R.onclick=S?H([M,S]):M;});mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:N,children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.alert=function C(P,M,O){var Q="mojoAlertx9";try{mstrmojo.all[Q].destroy();}catch(N){}mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:Q,title:O||mstrmojo.desc(3610),width:"475px",buttons:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),function(){mstrmojo.all.mojoAlertx9.destroy();if(M){M();}},"#666666")],children:[{scriptClass:"mstrmojo.Label",text:P}]}).render();};mstrmojo.toast=function L(Q,O){var R="mojoToast9",P,N=O||3000;try{mstrmojo.all[R].destroy();}catch(M){}mstrmojo.insert({id:R,scriptClass:"mstrmojo.Label",cssClass:"toastCss",text:Q}).render();P=mstrmojo.all[R].domNode;document.body.appendChild(P);F.bottomCenter(P);window.setTimeout(function(){mstrmojo.all[R].destroy();},N);};mstrmojo.mask={};mstrmojo.mask.show=function(){mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});mstrmojo.mask.win.render();document.body.appendChild(mstrmojo.mask.win.domNode);};mstrmojo.mask.hide=function(){mstrmojo.mask.win.destroy();};}}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.List");mstrmojo.requiresDescs(9924);var A=mstrmojo.dom,B=mstrmojo.css,E=mstrmojo.desc;var C={NONE:0,CITY:1,STATE:2,COUNTRY:3,LOCATION:4,LATITUDE:5,LONGTITUDE:6,OTHER:7,ZIPCODE:8,COUNTY:9};var D=[{n:mstrmojo.desc(2057,"None"),did:C.NONE,geo:true},{n:mstrmojo.desc(7674,"Country"),did:C.COUNTRY,geo:true},{n:mstrmojo.desc(7676,"State"),did:C.STATE,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456}]},{n:"County",did:C.COUNTY,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456},{n:mstrmojo.desc(7676,"State"),did:536870912}]},{n:mstrmojo.desc(7675,"City"),did:C.CITY,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456},{n:mstrmojo.desc(7676,"State"),did:536870912}]},{n:mstrmojo.desc(7677,"Zip Code"),did:C.ZIPCODE,geo:true,items:[{n:mstrmojo.desc(7674,"Country"),did:268435456},{n:mstrmojo.desc(7676,"State"),did:536870912},{n:mstrmojo.desc(7675,"City"),did:1073741824}]},{n:mstrmojo.desc(7696,"Latitude"),did:C.LATITUDE,geo:true},{n:mstrmojo.desc(7697,"Longtitude"),did:C.LONGTITUDE,geo:true},{n:"City, State",did:C.LOCATION,geo:true},{n:mstrmojo.desc(9923,"Others..."),did:C.OTHER,geo:true}];if(mstrApp.isCloudPro){D.splice(-1);}mstrmojo.qb.GeoRole=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.GeoRole",markupString:'<div id="{@id}"  class="{@cssClass}" style="top:{@top};left:{@left};width:155px;height:{@height};"><div style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown,click><div class="mstrmojo-qb-mapping-title">{@title}</div><div class="mstrmojo-qb-mapping-georole"></div><div class="mstrmojo-qb-mapping-buttons"></div></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild.childNodes[1];},titleNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];}},top:"0px",left:"0px",height:"320px",title:"Please select a geography role for this attribute and any additional attributes that you want to create.",georole:0,shapeKeys:[],der:0,_close:function(){var F=this.parent;if(F&&F._cmSource){F._cmSource.closeMenuTree();}},onOK:function(){var I=this.parent,F=I._cmSource;if(F.executeCommand){this.data.geo=true;if(this.geolist.selectedItem.geo){var H=this.geolist.selectedItem.did;this.data.georole=H;var G={2:268435456,1:805306368,9:805306368,8:1879048192}[H]||0;this.data.der=this.der=this.der&G;}else{this.data.georole=7;this.data.shapeKey=this.geolist.selectedItem.did;}F.executeCommand(this.data);}this._close();},onCancel:function(){this._close();},children:[{scriptClass:"mstrmojo.List",slot:"contentNode",alias:"geolist",cssClass:"mstrmojo-qb-geolist",itemIdField:"did",cssClassItem:"",onclick:function(G){var L=A.eventTarget(G.hWin,G.e).parentNode;if(L.className.indexOf("mstrmojo-qb-georole-attribute")>-1){var J=parseInt(L.getAttribute("did"),10);var I=[],K=this.domNode.children[0].children;switch(J){case 268435456:I.push(K[5].children[0].children[1].children[0].children[1]);I.push(K[4].children[0].children[1].children[0].children[1]);I.push(K[3].children[0].children[1].children[0].children[1]);I.push(K[2].children[0].children[1].children[0].children[1]);break;case 536870912:I.push(K[5].children[0].children[1].children[0].children[2]);I.push(K[4].children[0].children[1].children[0].children[2]);I.push(K[3].children[0].children[1].children[0].children[2]);break;case 1073741824:I.push(L);break;default:break;}if(this.parent.der&J){for(var H=0,F=I.length;H<F;H++){B.removeClass(I[H],"selected");}}else{for(var H=0,F=I.length;H<F;H++){B.addClass(I[H],"selected");}}this.parent.der=this.parent.der^J;}},adjustMenu:function(){var F=this.parent.parent;if(F){F=F.parent.parent;if(F&&F.adjustMenuPosition){F.adjustMenuPosition();}}},expandShapeKeyNode:function(){B.addClass(this.domNode,"showShapeKey");this.adjustMenu();},onmouseup:function(F){switch(this.selectedItem.did){case C.OTHER:this.expandShapeKeyNode();this.set("selectedItem",{did:this.parent.shapeKey});break;}},onchange:function(H){var F=H.added;if(F){switch(this.selectedItem.did){case C.COUNTY:case C.CITY:case C.STATE:case C.ZIPCODE:this.adjustMenu();break;case C.OTHER:var G=H.removed;if(G&&G.length){this.set("selectedIndex",G[0]);this.expandShapeKeyNode();}break;}}},bindings:{items:function(){return(this.parent.shapeKeys)?D.concat(this.parent.shapeKeys):D;}},itemMarkupFunction:function(M,K,H){var N=[],F=H.parent;if(M.items){var I=M.items,L="onclick=\"mstrmojo.dom.captureDomEvent('"+H.id+"','click', self, event)\"";N.push('<div class="mstrmojo-qb-georole-attribute-box"><span>');N.push(E(9924,"Create attributes for:"));N.push("</span>");for(var G=0,J=I.length;G<J;G++){N.push('<div class="mstrmojo-qb-georole-attribute '+((F.der&I[G].did)?"selected":"")+'" did="'+I[G].did+'"'+L+'><img class="mstrmojo-qb-georole-checkbox" src="../images/1ptrans.gif"><span style="padding-left:5px;">');N.push(I[G].n);N.push("</span></div>");}N.push("</div>");}return'<div class="mstrmojo-qb-georole '+((M.did==C.OTHER)?"other":"")+(M.geo?"":"shapeKey ")+H.cssClassItem+'" idx="'+K+'" did="'+M.did+'"><div class="mstrmojo-qb-georole-itemtext"><img class="mstrmojo-qb-georole-img" src="../images/1ptrans.gif"><span class="mstrmojo-qb-georole-text">'+M.n+'</span></div><div class="mstrmojo-qb-georole-itemcontent">'+N.join("")+"</div></div>";},onRender:function(){this.set("selectedItem",{did:this.parent.georole});}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox cf",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(1442,"OK"),onclick:function(F){var G=this.parent.parent;if(G.onOK){G.onOK();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(F){var G=this.parent.parent;if(G.onCancel){G.onCancel();}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox");mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur ></textarea>',maxLength:256,markupSlots:{inputNode:function(){return this.domNode;}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncssClassChange=function(){this.domNode.className="mstrmojo-TextArea "+(this.cssClass||"");};},onkeydown:function(D){var C=(this.value&&this.value.length)||0;if(this.maxLength<=C){this.isDeleteKeys=D.e.keyCode===8||D.e.keyCode===46;this.isArrowKeys=D.e.keyCode===37||D.e.keyCode===38||D.e.keyCode===39||D.e.keyCode===40;var B=(this.domNode.selectionEnd!==undefined)?(this.domNode.selectionEnd-this.domNode.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!B){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var A=this.domNode;A.blur();window.setTimeout(function(){A.focus();},1);}mstrmojo.dom.preventDefault(window,D.e);return false;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(E){var D=E[this.itemType],C=E[this.itemSubType],A=" t"+D,B=(D==1||D==3)?" st"+C:"",F=E[this.itemISC]?'class="mstrmojo-ListIcon isc"':"";return'<span class="mstrmojo-ListIcon '+A+B+'"><span '+F+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length;if(A>0){for(var B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+E.substring(0,G)+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc"});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var L=this;this._renderTimer=self.setInterval(function(){var M=L.getPagesToRender();if(M.length>0){L.renderPages(M);}else{L.renderingRows=false;self.clearInterval(L._renderTimer);delete L._renderTimer;if(L.isRenderingComplete()){L.postRenderingCleanup();}L=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],Z=this._pageHeight,b=null,W=this._pageStatus,Y=this;function R(c){var d=W[c];if(d&&d.filled){if(!d.height){if(!b){b=Y.itemsNode.tBodies;}d.height=b[c].offsetHeight;}return d.height;}else{return Z;}}var a=0,S=null,O=null,M=this.scrollboxTop;for(var V=0,X=this._totalPages;V<X;V++){a+=R(V);if(a>=M){S=V;break;}}if(S==null){S=O=X-1;}else{var L=this.scrollboxBottom;for(var T=S+1;T<X;T++){if(a>=L){O=T-1;break;}a+=R(T);}}if(O==null){O=X-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var U=W[Q];if(!U||!U.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var V=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(V[R]&&V[R].filled)){return ;}}var U=this._rowsPerPage,L=R*U,N=Math.min(L+U,this._rc)-1;var T=this.tempTableCont;if(!T){T=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';T.innerHTML=Q;var O=T.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz");var A={render:function(F,B,G){var H=(G.htmlName+B),D=G.selectedIndices[B]?"checked ":"",E=D?" selected":"",C=F.v!="u;"?" nAll":"";return'<div class="'+G.itemCssClass+E+C+'"><input type="'+G.inputType+'" name="'+G.htmlName+'" id="'+H+'" value="'+B+'" '+D+'/><label for="'+H+'" title="'+(F[G.itemTitleField]||"")+'" style="'+G.labelCssText+'">'+F[G.itemDisplayField||"n"]+"</label></div>";},select:function(D,E,B,F){var C=D&&D.firstChild;if(C&&!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);},unselect:function(D,E,B,F){var C=D&&D.firstChild;if(C&&C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);},rowHeight:23};mstrmojo._RendersInputItems={inputType:null,htmlName:null,itemRenderer:A,init:function(B){this._super(B);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(E){var D=E.hWin,G=E.e,F=mstrmojo.dom.eventTarget(D,G);if(F&&F.nodeName.match(/input/i)){var C=parseInt(F.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(C);}else{var B=(F.checked)?"add":"remove";this[B+"Select"](C);}}}};mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});})();(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),new mstrmojo.FishEye({items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E=="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E=="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof (G)=="object")&&(typeof (G.length)=="number"));};if(B(F)&&B(E)){for(var C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var A=mstrmojo.dom,B={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(B[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=A.eventTarget(D.hWin,D.e);if(F==this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd");function W(a){var c=document.createElement("div"),b=c.style,Z=a.domNode;c.className="mstrmojo-DataGrid-avatar";b.height=Z.clientHeight+"px";Z.appendChild(c);a.avatar=c;return c;}function N(Z){var a=mstrmojo.dom.position(Z.domNode,true);return a.x;}function L(Z){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+Z+'"></div>';}function X(b){var a=b.getAttribute("rh"),Z=a&&parseInt(a,10);return Z;}function U(a,f,Z){var c=Z.src,g=c&&c.data,b=g&&g.resizingIdx;if(!(b&&b>0)){return f&&f.apply(a,[Z]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function E(c,b){var Z=c.colSizeArray;var a=[-Z[b-1]+c.minColWidth,(b==Z.length-1)?Z[b]-c.resizeHandleWidth-c.minColWidth:Z[b]-c.minColWidth];return a;},updateSize:function D(c,b,a){var Z=c.colSizeArray;Z[b-1]=Z[b-1]+a;Z[b]=Z[b]-a;},updateColumnWidth:function Q(c,a,d,b){var Z=c.colSizeArray;a[b-1].style.width=Z[b-1]+"px";d[b-1].style.width=Z[b-1]+"px";a[b].style.width=Z[b]+"px";d[b].style.width=Z[b]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function E(f,d){var g=f.minColWidth+f.resizeHandleWidth,Z=f.colSizeArray,b=0;for(var c=d;c<Z.length;++c){b+=Z[c]-g;}var a=[-Z[d-1]+g,b];return a;},updateSize:function D(c,h,a){var g=c.minColWidth+c.resizeHandleWidth,d=c.colSizeArray;d[h-1]=d[h-1]+a;var Z=[];for(var b=0;b<d.length-h;++b){Z[b]=h+b;}Z.sort(function(i,k){return d[i]-d[k];});for(var b=0;b<Z.length;++b){var j=a/(Z.length-b);var f=d[Z[b]];a-=(f>=j+g)?j:f-g;d[Z[b]]=(f>=j+g)?f-j:g;}},updateColumnWidth:function Q(d,a,f,c){var Z=d.colSizeArray;for(var b=c-1;b<Z.length;++b){a[b].style.width=Z[b]+"px";f[b].style.width=Z[b]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,postBuildRendering:function S(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function C(Z){var b=Z.src,c=b.node,a=X(c);if(a&&a>0){return{resizingIdx:a,startingX:b.pos.x,baseX:N(this)};}else{if(this._super){return this.dropZone&&this._super(Z);}}return null;},allowDrop:function I(Z){var b=Z.src,c=b&&b.data,a=c&&c.resizingIdx;if(a&&a>0){return true;}else{return this.dropZone;}},ondragenter:function O(Z){U(this,this._super,Z);},ondragover:function P(Z){U(this,this._super,Z);},ondragleave:function A(Z){U(this,this._super,Z);},ondrop:function T(Z){U(this,this._super,Z);},ondragstart:function V(f){var n=f.src,g=n&&n.data,m=g&&g.resizingIdx;if(m&&m>0){var j=this.avatar||W(this);this.ownAvatar=true;j.style.left=(g.startingX-g.baseX)+"px";j.style.display="block";document.body.style.cursor="col-resize";var k=this.colSizeArray;if(!k){var b=this.headerContainerNode,h=b&&b.getElementsByTagName("table")[0],l=h.rows[0].cells;k=[];for(var Z=0,c=l.length;Z<c;Z++){k.push(l[Z].offsetWidth);}this.colSizeArray=k;this._firstTimeResize=true;}g.resizingRange=this.resizeColumnBehavior.getRange(this,m);return true;}else{if(this._super){return this._super(f);}}},ondragmove:function M(b){var k=b.src,c=k&&k.data,i=c&&c.resizingIdx;if(i&&i>0){var j=b.tgt,f=this.avatar,h=c.resizingRange,g=j.pos.x-c.startingX,Z=Math.min(h[1],Math.max(g,h[0]));c.deltaX=Z;if(f){f.style.left=(c.startingX-c.baseX+Z)+"px";}}else{if(this._super){this._super(b);}}},ondragend:function J(f){var n=f.src,g=n&&n.data,l=g&&g.resizingIdx;if(l&&l>0){var Z=this.titleColGroup,m=Z&&Z.childNodes,j=this.dataColGroup,k=j&&j.childNodes,c=m.length,h=this.colSizeArray,a=g.deltaX;this.resizeColumnBehavior.updateSize(this,l,a);if(this._firstTimeResize){for(var b=0;b<c;b++){m[b].style.width=h[b]+"px";k[b].style.width=h[b]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,m,k,l);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(f);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function H(b){var f=document.createElement("colgroup"),Z=b.length,a;for(var d=0;d<Z;d++){var c=document.createElement("col");a=b[d];if(a.colWidth){c.style.width=a.colWidth+"px";}c.className=a.colCss||("col"+d);f.appendChild(c);}return f;}function G(a){var b=a._headerWidgets_,Z=b&&b.length;if(Z>0){for(var c=0;c<Z;c++){b[c].destroy(true);}}}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},itemFunction:function(b,Z,a){var d=new mstrmojo.DataRow({columns:a.columns,data:b,idx:Z,dataGrid:a});return d;},preBuildRendering:function B(){var c=this.columns,Z=c.length,d=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],b,a;this._headerWidgets=[];for(var f=0;f<Z;f++){b=c[f];a=b.headerWidget;d.push("<td>");if(f>0&&this.resizableColumns){d.push(L(f));}d.push('<div class="mstrmojo-DataGrid-headerText');d.push(b.headerCss?" "+b.headerCss:"");if(a){this._headerWidgets.push(mstrmojo.hash.copy(a));d.push('" w="1">');}else{d.push('">');}d.push(b.headerText?b.headerText:"&nbsp");d.push("</div>");d.push("</td>");}d.push("</tr></table>");this.headerHtml=d.join("");if(this._super){this._super();}},postBuildRendering:function S(){if(this._super){this._super();}var c=this._headerWidgets,g=c.length;if(g>0){this._headerWidgets_=[];var h=this.headerContainerNode.getElementsByTagName("div"),b=mstrmojo.array.filter(h,function(i){return i.getAttribute("w")=="1";}),l;for(var d=0;d<g;d++){c[d].placeholder=b[d].firstChild;c[d].dataGrid=this;l=mstrmojo.registry.ref(c[d]);l.render();this._headerWidgets_.push(l);}}var Z=H(this.columns),k=Z.cloneNode(true),f=this.headerContainerNode,j=f&&f.getElementsByTagName("table")[0],m=this.itemsContainerNode,a=m&&m.getElementsByTagName("table")[0];this.titleColGroup=Z;this.dataColGroup=k;if(j&&a){j.insertBefore(Z,j.firstChild);a.insertBefore(k,a.firstChild);}},refresh:function F(Z){G(this);if(this._super){this._super(Z);}},destroy:function Y(Z){G(this);this._super();},unrender:function R(d){var b=this._headerWidgets_,a=b&&b.length,Z;if(a>0){for(var c=0;c<a;c++){Z=b[c];if(Z&&Z.hasRendered){Z.unrender(true);}}}this._super(d);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var g=document.createElement("tr"),l=this.data,o=this.idx,a=this.dataGrid,h=this.cssClass,q=this.columns,Z=this.children,b,m=-1,p,n;g.setAttribute("id",this.id);if(a.banding){h+=(o%2==1)?" odd":" even";}g.className=h+(mstrmojo.string.isEmpty(l[a.itemDisplayField||"n"])?" empty-row":"");for(var f=0,k=q.length;f<k;f++){p=q[f];n=(p.dataWidgetBuilder&&p.dataWidgetBuilder(l))||p.dataWidget;b=document.createElement("td");g.appendChild(b);if(n){b.setAttribute("w","1");m++;Z.push(mstrmojo.hash.copy(n,{slot:"slot"+m,data:l,idx:o,dataGrid:a}));}else{if(p.dataFunction){b.innerHTML=p.dataFunction(l,o,a);}else{var c=mstrmojo.string.htmlAngles(l[p.dataField||"n"])||"&nbsp",j=p.tooltip?' title="'+c+'"':"";b.innerHTML='<div class="mstrmojo-DataRow-text" '+j+">"+c+"</div>";}}}this.initChildren();return g;},buildRendering:function K(){this._super();var d=this.domNode.childNodes,Z=d.length,c={},b=0,f;for(var a=0;a<Z;a++){f=d[a];if(f.getAttribute("w")=="1"){c["slot"+b]=f;b++;}}this.addSlots(c);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo.Editor","mstrmojo.Label","mstrmojo.HBox");mstrmojo.qb.MissingColumnWarning=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.qb.MissingColumnWarning",title:mstrmojo.desc(3610),warning:mstrmojo.desc(10040,"Some of the previously uploaded columns are missing"),details:mstrmojo.desc(10041,"If you do not import previously used columns, existing reports, documents and analyses might be affected. Do you still want to continue?"),onOpen:function(){this.list.set("items",this.mappings);this.warningLabel.set("text",this.warning);this.detailLabel.set("text",this.details);},cssText:"width: 400px",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-MissingColumns-title",alias:"warningLabel"},{scriptClass:"mstrmojo.List",alias:"list",cssClass:"mstrmojo-qb-MissingColumns-list",itemIdField:"did",itemMarkupFunction:function(A,C,D){var B='<div class="mstrmojo-qb-MissingColumns-bullet mstrmojo-qb-MissingColumns-Icon t'+A.tp+'">'+A.n+"</div>";return B;}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-MissingColumns-instruction",alias:"detailLabel"},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-MissingColumns-buttonBox",slot:"buttonNode",cssText:"float:right;background:transparent;height:45px;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-Yes",text:mstrmojo.desc(219,"Yes"),onclick:function(A){var C=this.parent.parent;var B=true;if(C.onOK){B=C.onOK();}if(B){C.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-Editor-button-No",text:mstrmojo.desc(218,"No"),onclick:function(A){var B=this.parent.parent;if(B.onCancel){B.onCancel();}B.close();}}]}],onRender:function(){this.helpNode&&(this.helpNode.style.display="none");this.closeNode&&(this.closeNode.style.display="none");}});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.DI.ImportSource","mstrmojo.DI.DIConstants","mstrmojo.string");var Q=mstrmojo.DI.DIConstants;var A=mstrmojo.css;var D=new mstrmojo.Editor({id:"waitBox",cssClass:"mstrmojo-Architect-WaitBox",draggable:false,showTitle:false,zIndex:99999,counter:0,children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrIcon-wait"}]});function B(S,R){return S+"_"+R;}function M(T,R){var S=new mstrmojo.DI.ImportSource();S.init(T,R,B(T,R));return S;}var E={};mstrmojo.DI.DataImportModel=mstrmojo.declare(mstrmojo.Obj,null,{id:"DIModel",scriptClass:"mstrmojo.DI.DataImportModel",curPg:Q.pageType.intro,redirect:3,refresh_opt:"1",folderID:"",cubeID:"",cubeName:"",cubeDesc:"",currentSource:null,fileUploadSize:0,application:Q.application.platform,operationMode:Q.operationMode.create,applicationName:function(){switch(this.application){case Q.application.platform:return"Data Import";case Q.application.cloudPersonal:return"Cloud Personal";case Q.application.cloudProfessional:return"Cloud Express";}},initParams:function F(T){var S=this;var U;var V=T.StatusCode;var R=T.ReportId;var X=T.FolderId;var W=T.CubeName;var a=T.CubeDesc;switch(V){case Q.statusCode.edit:this.set("operationMode",Q.operationMode.edit);U=Q.requestFlag.sourceInfo;break;case Q.statusCode.obtainSource:this.set("operationMode",Q.operationMode.refresh);U=Q.requestFlag.sourceInfo;break;case Q.statusCode.xformsError:case Q.statusCode.mappingError:this.set("operationMode",Q.operationMode.refresh);U=Q.requestFlag.sourceInfo|Q.requestFlag.mapping|Q.requestFlag.preview|Q.requestFlag.sheets;break;default:this.set("operationMode",Q.operationMode.create);U=0;break;}this.cubeID=R;this.cubeName=W;this.folderID=X;this.cubeDesc=a;this.fileUploadSize=T.UploadSizeLimit*1024*1024;if(T.CloudEdition!==undefined){this.application=T.CloudEdition;}if(R!==undefined){var Y={success:function(b){S.populate(b,U,U);switch(V){case Q.statusCode.xformsError:case Q.statusCode.mappingError:S.set("curPg",Q.pageType.preview);break;default:if(S.currentSource.type===Q.sourceType.file){S.set("curPg",Q.pageType.file);}break;}},failure:function(b){S.hideWaitPage(true);mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));}};var Z={taskId:"qBuilder.GetReportXDADefinition",reportid:this.cubeID,messageid:null,sessionState:mstrApp.sessionState,browsetype:4,previewflag:U};this.showWaitPage();mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,this.restructCB(Y),Z);}},selectImportSource:function C(T,R){var S=E[B(T,R)];if(!S){this.currentSource=M(T,R);E[this.currentSource.key]=this.currentSource;}else{this.currentSource=S;}this.raiseEvent({name:"ImportTypeChanged"});},loadRptData:function P(S,T,R){var U={taskId:"qBuilder.GetReportXDADefinition",messageid:this.msgid,sessionState:mstrApp.sessionState,browsetype:4,previewflag:S};if(T>=0){U.sheetIndex=T;}this.showWaitPage();mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,this.restructCB(R),U);},importUrl:function I(S,R){var T={taskId:"importFile",messageid:this.msgid,sessionState:mstrApp.sessionState,url:S,taskContentType:"json",taskEnv:"xhr"};this.showWaitPage();mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,this.restructCB(R),T);},showWaitPage:function L(S){if(!D.hasRendered){D.render();}var T=D.editorNode,R=D.containerNode.children[0],U=D.curtainNode;D.counter++;if(S){if(!D.visible){A.addClass(T,"wide");A.addClass(R,"wide");A.addClass(U,"wide");}}else{if(!D.visible){A.removeClass(T,"wide");A.removeClass(R,"wide");A.removeClass(U,"wide");}}D.open();},hideWaitPage:function H(R){if(R){if(D.visible){D.close();}D.counter=0;return ;}D.counter--;if(D.counter===0&&D.visible){D.close();}},editCube:function J(U,T,S,R){var V={taskId:"editCube",msgID:this.msgid,sessionState:mstrApp.sessionState,shtIx:T};if(U){V.reportID=U;}if(S){V.chs=S;}if(this.currentSource.subtype===Q.sourceSubtype.url){V.isUrl=true;}this.showWaitPage();mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,this.restructCB(R),V);},restructCB:function O(T){var S=this;var R={success:function(U){S.hideWaitPage();if(T&&T.success){T.success(U);}},failure:function(U){S.hideWaitPage();mstrmojo.alert(U.getResponseHeader("X-MSTR-TaskFailureMsg"));}};return R;},changeMappings:function(U){var V=this.currentSource.getMappingChanges();var W={taskId:"qBuilder.RemapObject",msgid:this.msgid,mpcs:JSON.stringify(V)};if(mstrApp.sessionState!==undefined){W.sessionState=mstrApp.sessionState;}var T=this;var S={success:function(X){T.hideWaitPage();T.populate(X,Q.requestFlag.mapping,Q.requestFlag.mapping);if(U&&U.success){U.success(X);}},failure:function(X){me.hideWaitPage();mstrmojo.alert(X.getResponseHeader("X-MSTR-TaskFailureMsg"));}};var R={success:function(X){T.loadRptData(Q.requestFlag.mapping,-1,S);},failure:function(X){T.hideWaitPage();mstrmojo.alert(X.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.showWaitPage(true);mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,R,W);},pollStatus:function K(R){var S={taskId:"pollStatus",resultSetType:3,pollingFrequency:500,maxWait:60000,taskEnv:"xhr",taskContentType:"json",msgID:this.msgid,sessionState:mstrApp.sessionState};this.showWaitPage();mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,this.restructCB(R),S);},populateSourceInfo:function N(S){if(!S){return ;}var T=S.datap.srce;var R;switch(T.xt){case Q.xdaType.excel:case Q.xdaType.text:if(T.iurl){R=E[B(Q.sourceType.file,Q.sourceSubtype.url)];if(!R){this.selectImportSource(Q.sourceType.file,Q.sourceSubtype.url);R=this.currentSource;}}else{R=E[B(Q.sourceType.file,Q.sourceSubtype.localFile)];if(!R){this.selectImportSource(Q.sourceType.file,Q.sourceSubtype.localFile);R=this.currentSource;}}R.sourceInfo=new mstrmojo.Obj();R.sourceInfo.set("name",T.tbn);R.sourceInfo.set("sheetName",T.shn);R.sourceInfo.set("sheetIndex",T.shnb);R.sourceInfo.set("hasInsertedColumnHeaders",T.hnchs);break;case Q.xdaType.salesforce:R=E[B(Q.sourceType.salesforce,Q.sourceSubtype.salesforce)];if(!R){this.selectImportSource(Q.sourceType.salesforce,Q.sourceSubtype.salesforce);R=this.currentSource;}R.sourceInfo=new mstrmojo.Obj();R.sourceInfo.set("sourceId",T.sid);R.sourceInfo.set("name",T.tbn);R.sourceInfo.set("objectId",T.oid);R.sourceInfo.set("objectDesc",T.odesc);break;}},populate:function G(S,R,T){if((R&Q.requestFlag.sourceInfo)===Q.requestFlag.sourceInfo){this.populateSourceInfo(S);}this.currentSource.populate(S,T,R);if((R&Q.requestFlag.preview)===Q.requestFlag.preview){this.raiseEvent({name:"PreviewFetched"});}if((R&Q.requestFlag.mapping)===Q.requestFlag.mapping){this.raiseEvent({name:"MappingsFetched"});}if((R&Q.requestFlag.sheets)===Q.requestFlag.sheets){this.raiseEvent({name:"SheetsFetched"});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.TreeNode");var I=mstrmojo.dom;mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:mstrmojo.hash.copy({checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,onstateChange:function H(){if(!this.contentRetrieved&&(this.state==1)){this.set("items",[this.tree.loadingItemCreaterFunc()]);this.tree.getContent(this,this.blockBegin);}},toggleState:function F(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function G(J){I.clearBrowserHighlights(J.hWin);return false;},predblclick:function D(J){I.clearBrowserHighlights(J.hWin);return false;},premousedown:function B(K){var P=mstrmojo.dom,M=mstrmojo.dom.eventTarget(K.hWin,K.e),J=this.tree,L=(this.state==2),O=P.contains(this.itemsContainerNode,P.eventTarget(K.hWin,K.e),true,this.domNode),N=(J.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if(this.isSpecialNode()||!(M==this.checkBoxNode||(M==this.textNode&&(L||!N)))){P.stopPropogation(K.hWin,K.e);}if((M==this.stateNode)||(M==this.textNode&&!L&&N)){if(!L){this.toggleState();}}else{if(M==this.checkBoxNode||O){if(this._super){this._super(K);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var J=this.data&&this.data.st;return(J<0);},handleNodeClicked:function E(){var J=this.tree,K=this.parent,L=this.data;switch(L&&L.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin-J.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin+J.blockCount);break;case"-1":case"-2":break;default:if(J.handleNodeClicked){J.handleNodeClicked(L);}}},init:function(J){this._super(J);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var J=function(K){I.preventDefault(window,K||window.event);return false;};I.attachEvent(this.domNode,"mousedown",J);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Label","mstrmojo.FileUploadBox","mstrmojo.TextBox","mstrmojo.RadioList","mstrmojo.CheckBox","mstrmojo.Image","mstrmojo.Dialog","mstrmojo.DI.DIConstants","mstrmojo.DI.DISharedViewer");var A=mstrmojo.DI.DIConstants;var E=mstrmojo.DI.DISharedViewer;var C={scriptClass:"mstrmojo.Dialog",width:"300px",model:null,buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-blueButton",text:"OK",onclick:function(){var G=this.parent.parent;var F=G.model;F.currentSource.selectSheet(G.preShtsPD.selectedIndex);F.editCube(null,G.preShtsPD.selectedIndex,null,mstrmojo.DI.DISharedViewer.publish(F));G.destroy();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-greyButton",text:"Cancel",onclick:function(){this.parent.parent.destroy();}}],children:[{scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",text:"Select Sheet to Import:"},{scriptClass:"mstrmojo.Pulldown",alias:"preShtsPD",bindings:{items:function(){var H=this.parent.parent.model.currentSource.sheets;var G=[];var F;if(H){for(F=0;F<H.length;F++){if(H[F]!=="*"){G.push({dssid:F,n:H[F]});}}return G;}},defaultSelection:function(){return this.parent.parent.model.currentSource.currentIndex;}}}]}]};function B(G){var F=G.toLowerCase();if(F==".xls"||F==".xlsx"){return A.xdaType.excel;}else{if(F==".txt"||F==".csv"){return A.xdaType.text;}else{return 0;}}}var D=false;mstrmojo.DI.DIFileUpload=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DI.DIFileUpload",cssClass:"mstrmojo-di-fu",model:null,markupString:'<div id="{@id}" class="mstrmojo-di-fileUpload {@cssClass}" ><div></div><div></div><div></div><div></div><div></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},labelNode:function(){return this.domNode.children[0];},optionsNode:function(){return this.domNode.children[1];},fileInputNode:function(){return this.domNode.children[2];},urlInputNode:function(){return this.domNode.children[3];},showPreviewNode:function(){return this.domNode.children[4];},imageNode:function(){return this.domNode.children[5];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},isExtensionValid:function(){var M=true;var G=this.model;if((G.operationMode===A.operationMode.refresh)||(G.operationMode===A.operationMode.edit)){var J=G.currentSource.sourceInfo.name;var I=B(J.substring(J.lastIndexOf(".")));var F;var L;if(ultp.selectedIndex===0){var K=this.fuBox.fileNode.value;F=B(K.substring(K.lastIndexOf(".")));}else{L=this.urlInput.value.split("/");if(!L){var H=L[L.length-1];L=H.split(".");if(!L){if(L.length>1){F=B("."+L[1]);}}}}if(I!==F){M=false;}}return M;},onNextButtonClick:function(){var G=this.showPrv;var J=this.model;var H=this.fuBox;var N=this.urlInput;var L=(this.ultp.selectedIndex===0);var M=H.fileNode.value;var O;if(this.ultp.selectedIndex===0){var I=this.fuBox.fileNode.value;O=I.substring(I.lastIndexOf("."));if(B(O)===0){E.displayError(J.applicationName(),"The following file extension "+O+" is not supported.",false);return ;}}if(H.fileNode.files[0]!==undefined){if(H.fileNode.files[0].size>J.fileUploadSize){O=M.substring(M.lastIndexOf(".")+1);E.displayError(J.applicationName(),"The maximum file size for "+O+" files is "+J.fileUploadSize/(1024*1024)+" MB.",false);return ;}}if(!this.isExtensionValid()&&(J.operationMode!==A.operationMode.create)){E.displayError(J.applicationName(),"Switching the file type is not allowed during republishing or editing the cube.",false);return ;}var F={taskContentType:"json",sessionState:mstrApp.sessionState,fileType:"application/octet-stream",fileName:H.fileNode.value};if(J.cubeID!==""){F.reportid=J.cubeID;}var K={success:function(R){var Q=A.requestFlag.sourceInfo|A.requestFlag.sheets|A.requestFlag.preview|A.requestFlag.mapping,S=G.checked?0:-1,P={success:function(T){J.populate(T,Q,Q);if(G.checked){J.set("curPg",A.pageType.preview);}else{if(J.operationMode!==A.operationMode.create){if(J.currentSource.sheets.length>1){C.model=J;mstrmojo.insert(C).render();}else{mstrmojo.DI.DISharedViewer.publish(J);}}}},failure:function(T){J.hideWaitPage();E.displayError(J.applicationName(),"Error in importing the file. Please check the file to import.",false);}};if(L){J.set("msgid",R.content.msg_id);}else{J.set("msgid",R.msg_id);}J.loadRptData(Q,S,P);},failure:function(P){E.displayError("Import Data","Error in importing the file. Please check the file being imported",false);}};if(J.currentSource){J.currentSource.reset();}if(L){H.submit(F,K);}else{J.importUrl(N.value,K);}},children:[{slot:"labelNode",scriptClass:"mstrmojo.Label",cssClass:"bigTxt",text:"Specify the location of the file you would like to upload"},{slot:"optionsNode",scriptClass:"mstrmojo.RadioListHoriz",cssClass:"upload-options",itemCssClass:"upload-options-item",alias:"ultp",selectedIndex:0,items:[{did:"0",n:"From My Computer/Network"},{did:"1",n:"From the URL(File://,Http://, Https://, Ftp://)"}]},{slot:"fileInputNode",scriptClass:"mstrmojo.FileUploadBox",cssClass:"upload-file",alias:"fuBox",uploadTaskId:"importFile",markupMethods:{onvalueChange:function(){this.inputNode.value=this.value;},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function(){if(this.parent.model.operationMode!==A.operationMode.create){if(this.parent.model.currentImportSource){if(this.parent.model.currentImportSource.sourceInfo){this.value="Previously uploaded file: "+this.parent.model.currentImportSource.sourceInfo.name;}}}},bindings:{visible:function(){return(this.parent.ultp.selectedIndex===0);}},markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"><form class="mstrmojo-FileUploadBox-form" target="{@id}_iframe" enctype="multipart/form-data" method="post" action="{@action}"><input class="uploadFileText" readonly="readonly" type="text"/><div class="mstrmojo-di-fu-buttonDiv"><div class="mstrmojo-di-blueButton">{@browseLabel}</div><input class="mstrmojo-FileUploadBox-file" type="file" {@multiple} size="30" style="font-size:4em;" name="{@fileFieldName}" onchange="mstrmojo.all.{@id}.synValue();"/></div><div style="display:none;"></div></form><iframe id="{@id}_iframe" + name="{@id}_iframe" style="display:none;" src="about:blank"></iframe></div>'},{slot:"urlInputNode",scriptClass:"mstrmojo.TextBox",cssClass:"upload-url",alias:"urlInput",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:function(){return(this.parent.ultp.selectedIndex==1);},value:function(){var F=this.parent.model.currentImportSource;if(F){if(F.sourceInfo){if(F.sourceInfo.name!==undefined){return this.parent.model.currentImportSource.sourceInfo.name;}}}return"";}}},{slot:"showPreviewNode",scriptClass:"mstrmojo.ImageCheckBox",cssClass:"preview",alias:"showPrv",label:"Show a preview of the data",bindings:{checked:function(){return(this.parent.model.operationMode===A.operationMode.create);},visible:function(){return(this.parent.model.operationMode!==A.operationMode.create);}},onclick:function(){mstrmojo.DI.DISharedViewer.set("showPreview",this.checked);}},{slot:"imageNode",scriptClass:"mstrmojo.Image",cssClass:"mstrmojo-di-fileImportImage",bindings:{visible:function(){return(this.parent.model.operationMode===A.operationMode.create);}}},{slot:"imageNode",scriptClass:"mstrmojo.Label",cssClass:"imageText",text:"Data can be tabular or crosstab format.",bindings:{visible:function(){return(this.parent.model.operationMode===A.operationMode.create);}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.DI.DataImportModel","mstrmojo.DI.SalesforceModel","mstrmojo.DI.DIConstants","mstrmojo.form","mstrmojo.Label","mstrmojo.MenuButton","mstrmojo.Table","mstrmojo.date","mstrmojo.array","mstrmojo.locales");var I=mstrmojo.date,O=" ",D="-",B=":",G=mstrmojo.DI.DIConstants.xdaType,R=mstrmojo.desc(9943,"Contact your administrator to configure access to Salesforce reports by enabling an https connection and setting the appropriate Salesforce parameters. See Help for more details."),P=1024;function H(T){mstrmojo.alert(T.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}function K(){return mstrApp.sfID&&mstrApp.sfSecret&&mstrApp.sfURL&&document.location.protocol.indexOf("https")>-1;}function C(T){var U=T.split(O),V=U[0].split(D),W=U[1].split(B);return new Date(Date.UTC(V[0],parseInt(V[1],10)-1,V[2],W[0],W[1],W[2]));}var J=function(U){var T=mstrmojo.all.SalesforceModel,V=T.oAuth;V.clientId=mstrApp.sfID;V.clientSecret=mstrApp.sfSecret;V.redirectUrl=mstrApp.sfURL;if(T.code){A(U);}};var M=function(){var U={taskId:"qBuilder.GetQuota",sessionState:mstrApp.sessionState};var T={success:function(X){mstrmojo.all.mstrDiIntro.usage=X.cubes.cusage;mstrmojo.all.mstrDiIntro.quota=X.cubes.cquota;var V=mstrmojo.desc(9101,"You are currently using ##MB of ###MB");V=V.replace("###",(X.cubes.cquota/P).toFixed(0)).replace("##",(X.cubes.cusage/P).toFixed(2));mstrmojo.all.mstrDiQuota.set("text",V);var W=X.cubes,Y=(W&&W.cube)||[];if(W.cn===1){(Y=[Y]);}mstrmojo.array.forEach(Y,function(Z){Z.dateObj=C(Z.nutm);Z.formatDate=Z.utm;});mstrmojo.all.mstrDiListOfCubes.set("items",Y);},failure:H};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,T,U);};var A=function(V){var U=mstrmojo.all.SalesforceModel;var T={success:function(W){var X=mstrmojo.all.mstrDiSalesforce;X.populate(W,U);V.set("curPg",mstrmojo.DI.DIConstants.pageType.sfList);V.hideWaitPage();},failure:function(){V.hideWaitPage();}};V.showWaitPage();U.getReports(T);};var L={CDOC:-2,CRPT:-3,CAYS:-4,DEL:-5};function N(U,T){switch(U){case L.CDOC:return{evt:"3104",src:microstrategy.servletName+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:T};break;case L.CRPT:return{iframe:"true",evt:["5005","17004"],src:[microstrategy.servletName+".create.5005",microstrategy.servletName+".create.ObjectExplorer.17004"],selectedObjectID:T,defaultevtlist:"17004"};break;case L.CAYS:return{evt:"3104",src:microstrategy.servletName+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:T,rwCreateFlags:"16",rwViewMode:"2048"};break;}return{};}function F(U){var T=mstrmojo.all.DIModel;if(T){T.showWaitPage();}mstrmojo.form.send(U,mstrApp.name,"post");}function Q(){var V=this.domNode,W=this.parent.data,Y="mstr-di-moreCM",X=mstrmojo.all[Y];if(!X){var T=[{n:mstrmojo.desc(8042,"Analysis"),did:L.CAYS,cssClass:"",feature:"CreateReportServices"},{n:mstrmojo.desc(2918,"Document"),did:L.CDOC,cssClass:"",feature:"WebDocumentDesign"},{n:mstrmojo.desc(5,"Report"),did:L.CRPT,cssClass:"",feature:"CreateViewReport"}];X=new mstrmojo.MenuButton({id:Y,cmCssClass:"mstrmojo-CXM",cm:T,domSrc:V,obj:W,dynamicUpdate:true,queryVisible:function(Z){return mstrApp.diParams&&mstrApp.diParams[Z.feature];},getMenuPosition:function U(){var Z=mstrmojo.dom.position(this.domSrc,true);return{x:Math.round(Z.x),y:Math.round(Z.y+Z.h)};},executeCommand:function(Z){var a=this.obj;F(N(Z.did,a.cube_id));}});X.render();}else{X.set("domSrc",V);X.set("obj",W);}X.showContextMenu();X.onContextMenuClose=function(){V.style.visibility="inherit";};}mstrmojo.DI.DIIntro=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.DI.DIIntro",usage:0,quota:0,layout:[{cells:[{cssText:"border-right: 1px solid #888888;vertical-align:top;width:25%;"},{cssText:"vertical-align:top;width:75%;"}]}],children:[{scriptClass:"mstrmojo.Box",alias:"sourcePane",id:"mstrDiPanelOfSources",slot:"0,0",cssText:"padding: 24px 15px 0 15px;",children:[{scriptClass:"mstrmojo.List",alias:"sourceList",id:"mstrDiListOfSources",cssClass:"mstrmojo-di",cssText:"padding: 12px 17px; height: 100%",itemMarkupFunction:function(T){return'<div class="mstrmojo-di-bullet '+T.icon+'" style="padding: 10px 0px 10px;"><table cellpadding="0" cellspacing="0"><tr><td class="mstrmojo-di-icons '+T.icon+'"> </td><td '+(T.xda===G.salesforce?' id="mstrDiSf"':"")+'style="vertical-align: top; padding-left: 10px;">'+(T.icon==="SF"?'<div class="mstrmojo-di-source-name-disabled">':'<div class="mstrmojo-di-source-name">')+T.n+"</div>"+(T.icon==="SF"?'<div style="font: 11px Tahoma; color: #aaaaaa;">':'<div style="font: 11px Tahoma; color: #5b5b5b;">')+T.desc+"</div>"+(T.icon==="SF"?'<div class="SFTooltip">'+R+"</div>":"")+"</td></tr></table></div>";},onchange:function(U){var V=this.items[this.selectedIndex],T;switch(V.xda){case G.text:T=true;case G.salesforce:if(K()||T){var W={evt:"3137",src:microstrategy.servletName+".3137",isNew:"true",DataImportSource:T?"0":"2"};mstrApp.isNewAnalysis&&(W.isNewAnalysis="true");mstrApp.messageID&&(W.messageID=mstrApp.messageID);mstrApp.diParams.AnalysisId&&(W.analysisID=mstrApp.diParams.AnalysisId);F(W);}break;case G.ffsql:F({evt:"3171",src:microstrategy.servletName+".3171",FFsql:"true",isNewAnalysis:mstrApp.isNewAnalysis,messageID:mstrApp.messageID,analysisID:mstrApp.diParams.AnalysisId||""});break;case G.querybuilder:F({evt:"3171",src:microstrategy.servletName+".3171",isNewAnalysis:mstrApp.isNewAnalysis,messageID:mstrApp.messageID,analysisID:mstrApp.diParams.AnalysisId||""});break;default:break;}}}]},{scriptClass:"mstrmojo.Box",id:"mstrDiQuotaAndListOfCubes",slot:"0,1",items:[],children:[{scriptClass:"mstrmojo.Label",id:"mstrDiQuota",cssText:" font:12px Tahoma; font-weight:bold; color:#FFFFFF; background:#989898; padding:8px 0 7px 10px;",text:""},{scriptClass:"mstrmojo.DataGrid",cssClass:"mstrmojo-di-QuotaGrid",id:"mstrDiListOfCubes",resizableColumns:false,bindings:{items:"this.parent.items"},sortBy:{n:1,sz:1,own:1,dt:1},columns:[{headerWidget:{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(945,"Name"),cssClass:"headerText",onclick:function(){var V=this.dataGrid;V.sortBy.n=-V.sortBy.n;var U=V.sortBy.n;var T=[];T=T.concat(V.items);V.set("items",T.sort(function(X,W){return(X.cname.toLowerCase()<W.cname.toLowerCase())?U:(-U);}));}},colCss:"nameCol",dataWidget:{scriptClass:"mstrmojo.Table",cssClass:"nameTable",layout:[{cells:[{rowSpan:3,cssClass:"cubeCell"},{colSpan:6}]},{cells:[{},{},{},{},{},{}],cssClass:"actions"}],children:[{slot:"0,0",scriptClass:"mstrmojo.Image",cssClass:"mstrIcon-lv mstrIcon-lv-cb",cssText:"margin:-9px 10px 0 0;"},{slot:"0,1",scriptClass:"mstrmojo.Label",cssClass:"nameLabel",bindings:{text:function(){var T=this.parent.data.cname;return mstrmojo.string.escape4HTMLText(T);}}},{slot:"1,0",scriptClass:"mstrmojo.HBox",onRender:function(){var T="auto";this.domNode.parentNode.style.width=T;},children:[{scriptClass:"mstrmojo.Label",cssClass:"morelink",text:mstrmojo.desc(3291,"Create"),onclick:function(){this.parent.children[1].onclick();},onRender:function(){var V=[{did:L.CAYS,feature:"CreateReportServices",txt:mstrmojo.desc(8042,"Create Dashboard")},{did:L.CDOC,feature:"WebDocumentDesign",txt:mstrmojo.desc(2918,"Create Document")},{did:L.CRPT,feature:"CreateViewReport",txt:mstrmojo.desc(5,"Create Report")}],T=0,U=0,W=this.parent.parent.data.cube_id;if(mstrApp.diParams){mstrmojo.array.forEach(V,function(Y,X){if(mstrApp.diParams[Y.feature]){T++;U=X;}});if(T===0){this.set("visible",false);this.parent.children[1].set("visible",false);}else{if(T===1){this.set("text",V[U].txt);this.onclick=function(){F(N(V[U].did,W));};}}}}},{scriptClass:"mstrmojo.Label",cssClass:"menu-arrow",onclick:function(){this.parent.domNode.style.visibility="visible";Q.call(this.parent);}}]},{slot:"1,1",scriptClass:"mstrmojo.Label",cssClass:"editlink",text:mstrmojo.desc(1088,"Edit"),onRender:function(){if(mstrApp.diParams&&mstrApp.diParams.Republish){this.domNode.parentNode.style.width="35px";}else{this.set("visible",false);}},onclick:function(){var a=this.parent.data,Z=a.cube_id,X=a.xt,W=mstrmojo.DI.DIConstants.xdaType,U=false,V=false,Y;var T={success:function(b){var c=b.objects[0].pf.did;switch(parseInt(X,10)){case W.querybuilder:V=true;case W.ffsql:Y={evt:"3171",src:microstrategy.servletName+".3171",reportID:Z,isCube:1,FolderID:c};!V&&(Y.FFsql=true);F(Y);break;case W.text:case W.excel:U=true;case W.salesforce:Y={evt:"3137",src:microstrategy.servletName+".3137",isEdit:"true",cubeID:Z,folderId:c};!U&&(Y.DataImportSource="2");F(Y);break;default:break;}},failure:H,complete:function(){iframe.hideWaitPage();}};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,T,{taskId:"getObjectInfo",objectIDs:Z,objectTypes:3,includeParentFolder:true,sessionState:mstrApp.sessionState});}},{slot:"1,2",scriptClass:"mstrmojo.Label",cssClass:"deletelink",text:mstrmojo.desc(629,"Delete"),onRender:function(){if(mstrApp.diParams&&mstrApp.diParams.Delete){this.domNode.parentNode.style.width="50px";}else{this.set("visible",false);}},onclick:function(){var X=mstrmojo.all.DIModel;var W=this.parent.data,V=W.cube_id;X&&X.showWaitPage();mstrmojo.xhr.request("POST",mstrApp.taskURL,{success:function T(Y){M();},failure:function U(Y){H(Y);},complete:function(){X&&X.hideWaitPage();}},{taskId:"arch.deleteObject",sessionState:mstrApp.sessionState,objectid:V,objecttype:3});}},{slot:"1,3",scriptClass:"mstrmojo.Label",cssClass:"schedulelink",text:mstrmojo.desc(1085,"Schedule"),onRender:function(){if(mstrApp.diParams&&mstrApp.diParams.Subscriptions){this.domNode.parentNode.style.width="65px";}else{this.set("visible",false);}},onclick:function(){var T=this.parent.data.cube_id;F({evt:"3032",src:microstrategy.servletName+".3032",objectType:"3",objectID:T});}},{slot:"1,4",scriptClass:"mstrmojo.Label",cssClass:"sharelink",text:mstrmojo.desc(9099,"Share"),onRender:function(){if(mstrApp.diParams&&mstrApp.diParams.Share){this.domNode.parentNode.style.width="45px";}else{this.set("visible",false);}},onclick:function(){var X=this.parent.data,W=X.cube_id,U=mstrApp.appPath,V="&",T=microstrategy.servletName;U=[U,T,"?evt=3104&src=",T,".3104&executionMode=1&rwDesignMode=0&rwViewMode=2048&objectID=",W,"&objectType=3&rwCreateFlags=16"].join("");microstrategy.showSharingEditor&&microstrategy.showSharingEditor(U,{objId:W,objType:3,objectName:X.cname,mid:-1});}},{slot:"1,5",scriptClass:"mstrmojo.Label",cssClass:"republishlink",text:mstrmojo.desc(9242,"Republish"),onRender:function(){if(mstrApp.diParams&&mstrApp.diParams.Republish){this.domNode.parentNode.style.width="70px";}else{this.set("visible",false);}},onclick:function(){F({evt:"4001",src:microstrategy.servletName+".4001",visMode:"0",reportViewMode:"1",reportID:this.parent.data.cube_id});}}]}},{headerWidget:{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(8724,"Size (KB)"),cssClass:"headerText",onclick:function(){var V=this.dataGrid;V.sortBy.sz=-V.sortBy.sz;var U=V.sortBy.sz;var T=[];T=T.concat(V.items);V.set("items",T.sort(function(X,W){return(parseInt(X.sz,10)<parseInt(W.sz,10))?U:(-U);}));}},colCss:"sizeCol",dataWidget:{scriptClass:"mstrmojo.Label",cssClass:"sizeLabel",bindings:{text:"this.parent.data.sz"}}},{headerWidget:{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(60,"Owner"),cssClass:"headerText",onclick:function(){var V=this.dataGrid;V.sortBy.own=-V.sortBy.own;var U=V.sortBy.own;var T=[];T=T.concat(V.items);V.set("items",T.sort(function(X,W){return(X.n.toLowerCase()<W.n.toLowerCase())?U:(-U);}));}},colCss:"ownerCol",dataWidget:{scriptClass:"mstrmojo.Label",cssClass:"ownLabel",bindings:{text:"this.parent.data.n"}}},{headerWidget:{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(61,"Modified"),cssClass:"headerText",onclick:function(){var V=this.dataGrid;V.sortBy.dt=-V.sortBy.dt;var U=V.sortBy.dt;var T=[];T=T.concat(V.items);V.set("items",T.sort(function(X,W){return(X.dateObj.getTime()<(W.dateObj.getTime()))?U:(-U);}));}},colCss:"modifiedCol",dataWidget:{scriptClass:"mstrmojo.Label",cssClass:"mtLabel",bindings:{text:"this.parent.data.formatDate"}}}]}]}],populate:function(){var U=[];var T=function T(V,W,X,Z,Y){V.push({t:12,icon:W,xda:X,n:Z,desc:Y});};T(U,"File",G.text,mstrmojo.desc(4700,"File"),mstrmojo.desc(9096,"Import an Excel, CSV or Text file"));if(mstrApp.allowImportDB){T(U,"Cube",G.querybuilder,mstrmojo.desc(1563,"Database"),mstrmojo.desc(9098,"Import from Relational data sources"));}T(U,(K()?"SFA":"SF"),G.salesforce,mstrmojo.desc(9213,"Salesforce"),mstrmojo.desc(9214,"Import your Reports from Salesforce.com"));if(mstrApp.allowImportDB){T(U,"Database",G.ffsql,mstrmojo.desc(9095,"Freeform"),mstrmojo.desc(9097,"Import Data using a Script:SQL,XQuery,SOQL or HiveQL"));}this.sourcePane.sourceList.set("items",U);if(K()){J(this.model);}M();},resize:function S(T,U){if(!this.domNode){return ;}var W=T*0.3;if(W<300){W=300;}var X=T-W;this.domNode.rows[0].cells[0].style.width=W+"px";this.domNode.rows[0].cells[1].style.width=X+"px";this.setListBaseItemsContainerSize(document.getElementById("mstrDiPanelOfSources"),"100%","100%");var V=document.getElementById("mstrDiQuotaAndListOfCubes");V.style.height=U+"px";V.style.width=X+"px";},setListBaseItemsContainerSize:function E(W,T,V){var U;for(U=0;U<W.children.length;U++){if(W.children[U].className=="mstrmojo-ListBase2-itemsContainer"){W.children[U].style.width=T;W.children[U].style.height=V;}this.setListBaseItemsContainerSize(W.children[U],T,V);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.MenuButton","mstrmojo.Label","mstrmojo.form","mstrmojo.DI.DISharedViewer","mstrmojo.DI.DIConstants");mstrmojo.requiresDescs(2140,373,172,1059,8132,3345,1279,9115);var A=mstrmojo.DI.DIConstants;mstrmojo.DI.DIFooter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DI.DIFooter",cssClass:"mstrmojo-di-footer",markupString:'<div id="{@id}" class="mstrmojo-di-footer {@cssClass}" ><div class="footer-buttons"></div><div class="footer-buttons"></div><div class="footer-buttons"></div><div class="footer-cancel-button"></div><div class="footer-preview-info"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},navigateNode:function(){return this.domNode.children[0];},nextNode:function(){return this.domNode.children[1];},backNode:function(){return this.domNode.children[2];},cancelNode:function(){return this.domNode.children[3];},infoNode:function(){return this.domNode.children[4];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},model:null,currentPage:function(){switch(this.model.curPg){case A.pageType.file:return this.parent.children.fileUpload;case A.pageType.preview:return this.parent.children.preview;}},children:[{scriptClass:"mstrmojo.Label",slot:"infoNode",text:"Preview shows only first 50 rows of data",cssClass:"mstrmojo-di-previewinfo",bindings:{visible:function(){return(this.parent.model.curPg==A.pageType.preview);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-button",text:mstrmojo.desc(2177,"Close"),slot:"cancelNode",onclick:function(){mstrmojo.form.send({evt:"3124",src:microstrategy.servletName+".import.3124",relativePageNumber:"-1"},mstrApp.name,"POST",null,null,false);}},{slot:"backNode",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-button",text:mstrmojo.desc(373,"Back"),onclick:function(){var B=this.parent.model;B.set("curPg",B.curPg-1);},bindings:{visible:function(){return(this.parent.model.curPg==A.pageType.preview);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-button publish",alias:"next",slot:"nextNode",bindings:{visible:function(){return(this.parent.model.curPg!==A.pageType.intro);},text:function(){var B=mstrmojo.DI.DISharedViewer;if(this.parent.model.curPg==A.pageType.preview){return mstrmojo.desc(172,"Publish");}else{if(mstrmojo.DI.DISharedViewer.showPreview){return mstrmojo.desc(1059,"Next");}else{return mstrmojo.desc(172,"Publish");}}},enable:function(){if(this.parent.model.curPg==A.pageType.file){if(mstrmojo.DI.DISharedViewer.sourceSelected){return true;}else{return false;}}}},onclick:function(){this.parent.parent.currentPage.onNextButtonClick();},postBuildRendering:function(){mstrmojo.DI.DISharedViewer.attachEventListener("showPreviewChange",this.id,function(){if(mstrmojo.DI.DISharedViewer.showPreview){this.text=mstrmojo.desc(1059,"Next");}else{this.text=mstrmojo.desc(172,"Publish");}});}},{scriptClass:"mstrmojo.MenuButton",slot:"navigateNode",iconClass:"mstrmojo-ArchitectListIconBlock redirect",postCreate:function(){this.cm=[{did:3,n:mstrmojo.desc(8132,"Analysis")},{did:2,n:mstrmojo.desc(3345,"Document")},{did:1,n:mstrmojo.desc(1279,"Report")},{did:0,n:mstrmojo.desc(9115,"Exit")}];},dynamicUpdate:true,queryChecked:function(B){return(B.did==this.parent.model.redirect);},executeCommand:function(B){this.parent.model.redirect=B.did;},bindings:{visible:function(){return(this.parent.model.curPg==A.pageType.preview);}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st];},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc());}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){this.getContent(this);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new mstrmojo.TreeBrowserNode({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}else{var J=this.selectionParentNode;return J&&J.getSelectedItems();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch");var A=mstrmojo.meta.TP,K="5CECE58CC1D549F890EB61C4DB2156A3",H="E0CCB9CF22104A489CBE78D974AFD19E",B=function(R,S){var Q=mstrmojo.insert({scriptClass:"mstrmojo.OBList",items:S});Q.render();return Q;},D={success:function(S){var T=this.ob,R=S.items,Q=T.pageCache[T.currentPage]._w;Q.set("items",R);this.ob=null;this.item=null;window.clearTimeout(T._btm);T.booklet.set("waiting",false);},failure:function(Q){window.alert(Q.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},C=function(T,S,Q){var U=O(T,S,false),R=!U;U=U||O(T,S,true);if(!U){T._btm=window.setTimeout(function(){T.booklet.set("waiting",true);},300);Q.ob=T;Q.item=S;T.dataProvider.fetchFolderContents(T,S,Q);}else{G(T,S,U,true,R);}},N=function(R,S,T,Q){C(R,{fid:R.pageCache[R.currentPage].did,blockBegin:S,searchPattern:T,recursive:Q},D);},I=function(R,S){var Q=S.anc;Q=Q&&Q.items;Q=Q&&Q[0];Q=Q&&Q.items;R.set("canGoUp",!(!S.pf||!Q));},G=function(U,T,V,S,R){delete U._btm;var Q;if(!S){Q=B(this,V.items);Q.attachEventListener("change",U.id,"navigate");}else{Q=V._w;}U.booklet.turn(Q,!R);if(!S){E(U,T,Q,V);}U.set("currentFolder",V);U.set("currentPage",U.currentPage+(R?-1:1));I(U,V);},F={success:function(R){var S=this.ob;if(S){window.clearTimeout(S._btm);if(!R.items){R.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var Q=function T(U){var X=U.length;for(var V=0;V<X;V++){var W=U[V];if(W.did===K||W.did===H){W.n=(W.did===K)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(W.items){Q(W.items);}}};if(R.did===K||R.did===H){R.n=(R.did===K)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(R.anc&&R.anc.items){Q(R.anc.items);}}G(S,this.item,R,false,false);this.ob=null;this.item=null;}},failure:function(Q){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(Q);}else{window.alert(Q.getResponseHeader("X-MSTR-TaskFailureMsg"));}}},E=function(U,T,S,V){var W=U.currentPage+1;var R=U.pageCache.length;for(var Q=W;Q<R;Q++){U.pageCache[Q]._w.destroy();delete U.pageCache[Q].items;}U.pageCache=U.pageCache.slice(0,W);V._w=S;V._k=T.k;U.pageCache[W]=V;U.cacheChange();},O=function(T,S,R){var U=T.currentPage+(R?-1:1);if(T.pageCache.length>U&&U>=0){var Q=T.pageCache[U];if(Q._k==S.k){return Q;}}return false;},M=function(S){var R=S.pageCache.length;for(var Q=0;Q<R;Q++){S.pageCache[Q]._w.destroy();}S.pageCache=[];S.currentPage=-1;S.cacheChange();},J=function(S,R){if(R&&R.acg==33){return ;}var Q={};if(R){Q.k=R.did;Q.fid=R.did;}else{if(S.rootFolderID){Q.k=S.rootFolderID;Q.fid=S.rootFolderID;}else{if(S.rootFolderType){Q.k=S.rootFolderType;Q.fty=S.rootFolderType;}else{if(S.folderLinksContextId){Q.k=S.folderLinksContextId;}}}}C(S,Q,F);},P=function(V,Q,S){if(!S){return Q;}var T=V.showCompletePath,X=Q[0],U,R;while(X){for(var W=0;W<S.length;){if(X.did==S[W].did){S.splice(W,1);X._isSc=true;}else{W++;}}R=X;X._open=true;X=X.items;X=X&&X[0];if(!X){R.lastLeaf=true;}}if(!T){X=Q[0];while(X){if(X._isSc){Q[0]=X;break;}X=X.items;X=X&&X[0];}}return Q.concat(S);},L=function(R,Q,S){R._naviInfo=P(R,Q,S);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,showCompletePath:true,dataProvider:mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"}),markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var Q=this.opener.parent.parent,S=this.tree,R=Q._naviInfo;if(S.items!=R){S._pup=this;this.ob=Q;S.set("items",R);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(T,Q,R){var S=mstrmojo.WidgetTree.prototype.itemFunction(T,Q,R);if(T._open){S.state=1;}S._ll=!!T.lastLeaf;S._pup=R._pup;S.onmousedown=function(U){if(!this._ll){var V=mstrmojo.dom.eventTarget(U.hWin,U.e);if(V==this.domNode||V==this.textNode){var W=this._pup;W.close();J(W.ob,this.data);}}};S.markupMethods.onstateChange=function(){var U=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[U]||"closed");this.itemsContainerNode.style.display=(U===1)?"block":"none";};return S;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up one level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 5px 0; ",width:"105px",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,bindings:{quickSearch:"this.parent.parent.quickSearch"},preFetch:function(){this.objectTypes=(this.parent.parent.browsableTypes)?this.parent.parent.browsableTypes:this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssText:"width:100%;background-color:white;",alias:"booklet"},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046),p:mstrmojo.desc(1058),n:mstrmojo.desc(1059),l:mstrmojo.desc(4049),pgs:mstrmojo.desc(5972),gt:mstrmojo.desc(5878),v:mstrmojo.desc(6079)},onvisibleChange:function(R){var T=parseInt(this.height,10),Q=this.np>1,S={target:this.domNode,props:{height:{start:(Q?0:T),stop:(Q?T:0),suffix:"px"}},onEnd:function(){if(Q){this.target.style.overflow="visible";}}},U=new mstrmojo.fx.AnimateProp(S);this.domNode.style.overflow="hidden";U.play();},onifsChange:function(Q){var R=this.np;mstrmojo.hash.copy(Q.value,this);if(this.np>1){this.children=null;this.refresh();}if(R<=1&&this.np>1||R>1&&this.np<=1||R===0&&this.np>0){this.set("visible",this.np>1);}this.cssText="";}}],postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var S=this.searchUpBar;if(S&&S.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var Q=this.obSearchBox.contentWidget||this.obSearchBox;Q.attachEventListener("ifsChange",this.id,function(T){this.obIncFetch.set("ifs",T.value);});}if(this.obIncFetch){var R=this.obIncFetch;R.attachEventListener("fetch",this.id,function(T){R.cp=T.v;R.children=null;R.refresh();N(this,(T.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}},onSearchItemsChange:function(R){var S=R.value,Q=this.pageCache[this.currentPage]._w;if(!S||S.length==0){S=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}Q.set("items",S);},navigate:function(Q){var R=Q&&Q.src.selectedItem;if(R&&R.did=="empty"){return ;}if(!R||R[A]==8){J(this,R);}else{if(R){this.select(R);}}},onFishEyeChange:function(Q){this.goToPage(Q.value);},goToPage:function(Q){if(Q<this.pageCache.length&&Q!=this.currentPage){var S=Q>this.currentPage,R=this.pageCache[Q];this.set("currentPage",Q);this.booklet.turn(R._w,S);this.set("currentFolder",R);I(this,R);}},oncurrentPageChange:function(Q){if(this.fishEye){this.fishEye.setSelectedIndex(Q.value);}var R=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(R.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",R.items||[]);this.obSearchBox.set("totalSize",R.sz);this.obSearchBox.set("rootID",R.did);this.obSearchBox.clearSearch();}if(this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(R.sz/R.bc)+((R.sz%R.bc>0)?1:0),cp:Math.floor(R.bb/R.bc)+((R.bb%R.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(R){for(var Q in R){this[Q]=R[Q];}if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}M(this);this.navigate();},close:function(){var R=this.ctx||this,Q=R.onCloseCB;if(Q){Q[0][Q[1]]();}R.set("visible",false);},select:function(R){var Q=this.onSelectCB;if(Q){Q[0][Q[1]](R);}if(this.closeOnSelect){this.close();}},goUp:function(){if(this.canGoUp){J(this,{did:this.currentFolder.pf});}},oncurrentFolderChange:function(Q){var R=Q.value;L(this,R.anc.items,R.sc);},refreshContent:function(Q){N(this,Q);},onError:null,onheightChange:function(){var Q=["titleBar","fishEye","searchUpBar","obIncFetch"],T=0,S=0;for(var R in Q){T+=parseInt(this[Q[R]].domNode.offsetHeight);}S=parseInt(this.height)-T;this.booklet.set("height",S+"px");}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser");function B(){var E={alias:"newFolder",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon nf",title:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var F=this.parent.parent.parent;F.openPopup("newFolder",{zIndex:F.zIndex+10});}},D=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);tc=D[0].children;if(tc&&tc.length>2){tc.splice(2,1,E);}return D;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B()});var A={success:function(D){var E=this.parent;if(E.onObjectSaved){E.onObjectSaved({name:E.name,did:D.did,desc:E.desc});}mstrmojo.confirm(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",E.typeDesc||"Object").replace("###",E.name),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(7984,"Object Saved"));E.ob.refreshContent();E.close();},failure:function(E){var D=parseInt(E.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,F=this.parent;if(D==2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",F.typeDesc||"Object").replace("###",F.name),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(219),function(){F.saveAs(true);},null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(218),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})],mstrmojo.desc(3179));}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+E.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",help:"Save_As_dialog_box.htm",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3379,"To the folder:"),cssText:"padding-bottom:6px;"},{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,searchVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];}},{scriptClass:"mstrmojo.Table",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBSelect:function(D){this.set("name",D.n);},saveAsCallback:function C(){return A;},saveAs:function(F){var E=this.contPanel;this.name=E.name.value;this.desc=E.desc.value;if(!this.name){mstrmojo.confirm(mstrmojo.desc(3380,"Please enter valid name"),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return ;}var G=this.saveParams||{};G.folderID=this.ob.currentFolder.did;G.description=this.desc||"";G.name=this.name||"";G.saveAsOverwrite=!!F;if(this.sId){G.sessionState=this.sId;}var D=this.saveAsCallback();D.parent=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,D,G);},createFolder:function(F,I){if(!F){mstrmojo.confirm(mstrmojo.desc(3380),[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442),null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return -1;}var G=this.newFolder,E=this.ob,J=E&&E.dataProvider,H=E&&E.currentFolder.did,D={success:function(K){E.refreshContent();G.contPanel.name.set("value","");G.contPanel.desc.set("value","");},failure:function(K){window.alert(K.getResponseHeader("X-MSTR-TaskFailureMsg"));}};J.newFolder(H,F,I,D);}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(G.createFolder(D,F)!=-1){E.close();}}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.close();}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.array","mstrmojo.TreeBrowser","mstrmojo.fx");var E=mstrmojo.hash;var B=[{n:mstrmojo.desc(2461,"All"),did:"all"}],A=[{n:mstrmojo.desc(873,"Year"),did:1},{n:mstrmojo.desc(10050,"Quarter"),did:2},{n:mstrmojo.desc(10051,"Quarter of Year"),did:4},{n:mstrmojo.desc(871,"Month"),did:8},{n:mstrmojo.desc(10049,"Month of Year"),did:16},{n:mstrmojo.desc(10048,"Week"),did:32},{n:mstrmojo.desc(10047,"Week of Year"),did:64},{n:mstrmojo.desc(2052,"Date"),did:128},{n:mstrmojo.desc(10046,"Day of Month"),did:256},{n:mstrmojo.desc(10045,"Day of Week"),did:512}],F=[{n:mstrmojo.desc(10042,"Hour"),did:1024},{n:mstrmojo.desc(10043,"Minute"),did:2048},{n:mstrmojo.desc(10044,"Second"),did:4096}];var D=false;mstrmojo.qb.TimeDimension=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.TimeDimension",markupString:'<div id="{@id}"  class="{@cssClass}" style="top:{@top};left:{@left};width:155px;height:{@height};"><div style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown,click><div class="mstrmojo-qb-mapping-title">{@title}</div><div class="mstrmojo-qb-mapping-time"></div><div class="mstrmojo-qb-mapping-buttons"></div></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild.childNodes[1];},titleNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];}},top:"0px",left:"0px",height:"320px",title:"Please select additional time attributes that you want to create.",mode:3,_close:function(){var G=this.parent;if(G&&G._cmSource){G._cmSource.closeMenuTree();}},onOK:function(){var I=this.timebrowser.getTotalSelections();var M=this.parent,H=M._cmSource;if(H.executeCommand){this.data.geo=false;var K=I.slice(),L=0;for(var J=0,G=K.length;J<G;J++){(K[J].did!=="all")&&(L=L|K[J].did);}this.data.der=L;H.executeCommand(this.data);}this._close();},onCancel:function(){this._close();},children:[{scriptClass:"mstrmojo.TreeBrowser",slot:"contentNode",alias:"timebrowser",noCheckBox:false,itemIdField:"did",itemDisplayField:"n",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,multiSelect:true,cssClass:"mstrmojo-qb-time-tree",isBranch:function C(G){return false;},bindings:{items:function(){var H=this.parent.mode,G=[];switch(H){case 1:G=B.concat(A);break;case 2:G=B.concat(F);break;case 3:G=B.concat(A).concat(F);break;default:break;}return G;}},onchange:function(M){var J=M.added,L=M.removed;if(D){D=false;return ;}if(J){var H=this.items,K=H.length,G,I=this.selectedIndices;if(J[0]===0){for(G=0;G<K;G++){if(!I[G]){D=true;this.setSelectedItems(H,true);break;}}}else{for(G=1;G<K;G++){if(!I[G]){return ;}}if(!I[0]){D=true;this.toggleSelect(0,false);}}}if(L){if(L[0]===0){this.clearTreeSelect();}else{if(this.selectedIndices[0]){D=true;this.toggleSelect(0,false);}}}},onRender:function(){var K=this.parent.der,J=this.items,H=[];for(var I=0,G=J.length;I<G;I++){(K&J[I].did)&&(H.push({did:J[I].did}));}(G==H.length+1)&&(H.push({did:"all"}));H.length&&this.setSelectedItems(H,true);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox cf",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(1442,"OK"),onclick:function(G){var H=this.parent.parent;if(H.onOK){H.onOK();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(G){var H=this.parent.parent;if(H.onCancel){H.onCancel();}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.TreeBrowser","mstrmojo.fx","mstrmojo.array","mstrmojo.hash");var Q=mstrmojo.desc(8953,"Suggestions"),D=mstrmojo.desc(9135,"No match found"),P=mstrmojo.dom,R=mstrmojo.css,N=mstrmojo.hash,F=16,S,C;function I(X,V){var W=X.did,U=X.n;var T={success:function(c){if(c.container){var a=c.container.dssforms;a=a?a:[];for(var b=0,Z=a.length;b<Z;b++){a[b].aid=W;a[b].an=U;a[b].did=W+a[b].dssid;a[b].idf=a[0].dssid;}if(V&&V.success){V.success({items:a});}}},failure:function(Z){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}};var Y={taskId:"getAttributeForms",attributeID:W,displayedForms:0};mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,T,Y);}mstrmojo.qb.AttributeMapping=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup],{scriptClass:"mstrmojo.qb.AttributeMapping",markupString:'<div id="{@id}"  class="mstrmojo-Editor {@cssClass}" style="top:{@top};left:{@left};"><div style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown><div class="mstrmojo-qb-mapping-searchbox" mstrAttach:click ><input class="mstrmojo-SearchBox-input mstrmojo-qb-mapping-searchinput" type="text"  mstrAttach:keyup,blur/><span class="mstrmojo-qb-mapping-spinnerbox" style="width:20px;"><span class="mstrmojo-SearchBox2-spinner" id="{@id}sbSpinner"></span></span></div><div class="mstrmojo-qb-mapping-search-status"></div><div class="mstrmojo-qb-mapping-search-content"></div><div class="mstrmojo-qb-mapping-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild.childNodes[2];},inputNode:function(){return this.domNode.firstChild.firstChild.firstChild;},spinnerNode:function(){return this.domNode.firstChild.firstChild.lastChild.lastChild;},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},statusNode:function(){return this.domNode.firstChild.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;}},blockCount:50,cssClass:"mstrmojo-qb-mapping-editor",children:[{scriptClass:"mstrmojo.TreeBrowser",slot:"contentNode",alias:"tree",noCheckBox:false,itemIdField:"did",cssClass:"mstrmojo-qb-mapping-tree",items:[],isBranch:function H(T){return T.items;},item2textCss:function E(T){return("mstrmojo-ArchitectListIcon "+(T.items?"t12":"t21"));},selectionAcrossBranch:false,listSelector:mstrmojo.ListSelector,multiSelect:false,getContentThroughTaskCall:function L(V,U){var T=this;if(V.isRoot){U.success(T.items);}else{I(V.data,U);}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-qb-mapping-status",slot:"statusNode",alias:"status",text:Q},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-qb-mapping-buttonbox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-attributelink-button",cssText:"float: right",text:mstrmojo.desc(1442,"OK"),onclick:function(V){var Y=this.parent.parent;var X=Y.children[0].getTotalSelections();if(X&&X.length>0){var W=mstrmojo.all.QBuilderModel,a=W.mappings,U=mstrmojo.array.find(a,"did",Y.did),Z=a[U];var T={success:function(){Y.close();Z.alias=X[0].an;Z.ipa=1;Z.fmn=X[0].n;Z.tp=12;Z.oid=X[0].aid;Z.nochange=true;Z.georole=0;Z.der=0;Y.target.parent.dataGrid.populatePreview();},failure:function(b){Y._displayError(b);}};W.mapAttribute(Y.did,X[0].aid,X[0].dssid,X[0].idf,T,Z.oid);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-attributelink-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(T){var U=this.parent.parent;U.close();}}]}],_displayError:function K(U){var T=this.status;T.set("text",U);T.set("title",U);R.addClass(T.domNode,"error");this.adjustPosition();},onEnter:function(){this._onsearch();},onEsc:function(){if(this.onCancel){this.onCancel();}this.close();},close:function(){P.detachEvent(document.body,"mousedown",this._close_handler);if(this.target){R.toggleClass(this.target.domNode,"highlight",false);}this.buttonNode.style.display="none";this.statusNode.style.display="none";this.slideProp(false,this.contentNode,95);this.slideProp(false,this.inputNode,16);var T=this.domNode;self.setTimeout(function(){document.body.removeChild(T);},510);},onkeyup:function M(U){var T=U.hWin,X=U.e||T.event;if(this.onEnter&&X.keyCode===13){this.onEnter();return ;}if(this.onEsc&&X.keyCode===27){this.onEsc();return ;}if(microstrategy.enableQuickSearch){if(this._autoSearchTimer){self.clearTimeout(this._autoSearchTimer);}var W=microstrategy.searchAutoCompleteDelay,V=this;if(W){this._autoSearchTimer=self.setTimeout(function(){V._onsearch();},W);}else{this._onsearch();}}},slideProp:function(T,X,V){var U={target:X,props:{height:{start:(T?0:V),stop:(T?V:0),suffix:"px"}}};var W=new mstrmojo.fx.AnimateProp(U);W.play();},onshowContentChange:function A(){if(this.showContent){this.contentNode.style.display="block";this.slideProp(true,this.contentNode,95);this.buttonNode.style.display="block";}else{this.contentNode.style.display="none";this.buttonNode.style.display="none";}},_onsearch:function(){var V=mstrmojo.string.trim(this.inputNode.value),X=this;if(!V){return ;}var a={success:function Z(c){var d=[],b;S=S.toLowerCase();mstrmojo.array.forEach(c.items,function(f){if(f.n.toString().toLowerCase().indexOf(S)===0){d.push(N.copy({items:[],st:-5},f));}});C=d;b=d.length>0;X.status.set("text",b?Q:D);X.statusNode.style.display="block";X.set("showContent",b);R.removeClass(X.status.domNode,"error");X.children[0].set("items",d);},failure:function W(b){if(X.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+b.getResponseHeader("X-MSTR-TaskFailureMsg").replace(/com\.microstrategy\.(.*): \((.*)\)/,"$2"));}},complete:function U(b){if(X.spinnerNode){X.spinnerNode.style.display="none";}if(X.postFetch){X.postFetch();}}};var T=microstrategy.useQuickSearch();if(S&&V.indexOf(S)===0&&C.length<this.blockCount){S=V;a.success({items:C});return ;}S=V;if(this.spinnerNode){this.spinnerNode.style.display="block";}var Y={taskId:"searchMetadata",styleName:"MojoFolderStyle",nameWildcards:T?16:1,blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:true,includeAncestorInfo:true,objectType:"12",quickSearch:T};Y.searchPattern=T?V:V+"*";mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,a,Y);},attachMousedownEvent:function J(){var T=this;if(!this._close_handler){this._close_handler=function(){if(!T.isOnMe(P.eventTarget(self,arguments[0]))){T.close();}};}P.attachEvent(document.body,"mousedown",this._close_handler);},isOnMe:function G(T){return P.contains(this.domNode.firstChild,T,true,document.body);},adjustPosition:function O(){var U=this.domNode,W=U.firstChild,V=W.offsetHeight,T=W.offsetWidth,Y=P.windowDim(),X=P.position(W,false);if((X.x+T+F)>Y.w){W.style.left=Y.w-T-F+"px";}if((X.y+V+F)>Y.h){W.style.top=Y.h-V-F+"px";}},onOpen:function B(){var T=this.inputNode;this.tree.set("items",[]);T.value="";this.set("showContent",false);this.statusNode.style.display="none";if(!mstrmojo.dom.isWK){this.slideProp(true,T,16);}T.focus();this.attachMousedownEvent();}});})();(function(){mstrmojo.requiresCls("mstrmojo.HBox","mstrmojo.Box","mstrmojo.Table","mstrmojo.DataGrid","mstrmojo.qb.AttributeMapping","mstrmojo.qb.TimeDimension","mstrmojo.qb.GeoRole");var B=mstrmojo.css,O=mstrmojo.dom,K=mstrmojo.string;var L=mstrmojo.desc(11170,"This column contains geographical locations. Additional columns will be created automatically so that you can view your data on Google Maps. See menu options for details."),D=mstrmojo.desc(11171,"This column contains date values. Additional columns will be created automatically. See menu options for details.");var G=function(Q,S,U){var T={},V=Q;for(var R=0,P=S.length;R<P;R++){(S[R].tp==U)&&(T[S[R].alias]=1);}R=0;while(T[V]){V=Q+" ("+(++R)+")";}return V;};function M(S,P,Q){var T="mstrmojo-di-timedimension";var R=mstrmojo.all[T];if(!R){R=new mstrmojo.qb.TimeDimension({height:P,mode:S,der:Q});}else{R.set("height",P);R.set("mode",S);R.set("der",Q);}return R;}function N(T,P,R,Q){var U="mstrmojo-di-georole";var S=mstrmojo.all[U];if(!S){S=new mstrmojo.qb.GeoRole({height:"200px",georole:T,der:P,shapeKey:R,shapeKeys:Q});}else{S.set("georole",T);S.set("der",P);S.set("shapeKey",R);}return S;}var F=[{did:"QBAttribute",n:mstrmojo.desc(518,"Attribute"),items:[{did:"QBTimeGeo"}]},{did:"QBMetric",n:mstrmojo.desc(517,"Metric")},{did:"QBNone",n:mstrmojo.desc(9132,"Do not map")},{did:-1,n:"-"},{did:"QBRename",n:mstrmojo.desc(1388,"Rename")},{did:"QBMap",n:mstrmojo.desc(9133,"Link...")},{did:"QBUnMap",n:mstrmojo.desc(9134,"Unlink")},{did:-1,n:"-"},{did:"QBEdit",n:mstrmojo.desc(1088,"Edit")},{did:"QBRemove",n:mstrmojo.desc(629,"Delete")},{did:-1,n:"-"},{did:"QBDataType",n:mstrmojo.desc(9918,"Data Type"),items:[{did:"2",n:mstrmojo.desc(3434,"Number")},{did:"3",n:mstrmojo.desc(3544,"Text")},{did:"8",n:mstrmojo.desc(2052,"Date")},{did:"1",n:mstrmojo.desc(9919,"DateTime")},{did:"9",n:mstrmojo.desc(2170,"Time")},{did:"11",n:mstrmojo.desc(9920,"Big Decimal")},{did:"6",n:mstrmojo.desc(4699,"Email")},{did:"7",n:mstrmojo.desc(9921,"HTML Tag")},{did:"12",n:mstrmojo.desc(8984,"Phone Number")},{did:"10",n:mstrmojo.desc(4530,"Symbol")},{did:"5",n:mstrmojo.desc(9922,"URL")}]}];function I(Q,R,S){var P,T={1:1|2|4|8|16|32|64|128|256|512|1024|2048|4096,8:1|2|4|8|16|32|64|128|256|512,9:1024|2048|4096};P=T[S];P=P?P:(268435456|536870912|1073741824);Q.der=Q.der&P;R.der=Q.der;}var J={scriptClass:"mstrmojo.MenuButton",cssClass:"mstrmojo-di-datapreview-cxtmenu",cmCssClass:"mstrmojo-di-datapreview-popmenu",id:"mstrmojo-di-datapreview-cm",postCreate:function(){this.cm=F;},getMenuPosition:function H(){var P=mstrmojo.dom.position(this.domSrc,true);return{x:Math.round(P.x),y:Math.round(P.y+P.h)};},dataGrid:null,widget:null,dynamicUpdate:true,queryEnabled:function(P){var Q=this.widget;switch(P.did){case"QBAttribute":return !Q.nochange&&!Q.ipa&&!Q.multiForms;break;case"QBMetric":return !Q.nochange&&(Q.tp!=4)&&!Q.ipa&&(!Q.multiForms||!Q.isIDForm);break;case"QBNone":return Q.mapped;break;case"QBRename":return !Q.nochange&&!Q.ipa&&(!Q.multiForms||Q.isIDForm);break;case"QBEdit":case"QBMap":return !Q.nochange&&!Q.ipa;break;case"QBUnMap":return(Q.nochange||Q.ipa||Q.multiForms);break;default:return true;}},queryVisible:function(R){var Q=this.dataGrid,P=this.widget;switch(R.did){case"QBAttribute":case"QBMetric":case"QBRename":return this.widget.hasMapped;break;case"QBMap":case"QBUnMap":return this.widget.hasMapped&&this.widget.tp==12&&this.widget.sptMap;break;case"QBEdit":case"QBRemove":return !!this.widget.isQB&&(!this.widget.isReadOnly);break;case"QBNone":return !!this.widget.isDI;break;case"QBDataType":return this.widget.hasMapped&&this.widget.sptGeo&&this.widget.tp==12;break;default:return true;}},queryChecked:function(R){var P=this.widget;var Q=parseInt(R.did,10);if(Q>0&&Q<=12){return Q==P.dtp;}return false;},executeCommand:function(j){var k=this.widget.did;var S=this.dataGrid.model;var h=S.mappings;var b=mstrmojo.array.find(h,"did",k);var W=this.dataGrid;var Q;if(b!=-1){Q=mstrmojo.hash.copy(h[b]);}var d={success:function X(m){S.autoMap&&S.autoMap();},failure:function(m){h[b]=Q;W.populatePreview();}};switch(j.did){case"QBAttribute":if(b!=-1){h[b].alias=G(h[b].alias,h,12);if(S.remap){S.remap(h[b].did,h[b].alias,null,12,null,null,null,d);}}break;case"QBMetric":if(b!=-1){h[b].alias=G(h[b].alias,h,4);if(S.remap){S.remap(h[b].did,h[b].alias,null,4,null,null,null,d);}}break;case"QBNone":if(b!=-1){h[b].selected=false;this.dataGrid.populatePreview();}break;case"QBRename":var c=h[b].alias;var Z=this.widget;var g=Z.domNode.parentNode.clientWidth-25;g=(g>0)?(g+"px"):"20px";var T=O.position(Z.domNode).x-O.position(W.domNode).x+20+"px";W.openPopup("inlineTextRef",{top:(O.isIE?0:-1)+"px",left:T,txtConfig:{value:c||"",width:g,onEnter:function(){var m=K.trim(this.value),p=false;this.parent.close({enter:true});if(m===h[b].alias){return ;}if(m===""){return ;}if(S.validateRename){p=S.validateRename(m);}else{p=(m===G(m,h,h[b].tp));}if(p){var o=h[b].oid;mstrmojo.array.forEach(h,function(r){if(r.oid===o){r.alias=m;}});W.populatePreview();S.remap&&S.remap(Z.did,m,null,null,null,null,null,d);}else{var q="The name ## has been used by another column. Please give a new name.";mstrmojo.alert(K.encodeHtmlString(q.replace("##",m)),null,S.alertTitle);}}}});break;case"QBEdit":var b=this.widget.ix,i=S.selectedClns[b],n=3;mstrApp.getRootController().openExpressionEditor({type:n,w:i,tkn:i.expr,cIndex:b+1});break;case"QBRemove":var Z=this.widget;var f=Z.ix+1;if(S.removeSelectedColumn){S.removeSelectedColumn(f);}break;case"QBMap":var W=this.dataGrid,Z=this.widget,V=O.position(Z.domNode),R=S.mappings[b],l=mstrmojo.Button.newInteractiveButton,P=function U(){var m=new mstrmojo.qb.AttributeMapping({});m.placeholder=document.body.appendChild(document.createElement("div"));m.top=V.y+22+"px";m.left=V.x+"px";m.did=Z.did;m.target=Z;m.open();};B.toggleClass(Z.domNode,"highlight",true);if(R.georole||R.der){mstrmojo.confirm(mstrmojo.desc(9912,"Mapping this column to a project attribute will remove its geographical role and any derived attributes. Do you want to continue?"),[l(mstrmojo.desc(219),function(){P();}),l(mstrmojo.desc(218))]);}else{P();}break;case"QBUnMap":if(S.unmap){S.unmap(k,h[b].oid);}break;case"1":case"8":case"9":case"2":case"3":case"4":case"5":case"6":case"7":case"10":case"11":case"12":var Z=this.widget,Y=parseInt(j.did,10),a=S.mappings[b];if(Z.dtp!=Y){Z.dtp=Y;a.dtp=Y;S.remap&&S.remap(k,null,Y,null,null,null,null,d);if(Y==1||Y==8||Y==9){Z.georole=0;B.removeClass(Z.domNode,"geo");if(!Z.ipa){B.addClass(Z.domNode,"time");Z.parent.tips.set("title",D);}}else{B.removeClass(this.widget.domNode,"time");Z.parent.tips.set("title","");}I(Z,a,Y);}break;case"QBTime":if(b!=-1){var R=S.mappings[b];R.tp=12;R.selected=true;R.der=j.der;W.populatePreview();}break;case"QBGeo":if(b!=-1){var R=S.mappings[b];R.tp=12;R.selected=true;R.georole=j.georole;R.der=j.der;R.shapeKey=j.shapeKey;W.populatePreview();}break;default:break;}}};function E(P,V,R){var Q="mstrmojo-di-datapreview-cm",U=mstrmojo.all[Q];var W=P.parent.dataGrid;if(!U){U=mstrmojo.insert(J);U.set("domSrc",V);U.widget=P;U.dataGrid=W;U.render();}else{U.widget=P;U.dataGrid=W;U.set("domSrc",V);}U._subMenu&&U._subMenu.domNode&&U._subMenu.domNode.parentNode.removeChild(U._subMenu.domNode);U._subMenu=null;if(P.sptGeo&&P.tp!=4&&!P.ipa&&!P.multiForms){var T={},X=true;switch(P.dtp){case 8:T={height:"220px",mode:1};X=false;break;case 9:T={height:"100px",mode:2};X=false;break;case 1:T={height:"260px",mode:3};X=false;break;default:T={georole:P.georole};break;}if(X){var S=W.model;F[0].items=[{did:"QBGeo",itemWidget:N(P.georole,P.der,P.shapeKey,S.shapeKeys)}];}else{F[0].items=[{did:"QBTime",itemWidget:M(T.mode,T.height,P.der)}];}}else{delete (F[0].items);}U.cm=F;U.showContextMenu();}function C(R){var P={},Q;mstrmojo.array.forEach(R,function(S){if(S.tp===12){Q=S.oid;P[Q]=(P[Q]||0)+1;}});return P;}mstrmojo.qb.QBPreview=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.QBPreview",resizeColumnBehavior:mstrmojo.RESIZE_ALL_COLUMN_MODE,model:null,visible:false,markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},adjustSize:function(R){var Q=200;var S=this.parent&&this.parent.domNode;if(!S){return ;}var P=Q*R;if(S.clientWidth>P){S.style.overflowX="hidden";this.cssText="width:100%";}else{S.style.overflowX="auto";this.cssText="width:"+P+"px";}},populatePreview:function A(){var R=this.model,P=R.mappings,c=R.supportTimeGeo,X=!R.isCloud;this.columns=[];var d=0;if(this.parent&&this.parent.domNode){d=this.parent.domNode.scrollLeft?this.parent.domNode.scrollLeft:0;}this.unrender();this.adjustSize(P.length);var h,f,g,a,Q,k,U=C(P);for(var Y=0,Z=P.length;Y<Z;Y++){h=P[Y];g=K.encodeHtmlString(h.alias);g=(U[h.oid]>1&&h.fmn)?[g,"(",h.fmn,")"].join(""):g;a=h.tp;Q=((h.dtp==1)||(h.dtp==8)||(h.dtp==9))&&!h.ipa;k="";if(Q){a+=" time";if(h.tp===12){k=D;}}else{if(h.georole){a+=" geo";if(h.tp===12){k=L;}}}f={tag:h,headerWidget:{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-di-datapreview-header",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-datapreview-headerIcon t"+(h.selected?a:0).toString(),text:g,did:h.did,tp:h.tp,isReadOnly:h.isReadOnly,hasMapped:h.hasMapped,isQB:h.isQB,sptGeo:c,sptMap:X,mapped:h.selected,ix:h.ix,nochange:h.nochange,ipa:h.ipa,dtp:h.dtp,georole:h.georole,der:h.der,shapeKey:h.shapeKey,multiForms:h.multiForms,isIDForm:h.isIDForm},{scriptClass:"mstrmojo.Widget",cssClass:"menu",alias:"tips",title:k,markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" title="{@title}" style="{@cssText}" mstrAttach:click></div>',onclick:function(){var i=this.parent.children[0],j=i.tag;E(i,this.domNode,j);},markupMethods:{ontitleChange:function(){this.domNode.title=this.title;}}}]},colWidth:"60",colCss:"mstrmojo-qb-metric",dataFunction:function(o,j,n){var l=n.columns,i=o[this.dataField],m="mstrmojo-di-datapreview-DataRow-text";if(this.tag.selected){m+={"12":" Attribute","4":" Metric"}[this.tag.tp];}m+=(j%2==1)?" odd":" even";return'<div class="'+m+'">'+i+"</div>";},dataField:Y.toString()};this.columns.push(f);}var V=R.dataset;if(V.length==0&&this.columns.length>0){var b=21;var T=parseInt(parseInt(this.parent.height)/b)-1;T=T>0?T:1;var S;for(var Y=0;Y<T;Y++){S=[];for(var W=0,Z=this.columns.length;W<Z;W++){S.push("");}V.push(S);}}this.items=V;this.render();if(this.parent&&this.parent.domNode){this.parent.domNode.scrollLeft=d;}},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,slot:"headerContainerNode",children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onblur:function(){this.onEsc();},onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var Q=this.txt,R=this.txtConfig;if(R){for(var P in R){Q.set(P,R[P]);}}Q.domNode.style.width=Q.width;Q.focus();},onClose:function(P){if(!P||(!P.cancel&&!P.enter)){this.txt.onEnter();}this.unrender();}},onvisibleChange:function(P){if(P.value){this.populatePreview();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.qb.QBPreview","mstrmojo._HasPopup","mstrmojo.SaveAsEditor","mstrmojo.WaitIcon","mstrmojo.form","mstrmojo.MenuButton","mstrmojo._HasLayout","mstrmojo.DI.DIConstants","mstrmojo.qb.MissingColumnWarning","mstrmojo.DI.DISharedViewer","mstrmojo.Editor","mstrmojo.Container");mstrmojo.requiresDescs(9120,9121,1442,221,9117,9118,9119);var C=mstrmojo.DI.DIConstants;var E=mstrmojo.DI.DISharedViewer;var B=new mstrmojo.Editor({cssText:"background: white; width:270px;border: 10px solid rgba(0, 0, 0, 0.3); border-radius:5px; -moz-border-radius:5px;-webkit-border-radius:10px;",showTitle:false,zIndex:10,model:mstrmojo.all.DIModel,onOpen:function(){var F=this.curtainNode.style;F.background="black";F.opacity=0.5;F.filter="alpha(opacity=50)";},children:[{scriptClass:"mstrmojo.Label",cssText:"padding:10px 10px 10px 20px;",text:mstrmojo.desc(9120,"Options - Data Refresh")},{scriptClass:"mstrmojo.Label",cssText:"padding:0px 10px 20px 20px; color: blue;",text:mstrmojo.desc(9121,"Choose data refresh policy")},{scriptClass:"mstrmojo.RadioList",alias:"radiolist",cssText:"padding-left:25px;",itemCssClass:"mstrmojo-qb-radiolist-item",items:[{did:"1",n:mstrmojo.desc(9117,"Replace existing data")},{did:"4",n:mstrmojo.desc(9118,"Update existing data and add new data")},{did:"2",n:mstrmojo.desc(9119,"Keep existing data and add new data")}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width: 46px; float:right;",text:mstrmojo.desc(1442,"OK"),onclick:function(F){var G=this.parent.parent;G.model.refresh_opt=G.radiolist.selectedItem.did;if(G.onOK){G.onOK();}G.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(F){var G=this.parent.parent;if(G.onCancel){G.onCancel();}G.close();}}]}]});mstrmojo.DI.DIPreview=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DI.DIPreview",model:null,markupString:'<div id="{@id}" class="mstrmojo-di-datapreview {@cssClass}" style="overflow-y: hidden; {@cssText}"><div style="height: 50px"></div><div id="mstr_PreviewNode" style="overflow-x:auto;overflow-y:auto;border:1px solid lightGrey;margin:0px 1px 20px 0px"></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},sheetsNode:function(){return this.domNode.children[0];},previewNode:function(){return this.domNode.children[1];},footerNode:function(){return this.domNode.children[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible){if(this.height){var G=parseInt(this.height.substring(0,this.height.length-2),10);document.getElementById("mstr_PreviewNode").style.height=(G-139)+"px";}if(this.width){var F=parseInt(this.width.substring(0,this.width.length-2),10);document.getElementById("mstr_PreviewNode").style.width=(F-2)+"px";}}}},onNextButtonClick:function(){var I=this;var F=I.model;var G=F.currentSource.getMissingColumns();var J={success:function(K){F.hideWaitPage();I.publish();},failure:function(K){F.hideWaitPage();mstrmojo.alert(K.getResponseHeader("X-MSTR-TaskFailureMsg"));}};if(G){var H=mstrmojo.insert({scriptClass:"mstrmojo.qb.MissingColumnWarning",mappings:G,title:F.applicationName(),warning:"The following previously uploaded columns are missing",details:"If you publish without these columns, existing reports, documents and analyses based on this cube might be affected. Do you still want to continue?",onOK:function(){I.model.changeMappings(J);return true;}});H.open();}else{I.model.changeMappings(J);}},publish:function D(){var G=this;var F=G.model;var I={success:function(J){F.cubeID=J.objectId;G.pollPublish();},failure:function(J){E.publishErrorHandler(J,F);}};var H={taskId:"saveAndPublishCube",msgID:F.msgid,sessionState:mstrApp.sessionState};if(F.operationMode===C.operationMode.create){G.openPopup("saveasRef",{zIndex:20,folderLinksContextId:1,name:"File",saveParams:H,saveAsCallback:function(){return I;}});}else{H.folderID=F.folderID;H.objName=F.cubeName;H.saveAsOverwrite=true;F.showWaitPage();mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,I,H);}},pollPublish:function A(){var G=this.model;var H={taskId:"pollStatus",resultSetType:3,pollingFrequency:500,maxWait:60000,taskEnv:"xhr",taskConRtentType:"json",msgID:G.msgid,sessionState:mstrApp.sessionState};var F={success:function(J){if(J.status==="1"){var I=E.getRedirectURL(G.redirect,G.cubeID);mstrmojo.form.send(I,mstrApp.name,"POST",null,null,false);}else{mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,G.restructCB(this),pollParams);}},failure:function(I){E.publishErrorHandler(I,G);}};G.showWaitPage();mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,G.restructCB(F),H);},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Cube",browsableTypes:"776",saveAs:function(H){var G=this.contPanel;this.name=G.name.value;this.desc=G.desc.value;if(!this.name){mstrmojo.confirm(mstrmojo.desc(8114),[mstrmojo.Button.newInteractiveButton("*enter a valid name*",null,null,{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:72px;"})]);return ;}var I=this.saveParams||{};I.folderID=this.ob.currentFolder.did;I.objDesc=this.desc||"";I.objName=this.name||"";I.saveAsOverwrite=!!H;var F=this.saveAsCallback();F.parent=this;mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,F,I);}},children:[{slot:"previewNode",scriptClass:"mstrmojo.qb.QBPreview",alias:"preGrid",columns:[],postCreate:function(){var F=mstrmojo.all.DIModel;F.attachEventListener("PreviewFetched",this.id,"initPreview");F.attachEventListener("MappingsFetched",this.id,"initPreview");},initPreview:function(){var F=this.parent.model;if(!F.currentSource){return ;}var G={mappings:F.currentSource.currentMapping,dataset:F.currentSource.currentPreview.data,supportTimeGeo:true,renameMapped:function(O,N,P,M){var I=this,J=I.mappings,Q=false;for(var K=0,L=J.length;K<L;K++){if(K!=N){if(P===J[K].alias&&J[N].tp==J[K].tp){Q=true;break;}}}if(Q){var H="The name ## has been used by another column. Please give a new name.";mstrmojo.alert(H.replace("##",P),null,I.alertTitle);return ;}I.mappings[N].alias=P;mstrmojo.all.DIModel.raiseEvent({name:"MappingsFetched"});}};this.model=G;if(!G.mappings){return ;}this.populatePreview();}},{scriptClass:"mstrmojo.ImageCheckBox",slot:"sheetsNode",cssText:"float:left",alias:"newCH",label:"Insert New Column Headers",postBuildRendering:function(){var F=mstrmojo.all.DIModel;F.attachEventListener("PreviewFetched",this.id,"insertHdrs");},insertHdrs:function(){var F=this.parent.model.currentSource.currentPreview;this.set("checked",F.hasNewHeaders);},onclick:function(){var F=this.parent.model;var J=F.currentSource.currentPreview;var I=this.parent.preGrid;var H;var K="<chs>";if(this.checked){for(H=1;H<=J.chs.length;H++){K=K+"<ch>Column "+H+"</ch>";}J.data.splice(0,0,J.chs);J.set("hasNewHeaders",true);}else{J.data.splice(0,1);J.set("hasNewHeaders",false);}K=K+"</chs>";var G={success:function(M){F.set("msgid",M.msg_id);var L={success:function(N){if(N.datap){F.populate(N,C.requestFlag.mapping,C.requestFlag.mapping);}}};F.loadRptData(C.requestFlag.mapping,F.currentSource.currentIndex,L);}};F.editCube(F.cubeID?F.cubeID:null,F.currentSource.currentIndex,K,G);}},{scriptClass:"mstrmojo.Button",slot:"sheetsNode",alias:"refreshbtn",cssText:"float:right;padding-right:10px;",iconClass:"mstrmojo-QBToolbarIcon refreshOption",visible:true,title:mstrmojo.desc(9136,"Data Refresh Options"),onclick:function(G){var H=this.parent.model.refresh_opt,F;switch(H){case"1":F=0;break;case"4":F=1;break;case"2":F=2;break;default:F=0;}B.model=this.parent.model;B.radiolist.set("selectedIndex",F);B.open();}},{scriptClass:"mstrmojo.HBox",slot:"sheetsNode",cssText:"float:right;padding-right:10px;",visible:false,postCreate:function(){this.model=mstrmojo.all.DIModel;this.model.attachEventListener("SheetsFetched",this.id,"makeVisible");},makeVisible:function(){var F=this.parent.model.currentSource.sheets;if(F!==null){if(F.length>1){this.set("visible",true);return ;}}this.set("visible",false);},children:[{scriptClass:"mstrmojo.Label",text:"Sheet Name:"},{scriptClass:"mstrmojo.Pulldown",alias:"preShtsPD",items:[],postCreate:function(){this.model=mstrmojo.all.DIModel;this.model.attachEventListener("SheetsFetched",this.id,"populateSheets");},populateSheets:function(){var H=this.parent.parent.model.currentSource.sheets;var F=[];var G;if(H){for(G=0;G<H.length;G++){F.push({dssid:H[G].index,n:H[G].name});}this.set("items",F);}},onitemsChange:function(F){if(F.value){this.set("value",-1);this.set("value",0);}},onvalueChange:function(G){var F=this.parent.parent.model;if(this.selectedIndex>=0){this.loadData();}},loadData:function(){var F=this.parent.parent.model,I=this.parent.parent.preGrid,H=this.items[this.selectedIndex].dssid;if(!F.currentSource.hasFetchedPreview(H)){var G={success:function(L){F.set("msgid",L.msg_id);var J=C.requestFlag.preview|C.requestFlag.mapping|C.requestFlag.sourceInfo;var K={success:function(M){if(M.datap){F.populate(M,J,J);}}};F.loadRptData(J,H,K);}};F.editCube(F.cubeID?F.cubeID:null,H,null,G);}else{F.currentSource.selectSheet(H);this.parent.parent.newCH.insertHdrs();I.initPreview();}}}]}],resize:function(F,G){if(document.getElementById("mstr_PreviewNode")){document.getElementById("mstr_PreviewNode").style.height=(G-139+68)+"px";document.getElementById("mstr_PreviewNode").style.width=(F-2)+"px";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.Image","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo.DI.DIFileUpload","mstrmojo.DI.DIIntro","mstrmojo.DI.DIPreview","mstrmojo.DI.DataImportModel","mstrmojo.DI.DIFooter","mstrmojo.DI.SalesforceModel");mstrmojo.requiresDescs(8571,4700,1563,1143,1085,1088,2102,61,60,9095,9096,9097,9098,8042,9099,7972,8724,9100,9101,9213,9214,9212);window.onload=function(){mstrmojo.all.DataImport.browserResized(null);};var C=mstrmojo.DI.DIConstants;var F=mstrmojo.all.DIModel;if(!F){F=new mstrmojo.DI.DataImportModel({});}var A=mstrmojo.all.SalesforceModel;if(!A){A=new mstrmojo.DI.SalesforceModel({});}mstrmojo.DataImport=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout],{scriptClass:"mstrmojo.DataImport",markupString:'<div id="{@id}" class="mstrmojo-di {@cssClass}" style="background-color: #FFFFFF;"><div id="mstr_DiToolbar" class="mstrmojo-di-toolbar"></div><div id="mstr_Layout" class="mstrmojo-di-layout" style="width: 100%; overflow: hidden; padding-bottom: 20px;"></div><div id="mstr_SFTT" class="mstrmojo-di-bullet-tip" style="display: none;">'+mstrmojo.desc(9212,"Contact your administrator to configure access to Salesforce reports by enabling an https connection and setting the appropriate Salesforce parameters. See Help for more details")+'</div><div id="mstr_DiFooter" class="mstrmojo-di-footer" style="width: 100%;"></div></div>',markupSlots:{toolbar:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.children[1];},footer:function(){return this.domNode.lastChild;}},height:null,width:null,minWidth:800,minHeight:500,model:F,currentPage:null,initParams:function(H){var G=F;G.initParams(H);},children:[{scriptClass:"mstrmojo.Box",slot:"toolbar",cssClass:"mstrmojo-di-header cf",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left; font: 12px Tahoma; font-weight: bold; color: #5b5b5b; padding: 8px 0 0 10px;",text:mstrmojo.desc(9100,"Select your data source")},{scriptClass:"mstrmojo.Label",cssText:" float:left; font: 12px Tahoma; font-weight: bold; color: #5b5b5b; padding: 8px 0 0 450px;",text:mstrmojo.desc(10039,"My datasets")},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-di-help",title:mstrmojo.desc(1143,"help"),onclick:function(){var G=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(mstrApp.helpTopic||"import_data_page.htm");window.open(G);}}]},{scriptClass:"mstrmojo.Box",slot:"layout",children:[{scriptClass:"mstrmojo.DI.DIIntro",id:"mstrDiIntro",cssText:"width:100%;",model:F,visible:true,bindings:{visible:function(){return this.parent.parent.model.curPg==C.pageType.intro;}}},{scriptClass:"mstrmojo.DI.DIFileUpload",id:"mstr_FileUpload",alias:"fileUpload",model:F,bindings:{visible:function(){if(this.parent.parent.model.curPg==C.pageType.file){this.parent.parent.currentPage=this;}return this.parent.parent.model.curPg==C.pageType.file;}}},{scriptClass:"mstrmojo.DI.DIPreview",id:"mstrDiPreview",alias:"preview",model:F,visible:false,bindings:{visible:function(){if(this.parent.parent.model.curPg==C.pageType.preview){this.parent.parent.currentPage=this;this.height=mstrmojo.all.DataImport.height;}return this.parent.parent.model.curPg==C.pageType.preview;}}},{scriptClass:"mstrmojo.DI.DISalesforce",id:"mstrDiSalesforce",model:F,visible:false,bindings:{visible:function(){if(this.parent.parent.model.curPg==C.pageType.sfList){this.parent.parent.currentPage=this;}return this.parent.parent.model.curPg==C.pageType.sfList;}}}],preBuildRendering:function(){if(this._super){this._super();}var H=window.location.href.split("&");if(H.length>0&&H[0].indexOf("?")>0){H[0]=H[0].split("?")[1];}for(var G=0;G<H.length;G++){if(H[G].split("=")[0]=="code"){A.code=H[G].split("=")[1];}}mstrmojo.all.mstrDiIntro.populate();}},{scriptClass:"mstrmojo.DI.DIFooter",slot:"footer",model:F}],browserResized:function B(O){O=this.getBrowserDimensions();var K={x:0,y:0};if(this.domNode){K=this.getAbsPos(this.domNode);}var L=parseInt(O.w,10)-K.x-20;var H=parseInt(O.h,10)-K.y-96;H=H+40;L=L+10;if(L<800){L=800;}if(H<400){H=400;}if(this.height&&H!==this.height){this.set("height",H+"px");}else{this.height=H+"px";}if(this.width&&L!==this.width){this.set("width",L+"px");}else{this.width=L+"px";}if(!document.getElementById("mstr_Layout")){return true;}var G=document.getElementById("mstr_Layout").style;var J=64;G.width=L+"px";G.height=(H-J)+"px";var N=mstrmojo.all.mstrDiIntro;if(N){N.set("height",(H-J)+"px");N.set("width",L+"px");N.resize(L,H);}var M=mstrmojo.all.mstrDiPreview;if(M){M.set("height",(H-J)+"px");M.set("width",L+"px");M.resize(L,H);}var I=mstrmojo.all.mstrDiSalesforce;if(I){I.set("height",(H-J)+"px");I.set("width",L+"px");}return true;},postBuildRendering:function D(){if(this._super){this._super();}this.browserResized(this.getBrowserDimensions());},getAbsPos:function E(J){var I=(typeof J=="String")?document.getElementById(J):J;var H=0;var G=0;while(I&&(!isNaN(I.offsetLeft))&&(!isNaN(I.offsetTop))){H+=I.offsetLeft-I.scrollLeft;G+=I.offsetTop-I.scrollTop;I=I.offsetParent;}return{x:H,y:G};},layoutConfig:{h:{toolbar:"30px",layout:"100%",footer:"40px"},w:{layout:"100%"}}});})();