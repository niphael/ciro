(function(){var A={};mstrmojo.NumberFormat={getInstance:function B(F,G){var E=F+"--"+G;if(E in A){return A[E];}var C={parse:function(H){},format:function(H){}};if(F==="."&&G===","){C.parse=function(H){if(!H){return NaN;}var I=H.replace(/,/g,"");return Number(I);};C.format=function(H){return Number(H).toString();};}else{var D=new RegExp("\\"+G,"g");C.parse=function(I){if(!I){return NaN;}var H=I.replace(D,"").replace(F,".");return Number(H);};C.format=function(I){var H=Number(I).toString();return H.replace(".",F);};}A[E]=C;return C;}};})();(function(){function B(N,H,M){if(!M&&N===!!this._inFullScreen){return ;}delete this._inFlash;var L=this.domNode;if(!L){return ;}var I=L.style,Q=!!this.controller,P=this,K=(this.fullscreenDirection==="up")?"top":"bottom",O=function(){I.position=N?"absolute":"static";if(Q){mstrApp.rootView.doLayout();}},J=function(){if(Q){mstrMobileApp[(N?"enter":"exit")+"FullScreen"]();}};if(!M){this._inFullScreen=N;if(N||!H){O();}}if(!N){if(parseInt(I[K],10)===0){O();J();return ;}if(M){this._inFlash=true;}}if(H){mstrmojo.dom.attachOneTimeEvent(L,"webkitTransitionEnd",function(){if(!N){if(!M){O();}else{P._flashHandle=window.setTimeout(function(){delete P._flashHandle;B.call(P,true,true,true);},3000);}}else{if(P.onEnterFullScreenEnd){P.onEnterFullScreenEnd();}}if(!M){J();}});}else{J();}this["on"+(N?"Enter":"Exit")+"FullScreen"]();I.webkitTransitionDuration=H?"":0;I[K]=N?-L.offsetHeight+"px":0;}function D(){var H=this._flashHandle;if(H){window.clearTimeout(H);delete this._flashHandle;}}mstrmojo.android.ui._CanBeFullScreen=mstrmojo.provide("mstrmojo.android.ui._CanBeFullScreen",{fullscreenDirection:"up",onEnterFullScreen:mstrmojo.emptyFn,onExitFullScreen:mstrmojo.emptyFn,resetFullScreen:function F(){if(this._inFullScreen){delete this._inFullScreen;B.call(this,true,false);}},enterFullScreen:function C(){B.call(this,true,true);},flashFullScreen:function G(){if(this._inFullScreen&&!this._inFlash){B.call(this,false,true,true);}},exitFullScreen:function A(H){D.call(this);B.call(this,false,H);},cancelFlashFullScreen:function E(){if(this._inFullScreen&&this._inFlash){D.call(this);B.call(this,true,false,true);}}});}());(function(){mstrmojo.url=mstrmojo.provide("mstrmojo.url",{isAbsoluteURL:function(A){return/^(http|https|ftp|file):\/\//i.test(A);},getAbsoluteURL:function(A,B){if(this.isAbsoluteURL(A)){return A;}else{if(B){return B+(/\/$/.test(B)?"":"/")+A;}else{return"http://"+A;}}}});})();(function(){mstrmojo.BarcodeReader=mstrmojo.provide("mstrmojo.BarcodeReader",{_callback:null,_callbackId:0,readBarcodes:function B(G,I,C,F,D){this._callbackId++;var H=""+this._callbackId;this._callback=I;var E="mstrmojo.BarcodeReader.onBarcodeResult";if(G){G.blockBegin=0;G.blockCount=-1;G.serverUrl=mstrApp.getConfiguration().getTaskUrlByProject(mstrApp.getCurrentProjectId());G.sessionState=mstrApp.getSessionState();}mstrMobileApp.readBarcodes(H,C,(G&&JSON.stringify(G))||null,(F&&JSON.stringify(F))||null,D||null,E);},onBarcodeResult:function A(F,C,D){var E=this._callback;if(F!=this._callbackId||(!E)){return ;}delete this._callback;if(C==-1){E.success(D);}else{if(C!=0){E.failure(D||"Error reading bare code.");}}}});})();mstrmojo.android.EnumMenuOptions=mstrmojo.provide("mstrmojo.android.EnumMenuOptions",{HOME:1,SETTINGS:2,HELP:4,LEARN:8,ALL:255,REFRESH:256,FULL_SCREEN:512,GROUP_BY:768,PAGE_BY:1024,REPROMPT:1280,DELETE:1536,SEARCH:1792,SCAN:2048,MAP_ROADMAP:2304,MAP_SAT:2560,MAP_HYBRID:2816,MAP_TERRAIN:3072,DOC_LAYOUTS:3328,TRANSACTIONS_QUEUE:3584,ADD_SERVER:3840,ADD_PROJECT:4096,ABOUT:4352,SHARE:4608,ABOUT_RESULTSET:4864,ANNOTATION:5120});(function(){mstrmojo._HasDrillLinks=mstrmojo.provide("mstrmojo._HasDrillLinks",{_mixinName:"mstrmojo._HasDrillLinks",update:function A(E){this._super(E);var B=E.defn.dl,F=E.data.dl,D=this.drillLinkItems=((B&&B.items)||[]).concat((F&&F.items)||[]).sort(function(H,G){return H.index-G.index;}),C;for(C=D.length-1;C>=0;C--){if(C&&D[C].index===D[C-1].index){D.splice(C,1);}}if(B&&B.target){for(C=0;C<D.length;C++){D[C].target=B.target;}}}});}());(function(){var N={Min:15872549,Max:1489202,Invalid:0,NoColorMetric:16119287};var G={LeftToRight:0,RightToLeft:1,Center:2,None:3};function K(T,f,X){if(T<0||T>1){return 0;}var U=256,W=T*U,P,V,Y,S=f>>16,R=X>>16,a=(f&65280)>>8,Z=(X&65280)>>8,Q=(f&255),d=(X&255);P=S+Math.floor((W*(R-S)/U));V=a+Math.floor((W*(Z-a)/U));Y=Q+Math.floor((W*(d-Q)/U));return Y+(V<<8)+(P<<16);}function F(Q,T){var S=Q>>16,R=(Q&65280)>>8,P=(Q&255);S=Math.floor((1-T)*S);R=Math.floor((1-T)*R);P=Math.floor((1-T)*P);return P+(R<<8)+(S<<16);}function J(P){var W=[],U,Q,S=P.dp,R=S.length,X,Y;if(P==null||P.length==0){return[];}for(var T=0;T<R;T++){Q={};var X,V;if(T>0){X=U;U=Y;}else{U=S[T];}if(T<R-1){Y=S[T+1];}Q.sv=(T==0)?U.v:(X.v+U.v)/2;Q.ev=(T==R-1)?U.v:(Y.v+U.v)/2;Q.c=U.c;Q.d=(T==0)?G.LeftToRight:(T==R-1?G.RightToLeft:G.Center);W[T]=Q;}return W;}function E(X){var P=[],T,Q,S=X.dp,R=S.length;if(X==null||X.length==0){return[];}for(var U=0;U<R;U++){T={};Q=S[U];var Y=Q.s,W=Q.e;T.c=Q.c;switch(Q.d){case G.LeftToRight:T.v=Q.s;break;case G.RightToLeft:T.v=Q.e;case G.Center:case G.None:default:var V=(Q.s+Q.e)/2;T.v=V;break;}P[U]=T;}return P;}function D(T,Y){var P=[],Q=[],V=[];if(this.min==this.max||isNaN(T)||isNaN(Y)||T==Y){P[0]=L.call(this,T);P[1]=L.call(this,Y);Q[0]=1;Q[1]=1;V[0]=0;V[1]=1;}else{if(this.min<this.max){var X,S=this.blend.dp,R=S.length,W=0;P[W]=L.call(this,T);Q[W]=1;V[W]=0;W++;for(var U=0;U<R;U++){X=S[U];if(X.v>=T&&X.v<=Y){P[W]=X.c;Q[W]=1;V[W]=(X.v-T)/(Y-T);W++;}}P[W]=L.call(this,Y);Q[W]=1;V[W]=1;}}return{c:P,a:Q,r:V};}function A(T,d){var P=[],Q=[],V=[];if(this.min==this.max||isNaN(T)||isNaN(d)||T==d){P[0]=B.call(this,T);P[1]=B.call(this,d);Q[0]=1;Q[1]=1;V[0]=0;V[1]=1;}else{if(this.min<this.max){var S=this.band.dp,R=S.length,e=0.4,Y,b,g,X=0;if(T<0){P[X]=B(T);Q[X]=1;V[X]=0;X++;if(d<1){P[X]=B(d);Q[X]=1;V[X]=1;X++;}}for(var U=0;U<R;U++){Y=S[U];if(Y.s>d||Y.e<T){continue;}b=Y.c;g=F(b,e);var f=Math.max(Y.s,T),Z=Math.min(Y.e,d);if(Z!=f){switch(Y.d){case G.LeftToRight:case G.RightToLeft:case G.Center:if(f==Y.s){P[X]=(Y.d!=G.LeftToRight)?g:b;}else{P[X]=B.call(this,f);}V[X]=(f-T)/(d-T);Q[X]=1;X++;if(Y.d==G.Center){var W=(Y.s+Y.e)/2;if(W>f&&W<Z){P[X]=b;V[X]=(W-T)/(d-T);Q[X]=1;X++;}}if(Z==Y.e){P[X]=(Y.d!=G.RightToLeft)?g:b;}else{P[X]=B.call(this,Z);}V[X]=(Z-T)/(d-T);Q[X]=1;X++;break;case G.None:default:P[X]=b;V[X]=(f-T)/(d-T);Q[X]=1;X++;P[X]=b;V[X]=(Z-T)/(d-T);Q[X]=1;X++;break;}}}if(d>1){if(T>1){P[X]=B.call(this,T);V[X]=0;Q[X]=1;X++;}P[X]=B.call(this,d);V[X]=1;Q[X]=1;}}}return{c:P,a:Q,r:V};}function I(R,U){var S=0.4,Q=F(U.c,S),P,T;switch(U.d){case G.LeftToRight:if(R<U.s){return U.c;}if(R>U.e){return Q;}if(U.s==U.e){return K(0.5,U.c,Q);}T=(R-U.s)/(U.e-U.s);return K(T,U.c,Q);case G.RightToLeft:if(R<U.s){return Q;}if(R>U.e){return U.c;}if(U.s==U.e){return K(0.5,Q,U.c);}T=(R-U.s)/(U.e-U.s);return K(T,Q,U.c);case G.Center:P=(U.s+U.e)/2;if(R<U.s||R>U.e){return Q;}if(U.s==U.e){return Q;}if(R<=P){T=(R-U.s)/(P-U.s);return K(T,Q,U.c);}T=(R-P)/(U.e-P);return K(T,U.c,Q);case G.None:default:return U.c;}}function L(Y){if(isNaN(Y)){return N.Invalid;}if(this.max==this.min){return this.blendEqualColor;}var R=this.blend.dp,Q=R.length;if(!this.valid){var a=R[0],U=R[Q-1];if(Y<this.min){return a.c;}return U.c;}var S,W=R[0],Z=W.v,V=W.c,X,T;for(S=1;S<Q;S++){W=R[S];if(W.v>=Y){break;}Z=W.v;V=W.c;}S=Math.min(S,Q-1);W=R[S];X=W.v;T=W.c;if(Y<Z){return V;}if(Y>X){return T;}if(Z==X){return K(0.5,V,T);}var P=(Y-Z)/(X-Z);return K(P,V,T);}function B(Q){if(isNaN(Q)){return N.Invalid;}if(this.min==this.max){return this.bandEqualColor;}var U=this.band.dp,P=U.length;if(!this.valid){var S=U[0],T=U[P-1];if(Q<this.min){return I(T.s,S);}else{return I(T.e,T);}}for(var R=0;R<P;R++){c=U[R];if(c.s===c.e){continue;}if(c.s<=Q&&Q<=c.e){return I(Q,c);}}}function O(Q,P){this.blend.dp=[];var S=this.blend.dp,R;R={};R.c=Q;R.v=0;S[0]=R;R={};R.c=P;R.v=1;S[1]=R;}function M(Q,P){this.band.dp=[];var S=this.band.dp,R;R={};R.d=G.LeftToRight;R.s=0;R.e=0.5;R.c=Q;S[0]=R;R={};R.d=G.LeftToRight;R.s=0.5;R.e=1;R.c=P;S[1]=R;}function C(q,S,o){var U=[],T=0,X,k,a=this.min,e=this.max,R=o.legendTickCount,Q={},P,W=!isNaN(this.min)&&!isNaN(this.max);if(this.min>=this.max||this.blend.dp.length<=2){var h=(e-a)/R;for(var g=0;g<q;g++){Q={x:T,w:Math.floor(S/R)};T+=Q.w;if(W){X=a+g*h;k=X+h;P=this.getColor((X+k)/2);}else{X="Null";k="Null";P=0;}U.push({r:Q,c:P,sv:X,ev:k});}}else{var Z=this.blend.dp,b=Z.length;for(var g=0;g<b;g++){var j=Z[g],V,Y;if(g==0){X=a;}else{V=Z[g-1];X=a+(e-a)*(j.v+V.v)/2;}if(g==b-1){k=e;}else{Y=Z[g+1];k=a+(e-a)*(j.v+Y.v)/2;}Q={x:T,w:Math.floor(S*(k-X)/(e-a))};T+=Q.w;if(W){P=this.getColor((X+k)/2);}else{X="Null";k="Null";P=0;}U.push({r:Q,c:P,sv:X,ev:k});}}this.tooltipInfo=U;}function H(q,U,p){var W=[],V=0,Y,o,f=this.min,g=this.max,S=p.legendTickCount,R={},Q,a,X=!isNaN(this.min)&&!isNaN(this.max);if(this.min>=this.max){for(var h=0;h<q;h++){R={x:V,w:Math.floor(U/S)};a+=R.w;if(X){a=Y+" < "+ms+" < "+o;Q=this.getColor(f);}else{Y="Null";o="Null";Q=0;}W.push({r:R,c:Q,sv:Y,ev:o});}}else{var T,P;if(this.isFixedColorBanding){T=this.initMax;P=this.initMin;}else{T=g;P=f;}var Z=this.band.dp,e=Z.length;if(e<=2){for(var h=0;h<e;h++){var k=Z[h];if(h==0){Y=P;}else{Y=P+(T-P)*k.s;}if(h==e-1){o=T;}else{o=P+(T-P)*k.e;}if(Y<f){Y=f;}if(o>g){o=g;}if(Y>o&&o>=g){Y=g;o=g;}else{if(o<Y&&Y<=f){Y=f;o=f;}}R={x:V,w:Math.floor(U*(o-Y)/(g-f)/2)};V+=R.w;if(X){o=(Y+o)/2;Q=this.getColor((Y+o)/2);}else{Y="Null";o="Null";Q=0;}W.push({r:R,c:Q,sv:Y,ev:o});V+=R.w;var j=U*(o-Y)/(g-f)/2;R={x:V,w:Math.ceil(j)};if(h>0){var b=W[W.length-1].r;if(R.x<b.x+b.w+1){b.w=R.x-b.x;}}V+=Math.floor(j);if(X){Y=(Y+o)/2;Q=this.getColor((Y+o)/2);}else{Y="Null";o="Null";Q=0;}W.push({r:R,c:Q,sv:Y,ev:o});}}else{for(var h=0;h<e;h++){var k=Z[h];if(h==0){Y=p.props.legendAsc?P:T;}else{Y=p.props.legendAsc?P+(T-P)*k.s:T+(P-T)*k.s;}if(h==e-1){o=p.props.legendAsc?T:P;}else{o=p.props.legendAsc?P+(T-P)*k.e:T+(P-T)*k.e;}if(Y<f){Y=f;}if(o>g){o=g;}if(Y>o&&o>=g){Y=g;o=g;}else{if(o<Y&&Y<=f){Y=f;o=f;}}var j=U*(o-Y)/(g-f);R={x:V,w:Math.ceil(j)};if(h>0){var b=W[W.length-1].r;if(R.x<b.x+b.w+1){b.w=R.x-b.x;}}if(h==e-1){R.w=U-V;}V+=Math.floor(j);var s=p.props.legendAsc?" < ":" > ";if(X){Q=this.getColor((Y+o)/2);}else{Y="Null";o="Null";Q=0;}if(s){W.push({r:R,c:Q,sv:Y,ev:o});}else{W.push({r:R,c:Q,sv:Y,ev:o,sign:">"});}}}}this.tooltipInfo=W;}mstrmojo.VisHeatMapColorTheme={newInstance:function(){return{initialize:function T(){this.blend={};this.band={};this.valid=true;this.blendEqualColor=0;this.bandEqualColor=0;this.isBlend=true;this.setDefaultDataProvider();this.checkMinMax();},getGradientFillInfo:function W(b,Z){var e,a;if(isNaN(b)||isNaN(Z)){if(this.isBlend){return D.call(this,b,Z);}else{return A.call(this,b,Z);}}if(this.min==this.max){if(b<this.min){e=0;}else{e=1;}if(Z<this.max){a=0;}else{a=1;}}else{if(this.isFixedColorBanding){var f=this.initMax-this.initMin;e=(b-this.initMin)/f;a=(Z-this.initMin)/f;}else{var f=this.max-this.min;e=(b-this.min)/f;a=(Z-this.min)/f;}}if(this.isBlend){return D.call(this,e,a);}else{return A.call(this,e,a);}},checkMinMax:function U(){var f=this.min,Z=this.max;if(f>Z){this.valid=false;}else{if(f==Z){f=Z=1;var h=this.blend.dp,a=h.length,g,d;for(var e=a-1;e>=0;e--){g=h[e];if(e==a-1&&g.v<=f){this.blendEqualColor=g.c;break;}if(e==0&&g.c>=f){this.blendEqualColor=g.c;break;}if(e>0&&g.c>=f){var b=h[e-1];if(b.c<f){d=(f-b.v)/(g.v-b.v);this.blendEqualColor=K(d,b.c,g.c);break;}}}h=this.band.dp;a=h.length;for(var e=0;e<a;e++){g=h[e];if((e==0&&g.s>=f)||(e==a-1&&g.e<=f)||(g.s<=f&&g.e>=f)){this.bandEqualColor=g.c;break;}}}}},setDefaultDataProvider:function Y(){O.call(this,N.Min,N.Max);M.call(this,N.Min,N.Max);this.useDefault=true;},getColor:function Q(Z){if(this.hasNoColorMetric){return N.NoColorMetric;}var a=NaN;if(isNaN(Z)){a==0;}else{if(this.min==this.max){a=Z<this.min?0:1;}else{if(this.isFixedColorBanding){a=(Z-this.initMin)/(this.initMax-this.initMin);}else{a=(Z-this.min)/(this.max-this.min);}}}if(this.isBlend){return L.call(this,a);}else{return B.call(this,a);}},isBrightColor:function X(f){var d=f>>16,a=(f&65280)>>8,Z=(f&255),e=(d*299+a*587+Z*114)/1000;if(e>150){return true;}return false;},getContrastColor:function P(Z){if(this.isBrightColor(Z)){return 0;}return 16777215;},createTooltipInfo:function S(b,a,f){var e=0;if(this.min>=this.max){e=1;}else{var Z;if(this.isBlend){Z=this.blend.dp.length;e=(Z<=2)?5:Z;}else{Z=this.band.dp.length;e=(Z<=2)?4:Z;}}if(this.isBlend){C.call(this,e,a,f);}else{H.call(this,e,a,f);}},getTooltipInfo:function R(Z){var b=this.tooltipInfo;for(var a=0;a<b.length;a++){var e=b[a],d=e.r;if(Z>=d.x&&Z<d.x+d.w){return a;}}return a-1;},getMaxMinByMetricID:function(g,a){var b=g.gts.col,k=b.length,f=0,h=null;range={min:null,max:null};for(f=0;f<k&&h==null;f++){var o=b[f].es,Z=o.length,e;for(e=0;e<Z;e++){if(o[e].oid==a){h=e;break;}}}if(h==null){return range;}var d=g.gvs.items,k=d.length;for(f=0;f<k;f++){var l=parseFloat(d[f].items[h].rv);if(range.min==null){range.min=l;}if(range.max==null){range.max=l;}if(range.min>l){range.min=l;}if(range.max<l){range.max=l;}}return range;},convertFixedValueToBlendString:function(e,d){var k="";if(e.length%2==0){var Z=e.length,a=d.min,f=d.max,b=0;var j=f-a;k="0,"+e[1];for(b=2;b<Z-2;b+=2){var h=parseInt(e[b]);if(h<a||h>f){continue;}else{var g=(h-a)/j;k+=","+g+","+e[b+1];}}k+=",1,"+e[Z-1];}return k;},convertFixedValueToBandString:function(f,e){var o=f.split(","),g=o.length,b,k=e.max-e.min;var h="";if(g%4===0){for(b=0;b<g;b+=4){var Z=0;for(Z=0;Z<2;Z++){var p,l=o[b+Z];if(l==="min"){p=e.min;}else{if(l==="max"){p=e.max;}else{p=parseFloat(o[b+Z]);}}if(!isNaN(p)){o[b+Z]=String((p-e.min)/k);}else{console.log("warning: invalid band string. In heatmap color theme");}}}for(b=0;b<g;b++){h+=(o[b]+",");}h=h.substring(0,h.length-1);}else{console.log("warning: Invalid band color string. In heatmap color theme");}return h;},convertAbsoluteToBlend:function(b,e){this.useDefault=false;this.isColorBanding=true;var Z=e.abs.replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");Z=(new window.DOMParser()).parseFromString(Z,"text/xml");var d=Z.getElementsByTagName("m")[0];b.absoluteColorID=d.getAttribute("id");this.isFixedColorBanding=true;this.fixedBandingArray=d.getAttribute("bl").split(",");var a;if(!isNaN(this.min)&&!isNaN(this.max)){a={max:this.max,min:this.min};}else{a=this.getMaxMinByMetricID(b.model,b.absoluteColorID);this.max=a.max;this.min=a.min;}if(isNaN(this.initMax)||isNaN(this.initMin)){a=this.getMaxMinByMetricID(b.model,b.absoluteColorID);this.max=a.max;this.min=a.min;this.initMax=a.max;this.initMin=a.min;}e.bandColors=this.convertFixedValueToBandString(d.getAttribute("ba"),a);e.gradientColors=this.convertFixedValueToBlendString(this.fixedBandingArray,a);},createDataProviderFromString:function V(g,f){var Z=g.split(","),a=0,e;this.blend.dp=[];this.useDefault=false;e=this.blend.dp;if(Z.length%2==0){while(a<Z.length){var d={};d.v=parseFloat(Z[a]);a++;d.c=parseInt(Z[a]);a++;e[e.length]=d;}}a=0;Z=f.split(",");this.band.dp=[];e=this.band.dp;if(Z.length%4==0){while(a<Z.length){var d={};d.s=parseFloat(Z[a]);a++;d.e=parseFloat(Z[a]);a++;d.c=parseInt(Z[a]);a++;var b=Z[a];switch(b){case"leftToRight":d.d=G.LeftToRight;break;case"rightToLeft":d.d=G.RightToLeft;break;case"center":d.d=G.Center;break;default:d.d=G.None;}a++;e[e.length]=d;}}}};}};})();(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function B(){return this.items==null?0:this.items.length;},totalSize:function A(){return this.totalSize;},next:function(C){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,C);}},previous:function(C){if(this.hasPrevious()){var D=this.blockBegin-this.blockCount;D=D<0?0:D;this.getItems(D,C);}},getItems:function(H,F){F=F||{};var E=this,D=mstrmojo.emptyFn,C=F.success||D,G=F.failure||D;this._retrieveItems(H,{success:function(I){E.blockBegin=H;E.set("items",(E.concat?(E.items||[]).concat(I.items):I.items));if(I.totalSize){E.totalSize=I.totalSize;}C(E,I.items);},failure:function(I){G(I);}});},_retrieveItems:function(){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+(this.items&&this.items.length||0))<(this.totalSize+1));},hasPrevious:function(){return this.blockBegin>1;}});})();mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){mstrmojo._HasRelativeUrls={_mixinName:"mstrmojo._HasRelativeUrls",relativeUrls:[],update:function A(C){this._super(C);var B=this,D=B.builder.parent,E=mstrApp.getConfiguration().getHostUrlByProject(mstrApp.getCurrentProjectId());mstrmojo.array.forEach(this.relativeUrls,function(G){var F=B[G];if(F&&(F.indexOf("://")===-1&&F.indexOf("data:")!==0)){B[G]=E+F;}});}};})();(function(){function L(N,T,S,P,R,O,Q){if(T>O){return false;}return(!Q)||(N===0)||((N<P)&&(T>=R-(O-R)));}function H(Q,N,U,T,P,S,O,R){if(U>O){return false;}return(!R)||((N<P)&&(U>=S-Q.height()));}function F(N,P,O){N.renderMode="scroll";N.render();N.numChildrenRendered=0;P.numChildrenRendered++;if(O&&!N.builtChildren){N.buildChildren();}}function E(){return this.useScrollBuffer?this.scrollBuffer:0;}mstrmojo._CanRenderDocOnScroll=mstrmojo.provide("mstrmojo._CanRenderDocOnScroll",{_mixinName:"mstrmojo._CanRenderDocOnScroll",renderMode:"scroll",scrollBuffer:0,postBuildRendering:function B(){if(this.renderMode===null){return this._super();}else{this.renderChildren();return true;}},childRenderOnAddCheck:function(N){if(this.renderMode===null){return this._super(N);}else{return false;}},renderChildren:function M(){var O;if(this.renderMode==="scroll"){var P=this;while(P){if(P.scrollboxNode&&(P.scrollboxWidthFixed||P.scrollboxHeightFixed)&&P.connectScrollbox){O=P;break;}P=P.parent;}}if((this.renderMode!=="scroll")||!O){this._super();return ;}if(this.containerNode){this.scrollboxOwner=O;O.connectScrollbox(this);this.numChildrenRendered=0;var N=this.numChildren;if(N===undefined){this.numChildren=N=this._getModelChildNodes(this.node,false,0,0,true).total;}this.sectionsToRender=N;this.subsectionsToRender=0;if(N){this._startSubsectionThread(false);}}if(this.resizeOrReposition){this.resizeOrReposition();}},onscroll:function J(){if(!this.renderingSubsections){this.useScrollBuffer=true;this._startSubsectionThread(true);}},_startSubsectionThread:function A(Q){var O=this;var P=function(S,R){if(O[S]){if(R){self.clearTimeout(O[S]);}else{self.clearInterval(O[S]);}delete O[S];}};var N=function(S){O.renderingSubsections=false;var R=function(){P("renderCtlsTimer");O.showRenderStatus(false);O.renderCtrlsInViewport();O.raiseEvent({name:"afterScroll"});O=null;};if(S){O.renderCtlsTimer=self.setTimeout(R,O.scrollboxOwner.scrollInterval+1);}else{R();}};P("renderSubsTimer");P("renderCtlsTimer",true);this.renderingSubsections=true;if((this.sectionsToRender||this.subsectionsToRender)&&!this._renderSubsectionsToScroll()){this.showRenderStatus(true);this.renderSubsTimer=self.setInterval(function(){if(O._renderSubsectionsToScroll()){P("renderSubsTimer");N(Q);}else{O.showRenderStatus(true);}},this.scrollboxOwner.scrollInterval);}else{N(Q);}},showRenderStatus:function G(O,T){var S=this.parent;if(!S||!S.showStatus){return ;}var N=T,P;if(O){var Q=this.numChildrenRendered,R=this.numChildren;P=R&&parseInt(100*Q/R,10);N="*Rendering section "+Q+" of "+R+".*";}S.showStatus(O,N,P);},_renderSubsectionsToScroll:function K(){var Y=this.scrollboxOwner,Z=Y.scrollboxTop,Q=Y.scrollboxLeft,T=Y.scrollboxBottom+E.call(this),l=Y.scrollboxRight,a=T-Z,W=0,V=0,U=null,b=null,X,h;function o(){U=V;b=U+a;}var N=this.numChildren,S=this.children||[],P=this.model,f=this.node,e=false;for(h=0;h<N;h++){var k=S[h];if(!k){k=this.addChildren(this.builder.build(this._getModelChildNodes(f,false,h,1,true).nodes,P))[0];S=this.children||[];}var O=e;e=!!k.defn.horiz;X=(h>0&&k.node.data.bh);if((!e&&O)||(X&&O)){W=0;V+=S[h-1].height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}if(!k.hasRendered){if(!L(W,V,Q,l,Z,T,e)){if(e){continue;}else{return true;}}this._renderSection(k,h);this.sectionsToRender--;this.subsectionsToRender+=(k.children&&k.children.length)||0;if(U===null){o();}}var R=k.children||[],g=null,d,j;for(d=0,j=R.length;d<j;d++){g=R[d];if(!g.hasRendered){if(!H(g,W,V,Q,l,Z,T,e)){if(e){break;}else{return true;}}F(g,k);this.subsectionsToRender--;if(U===null){o();}}if(e){W+=g.width();if(W>l){break;}}else{V+=g.height();if(V>T){return true;}else{if((b!==null)&&(V>b)){return false;}}}}}return true;},_renderSection:function I(N,O){F(N,this,true);},_getModelChildNodes:function(P,O,R,N,Q){return this.model.getChildren(P,O,R,N,Q);},renderCtrlsInViewport:function D(){var W=this.scrollboxOwner,Y=W.scrollboxTop,O=W.scrollboxLeft,R=W.scrollboxBottom+E.call(this),o=W.scrollboxRight,T=0,S=0,d=false,Q=this.children||[],N,U,g,X;var b=function(s){if(d){T+=s.width();}else{S+=s.height();}};var k=function(z,t,x,AA,w){t=parseInt(t,10)||0;x=parseInt(x,10);return(isNaN(x))?(z+t<=w):mstrmojo.boxmodel.rangeIntersect(z+t,z+t+x,AA,w);};for(g=0,X=(Q&&Q.length)||0;g<X;g++){var p=Q[g];N=d;d=!!p.defn.horiz;U=(g>0&&p.node.data.bh);if((!d&&N)||(U&&N)){T=0;S+=Q[g-1].height();if(S>R){return ;}}if(!p.hasRendered){if(!d){return ;}else{continue;}}var j=p.children,P=(j&&j.length)||0,a,f;for(a=0;a<P;a++){f=j[a];if(!f.hasRendered){break;}if(f.builtChildren&&(f.numChildrenRendered===((f.children&&f.children.length)||0))){b(f);}else{if((S+f.height()>=Y)&&(!d||(T+f.width()>=O))){var q=f.children,Z=(q&&q.length)||0;if(!Z&&!f.builtChildren){f.buildChildren();q=f.children;Z=(q&&q.length)||0;}var e=[],h;for(h=0;h<Z;h++){var l=q[h];if(l.hasRendered){continue;}var V=l.getFormats()||{};if(k(S,V.top,V.height,Y,R)&&k(T,V.left,V.width,O,o)){l.render();e.push(l);}}f.performCanGrowCanShrink(e,true);}b(f);}if((d&&T>o)||(!d&&S>R)){break;}}}},unrender:function C(O){var N=this.scrollboxOwner;if(N){N.disconnectScrollbox(this);}this._super(O);}});}());(function(){mstrmojo.android._HasLingeringListSelections=mstrmojo.provide("mstrmojo.android._HasLingeringListSelections",{_mixinName:"mstrmojo.android._HasLingeringListSelections",selectionPolicy:"reselect",noLinger:false,canItemLinger:function D(E){return true;},setClearHandler:function C(F){if(this.noLinger){return ;}var E=this.selectedIndex,G=this.id;if(E>-1&&this.canItemLinger(this.items[E])){this._clearHandler=window.setTimeout(function(){var H=mstrmojo.all[G];if(H){if(H.selectedIndex===E){H.clearSelect();}delete H._clearHandler;}},F);}},postBuildRendering:function A(){this._super();this.setClearHandler(800);},preselectionChange:function B(E){var F=this._clearHandler;if(F){window.clearTimeout(F);delete this._clearHandler;}}});}());(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};})();(function(){var E=[];function H(L,K){E.push({n:L,args:K});}function I(N,M,K){var L=false;switch(N._loadingStatus){case 0:if(google&&google.maps&&google.maps.Geocoder){N._loadingStatus=2;L=true;}else{H(M,K);N._loadScript();}break;case 1:H(M,K);break;case 2:L=true;break;}return L;}mstrmojo.GeoLocation=mstrmojo.provide("mstrmojo.GeoLocation",{_altitude:null,_latitude:null,_longitude:null,_callbacks:[],_getPos:function(){if(mstrMobileApp&&mstrMobileApp.getGeoLocation){mstrmojo.GeoLocation._getPos=function(){mstrMobileApp.getGeoLocation("mstrmojo.GeoLocation.updateLocation");};}else{if(navigator&&navigator.geolocation){mstrmojo.GeoLocation._getPos=function(){navigator.geolocation.getCurrentPosition(function(K){mstrmojo.GeoLocation.updateLocation(K);},function(K){switch(K.code){case K.TIMEOUT:alert("Retrieve Geo Position: Timeout, please try it again ");break;case K.PERMISSION_DENIED:alert("Retrieve Geo Position: Permission to use location service has been denied ");break;case K.POSITION_UNAVAILABLE:alert("Retrieve Geo Position: Position unavaiable ");break;}mstrmojo.GeoLocation.updateLocation(K);},{maximumAge:10000,timeout:10000});};}else{mstrmojo.GeoLocation._getPos=function(){alert("no available Geo Location service");};}}mstrmojo.GeoLocation._getPos();},getCurrentLocation:function(K){this._callbacks.push(K);if(!this._pending){this._pending=true;this._getPos();}},updateLocation:function(P){var M=mstrmojo.GeoLocation;var L,K;var O=P&&P.coords;var N=P&&P.err;if(O){M._latitude=O.latitude;M._longitude=O.longitude;K=M._callbacks;for(L=0;L<K.length;L++){K[L].success(O.latitude,O.longitude);}}else{if(N){K=M._callbacks;for(L=0;L<K.length;L++){K[L].failure("Error in updating geo location information."+N);}}else{K=M._callbacks;for(L=0;L<K.length;L++){K[L].failure("Error in updating geo location information.");}}}M._callbacks=[];M._pending=false;},getCurrentAddress:function(K){this.getCurrentLocation({success:function(N,L,M){mstrmojo.GeoLocation.findAddress({lat:N,lng:L},{success:K.success&&K.success||mstrmojo.emptyFn,failure:K.failure&&K.failure||mstrmojo.emptyFn});},failure:K.failure&&K.failure||mstrmojo.emptyFn});},count:null,cbs:null,getUniqId:function D(){var K;if(!this.count){K=this.count=1;}else{K=this.count++;}return"fa"+K;},findAddress:function F(L,K){if(!mstrMobileApp||!mstrMobileApp.useNativeMap||!mstrMobileApp.useNativeMap()){this.findAddressUsingJsAPI(L,K);}else{this.findAddressUsingNativeAPI(L,K);}},findAddressUsingJsAPI:function J(M,K){if(I(this,"findAddress",[M,K])){var L=new google.maps.Geocoder();L.geocode({location:new google.maps.LatLng(M.lat,M.lng)},function(O,N){if(N==google.maps.GeocoderStatus.OK&&O[0]){K.success(O);}else{K.failure(O,N);}});}},findAddressUsingNativeAPI:function G(M,K){var L=this.getUniqId();if(this.cbs==null){this.cbs={};}this.cbs[L]=function(N){if(N.status=="OK"){K.success(N.results);}else{K.failure(N.results,N.status);}};mstrMobileApp.findAddress(M.lat,M.lng,"mstrmojo.GeoLocation.findAddressCallback",L);},findAddressCallback:function B(L,K,M){this.cbs[M].apply(mstrmojo.GeoLocation,[L]);},_loadingStatus:0,_loadScriptCallBack:function A(){this._loadingStatus=2;for(var K=0;K<E.length;K++){var L=E[K];mstrmojo.GeoLocation[L.n].apply(mstrmojo.GeoLocation,L.args);}},_loadScript:function C(){this._loadingStatus=1;var K=document.createElement("script");K.type="text/javascript";K.src="http://maps.google.com/maps/api/js?sensor=false&callback=mstrmojo.GeoLocation._loadScriptCallBack";document.body.appendChild(K);}});})();(function(){mstrmojo._IsSelectorTarget={_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(B){var C=((B)?"add":"remove")+"DirtyKey";if(this.parent&&this.parent[C]){this.parent[C](this.k);}}};})();mstrmojo.android.EnumOrientationTypes={PORTRAIT:1,LANDSCAPE:2};(function(){function B(I,J,H){var F=0,G=0,E=(H&&H.length)||0;if(!I||!H){return F;}for(;G<E;G++){F+=H[G][J]();}return F;}function D(E,F){if(F===undefined||isNaN(F)){return E;}return(E&&[E[F-1]]);}mstrmojo._CanMeasureChildren={height:function A(E){return B(this.domNode,"height",D(this.children,E));},width:function C(E){return B(this.domNode,"width",D(this.children,E));}};}());(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats();var I=J.toLowerCase();if(H&&I in H){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects={height:function A(){return B("Height",this);},width:function D(){return B("Width",this);},getMaxZIndex:function C(){var E=0;mstrmojo.array.forEach(this.children,function(F){E=Math.max(E,F.getFormats()["z-index"]);});return E;}};})();(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}else{if(D.visible){return this._super(D);}else{var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;}}},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});})();mstrmojo.mstr.EnumWebAPIErrorCodes={MSI_INBOX_MSG_NOT_FOUND:-2147468986,E_MSI_USERMGR_USER_NOTFOUND:-2147209051,AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:-2147216963,AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:-2147216960,AUTHEN_E_LOGIN_FAIL:-2147216959,E_UNUSED:4294967295};(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo._HasDrillLinks","mstrmojo.registry","mstrmojo.hash","mstrmojo.dom");var B=mstrmojo.dom;function D(F){var E=F;while(E){if(E.openDrillLinkMenu){return E;}E=E.parent;}return null;}mstrmojo._HasHoverButton=mstrmojo.provide("mstrmojo._HasHoverButton",mstrmojo.hash.copy(mstrmojo._HasDrillLinks,{_mixinName:"mstrmojo._HasHoverButton",buttonNodeMarkup:'<div class="mstrmojo-LinkInfo-buttonNode"></div>',init:function C(E){this._super(E);this.markupSlots.buttonNode=function(){return this.domNode.lastChild;};},postBuildRendering:function A(){if(!this.hoverBtn){this.addChildren(mstrmojo.registry.ref({scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"hoverBtn",onclick:function H(){this.openPopup();},openPopup:function E(){var J=D(this);if(J){J.openDrillLinkMenu({openerButton:this,drillLinkItems:this.parent.drillLinkItems,cmPos:this.cmPos});}},closePopup:function F(){var J=D(this);if(J){J.closeDrillLinkMenu();}}}));}var G=this._super();var I=this.id;B.attachEvent(this.domNode,"contextmenu",function(J){mstrmojo.all[I].oncontextmenu(J,self);});return G;},oncontextmenu:function(G,E){var F=this.hoverBtn;F.cmPos=B.getMousePosition(G,E);F.openPopup();F.cmPos=null;B.preventDefault(E,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,L=mstrmojo.hash;function F(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(C.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function B(R){var Q=[],S=R.selectedIndices;for(var P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function N(V,U){var S=[],Q=V.selectedIndices,X=C.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return B(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}for(var R=0,T=U.length;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex==W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V;for(var Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function H(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function O(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=B(this),S=F(this,[P]);if(Q!==true){H(this,S,R);}}},toggleSelect:function J(P,Q){var S,R;if(this.selectedIndices[P]){R=N(this,[P]);}else{S=F(this,[P]);}if(Q!==true){H(this,S,R);}},rangeSelect:function G(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=B(this);if(P!==true){H(this,null,Q);}},select:function E(R,P){var Q=A(this,C.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){H(this,Q.add,Q.rmv);}},addSelect:function M(R,P){if(R==null){return ;}if(R.constructor!==Array){R=[R];}var Q=F(this,R);if(P!==true){H(this,Q,null);}return Q;},removeSelect:function K(R,P){if(R==null){return ;}if(R.constructor!=Array){R=[R];}var Q=N(this,R);if(P!==true){H(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){H(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof (T)=="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=C.find(U,V,T[V]);}else{if(T!=null){Q=C.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function D(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!=null){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return L.keyarray(this.selectedIndices,true).sort(C.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return C.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],t=this.itemIdField!=null?C.findMulti(S,this.itemIdField,Q):C.indexOfMulti(S,Q),V=Q.length,T=V-t.count,q=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(q&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],f=t.map;if(T&&q){var p=0;for(var e=0;e<V;e++){if(f[e]==null){R.push(Q[e]);U.push(b+p++);}}this.add(R,b);}var W=[];for(var h in f){var o=f[h];if(o>=b){o+=X;}W.push(o);}var s=W.concat(U),Y=this.addSelect(s,!d);if(!d){var Z=C.hash(Y),g=this.selectedIndices,a=[];for(var l in g){if(!Z[l]){a.push(parseInt(l,10));}}var P=this.removeSelect(a,true);H(this,Y,P);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash;mstrmojo._CanSupportTransaction={_mixinName:"mstrmojo._CanSupportTransaction",updatedCellsMap:null,getUpdates:mstrmojo.emptyFn,getUpdateObject:mstrmojo.emptyFn,getKeyContext:mstrmojo.emptyFn,autoRefresh:mstrmojo.emptyFn,editNext:mstrmojo.emptyFn,dataChanged:function A(F,G,E,H){var D=this.updateValue(F,E);this.updatedCellsMap[F]={r:G,v:E};this.controller.onTransactionUpdates(this,this.getUpdateObject(),D);},postBuildRendering:function B(){if(this._super){this._super();}if(!this.txModel){this.txModel=this.model.docModel||this.model;}this.updatedCellsMap=this.updatedCellsMap||{};},updateValue:function(E,D){if(this.txModel.deltaUpdate){this.txModel.deltaUpdate(this);}return false;},getUpdatedValues:function(){var E=this.updatedCellsMap,F,D,G=[];for(F in E){if(E.hasOwnProperty(F)){D={};D.v=E[F].v.v;G.push(C.copy(this.getKeyContext(F),D));}}return G;},clear:function(){this.updatedCellsMap={};},registerTxWidget:function(){function E(F,H){var G=F.node.data.k;H.txWidgets=H.txWidgets||{};H.txWidgets[G]=F;return false;}var D=this.parent;while(D){if(D.isPanelStack===true){E(this,D);}D=D.parent;}}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash,A=null;function B(D){return mstrmojo.DICFactory.createDIC(C.copy({dic:this.dic,owner:this.owner,group:this},D));}mstrmojo.DICFactory=mstrmojo.provide("mstrmojo.DICFactory",{createDIC:function(G){var E=G.dic,F=mstrmojo.DICConfig.getDICClass(E),D;if(F){if(G.k===undefined){G.k=G.opener&&G.opener.id;}G.showByDefault=mstrmojo.DICConfig.showDICByDefault(G.dic,G.openerType);G.hasPreview=mstrmojo.DICConfig.hasDICPreview(G.dic,G.openerType);D=new F(G);}return D;},createDICPopup:function(D,E){return mstrmojo.DICPopup.getInstance(D,E);},createDICGroup:function(F){var I=C.copy(F,{scriptClass:"mstrmojo.Widget",widgetsMap:{},dic:null,owner:null,groupMembers:{},postCreate:function(){var L=this.dic,K=this.openerType,J=mstrmojo.DICConfig;this.showByDefault=J.showDICByDefault(L,K);this.hasPreview=J.hasDICPreview(L,K);},addDIC:function D(J,K){this.groupMembers[J]=K;},showPopupDIC:function H(K){if(!this.showByDefault){var J=this.widgetsMap[K],L=this.groupMembers[K];if(!L){return ;}if(!J){J=this.widgetsMap[K]=B.call(this,L);}J.showInPopup();}},render:function G(){if(this.showByDefault||this.hasPreview){var L=this.groupMembers,K=this,J;C.forEach(L,function(N,M){if(!N.hasRendered){K.widgetsMap[M]=J=B.call(K,N);if(K.showByDefault){J.render();}else{if(K.hasPreview){J.renderPreview();}}N.hasRendered=true;}});}},destroy:function E(){C.forEach(this.widgetsMap,function(J){J.destroy();});this.widgetsMap={};}});return mstrmojo.insert(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.string","mstrmojo.StringBuffer");mstrmojo._XMLNode=mstrmojo.declare(null,null,{nodeName:null,init:function N(O){mstrmojo.hash.copy(O,this);},addChild:function F(P){var O=new mstrmojo._XMLNode({nodeName:P});return this.appendNode(O);},appendNode:function J(O){if(O){if(!this.children){this.children=[];}this.children.push(O);O.parent=this;}return O;},addAttribute:function L(O,P){if(O!=null){if(!this.attributes){this.attributes={};}this.attributes[O]=P;}return this;},addText:function M(O){this._addToStringMember("text",O);return this;},addRawXML:function K(O){this._addToStringMember("rawXML",O);return this;},getXMLString:function I(){var O=new mstrmojo.StringBuffer();this.buildXMLString(O);return O.toString();},buildXMLString:function E(O){O=O||new mstrmojo.StringBuffer();O.append("<").append(this.nodeName).append(" ");this._buildAttributesXMLString(O).append(">").append(((this.text!=null)?this._escapeString(this.text):"")).append(((this.rawXML!=null)?this.rawXML:""));this._buildChildrenXMLString(O).append("</").append(this.nodeName).append(">");return O;},_buildAttributesXMLString:function D(O){var Q=this.attributes;if(Q){for(var R in Q){if(Q[R]!=null){var P=String(Q[R]);switch(R){case"et":case"nt":case"dmt":case"ddt":case"fnt":case"tp":case"stp":break;default:P=this._escapeString(P);}O.append(R+'="'+P+'" ');}}}return O;},_escapeString:function C(O){return mstrmojo.string.escape4HTMLText(O);},_buildChildrenXMLString:function H(P){var R=this.children;var O=R&&R.length;if(O){for(var Q=0;Q<O;Q++){if(R[Q]&&R[Q].buildXMLString){R[Q].buildXMLString(P);}}}return P;},_addToStringMember:function A(O,Q){var P=this[O];if(P==null){this[O]=Q;}else{this[O]=P+Q;}}});mstrmojo.XMLBuilder=mstrmojo.declare(null,null,{root:null,curNode:null,addChild:function F(O){if(!this.root){this.currentNode=this.root=new mstrmojo._XMLNode({nodeName:O});}else{this.currentNode=this.currentNode.addChild(O);}return this;},appendNode:function J(O){if(!this.root){this.currentNode=this.root=O;}else{this.currentNode=this.currentNode.appendNode(O);}return this;},addAttribute:function L(O,P){if(this.currentNode){this.currentNode.addAttribute(O,P);}else{alert("no root node");}return this;},addText:function M(O){if(this.currentNode){this.currentNode.addText(O);}else{alert("no root node");}return this;},addRawXML:function K(O){if(this.currentNode){this.currentNode.addRawXML(O);}else{alert("no root node");}return this;},closeElement:function G(){this.currentNode=this.currentNode.parent;},toString:function B(){if(this.root){return this.root.getXMLString();}else{return"";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer");var Q=mstrmojo.dom,O=mstrmojo.hash,T=mstrmojo.array;function U(){O.forEach(this.ifwMap,function(X){X.destroy();});this.ifwMap={};}function A(){var X=[],Z=null,Y=null;O.forEach(this.ifwMap,function(a){if(a.visible){X.push({psId:a.psId,psKey:a.psKey,anchorPos:a.anchorPosition||Q.position(a.anchor,true),anchorOrn:a.anchorOrientation});}});if(X.length>0){Z=this.getSelectedLayoutWidget();Y=Z&&Z.getScrollPos();}return{ifwRecords:X,docScrollRecord:Y};}function L(b){var X=(b&&b.ifwRecords)||[],Y=b&&b.docScrollRecord,Z=this.getSelectedLayoutWidget(),a=this,d={};if(X.length>0){if(Y&&Z){Z.scrollTo(Y);}T.forEach(X,function(e){a.showInfoWindow(e.psId,e.psKey,d,null,e.anchorOrn,e.anchorPos);});}}function I(){mstrmojo.DICPopup&&mstrmojo.DICPopup.cancel&&mstrmojo.DICPopup.cancel();}function N(){if(this.xtabStyleSheets){var Z,Y,X;for(Y=0;Z=this.xtabStyleSheets[Y];Y++){X=Z.parentNode;if(X){X.removeChild(Z);}}}}function W(Y,b){var Z=this.getLayout(Y),X=Z.docGroupBy,a=this.controller;if(X){X.set("data",b.groupbys);Z.gb=b;}if(a.getPageByTree){a.getPageByTree(true);}}mstrmojo._IsRwDocument={_mixinName:"mstrmojo._IsRwDocument",updateXtabStyles:function K(e,Z){var l=this.xtabStyleSheets&&this.xtabStyleSheets[0],k=this.styleList||{},Y=function(t,q){var s;for(s in q){var p=q[s].css||"";if(q[s].app){p=(t[s]||"")+p;}t[s]=p;}return t;},o=document;if(!k[e]){k[e]=Y({},this.model.getSelectedXtabStyles(e));}Y(k[e],Z);if(!l){this.xtabStyleSheets=[];l=this.xtabStyleSheets[0]=o.getElementsByTagName("head")[0].appendChild(o.createElement("style"));}var a=new mstrmojo.StringBuffer(),b,d;for(b in k){for(d in k[b]){a.append(k[b][d]);}a.append("\n");}a=a.toString();if(l&&a){l=l.styleSheet||l;if(Q.isWK){var j=l.firstChild;if(j){j.nodeValue=a;}else{l.appendChild(o.createTextNode(a));}}else{if(Q.isIE){l.cssText=a;var h,g,X,f;for(h=1;l.rules.length===4095&&o.styleSheets.length<31;h++){g=l.rules[4094];X=new RegExp(g.selectorText,"i");f=a.search(X);if(f===-1){break;}f=a.indexOf("}",f+1);a=a.slice(f+1);if(!this.xtabStyleSheets[h]){this.xtabStyleSheets[h]=o.getElementsByTagName("head")[0].appendChild(o.createElement("style"));}l=this.xtabStyleSheets[h].styleSheet;l.cssText=a;}}else{l.innerHTML=a;}}}this.styleList=k;},postBuildRendering:function S(){if(this.xtabStyleSheets){for(var Y,X=0;Y=this.xtabStyleSheets[X];X++){if(!Y.parentNode){document.getElementsByTagName("head")[0].appendChild(Y);}}}return this._super();},buildChildren:function B(b){var g;try{var d=this.model;if(d){var e=this.buildSubs||{},o=d.id+"-partialUpdate",Y=d.id+"-rebuildLayout",j=d.id+"-updateStyles",a=d.id+"-showInfoWin",Z=this.id;var h=this,l=function(){T.forEach(h.getLayouts(),function(p){if(p.k!==d.currlaykey){p.defn.loaded=false;}});};if(e[o]===undefined){var k=function X(AA){var s=this.model,q=s&&s.getLayoutDataCache(s.getCurrentLayoutKey()),p=AA&&AA.ids;if(O.isEmpty(q)||!p){return ;}T.forEach(AA.tree.layouts,function(AC){if(AC.k===s.currlaykey){this.updateXtabStyles(AC.k,AC.xtabStyles);if(AC.gbys){W.call(this,AC.k,AC.gbys);}return false;}},this);var w=O.forEach,AB=false,x={update:p.upd,refresh:p.tgts,adjustSectionSize:p.secs};w(p.ifws,function(AE,AD){var AC=mstrmojo.all[AE+"_ifw"];if(AC&&AC.visible){this.updateInfoWindowPS(AE,AD);}},this);w(x,function(AD,AC){w(AD,function(AF,AH){var AE=mstrmojo.all[AH],AG;if(AE&&AE[AC]!==undefined){AG=AE[AC](AC==="update"?q[AH]:null);if(AC==="adjustSectionSize"&&AG){AB=AB||(!!AG.heightReduced);}}},this);},this);var t=this.getSelectedLayoutWidget();if(AB){t.notifyScrollListeners();}var z=t.docLayout;if(z){z.resizeOrReposition();}if(AA&&AA.unloadCache){l();}};e[o]=d.attachEventListener("partialUpdate",Z,k);}e[Y]=e[Y]||d.attachEventListener("rebuildLayout",Z,function(p){var s=p&&p.restoreIW,q;if(s){q=A.call(this);this.model.aws=null;}this.onLayoutRebuilt(this.rebuildLayout(p.src.currlaykey,this.getLayouts()));if(p&&p.unloadCache){l();}if(s){L.call(this,q);}});e[j]=e[j]||d.attachEventListener("updateStyles",Z,function(p){this.updateXtabStyles(p.key,p.updatedStyles);});e[a]=e[a]||d.attachEventListener("showInfoWin",Z,function(p){this.showInfoWindow(p.psId,p.psKey,p.anchor,p.invalidate,p.anchorOrientation,p.anchorPosition);});this.updateXtabStyles(d.getCurrentLayoutKey());d.attachEventListener("refresh",this.id,function(){this.refresh();});}g=this._super(b);}catch(f){mstrmojo.err(f);}return g;},updateInfoWindowPS:mstrmojo.emptyFn,showInfoWindow:function H(Y,t,h,k,p,q){var a=this.model,e=a.getLayoutDataCache(a.getCurrentLayoutKey()),z=this.builder,X=e[Y]&&e[Y].defn,d=X&&X.iwpl,x=Y+"_ifw",AD=mstrmojo.all[x],AA=this.domNode,Z=mstrmojo.DocInfoWindow.PLACEMENT.FIXED,AB=function(AE,AF,AG,AI,AH){if(d===Z){if(AF){var AJ=Q.delta(AF,AA);AE.popPosition={left:(AJ&&AJ.x)?AI+AJ.x:AI,top:(AJ&&AJ.y)?AH+AJ.y:AH};}else{if(AG){AE.popPosition={left:(AG.scrollboxLeft)?AI-AG.scrollboxLeft:AI,top:(AG.scrollboxTop)?AH-AG.scrollboxTop:AH};}else{AE.popPosition={left:AI,top:AH};}}}};var o=this.getLayout(a.getCurrentLayoutKey());if(AD){if(k){AD.refresh();}AD.anchorOrientation=p;AD.anchorPosition=q;AB(AD,AD._ifwpdn,o,AD._ifwfl,AD._ifwft);AD.open(this,{anchor:h,boundary:AA});}else{var f={opener:this,anchor:h,anchorOrientation:p,boundary:AA,parent:this,builder:z,model:this.model,psKey:t,psId:Y,id:x,autoCloses:true,locksHover:true,closeOnClick:false,anchorPosition:q};if(d){d=parseInt(d,10);f.placement=d;if(d===Z){var g=X.fmts,b=f._ifwfl=g&&g.left&&parseInt(g.left.replace("px",""),10),w=f._ifwft=g&&g.top&&parseInt(g.top.replace("px",""),10),j=e[Y]&&e[Y].p,s=j&&a.getUnitInstance(j.k,j.wid),l=f._ifwpdn=s&&s.domNode;AB(f,l,o,b,w);}}AD=z.newInfoWindow(f);this.renderInfoWindow(AD);var AC=this.ifwMap=(this.ifwMap||{});AC[Y]=AD;}},renderInfoWindow:function J(X){X.render();},_lockInfoWinContainer:function G(Y){var b=this.ifwMap,X;for(X in b){var Z=b[X],a=Y.xtab;if(Z&&a&&Q.contains(Z.infoNode,a.domNode,true,document.body)){Z.autoCloseLocked=true;Y.onClose=function(){Z.autoCloseLocked=false;};break;}}},unrender:function R(X){U.call(this);this._super(X);N.call(this);},getLayouts:function M(){return this._layouts;},getLayout:function P(X){X=X||this.model.getCurrentLayoutKey();var Y=this.getLayouts();return Y[T.find(Y,"k",X)];},getNewLayout:function E(Y,e,X,h){var b=this,Z=b.model,d=Z.getDataService(),g=Y.layoutKey,a=e[T.find(e,"k",g)];if(a.defn&&(Y.reload||a.defn.loaded===false||(Z.zt&&(window.mstrMobileApp!==undefined)&&(a.defn.lastOrientation!==mstrMobileApp.getOrientation())))){var f=h.success;h.success=function(j){Z.replaceLayout(g,j);Z.currlaykey=g;if(X){a.zf=j.zf;b.selectLayout(a,false);}var k=b.rebuildLayout(g,e);if(b.controller.getPageByTree){b.controller.getPageByTree(true);}f(k);};d.loadDocLayout(Y,h);}else{h.success(a);if(X){this.selectLayout(a,true,{success:function(j){O.copyProps(["bs"],j,Z);}});}}},selectLayout:function D(a,b,d){var X=this.model,Y=a.k,Z=(Y!==X.currlaykey);X.currlaykey=Y;this.restoreLayoutState(a);if(b&&Z){X.getDataService().setCurrentDocLayout(Y,d);}else{if(d&&d.complete){d.complete();}}return a;},rebuildLayout:function C(Y,e){var a=this.model,Z=T.find,b=e[Z(e,"k",Y)],X=a.getChildren(this.node,false);var d=X[Z(X,"k",Y)];if(window.mstrMobileApp!==undefined){d.defn.lastOrientation=mstrMobileApp.getOrientation();}var f=this.replaceLayout(b,d);this.updateXtabStyles(Y,a.getSelectedXtabStyles(Y));U.call(this);I();return f;},destroy:function V(){U.call(this);if(this._super){this._super();}N.call(this);},replaceLayout:mstrmojo.emptyFn,restoreLayoutState:mstrmojo.emptyFn,onLayoutRebuilt:mstrmojo.emptyFn,unloadGbLayuts:function F(Z){var f=this.getLayouts(),b=this.model.getCurrentLayoutKey(),e,d,g,Y,a,X;e=this.getLayout();Y=e.gb&&e.gb.groupbys;for(a=0;a<Y.length;a++){g=Y[a];if(g.k===Z){X=g.unit.target.did;break;}}for(d=0;d<f.length;d++){e=f[d];if(e.k===b){continue;}Y=e.gb&&e.gb.groupbys;if(Y&&Y.length){for(a=0;a<Y.length;a++){g=Y[a];if(g.unit.target.did===X){e.defn.loaded=false;break;}}}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash");var B="AndroidServerTransport";mstrmojo.android.AndroidServerTransport={serverRequest:function A(I,H,F){var E=new mstrmojo.StringBuffer(),G,D;mstrmojo.hash.forEach(F.params,function(J,K){E.append(K+"="+encodeURIComponent(J));});G=F.taskURL+"?"+E.toString("&");F.params.hostUrl=F.taskURL;if(mstrApp.useBinaryFormat){D=JSON.stringify({params:F.params,url:G});}else{D=G;}$MAPF(true,B,"transportRequest");mstrMobileTransport.serverRequest(I,H,D,"response","progress");},cancelRequest:function C(D){$MAPF(false,B,"transportRequest");return mstrMobileTransport.cancelRequest(D);}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var R=mstrmojo.dom,P=mstrmojo.hash;var M=100;var E=R.supportsTouches?0.5:1;var F=1;var Q=100;var N={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var K=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[R.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[R.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[R.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[R.CSS3_TRANSITION]=this.decelerating?(R.CSS3_PREFIX+"transform 0.2s linear"):"";}},P.copy(N));var G=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},P.copy(N));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function L(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=P.copy(R.isSafari?K:G,P.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}R.attachEvent(U,R.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){R.detachEvent(T,R.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function I(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}R.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=R.getMousePosition(R.firstTouch(T,V),T);this.dragging=false;R.attachEvent(window,R.TOUCHMOVE,this._tmCallback);R.attachEvent(window,R.TOUCHEND,this._teCallback);},touchesMoved:function D(b,f){var Z=R.getMousePosition(R.firstTouch(b,f),b);R.preventDefault(b,f);if(!this.dragging){var T=5,j=Math.abs;if((this.scrollsHoriz&&j(Z.x-this.pos.x)>T)||(this.scrollsVert&&j(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},g={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=g;this.maxPos={x:Math.max(g.x-Y.x,0),y:Math.max(g.y-Y.y,0)};this.showScroll();}}if(this.dragging){R.stopPropogation(b,f);var d=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(d.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(d.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),h=this.lastDragTime;this.nextLastDragTime=h;this.lastDragTime=U;if((U-h)>Q){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function H(T,U){R.preventDefault(T,U);R.detachEvent(window,R.TOUCHMOVE,this._tmCallback);R.detachEvent(window,R.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;R.stopPropogation(T,U);if((new Date())-this.lastDragTime<=Q){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=R.getMousePosition(R.firstChangedTouch(Y,Z),Y),d=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-d.x,y:W.y-d.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),f=T?(new Date())-T:0,V={x:f?Number(b.x*M*E/f).toFixed(2):0,y:f?Number(b.y*M*E/f).toFixed(2):0};var a=this,U=function(e){return(a.scrollsHoriz&&Math.abs(e.x)>=F)||(a.scrollsVert&&Math.abs(e.y)>=F);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,M);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=(b)?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=(b)?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function J(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function O(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var B=mstrmojo.EnumReadystate;function D(F){return(F.getKey&&F.getKey())||F.k;}mstrmojo._IsDocController={_mixinName:"mstrmojo._IsDocController",_getXtabCallback:function(J){var F={},H=F[D(J)]=J.defn,I=this,G=I.model;return G.newCallback({submission:function(){if(H.set){H.set("readyState",B.WAITING);}},success:function(K){if(K.pukeys){F=G.getUnitDefinitions(K.pukeys);}G.partialUpdate(K.data,F);},failure:function(K){mstrmojo.alert(K.code+": "+K.message);},complete:function(){if(H.set){H.set("readyState",B.IDLE);}I.docRequestComplete();}});},_addNodeKeyToAction:function(F,G){G.nodeKey=D(F);return G;},onGridSelector:function(G,J){var F=this.model,I=F.getTargetInfoWin(J.tks);if(I&&I.length){for(var H=0;H<I.length;H++){F.showInfoWin(I[H],J.anchor,"h",true);}}J.sid=G.sid;F.slice(J);},onVisSelector:function(G,I){if(I.anchor){var F=this.model,H=F.getTargetInfoWin(I.tks);if(H&&H.length){F.showInfoWin(H[0],I.anchor,"h",true);}}if(G.xtabModel&&G.xtabModel.docModel&&G.xtabModel.docModel.slice){G.xtabModel.docModel.slice(I);}},isInRequest:function C(){var F=!!this._inProcess;if(!F){this._inProcess=true;}return F;},docRequestComplete:function E(){this._inProcess=false;},nudgeWidget:mstrmojo.emptyFn,getGroupByElements:function A(H){var L=[],K;while(H){var K=H.node&&H.node.data&&H.node.data.pbes;if(K){break;}H=H.parent;}if(K){var I=this.model.data.elems;for(var J=0,G=K.length;J<G;J++){var F=K[J];L.push(isNaN(F)?F:I&&I[F]);}}return L;}};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=(F)?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var G=mstrmojo.dom,H=Math;var D=1,F=2,I=3,K=4,E=5,A=6;function B(){var N=this.anchor;if(!N){return false;}var W=this.baseTipClass,X=this[this.tipNodeName];X.className=W+" top";var k=this[this.boundaryNodeName],AB=this[this.popupNodeName],h=this.anchorOffset,z=this.anchorOrientation,w=this.hasScrollbars(),e=mstrmojo.hash.copy(this.anchorPosition||G.position(N,true)),Q=G.position(k,true),AF=Q.w,O=Q.h,l=AB.offsetWidth,S=AB.offsetHeight,a=l/2,L=S/2,d=G.position(X),s=H.min(d.h,d.w),U=H.max(d.h,d.w)/2,p=this.placement;if(w){AF-=15;O-=15;}var f=G.contains(k,AB),t=f?0:Q.y,AE=AF/2-a,V=O/2-L+t,AA=-1000,AG=-1000,P,q=["borderBottomColor","borderTopColor","borderRightColor","borderLeftColor"],AH=0;if(f){e.x=e.x-Q.x;e.y=e.y-Q.y;}var o=e.y+e.h,R=e.x+e.w,AC=((R+l)<AF),Y=e.y>S,x=((o+S)<O),b=function(AI,AK,AJ){return H.min(H.max(AI,AJ),H.max(AK,0));},T=function(){if((e.x<AF)&&(x||Y)){var AI=e.x+(e.w/2),AJ=(p==K&&x)||!Y;if(AJ){P="top";AG=o;AH=0;V=o+s-h;}else{P="bottom";AG=e.y-s;AH=1;V=AG-S+h;}AE=b(0,AF-l,AI-a);AA=b(e.x,R,AI)-U;return true;}return false;},j=function(){if((e.y<O)&&(AC||e.x>l)){var AI=e.y+(e.h/2),AJ=!(p==E&&e.x>l)&&AC;if(AJ){P="left";AA=R;AH=2;AE=R+s-h;}else{P="right";AA=e.x-s;AH=3;AE=AA-l+h;}V=b(t,O-S,AI-L);AG=b(e.y,o,AI)-U;return true;}return false;},Z=[T,j],AD=0;if(p==F){V=this.popPosition.top;AE=this.popPosition.left;AG=-1000;AA=-1000;P=null;}else{if(p==E||p==A||(p==D&&z==="h")){Z.reverse();}for(;AD<2;AD++){if(Z[AD]()){break;}}V=H.round(V);AE=H.round(AE);AG=H.round(AG);AA=H.round(AA);}X.className=W+" "+(P||"hidden");var g=X.style,M=AB.style;g.top=AG+"px";g.left=AA+"px";if(this.tipNodeColor){mstrmojo.array.forEach(q,function(AI){g[AI]="";});g[q[AH]]=this.tipNodeColor;}M.top=V+"px";M.left=AE+"px";return true;}mstrmojo._IsAnchorable={anchor:null,anchorPosition:null,boundaryNodeName:"curtainNode",popupNodeName:"editorNode",tipNodeName:"tipNode",baseTipClass:"mstrmojo-Editor-tip",anchorOffset:25,anchorOrientation:"v",placement:D,popPosition:null,hasScrollbars:function C(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},prepareAnchor:mstrmojo.emptyFn,positionDialog:function J(){this.prepareAnchor();if(!B.apply(this,[])){if(typeof this._super==="function"){this._super();}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function A(){var I=this.getFormats(),G="",H=function H(J){if(I[J]){var K=this[J]||I[J];this[J]=K;if(this.isFullScreenWidget){I[J]=K;}this[J+"Limit"]=parseInt(K,10);}};H.call(this,"height");H.call(this,"width");var F=function(M,L){var J=I[M];if(J&&J.charAt(J.length-1)!=="%"){var K=parseInt(J,10);if(!isNaN(K)){if(L){K-=L;}G+=M+":"+K+"px;";}}return null;};F("height",0);F("width",0);this.scrollboxNodeCssText=G;return this._super();},resize:function(){this.clearCache();var I=this.getFormats(),G=parseInt(I.height,10),F=parseInt(I.width,10);if(F>0&&G>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}mstrmojo.array.forEach([this.scrollboxNode,this.viewport],function(K){var J=K.style;J.height=G+"px";J.width=F+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=G&&(G!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(G,10);this.scrollboxBottom=this.scrollboxTop+G;}if(this.lockHeadersCase){this.resizeScrollBox(B.isIE);}}var H=this.zones;if(H){if(H._BL){H._BL.onscroll();}if(H._BR){H._BR.onscroll();}}if(!(this.gridData&&this.gridData.eg)){this.onGridWidthChanged();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function D(){this.clearCache();this.unrender();this.render();},unrender:function E(){this.clearCache();if(this._super){this._super();}},defaultAction:function C(J,H){if(this._super(J,H)){var F=this.model.sti,G=F&&F.titleId,L=F&&F.deselectCurrent,M;this._currentSelectedTD=L?undefined:J;if(G){for(M in this.zones){var N=this.zones[M],K=N.domNode,I=K&&K.firstChild;if(I&&(J.offsetParent===I||J.offsetParent===K)){N.clearHilites(G);if(!L){N.setHilites(G,J);}N.hiliteKey=G;this.model.sti=null;return true;}}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom,E=false;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function(){var F=C.windowDim(),J=(C.isFF||C.isWK)?0:2;var G=F.w,I=F.h;if(E){var H=I;I=G;G=H;}return{w:Math.max(G,0)+"px",h:Math.max(I-J,0)+"px"};},simulateOrientationChange:function A(){E=!E;this.monitorWindow();},preBuildRendering:function B(){var G=true;if(this._super){G=this._super();}var H=this.getBrowserDimensions();if(!("browserResized" in this)||this.browserResized(H)!==true){this.height=H.h;this.width=H.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return G;},destroy:function D(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function(F){var H=F.currentTarget,I=this.getBrowserDimensions(),G={w:(H?H.innerWidth+"px":I.w),h:(H?H.innerHeight+"px":I.h)};if(G.h===this.height&&G.w===this.width){return ;}if(!("browserResized" in this)||this.browserResized(G)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=mstrmojo.dom;function E(J,I){var G=[];if(J){for(var F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function D(L,F,N){var I=N.hWin,J=N.e,G=A.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=A.ctrlKey(I,J),O=A.shiftKey(I,J);if(K||O){A.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}},premouseup:function C(H,K,G){var F=G.hWin,J=G.e,L=A.ctrlKey(F,J),I=A.shiftKey(F,J);if(L||I){A.clearBrowserHighlights(F);}},onadd:function B(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=E(K,G);for(var J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function B(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){for(var H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);for(var J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var Y=5;var k=1;var V=2;var N=4;var j=0;var O=true;var I=0;var F=86400000;mstrmojo.VisChartUtils=mstrmojo.provide("mstrmojo.VisChartUtils",{getScreenZoomFactor:function Z(){if(I==0){if(mstrMobileApp){var q=mstrMobileApp.getDeviceDPI();console.log("dpi:"+q);I=q/160;}else{I=1;}}return I;},changeElementSize:function a(w,AB,AA){if(AB=="fontSize"||AB=="height"||AB=="line-height"){var z=mstrmojo.css.getStyleValue(w,AB);var t=Math.round(AA*parseInt(z));w.style[AB]=t+"px";}else{if(AB=="font"){var x=mstrmojo.css.getStyleValue(w,"fontSize");var t=Math.round(AA*parseInt(x));var s=mstrmojo.css.getStyleValue(w,"fontWeight");var q=mstrmojo.css.getStyleValue(w,"fontFamily");w.style.font=s+" "+t+"px "+q;}}},rgbaStr2rgba:function L(q){var t=null;q=q.replace(/ /g,"");var s=q.indexOf("rgba");if(s>=0){q=q.substring(s+5,q.length-1);t=q.split(",");}return t;},fillBackground:function b(z,s,AH,t,AB){var AA=t||z.context,x=s||z.canvas.width,AE=AH||z.canvas.height,AF=z.themeColor||"#000000",AD=null,AG=AB||1;if(!AA){AA=z.canvas.getContext("2d");if(!AA){return ;}}AA.save();if(z.noBackground){}else{if(!z.isAndroid&&!z.isTimeSeries){AD=AA.createLinearGradient(0,0,0,AE/2);AA.fillStyle=AF;AA.fillRect(0,0,x,AE);AA.globalAlpha=0.4;AD.addColorStop(0,"#fff");AD.addColorStop(0.1,"#fff");AD.addColorStop(1,AF);AA.fillStyle=AD;AA.rect(0,0,x,AE/2);AA.fill();AA.globalAlpha=0.1;AA.fillStyle="#fff";AA.fillRect(0,0,x,AE/2);}else{if(z.isTimeSeries){var AC=z.formatProp;AD=AA.createLinearGradient(0,0,0,AE);AA.globalAlpha=AC.backgroundAlpha;var q=this.rgb2rgbStr(AC.backgroundClr,0.83)||"#2c2c2c";var w=this.rgb2rgbStr(AC.backgroundClr)||"#000000";AD.addColorStop(0,q);AD.addColorStop(1,w);AA.fillStyle=AD;AA.rect(0,0,x,AE);AA.fill();}else{AA.globalAlpha=AG;AA.fillStyle=AF;AA.fillRect(0,0,x,AE);}}}AA.restore();},rgb2rgbStr:function W(s,t){var q="";if(!s||s.length!=3){return q;}if(t||t==0){q="rgba("+s[0]+","+s[1]+","+s[2]+","+t+")";}else{q="rgb("+s[0]+","+s[1]+","+s[2]+")";}return q;},getRGBWithOpacity:function R(s,q,t){if(isNaN(q)){return ;}if(!t){t=[255,255,255];}var w=[];for(color in s){w[color]=parseInt(s[color]*(1-q)+t[color]*q);}return w;},fillMasterChartBackground:function S(AD,t,q,x,AJ,AC,z){var AE=z||AD.context,AB=x||AD.canvas.width,AH=AJ||AD.canvas.height,AI=AD.themeColor,AG=null;var AF=AD.formatProp;AE.save();AE.globalAlpha=AF.backgroundAlpha;AE.fillStyle=this.rgb2rgbStr(AF.backgroundClr)||"#000000";AE.fillRect(0,0,AB,q);AG=AE.createLinearGradient(0,0,0,AH/2);var s=this.rgb2rgbStr(this.getRGBWithOpacity(AF.backgroundClr,0.45))||"#737373";var AA=this.rgb2rgbStr(this.getRGBWithOpacity(AF.backgroundClr,0.13))||"#222222";AG.addColorStop(0,s);AG.addColorStop(1,AA);AE.fillStyle=AG;AE.fillRect(t,q,AB,AH/2);AE.fillStyle=this.rgb2rgbStr(AF.backgroundClr)||"#000000";AE.fillRect(t,q+AH/2,AB,AH/2+AC);AE.globalAlpha=1;AE.strokeStyle=this.rgb2rgbStr(AD.formatProp.textClr,0.5);AE.lineWidth=1;var w=q+0.5;this.drawLineSet(this,[{x:t,y:w},{x:t+AB,y:w}],false,AE);w=q+AH-0.5;this.drawLineSet(this,[{x:t,y:w},{x:t+AB,y:w}],false,AE);AE.restore();},drawLineSetWithSplit:function(z,AD,AC,s,AA){var t=AD.length,AB=Math.ceil(t/AA),q,w;for(var x=0;x<AB;x++){q=x*AA;w=Math.min(q+AA+1,t);this.drawLineSet(z,AD.slice(q,w),AC,s);}},drawLineSet:function M(x,AE,AD,q){var z=null,t=AE.length,AC=null;if(q){z=q;}else{z=x.context;}var AA=null,s=false;z.beginPath();var w=0;while(w<t){if(AE[w]){z.moveTo(AE[w].x,AE[w].y);AA=AE[w];s=true;w++;break;}w++;}var AB=false;for(;w<t;w++){AC=AE[w];if(AC){if(!AB){z.lineTo(AC.x,AC.y);s=false;}else{z.moveTo(AC.x,AC.y);s=true;AA=AC;AB=false;}}else{if(!AB){AB=true;if(s){z.arc(AA.x,AA.y,1,0,Math.PI*2,false);}}}}if(AD){z.closePath();z.fill();}else{z.stroke();}},getMinYPosition:function H(s,x,q){var w=x,t;while(w<=q){if(s[w]){t=s[w].y;break;}w++;}for(w=x;w<=q;w++){if(s[w]){t=Math.min(t,s[w].y);}}return t;},drawLineAreaWithSplit:function(AA,AG,q,x,w,AB,s,AC){var t=x-q+1,AE=Math.ceil(t/AC),AF,AD;for(var z=0;z<AE;z++){AF=q+z*AC;AD=Math.min(AF+AC,q+t-1);this.drawLineArea(AA,AG,AF,AD,w,AB,s);}},drawLineArea:function M(z,q,AC,x,AB,AG,t){var AF=null,AJ=q.length,AE=null,AK=0,AD=0;if(t){AF=t;}else{AF=z.context;}var w=null,AI=false;AF.save();AF.lineWidth=0;AF.beginPath();var AM=AC,AA;while(AM<=x){if(q[AM]){AK=q[AM].x;AF.moveTo(AK,AB);w=q[AM];AI=true;break;}AM++;}AA=AM;var AH=false;for(;AM<=x;AM++){AE=q[AM];if(AE){if(!AH){AF.lineTo(AE.x,AE.y);AI=false;AD=AE.x;}else{AK=AE.x;AF.moveTo(AK,AB);if(AM+1<=x&&q[AM+1]){AF.lineTo(AE.x,AE.y);}w=AE;AH=false;AA=AM;}}else{if(!AH){AH=true;if(!AI){AF.lineTo(AD,AB);AF.lineTo(AK,AB);var s=this.getMinYPosition(q,AA,AM)||0;var AL=AF.createLinearGradient(0,s,0,AB);AL.addColorStop(1,this.rgb2rgbStr(AG,0));AL.addColorStop(0,this.rgb2rgbStr(AG,1));AF.fillStyle=AL;AF.globalAlpha=0.8;AF.fill();}}}}if(!AI){AF.lineTo(AD,AB);AF.lineTo(AK,AB);var s=this.getMinYPosition(q,AA,x)||0;AF.closePath();var AL=AF.createLinearGradient(0,s,0,AB);AL.addColorStop(1,this.rgb2rgbStr(AG,0));AL.addColorStop(0,this.rgb2rgbStr(AG,1));AF.fillStyle=AL;AF.globalAlpha=0.8;AF.fill();}AF.restore();},drawRectangle:function l(AB,q,AD,t,AA,AC,z){var s=null;if(z){s=z;}else{s=AB.context;}if(AC){s.fillRect(q,AD,t,AA);}else{s.strokeRect(q,AD,t,AA);}},drawArc:function Q(w,AD,AC,AA,AB,s,t,AE,q){var z=null;if(q){z=q;}else{z=w.context;}z.beginPath();z.arc(AD,AC,AA,AB,s,t);if(AE){z.fill();}else{z.stroke();}},drawRoundRect:function K(t,q,AC,s,z,AA,AB){AA=Math.min(s/2,z/2,AA);t.beginPath();t.moveTo(q+AA,AC);t.arcTo(q+s,AC,q+s,AC+z,AA);t.arcTo(q+s,AC+z,q,AC+z,AA);t.arcTo(q,AC+z,q,AC,AA);t.arcTo(q,AC,q+s,AC,AA);t.closePath();if(AB){t.fill();}else{t.stroke();}},drawHalfRoundedRectangle:function p(t,AC,AB,AD,z,q,AE,s){var AA=null;if(s){AA=s;}else{AA=t.context;}AA.beginPath();AA.moveTo(AC+AD,AB);AA.lineTo(AC+q,AB);AA.arcTo(AC,AB,AC,AB+q,q);AA.lineTo(AC,AB+z-q);AA.arcTo(AC,AB+z,AC+q,AB+z,q);AA.lineTo(AC+AD,AB+z);if(AE){AA.fill();}else{AA.stroke();}},drawStartEndPoints:function X(AB,AH,t,x){var w=AH.length;var AC=null,q=AB.startEndPointRadius;if(t){AC=t;}else{AC=AB.context;}AC.save();var AE="#f0f43e",AD="#f0f43e",AF="#663300";if(AB.startPointColor){AE=AB.startPointColor;}if(AB.endPointColor){AD=AB.endPointColor;}else{var AG=AH[0].y,AA=AH[w-1].y;if(AG>AA){AD="#008000";}else{if(AG<AA){AD="#8d1616";}else{AD=AE;}}}if(AB.otherPointColor){AF=AB.otherPointColor;}if(x&k&&AH[0]){AC.strokeStyle=AE;AC.fillStyle=AE;this.drawArc(this,AH[0].x,AH[0].y,q,0,Math.PI*2,true,true,AC);}if(x&V&&AH[w-1]){AC.strokeStyle=AD;AC.fillStyle=AD;this.drawArc(this,AH[w-1].x,AH[w-1].y,q,0,Math.PI*2,true,true,AC);}if(x&N){AC.strokeStyle=AF;AC.fillStyle=AF;for(var z=1;z<w-1;z++){if(AH[z]){this.drawArc(this,AH[z].x,AH[z].y,q,0,Math.PI*2,true,true,AC);}}}AC.restore();},getColor:function T(q){return(parseInt(q.themeColor.substr(1),16)>8388607)?"#000000":"#ffffff";},drawHighlightLine:function d(s,AA){var q=s.context,z=s.margin,x=z.l,t=s.isTimeSeries?s.chartWidth+z.l:s.getWidth()-z.r;q.save();q.globalAlpha=1;q.strokeStyle=this.rgb2rgbStr(s.formatProp.textClr,0.35);q.lineWidth=1;q.lineCap="round";while(x<t){q.beginPath();q.moveTo(x,AA);x+=2;q.lineTo(x,AA);q.stroke();x+=3;}q.restore();},addLabel:function o(AK,AL,AJ,AH,s,AD,AE){var AG=document.createElement("div");AG.className="mstrmojo-Chart-lbl";AG.style.color=this.rgb2rgbStr(AK.formatProp.textClr,0.8);AG.innerHTML=AL;if(s){AG.style.width=s+"px";}var AA=null;var AF=0;if(AK.isTimeSeries){if(AE.w>=0){AA=AK.xdiv;AF=AK.animationCanvas.width;}else{AA=AK.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(!AA){AA=document.createElement("div");AA.id="mstrmojo-chart-ylbl-div";AA.className="mstrmojo-chart-ylbl-div";AK.domNode.appendChild(AA);}AA.style.width=AK.margin.l-1+"px";}}else{AA=AK.domNode;AF=AK.getWidth();}AA.appendChild(AG);var z=AG.offsetWidth||(AK.getTextWidth&&AK.getTextWidthByElem(AL,AG));var AI=AG.offsetHeight||22*(I||1);var t=s||z||100;var AC=AK.xLabelPadding/2;var AB=AK.yLabelPadding/2;if(AE.w>=0&&AK.isTimeSeries&&AK._scroller.origin){var AM=AJ-AK._scroller.origin.x;if(AM<=0&&(AM+z/2>-AK.maxYLblWidth)){AK.needRedrawVerticalLine=true;AA.removeChild(AG);return null;}var q=AM-AK.getChartWidthOnScreen();if((q-z/2)<=0&&q>=0){AK.needRedrawVerticalLine=true;AA.removeChild(AG);return null;}}if(AE.w>=0){AJ=AJ-t/2;}if(AE.h>=0&&((AH>=AE.y-AB&&AH<=AE.y+AE.h)||(AH+AI>=AE.y-AB&&AH+AI<=AE.y+AE.h)||(AH+AI>=AK.canvas.height-AK.margin.b))){AA.removeChild(AG);return null;}if(AE.w>=0&&(((AJ>=AE.x&&AJ<AE.x+AE.w+AC))||AJ<AE.x||AJ<AK.margin.l||AJ+t>AF)){AA.removeChild(AG);return null;}if(AK.isTimeSeries&&AE.h>=0){AA.style.top=(AK.margin.t-AI/2)+"px";AA.style.height=(AK.canvas.height-AK.margin.t-AK.margin.b-1+AI/2)+"px";this.translateCSS(AJ,(AH-AK.margin.t)+AI/2,AD,AG);}else{this.translateCSS(AJ,AH,AD,AG);AG.style.maxHeight=AI+"px";}AE.x=AJ;AE.y=AH;if(AE.h>=0){AE.h=AI;}if(AE.w>=0){AE.w=t;AG.style.textAlign="center";}return AG;},addDataLabel:function o(s,x,AA,t){var q=(s.margin.l>s.margin.r)?Y:s.getWidth()-s.margin.r+Y,z=(s.margin.l>s.margin.r)?s.margin.l:s.margin.r;return this.addLabel(s,x,q,AA-10,z-Y*2,false,t);},translateCSS:function f(q,z,s,w){var t="translate("+q+"px,"+z+"px)";if(s){t+=" rotate(45deg)";}w.style[J.CSS3_TRANSFORM]=t;},getTouchXYOnWidget:function B(s,q,x){var w=mstrmojo.TouchScroller,t=(w&&x.parent&&w.getScrollPositionTotals(x.parent))||{x:0,y:0};s=s-x.offsetLeft+t.x;q=q-x.offsetTop+t.y;return{touchX:s,touchY:q};},getYValue:function A(x,s){var q=x.canvas.height,w=x.margin,t=x.model.mvalues;return q-w.b-4-((parseFloat(s)-t[0])*x.RTY);},getMasterYValue:function e(w,s,x){var q=w.masterCanvas.height,t=w.model.mvalues;return q-x.b-3-((parseFloat(s)-t[0])*w.MRTY);},getSeriesIndexAndYValue:function C(AD,q,AE){var AF=AD.model.series,z=AF.length,AB=0;y=this.getYValue(AD,AF[AB].rv[q])||0;var AC=AE-y<0?-(AE-y):AE-y,t=AC;for(var AA=1;AA<z;AA++){var x=this.getYValue(AD,AF[AA].rv[q])||0;AC=AE-x<0?-(AE-x):AE-x;if(AC<t){y=x;t=AC;AB=AA;}}return{y:y,si:AB};},getLabelWidthForMargin:function h(q,x){var t=document.createElement("div");t.className="mstrmojo-Chart-lbl";t.innerHTML=x;q.domNode.appendChild(t);var s=t.offsetWidth||60;q.domNode.removeChild(t);return s+Y*2;},animateLineSet:function U(AF,t,AD,AB){var AG=[],AE=AF.animationContext,z=AD.length;AE.clearRect(0,0,AF.getWidth(),AF.canvas.height);if(!AB.index){AB.index=0;}else{if(AB.index>=AB.rate){this.drawLineSet(AF,AD,false,AE);AF.drawLabels();if(AF.isFillLinesArea){this.fillLinesArea(AF,AD.slice(0));}if(AF.isDrawStartEndPoints){this.drawStartEndPoints(AF,AD,AE,AF.isDrawStartEndPoints);}return ;}}for(var AA=0;AA<z;AA++){var s=AD[AA],q=t[AA];AG[AA]={x:(AB.index*(s.x-q.x)/AB.rate)+q.x,y:(AB.index*(s.y-q.y)/AB.rate)+q.y};}this.drawLineSet(AF,AG,false,AE);var AC=this;AB.index++;window.setTimeout(function(){AC.animateLineSet(AF,t,AD,AB);},40);},fillLinesArea:function G(s,z){var t=s.canvas.height;z.push({x:s.getWidth()-s.margin.r,y:t-s.margin.b});z.push({x:s.margin.l,y:t-s.margin.b});var AA=new Array();if(s.fillinColor){mstrmojo.requiresCls("mstrmojo.color");var x=mstrmojo.color.hex2rgb(s.fillinColor).join(",");AA[0]="rgba("+x+", 0.8)";AA[1]="rgba("+x+", 0.2)";}else{AA=["rgba(255,128,0,0.8)","rgba(255,128,0,0.2)"];}var q=s.animationContext;var x=q.createLinearGradient(0,0,0,t);x.addColorStop(0,AA[0]);x.addColorStop(0.75,AA[1]);q.fillStyle=x;this.drawLineSet(s,z,true,q);},convertRawValueToMilliseconds:function g(t){var w=Number(t),q=w-((new Date("1/1/1970").getTime()-new Date("12/30/1899").getTime())/F)-j,s=new Date(q*F);return new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()).getTime();},getAncestorBgColor:function D(t){var AB=null,AA=t,w=AA.model,AE=null;if(AA.hasOwnProperty("xtabModel")&&AA.xtabModel.hasOwnProperty("docModel")){AE=AA.xtabModel.docModel;}if(AE&&AE.defn&&AE.defn.layouts&&AE.defn.layouts.length>0){var AD=AE.defn.layouts,x;var s;for(s in AD){if(AD[s].loaded){x=AD[s];}}if(x&&x.hasOwnProperty("units")){var z=x.units;var AC=w.parent;while(AC){var q=AC.k||null;if(z[q]&&z[q].fmts&&z[q].fmts["background-color"]){AB=z[q].fmts["background-color"];break;}else{AC=AC.parent||null;}}if(!AB){if(x.fmts&&x.fmts["background-color"]){AB=x.fmts["background-color"];}}}}return AB;},getPointDistanceSquare:function E(s,q){return(s.x-q.x)*(s.x-q.x)+(s.y-q.y)*(s.y-q.y);},truncateTextToLine:function(s,AF,AJ){AF.className=s.className;AF.style.whiteSpace="nowrap";var AA=AF.innerHTML=s.innerHTML;var w=parseInt(s.offsetWidth)-parseInt(s.style.width);var AH=AJ*parseInt(s.style.width)+w;var x=AA;if(AF.offsetWidth>AH){var AB=0,t=AA.length-1;while(AB<=t){var AE=Math.round((AB+t)/2);var AI=AA.substr(0,AE+1);var AG=AA.substr(0,AE+2);AF.innerHTML=AI;var AD=AF.offsetWidth;AF.innerHTML=AG;var z=AF.offsetWidth;if(AD<=AH&&z>AH){break;}else{if(AD>AH){t=AE-1;}else{if(z<=AH){AB=AE+1;}}}}x=AA.substr(0,AE+1);if(x.length<AA.length){if(x.charAt(x.length-1)===" "){x=x.substr(0,x.length-1);}var AC=x.lastIndexOf(" ");var q=x.length-1-AC;if(q>=2&&q<=8){x=x.substr(0,x.length-q-1)+"...";}else{x=x.substr(0,x.length-3)+"...";}}}s.innerHTML=x;},getLen:function(w,t,s,q){t.innerHTML=w;var x=t.offsetWidth+s-q;return x;},splitWordIfTooLong:function(x,AI,AF,AB,AD){var AH=x.split(" ");var AC=[];var AE=AH.length;var z=0;var w=0;for(z=0;z<AE;z++){var s=AH[z];while(true){var AJ=this.getLen(s,AI,AD,AB);if(AJ>AF){var AG=(AF/AJ)*s.length;var q=Math.round(AG);while(q>0){var AA=s.substr(0,q);var t=this.getLen(AA,AI,AD,AB);if(t<=AF){AC.push(AA);break;}else{q--;}}s=s.substr(q,s.length-q);}else{AC.push(s);break;}}}return AC.join(" ");},truncateTextToLineWithWordWrap:function(AS,AO,AL){AO.className=AS.className;AO.style.whiteSpace="nowrap";var AK=7;var AC=-1;if(AS.style&&AS.style.width&&AS.style.width.length>0){AC=parseFloat(AS.style.width);}if(AC<0){AC=parseFloat(mstrmojo.css.getComputedStyle(AS).width);}var AM=AS.innerHTML;var AR=parseFloat(AS.offsetWidth)-AC;AM=this.splitWordIfTooLong(AM,AO,AC,AR,AK);var AE=AM.split(" ");var x=[];var AH=[];var AQ=0;var q=0;var AJ=AE.length;AO.innerHTML="&nbsp;";var AT=AO.offsetWidth-AR;AH.push(0);for(AQ=0;AQ<AJ;AQ++){var s=this.getLen(AE[AQ],AO,AK,AR);if(s>AC){var AD=AE[AQ];var AP=(AC/s)*AD.length;AE[AQ]=AD.substr(0,parseInt(AP));s=AC;}x.push(s);q+=s;AH.push(q);if(AQ!==AJ-1){q+=AT;}}var AG=0,AN=0;var AF=AL;for(;AN<AH.length;){var AB=AH[AN]-AH[AG];if(AG>0&&AN!=AG){AB-=AT;}var AA=AH[AN+1]-AH[AG];if(AG>0&&AN+1!=AG){AA-=AT;}if(AB<=AC&&((AN+1==AH.length)||(AA>AC))){AF--;if(AF==0||AN===AJ){break;}else{AG=AN;AN++;}}else{AN++;}}if(AN>AJ){AN=AJ;}var AI=AH[AN]-AH[AG];if(AG>0&&AN!=AG){AI-=AT;}var AU;if(AN>=AJ&&AI<AC){AU=AE.join(" ");}else{AU=AE.slice(0,AN).join(" ");var w=this.getLen("...",AO,AK,AR);if(AI+w<=AC){AU+="...";}else{if(AU.charAt(AU.length-1)===" "){AU=AU.substr(0,AU.length-1);}var z=AU.lastIndexOf(" ");var t=AU.length-1-z;if(t===3){AU=AU.substr(0,AU.length-3)+" ...";}else{AU=AU.substr(0,AU.length-3)+"...";}}}AS.innerHTML=AU;},getLen2:function(AA,s,q){var t=q;var w=t.getContext("2d");w.font=s;w.textAlign="center";w.fillStyle="blue";var z=w.measureText(AA);var x=z.width;return x;},splitWordIfTooLong2:function(z,AF,x,AA){var AH=z.split(" ");var AD=[];var AE=AH.length;var AB=0;var w=0;for(AB=0;AB<AE;AB++){var s=AH[AB];while(true){var AI=this.getLen2(s,x,AA);if(AI>AF){var AG=(AF/AI)*s.length;var q=Math.max(Math.round(AG),1);while(q>0){var AC=s.substr(0,q);var t=this.getLen2(AC,x,AA);if(t<=AF||q==1){AD.push(AC);break;}else{q--;}}s=s.substr(q,s.length-q);}else{AD.push(s);break;}}}return AD.join(" ");},getComputedFontStyle:function P(q){var s=q.fontStyle+" "+q.fontWeight+" "+q.fontSize+"/"+q.fontVariant+" "+q.fontFamily;return s;},truncateTextToLineWithWordWrap2:function(AV,AF,AN){var AE=-1;if(AV.style&&AV.style.width&&AV.style.width.length>0){var AS=0;var AU=mstrmojo.css.getComputedStyle(AV);if(AU.paddingLeft){AS+=parseFloat(AU.paddingLeft);}if(AU.paddingRight){AS+=parseFloat(AU.paddingRight);}var AT=AV.offsetWidth;AE=AT?AT-AS:parseInt(AV.style.width);}if(AE<0){AV.innerHTML="...";return ;}var AO=AV.innerHTML;var AB=mstrmojo.css.getComputedStyle(AV);var t=this.getComputedFontStyle(AB);AO=this.splitWordIfTooLong2(AO,AE,t,AF);var AH=AO.split(" ");var z=[];var AK=[];var AR=0;var q=0;var AM=AH.length;var AW=this.getLen2(" ",t,AF);AK.push(0);for(AR=0;AR<AM;AR++){var s=this.getLen2(AH[AR],t,AF);if(s>AE){var AG=AH[AR];var AQ=(AE/s)*AG.length;AH[AR]=AG.substr(0,parseInt(AQ));s=AE;}z.push(s);q+=s;AK.push(q);if(AR!==AM-1){q+=AW;}}var AJ=0,AP=0;var AI=AN;for(;AP<AK.length;){var AD=AK[AP]-AK[AJ];if(AJ>0&&AP!=AJ){AD-=AW;}var AC=AK[AP+1]-AK[AJ];if(AJ>0&&AP+1!=AJ){AC-=AW;}if(AD<=AE&&((AP+1==AK.length)||(AC>AE))){AI--;if(AI==0||AP===AM){break;}else{AJ=AP;AP++;}}else{AP++;}}if(AP>AM){AP=AM;}var AL=AK[AP]-AK[AJ];if(AJ>0&&AP!=AJ){AL-=AW;}var AX;if(AP>=AM&&AL<AE){AX=AH.join(" ");}else{AX=AH.slice(0,AP).join(" ");var x=this.getLen2("...",t,AF);if(AL+x<=AE){AX+="...";}else{if(AX.charAt(AX.length-1)===" "){AX=AX.substr(0,AX.length-1);}var AA=AX.lastIndexOf(" ");var w=AX.length-1-AA;if(w===3){AX=AX.substr(0,AX.length-3)+" ...";}else{AX=AX.substr(0,AX.length-3)+"...";}}}AV.innerHTML=AX;return AX.indexOf("...")>-1;},truncateDivContent:function(z,AD,t){AD.innerHTML=z;if(AD.offsetHeight>t){var AA=0,s=z.length-1;while(AA<=s){var AE=Math.round((AA+s)/2);var AG=z.substr(0,AE+1);var AF=z.substr(0,AE+2);AD.innerHTML=AG;var AC=AD.offsetHeight;AD.innerHTML=AF;var x=AD.offsetHeight;if(AC<=t&&x>t){break;}else{if(AC>t){s=AE-1;}else{if(x<=t){AA=AE+1;}}}}var w=z.substr(0,AE+1);if(w.length<z.length){if(w.charAt(w.length-1)===" "){w=w.substr(0,w.length-1);}var AB=w.lastIndexOf(" ");var q=w.length-1-AB;if(q>=2&&q<=8){w=w.substr(0,w.length-q-1)+"...";}else{w=w.substr(0,w.length-3)+"...";}}return w;}else{return z;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var B="mstrmojo-floating-toolbar-lightbox";var G="mstrmojo-floating-toolbar";var M="mstrmojo-floating-toolbar-cell";var I="mstrmojo-fixed-toolbar-lightbox";var A="mstrmojo-fixed-toolbar";var N="mstrmojo-fixed-toolbar-cell";var H=" hasToolBar";var E="mstrmojo-Button mstrmojo-InteractiveButton mstrmojo-oivmSprite ";var D="mstrmojo-Button-text";var L=27;mstrmojo._HasToolbar={_mixinName:"mstrmojo._HasToolbar",postBuildRendering:function C(){this._super();var O=this.getToolbarCfg();if(!O||this.defn.ttl){return ;}var S=this.containerNode;if(S){var Q=this._createToolbar(G,M);Q.className=B;S.className+=H;S.insertBefore(Q,S.firstChild);var P=this.domNode,R=mstrmojo.boxmodel.offset(P,this.parent&&this.parent.domNode);if(R.top<L){Q.style.top=(L-R.top)+"px";}}},_createToolbar:function F(V,Z){var S=this.getToolbarCfg(),Y=this,W=document,P=W.createElement("div"),U=W.createElement("table"),X=W.createElement("tr"),R=W.createElement("td");P.appendChild(U);U.className=V;R.className=Z;X.appendChild(R);U.appendChild(X);for(var T in S){var O=W.createElement("div");O.className=E+S[T].css[0];var Q=W.createElement("div");Q.className=D;Q.nodeValue="&nbsp;";Q.setAttribute("ix",T);Q.setAttribute("cix",0);O.appendChild(Q);R.appendChild(O);O.onclick=function(a){Y.onClick(a);};}return P;},renderToolbar:function K(Q){if(!this.getToolbarCfg()){return ;}var P=Q.firstChild,O=this._createToolbar(A,N);O.className=I;if(P){Q.insertBefore(O,P);}else{Q.appendChild(O);}},onClick:function J(U,P){var V=mstrmojo.dom,O=V.eventTarget(P,U),S=O.getAttribute("cix"),R=O.getAttribute("ix");var Q=this.toolbarCfg[R],T=Q.callback;if(T&&this[T]&&this[T]()){S=++S%Q.css.length;O.parentNode.className=E+Q.css[S];O.setAttribute("cix",S);}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var I=1,C=2;function E(P){var Q=this.defn,R=Q.vc,S=Q.hc;if(!P||P.length===0||(!R&&!S)){return{};}return{v:!!R,h:!!S};}function B(P){return parseInt(this.getFormats()[(P===I)?"height":"width"],10);}function H(Q){var P=this.getFormats()["max-"+((Q===I)?"height":"width")];return P&&parseInt(P,10);}function G(T,S){var Q=this.defn,R=T&&(T.dimNode||T.domNode),P=Q.ck&&Q.ck[T&&(T.k||T.content.k)];if(R&&P&&(P&S)){return R;}return null;}function F(Q,T,S,Y){var P=parseInt(S.style[(T===I)?"top":"left"],10);if(!!Y){return P+Y;}var R=(Q.fmts&&Q.fmts.fx)||{},U=(!J.isIE7&&(R.rt===1||R.rt===3))?((T===I)?C:I):T,W=(U===I)?"Height":"Width";Y=S["offset"+W]+(R.ds||0);var V=P+Y;if(J.isIE7&&W==="Width"&&Q instanceof mstrmojo.XtabBase){var X=Q.contentNode.offsetWidth;if(V<X){V+=X;}}return V;}function L(P,Q,R){if(P>Q){if(R){P=Math.min(P,R);}return P;}return Q;}function D(V,T,U){var P=this.getCanGrowShrinkNode(),R=(V===I)?"Height":"Width",Q=R.toLowerCase(),S=parseInt(P.style[Q],10);if(T&&T!==S&&!(T<S&&!!U)){S=T;P.style[Q]=S+"px";this.afterCanGrowShrink();}this["_fixed"+R]=S;}function A(Q,T,V){var W=H.call(this,T),X=B.call(this,T),U=Q.length,R;for(R=0;R<U;R++){var P=Q[R],S=G.call(this,P,T);if(!S){continue;}X=L(F.call(this,P,T,S),X,W);if(X===W){break;}}D.call(this,T,X,V);}function O(U,T,Q,S){var R=G.call(this,U,T);if(!R){return ;}var P=F.call(this,U,T,R,Q);D.call(this,T,L(P,B.call(this,T),H.call(this,T)),S);}mstrmojo._CanGrowOrShrink=mstrmojo.provide("mstrmojo._CanGrowOrShrink",{getCanGrowShrinkNode:function N(){return this.domNode;},performCanGrowCanShrink:function M(Q,R){var P=E.call(this,Q);if(P.v){A.call(this,Q,I,R);}if(P.h){A.call(this,Q,C,R);}},fixedSizeCanGrowShrink:function K(T,P,R,S){var Q=E.call(this,T&&[T]);P=parseInt(P,10);R=parseInt(R,10);if(Q.v&&!isNaN(P)){O.call(this,T,I,P,S);}if(Q.h&&!isNaN(R)){O.call(this,T,C,R,S);}},afterCanGrowShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",H="";var N=/\+/g;for(var I=0,F=M.length;I<F;I++){var E=M[I].split("=");L=E[0];H=E[1];if(H){H=decodeURIComponent(H.replace(N," "));}var G=document.createElement("INPUT");G.type="HIDDEN";G.name=L;G.value=H;K.appendChild(G);}return false;}mstrmojo.form={createDynamicForm:function A(E){var G=document.createElement("FORM"),H=E.indexOf("?")>0;G.name="dynamic_form";G.method="POST";var F=((H)?E.substring(0,E.indexOf("?")):E);G.action=F;if(H){B(G,E);}document.body.appendChild(G);return G;},send:function D(J,K,E,M,H,F){var O=((H&&H.hWin)||window).document,L=O.createElement("form"),I=mstrApp;L.method=E||"GET";if(M){L.target=M;}L.action=K||I.name;F=(F!==undefined)?F:!(L.action&&L.action.indexOf("aspx")>0);if(I.sessionId){L.action+=";jsessionid="+I.sessionId;}if(F){L.action+=";uxts"+mstrmojo.now();}L.appendChild(C(O,"xts",mstrmojo.now()));for(var P in I.persistTaskParams){J[P]=I.persistTaskParams[P];}if(I.servletState&&I.name){J[I.name]=I.servletState;}if(J){for(var G in J){if(J[G].constructor==Array){mstrmojo.array.forEach(J[G],function(Q){L.appendChild(C(O,G,Q));});}else{L.appendChild(C(O,G,J[G]));}}}O.body.appendChild(L);try{L.submit();}catch(N){if(M&&N.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}O.body.removeChild(L);}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._IsPanelStack=mstrmojo.provide("mstrmojo._IsPanelStack",{_mixinName:"mstrmojo._IsPanelStack",TTL_SRC_PANEL:0,init:function J(N){this._super(N);var M=this.defn;if(!M){M=this.defn=this.node&&this.node.defn;this.titleSrc=this.titleSrc||M.ttlSrc;}var L=this.selectedKey=this.defn.selKey=this.node.data.selKey;this.set("selectedIdx",E.find(this.node.data.panels,"k",L));M.attachEventListener("selKeyChange",this.id,function(O){this.set("selectedKey",O.value);});},addChildren:function K(O,L,N){var M=this.getFormats(),P=M&&M.overflow;if(P){E.forEach(O,function(Q){var R=Q.getFormats();if(R){R.overflow=P;}});}return this._super(O,L,N);},refresh:function F(){if(this.hasRendered){var L=this.defn.newSelKey||this.selectedKey;E.forEach(this.children,function(M){M._delayRefresh=(M.k!==L);if(!M._delayRefresh){M.refresh();}});}delete this.defn.newSelKey;},selectPanel:function B(L,M){if(L!==this.selectedKey){this.defn.set("selKeyChange",L);this.model.slice({type:3,tks:this.k,eid:L,sid:this.node.data.wid,ck:this.k,hasLoader:M});}},onselectedKeyChange:function G(M){var O,L,N;E.forEach(this.children,function(Q,P){var R=Q.k;if(M.value===R){L=Q;N=P;Q.set("selected",true);}else{if(M.valueWas===R){O=Q;Q.set("selected",false);}}if(L&&O){return false;}});if(this.titleSrc===this.TTL_SRC_PANEL&&this.title){this.set("title",L.title);this.defn.ttl=L.title;}this.prevSelectIdx=this.selectedIdx;this.set("selectedIdx",N);this.raiseEvent({name:"panelSelected",key:L.k});return{on:L,off:O};},setDirty:function D(L){if(L){this.setDirtyChildren(true);}this._super(L);},setDirtyChildren:function H(L){var M=this.selectedKey;E.forEach(this.children,function(O){var N=O.k;O[((L||N!==M)?"add":"remove")+"DirtyKey"](N);});},clearDirtyChild:function I(N){var M=this.children,L=M[E.find(M,"k",N)];if(L){L.removeDirtyKey(L.k);}},isPanelStack:true,checkRequiredObjects:function C(){var L=this.txWidgets||{},O,N,M=true;for(O in L){M&=!!L[O].checkRequiredObjects();}return M;},updateSelectedIdx:mstrmojo.emptyFn,switchToPanel:function A(L,M){if(M!==undefined){this.set("selectedIdx",M);}else{this.updateSelectedIdx(L);}this.children[this.selectedIdx]&&this.selectPanel(this.children[this.selectedIdx].k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo._HasBuilder={postBuildRendering:function B(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function C(){return this.model.getChildren(this.node,false);},buildChildren:function A(E){if(!this.builder||!this.model){return false;}if(this.children&&this.children.length){this.set("children",[]);}var D=this.model,F=this.builder.build(this.getChildren(),D,this.buildConfig);if(!E){this.addChildren(F);}this.builtChildren=true;return(E)?F:true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.array");mstrmojo.requiresDescs(4891);var D=mstrmojo.array,C="u;",A="-1";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function E(F,I,K){var H;for(var G in F){H=F[G];if(H.v){var J=H.v.split(";");if(J&&J.length>1){J[1]=I;if(K&&J.length>2){J.pop();}H.v=J.join(";");}}}return F;},buildElemsCountStr:function B(I,G){if(!I||!I.length||!G||!G.length){return"";}var H=I.length,F=G.length;if(D.find(G,"v",C)>-1){F-=1;}if(D.find(G,"v",A)>-1){F-=1;}if(D.find(I,"v",C)>-1||D.indexOf(I,C)>-1){H=F;}if(H>=F){return"("+F+")";}else{return mstrmojo.desc("4891").replace("##",H).replace("###",F);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var L=10,C=20,a=false,l=false,W=L,b=[],V=mstrmojo.array,J=false,P,g;var B=6,X=7,A=100,j=101,O=102,F=103;function D(q,w,s){var p=w[0],o=w[1],t;q.beginPath();q.moveTo(p,o);for(t=2;t<w.length-1;t=t+2){q.lineTo(w[t],w[t+1]);}q.lineTo(p,o);q.fillStyle=s;q.stroke();q.fill();}function h(q,w,s){var p=w[0],z=w[1],t=w[2]-p,o=w[3]-z;q.fillStyle=s;q.strokeRect(p,z,t,o);q.fillRect(p,z,t,o);}function Z(z,t,AA){var q=t[0],p=t[1],x=t[2],s=t[3],w=t[4],o=t[5];z.beginPath();z.arc(q,p,s,w,o,false);z.lineTo(q+x*Math.cos(o),p+x*Math.sin(o));z.arc(q,p,x,o,w,true);z.closePath();z.fillStyle=AA;z.stroke();z.fill();}function M(z,t,AA){var s=t[0],q=t[1],w=t[2],x=t[3],o=t[4],p=t[5];z.scale(1,p);z.beginPath();z.arc(s,q,w,x,o,false);z.lineTo(s,q);z.arc(s,q,0,o,x,true);z.closePath();z.fillStyle=AA;z.stroke();z.fill();z.scale(1,1/p);}function N(AA,w,AB){var s=w[0],q=w[1],x=w[2],z=w[3],o=w[4],t=w[5],p=w[6];AA.scale(1,p);AA.beginPath();AA.arc(s,q,x,z,o,false);AA.lineTo(s+x*Math.cos(o),q+x*Math.sin(o)-t);AA.arc(s,q-t,x,o,z,true);AA.closePath();AA.fillStyle=AB;AA.stroke();AA.fill();AA.scale(1,1/p);}function E(o,q,p){o.fillStyle=p;o.beginPath();o.arc(q[0],q[1],q[2],0,Math.PI*2,true);o.stroke();o.fill();}function T(p,o){return p.Point.X-o.Point.X;}function I(p,AH,AC){var AG=this.tooltipArr[AC],s=p.Text,x=p.SC,o=AG.style,AF=(this.model.zf||1),z=mstrMobileApp.getDeviceDPI()/160,AD=2*z,AE=mstrApp.getScreenDimensions().w-(P*2);if(mstrApp.isTablet()){AF=(AF*z)+"em";}else{if(mstrMobileApp.getDeviceDPI()>240){AF=(AF*1.5)+"em";}else{AF+="em";}}var w="font-size:"+AF+";";w+="padding:"+AD+"px;";w+="maxWidth:"+AE+"px;";if(x){w+="border-color:#"+x;}AG.innerHTML=s;o.cssText=w;o.display="block";var AB=0,t=0;var q=AG.offsetHeight,AA=AG.offsetWidth;AB=AH.y-q-6;t=AH.x-AA-6;b.push({x:p.Point.X,y:p.Point.Y,clr:x||"#000000",top:AB,left:t,width:AA,height:q});}function Q(q,p,o){var t=o.left,s=Math.max(o.top,g+C);width=o.width,style=p.style,newLeft=t+width+12;if(newLeft+width<=mstrApp.getScreenDimensions().w){t=newLeft;}else{if(t<0){t=P;}}style.left=t+"px";style.top=s+"px";q.showAreaMarker(o.x,o.y,o.clr);}function f(o,AK){var AF=b[AK],AH=o.tooltipArr,AE=AH[AK].style,q=AF.left,w=AF.top,AB=AF.width,x=AF.height,AC=mstrApp.getScreenDimensions().w,AD,AA;if(AK>0){var z=b[AK-1],t=z.top,p=z.left,AJ=p+z.width,s=p+AB,AI;q=p;if(s>AJ){q-=(s-AJ);}else{if(s<AJ){q+=(AJ-s);}}if(q<0){if((AB*2)+12>AC){a=false;J=true;q=P;for(AD=0;AD<AK;AD++){AI=AH[AD];z=b[AD];AA=q+AB-z.width;z.left=AA;AI.style.left=q+AB-z.width+"px";}}else{a=true;}}w=t-C-x;if(w<g){var AG=Math.abs(w)+g+C;for(AD=0;AD<AK;AD++){AI=AH[AD];z=b[AD];t=z.top+AG;z.top=t;AI.style.top=t+"px";}w+=AG;}}else{if(q<0){if((AB*2)+12>AC){J=true;q=P;}else{a=true;}}if(w<g){w=g+C;}}if(!a){AE.left=q+"px";AF.left=q;}AE.top=w+"px";AF.top=w;o.showAreaMarker(AF.x,AF.y,AF.clr);}function U(w,o,s,z){var q=w.tooltipArr[o].style,t=b[o],x=b[o-s].top,p=t.width;if(z+p>mstrApp.getScreenDimensions().w){l=true;q.display="none";return ;}q.left=z+"px";q.top=x+"px";w.showAreaMarker(t.x,t.y,t.clr);}function d(AF){var AG=b.length,p=AF.tooltipArr,t=Math.ceil(AG/2),x=0,AE=1,AC=Math.min(AG,L/2),o=mstrApp.getScreenDimensions().w,s,q,AB;for(x=0;x<t;x++){f(AF,x);}if(a||J){for(x;x<AC;x++){f(AF,x);}if(!J){var w=x-1,AD=0,AA=0,z,AH;s=b[w];q=s.left+s.width+12;for(w=x-1;w>=0;w--){AB=p[w];AH=b[w].width;if(q+AH>o){AA=P+AH;if(AA>AD){rightMostPositon=AA;z=b[w];}}AB.style.left=q+"px";}if(AD>0){for(w=0;w<x;w++){AB=p[w];AB.style.left=(P+z.width-b[w].width)+"px";}}}}else{s=b[AG-1];q=s.left+s.width+12;for(x;x<AG;x++){U(AF,x,AE,q);AE+=2;if(l){break;}}if(l&&x<=AC){for(x=t;x<AG;x++){f(AF,x);p[x].style.display="block";}}}}function S(){var o=this,p=b.length;if(p===0){return ;}g=mstrApp.rootView.getTitleHeight();if(p===1){Q(o,o.tooltipArr[0],b[0]);}else{d(o);}}function K(q,o,s,p){switch(q){case X:h(o,s,p);break;case A:E(o,s,p);break;case j:Z(o,s,p);break;case O:M(o,s,p);break;case F:N(o,s,p);break;default:D(o,s,p);}}mstrmojo.graph._MobileGraphAreaHelper=mstrmojo.provide("mstrmojo.graph._MobileGraphAreaHelper",{highlightArea:function k(t,q){var s=this,o=t.getContext("2d"),p="rgba(255, 255, 255, 0.5)";s.clearHighlightArea(t);o.strokeStyle="#FFFFFF";V.forEach(q,function(w){K(w.Shape,o,w.Coords,p);});},highlightAreaInInit:function G(AC,z){var AE=AC.getContext("2d"),o=this.graphData.Areas,t="rgba(255, 255, 255, 0.5)";AE.clearRect(0,0,AC.width,AC.height);AE.strokeStyle="#FFFFFF";var p=o.length,AF=286,x=259,AD=341;var AB=z.length/2,w,AA;for(AA=0;AA<p;AA++){var q=o[AA],s=parseInt(q.OID,10);if(s!==AF&&s!==x&&s!==AD){continue;}if(q.SID<0||q.GID<0){continue;}for(w=0;w<AB;w++){if(q.SID!==z[2*w]||q.GID!==z[2*w+1]){continue;}K(q.Shape,AE,q.Coords,t);}}},clearHighlightArea:function R(p){if(p){var o=p.getContext("2d");o.clearRect(0,0,p.width,p.height);p.width=p.width;}},showAreaMarker:function H(o,s,q){if(o>=0&&s>=0){var p=this.highlightNode.getContext("2d");p.save();p.fillStyle="#FFFFFF";p.strokeStyle=q||"#000000";p.lineWidth=2;p.beginPath();p.arc(o,s,5,0,Math.PI*2,true);p.stroke();p.fill();p.fillStyle=q||"#000000";p.beginPath();p.arc(o,s,2,0,Math.PI*2,true);p.stroke();p.fill();p.restore();}},displayTooltips:function e(o,w,t){o.sort(T);var s=this.tooltipArr,x;a=false;l=false;b=[];this.clearHighlightArea(this.highlightNode);if(!s){P=8*(mstrMobileApp.getDeviceDPI()/160);s=[];for(x=0;x<L;x++){var AA=document.createElement("div");AA.id="mstrmojo-mobileGraph-tooltip";AA.className=mstrmojo.GraphBase.tooltipCLS;document.body.appendChild(AA);s[x]=AA;}this.tooltipArr=s;}W=Math.min(o.length,L);var z=mstrmojo.touchManager;if(W===0&&this._touchListener){z.detachEventListener(this._touchListener);delete this._touchListener;}else{if(W>0&&!this._touchListener){this._touchListener=z.attachEventListener("touchesBegin",this.id,function(AC){var AD=mstrmojo.all[AC.srcId];if(!(AD instanceof mstrmojo.android.ui.ActionToolbarButtons||AD instanceof mstrmojo.android.ui.Menu)){this.displayTooltips([],0,0);}});}}var q=null,AB={},p;J=false;for(x=0;x<L;x++){p=s[x].style;p.left=-9999;p.display="none";}for(x=0;x<W;x++){q=o[x];AB.x=q.Point.X+w;AB.y=q.Point.Y+t;I.call(this,q,AB,x);}S.call(this);window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},destroy:function Y(o){V.forEach(this.tooltipArr,function(p){document.body.removeChild(p);});delete this.tooltipArr;if(this._super){this._super(o);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.shouldEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){if(this.shouldEllipsize){A(this);mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered&&this.shouldEllipsize){this.doEllipsize();}}},this.markupMethods);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.android.EnumMenuOptions");var C=mstrmojo.android.EnumMenuOptions,D=C.TRANSACTIONS_QUEUE;function B(){return mstrApp.getTransactionNotificationController();}function A(){return(!this.hsc&&(this.st===14081));}mstrmojo.android.controllers._SupportsQueuedTransactions=mstrmojo.provide("mstrmojo.android.controllers._SupportsQueuedTransactions",{_mixinName:"mstrmojo.android.controllers._SupportsQueuedTransactions",getTxnToolbarButton:function F(G){var H=B();if(H&&H.hasTransactionQueue((A.call(this))?this.did:null)){G.addToolbarBtn(D,mstrmojo.desc(9262,"Transactions Queue"),D,true,18);}return G;},handleMenuItem:function E(I,G){if(I===D){var H,J;if(A.call(this)){H=this.did;J=this.ttl;}B().showNotificationBoard(this,H,J);}else{this._super(I,G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}else{F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);}this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?1:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}else{var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(J.bc==-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};}var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices",sessionState:mstrApp.sessionState};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom,B=A.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function C(E,I,D){var G=E&&E.tree||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function A(E,H,D){var C=D.hWin,G=D.e,F=mstrmojo.dom.eventTarget(C,G),B=E.listMapper.findIndex(E,H,F);if(B>-1){E.toggleSelect(B);}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.android.selectors._SupportsHoriz=mstrmojo.provide("mstrmojo.android.selectors._SupportsHoriz",{_mixinName:"mstrmojo.android.selectors._SupportsHoriz",scrollerConfig:{bounces:false,showScrollbars:false},minItemHeight:25,getItemProps:function A(H,D){var G=this._super(H,D),F=this.height,I=this.items.length,E;G.tag="label";G.n=G.n||"&nbsp";if(this.isHoriz){if(F){E=F;}if(this.itemWidthMode===0){G.style+="width:"+Math.floor(100/I)+"%;";}}else{if(F){E=Math.round(parseInt(F,10)/I);E=Math.max(E,this.minItemHeight);E+="px";}}if(E){G.style+="line-height:"+E+";";}return G;},init:function C(E){this._super(E);if(this.isHoriz){this.cssDisplay="table";var D=["horiz"];if(this.itemWidthMode===0){D.push("fixedWidth");}mstrmojo.css.addWidgetCssClass(this,D);}},updateScrollerConfig:function B(){var G=this._super(),K=this.itemsContainerNode,F="Height",D="y",J="v",E={};if(this.isHoriz){F="Width";D="x";J="h";}G.scrollEl=K;var L=this[F.toLowerCase()];if(L){L=parseInt(L,10);var I=Math.max(K["offset"+F]-L,0),H=G[J+"Scroll"]=(I!==0);if(H){E[D]={start:0,end:I};}}G.offset=E;G.origin=G.origin||{x:0,y:0};return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,B=mstrmojo.css,D="selected";function G(I,J,K,H,M){var L=M.listHooks[I];if(L&&L.call(M,J,K,H)){return ;}B[((I==="select")?"add":"remove")+"Class"](J,D);}function E(K,J,I){var L=this[K],H=(L)?L.split(J):[];H=H.concat(I.split(J));this[K]=H.join(J);return H.length-1;}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},getItemMarkup:function(I,H){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}">{@n}</{@tag}>';},getItemProps:function C(J,H){var I=!!this.selectedIndices[H];return{tag:"div",sel:I,cls:(I)?D:"",n:J.n||"",style:"",idx:H,addCls:function(K){E.call(this,"cls"," ",K);},addStyle:function(K){E.call(this,"style",";",K);}};},itemRenderer:{render:function(I,H,J){I._renderIdx=H;return mstrmojo.string.apply(J.getItemMarkup(I,H),J.getItemProps(I,H));},select:function(I,J,H,K){G("select",I,J,H,K);},unselect:function(I,J,H,K){G("unselect",I,J,H,K);}},onclick:function A(J){try{var M=J.target||F.eventTarget(J.hWin,J.e),L=F.findAncestorByAttr(M,"idx",true,this.domNode),I=L&&parseInt(L.value,10);if(I!==null&&!isNaN(I)){if(!this.multiSelect){this.singleSelect(I);}else{var H=(this.selectedIndices[I])?"remove":"add";this[H+"Select"](I);}}}catch(K){mstrApp.onerror(K);}}});mstrmojo._IsList.SELECTED_CLS=D;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array");var H=1,B=2;function J(M,L){return D(M,L)&&M.o===L.o;}function D(M,L){return M&&L&&M.ui===L.ui&&M.axis===L.axis&&M.mix===L.mix;}function A(P,M,N){var O=N.getCellTitleId(M),L=N.getCellUnitIndex(M);N.selections[O]=N.selections[O]||{};N.selections[O][L]=N.selections[O][L]||[];N.selections[O][L].push(P);C(P);}function K(M){var Q=M.selections;for(var P in Q){for(var O in Q[P]){for(var N=0,L=Q[P][O].length;N<L;N++){G(Q[P][O][N]);}}}M.selections={};}function C(L){mstrmojo.css.setOpacity(L,50);}function G(L){mstrmojo.css.setOpacity(L,100);}function F(N,O){if(N.mix===undefined){var R=O.gridData.gts[N.axis===H?"row":"col"],M=R[N.tui||N.ui],Q=0;for(var P=0,L=R.length;P<L;P++){if(R[P].id===M.id){Q++;}}return Q;}return 0;}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelect:function E(M,U){var S=this.getCellForNode(M),b=M.parentNode;if(U){var R=this.getCellTitleId(S),X=this.getCellUnitIndex(S);selectedTitle=this.selections[R];selectedUnit=selectedTitle&&selectedTitle[X];if(selectedUnit){for(var T=0,V=selectedUnit.length;T<V;T++){G(selectedUnit[T]);}delete selectedTitle[X];return ;}}var Q=F(S,this);if(S.axis===H){for(var T=0,L=0,V=b.cells.length;T<V&&L<Q;T++){var O=b.cells[T],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;}}}else{if(S.axis===B){var Z=mstrmojo.dom.findAncestorByName(M,"table",false),a=Z.rows;for(var T=0,L=0,V=a.length;T<V&&L<Q;T++){var Y=a[T].cells;for(var P=0,N=Y.length;P<N;P++){var O=Y[P],W=this.getCellForNode(O);if(J(W,S)){A(O,W,this);L++;break;}}}}else{A(M,S,this);}}},rangeSelect:function I(e,f){var a=this.getCellForNode(e),L=this.getCellForNode(f);if(D(a,L)){if(a.o>L.o||a._ei>L._ei){var k=e;e=f;a=this.getCellForNode(e);f=k;L=this.getCellForNode(f);}var W=F(a,this),M=a.axis,g=mstrmojo.dom.findAncestorByName(e,"table",false),T=g.rows,b=e.parentNode,l=b.rowIndex,V=b.cells,Y=f.parentNode.rowIndex;if(M===H){for(var Z=l;Z<=Y;Z++){var N=T[Z].cells,O=false;for(var X=0,d=N.length,P=0;X<d&&P<W;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);P++;}}}}else{if(M===B){for(var Z=0,d=T.length,h=0;Z<d&&h<W;Z++){var N=T[Z].cells,S=false;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(J(U,a)){S=true;}if(S){A(R,U,this);}if(J(U,L)){break;}}if(S){h++;}}}else{if(l==Y){for(var Z=e.cellIndex,d=f.cellIndex;Z<=d;Z++){var R=V[Z],U=this.getCellForNode(R);A(R,U,this);}}else{for(var Z=l,d=Y;Z<=d;Z++){var N=T[Z].cells;for(var X=0,Q=N.length;X<Q;X++){var R=N[X],U=this.getCellForNode(R);if(D(U,a)){A(R,U,this);break;}}}}}}}},doSelection:function(S,R,P){var T=mstrmojo.dom,L=T.ctrlKey(R,S),M=T.shiftKey(R,S);if(!L){K(this);}var Q=this.getCellForNode(P);var N=Q&&(Q.mix===undefined&&Q.o!==undefined),O=Q&&(Q.mix!==undefined&&(Q._lp||Q._tp));if(N||O){if(M){this.rangeSelect(this.lastSelectedTD,P);}else{this.singleSelect(P,L);this.lastSelectedTD=P;}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"]};J.RW=["z-index"].concat(J.T.concat(J.D));var E=mstrmojo.dom;function D(N,P,M){var O=N[P]||[];O.push(M);N[P]=O;}mstrmojo._Formattable={_mixinName:"mstrmojo._Formattable",formatHandlers:null,getCacheKey:function B(M){return"csscache"+(M.thresholdId||"");},update:function C(M){this.invisible=!!(M&&M.data&&M.data.invisible);if(this._super){this._super(M);}},preBuildRendering:function K(){if(this._super){this._super();}var M=this.defn;if(!M){M=this.defn={};}var Q=this.getCacheKey(this),Z=M[Q];if(!Z){Z=M[Q]={};var Y=this.getFormats();if(Y){var U=this.formatHandlers;for(var P in U){var g=U[P];var S=g.src?Y[g.src]:Y;if(!S){return ;}var X=[];var W=-1;var R=P+"CssText";var O=g.props||g;if(!O){continue;}for(var h=O.length-1;h>=0;h--){var a=O[h];var e=J[a]||[a];for(var V=e.length-1;V>=0;V--){a=e[V];if(a in S){if(a==="fx"){var d=S[a],N={};if("gd" in d){this.formatGradient(d.gd,N);}if("rt" in d){if(d.rt==1||d.rt==3){this.formatTextRotation(d.rt,N);}}if("ds" in d){this.formatDropShadow(d,N);}for(var T in N){X[++W]=T+":"+N[T].join(" ");}}else{X[++W]=a+":"+S[a];}}}}if(this.invisible){X.push("visibility:hidden");}this[R]=Z[R]=X.join(";")+";";}}}else{for(var b in Z){this[b]=Z[b];}}return true;},formatGradient:function G(M,O){var N=mstrmojo.css.buildGradient(M.t,M.sc,M.ec);if(N){D(O,N.n,N.v);}},formatDropShadow:function L(P,N){if(E.supports(E.cssFeatures.DROP_SHADOW)){var O=P.ds;if(E.isDXIE){D(N,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+O+",OffY="+O+")");}else{var M=[O,O];if(P.rt==1||P.rt==3){M[((P.rt===1)?1:0)]=-O;}D(N,(E.isWK?"-webkit-":"")+"box-shadow",M.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function A(N,M){if(E.supports(E.cssFeatures.TEXT_ROTATION)){if(E.isDXIE){D(M,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+N+")");}else{var O=(N===1)?90:-90;D(M,E.CSS3_PREFIX+"transform-origin","top left");D(M,E.CSS3_PREFIX+"transform","rotate("+O+"deg)");}}},getFormats:function I(){if(!this.fmts){this.fmts=this.formatResolver.getFormat(this.defn,this.thresholdId);}return this.fmts;},clearCache:function F(){delete this.defn[this.getCacheKey(this)];},unrender:function H(M){if(this.thresholdId){this.fmts=null;}this._super(M);}};mstrmojo._Formattable.getBorderWidths=function(N){var P=N.getFormats(),M=("border" in P)?P.border.match(/(\d*|\d*\.\d*)pt/)[0]:P["border-width"],O=N.model.docModel?N.model.docModel.dpi:N.model.dpi;return mstrmojo.css.getBorderWidths(M,O);};})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.DICFactory");var L=3,R=2,T=2,P=mstrmojo.css,A="********",O=mstrmojo.hash;var H=null;function F(X,W){if(X){var U=this.dicWidget;if(U&&U.setDirtyFlag){U.setDirtyFlag(X,W);}else{if(X.className!=="flag-container"){var V=document.createElement("div");V.className="flag-container";V.style.right="10px";V.innerHTML='<div class="dirty-cell"/>';W.insertBefore(V,X);}}}}mstrmojo._IsEditableTextfield={_mixinName:"mstrmojo._IsEditableTextfield",preBuildRendering:function Q(){if(!this.edb){var W=this.node.data,U=this.node.defn,V=W.dic||U.txi.dic,X=(this.rv==="")?this.value:this.rv;if(V.psw){this.v=A;X=this.rv="";}if(V.ipt===T){V.vls=this.vls||[];this.dk=V.k;}this.req=V.req;this.dt=V.dt;this.dicWidget=mstrmojo.DICFactory.createDIC({dic:V,owner:this,k:0,dv:this.value,value:X,openerType:R,popupTitle:U.n});if(this.shouldReplaceValueNode()){if(!H){H=O.clone(this.formatHandlers);}this.formatHandlers.domNode=["T","z-index","D","B","F","P","text-align","background-color","fx","white-space","overflow"];delete this.formatHandlers.valueNode;}}this.set("cssClass",this.edb?"":"editable-field");this._super();},shouldReplaceValueNode:function N(){return this.dicWidget.showByDefault||this.dicWidget.hasPreview;},postBuildRendering:function J(){this._super();if(this.edb){return ;}var U=this.dicWidget,W=this.valueNode.innerHTML;if(mstrmojo.string.isEmpty(W)){this.valueNode.innerHTML=W+"1";this.valueNode.style.height=this.valueNode.clientHeight+"px";this.valueNode.innerHTML=W;}if(U.showByDefault){U.render();}else{if(U.hasPreview){U.openerNode=this.domNode;U.renderPreview(this.value);}else{U.openerNode=this.valueNode;}mstrmojo.dom.attachEvent(U.openerNode,mstrApp.isMobile?mstrmojo.dom.TOUCHEND:"click",function(){U.showInPopup();});}if(this.shouldReplaceValueNode()){O.copy(H,this.formatHandlers);}this.registerTxWidget();this.addToTraversalList();if(this.mdf&&this.sci){var V=this.domNode;F.call(this,V.firstChild,V);}},getKeyContext:function D(){return{dt:this.dt||0,k:this.dk||undefined};},getUpdates:function C(){var V=this.getUpdatedValues()[0],U=V.k?('rw_control_key="'+V.k+'" element_id="'+this.vls[mstrmojo.array.find(this.vls,"v",V.v)].eid+'" '):"";return'<rwf rw_tree_type="'+this.tt+'" rw_node_key="'+this.fgk+'" rw_field_key="'+this.k+'" key="'+this.key+'" columns="'+this.cls+'" types="'+L+'" '+U+'value="'+mstrmojo.string.encodeXMLAttribute(String(V.v))+'" dt="'+V.dt+'" />';},updateValue:function K(U,X){if(this._super){this._super(U,X);}var Z=this.valueNode,a=this.domNode,V=this.dicWidget,W=X.v,Y=X.dv;if(this.rv!==W){if(this.req){P.removeClass(a,"required");}this.rv=W;this.v=Y;this.mdf=1;if(!V.showByDefault){if(V.hasPreview){V.renderPreview();}else{Z[Z.innerText!==undefined?"innerText":"textContent"]=this.psw?A:Y;}}if(this.req){P.removeClass(a,"required");}if(this.sci){F.call(this,a.firstChild,a);}}return false;},applyPasswordMask:function M(){this.psw=true;this.v=A;this.rv="";},getUpdateObject:function G(){var V={fieldKey:this.k,wid:this.wid,newValue:mstrmojo.string.encodeXMLAttribute(String(this.rv)),dataType:this.dt},U=this.getUpdatedValues()[0];if(U.k!==undefined){V.controlKey=U.k;V.elementId=this.vls[mstrmojo.array.find(this.vls,"v",U.v)].eid;}return{nodeKey:this.fgk,cells:[V],retrieveData:false,autoRefresh:false};},update:function I(U){if(this._super){this._super(U);}var W=U.data,V=U.defn;if(W.vls){this.vls=W.vls;}else{delete this.vls;}this.cell=U.data;this.value=W.v||"";this.rv=(W.rv===undefined)?this.value:W.rv;this.tca=W.tca||0;this.dt=W.dt;this.key=W.key||"";this.cls=W.cls||"";this.wid=W.wid;this.edb=W.edb;this.mdf=W.mdf;this.req=W.req;this.sci=V.txi.sci;this.tt=V.tt;this.fgk=V.fgk;},addToTraversalList:function S(){if(mstrmojo.DICConfig.isKeyNavigable(this.dicWidget.dic)){var U=this.parent.traversalList,V=this.domNode;if(!U){U=this.parent.traversalList=[];}U.push({x:V.offsetLeft,y:V.offsetTop,h:V.offsetHeight,refField:this});}},editNext:function E(){var Z=this.parent.traversalList,X,U,W,Y=0;if(!Z){return false;}if(!Z.isSorted){for(X=0,U=Z.length;X<U;X++){Y+=Z[X].h;}W=Y/U;Z.sort(function(f,d){var g=Math.floor(f.y/W),e=Math.floor(d.y/W);if(g<e){return -1;}if(g>e){return 1;}if(f.x<d.x){return -1;}if(f.x>d.x){return 1;}return(f.y<d.y)?-1:1;});Z.isSorted=true;}for(X=0,U=Z.length;X<U;X++){if(Z[X].refField.k===this.k){break;}}if(X<U){do{X++;if(X>=U){X%=U;}if(X===parseInt(this.k,10)){return false;}var V=Z[X].refField.dicWidget;if(V){if(!V.showByDefault){V.showInPopup();}else{V.focus();}return true;}}while(true);}},checkRequiredObjects:function B(){if(this.req&&!this.mdf&&!this.edb){P.addClass(this.domNode,"required");return false;}return true;}};}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");mstrmojo._HasDocLink=mstrmojo.provide("mstrmojo._HasDocLink",{_mixinName:"mstrmojo._HasDocLink",url:"",target:"",linkEnabled:true,ifw:"",update:function C(D){var E=D.defn;this.url=D.data.url||E.url;if(E.target){this.target=E.target;}if(E.ifw){this.ifw=E.ifw;}this._super(D);},postBuildRendering:function A(){if(this.url||this.ifw){mstrmojo.css.addClass(this.domNode,"hasLink");}var E=this.controller.view,D=E&&E.getCurrentLayout();if(D&&D.addLinkInfo){D.addLinkInfo(this.id,{url:this.url,target:this.target,src:this});}return this._super();},setLinkEnabled:function B(H){this.linkEnabled=H;var G=this.domNode;if(!G){return ;}var I=G.childNodes,F=I[I.length-1],D=this.id+"_mask",E=(F.id===D)?F:null;if(H){if(E){G.removeChild(E);delete this._mask;}}else{if(!E){E=document.createElement("div");E.className="mstrmojo-DocLinkMask";E.id=D;E.innerHTML="&nbsp;";G.appendChild(E);}}},onclick:function(){if(this.linkEnabled){var E=this.drillLinkItems,D=E&&E[0];url=this.url||(D&&D.url);if(this.ifw){this.model.showInfoWin(this.ifw,(this.getAnchor&&this.getAnchor())||this.domNode,"v",true);}else{if(url){this.model.executeLink(url,this.target,this);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");var B="tx-touch",E=100,D='<div class="mstrmojo-dicPreview dicx{@t} {@x}" ontouchstart="mstrmojo.all[\'{@id}\'].previewTouchStart()";><div><div>{@v}</div></div></div>';mstrmojo.android._HasPreviewButton=mstrmojo.provide("mstrmojo.android._HasPreviewButton",{_mixinName:"mstrmojo.android._HasPreviewButton",renderPreview:function F(){var I=this.openerNode,J=this.group||this,H=(J.openerType===2)||!!this.dic.dm||this.dicChanged;this.renderPreviewButton(I,H?this.dv:I.innerHTML);},renderPreviewButton:function A(K,N){var Q=this.dic,O=Q.t,P=this.group||this,M=false,J=true,I=mstrmojo.DICConfig.TYPES,R=[];switch(O){case I.SLIDER:case I.TEXTAREA:J=!Q.dm;break;case I.SWITCH:case I.TOGGLE:case I.RATING:case I.STEPPER:case I.LIKERTSCALE:J=false;break;}if(P.openerType===2){M=J;}if(J){var L=K.style;L.border="";L.padding="";R.push("arw");if(M){R.push("prv");}}var H=this.id;K.innerHTML=mstrmojo.string.apply(D,{t:O,v:N||"&nbsp;",id:H,x:R.join(" ")});this._previewNode=K.firstChild;if(this.inlineExtraCssText){this._previewNode.style.cssText+=" "+this.inlineExtraCssText;}},setDirtyFlag:function C(K,J){var H=this._previewNode,I=H&&H.firstChild;mstrmojo.css.addClass(I||J,"tx-active");},previewTouchStart:function G(){var H=this;mstrmojo.css.addClass(H._previewNode,B);if(this._holderTimer){clearTimeout(this._holderTimer);}this._holdTimer=setTimeout(function(){delete H._holdTimer;mstrmojo.css.removeClass(H._previewNode,B);},E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom");var E=mstrmojo.dom,H=E.position,G=Math;function A(T,O,M){var N=this._ellTestNodes||{},J=N[T],L=mstrmojo.css.getComputedStyle(O),I=["width","height"];if(M){I.reverse();}var R=I[0],P=I[1];if(!J||!E.contains(this.domNode,J.n,true,document.body)){var K=O.cloneNode(true);K.removeAttribute("id");K.removeAttribute("onclick");var S=K.style;S.position="absolute";S.top="-10000px";S.maxHeight=S.maxWidth="none";S[R]="auto";O.parentNode.appendChild(K);var Q=parseInt(L["max-"+R],10);if(isNaN(Q)){Q=parseInt(L[R],10);}J=N[T]={n:K,m:Q,d:R.substr(0,1)};this._ellTestNodes=N;}else{J.n.innerHTML=O.innerHTML;}J.n.style[P]=L[P];return J;}function D(J,K){var L=this.ellipsisText;switch(this.ellipsisPosition){case"middle":var I=G.floor(K/2);return J.slice(0,I).join("")+L+J.slice(-I).join("");case"end":return J.slice(0,K).join("")+L;default:return J.join("");}}var B=4;mstrmojo._SupportsEllipsisText=mstrmojo.provide("mstrmojo._SupportsEllipsisText",{_mixinName:"mstrmojo._SupportsEllipsisText",ellipsisText:"&hellip;",ellipsisPosition:"end",ellipsize:function F(T,O,N){var U=O.innerHTML;if(!U){return false;}var J=A.call(this,T,O,N),L=function(){var V=H(J.n)[J.d];return(V<=J.m);};if(L()){return false;}var K=J.n,I=U.split(""),Q=0,M=I.length,P,R;while(Q<M){var S=G.floor((Q+M)/2);U=K.innerHTML=D.call(this,I,S);if(L()){Q=S+1;}else{M=S-1;}if(M-Q<B){for(R=Q-1;R<M+1;R++){U=K.innerHTML=D.call(this,I,R);if(!L()){break;}P=U;}}if(P){O.innerHTML=P;break;}}return true;},unrender:function C(I){delete this._ellTestNodes;this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,J="mstrmojo-itemwrap",I="&nbsp;",S=mstrmojo.array;function F(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}else{if(X===V){break;}}Y=X;X=Y.parentNode;}}return null;}function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=S.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;}function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function L(l,Z,k,s,W,d,t,q){if(!Z){return{start:0,end:0};}var f=this.wrapperNodes(l),j=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,g=k+s,e=f[0].offsetTop,b;for(var o=1;o<=Y;o++){b=f[j].offsetTop-e+q;if(b<k){X=j;}else{if(b>g){V=j;}}var a=Math.round(Z/Math.pow(2,o+1));j+=(b>k)?-a:a;j=Math.min(Math.max(0,j),Z-1);}return{start:X,end:V};},findWrapper:function K(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function E(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function R(d,V,X,b,W){var Y=this._nd2iw(d,V,X),e,a,f;if(Y){a=this._iw2idx(d,V,Y);e=a;f=this.itemOffsetTop(d,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+f+Z/2){e++;f+=Z;}}else{return d.dropCuePos;}return{left:0,top:f,idx:e,idxActual:a};},getWrapperCss:function(V){return J;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function O(f,b,l,e,a,o){var p=this.itemWrapperPrefix(l),h=this.itemWrapperSuffix,Z=p+this.itemWrapperPrefill+h,Y=[this.markupPrefix],W=1,V=l.selectedIndices||{},s=function q(k,j){for(var t=k;t<j;t++){Y[W++]=p;var w=b.build(l,e,f[t],t);if(V[t]){w=w.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=w;Y[W++]=h;}};var d=(f&&f.length)||0;a=a&&b?Math.min(a,d):0;if(a){s(0,a);}o=o&&b?Math.min(o,d-a):0;var g=d-o;for(var X=a;X<g;X++){Y[W++]=Z;}if(o){s(g,d);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,h,e,q,g,W,b,o){var f=(h&&h.length)||0,l=this.wrapperNodes(X),s=g.itemStatus,V=mstrmojo.css,Z=q.selectedIndices||{};for(var d=W,j=Math.min(b+1,f),a=0;d<j;d++){if(s[d]!==A){l[d].innerHTML=e.build(q,g,h[d],d);if(Z[d]){var Y=l[d].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===o){break;}}}return a;},onadd:function N(e,V,Z,f){if(V&&f){var a=f.value.length,b=this.wrapperNodes(V),d=b[f.index],Y=this.getWrapperCss(e);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=I;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(e,this);}},onremove:function P(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function Q(h,X,d,l){if(X&&l){var e=this.wrapperNodes(X);if(e){var W=mstrmojo.css,o=d.itemStatus,k;for(var b=0,V=l.removed,g=V&&V.length;b<g;b++){k=V[b];if(o[k]){W.removeClass(e[k].firstChild,["selected"]);}}for(var Z=0,f=l.added,Y=f&&f.length;Z<Y;Z++){k=f[Z];if(o[k]){W.addClass(e[k].firstChild,["selected"]);}}}}},_nd2iw:F,_iw2idx:M,toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,e=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=e.clientHeight,d=e.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}e.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var E=mstrmojo.hash,H=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=E.clone(I);O.data=M;O.parent=N;return H.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length);for(var N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L;for(var O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}for(var M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9\_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')},VALIDATOR:{DEMO:function L(d){var b=parseInt(d,10),e=mstrmojo.validation.STATUSCODE;if(b===0||b===1||b>10){return{code:e.VALID};}return{code:e.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function H(b){var e=this.dtp,d=String(b).replace(/[^\d]/g,"");if(d.length<10){return{code:E.INVALID,msg:mstrmojo.desc(9203)};}if(!J.REGEXP.PHONE_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9204)};}return{code:E.VALID};},VALIDATE_ZIPCODE:function G(b){var e="",d=this.dtp;if(!J.REGEXP.US_ZIP.test(b)){if(J.isNumeric(d)||J.isInt(d)){e=mstrmojo.desc(9208);}else{if(J.isString(d)){e=mstrmojo.desc(9206);}}return{code:E.INVALID,msg:e};}return{code:E.VALID};},VALIDATE_EMAIL:function P(b){var d=b.indexOf("@");if(d===-1){return{code:E.INVALID,msg:mstrmojo.desc(9197)};}if(b.substring(d).indexOf(".")===-1){return{code:E.INVALID,msg:mstrmojo.desc(9198)};}return J.REGEXP.EMAIL_ADDRESS.test(b)?{code:E.VALID}:{code:E.INVALID,msg:mstrmojo.desc(9207)};},VALIDATE_SSN:function O(b){var e=this.dtp,d;if(J.isNumeric(e)||J.isInt(e)){d=String(b).replace(/[^\d]/g,"");if(d.length!=9){return{code:E.INVALID,msg:mstrmojo.desc(9209)};}}if(!J.REGEXP.SOCIAL_SECURITY_NUMBER.test(b)){return{code:E.INVALID,msg:mstrmojo.desc(9210)};}return{code:E.VALID};}},isInt:function(b){return B[b]==1;},isNumeric:function(b){return B[b]==2||B[b]==5;},isString:function(b){return B[b]==3;}};var V=window.mstrConfig,I=V.listSep,W=mstrmojo.expr,K=W.DTP,J=mstrmojo.validation,F=J.TRIGGER,E=J.STATUSCODE,X=mstrmojo.css,Q=mstrmojo.num,N=mstrmojo.string,a=mstrmojo.date,B={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,21:2,22:2,23:3,24:4,25:3,30:5};function D(k,l){var g=k.dtp,j=k.constraints,p=j.allowedFormatChars?j.allowedFormatChars:"",f=(B[g]==1),b=(B[g]==2),d=(B[g]==6),o=mstrmojo.locales.number.THOUSANDSEPARATOR,e=mstrmojo.locales.number.DECIMALSEPARATOR,h;if(f){if(!k._intRegExp){p+="0-9-"+(k.isList?I:"")+o;k._intRegExp=new RegExp("[^"+p+"]");}h=k._intRegExp;}if(b){if(!k._numericRegExp){p+="0-9-"+(k.isList?I:"")+e+o;k._numericRegExp=new RegExp("[^"+p+"]");}h=k._numericRegExp;}if(d){}return !!h&&h.test(l);}function Y(k,o){var g=k.dtp,j=k.constraints,f=(B[g]==1),b=(B[g]==2),d=(B[g]==6),e=j.min,l=j.max,h;if(e==undefined&&l==undefined){return false;}if(f||b){return Q.inNumericRange(o,e,l)!==0;}if(d){return a.inDateTimeRange(o,e,l)!==0;}return false;}function Z(d,b){return !Q.isNumeric(b);}function A(f,d){var e=(f.dtp===K.DATE),b=(f.dtp===K.TIME);return(e?!a.isDate(d):(b?!a.isTime(d):!a.isDateAndOrTime(d)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:K.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function S(b){this._super(b);if(!this.constraints){this.constraints={};}var d=this.constraints;if(!("trigger" in d)){d.trigger=F.NONE;}},_set_value:function(h,e){var f=this.value,d=(f!==e);if(d){this.value=e;var g=this.constraints.trigger,b=(g&F.VALUESET)>0;if(b){this.validate(e);}}return d;},validate:function M(){var e=(this.value!==null&&this.value!==undefined)?this.value:"",h=this.isList?e.split(I):[e],g,d,j;for(var f=0,b=h.length;f<b;f++){g=this.doValidation(h[f]);d=(g.code>E.VALID);if(d){if(b>1){g.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",h[f]?h[f]:" ");}break;}}j=d?"onInvalid":"onValid";if(!d&&this.autoFormat){this.format();}this.set("validationStatus",g);if(this[j]){this[j](g);}},format:function T(){var h=this.dtp,e=(B[h]==6);if(!e){return ;}var k=mstrConfig.listSep,p=this.value||"",d=this.isList?p.split(k):[p],o=h===14,l=[],b,f=mstrmojo.locales.datetime;for(var g=0,j=d.length;g<j;g++){p=d[g];b=a.parseDateAndOrTime(p);if(b){if(o&&b.date){l.push(a.formatDateInfo(b.date,f.DATEOUTPUTFORMAT));}else{l.push((b.date?a.formatDateInfo(b.date,f.DATEOUTPUTFORMAT):"")+" "+(b.time?a.formatTimeInfo(b.time,f.TIMEOUTPUTFORMAT):""));}}}this.set("value",l.join(k));},isValid:function R(){var b=this.validationStatus;if(!b){this.validate();}return this.validationStatus.code===E.VALID;},clearValidation:function U(){this.set("validationStatus",{code:E.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function C(q){var l=this.constraints,o=l.regExp,e=l.validator,b={id:this.id,code:E.VALID,msg:""},k=this.dtp,j=(B[k]==1),d=(B[k]==2||B[k]==5),f=(B[k]==3),g=(B[k]==6),h=N.isEmpty(q),p=String(q).length;err="",_VAL=mstrmojo.locales.validation;if(this.required&&h){b.code=E.INVALID_EMPTY;b.msg=_VAL.requiredFieldError;return b;}q=N.trim(q);if(!h&&D(this,q)){if(j){err=_VAL.integerDataType;}if(d){err=_VAL.numericDataType;}if(g){err=_VAL.dateDataType;}b.code=E.INVALID_CHAR;b.msg=_VAL.invalidCharError.replace("#",err);return b;}if(!h&&g&&A(this,q)){b.code=E.INVALID_BAD_DATESTRING;b.msg=_VAL.invalidDateStringError;return b;}if(!h&&(d||j)&&Z(this,q)){b.code=E.INVALID_BAD_NUMERICFORMAT;b.msg=_VAL.invalidNumericFormatError;return b;}if(!h&&(j||d||g)&&Y(this,q)){b.code=E.INVALID_OUTOFRANGE;if(l.min!=null&&l.max!=null){err=_VAL.outofRangeError.replace("#","").replace("##",l.min).replace("###",l.max);}else{if(l.min!=null){err=_VAL.noLessMinError.replace("##",l.min).replace("#","");}else{if(l.max!=null){err=_VAL.noGreaterMaxError.replace("###",l.max).replace("#","");}}}b.msg=err;return b;}if(f&&l.minLen!=null&&l.maxLen!=null){if(p<l.minLen||p>l.maxLen){b.code=E.INVALID;b.msg=mstrmojo.desc(9211).replace(/#/,l.minLen).replace(/##/,l.maxLen);return b;}}if(o&&!o.test(q)){b.code=E.INVALID_REGEX;b.msg=mstrmojo.desc(9205);return b;}var s=e&&e.apply(this,[q]);if(s){b.code=s.code;b.msg=s.msg;return b;}return b;}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.date","mstrmojo.string");var G=mstrmojo.hash,F=mstrmojo.string,A='<div class="clearingDiv"></div>',E="<div {@attr}>",D="</div>";function C(I){var J=[],H=-1;G.forEach(I,function(L,K){J[++H]=K+'="'+L+'"';});return J.join(" ");}mstrmojo.android.ui.CalendarMarkupBuilder={getHeaderHTML:mstrmojo.emptyFn,getContentHTML:mstrmojo.emptyFn,getSingleMonthHelper:function B(R,S,L){var P=[],Q=-1,T=L.mkp||(E+"{@d}"+D),K=new Date(S,R),J=-1,N=L.incl,I=L.showAddlWeek,H=0;K.setDate(1-K.getDay());J=K.getMonth()-R;while(!((J===1||J===-11)&&K.getDay()===0)||(I&&H<6)){var M=K.getDate(),O=(N||J===0)?{d:M,attr:C({d:M})}:{};if(O.attr&&L.cls){O.attr["class"]=L.cls;}P[++Q]=F.apply(T,O);K.setDate(M+1);J=K.getMonth()-R;if(K.getDay()===0){H++;}}P[++Q]=A;return P.join("");}};}());(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.VisChartUtils");var L=0;var N=mstrmojo.num;var F=[{n:1,s:""},{n:1000,s:"K"},{n:1000000,s:"M"},{n:1000000000,s:"B"},{n:1000000000000,s:"T"},{n:1000000000000000,s:"Q"}];var M=3;var K=5;function D(T,P,S){var R=function(V,U){return U?Math.floor(V):Math.ceil(V);};var Q=R(T/P,S)*P;if(Q.toString().indexOf(".")>=0&&P<1&&Q>1){Q=parseFloat(Q.toFixed(2));}if(Q>0&&Q<1&&P>1/1000){Q=parseInt(R(Q*100,S))/100;}return Q;}function H(U,V){if(!V){V=",";}var P=U.length;for(var S=0;S<P;S++){var T=U[S].rv,Q=T.length;for(var R=0;R<Q;R++){if(Number(T[R])){break;}T[R]=T[R].replace(V,".");}}}mstrmojo.VisChartData=mstrmojo.provide("mstrmojo.VisChartData",{process:function B(T){if((!T.baseModel&&T.model)||T.model.vp){this.setDerivedModel(T);var P=T.baseModel,V=P.colHeaders,g=V.length,Y=V[g-1].items[0].ds;if(Y&&Y!=="."){H(P.series,Y);}else{if(!Y){H(P.series);}}}var R=T.model;var Q=R.series,a=Q.length;if(a<=0){return ;}var W=!T.isLinearChart&&T.isDrawAxis&&T.drawYAxisLabels,Z="";L=0;var U=new Array();if(Q&&Q[0]&&Q[0].rv.length){for(var d=0;d<a;d++){var X=Q[d].rv,f=X.length,b=U.length;for(var e=0;e<f;e++){var h=X[e];if(!h||h.length==0){continue;}if(L===0){L=Q[d].v[e].indexOf("%")>=0?100:1;}U[b]=parseFloat(h);if(W&&U[b].toString().length>Z.length){Z=U[b].toString();}b++;}}U=U.sort(function S(k,j){return k-j;});}R.mvalues=U;if(W){R.mls=Z;R.ylbls=U;}},setDerivedModel:function I(Z){var R=Z.model,b=R.series,S=b.length,Y=R.ri,a=R.rowHeaders,X=R.colHeaders;var W=typeof (R.vp)!=="undefined"&&R.vp.rl&&R.vp.rl.length>0?R.vp.rl:null;Z.baseModel=R;var Q=b[0].rv.length,V=0;if(W&&Z.isTimeSeries){var T=parseInt(W[0].rs),P=W[0].sr;for(var U=0;U<a.length;U++){if(a[U].id==P){V=Q-(a[U].l*T)>=0?Q-(a[U].l*T):0;break;}}}Z.model={categories:R.categories,mtrcs:R.mtrcs,series:b,colHeaders:X,rowHeaders:a,rne:Q,rns:V,ri:Y};},processLinearData:function G(b){this.process(b);var T=b.model;var a=T.mvalues,d=b.getMaxValue(),U=b.getMinValue();var V=this.generateAxisLabels(b,d,U);T.mvalues=V;var e=b.isDrawAxis&&b.drawYAxisLabels;var Q=b.isTimeSeries?b.formatProp.condenseLabels:true;if(e){var X=this.condenseLabels(V,M);if(Q){var R=this.checkDuplicatedCondensed(X.condensedLabels);if(R){for(S=M+1;S<K;++S){X=this.condenseLabels(V,S);R=this.checkDuplicatedCondensed(X.condensedLabels);if(!R){break;}}if(R){Q=false;}}T.mls=X.maxLabel;T.ylbls=X.condensedLabels;}if(!Q){var Z=[];var P="";var W=T.colHeaders[T.colHeaders.length-1].items;var Y=W&&W[0]&&W[0].f||"";for(var S=0;S<V.length;S++){Z[S]=N.formatByMask(Y,V[S]);if(Z[S].toString().length>P.length){P=Z[S].toString();}}T.mls=P;T.ylbls=Z;}}},checkDuplicatedCondensed:function E(P){var Q=false;for(var R=1;R<P.length;R++){if(P[R]==P[R-1]){Q=true;break;}}return Q;},condenseLabels:function J(Q,P){var U=Q.length;var R="";var T=new Array();for(var S=0;S<U;S++){T[S]=this.formatNumber(Q[S],P);if(T[S].toString().length>R.length){R=T[S].toString();}}return{condensedLabels:T,maxLabel:R};},generateAxisLabels:function A(T,W,R,X){var S=new Array();if(W==R){if(R<0){S.push(R);}S.push(0);if(R>0){S.push(R);}return S;}var P=this.calInterval(W,R,X);if(T.isTimeSeries&&T.formatProp.useCustomAxisScale){var Q=W;var V=R;}else{var Q=D(W,P,false);var V=D(R,P,true);}if((R-V)>0.9*P){V=D(R,P,false);}if((Q-W)>0.9*P){Q=D(W,P,true);}S=new Array();if(P<((Q-V)/30)){S.push(V);S.push(Q);}else{var U=V;while(U<=Q){S.push(U);if(U==V){U=Math.ceil((V+P/100)/P)*P;}else{U=Math.ceil((U+P)*1000)/1000;}}if(S[S.length-1]<Q){S.push(Q);}}return S;},formatNumber:function C(T,Q){var U="",a=1,S=T*L;if(S<0){S=-T*L;a=-1;U="-";}if(S<=1+0.000001){a*=S;if(S.toString().length<=Q){U+=S;}else{var W=2;U+=S.toFixed(W);for(var V=U.length-1;V>=0;--V){if(U.charAt(V)=="."){break;}else{if(U.charAt(V)!="0"){++V;break;}}}if(V<U.length){U=U.substr(0,V);}}}else{var P=Math.log(S)/Math.LN10+0.000001;var R=parseInt(P/3);if(R>=F.length){R=F.length-1;}var d=S/F[R].n;var Y=d.toString();if(Y.length>Q){var X=Y.indexOf(".");var Z=X<0?0:Y.length-X+1,e=X<0?Y.length:X;var b=Q-e-1;Y=d.toFixed(b<0?0:b);}a*=parseFloat(Y)*F[R].n;U+=Y+F[R].s;}return U;},calInterval:function O(P,R,S){var Q,T=(P-R);if(T==0){if(P==0){P=1;R=-1;}else{P=P*2;R=R/2;}T=P-R;}Q=1;if(T<1){while(T<1){T*=10;Q/=10;}}else{if(T>=10){while(T>=10){T/=10;Q*=10;}}}if(T<1.8){Q*=0.2;}else{if(T<3.1){Q*=0.4;}else{if(T<4.6){Q*=0.5;}else{if(T>=8.1){Q*=2;}}}}if(S){Q=Math.round(Q);if(Q<1){Q=1;}}else{if((Q>0&&Q<1)&&(parseInt(Q.toFixed(2)*100)/100)>0){Q=parseInt(Q.toFixed(2)*100)/100;}}return Q;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.num","mstrmojo.array","mstrmojo.DICFactory");var F=1,J=0,L=1,N=2,G=".",I=mstrmojo.dom,K=mstrmojo.css,E=mstrmojo.hash,D=mstrmojo.Enum_Keys.TAB,H=function(Q){return(Q>=1&&Q<=7)||Q==21||Q==22||Q==30;},C=function(T,R){if(I.isIE&&!/px$/.test(R)){var Q=document.createElement("img"),S;Q.style.zIndex=-1;Q.style.left=R;T.appendChild(Q);S=Q.style.pixelLeft;T.removeChild(Q);return S+"px";}return R;},B=function(Q,R){return parseInt(C(Q,K.getStyleValue(Q,R)),10)||0;},M=function(Q){return{lp:B(Q,"paddingLeft"),rp:B(Q,"paddingRight"),tp:B(Q,"paddingTop"),bp:B(Q,"paddingBottom")};},P=function(R){var Q=R.currentStyle;if(!Q){Q=document.defaultView.getComputedStyle(R,null);}return{fontFamily:Q.fontFamily,fontSize:C(R,Q.fontSize),fontStyle:Q.fontStyle,fontVariant:Q.fontVariant,fontWeight:Q.fontWeight,textAlign:Q.textAlign};},O=function(S,Q){var R=mstrmojo.findAncestor(S,"scriptClass","mstrmojo.DocInfoWindow");if(!!R){R.autoCloseLocked=Q;}};mstrmojo._IsInputControl={_mixinName:"_IsInputControl",dic:null,owner:null,openerNode:null,popupStyle:J,items:null,applyOnEnter:true,lv:null,init:function(T){if(this._super){this._super(T);}var V=this.dic,U=V.dt,S=mstrmojo.expr.DTP,R,Q=[];if(mstrApp.useBinaryFormat){if(U==S.DATE||U==S.TIME||U==S.TIMESTAMP){R=mstrmojo.date.parseDateAndOrTime(this.value);if(R){if(U!=S.TIME){Q.push(mstrmojo.date.formatDateInfo(R.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}if(U!=S.DATE){Q.push(mstrmojo.date.formatTimeInfo(R.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}this.value=Q.join(" ");}}}this.lv=this.value;if(V.wm&&V.w===undefined){V.wm=0;}},showByDefault:false,hasPreview:false,getItems:function(){var X=this.dic,R=[],V,T,Q=0,U=String(X.itv),S=U&&U.indexOf(G),W=H(X.dt);if(S>=0){Q=U.substring(S+1).length;}if(parseInt(X.ipt,10)===0){for(V=0,T=X.min;T<X.max+0.00001;V++,T+=X.itv){R[V]={n:mstrmojo.num.toLocaleString(Q>0?T.toFixed(Q):T),v:T};}}else{R=X.vls;mstrmojo.array.forEach(R,function(Y){if(Y.n===undefined){Y.n=W?mstrmojo.num.toLocaleString(Y.v):Y.v;}});}return R;},font:null,onfontChange:function(){if(this.getInputNode){var Q=this.getInputNode(),R=this.font;E.forEach(R,function(T,S){Q.style[S]=T;});}},getOpenerNodeStyle:function(){var Q=this.group&&this.group.ons,R=this.openerNode;if(!Q){Q=M(R);Q.hp=Q.lp+Q.rp;Q.vp=Q.tp+Q.bp;Q.iw=Math.max(0,R.clientWidth-Q.hp);Q.ih=Math.max(0,R.clientHeight-Q.vp);if(this.group){this.group.ons=Q;}}return Q;},onvalueChange:function(){if(this._super){this._super();}this.dicChanged=true;if(this.showByDefault){this.applyChanges();}else{if(this.popupStyle!==J&&this.popup&&this.popup.enableApply){this.popup.enableApply();}}},preBuildRendering:function(){if(this._super){this._super();}this.openerNode=this.openerNode||this.owner.domNode;if(this.showByDefault){this.openerStyle=this.getOpenerNodeStyle();if(this.inlineExtraCssText){this.cssText+=" "+this.inlineExtraCssText;}}if(!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}},postBuildRendering:function(){var Q=this.openerNode;if(this._super){this._super();}if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault){Q.replaceChild(this.domNode,Q.lastChild);}else{this.set("font",P(Q));}}if(mstrmojo.DICConfig.isKeyNavigable(this.dic)){this.registerKeyEvents(this.domNode);}},applyChanges:function(){var W=this.lv,Q=this.getCurValue?this.getCurValue():this.value,V=this.openerNode,S=this.getDisplayValue?this.getDisplayValue():Q,U=this.dic.dt,R=mstrmojo.expr.DTP,T=mstrmojo.locales.datetime;if(String(Q)!==String(W)){if(mstrApp.useBinaryFormat){if(U==R.TIME||U==R.TIMESTAMP){Q=Q.replace(new RegExp(T.AM_NAME),"AM").replace(new RegExp(T.PM_NAME),"PM");}}this.lv=Q;this.dv=S;if(this.owner&&this.owner.dataChanged){this.owner.dataChanged(this.k,W,{dv:S,v:Q},V);}}return true;},cancelChanges:function A(){this.value=this.lv;},showInPopup:function(){this.popup=mstrmojo.DICFactory.createDICPopup(this.owner,this);if(this.focus){this.focus();}this.setInfoWindowLock(true);},lockPopup:function(){this.setInfoWindowLock(false);},renderPreview:null,onTabDown:function(Q){mstrmojo.dom.preventDefault(window,Q);if(this.applyChanges()!==false){if(this.popup){this.popup.close();}this.owner.editNext(this.k);this.cleanup();}},cleanup:mstrmojo.emptyFn,registerKeyEvents:function(R){var Q=this;I.attachEvent(R,"keydown",function(S){var T=S||window.event;if(T.keyCode===D){Q.onTabDown(S);}});if(I.isIE){I.attachEvent(R,"keyup",function(S){var T=S||window.event;if(T.keyCode===D){Q.focus();}});}},setInfoWindowLock:function(Q){O(this.owner,Q);}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo._IsList","mstrmojo.dom");var F=mstrmojo.android._IsList=mstrmojo.provide("mstrmojo.android._IsList",mstrmojo.hash.copy(mstrmojo._IsList,{_mixinName:"mstrmojo.android._IsList",getItemIdxTouch:function A(I){var H=mstrmojo.dom.findAncestorByAttr(I.target,"idx",true,this.domNode),G=H&&parseInt(H.value,10);return(G!==null&&!isNaN(G))?G:-1;},resetListState:function B(){this.clearSelect(true);var G=this.scrollerConfig;if(G){delete this.scrollerConfig.origin;}},restoreListState:function C(G,I){var J={};J[G]=true;this.selectedIndices=J;this.selectedIndex=G;var H=this.scrollerConfig;if(H){H.origin=I;}},touchSelectEnd:function E(G){this.touchTap(G);}}));var D=F.onclick;F.onclick=mstrmojo.emptyFn;F.touchTap=function(G){this._listTarget=G.target;D.call(this,G);};}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo._Fetchable","mstrmojo.hash");var E=mstrmojo.hash;function A(){var F=mstrApp.modelFactory;if(F){return F.newDataService("Element");}else{return mstrApp.viewFactory.newElementDataService();}}function D(F){var I,H,G;I=-1;G=0;while(G>=0){I++;G=F.indexOf(":",G);if(G>=0){G++;}}H=-1;G=0;while(G>=0){H++;G=F.indexOf("*:",G);if(G>=0){G++;}}if(I<H+1){alert("Unexpected format for element ID "+F);}return I-H;}mstrmojo.requiresCls("mstrmojo.XMLBuilder","mstrmojo.Obj");mstrmojo.mstr.WebElements=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.WebElements",source:null,items:null,duplicate:function(){return new mstrmojo.mstr.WebElements({source:E.copy(this.source),browseConfig:E.copy(this.browseConfig)});},browseConfig:null,init:function(F){var G=F&&F.browseConfig;if(G){this.blockBegin=G.blockBegin||1;this.blockCount=G.blockCount||15;}if(this._super){this._super(F);}},getBrowseConfig:function(G){var F=this.browseConfig;return{attributeID:this.source&&this.source.did||0,blockBegin:G||1,blockCount:this.blockCount||-1,filterXML:F.filter&&F.filter.getXML()||"",shortFilterXML:F.shortFilterXML||"",searchPattern:F.searchPattern||"",matchCase:!!F.matchCase,dataSourcesXML:F.dataSources||"",targetAttributeID:F.searchTarget&&F.searchTarget.did||"",searchForms:F.searchForms||""};},_retrieveItems:function(H,G){var F=this;A().getElements(this.getBrowseConfig(H),{success:function(I){if(G&&G.success){G.success({items:F.convertElems(I.items),totalSize:I.totalSize});}},failure:function(I){if(G&&G.failure){G.failure(I);}}});},convertElems:function C(G){var F=[],G=G||[];for(var H=0;H<G.length;H++){var I=G[H];F[H]={vi:H,v:I.dssid,n:I.n,t:I.emt};}return F;},buildShortXML:function B(F){F.addChild("mi");F.addChild("es");if(this.source!=null){this.source.buildShortObjectElt(F);}var I=[].concat(this.items);I.sort(function(N,M){var L=N.n,K=M.n,J;if(L===K){J=0;}else{if(L<K){J=-1;}else{J=1;}}return J;});for(var H=0;H<I.length;H++){var G=I[H];F.addChild("e");F.addAttribute("ei",G.v);F.addAttribute("emt",G.t);F.addAttribute("art",D(G.v));F.addAttribute("disp_n",G.n);F.closeElement();}F.closeElement();F.closeElement();}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");mstrmojo.touchManager=new mstrmojo.Obj({notify:function(x,z){return this.raiseEvent({name:"touchesBegin",srcId:x,touch:z});}});var V=mstrmojo.dom,s=V.attachEvent,t=V.detachEvent,B=Math,W=window.mstrConfig,Q=false,J=null,j=W&&W.allowDefaultTouches;var h=10,D=250,F=400,Y=100;var g="Begin",N="End",d="Move",S="Cancel";var o=1,p=2,C=3,P=4;var K={};K[o]="Select";K[p]="Swipe";K[C]="Multi";K[P]="Tap";s(document.body,V.TOUCHMOVE,function(x){if(!W||!W.allowDefaultTouches){if(x.preventDefault){x.preventDefault();return false;}}return true;});function X(x){var z=x.identifier;return(z===undefined)?1:z;}function k(AB,AC,AA,z){if(Q){var x=(z)?X(z)+" ":"";window.console.log(AB+":"+((AA)?" "+AA.scriptClass+" "+AA.id:"")+" "+x+(AC||""));}}function l(x){return(J===x);}function T(x){if(!l(x)){return ;}k("detachWinEvts","",x);t(window,V.TOUCHMOVE,x._tmCallback,true);t(window,V.TOUCHEND,x._teCallback,true);t(window,V.TOUCHCANCEL,x._teCallback,true);J=null;}function U(x){if(l(x)){return ;}var z=J;if(z){k("forced deactivation","",z);T(z);}k("attachWinEvts","",x);s(window,V.TOUCHMOVE,x._tmCallback,true);s(window,V.TOUCHEND,x._teCallback,true);s(window,V.TOUCHCANCEL,x._teCallback,true);J=x;}function M(z,x){return"touch"+((x&&K[x])||"")+(z||"");}function Z(AA,AB,z){var x=M(AB,z);return(AA[x]!==undefined)?x:"";}function q(AB,AD,AE,AA,z){z=z||AB.gestures[AE.id];var AC=(z&&z.bubbleTarget)||AB,x=Z(AC,AD,AA);if(x){k("fire",x,AC);AE.methodName=x;return AC[x](AE);}k("no handler",M(AD,AA),AC);return true;}function e(AG,AH,x,AC){var AD=x.pageX,AB=x.pageY,AE=AG.timeStamp,z=X(x),AL={x:B.round(AD-AH.pageX),y:B.round(AB-AH.pageY)};var AK={id:z,evt:AG,pageX:AD,pageY:AB,clientX:x.clientX,clientY:x.clientY,target:x.target,delta:AL,date:AE,stop:function(){k("event stopped",z);AG.stopPropagation();AG.cancelBubble=true;}};if(AC){var AA=AE-AC.date,AJ=AC.delta,AF={x:B.abs(AL.x-AJ.x),y:B.abs(AL.y-AJ.y)};AK.velocity={x:AF.x/AA,y:AF.y/AA};AK.isVertical=(AF.y>AF.x);AK.accelDelta=AF;var AI=AK.direction={};if(AD!==AC.pageX){AI.x=(AD<AC.pageX);}else{if(AD!==AH.pageX){AI.x=(AD<AH.pageX);}}if(AB!==AC.pageY){AI.y=(AB<AC.pageY);}else{if(AD!==AH.pageX){AI.y=(AB<AH.pageY);}}}return AK;}function I(AB,x,AA,z){return{s:AB,p1:x,p2:AA,evt:z,target:z.target};}function L(z,x){if(z){z.gestures[x]=null;}}function a(z,x){T(z);q(z,N,x);}function G(x){if(x._selectHandle){window.clearTimeout(x._selectHandle);delete x._selectHandle;k("cancelSelect","",x);}}function H(AE,AG){var AC=AG.which;if(AC&&AC===3){k("ignore","right mouse click",AE);return ;}var AF=AE.gestures,AD=AG.touches||[AG],x=(AG.changedTouches&&AG.changedTouches[0])||AG,AJ=l(AE),AK=e(AG,x,x),AI=I(AK,AK,AK,AG);k("touchBegin","",AE,x);if(AD.length>1){if(!AJ){AK.stop();k("ignore","cross widget multitouch",AE,x);var AB=J;if(AB&&AB.onCrossWidgetMultitouch!==undefined){k("call onCrossWidgetMultitouch for","",AB);AB.onCrossWidgetMultitouch();}return false;}}else{if(AJ){k("forced deactivation","",AE,x);T(AE);AJ=false;}}if(AE.singleNode&&x.target!==AE._tn){k("ignore","target is not touch node",AE,x);return ;}if(mstrmojo.touchManager.notify(AE.id,AK).ignore){AK.stop();return ;}if(!AJ){var AA=AK.target.tagName;AA=AA&&AA.toLowerCase();if(AA==="select"||AA==="input"){k("ignore","target is input or select",AE,x);if(AE.monitorInputs){q(AE,null,AK,P);}return ;}}AF[AK.id]=AI;if(AJ){if(!AE.multiTouch){G(AE);var z=AD[AD.length-2],AH=AF[X(z)];q(AE,S,z,AH.action,AH);}else{AI.action=C;if(AE._singleTouch){G(AE);AE._singleTouch.action=C;delete AE._singleTouch.bubbleTarget;delete AE._singleTouch;q(AE,g,AK,C);}}AK.stop();return ;}if(!V.contains(AE._tn,AG.target,true,AE.domNode)){delete AF[AK.id];return ;}AE._singleTouch=AI;if(q(AE,g,AK)===false){return ;}AK.stop();if(Z(AE,g,o)){AE._selectHandle=window.setTimeout(function(){AI.action=o;if(q(AE,g,AK,o)===false){a(AE,AK);}delete AE._selectHandle;},F);}U(AE);}function w(AC,AD){var AF=(AD.changedTouches&&AD.changedTouches[0])||AD,z=AC.gestures[X(AF)];if(!z){return ;}var AA=e(AD,z.s,AF,z.p2),AB=z.action;z.p2=z.p1;z.p1=AA;if(!AB&&(B.abs(AA.delta.x)>h||B.abs(AA.delta.y)>h)){AB=z.action=p;G(AC);if(!Z(AC,g,AB)&&!Z(AC,d,AB)){AA.methodName=M(g,AB);return AC.bubbleTouchEvent(AA);}if(q(AC,g,AA,AB)===false){a(AC,AA);return ;}}if(AB){var x=z.lastMove||z.s.date,AE=AA.date-x;if(!mstrApp.isTouchApp()||AE>=Y){z.lastMove=AA.date;q(AC,d,AA,AB);}}}function E(AC,AE){var x=(AE.changedTouches&&AE.changedTouches[0])||AE,AF=(AE.touches&&AE.touches.length)||0,AD=AC.gestures,AI=X(x),AH=AD[AI];if(!AH){k("No gesture",AI,AC,x);return ;}var AB=AH.action,AJ=e(AE,AH.s,x,AH.p2);if(!AB){G(AC);if(!AH.wasMulti){AB=P;}}if(AF===0){T(AC);AC.gestures=[];k("gestures","clear all",AC,x);}else{AD[AI]=null;k("gestures","clear single",AC,x);}L(AH.bubbleTarget,AI);switch(AB){case p:case o:AJ.stop();q(AC,N,AJ,AB,AH);break;case C:if(AF<2){q(AC,N,AJ,AB,AH);if(AF===1){var AA=AE.touches[0],AG=e(AE,AA,AA),z=I(AG,AG,AG,AE);z.wasMulti=true;AD[X(AA)]=z;AC._singleTouch=z;}}if(AF>0){return ;}break;case P:if(!Z(AC,null,AB)){break;}var AK=AC._tapHandler;if(AK){window.clearTimeout(AK.h);}if(AJ.date-AH.s.date<F){if(q(AC,"Before",AJ,AB,AH)===false){break;}if(!AC.multiTap){AJ.count=1;q(AC,null,AJ,AB,AH);}else{if(AK){AK.count++;}else{AK=AC._tapHandler={count:1};}AK.h=window.setTimeout(function(){AJ.count=AK.count;q(AC,null,AJ,AB,AH);delete AC._tapHandler;},D);}}else{delete AC._tapHandler;}break;}q(AC,N,AJ,undefined,AH);}function b(z){var x=z._tn;if(!x){return ;}if(!z._tmCallback){z._tsCallback=function(AA){H(z,AA);};z._tmCallback=function(AA){w(z,AA);};z._teCallback=function(AA){E(z,AA);};}s(x,V.TOUCHSTART,z._tsCallback);}mstrmojo._TouchGestures=mstrmojo.provide("mstrmojo._TouchGestures",{_mixinName:"mstrmojo._TouchGestures",singleNode:false,multiTouch:false,touchNode:null,multiTap:false,monitorInputs:false,postBuildRendering:function O(){if(this._super){this._super();}this._tn=this.touchNode||this.domNode;this.gestures=[];b(this);},bubbleTouchEvent:function f(AE){var AB=AE.methodName,x=AE.id,z=this.gestures[x],AA=this.parent;while(AA){var AD=AA[AB],AC=AA.touchBegin;if(AD&&(!AC||q(AA,g,AE)!==false)){AE.methodName=AB;L(z.bubbleTarget,x);z.bubbleTarget=AA;AA.gestures[x]=z;k("bubble",((this.k)?" "+this.k:"")+"] bubbled "+AB+" to ["+AA.scriptClass+((AA.k)?" "+AA.k:"")+"]",this,AE);return AD.call(AA,AE);}AA=AA.parent;}return false;},unrender:function A(z){if(l(this)){T(this);}var x=this._tn;if(x){V.detachEvent(x,V.TOUCHSTART,this._tsCallback);}this._super(z);},restoreDefaultTouches:function R(x){if(W){W.allowDefaultTouches=x&&j;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func");mstrmojo.requiresDescs(8445);var O=mstrmojo.hash;var J=mstrmojo.dom;var Q=[mstrmojo.desc(8445,"Loading")];var G=0;function h(z,AA,t){var w=G++,x=this.getTxUpdates(w);t=t||{};t.src=arguments.callee.caller.name;if(!mstrmojo.string.isEmpty(x)){z.updateChanges=x;}mstrApp.serverRequest(z,this.wrapCallback(AA,w),t);}function H(t){var w=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(w){t.styleName="RWDocumentMobileStyle";t.availableWidth=w.w;t.availableHeight=w.h;}}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService],{scriptClass:"mstrmojo.DocDataService",wrapCallback:function s(x,t){var w=this;return mstrmojo.func.wrapMethods({success:function(z){if(z){w.rwb=z.bs||w.rwb;w.msgId=z.mid||w.msgId;}w.clearTxUpdates(t);},failure:function(z){w.resetTxUpdates(t);}},x);},refresh:function q(x,z){var w=!!x.useRefreshProgress,t=w?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:Q;delete x.useRefreshProgress;h.call(this,O.copy(x,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false}),z,{showProgress:true,hideProgress:true,progressStateText:t,useRefreshProgress:w});},getTxUpdates:function Z(x){var w=this.model;return w&&w.getTransactionUpdates&&w.getTransactionUpdates(x);},clearTxUpdates:function M(x){var w=this.model;if(w&&w.clearTransactionUpdates){w.clearTransactionUpdates(x);}},resetTxUpdates:function D(x){var w=this.model;if(w&&w.resetTransactionUpdates){w.resetTransactionUpdates(x);}},loadDocLayout:function V(w,x){var t=O.copy(w,{taskId:"loadDocLayout",rwb:this.rwb});H.call(this,t);h.call(this,t,x,{showProgress:true,hideProgress:true,progressStateText:Q});},setCurrentDocLayout:function T(t,w){w=w||null;h.call(this,{taskId:"setDocLayout",rwb:this.rwb,layoutKey:t},w,{silent:(w===null)});if(typeof mstrMobileApp!=="undefined"){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function b(t,w){h.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:t},w);},setCurrentPanel:function g(z,x,t,w){h.call(this,{taskId:"setCurrentPanel",rwb:this.rwb,key:z,panelStackKey:x,selectorKeyContext:t},w,{silent:true});},requestNewPanel:function j(AB,AA,x,t,w,z){h.call(this,{taskId:"requestNewPanel",rwb:this.rwb,key:AB,panelStackKey:AA,selectorKeyContext:x,dirtyKeys:t},z,{showProgress:w,hideProgress:w,progressStateText:Q});},applyGraphSelectorAction:function E(AB,AA,z,t,AD,AC,w){h.call(this,{taskId:"applyGraphSelectorAction",rwb:this.rwb,selectorKeyContext:AB,ctrlKeys:AA,sliceID:z,x:t,y:AD,zoomFactor:w},AC);},setDocSelectorElements:function L(AB,AD,AG,AC,AE,x,t,AA,AF,w){var z={taskId:"setDocSelectorElements",rwb:this.rwb,selectorKeyContext:AB,elemList:AD,ctlKey:AG,zoomFactor:x};if(J.isAndroid||t){z.taskId="androidSetDocSelectorElements";}if(AC!==null&&AC!==undefined){z.include=AC;}if(AA){z.sdpKeys=AA;}if(AF){z.tks=AF;}if(w){z.usePartialUpdate="0";}h.call(this,z,AE,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setDocVisSelectorElements:function p(AA,AC,AF,AB,AD,w,t,z,AE){var x={taskId:"setDocVisSelectorElements",rwb:this.rwb,selectorKeyContext:AA,elemList:AC,ctlKey:AF,zoomFactor:w};if(J.isAndroid||t){x.taskId="androidSetDocSelectorElements";}if(AB!==null&&AB!==undefined){x.include=AB;}if(z){x.sdpKeys=z;}if(AE){x.tks=AE;}h.call(this,x,AD,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},setMultiDocSelectorElements:function W(t,x,AA,w){var z={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:x,selectorObjects:t,zoomFactor:w};h.call(this,z,AA,{showWait:true,hideWait:true,delay:true});},setDocSelectorExpression:function X(x,AI,AC,t,AG,AB,AA,AE,AD,AF,w,AH){var z={taskId:"setDocSelectorExpression"+(AH?"Unset":""),rwb:this.rwb,unitKeyContext:x,ctlKey:AI,objectId:AC,objType:t,expFunction:AG,expFunctionType:AB,zoomFactor:w};if(AA!==null&&AA!==undefined){z.include=AA;}if(AE!==null&&AE!==undefined){z.expConstants=AE;}if(AD!==null&&AD!==undefined){z.dataType=AD;}h.call(this,z,AF);},setDocSelectorInclude:function N(x,w,AC,AB,t,z){var AA={taskId:"setDocSelectorInclude",rwb:this.rwb,include:w,ctlKey:x,zoomFactor:z};if(AB){AA.objectID=AB;}if(t){AA.objType=t;}h.call(this,AA,AC);},setDocUnsetSelector:function S(w,t,z,x){h.call(this,{taskId:"unsetSelector",rwb:this.rwb,unitKeyContext:w,ctlKey:t,zoomFactor:x},z);},getRWGraphImage:function f(AB,AD){var AA=mstrApp,AC=this.id,z={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:AB.k,sliceID:parseInt(AB.sid,10),width:parseInt(AB.w,10),height:parseInt(AB.h,10)};if(AA.onMobileDevice()&&AA.useBinaryFormat){window.setTimeout(function(){h.call(mstrmojo.all[AC],z,AD);},0);}else{if(AB.encodeImage){z.taskContentEncoding="base64";delete z.taskEnv;h.call(this,z,{success:function(AE){AD.success("data:image/png;base64,"+AE);},failure:function(AE){(AD.failure||AA.onerror)(AE);}});}else{var t=AA.getConfiguration(),x=AA.getCurrentProjectId(),w=new mstrmojo.StringBuffer();z.__ts__=new Date().getTime();z.sessionState=AA.getSessionState(x);O.forEach(z,function(AE,AF){w.append(AF+"="+encodeURIComponent(AE));});AD.success(t.getTaskUrlByProject(x)+"?"+w.toString("&"));}}},getImage:function A(w){var x=mstrApp,t=x.getConfiguration();if(t&&w&&w.indexOf("://")===-1){w=t.getHostUrlByProject(x.getCurrentProjectId())+w;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(w)):w;},getDocImage:function l(t){return this.getImage(t);},setQuickSwitchViewMode:function C(t,w){h.call(this,{taskId:"setDisplayMode",gridKeyContext:t,messageID:this.msgId,displayMode:w},null,{silent:true});},setRWUnitProperties:function a(t,x,z,w,AA){h.call(this,{taskId:"setRWUnitProperties",rwb:this.rwb,nodeKey:t,props:x,formatType:z,returnData:w},AA,{silent:true});},setDocZoom:function B(t,w){h.call(this,{taskId:"setDocZoom",rwb:this.rwb,zoomType:t.zoomType,zoomFactor:t.zoomFactor},w);},sort:function k(t,w){h.call(this,O.copy(t,{taskId:"DocSort",rwb:this.rwb}),w);},pivot:function K(w,x){var t=O.copy(w,{messageID:this.msgId,rwb:this.rwb});t.key=w.nodeKey;delete t.nodeKey;t.taskId=w.formID?"docPivotForm":"docPivot";h.call(this,t,x);},drillGrid:function U(t,w){h.call(this,{taskId:"DocDrill",messageID:this.msgId,nodeKey:t.nodeKey,drillPathIndex:t.drillPathIndex,drillPathKey:t.drillPathKey,elementList:t.drillElements},w,{showProgress:true,hideProgress:true,progressStateText:Q,delay:true});},changeDocGroupBy:function F(x,z,t){var w={taskId:"changeDocGroupBy",rwb:this.rwb,messageID:this.msgId,treesToRender:3};if(x.flags){w.flags=x.flags;}if(x.groupbyKey){w.groupByKey=x.groupbyKey;w.elementID=x.elementId;}else{w.gbUnits=x.gbUnits;}H.call(this,w);h.call(this,w,z,t);},downloadGridData:function d(t,w){h.call(this,{taskId:"DocXtabIncrementalFetch",rwb:this.rwb,nodeKey:t.nodeKey,rowPosition:t.rowPosition,maxRows:t.maxRows,colPosition:t.colPosition,sliceId:t.sliceId,maxColumns:t.maxColumns},w);},txMarkRows:function e(t,w){h.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:t.nodeKey,sliceId:t.sliceId,rowOrdinal:t.rowOrdinal,actionType:t.actionType},w);},txChangeData:function I(t,w){h.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:t.nodeKey,sliceId:t.sliceId,cells:t.cells,autoRefresh:t.autoRefresh},w);},sendTransactionActions:function R(w,x){var t={taskId:"DocTransaction",rwb:this.rwb,keyContext:w.keyContext,actions:w.actions,messageID:this.msgId};if(w.txrcd){t.isPending=w.txrcd.pending;t.timestamp=w.txrcd.timestamp;}h.call(this,t,x,{silent:!!x});},RWEventsTask:function o(t,w){h.call(this,{taskId:"RWEventsTask",rwb:this.rwb,messageID:t.messageID,styleName:t.styleName,events:t.events},w);},getPageByTree:function Y(t){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},t);},resetSelections:function P(w,t,x){h.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:w||"",usePartDisplay:t?"0":"1"},x);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var D=mstrmojo.hash;var E=0;var M=[];var P={};var B=false;function H(R){var S=R.callback;if(S.submission){S.submission(this.userInteractionRequired(R));}this.submitRequest(R);}function K(){if(M.length&&!B){H.call(this,M.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function I(b,Y,S,T){if(S){this.cancelRequests();}var V=this.id,W=this.transport,R=mstrmojo.now()+Y.taskId+E++,U=b.canceled||mstrmojo.emptyFn;b.canceled=function(d){U();b.complete(true);return W.cancelRequest(d);};b=mstrmojo.func.wrapMethods(b,{complete:function(d){mstrmojo.all[V].deleteRequest(d);}});var X=!D.isEmpty(this._requests),Z=this.createRequest(R,b,Y,T),a=(B||X)&&!T.doNotHold;if(a){M.push(Z);}else{H.call(this,Z);}},createRequest:function C(U,W,V,R){var S=this._requests;if(!S){S=this._requests={};}var T=S[U]={id:U,callback:W,params:V,config:R};return T;},submitRequest:function F(R){this.transport.serverRequest(this.id,R.id,R);},cancelRequests:function O(){var R=false;D.forEach(this._requests,function(S){if(typeof S.gotResponse==="undefined"){R|=S.callback.canceled(S.id);}});this._requests={};M=[];return R;},response:function G(V,R,T){$MAPF(false,"AndroidServerTransport","transportRequest");var U=this.getRequest(V);if(U){U.gotResponse=true;var W=U.callback,S=(R&&!T.mstrerr)?"success":"failure";try{if(W[S]){W[S](T,U);}}finally{W.complete(V);}}K.call(this);},deleteRequest:function Q(S){var R=this._requests;delete R[S];},getRequest:function A(S){var R=this._requests;return R&&R[S];},userInteractionRequired:function L(R){return false;},addLoadingGraph:function J(R){P[R]=true;B=true;},removeLoadingGraph:function N(R){delete P[R];if(D.isEmpty(P)){B=false;K.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.color","mstrmojo.hash","mstrmojo.num","mstrmojo.storage.DOMLocalStorage","mstrmojo.StringBuffer","mstrmojo.android.EnumMenuOptions");mstrmojo.requiresDescs(1089,1143,7830,7831,7832,7859,7860,7861,7862,8621);var $A=mstrmojo.array,$AFE=$A.forEach,$HASH=mstrmojo.hash,$MENUS=mstrmojo.android.EnumMenuOptions,_cacheKey="CacheEnabled",_verifyJsonKey="VerifyJson",_diagnosticModeKey="DiagnosticMode",EnumHSButtonType={FOLDER:1,RESULTSET:2,REPORTS:3,SETTINGS:4,SHAREDLIBRARY:5,SUBSCRIPTIONS:8,HELP:6};function isObject(o){return(typeof o==="object");}function getColor(clr){if(isObject(clr)){if(clr.tp){return"transparent";}clr=clr.clr;}return mstrmojo.color.decodeColor(clr);}function findServer(project){var servers=this.getWebServersList(),res=null;$AFE(servers,function(server){$AFE(server.pl,function(proj){if(proj===project){res=server;return false;}});return !res;});return res;}function iterateProjects(searchConfig,serversNode,projectCache){var serverCache=projectCache?projectCache.servers:[],projectFound=false;$AFE(serversNode,function(server){$AFE(server.pl,function(project){var id=project.pid;if(id!==undefined){if(projectCache){projectCache[id]=project;serverCache[id]=server;}if(project[searchConfig.n]===searchConfig.v){projectFound=true;return false;}}});if(projectFound){return false;}});return projectFound;}function reconcileHSType(hsType){var projectID=getHSProjectID.call(this,hsType),hscNode=this._cfg.hsc,projectExists;if(!projectID){return ;}projectExists=iterateProjects({n:"pid",v:projectID},this.getWebServersList());if(!projectExists){hscNode.tp=1;switch(hsType){case 3:delete hscNode.rs;break;case 4:delete hscNode.fd;break;}}}function getHSProjectID(hsType){var projectID,hscNode=this._cfg.hsc;switch(hsType){case 3:projectID=hscNode.rs.oi.pid;break;case 4:projectID=hscNode.fd.oi.pid;break;}return projectID;}function buildCustomHomeScreen(hsc,asFolder){var ths=this,cst=hsc.cst,btns=[],hscType=ths.getHomeScreenType(),devType=ths.getDeviceType();if(hscType===1&&devType!==4){var addSubsButton=true;$AFE(cst.btns,function(btn){if((btn.act===EnumHSButtonType.SUBSCRIPTIONS)||(btn.act===EnumHSButtonType.REPORTS)){addSubsButton=false;return false;}});if(addSubsButton&&(hscType===1||(devType===4&&hscType===2&&cst.fmt.vw.rpt))){btns.push({act:EnumHSButtonType.SUBSCRIPTIONS,txt:mstrmojo.desc(1089,"Subscriptions"),dsc:""});}}$AFE(cst.btns,function(btn){var xlt=ths.xlat[$A.find(ths.xlat,"act",btn.act)],txt=xlt?(btn.cap===xlt.dcp?xlt.cap:btn.cap):btn.cap,dsc=xlt?xlt.dsc:btn.dsc,b={};if(asFolder){b.n=txt;b.desc=dsc;}else{b.txt=txt;b.dsc=dsc;}var icon=btn.icn;if(isObject(icon)){b.icn=icon.img;}var action=btn.act;if(isObject(action)){var objInfo=(action.fd&&action.fd.oi)||(action.rs&&action.rs.oi)||action.rs;b.did=objInfo.did;b.t=objInfo.t;b.st=objInfo.st;b.pid=objInfo.pid;b.ab=objInfo.ab;b.csp=!!(action.fd&&action.fd.csp);}else{b.act=action;if(b.act===EnumHSButtonType.SETTINGS&&!ths.getGeneralSettings().uas){b=null;}}if(b){btns.push(b);}});var config={btns:btns,fmt:{},ttl:""},fmt=cst.btns?cst.fmt:cst;if(fmt){var bgFmt=fmt.bkg,btnFmt=fmt.btn;config.fmt={bg:{tp:bgFmt.tp,v:(bgFmt.tp===1)?getColor(bgFmt.fll.clr):bgFmt.img},btn:{bc:getColor(btnFmt.brd),bg:getColor(btnFmt.fll),c:getColor(btnFmt.fnt),sty:btnFmt.stl}};config.ttl=fmt.ttl.cap;}if(devType===4){config.hlp=fmt.vw.hlp;}return config;}function _loadConfiguration(){var cfg=mstrMobileApp.getConfiguration();return eval("("+cfg+")");}function _initializePrjCache(cfg){cfg._hostUrls={};cfg._projects={servers:{}};}function _clearCachedValues(){delete this._hsType;delete this._hsCfg;delete this._wsl;delete this._gnl;}mstrmojo.MobileConfiguration=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.MobileConfiguration",_cfg:null,xlat:null,init:function init(props){var xl=this.xlat=[],md=mstrmojo.desc;xl.push({act:5,cap:md(7832),dsc:md(7859),dcp:"Shared Library"});xl.push({act:4,cap:md(7831),dsc:md(7861),dcp:"Settings"});xl.push({act:6,cap:md(1143),dsc:md(7862),dcp:"Help"});xl.push({act:3,cap:md(7830),dsc:md(7860),dcp:"Reports"});xl.push({act:EnumHSButtonType.SUBSCRIPTIONS,cap:md(1089),dsc:md(7860),dcp:"Subscriptions"});this._super(props);this._cfg=this._cfg||_loadConfiguration();_initializePrjCache(this);this.cacheEnabled=$LS.getItem(_cacheKey)||false;this.binaryMode=mstrMobileApp.useBinaryFormat();this.verifyJson=$LS.getItem(_verifyJsonKey)===true;this.diagnosticMode=mstrMobileApp.getDiagnosticMode();},getConfiguration:function(){return this._cfg;},saveConfiguration:function(silently){_clearCachedValues.call(this);_initializePrjCache(this);mstrMobileApp.saveConfiguration(JSON.stringify(this._cfg),!!silently);},reloadDefaultConfiguration:function(){mstrMobileApp.reloadDefaultConfiguration();this._cfg=_loadConfiguration();_clearCachedValues.call(this);_initializePrjCache(this);},setWebServerList:function(wsl){this._wsl=this._cfg.cty.wsl=wsl;_initializePrjCache(this);return this;},getWebServersList:function(){if(!this._wsl){this._wsl=this._cfg.cty.wsl||[];}return this._wsl;},getGeneralSettings:function(){if(!this._gnl){this._gnl=this._cfg.gnl;}return this._gnl;},getDefaultServerCreds:function(){var cty=this._cfg.cty;cty.wsdc=cty.wsdc||{am:1,lo:"",ps:""};return cty.wsdc;},getBackgroundSyncSettings:function(){var gnl=this.getGeneralSettings();gnl.bss=gnl.bss||{ebs:false,ui:4,tod:0,wo:false,co:false};gnl.bss.wo=gnl.bss.wo||false;gnl.bss.co=gnl.bss.co||false;return gnl.bss;},setDefaultServerCreds:function(sd){var cty=this._cfg.cty;$HASH.copy(sd,cty.wsdc);return this;},getCacheEnabled:function(){return false;},setCacheEnabled:function(c){this.cacheEnabled=c;$LS.setItem(_cacheKey,c,-1);},getBinaryMode:function(){return this.binaryMode;},setBinaryMode:function(v){if(this.binaryMode!==v){this.binaryMode=v;mstrApp.serverProxy.closeAllSessions();mstrApp.useBinaryFormat=v;mstrMobileApp.setBinaryFormat(v);}},getDeviceType:function(){return this._cfg.dt;},isSubscriptionEnabled:function(){return this.getHomeScreenType()!=2?true:!!this._cfg.hsc.cst.fmt.vw.rpt;},getVerifyJson:function(){return this.verifyJson;},getDiagnosticMode:function(){return this.diagnosticMode;},setDiagnosticMode:function(v){if(this.diagnosticMode!==v){this.diagnosticMode=v;$LS.setItem(_diagnosticModeKey,v,-1);mstrApp.diagnosticMode=v;mstrMobileApp.setDiagnosticMode(v);}},getSettingsAllowed:function getSettingsAllowed(){return this.getGeneralSettings().uas;},isMenuAllowed:function isMenuAllowed(menuItem,menuMask){if((menuMask&menuItem)>0){var generalSettings=this.getGeneralSettings(),vw=this._cfg.hsc.cst?this._cfg.hsc.cst.fmt.vw:{stg:true,hlp:true};switch(menuItem){case $MENUS.SETTINGS:return !!generalSettings.uas&&!!vw.stg;case $MENUS.HELP:return !!vw.hlp;case $MENUS.SHARE:var project=this.getProject(mstrApp.getCurrentProjectId());return(!!generalSettings.es&&project&&!!project.es);case $MENUS.LEARN:return !!generalSettings.slml;default:return true;}}return false;},reconcileHomescreen:function reconcileHomescreen(){var ths=this,hsType=ths.getHomeScreenType(),hs=this._cfg.hsc;switch(hsType){case 1:break;case 2:var btns=[];$AFE(hs.cst.btns,function(btn){var action=btn.act;if(isObject(action)){var objInfo=(action.fd&&action.fd.oi)||(action.rs&&action.rs.oi)||action.rs;if(ths.getProject(objInfo.pid)!==undefined){btns.push(btn);}}else{btns.push(btn);}});if(!btns.length){btns.push({act:5,cap:mstrmojo.desc(7832),icn:1});}hs.cst.btns=btns;break;case 3:case 4:reconcileHSType.call(this,hsType);break;}},getHomeScreenType:function(){if(!this._hsType){var hscNode=this._cfg.hsc;if(hscNode){this._hsType=(typeof hscNode==="number")?hscNode:hscNode.tp;}}return this._hsType;},getHomeScreen:function(asFolder){if(!this._hsCfg){var type=this.getHomeScreenType(),hsc=this._cfg.hsc,cfg;switch(type){case 1:case 2:cfg=buildCustomHomeScreen.call(this,hsc,asFolder);break;case 3:cfg=hsc.rs;if(cfg.oi){cfg=cfg.oi;}break;case 4:cfg=hsc.fd;cfg.hlp=true;break;}this._hsCfg=cfg;}return this._hsCfg;},getProjectByRealPid:function getProjectByRealPid(realPid){var proj;$AFE(this.getWebServersList(),function(server){$AFE(server.pl,function(project){if(realPid===project.realPid){proj=project;return false;}});if(proj){return false;}});return proj;},getProjectByServerAndProjectName:function getProjectByServerAndProjectName(serverName,port,projName){var proj;$AFE(this.getWebServersList(),function(server){$AFE(server.pl,function(project){if((serverName===project.sn)&&(projName===project.pn)){if((port===undefined)||(!!port&&parseInt(port,10)===project.sp)){proj=project;return false;}}});if(proj){return false;}});return proj;},getHostUrlByRealPid:function getHostUrlByRealPid(realPid){var proj=this.getProjectByRealPid(realPid);return this.getHostUrlByProject((proj&&proj.pid)||realPid);},getWebServerUrlByProject:function getWebServerUrlByProject(projectId){var servUrl=this.getHostUrlByProject(projectId);return servUrl.replace(/(servlet\/|asp\/)$/,"");},getCurrentProjectWebServerUrl:function getCurrentProjectWebServerUrl(){return this.getWebServerUrlByProject(mstrApp.getCurrentProjectId());},getHostUrlByProject:function getHostUrlByProject(projectId){var urls=this._hostUrls;if(!urls[projectId]){var server=this.getServerByProjectId(projectId);if(server===undefined){throw new Error("Could not find server for project, pid="+projectId);}var hostUrl=new mstrmojo.StringBuffer();hostUrl.append("http");if(server.rt){hostUrl.append("s");}hostUrl.append("://"+server.nm);var port=server.po;if(port){hostUrl.append(":"+port);}hostUrl.append("/"+server.pt+"/");hostUrl.append(((server.ty===0)?"servlet":"asp")+"/");urls[projectId]=hostUrl.toString();}return urls[projectId];},getTaskUrlByProject:function getTaskUrlByProject(projectId){var server=this.getServerByProjectId(projectId);if(server===undefined){throw new Error("Could not find server for project, pid="+projectId);}return this.getHostUrlByProject(projectId)+mstrConfig.taskURL+((server.ty===1)?".aspx":"");},getProject:function getProject(projectId){var projects=this._projects;if(!projects[projectId]){iterateProjects({n:"pid",v:projectId},this.getWebServersList(),projects);}return projects[projectId];},getProjectHash:function getProjectHash(){var _result={},serverList=this.getWebServersList();if(serverList.length<1){return _result;}var projects=this._projects,dummyProjectID=mstrmojo.num.generateUniqueID(64);iterateProjects({n:"pid",v:dummyProjectID},serverList,projects);_result=$HASH.clone(projects);delete _result.servers;return _result;},getProjectList:function getProjectList(){var projectList=[];$HASH.forEach(this.getProjectHash(),function(project){projectList.push({did:project.pid,n:project.pn,desc:project.sn,st:"Project",t:8,rtf:project.rtf});});return projectList;},clearLoginInfoForProject:function clearLoginInfoForProject(pid){var cfg=this.getConfiguration(),server=this.getServerByProjectId(pid),project=this.getProject(pid),creds=project.udc?server.pdc:project.pc;creds.lo=creds.ps="";},getLoginInfo:function(projectId){var cfg=this.getConfiguration(),server=this.getServerByProjectId(projectId),serverCreds=server.wsc,wsuid=serverCreds.lo||"",wspwd=serverCreds.ps||"",wsam=serverCreds.am,project=this.getProject(projectId),projectCreds=project.pc,uid=projectCreds.lo||"",pwd=projectCreds.ps||"",am=projectCreds.am;if(server.udc){var wsdc=cfg.cty.wsdc;wsam=wsdc.am;wsuid=wsdc.lo||"";wspwd=wsdc.ps||"";}if(project.udc){var pdc=server.pdc;uid=pdc.lo;pwd=pdc.ps;am=pdc.am;}return{wsuid:wsuid,wspwd:wspwd,wsam:wsam,uid:uid,pwd:pwd,am:am};},updateLoginInfo:function updateLoginInfo(projectId,loginInfo){var server=this.getServerByProjectId(projectId),project=this.getProject(projectId),creds=project.udc?server.pdc:project.pc,serverCreds=server.udc?this.getDefaultServerCreds():server.wsc;if(loginInfo.updateCfgAfterLogin&1){serverCreds.lo=loginInfo.wsuid;serverCreds.ps=loginInfo.wspwd;}if(loginInfo.updateCfgAfterLogin&2){creds.lo=loginInfo.uid;creds.ps=loginInfo.pwd;}this.saveConfiguration(false);},getProjectCount:function(){var wsl=this.getWebServersList(),count=0,i=0;for(i=0;i<wsl.length;i++){if(wsl[i].pl){count+=wsl[i].pl.length;}}return count;},getServerByProjectId:function(projectId){var projects=this._projects,servers=projects.servers;if(!servers[projectId]){iterateProjects({n:"pid",v:projectId},this.getWebServersList(),projects);}return servers[projectId];},setPid:function setPid(project){var oldPid=project.pid,oldRealPid=project.realPid,projCache=this._projects,serverCache=projCache.servers,pid=mstrmojo.num.generateUniqueID(32),server=findServer.call(this,project);if(oldPid){delete projCache[oldPid];delete serverCache[oldPid];}if(oldRealPid){delete projCache[oldRealPid];delete serverCache[oldRealPid];}project.pid=pid;delete project.realPid;projCache[pid]=project;serverCache[pid]=server;},setRealPid:function setRealPid(project,value){if(typeof project==="string"){project=this.getProject(project);if(!project){return ;}}var oldRealPid=project.realPid,projCache=this._projects,serverCache=projCache.servers,server=findServer.call(this,project);if(oldRealPid&&oldRealPid!==project.pid){delete projCache[oldRealPid];delete serverCache[oldRealPid];}project.realPid=value;projCache[value]=project;serverCache[value]=server;this.saveConfiguration(true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,toXml:function A(){var J=this,D=function(P,Q){return" "+P+'="'+Q+'"';},C=function(P,Q){return D(P,mstrmojo.string.encodeXMLAttribute(Q));},F=new mstrmojo.StringBuffer();var H=this.prms,B=H&&H.length;if(B||J.aopam!=J.DO_NOT_ANSWER){F.append("<hl"+D("mid",J.mid)+D("srct",J.srct)+D("aopam",J.aopam)+">");if(B){F.append("<prms>");for(var E=0;E<B;E++){var O=H[E];F.append("<prm"+D("id",O.id)+D("am",O.am)+D("pt",O.pt));if(O.orid){F.append(D("orid",O.orid)+D("ortp",O.ortp));}F.append(">");switch(O.am){case J.DO_NOT_ANSWER:case J.CLOSE:case J.USE_DEFAULT_ANSWER:case J.SAME_PROMPT:break;case J.STATIC:F.append('<pa ia="1"><es>');var N=O.pa.es,M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es></pa>");break;case J.DYNAMIC:case J.ALL_VALID_UNITS:case J.CURRENT_UNIT:var L=O.pa;if(L){F.append('<pa ia="1">');var K=L.a;if(K){F.append("<a"+D("id",K.id)+C("n",K.n)+">");}if(O.pt===1){F.append(mstrmojo.string.encodeXMLAttribute(L.v));}else{F.append("<es"+D("dispForms",K&&K.dispForms>=0?K.dispForms:"")+">");var N=L.es;M=N&&N.length||0;for(var I=M-1;I>=0;--I){var G=N[I];F.append("<e"+C("ei",G.ei)+D("disp_n",G.disp_n)+D("emt",G.emt)+"/>");}F.append("</es>");if(K){F.append("</a>");}}F.append("</pa>");}break;}F.append("</prm>");}F.append("</prms>");}F.append("</hl>");}return F.toString();}});})();(function(){mstrmojo.requiresDescs(8409);mstrmojo.prompt.WebPrompt=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.prompt.WebPrompt",promptType:0,prs:null,pt:0,pin:0,loc:null,title:"",mn:"",req:false,min:null,max:null,dataSourcesXML:"",getStyle:mstrmojo.emptyFn,getDisplayValue:mstrmojo.emptyFn,validate:function F(K){if(this.isAnswerEmpty(K)&&this.req){throw new Error(mstrmojo.desc(8409,"This prompt (#) requires an answer.").replace("#",this.title));}},prepareAnswer:function E(L){var K=L&&L.success;if(K){K();}},getAnswerXML:function C(){var K=new mstrmojo.XMLBuilder();this.buildShortPa(K);return K.toString();},buildShortAnswerXML:function I(K){return K;},buildShortPa:function G(K){K.addChild("pa");K.addAttribute("pt",this.pt);var L=this.loc;if(L){K.addAttribute("pin",L.pin);K.addAttribute("did",L.did);K.addAttribute("tp",L.t);}this.buildShortAnswerXML(K);K.closeElement();},populateAnswer:function H(K){},setAnswerValue:mstrmojo.emptyFn,isAnswerEmpty:function J(K){return false;},populate:function D(L){this.promptType=L.ptp;this.pt=L.dptp;this.mn=L.mn;this.pin=L.pin;this.title=L.ttl;this.loc=L.loc;this.min=L.min||"";this.max=L.max||"";this.req=L.reqd;this.dataSourcesXML=L.dsrcs;var K=this.prs={};mstrmojo.array.forEach(L.prs,function(M){K[M.n]=M.v;});this.hasAnswer=L.hasAns;},buildAnswerObject:function B(){return{};},supported:function A(){return true;}});mstrmojo.prompt.WebPrompt.TYPES={CONSTANT_PROMPT:1,CONSTANT_GEO_PROMPT:1.5,ELEMENTS_PROMPT:2};mstrmojo.prompt.WebPrompt.STYLES={TEXT:1,LIST:2,STEPPER:3,SWITCH:4,SLIDER:5,CALENDAR:6,TIME:7,GEO:8,BARCODE:9};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.maps.AndroidMapModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.AndroidMapModel",getVisProps:function(){return this.data.vp;},setPrompts:function E(M){},getDataService:function G(){},execute:function H(M,N){},answerPrompts:function F(M){},getPageByTree:function J(M){},sort:function D(M,N){},pivot:function K(M,N){},drillGrid:function L(M,N){},drill2Grid:function C(M,N){},linkToObject:function A(M,N){},pageBy:function I(M,N){},saveRWProps:function B(N,P,O,M,Q){}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array");var Q=Math,V=mstrmojo.publisher.hasSubs,P=mstrmojo.hash,U=P.forEach,b=mstrmojo.dom;var S=0.15;var f=1,T=2;var B={y:{edge:["top","bottom"],size:0},x:{edge:["left","right"],size:0},clsName:"mstrmojo-touch-scroll-indicator",init:function Z(){var k=this.y,j=this.x;if(!k.i){var l=k.i=document.createElement("div");l.className=this.clsName;var o=j.i=l.cloneNode();document.body.appendChild(l);document.body.appendChild(o);}},setGradient:function a(t,l,w,p){var s=t.i,k=t.edge[(l)?1:0];var q=Q.min(Q.round(Q.min(Q.abs(w)/200,1)*100),p/2),j="left top",o="left bottom";if(l){o=j;if(k==="bottom"){j="left bottom";}else{j="right top";}}else{if(k==="left"){o="right top";}}if(q!==t.size){s.style.background="-webkit-gradient(linear, "+j+", "+o+", from(rgba(39, 104, 162, .4)), to(rgba(39, 104, 162, 0)), color-stop("+(q/100)+", rgba(39, 104, 162, 0)))";t.size=q;}},scrollAxis:function D(o,AB,q,z,l){var AG=AB-q,k=l[o]=(AG!==0);if(!k){this.hide(o);return ;}var s=this[o],x=s.i,j=x.style,t=(o==="y"),w=(AG>0),AA=this.clsName+" "+s.edge[(w)?1:0];if(!s.size||x.className!==AA){x.className=AA;var AC="px",AH=3,AD=z.y,p=z.x,AE=100,AF=z.w;if(t){if(w){AD+=z.h-AE-AH;}}else{AF=AE;AE=z.h;if(w){p+=z.w-AF-AH;}}j.top=AD+AC;j.left=p+AC;j.width=AF+AC;j.height=AE+AC;j.display="block";}this.setGradient(s,w,AG,(t)?z.h:z.w);},scroll:function D(o,l,s,q,z){var w=l.x,t=l.y;if(w!==s||t!==q){this.init();var p=this._widgetPosition;if(!p){var j=o.indicatorEl||z;p=mstrmojo.dom.position(j.parentNode);}var k=o._outOfBounds||{};this.scrollAxis("y",t,q,p,k);this.scrollAxis("x",w,s,p,k);this._widgetPosition=p;o._outOfBounds=k;}else{this.hideAll();delete o._outOfBounds;}},hide:function L(k){var j=this[k];if(j.size!==undefined){j.i.style.display="none";j.i.className=this.clsName;j.size=0;}},hideAll:function d(){this.hide("y");this.hide("x");delete this._widgetPosition;}};function X(j,k){return(k)?Q.max(Q.min(Q.round(j),k.end),k.start):j;}function N(j,l,k){k.name=l;k.id=j.identifier;j.raiseEvent(k);}function F(){var k="scrollDone",j=this.origin;if(V(this.id,k)&&j){N(this,k,{x:j.x,y:j.y});}this.stopDeceleration();}function H(l,k,q){var p=l.scrollEl;if(!p){F.call(l);return ;}var o={x:k.x||0,y:k.y||0};U(l._scrollBarEls,function(AF,AA){var AK=(AA==="x"),AE=o[AA],s=AF.length,AG=AF.ratio,AC=AF.viewportSize,z=6/s,x=AF["base"+((AK)?"Left":"Top")],AD=x+AC-s,w=Q.round(x+(AG*AE));if(w<x){w=x-AE;s+=AE;}else{if(w>AD){var AJ=(AE-l.offset[AA].end)*AG;w=Q.min(AD+AJ,AC+x-6)-1;s-=AJ;}}var AI=0,t=[AI,AI,AI],AB=[1,1,1],AH=(AK)?0:1;t[AH]=(w-x);AB[AH]=Q.min(Q.max(s/AF.length,z),1);b.translate(AF,t[0],t[1],t[2]," scale3d("+AB.join(",")+")");});if(q){q+="ms";}if(l._isHosted){var j=p.parentNode;j.scrollTop=o.y;j.scrollLeft=o.x;}else{p.style[b.CSS3_TRANSITION_DURATION]=q||"0";b.translate(p,-o.x,-o.y,0,l.transform,l.useTranslate3d);}if(V(l.id,"scrollMoved")){N(l,"scrollMoved",{x:k.x,y:k.y});}}function I(j,k,l){return Q.ceil(1+Q.log(j/Q.abs(k))/Q.log(1-l));}function E(j,p,l,k,o){return j+(p*(l*(1-Q.pow(1-o,k))/o));}function M(AL,AV,q,AR,AD,AQ,z){var x=AL.offset[q];if(!x){return AV;}var p=AL._outOfBounds,k=p&&p[q],AB=x.incFetch,AC=AL.friction,w=x.start,t=x.end,AM=(AR)?t:w;AD=Q.abs(AD);if(k){AR=(AV<w);AM=(AR)?w:t;}var AU=(AR)?1:-1;if(k&&(AR||!AB)){var AA=S*3,AT=1/(1-AC),o=AA/Q.pow((1-AC),(Q.log(1-Q.abs(AV-AM)*(1-AT)/AA)/Q.log(AT))-1);var AJ=Q.round(E(AV,AU,o,AQ,AC));if(AR?(AJ>=AM):(AJ<=AM)){F.call(AL);return AM;}return AJ;}var AP=x.pageSize,AO=x.supportedEdges;var s=E(AV,AU,AD,AQ,AC),AE=(s<=w),l=(s>=t);if(AE||l){if(AB&&((AE&&((AO&f)>0))||(l&&((AO&T)>0)))){if(s-t>=AP){s=t+AP;AM=s;}if(!AL.STATUS_INC_FETCH){AL.STATUS_INC_FETCH=true;N(AL,"incFetch",{edge:l?T:f});}}else{if(AL.bounces){var AS=AC*2,AF=AL.bounceVelocity,j=AL.bounceTime,AN=AL.bounceDistance;if(!AL.hasBounced){AF[q]=Q.abs(S/Q.pow(1-AC,z-AQ-1));j[q]=I(S,AF[q],AS);AN[q]=Q.abs(E(s,AU,AF[q],j[q],AS)-s);AL.raiseEvent({name:"bounceOut",id:AL.identifier,axis:q,direction:AR,value:Q.round(s)});AL.hasBounced=true;}var AI=Math.floor(AN[q]/2);var AH=E(AM,AU,AF[q],AQ,AS),AK=Q.abs(AH-AM);if(Q.abs(AK)<AI){return AH;}if(Q.abs(AK)>=AN[q]){F.call(AL);return AM;}var AG=AI-(AK-AI);return Q.round(AM-((AR)?-AG:AG));}s=AM;}}return Q.round(s);}function O(k){var j=this._scrollListener;if(j){if(!k||k!==j.el){b.detachEvent(j.el,"scroll",j.fn);delete this._scrollListener;return true;}return false;}return true;}var R=mstrmojo.TouchScroller=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.TouchScroller",scrollEl:null,identifier:"",hScroll:false,vScroll:false,offset:null,origin:null,transform:"",friction:0.0015,frameRate:60,bounces:true,hasBounced:false,bounceDistance:{},bounceTime:{},bounceVelocity:{},showScrollbars:false,showIndicators:true,useTranslate3d:true,STATUS_INC_FETCH:false,init:function Z(j){this._super(j);B.init();},initScroller:function Y(k){P.copy(k,this);var p=this.scrollEl;if(p){var o=this._isHosted=false;if(o){var j=p.parentNode;if(O.call(this,j)){j.style.overflow="auto";var q=this.id,l=this._scrollListener={el:j,fn:function(s){var t=mstrmojo.all[q].origin,w=s.target;t.x=w.scrollLeft;t.y=w.scrollTop;}};b.attachEvent(j,"scroll",l.fn);}this.showScrollbars=false;}}},canScroll:function K(){return this.vScroll||this.hScroll;},updateScrollBars:function G(t,o){var q=this.scrollEl;if(!this.showScrollbars||!q){return ;}var k=this._scrollBarEls;if(!k){var p=this;k=this._scrollBarEls={x:"hScroll",y:"vScroll"};U(k,function(w,x){if(p[w]){var z=document.createElement("div");z.className="mstrmojo-touch-scrollBar "+x+"Axis";(o||q.parentNode).appendChild(z);k[x]=z;}else{delete k[x];}});}if(!t){var j=this.scrollEl.parentNode;t={top:0,right:j.clientWidth,bottom:j.clientHeight,left:0};}var s=9,l={x:{left:t.left,top:t.bottom-s,x:t.right-t.left,d:"Width"},y:{left:t.right-s,top:t.top,x:t.bottom-t.top,d:"Height"}};U(k,function(AD,AA){var AI=AD.style,AG=l[AA],AB=AG.d,AC=AD.parentNode,AH=AG.x;var z=AG.left,AF=AG.top,AE=AH/q["offset"+AB],w=Math.min(Math.round(AH*AE),AH);AD.baseLeft=z;AD.baseTop=AF;AD.ratio=AE;AD.viewportSize=AH;AD.length=w;AI.left=z+"px";AI.top=AF+"px";AI[AB.toLowerCase()]=w+"px";});},toggleScrollBars:function C(j){U(this._scrollBarEls,function(k){k.style.opacity=(j)?1:0;});},scrollTo:function(k,q,o){if(!this.canScroll()&&!(k===0&&q===0)){H(this,{x:0,y:0});return ;}var p=this.offset,l=this.origin,j={x:(this.hScroll)?X(k,p.x):0,y:(this.vScroll)?X(q,p.y):0};H(this,j,o);l.x=j.x;l.y=j.y;},scrollToEnd:function(k,q,o){var l=this.origin,p=this.offset,j={x:0,y:0};if(l&&p){mstrmojo.array.forEach([k,q],function(t,s){var x=(s)?"y":"x",w=p[x];j[x]=(t)?(w&&w.end)||0:l[x];});}this.scrollTo(j.x,j.y,o);},scroll:function D(q){if(this._isHosted){return ;}var o=this.offset,AB=this.scrollEl,AD=q.delta,AE=AD.x,AC=AD.y;if(!AB){return ;}if(!o&&this.showIndicators){B.scroll(this,{x:(this.noHScroll)?0:-AE,y:(this.noVScroll)?0:-AC},0,0,AB);return ;}var AA=this.origin,s={x:(this.hScroll)?Q.round(AA.x-AE):0,y:(this.vScroll)?Q.round(AA.y-AC):0},x=X(s.x,o.x),w=X(s.y,o.y);if(!o.scrollPast){if(this.showIndicators){B.scroll(this,s,x,w,AB);}s.x=x;s.y=w;}else{var p=(x!==s.x),t=(w!==s.y),j=(p||t),l=this._outOfBounds,k="";if(l){if(p!==(l.x===true)||t!==(l.y===true)){k="scrollIn";}}else{if(j){k="scrollOut";}}if(k){if(V(this.id,k)){var z=q.direction;N(this,k,{x:{position:s.x,direction:z.x},y:{position:s.y,direction:z.y}});}if(j){this._outOfBounds={x:p,y:t};}else{delete this._outOfBounds;}}}H(this,s);},scrollEnd:function W(AC){B.hideAll();if(!this.canScroll()||this._isHosted){return ;}var AK=this.id,AD=this.friction,AS=1/(1-AD),AL=this.origin,o=AC.velocity,AQ=AC.direction,AJ=new Date(),p=this._outOfBounds,z=this.offset,AR={x:this.hScroll,y:this.vScroll},AE={},AU={},AT={},AA={},s={},AB={},w={},t={},AN={},AP=function(AX){AB[AX]=S;var AW=z[AX],AV=(p&&p[AX]),AY=(AV&&(!AW||!z.scrollPast));AU[AX]=(AR[AX]&&!AY)?AL[AX]-AC.delta[AX]:AL[AX];if(AW){w[AX]=AW.start;t[AX]=AW.end;if(AV){if(!AY){AQ[AX]=(AU[AX]<w[AX]);AN[AX]=(AQ[AX])?w[AX]:t[AX];if(AQ[AX]||!AW.incFetch){AB[AX]=S*3;o[AX]=AB[AX]/Q.pow((1-AD),(Q.log(1-Q.abs(AU[AX]-AN[AX])*(1-AS)/AB[AX])/Q.log(AS))-1);}}else{AU[AX]=X(AL[AX]-AC.delta[AX],AW);}}}AE[AX]=(AR[AX]&&!AY)?Q.abs(o[AX]):0;AT[AX]=(AQ[AX]||false)?1:-1;AA[AX]=I(AB[AX],AE[AX],AD);s[AX]=E(AU[AX],AT[AX],AE[AX],AA[AX],AD);};AP("x");AP("y");AL.x=AU.x;AL.y=AU.y;var AH=(AE.x>0),AG=(AE.y>0);if(!z.scrollPast&&!AH&&!AG){F.call(this);var q,AM,AF,l,AO;for(q in z){AM=z[q];AO=AM.supportedEdges;AF=((AM.start===AU[q])&&((AO&f)>0));l=((AM.end===AU[q])&&((AO&T)>0));if(AM.incFetch&&(AF||l)){this.STATUS_INC_FETCH=true;N(this,"incFetch",{edge:(l)?T:f});}}return ;}this.hasBounced=false;this.bounceDistance={};this.bounceTime={};this.bounceVelocity={};this.decelerating=true;var k=Math.round(1000/this.frameRate),x=AJ,AI,j={x:AH,y:AG};this.decelerationTimer=window.setTimeout(function(){var AV=mstrmojo.all[AK],AW=AV.origin,Aa=new Date(),Ab=(Aa-AJ),AZ;if(AV._halt){F.call(AV);return ;}AI=Aa-x;x=Aa;if(AI>(k+5)){k=k+Q.round((AI-k)/2);}for(AZ in j){if(j[AZ]){var AY=M(AV,AU[AZ],AZ,AQ[AZ],AE[AZ],Ab,AA[AZ]);if(!isNaN(AY)){AW[AZ]=AY;}}}H(AV,AW);var AX=(Ab>AA.x&&Ab>AA.y);if(!AX&&!AV.bounces){AX=true;mstrmojo.hash.forEach(z,function(Ae,Ad){var Ac=AW[Ad];if(Ac!==Ae.end&&Ac!==Ae.start){AX=false;return false;}});}if(AX){F.call(AV);}else{if(AV.decelerating){AV.decelerationTimer=window.setTimeout(arguments.callee,k);}}},k);},stopDeceleration:function A(){var j=!!this.decelerating;if(j){if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}delete this.decelerating;this.toggleScrollBars(false);}delete this._outOfBounds;delete this.hasBounced;delete this.bounceDistance;delete this.bounceTime;delete this.bounceVelocity;delete this._halt;return j;},haltScroller:function J(){this._halt=!!this.decelerating;},unrender:function e(){delete this.scrollEl;},destroy:function g(){this.stopDeceleration();O.call(this);this._super();}});mstrmojo.TouchScroller.getScrollPositionTotals=function h(p){var l=p.parent,j=p._scroller,k=mstrmojo.hash.copy((j&&j.origin)||{x:0,y:0});if(l){var o=mstrmojo.TouchScroller.getScrollPositionTotals(l);k.x+=o.x;k.y+=o.y;}return k;};mstrmojo.TouchScroller.ScrollIndicators=B;R.EnumIncFetchEdges={start:f,end:T};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var G=mstrmojo.hash,N="pending",E="failed";function M(P){if(mstrApp.isHosted()){P.success({});}else{mstrApp.serverRequest({taskId:"getOfflineTransaction"},P,{noTaskURL:true,skipLogin:true});}}function C(P){var Q=true;G.forEach(P,function(R){if(R.pending&&R.pending.length>0){Q=false;}});return Q;}function J(){var P=this;M({success:function(S){var Q=false,R,U,T;P.emptyTransactionQueue=G.isEmpty(S);G.forEach(P.prjModel,function(W,V){if(!S[V]){R=P.prjModel[V];if(R&&R.list){delete P.prjModel[V];Q=true;}}});G.forEach(S,function(W,V){var X=mstrApp.getConfiguration().getProjectByRealPid(V);if(!X){return ;}R=P.prjModel[V];if(!R){R=P.prjModel[V]={pid:X.pid,realPid:V,pn:X.pn,list:W};Q=true;}else{if(!G.equals(R.list,W)){R.list=W;Q=true;}}});if(Q){T={};G.forEach(P.prjModel,function(V){if(V){U=G.clone(V.list);G.copy(U,T);G.forEach(U,function(W){W.p=V;});}});P.ntfBoardModel.docsTx=T;P.ntfBoardModel.raiseEvent({name:"recordChanged",data:P.ntfBoardModel.docsTx});}}});}var D=mstrmojo.OfflineTransactionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.OfflineTransactionModel",lastSubmission:false,emptyTransactionQueue:true,ntfBoardModel:null,prjModel:null,init:function O(P){this._super(P);this.prjModel={};this.ntfBoardModel=new mstrmojo.Obj({docsTx:{},getOfflineRecords:function Q(R){return R?this.docsTx[R]:this.docsTx;}});J.call(this);},getBoardModel:function A(){return this.ntfBoardModel;},hasOfflineTransactions:function L(){return !this.emptyTransactionQueue;},editTransactionRecord:function H(R,Q,P,V){var U=this.ntfBoardModel,T=U.docsTx[R].p,S=mstrApp.getContentDimensions();mstrApp.serverRequest({taskId:"editOfflineTransaction",projectId:T.realPid,documentId:R,isPending:Q,timeStamp:P,availableWidth:S.w,availableHeight:S.h},V,{projectId:T.pid,skipLogin:true});},deleteTransactionRecord:function F(R,V,U,Z){var Q=this.ntfBoardModel,S=Q.docsTx[R],P=S.p,W=S[V?N:E],Y,T,X=this;mstrApp.serverRequest({taskId:"deleteOfflineTransaction",projectId:P.realPid,documentId:R,isPending:V,timeStamp:U},{success:function(){Y=mstrmojo.array.find(W,"timestamp",U);if(Y!==-1){W.splice(Y,1);}if(S.pending.length===0&&S.failed.length===0){delete Q.docsTx[R];if(G.isEmpty(Q.docsTx)){X.emptyTransactionQueue=true;}T=X.prjModel[P.realPid];if(T){delete T.list[R];if(G.isEmpty(T.list)){delete X.prjModel[P.realPid];}}Q.raiseEvent({name:"recordChanged",data:Q.docsTx});}if(Z.success){Z.success(W);}}},{noTaskURL:true,skipLogin:true});},submitOfflineTransaction:function B(){if(!this.lastSubmission||!this.emptyTransactionQueue){G.forEach(this.prjModel,function(Q,P){if(Q&&Q.list&&!G.isEmpty(Q.list)&&!C(Q.list)){mstrApp.submitTransactionQueue(P,"submitOfflineTransaction");}});}},onSubmitDone:function I(P){this.lastSubmission=P;this.refresh();},refresh:function K(){J.call(this);}});D.PENDING=N;D.FAILED=E;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.locales","mstrmojo.array","mstrmojo.date","mstrmojo.string","mstrmojo.android.ui.CalendarMarkupBuilder");var H=mstrmojo.array,E=mstrmojo.hash,L=mstrmojo.locales.datetime,I=L.dayNames_FULL,K=mstrmojo.string,G='<div class="clearingDiv"></div>',J="<div {@attr}>",C="</div>",F="mstrmojo-CalendarMV-";function A(N){var O=[],M=-1;E.forEach(N,function(Q,P){O[++M]=P+'="'+Q+'"';});return O.join(" ");}mstrmojo.android.medium.ui.CalendarMarkupBuilder=E.copy({getHeaderHTML:function B(Q,P){var O=[],N=-1,M=new Date(P,Q-1);O[++N]=K.apply(J,{attr:A({"class":F+"MonthLabel"})});O[++N]=mstrmojo.locales.datetime.MONTHNAME_SHORT[M.getMonth()]+" "+M.getFullYear()+C;H.forEach(I,function(R,S){O[++N]=K.apply(J,{})+R.substring(0,3)+C;});O[++N]=G;return O.join("");},getContentHTML:function D(S,O,P){var Q=[],N=-1,M=new Date(S.y,S.m),R=(new Date(O.y,O.m));P.showAddlWeek=true;while(M<=R){Q[++N]=K.apply(J,{attr:A({m:M.getMonth()+1,y:M.getFullYear(),"class":F+"Container"})});Q[++N]=K.apply(J,{attr:A({"class":F+"DatesList"})});Q[++N]=this.getSingleMonthHelper(M.getMonth(),M.getFullYear(),P);Q[++N]=C;Q[++N]=G;Q[++N]=C;M.setMonth(M.getMonth()+1);}Q[++N]=G;return Q.join("");}},E.copy(mstrmojo.android.ui.CalendarMarkupBuilder));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.TouchScroller");var d=mstrmojo.array.forEach,S=mstrmojo.hash.forEach,Y=mstrmojo.dom;function M(f,g){var e;for(e in f){Y.translate(f[e],g[0],g[1],g[2]);}}function P(f){var e=Math.abs;return{x:(e(f.accelDelta.x)<e(f.accelDelta.y)),y:(e(f.accelDelta.y)<e(f.accelDelta.x))};}function I(f,g){f.raiseEvent({name:"scrolledOut",value:g.value,axis:g.axis,direction:g.direction});}function O(f,k,p,l,q,e,j,g){var o=new mstrmojo.TouchScroller({scrollEl:f,vScroll:p,hScroll:l,frameRate:q,showScrollbars:e,offset:k,origin:{x:0,y:0},bounces:false,useTranslate3d:false,indicatorEl:g});if(j){o.friction=j;}return o;}function B(e){var f;for(f in e){if(e[f].decelerating){e[f].stopDeceleration();}}}var Q={x:false,y:false};function T(){var e=Q;if(!e.x){return"x";}if(!e.y){return"y";}return null;}var N={x:false,y:false};function L(h,j){var f=T(),g=h.scrollerConfig.scrollPast;if(!f||!g){return !!f&&!g;}function e(o){var k=h.viewport,l=h._TSN[o],t=h._scroller[o],w=h.tPos[o],p=j[o],x=N[o],q=(o==="x")?"y":"x",AA=h._scroller[q],z=N[q],s;if(!AA[0].decelerating&&z){e(q);}if(w<=0&&p>0){if(!x){if(z){return false;}M(l,[0,0,0]);for(s in t){t[s].scrollEl=k;}N[o]=true;}}else{if(x){M([k],[0,0,0]);for(s in t){t[s].scrollEl=l[s];}N[o]=false;}}return true;}return e(f);}function E(o,e){var j=e.axis,h=o.scrollboxHeightFixed,l=e.name;if(o.ss){var k=o.zones._BR.getRowInfoByPosition(e[j]);k.position=e[j];o.ss.onMove(k);}o.tPos[j]=e[j];if(l==="scrollDone"){S(o._scroller,function(p){d(p,function(q){q.toggleScrollBars(false);});});if(!L(o,e)){return true;}}if(j==="y"){var g=function(p){if(!o._isDownloading&&(-p<=o._TMAX[j])){if(o.onScrolledToLastRow){o.onScrolledToLastRow();}}};if(l==="scrollDone"){delete o._isDecelerating;if(o._cachedDownload){o.dataDownloaded();}else{g(e.y);}if(h){var f=e.y;o.notifyScrollListeners({x:e.x,y:Math.max(f,0)});}}else{if(l==="scrollDecel"){o._isDecelerating=true;g(e.fY);if(h){o.notifyScrollListeners({x:e.fX,y:e.fY});}}else{if(l==="scrollOut"){o._isDecelerating=true;g(e.y.position);}}}}}function H(h,g){var e=Math.abs,j={};var f=j[g]={start:h._TMIN[g],end:e(h._TMAX[g])};j.scrollPast=h.scrollerConfig.scrollPast;if(g==="y"){if(h.useSeamlessIncFetch){f.incFetch=!h.endFetching;f.pageSize=h.scrollboxHeight-((parseInt(h.gridData.rh,10)||25)*4);}}return j;}function V(e){e._scroller={x:[],y:[]};var f=e._viewportCoords;S(e._TSN,function(j,k){var p=H(e,k),l=(k==="y"),o=(k==="x"),g=j.length;d(j,function(w,t){var s=O(w,p,l,o,e.frameRate,(t===g-1)&&e.scrollerConfig.showScrollbars,e.scrollerFriction,e.domNode);s.updateScrollBars(f,e.domNode);e._scroller[k][t]=s;});var q=e._scroller[k][0],h=["scrollDone","scrollMoved"];if(q){if(l){h=h.concat(["scrollDecel","scrollOut"]);}d(h,function(s){q.attachEventListener(s,e.id,function(t){t.axis=k;E(e,t);});});}});}function A(f){if(this.hasRendered){this[f+"Limit"]=parseInt(this[f],10);if(this.zones){var e=this;window.setTimeout(function(){if(e.hasRendered){e.setOffsets();e.setupScrollers();}},0);}}}mstrmojo._HasXtabTouchScroll=mstrmojo.provide("mstrmojo._HasXtabTouchScroll",{noScrolling:false,useTouchScrolling:true,scrollerConfig:{showScrollbars:false,scrollPast:false},_TSN:null,tPos:{x:0,y:0},_TMIN:{x:0,y:0},setupTNs:function R(){this._TSN.x=this._TSN.y=[this.domNode];},touchBegin:function W(j){if(!this.noScrolling){j.stop();if(!this._isDownloading){if(this.toolbarMgr){this.toolbarMgr.closeToolbar();}var h=this._scroller,f=this._TMIN,e=this._TMAX;S(this.tPos,function(k,l){if(k>=f[l]&&k<=Math.abs(e[l])){B(h[l]);}});}var g=this._scroller.x;S(g,function(k){k.origin.x=g[0].origin.x;});}return true;},touchSwipeBegin:function U(l){if(this.noScrolling){return this.bubbleTouchEvent(l);}if(this._isDownloading){return false;}Q=P(l);var g=Q.y?"x":"y",e=this._scroller[g][0],j=e.offset,h=j[g][l.direction[g]?"end":"start"];if(!j.scrollPast&&h===e.origin[g]){var k=this.bubbleTouchEvent(l);if(k!==undefined){return k;}}var f=this._scroller;if(!L(this,l.delta)){return true;}if(!Q.x){B(f.x);}if(!Q.y){B(f.y);}S(this._scroller,function(p,o){if(!Q[o]){d(p,function(q){q.toggleScrollBars(true);});}});return true;},touchSwipeMove:function D(f){if(!L(this,f.delta)){return true;}var e=this._scroller;d(["x","y"],function(g){if(!Q[g]){S(e[g],function(h){h.scroll(f);});}});},touchSwipeEnd:function X(l){var f=Q,h=null,k=l.delta,j=l.direction;if(!f.x&&k.x!==0){h="x";j=j.x?"left":"right";}if(!f.y&&k.y!==0){h="y";j=j.y?"up":"down";}if(h){I(this,{axis:h,value:this.tPos[h],direction:j});var e=this._scroller[h],g;if(!f[h]){for(g in e){e[g].scrollEnd(l);}}}},gridPagesRendered:function C(){if(this._super){this._super();}this.setOffsets();},renderEmptyGrid:function F(){if(this._super){this._super();}this.noScrolling=true;},postBuildRendering:function a(){if(this._super){this._super();}if(this.zones&&!this.gridData.eg){var e=this;window.setTimeout(function(){if(e.hasRendered){e._TSN={x:[],y:[]};e.setupTNs();e.setupScrollers();}},0);}},setOffsets:function b(){var h=this,g=this.domNode,f=this.zones,k=f._TR,e=f._BL,j=(!this.isFullScreenWidget&&this.isDocXtab),l=this._viewportCoords={top:k?k.cp.rc*parseInt(this.gridData.rh,10):0,right:j?this.widthLimit:parseInt(this.width,10),bottom:j?this.heightLimit:parseInt(this.height,10),left:e?e.totalColWidth:0};S(this._scroller,function(p,o){d(p,function(q){q.offset=H(h,o);q.updateScrollBars(l,g);var s=q.origin;if(s){q.scrollTo(s.x,s.y);}});});},setupScrollers:function G(){var g=this.gridData,f=this._TMAX,e=this.noScrolling=((g&&g.co)||(!this.scrollerConfig.scrollPast&&f.x===0&&f.y===0));if(!e&&!this._scroller){N={x:false,y:false};M(this._TSN.x,[0,0,0]);M(this._TSN.y,[0,0,0]);V(this);}},onwidthChange:function K(){A.call(this,"width");if(this._super){this._super();}},onheightChange:function J(){A.call(this,"height");if(this._super){this._super();}},unrender:function Z(e){S(this._scroller,function(f){d(f,function(g){g.destroy();});});delete this._scroller;if(this._super){this._super(e);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller");var C={v:{axis:"y",dimension:"height"},h:{axis:"x",dimension:"width"}};mstrmojo.android._IsIncFetchList=mstrmojo.provide("mstrmojo.android._IsIncFetchList",{_mixinName:"mstrmojo.android._IsIncFetchList",supportsIncFetch:true,ifDataHelper:null,ifDirection:"v",supportedEdges:mstrmojo.TouchScroller.EnumIncFetchEdges.end,initScroller:function B(E){this._super(E);var F=this.ifDataHelper;if(F){E.attachEventListener("incFetch",this.id,function(G){if(!this.supportsIncFetch){return ;}var H=this;F.next({success:function(J,I){H.addItems(I||J.items);H._scroller.STATUS_INC_FETCH=false;},failure:function(I){mstrmojo.alert("Error in fetching next: "+I);}},G.edge);});}},updateScrollerConfig:function D(){var E=this._super(),I=this.supportsIncFetch,F=this.ifDirection,H=C[F];if(E[F+"Scroll"]){var G=E.offset[H.axis];G.incFetch=I;G.supportedEdges=this.supportedEdges;G.pageSize=I?(parseInt(this[H.dimension],10)-100):0;this.scrollerConfig=E;}return E;},addItems:function A(E){this._super(E);this.supportsIncFetch=((this.ifDataHelper.totalSize===-1)||(this.items.length<this.ifDataHelper.totalSize));if(this.updateScroller){this.updateScroller();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.TouchScroller");var E=mstrmojo.dom,A=Math;function F(K,L){return(L)?A.max(A.min(A.round(K),L.end),L.start):K;}mstrmojo._NeedSyncScroller=mstrmojo.provide("mstrmojo._NeedSyncScroller",{init:function J(K){if(this._super){this._super(K);}if(!this.lisenters){this.lisenters=[];}},initScroller:function H(K){if(this._super){this._super(K);}this._scrollMovedListener=this._scroller.attachEventListener("scrollMoved",this.id,function(L){this.onScrollMoved(L);});this._scrollDoneListener=this._scroller.attachEventListener("scrollDone",this.id,function(L){this.onScrollDone(L);});},onScrollMoved:function B(K){if(this._super){this._super(K);}this.syncScroller(K,true);},onScrollDone:function G(K){if(this._super){this._super(K);}this.syncScroller(K,false);},syncScroller:function C(O,N){if(!O||O.x==undefined||O.y==undefined){return ;}var M=this.lisenters,L=this.lisenters.length;for(var P=0;P<L;P++){var K=M[P]._scroller,Q=K.offset;K.origin={x:K.hScroll?O.x:0,y:K.vScroll?O.y:0};E.translate(K.scrollEl,-K.origin.x,-K.origin.y,0,K.transform,K.useTranslate3d);K.toggleScrollBars(N);mstrmojo.hash.forEach(K._scrollBarEls,function(b,W){var h=(W==="x"),a=O[W],R=b.length,d=b.ratio,Y=b.viewportSize,V=6/R,U=b["base"+((h)?"Left":"Top")],Z=U+Y-R,T=A.round(U+(d*a));if(T<U){T=U-a;R+=a;}else{if(T>Z){var g=(a-K.offset[W].end)*d;T=A.min(Z+g,Y+U-6)-1;R-=g;}}var f=0,S=[f,f,f],X=[1,1,1],e=(h)?0:1;S[e]=(T-U);X[e]=A.min(A.max(R/b.length,V),1);E.translate(b,S[0],S[1],S[2]," scale3d("+X.join(",")+")");});}},addSyncScroller:function D(K){this.lisenters.push(K);},destroy:function I(){this.lisenters=null;if(this._scrollDoneListener){this._scroller.detachEventListener(this._scrollDoneListener);delete this._scrollDoneListener;}if(this._scrollMovedListener){this._scroller.detachEventListener(this._scrollMovedListener);delete this._scrollMovedListener;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller","mstrmojo.hash");var H=mstrmojo.hash;mstrmojo._HasTouchScroller=mstrmojo.provide("mstrmojo._HasTouchScroller",{_meta_usesSuper:true,scrollerConfig:{},allowTouchBubble:true,scrollerSetupDelay:undefined,init:function M(S){this._super(S);this.scrollerConfig=H.clone(this.scrollerConfig);},updateScrollerConfig:function P(){return this.scrollerConfig;},updateScroller:function F(V,W){var S=this._scroller;if(S){var T=this.updateScrollerConfig();S.initScroller(T);if(!V){var U=T.origin;if(U){S.scrollTo(U.x,U.y,W);}}S.updateScrollBars();}},initScroller:mstrmojo.emptyFn,useSelectScroll:false,postBuildRendering:function Q(){var S=this._scroller;if(!S){S=this._scroller=new mstrmojo.TouchScroller();this.initScroller(S);}else{S.haltScroller();}if(!this.layoutConfig){var U=this,T=this.scrollerSetupDelay;if(!isNaN(T)){window.setTimeout(function(){U.updateScroller();},T);}else{this.updateScroller();}}if(this._super){this._super();}},afterLayout:function G(){this._super();this.updateScroller();},getScrollPos:function A(){return H.copy(this._scroller.origin||{x:0,y:0});},shouldTouchBubble:function I(V){if(!this.allowTouchBubble){return false;}var S=this._scroller,U=V.isVertical,T=(U)?"y":"x";return(!S[((U)?"v":"h")+"Scroll"]||S.offset[T][V.direction[T]?"end":"start"]===S.origin[T]);},touchBegin:function L(S){this._scroller.haltScroller();return(this._super&&this._super(S))||true;},touchSwipeBegin:function J(S){if(this.shouldTouchBubble(S)){if(this.bubbleTouchEvent(S)===false){this._touchCanceled=true;}return ;}if(this._super){this._super(S);}this._scroller.toggleScrollBars(true);},touchSelectBegin:function B(S){if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeBegin(S);}},touchSwipeMove:function C(S){if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scroll(S);},touchSelectMove:function E(S){if(!this._touchCanceled){if(this._super){this._super(S);}}if(this.useSelectScroll){this.touchSwipeMove(S);}},touchSwipeEnd:function N(S){S.evt.handled=true;if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scrollEnd(S);},touchSelectEnd:function K(S){if(this._touchCanceled){return ;}if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeEnd(S);}},touchEnd:function D(S){if(this._touchCanceled){delete this._touchCanceled;return ;}if(this._super){this._super(S);}},unrender:function O(T){var S=this._scroller;if(S){S.unrender();}delete this.scrollerConfig.scrollEl;this._super(T);},destroy:function R(){if(this._scroller){this._scroller.destroy();delete this._scroller;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller","mstrmojo.dom");var I=0,L=1,K=2,T=3,J="CellInfo",V="Drill",S="Link",D=25,B=40,H=55,E=6,C=4,O=false,N="InfoViewer-Tab",G="InfoViewer-TabWrapper",U="InfoViewer-nTab",P="showAll",F="drillTo",M="linkTo",R="glow",Q=mstrmojo.css,A=[];A[N]=A[U]=function(Z){var X=Z.className;if(X==N){X=Z.parentNode.className;}for(var Y=0,W=this.tabs.length;Y<W;Y++){if(X.indexOf(this.tabs[Y].name)>-1){this.setCurrentTab(Y);break;}}this.xtab.magnifier.resizeAndPosition();};A[F]=function(){mstrApp.closeDialog();this.xtab.controller.onDrill(this.xtab,this.drillPaths[0].act);};A[M]=function(W){mstrApp.closeDialog();this.xtab.controller.onLink(this.xtab,this.linkPaths[W.getAttribute("lnk")].act);};A[P]=function(W){this.tabs[this.currentTabIndex].expanded=true;Q.removeClass(this.xtab.magnifier.containerNode,"hideMore");this.xtab.magnifier.resizeAndPosition();};mstrmojo.XtabMagnifierHelper=mstrmojo.declare(mstrmojo.Obj,null,{xtab:null,cellInfo:null,selectedCell:null,drillPaths:null,linkPaths:null,tabs:[],currentTabIndex:0,init:function(X){this._super(X);O=mstrApp.isTablet();var W=mstrMobileApp.getDeviceDPI();if(W<=120){B=26;H=35;D=15;}else{if(W<=160){B=35;H=46;D=20;}else{if(W<=213){B=46;H=61;D=26;}else{if(W<=240){B=53;H=69;D=30;}else{B=70;H=92;D=40;}}}}if(!O){C=3;}this.titleHeight=H;},glowOnTap:function(a){var Y=[G,P,F,M],X=a.className;if(X==N){a=a.parentNode;X=a.className;}for(var Z=0,W=Y.length;Z<W;Z++){if(X.indexOf(Y[Z])>-1){Q.addClass(a,R);setTimeout(function(){Q.removeClass(a,R);},200);break;}}},handleTouchTap:function(W){this.glowOnTap(W);for(n in A){if(W.className.indexOf(n)>-1){A[n].call(this,W);}}},handleTouchSwipe:function(d){if(!O){var Y=d.direction.x,b=d.delta,X=this.currentTabIndex,Z=this.tabs.length,W=parseInt(this.xtab.magnifier.width,10),a=isNaN(W)?50:W*0.2;if(Math.abs(b.x)>a){if(b.x>0){X=(X+Z-1)%Z;}else{X=(X+Z+1)%Z;}if(X!=this.currentTabIndex){this.setCurrentTab(X);this.xtab.magnifier.resizeAndPosition();}}}},resolveTouchEvent:function(a){var f=a.pageX,e=a.pageY,Y=document.elementFromPoint(f,e),g=this.xtab,W=g.zones,X,d;while(Y){var b=Y.className;if(!X&&Y.tagName==="TD"&&b&&b.toLowerCase().indexOf("xtab-td")>=0){X=Y;}if(/mstrmojo-XtabZone/.test(b)){for(var Z in W){if(Y==W[Z].domNode){d=W[Z];}}break;}Y=Y.parentNode;}if(X&&d){return{cell:X,zone:d,pos:{x:f-D,y:e-D,w:D*2,h:D*2}};}return null;},resolveInfoToDisplay:function(p){var g=p.cell,AE=p.zone,AI=this.xtab,b=AI.lockHeadersCase,t=parseInt(g.getAttribute("r"),10),Y,d,f,AB,e,AG,h,q,AF,a,AB,x,AA,AD,w,W,X=[],AH=this,s=function(AJ,k,j){if(j){AH.selectedCell=k;X.unshift({title:AJ,value:k});}else{X.push({title:AJ,value:k});}};delete this.selectedCell;if(b==I||b==L){t=t-(Math.max(AI.titlesCP.rc,AI.chsCP.rc)||0);}else{if(AE.slot=="_TR"||AE.slot=="_TL"){t=-1;}}if(t<0){Y=AI.getCellForNode(g);if(Y&&Y.o!==undefined){s(AI.model.getCellTitleInfo(Y).title,Y,true);}else{return null;}}else{d=AI.rhsCP.getUnmergedCells(t)||[];f={rh:d.concat(AI.rhsCP.getRowCells(t)),vs:AI.valuesCP.getRowCells(t),ch:[]};for(AB=0,x=AI.chsCP.rc;AB<x;AB++){f.ch.push(AI.chsCP.getRowCells(AB));}e=g.cellIndex;if(b==I||b==K||AE.slot=="_BL"){if(g.parentNode.sectionRowIndex===0){AG=e;}else{AG=e+d.length;}}else{AG=e+f.rh.length;}h=f&&f.rh.length;if(AG>=h){AG-=h;for(AA=0,AD=f.ch.length;AA<AD;AA++){q=0;for(w=0,W=f.ch[AA].length;w<W;w++){AF=f.ch[AA][w];a=(AF&&AF.cs)||1;if((AG>=q)&&(AG<q+a)){if(AF.mix!==undefined){s(AF,f.vs[AG],true);}else{if(AF.ui!=null||AF.tui!=null){s(AI.model.getCellTitleInfo(AF).title,AF);}}break;}q+=a;}}if(!this.selectedCell){s(null,f.vs[AG],true);}AG=-1;}for(AB=0,x=h;AB<x;AB++){AF=f.rh[AB];s(AI.model.getCellTitleInfo(AF).title,AF,AB==AG);if(AB==AG){break;}}}this.cellInfo=X;if(this.cellInfo){this.tabs=[];this.tabs.push({name:J,label:mstrmojo.desc(10638,"Info"),expanded:false,content:this.cellInfo});var Z=this.selectedCell,l=(Z.v!==undefined)&&!!(Z.at&1),o=!!(Z.at&4);if(l){this.drillPaths=[];this.drillPaths.push({n:AI.model.getCellDrillsInfo(Z).n,act:AI.model.getDrillAction([Z])});this.tabs.push({name:V,label:mstrmojo.desc(145,"Drill"),expanded:false,content:this.drillPaths});}else{this.drillPaths=null;}if(o){this.linkPaths=[];var z=AI.model.getCellLinksInfo(Z);for(var AB=0,AC=z.links.length;AB<AC;AB++){this.linkPaths.push({n:z.links[AB].n,act:AI.model.getLinkAction(Z,AB)});}this.tabs.push({name:S,label:mstrmojo.desc(8149,"Link"),expanded:false,content:this.linkPaths});}else{this.linkPaths=null;}}return this.cellInfo;},createTitle:function(Y){var Z=[],b=0,a=this.tabs,X=a.length,d,W;for(;b<X;b++){d=a[b];if(O){Z.push('<div class="',G," ",d.name,'" style="height:'+(H-E)+'px;" >');Z.push('<div class="',N,'">',d.label,"</div>");Z.push("</div>");}else{Z.push('<div class="',U," ",d.name,'" >',d.label,"</div>");}}Y.style.lineHeight=Y.style.height=H+"px";Y.innerHTML=Z.join("");this.setCurrentTab();},createContent:function(d){var Y=this.cellInfo,W=this.drillPaths,X=this.linkPaths,b=[],g=[],f=this.xtab,Z=function(h,k,j){function o(w,s){var p=[],q=(s==="value"&&!O)?B/2:B;p.push('<td><div class="',s,'" style="line-height:',q,"px;max-height:",B,'px;" >');if(w){if(w.ts==4){var l=(w.n||w.v),t=f.controller&&f.controller.model&&f.controller.model.dataService;if(t&&t.getImage){l=t.getImage(l);}p.push('<img src="'+l+'"/>');}else{p.push(w.n||w.v||"&nbsp;");}}p.push("</div></td>");return p.join("");}g.push('<tr style="height:',B,'px">',o(h,"title"),o(k,"value"),"</tr>");},a,e;if(Y==null){return ;}for(a=0,e=Y.length;a<e;a++){Z(Y[a].title,Y[a].value);}b.push('<table class="content">');b.push(g.join(""));b.push("</table>");if(W){b.push('<div class="actionMenu hide">');for(var a=0,e=W.length;a<e;a++){b.push('<div class="drillTo" style="line-height:',B,'px">',W[a].n,"</div>");}b.push("</div>");}if(X){b.push('<div class="actionMenu hide">');for(var a=0,e=X.length;a<e;a++){b.push('<div class="linkTo" style="line-height:',B,'px" lnk="',a,'">',X[a].n,"</div>");}b.push("</div>");}b.push('<div class="',P,'" style="line-height:',B,'px" >'+mstrmojo.desc(8995,"See all...")+"</div>");d.innerHTML=b.join("");},setCurrentTab:function(g){var X=g||0,f=this.tabs,Y=f[X],W=f.length,d=this.xtab.magnifier,f=d.titleNode.children,Z=d.containerNode.children,b,e,a;this.currentTabIndex=X;for(b=0;b<W;b++){Q.toggleClass(f[b],"selected",b==X);if(!O){if(W<=2){Q.toggleClass(f[b],"left",b!=X);}else{Q.toggleClass(f[b],"left",b==(X+W-1)%W);}Q.toggleClass(f[b],"right",b==(X+W+1)%W);}}for(b=0,e=Z.length-1;b<e;b++){Q.toggleClass(Z[b],"hide",b!=X);if(b==X){this.contentNode=Z[b];}}Q.toggleClass(d.containerNode,"hideMore",!Y.expanded&&Y.content.length>C);},getContentHeight:function(){function a(d){var e=d.content,f=e.length,b=d.expanded;return(!b&&f>C)?(B+1)*(C+1):(B+1)*f;}var Z=this.tabs;if(O){return a(Z[this.currentTabIndex]);}else{var X=0;for(var Y=0,W=Z.length;Y<W;Y++){X=Math.max(a(Z[Y]),X);}return X;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var a=1,P=2;var C=2,H=4;var S=1,K=4;function F(b,d){return b[((d===a)?"row":"col")];}function A(b,e){var d=e.lm;return d&&d[b.mix||0];}function G(b,e){var d=e.dp;return d&&d[b.mix||0];}function V(w,l,d){var p=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:l.daMode});var j=l.ans,h=j&&j.length;if(h){var s=p.prms=[],AF=0;for(AF=0;AF<h;AF++){var AD=j[AF];var AC=AD.pid,AE=parseInt(AD.m,10),x={id:AC,am:AE,pt:AD.pt};s.push(x);if(AD.po){x.orid=AD.po.did;x.ortp=AD.po.t;}switch(AE){case p.DO_NOT_ANSWER:case p.CLOSE:case p.USE_DEFAULT_ANSWER:case p.SAME_PROMPT:break;case p.STATIC:var AG=AD.es,o=(AG&&AG.length)||0,q;x.pa={es:[]};for(q=o-1;q>=0;--q){var AA=AG[q];x.pa.es.push({ei:AA.id,disp_n:AA.n,emt:1});}break;case p.DYNAMIC:case p.ALL_VALID_UNITS:case p.CURRENT_UNIT:var e=AD.dunits;if(e&&e.length&&d){var b=x.pa={};var t=d,k=(d.mix!==undefined)&&(d._lp||d._tp);if(k){t=d._lp||d._tp;}var g=parseInt(t.axis,10);while(t){var AH=this.getPTitle(t,g);if(AH&&mstrmojo.array.find(e,"id",AH.id)>=0){if(AE!==p.DYNAMIC){b.a={id:AH.id,n:AH.n,dispForms:AH.dfi};}if(AD.pt===1){b.v=t.v;break;}else{var AB=t._e.id,f=t._e.n;b.es=[];b.es.push({ei:AB,emt:1,disp_n:f});}if(AE===p.CURRENT_UNIT){break;}}t=this.getPCellParentNode(t,g);if(k&&!t&&g===a){g=P;t=d._tp;}}}break;}}}return p;}function N(e){var d=this.getCellTitleInfo(e[0]),g=[],j=function(k){if(k){if(mstrApp.useBinaryFormat){if(k._e){g.push(k.axis+"A"+(k.ui+1)+"A"+k._e.id);}j(k._p);}else{g.push(k.axis+"A"+(k.ui+1)+"A"+k.o);}}},f,b;if(!d.isSrcTitle){for(f=0,b=e.length;f<b;f++){var h=e[f];if(h.mix!==undefined&&(h._lp||h._tp)){j(h._lp);j(h._tp);}else{j(h);}}}return(mstrApp.useBinaryFormat)?g:g.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function O(){return this.data.mid;},getCellTitleInfo:function W(d,g){var e=g?g.gts:this.data.gts;var f=null;if(d.mix===undefined){f=F(e,d.axis)[d.tui||d.ui];}else{var b=function(k){var h=(k&&k.length)||0,j;for(j=h-1;j>=0;--j){if(parseInt(k[j].otp,10)===-1){return k[j];}}return null;};f=b(e.col)||b(e.row);}return{isSrcTitle:(d.o===undefined),title:f};},getCellLinksInfo:function Y(d,e){if(!e){var b=this.getCellTitleInfo(d);e=b&&b.title;}return A(d,e);},getCellDrillsInfo:function E(d,e){if(!e){var b=this.getCellTitleInfo(d);e=b&&b.title;}return G(d,e);},getLinkDrillAction:function L(b){return this.getActionObject(b);},getAction:function R(b){return this.getActionObject(b);},getActionObject:function I(d){var b=d[0]&&d[0].at,e=null;if(b){if(b&K){e={h:"onLink",a:this.getLinkAction(d[0])};}else{if(b&S){e={h:"onDrill",a:this.getDrillAction(d)};}}}return e;},getSortAction:function D(w,l){var g=this.getCellTitleInfo(w),q=g.title,t=this.data.gts[((w.axis===a)?"row":"col")+"SubPos"],b=[],f=q.axis,j,p,o,s;l=(l===null||l===undefined)?!(w&&w.so):l;if(g.isSrcTitle){j=C;p=q.id;o=q.otp;s=q.fid;}else{j=H;o=4;f=a;t=this.data.gts.rowSubPos;do{var k=w._e;if(k){if(k.oid){p=k.oid;}else{b.push(k.id);}}w=w._p;}while(w);}var h={sortType:j,axis:f,isAsc:l,unitID:p,unitType:o,elementList:b.join("\u001E"),subTotalsPos:t};if(p){h.unitID=p;}if(s){h.formId=s;}var d;if(j===H){d=["","",h.elementList||"",h.axis];}else{d=[h.formId,"21"];}d=[h.unitType,h.unitID].concat(d);h.sortKey=d.join("!");return h;},getPivotAction:function J(t,e){var q=false,w=t.hasOwnProperty("mix"),b=(w)?null:t.axis,s=((w)?t.mix:t.ui)+1,d=(t.otp===-1);if(!isNaN(e)){b=e;s=1;if(w){w=false;d=true;}}else{var j=(e==="u"||e==="l");if(!w){var h=F(this.data.gts,b),g=0,f={},l=false;mstrmojo.array.forEach(h,function(x){if(f[x.id]){f[x.id].frm++;}else{g++;f[x.id]={pos:g,frm:1};if(x.id===t.id){l=true;}else{if(l){return false;}}}});s=f[t.id].pos;var o=t.fix;if(o){if(!j||o>1){if(j||o!==f[t.id].frm){s=o;q=true;}}}}s=s+((j)?-1:1);}var k={pos:s};if(q){k.formID=t.fid;}else{if(!w){k.axis=b;}}if(!d){var p=(w)?t._e:t;if(!q){k.objectType=p.otp;}k.objectId=(w)?p.oid:t.id;}return k;},isPvtButtonVisible:function X(k,e){var g=k.axis,f=F(this.data.gts,g),d=k.hasOwnProperty("mix");if(!isNaN(e)){if(parseInt(e,10)===g){return false;}if(d){return !!f[k.ui]._hid;}return true;}var h=f[k.ui].es,j=k.ui,b=(d)?h.length:f.length;if(b===1){return false;}if(g===((d)?P:a)){if(e==="u"||e==="d"){return false;}}else{if(e==="l"||e==="r"){return false;}}if((d)?k._e===h[0]:j===0){if(e==="l"||e==="u"){return false;}}if(d?k._e===h[b-1]:j===b-1){if(e==="r"||e==="d"){return false;}}return true;},getDrillAction:function B(d){var b=this.getCellTitleInfo(d[0]),f=b.title,e=f.dp[d[0].mix||0];return{srcMsgId:this.data.mid,isWithin:e.within,drillPathKey:e.k,drillPathIndex:e.dpi,drillElements:N.call(this,d)};},getPTitle:function Z(e,d){var b=this.data.gts;return F(b,d)[e.tui];},getPCellParentNode:function M(d,b){return d._p;},getLinkAction:function Q(e,d){var b=this.getCellTitleInfo(e),f=b.title;return this.getLinkActionImpl(e,f,d);},getLinkActionImpl:function U(s,l,p){var e=A(s,l),o=e&&e.links,t=(e.onw)?"_blank":"";if(p===null||p===undefined){p=(e&&e.di)||0;}var h=o&&o[p];if(!h){return null;}var f={linkInfo:h,linkTarget:t};var b=h.url;if(b){var g="&CurrentElement";if(s&&l&&b.indexOf(g)>-1){b=b.replace(g,s._e.id);}f.url=b;}else{var j=h.target,q,d;switch(parseInt(j&&j.t,10)){case 55:if(parseInt(j.st,10)===14081){q=2048001;d="objectID";}else{q=32001;d="documentID";}break;case 3:q=4001;d="reportID";f.reportViewMode=((parseInt(j.st,10)===769)?2:1);break;default:return null;}f.evt=q;f[d]=j.did;f.srcMsgId=this.getMessageId();var k=V.call(this,e,h,s);if(k){f.link=k;}return f;}},getDownloadAction:function T(f,d,h,e,g,b){return{xtabId:g,rowPosition:f,maxRows:d,colPosition:h,maxColumns:e,memo:b};}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Model","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.DocDataService","mstrmojo.StringBuffer","mstrmojo.EnumReadystate");var p=mstrmojo.EnumRWUnitType,J=mstrmojo.EnumReadystate,t=mstrmojo.hash.forEach,O=mstrmojo.func.wrapMethods,a=mstrmojo.array;var AE={isObservable:function(AK){var AJ=AK&&AK.t;if(!AJ||!(AJ in this)||AK.scriptClass){return false;}return(AJ!==p.SUBSECTION||!AK.dt);},makeObservable:function(AJ){AJ.audibles=this[AJ.t]||{};if("readyState" in AJ.audibles){AJ.readyState=J.IDLE;}return new mstrmojo.Model(AJ);}};AE[p.PANELSTACK]={"*":false,selKey:true,readyState:true};AE[p.GRID]={"*":false,readyState:true,ds:true};AE[p.GRAPH]={"*":false,readyState:true,ds:true};AE[p.GRIDGRAPH]={"*":false,qsm:true,ds:true};AE[p.SUBSECTION]={"*":false,resize:true,adjustSize:true};AE[p.VISUALIZATION]={"*":false,ds:true};AE[p.SELECTOR]={"*":false,cek:true,ds:true};AE[p.MOJOVISUALIZATION]={"*":false,ds:true};function G(AN,AO){var AK=AN.layoutMap&&AN.layoutMap[AO];if(AK){return AK;}var AJ=AN.layouts,AM=(AJ&&AJ.length)||0,AL=0;for(AL=0;AL<AM;AL++){if(AJ[AL].k==AO){return AJ[AL];}}return null;}function H(AL,AN,AK){var AJ=G(AL,AN);if(AK==AN){AJ._lkz=AN;return AJ;}else{if(AJ){var AM=AJ.units[AK];if(AM){if(AM.t==p.GRIDGRAPH){if(!AJ.units[AK+"_0"]){AJ.units[AK+"_0"]={ck:AM.ck,fmts:AM.fmts.gd,txi:AM.txi,t:p.GRID};AJ.units[AK+"_1"]={ck:AM.ck,fmts:AM.fmts.gp,t:p.GRAPH};}}if(AE.isObservable(AM)){AM=AJ.units[AK]=AE.makeObservable(AM);}AM._lkz=AN;}}}return AJ&&AJ.units[AK];}function AI(AN,AM,AL,AJ){var AK=this.getChildren(AN,AM,0);return(mstrApp.isMobile?(mstrmojo.array.filter(AK,function(AQ){var AO=AL&&AL.indexOf(AQ.defn.t),AP=AQ.defn.dk;return AJ?(AO>-1&&AP===-1):(AO<0||AP!==-1);})):(AJ?[]:AK));}var k=function(AJ,AK){var AL=new mstrmojo.StringBuffer();if(AK){AL.append("*l"+AK);}AL.append("*k"+AJ.k);if("wid" in AJ){AL.append("*x"+AJ.wid);}AL.append("*t"+this.buildTime);return AL.toString();};function g(AL){var AK,AJ,AO=this.delta,AM=this.pendingUpdate,AN=[];if(!AM){AM=this.pendingUpdate={};}if(!mstrmojo.hash.isEmpty(AO)){AN.push("<updates>");for(AK in AO){if(AO.hasOwnProperty(AK)){AJ=AO[AK];AN.push(AJ.getUpdates());}}AM[AL]=AO;this.delta={};AN.push("</updates>");}return AN.join("");}function d(AM,AN){var AJ;if(AM){AM=AM.split(AN||"\u001E");for(var AL=0,AK=AM.length;AL<AK;AL++){AJ=AJ||{};AJ[AM[AL]]=H.call(this,this.defn,this.currlaykey,AM[AL]);}}return AJ;}function A(AL,AM){var AJ=AM.ulkeys,AK=AL.controller.view;if(AK&&AK.unloadLayouts&&AJ&&AJ.length){AK.unloadLayouts(AJ);}}function P(AK,AJ){var AL=this.getLayoutUnitDefn(AK,AJ);return(AL&&AL.t===p.PANELSTACK&&AL.ifw);}function l(AK,AJ){return !AJ||(AK.wid==AJ);}function K(){var AK=this.data&&this.data.layouts,AJ=AK[a.find(AK,"k",this.getCurrentLayoutKey())],AM=AJ&&AJ.gbys&&AJ.gbys.groupbys,AL=false;a.forEach(AM,function(AN){if(AN.unit&&AN.unit.elms&&AN.unit.elms[AN.unit.idx].v==="u;"){AL=true;return false;}});return AL;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true},features:null,dataCache:null,controller:null,sdp:null,init:function x(AJ){this._super(AJ);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();this.buildTime=mstrmojo.now();},makeObservable:function U(AJ){return AE.makeObservable(AJ);},getTargetDefn:function(AJ){return d.call(this,AJ);},getTargetInfoWin:function(AK){var AJ=[],AL=d.call(this,AK);if(AL){var AM;for(AM in AL){if(AL[AM]&&AL[AM].ifw){AJ.push(AM);}}}return AJ;},getUnitDefinitions:function(AJ,AK){return d.call(this,AJ,AK);},hasFeatures:function s(AN){var AL=this.features;if(!AL){return false;}var AK=AN.split(",");for(var AM=0,AJ=AK.length;AM<AJ;AM++){var AO=AK[AM],AP=AO.match(/^\!/);if(AP){AO=AO.replace("!","");}if(AP?this.features[AO]:!this.features[AO]){return false;}}return true;},ondefnChange:function h(){var AO=this.defn,AL=AO&&AO.layouts,AK={};if(AO){AO.layoutMap=AK;for(var AN=0,AM=AL&&AL.length||0;AN<AM;AN++){var AJ=AL[AN];AK[AJ.k]=AJ;}}},formatResolver:{getFormat:function L(AN,AM){var AL=((AN&&AN.fmts)||null);if(AM){var AP=AN.thresholds,AK=AP&&AP[AM];if(AK){var AO={},AQ;for(AQ in AL){AO[AQ]=AK[AQ]||AL[AQ];}for(AQ in AK){var AJ=AK[AQ];AO[AQ]=(typeof (AJ)==="string")?(AJ+" !important"):AJ;}AL=AO;}}return AL;}},getSelectedXtabStyles:function W(AL){var AK=AL||this.currlaykey;var AN={};var AJ=this.data&&this.data.layouts;for(var AM in AJ){if(AJ[AM].k===AK){AN=AJ[AM].xtabStyles;break;}}return AN;},getChildren:function z(AZ,AJ,AQ,AR,AP){var AU=this.currlaykey;if(AZ){var AM=AZ.defn;AU=(AM&&AM._lkz)||AZ.k;}var Ak=this.getLayoutDataCache(AU),Aa=(!AJ&&!mstrmojo.hash.isEmpty(Ak)),Ag;if(!AZ){Ag=this.data;}else{var AS=AZ.data||AZ;if(Aa){Ag=Ak[k.call(this,AS,AU)];Ag=(Ag&&Ag.data)||Ag||AS;}else{Ag=AS;}}var AK=Ag?(Ag.sections||Ag.subsections||Ag.objects||Ag.panels||Ag.layouts||Ag.children):[],AV=[];var Ad=(AK&&AK.length)||0;if(Ad){var AM=this.defn,AX=!AZ,AT=AZ?AU:null,AO=(AZ&&((AZ.defn)?AZ.defn.t:H.call(this,AM,AT,AZ.k).t));var AL=(AO===p.GRIDGRAPH),Ae=(AO===p.DETAILS);for(var Ac=AQ||0,Ab=(isNaN(AR))?Ad:Ac+AR;Ac<Ab;Ac++){var Ai=AK[Ac];if(AL){Ai.k=AZ.k;Ai.wid=AZ.data.wid;}var Al=Ai.k,AY=k.call(this,Ai,AT),Ah;if(!AX&&!AJ&&P.call(this,Al,AT)){var Af=this.getLayoutUnitDefn(Al),AW={data:Ai,defn:Af,id:AY,k:Al,p:Ag};Ak[AY]=AW;if(!this.infoWinByKey||!this.infoWinByKey[Al]){var AN=this.infoWindows=this.infoWindows||{};var Aj=this.infoWinByKey=this.infoWinByKey||{};AN[Af.n]=Aj[Al]=AW;}continue;}if(AL){AY+="_"+Ac;Ah=H.call(this,AM,AT,Ai.k+"_"+Ac);}else{Ah=H.call(this,AM,AT||Ai.k,Ai.k);}if(Ae){Ah.dt=true;}AV.push({k:Ai.k,id:AY,defn:Ah,data:Aa?(Ak[AY]&&Ak[AY].data)||Ai:Ai});}}return AP?{nodes:AV,total:Ad}:AV;},getInfoWindow:function q(AK){var AJ=this.infoWindows;return AJ&&AJ[AK];},getFixedHeaders:function(AK,AJ){return AI.call(this,AK,AJ,[p.PAGEHEADER],true);},getFixedFooters:function(AK,AJ){return AI.call(this,AK,AJ,[p.PAGEFOOTER],true);},getNonFixedSections:function(AK,AJ){return AI.call(this,AK,AJ,[p.PAGEHEADER,p.PAGEFOOTER],false);},getLayoutUnitDefn:function E(AK,AJ){return H.call(this,this.defn,AJ||this.currlaykey,AK);},getUnitInstance:function S(AJ,AK){return mstrmojo.all[k.call(this,{k:AJ,wid:AK},this.currlaykey)];},getFirstUnitInstanceByName:function o(AL){var AJ=G(this.defn,this.currlaykey);if(AJ){var AK=AJ.units;for(u in AK){var AM=AK[u];if(AM.n===AL){return this.getUnitInstance(u,1);}}}return null;},getSelectedKey:function AF(AJ){return(!AJ&&this.currlaykey)||null;},getCurrentLayoutKey:function AA(){return this.currlaykey;},getCurrentLayoutDef:function AC(){var AJ=this.defn&&this.defn.layouts;return AJ&&AJ[a.find(AJ,"k",this.currlaykey)];},replaceLayout:function C(AM,AN){var AK=this.dataCache;if(AK&&AK[AM]){AK[AM]={};}var AJ=(this.data&&this.data.layouts)||(this.defn&&this.defn.layouts);for(var AL=(AJ&&AJ.length-1)||0;AL>=0;AL--){if(AJ[AL].k===AM){break;}}this.bs=AN.bs;this.zf=AN.zf;if(AN.data){this.data.layouts[AL]=AN.data.layouts[AL];this.data.elems=AN.data.elems;}if(AN.defn){this.defn.layouts[AL]=AN.defn.layouts[AL];this.ondefnChange();}},loadLayout:function f(AJ,AL,AK){this.replaceLayout(AJ.currlaykey,AJ);this.raiseEvent({name:"rebuildLayout",unloadCache:!!AL,restoreIW:!!AK});},getTransactionUpdates:function AH(AJ){return this.txDiscardTargets?"":g.call(this,AJ);},clearTransactionUpdates:function AB(AJ){this.clearTxDeltaUpdate(AJ);},resetTransactionUpdates:function B(AJ){var AK=this.pendingUpdate,AL=this.delta;if(AK&&AK[AJ]){t(AK[AJ],function(AM,AN){if(AL&&!AL[AN]){AL[AN]=AM;}});delete AK[AJ];}},getDataService:function N(){var AL=this.dataService,AJ=this;if(!AL){var AK={rwb:this.bs,msgId:this.mid,model:this};if(mstrApp.modelFactory){AL=mstrApp.modelFactory.newDataService("Document",AK);}else{AL=mstrApp.viewFactory.newDocDataService(AK);}this.dataService=AL;this.disposables.push(AL);}return AL;},partialUpdate:function T(AL,AJ){var AK=this.updateDataCache(AL,AJ);this.raiseEvent({name:"partialUpdate",tree:AL,ids:AK});return AK;},transactionUpdate:function(AL,AK){if(!AL.data){return ;}var AN=this,AO;if(AK&&AK.tks){AO=d.call(this,AK.tks);}if(AL.pukeys){AO=d.call(this,AL.pukeys);var AP;for(AP in AO){if(AO[AP]&&AO[AP].cek){AO[AP].cek=null;}}}if(AL.txrcd){this.txrcd=AL.txrcd;}else{delete this.txrcd;}var AM=this.updateDataCache(AL.data,AO,AK&&AK.sid),AJ={name:"partialUpdate",tree:AL.data,ids:AM};if(!mstrmojo.hash.isEmpty(AM.ifws)){if(AK&&AK.type===p.GRID){AJ.anchor=AK.anchor;}else{AM.ifws={};}}this.raiseEvent(AJ);return AM;},deltaUpdate:function AG(AJ){var AK=this.delta;if(!AK){AK=this.delta={};}AK[AJ.id]=AJ;},clearTxDeltaUpdate:function V(AK){var AN=this.txDiscardTargets,AJ=!AN,AM=this.pendingUpdate,AL=this,AO;if(!AJ){t(AN,function(AP,AQ){if(AL.delta&&AL.delta[AQ]){AL.delta[AQ].clear();delete AL.delta[AQ];}});}if(AM&&AM[AK]){t(AM[AK],function(AP){AP.clear();});delete this.pendingUpdate[AK];}},sendTransactionActions:function w(AK,AJ,AM){var AL=this,AN;if(!AM){AM={success:function(AO){AL.transactionUpdate(AO);}};}AL.getDataService().sendTransactionActions({keyContext:AK,actions:AJ,txrcd:this.txrcd},AM);},addSDP:function D(AK,AJ){if(!AK||!AJ){return ;}if(!this.sdp){this.sdp={};}this.sdp[AK]={k:AJ.k,visName:AJ.visName};},removeSDP:function Z(AJ){if(!AJ||!this.sdp[AJ]){return ;}delete this.sdp[AJ];},slice:function R(AW){try{if(!AW||(!mstrmojo.dom.isAndroid&&!AW.tks&&!AW.multiSelect&&(AW.type===3||(AW.type===p.GRAPH&&AW.tty!=1)))){return ;}var AL=null,Ae=this,AZ=this.getDataService(),Af=AW.tks?d.call(this,AW.tks):null,AY=Af,Ad=function(Ag){t(AY,function(Ah,Ai){if(Ah&&Ah.set){Ah.set("readyState",Ag);}});},Ac=function(Ag,Ah){return mstrmojo.all[k.call(Ae,{k:Ag,wid:Ah},Ae.currlaykey)];},AP=this.newCallback({method:"slice",submission:function(){Ad(J.WAITING);},success:function(Ah){if(AW.disablePU){Ae.loadLayout(Ah,AW.isUConDS,AW.restoreIW);return ;}if(Ah.pukeys){Af=d.call(Ae,Ah.pukeys);}A(Ae,Ah);AL=Ae.updateDataCache(Ah.data,Af,AW&&AW.sid);if(typeof (Ah)=="object"){mstrmojo.hash.copyProps(["bs","exopt","dty"],Ah,Ae);}var Ag={name:"partialUpdate",tree:Ah.data,ids:AL};if(!mstrmojo.hash.isEmpty(Ag.ids.ifws)){if(AW&&!AW.suppressIW&&(AW.type===p.GRID||AW.type===p.GRAPH)){Ag.anchor=AW.anchor;}else{Ag.ids.ifws={};}}Ae.raiseEvent(Ag);},complete:function(){Ad(J.IDLE);}});if(AW.type==3){var AX=AW.tks,AR=AW.eid;if(!AX){return ;}var AV=H(this.defn,this.currlaykey,AR);if(!AV){return ;}var AS=AR,AJ=Af[AX],AO=function(){AJ.set("selKey",AR);},AN;AJ.newSelKey=AR;if(AV.l){var Aa=AV.dirtyKeys;if(!!Aa){AS=mstrmojo.hash.keyarray(Aa).join(",");AY=Af=d.call(this,AS,",");AN=function(){AO();t(AL.upd,function(Ag,Ah){var Ai=mstrmojo.all[Ah];if(Ai&&Ai.setDirty){Ai.setDirty(false);}});};}else{AZ.setCurrentPanel(AR,AW.tks,AW.ck,this.newCallback({method:"slice",success:AO}));return ;}}else{AN=function(){AO();AV.l=true;};}var AT=AP.success;AP.success=function(Ak){var Ai=G(Ak.defn,Ae.currlaykey),Ao=G(Ae.defn,Ae.currlaykey),Al=function(Ap,Aq){for(var Ar in Aq){if(Ap[Ar]===undefined){Ap[Ar]=Aq[Ar];}}},An=Ai&&Ai.units,Am=Ao&&Ao.units,Ah=Ai&&Ai.cgbMap,Ag=Ao&&Ao.cgbMap;if(An){Al(Am,An);}if(Ah){Al(Ag,Ah);Ae.raiseEvent({name:"CGBMapChange",cgbMap:Ag});}AT(Ak);AN();var Aj=Ac(AW.tks,0);if(Aj){Aj.clearDirtyChild(AR);}};AZ.requestNewPanel(AR,AW.tks,AW.ck,AS,!AW.hasLoader,AP);}else{AP=O(AP,{success:function(Ag){t(AY,function(Ak,Ai){var Aj=Ac(Ai,1);if(!Aj){if(!!Ae.sdp&&!!Ae.sdp[Ai]){var Ah=Ae.getLayoutDataCache(Ae.getCurrentLayoutKey());var Al=k.call(Ae,{k:Ai,wid:1},Ae.currlaykey);Ae.raiseEvent({name:"secondaryDataSliced",key:Ai,data:Ah[Al].data});}return ;}if(AL&&!(Ai in AL.def)){if(Aj.setDirty){Aj.setDirty(true);}}else{if(Ak.t==p.PANELSTACK){Aj.setDirtyChildren();}}});}});var AM,AU;if(AW.type==p.GRAPH){AU="applyGraphSelectorAction";AM=[AW.ck,AW.cks,AW.sid,AW.x,AW.y,AP,Ae.zf];}else{if(AW.isMultipleEvents){AU="RWEventsTask";params={messageID:this.mid,styleName:"RWDocumentMojoStyle",events:AW.events};AM=[params,AP];}else{if("eid" in AW){AU=AW.isDocVis?"setDocVisSelectorElements":"setDocSelectorElements";AM=[AW.ck,AW.eid,AW.ctlKey,AW.include,AP,Ae.zf];var AQ=K.call(this);if(AW.isUConDS||AQ){AW.disablePU=true;AM=AM.concat([null,0,null,true]);}if(AQ){AW.restoreIW=true;}if(Ae.sdp){var AK={};t(Ae.sdp,function(Ah,Ag){if(Ae.sdp[Ag]){AK[Ag]=Ah.visName;}});AM[7]=JSON.stringify(AK);}AM[8]=AW.tks;}else{if(AW.multiSelect){if(AW.selectorObjects.length>0){AU="setMultiDocSelectorElements";AM=[AW.selectorObjects,AW.multiSelect,AP,Ae.zf];}}else{if("srct" in AW&&AW.srct==4){if(AW.onlyInclude){AU="setDocSelectorInclude";AM=[AW.ckey,AW.include,AP,AW.srcid,AW.srct,Ae.zf];}else{AU="setDocSelectorExpression";AM=[AW.ck,AW.ckey,AW.srcid,AW.srct,AW.f,AW.ft,AW.include,AW.cs,5,AP,Ae.zf];if(!AW.cs){AM[7]=null;AM[8]=null;if(AW.changeQual){AZ.setRWUnitProperties(AW.ckey,AW.ckey+"\u001FFormattingSelector\u001FMetricConditionType\u001F"+AW.qt,1,false,null);AM.push(AW.unset);}}}}else{if(AW.unset){AU="setDocUnsetSelector";AM=[AW.ck,AW.ckey,AP,Ae.zf];}else{AU="setDocSelectorInclude";AM=[AW.ckey,AW.include,AP,null,null,Ae.zf];}}}}}}if(AU){AZ[AU].apply(AZ,AM);}}}catch(Ab){mstrmojo.err(Ab);}},getLayoutDataCache:function F(AK){if(!AK){return null;}var AJ=this.dataCache;if(!AJ){AJ=this.dataCache={};}if(!AJ[AK]){AJ[AK]={};}return AJ[AK];},updateDataCache:function X(AK,AP,AM){var AO=this,AL=this.getLayoutDataCache(this.getCurrentLayoutKey()),AN={ifws:{},upd:{},tgts:{},def:{},secs:{}};function AJ(AX,AU,Ac){var AR=false,Ad=AO.getChildren(AX,true),Ae;if(!Ad.length){return ;}if(AU){Ae=mstrmojo.all[AX.id];AR=!AX.id||!!Ae;}var AY=AX.defn,AT=AX.data,Ab;if(AY&&AY.t===p.PANELSTACK&&AY.od){Ab=AT.selKey;}for(var AW in Ad){var AQ=Ad[AW],AV=AQ.k,AS=AQ.id,Aa=null;if(mstrmojo.all[AS]){AR=true;}if(AV in AP){if(P.call(AO,AV)&&l(AQ.data,AM)){AL[AS]=AQ;if(!Ac){AN.ifws[AV]=AO.infoWinByKey[AV].id;}}Aa=AV;if(AR){if(Ab&&Ab!==AV){continue;}if(!Ac){AN.tgts[AS]=true;}var Af=Ae&&Ae.defn,AZ=Af&&Af.t,Ag=Af&&Af.ck;if(AZ===p.SUBSECTION&&(Ag&&(AV in Ag))){AN.secs[Ae.id]=true;}}}if((Ac||Aa)&&(!Ab||Ab===AV)){AL[AS]=AQ;AN.def[AV]=true;if(AR){AN.upd[AS]=true;}}AJ(AQ,AR,Ac||Aa);}}if(AK&&AK.layouts&&AP){AJ(mstrmojo.array.filter(AK.layouts,function(AQ){return(AQ.loaded);},{max:1})[0],true);}return AN;},getCGBMap:function b(){var AJ=G(this.defn,this.currlaykey);return AJ&&AJ.cgbMap;},executeLink:function Q(AJ,AL,AM){if(AJ.indexOf("prevMsgID")>0){var AK="prevMsgID="+this.mid;AJ=AJ.replace(/prevMsgID=0($|&)/g,function(AN,AO){if(AO=="&"){return AK+="&";}else{return AK;}});if(mstrmojo.dom.isIE){AJ+="&cb"+mstrmojo.now()+"=1";}}AJ=mstrmojo.addCSRFTokenToURL(AJ);this.controller.onLink(this,{url:AJ,target:AL,src:AM||null});},showInfoWin:function Y(AM,AL,AJ,AN,AO){var AK=this.infoWinByKey&&this.infoWinByKey[AM];if(AK===undefined){return ;}this.raiseEvent({name:"showInfoWin",psId:AK.id,psKey:AK.k,anchor:AL,anchorOrientation:AJ,anchorPosition:AO,invalidate:AN});},downloadGridData:function j(AO){var AM=this,AL=AO.xtabId,AK=AO.memo,AJ=mstrmojo.all[AL],AN=this.getDataService();var AP=this.newCallback({success:function(AT){function AX(Ac,Ad){var Aa=AM.getChildren(Ac,true);for(var AZ in Aa){var Ab=Aa[AZ];if(Ad==Ab.id){return Ab;}var AY=AX(Ab,Ad);if(AY){return AY;}}return null;}var AQ=AT.data,AW=null,AV,AR=AQ&&G(AQ,AM.currlaykey);if(AR){AW=AX(AR,AL);}if(AW&&AJ){AJ.dataDownloaded(AW,AK);}if(AR&&AR.xtabStyles){AM.raiseEvent({name:"updateStyles",key:AR.k,updatedStyles:AR.xtabStyles});}AV=H.call(AM,AM.defn,AM.currlaykey,AO.nodeKey);if(AV&&AV.t===p.GRIDGRAPH&&AK.recalculating){var AS=AJ.parent,AU=AS&&AS.getGraphWidget();if(AS&&AU&&AS.updateGraph){AS.updateGraph(AX(AR,AU.id));}}},failure:function(){if(AJ.dataDownloadErr){AJ.dataDownloadErr();}}});AN.downloadGridData(AO,AP);},saveRWProps:function AD(AK,AO,AP,AM,AR){var AJ=[],AN="\u001F";t(AO,function(AT,AS){t(AT,function(AU,AV){AJ.push(AS+AN+AV+AN+AU);});});if(!AJ.length){return ;}if(AM){var AL=H.call(this,this.defn,this.currlaykey,AK),AQ=function(AS){AL.set("readyState",AS);};AR=O(AR,{submission:function(){AQ(J.WAITING);},complete:function(){AQ(J.IDLE);}});}this.getDataService().setRWUnitProperties(AK,AJ.join("\u001E"),AP||1,AM,AR);},loadPartialData:function I(AO,AK){var AM={};AM[AK]=H.call(this,this.defn,this.currlaykey,AK);var AL=this.updateDataCache(AO,AM),AJ=this.getLayoutDataCache(this.getCurrentLayoutKey()),AN=this;mstrmojo.array.forEach(AO.layouts,function(AP){if(AP&&AP.xtabStyles){AN.raiseEvent({name:"updateStyles",key:AP.k,updatedStyles:AP.xtabStyles});}});t(AL,function(AQ,AP){if(AP==="upd"){t(AQ,function(AS,AT){var AR=mstrmojo.all[AT];if(AR&&AR.update){AR.update(AJ[AT]);}});}});},addAutoWidthID:function e(AL){var AK=this.aws||{},AJ=AK[this.currlaykey]||[];AJ.push(AL);AK[this.currlaykey]=AJ;this.aws=AK;},getAutoWidthIDs:function M(){var AL=this.aws,AJ=this.currlaykey;var AK=AL&&AL[AJ];if(AK){delete AL[AJ];}return AK;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._TouchGestures","mstrmojo.array","mstrmojo.dom","mstrmojo.css");var X=mstrmojo.css,b=mstrmojo.emptyFn,T=mstrmojo.dom,G=32,d=mstrmojo.css,J={SINGLE:1,INCLUDE:2,EXCLUDE:3},Y={CONTINUOUS_STEPS:-1,UNSET:-4641},Z={},E=function(f){if(!Z[f.id+"cw"]){var g=parseInt(X.getComputedStyle(f.sliderContainer).width,10);if(isNaN(g)){g=parseInt(X.getComputedStyle(f.domNode.parentNode).width,10);}Z[f.id+"cw"]=g;}return Z[f.id+"cw"];},D=function(q,g,k){var j=q.type!==J.SINGLE,o=G,h=!!g?(g-(o/2)):parseInt(k.style.left,10),s=q.steps,w=E(q)-o,p=Math.round(w/(s-(!j?1:0))),f=j?q.rightStep:s-1;return Math.min(f,Math.round(h/p));},C=function(g){var j=g.rangeContainer.style,h=parseInt(j.width,10)-G,k=parseInt(j.left,10),f=g.steps,o=E(g)-G,l=Math.round(o/f);return Math.max(0,Math.min(Math.round((k+h)/l),f));},M=function(j,k){var g=j.steps,f=E(j),h=G;return Math.min(f-h,Math.max(0,((f/(g-1)*k)-h/2)))+"px";},B=function(h,j){var g=h.steps,f=E(h)-G;return((f/g)*j)+"px";},e=function(j,l,g){var h=j.steps,f=E(j)-G,k=g-l;return((k*f)/h)+G+"px";},W=function(g,h){var f=g.singleHandle;if(f){f.style.left=M(g,h);}},P=function(k,l,h){var f=k.rangeContainer,j,g=(k.rangeLHandle.clientWidth||G)+5;if(f){var o=k.innerRangeContainer.style;j=f.style;j.left=B(k,l);j.width=e(k,l,h);o.left=parseInt(j.left,10)+g+"px";o.width=Math.max(parseInt(j.width,10)-(2*g),0)+"px";}},A=function(h,f,o){var g=h.type!==J.SINGLE,k=D(h,f,o),p=g?"leftStep":"singleStep",j;if(k!==h[p]){h.set(p,k);this.step=k;}else{j=g?P:W;j(h,k,h.rightStep);}},H=function(g,l,k){var f=g.rangeContainer,h,j=g.leftStep,o=(k===f||k===g.innerRangeContainer);if(k===g.rangeRHandle||o){h=C(g);j+=o?h-g.rightStep:0;P(g,j,h);if(g.rightStep!==h){g.set("rightStep",h);if(o){g.set("leftStep",j);}}}else{if(k===g.rangeLHandle){A(g,l,f);}}},R=function(f,g){switch(f.type){case J.SINGLE:A(f,null,f.singleHandle);break;case J.EXCLUDE:case J.INCLUDE:H(f,null,g);break;}},I=function(s,k){var p=s.rangeContainer,g=p.style,h=parseInt(g.width,10),l=parseInt(g.left,10),f=s.leftStep,q=s.rightStep,j=q,o=f;if(k>0&&k<l&&f>0){j--;o--;}else{if(k>(l+h)&&k<E(s)){j++;o++;}}P(s,o,j);s.set("leftStep",o);s.set("rightStep",j);},Q=function(k,j,l,f,g){var h=l.style.width;if(h===""){h=X.getComputedStyle(l).width;}f=Math.min(Math.max(0,f+(g||0)),E(k)-parseInt(h,10));j.style.left=f+"px";return f;},V=function(q,o,g,k){var j=q.rangeContainer,h=q.rangeLHandle,s=E(q)-G,p=Math.round(s/q.steps),l=g-k,f;if(l>=(p+G)){f=Q(q,j,h,o,k);if((o+k)>0){j.style.width=l+"px";}return f;}},a=function(q,l,g,j){var h=q.rangeContainer,o=E(q)-parseInt(h.style.left,10),k=g+j,s=E(q)-G,p=Math.round(s/q.steps),f;if(k>=(p+G)){f=Math.min(o,k);h.style.width=f+"px";return f;}},O=function(h){var j,k,f,g;switch(h.type){case J.SINGLE:j=parseInt(this.step,10)===Y.UNSET?D(h,null,h.singleHandle):this.step;g=h.buildSummary(j);this.step=Y.UNSET;break;case J.EXCLUDE:case J.INCLUDE:k=D(h,null,h.rangeContainer);f=C(h);g=h.buildSummary(null,k,f);break;}return g;};mstrmojo.android.selectors.MobileSliderSelector=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures,mstrmojo._ListSelections],{width:0,type:Y.UNSET,value:Y.UNSET,steps:Y.UNSET,include:Y.UNSET,initState:b,buildSummary:b,updateMinMaxLabels:b,flushSelections:b,step:Y.UNSET,singleStep:Y.UNSET,leftStep:Y.UNSET,rightStep:Y.UNSET,cssDisplay:"block",scriptClass:"mstrmojo.android.selectors.MobileSliderSelector",useRichTooltip:true,markupString:'<div class="mstrmojo-sliderSel" id="{@id}"><div></div><div class="mstrmojo-sliderSelSummary">&nbsp;</div><div class="mstrmojo-sliderSelScrollerContainer"><div class="mstrmojo-sliderSelScrollerHandle" style="display:none;"><div class="mstrmojo-sliderSelScrollerHandle1 leftHandle"><div></div></div><div class="mstrmojo-sliderSelScrollerHandle1 rightHandle"><div></div></div></div><div class="mstrmojo-sliderSelScrollerHandle2" style="display:none;"><div></div></div><div class="mstrmojo-sliderSelScrollerHandleArea" style="display:none;position:absolute"></div></div><div class="mstrmojo-sliderSelLabels"><label class="mstrmojo-sliderSelLL">&nbsp;</label><label class="mstrmojo-sliderSelLR">&nbsp;</label></div></div>',markupSlots:{editor:function(){return this.domNode.childNodes[0];},summary:function(){return this.domNode.childNodes[1];},sliderContainer:function(){return this.domNode.childNodes[2];},innerRangeContainer:function(){return this.domNode.childNodes[2].childNodes[2];},rangeContainer:function(){return this.domNode.childNodes[2].childNodes[0];},rangeLHandle:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0];},rangeRHandle:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1];},singleHandle:function(){return this.domNode.childNodes[2].childNodes[1];},minLabel:function(){return this.domNode.childNodes[3].childNodes[0];},maxLabel:function(){return this.domNode.childNodes[3].childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},ontypeChange:function(){var h,g="none",j="mstrmojo-sliderSelScrollerContainer",f="Handle1";switch(this.type){case J.SINGLE:h="block";break;case J.EXCLUDE:j="mstrmojo-sliderSelScrollerContainerExcl";f="Handle2";g="block";break;case J.INCLUDE:g="block";break;}this.rangeContainer.style.display=g;this.innerRangeContainer.style.display=g;this.sliderContainer.className=j;this.rangeLHandle.className="mstrmojo-sliderSelScrollerHandleX leftHandle".replace("HandleX",f);this.rangeRHandle.className="mstrmojo-sliderSelScrollerHandleX rightHandle".replace("HandleX",f);this.singleHandle.style.display=h;},onconstantsChange:function(){this.updateMinMaxLabels();},onvalueChange:function(){O(this);}},postBuildRendering:function U(){var f=this._super();this.initState();var g=this.tooltipNode||this.domNode;T.detachEvent(g,"mouseover",this._ontooltipover);T.detachEvent(g,"mouseout",this._ontooltipout);return f;},onsingleStepChange:function(){W(this,this.singleStep);},onleftStepChange:function(){P(this,this.leftStep,this.rightStep);},onrightStepChange:function(){P(this,this.leftStep,this.rightStep);},touchSwipeBegin:function(o){var l=o.target;if(!l){return false;}this.touchTap(o);var f=this._glowing=[];d.addClass(l,"glow");f.push(l);this._sliderTarget=l;var g=this.singleHandle,h=this.rangeContainer,k,j;switch(l){case g:k=g.style.left;Z.shl=parseInt(!!k?k:0,10);break;case h:case this.innerRangeContainer:case this.rangeLHandle:case this.rangeRHandle:j=h.style;k=j.left;Z.icl=parseInt(!!k?k:0,10);Z.icw=parseInt(j.width,10);break;case this.sliderContainer:d.addClass(g,"glow");f.push(g);break;default:this.bubbleTouchEvent(o);}this._initTooltip();if(this.type===J.SINGLE){this.touchSelectMove(o,true);}},touchSwipeMove:function(p,k){var q=p.target;if(!q){return false;}q=this._sliderTarget;var g=this.singleHandle,j=this.rangeContainer,f=this.rangeLHandle,h=this.rangeRHandle,o=p.delta.x,l;switch(q){case g:l=Q(this,g,g,Z.shl,o);break;case h:l=a(this,Z.icl,Z.icw,o);break;case f:l=V(this,Z.icl,Z.icw,o);break;case j:case this.innerRangeContainer:if(this.type===J.INCLUDE){l=Q(this,j,j,Z.icl,o);}break;case this.sliderContainer:l=Q(this,g,g,p.clientX-T.position(this.sliderContainer,true).x);break;}this._updateTooltip(p.evt,q,l,k);},touchSwipeEnd:function(k){var j=(k.target===this.sliderContainer)?this.singleHandle:this._sliderTarget,f=this.leftStep,h=this.rightStep,g=this.singleStep;mstrmojo.array.forEach(this._glowing,function(l){d.removeClass(l,"glow");});R(this,j);if(f!==this.leftStep||h!==this.rightStep||g!==this.singleStep){this.flushSelections();}this.hideTooltip(k.evt,this);},touchTap:function(k){var o=k.target;if(!o){return false;}var p=this.sliderContainer,g=k.clientX,q=(p===o),h=g-T.position(p,true).x,j=this.leftStep,f=this.rightStep,t=this.singleStep;switch(this.type){case J.SINGLE:if(q){A(this,h,this.singleHandle);}break;case J.INCLUDE:if(q){I(this,h);}break;}if(j!==this.leftStep||f!==this.rightStep||t!==this.singleStep){O(this);this.flushSelections();}},touchSelectBegin:function(f){this.touchSwipeBegin(f);},touchSelectMove:function(f){this.touchSwipeMove(f,true);},touchSelectEnd:function(f){this.touchSwipeEnd(f);},touchEnd:function F(f){this.hideTooltip(f.evt,this);},_initTooltip:function S(){this.set("richTooltip",{refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMCENTER,contentNodeCssClass:"mstrmojo-sliderTip"});},_updateTooltip:function N(f,s,l,j){this.showTooltip(f,this);var k=T.position(this.sliderContainer,false),h=T.position(this.domNode,false),g=mstrmojo.boxmodel.offset(this.sliderContainer),o=(k.y<90),p=this.richTooltip,q=O(this),t;if(j){t=(G/2);}else{t=s.style.width;if(t===""){t=X.getComputedStyle(s).width;}t=parseInt(t,10)/2;}p.content='<div class="mstrmojo-sliderTip-top">'+q+'</div><div class="mstrmojo-sliderTip-bottom'+(o?" down":"")+'"></div>';p.top=h.y-g.top-20+(o?100:0);p.left=l+t+(h.x-g.left);this.richTooltip=null;this.set("richTooltip",p);},onselectionChange:function L(){if(this.onchange){this.onchange();}if(this.makeSelection){this.makeSelection({selItem:this.type===J.SINGLE?this.singleHandle:this.rangeContainer});}},slideHosted:function(h,g,f){if(h!==null&&h!==undefined){this.set("singleStep",h);}if(g!==null&&g!==undefined){this.set("leftStep",g);}if(f!==null&&f!==undefined){this.set("rightStep",f);}this.flushSelections();O(this);}});var K=mstrmojo.android.selectors.MobileSliderSelector;K.TYPES=J;K.FLAGS=Y;}());(function(){var regExH=/"height", "[0-9.]+"/g;var regExW=/"width", "[0-9.]+"/g;var regExH1=/height="?[0-9.]+"?/g;var regExW1=/width="?[0-9.]+"?/g;mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._IsSelectorTarget");mstrmojo.DocVisualization=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocVisualization",markupString:'<div id={@id} class="mstrmojo-docvisualization" title="{@tooltip}" style="{@domNodeCssText}">{@htmlText}</div>',formatHandlers:{domNode:["RW","T","B","fx"]},update:function update(node){if(this._super){this._super(node);}var d=node.data;this.htmlText=d.htmlText;this.jsText=d.jsText;this.selData=d.selData;this.ctrLink=d.ctrLink;this.vp=d.vp;this.eg=d.eg;if(this.eg){this.htmlText=this.eg;}},preBuildRendering:function(){if(this._super){this._super();}var fmts=this.getFormats();if(!fmts){return ;}var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(this.jsText){this.jsText=this.jsText.replace(regExH,'"height", "'+h+'"').replace(regExW,'"width", "'+w+'"');}},postBuildRendering:function pstBldRnd(){if(this._super){this._super();}eval(this.jsText);},resize:function(){if(this.eg){return ;}var embedNode=this.domNode.firstChild.firstChild.firstChild;if(!embedNode){return ;}var fmts=this.getFormats();var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(mstrmojo.dom.isIE){embedNode.firstChild.setAttribute("height",h);embedNode.firstChild.setAttribute("width",w);}else{embedNode.innerHTML=embedNode.innerHTML.replace(regExH1,'height="'+h+'"').replace(regExW1,'width="'+w+'"');}},makeSelections:function(selections){var shuffledData={},i,j,attId,e;for(i=0;i<selections.length;i++){var attIdI=selections[i].attId;if(!shuffledData[attIdI]){shuffledData[attIdI]=[];}shuffledData[attIdI]=shuffledData[attIdI].concat(selections[i].values);}var sep="\u001E",sep1="\u001F";var ckJoined="",eidJoined="",cklJoined="";var tksArray=[];for(attId in shuffledData){var sd=this.getSelectionData(attId);if(!sd){continue;}var ctrLink=this.ctrLink[attId];var values=shuffledData[attId];if(sd&&values&&values.length>0){sd.sel=values;sd.ias=false;for(e in values){if(e==="u;"){sd.ias=true;break;}}}if(ctrLink.gbTargets){var t=ctrLink.targets=[],gbt=ctrLink.gbTargets,cgbmap=this.model.getCGBMap();for(j=0;j<gbt.length;j++){var targetKey=cgbmap[gbt[j]];if(targetKey){t.push(targetKey);}}delete ctrLink.gbTargets;}ckJoined+=ctrLink.ctxt+sep1;eidJoined+=values.join(sep)+sep1;cklJoined+=ctrLink.ck+sep1;tksArray=tksArray.concat(ctrLink.targets);}ckJoined=ckJoined.substring(0,ckJoined.length-1);eidJoined=eidJoined.substring(0,eidJoined.length-1);cklJoined=cklJoined.substring(0,cklJoined.length-1);if(tksArray.length==0){return ;}var evt={ck:ckJoined,eid:eidJoined,src:this.k,tks:tksArray.join(sep),type:this.defn.t,ctlKey:cklJoined,include:true,isDocVis:true};this.model.slice(evt);},getAllSelectionData:function(){return this.selData;},getSelectionData:function(attId){var selData=this.selData,k;if(selData&&selData.attl){var attl=selData.attl;if(attId){return attl[attId];}else{for(k in attl){return attl[k];}}}},saveVisProps:function(widgetPropsXml){var props={};props[this.k]={FormattingWidget:"WidgetProps\u001F"+widgetPropsXml};mstrApp.docModel.saveRWProps(this.k,props,1,false,{success:function(){}});}});}());(function(){var Q="<tr>";var Y=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var T="&nbsp;";var I="fsbp_1 ";var X="fsbp_2 ";var B="fsbp_3 ";var V=1,W=2,F=3,K=4,A=5,S={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" no-stack",5:" stack-full"};var Z=mstrmojo.css;var L=4;function E(f,e){for(var g=0,b=f.length;g<b;g++){var j=f[g];var h=e.rows[j.rows].cells[j.cells];if(h){mstrmojo.css.addClass(h,I);}}}mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function J(b){this._super(b);},numColumnCanMerge:0,preBuildRendering:function D(b){var d=this.cp;if(!d){return ;}d.initContent();this.rc=d.rc||0;this.cws=d.colWidths||[];this.cc=this.cws.length;this.tdWidths=d.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=d.getNumAutoHeightRows&&d.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function H(d){var b=this._super(d);this.renderGrid();return b;},renderGrid:function R(d){var b=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(b,d);this.postBuildGridTable();},getGridContainer:function a(){return this.gridContainerNode;},buildGridTable:function G(e,b){var d=this.getTableStartMarkup();var l=this.getTableEndMarkup();if(b){this.mergeHdrsAcrossBlks=true;}var j=this.buildTableRowsMarkup(this.start,this.end,d,l).join("");if(b){var g=document.createElement("div");g.innerHTML=j;var k=e.firstChild,o=k&&k.tBodies,f=g.firstChild.tBodies[0],h=this.matchedHdrsAcrossBlks;k.appendChild(f);if(h&&h.length>0){E(h,o[o.length-2]);}}else{e.innerHTML=j;}},getTableStartMarkup:function O(){var d=this._getGridWidths(),b=Y;b[1]=d.tableLayout;b[3]=d.totalColWidths;b[5]=this.tableCssClass?"class="+this.tableCssClass:"";b[7]="<colgroup>"+d.colgroup+"</colgroup>";if(this.tbodyStyle){b[8]='<tbody style="'+this.tbodyStyle+'">';}return b.join("");},getTableEndMarkup:function N(){return"</tbody></table>";},_getGridWidths:function U(){var l={};var g="",e=[],k="fixed",d=this.cws,h=d.length;if(h){g=0;e=[];for(var f=0;f<h;f++){if(d[f].w!==""){g+=parseInt(d[f].w,10);}}for(f=0;f<h;f++){var b=d[f];if(b.w!==""){var j=parseInt(b.w,10);if(mstrmojo.dom.isIE7){if(j===0){e.push('<col style="width:0%;display:none"></col>');}else{e.push('<col style="width:'+(j/g*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&j===0){e.push('<col style="width:-1px"></col>');}else{e.push('<col style="width:'+b.w+'"></col>');}}}else{e.push("<col />");k="auto";}}this.totalColWidth=g;}l.colgroup=e.join("");k=this.tableLayout||k;if(this.autoFitWindow){k=this.tableLayout||k||"fixed";g="100%";}else{if(k=="fixed"){g+="px";}else{g="auto";}}l.totalColWidths=g;l.tableLayout=k;return l;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function P(x,g,AW,d){var AK=[],AU=0;AK[AU++]=AW||"<table><tbody>";var z=this.cp,AE=z.getRowHeight(),AS=this._CELL_MARKUP,AJ=AE?'<tr style="height:'+(AE?AE+"px":"")+'">':Q;var f=true,t=true,AQ=[],AM;this.matchedHdrsAcrossBlks=[];for(var AN=x;AN<=g;AN++){AM=AU++;AK[AM]=AN<this.numAutoHeightRows?Q:AJ;var l=z.getRowCells(AN);var AI=g+1-AN;var AH=0;if(!this.mergeHdrsAcrossBlks){if(f&&x>0&&l.length<z.colWidths.length){var AG=z.getUnmergedCells(x);if(AG){AH=AG.length;}for(var AT in AG){var AP=AG[AT];if(AP.rs>AI){AS[1]=AI;AS[5]=X+AP.css;}else{AS[1]=AP.rs||1;AS[5]=B+AP.css;}if(AP.cet){AS[5]+=" mstrmojo-selected-cell";this.addHilitePosition(AP.cet,AN,AT);}if(AP._ei){this.addExtraInfoMap(AP._ei,AN,AT);AS[5]+=" pt";}AS[9]="";AS[13]=T;AS[3]=AP.cs;AS[7]=AP._ei!==undefined?AP._ei:"";AK[AU++]=AS.join("");}f=false;}}for(var AV=0,h=l.length;AV<h;AV++){var AC=l[AV],AD;if(AC.rs&&AC.rs>AI){AS[1]=AI;AS[5]=I+AC.css;if(AC._ei){this.addExtraInfoMap(AC._ei,AN,AV);}}else{AS[1]=AC.rs||1;AS[5]=AC.css;}if(AC.rowType!==V){AS[5]+=" xtab-td ";}if(AC.cet){AS[5]+="sc_"+this.parent.k;this.addHilitePosition(AC.cet,AN,AV);}AD=AC.rowType;if(AD){AS[5]+=S[AD]||"";var k=z.getRowHeight(AD);if(k){AK[AM]='<tr style="height:'+(k?k+"px":"")+'">';}}AS[3]=AC.cs||1;AS[7]=AC._ei!==undefined?AC._ei:"";if(AC.fs||AC._e){this.addTitleHeaderPositionMap(AN,AV+AH,AC);}if(AC._ei!=null){this.addPositionMap(AC._ei,AN,AV+AH);}AS[11]=AN;if(AC.ts===L){var q=AC.v;if(this.imgCacheMap){var AR=this.imgCacheMap,AL=q&&q.replace(/\\/g,"/");if(AR.cachedImg[AL]){AC.v=q=AR.baseURL+AR.cachedImg[AL];}else{if(AL&&!AR.unCachedImg[AL]){AR.unCachedImg[AL]=AL;}}}else{var e=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(e&&e.getImage){q=e.getImage(q);}}if(AC.rowType){var b=(z.getRowHeight(AC.rowType)||z.rh||AE),AO=b,w=this.tdWidths,AF=AC.colIdx,AA=0;if(AF!=="undefined"&&AF>-1&&w&&w.length>AF){var o=w[AF]&&w[AF].w;if(o!=="undefined"){AA=parseInt(o,10);}}var s=AA>30?(AA-30):0;AS[13]='<div><div style="top:'+(-parseInt(AO/2,10))+"px;height:"+b+"px;line-height:"+b+'px !important;">&nbsp;<img style="max-height:'+b+"px; max-width: "+s+'px;" src="'+q+'"></img></div></div>';}else{if(this.parent.gridData.lhv){AS[9]="background-image:url('"+q+"');background-repeat:no-repeat;background-position:center "+(AC.rs>1?"top":"center")+";";AS[13]=T;}else{AS[9]="";AS[13]='<img src="'+q+'"></img>';if(AC.css&&AC.css.indexOf("hl")>-1){AS[13]="<span>"+AS[13]+"</span>";}}}}else{AS[9]="";AS[13]=AC.v||AC.n||T;if(AC.css&&AC.css.indexOf("hl")>-1){AS[13]="<span>"+AS[13]+"</span>";}}if(AV<this.numColumnCanMerge){if(AN===x&&this.mergeHdrsAcrossBlks){var AB=this.rowHdsAcrossBlks;if(t&&AC.v&&AB&&AB[AV]){if(AC.v===AB[AV].v){AS[1]=AC.rs||1;AS[5]=B+AC.css;AS[13]="";this.matchedHdrsAcrossBlks.push(AB[AV]);}else{t=false;}}}if(AS[1]>=AI&&AC.v){AQ.push({rows:AN-x,cells:AV,v:AC.v});}}AK[AU++]=AS.join("");}AK[AU++]="</tr>";}AK[AU++]=d||"</tbody></table>";this.rowHdsAcrossBlks=AQ;return AK;},addHilitePosition:function(d,e,b){var f=this.hiliteCellsMap[d];if(!f){this.hiliteCellsMap[d]={pos:[],nodes:[]};}this.hiliteCellsMap[d].pos.push({row:e,cell:b,page:0});},addExtraInfoMap:function(d,b,e){if(!this.eiMap[d]){this.eiMap[d]=[];}this.eiMap[d].push({row:b,cell:e,page:0});},addPositionMap:function(d,b,e){if(!this.posMap[d]){this.posMap[d]={row:b,cell:e,page:0};}},addTitleHeaderPositionMap:function(b,e,d){this.thPosMap.push({row:b,cell:e,page:0,obj:d});},clearHilites:function(l){var f=this.hiliteCellsMap[l],g=f&&f.nodes,j=this.parent;if(g){if(g.length==0&&f.pos){g=this.getNodesByPositions(f.pos);}for(var e=0,b=g.length;e<b;e++){var d=g[e],h=d.className,k=j.getCellForNode(d);if(k){delete k.cet;}Z.removeClass(d,"sc_"+j.k);}this.hiliteCellsMap[l].nodes=[];}},setHilites:function(d,e){Z.addClass(e,"sc_"+this.parent.k);if(!this.hiliteCellsMap[d]){this.hiliteCellsMap[d]={pos:[],nodes:[]};}this.hiliteCellsMap[d].nodes.push(e);var b=this.parent.getCellForNode(e);if(b){b.cet=d;}},getNodesByPositions:function(g){var f=this.tableNode,b=[];for(var e in g){var d=g[e];b.push(f.tBodies[0].rows[d.row].cells[d.cell]);}return b;},preBuildGridTable:function C(){},postBuildGridTable:function M(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocHTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocHTMLContainer",scrolling:"auto",markupString:'<iframe id="{@id}" class="mstrmojo-DocHTMLContainer" title="{@tooltip}" style="{@domNodeCssText}" src="{@v}" scrolling="{@scrolling}"></iframe>',formatHandlers:{domNode:["RW","B","F","background-color","text-align","white-space","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function A(B){this.v=B.data.v;if(mstrApp&&mstrApp.isTouchApp()){this.scrolling="no";}if(this.thresholdId||B.data.tid){delete this.fmts;}this.thresholdId=B.data.tid;this.set("visible",!B.data.hidden);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget");mstrmojo.StickySections=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.StickySections",markupString:'<div id="{@id}" style="{@cssText};overflow:hidden"><div class="mstrmojo-StickySections {@cssClass}">{@currentSectionTitle}</div></div>',oncurrentSectionTitleChange:function B(C){this.domNode.lastChild.innerHTML=this.currentSectionTitle;},onMove:function A(G){var F=0;if(G.isNextRowNewSection){var C=G.position,D=G.rowStart,E=(D>C)?(this.domNode.offsetHeight+1):0;F=(D-C)-E;}mstrmojo.dom.translate(this.domNode.lastChild,0,F,0,"",true);if(G.sectionName&&G.sectionName!==this.currentSectionTitle){this.set("currentSectionTitle",G.sectionName);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo._IsAnchorable");var B=1,H=2,E=3,G=4;var F="title",D="content";mstrmojo.VisTextTooltip=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.VisTextTooltip",left:0,top:0,zIndex:10,boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:"mstrmojo-vis-tip",anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,tipNodeColor:"#ffffff",utils:mstrmojo.VisChartUtils,touchAreaType:D,markupString:'<div id="{@id}" class="{@cssClass}" style="top:{@top}px;left:{@left}px;z-index:{@zIndex};position:absolute;{@cssText};"><div class="timeseries-slider-tooltip" style="display: block"></div><div class="mstrmojo-vis-tip" style="display: block"></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];}},toggle:function A(I){if(I){this.domNode.style.display="block";}else{this.domNode.style.display="none";}},updateContent:function(I,K,J){this.fillContent(I,K,J);this.positionDialog();},fillContent:function C(I,K,J){this.anchor=I;this.touchAreaType=K;this.domNode.firstChild.innerHTML=J||this.anchor.innerText;this.toggle(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocLine=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocLine",markupString:'<div id="{@id}" class="mstrmojo-DocLine" title="{@tooltip}" style="{@domNodeCssText}"></div>',formatHandlers:{domNode:["RW","border-top","border-left","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}},getFormats:function A(){var C=this._super();if(C&&parseInt(C.height,10)===0){C.height="1px";}return C;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.dom","mstrmojo.num","mstrmojo._TouchGestures");var O=mstrmojo.dom,S=mstrmojo.css,D=Math.min,E=Math.max,Q=Math.round,N=mstrmojo.num,F=N.countOfDecimals;function B(){var a=document.defaultView.getComputedStyle,Z=[this.leftNode,this.rightNode],e=["border-left-width","padding-left","margin-left","border-right-width","padding-right","margin-right"],d=[0,0],Y,X;for(Y=0;Y<Z.length;Y++){var b=a(Z[Y]);for(X=0;X<e.length;X++){d[Y]+=parseInt(b.getPropertyValue(e[X]),10)||0;}}this._lnExt=d[0];this._rnExt=d[1];if(!this._thumbLen){this._thumbLen=parseInt(this.thumbNode.offsetWidth,10);}this._length=this.domNode.clientWidth;this._effLen=Q(this._length-this._thumbLen);this._unitLen=this._effLen/(this.max-this.min);}function V(Y){var b=this.min,a=this._unitLen,Z=this._thumbLen/2,X=Q((Y-b)*a);this.leftNode.style.width=(X+Z-this._lnExt)+"px";this.rightNode.style.width=(this._effLen-X+Z-this._rnExt)+"px";O.translate(this.thumbNode,E(D(X,(this.max-b)*a),0),0);}function T(Y,Z){var X=this.interval;return D(E(this.min,parseFloat(Y,10)+Q(Z/this._unitLen/X)*X),this.max).toFixed(this._intervalDecimals);}function H(X){return T.call(this,this.min,X-O.position(this.domNode,true).x-this._thumbLen/2);}function J(X){return function(Y){return this["touchSelect"+X](Y);};}mstrmojo.ui.MobileSlider=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures],{markupString:'<div class="mstrmojo-MobileSlider" style="visibility:hidden;"><div class="v"></div><div class="bk"></div><div class="th"><div></div></div><div class="min">{@minText}</div><div class="max">{@maxText}</div></div>',markupSlots:{leftNode:function(){return this.domNode.childNodes[0];},rightNode:function(){return this.domNode.childNodes[1];},thumbNode:function(){return this.domNode.childNodes[2];},minNode:function(){return this.domNode.childNodes[3];},maxNode:function(){return this.domNode.childNodes[4];}},markupMethods:{onvalueChange:function(){if(this.hasRendered){V.apply(this,[this.value]);}if(this.slidingValue!==this.value){this.set("slidingValue",this.value);}},onslidingValueChange:function(){if(this.hasRendered){V.apply(this,[this.slidingValue]);}}},value:0,slidingValue:0,max:10,min:0,interval:1,_intervalDecimals:0,init:function M(X){this._super(X);this._intervalDecimals=F(this.interval,".");},onintervalChange:function K(Y,X){this._intervalDecimals=F(X,".");},preBuildRendering:function C(){this.minText=N.toLocaleString(this.min);this.maxText=N.toLocaleString(this.max);this._super();},postBuildRendering:function R(){this._super();B.call(this);V.call(this,this.value);this.domNode.style.visibility="visible";},resize:function U(){B.call(this);V.call(this,this.value);},touchBegin:function L(X){X.stop();},touchSelectBegin:function A(Y){var X=Y.target;if(!X||X!==this.thumbNode){return this.bubbleTouchEvent(Y);}S.addClass(this.domNode,"active");this.slidingValue=this.value;},touchSelectMove:function G(X){this.set("slidingValue",T.apply(this,[this.value,X.delta.x||0]));},touchSelectEnd:function I(X){S.removeClass(this.domNode,"active");this.set("slidingValue",T.apply(this,[this.value,X.delta.x||0]));this.set("value",this.slidingValue);},touchSwipeBegin:J("Begin"),touchSwipeMove:J("Move"),touchSwipeEnd:J("End"),onclick:function W(Y,X){this.touchTap({clientX:O.getMousePosition(Y.e,X).x});},touchTap:function P(X){this.set("value",H.call(this,X.clientX));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.BarcodeReader","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton");var A=mstrmojo.array;mstrmojo.android.inputControls.BarcodeDIC=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.BarcodeDIC",markupString:"<div></div>",showInPopup:function(){var C=this;var E={success:function(F){if(F!==""){if(!!C.dic.em){C.value=C.dic.vls[parseInt(F,10)].v;}else{C.value=F;}C.applyChanges();}},failure:function(F){}};var D={barcodeDIC:true};if(!!C.dic.em){var B=[];A.forEach(C.dic.vls,function(G,F){B[F]=G.m||G.v;});D.vls=B;}mstrmojo.BarcodeReader.readBarcodes(D,E,this.popupTitle);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRoundRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRoundRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRoundRectangle" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocRoundRectangle-l1" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div style="{@rectNodeCssText}{@rectNodeGradCssText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l1" style="{@bCornersCssText}{@bCornersCssGradText}"></div></div>',markupSlots:{rectNode:function(){return this.domNode.childNodes[3];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["top","left","width","z-index","fx"],rectNode:["height","background-color"],tCorners:["background-color"],bCorners:["background-color"]},update:function C(D){if(this.thresholdId||D.data.tid){delete this.fmts;}this.thresholdId=D.data.tid;this.set("visible",!D.data.hidden);},preBuildRendering:function B(){var F=this._super();var G=this.getFormats(),D=!!this.defn.topc,I=(D)?4:8,H="(\\d*px)",E=Math.max(parseInt(G.height,10)-I,0);if(G.height==="100%"){H="(100%)";E=this.parent.height()-I;}this.rectNodeCssText=this.rectNodeCssText.replace(new RegExp("(.*height:)"+H+"(.*)"),"$1"+E+"px$3");if(D){this.bCornersCssText="display:none;";}return F;},formatGradient:function A(E,H){var F=mstrmojo.css.buildGradient(E.t,E.sc,E.ec);if(!F){return ;}var D=F.n+":"+F.v+";",G="background-color:";this.rectNodeGradCssText=D;if(E.t===0){this.tCornersCssGradText=G+E.sc+";";this.bCornersCssGradText=G+E.ec+";";}else{this.tCornersCssGradText=this.bCornersCssGradText=D;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Widget");var C=mstrmojo.css;mstrmojo.VisTooltip=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.VisTooltip",cssClass:"vis-tooltip",markupString:'<div class="{@cssClass}"><div class="vis-tooltip-container"><table class="vis-tooltip-table"></table></div></div>',markupSlots:{domContainer:function(){return this.domNode.firstChild;},domTable:function(){return this.domNode.firstChild.firstChild;}},toggle:function A(F){if(F){this.domNode.style.display="block";}else{this.domNode.style.display="none";}},displayInfo:function E(I,P){var K,F,U,L,O,J,H,G,R=document,T=this.domTable;T.innerHTML="";F=I.length;for(K=0;K<F;K++){U=I[K];L=R.createElement("tbody");O=R.createElement("tr");J=R.createElement("td");H=R.createElement("td");G=R.createElement("td");J.setAttribute("class","vis-tooltip-name");H.setAttribute("class","vis-tooltip-space");G.setAttribute("class","vis-tooltip-value");if(U===null){O.setAttribute("class","vis-tooltip-tr separator");}else{O.setAttribute("class","vis-tooltip-tr");J.innerHTML=U.n+":";G.innerHTML=U.v;}O.appendChild(J);O.appendChild(H);O.appendChild(G);L.appendChild(O);this.domTable.appendChild(L);}if(P){var N=mstrmojo.dom.position(R.body),Q=this.domNode.offsetWidth,M=this.domNode.offsetHeight,V=P.x+Q-N.x-N.w,S=P.y+M-N.y-N.h;if(V>0){P.x-=V;}if(S>0){P.y-=S;}this.domNode.style.left=P.x+"px";this.domNode.style.top=P.y+"px";}},doLayout:function D(F){var J=this.domTable,L=C.getComputedStyle(this.domNode),H=J.firstChild.firstChild.childNodes,K=J.getElementsByClassName("vis-tooltip-value"),G;var I=F-parseInt(L.paddingLeft)-parseInt(L.paddingRight);I-=H[0].offsetWidth;I-=10;for(G=0;G<K.length;G++){K[G].style.maxWidth=I+"px";}},posTo:function B(F){this.domNode.style.left=F.x+"px";this.domNode.style.top=F.y+"px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var Z=mstrmojo.hash,f=mstrmojo.array,e=mstrmojo.boxmodel,b=mstrmojo.dom;function A(j,l,h){var k=j.listSelector;if(k){k[l](j,j.itemsContainerNode,h);}}function K(j,h){var k=j.lastPagePos;if(!k||k.dragId!==h){k=e.offset(j.itemsContainerNode);k.dragId=h;j.lastPagePos=k;var l=j.scrollboxNode;j.lastScrollPos={left:l.scrollLeft,top:l.scrollTop,width:l.clientWidth,height:l.clientHeight};}}function N(l,q,j){var k=q&&q.node;if(k===l.dropCueNode||k===l.dropCueNode.firstChild){return l.dropCuePos;}var o=l.listMapper;var h=o&&o.whereDrop(l,l.itemsContainerNode,k,q.pos,{left:l.lastPagePos.left-l.lastScrollPos.left,top:l.lastPagePos.top-l.lastScrollPos.top,width:l.lastScrollPos.width,height:l.lastScrollPos.height});var p=l.dropCuePos;return((j!==false)&&p&&h&&(p.idx===h.idx)&&(p.left===h.left)&&(p.top===h.top))?p:h;}var g="attachEventListener";function C(j,h){if(j.makeObservable){h=h||[];if(!h[g]){mstrmojo.hash.make(h,j.itemsScriptClass||mstrmojo.Arr);}}return h;}function G(j,h){if(h&&h[g]){j._sub_its=h;j._sub_add=h[g]("add",j.id,"preadd");j._sub_rmv=h[g]("remove",j.id,"preremove");}}function F(h){if(h._sub_its){var j=mstrmojo.publisher;j.unsubscribe(h._sub_add);j.unsubscribe(h._sub_rmv);delete h._sub_add;delete h._sub_rmv;delete h._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var j=this.dropCueNode,h=j&&j.style;if(!h){return ;}var l=this.dropCuePos,k=!!l;if(k){h.left=l.left+"px";h.top=l.top+"px";}h.display=k?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Y(p){this._super(p);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,q=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||q){this.initSelections(l,j,k,q);}if(this.postInitItems){this.postInitItems();}},initItems:function H(h){return C(this,h);},preBuildRendering:function V(){var o=this.listBuilder,s=o.newContext(this);this.ctxtBuilder=s;var j=this.markupSlots,l=!!(this.renderOnScroll&&this.renderBlockSize&&j&&j.scrollboxNode),k=this.items,h=(k&&k.length)||0,p=l?this.firstRenderBlockSize:h,q=l?this.firstRenderBlockSize:0;this._eros=l;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(k,o,this,s,p,q).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function D(){delete this.itemsHtml;var o=this.listMapper;if(o&&o.postBuildRendering){o.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}G(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var q=this.id;this._cb_scroll=function(){var s=mstrmojo.all[q];s.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var k=0,j=["itemsEffect","scrollEffect"],h=j.length;k<h;k++){var p=j[k],l=this[p];if(l&&l.constructor===Object){l=mstrmojo.insert(mstrmojo.hash.clone(l));l.widget=this;this[p]=l;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function W(l){F(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var j=0,k=["itemsEffect","scrollEffect"],h=k.length;j<h;j++){var o=this[k[j]];if(o&&o.isPlaying){o.cancel();}}this._super(l);},pauseScrollRendering:function O(k,h,j){if(k!==false){k=true;}if(this.paused===!!k){return ;}this.paused=!!k;if(k){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(h,j);}},onscroll:function J(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var h=this;this._fillTmr=self.setTimeout(function(){h.fill();h=null;},50);}}if(this._super){this._super();}},fill:function a(h,o){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var p=(this.items&&this.items.length)||0;if(!p){if(o){o();}}else{var k=this.scrollboxNode,q=this.itemsContainerNode,l=mstrmojo.boxmodel.offset(q,k),t=this.listMapper,s=t.findScrollRange(q,p,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||k.scrollTop,k.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||k.scrollLeft,k.clientWidth,l.left,l.top);if(this.fillAt(s.start,s.end)){if(h){h();}var j=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[j].fill(h,o);},100);}else{if(o){o();}}}},fillAt:function L(k,j){var h=this.listMapper;if(h){return h.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,k,j,this.renderBlockSize);}else{return false;}},add:function Q(j,h){if(!j||!j.length){return -1;}var k=this.items;if(h==null){h=Z.min(this.selectedIndices,false,true);if(h!==null&&h!==undefined){h++;}}if(h==null||h===-1){h=(k&&k.length)||0;}if(k&&k.add){k.add(j,h);}else{this.set("items",k?f.insert(k.concat(),h,j):j);}return h;},preadd:function B(k){if(this.hasRendered){var p=this.listMapper;if(p){p.onadd(this,this.itemsContainerNode,this.ctxtBuilder,k);}var o=this.listBuilder;if(o){o.onadd(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onadd(this,k);}if(this._eros){this.onscroll();}else{var l=k.index,h=k.value.length;this.fillAt(l,l+h-1);}}if(this.onadd){this.onadd(k);}if(this._super){this._super(k);}},remove:function T(h){if(h==null){return -1;}if(h.constructor!==Array){return this._remove(h);}var k=this.items;if(k){var j;if(k.remove){for(j=h.length-1;j>-1;j--){k.remove(h[j],1);}}else{k=k.concat();for(j=h.length-1;j>-1;j--){k.splice(h[j],1);}this.set("items",k);}return h[0];}return -1;},_remove:function T(k){var j=this.items;if(!j||(k==null)){return -1;}var h;if(!isNaN(k)){h=k;}else{h=this.itemIndex(k);}if(h>-1){if(j.remove){j.remove(h,1);}else{j=j.concat();j.splice(h,1);this.set("items",j);}}return h;},duplicate:function X(p,j,k){var l=this.items,h=-1;if(!l||(p==null)){return -1;}if(!isNaN(p)){if(j===null||j===undefined){j=p+1;}p=l[p];}else{if(j===null||j===undefined){j=this.itemIndex(p)+1;}}if(p){var o;o=Z.copy(k,Z.clone(p));h=this.add([o],j);}return h;},preremove:function M(j){if(this.hasRendered){var l=this.listMapper;if(l){l.onremove(this,this.itemsContainerNode,this.ctxtBuilder,j);}var k=this.listBuilder;if(k){k.onremove(this,this.ctxtBuilder,j);}var h=this.listSelector;if(h){h.onremove(this,j);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(j);}if(this._super){this._super(j);}},move:function R(l,t){function q(x,w){return(t>=x)&&(t<=x+w);}var s=(this.items&&this.items.length)||0;if(t===-1||t==null||isNaN(t)){t=s;}else{t=Math.min(t,s);}var k,h,p,o;if(l.constructor===Array){h=l;p=l;o=(h&&h.length)||0;if(q(l[0],l.length)){return false;}k=f.get(this.items,l);}else{if(typeof (l)==="object"){k=[l];o=1;h=this.itemIndex(k[0]);p=[h];if(q(h,1)){return false;}}else{h=l;p=[l];o=1;if(q(h,1)){return false;}k=[this.items[h]];}}for(var j=0;j<o;j++){if(p[j]<=t){t--;}}if(k[0]!=null){this.remove(h);this.add(k,t);}return true;},itemIndex:function E(h){if(h==null){return -1;}var j=this.itemIdField;return j?f.find(this.items,j,h[j]):f.indexOf(this.items,h);},prechange:function S(k){if(this.hasRendered){var j=[this.listBuilder,this.listMapper];for(var l=0,h=j.length;l<h;l++){var p=j[l];if(p&&p.onchange){p.onchange(this,this.itemsContainerNode,this.ctxtBuilder,k);}}}},makeObservable:false,_set_items:function I(p,h){var o=this.items;h=this.initItems(h);this.items=h;if(o!==h){var l=this,k=function(){if(l.autoHide){l.set("visible",!!(h&&h.length));}l=null;},j=this.hasRendered;if(j){this.refresh(k);}else{k();}}return o!==h;},premousedown:function d(h){A(this,"premousedown",h);},premouseup:function P(h){A(this,"premouseup",h);},scrollTo:function U(j){var h,k=this.listMapper;if(k&&k.toItem){if(!isNaN(j)){h=j;}else{h=this.itemIndex(j);}if(h>=0){k.toItem(this,h);}}},draggable:false,getDragData:function(o){K(this,o.id);var k=N(this,o.src),j=k&&k.idxActual;if((j>-1)&&this.selectedIndices[j]){var l=this.sortSelectedIndices(),h=f.get(this.items,l)||[];switch(h.length){case 1:return Z.copy(h[0],{html:h[0][this.itemDisplayField],index:l[0]});case 0:return null;default:return Z.copy({html:h.length+" selections",indices:l},h);}}},dropZone:false,ondragenter:function(h){K(this,h.id);this.set("dropCuePos",N(this,h.tgt));},ondragover:function(h){this.set("dropCuePos",N(this,h.tgt));},ondragleave:function(h){this.set("dropCuePos",null);},ondragstart:function(h){if(!(h&&h.src&&h.src.data)){return false;}},allowCopy:false,ondragend:function(l){var j=l&&l.tgt,h=j&&j.widget;if(h===this){}else{if(this.tree&&h&&h.tree===this.tree){if(!this.allowCopy||!b.ctrlKey(j.hWin,j.e)){var k=l.src&&l.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}}}}},ondrop:function(t){var z=t&&t.src,q=z&&z.data;if(q){var j=N(this,t.tgt,false),w=j&&j.idx,k=(q&&q.constructor===Array);var o=this.items;w=Math.min(w,(o&&o.length)||0);var x=true;if(z.widget===this){x=this.move(this.sortSelectedIndices(),w);}else{this.add(k?q:[q],w);}if(x){var p=k?q.length:1,h={};for(var l=0;l<p;l++){h[w+l]=true;}this.set("selectedIndices",h);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var F=mstrmojo.array,C=mstrmojo.css,G=mstrmojo.string,B=mstrmojo.dom,A="unselected",D="inline-block";mstrmojo.ImageToggle=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ImageToggle",unset:null,useAnimation:true,markupString:'<div class="mstrmojo-ImageToggle {@cssClass}" style="{@cssText}" tabindex="{@tabIndex}"  mstrAttach:click,blur,keydown ></div>',tabIndex:0,markupMethods:{onimageListChange:function(){var O=this.imageList&&this.imageList.slice(),L=this,M=this.unset,K,N,J;if(!G.isEmpty(M)&&O){O.push({n:M,v:M,_ust:true});}if(this.domNode&&O){L.domNode.innerHTML="";L.domNode.style.minHeight=Math.min(20,L.height)+"px";L.domNode.style.minWidth=Math.min(20,L.width)+"px";L._loadedImgs=O.length;mstrmojo.array.forEach(O,function(Q,P){N=document.createElement("div");N.style.cssText="display:none;font-size:0px !important;line-height:"+L.height+"px !important;";J=document.createElement("img");J.alt=J.title=Q.v;J.style.verticalAlign="middle";J.style.maxHeight=L.height+"px";J.style.maxWidth=(L.width-1)+"px";if(!mstrmojo.dom.isIE){J.onerror=function(){this.src="../images/image_not_found.jpg";};}N.appendChild(J);L.domNode.appendChild(N);J.src=Q.n||"../images/image_not_found.jpg";if(Q._ust){L.ustImgIdx=P;}L._imgs[P]=N;});this._setSelectedValue();}},onvalueChange:function(){this._setSelectedValue();}},imageList:null,value:null,selectedIndex:-1,preBuildRendering:function E(){if(this._super){this._super();}this._imgs=[];},_setSelectedValue:function H(){var L=this,K=this.selectedIndex,N=this.imageList;if(N){if(N[K]){L._imgs[K].style.display="none";}F.forEach(this.imageList,function(O,P){if(O.v==L.value){C.removeClass(L.domNode,A);L.selectedIndex=P;L._imgs[P].style.display=D;return ;}});if(this.selectedIndex===-1){if(!this.unset){C.addClass(this.domNode,A);}else{var M=this._imgs[this.ustImgIdx],J=M.lastChild;J.alt=J.title=this.value;M.style.display=D;}}}},onclick:function I(){var L=this.imageList,M=L&&L.length,N=300,T=this.selectedIndex,K=T,J=this.domNode,R,Q,P,S,O=this;P=(T===-1&&this.ustImgIdx!==null)?this._imgs[this.ustImgIdx]:this._imgs[T];T=(T+1)%M;S=this._imgs[T];C.removeClass(J,A);this.selectedIndex=T;if(this.useAnimation){Q=new mstrmojo.fx.FadeIn({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:S,preStart:function(){this.target.style.display=D;}});R=new mstrmojo.fx.FadeOut({duration:N,interval:(B.isIE8?(N/3):(N/10)),target:P,onEnd:function(){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}Q.play();}});if(P){R.play();}else{Q.play();}}else{if(P){P.style.display="none";if(K===-1){O._imgs.splice(O.ustImgIdx,1);J.removeChild(P);delete O.ustImgIdx;}}S.style.display=D;}this.value=this.imageList[T].v;},onkeydown:function(K){var J=K.hWin,L=K.e||J.event;if(L.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(J,L);this.onclick();}}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl");mstrmojo.DefaultDIC=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DefaultDIC",isDummy:true,showInPopup:function(){mstrmojo.alert("The control style has not been supported yet.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRectangle",markupString:'<div id="{@id}" class="mstrmojo-DocRectangle" title="{@tooltip}" style="{@domNodeCssText}"></div>',markupMethods:{onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width+"px";}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["RW","B","background-color","fx"]},preBuildRendering:function A(){var D=this._super(),C=this.defn;if(C.r){this.domNodeCssText+=mstrmojo.css.buildRoundCorners(C.r,C.topc);}return D;},postBuildRendering:function(){var E=this._super();var D=this.fmts;if(D){var C=D.border||D["border-width"],F=C&&(parseInt(C,10)/72*this.model.dpi);if(F){if(D.height=="100%"){this.set("height",this.domNode.clientHeight-2*F);}if(D.width=="100%"){this.set("width",this.domNode.clientWidth-2*F);}}}return E;},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}}});})();(function(){mstrmojo.requiresCls("mstrmojo._TouchGestures","mstrmojo.css","mstrmojo.dom","mstrmojo.hash");mstrmojo.android.ui._IsTouchLink=mstrmojo.provide("mstrmojo.android.ui._IsTouchLink",mstrmojo.hash.copy(mstrmojo._TouchGestures,{_mixinName:"mstrmojo.android.ui._IsTouchLink",ontouchend:function(B){if(!this.linkEnabled){return ;}if(!B.e.handled){var C=this.domNode,A=document.createElement("div"),D=this.id;A.className="activeLink on";C.appendChild(A);window.setTimeout(function(){var E=mstrmojo.all[D];if(E&&E.hasRendered){mstrmojo.dom.attachOneTimeEvent(A,"webkitTransitionEnd",function(){C.removeChild(A);});mstrmojo.css.removeClass(A,"on");}},200);this.onclick();}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo.Container");var A=1;mstrmojo.maps.jsmap.AndroidDocMapInfoWindow=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._HasLayout],{scriptClass:"mstrmojo.maps.jsmap.AndroidDocMapInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild;}},getChildren:function B(){var C=this.model,E=C.getLayoutDataCache(C.getCurrentLayoutKey())[this.psId],D=E.defn.fmts;D.left=A+"px";D.top=A+"px";return[E];}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Container","mstrmojo._Formattable","mstrmojo.EnumRWUnitType");var HTML_CONTAINER=mstrmojo.EnumRWUnitType.HTMLCONTAINER;mstrmojo.DocTextfield=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocTextfield",markupString:'<div id="{@id}" class="mstrmojo-DocTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@v}</div>{@buttonNodeMarkup}</div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","P","background-color","fx","text-align","white-space","overflow"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function update(node){var d=node.data,v=d.v||"";if(node.defn.t===HTML_CONTAINER){var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value;div=null;}this.v=v;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.set("visible",!node.data.hidden);if(this._super){this._super(node);}},postBuildRendering:function postBuildRendering(){var $D=mstrmojo.dom,f=this.getFormats(),rotateValue=f.fx&&f.fx.rt,i,len;if(rotateValue&&!$D.isIE&&$D.supports($D.cssFeatures.TEXT_ROTATION)){var dn=this.domNode;switch(rotateValue){case 1:dn.style.left=(parseInt(f.left,10)+dn.offsetHeight)+"px";break;case 3:dn.style.top=(parseInt(f.top,10)+dn.offsetWidth)+"px";break;}}if(this.defn.t===HTML_CONTAINER){var scripts=this.domNode.getElementsByTagName("script");for(i=0,len=scripts.length;i<len;i++){eval(scripts[i].innerHTML);}}return this._super();},getAnchor:function getAnchor(){return this.valueNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.requiresDescs(9936,9937);var B=25,D=mstrmojo.desc;mstrmojo.android.ui.NoProjectsView=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.android.ui.NoProjectsView",markupString:'<div id="{@id}" class="mstrmojo-NoProjectsView"><div><div class="mstrmojo-NoProjectsViewImage"></div><div class="mstrmojo-NoProjectsViewMsg1">{@msg1}</div><div class="mstrmojo-NoProjectsViewMsg2">{@msg2}</div></div></div>',markupSlots:{wrapperNode:function(){return this.domNode.firstChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},preBuildRendering:function A(){this.msg1=D(9936,"No projects have been configured.");this.msg2=D(9937,"Contact your administrator");},postBuildRendering:function C(){this._super();var E=this.wrapperNode;E.style.marginTop=(-(E.clientHeight/2)-B)+"px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._CanGrowOrShrink","mstrmojo.boxmodel");mstrmojo.DocSubsection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._CanGrowOrShrink],{scriptClass:"mstrmojo.DocSubsection",markupString:'<div id="{@id}" class="mstrmojo-DocSubsection" style="{@domNodeCssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},formatHandlers:{domNode:["D","B","background-color","fx"]},update:function G(H){if(this.thresholdId||H.data.tid){delete this.fmts;}this.thresholdId=H.data.tid;if(this._super){this._super(H);}},postBuildRendering:function E(){var L=this.defn;if(L.hc||L.vc){var H=this.domNode,K=this.getFormats(),M=this.id,J=K.height,I=K.width;L.attachEventListener("resized",M,function(){if("height" in K){H.style.height=K.height;}if("width" in K){H.style.width=K.width;}});L.attachEventListener("adjustSize",M,function(P){var O=H.style,N=O.height;if(L.hc&&O.width!==I){O.width=I;}if(L.vc&&O.height!==J){O.height=J;}this.performCanGrowCanShrink(this.children);P.heightReduced=(parseInt(N,10)>parseInt(O.height,10));});}return(this.renderMode!=="scroll")?this._super():true;},childRenderOnAddCheck:function C(H){return(this.renderMode!=="scroll")?this._super(H):false;},onchildRenderingChange:function B(J){this._super(J);if(this.renderMode!=="scroll"){var H=this.parent.slot,I=H==="fixedHeaderNode"||H==="fixedFooterNode";this.performCanGrowCanShrink([(J&&J.src)||J],I);}},portalMaximized:function D(){var K=this.defn,L=K.vc,I=K.hc;if(!I&&!L){return{};}delete K.vc;delete K.hc;delete K.ck;var J=this.getFormats(),H=this.model,P=this.domNode,M=this;var N={HideIfEmpty:-1};var O=function(T,R,S){var U=T.toLowerCase(),Q=parseInt(P.style[U],10);R=((R===undefined)?Q:Math.max(parseInt(R,10),Q))+"px";if(J[U]!==R){J[U]=R;N[T]=mstrmojo.boxmodel.px2Inches(H,R);delete M["_fixed"+T];}S=S||"";N["Max"+T]=0;N["CanGrow"+S]=0;N["CanShrink"+S]=0;};if(L){O("Height",J.normHeight);}if(I){O("Width",J.normWidth,"Horizontal");}K.raiseEvent({name:"resized"});return N;},adjustSectionSize:function A(){var H=this.defn;if(H.vc||H.hc){return H.raiseEvent({name:"adjustSize"});}return null;},refresh:function F(){if(!this.hasRendered){return ;}var I=this.children||[];for(var H=I.length-1;H>=0;H--){I[H].refresh&&I[H].refresh();}},preserveChildDomOrder:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo.css","mstrmojo.array");var K=mstrmojo.css;var C=2;function N(Q,O,P){var R=Q.parent.parent;if(R&&R instanceof mstrmojo.DocPanel){R[O+"DirtyKey"](P);}}function E(P,O,Q){if(P===O.k){mstrmojo.array.forEach(O.children,function(R){if(R.setDirtyChildren){R.setDirtyChildren(Q);}});}}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,cssDisplay:"block",topStart:C,contentWidth:0,markupString:'<div id="{@id}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="height:100%;width:100%;position:absolute;{@containerNodeCssText}"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx"]},title:"",init:function M(O){this._super(O);if(!this.title){this.title=this.node.defn.ttl||"";}},childRenderCheck:function D(O){return(this._super(O)&&this.selected);},postBuildRendering:function A(){var O=K.addClass;if(!this.defn.l&&!this._forceRender){O(this.domNode,"placeholder");}return this._super();},onselectedChange:function F(O){this.set("visible",!!O.value);if(O.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!O.value});},refresh:function J(){if(!this.hasRendered){return ;}if(!this.selected){if(!this.children){this.builtChildren=false;}this._forceRender=true;this._super();delete this._forceRender;}else{var P=this.children||[],O;for(O=P.length-1;O>=0;O--){P[O].refresh();}if(this._isFP()){this.refreshFP();}}},setDirty:function H(O){var P=((O)?"add":"remove")+"DirtyKey";this[P](this.k);},addDirtyKey:function L(O){var Q=this.defn,P=Q.dirtyKeys||{};P[O]=true;Q.dirtyKeys=P;E(O,this,true);N(this,"add",O);},removeDirtyKey:function G(P){N(this,"remove",P);E(P,this,false);var Q=this.defn,O=Q.dirtyKeys;if(!O){return ;}delete O[P];if(!mstrmojo.hash.isEmpty(O)){return ;}delete Q.dirtyKeys;},renderChildren:function B(){var T=this.children;if(T&&(this._isFP()||this._isFSP())){for(var S=0,O=T&&T.length||0;S<O;S++){T[S].orgPos=S;}T.sort(function(W,Z){var X=(W.getFormats()&&W.getFormats()["z-index"])||0,Y=(Z.getFormats()&&Z.getFormats()["z-index"])||0;return X-Y||W.orgPos-Z.orgPos;});}if(this._isFP()){if(T){var U=this.domNode.clientWidth-2*C;this.topStart=C+1;for(var S=0,O=T&&T.length||0;S<O;S++){var Q=this.domNode.clientWidth-2*C;this.contentWidth=(Q>0)?Q:0;if(Q!=U){this.topStart=C;for(var R=0;R<S;R++){var P=T[R];P.refresh();if(P.getContainerHeight){this.topStart+=P.getContainerHeight()+C;}}}var V=T[S];if(this.childRenderCheck(V)){V.render(null);if(V.getContainerHeight){this.topStart+=V.getContainerHeight()+C;}}}}}else{this._super();}},refreshFP:function(){if(!this.hasRendered){return ;}var R=this.children;this.topStart=C;var P=this.domNode.clientWidth-2*C;this.contentWidth=(P>0)?P:0;for(var Q=0,O=R&&R.length||0;Q<O;Q++){var S=R[Q];if(S.relocate){S.relocate(this.topStart,this.contentWidth);}if(S.getContainerHeight){this.topStart+=S.getContainerHeight()+C;}}},getChildren:function I(){var Q=this.model.getChildren(this.node,false);if(this._isFP()||this._isFSP()){for(var P=0,O=Q&&Q.length||0;P<O;P++){var R=Q[P];if(this._isFP()&&!R.defn.iifp){R.defn.iifp=true;}if(this._isFSP()&&!R.defn.iifs){R.defn.iifs=true;}}}return Q;},_isFP:function(){return this.parent.defn.ifp;},_isFSP:function(){return this.parent.defn.ifsp;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.array");var I=mstrmojo.array,J={containerNode:"100%",node1:"100%",node2:"100%"};mstrmojo.android.ui.ViewSwitcher=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.ViewSwitcher",markupString:'<div id="{@id}" class="mstrmojo-AndroidSwitcher {@cssClass}" style="{@cssText}"><div class="switch-slider"><div class="switch-page"></div><div class="switch-page"></div></div><div class="overlay"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},sliderNode:function(){return this.domNode.firstChild;},node1:function(){return this.domNode.firstChild.firstChild;},node2:function(){return this.domNode.firstChild.lastChild;},overlayNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:J,w:J},getSlots:function E(){var M=this._curSlot||"node1",N=(M==="node1")?"node2":"node1";return{current:this[M],next:this[N],slot:N};},addChildren:function L(O,M,N){I.forEach(O,function(P){if(P.slot==="overlayNode"){P.ignoreLayout=true;}});this._super(O,M,N);},prepareNewView:function H(M,N){M.height=this.height;M.width=this.width;M.visible=true;M.slot=N;},switchView:function D(M,O){var Q=this.getCurrentView();if(M===Q){return ;}var P=this.getSlots(),N=this.getViewController(M),R=this.getViewController(Q);if(Q){if(R&&R.beforeViewHidden){R.beforeViewHidden(O);}}this.prepareNewView(M,P.slot);if(N&&N.beforeViewVisible){N.beforeViewVisible(O);}this.addChildren([M]);if(Q){this.removeChildren(Q);Q.unrender();if(R&&R.afterViewHidden){R.afterViewHidden(O);}}if(N&&N.afterViewVisible){N.afterViewVisible(O);}this.stackViews(P.slot);this.afterSwitch(M);},replaceView:function B(N,O,P){var M=I.indexOf(this.children,O);if(M===-1){return ;}var Q=O.slot;I.forEach([N,O],function(R){if(R.parent===this){this.removeChildren(R,true);R.unrender();if(!P){R.destroy();}}},this);this.prepareNewView(N,Q);this.addChildren([N]);return N;},stackViews:function C(M){I.forEach([1,2],function(N){var O="node"+N,P=this["node"+N];if(P){P.style.zIndex=(O===M)?3:1;}},this);},getCurrentView:function G(){var N=this._curSlot||"node2",M;I.forEach(this.children,function(O){if(O.slot===N){M=O;return false;}});return M;},getViewController:function K(M){return M?M.controller||M:null;},afterSwitch:function F(M){this._curSlot=M.slot;},doLayout:function A(){var N=this.node1.style,M=this.node2.style;N.height=M.height=this.height;N.width=M.width=this.width;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable");mstrmojo.DocImage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocImage",markupString:'<div id="{@id}" class="mstrmojo-DocImage" title="{@tooltip}" style="{@domNodeCssText}"><div style="{@shadowNodeCssText}"><img src="{@v}" style="{@imgNodeCssText}" mstrAttach:click></div>{@buttonNodeMarkup}</div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function C(E){var F=this.model.getDataService(),D=E.data.v;this.v=(F&&F.getDocImage&&F.getDocImage(D))||D;if(this.thresholdId||E.data.tid){delete this.fmts;}this.thresholdId=E.data.tid;this.set("visible",!E.data.hidden);if(this._super){this._super(E);}},formatHandlers:{domNode:["left","top","z-index"],shadowNode:["width","height","B","fx"],imgNode:["height","width"]},preBuildRendering:function B(){if(this._super){this._super();}if(!mstrmojo.dom.isIE7){var D=this.getFormats(),F=(D.fx&&D.fx.ds)||0,E=mstrmojo._Formattable.getBorderWidths(this);this.domNodeCssText+="width:"+((parseInt(D.width,10)||0)+F+E.w)+"px; height: "+((parseInt(D.height,10)||0)+F+E.h)+"px;";}},getAnchor:function A(){return this.imgNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo.ListBase","mstrmojo.android._IsList","mstrmojo.android._IsIncFetchList","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller");var H=mstrmojo.array,J=mstrmojo.hash.copy,G=mstrmojo.TouchScroller.EnumIncFetchEdges,D=G.start,C=50,F=20,B=false;function L(Q,M){if(this.end===null||isNaN(this.end)||this.start===null||isNaN(this.start)){this.ifDirection="h";this.supportedEdges=0;H.forEach(["start","end"],function(R){this.supportedEdges+=isNaN(this[R])?G[R]:0;},this);var P=this,N;this.ifDataHelper=new mstrmojo.Obj({totalSize:-1,next:function O(U,T){var S=[],R=-1;S=S.concat(P.items);if(T===D){for(N=0;N<C;N++){S.splice(0,0,{n:--Q});}S=S.splice(0,C+F);M=Q+C+F-1;R=C;}else{for(N=0;N<C;N++){S.push({n:++M});}S=S.splice(S.length-C-F);Q=M-C-F;R=F-3;}P.set("items",S);window.setTimeout(function(){B=true;P.singleSelect(R);},0);U.success({items:undefined});}});}}mstrmojo.android.ui.CalendarYearList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo.android._IsIncFetchList],{scriptClass:"mstrmojo.android.ui.CalendarYearList",years:undefined,scrollerConfig:{bounces:false,showScrollbars:false,scrollPast:true},getItemMarkup:function(N,M){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}"><span>{@n}</span><div class="marker"></div></{@tag}>';},postCreate:function K(O){if(this._super){this._super();}var Q=(this.start)||(new Date(0)).getFullYear(),M=(this.end)||((new Date()).getFullYear()+5),P=Q,N=this.items=this.items||[];while(M>=P){N.push({n:P++});}L.call(this,Q,M);},postBuildRendering:function A(){this._super();var M=this.ITEMS_NODE_WIDTH=this.itemsNode.clientWidth;this.updateScroller();this.singleSelectByField(this.initialYear,"n");this._scroller.attachEventListener("scrollDone",this.id,function(N){var Q=(N.x+(parseInt(this.width,10)-M)/2)/M,P=Math.floor(Q),O=P;O+=((Q-P)>0.3)?1:0;if(O!==this.selectedIndex){this.singleSelect(O);}else{this.onchange();}});},onchange:function(){var M=this.selectedIndex;if(M>=0){var O=this.ITEMS_NODE_WIDTH,N=(M*O)-(parseInt(this.width,10)-O)/2;this._scroller.scrollTo(N,undefined,B?0:200);this.raiseEvent({name:"yearChanged",value:this.selectedItem.n});B=false;}},updateScrollerConfig:function E(){var N=this._super(),P=this.itemsContainerNode,M=parseInt(this.width,10);if(isNaN(M)){M=this.domNode.clientWidth;}N.scrollEl=P;N.noVScroll=true;N.origin=N.origin||{x:0,y:0};var Q=Math.max(P.clientWidth-M,0),O=N.hScroll=(Q!==0);if(O){N.offset={x:J({start:0,end:Q},N.offset&&N.offset.x)};}else{N.offset=undefined;}return N;},destroy:function I(){if(this.ifDataHelper){this.ifDataHelper.destroy();delete this.ifDataHelper;}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo.Container");var A=1;mstrmojo.maps.androidmap.AndroidDocMapInfoWindow=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._HasLayout],{scriptClass:"mstrmojo.maps.androidmap.AndroidDocMapInfoWindow",markupString:'<div class="mstrmojo-androidmap-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-androidmap-DocInfoWindow"></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild;}},getChildren:function B(){var C=this.model,E=C.getLayoutDataCache(C.getCurrentLayoutKey())[this.psId],D=E.defn.fmts;D.left=A+"px";D.top=A+"px";return[E];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo._HasLayout","mstrmojo._ShowsStatus");function E(J){var I=this.domNode,H=parseInt(this[J.toLowerCase()],10);return(isNaN(H))?I["offset"+J]:H;}mstrmojo.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasScrollbox,mstrmojo._HasLayout,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-DocLayoutViewer {@cssClass}" style="{@domNodeCssText}"><div></div><div><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_fh"></div><div id="{@id}_scrollboxNode" class="mstrmojo-DocLayoutViewer-layout" style="{@_scrollCssText}"></div><div id="{@id}_ff"></div></div><div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}}},markupSlots:{groupBy:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.childNodes[1].childNodes[2];},scrollboxNode:function(){return this.domNode.childNodes[1].childNodes[2];},containerNode:function(){return this.domNode.childNodes[1].childNodes[2];},incFetchNode:function(){return this.domNode.lastChild;},fixedHeaderNode:function(){return this.domNode.childNodes[1].childNodes[1];},fixedFooterNode:function(){return this.domNode.childNodes[1].childNodes[3];},_STATUS:function(){return this.domNode.childNodes[1].firstChild;},_STATUS_TXT:function(){return this.domNode.childNodes[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;}},layoutConfig:{h:{groupBy:"auto",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"auto"},w:{layout:"100%"}},scrollboxHeightFixed:true,scrollboxWidthFixed:true,getHeight:function G(){return E.call(this,"Height");},getWidth:function B(){return E.call(this,"Width");},afterLayout:function A(){this._super();this.notifyScrollListeners();},preBuildRendering:function D(){if(this.parent){var J=this.parent[this.slot].style,I=this.height,H=this.width;this.height=(I!=="auto")?I:J.height;this.width=(H!=="auto")?H:J.width;}this.zf=this.model.zf;this.bs=this.model.bs;return this._super?this._super():true;},setSlotDimensions:function F(J,I,H){if(J==="layout"){this.scrollboxHeight=parseInt(I,10);this.scrollboxWidth=parseInt(H,10);}this._super(J,I,H);},onaddChild:function C(H){if(!isNaN(H.index)){var I=this.children[H.index];if(I&&I.slot==="groupBy"){this.docGroupBy=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._Formattable","mstrmojo._HasToolbar");var B="\u001E";var F=1;var H=2;var I={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3,vert:["height","width","top"],horiz:["width","height","left"],updateStyle:function(K){var N=K.defn.qsm;if(!N){return ;}if(K.getFormats().width){return ;}var O=null;if(N==F){O=K.containerNode.firstChild;}else{O=K.containerNode.lastChild;}if(!O){return ;}var L=O.clientHeight+"px";var J=O.clientWidth+"px";var M=K.domNode.style;M.height=L;M.width=J;if(K.parent.updateStyle){K.parent.updateStyle(L,J);}},repositionChildren:function(P){var O=P.getFormats(),N=parseInt(O.height,10),S=parseInt(O.width,10);var J=P.children,M=J[0].getFormats(),U=J[1].getFormats();var K=(P.defn.gp<this.LEFT),R=(K)?N:S,Q=(K)?S:N,T=this[((K)?"vert":"horiz")];var L=Math.round(R*(P.defn.ga/100));M[T[0]]=L+"px";M[T[1]]=Q+"px";U[T[0]]=(R-L)+"px";U[T[1]]=Q+"px";if((P.defn.gp%2)===0){U[T[2]]=L+"px";}else{M[T[2]]=(R-L)+"px";}this.resizeChildren(J[0],J[1]);},stackChildren:function(J){var M=J.children,N=J.getFormats(),L;for(var K=M.length-1;K>=0;K--){L=M[K].getFormats();L.width=N.width;L.height=N.height;}this.resizeChildren(M[0],M[1]);},resizeChildren:function(L,J){L.renderPortalState();var K=J.getFormats();J.resizeForDisplayState(parseInt(K.height,10),parseInt(K.width,10),true);},changeVisibility:function(L,J){var O=L.children,N=L.defn.qsm,K=J&&(!N||L.viewMode===F),M=J&&(!N||L.viewMode===H);if(O&&O.length>0){if(O[0].visible!==K){O[0].set("visible",K);}if(O[1].visible!==M){O[1].set("visible",M);}}L.visible=J;},setViewMode:function G(K){var L=K.children,M=K.visible;if(K.defn.qsm&&L&&L.length>0){var J=K.viewMode;L[0].set("visible",(J==F)&&M);L[1].set("visible",(J==H)&&M);}},clearFormatCache:function C(K){var M=K.children;for(var L=0,J=M&&M.length||0;L<J;L++){M[L].clearCache();}}};mstrmojo.DocGridGraph=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocGridGraph",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocGridGraph" style="{@domNodeCssText}"><div class="mstrmojo-DocGridGraph-msg"></div><div class="mstrmojo-DocGridGraph-container"></div></div>',markupSlots:{msgNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW","B","background-color","fx","font"]},viewMode:null,visible:true,resize:function D(){this.clearCache();I.clearFormatCache(this);var L=this.getFormats(),J=parseInt(L.width,10),K=parseInt(L.height,10);if(J>0&&K>0){I.changeVisibility(this,true);if(!this.defn.qsm){I.repositionChildren(this);}else{I.stackChildren(this);}}else{I.changeVisibility(this,false);}},postBuildRendering:function A(){this._super();var L=this.node.data.eg;if(L===undefined){this.msgNode.style.display="none";this.containerNode.style.display="block";}else{this.msgNode.innerHTML=L;this.msgNode.style.display="block";this.containerNode.style.display="none";}var K=this.defn.qsm;if(!this.viewMode&&K){this.viewMode=K;}var J=this.node.defn;J.attachEventListener("qsmChange",this.id,function(M){this.viewMode=M.value;I.setViewMode(this);this.model.getDataService().setQuickSwitchViewMode(this.defn.tt+B+this.k,this.viewMode);I.updateStyle(this);});I.setViewMode(this);I.updateStyle(this);if(!K){this.resize();}},getGridWidget:function(){return this.children[0];},getGraphWidget:function(){return this.children[1];},updateGraph:function(K){var J=this.getGraphWidget();if(J){J.update(K);J.refresh();}},quickSwitch:function E(){var J=this.viewMode!=H;this.defn.set("qsm",(J?H:F));return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._IsPanelStack","mstrmojo._IsSelectorTarget","mstrmojo._HasBuilder","mstrmojo._HasTouchScroller","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo.css");var T=mstrmojo.css,E=mstrmojo.dom,K=Math,A=700;function G(){var U=this._animHandle;if(U){window.clearTimeout(U);delete this._animHandle;}}function D(){delete this._animHandle;this._isAnimating=false;}function J(Z,Y,X,W){var V=this._translateX;if(X||Y!==V){this._translateX=Y;G.call(this);if(Z){this._isAnimating=true;}var U=this.containerNode.style;U[E.CSS3_TRANSITION_DURATION]=Z+"ms";U[E.CSS3_TRANSFORM]=E.createTranslateString(-Y);if(W){var a=this.id;this._animHandle=window.setTimeout(function(){var b=mstrmojo.all[a];if(mstrmojo.all[a]._isAnimating){D.call(b);}},Z*3);}if(this._scroller){this._scroller.raiseEvent({name:"transformAnim",x:Y,y:0});}}}function C(){if(!this.defn.dk){return ;}var b=this.children,Z=0,U=b.length,Y=this.selectedIdx,a=[];for(Z=0;Z<U;Z++){a.push('<div idx="'+Z+'" class="');if(Z===Y){a.push("on");}a.push('"><div></div></div>');}var W=this.selectorBtns,V=mstrMobileApp.getDeviceDPI();var X={160:26,213:26,240:38,320:57},d=X[V]||(X[160]*V/160);W.style.width=(U*d)+"px";W.innerHTML=a.join("");this.selector.style.display="block";}mstrmojo.android.DocPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._HasBuilder,mstrmojo._HasTouchScroller,mstrmojo._IsPanelStack,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.DocPanelStack",btnMarkup:"",markupString:'<div id="{@id}" title="{@tooltip}" class="mstrmojo-DocPanelStack {@cssClass}" style="{@domNodeCssText}"><div></div><div class="mstrmojo-PanelSelector"><div class="mstrmojo-SelectorBtns"></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},selector:function(){return this.domNode.lastChild;},selectorBtns:function(){return this.domNode.lastChild.firstChild;}},formatHandlers:{domNode:["RW","B"]},scrollerConfig:{bounces:false,showScrollbars:false,vScroll:false,hScroll:true},addChildren:function I(b,f,d){this._super(b,f,d);var a=this.containerNode.style,e=this.getFormats(),V=this._pnlWidth=parseInt(e.width,10),g=parseInt(e.height,10),Y=this.selectedIdx;var X=this.selectedIdx*V;a.width=(V*b.length)+"px";if(!E.isWinPhone){J.call(this,0,X);}else{a.msTransform=X;}var Z=0,W=b.length;for(Z=0;Z<W;Z++){var U=b[Z];U.visible=true;U.selected=(Z===Y);U.updatePanelDimensions(Z*V,g,V);}C.call(this);this.updateScroller();return true;},postBuildRendering:function R(){this._super();C.call(this);var U=this.id;mstrmojo.dom.attachEvent(this.containerNode,E.CSS3_TRANSITION_END,function(V){var W=mstrmojo.all[U];if(V.target!==W.containerNode){return true;}G.call(W);V.stopPropagation();D.call(W);return false;});return true;},setInfoWindowDimensions:function S(Z){var a=this.parent;if(a.scriptClass==="mstrmojo.DocPortlet"){a.setInfoWindowDimensions(Z);}var W=Z.h,e=Z.w,U=this.domNode.style,Y=this.children,X=Y.length,b="px",V;U.height=W+b;U.width=e+b;this.containerNode.style.width=(e*X)+b;this._pnlWidth=e;this._translateX=(this.selectedIdx||0)*e;for(V=0;V<X;V++){Y[V].updatePanelDimensions(V*e,W,e,true);}this.updateScroller();},getTitle:function H(){return this.title;},initScroller:function M(U){U.attachEventListener("scrollDone",this.id,function(V){this._translateX=V.x;});},updateScrollerConfig:function Q(){var W=this.children,Y=W&&W.length,V=this._super();V.noVScroll=true;if(Y){var U=this._translateX||0,X=this._pnlWidth,Z;Z={start:K.max(U-X,0),end:K.min(U+X,Y*X-X)};mstrmojo.hash.copy({scrollEl:this.containerNode,offset:{x:Z,scrollPast:false},origin:{x:U,y:0}},V);}return V;},onselectedIdxChange:function B(V){var U=this.selectorBtns,W=U&&U.childNodes;if(W){T.addClass(W[V.value],"on");T.removeClass(W[V.valueWas],"on");}},onselectedKeyChange:function F(W){this._super(W);var X=this._pnlWidth,V=this.selectedIdx*X;if(E.isWinPhone){var U=this.containerNode;U.style.position="relative";(new mstrmojo.fx.AnimateProp({props:{left:{isStyle:true,start:V,stop:this.prevSelectIdx*X,suffix:"px",ease:mstrmojo.ease.linear}},duration:0,target:U})).play();}else{J.call(this,0,V);}this.updateScroller(true);},touchBegin:function N(U){if(this._isAnimating){U.stop();return false;}if(!this.defn.sw&&!E.contains(this.selector,U.target,true,this.domNode)){return false;}return this._super(U);},touchTap:function P(a){var Y=a.target,V=this.domNode;if(E.contains(this.selector,Y,true,V)){var Z=this.selectorBtns,W=-1;if(E.contains(Z,Y,true,V)){W=E.findAncestorByAttr(Y,"idx",true,Z).value;}else{W=this.selectedIdx+((a.clientX-V.offsetLeft<(this._pnlWidth/2))?-1:1);}if(W>-1){var U=this.children[W];if(U){this.selectPanel(U.k);}}}else{var X=this.controller;if(X&&X.viewTap){X.viewTap();}}},touchSwipeBegin:function L(U){if(this.defn.sw||E.contains(this.selector,U.target,true,this.domNode)){return this._super(U);}return this.bubbleTouchEvent(U);},touchSwipeEnd:function O(X){X.evt.handled=true;mstrmojo.TouchScroller.ScrollIndicators.hideAll();var a=this._translateX||0,U=this._pnlWidth,W=this._scroller.offset.x,Y=K.max(K.min(a-X.delta.x,W.end),W.start),d=a-Y,Z=K.abs(d),V=A,b=(Z<U*0.2);if(b){Y=a;V*=Z/U;}else{Y=a+((d<0)?U:-U);V*=(U-Z)/U;}J.call(this,K.round(V),Y,true,b);this.selectPanel(this.children[Y/U].k,true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren","mstrmojo._CanRenderDocOnScroll","mstrmojo.dom");mstrmojo.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren,mstrmojo._CanRenderDocOnScroll],{scriptClass:"mstrmojo.DocLayout",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},popupNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["B","background-color","D","min-height","width"]},alias:"docLayout",markupMethods:{onminHeightChange:function(){var N=this.minHeight;if(!N){var M=this.getFormats();N=M&&M["min-height"];}if(N){this.containerNode.style[mstrmojo.css.MINHEIGHT]=N;}}},getHeight:function E(){var M=0;mstrmojo.array.forEach(this.children,function(N){M+=N.height();});return M||this.containerNode.offsetHeight;},getWidth:function I(){var M=this.children;return(M&&M.length)?M[0].width():this.containerNode.offsetWidth;},preBuildRendering:function K(){var M=this.getFormats();if(M&&M["min-width"]!==undefined){M.width=M["min-width"];}this._super();},renderChildren:function L(){this._super();this.resizeOrReposition();},resizeOrReposition:function D(){var O=this.containerNode;if(!!this.defn.aw){var U=this.model.getAutoWidthIDs(),S=(U&&U.length)||0,Y=0,X=mstrmojo.all,P;if(!S){return ;}for(P=0;P<S;P++){Y=Math.max(this._getWidgetRightMostPosition(X[U[P]]),Y);}Y=Math.max(this.getLayoutMinWidth(),Y);if(Y>parseInt(this.getFormats().width,10)){O.style.width=Y+"px";}}var W=this.model.zt;if(mstrApp.isMobile&&W){var M=this.parent.domNode;if(M){var Q=this.model.controller,N=!!Q.orientation,Z=0,V=this.parent,R=V.getHeight()-V.fixedHeaderNode.clientHeight-V.fixedFooterNode.clientHeight;if(W===2){if(!Q.toolBarDelegated){R-=Q.getBottomToolBarHeight();}Z=Math.round(N?Math.max((R-this.getHeight()),0)/2:0)+"px";}O.style.margin=Z+" auto";var T=this;window.setTimeout(function(){Q.nudgeWidget(T.id,{left:O.offsetLeft,top:O.offsetTop});},0);}}},getLayoutMinWidth:function F(){return 0;},_getWidgetRightMostPosition:function F(M){return parseInt(M.getFormats().left,10)+(M.getDim&&M.getDim().w||M.domNode.offsetWidth);},renderCtrlsInViewport:function C(){this._super();this.resizeOrReposition();},adjustAutoWidth:function H(M){if(!this.defn.aw||!M){return ;}var O=this.containerNode.style,N=parseInt(O.width,10)||0;var P=this;window.setTimeout(function(){var Q=P._getWidgetRightMostPosition(M);if(Q>N){O.width=Q+"px";}},1);},_getModelChildNodes:function B(P,O,S,N,R){var Q=this.model.getNonFixedSections(P,O);var M=Q.length;N=isNaN(N)?M:N;S=S||0;if(S>0||N<M){Q=Q.slice(S,S+N);}return R?{nodes:Q,total:M}:Q;},getChildren:function G(O,N,Q,M,P){return this._getModelChildNodes(O||this.node,N||false,Q,M,P);},getCaptureDimensions:function J(){var N=this.domNode,M={};if(!this.domNode){return ;}M=mstrmojo.dom.position(N);M.w=Math.min(N.offsetWidth,M.w);M.h=Math.min(N.offsetHeight,M.h);return M;},preserveChildDomOrder:false,postBuildRendering:function A(){if(window.mstrMobileApp!==undefined){this.defn.lastOrientation=mstrMobileApp.getOrientation();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.ImageToggle","mstrmojo._IsInputControl");mstrmojo.ToggleDIC=mstrmojo.declare(mstrmojo.ImageToggle,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ToggleDIC",init:function(A){this._super(A);this.unset=this.dic.ust;},focus:function(){this.domNode.focus();},onvalueChange:function(){},onblur:function(B){var A=B.e||B,C=this.domNode,D=mstrmojo.boxmodel.offset(C,document.body);if(A.clientX>D.left&&A.clientX<D.left+C.offsetWidth&&A.clientY>D.top&&A.clientY<D.top+C.offsetHeight){this.domNode.focus();}else{this.applyChanges();}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var A=this.openerStyle;this.width=A.iw;this.height=A.ih;this.set("imageList",this.dic.vls);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Image","mstrmojo._TouchGestures");mstrmojo.android.ui.Image=mstrmojo.declare(mstrmojo.Image,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Image",touchTap:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._TouchGestures");mstrmojo.ui.MobileStepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.ui.MobileStepper",onclick:function D(I){if(!mstrApp.isTouchApp()){this._super(I);}return false;},onmousedown:function A(I){if(!mstrApp.isTouchApp()){this._super(I);}return false;},onmouseup:function C(I){if(!mstrApp.isTouchApp()){this._super(I);}return false;},touchSelectBegin:function B(I){this.startStepperInterval(I,"touchTap");},touchSelectEnd:function G(I){this.stopStepperInterval();},touchTap:function F(I){this.processEvent(I.target);},touchBegin:function H(J){var I=J.target;if(I==this.nextNode||I==this.prevNode){mstrmojo.css.addClass(I,"glow");}},touchEnd:function E(J){var I=J.target;if(I==this.nextNode||I==this.prevNode){mstrmojo.css.removeClass(I,"glow");}}});mstrmojo.ui.MobileStepper.prototype.markupString=mstrmojo.ui.MobileStepper.prototype.markupString.replace(",mousedown,mouseup","");}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.Button","mstrmojo.url");mstrmojo.requiresDescs(1442,2140);var A=mstrmojo.Button.newInteractiveButton;mstrmojo.android.inputControls.SignatureDIC=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.SignatureDIC",markupString:"<div></div>",hasSignature:false,showInPopup:function C(){var F=this.ownerCell||this.owner;if(F.mdf){var G=this;mstrmojo.confirm("Continuing will erase the existing signature. Do you want to proceed?",[A(mstrmojo.desc(2140,"Cancel"),null,null),A(mstrmojo.desc(1442,"Ok"),function(){G.captureSignature();},null)]);}else{this.captureSignature();}},captureSignature:function B(){mstrMobileApp.captureSignature(JSON.stringify({serverURL:mstrApp.getConfiguration().getTaskUrlByProject(mstrApp.getCurrentProjectId()),sessionState:mstrApp.getSessionState(),showGuideLine:this.dic.sgl}),'mstrmojo.all["'+this.id+'"].signatureCaptured');},signatureCaptured:function D(F){this.value=mstrmojo.url.getAbsoluteURL(F,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());this.applyChanges();},renderPreview:function E(){var I="",G=this.ownerCell||this.owner,H=this.openerNode,F=this.value;if(G.mdf&&/^(http|https).+(png|jpg)$/.test(F)){I='<img src="'+this.value+'" style="max-height:'+H.clientHeight+"px;max-width:"+(H.clientWidth-30)+'px;"></img>\u00a0';}this.renderPreviewButton(H,I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.css","mstrmojo.hash");var H=mstrmojo.css,D=mstrmojo.hash,B="glow";var F=mstrmojo.android.ui.Button=mstrmojo.declare(mstrmojo.Button,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Button",onclick:mstrmojo.emptyFn,touchBegin:function E(){if(this.enabled){H.addClass(this.domNode,B);}},touchTap:function C(J){if(this.enabled){this.onclick({e:J.evt});}},touchSelectBegin:mstrmojo.emptyFn,touchSelectEnd:function A(J){if(this.enabled){this.onclick({e:J.evt});}},touchEnd:function I(){H.removeClass(this.domNode,B);}});F.prototype.markupString=F.prototype.markupString.replace(new RegExp(" mstrAttach:[a-zA-Z,]*"),"");F.newButton=function G(M,L,K){var J={scriptClass:"mstrmojo.android.ui.Button",text:M};if(L){J.onclick=L;}D.copy(K,J);return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.OfflineTransactionModel","mstrmojo.Button");mstrmojo._CanSupportOfflineTransactions=mstrmojo.provide("mstrmojo._CanSupportOfflineTransactions",{_mixinName:"mstrmojo._CanSupportOfflineTransactions",getTransactionNotificationController:function A(){var E=this.txNtfCtlr;if(this.oflnTxModel&&(!E||!mstrmojo.all[E.id])){E=this.txNtfCtlr=mstrApp.controllerFactory.newController("Transactions",{model:this.oflnTxModel,rootCtrl:mstrApp.rootController});}return E;},submitTransactionQueue:function C(E,F){mstrMobileApp.submitOfflineTransactions(E,F,"mstrApp.onSubmitTransactionQueueDone");},onSubmitTransactionQueueDone:function B(E,F){if(this.oflnTxModel){this.oflnTxModel.onSubmitDone(E);}if(E){mstrApp.rootController.generateActionToolbar();mstrmojo.toast(mstrmojo.desc(9724,"All pending transactions have been successfully submitted"));}else{mstrmojo.toast(mstrmojo.desc(9261,"A background transaction submission failed"));}},submitOfflineTransaction:function D(){if(this.oflnTxModel){this.oflnTxModel.submitOfflineTransaction();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Calendar","mstrmojo._TouchGestures");mstrmojo.MobileCalendar=mstrmojo.declare(mstrmojo.Calendar,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.MobileCalendar",cssPrefix:"mobile-calendar",monthNames:function(C){return mstrmojo.locales.datetime.MONTHNAME_FULL[C];},supportedViews:{day:true,month:true,year:true},premousedown:function A(C){if(!mstrApp.isTouchApp()){return this._super(C);}},touchTap:function B(C){this.processEvent(document.elementFromPoint(C.pageX,C.pageY));return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo.array","mstrmojo.css");var G=mstrmojo.array,H=mstrmojo.css,E=Math,A="fixed";function F(R,S){var O=this.domNode,N=O.clientWidth,Q=this._itemSizeMap,M=R-1,P=R+1;S=S||0;G.forEach(this.itemsContainerNode.childNodes,function(V,T){var W=0;if(T===R){W=(N/2)-(Q[T]/2);}else{if(T===P){W=N-Q[T];}else{if(T!==M){W=-(N/2);if(T>P){W=N+(-1*W);}}}}var U=E.round(W+S/2)+"px";if(V.style.left!==U){V.style.left=U;}V.style.left=(W+S/2)+"px";});}mstrmojo.android.ui.ScrollableTabs=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList],{scriptClass:"mstrmojo.android.ui.ScrollableTabs",multiSelect:false,init:function L(M){this._super(M);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ScrollableTabs");},setCurrentTab:function K(M){this.clearSelect();this.singleSelect(M,true);this.itemRenderer.select(this._getItemNode(M),this.items[M],M,this);F.call(this,M);},tabSelected:mstrmojo.emptyFn,postitemsChange:function B(){var O=this._itemSizeMap=[],M=this.items,N=this.domNode;if(M&&M.length){G.forEach(this.itemsContainerNode.childNodes,function(Q,P){O[P]=Q.offsetWidth;});}else{this.set("visible",false);}H.addClass(N,A);F.call(this,E.max(this.selectedIndex||0,0));window.setTimeout(function(){H.removeClass(N,A);},0);},postselectionChange:function C(M){var N=M.added;if(N){this.tabSelected(this.items[N[0]]);}},enterScroll:function I(){H.addClass(this.domNode,A);},scroll:function J(M){F.call(this,this.selectedIndex,M);},exitScroll:function D(M){H.removeClass(this.domNode,A);this.setCurrentTab(M);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.android._IsList","mstrmojo._TouchGestures","mstrmojo.dom","mstrmojo.css");function C(){var E=this._tchHandler;if(E){E.clear();delete this._tchHandler;}this.clearSelect();mstrApp.setMenuStatus(this.id,false);}mstrmojo.android.ui.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Menu",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ActionMenu");this._lastVisible=this.visible;},setMaxWidth:false,markupMethods:{onvisibleChange:function(){var E=!!this.visible,G=this.domNode,F=G.style;F.display=(E)?this.cssDisplay:"none";if(this.parent&&this.parent.propogateMenuVisibleChange&&E!=this._lastVisible){this._lastVisible=E;this.parent.propogateMenuVisibleChange(E);}if(E&&this.setMaxWidth){F.maxWidth=(Math.round(mstrApp.getScreenDimensions().w*0.98)-mstrmojo.dom.position(G).x)+"px";}}},onvisibleChange:function B(E){if(E.value){var F=this.id;this._tchHandler=mstrmojo.touchManager.attachEventListener("touchesBegin",F,function(G){if(G.srcId!==F){this.set("visible",false);G.ignore=true;}});mstrApp.setMenuStatus(F,true);}else{C.call(this);}},onUnRender:function A(){C.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo._HasTouchScroller","mstrmojo.android.selectors._SupportsHoriz","mstrmojo.color","mstrmojo.css");function E(F){return function(K,L,G,N){var J=K.style,I="remove",M="transparent",H="inherit";if(F){I="add";M=N.selColor;H=N._txtColor;}J.backgroundColor=M;J.color=H;mstrmojo.css[I+"Class"](K,mstrmojo.android._IsList.SELECTED_CLS);};}mstrmojo.android.selectors.LinkBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList,mstrmojo._HasTouchScroller,mstrmojo.android.selectors._SupportsHoriz],{scriptClass:"mstrmojo.android.selectors.LinkBar",selColor:"#60b1f6",minItemHeight:29,getItemMarkup:function(G){var F=this._itemMarkup;if(!F){this._itemMarkup=F=this._super(G).replace("{@n}",'<div>{@n}<div style="background-color:'+(this.parent.getFormats().color||"#000")+';"></div></div>');}return F;},getItemProps:function C(H,F){var G=this._super(H,F);if(G.sel){G.style+="color:"+this._txtColor+";background-color:"+this.selColor+";";}return G;},preBuildRendering:function B(){this.cssClass+=" selector-linkbar";this._txtColor=mstrmojo.color.getContrastingColor(this.selColor,["#ffffff","#000000"]);return this._super();}});var D=mstrmojo.android.selectors.LinkBar.prototype,A=D.itemRenderer;D.itemRenderer={render:A.render,select:E(true),unselect:E(false)};}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo._HasTouchScroller","mstrmojo.android.selectors._SupportsHoriz","mstrmojo.css");var B,A=/line-height:(\d*)px/,C=mstrmojo.css;function G(I){if(this.parent.defn.ct!=="4"){return ;}mstrmojo.css[((I)?"add":"remove")+"Class"](this.domNode,"glow");}mstrmojo.android.selectors.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList,mstrmojo._HasTouchScroller,mstrmojo.android.selectors._SupportsHoriz],{scriptClass:"mstrmojo.android.selectors.ButtonBar",cssClass:"selector-btnbar",getItemMarkup:function F(I){if(!B){B=this._super(I).replace("{@n}","<div>{@n}</div>");}return B;},getItemProps:function D(M,I){var L=this._super(M,I),K=L.style,J=K.match(A);if(J){L.style=K.replace(A,"line-height:"+(parseInt(J[1],10)-2)+"px");}return L;},touchBegin:function H(){G.call(this,true);},touchEnd:function E(){G.call(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo.android._IsList","mstrmojo._HasTouchScroller","mstrmojo.android.selectors._SupportsHoriz","mstrmojo.css");mstrmojo.android.selectors.CheckList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._TouchGestures,mstrmojo.android._IsList,mstrmojo._HasTouchScroller,mstrmojo.android.selectors._SupportsHoriz],{scriptClass:"mstrmojo.android.selectors.CheckList",hasEvenRows:true,init:function A(C){this._super(C);var B=["selector-checklist"];if(this.multiSelect){B.push("multi");}mstrmojo.css.addWidgetCssClass(this,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo.android._IsList","mstrmojo.android._HasLingeringListSelections","mstrmojo._TouchGestures","mstrmojo.css");var A,C=mstrmojo.dom,B=C.CSS3_TRANSITION_DURATION;mstrmojo.android.ui.ActionToolbarButtons=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo.android._HasLingeringListSelections,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.ActionToolbarButtons",init:function G(H){this._super(H);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ActionToolbar-buttons");},cssDisplay:"table",icnCssText:"display:table-row",getItemMarkup:function F(H){if(!A){A=this._super(H).replace(">{@n}",' title="{@n}"><div></div>');}return A;},getItemProps:function D(J,H){var I=this._super(J,H);I.addCls(J.cls);return I;},listHooks:{select:function(H){H.style[B]=0;this.setClearHandler(200);},unselect:function(H){H.style[B]="300ms";}},preselectionChange:function E(H){if(H.added){return !!this.parent.active;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.android._IsList","mstrmojo.css","mstrmojo.dom","mstrmojo.array");var K=mstrmojo.dom,L=mstrmojo.css;function F(T,Q){var R=K.findAncestorByAttr(T.target,"idx",true,this.domNode);if(R){var P=R.value,S=this.itemRenderer;S[Q](R.node,this.items[P],P,this);}}mstrmojo.android.SimpleList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.SimpleList",scrollerConfig:{bounces:false,showScrollbars:false},highlightOnSelect:false,hasEvenRows:false,rowHeight:-1,itemsFloat:false,init:function O(P){this._super(P);if(!mstrApp.isTouchApp()){L.addWidgetCssClass(this,["hosted"]);}},updateItem:function C(P){var T=document.createElement("div"),R=this.items[P],Q=this;T.innerHTML=this.itemRenderer.render(this.items[P],P,this);var S=T.firstChild;this.itemsContainerNode.replaceChild(S,this._getItemNode(P));mstrmojo.array.forEach(R.dependents,function(U){Q.updateItem(U._renderIdx);});return S;},setDimensions:function N(R,Q){if(this.height!==R||this.width!==Q){this.height=R;this.width=Q;var P=this.domNode;if(P){P.style.height=R;P.style.width=Q;this.updateScroller();}}},buildRendering:function H(){var P=this._super();if(this.itemsFloat){var Q=document.createElement("div");Q.className="clear-me";this.itemsContainerNode.appendChild(Q);}return P;},updateScrollerConfig:function J(){var P=this._super(),T=this.itemsContainerNode,R=parseInt(this.height,10);if(isNaN(R)){R=this.domNode.clientHeight;}P.scrollEl=T;P.noHScroll=true;P.origin=P.origin||{x:0,y:0};var S=P.offsetIdx;if(S){delete P.offsetIdx;P.origin.y=this.getItemOffset(S);}var U=Math.max(this.getItemsContainerHeight()-R,0);var Q=P.vScroll=(U!==0&&P.noVScroll!==true);if(Q){P.offset={y:{start:0,end:U}};}else{P.offset=null;}return P;},getItemOffset:function E(P){var Q=this._getItemNode(P);return Math.max(Q.offsetTop-parseInt(L.getStyleValue(Q,"marginTop"),10),0);},getOffsetIndex:function B(){var T=this.scrollerConfig,Y=T&&T.origin,U=Y&&Y.y;if(U){var P=this.rowHeight;if(this.hasEvenRows&&P!==-1){return Math.round(U/P);}var Q=this.itemsContainerNode.childNodes,S=0,V=Q.length-1;while(V>=S){var X=S+V>>1,W=Q[X],R=W.offsetTop,Z=W.offsetHeight;if(U<R-Z){V=X-1;}else{if(U>R+(Z*2)){S=X+1;}else{return X;}}}}return 0;},scrollToItem:function D(Q,R){var P=this._scroller;if(P){P.scrollTo(0,this.getItemOffset(Q),R||0);}},getItemsContainerHeight:function G(){var S=this.hasEvenRows,Q;if(!S||this.rowHeight===-1){if(S){var R=this._getItemNode(0);if(R){this.rowHeight=R.offsetHeight;}}else{this.rowHeight=-1;}Q=this.itemsContainerNode.offsetHeight;}else{var P=this.items;Q=(this.rowHeight*((P&&P.length)||0));}return Q;},touchSelectBegin:function I(P){if(this.highlightOnSelect){F.call(this,P,"select");}this._super(P);},touchSelectMove:function M(P){this._selectMove=true;this._super(P);},touchSelectEnd:function A(Q){var P=this._selectMove;delete this._selectMove;if(!P){this.touchTap(Q);}else{if(this.highlightOnSelect){F.call(this,Q,"unselect");}}},touchend:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(E,D){if(!A){var F=this.itemField;A=this._super(E).replace(">{@n}<",' title="{@'+F+'}">{@'+F+"}<");}return A;},getItemProps:function C(F,D){var E=this._super(F,D),G=this.itemField;E[G]=F[G];return E;},onclick:function B(D){this._super(D);var E=this.parent,G=E.opener;G.suggestionShown=false;var F=this.selectedItem;if(F){G.handleSuggestionItemSelect(F);}E.close();},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems"}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._TouchGestures");mstrmojo.android.ui.Label=mstrmojo.declare(mstrmojo.Label,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.Label",touchTap:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasTouchScroller","mstrmojo._TouchGestures");mstrmojo.android.TextArea=mstrmojo.declare(mstrmojo.Label,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.TextArea",markupString:'<div id="{@id}" class="mstrmojo-TextArea {@cssClass}" style="{@cssText}"><div>{@text}</div></div>',markupMethods:{ontextChange:function(){this.domNode.firstChild.innerHTML=this.text||"";},oncssTextChange:function(){this.domNode.style.cssText=this.cssText||"";},onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onheightChange:function(){this.domNode.style.height=this.height||"auto";}},allowTouchBubble:false,updateScrollerConfig:function A(){var B=this._super(),E=this.domNode,F=E.firstChild,D=parseInt(this.height,10);if(isNaN(D)){D=E.clientHeight;}B.bounces=false;B.scrollEl=F;B.origin=B.origin||{x:0,y:0};var G=Math.max(F.offsetHeight-D,0);var C=B.vScroll=(G!==0);if(C){B.offset={y:{start:0,end:G}};}return B;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.GridBase");var V=mstrmojo.css,M=mstrmojo.color;function C(b,d){var e=b&&b.parent;while(e&&e.scriptClass.indexOf("DocPanelStack")===-1){if(d in e){return e;}e=e.parent;}return null;}function B(d){var b=document.createElement("img");d.appendChild(b);d.removeChild(b);}function E(b,d){var e=Math.floor(b/d.rowsPerPage),g=b%d.rowsPerPage,f=d.tableNode.tBodies[e];r=f.rows[g].cells;return r;}function H(){var b=this._renderTimer;if(b){self.clearInterval(b);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:15,defaultRowsPerPage:100,minRowsPerPage:50,init:function G(b){this._super(b);this.forceFixedSizes=true;},initPageSettings:function N(){var d=this.parent,b=this.defaultRowsPerPage;this.effectiveRh=this.rh||this.rhMin||1;if(d&&d.numRowFixed){b=this.cp.getAvailableRowsCount();}else{if(d&&d.scrollboxHeightFixed){b=Math.ceil(d.scrollboxHeight/this.effectiveRh);b=Math.max(b,this.minRowsPerPage);}}this.pageStatus=[];this.rowsPerPage=b;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function X(g){var f=this.rowsPerPage;this.totalPages=f&&Math.ceil(this.cp.rc/f)||0;g=g||this.pageStatus;for(var d=0;d<this.totalPages;++d){var h=d*f,e=h+f-1,b=this.cp.isDataAvailable(h,e);if(!g[d]){g[d]={};}g[d].onDemand=!b;}},buildRendering:function F(h){if(this.renderMode=="vscroll"){this.initPageSettings();var g=this.pageStatus[0],b=g&&g.onDemand;this.start=0;this.end=-1;if(!b){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!b);}this._super();if(this.renderMode=="vscroll"){var f=this.parent,e=this,j=function(){e.gridContainerNode.style[mstrmojo.css.MINHEIGHT]=(e.cp.rc*e.effectiveRh)+"px";};if(mstrmojo.dom.isIE7){this.gridContainerNode.style.zoom="1";window.setTimeout(j,10);}else{j();}if(!this.connectedScrollbox){if(f&&f.connectScrollbox){f.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!b);this.postRenderPages();var d=f&&!f.scrollboxHeightFixed&&!f.numRowFixed;if(d&&this.numPagesRendered>=this.totalPages&&!b){this.postRenderingCleanup();}else{if(b||d){this.onscroll();}}}else{this.configureActions();}},preRenderPages:function Q(){},postRenderPages:function Z(){this.configureActions();},configureActions:function L(){var b=this.parent;if(b&&b.configureActions){b.configureActions();}},preRenderPage:function O(b,d){this.pageNum=b;},postRenderPage:function J(d,f,g){if(d+1>this.numPagesRendered){this.numPagesRendered=d+1;}var b=this.pageStatus,e=b[d];if(!e){e=b[d]={};}if(f){e.filled=true;e.dirty=false;}var h=this.gridContainerNode.style;if(d==this.totalPages-1&&h){h[mstrmojo.css.MINHEIGHT]="";}},invalidAllPages:function(){for(var b=0;b<this.totalPages;++b){var d=this.pageStatus[b];if(d.filled){d.dirty=true;}d.onDemand=true;d.filled=false;d.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function a(){var b=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var f=mstrmojo.all[b];if(!f){return ;}var d=f.getPagesToRender();if(d.length>0){f.preRenderPages();f.renderPages(d);f.postRenderPages();f._postPagesClearup=true;}else{if(f._postPagesClearup){f.postRenderPagesCleanup();f._postPagesClearup=false;}H.call(f);if(f.isRenderingComplete()){f.postRenderingCleanup();}}}catch(e){H.call(mstrmojo.all[b]);throw e;}},this.renderPause);},onscroll:function Y(b){if(!this.renderingRows){if(b===true){var d=this.parent;if(d&&d.maskNode){V.addClass(d.maskNode,"wait");}}this._startPageRenderThread();}},isRenderingComplete:function P(){if(this.end>=this.cp.rc-1){for(var b=this.pageStatus,d=this.totalPages-1;d>-1;d--){if(!b[d]||!b[d].filled){return false;}}return true;}return false;},renderPages:function D(d){for(var e=0,b=d.length;e<b;++e){this.renderPage(d[e].idx,d[e].fill);}},renderPage:function W(j,d){var o=this.pageStatus,f=(this.numPagesRendered>=j+1);if(f){if(!d||(o[j]&&o[j].filled)){return ;}}var l=this.rowsPerPage,g=this.domNode;this.start=j*l;this.end=Math.min(this.start+l,this.cp.rc)-1;this.preRenderPage(j,d);var b=this.tempTable;if(!b){b=this.tempTable=g.ownerDocument.createElement("div");}var h=d?this.buildTableRowsMarkup(this.start,this.end,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>").join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(this.effectiveRh*(this.end-this.start+1))+'px">&nbsp;</td></tr></tbody></table>';b.innerHTML=h;var e=b.firstChild.tBodies[0],k=this.tableNode;if(!f){k.appendChild(e);}else{k.replaceChild(e,k.tBodies[j]);}this.postRenderPage(j,d,e);},getPagesToRender:function S(){var q=[],w=this.parent,AH=this._defaultPageHeight,g=null,AI=this.pageStatus,AJ=this;function l(j){var p=AI[j];if(p&&(p.filled||p.dirty)){if(!p.height){if(!g){g=AJ.tableNode.tBodies;}p.height=g[j].offsetHeight;}return p.height;}else{return AH;}}var k=0,h=null,s=null,d=w.scrollboxTop;for(var AD=0,AE=this.totalPages,b=this.pageStatus;AD<AE;AD++){k+=l(AD);if(k>=d){h=AD;break;}}if(h===null){h=s=AE-1;}else{var t=w.scrollboxBottom;if(isNaN(t)&&w.numRowFixed){t=d;}for(var AB=h+1;AB<AE;AB++){if(k>t){s=AB-1;break;}k+=l(AB);}}if(s===null){s=AE-1;}for(var x=this.numPagesRendered;x<h;++x){q.push({idx:x,fill:false});}var AC=this.pageStatus,AA=0,AF=this.rowsPerPage,o=false;for(var z=h;z<=s;++z){var AG=AI[z];if(!AG||!AG.filled){if(AG&&AG.onDemand){o=true;if(!AG.isDownloading&&!this.isDownloading){AA+=AF;AG.isDownloading=true;this.isDownloading=true;var f=z*AF,e=f+AF-1;this.cp.download(f,e);}q.push({idx:z,fill:false});}else{q.push({idx:z,fill:true});}}}if(o){this.parent.showDownloadStatus(AA);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return q;},addHilitePosition:function(d,f,b){var g=this.hiliteCellsMap[d];if(!g){this.hiliteCellsMap[d]={pos:[],nodes:[]};}var e=f-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[d].pos.push({row:e,cell:b,page:this.pageNum});},setHilites:function(f,g){var h=g.getAttribute("ei"),j=this.eiMap[h],b=this.getNodesByPositions(j);if(!b.length){this._super(f,g);return ;}for(var e=0,d=b.length;e<d;e++){this._super(f,b[e]);}},addExtraInfoMap:function(d,e,b){if(!this.eiMap[d]){this.eiMap[d]=[];}this.eiMap[d].push(this.getPosObj(e,b));},addPositionMap:function(d,e,b){if(!this.posMap[d]){this.posMap[d]=this.getPosObj(e,b);}},addTitleHeaderPositionMap:function(e,b,d){var f=this.getPosObj(e,b);f.obj=d;this.thPosMap.push(f);},getPosObj:function(b,d){return{row:b-this.pageNum*this.rowsPerPage,cell:d,page:this.pageNum};},getNodeByPosition:function(b){return this.tableNode.tBodies[b.page].rows[b.row].cells[b.cell];},getRowIdxByCell:function(b){var d=this.posMap[b._ei];return d.page*this.rowsPerPage+d.row;},getNodesByPositions:function(j){var b=[];for(var e in j){var d=j[e],g=(d&&d.page)||0,f=d&&d.row,h=d&&d.cell;b.push(this.tableNode.tBodies[g].rows[f].cells[h]);}return b;},getPageHeight:function R(b){var d=this.tableNode.tBodies;return(d&&d[b]&&d[b].offsetHeight)||0;},getTargetCell:function(l,k){var f=0,d=0;for(var g=this.totalPages;d<g;d++){f+=this.getPageHeight(d);if(k<=f){break;}}var e=this.tableNode.tBodies[d];if(e){for(var d=0,g=e.rows.length;d<g;d++){var q=e.rows[d];for(var b=0,p=q.cells.length;b<p;b++){var o=q.cells[b];if(o.offsetTop+o.offsetHeight>=k){if(l>=o.offsetLeft&&l<=o.offsetLeft+o.offsetWidth){return o;}}else{break;}}}}},postRenderPagesCleanup:function I(){var e=this.parent;if(e&&e.gridData&&e.gridData.afc){var d=this.tableNode;if(d&&(this.lastWidth!=d.offsetWidth)){if(e.onGridWidthChanged){e.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(f){delete f.height;});this.lastWidth=d.offsetWidth;}var b=C(e,"adjustAutoWidth");if(b){b.adjustAutoWidth(e);}}if(e.gridPagesRendered){e.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(e&&e.maskNode){V.removeClass(e.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function K(){var l=this.cp.getUpdatedRows(),g=this,k,b,j,o,e,f,h,d=[];if(l){mstrmojo.hash.forEach(l,function(q,p){h=parseInt(p,10);k=g.cp.getRowCells(h);b=E(h,g);j=b.length;o=k.length-1;if(o>=0){for(e=j-1;e>=0;e--){f=b[e];if(o<0){break;}if(k[e]._d){var t=f.style.backgroundColor,s=f.style.color;d.push({dom:f,bgcolor:t,ftcolor:s});f.style.backgroundColor=M.getHighlightColor(M.rgbStr2rgb(mstrmojo.css.getStyleValue(f,"backgroundColor"),true));f.style.color=M.getContrastingColor(M.rgbStr2hex(mstrmojo.css.getStyleValue(f,"backgroundColor")),["#ffffff","#000000"]);delete k[e]._d;}o--;}}});if(d.length>0){window.setTimeout(function(){mstrmojo.array.forEach(d,function(p){p.dom.style.backgroundColor=p.bgcolor;p.dom.style.color=p.ftcolor;});},300);}}},getRowInfoByPosition:function(b){return this.cp.getRowCellInfo(b);},postRenderingCleanup:function A(){var b=this.parent;if(b&&this.connectedScrollbox){b.disconnectScrollbox(this);}this.connectedScrollbox=false;if(b&&!b.scrollboxHeightFixed){var d=C(b,"performCanGrowCanShrink");if(d){d.performCanGrowCanShrink([b],true);}}},unrender:function U(b){H.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this._super(b);},dataDownloaded:function T(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.android.selectors.MobileSliderSelector","mstrmojo.hash");var D=mstrmojo.android.selectors.MobileSliderSelector,A=D.FLAGS,F=D.TYPES;mstrmojo.android.selectors.Slider=mstrmojo.declare(mstrmojo.android.selectors.MobileSliderSelector,null,{scriptClass:"mstrmojo.android.selectors.Slider",items:A.UNSET,initState:function C(){if(!!this.items){this.leftStep=this.rightStep=this.singleStep=null;this.set("type",(!this.multiSelect)?F.SINGLE:(this.include)?F.INCLUDE:F.EXCLUDE);this.set("steps",this.items.length);this.value=null;this.set("value",this.selectedIndices);}},onvalueChange:function G(){var H=this.value,J=mstrmojo.hash.any(H,true),K=J;if(this.type===F.SINGLE){this.set("singleStep",parseInt(J)||0);}else{var I;for(I in H){J=Math.min(I,J);K=Math.max(I,K);}J=J||"0";if(K===undefined||K===null){K=String(this.steps-1);}this.set("leftStep",parseInt(J,10));this.set("rightStep",parseInt(K,10)+1);}},flushSelections:function B(){if(this.type===F.SINGLE){this.select([this.singleStep]);}else{var I=[],H=this.leftStep;for(;H<this.rightStep;H++){I.push(H);}this.select(I);}},buildSummary:function E(L,M,H){var I=this.items,K=(L!==null)?L:M;if(K===undefined||K===null||isNaN(K)||!I.length){return ;}var J=(L===null&&M!==H-1)?I[M].n+" - "+I[H-1].n:(I[K]&&I[K].n)||"";this.summary.innerHTML=J;return J;}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func");var F="Metrics",D=2;function B(a){if(!a){return ;}var Y=this.scm,T="\u001E",V=0,S=null,W=null,U=null,X=null,R=null,Z=false;for(S in Y){W=Y[S];U=W.cgb;for(V in U){cgKey=U[V];R=a[cgKey];if(R){if(!W.tks){W.tks=R;Z=true;}else{if(W.tks&&(W.tks.indexOf(R)<0)){W.tks+=T+R;Z=true;}}}}}return Z;}function Q(){var S=this.data,R=S.gts;if(!R){return ;}var T;mstrmojo.array.forEach([R.row,R.col],function(W){for(var V=0,U=W.length;V<U;V++){var X=W[V];if(X.sc){T=T||{};T[X.id||F]=X.sc;if(X.fid){T[X.id+"_"+X.fid]=X.sc;}}}});this.scm=T;B.call(this,this.docModel.getCGBMap());}function I(R,S){var T=this.getDataService();T[R].apply(T,S);}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function P(R){this._super(R);this.docModel.attachEventListener("CGBMapChange",this.id,function(S){});},ondataChange:function E(R){Q.call(this);},getMessageId:function C(){return this.docModel.mid;},getDataService:function H(){return this.docModel.getDataService();},getAction:function M(f,V,Z){var d=f[0],S=d&&d.at;var U;if(S){if(S&D){var T=this.getCellTitleInfo(d),a=T&&T.title,R=a&&a.id,b=this.scm;this.sti={titleId:R||F};var Y=(R&&b[R])||b[F];if(Y){var e=this.xtab,W=(e.allowToggleSelections&&Y.all&&Z),X=(T.isSrcTitle||W);this.sti.deselectCurrent=W;U={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:V,ck:Y.ck,tks:Y.tks,eid:X?"OA:(All)":d._e.id,ctlKey:Y.ckey,sliceId:e.sid,isUConDS:Y.isUConDS}};}}}if(!U){var U=this._super(f);}if(U&&U.a){U.a.sliceId=this.xtab.sid;}return U;},getDownloadAction:function A(U,S,W,T,V,R){var X=this._super(U,S,W,T,V,R);X.sliceId=this.xtab.sid;return X;},getDrillAction:function K(R){var S=this._super(R);S.srcMsgId=this.docModel.mid;return S;},sort:function G(R,S){I.call(this,"sort",arguments);},pivot:function L(R,S){I.call(this,"pivot",arguments);},drillGrid:function O(R,S){I.call(this,"drillGrid",arguments);},downloadGridData:function N(R,S){I.call(this,"downloadGridData",arguments);},loadLayout:function J(R){this.docModel.loadLayout(R);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._HasTouchScroller","mstrmojo._TouchGestures","mstrmojo.hash");mstrmojo.android.HTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._HasTouchScroller,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.HTMLContainer",markupString:'<div id="{@id}" class="mstrmojo-HTMLContainer {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div>{@v}</div></div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","F","P","background-color","fx","text-align","white-space"]},update:function update(node){var d=node.data,v=d.v||"";var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value+"&nbsp;";div=null;this.v=v;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.scrollerConfig={bounces:false,showScrollbars:false};},postBuildRendering:function postBuildRendering(){var scripts=this.domNode.getElementsByTagName("script"),len=scripts.length,i;for(i=0;i<len;i++){eval(scripts[i].innerHTML);}return this._super();},updateScrollerConfig:function updateScrollerConfig(){var cfg=this._super(),scrollEl=this.valueNode,domNode=this.domNode,fmts=this.getFormats(),iterator={Height:{a:"y",s:"v"},Width:{a:"x",s:"h"}},offset={};cfg.scrollEl=scrollEl;mstrmojo.hash.forEach(iterator,function(info,dimension){if(cfg["no"+info.s.toUpperCase()+"Scroll"]){return ;}var widgetSize=parseInt(fmts[dimension.toLowerCase()],10);if(isNaN(widgetSize)){widgetSize=domNode["client"+dimension];}var offsetEnd=Math.max(scrollEl["offset"+dimension]-widgetSize,0),enableDimensionScroll=cfg[info.s+"Scroll"]=(offsetEnd!==0);if(enableDimensionScroll){offset[info.a]={start:0,end:offsetEnd};}});cfg.offset=offset;cfg.origin=cfg.origin||{x:0,y:0};return cfg;}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasTouchScroller","mstrmojo.dom");var B=mstrmojo.dom;function A(G,E){var D=Math.max(G.x,E.x);var I=Math.max(G.y,E.y);var F=Math.min(G.x+G.w,E.x+E.w)-D;var H=Math.min(G.y+G.h,E.y+E.h)-I;if(F<0||H<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:D,y:I,w:F,h:H};}function C(D){return{x:D.x,y:D.y,w:D.w,h:D.h};}mstrmojo.SmoothScroll=mstrmojo.provide("mstrmojo.SmoothScroll",{viewRect:null,scrollerRect:null,unitRect:null,cachedUnits:[],demarcationUnits:{left:null,right:null,top:null,bottom:null},viewCutX:function(){},storeUnits:function(){this.cachedUnits=[];var G=C(this.unitRect),D=Math.ceil(this.scrollRect.h/G.h),E;for(E=0;E<D;E++,G.y+=G.h){var F=this.getUnitFromPoint(G.x+G.w/2,G.y+G.h/2);if(!F){continue;}this.cachedUnits.push(F);}},appendUnits:function(G,E){var I=this.cachedUnits,D;for(D=G;D<=E;D++){var F=I[D];if(!F){return ;}if(F.outside==true){F.outside=false;var H=F._parentNode,J=H.children;H.insertBefore(F,J[F._oldIndex]);H.style.paddingTop="";delete F._parentNode;delete F._oldIndex;}}console.log(E-G+1+" units added.");},removeUnits:function(G,E){var I=this.cachedUnits,D;for(D=G;D<=E;D++){var F=I[D];if(!F){return ;}if(F.outside!=true){var H=F.parentNode,J=H.children;F._parentNode=H;F._oldIndex=0;H.removeChild(F);H.style.paddingTop=this.unitRect.h+"px";F.outside=true;}}console.log(E-G+1+" units removed.");},viewCutY:function(K){if(!this.viewRect||!this.scrollRect||!this.unitRect){return ;}var G=K?K.y:this._scroller.origin.y,E=G+this.viewRect.h;if(!this._scroller||!this._scroller.scrollEl){console.log("no scrollEl.");return ;}var J=this._scroller.scrollEl;var H=Math.floor(G/this.unitRect.h),F=Math.floor(E/this.unitRect.h),I=this.cachedUnits,D=I.length;delta=0;this.removeUnits(0,H-1);this.appendUnits(H,F);this.removeUnits(F+1,D);delta=H;console.log("do viewCut.");},updateScroller:function(G,F){if(this._super){this._super(G,F);}var E=mstrmojo.dom.position;if(!this.unitRect||!this.unitRect.w||!this.unitRect.h){var D=this.cachedUnits[0];if(!D){return ;}this.unitRect=E(D);}if(this.viewNode){this.viewRect=E(this.viewNode);}this.scrollRect={x:this.unitRect.x,y:this.unitRect.y,w:this.unitRect.w,h:this.unitRect.h*this.cachedUnits.length};if(!this.viewRect||!this.scrollRect||!this.unitRect){return ;}this.viewCutY(this._scroller.origin);},getUnitFromPoint:function(D,J){var E=[],H=false;do{var I=document.elementFromPoint(D,J);if(I==G){break;}if(I.offsetHeight==this.unitRect.h&&I.offsetWidth==this.unitRect.w){H=true;}else{I.__metaDisplay=I.style.display;E.push(I);I.style.display="none";}var G=I;}while(!H&&I!=document.body);var F=I;while(E.length){var I=E.pop();I.style.display=I.__metaDisplay;delete I.__metaDisplay;}if(H){return F;}else{return null;}},postBuildRendering:function(D){if(this._super){this._super(D);}console.log("event binded!");this.smoothSwipeListener=this._scroller.attachEventListener("scrollMoved",this.id,this.viewCutY);},unrender:function(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.VisHeatMapColorTheme","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.dom","mstrmojo.css");var STEP_X=1200,STEP_Y=800;var LABEL={ON:0,OFF:1,PROPORTIONAL:2};var FMT={LABEL_CTNR_THRES:6,LABEL_CTNR_WIDTH_THRES:32,LGD_GUTTER:5,LABEL_PADDING:2};var CSSATTR={"heatmap-one-level-1":{},"heatmap-two-level-2":{},"heatmap-multi-level-1":{},"heatmap-multi-level-2":{},"heatmap-multi-level-3":{},init:false};function getCSSColor(rgb){var c=16777216+rgb;var str="#"+c.toString(16).substring(1).toUpperCase();return str;}function wfs(root,f){var arr=[root];while(arr.length!==0){var node=arr.shift();if(node===undefined||node.deleted){continue;}f(node);var children=node.entityChildren;if(children!==undefined){var l=children.length;for(var i=0;i<l;i++){arr.push(children[i]);}}}}function dfs(root,f,indexString){if(root.deleted){return ;}if(indexString===undefined){f(root);}else{f(root,indexString);}if(root.entityChildren===undefined){return ;}var arr=root.entityChildren,l=arr.length;for(var i=0;i<l;i++){var e=arr[i];if(indexString===undefined){dfs(e,f);}else{var param=indexString;if(!param){param=i.toString();}else{param=param+":"+i;}dfs(e,f,param);}}}function getLabelCSS(l,n){var css;if(n===1){if(l===0){css="heatmap-one-level-1";}}else{if(n===2){if(l===0){css="heatmap-multi-level-1";}else{if(l===1){css="heatmap-two-level-2";}}}else{if(n>=3){if(l===0){css="heatmap-multi-level-1";}else{if(l===1){css="heatmap-multi-level-2";}else{if(l===2){css="heatmap-multi-level-3";}}}}}}return css;}function intersect(lhs,rhs){if(!lhs||!rhs){return false;}if(rhs.x>=lhs.x+lhs.w||rhs.y>=lhs.y+lhs.h||rhs.x+rhs.w<=lhs.x||rhs.y+rhs.h<=lhs.y){return false;}else{return true;}}function rectIntersection(a,b){var x=Math.max(a.x,b.x);var y=Math.max(a.y,b.y);var w=Math.min(a.x+a.w,b.x+b.w)-x;var h=Math.min(a.y+a.h,b.y+b.h)-y;if(w<0||h<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:x,y:y,w:w,h:h};}mstrmojo.VisHeatMapCanvas=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.VisHeatMapCanvas",parent:null,root:null,colorTheme:null,attributes:[],scale:1,labelSetting:0,showMetric:false,bgColor:"#333333",numImages:0,offsetX:0,offsetY:0,markupString:'<div style="position:absolute; width:{@width}px; height:{@height}px"><canvas width={@width} height={@height} style="visibility: hidden; z-index:0"></canvas><span></span></div>',markupSlots:{domCanvas:function(){return this.domNode.firstChild;},domSpan:function(){return this.domNode.childNodes[1];},domImage:function(){return this.domNode.childNodes[2];}},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res=eval(s);return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},postBuildRendering:function(){this.initCSSATTR();this.draw();if(this._super){this._super();}},removeImageAndLabels:function(){var dom=this.domNode,labels=dom.childNodes,n=labels.length;for(var i=n-1;i>1;i--){var node=labels[i];dom.removeChild(node);}this.numImages=0;},removeLabels:function(){var dom=this.domNode,labels=dom.childNodes,n=labels.length,stop=1+this.numImages;for(var i=n-1;i>stop;i--){var node=labels[i];dom.removeChild(node);}},updateOffsets:function(x,y){this.offsetX=x;this.offsetY=y;this.removeLabels();this.drawLabels();},draw:function(x,y){if(x!==undefined){this.offsetX=x;}if(y!==undefined){this.offsetY=y;}this.removeImageAndLabels();this.drawRects();this.drawLabels();},drawRects:function(){var w=this.width,h=this.height,k=this.scale,cw=Math.ceil(w*k),ch=Math.ceil(h*k),cvs=this.domCanvas,dom=this.domNode,fragment=document.createDocumentFragment(),row=Math.ceil(ch/STEP_Y),col=Math.ceil(cw/STEP_X),count=0;for(var i=0;i<row;i++){for(var j=0;j<col;j++){var window={x:j*STEP_X,y:i*STEP_Y,w:STEP_X,h:STEP_Y};if(i+1===row){window.h=ch-window.y;}if(j+1===col){window.w=cw-window.x;}cvs.setAttribute("width",window.w);cvs.setAttribute("height",window.h);var cxt=cvs.getContext("2d");cxt.fillStyle=this.bgColor;cxt.fillRect(0,0,window.w,window.h);var drawPiece=function(e,idx){var rect=e.size;if(e.entityChildren===undefined&&!e.deleted&&intersect(window,rect)){var x1=Math.max(rect.x-window.x,0),y1=Math.max(rect.y-window.y,0),x2=Math.min(rect.x+rect.w-window.x,window.w),y2=Math.min(rect.y+rect.h-window.y,window.h);cxt.fillStyle=e.color;cxt.fillRect(x1,y1,x2-x1,y2-y1);}e.idx=idx;};dfs(this.root,drawPiece,"");var res=cvs.toDataURL();var img=document.createElement("img");img.src=res;img.style.position="absolute";img.style.left=window.x+"px";img.style.top=window.y+"px";img.setAttribute("draggable","false");img.setAttribute("orgx",window.x);img.setAttribute("orgy",window.y);fragment.appendChild(img);count++;}}cvs.setAttribute("width",0);cvs.setAttribute("height",0);dom.style.width=cw+"px";dom.style.height=ch+"px";dom.appendChild(fragment);this.numImages=count;},drawLabels:function(){var l=this.attributes.length,that=this,dom=this.domNode,gut=FMT.LGD_GUTTER,padding=FMT.LABEL_PADDING,window={x:this.offsetX,y:this.offsetY,w:this.width,h:this.height};var caches=[],layout=[{},{},{}];var ext=Math.floor(Math.log(this.scale)/Math.log(2));ext=Math.min(ext,l-3);ext=Math.max(ext,0);this._ext=ext;var drawText=function(e){if(e===that.root||e.deleted){return ;}var rect=e.size,w=rect&&rect.w,h=rect&&rect.h;if(!intersect(window,rect)){return ;}if(w<FMT.LABEL_CTNR_WIDTH_THRES+2*FMT.LABEL_PADDING||h<FMT.LABEL_CTNR_THRES){return ;}var str=e.text,idx=e.idx,level=e.level-ext;if(level>=0&&level<3){var tw,th,labelCSS=getLabelCSS(level,l),font=CSSATTR[labelCSS].font,fontSize=CSSATTR[labelCSS].fontSize,o={s:{},e:e,m:0,css:labelCSS};if(that.showMetric===true&&e.entityChildren===undefined){var loc={};mstrmojo.hash.copy(rect,loc);if(l>1&&level===0){loc.w-=2*gut;loc.h-=gut;}else{loc.w-=2*padding;}var lh,txtS;if(that.labelSetting===LABEL.PROPORTIONAL){lh=9;var step=8,shrink=false,txtS=that.getTextSize(str,font,lh,true,false,loc.w);while(step>=1){if(txtS.h<loc.h){lh+=step;}else{if(lh===9){break;}if(lh>=loc.w){break;}if(!shrink){step/=2;}shrink=true;lh-=step;}txtS=that.getTextSize(str,font,lh,true,false,loc.w);if(shrink){step=step>>1;}}if(txtS.h>loc.h&&lh>9){lh--;}if(lh>loc.w){lh=loc.w;}o.fs=lh;}else{lh=fontSize;}o.lh=lh;txtS=that.getTextSize(str,font,lh,true,false,loc.w);tw=Math.min(txtS.w,loc.w);th=txtS.h;if(th>loc.h){th=Math.floor(loc.h/lh)*lh;}}else{if(caches[level]===undefined){caches[level]={};}var cache=caches[level];if(cache[str]===undefined){var txtS=that.getTextSize(str,font,fontSize,true),tw=txtS.w,th=txtS.h;if(l>1&&level===0){tw+=2*gut;th+=gut;}cache[str]={w:tw,h:th};}else{tw=cache[str].w;th=cache[str].h;}if(th>h){return ;}o.lh=th;var p;if(l>1&&level===0){p=2*gut;}else{p=2*padding;}if(tw>w-p){var trunw=tw>>1,lineCount=Math.floor(h/o.lh);if(trunw>(w-p)*lineCount){return ;}tw=w-p;if((l==1&&level==0)||(l==2&&level==1)||(l>2&&level==2)){var ts=that.getTextSize(str,font,fontSize,true,false,w-p,true);th*=Math.floor(Math.min(ts.h,h)/o.lh);o.isLowestLevel=true;}}}var x=rect.x+((w-tw)>>1),y=rect.y+((h-th)>>1);o.s={x:x,y:y,w:tw,h:th};layout[level][idx]=o;}};if(that.labelSetting!==LABEL.OFF){wfs(this.root,drawText);this.layoutLabels(layout);}},layoutLabels:function(layout){var that=this,doc=document,fragment=doc.createDocumentFragment();function generateLabel(o){var s=o.s,e=o.e,css=o.css,color=that.getLabelColor(s,e),hasM=o.fs!==undefined;var div=doc.createElement("div");if(hasM){div.setAttribute("style","font-size: "+o.fs+"px !important");div.className=css+" heatmap-showMetric-text";}else{div.className=css+" heatmap-trun-text";}div.style.position="absolute";div.style.color=color;div.style.backgroundColor="rgba(255, 255, 255, 0)";div.style.zIndex="1";div.style.left=s.x+"px";div.style.top=s.y+"px";div.style.width=s.w+"px";div.style.height=s.h+"px";div.style.lineHeight=o.lh+"px";if(o.isLowestLevel){div.style.textOverflow="ellipsis";div.style.wordBreak="normal";}div.setAttribute("idx",e.idx);div.innerHTML=e.text;fragment.appendChild(div);}var L0=layout[0],L1=layout[1],L2=layout[2],idx;for(idx in L1){var info=L1[idx],bbox=info.s,node=info.e,prt=node.parentEntity,pinfo=L0[prt.idx];if(pinfo===undefined){generateLabel(info);continue;}var pbox=pinfo.s,inter=rectIntersection(bbox,pbox);var rmIt=false;if(inter.w>5||inter.h>5){if(pbox.y<=bbox.y){var delta=((pbox.y+pbox.h-bbox.y)>>1)+1;if(pinfo.m!==2&&(pbox.y-delta>=prt.size.y)&&(bbox.y+bbox.h+delta<=node.size.y+node.size.h)){pbox.y-=delta;bbox.y+=delta;pinfo.m=1;}else{rmIt=true;}}else{var delta=((bbox.y+bbox.h-pbox.y)>>1)+1;if(pinfo.m!==1&&(pbox.y+pbox.h+delta<=prt.size.y+prt.size.h)&&(bbox.y-delta>=node.size.y)){pbox.y+=delta;bbox.y-=delta;pinfo.m=2;}else{rmIt=true;}}}if(rmIt!==true){generateLabel(info);}}for(idx in L0){generateLabel(L0[idx]);}for(idx in L2){rmIt=false;var info2=L2[idx],node2=info2.e,node1=node2.parentEntity,node0=node1.parentEntity,idx1=node1.idx,idx0=node0.idx,info1=L1[idx1],info0=L0[idx0];if(info1!==undefined){var inter12=rectIntersection(info1.s,info2.s);if(!isNaN(inter12.w)){rmIt=true;}}if(rmIt===false&&info0!==undefined){var inter02=rectIntersection(info0.s,info2.s);if(!isNaN(inter02.w)){rmIt=true;}}if(rmIt!==true){generateLabel(info2);}}this.domNode.appendChild(fragment);},getLabelColor:function(s,e){var level=e.level-this._ext;if(level===0){return"#FFFFFF";}var ct=this.colorTheme;if(e.entityChildren===undefined){return getCSSColor(ct.getContrastColor(parseInt(e.color.substring(1,e.color.length),16)));}var stack=[e],ls=0,ds=0;while(stack.length!==0){var node=stack.shift(),ch=node.entityChildren,n=node.entityChildren.length;for(var i=0;i<n;i++){var child=ch[i];if(child.deleted){continue;}var rect=rectIntersection(s,child.size);if(child.entityChildren===undefined){if(!isNaN(rect.w)){if(ct.isBrightColor(parseInt(child.color.substring(1,child.color.length),16))){ls+=rect.w*rect.h;}else{ds+=rect.w*rect.h;}}}else{if(!isNaN(rect.w)){stack.push(child);}}}}if(ls>ds){return"#000000";}else{if(level===1){return"#e6e7e8";}else{return"#d1d3d4";}}},getEntity:function(pos){var ox=pos.x,oy=pos.y,target;var hitTest=function(node){if(node.entityChildren===undefined&&!node.deleted&&node.size){var size=node.size,x1=size.x,y1=size.y,x2=x1+size.w,y2=y1+size.h;if(ox>=x1&&ox<=x2&&oy>=y1&&oy<=y2){target=node;}}};var dfsReturnOnFound=function(root,f){if(root.deleted){return ;}f(root);var arr=root.entityChildren;if(arr!==undefined){var l=arr.length;for(var i=0;i<l;i++){var e=arr[i];dfsReturnOnFound(e,f);if(target!==undefined){return ;}}}};dfsReturnOnFound(this.root,hitTest);return target;},initCSSATTR:function(){if(CSSATTR.init===false){var dom=this.domSpan;for(var css in CSSATTR){if(css==="init"){continue;}dom.setAttribute("class",css);var res=document.defaultView.getComputedStyle(dom);CSSATTR[css].fontSize=parseInt(res.fontSize);CSSATTR[css].font=res.fontFamily;}}},getTextSize:function(str,fontName,fontSize,isBold,isItalic,width,normalBreak){var dom=this.domSpan,breakMethod="break-all";if(normalBreak){breakMethod="normal";}dom.className="";dom.innerHTML=str;dom.style.cssText="position:absolute; visibility:hidden; z-index:-1; font-family:"+fontName+"; font-size:"+fontSize+"px; font-weight:"+(isBold?"bold":"normal")+"; font-style:"+(isItalic?"italic":"normal")+"; line-height:"+fontSize+"px;";var w=dom.offsetWidth;if(width!==undefined&&w>width){dom.style.cssText+="overflow:hidden; word-break:"+breakMethod+"; width:"+width+"px;";w=dom.offsetWidth;}return{w:w,h:dom.offsetHeight};}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.array","mstrmojo.dom","mstrmojo.css");var R=mstrmojo.array,U=mstrmojo.css,M=mstrmojo.dom,O=1,J="selected",H="d",L="m",E="y";function V(a,e,W,f){var Z,b=this.selected=this.selected||[],X;for(Z=0;Z<b.length;Z++){X=b[Z];if(X.day===e&&X.month===W&&X.year===f){b.splice(Z,1);return false;}}var Y={node:a,day:e,month:W,year:f};Y.n=mstrmojo.date.formatDateInfo(Y,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);b.push(Y);return true;}function I(W){this.contentNode.innerHTML=this.markupBuilder.getContentHTML({m:0,y:W},{m:11,y:W},{incl:false});}function F(W,Z){var X=this.contentNode.children,Y;R.forEach(W||this.selected,function(a){if(a&&a.year===this.current.y){var b=new Date(a.year,a.month-O,1);R.forEach(X,function(d){if(parseInt(d.getAttribute(L),10)===a.month){U.toggleClass(d.getElementsByClassName("mstrmojo-CalendarMV-DatesList")[0].children[a.day+(b.getDay())-1],J,Z);return false;}});}Y=undefined;},this);}function G(W,Z){var b=this.MONTH_CACHE,a=b[parseInt(W,10)],Y=b[parseInt(Z,10)],X="selectedMonth";if(Z!==undefined){U.toggleClass(Y.node,X,false);}U.toggleClass(a.node,X,true);if(this._scroller){this._scroller.scrollTo(0,a.top,200);}if(!(mstrApp.isTablet()&&mstrApp.isLandscape())){this.headerNode.innerHTML=this.markupBuilder.getHeaderHTML(W,this.current.y);}}function K(j,g){I.call(this,this.current.y);this.updateScroller();var b=0,e=parseInt(this.height,10)-this.headerNode.clientHeight,d=this.contentNode,f=d.offsetTop,X=d.children,Z=this.selected,l=R.find(Z,"year",j),a=l!==-1,k=this.MONTH_CACHE=[{}];for(b=0;b<X.length-1;b++){var Y=X[b],W=Y.clientHeight;k.push({node:Y,top:Y.offsetTop-f-(e-W)/2,height:W});}this._scroller.scrollTo(0,0);G.call(this,g||(a&&Z[l].month)||O);this.selectItems();}mstrmojo.android.ui.CalendarMonthView=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.ui.CalendarMonthView",config:undefined,markupString:'<div id="{@id}" class="mstrmojo-Calendar-MonthView"><div class="mstrmojo-CalendarMV-Header"></div><div class="mstrmojo-CalendarMV-Content"><div></div></div></div>',markupSlots:{headerNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild.lastChild;}},range:undefined,selected:undefined,multiSelect:true,current:undefined,scrollerConfig:{bounces:false,showScrollbars:false,showIndicators:false},postCreate:function B(){if(this._super){this._super();}var X=this,a=this.initialYear,W=this.initialMonth;if(isNaN(W)||isNaN(a)){throw new Error(mstrmojo.desc(96,"Error"));}this.current=new mstrmojo.Obj({m:W,y:a,onyChange:function Z(){K.call(X,this.y);},_set_m:function Y(e,d){var b=this.m;this.m=d;G.call(X,this.m,b);}});},postBuildRendering:function Q(){var W=this.markupBuilder,X=this.current;this._super();this.headerNode.innerHTML=W.getHeaderHTML(X.m,X.y);K.call(this,X.y,X.m);this._scroller.attachEventListener("scrollDone",this.id,function(Z){var g=this.MONTH_CACHE,Y=Math.abs,e=Z.y,f,d,b,a;for(a=1;a<g.length-1;a++){f=g[a].top;d=g[a+1].top;if((f<=e)&&(e<=d)){b=a+((Y(d-e)<Y(f-e))?1:0);break;}}this.current.set("m",b);});},touchTap:function P(b){var X=M.findAncestorByAttr(b.target,L,true,this.domNode);if(X){var Y=b.target,Z=parseInt(Y.getAttribute(H),10),W=parseInt(X.value,10),a=parseInt(X.node.getAttribute(E),10);if(!isNaN(Z)){if(this.singleSelect){R.forEach(this.selected,function(d){U.toggleClass(d.node,J,false);});this.selected=[];}U.toggleClass(Y,J,V.call(this,Y,Z,W,a));this.raiseEvent({name:"selectionChanged",items:this.selected});}if(!isNaN(W)){this.current.set("m",W);}}return false;},selectItems:function T(W){F.call(this,W,true);},unselectItems:function C(W){F.call(this,W,false);},touchSelectBegin:function A(W){},touchSelectMove:function D(W){},touchSelectEnd:function P(W){},updateScrollerConfig:function N(){var W=this._super(),a=this.contentNode,Y=parseInt(this.height,10);if(isNaN(Y)){Y=this.domNode.clientHeight;}W.scrollEl=a;W.noHScroll=true;W.origin=W.origin||{x:0,y:0};var Z=W.offsetIdx;if(Z){delete W.offsetIdx;W.origin.y=this.getItemOffset(Z);}var b=Math.max(a.clientHeight+this.headerNode.clientHeight-Y,0);var X=W.vScroll=b!==0;if(X){W.offset={y:{start:0,end:b}};}else{W.offset=null;}return W;},destroy:function S(){if(this.current){this.current.destroy();delete this.current;}delete this.MONTH_CACHE;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._TouchGestures","mstrmojo.android.ui.CalendarMonthView","mstrmojo.android.ui.CalendarYearList");var H=mstrmojo.hash,E=mstrmojo.array,C=mstrmojo.desc(2827,"Clear"),A=mstrmojo.desc(221,"Cancel");mstrmojo.android.ui.Calendar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._TouchGestures,mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.Calendar",config:undefined,markupString:'<div id="{@id}" class="mstrmojo-android-Calendar"><div class="mstrmojo-Calendar-Year"></div><hr class="mstrmojo-Calendar-Sep"/><div class="mstrmojo-Calendar-Month"></div></div>',markupSlots:{yearNode:function(){return this.domNode.firstChild;},monthNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},cssDisplay:"",isMultiSelect:false,selectedDates:undefined,min:undefined,max:undefined,init:function G(O){var J=new Date(),M=this.children[0],R=this.children[1],L=O.min=O.min||{},P=O.max=O.max||{},K=O.selectedDates=O.selectedDates||[],Q=K[0]||{},N,I;E.forEach([Q,L],function(S){if(!isNaN(S.year)&&!isNaN(S.month)){N=S.year;I=S.month;return false;}});I=!isNaN(I)?I:(J.getMonth()+1);N=!isNaN(N)?N:J.getFullYear();H.copy({initialYear:N,initialMonth:I,multiSelect:!!this.isMultiSelect,selected:K,range:{start:L,end:P}},R);H.copy({initialYear:N,start:L.year,end:P.year},M);this._super(O);},postBuildRendering:function D(){this.monthWidget.markupBuilder=this.markupBuilder;this._super();var I=this.target;I.set("items",this.selectedDates);I.selectItems(I.items);this.yearWidget.attachEventListener("yearChanged",this.monthWidget.id,function(J){this.current.set("y",J.value);});this.monthWidget.attachEventListener("selectionChanged",this.id,function(J){this.syncListItemsWithSelections([].concat(J.items));});this.target.attachEventListener("selectionChange",this.id,function(K){var P=this.target,J=P.items,N=this.monthWidget,M=E.get(J,K.added),O=E.get(J,K.removed);if(M&&M.length>0){N.selectItems(M);}else{var L;if((O&&O.length>0)&&(J&&J.length>0)){L=O;}N.unselectItems(L);}if(P.parent){P.parent.btnHbox.children[0].set("text",((P.getSelectedItems().length>0)?C:A));}N.selected=P.getSelectedItems();});},syncListItemsWithSelections:function F(I){var J=this.target;J.glow=false;J.set("items",I);J.selectItems(I);if(J.parent){J.parent.btnHbox.children[0].set("text",((J.getSelectedItems().length>0)?C:A));J.parent.resizeDialog();}J.glow=true;},getSelectedDates:function B(J){var I=[];E.forEach(this.target.getSelectedItems(),function(K){I.push(K.n);});return I;},children:[{scriptClass:"mstrmojo.android.ui.CalendarYearList",alias:"yearWidget",slot:"yearNode"},{scriptClass:"mstrmojo.android.ui.CalendarMonthView",alias:"monthWidget",slot:"monthNode"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.SmoothScroll","mstrmojo._HasTouchScroller");var C=16;var A={0:"&#9654;",1:"&#9660;",2:"&nbsp;"};var B=["heatmap-tree-state-text collapsed","heatmap-tree-state-text expanded","heatmap-tree-state-text leaf"];var D={NO:0,YES:1,PART:2};mstrmojo.VisHeatMapTreeItem=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VisHeatMapTreeItem",isRoot:false,showRoot:false,rootText:"",idx:0,buttonNodeCss:"heatmap-tree-checkbox",buttonNodeWidget:null,markupString:'<div id="{@id}" class="heatmap-tree" style="{@cssText}"><div class="heatmap-tree-div" idx="{@idx}"><div class="heatmap-tree-state"><div class="heatmap-tree-state space">&nbsp;</div><div class="heatmap-tree-state-text"></div></div><div class="heatmap-tree-text"></div><div class="{@buttonNodeCss}">&nbsp;</div></div><div class="heatmap-tree-container"></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild;},stateNode:function(){return this.domNode.firstChild.firstChild;},stateSpaceNode:function(){return this.domNode.firstChild.firstChild.firstChild;},stateTextNode:function(){return this.domNode.firstChild.firstChild.lastChild;},textNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];},containerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=this.text;},onstateChange:function(){this.stateTextNode.className=B[this.state];if(!this.isRoot){this.containerNode.style.display=(this.state===1)?"block":"none";if(this.state!=2){this.tree.resized();}}}},level:-1,tree:null,itemDisplayField:"n",itemChildrenField:"items",isSelectable:true,itemFunctionField:"itemFunction",itemIncludeFunction:function(){return true;},dataProvider:null,owner:null,fillData:function(){var M=this.tree||this;if(this.dataProvider){this.items=this.dataProvider[this.itemChildrenField];}var J=this.items;if(this.items&&this.items.length){this.childTree=[];var F=0;for(var G=0;G<J.length;G++){var L=J[G];if(this.itemIncludeFunction(L)){var K;if(M.owner){K=L.label;}else{K=L[this.itemDisplayField];}var I=new Date();var H=(new Date()).getTime();var E={idx:F,isRoot:false,text:K,itemFunction:L[this.itemFunctionField],buttonNodeWidget:L.buttonNodeWidget,tree:M,level:(this.level+1),itemDisplayField:this.itemDisplayField,itemChildrenField:this.itemChildrenField,parent:this,parentTree:this,state:0,isSelectable:this.isSelectable,itemIncludeFunction:this.itemIncludeFunction,buttonNodeCss:this.buttonNodeCss,fillData:this.fillData,buildTree:this.buildTree,setChildStatus:this.setChildStatus,updateSelection:this.updateSelection};if(this.dataProvider){E.dataProvider=L;}else{E.items=L[this.itemChildrenField];}this.childTree[F]=E;F++;}}}},renderChildrenList:function(){if(!this.childTree){return ;}var J=this.childTree.length,M,L;if(this.tree){L=this.tree.cachedUnits;M=L.indexOf(this.contentNode)+1;if(M==0){M=L.length;}}if(this.isRoot&&this.showScrollbars){M=0;L=this.cachedUnits;}for(var H=0;H<J;H++){if(this.childTree[H].domNode){this.tree.cachedUnits.splice(M,0,this.childTree[H].contentNode);M++;continue;}var E=document.createElement("div");this.containerNode.appendChild(E);this.childTree[H].placeholder=E;var I=new mstrmojo.VisHeatMapTreeItem(this.childTree[H]);if(!I){alert("new failed!");}I.childTree=this.childTree[H].childTree;if(I.childTree){var F=I.childTree,K=F.length;for(var G=0;G<K;G++){F[G].parent=I;F[G].parentTree=I;}}this.childTree[H]=I;this.childTree[H].render();if(!isNaN(M)){L.splice(M,0,this.childTree[H].contentNode);M++;}}},postBuildRendering:function(){if(this._super){this._super();}this.domNode.style.display="none";var E=this.tree||this;if(this.dataProvider){this.items=this.dataProvider[this.itemChildrenField];}if(this.isRoot){if(!this.showRoot){this.contentNode.style.display="none";}else{this.stateNode.style.display="none";this.textNode.innerHTML=this.rootText;}this.containerNode.className="heatmap-tree-container root";}else{if(this.buttonNodeWidget){this.buttonNodeWidget.placeholder=this.buttonNode;var G=mstrmojo.insert(this.buttonNodeWidget);G.render();this.buttonNode=G.domNode;}this.textNode.innerHTML=this.text;var F=(this.level+1)*C;this.stateSpaceNode.style.width=(F>=0?F:0)+"px";this.textNode.style.width=this.domNode.offsetWidth-this.stateNode.offsetWidth-this.buttonNode.offsetWidth-10+"px";}if(!(this.items&&this.items.length)){this.set("state",2);this.tree.sampleUnit=this.domNode;}else{this.set("state",0);}this.domNode.style.display="block";},buildTree:function(){this.fillData();if(this.childTree){var E=this.childTree.length;}for(var F=0;F<E;F++){this.childTree[F].buildTree();}},clickHandler:function(F){var H=F.target;if(this.state!==2&&mstrmojo.dom.contains(this.stateNode,H,true,this.domNode)){this.set("state",this.state===0?1:0);if(this.state==1){this.renderChildrenList();this.updateChildrenSelection();}else{var G=this.tree.cachedUnits.indexOf(this.contentNode);if(G!=-1){G++;var E=this.childTree.length;this.tree.cachedUnits.splice(G,E);}}this.tree.resized();this.tree.updateScroller();return ;}if(this.itemFunction){this.itemFunction(F);}if(!this.isSelectable){return ;}mstrmojo.VisHeatMapAnimation.animate(this.contentNode,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});if(this.selectionStatus===D.YES){this.selectionStatus=D.NO;}else{this.selectionStatus=D.YES;}this.setChildStatus(this.selectionStatus);this.updateSelection(false,true);},setChildStatus:function(E){if(this.childTree){for(var F=0;F<this.childTree.length;F++){var G=this.childTree[F];if(!G){continue;}G.selectionStatus=E;G.setChildStatus(E);G.updateSelection(false,false);}}},updateChildrenSelection:function(){if(!this.childTree){return ;}var E=this.childTree.length;for(var F=0;F<E;F++){if(this.childTree[F]){this.childTree[F].updateSelection(false,false);}}},updateSelection:function(K,J){if(K&&this.childTree){var G=true;var L=true;var F=false;for(var H=0;H<this.childTree.length;H++){var I=this.childTree[H];if(G&&I.selectionStatus!==D.YES){G=false;}if(L&&I.selectionStatus!==D.NO){L=false;}if(!G&&!L){F=true;break;}}this.selectionStatus=G?D.YES:(L?D.NO:D.PART);}var E="heatmap-tree-div";switch(this.selectionStatus){case D.YES:E+=" selected";break;case D.PART:E+=" partSelected";break;case D.NO:default:break;}this.cssName=E;if(this.contentNode){this.contentNode.className=E;}if(J&&this.parentTree){this.parentTree.updateSelection(true,true);}if(this.isRoot){this.notifyAll();}},resized:function(){if(this.parent.resized){this.parent.resized(this.domNode.offsetHeight);}},selectionStatus:D.NO});mstrmojo.VisHeatMapTree=mstrmojo.declare(mstrmojo.VisHeatMapTreeItem,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo.SmoothScroll],{scriptClass:"mstrmojo.VisHeatMapTree",isRoot:true,showRoot:false,rootText:"",heightLimit:0,defaultSelectionStatus:D.NO,markupString:'<div id="{@id}" class="heatmap-tree root {@cssClass}" style="{@cssText} mstrAttach:mousedown,mousemove,mouseup,click"><div class="heatmap-tree-div" style="line-height:40px;" idx="{@idx}"><div class="heatmap-tree-state" style="display:none;"><div class="heatmap-tree-state space">&nbsp;</div><div class="heatmap-tree-state-text"></div></div><div class="heatmap-tree-text"></div><div class="{@buttonNodeCss}">&nbsp;</div></div><div style="overflow:hidden; position:relative"><div class="heatmap-tree-container"></div></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild;},stateNode:function(){return this.domNode.firstChild.firstChild;},stateSpaceNode:function(){return this.domNode.firstChild.firstChild.firstChild;},stateTextNode:function(){return this.domNode.firstChild.firstChild.lastChild;},textNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];},scrollboxNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild.firstChild;}},initialized:false,dirty:false,showIndicators:false,showScrollbars:false,cachedUnits:[],init:function(E){this._super(E);this.observer=[];},register:function(E){this.observer.push(E);this.notifyAll();},notifyAll:function(){var F=false;if(this.childTree&&this.childTree.length>0){F=true;}if(F){mstrmojo.css.removeClass(this.contentNode,"disabled");}else{mstrmojo.css.addClass(this.contentNode,"disabled");}if(this.selectionStatus===D.NO){F=false;}for(var E in this.observer){this.observer[E].notify(F);}},buildRendering:function(){if(this.isRoot){this.cachedParent=this.parent;delete this.parent;}if(this._super){this._super();}},postBuildRendering:function(){var F=(new Date()).getTime();if(this.isRoot){this.scrollerConfig={bounces:false,showIndicators:this.showIndicators,showScrollbars:this.showScrollbars,useTranslate3d:true,vScroll:true,hScroll:false,offset:{y:{start:0,end:0},x:{start:0,end:0}},origin:{x:0,y:0},scrollEl:this.containerNode};}this._super();this.buildTree();this.renderChildrenList();if(this.isRoot){this.parent=this.cachedParent;this.parent.containerNode.appendChild(this.domNode);}if(this.heightLimit>0){var E=this.heightLimit-this.contentNode.offsetHeight-2;if(E>=0){this.scrollboxNode.style.maxHeight=E+"px";}}this.selectionStatus=this.defaultSelectionStatus;this.setChildStatus(this.selectionStatus);this.updateSelection(false,true);this.viewNode=this.scrollboxNode;this.notifyAll();this.resized();this.updateScroller();},touchTap:function(F){var G=mstrmojo.dom.findAncestorByAttr(F.target,"id",true,this.domNode);if(!G){this.clickHandler(F);return ;}var E=mstrmojo.all[G.value];if(E&&E.clickHandler){E.clickHandler(F);}},resized:function(E){var F=mstrmojo.dom.position;if(!this.viewRect){this.viewRect=F(this.scrollboxNode,true);}if(!(this.heightLimit>0)){return ;}if(!this._scroller.offset){return ;}E=E||this.containerNode.offsetHeight;if(E>this.scrollboxNode.clientHeight){this._scroller.offset.y.end=E-this.scrollboxNode.clientHeight;}else{this._scroller.offset.y.end=0;this._scroller.scrollTo(0,0,0);}},refresh:function(){if(this.needRefresh){this.containerNode.innerHTML="";this.postBuildRendering();this.resized();this.updateScroller();this.needRefresh=false;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.array","mstrmojo.func");var H=2;var G=1,B=2;mstrmojo.DocVisModel=mstrmojo.declare(mstrmojo.DocXtabModel,null,{scriptClass:"mstrmojo.DocVisModel",getAction:function F(K){var I=K[0],J=I&&I.at;var L;if(J){if(J&H){L={h:"onVisSelector",a:this.getSelectAction(I)};}}if(!L){L=this.getActionObject(K);}return L;},getSelectAction:function D(N){var Q=N.scObjList,P=Q.length,J=null;if(P>1){J={multiSelect:true,type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,anchor:N.anchor,selectorObjects:[]};var I={};var M="";for(var L=0;L<P;L++){var R=Q[L];var S=R.sc.tks.split("\x1E");for(var K=0;K<S.length;K++){var O=S[K];if(!I[O]){I[O]=true;if(M.length>0){M=M+"\x1E"+O;}else{M=O;}}}}for(var L=0;L<P;L++){var R=Q[L];J.selectorObjects.push({ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid});}if(!J.tks){J.tks=M;}}else{if(P==1){var R=Q[0];J={type:mstrmojo.EnumRWUnitType.GRID,src:N.k,sliceId:1,sid:1,ck:R.sc.ck,ctlKey:R.sc.ckey,tks:R.sc.tks,eid:R.eid,anchor:N.anchor};}}return J;},getLinkAction:function E(J,I){var K=J.node,L=K&&K.titleInfo;return this.getLinkActionImpl(K,L,I);},getPCellParentNode:function A(J,I){return(I==G)?J._lp:J._tp;},getPTitle:function C(J,I){return J.titleInfo;}});})();(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function I(J){mstrmojo.hash.copy(J,this);},initContent:function D(L){this.startIndexInContainer=L||this.startIndexInContainer||0;var K=this.base.show,J=this.base.items;this.rc=K&&J?J.length:0;this.colWidths=K&&this.base.cws||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function B(K,J){return !this.invalidData;},download:function A(K,J){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function C(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function H(){return this.rc;},getUpdatedRows:function G(){return this.updatedRows;},getRowCells:function(U){var N=this.base.items,V=N[U],O=V.items,X=this.lookupBase,Q=this.interactiveCellsArray,W=this.gridData.css,a=null,Z=false,g,P,S,M;if(this.oldGridData){g=this.oldGridData;P=this.oldBase;S=P&&P.items;M=S[U]&&S[U].items;}for(var R=0,Y=O&&O.length||0;R<Y;R++){var L=O[R];if(L){L.v=L.v||L.n;if(X&&!L._e){var T=X[L.tui];a=T&&T.es[L.idx];if(a){L.v=L.v||a.n;if(a.rv){L.rv=a.rv;}L._e=a;}}if(!L.css){L.css=W[L.cni].n;}if(!L._d&&M&&this.preServeUpdatedRows){var K=M[R];if(!K||(K.rs!==L.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((K.v&&L.v!==K.v)){data={};if(L.v!==K.v){data.v=K.v;}if(L.css!==K.css){data.css=K.css;}L._d=data;this.updatedRows[this.startIndexInContainer+U]=true;}}}L._gd=this.gridData._bidx||0;if(L.at>0&&Q){if(L._ei===undefined||Q[L._ei]!==L){L._ei=Q.push(L)-1;}}if(this.axis){L.axis=this.axis;}var b=L.pi;if(b){if(b.ri!==undefined&&b.ci!==undefined){L._p=N[b.ri].items[b.ci];}else{var f=this.gridData.ghs,d=b.left,J=b.top;if(d){L._lp=f.rhs.items[d.ri].items[d.ci];}if(J){L._tp=f.chs.items[J.ri].items[J.ci];}}}}}return O;},getUnmergedCells:function F(O){var Q=[],R=this.base.items,L=this.gridData.css,P=R[O].items[0],K=P&&P.pi,J=K&&K.ri,N=K&&K.ci;while(K&&J>-1&&N>-1){P=P._p||R[J].items[N];var M={};mstrmojo.hash.copy(P,M);if(!M.css){M.css=L[M.cni].n;}M.rs=P.rs-O+J;Q.splice(0,0,M);K=P&&P.pi;J=K&&K.ri;N=K&&K.ci;}return Q;}});})();(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];for(var J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getRowCells(I);},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K);for(var I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0;for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){for(var I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={};for(var J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(K.getUpdatedRows(),I);}}this.updatedRows=I;return I;},download:function B(M,L){var K=this._getCPs(M,L);for(var I=0;I<K.length;++I){var J=K[I];J.download(M,L);}}});})();(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];for(var I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowCells:function(I){var M=this.cps,J=[];for(var L=0,H=M.length;L<H;L++){if(M[L].getAvailableRowsCount()>0&&M[L].rc>I){var K=M[L].getRowCells(I);if(K){J=J.concat(K);}}}return J;},getRowHeight:function C(){return this.cps[0].getRowHeight();},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={};for(var I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}else{mstrmojo.hash.copy(J.getUpdatedRows(),H);}}this.updatedRows=H;return H;},download:function B(J,H){var I=this.cps[1];I.download(J,H);}});})();(function(){mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function E(G){this._super(G);},download:function A(H,G){},initContent:function D(N){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var H=this.gridData.gts,X=(this.gridData.lhv!==0),J=H.row||[],G=H.col||[],P=H.show,M=H.rec,V=this.cts||[],U=J.length,O=V.length,R=this.gridData.css;this.base={items:[]};this.rc=P&&V.length||0;if(this.rc===0&&P){this.rc=U>0?1:0;}this.colWidths=P&&H.cws||[];if(!this.rc){return ;}var L={items:[]},I=1,Q,T;for(T=0;T<U;++T){J[T].axis=1;J[T].ui=T;L.items.push(J[T]);}if(O>0){V[0].axis=2;V[0].ui=0;G[0].axis=2;G[0].ui=0;I=V[0].rs||1;if(X&&I>1){V[0].rs=1;Q=mstrmojo.hash.clone(V[0],{});Q.n="&nbsp;";V[0].cni=R.push({n:(R[V[0].cni].n||"")+" fsbp_1"})-1;}L.items.push(V[0]);}var K=this.base.items;K.push(L);for(T=1;T<O;++T){if(I>1){var S=I;while(S-->1){if(X){var W=mstrmojo.hash.clone(Q,{});W.cni=R.push({n:(R[W.cni].n||"")+" fsbp_"+((S==1)?"3":"2")})-1;K.push({items:[W]});}else{K.push({items:[]});}}}V[T].axis=2;V[T].ui=T;G[T].axis=2;G[T].ui=T;I=V[T].rs||1;if(X&&I>1){V[T].rs=1;Q=mstrmojo.hash.clone(V[T],{});Q.n="&nbsp;";V[T].cni=R.push({n:(R[V[T].cni].n||"")+" fsbp_1"})-1;}K.push({items:[V[T]]});}this.rc=K.length;if(M){this._removeExtraColumn(J,V);}},getAvailableRowsCount:function C(){return this.rc;},isDataAvailable:function B(H,G){return true;},_removeExtraColumn:function F(J,Z){var X=J&&J.length,O=Z&&Z.length,G=this.gridData.gts,R=G.row||[],M=G.col||[],H=R.length,V=M.length;if(!X||!O){if(O===1){var a=Z[O-1];if(a.otp==-1){if(V>0){M[V-1]._hid=true;}this.base.items=[];this.rc=0;}}return ;}var I=J[X-1],S=this.rc,K=this.base.items;if(I){if(I.otp==-1){if(H>0){R[H-1]._hid=true;}K[0].items.splice(X-1,1);}else{var P=S>1?S-1:0,Q=K[P],Y=Q.items.length;if(Y>0&&V>0){M[V-1]._hid=true;}var L=I.fix;if(L){for(var W=0;W<L;W++){Q.items[Y-1+W]=J[X-L+W];}}else{Q.items[Y-1]=I;}for(var U=0,T=O-1;U<T;U++){Z[U].cs=L?L:I.cs;}var N=L?L:1;K[0].items.splice(X-N,N);}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var Y=1,b=2,o=4,U=8,e=1,f=2,F=3,l=4,S=5,K=6,h=7,D={},X={120:0.75,240:1,320:1.5},k={1:30,2:26,3:20,4:70,5:40,6:34,7:40},H=4,P=1,I={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},R=mstrmojo.hash,T=mstrmojo.array;function W(w,s){var t=w[0],p=s.gts,q=p.cws.length;return(s.vp.gr==="1"&&(q>1));}function g(q,z){var w=function(AA,AB){if(AB&&AA&&AA.css&&AA.css.indexOf(AB)<0){AA.css+=" "+AB;}};var t=z.type,s=z.col,x=(s&&s.cl)||0,p=(t===b||t===Y);if(t===b||t===U){w(q,I.RIGHT_ALIGN);}else{if(t===Y||t===o){w(q,I.LEFT_ALIGN);}}if(p){if(s&&s.tg&&x>1){if(!q._v){q._v=q.v;q.v="<span class='toggleHeader'>"+q.v+"</span>";}}w(q,I.TITLE);}T.forEach(z.extraCss,function(AA){w(q,AA);});}function A(p){return 0;}function j(w){var s,t=w.cg,p=t&&t.cgc,q=1;for(s=0;s<p;s++){if(t&&t[s]&&!t[s].tg&&t[s].cl>q){q=t[s].cl;}}return q;}function L(q,p){var s=l;if(p>1){if(q===0){s=e;}else{if(q===p-1){s=F;}else{s=f;}}}return s;}function J(p,w,s,q){var z=q&&q.cols&&q.cols.cg,t,AA=0,x=0;if(z){for(t=0;t<w;t++){if(p[t]){AA+=p[t].length;}}AA+=(s+1);for(t=0;t<z.cgc;t++){x+=z[t].cl;if(x>=AA){return t;}}}return -1;}function N(AA,t,q,p){var z=[],x,s,w,AB;for(s=0,w=AA.length;s<w;s++){if(AA[s].length===1){x=AA[s][0];x.rowType=(x.rowType!==h)?L(t,q):h;x.singleStack=(q>1);x=R.copy(x);if(x.ts===H){if(q===1){x.rowType=l;x.colIdx=J(AA,s,t,p);}else{if(!t){x.colIdx=J(AA,s,t,p);}else{delete x.ts;x.v="";}}}else{if(t){x.v="";}}}else{x=AA[s][t];if(!x){AB=AA[s].length;x=R.copy(AA[s][AB-1],{});x.v="";if(x.hasOwnProperty("ts")){delete x.ts;}}else{if(x.ts===H){x.colIdx=J(AA,s,t,p);}}x.rowType=(x.rowType!==h)?L(t,q):h;}z.push(x);}return z;}function O(p){if(p===0){return 0;}var q=this.sectionMap[p-1]||0;return Math.floor((p-q)/this.stackLevels);}function C(AA){var x,z,w=this.sectionInfo,p=w.length,t=this.srh,q=this.lastSectionIndex;z=w[q];if(AA>=z.rs&&AA<(z.rs+t)){return z;}if(AA<z.rs){x=q-1;if(x<=0){this.lastSectionIndex=0;return null;}do{z=w[x];if(AA>z.rs&&AA<=(z.rs+t)){this.lastSectionIndex=x;return z;}}while(AA<z.rs&&--x>0);this.lastSectionIndex=x;return z;}else{x=q+1;if(x>=p){this.lastSectionIndex=p-1;return null;}do{z=w[x];if(AA>z.rs&&AA<=(z.rs+t)){this.lastSectionIndex=x;return z;}}while(AA>(z.rs+t)&&++x<p);this.lastSectionIndex=x-1;return null;}}function a(AB,s,p,AA){var z=AB[0],w,x=AB.length,q=z&&z.rowType,t={v:"",css:"empty-igcell",rowType:q};if(p!==undefined&&z&&(q===e||q===l||q===S)){t={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+AA+"px;top:-"+(0.5*D[q])+'px;"></div></div>',css:"IG-ActionArrow",_ei:p};}for(w=x-1;w>=x-s;w--){z=AB&&AB[w];if(z){z.css+=" IG-lastdatacolumn";}}AB.push(t);}function Q(AO,AJ,s){var AF=AO.cols,AG=AF.cg,p=[{w:"0px"}];if(AF&&AJ){var AP=AF.cws,q=[],AN=AP.length,AR=0,AB=(parseInt(AO.ar,10)===1)?(AJ/AN):-1,AE,t,AD=false,x=0,AH=AJ,AI=0,AM;for(AM=0;AM<AN;AM++){t=q[AM]=AP[AM];AE=t.w;if(AE===""){AD=true;}else{if(t.xc){AR+=parseInt(AE);AH-=AR;x++;}else{AI+=parseFloat(AE,10);}}}if(AD||AI<100){AB=AH/(AN-x);}for(AM=0;AM<AN;AM++){t=AP[AM];if(t.xc){continue;}else{if(AB===-1){AE=parseInt(t.w,10)*AH/100;if(!AE&&AE!==0){AE=parseInt(AH/AG.cgc,10);}}else{AE=(parseInt(t.w,10)<0)?0:AB;}}q[AM]={w:AE+"px"};}if(s){return q;}var AC=[],AL=0;for(AM=0;AM<AN;AM++){var AQ=AG[AM],AA=AQ.tg?AQ.cl:1,AK=0;for(AK=0;AK<AA;AK++){var z="0px";if(AK===AQ.cc){z=q[AM].w;}AC[AL+AK]={w:z};}AL+=AA;}return AC.concat(p);}else{if(s){return null;}else{return cp.cws.concat(p);}}}function B(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function M(){var AC=this.cps,AB=this.cps[0],AH=Math.max(AC[0].rc,AC[1].rc);if(AB.type!==Y){var AM=this.gridData,AG=function(AP,AS){var AO=AP.base.items,AQ=AP.lookupBase[0].es,AR=AO[AS].items[0],AN=AQ&&AQ[AR.idx];return(AN&&AN.n)||((AR.pi&&AQ[AR.pi.ri||0])||"");},AK,AJ,p=1,z,q,AE,t=0,s=-1,AF,AL,AI=0,AD=this.groupEnabled;for(AF=0,AK=0,AL=AB.cps?AB.cps.length:1;AF<AL;AF++){var x=AB.cps?AB.cps[AF]:AB,AA=x.rc;t=s+1;s=t+AA-1;if(x.isDataAvailable(t,s)){if(x.lastRow){AI=x.lastRow;q=x.lastSection;}else{AK=AI||0;for(AJ=0,p=this.sectionMap[AK-1]||0;AJ<AA;AJ++){var w=this.stackLevels;AE=AG(x,AJ);if(AD&&AE!==q){q=AE;this.sectionInfo.push({sn:AE,rs:this.srh*p+this.stackedRh*Math.floor((AK-p)/this.stackLevels)});this.sectionMap[AK]=++p;AK++;}while(w){this.sectionMap[AK]=p;w--;AK++;}}AI=x.lastRow=AK;x.lastSection=AE;}}else{break;}}this.rc=(this.stackLevels>1?AH*this.stackLevels:AH)+(AD?p:0);}},onDemandDataReady:function Z(){this.adjustCPMaps();},initContent:function V(AC){var AB=this.cps,AN=this.gridData=AB[0].gridData||AB[0].cps[0].gridData,AJ=AN.vp=this.gridVp=this.gridVp||AN.vp,s=AJ.daf&&AJ.daf.split(":"),AD=AJ.cols,AE=AD.cg,AK=AD.cws,AA=AB[A(AE)],AH=AN.gts.row,q=AN.gts,AL=W(AB,AN),z=AA.type!==Y,AG,AI,w,p,AF,x,AM,t=mstrApp.isTablet()?240:mstrMobileApp.getDeviceDPI();R.forEach(k,function(AP,AO){D[AO]=AP*X[t];});if(z){if(AJ.dafIdx===undefined&&s){for(AG=0;AG<AH.length;AG++){if(AH[AG].id===s[0]&&AH[AG].fid===s[1]){AJ.dafIdx=AG;break;}}}}for(AG=0;AG<AE.cgc;AG++){if(AE[AG]&&AE[AG].tg){break;}}if(AG===AE.cgc){AN.gts.show=false;AN.ghs.chs.show=false;}this._super(AC);this.colWidths=Q(AJ,this.gridWidth);this.tdWidths=Q(AJ,this.gridWidth,true);if(z){this.stackLevels=j(AD);if(this.stackLevels>1){this.srh=D[K];this.rh=D[l];this.mrh=D[F];this.stackedRh=D[e]+(this.stackLevels-2)*D[f]+D[F];}else{this.srh=D[K];this.rh=this.stackedRh=this.mrh=D[l];}if(AL||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AL;this.adjustCPMaps();p=this.cps[0].cps;if(p){AM=this;for(AG=0,AI=p.length;AG<AI;AG++){x=p[AG];if(x&&x.addCPListener){x.addCPListener(AM);}}}}}},getUnmergedCells:function(p){return ;},getResolvedGroupHeader:function(s,w){var q=this.gridData,t=q.gts.row[w].es,p=q.ghs.rhs.items[s].items[w];if(p){if(!p.css){p.css=q.css[p.cni].n+" iggroup";p.n=t[p.idx].n;}}else{return{css:" iggroup",n:""};}return p;},getRowCells:function(AL){var AG=this.cps,z=[],AZ=this.gridData,AV=AZ.vp,AJ=AV.cols.cg,AE=AG[A(AJ)],AI=this.groupEnabled,s=AV.bn==="1",AW=[],AK=O.call(this,AL),AA,t,AM=1,AF,q,AC,AS,AR,AU,AY,AD;if(AI&&(this.sectionMap[AL]!==this.sectionMap[AL-1])){var w=R.copy(AE.getRowCells(AK)[0],{});w.cs=this.colWidths.length;w.rowType=K;g(w,{col:null,type:AE.type,extraCss:[I.GROUPING]});return[w];}if(!AL){B.call(this);}this.lastAttRow=this.lastAttRow||(AG[0].rc?AG[0].getRowCells(AK):[]);this.lastMtxRow=this.lastMtxRow||(AG[1].rc?AG[1].getRowCells(AK):[]);AC=this.lastAttRow;AU=AC.length;if(AU>0&&AC[0].stt){AF=true;for(AS=0;AS<AU;AS++){AY=AC[AS];if(AY.stt===P){q=AY;break;}}}if(!this.lastStackCols){T.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AS=0;AS<p.length;AS++){if(p[AS]._ei!==undefined){if(AV.dafIdx>=0){AD=AE.getRowCells(AK)[AV.dafIdx];}AA=(AV.dafIdx>=0)?(AD&&AD._ei):"";return false;}}},this);var AQ=function(p,Aa){if(p&&(Aa.type===Y||Aa.type===b)){if(AO.tg===false){p.n=p.v="";}p.rowType=h;}g(p,{col:AO,type:Aa.type,extraCss:[((Aa.type===U||Aa.type===o)&&s&&(AK%2===1))?I.BANDING:null,AF?I.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AV.dafIdx!==undefined){p._ei=AA;}}};this.lastRowIndex=0;for(AR=0;AR<AJ.cgc;AR++){var AO=AJ[AR],AT=AO["mix"+AO.cc],x=AT!==undefined,AB=AG[x?1:0],AP,AN,AH,AX={n:"",stt:P,css:"xtab-td"};arr=[];if(AO.tg){for(var AS=0;AS<AO.cl;AS++){arr=[];AH=x?AO["mix"+AS]:AO.attForms[AS].idx;var AC=x?this.lastMtxRow:this.lastAttRow;AY=AC[AH];if(AF){if(!AY){AY=AX;}else{if(AY&&AY.stt===P){AY=R.copy(q,AX);}else{AY=R.copy(AY,{});}}}else{AY=R.copy(AY,{});}AQ(AY,AB);arr.push(AY);AW.push(arr);}if(AR+1===AJ.cgc){AM=AO.cl;}}else{for(AP=0,AU=AO.cl;AP<AU;AP++){if(x){AN=AO["mix"+AP];if(AN!==undefined){AY=this.lastMtxRow[AN];}}else{AN=AO.attForms[AP];if(AN){AY=this.lastAttRow[AN.idx];}if(AF&&!AY){AY=AX;}}AQ(AY,AB);arr.push(AY);}AW.push(arr);}}this.lastStackCols=AW;}z=N(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AV);if(this.lastRowIndex>=this.stackLevels){B.call(this);}return z;},getRowHeight:function E(q){var p=D[l];return D[q]||p;},isDataAvailable:function d(q,p){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var w=this.sectionMap.length,t;if(!w){return this.cps[1].isDataAvailable(q,p);}if(p>w){if(q<w){t=O.call(this,q);return this.cps[1].isDataAvailable(t,t+(p-q));}else{return false;}}else{return this.cps[1].isDataAvailable(O.call(this,q),O.call(this,p));}}},download:function G(AA,w){var p=O.call(this,AA),z=p+Math.ceil((w-AA)/this.stackLevels),x=this.cps[0],q,s,t=!x.cps?[x]:this.cps[0]._getCPs(p,z);for(q=0;q<t.length;++q){s=t[q];s.download(p,z);}},getRowCellInfo:function(t){var s=C.call(this,t+this.srh),p,q=this.lastSectionIndex;if(s){p=this.sectionInfo[q-1];return{rowStart:s.rs,isNextRowNewSection:true,sectionName:p&&p.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[q].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TristateCheckBox","mstrmojo._IsInputControl");mstrmojo.CheckBoxDIC=mstrmojo.declare(mstrmojo.TristateCheckBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CheckBoxDIC",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" tabindex="1" mstrAttach:click,keydown></div>',cssText:"width: 0; margin:0 auto; max-height: 18px; cursor: pointer;",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);this.set("checked",true);}else{this.set("checked",!this.checked);}},oncheckedChange:function(A){this.set("value",this[this.checked?"onValue":"offValue"]);},preBuildRendering:function(){this._super();var A=this.dic.vls;this.offValue=A[0].v;this.onValue=A[1].v;this.grayed=(this.onValue!==this.value)&&(this.offValue!==this.value);this.checked=(this.onValue===this.value);},postBuildRendering:function(){this._super();this.domNode.style.height=this.openerStyle.ih+"px";},onkeydown:function(B){var A=B.hWin,C=B.e||A.event;if(C.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(A,C);this.onclick();}},focus:function(){this.domNode.focus();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._SupportsEllipsisText","mstrmojo.android.ui.Label","mstrmojo.android.ui.Menu","mstrmojo.css");var I=mstrmojo.css,B="oversize",E="multiline",K=[B,E];mstrmojo.android.ui.TitleLabel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._SupportsEllipsisText],{scriptClass:"mstrmojo.android.ui.TitleLabel",markupString:'<div id="{@id}" class="mstrmojo-AndroidTitleLabel {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},children:[{scriptClass:"mstrmojo.android.ui.Label",alias:"lbl",touchTap:function(){mstrApp.closeAllDialogs();var P=this.parent,O=P.list,M=O.items,N=M&&M.length;if(!O.visible&&N){if(P._isDropDown&&N===2){O.singleSelect((!O.selectedIndex)?1:0);}else{O.set("visible",true);if(mstrMobileApp&&mstrMobileApp.genMapPreview){mstrMobileApp.genMapPreview();}}}}},{scriptClass:"mstrmojo.android.ui.Menu",alias:"list",selectionPolicy:"reselect",visible:false,setMaxWidth:true}],addChildren:function L(O,M,N){this._super(O,M,N);this.list.attachEventListener("selectionChange",this.id,function(P){var Q=P.added,S=this.list;S.set("visible",false);if(mstrMobileApp&&mstrMobileApp.showMapView){mstrMobileApp.showMapView(0);}if(!Q){return ;}var R=S.items[Q[0]];if(R.isTitle){return ;}if(this._isDropDown){this.setText(R.n);}this.raiseEvent({name:"listSelectionMade",item:R});});},onRender:function J(){var M=this._testLbl=this.lbl.domNode.cloneNode(false),N=this.domNode;mstrmojo.css.addClass(M,"test");M.removeAttribute("onclick");M.removeAttribute("id");N.insertBefore(M,N.lastChild);},unrender:function H(M){delete this.testLbl;this._super(M);},setText:function D(M){this.checkTextFit(M);},checkTextFit:function A(R){var M=this.lbl,T=M.domNode,P=this._testLbl,Q=this._compOffset;R=(R===undefined)?M.text:R;if(Q===undefined){var N=I.getComputedStyle(T);Q=parseInt(N.paddingLeft,10)+parseInt(N.paddingRight,10);this._compOffset=Q;}P.style.width=(T.parentNode.offsetWidth-Q)+"px";P.innerHTML=R;var O=T.offsetHeight,S=(P.offsetHeight>O);I.toggleClass(T,K,S);M.set("text",R);if(S){if(!this.ellipsize("ttl",T,true)){I.addClass(P,B);P.innerHTML=T.innerHTML;if(P.offsetHeight===O){I.removeClass(T,E);}I.removeClass(P,K);}}},setListItems:function G(M,P){var Q=(M&&M.length),N=(P!==undefined),O=this.list;I.toggleClass(this.domNode,"has-items",Q);this._isDropDown=!!N;if(Q){if(!N){M=[{n:mstrmojo.desc(9850,"RECENTLY OPENED"),isTitle:true}].concat(M);}else{this.setText(M[P].n);}}O.set("items",M);if(N){O.singleSelect(P,true);}},clearListItems:function C(){var N=this.list,M={items:[].concat(N.items),idx:N.selectedIndex};mstrmojo.css.removeClass(this.domNode,"has-items");N.set("items",[]);return(M.idx>-1)?M:null;},reset:function F(){this.list.set("visible",false);this.checkTextFit();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.Image","mstrmojo.Label","mstrmojo.Box","mstrmojo.Button","mstrmojo.android.ui.Button","mstrmojo.android.ui.Label","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.Image.baseCssClass+" prv",J=mstrmojo.dom,M=mstrmojo.css;function F(S,Q){var R=S.imgNode;if(R){var T=S.imgNode.style;T[J.CSS3_TRANSITION_DURATION]=Q?"300ms":0;T.opacity=Q;}}function B(){var R=this.imgPreview.params,Q=R&&R.item;if(Q){this.onOpenItem();mstrmojo.all[R.ctrlId].executeItem(Q);}}function D(){if(mstrApp.isTablet()){this.updateScroller();return ;}var f=this._scrollStyle,U=this.scrollNode,b=U.parentNode,Q=b.parentNode;if(!f){var W=M.getComputedStyle(Q),k=M.getComputedStyle(U);this._scrollStyle=f={p:parseInt(W.paddingLeft,10)+parseInt(W.paddingRight,10),b:0,sp:parseInt(k.paddingLeft,10)+parseInt(k.paddingRight,10)};}var a="px",S=f.p,R=f.b,V=f.sp,l=parseInt(this.height,10),h=parseInt(this.width,10),T=this.staticNode,X=T.offsetHeight,e=T.offsetWidth,d=0,Y=(h-S),g=(l-X-S);if(!this.controller.orientation){d=e;Y=(h-e-S);g=l-S;}var Z=Q.style;Z.left=d+a;Z.width=Y+a;Z.height=g+a;var j=b.style;j.width=(Y-R)+a;j.height=(g-R)+a;U.style.width=(Y-R-V)+a;this.updateScroller();}var C=mstrmojo.android.ui.PropertiesView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.ui.PropertiesView",markupString:'<div id="{@id}" class="mstrmojo-PropertiesView {@cssClass}" style="{@cssText}"><div class="mstrmojo-PropertiesViewStatic"></div><div class="mstrmojo-PropertiesViewScroll"><div><div></div></div></div></div>',markupSlots:{staticNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.lastChild.firstChild.firstChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},children:[{scriptClass:"mstrmojo.Image",slot:"staticNode",alias:"imgPreview",cssClass:"prv",visible:false,onload:function(){F(this,1);}},{scriptClass:"mstrmojo.Box",slot:"staticNode",cssClass:"btns",alias:"btns",children:[mstrmojo.android.ui.Button.newButton(mstrmojo.desc(1900,"View"),function(){B.call(this.parent.parent);},{alias:"btnView",cssClass:"mstrmojo-GlowButton",visible:false}),{scriptClass:"mstrmojo.android.ui.Label",alias:"txView",cssClass:"txOffline",visible:false,txData:{},ontxDataChange:function H(){if(!this.txData){this.set("visible",false);this.txData={};}},touchTap:function(){var Q=mstrApp.getTransactionNotificationController(),R=Q&&Q.rootCtrl.getCurrent();if(R){if(R.ctrlType!==2048){R=R.getController("ctrlType",2048);}Q.showNotificationBoard(R||Q.rootCtrl,this.did,this.n);}}}]},{scriptClass:"mstrmojo.Label",slot:"scrollNode",alias:"lblName",cssClass:"nm",visible:false},{scriptClass:"mstrmojo.Label",slot:"scrollNode",alias:"lblDesc",cssClass:"ds"},{scriptClass:"mstrmojo.Label",slot:"scrollNode",alias:"lblCachedOn",cssClass:"ch",text:""}],afterViewVisible:function A(){D.call(this);},rootOrientationChange:function O(){D.call(this);},updateScrollerConfig:function I(){var Q=this._super(),S=this.scrollNode;Q.scrollEl=S;Q.noHScroll=true;Q.origin={x:0,y:0};var T=Math.max(S.offsetHeight-S.parentNode.clientHeight,0);var R=Q.vScroll=(T!==0);if(R){Q.offset={y:{start:0,end:T}};}else{Q.offset=null;}M.toggleClass(this.domNode,"can-scroll",R);return Q;},onOpenItem:mstrmojo.emptyFn,updateView:function P(f){var j=this.imgPreview,e=this.lblName,T=this.lblDesc,W=this.lblCachedOn,R=this.btns.btnView,V=this.btns.txView,d=f.item,S="visible",U="text";var a=f.desc||f.defaultMsg;T.set(U,a);T.set(S,!!a);if(!d){j.set(S,false);e.set(S,false);W.set(S,false);R.set(S,false);V.set(S,false);delete j.params;}else{var Q=mstrmojo.android.ui.PropertiesView.getPreviewSizes();if(mstrApp.isTablet()&&this.controller.orientation){Q.reverse();}mstrMobileApp.getScreenShot(this.id,d.pid||mstrApp.getCurrentProjectId(),d.did,Q[0].h,Q[0].w);var Z=j.params;if(!Z||Z.did!==f.did){j.set("cssClass",G+" i"+f.st);j.set("src","");}j.params=f;j.set(S,true);var Y=f.ttl;e.set(U,Y);e.set(S,!!Y);var h=f.cached;W.set(U,h);W.set(S,(h!==undefined));if(f.avail){R.set(S,true);var g=f.did;if(g){var b=mstrApp.getTransactionNotificationController(),X=(b&&b.hasTransactionQueue(g));V.set("did",g);V.set("n",f.ttl);V.set("visible",X);if(X){b.addWidgetListener(g,V);}}}else{R.set(S,false);V.set(S,false);}}D.call(this);},onPreviewReady:function E(R){if(R){var Q=this.imgPreview;if(Q.src!==R){F(Q,0);Q.domNode.className=G;Q.set("src",R);}}}});var N={160:{h:150,w:200},213:{h:150,w:200},240:{h:225,w:300},320:{h:300,w:400},480:{h:300,w:400}},L={160:{h:334,w:400},213:{h:334,w:400},240:{h:501,w:600},320:{h:668,w:800}},K={160:{h:337,w:400},213:{h:337,w:400},240:{h:506,w:930},320:{h:674,w:1240}};C.getPreviewSizes=function(){var R=[],Q=mstrMobileApp.getDeviceDPI();if(mstrApp.isTablet()){R.push(K[Q]);R.push(L[Q]);}else{R.push(N[Q]);}return R;};}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList");var A=function(O,P){var N=O.parent.opener,F=N&&N.showDesc,M=N&&N.showPath,E=P[O.itemField];var L=mstrmojo.string.escape4HTMLText,Q="";if(M){var I=P.anc&&P.anc.items,K=I&&I.length;if(K>0){for(var H=0;H<K-1;H++){Q+=I[H].n+" > ";}Q+=L(I[K-1].n);}else{if(P.path){Q+=P.path;}}}Q+=(Q.length==0?"":" > ")+L(E);if(F){var J=P[O.itemDescField],G=120;if(J){Q+="\r\n\r\n"+L(J.substring(0,G)+(J.length>G?"...":""));}}return Q;};var C=function(E,F,G){if(!F||!G){return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var H=F.path||F.getAttribute("path");if(H){return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(I){var J=D(I.toString())||"";G.path=J;F.path=1;F.title=A(E,G);}},{taskId:"getObjectDetails",objectID:G.did,objectType:G.t,sessionState:mstrApp.sessionState},undefined);},200);};var D=function(G){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(G,"text/xml");}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(G);}var K=xmlDoc.getElementsByTagName("path")[0],H=K.childNodes,J="";if(H){for(var F=0,E=H.length;F<E;F++){var I=H[F].childNodes&&H[F].childNodes[0];if(I){J+=mstrmojo.string.escape4HTMLText(I.nodeValue)+(F<E-2?"> ":"");}}}return J;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",itemDescField:"desc",getItemMarkup:function(G,E){var F=this.parent.opener,H=A(this,G);return'<div class="mstrmojo-suggest-text '+((F&&F.item2textCss(G))||"")+'" idx="'+E+'" title="'+H+'">'+F.getHighlightedText(F.getSearchPattern(),mstrmojo.string.escape4HTMLText(G[this.itemField]))+"</div>";},getItemProps:function B(F,E){return{};},onmouseover:function(F){var I=this.parent.opener;if(I&&I.showPath){var G=mstrmojo.dom.eventTarget(F.hWin,F.e),E=G.getAttribute("idx"),H=E!=null?this.items[E]:null;if(H&&H.t>-1){C(this,G,H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.css");var E=mstrmojo.css,B="glow",F=mstrmojo.dom,D=F.$TRANS_DURATION,A;function C(I){var H=I.style;H[D]=0;E.addClass(I,B);window.setTimeout(function(){H[D]="300ms";E.removeClass(I,B);},100);}mstrmojo.ui.MobileCheckList=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.ui.MobileCheckList",multiSelect:true,hasEvenRows:true,glow:true,allowTouchBubble:false,listHooks:{select:function(I,J,H){if(this.glow&&!this.skipEvent){C.call(this,I);}},unselect:function(I,J,H){if(this.glow&&this.multiSelect&&!this.skipEvent){C.call(this,I);}}},getItemMarkup:function(H){if(!A){A=this._super(H).replace("{@n}","<div><h3>{@n}</h3></div>");}return A;},init:function G(I){this._super(I);var H=["mobile-checklist"];if(this.multiSelect){H.push("multi");}mstrmojo.css.addWidgetCssClass(this,H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.android._HasLingeringListSelections");var A=[],F=mstrmojo.dom,E=mstrmojo.string;mstrmojo.android.ui.FolderView=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo.android._HasLingeringListSelections],{scriptClass:"mstrmojo.android.ui.FolderView",allowTouchBubble:false,useSelectScroll:true,highlightOnSelect:true,hasEvenRows:true,listHooks:{select:function(I){I.style[F.CSS3_TRANSITION_DURATION]=0;},unselect:function(I){I.style[F.CSS3_TRANSITION_DURATION]="300ms";}},getItemMarkup:function(K){var M=K.desc,L=K.isc,J=((M)?1:0)+((L)?2:0);if(!A[J]){var I="<h3>{@n}</h3>";if(M){I+="<h4>{@desc}</h4>";}I+="<div><div><div></div></div></div>";A[J]=this._super(K).replace("{@n}",I);}return A[J];},getItemProps:function C(M,I){var L=this._super(M,I),N=M.desc||"",K=this.controller.isItemCached(M),J=!(K||this.controller.isItemAvail(M,true));L.addCls("ty"+(M.st||2048));if(L.n){L.n=E.htmlAngles(L.n);}if(N){L.desc=E.htmlAngles(N);L.addCls("desc");}if(K&&M.st!==2048){L.addCls("cached");}else{if(M.isc){L.addCls("isc");}}if(M.unread){L.addCls("new");}if(J){L.addCls("disabled");}return L;},canItemLinger:function H(I){return this.controller.canItemLinger(I);},buildRendering:function G(){var I=this._super();var J=document.createElement("div");J.className="clear-me";this.itemsContainerNode.appendChild(J);return I;},preselectionChange:function D(I){var J=I.added,L=I.removed;if(J){var K=this.items[J[0]];if(!this.controller.isItemAvail(K)){if(L&&L.length){this.select(L,true);}return false;}}return true;},touchSelectBegin:function B(K){var I=this.getItemIdxTouch(K);if(I>-1){var J=this.controller;if(!J.itemLongPressed||!J.itemLongPressed(this.items[I])){this._super(K);}else{return false;}}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.android.SimpleList","mstrmojo.OfflineTransactionModel");var F=mstrmojo.OfflineTransactionModel,H=F.PENDING,C=F.FAILED;mstrmojo.android.ui.TxEditDoc=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.TxEditDoc",markupString:'<div id="{@id}" class="mstrmojo-TxEditDoc {@cssClass}" style="{@cssText}"><div></div><div></div><div></div></div>',markupSlots:{typeNode:function(){return this.domNode.firstChild;},txNode:function(){return this.domNode.childNodes[1];},btmNode:function(){return this.domNode.lastChild;}},model:null,docDid:null,children:[{scriptClass:"mstrmojo.android.SimpleList",alias:"txList",slot:"txNode",cssClass:"txList",postselectionChange:function(K){var M=K.added,J=M&&M[0],L=this.parent.parent;if(L){L.enableButtons(J!==null);}}}],addChildren:function I(L,J,K){L=L.concat([mstrApp.viewFactory.newView("TransactionsTypeList",{alias:"typeList",slot:"typeNode",cssClass:"txTypeList",selectionPolicy:"reselect",postselectionChange:function(N){var P=N.added,M=P&&P[0];if(M!==null){var Q=[],O=this.parent;mstrmojo.array.forEach(this.parent._tx[M?C:H],function(S,R){Q.push({n:S.n,v:S.timestamp,idx:R});});O.txList.set("items",Q);O.typeSelected(M);}}})]);this._super(L,J,K);},getType:function G(){return this.typeList.selectedIndex;},setType:function D(J){this.typeList.singleSelect(J);},getSelectedTx:function B(){return this.txList.getSelectedItems()[0];},typeSelected:mstrmojo.emptyFn,generateTypeList:function A(S){var R=this.docID;if(!R){return ;}var P=this.model,Q=(P&&P.docsTx)||[],K=Q[R],J=[],L=[];if(K){J=K[H];L=K[C];}var O=this._tx={};O[H]=J;O[C]=L;var M=this.typeList,N=Math.max(M.selectedIndex,0);M.set("items",[{n:mstrmojo.desc(9250,"Pending"),v:J.length},{n:mstrmojo.desc(9251,"Failed"),v:L.length}]);if(S){N=(L.length)?1:0;}M.singleSelect(N);},ondocIDChange:function E(){this.generateTypeList(true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo._SupportsEllipsisText","mstrmojo.css");var C;mstrmojo.android.medium.ui.HomeScreenView=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo._SupportsEllipsisText],{scriptClass:"mstrmojo.android.medium.ui.HomeScreenView",selectionPolicy:"reselect",itemsFloat:true,getItemMarkup:function E(){if(!C){var J=this.hsFmt.btn,L="",I=["btn"],M='<div class="ttl" style="color:'+J.c+';">{@txt}</div>',H="</div>",K=[],G=-1;if(J.sty>1){L="border-color:"+J.bc+";background-color:"+J.bg+";";}K[++G]='<div class="btnC" idx="{@idx}">';K[++G]='<div class="'+I.join(" ")+'" style="'+L+'">';K[++G]='<div class="{@iconClass}" style="{@iconStyle}">';if(this.items.length<=4){K[++G]=M;K[++G]=H;K[++G]=H;}else{K[++G]=H;K[++G]=H;K[++G]=M;}K[++G]=H;C=K.join("");}return C;},getItemProps:function D(I,H){var J="",G="";if(I.icn){J="background-image: url("+I.icn+");";}else{G=" ic"+(I.act||I.st);}return{idx:H,txt:I.txt,iconStyle:J,iconClass:G};},preBuildRendering:function B(){mstrmojo.css.addWidgetCssClass(this,(this.items.length>4)?"multiCol":"singleCol");return this._super();},onRender:function F(){var L=this.itemsContainerNode,G=L.childNodes,K=G.length-1,J;if(K>4){for(J=0;J<K;J++){this.ellipsize("ttl",G[J].lastChild,true);}}var I=this.hsFmt.bg;if(I){var H=I.v,M=this.domNode.style;if(I.tp!==1){H="transparent url("+H+") no-repeat 0 0";M.backgroundSize="100%";}M.background=H;}},afterViewVisible:function A(){var H=document.createElement("table"),G=this.domNode;G.appendChild(H);window.setTimeout(function(){G.removeChild(H);},100);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.css","mstrmojo.array");function A(){var E=this.items.length;if(E){var F=Math.floor(parseInt(this.width,10)/E),D=parseInt(mstrmojo.css.getStyleValue(this._getItemNode(E-1),"borderLeftWidth"),10);mstrmojo.array.forEach(this.itemsContainerNode.childNodes,function(H,G){if(G<E){H.style.width=(F-((G)?D:0))+"px";}});}}mstrmojo.android.medium.ui.TxButtons=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.medium.ui.TxButtons",itemsFloat:true,onRender:function C(){A.call(this);},setDimensions:function B(E,D){this._super(E,D);if(this.hasRendered){A.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList");var A;mstrmojo.android.ui.TxDocList=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.ui.TxtDocList",scrollerConfig:{bounces:false,showScrollbars:false},highlightOnSelect:true,getItemMarkup:function C(D){if(!A){A=this._super(D).replace("{@n}","<h3>{@n}</h3><h4>{@desc}</h4><em>{@cnt}</em>");}return A;},getItemProps:function B(F,D){var E=this._super(F,D);E.desc=F.desc;E.cnt=F.c;return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList");mstrmojo.android.selectors.ListBox=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.selectors.ListBox",init:function B(C){this._super(C);mstrmojo.css.addWidgetCssClass(this,["selector-listbox"]);},postBuildRendering:function A(){var H=parseInt(this.height,10);if(H){var F=this.itemsContainerNode,C=F.offsetHeight;if(C<H){var E=this.items.length,G=Math.round(H/this.items.length)+"px",D=0;for(D=0;D<E;D++){F.childNodes[D].style.lineHeight=G;}}}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.android.ui._CanBeFullScreen","mstrmojo.array","mstrmojo.css","mstrmojo.android.ui.ActionToolbarButtons","mstrmojo.android.ui.Menu","mstrmojo.android.EnumMenuOptions","mstrmojo._TouchGestures");var N=mstrmojo.array,T=mstrmojo.css,M=1,F=2,E=mstrmojo.android.EnumMenuOptions,K=E.SHARE,J=E.ANNOTATION;function R(){return false;}function S(V){if(!this.active){return ;}var W=V.added,Z=V.src,X=W&&Z.items[W[0]],Y=this.menu;if(!X){return ;}if(X.isMenu){if(mstrMobileApp&&mstrMobileApp.genMapPreview){mstrMobileApp.genMapPreview();}Y.set("visible",!Y.visible);}else{if(X.grp!==K&&X.grp!==J){mstrApp.closeAllDialogs();}if(Z===Y){Y.set("visible",false);if(mstrMobileApp&&mstrMobileApp.showMapView){mstrMobileApp.showMapView(0);}}mstrmojo.all[this._actController].handleMenuItem(X.grp,X.act);}}function G(){var X=[],W=this.icons,V=this.groups,Y=this.actions;N.forEach(this.labels,function(a,Z){X.push({cls:"ic"+W[Z],grp:parseInt(V[Z],10),act:parseInt(Y[Z],10),n:a});});return X;}function Q(e){var a=[],d=this.icons,V=this.groups,W=this.actions,Z=this.labels;N.forEach(this.types,function(g,f){if(g===F){a.push({cls:"ic"+d[f],act:parseInt(W[f],10),grp:parseInt(V[f],10),idx:f,n:Z[f]});if(a.length===e){return false;}}});var X;for(X=a.length-1;X>=0;X--){var Y=a[X],b=Y.idx;delete Y.idx;this.types.splice(b,1);this.groups.splice(b,1);this.labels.splice(b,1);this.actions.splice(b,1);this.checked.splice(b,1);this.icons.splice(b,1);}return a;}var A=mstrmojo.android.ui.ActionToolbar=mstrmojo.declare(mstrmojo.Box,[mstrmojo.android.ui._CanBeFullScreen],{scriptClass:"mstrmojo.android.ui.ActionToolbar",active:true,init:function P(V){this._super(V);T.addWidgetCssClass(this,"mstrmojo-ActionToolbar");},children:[{scriptClass:"mstrmojo.android.ui.ActionToolbarButtons",alias:"buttons"},{scriptClass:"mstrmojo.android.ui.Menu",alias:"menu",visible:false}],addChildren:function L(X,V,W){this._super(X,V,W);N.forEach(this.children,function(Y){Y.attachEventListener("selectionChange",this.id,S);},this);},setActions:function B(Z,W){var Y=[],V=R();var X=W.getBtnCount(W.minBtnCount,W.maxBtnCount);if(X){Y=Q.call(W,X);}if(W.size()){if(V){mstrMobileApp.setSysMenu(Z,W.groups,W.labels,W.actions,W.checked,W.icons);}else{Y.push({cls:"menu",isMenu:true,n:"Menu"});this.menu.set("items",G.call(W));}}this.buttons.set("items",Y);this._actController=Z;this.raiseEvent("renderComplete");this.resetFullScreen();},onactiveChange:function I(){T.toggleClass(this.domNode,"inactive",!this.active);},reset:function U(){this.menu.set("visible",false);},onEnterFullScreen:function D(){this.reset();},propogateMenuVisibleChange:function C(V){mstrmojo.touchManager.raiseEvent({name:"actionBarMenuStateChange",value:V});}});function O(Y,W,V,a,Z,X){this.types.push(Y);this.groups.push(String(W));this.labels.push(String(V));this.actions.push(String(a));this.checked.push(String(!!Z));this.icons.push(X||-1);}A.newToolbarConfig=function H(){var W={addMenuItem:function Y(d,b,g,f,e){O.call(this,M,d,b,g,f,e);this.mnuCount++;},addToolbarBtn:function a(d,b,g,f,e){O.call(this,F,d,b,g,f,e);this.btnCount++;},getBtnCount:function X(f,d){var e=this.btnCount;if(this.mnuCount){e++;}var b=Math.min(e,d);if(b<f){return 0;}if(b===d){if(!R()&&(this.mnuCount||(e>b))){b--;}}return b;},clear:function V(){this.btnCount=0;this.mnuCount=0;this.maxBtnCount=5;this.minBtnCount=1;this.types=[];this.groups=[];this.labels=[];this.actions=[];this.checked=[];this.icons=[];},size:function Z(){return this.labels.length;}};W.clear();return W;};}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ScrollableTabs","mstrmojo.css","mstrmojo.dom","mstrmojo.hash");var A=mstrmojo.css,D=mstrmojo.dom,F=mstrmojo.hash;mstrmojo.android.ui.LayoutSelector=mstrmojo.declare(mstrmojo.android.ui.ScrollableTabs,null,{scriptClass:"mstrmojo.android.ui.LayoutSelector",init:function E(H){this._super(H);var G=this.markupMethods=F.copy(this.markupMethods);G.onvisibleChange=function(){var L=this._hFade;if(L){window.clearTimeout(L);delete this._hFade;}var J=this.items;if(!J||J.length<=1){return ;}var I=!!this.visible,K=this.domNode;if(I){K.style.marginTop=0;}A.toggleClass(K,"open",I);};},initiateFade:function C(G){var H=this.id;this._hFade=window.setTimeout(function(){var I=mstrmojo.all[H];if(I){I.set("visible",false);}},G||2000);},postBuildRendering:function B(){var G=this.id;D.attachEvent(this.domNode,"webkitTransitionEnd",function(){var H=mstrmojo.all[G];if(!H.visible){H.domNode.style.marginTop="-10000px";}});return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate");mstrmojo.MCSUtil=mstrmojo.provide("mstrmojo.MCSUtil",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],getQuaByFunc:function(U,V){var R=this.F,Q=this.Q,T=mstrmojo.array;var S=function(W){if(T.indexOf(R[1],W)!==-1){return true;}else{return false;}};if(V===undefined||V==this._GENERIC){return Q._G;}else{if(S(U)){return(V==this._RANK)?Q._RT:Q._PT;}else{return(V==this._RANK)?Q._RB:Q._PB;}}},getFuncInfo:function(Q,R){var T,S;switch(R){case this.Q._G:T=this._GENERIC;S=0;break;case this.Q._RT:T=this._RANK;S=1;break;case this.Q._RB:T=this._RANK;S=2;break;case this.Q._PT:T=this._PERCENT;S=1;break;case this.Q._PB:T=this._PERCENT;S=2;break;default:return{};}return{ft:T,f:this.F[S][Q]};},getOpIdxByfunc:function(U,V){if(!U||!V){return -1;}var R=this.F,Q=this.Q,T=mstrmojo.array,S=-1;switch(V){case this._GENERIC:S=T.indexOf(R[0],U);break;case this._RANK:case this._PERCENT:S=T.indexOf(R[1],U);if(S==-1){S=T.indexOf(R[2],U);}break;}return S;},getIncludeByOp:function(R){var Q=this.OP;switch(R){case Q._EQUALS:case Q._GREATER_EQUAL:case Q._LESS_EQUAL:case Q._BETWEEN:case Q._IN:return true;}return false;},formatNumber:function(T,R,Q){if(T==B.Q._G){var S=mstrmojo.num;return(Q.fm)?S.formatByMask(Q.fm,R):S.format(Q.cat,Q.dp,Q.curr,R);}else{if(T==B.Q._RB||T==B.Q._RT){return parseInt(R);}else{if(T==B.Q._PB||T==B.Q._PT){return parseFloat(R)+"%";}}}}});var B=mstrmojo.MCSUtil,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,F=[{n:mstrmojo.desc(2795,"Equals"),v:B.OP._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:B.OP._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:B.OP._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:B.OP._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:B.OP._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:B.OP._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:B.OP._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:B.OP._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:B.OP._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:B.OP._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:B.OP._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:B.OP._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var D=function(Y,Q,S,U,T){if(T==2){return Q;}var Z=String(Y).split(";"),W=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(U&&Z&&Z.length>1){Q.code=W;}else{for(var V=0;V<Z.length;V++){var X=parseFloat(Z[V],10);if(isNaN(X)||(S&&((Z[V].match(/^\d+(\.\d+)?%$/)==null&&Z[V].match(/^\d+(\.\d+)?$/)==null)||X<0||X>100))||(!S&&Z[V].match(/\d+$/)==null)){Q.code=W;}if(Q.code!=R){break;}}}if(Q.code!=R){Q.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return Q;};var M=function(Q){Q=parseFloat(Q);if(isNaN(Q)){return"54px";}else{return(Q*72/16)+"pt;";}},P=function(S){if(S.hasRendered){var R=S.domNode.style;R.font=S.font;R.width=M(R.fontSize);}else{var Q=S.font.match(/[^\s]*?pt/)||[];S.cssText=S.cssText+" font:"+S.font+"; width:"+M(Q[0]);}},I=function(Q){if((Q>=8&&Q<=16)||(Q>=23&&Q<=25)||Q==30){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function O(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(Q){if(this._super){this._super(Q);}this._init();},_init:function(T){switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(T){this.cs=[];this.f=this.ft=null;}var U=B.getOpIdxByfunc(this.f,this.ft),Q;if(this.qua==0||this.dt==30){Q=(U==B.OP._IS_NOT_NULL||I(this.dt))?(U==-1)?B.OP._GREATER_EQUAL:U:B.OP._IS_NULL;}else{Q=(U==-1)?B.OP._GREATER_EQUAL:U;}this.set("opId",Q);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId==B.OP._IN||this.opId==B.OP._NOT_IN){for(var S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function C(Q,R){this.da=Q;this.updateExpr(R);},updateExpr:function A(Q){if(Q){this.cs=Q.cs;this.f=Q.f;this.ft=Q.ft;this.qua=Q.qua;}this._init();},onquaChange:function N(Q){this._init(true);this.func.items=(this.qua!=0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!=0)?L:I(this.parent.dt)?F:H;},onchange:function(){var Q=this.parent,R=this.selectedItem;if(R&&R.v!==null&&R.v!==undefined){Q.set("opId",R.v);}if(mstrApp.isMobile&&(R.v===B.OP._IS_NULL||R.v==B.OP._IS_NOT_NULL)){if(Q.onchange){Q.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){var R=this.parent,Q=this.domNode;R.set("cs1",this.value);if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(R){var Q=R.hWin,U=R.e||Q.event,T=this.parent,S=R.src.domNode;if(U.keyCode===13&&T.apply&&T.apply.enabled){T.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(Q){var R={id:this.id,code:K.STATUSCODE.VALID,msg:""},S=this.parent;D(Q,R,(S.qua==3||S.qua==4),(S.opId!=8&&S.opId!=9),(S.numFmts&&S.numFmts.cat));return R;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){P(this);},onValid:function(){this.parent.set("cs2",this.value);var Q=this.domNode;if(Q&&Q.value.length>6){Q.title=Q.value;}else{if(Q){Q.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(R){var Q=R.hWin,T=R.e||Q.event,S=this.parent;if(T.keyCode===13&&S.apply&&S.apply.enabled){S.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var S=this.parent,V=(S.qua==B.Q._PT||S.qua==B.Q._PB);S.cs=[];var T=function(W){return W+((V&&!String(W).match(/^\d+%$/))?"%":"");};var R=function(W,X){return((W==2||W==3)&&X==0)?14:5;};if(S.opId==B.OP._IN||S.opId==B.OP._NOT_IN){var U=String(S.cs1).split(";");for(var Q=0;Q<U.length;Q++){if(!mstrmojo.string.isEmpty(U[Q])){S.cs.push({dtp:5,v:T(U[Q])});}}}else{if(S.vldTbL.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs1)});}if(S.vldTbH.visible){S.cs.push({dtp:R((S.numFmts&&S.numFmts.cat),S.qua),v:T(S.cs2)});}}if(S.onchange){S.onchange();}if(S.makeSelection){S.makeSelection();}}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(F,D){var E=this.items;this.items=D||[];return E!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var E=this.value,D=this.selectedIndex,G=this.items||[],H,F;if(D===undefined||(E!==null&&(D===-1||(D!==-1&&G[D]&&G[D][this.itemIdField]!==E)))){D=mstrmojo.array.find(G,this.itemIdField,E);D=(D>-1)?D:this.defaultSelection;this.selectedIndex=D;}else{if(E===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=H=G[this.selectedIndex];if(H){F=H[this.itemField];}else{F=this.defaultText||"";}this.set("text",F);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function(E){var F=this.value,D=-1;if(F!==null){D=mstrmojo.array.find(this.items,this.itemIdField,F);}if(D>-1){this.selectedItem=this.items[D];this.selectedIndex=D;}},togglePopup:function C(){if(this.popupToBody){var G=mstrmojo.dom.position(this.popupNode,true),F=this.popupRef,D={left:Math.round(G.x)+"px",top:Math.round(G.y)+"px"};if(!F.hasRendered){delete F.slot;D.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(D,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var E=this.popupRef.domNode;if(E){if(this.fixWidth){E.style.width=(this.domNode.offsetWidth-2)+"px";}else{E.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(D){this.togglePopup();},unrender:function B(D){var E=this.popupRef;if(this.popupToBody&&E.hasRendered){E.unrender(false);}if(this._super){this._super(D);}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var F=this.opener,E=F&&F.popupZIndex,G=F&&F.popupCssClass||"",D=this.domNode;if(E){D.style.zIndex=E;}if(G){mstrmojo.css.addClass(D,[G]);}if(F&&F.fixWidth){mstrmojo.css.addClass(D,["fix-width"]);}if(F&&F.fixHeight){mstrmojo.css.addClass(D,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(F,D,E){return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+(F[E.itemCSS]||"")+'" title="'+F[E.itemField]+'">'+(F[E.itemField]||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var F=this.parent,G=F.visible,D=F.opener,E=this.selectedItem;if(!D||!E||!G){return ;}D.set("value",E[this.itemIdField]);}}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.MobileCalendar","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton");mstrmojo.android.inputControls.CalendarDIC=mstrmojo.declare(mstrmojo.MobileCalendar,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.CalendarDIC",onpopupResized:function A(C){var B=this.domNode;if(B){B.style.zoom=parseInt((95*C.width/B.offsetWidth),10)+"%";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.Button");var B=mstrmojo.android.ui.Button.newButton;mstrmojo._CanMakeServerProxyRequests=mstrmojo.provide("mstrmojo._CanMakeServerProxyRequests",{_mixinName:"mstrmojo._CanMakeServerProxyRequests",cancelRequests:function A(){return this.serverProxy.cancelRequests();},serverRequest:function C(J,K,E){var I=this;try{K=K||{};E=E||{};E.projectId=E.projectId||this._currentProjId;E.mobileConfig=this.getConfiguration();var F=E.src||(arguments.callee&&arguments.callee.caller.name);var D=function(L){if(E[L+"Wait"]){I.hideMessage();}if(E[L+"Progress"]){mstrMobileApp.hideProgress();}};if(!E.silent){K=mstrmojo.func.wrapMethods(K,{submission:function(L){if(!L){if(E.showWait){I.showMessage();}if(E.showProgress){mstrMobileApp.showProgress(E.progressStateText,!!E.useRefreshProgress);}}},failure:function(L){D("show");if(L&&L.requireDeviceCertificate){var M=function(){try{mstrApp.rootController.spawn(mstrApp.controllerFactory.newController("Settings",{}),{viewFn:"getCertificateAuthenticationFieldsView"});}catch(N){L.method=F;mstrApp.handleError(N,I);}};mstrmojo.confirm("Missing/invalid/expired device certificate detected. Would you like to get a new one?",[B(mstrmojo.desc(1442,"OK"),M),B(mstrmojo.desc(221,"Cancel"))]);return ;}if(!(E.noErrorMessage||L.noErrorMessage)){L.method=F;mstrApp.handleError(L,I);}},complete:function(){D("hide");},canceled:function(){D("show");}});}try{I.serverProxy.request(K,J,!!E.override,E);}catch(H){K.failure(H);}}catch(G){mstrApp.handleError(G,this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._TouchGestures","mstrmojo.android.ui.Button","mstrmojo.array","mstrmojo.dom","mstrmojo.css");mstrmojo.requiresDescs(221);var D=mstrmojo.css,C=mstrmojo.android.ui.Button.newButton;mstrmojo.android.DropDownList=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.DropDownList",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-AndroidDropDownList {@cssClass}" mstrAttach:click><div>{@value}</div></div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onvalueChange:function(){var K=this.value,I=this.options;if(I){var H=mstrmojo.array.find(I,"v",K),J=I[H];this.valueNode.innerHTML=J.n;if(K!=="-1"&&I[0].v==="-1"){I.shift();H--;}this.idx=H;}}},options:null,value:"",name:"",idx:0,singleSelectByField:function G(H){this.set("value",H);},touchTap:function F(){var J=this.id,H=this.domNode,I=mstrApp;I.showDialog({autoClose:true,title:this.name,fadeOnClose:false,cssClass:"dropDownList",onClose:function(){D.removeClass(H,"down");},children:[{scriptClass:"mstrmojo.ui.MobileCheckList",items:this.options,multiSelect:false,isElastic:true,selectedIndex:this.idx,hasEvenRows:true,postselectionChange:function(K){mstrApp.closeDialog();mstrmojo.all[J].set("idx",K.added[0]);}}],buttons:[C(mstrmojo.desc(221,"Cancel"),function(){mstrApp.closeDialog();})]});D.addClass(H,"down");},touchSelect:function A(){this.touchTap();},onidxChange:function E(){var H=this.options;if(H){this.set("value",H[this.idx].v);}},preBuildRendering:function B(){this._super();var H=this.options;if(H){this.value=H[this.idx].v;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout","mstrmojo._TouchGestures","mstrmojo.android.ui.Image","mstrmojo.dom","mstrmojo.css");var F={containerNode:"100%"};mstrmojo.android.ui.ResultSetView=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.ResultSetView",layoutConfig:{h:F,w:F},init:function G(I){this._super(I);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ResultSetView");},rootOrientationChange:mstrmojo.emptyFn,addChildren:function A(K,I,J){if(!this.btnFullScreen){K=K.concat([{scriptClass:"mstrmojo.android.ui.Image",alias:"btnFullScreen",cssClass:"btnFullScreen",ignoreLayout:true,visible:false,touchTap:function(){this.parent.controller.viewTap();}}]);}this._super(K,I,J);},delegateToolbar:function H(I){return false;},setActionToolbarStatus:mstrmojo.emptyFn,getMaskNode:mstrmojo.emptyFn,touchTap:function E(){this.controller.viewTap();},enterFullScreen:function D(){this.btnFullScreen.set("visible",true);},exitFullScreen:function B(){this.btnFullScreen.set("visible",false);},flashFullScreen:mstrmojo.emptyFn,cancelFlashFullScreen:mstrmojo.emptyFn,getPosition:function C(){var I=this.domNode;return I?mstrmojo.dom.position(I):undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ToggleDIC","mstrmojo._TouchGestures","mstrmojo.android._HasPreviewButton","mstrmojo.url","mstrmojo.array");mstrmojo.android.inputControls.ToggleDIC=mstrmojo.declare(mstrmojo.ToggleDIC,[mstrmojo._TouchGestures,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.ToggleDIC",useAnimation:false,init:function C(D){this._super(D);mstrmojo.array.forEach(this.dic.vls,function(E){E.n=mstrmojo.url.getAbsoluteURL(E.n,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());});},touchTap:function B(){this.onclick();},onclick:function A(){this._super();this.applyChanges();},onblur:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayout");function F(P){var N=-1,O=P.children,M,L,K,I,J=[],H=function(){var R;for(R in J){var Q=J[R];if(Q._fixedHeight!==N){Q._fixedHeight=N;if(Q.domNode){Q.domNode.style.height=N+"px";}}}N=-1;J=[];};for(L in O){M=O[L];if(M.node.data.bh&&N>-1){H();}if(M.defn.horiz){for(K in M.children){I=M.children[K];N=Math.max(I._fixedHeight||0,N);J[J.length]=I;}}}H();}mstrmojo.DocLayoutHoriz=mstrmojo.declare(mstrmojo.DocLayout,null,{scriptClass:"mstrmojo.DocLayoutHoriz",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},getWidth:function A(){return this.containerNode.offsetWidth;},getHeight:function G(){return this.containerNode.offsetHeight;},_renderSection:function C(L,I){if(L.node.data.bh){var M=document.createElement("div");M.className="mstrmojo-DocLayout-HBox";var J=document.createElement("table");J.className="mstrmojo-DocLayout-HBox-HorizContainerTable";this._hRow=J.insertRow(-1);M.appendChild(J);this.containerNode.appendChild(M);}if(L.defn.horiz){var H="hi"+I;L.slot=H;var N=this._hRow.insertCell(-1);N.vAlign="top";var K={};K[H]=N;this.addSlots(K);}this._super(L,I);},getLayoutMinWidth:function B(){var I=0,Q=0,J=this.children,P=J.length,N,M;for(N=0;N<P;N++){var O=J[N],L=O&&O.node,H=L&&L.data,K=H&&(String(H.bh)==="true"||String(H.bv)==="true");if(K){I=Math.max(I,Q);Q=0;}if(O.children){for(M in O.children){Q+=O.children[M].width();}}else{Q+=10;break;}}return Math.max(I,Q);},resizeOrReposition:function E(){if(this._super){this._super();}F(this);},renderCtrlsInViewport:function D(){this._super();F(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip","mstrmojo.HBox");var B=mstrmojo.dom,C=mstrmojo.css,A=1,G=2,F=3,E=function(I){var H=C.getStyleValue(I,"verticalAlign");return{top:A,bottom:F,middle:G}[H]||A;};mstrmojo.SliderBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SliderBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table></div>',markupSlots:{valuePartNode:function(){return this.domNode.firstChild;},valueLabelNode:function(){return this.domNode.firstChild.firstChild;},valueTextNode:function(){return this.domNode.firstChild.lastChild;},sliderPartNode:function(){return this.domNode.lastChild;},minTextNode:function(){return this.domNode.lastChild.rows[0].cells[0];},maxTextNode:function(){return this.domNode.lastChild.rows[0].cells[2];},sliderNode:function(){return this.domNode.lastChild.rows[0].cells[1];}},markupMethods:{onmaxChange:function(){this.maxTextNode.innerHTML=this.max;},onminChange:function(){this.minTextNode.innerHTML=this.min;},onvalueTextChange:function(){this.valueTextNode.innerHTML=this.valueText;},onunsetChange:function(){var H=this.sliderBar.domNode;if(H){mstrmojo.css.toggleClass(H,"unset",this.unset);}}},tabIndex:-1,sliderRef:null,valueLabel:mstrmojo.desc(4104,"Value:"),valueText:"",min:"",max:"",interval:0,isSequential:false,unset:false,cssClass:"mstrmojo-SliderGroup",postCreate:function D(){if(!this.sliderRef){this.sliderRef={scriptClass:"mstrmojo.Slider",isHoriz:true,ontitleChange:function(){if(this.domNode&&this.title){this.domNode.setAttribute("title",this.title);}},onselectionChange:function(){if(!this.hasRendered){return ;}var I=this.items[this.selectedIndex]&&this.items[this.selectedIndex].n,H=this.parent;if(H.unset){H.unset=false;C.removeClass(this.domNode,"unset");}H.set("valueText",I);H.set("value",I);this.typeHelper.updateThumb();}};}this.sliderRef.slot="sliderNode";this.sliderRef.alias="sliderBar";this.addChildren(this.sliderRef);},preBuildRendering:function(){this._super();var M=this.min,I=this.max,K=mstrmojo.num.parseNumeric(this.value),J=this.items,H,L=this.sliderBar;if(this.isSequential){H=Math.floor((Math.max(Math.min(K,I),M)-M)/this.interval);if(isNaN(K)||K<M||K>I){this.unset=true;}}else{H=mstrmojo.array.find(J,"v",String(K));if(H==-1){this.unset=true;H=0;}}L.set("items",J);L.select(H||0);},postBuildRendering:function(){this._super();if(this.unset){C.addClass(this.sliderBar.domNode,"unset");}},alignSlider:function(K,H){var J=E(K),I,L;if(!this.valuePartNode){L=this.valueCssText||"";I=this.sliderCssText||"";if(J===A){this.valueCssText="top:0;"+L;this.sliderCssText="top:0;"+I;}else{if(J===F){this.valueCssText="bottom:0;"+L;this.sliderCssText="bottom:0;"+I;}else{this.valueCssText="height: 100%; line-height: "+H+"px;"+L;this.sliderCssText="height: 100%;"+I;}}}else{I=this.sliderPartNode.style;L=this.valuePartNode.style;if(J){if(J===A){I.top=L.top="0";}else{if(J===F){I.bottom=L.bottom="0";}else{L.height=I.height="100%";L.lineHeight=inlineHeight+"px";}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.HBox","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren");var F={postBuildRendering:function C(){return(this.renderMode!="scroll")?this._super():true;},childRenderOnAddCheck:function(G){return(this.renderMode!="scroll")?this._super(G):false;},preserveChildDomOrder:false};function B(H){if(!H.hasRendered){return ;}var I=H.children||[];for(var G=I.length-1;G>=0;G--){I[G].refresh&&I[G].refresh();}}mstrmojo.DocSection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSection",markupString:'<div id="{@id}" class="mstrmojo-DocSection"></div>',markupSlots:{containerNode:function(){return this.domNode;}},width:function E(G){return this._super(1);},refresh:function D(){B(this);}});mstrmojo.DocSectionHoriz=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder,F,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSectionHoriz",height:function A(G){return this._super(1);},refresh:function D(){B(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo.num","mstrmojo.HBox","mstrmojo._IsInputControl","mstrmojo._TouchGestures");var W=mstrmojo.dom,O=W.attachEvent,P=W.detachEvent,a=mstrmojo.css,Q=mstrmojo.expr.DTP,M="mstrmojo.Button",R=mstrmojo.num,I=mstrmojo.validation.TRIGGER,b=50,L=500,A=10;function S(){var h=this;O(window,W.TOUCHSTART,h._evtHandler,true);h.isActive=true;}function V(){var h=this;P(window,W.TOUCHSTART,h._evtHandler,true);h.isActive=false;}function G(h){return h?parseFloat(h.toFixed(A)):h;}function d(){var k=this.numericValue,h=this.max,l=this.min,j=this.itv;if(!isNaN(k)){if(h!==undefined&&k-j>h){this.set("numericValue",h);}else{if(l===undefined||k-j>=l){this.set("numericValue",G(k-j));}else{if(k>l&&k-j<l){this.set("numericValue",l);}}}}}function K(){var k=this.numericValue,h=this.max,l=this.min,j=this.itv;if(!isNaN(k)){if(l!==undefined&&k+j<l){this.set("numericValue",l);}else{if(h===undefined||k+j<=h){this.set("numericValue",G(k+j));}else{if(k<h&&k+j>h){this.set("numericValue",h);}}}}}function D(h){if(h){K.call(this);}else{d.call(this);}}function f(h){var j=this;this._holdTimer=setInterval(function(){D.call(j,h);},b);}function B(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}}function g(h){var j=this;if(!this._holdTimer&&!this._startHoldTimer){this._startHoldTimer=setTimeout(function(){delete j._startHoldTimer;f.call(j,h);},L);}}function e(){if(this._startHoldTimer){clearTimeout(this._startHoldTimer);delete this._startHoldTimer;}B.call(this);}function F(h){var j=h.target;return(this.plusNode&&this.plusNode==j);}function E(h){var j=h.target;return(this.minusNode&&this.minusNode==j);}function J(){var h=this.numericValue;if(!isNaN(h)&&h>=this.min&&h<=this.max&&h!=this.value){this.set("value",h);}}function Z(h){a.addClass(h,"touched");}function N(l){var h=l.max,k=l.min,j=l.itv;return{scriptClass:"mstrmojo.HBox",alias:"hBox",cssText:"margin:auto",children:[{scriptClass:M,alias:"minus",cssClass:"mstrmojo-StepperDIC-Operator minus",bindings:{enabled:function(){return this.parent.parent.numericValue>k;}}},{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-DataInputControl",dtp:Q.DOUBLE,required:true,alias:"textInput",constraints:{trigger:I.ONKEYUP|I.ONBLUR,max:h,min:k},bindings:{value:"this.parent.parent.numericValue"},onblur:function o(p){var q=this.parent.parent,s=R.parseNumeric(this.value);if(!q.isActive){J.call(this.parent.parent);}this._super&&this._super(p);},onValid:function(){this.parent.parent.set("numericValue",parseFloat(this.value));}},{scriptClass:M,alias:"plus",cssClass:"mstrmojo-StepperDIC-Operator plus",bindings:{enabled:function(){return this.parent.parent.numericValue<h;}}}]};}mstrmojo.android.inputControls.StepperDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.inputControls.StepperDIC",cssClass:"mstrmojo-StepperDIC",isActive:false,markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},init:function U(j){this._super&&this._super(j);this.max=this.dic.max;this.min=this.dic.min;this.itv=this.dic.itv;var h=parseFloat(this.value);this.set("numericValue",isNaN(h)?(this.min||0):h);this.set("children",N(this.dic));this.plus=this.hBox&&this.hBox.plus;this.minus=this.hBox&&this.hBox.minus;var k=this;this._evtHandler=this._evtHandler||function(l){var o=l.target;if(!W.contains(k.domNode,o)){W.stopPropogation(l.view,l);V.call(k);J.call(k);}};},postBuildRendering:function Y(){this._super();this.plusNode=this.plus&&this.plus.domNode;this.minusNode=this.minus&&this.minus.domNode;},touchTap:function(h){if(!this.isActive){S.call(this);}if(F.call(this,h)){Z(this.plusNode);D.call(this,true);}else{if(E.call(this,h)){Z(this.minusNode);D.call(this,false);}}},touchBegin:function T(h){if(!this.isActive){S.call(this);}if(F.call(this,h)){Z(this.plusNode);g.call(this,true);}else{if(E.call(this,h)){Z(this.minusNode);g.call(this,false);}}},touchEnd:function C(h){e.call(this);},unrender:function X(h){if(this.isActive){V.call(this);}e.call(this);this._super(h);},setDirtyFlag:function H(j,h){mstrmojo.css.addClass(this.domNode.firstChild||h,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.TextBox");mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="mstrmojo-TextBoxWithLabel {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;}},preBuildRendering:function(){this.markupMethods=mstrmojo.hash.copy({onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},oncssClassChange:function(){this.domNode.className="mstrmojo-TextBoxWithLabel "+(this.cssClass||"");}},mstrmojo.hash.copy(this.markupMethods));}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._TouchGestures","mstrmojo.css","mstrmojo.dom");var E=500,B=mstrmojo.css;var C={onkeyup:function(H,I){var J=H._searchTimer;if(J){window.clearTimeout(J);}H._searchTimer=window.setTimeout(function(){H.searchFunc(I);delete H._searchTimer;},E);},onEnter:function(H,I){H.searchFunc(I);}};mstrmojo.android.ui.SearchBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._TouchGestures],{searchResult:null,searchStrategy:C,searchFunc:mstrmojo.emptyFn,clearFunc:mstrmojo.emptyFn,monitorInputs:true,clearSearch:function G(){this.clearFunc();},onkeyup:function D(){},onEnter:function A(){this.searchStrategy.onEnter(this,this.searchValue||this.value);delete this.searchValue;},onvalueChange:function F(){B.toggleClass(this.domNode,"clear",!!this.value.length);},touchTap:function(H){var I=this.domNode,J=H.evt;if(H.pageX-mstrmojo.dom.position(J.target).x>(I.offsetWidth-parseInt(B.getStyleValue(I,"paddingRight"),10))){this.set("value","");this.clearSearch();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate");var A=mstrmojo.css,D=mstrmojo.validation,H=D.TRIGGER,G=D.STATUSCODE,E=mstrmojo.TextBox.prototype.markupMethods;mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,markupMethods:{onvisibleChange:E.onvisibleChange,onvalueChange:E.onvalueChange,onenabledChange:E.onenabledChange,onreadOnlyChange:E.onreadOnlyChange,ontooltipChange:E.ontooltipChange,onvalidationStatusChange:function(){var M=this.validationStatus;if(!M){return ;}var L=this.inputNode,J=(M.code>G.VALID),K=this.constraints.invalidCssClass;A.toggleClass(L,K?K:["mstrmojo-TextBox-ErrValidation"],J);if(J){L.setAttribute("title",M.msg);}else{if(this._original_tooltip!==undefined&&this._original_tooltip!==null){L.setAttribute("title",this._original_tooltip);}}}},postBuildRendering:function I(){if(this._super){this._super();}this._original_tooltip=this.inputNode.title;},prekeyup:function B(J){if(this._super){this._super(J);}var L=(this.constraints.trigger&H.ONKEYUP)>0;if(L){if(this.validationDelay>0){if(this._valDelayTimer){window.clearTimeout(this._valDelayTimer);}if(!this._validateHandler){var K=this;this._validateHandler=function(){K.validate();if(K._valDelayTimer){window.clearTimeout(K._valDelayTimer);delete K._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(this._validateHandler,this.validationDelay);}else{this.validate();}}},preinput:function(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONKEYUP)>0;if(K){this.validate();}},preblur:function F(J){if(this._super){this._super(J);}var K=(this.constraints.trigger&H.ONBLUR)>0;if(K){this.validate();}},clearValidation:function C(){if(this._super){this._super();}var K=this.inputNode,J=this.constraints.invalidCssClass;A.removeClass(K,J?J:["mstrmojo-TextBox-ErrValidation"]);K.title=this._original_tooltip;}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox");mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur ></textarea>',maxLength:256,markupSlots:{inputNode:function(){return this.domNode;}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncssClassChange=function(){this.domNode.className="mstrmojo-TextArea "+(this.cssClass||"");};},onkeydown:function(D){var C=(this.value&&this.value.length)||0;if(this.maxLength<=C){this.isDeleteKeys=D.e.keyCode===8||D.e.keyCode===46;this.isArrowKeys=D.e.keyCode===37||D.e.keyCode===38||D.e.keyCode===39||D.e.keyCode===40;var B=(this.domNode.selectionEnd!==undefined)?(this.domNode.selectionEnd-this.domNode.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!B){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var A=this.domNode;A.blur();window.setTimeout(function(){A.focus();},1);}mstrmojo.dom.preventDefault(window,D.e);return false;}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.css","mstrmojo.array");mstrmojo.android.ui.TextInput=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.android.ui.TextInput",markupString:'<div id="{@id}" class="mstrmojo-AndroidTextInput {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onlabelTxtChange:function(){var D=this.lbl,E=this.labelTxt;D.set("visible",!!E);D.set("text",E||"");},ontextValueChange:function(){this.txt.set("value",this.textValue||"");},ontextTypeChange:function(){this.txt.set("type",this.textType||"text");}},labelTxt:"",textValue:"",textType:"text",init:function C(E){this._super(E);this.parent.attachEventListener("widthChange",this.id,function(G){var H=parseInt(G.value,10),F=this.txt.domNode,I=mstrmojo.css.getComputedStyle(F);mstrmojo.array.forEach(["padding","margin"],function(J){H-=parseInt(I[J+"Left"],10);H-=parseInt(I[J+"Right"],10);});F.style.width=H+"px";});var D=this.getTextCfg();D.alias="txt";D.cssDisplay="block";this.addChildren([D,{scriptClass:"mstrmojo.Label",cssClass:"lblErr",alias:"lblErr",visible:false}]);},getTextCfg:function B(){return{scriptClass:"mstrmojo.TextBox",onEnter:function(){var D=this.parent,E=D.onEnter;if(E){E.call(D,this.value);}}};},getValue:function A(){return this.txt.value;},children:[{scriptClass:"mstrmojo.Label",alias:"lbl"}],onRender:function(){this._super();this.txt.focus();}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip");var T=mstrmojo.dom;var K=mstrmojo.all;mstrmojo._HasDnD={postBuildRendering:function V(){if(this._super){this._super();}var Y=this.id;this.dnd=new mstrmojo._DnDComponent({target:this});this.__mouseDownEvt=function(Z){K[Y].dnd.onmousedown(Z);return true;};T.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);},unrender:function U(){if(this.__mouseDownEvt&&this.dndNode){T.detachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);}this.min=0;this.max=(this.items&&this.items.length-1)||0;this.dnd&&this.dnd.clearListeners();this._super();}};mstrmojo._DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo._DnDComponent",isDragging:null,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,_mousemoveCounter:0,init:function J(Y){mstrmojo.hash.copy(Y,this);},onmousedown:function X(Y){if(Y&&Y.preventDefault){Y.preventDefault();}if(this.dragging){return true;}var Z=this.target.id;if(!this._mousemoveCallback){this._mousemoveCallback=function(a){K[Z].dnd.onmousemove(a);return true;};}this._mousemoveCounter=0;this.startE=mstrmojo.hash.copy(Y);T.attachEvent(document.body,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(a){K[Z].dnd.ondragcancel(a);return true;};}T.attachEvent(document.body,"mouseup",this._cancelCallback);},ondragcancel:function H(Y){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);if(this.afterDragCancel){this.afterDragCancel.apply(this.target,[Y]);}},onmousemove:function D(Y){if(this.dragging){return ;}this._mousemoveCounter++;if(this._mousemoveCounter>this.mousemoveBuffer){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);T.detachEvent(document.body,"mouseup",this._cancelCallback);this.initDrag(Y);}},initDrag:function S(Y){this.dragging=true;var Z=this.target.id;if(!this._dragCallback){this._dragCallback=function(a){K[Z].dnd.ondrag(a);return true;};}T.attachEvent(document.body,"mousemove",this._dragCallback);if(!this._dragEndCallback){this._dragEndCallback=function(a){K[Z].dnd.ondragend(a);return true;};}T.attachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragStart){this.afterDragStart.apply(this.target,[Y]);}this._dragCallback(Y);},ondrag:function F(Y){if(this.duringDrag){this.duringDrag.apply(this.target,[Y]);}},ondragend:function E(Y){this.dragging=false;T.detachEvent(document.body,"mousemove",this._dragCallback);T.detachEvent(document.body,"mouseup",this._dragEndCallback);if(this.afterDragEnd){this.afterDragEnd.apply(this.target,[Y]);}},clearListeners:function I(){if(this._mousemoveCallback){T.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._cancelCallback){T.detachEvent(document.body,"mouseup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){T.detachEvent(document.body,"mousemove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){T.detachEvent(document.body,"mouseup",this._dragEndCallback);delete this._dragEndCallback;}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasDnD","mstrmojo._ListSelections");function B(Y){this.getUnit=function Z(){return Y._effLen/(Y.items.length-1)||1;};this.calcMinMax=function(b,a){var d=Math.round((b/Y.unit+a/Y.unit)/2);return{min:d,max:d};};this.preUpdateThumb=function(){Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";";};this.updateThumb=function(){Y.containerNode.style[Y.orCfg.posCssP]=Y.start=Math.min(Y.min*Y.unit,Y._effLen)+"px";};}function P(Y){this.getUnit=function(){return Y._effLen/Y.items.length;};this.calcMinMax=function(a,Z){return{min:Math.floor(a/Y.unit+0.5),max:Math.floor(Z/Y.unit-0.5)};};this.preUpdateThumb=function(){Y.start=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),0)+"px";Y.sdCssText+=Y.orCfg.posCssP+":"+Y.start+";"+Y.orCfg.lenCssP+":"+Y.length+";";};this.updateThumb=function(){Y.start=Y.min*Y.unit+"px";Y.containerNode.style[Y.orCfg.posCssP]=(Y.min*Y.unit)+"px";Y.length=Math.max(Math.round((Y.max-Y.min+1)*Y.unit-Y.gap),1)+"px";Y.containerNode.style[Y.orCfg.lenCssP]=Y.length;};}var L="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasDnD,mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:0,useRichTooltip:true,init:function R(Y){this._super(Y);if(Y.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(Y.multiSelect){this.typeHelper=new P(this);}else{this.clsType="sc1";this.typeHelper=new B(this);}},markupSlots:{dndNode:function(){return this.domNode.childNodes[0];},bgNode:function(){return this.domNode.childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0];},frontNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[0];},thumbNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[1];},endNode:function(){return this.domNode.childNodes[0].childNodes[1].childNodes[0].childNodes[2];},tooltipNode:function(){return this.domNode.childNodes[0].childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,preBuildRendering:function A(){var e=this.orCfg.lenCssP,a=this[e],Z=parseInt(a);this._effLen=isNaN(Z)?0:(Z-this._exRoom);if(a){this.bkCssText=e+":"+Math.max(parseInt(a,10)-(2*this.cssBkBW),0)+"px;";this.sdcCssText=e+":"+this._effLen+";"+this.orCfg.posCssP+":"+this._exRoom/2+"px;"+this.orCfg.opPosCssP+":0px;";}var Y=this.selectedIndices;if(!mstrmojo.hash.isEmpty(Y)){this.min=this.items.length-1;this.max=0;for(var b in Y){if(Y[b]){this.min=Math.min(this.min,b);this.max=Math.max(this.max,b);}}}this.unit=this.typeHelper.getUnit();this.typeHelper.preUpdateThumb();},postBuildRendering:function V(){if(this._super){this._super();}if(this.items.length>1&&this.dnd){this.dnd.afterDragStart=this.initDrag;this.dnd.duringDrag=this.ondrag;this.dnd.afterDragEnd=this.ondrop;this.dnd.afterDragCancel=this.cancelDrag;}},_initGhost:function O(){if(!this.ghost){var b=this.containerNode.cloneNode(true);mstrmojo.css.addClass(b,["gh"]);this.ghost={containerNode:b,frontNode:b.childNodes[0],thumbNode:b.childNodes[1],endNode:b.childNodes[2]};this.sdcNode.appendChild(b);}var Z=this.ghost.containerNode.style,a=this.containerNode.style,Y=this.orCfg;Z[Y.posCssP]=a[Y.posCssP];Z[Y.lenCssP]=a[Y.lenCssP];Z.display="block";return this.ghost;},initDrag:function S(b,Y){Y=Y||window;var a=this._initGhost(),Z=this.orCfg;this.dnd.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:a.containerNode[Z.lenP],offset:T.getMousePosition(this.dnd.startE,Y)[Z.offsetP]};this.dnd.initD.td=T.eventTarget(Y,this.dnd.startE);},ondrag:function F(j,f){f=f||window;var k=this.dnd.initD,h=this.ghost,o=h.containerNode,q,a,Z,d=this.min,l=this.max,Y=this.orCfg;var p=T.getMousePosition(j,f)[Y.offsetP]-k.offset;switch(k.td){case this.thumbNode:q=Math.max(Math.min(k.tP+p,k.sL-k.contL),0);a=q+k.contL;o.style[Y.posCssP]=q+"px";var b=this.typeHelper.calcMinMax(q,a);d=b.min;l=b.max;break;case this.frontNode:q=Math.max(Math.min(k.tP+p,k.tP+k.contL),0);Z=Math.max(Math.min(k.contL-p,k.tP+k.contL),0);o.style[Y.posCssP]=q+"px";o.style[Y.lenCssP]=Z+"px";d=Math.min(Math.floor(q/this.unit+0.5),this.max);break;case this.endNode:Z=Math.max(Math.min(k.contL+p,k.sL-k.tP),0);a=k.tP+Z;o.style[Y.lenCssP]=Z+"px";l=Math.max(Math.floor(a/this.unit-0.5),this.min);break;default:return ;}if(d!==this.min||l!==this.max){this.min=d;this.max=l;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function W(a){this.typeHelper.updateThumb();if(this.ghost){this.ghost.containerNode.style.display="none";}this.hideTooltip();if(this.items&&this.items.length){var Z=[];for(var Y=this.min;Y<=this.max;Y++){Z.push(Y);}this.select(Z);}this.dnd.initD=null;},cancelDrag:function Q(Z,Y){if(this.makeSelection){Y=Y||window;var a=T.eventTarget(Y,this.dnd.startE);this.makeSelection({selItem:a});}},showTooltip:function C(Z,Y){this._updateTooltip();this._super(Z,Y);},hideTooltip:function G(Z,Y){if(this.dnd&&this.dnd.dragging){return ;}this._super(Z,Y);},_updateTooltip:function N(){var Z=this.orCfg,b={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},d=(this.ghost)?this.ghost.containerNode:this.containerNode;b[Z.opPosCssP]=0;b[Z.posCssP]=d.style[Z.posCssP];if(this.items&&this.items.length){var a=this.getItemTooltip(this.items[this.min]);var Y;if(this.min===this.max){Y=a;}else{Y=mstrmojo.desc(146,"From:")+" '"+a+"' "+mstrmojo.desc(147,"To:")+" '"+this.getItemTooltip(this.items[this.max])+"'";}b.content=L.replace(/\{@content\}/g,Y);}else{b.content="";}this.set("richTooltip",b);},getItemTooltip:function(Y){return"'"+(Y?Y.n:"")+"'";},unrender:function U(Y){this.ghost=null;this.dnd&&(this.dnd.dragging=false);this.hideTooltip();this._super(Y);},onselectionChange:function M(Y){if(this.onchange){this.onchange();}if(this.makeSelection&&this.dnd&&this.dnd.initD){this.makeSelection({selItem:this.dnd.initD.td});}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ListBase","mstrmojo._IsList");var F=",";mstrmojo.TableLayoutList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.TableLayoutList",cssClass:"mstrmojo-TableLayoutList",styleCssClass:"",itemIdField:"v",allowUnlistedValues:false,tableLayoutCssStyle:"auto",multiSelect:false,titleItems:null,items:null,itemsPerRow:0,getLeftEndTitle:function E(G){return"";},getRightEndTitle:function D(G){return"";},getTitleRowMarkup:function A(){var K=this.titleItems;if(K){var H='<tr><td class="left_text">'+this.getLeftEndTitle(-1)+"</td>",G=K.length,J=0,I;for(;J<G;J++){I=K[J];H+='<td class="item_title" title="'+I+'">'+I+"</td>";}H+='<td class="left_text">'+this.getRightEndTitle(-1)+"</td></tr>";return H;}return"";},_markupPrefix:function(){return'<table class="tableLayoutList" style="table-layout:'+this.tableLayoutCssStyle+'" cellspacing="0" cellpadding="0"><tbody>'+this.getTitleRowMarkup();},_markupSuffix:function(){return"</tbody></table>";},getItemMarkup:function(K,H){var J='<{@tag} class="item {@cls}" idx="{@idx}" title="{@n}" style="{@style}">{@n}</{@tag}>',G=this.getLeftEndTitle(H),I=this.getRightEndTitle(H),L=this.itemsPerRow;G='<td class="left_text" title="'+G+'">'+G+"</id>",I='<td class="right_text" title="'+I+'">'+I+"</id>",L=this.itemsPerRow;if(L>0){J=(H%L===0?"<tr>"+G:"")+"<td>"+J+"</td>"+((H+1)%L===0?I+"</tr>":"");}else{J='<td><div class="item_wrapper" idx="'+H+'">'+J+"</div></td>";if(!H){J="<tr>"+G+J;}else{if(H===this.items.length-1){J=J+I+"</tr>";}}}return J;},_getItemNode:function(G){var H=this.itemsNode,J=this.itemsPerRow,I=(this.titleItems?1:0)+((J>0)?parseInt(G/J,10):0),K=1+((J>0)?(G%J):G);return H.rows[I].cells[K].firstChild;},init:function(G){this._super(G);mstrmojo.css.addWidgetCssClass(this,this.styleCssClass);},onchange:function B(){var I,H=[];if(!this.multiSelect){I=this.selectedItem.v;}else{for(var G in this.selectedIndices){H.push(this.items[G].v);}I=H.join(this.delim||F);}this.set("value",I);},postBuildRendering:function C(){this._super();var G=[];if(this.multiSelect){var I=this.value.split(F);for(var H=0;H<I.length;H++){G.push({v:I[H]});}}else{G.push({v:this.value});}this.setSelectedItems(G);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasLayout");mstrmojo.Overlay=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height?this.height:"";},onwidthChange:function(){this.domNode.style.width=this.width?this.width:"";}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},scriptClass:"mstrmojo.Overlay"});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo._TouchGestures","mstrmojo.Box","mstrmojo.Label","mstrmojo.dom","mstrmojo.css");var Z=mstrmojo.css;mstrmojo.requiresDescs(2901,8445);function U(){var k="rootPortrait",h="rootLandscape",j=this.domNode;if(mstrApp.isLandscape()){var g=k;k=h;h=g;}Z.removeClass(j,h);Z.addClass(j,k);}mstrmojo.android.ui.RootView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.RootView",markupString:'<div id="{@id}" class="mstrmojo-RootView {@cssClass}" style="{@cssText}" ><div class="mstrmojo-RootView-title"></div><div class="mstrmojo-RootView-content"></div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{titleNode:"auto",containerNode:"100%"},w:{titleNode:"100%",containerNode:"100%"}},preBuildRendering:function D(){Z.addClass(document.body,"dpi"+mstrMobileApp.getDeviceDPI());if(!this.msgBox){var h=this.msgBox=new mstrmojo.Box({placeholder:"mainAppMsg",cssClass:"mstrmojo-RootViewMessage",cssText:"left:-10000px;",children:[{scriptClass:"mstrmojo.Label",alias:"lbl",text:mstrmojo.desc(2901,"Loading...")}]});h.render();}var g=mstrApp.viewFactory;this.addChildren([g.newView("ActionBar",{slot:"titleNode",alias:"actionBar",controller:mstrmojo.all[this.controllerId]}),g.newView("Switcher",{slot:"containerNode",alias:"switcher"})]);return this._super();},postBuildRendering:function Y(){U.call(this);var g=this.titleNode;if(!this._tchHandler){this._tchHandler=mstrmojo.touchManager.attachEventListener("actionBarMenuStateChange",this.id,function(h){if(h.value){Z.addClass(g,"top");}else{Z.removeClass(g,"top");}});}return this._super();},unrender:function W(g){if(this._tchHandler){mstrmojo.touchManager.detachEventListener(this._tchHandler);delete this._tchHandler;}this._super(g);},setNavigation:function d(h,g){this.actionBar.setNavigation(h,g);},getTitleHeight:function B(){return this.titleNode.offsetHeight;},clearNavigation:function O(){this.actionBar.clearNavigation();},restoreNavigation:function X(){this.actionBar.restoreNavigation();},selectNavigationItem:function G(g){return this.actionBar.selectNavigationItem(g);},hasNavigationItems:function Q(){return this.actionBar.getNavList().items.length>0;},reset:function a(){this.actionBar.reset();},setContent:function J(g,h){this.reset();this.switcher.switchView(g,h);},contentUpdated:function N(){this.reset();},setTitle:function M(g){this.actionBar.updateTitle(g);},setActionToolbar:function P(h,g){this.actionBar.updateToolbar(h,g);},setActionToolbarStatus:function I(g){this.actionBar.setActionToolbarStatus(g);},setUpStatus:function e(g){this.actionBar.setUpStatus(g);},updateLastOpened:function S(g){this.actionBar.setLastOpened(g);},monitorWindow:function F(){var g=mstrApp.getScreenDimensions();this._super({currentTarget:{innerWidth:g.w,innerHeight:g.h}});U.call(this);mstrmojo.all[this.controllerId].set("orientation",(mstrMobileApp.getOrientation()===mstrmojo.android.EnumOrientationTypes.PORTRAIT)?1:0);window.setTimeout(function(){mstrMobileApp.setWaitScreenVisibility(false);},0);},setDimensions:function T(k,j){this._super(k,j);var g=this.msgBox;g.set("height",this.height);g.set("width",this.width);},getBrowserDimensions:function(){var h=mstrApp.getScreenDimensions(),g="px";return{h:h.h+g,w:h.w+g};},getContentDimensions:function b(){var g=this.containerNode;return{h:g.clientHeight,w:g.clientWidth};},showMessage:function L(g){mstrMobileApp.showProgress([g||mstrmojo.desc(8445,"Loading")],false);},showHTMLProgress:function K(o){var k=this.msgBox,l=k.domNode.style,j=k.lbl,h=j.domNode,g=h.style;j.set("text",o||mstrmojo.desc(2901,"Loading..."));g.left=Math.round(parseInt(this.width,10)/2-h.offsetWidth/2)+"px";g.top=Math.round(parseInt(this.height,10)/2-h.offsetHeight/2)+"px";l.left=0;l.top=0;Z.addClass(k.domNode,"active");l.opacity=1;},hideMessage:function R(){mstrMobileApp.hideProgress();},hideHTMLProgress:function H(){var g=this.msgBox.domNode,h=g.style;h.opacity=0;h.left="-10000px";Z.removeClass(g,"active");},enterFullScreen:function V(){this.actionBar.enterFullScreen();},flashFullScreen:function f(){this.actionBar.flashFullScreen();},exitFullScreen:function E(g){this.actionBar.exitFullScreen(g);},cancelFlashFullScreen:function A(){return this.actionBar.cancelFlashFullScreen();},propogateMenuVisibleChange:function C(g){this.actionBar.propogateMenuVisibleChange(g);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box");mstrmojo.maps.jsmap.InfoWindow=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.maps.jsmap.InfoWindow",rowIndex:-1,init:function B(E){this._super(E);},start:function D(){this.render();this.update(this.rowIndex);},update:function C(G){this.rowIndex=G;var E=this.containerNode,F='<table><tbody><tr><td colspan="2" class="androidMap-infoWindowTitle">'+mapDataObj.getAttributeName(G)+"</td></tr>";F+=this.getMetricInfo();F+="</tbody></table>";E.innerHTML=F;},getMetricInfo:function A(){var F=JSON.parse(mapDataObj.getMetricValues(this.rowIndex).toString()),H="",K=F.length;for(var G=0;G<K;G++){var I=F[G];if(I.ts==4){H+='<tr><td class="androidMap-infoWindowText"> '+mapDataObj.getMetricName(G)+' </td><td><img src="'+I.v+'"></td></tr>';}else{var J="black",E="transparent";if(mapDataObj.useThresholds()){J=mapDataObj.getThresholdColorRGB(I.fcti);E=mapDataObj.getThresholdColorRGB(I.bcti);}H+='<tr><td class="androidMap-infoWindowText">'+mapDataObj.getMetricName(G)+'</td><td style="background-color:'+E+";color:"+J+';">'+I.v+"</td></tr>";}}return H;}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocLayoutViewer","mstrmojo._Formattable","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.dom");function J(f){var g,V=this._newLinks,e=mstrmojo.hash.copy(V,this._allLinks),g=f?e:V;this._newLinks={};if(mstrMobileApp.isOnline()){return ;}var X=this.controller,W,a,Y=[],h=[],b;for(W in g){a=g[W];b=X.getLinkRequest(a);if(b){Y.push(b);h.push(a);}}var Z=Y.length;if(Z){var d=function(j){for(W=0;W<Z;W++){a=h[W];a.src.setLinkEnabled(j[W]);}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(Y,{success:d,failure:mstrmojo.emptyFn});}}}function D(){var X=this.children,W,V;for(W=0,V=(X&&X.length)||0;W<V;W++){var Z=X[W],Y=Z.slot;if(Y){this.setSlotDimensions(Y,Z.height,Z.width);}}}mstrmojo.MobileDocLayoutViewer=mstrmojo.declare(mstrmojo.DocLayoutViewer,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.MobileDocLayoutViewer",layoutConfig:{h:{groupBy:"0",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"0"},w:{layout:"100%"}},formatHandlers:{domNode:["background-color"]},scrollerConfig:{vScroll:false,hScroll:false,bounces:false,showScrollbars:false},usesTouches:true,init:function O(V){this._super(V);this._newLinks={};this._allLinks={};},postBuildRendering:function T(){this._super();if(this.fixedFooterNode.clientHeight>0){D.call(this);}},preBuildRendering:function B(){this._super();this._scrollCssText="overflow:"+((!mstrmojo.dom.isWinPhone)?"hidden":"auto");var W=this.id,V=this.updateScroller;if(!this.afterScrollSubscr){this.afterScrollSubscr=this.docLayout.attachEventListener("afterScroll",W,function(){this.updateScroller();J.call(this);});this.model.attachEventListener("partialUpdate",W,V);}},mapID:null,setMapID:function I(V){this.mapID=V;},beforeViewHidden:function E(V){if(!this.mapID){return ;}var W=mstrmojo.all[this.mapID];if(W&&W.beforeViewHidden){W.beforeViewHidden(V);}this.mapID=null;},updateScrollerConfig:function R(){var W=this.scrollerConfig,Y=this.docLayout.containerNode;if(Y){var a=this.docLayout,X={start:0,end:Math.max(a.getWidth()-this.scrollboxWidth,0)},d={start:0,end:Math.max(a.getHeight()-this.scrollboxHeight,0)},V=(d.start!==d.end),Z=(X.start!==X.end),b;if(V||Z){b={x:X,y:d};}else{W.origin={x:0,y:0};}mstrmojo.hash.copy({scrollEl:this.scrollboxNode.firstChild,offset:b,vScroll:V,hScroll:Z,showScrollbars:false},W);if(!W.origin){W.origin=this._origin={x:0,y:0};}a.scrollBuffer=parseInt(mstrApp.rootView.getContentDimensions().h,10);}return this._super();},initScroller:function M(V){this._super(V);V.attachEventListener("scrollDone",this.id,function(W){this._origin={x:W.x,y:W.y};this.notifyScrollListeners(W);});},touchBegin:function N(W){var V=this.parent;if(V&&V.isAnimating&&V.isAnimating()){W.stop();return false;}return this._super(W);},shouldTouchBubble:function K(V){if(mstrmojo.dom.contains(this.scrollboxNode,V.target,true,this.domNode)){return this._super(V);}return true;},touchSwipeBegin:function L(X){if(this.shouldTouchBubble(X)){var W=this.parent,V=W.canScroll&&W.canScroll(X);if(V){this._parentScrolling=true;W.beginScroll(X);}return V;}this._super(X);},touchSwipeMove:function A(V){if(this._parentScrolling){this.parent.scroll(V);return ;}this._super(V);},touchSwipeEnd:function P(V){V.evt.handled=true;if(this._parentScrolling){delete this._parentScrolling;this.parent.endScroll(V);return ;}this._super(V);},touchTap:function S(){var V=this.controller;if(V&&V.viewTap){V.viewTap();}},renderChildren:function F(){this._super();this.updateScroller();},unrender:function Q(){delete this.scrollerConfig.origin;var V=this._scroller;if(V){delete V.origin;}if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}if(this.afterScrollSubscr){mstrmojo.publisher.unsubscribe(this.afterScrollSubscr);delete this.afterScrollSubscr;}this._super();},addLinkInfo:function H(W,V){this._newLinks[W]=V;},onRender:function C(){this._super();if(!this.subscr){var W=mstrmojo.publisher;this.subscr=W.subscribe(W.NO_SRC,W.CONNECTIVITY_CHANGED_EVENT,function(a){if(a){var X=this._allLinks,Y,Z;for(Y in X){Z=X[Y].src;if(!Z.linkEnabled){Z.setLinkEnabled(true);}}}else{J.call(this,true);}},this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var V=this;window.setTimeout(function(){J.call(V);},100);}},setSlotDimensions:function U(d,b,Y){if(d==="layout"){var X=parseInt(this.height,10),W=this.fixedHeaderNode.clientHeight,a=this.fixedFooterNode.clientHeight,V=parseInt(b,10),Z=X-W-a;if(W+a>=X){b=0;}else{if(V!=Z){b=Z+"px";}}}this._super(d,b,Y);},getCaptureDimensions:function G(){return this.docLayout.getCaptureDimensions();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo._HasBuilder","mstrmojo._IsAnchorable","mstrmojo.dom");var P="mstrmojo-DocInfoWindow-tip",O=1,G=mstrmojo.dom;function C(S,T){var R=G.findWidget(S)||(S&&S.w);while(R){if(R.autoCloseLocked!==undefined){R.autoCloseLocked=T;}R=R.parent;}}function H(S){var R=S.model;return R.getLayoutDataCache(R.getCurrentLayoutKey())[S.psId];}mstrmojo.DocInfoWindow=mstrmojo.declare(mstrmojo.Popup,[mstrmojo._HasBuilder,mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.DocInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div><div class="'+P+' top"></div><div class="mstrmojo-DocInfoWindow-curtain" mstrAttach:click></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.firstChild;}},boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:P,anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,closeOnClick:true,autoCloseLocked:false,tipNodeColor:"",ontouchstart:function J(){this.close();},close:function N(){if(this.autoCloseLocked){return ;}this.model.raiseEvent({name:"infoWindowClosed",psKey:this.psKey});var R=this;window.setTimeout(function(){if(R.anchor){C(R.anchor,false);}},0);if(this._super){this._super();}this.clearAnchorHilites();G.detachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",this.mw);G.attachEvent(document,"scroll",R.mw);},clearAnchorHilites:function B(){var R=mstrmojo.dom.findWidget(this.anchor);if(R&&R.clearHilites){R.clearHilites(R.hiliteKey);delete R.hiliteKey;}},prepareAnchor:function M(){if(this.children&&this.children[0]){var S=this.infoNode.style,T=this.children[0],U=T.dimNode||T.domNode,V=U.offsetWidth,R=U.offsetHeight;S.width=(V+2*O)+"px";S.height=(R+2*O)+"px";}},nudge:function E(){this.positionDialog();this.model.raiseEvent({name:"infoWindowRendered",id:this.id});},onRender:function Q(){this.open(this.opener);},open:function F(X,T){var R=mstrmojo.all[this.psId];if(R){var U=R.defn.sfp,Z=R.selectedIdx;if(U&&Z!==0){R.switchToPanel(0,0);R.children[Z].set("selected",false);}}if(this._super){this._super(X,T);}if(this.anchor){C(this.anchor,true);}if(mstrApp.isTablet&&mstrApp.isTablet()){var Y=mstrmojo.touchManager,S=this.id,W=this.domNode;this._tchHandler=Y.attachEventListener("touchesBegin",S,function(d){if(this.autoCloseLocked){return ;}var b=mstrmojo.dom.contains(W,d.touch.target,true);var f=document.getElementsByClassName("heatmap-infobox"),a=(f&&f.length)||0,e,h=d.touch.target,g=false;for(e=0;e<a;e++){if(mstrmojo.dom.contains(f[e],h,true)){g=true;break;}}if(!b&&!mstrApp.hasOpenDialog()&&!g){this.closeOnTablet();}});}var V=this;V.mw=V.mw||function(a){if(V.autoCloses&&!G.contains(V.domNode,G.eventTarget(self,a),true,document.body)){V.close();}};G.attachEvent(document,G.isFF?"DOMMouseScroll":"mousewheel",V.mw);G.attachEvent(document,"scroll",V.mw);},getChildren:function I(){return[H(this)];},preBuildRendering:function K(){var T=H(this),S=T.defn.fmts;S.left=O+"px";S.top=O+"px";if(S.border){var R=S.border.split(" ");if(R.length>=3){this.tipNodeColor=R[2];}}if(this._super){this._super();}},postBuildRendering:function A(){this.set("visible",true);if(this._super){this._super();}if(!this.closeOnClick){this.curtainNode.style.display="none";}},closeOnTablet:function L(){this.close();if(this._tchHandler){this._tchHandler.clear();}}});var D=mstrmojo.DocInfoWindow;D.PLACEMENT={AUTO:1,FIXED:2,ABOVE:3,BELOW:4,LEFT:5,RIGHT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ViewSwitcher","mstrmojo.dom","mstrmojo.array");var I=Math,H=mstrmojo.dom,J=mstrmojo.array;function F(O,N,Q,R){if(isNaN(N)){N=parseInt(N,10);}var P=O.style;P[H.CSS3_TRANSITION]=H.CSS3_PREFIX+"transform "+(Q||0)+"ms "+(R||"ease");P[H.CSS3_TRANSFORM]="translateX("+N+"px)";}function G(T,U,W){var P=this.getSlots(),S=P.current,V=P.next,R=P.slot,O=0;J.forEach(J.filter(this.children,function(X){return(X.slot===R);}),function(X){this.removeChildren(X);X.unrender();},this);this.prepareNewView(T,R);try{var N=this.id;window.setTimeout(function(){mstrmojo.all[N].addChildren([T]);},0);if(V&&S){O=W?parseInt(this.width,10):0;if(W){V.style.zIndex=3;S.style.zIndex=1;}}}catch(Q){mstrmojo.Obj.free(T);throw Q;}return{start:U,target:O,newView:T,oldView:this.getCurrentView(),isForward:W};}function B(O,U,W,R,Q){var N=this.sliderNode,P=0,S="",T=function(){F(N,-O,P,S);if(W){if(P){window.setTimeout(W,P+100);}else{W();}}};if(R){var V=I.abs((O||0)-(U||0));P=I.round(V/parseInt(this.width,10)*700);S="ease";if(Q){P=I.min(P,I.round(V/Q));S+="-out";}this._animating=true;window.setTimeout(T,20);}else{T();}}function M(O,N){this.removeChildren(N);N.unrender();this._curSlot=O.slot;delete this._animating;}mstrmojo.android.ui.ViewSlider=mstrmojo.declare(mstrmojo.android.ui.ViewSwitcher,null,{scriptClass:"mstrmojo.android.ui.ViewSlider",switchView:function E(N,O){var P=this.getSlots();F(this.sliderNode,0);F(P.current,0);F(P.next,0);this._super(N,O);},isAnimating:function A(){return !!this._animating;},resetSliderNodes:function(Q){var P=this.getSlots(),O=parseInt(this.width,10),S=-O,N=O,R=0;if(Q){S=0;N=0;R=O;}F(this.sliderNode,S);F(P.current,N);F(P.next,R);return{sliderX:S,currentX:N,nextX:R};},beginScroll:function(R,O){if(this.isAnimating()){return false;}var P=R.delta.x<0,N=this.resetSliderNodes(P);var Q=this._scrollInfo=G.call(this,O,N.sliderX,P);this.scrollStarted(Q);this.scroll(R);},scroll:function L(P){var O=this._scrollInfo,N=P.delta.x;if(O){if(O.isForward!==(N<0)){B.call(this,0);this.beginScroll(P);}else{B.call(this,-(O.start+N));this.scrollProgress(O,N);}}},endScroll:function D(T){var P=this._scrollInfo;if(!P){return ;}var S=T.delta.x,N=-P.start,R=false,O=0,Q=this.id;if(I.abs(S)/parseInt(this.width,10)>0.25){N=P.target;R=true;O=T.velocity.x;}this.scrollStopped(P,R);B.call(this,N,N-S,function(){mstrmojo.all[Q]["scroll"+(R?"Complete":"Canceled")](P);},true,O);delete this._scrollInfo;},scrollStarted:mstrmojo.emptyFn,scrollProgress:mstrmojo.emptyFn,scrollStopped:mstrmojo.emptyFn,scrollCanceled:function C(N){M.call(this,N.oldView,N.newView);},scrollComplete:function K(N){M.call(this,N.newView,N.oldView);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo._CanGrowOrShrink","mstrmojo.hash");function G(){var M=this.containerNode;if(M){var O=this.getFormats(),R=this._parentSize,P=Math.max((parseInt(O.height,10)||0),R.height),N=Math.max((parseInt(O.width,10)||0),R.width),Q=M.style;Q.width=N+"px";Q.height=P+"px";}}var L=mstrmojo.android.AndroidDocPanel=mstrmojo.declare(mstrmojo.DocPanel,[mstrmojo._CanGrowOrShrink,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.AndroidDocPanel",scrollerSetupDelay:0,postBuildRendering:function A(){if(this._isInfWin){G.call(this);}return this._super();},updatePanelDimensions:function D(Q,M,P,N){this._parentSize={height:M,width:P};var O="px";if(N){this._isInfWin=true;G.call(this);}this.cssText="left:"+Q+"px;top:0;height:"+M+O+";width:"+P+O+";";if(this.hasRendered){var R=this.domNode.style;R.left=Q+O;R.height=M+O;R.width=P+O;this.updateScroller();}},update:function E(M){this.scrollerConfig={bounces:false,showScrollbars:false};},onchildRenderingChange:function I(M){this._super(M);if(this.getFormats().overflow==="auto"){this.performCanGrowCanShrink([(M&&M.src)||M],(!!this._isInfWin&&!mstrApp.isTablet()));}},touchTap:function B(){var M=this.controller;if(M&&M.viewTap){M.viewTap();}},getCanGrowShrinkNode:function K(){return this.containerNode;},afterCanGrowShrink:function C(){this.updateScroller();},updateScrollerConfig:function F(){var M=this._super();if(this.getFormats().overflow==="auto"){var P=this.containerNode,O=this._parentSize,N={Height:{a:"y",s:"v"},Width:{a:"x",s:"h"}},Q={};M.scrollEl=P;mstrmojo.hash.forEach(N,function(U,T){var R=O[T.toLowerCase()];var V=Math.max(P["offset"+T]-R,0),S=M[U.s+"Scroll"]=(V!==0);if(S){Q[U.a]={start:0,end:V};}});M.offset=Q;M.origin=M.origin||{x:0,y:0};}return M;}});var J=L.prototype.formatHandlers,H="containerNode";J[H]=J[H].concat("D");}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.DocTextfield");var I=mstrmojo.dom,K=mstrmojo.css,L=1,Q=2,A=3,N=4,P=5,E=6,B=1,D=["","CaptionOnly","IconOnly","IconLeft","IconRight","IconTop","Custom"];var M=[];M[L]=M[Q]=M[E]={minsp:0,mincs:0};M[A]=M[N]={minsp:10,mincs:5};M[P]={minsp:4,mincs:5};function F(V,S,X,R,T){var Y=I.position(V),U=I.position(V.parentElement),W=V.style;R=R||{};R={t:R.t||0,r:R.r||0,b:R.b||0,l:R.l||0};R.h=U.h-R.t-R.b;R.w=U.w-R.l-R.r;if(T){if(Y.h>R.h){W.height=R.h+"px";}if(Y.w>R.w){W.width=R.w+"px";}Y=I.position(V);}if(S){W.top=((R.h-Y.h)/2+R.t)+"px";}if(X){W.left=((R.w-Y.w)/2+R.l)+"px";}}function J(U,V,T){var S=document.createElement("img"),R=S.style;U.appendChild(S);I.attachEvent(S,"load",function(){var W=R.display;R.display="block";F(S,true,true);R.display=W;},true);S.className=T;S.src=V;}mstrmojo.DocButton=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocButton",pressed:false,markupString:'<div id="{@id}" class="mstrmojo-DocButton {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocButton-Container" mstrAttach:click,mousedown><div class="mstrmojo-DocButton-IconNode"></div><div class="mstrmojo-DocButton-ValueNode" style="{@valueNodeCssText}">{@v}</div></div><div class="mstrmojo-DocButton-EffectOverlay"></div>{@buttonNodeMarkup}</div>',markupSlots:{iconNode:function(){return this.domNode.firstChild.firstChild;},valueNode:function(){return this.domNode.firstChild.lastChild;},buttonContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{onpressedChange:function(){var R=!!this.pressed,U=this.defn,T=this.domNode,S=this.fmts;K.toggleClass(T,"pressed",R);this.setBackgroundColor();this.valueNode.style.color=R?U.fhlc:(S.color||"");},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["T","z-index","D","B","P","background-color"],valueNode:["font","fx","color","white-space","overflow"]},setBackgroundColor:function H(){this.domNode.style.backgroundColor=(!!this.pressed)?this.defn.bhlc:(this.fmts["background-color"]||"");},getAnchor:function O(){return this.domNode;},getDPI:function C(){return this.model.dpi;},buildRendering:function G(){this._super();var S=this.defn,k=this.domNode,V=this.buttonContainerNode,j=this.iconNode,p=this.valueNode,e=parseInt((S&&S.dpst)||1,10),f="px";K.toggleClass(k,D[e],true);k.onselectstart=k.ondragstart=function(){return false;};var b=this.getFormats(),X=parseInt(K.getComputedStyle(V).borderWidth,10)*2;if(isNaN(X)){X=0;}var Z=parseFloat(b.width)-X,l=parseFloat(b.height)-X,W=M[e],a=W.minsp,s=W.mincs,d,Y=j.style,g=p.style;function U(h){Y.height=Y.width=h+f;}var q=V.style;q.height=l+f;q.width=Z+f;switch(e){case P:var T=this.getDPI(),R=l+K.getBorderWidths(b["border-width"],T).h+K.getPaddings(b.padding,T).h;d=Math.max(0,Math.min(Z,l-a-s,R*0.6));U(d);F(j,false,true);F(p,true,false,{t:d+a},true);break;case A:case N:d=Math.max(0,Math.min(l,Z-a-s));U(d);F(j,true,false);g[(e===A)?"left":"right"]=(d+a)+f;F(p,true,false);break;case L:F(p,true,false);break;case Q:case E:break;}if(B===parseInt(S.fe,10)){K.addClass(k,"gloss");}J(j,S.nmurl,"normal");J(j,S.hlurl||S.nmurl,"hilight");var o=document.createElement("div");K.addClass(o,"mstrmojo-DocButton-IconMaskNode");j.appendChild(o);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocButton","mstrmojo._HasDrillLinks","mstrmojo.ui.MobileCheckList","mstrmojo.android.ui.Button","mstrmojo.dom","mstrmojo.array");function A(L){this.set("pressed",L);}function J(M,N){var L=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(M);return L?"rgba("+parseInt(L[1],16)+","+parseInt(L[2],16)+","+parseInt(L[3],16)+","+N+")":"";}function B(L){this.model.executeLink(L,this.target,this);}function G(){var L=this.drillLinkItems,M=this.id;if(L.length===1){A.call(this,false);B.call(this,L[0].url);return ;}this._linksOpen=true;mstrApp.showDialog({title:this.defn.n,children:[{scriptClass:"mstrmojo.ui.MobileCheckList",items:L,multiSelect:false,isElastic:true,hasEvenRows:true,postselectionChange:function(N){mstrApp.closeDialog();B.call(mstrmojo.all[M],L[N.added[0]].url);}}],onClose:function(){var N=mstrmojo.all[M];A.call(N,false);delete N._linksOpen;},buttons:[mstrmojo.android.ui.Button.newButton(mstrmojo.desc(221,"Cancel"))]});}var F=mstrmojo.android.ui.DocButton=mstrmojo.declare(mstrmojo.DocButton,[mstrmojo._HasDrillLinks],{scriptClass:"mstrmojo.android.ui.DocButton",touchBegin:function E(){if(!this.linkEnabled){return false;}A.call(this,true);return true;},touchTap:function C(){if(this.ifw){this.model.showInfoWin(this.ifw,(this.getAnchor&&this.getAnchor())||this.domNode,"v");return ;}var L=this.drillLinkItems,M=(L&&L.length)||0;if(M>0){G.call(this);}},touchSelectBegin:function H(){this.touchTap();},touchEnd:function K(){if(!this._linksOpen){A.call(this,false);}},setBackgroundColor:function I(){var L=!!this.pressed,R=this.defn,Q=this.domNode,N=this.fmts,S=this.buttonContainerNode.style,O=this.domNode.style,P=L?R.bhlc:(N["background-color"]||""),M=L?J(R.bhlc,0.4):"";S.backgroundColor=P;S.borderColor=P;O.borderColor=M;O.backgroundColor=M;},getDPI:function D(){return mstrMobileApp.getDeviceDPI();}});F.prototype.markupString=F.prototype.markupString.replace(new RegExp(" mstrAttach:[a-zA-Z,]*"),"");F.prototype.formatHandlers.domNode=mstrmojo.array.filter([].concat(F.prototype.formatHandlers.domNode),function(L){return(L!=="P"&&L!=="B");});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ViewSlider","mstrmojo._HasBuilder","mstrmojo._IsRwDocument","mstrmojo.android.ui.LayoutSelector","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.func","mstrmojo.android.EnumOrientationTypes");mstrmojo.requiresDescs(4174);var h=mstrmojo.array,l=h.forEach,S=mstrmojo.hash,Q=mstrmojo.android.EnumOrientationTypes,K=Q.PORTRAIT,P=Q.LANDSCAPE;function f(AB){return(AB.defn.iw!==undefined&&AB.defn.iw);}function R(AB){return new mstrmojo.Label({cssClass:"pre-loader",n:AB.n,k:AB.k,isPreloader:true});}function g(AD,AB){var AC=this.layoutSelector,AE=this.getSupportedLayouts();if(!AB){AC.set("items",AE);}AC.setCurrentTab(h.find(AE,"k",AD.k));AC.set("visible",!!AB);if(AB){AC.initiateFade();}}function x(AC,AI){var AE=this._layouts,AB=mstrMobileApp.getOrientation(),AD=AE.length-1-AC,AH=false,AF;var AG=AE.slice(AC+1);if(AC){AG=AG.concat(AE.slice(0,AC));}if(!AI){AG.reverse();AD=AC;}l(AG,function(AK,AJ){AH=(AJ>=AD);if(((AK.defn.or&AB)>0)&&!f(AK)){AF=AK;return false;}});if(!AF){return null;}return{wrap:AH,layout:AF};}function s(){var AC=this.model.defn.views,AB=(AC&&AC.length)||0,AE;if(AB){var AD=AC[0].orientation;for(AE=1;AE<AB;AE++){if(AD!==AC[AE].orientation){return true;}}}return false;}function e(AL){var AI=this._layouts,AH=this._orientationInfo;if(!AH){AH=this._orientationInfo={};var AM=AH[K]={lyts:[]};var AJ=AH[P]={lyts:[]};h.forEach(AI,function(AO){var AQ=AO.defn.or,AP=AH[AQ];if(!f(AO)&&AP!==undefined){AP.lyts.push(AO.k);}});if(AM.lyts.length||AJ.lyts.length){AH.specific=true;}}var AC=AI[h.find(AI,"k",AL)],AE=AC.defn.or,AF=AH[AE],AD=mstrMobileApp.getOrientation(),AG={isSupported:true,currentLayout:AC,specific:!!AH.specific};if(f(AC)||((AE&AD)===0)){AG.isSupported=false;var AK=AH[AD];if(AF===undefined||AK===undefined){return AG;}var AN=AK.lyts[h.indexOf(AF.lyts,AL)];if(AN){AG.newLayout=AI[h.find(AI,"k",AN)];}else{var AB=AK.last;if(AB){AG.newLayout=AB;}else{h.forEach(AI,function(AO){if(!f(AO)&&(AO.defn.or&AD)>0){AG.newLayout=AO;return false;}});}}AF.last=AC;if(!AG.newLayout){AG.isStale=true;}}else{AG.needNewLayout=s.call(this);}return AG;}function AA(AC){var AB=x.call(this,h.find(this._layouts,"k",this.model.getCurrentLayoutKey()),(AC.delta.x<0));return(AB&&!AB.wrap)?AB:null;}function F(){var AC=this.model,AB=AC&&AC.wm;if(AB&&AB.tp===3&&AB.imgSrc){return AB;}return null;}function Y(AF){var AB=document.createElement("img"),AC=AB.style;this.watermarkNode=AB;AC.position="absolute";AC.top=0;AC.left=0;AC.visibility="hidden";var AD=this;AB.onload=function(){var AI=AB.width,AK=AB.height;if(AF.imgScale<=0){var AH=AD.domNode;if(AH){AB.width=AH.clientWidth;AB.height=AH.clientHeight;}}else{var AJ=AF.imgScale/100;AB.width=AI*AJ;AB.height=AK*AJ;}AB.style.visibility="visible";};this.domNode.insertBefore(AB,this.domNode.firstChild);var AE=this.model.getDataService();var AG=AF&&AF.imgSrc;AB.src=(AG&&AE&&AE.getDocImage&&AE.getDocImage(AG))||AG;}mstrmojo.android.ui.DocumentView=mstrmojo.declare(mstrmojo.android.ui.ViewSlider,[mstrmojo._HasBuilder,mstrmojo._IsRwDocument],{scriptClass:"mstrmojo.android.ui.DocumentView",postBuildRendering:function X(){var AC=this._super(),AB=F.call(this);if(AB){Y.call(this,AB);}return AC;},buildChildren:function d(AB){this._layouts=this._super(true);},beforeViewHidden:function M(AC){this._stale=true;var AB=this.getCurrentLayout();if(AB&&AB.beforeViewHidden){AB.beforeViewHidden(AC);}},getViewController:function H(AB){return null;},unrender:function A(AB){delete this._stale;this._super(AB);},reloadLayout:function I(){var AB=this.getCurrentView(),AD=this.id,AC={layoutKey:AB.k,reload:true,executionOrientation:mstrMobileApp.getOrientation()};this.getNewLayout(AC,this._layouts,true,{success:function(AE){var AF=mstrmojo.all[AD];AF.replaceView(AE,AB,true);AF.resetSliderNodes();}});},rootOrientationChange:function L(){if(this._stale){return ;}var AE=F.call(this);if(AE&&AE.imgScale<=0){var AG=this.watermarkNode;AG.width=parseInt(this.width,10);AG.height=parseInt(this.height,10);}var AN=this.getCurrentView();if(AN.isPreloader){return ;}var AL=this._layouts,AH=AN.k,AD=e.call(this,AH),AI=AD.newLayout;if(AD.isStale){return ;}if(AD.specific){g.call(this,AN);}var AJ=!!AD.needNewLayout,AK=!AJ&&(!AD.isSupported&&AI),AC=!AK&&(this.model.zt&&!AN.isFullScreenWidget);if(AJ||AK||AC){mstrApp.closeAllDialogs();var AB=this.id,AM=this,AF={layoutKey:AH,reload:true,executionOrientation:mstrMobileApp.getOrientation()},AO=function(AP){mstrmojo.all[AB].replaceView(AP,AM.getCurrentView());AM.resetSliderNodes();};if(AK){AN=this.replaceView(R(AI),AN,true);AF.layoutKey=AI.k;delete AF.reload;AO=mstrmojo.func.composite([function(AP){g.call(mstrmojo.all[AB],AP);},AO]);}this.getNewLayout(AF,AL,true,{success:AO});}this.controller.generateActionToolbar();},onRender:function C(){if(!this.layoutSelector){this.addChildren([{scriptClass:"mstrmojo.android.ui.LayoutSelector",slot:"overlayNode",alias:"layoutSelector",visible:false,tabSelected:function(AI){this.parent.showLayout(AI);}}]);}var AB=this.getCurrentLayout();var AG=e.call(this,this.model.getCurrentLayoutKey()),AC=AG.currentLayout,AE=this,AF=function(AI){if(AI&&!AI.domNode){AE.switchView(AI);}else{AE.stackViews(AI.slot);}return AI;};if(AG.needNewLayout&&this.controller.isBack){AF(AC);var AH={layoutKey:AC.k,reload:true,executionOrientation:mstrMobileApp.getOrientation()};this.getNewLayout(AH,this._layouts,true,{success:function(AI){AE.replaceView(AI,AC);}});}else{if(AG.isSupported){AF(AC);g.call(this,AC);}else{var AD=AG.newLayout;if(AD){AC.defn.loaded=false;AD=AF(this.selectLayout(R(AD),false));this.getNewLayout({layoutKey:AD.k},this._layouts,true,{success:function(AI){g.call(AE,AI);AE.replaceView(AI,AD);}});}else{this._ignoreOrientation=true;AF(AC);}}}},showLayout:function O(AC){var AB=AC.k,AD=this;if(AB!==this.model.getCurrentLayoutKey()){var AE={layoutKey:AB};if(s.call(this)){AE.executionOrientation=mstrMobileApp.getOrientation();AE.reload=true;}this.getNewLayout(AE,this._layouts,true,{success:function(AF){AD.switchView(AF);}});return true;}return false;},afterSwitch:function o(AB){this._super(AB);this.selectLayout(AB,(AB.k!==this.model.getCurrentLayoutKey()));},selectLayout:function k(AB,AC,AE){var AD=this._super(AB,AC,AE);this.controller.getPageByTree(true);if(!AB.defn||!AB.defn.iw){g.call(this,AD,true);}return AD;},replaceLayout:function D(AD,AC){var AE=this._layouts||[],AB=h.find(AE,"k",AD.k);if(AB>=0){AD.unrender();AD.destroy();}var AF=this.builder.build([AC],this.model)[0];if(AB>=0){AE[AB]=AF;}else{AE.push(AF);}this._layouts=AE;return AF;},onLayoutRebuilt:function W(AB){this.replaceView(AB,this.getCurrentView());},canScroll:function T(AB){return !!AA.call(this,AB);},beginScroll:function Z(AE,AH){if(this.isAnimating()){return false;}delete this._scrollInfo;if(!AH){var AI=this._layouts,AJ=AA.call(this,AE),AB=this.id;if(!AJ){return ;}AH=AJ.layout;var AC=mstrMobileApp.getOrientation(),AG=AH.docLayout,AF=s.call(this)||(this.model.zt&&AG&&AC!==AG.defn.lastOrientation);if(!AH.defn.loaded||AF){AH=R(AH);var AD={layoutKey:AH.k};if(AF){AD.executionOrientation=AC;AD.reload=true;}this.getNewLayout(AD,AI,false,{success:function(AL){var AK=mstrmojo.all[AB],AM=AK._scrollInfo;if(AM){AM.view=AL;}AK.replaceView(AL,AH);}});}}if(AH){this._super(AE,AH);}},scrollStarted:function G(){var AB=this.layoutSelector;AB.set("visible",true);AB.enterScroll();},scrollProgress:function j(AB,AC){this.layoutSelector.scroll(AC);},scrollStopped:function z(AD,AE){var AC=this.layoutSelector,AB=AC.selectedIndex;if(AE){AB+=(AD.isForward?1:-1);}AC.exitScroll(AB);},scrollCanceled:function p(AC){this._super(AC);var AB=AC.oldView;this.model.getDataService().setCurrentDocLayout(AB.k);this.selectLayout(AB,false);this.layoutSelector.initiateFade();},scrollComplete:function a(AC){this._super(AC);var AB=AC.newView;this.selectLayout(AB,(AB.k!==this.model.getCurrentLayoutKey()));this.controller.generateActionToolbar();},renderInfoWindow:function V(AC){AC.autoCloses=AC.locksHover=false;if(mstrApp.isTablet()){this._super(AC);return ;}var AD=this.controller,AK=AD.rootCtrl,AJ=AK.getTitle(),AG=function(AL){AK.updateContent(null,AL);},AE=false;this.fullScreenInfoWindow=true;AD.generateActionToolbar();var AB=this.id;mstrApp.showDialog({cssClass:"FSInfoWindow",children:AC,resizeDialog:function AI(){var AQ=mstrApp.rootView,AP=AQ.getContentDimensions(),AO=this.editorNode&&this.editorNode.style,AM=this.children[0],AL=AM&&AM.infoNode;if(AO){AO.top=(parseInt(AQ.getBrowserDimensions().h,10)-AP.h+3)+"px";AO.left="5px";}if(AL){var AN=AL.style;AN.height=AP.h+"px";AN.width=AP.w+"px";mstrmojo.all[AM.psId].setInfoWindowDimensions(AP);}},onClose:function AH(){AG(AJ);delete mstrmojo.all[AB].fullScreenInfoWindow;AD.generateActionToolbar();if(AE){mstrMobileApp.releaseOrientation();}var AL=this.children[0];if(AL&&AL.clearAnchorHilites){AL.clearAnchorHilites();}},positionDialog:mstrmojo.emptyFn});var AF=AC.children[0];AG(AF.getTitle());if(mstrMobileApp.getLockedOrientation()===0){mstrMobileApp.lockOrientation(mstrMobileApp.getOrientation());AE=true;}AF.attachEventListener("titleChange",this.id,function(AL){AG(AL.value);});},updateInfoWindowPS:function b(AB,AC){if(!mstrApp.isTablet()){mstrmojo.all[AB].setInfoWindowDimensions(mstrApp.getContentDimensions());}},destroy:function t(AB){l(this._layouts,function(AC){AC.destroy(AB);});this.builder.destroy();this._super(AB);},getLayouts:function(){return this._layouts;},getSelectedLayoutWidget:function B(){return this.getCurrentView();},getNewLayout:function J(AF,AE,AC,AG){var AB=this.controller,AD;if(AB&&AB.getDesiredElements){AD=AB.getDesiredElements();if(AD){AF.desiredElements=AD;}}AG.success=mstrmojo.func.composite([AG.success,function(){AB.generateActionToolbar();}]);S.forEach(this.ifwMap,function(AH){if(AH.visible){AH.close();}});return this._super(AF,AE,AC,AG);},unloadLayouts:function q(AK,AB){var AJ=this._layouts,AF=this.model.getCurrentLayoutKey(),AG,AC=(AJ&&AJ.length)||0,AE,AD,AI,AH;for(AG=0;AG<AC;AG++){AE=AJ[AG];AI=AE.defn;if(AE.k!==AF&&AI&&AI.loaded){if(AB){AD=(AE.gb&&AE.gb.groupbys);if(AD&&AD.length){AI.loaded=false;}}else{if(AK){for(AH=0;AH<AK.length;AH++){if(AE.k===AK[AH]){AI.loaded=false;break;}}}else{AI.loaded=false;}}}}},getSupportedLayouts:function N(){var AC=[],AB=mstrMobileApp.getOrientation();l(this._layouts,function(AD){if(((AD.defn.or&AB)>0)&&(!f(AD))){AC.push(AD);}});return AC;},getCurrentLayout:function w(){var AB=this._layouts;return AB[h.find(AB,"k",this.model.getCurrentLayoutKey())];},getCaptureDimensions:function U(){var AB=this.getCurrentLayout();return AB.getCaptureDimensions&&AB.getCaptureDimensions();},closeInfoWindowsOnTablet:function E(){if(mstrApp.isTablet()){S.forEach(this.ifwMap,function(AB){if(AB.visible){AB.closeOnTablet();}});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileDocLayoutViewer");var B=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.maps.MobileMapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MobileMapInfoWindowLayoutViewer",preBuildRendering:function A(){this.setDimensions(this.height,this.width);this.set("visible",true);return this._super?this._super():true;}});mstrmojo.maps.MapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MapInfoWindowLayoutViewer",preBuildRendering:function A(){this.set("visible",true);return this._super?this._super():true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.maps.jsmap.InfoWindow");mstrmojo.maps.jsmap.InfoWindowController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.jsmap.InfoWindowController",start:function A(C){C=C||{};var B=this.infoWindow=new mstrmojo.maps.jsmap.InfoWindow(C);B.start();}});})();(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList");mstrmojo._IsTableLayoutListDIC=mstrmojo.provide("mstrmojo._IsTableLayoutListDIC",{_mixinName:"mstrmojo._IsTableLayoutListDIC",icnCss:"dicContainer",tableLayoutCssStyle:"fixed",setDirtyFlag:function(D,C){if(D.className!=="flag-container"){var B=document.createElement("div"),A=this.itemsNode&&this.itemsNode.clientWidth-8;B.className="flag-container";B.style.left=(A>0?A:0)+"px";B.innerHTML='<div class="dirty-cell"/>';C.insertBefore(B,D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.GraphBase","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo._IsSelectorTarget","mstrmojo.tooltip");var F=mstrmojo.dom;function M(P){var Q=P.getFormats();if(!Q.width&&"gp" in Q){Q=Q.gp;}P.resizeForDisplayState(parseInt(Q.height,10),parseInt(Q.width,10),false);}function A(Q){var P=F.position(this.domNode),R=F.getMousePosition(Q);return{x:parseInt(R.x-P.x,10),y:parseInt(R.y-P.y,10)};}function O(V,U){var R=F.eventTarget(U,V),T=R&&R.parentNode,W=T&&T.children,P=[],S=R.getAttribute("coords");if(W&&!!S){for(var Q=0;Q<W.length;++Q){if(W[Q]&&W[Q].getAttribute&&W[Q].getAttribute("coords")==S){P.push(W[Q]);}}}return P;}mstrmojo.DocXtabGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._Formattable,mstrmojo._HasWaitIcon,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocXtabGraph",cssClassPrefix:"mstrmojo-DocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" onclick="mstrmojo.all[\'{@id}\'].onClickArea(this, event);" onmousemove="mstrmojo.all[\'{@id}\']._updateTooltip(event, self);" {@extra}/>',_att:"",markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","background-color","fx"]},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},onClickArea:function B(R,T){T=T||window.event;var Y=A.apply(this,[T]),U=this.defn,P=F.position(this.domNode),Q=this.as[R.getAttribute("aid")],X=this.k,W=Y.x,V=Y.y,S={getBoundingClientRect:function(){var a=P.x+W,Z=P.y+V;return{left:a,top:Z,right:a+1,bottom:Z+1};},w:this};this.showInfoWin(Q.tks,S);this.model.slice({type:parseInt(U.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:X,ck:U.ck,gk:X,tks:Q.tks,cks:Q.cks,sid:this.node.data.sid,x:W,y:V,anchor:S,tty:Q.tty});},showInfoWin:function G(T,Q){var P=this.model,S=T&&P.getTargetInfoWin(T);if(S&&S.length){for(var R=0;R<S.length;R++){P.showInfoWin(S[R],Q,"h");}}},showTooltip:function N(R,Q){this._updateTooltip(R,Q);var P=O(R,Q);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.open(this,R,Q,P);}else{this._super(R,Q);}},_updateTooltip:function L(P,Q){this.updatingTooltipHelper(F.eventTarget(Q,P),A.apply(this,[P]));},hideTooltip:function J(S,R){var Q=F.eventTarget(R,S);if(Q.getAttribute("aid")===this.cAreaIdx){this.cAreaIdx=-1;var P=O(S,R);if(P&&P.length>1){mstrmojo.DocXtabGraph.multiTooltip.close(this,S,R,P);}else{this._super(S,R);}}},update:function D(P){this.node.data=P.data;this.as=P.data.as;var b="\u001E",R=this.model,X=R.getCGBMap&&R.getCGBMap(),Q=this.as||[],V,T;for(V=0;V<Q.length;V++){var Y=Q[V],U=Y&&Y.tgbs;if(U){var W=U.split(b);var Z={};for(T=0;T<W.length;T++){var S=X&&X[W[T]];if(S){Z[S]=true;}else{Z[W[T]]=true;}}Y.tks=mstrmojo.hash.keyarray(Z).join(b);}}this.eg=P.data.eg;},retrieveGraphSrc:function I(Q,P){var S=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(P,10)+"&height="+parseInt(Q,10)+"&sessionState="+mstrApp.sessionState,R=this.imgNode;if(R.src!==S){R.src=S;}},resize:function(){M(this);},resizeForDisplayState:function E(R,Q,U){var T=this.getFormats(),S=this.imgNode;if(U){var P=this.domNode.style;P.top=T.top;P.left=T.left;P.height=T.height;P.width=T.width;}if(S){S.style.height=R+"px";}if(!this.eg){this.retrieveGraphSrc(R,Q);if(R){this.refreshMap();}}}});function H(P){if(P&&P.getAttribute){var Q=P.getAttribute("coords");Q=Q&&Q.split(",");if(Q&&Q.length>=3){return Q[2]-Q[0];}}return 0;}function C(R){var Q=[],V=document.body.offsetWidth,P=document.body.offsetHeight,W=0,T=0,Y=K[0]&&K[0].domNode?K[0].domNode.offsetLeft:0,X=K[0]&&K[0].domNode?K[0].domNode.offsetTop:0,b=Math.ceil(K.length/2),S=5,a=function(e,d){if(e+R+d+S>V){return V-R-d-S;}else{if(K.length>1&&e-d-S<0){return d+S;}}return e;},Z=function(g,e,d){g+=e;var f=d==1?e:(d*e+(d-1)*S)/2;if(f>g){return 0;}else{if(f+g>P){return P-f*2;}else{return g-f;}}};for(var U=0;U<K.length;++U){W=Math.max(W,K[U].containerNode.offsetWidth);T=Math.max(T,K[U].containerNode.offsetHeight);}Y=a(Y,W);X=Z(X,T,b);for(var U=0;U<K.length;++U){if(U%2==0){Q.push({l:Y+R+S,t:X});}else{Q.push({l:Y-K[U].containerNode.offsetWidth-S,t:X});X+=T+S;}}return Q;}var K=[];mstrmojo.DocXtabGraph.multiTooltip={_posMultiTp:function(Q){for(var P=0;P<K.length;++P){K[P].domNode.style.left=Q[P].l+"px";K[P].domNode.style.top=Q[P].t+"px";}},open:function(Y,V,U,Q,P){if(!P){P={};}P.e=V;P.win=U;var S=0;if(Q&&Q.length){S=H(Q[0]);}for(var R=0;R<Q.length;++R){var X=K[R];if(!X||!mstrmojo.all[X.id]){X=new mstrmojo.Tooltip();var T=0,W=this;X.optimizePos=function(){T++;if(T>=K.length){T=0;W._posMultiTp(C(S));}};K.push(X);}Y.richTooltip.content=Q[R]&&Q[R].getAttribute("ttl");X.open(Y,P);}},close:function(){for(var P=K.length-1;P>=0;--P){K[P].close();}K=[];}};}());(function(){mstrmojo.requiresCls("mstrmojo.graph._MobileGraphAreaHelper","mstrmojo.GraphBase","mstrmojo.dom");var AF=0,Au=0,BE=0,Ae=1,f=2,Y=11,W=12,AV=13,BK=101,l=102,A1=111,Ac=112,BF=113,k=121,A6=122,Af=131,x=132,AI=201,H=301,F=302,AC=303,s=311,g=321,BA=322,B=401,A4=402,Al=501,J=502,AQ=503,AO=511,q=512,M=513,BI=514,At=515,BL=521,AU=522,Q=601,N=701,AX=801;var Ak=0,I=9,AK=10,Z=14;var AA=0,AM=1,G=2,Aj=3,Ag=4;var o=0,A3=1,Ai=2;var U=2,d=3;var A0=0,AP=3,BD=4,z=6,E=13,A=14,D=101;var A9=0,Az=1,Ao=2;var Ah=3.14159265;var e,a;var Ax=0,A7=1,Ar=2,R=3,AG=4,BJ=5,AE=6,AZ=7,AW=8,Ab=9;var A8=100;var BB=[[-100,-100,100,-100,100,100,-100,100],[-80,-100,0,-20,80,-100,100,-80,20,0,100,80,80,100,0,20,-80,100,-100,80,-20,0,-100,-80],[-33,-100,33,-100,33,-33,100,-33,100,33,33,33,33,100,-33,100,-33,33,-100,33,-100,-33,-33,-33],[-50,-100,50,-100,50,-50,100,-50,100,50,50,50,50,100,-50,100,-50,50,-100,50,-100,-50,-50,-50],[],[0,-100,100,0,0,100,-100,0],[0,-100,100,100,-100,100],[-100,-100,100,-100,100,100,-100,100],[0,-100,23,-31,95,-31,36,12,59,81,0,38,-59,81,-36,12,-95,-31,-23,-31],[0,-60,100,-100,100,100,-100,100,-100,-100,0,-60,0,100]];function As(Cd,B1,Cv,Bz){var Bi=Cv.InstructionList,B7=Bi.length,Bo,CC,By,Bx,CF,B0,Bh,Bl,BR,BV,CE,B6,BZ,Cp,CL,CG,Ct;for(CC=0;CC<B7;CC++){Bo=Bi[CC];if(typeof (Bo)==="undefined"){continue;}switch(Bo.Ins){case BE:break;case Ae:Cd.save();break;case f:Cd.restore();break;case Y:Cd.clip();break;case W:Cd.scale(Bo.X,Bo.Y);break;case AV:if(Bo.Radian!==0){Cd.translate(Bo.Anchor.X,Bo.Anchor.Y);Cd.rotate(Bo.Radian);Cd.translate(-Bo.Anchor.X,-Bo.Anchor.Y);}break;case BK:Cd.beginPath();break;case l:Cd.closePath();break;case A1:if(Cv.IsAnimated===0){Cd.moveTo(Bo.X,Bo.Y);}else{if(Bo.CA[0]==0){By=Bo.X[0]*(1-B1)+Bo.X[1]*B1;Bx=Bo.Y[0]*(1-B1)+Bo.Y[1]*B1;Cd.moveTo(By,Bx);}else{var Bn=Math.sqrt((Bo.X[0]-Bo.BPX[0])*(Bo.X[0]-Bo.BPX[0])+(Bo.Y[0]-Bo.BPY[0])*(Bo.Y[0]-Bo.BPY[0]));var Bk=Math.sqrt((Bo.X[1]-Bo.BPX[0])*(Bo.X[1]-Bo.BPX[0])+(Bo.Y[1]-Bo.BPY[0])*(Bo.Y[1]-Bo.BPY[0]));var CI=Math.sqrt((Bo.X[0]-Bo.X[1])*(Bo.X[0]-Bo.X[1])+(Bo.Y[0]-Bo.Y[1])*(Bo.Y[0]-Bo.Y[1]));var Bm=Math.acos((Bn*Bn+Bk*Bk-CI*CI)/(2*Bn*Bk));var Cy=(Bo.X[0]-Bo.BPX[0])*Math.cos(Bm)-(Bo.Y[0]-Bo.BPY[0])*Math.sin(Bm)+Bo.BPX[0]-Bo.X[1];if(Cy<-0.01||Cy>0.01){Bm=2*Ah-Bm;}By=(Bo.X[0]-Bo.BPX[0])*Math.cos(B1*Bm)-(Bo.Y[0]-Bo.BPY[0])*Math.sin(B1*Bm)+Bo.BPX[0];Bx=(Bo.Y[0]-Bo.BPY[0])*Math.cos(B1*Bm)+(Bo.X[0]-Bo.BPX[0])*Math.sin(B1*Bm)+Bo.BPY[0];Cd.moveTo(By,Bx);}}break;case Ac:if(Cv.IsAnimated===0){Cd.lineTo(Bo.X,Bo.Y);}else{if(Bo.CA[0]==0){By=Bo.X[0]*(1-B1)+Bo.X[1]*B1;Bx=Bo.Y[0]*(1-B1)+Bo.Y[1]*B1;Cd.lineTo(By,Bx);}else{var Bn=Math.sqrt((Bo.X[0]-Bo.BPX[0])*(Bo.X[0]-Bo.BPX[0])+(Bo.Y[0]-Bo.BPY[0])*(Bo.Y[0]-Bo.BPY[0]));var Bk=Math.sqrt((Bo.X[1]-Bo.BPX[0])*(Bo.X[1]-Bo.BPX[0])+(Bo.Y[1]-Bo.BPY[0])*(Bo.Y[1]-Bo.BPY[0]));var CI=Math.sqrt((Bo.X[0]-Bo.X[1])*(Bo.X[0]-Bo.X[1])+(Bo.Y[0]-Bo.Y[1])*(Bo.Y[0]-Bo.Y[1]));var Bm=Math.acos((Bn*Bn+Bk*Bk-CI*CI)/(2*Bn*Bk));var Cy=(Bo.X[0]-Bo.BPX[0])*Math.cos(Bm)-(Bo.Y[0]-Bo.BPY[0])*Math.sin(Bm)+Bo.BPX[0]-Bo.X[1];if(Cy<-0.02||Cy>0.02){Bm=2*Ah-Bm;}By=(Bo.X[0]-Bo.BPX[0])*Math.cos(B1*Bm)-(Bo.Y[0]-Bo.BPY[0])*Math.sin(B1*Bm)+Bo.BPX[0];Bx=(Bo.Y[0]-Bo.BPY[0])*Math.cos(B1*Bm)+(Bo.X[0]-Bo.BPX[0])*Math.sin(B1*Bm)+Bo.BPY[0];Cd.lineTo(By,Bx);}}break;case BF:if(Cv.IsAnimated===0){Cd.bezierCurveTo(Bo.CP1X,Bo.CP1Y,Bo.CP2X,Bo.CP2Y,Bo.X,Bo.Y);}else{cp1x=Bo.CP1X[0]*(1-B1)+Bo.CP1X[1]*B1;cp1y=Bo.CP1Y[0]*(1-B1)+Bo.CP1Y[1]*B1;cp2x=Bo.CP2X[0]*(1-B1)+Bo.CP2X[1]*B1;cp2y=Bo.CP2Y[0]*(1-B1)+Bo.CP2Y[1]*B1;By=Bo.X[0]*(1-B1)+Bo.X[1]*B1;Bx=Bo.Y[0]*(1-B1)+Bo.Y[1]*B1;Cd.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,By,Bx);}break;case k:if(Cv.IsAnimated===0){Cd.rect(Bo.X,Bo.Y,Bo.W,Bo.H);}else{By=Bo.X[0]*(1-B1)+Bo.X[1]*B1;Bx=Bo.Y[0]*(1-B1)+Bo.Y[1]*B1;B0=Bo.W[0]*(1-B1)+Bo.W[1]*B1;CF=Bo.H[0]*(1-B1)+Bo.H[1]*B1;Cd.rect(By,Bx,B0,CF);}break;case A6:if(Cv.IsAnimated===0){if(Bo.EndAngle==6.283){Bo.EndAngle=2*Ah;}Cd.arc(Bo.X,Bo.Y,Bo.Radius,Bo.StartAngle,Bo.EndAngle,Bo.AntiClockwise);}else{if(Bo.EndAngle[0]==6.283){Bo.EndAngle[0]=2*Ah;}if(Bo.EndAngle[1]==6.283){Bo.EndAngle[1]=2*Ah;}Cd.arc(Bo.X[0]*(1-B1)+Bo.X[1]*B1,Bo.Y[0]*(1-B1)+Bo.Y[1]*B1,Bo.Radius[0]*(1-B1)+Bo.Radius[1]*B1,Bo.StartAngle[0]*(1-B1)+Bo.StartAngle[1]*B1,Bo.EndAngle[0]*(1-B1)+Bo.EndAngle[1]*B1,Bo.AntiClockwise[0]);}break;case x:if(Cv.IsAnimated==1){var Bu=Bo.Angle[0]*(1-B1)+Bo.Angle[1]*B1;var Bg=Bo.NeedleSize[0];var CJ=Bo.BPX[0];var CH=Bo.BPY[0];var BS=Bo.MarkSize[0];var Ci=Bo.MarkShape[0];var CU={X:Bg*Math.cos(Bu)+CJ,Y:Bg*Math.sin(Bu)*-1+CH};var B4=AR(Ci,CU,BS);C(Cd,B4,false,false);}break;case AI:case H:break;case F:Cd.lineWidth=Bo.LineWidth;break;case AC:switch(Bo.Type){case A9:Cd.lineJoin="miter";break;case Az:Cd.lineJoin="bevel";break;case Ao:Cd.lineJoin="round";break;}break;case s:case g:case BA:break;case B:Cd.fill();break;case A4:Cd.stroke();break;case Al:BR=Bo.Format;Bh=Bz[BR];if(Bo.HEP==1){Bl=Bo.FC;}else{Bl=Bh.SimpleColor;}Cd.fillStyle="RGBA("+Math.round(Bl.R*Bo.DarkerFactor)+", "+Math.round(Bl.G*Bo.DarkerFactor)+", "+Math.round(Bl.B*Bo.DarkerFactor)+", "+Bh.Alpha/255+");";Cd.fill();break;case J:break;case AQ:if(Cv.IsAnimated===0){BZ=Bo.BoundingRect;Ct=Bo.DarkerFactor;}else{BZ=Bo.BoundingRect[0];Ct=Bo.DarkerFactor[0];var Cw=Bo.BoundingRect[1];BZ.X=BZ.X*(1-B1)+Cw.X*B1;BZ.Y=BZ.Y*(1-B1)+Cw.Y*B1;BZ.Width=BZ.Width*(1-B1)+Cw.Width*B1;BZ.Height=BZ.Height*(1-B1)+Cw.Height*B1;}if(BZ.Width<1||BZ.Height<1){continue;}BZ.Width=Math.floor(BZ.Width);BZ.Height=Math.floor(BZ.Height);var Bh=Bz[Bo.Format];if(Bh.Bevel.FillBevelType!=Ag||B1<1){Ay(Cd,Bh,BZ,Ct);}else{Ap(Cd,Bh);Ay(Cd,Bh,BZ,Ct);}break;case AO:Bh=Bz[Bo.Format];CL=Bh.Bevel;B4=AH(Bo.Polygon);var Bt=B4.length;var BY=[];for(var CD=0;CD<Bt;CD++){BY.push(B4[CD]);}while(true){Bt=BY.length;if(Bt<3){break;}var Be=[];var B5=[];var BT=false;if(Bt>3){var Co={X:0,Y:0};for(var CD=0;((CD<(Bt-2))&&(!BT));++CD){for(var CA=CD+2;CA<(Bt-1);++CA){var Cr=b(BY[CD],BY[CD+1],BY[CA],BY[CA+1],Co,false);Co=Cr.interSection;if(Cr.val==1){BT=true;for(m=0;m<=CD;++m){if(!AY(BY[m],Co)){Be.push(BY[m]);}}Be.push(Co);for(m=CA+1;m<Bt;++m){if(!AY(BY[m],Co)){Be.push(BY[m]);}}B5.push(Co);for(m=CA;m>CD;--m){if(!AY(BY[m],Co)){B5.push(BY[m]);}}break;}}if((CD!=0)&&(!BT)){var Cr=b(BY[CD],BY[CD+1],BY[0],BY[Bt-1],Co,false);Co=Cr.interSection;if(Cr.val==1){for(m=0;m<=CD;++m){Be.push(BY[m]);}Be.push(Co);B5.push(Co);for(m=Bt-1;m>CD;--m){B5.push(BY[m]);}BT=true;}}}}if(!BT){Be=BY;}var Cn=0;var Ce=BN(Be,Cn);Cn=Ce.depth;if(!Ce.mark){break;}Cn*=CL.Depth*0.01;var Bw=[];var BX=[];var B2=Be.length;for(var CD=0;CD<B2;++CD){var CZ;var Br;var Ce=Aw(Be[(CD+B2-1)%B2],Be[CD],Be[(CD+1)%B2],Cn);CZ=Ce.start;Br=Ce.end;Bw.push(CZ);BX.push(Br);}for(var CD=0;CD<B2;++CD){var CR={X:BX[CD].X-Bw[CD].X,Y:BX[CD].Y-Bw[CD].Y};var BU=Math.sqrt(Av(CR));var CW={X:CR.X/BU,Y:CR.Y/BU};var BP=AB((540-CL.LightAngle)%360);var Ba={X:Math.cos(BP),Y:Math.sin(BP)};var B3=AN(CW,Ba);var CS=0;var B9=0;var Cg=0.1;var Cq=0.2;if(B3<-0.01){CS=(1+B3)*Cg;B9=(1+Math.abs(B3))*Cq*CL.Intensity*0.01;}else{CS=(1-Cg)+B3*Cg;B9=((1-Cq)+B3*Cq)*CL.Intensity*0.01;}var B8=CD+1;if(B8==B2){B8-=B2;}Cd.beginPath();Cd.moveTo(Be[CD].X,Be[CD].Y);Cd.lineTo(Be[B8].X,Be[B8].Y);Cd.lineTo(Bw[B8].X,Bw[B8].Y);Cd.lineTo(Bw[CD].X,Bw[CD].Y);Cd.closePath();var CQ=Math.round(CS*255);if(isNaN(CQ)){continue;}if(CL.FillBevelType==AM){Cd.save();Cd.clip();var BQ=Cd.createLinearGradient(BX[CD].X,BX[CD].Y,Bw[CD].X,Bw[CD].Y);BQ.addColorStop(0,"rgba("+CQ+","+CQ+","+CQ+","+B9+")");BQ.addColorStop(1,"rgba("+CQ+","+CQ+","+CQ+","+0+")");Cd.fillStyle=BQ;Cd.fill();Cd.restore();}else{Cd.fillStyle="RGBA("+CQ+", "+CQ+", "+CQ+", "+B9+");";Cd.fill();}}if(BT){BY=B5;}else{break;}}if(B4.length!=0){Cd.beginPath();Cd.moveTo(B4[0].X,B4[0].Y);for(var CD=1;CD<B4.length;++CD){Cd.lineTo(B4[CD].X,B4[CD].Y);}Cd.closePath();}break;case q:Bh=Bz[Bo.Format];CL=Bh.Bevel;if(Cv.IsAnimated===0){BZ=Bo.BoundingRect;CG=Bo.IsCircularShape;}else{var Cx=Bo.BoundingRect[0];var Cw=Bo.BoundingRect[1];BZ={X:0,Y:0,Width:0,Height:0};BZ.X=Cx.X*(1-B1)+Cw.X*B1;BZ.Y=Cx.Y*(1-B1)+Cw.Y*B1;BZ.Width=Cx.Width*(1-B1)+Cw.Width*B1;BZ.Height=Cx.Height*(1-B1)+Cw.Height*B1;}if(CL.FillBevelType===Aj){var Cu=0.2;var CN=CL.Intensity*0.01*Bh.Alpha/255;var CP=1-CL.Depth*0.01;Cp=Cd.createLinearGradient(BZ.X,BZ.Y,BZ.X+BZ.Width,BZ.Y);CE="RGBA(0,0,0,"+CN+");";B6="RGBA(255,255,255,"+CN+");";Cp.addColorStop(0,CE);Cp.addColorStop(CP*Cu,CE);Cp.addColorStop(CP,B6);Cp.addColorStop(1,CE);}else{CE=Bh.SimpleColor;var Bb={x:BZ.X+BZ.Width/2,y:BZ.Y+BZ.Height/2};e={x:0,y:0};a={x:0,y:0};AD(BZ,CL.LightAngle,Bb);var Bf=Bh.Alpha/255;var Bq=Bf;if(Bh.FillType!=A0){Bf*=0.8;Bq*=0.5;CE={R:128,G:128,B:128};}var BQ=Cd.createLinearGradient(e.x,e.y,a.x,a.y);BQ.addColorStop(0,"rgba(255,255,255,"+Bf+")");BQ.addColorStop(0.05+CL.Intensity*0.001,"rgba(255,255,255,"+9*Bf/(10-Bf)+")");BQ.addColorStop(0.5,"rgba("+CE.R+","+CE.G+","+CE.B+","+Bq+")");BQ.addColorStop(0.85+(1-CL.Intensity*0.01)*0.05,"rgba(0,0,0,"+9*Bf/(10-Bf)+")");BQ.addColorStop(1,"rgba(0,0,0,"+Bf+")");Cd.fillStyle=BQ;Cd.fill();if(Bh.FillType!=A0){continue;}var BO=Math.max(BZ.Width,BZ.Height)*0.5*(2-CL.Intensity*0.01);BO*=CG?0.75:2;Cp=Cd.createRadialGradient(Bb.x,Bb.y,0,Bb.x,Bb.y,BO);Cp.addColorStop(0,"rgba("+CE.R+","+CE.G+","+CE.B+","+Bf+")");Cp.addColorStop(0.5,"rgba("+CE.R+","+CE.G+","+CE.B+","+Bf/2+")");Cp.addColorStop(0.8,"rgba("+CE.R+","+CE.G+","+CE.B+","+Bf/10+")");Cp.addColorStop(1,"rgba("+CE.R+","+CE.G+","+CE.B+",0)");}Cd.fillStyle=Cp;Cd.fill();break;case At:Bh=Bz[Bo.Format];CL=Bh.Bevel;var Cc=Bo.CX;var Cb=Bo.CY;var Ck=Bo.Radius;var BO;var CN;switch(Bo.BorderUse){case U:CN=0.4;e={x:Cc+Ck*Math.cos(Ah*1.25),y:Cb+Ck*Math.sin(Ah*1.25)};a={x:Cc+Ck*Math.cos(Ah*0.25),y:Cb+Ck*Math.sin(Ah*0.25)};Cd.save();Cd.clip();var BQ=Cd.createLinearGradient(e.x,e.y,a.x,a.y);BQ.addColorStop(0,"rgba(0,0,0,"+CN+")");BQ.addColorStop(1,"rgba(255,255,255,"+CN+")");Cd.fillStyle=BQ;Cd.fill();Cd.restore();CN=0.4;BO=Ck*0.3;Bl=Bh.SimpleColor;e={x:Cc+BO*Math.cos(Ah*0.75),y:Cb+BO*Math.sin(Ah*0.75)};a={x:Cc+BO*Math.cos(Ah*1.75),y:Cb+BO*Math.sin(Ah*1.75)};Cd.save();Cd.clip();var BQ=Cd.createLinearGradient(e.x,e.y,a.x,a.y);BQ.addColorStop(0,"rgba("+Bl.R+","+Bl.G+","+Bl.B+","+0+")");BQ.addColorStop(0.2,"rgba("+Bl.R+","+Bl.G+","+Bl.B+","+1+")");BQ.addColorStop(0.8,"rgba("+Bl.R+","+Bl.G+","+Bl.B+","+1+")");BQ.addColorStop(1,"rgba("+Bl.R+","+Bl.G+","+Bl.B+","+0+")");Cd.fillStyle=BQ;Cd.fill();Cd.restore();break;case d:CN=0.6;BO=Ck*0.2;var CP=0.3;e={x:Cc+BO*Math.cos(Ah*1.25),y:Cb+BO*Math.sin(Ah*1.25)};a={x:Cc+Ck*Math.cos(Ah*0.25),y:Cb+Ck*Math.sin(Ah*0.25)};Cd.save();Cd.clip();var BQ=Cd.createLinearGradient(e.x,e.y,a.x,a.y);BQ.addColorStop(0,"rgba(255,255,255,"+CN+")");BQ.addColorStop(CP,"rgba(0,0,0,"+CN+")");BQ.addColorStop(1,"rgba(255,255,255,"+CN+")");Cd.fillStyle=BQ;Cd.fill();Cd.restore();break;default:CN=0.4;BO=Ck-Bo.Thickness;e={x:Cc+BO*Math.cos(Ah*1.25),y:Cb+BO*Math.sin(Ah*1.25)};a={x:Cc+BO*Math.cos(Ah*0.25),y:Cb+BO*Math.sin(Ah*0.25)};Cd.save();Cd.clip();var BQ=Cd.createLinearGradient(e.x,e.y,a.x,a.y);BQ.addColorStop(0,"rgba(0,0,0,"+CN+")");BQ.addColorStop(1,"rgba(255,255,255,"+CN+")");Cd.fillStyle=BQ;Cd.fill();Cd.restore();break;}break;case M:Bh=Bz[Bo.Format];CL=Bh.Bevel;var CN;var CP;var Cc;var Cb;var Bp;var Bd;var CO;var Bv;var Bs;var Cf;if(Cv.IsAnimated===0){Cc=Bo.CX;Cb=Bo.CY;Bp=Bo.InnerRadius;Bd=Bo.OuterRadius;CO=Bo.RGUsage;Bv=Bo.HEP;if(Bv==1){Bs=Bo.ExtraDepth;Cf=Bo.ExtraIntensity;}}else{Cc=Bo.CX[0]*(1-B1)+Bo.CX[1]*B1;Cb=Bo.CY[0]*(1-B1)+Bo.CY[1]*B1;Bp=Bo.InnerRadius[0];Bd=Bo.OuterRadius[0];CO=Bo.RGUsage[0];Bv=Bo.HEP[0];if(Bv==1){Bs=Bo.ExtraDepth[0];Cf=Bo.ExtraIntensity[0];}}switch(CO){case o:CN=CL.Intensity*0.01*Bh.Alpha/255;CP=1-CL.Depth*0.01;Cp=Cd.createRadialGradient(Cc,Cb,Bp,Cc,Cb,Bd);CE="RGBA(0,0,0,"+CN+");";B6="RGBA(255,255,255,"+CN+");";Cp.addColorStop(0,CE);Cp.addColorStop(CP,B6);Cp.addColorStop(1,CE);Cd.fillStyle=Cp;Cd.fill();break;case A3:CN=CL.Intensity*0.01*Bh.Alpha/255;Cp=Cd.createRadialGradient(Cc,Cb,Bp,Cc,Cb,Bd);CE="RGBA(0,0,0,"+CN+");";B6="RGBA(255,255,255,"+CN+");";Cp.addColorStop(0,CE);Cp.addColorStop(1,B6);Cd.fillStyle=Cp;Cd.fill();break;case Ai:if(Bv==0){CN=CL.Intensity*0.01*Bh.Alpha/255;CP=CL.Depth*0.01;}else{CN=Cf*0.01*Bh.Alpha/255;CP=Bs*0.01;}Cp=Cd.createRadialGradient(Cc,Cb,Bp,Cc,Cb,Bd);CE="RGBA(0,0,0,"+CN+");";B6="RGBA(255,255,255,"+CN+");";Cp.addColorStop(0,CE);Cp.addColorStop(CP,B6);Cp.addColorStop(1,CE);Cd.fillStyle=Cp;Cd.fill();break;}break;case BI:Bh=Bz[Bo.Format];CL=Bh.Bevel;CN=CL.Intensity*0.01*Bh.Alpha/255;CP=1-CL.Depth*0.01;CE="RGBA(0,0,0,"+CN+");";B6="RGBA(255,255,255,"+CN+");";Cp=Cd.createLinearGradient(Bo.StartPoint.X,Bo.StartPoint.Y,Bo.EndPoint.X,Bo.EndPoint.Y);Cp.addColorStop(0,CE);Cp.addColorStop(CP,B6);Cp.addColorStop(1,CE);Cd.save();Cd.clip();Cd.fillStyle=Cp;Cd.fill();Cd.restore();break;case BL:case AU:break;case Q:BR=Bo.Format;Bh=Bz[BR];Bl=Bh.Color;Cd.strokeStyle="RGBA("+Bl.R+", "+Bl.G+", "+Bl.B+", "+Bh.Alpha/255+");";Cd.stroke();break;case N:BR=Bo.Format;Bh=Bz[BR];Bl=Bh.Color;Cd.font=Bh.Size+"px "+Bh.Name;if(Bh.Style&2){Cd.font="italic "+Cd.font;}if(Bh.Style&1){Cd.font="bold "+Cd.font;}Cd.fillStyle="RGBA("+Bl.R+", "+Bl.G+", "+Bl.B+", "+Bh.Alpha/255+");";Cd.fillText(Bo.Text,Bo.StartPoint.X,Bo.StartPoint.Y);if(Bh.Style&12){Cd.beginPath();var CM=Cd.measureText(Bo.Text);if(Bh.Style&4){Cd.moveTo(Math.round(Bo.StartPoint.X),Math.round(Bo.StartPoint.Y));Cd.lineTo(Math.round(Bo.StartPoint.X+CM.width),Math.round(Bo.StartPoint.Y));}if(Bh.Style&8){Cd.moveTo(Math.round(Bo.StartPoint.X),Math.round(Bo.StartPoint.Y-Bh.Size*0.5));Cd.lineTo(Math.round(Bo.StartPoint.X+CM.width),Math.round(Bo.StartPoint.Y-Bh.Size*0.5));}Cd.strokeStyle="RGBA("+Bl.R+", "+Bl.G+", "+Bl.B+", "+Bh.Alpha/255+");";Cd.lineWidth=Math.round(Math.max(1,Bh.Size*3/40));Cd.stroke();}break;case AX:var Cs;if(Cv.IsAnimated===0){Cs=Bo.Rect;}else{Cs=Bo.Rect[0];var Cw=Bo.Rect[1];Cs.X=Cs.X*(1-B1)+Cw.X*B1;Cs.Y=Cs.Y*(1-B1)+Cw.Y*B1;Cs.Width=Cs.Width*(1-B1)+Cw.Width*B1;Cs.Height=Cs.Height*(1-B1)+Cw.Height*B1;}var CB=Bo.RotationAngle;var CK=Bo.BevelDepth;var CV=Bo.LTColor;var CT=Bo.LTAlpha;var Cm=Bo.RBColor;var Cj=Bo.RBAlpha;var Cl={X:Cs.X+Cs.Width/2,Y:Cs.Y+Cs.Height/2};var Ca={X:0,Y:0,Width:0,Height:0};Ca.X=Cs.X;Ca.Y=Cs.Y;Ca.Width=Cs.Width;Ca.Height=Cs.Height;BH(Ca,CK,CK);var Bj=[];Bj.push(A5({X:Cs.X,Y:Cs.Y},Cl,CB));Bj.push(A5({X:Cs.X+Cs.Width,Y:Cs.Y},Cl,CB));Bj.push(A5({X:Cs.X+Cs.Width,Y:Cs.Y+Cs.Height},Cl,CB));Bj.push(A5({X:Cs.X,Y:Cs.Y+Cs.Height},Cl,CB));var Ch=[];Ch.push(A5({X:Ca.X,Y:Ca.Y},Cl,CB));Ch.push(A5({X:Ca.X+Ca.Width,Y:Ca.Y},Cl,CB));Ch.push(A5({X:Ca.X+Ca.Width,Y:Ca.Y+Ca.Height},Cl,CB));Ch.push(A5({X:Ca.X,Y:Ca.Y+Ca.Height},Cl,CB));var Bc=[];Bc.push(A5({X:Cs.X,Y:Cs.Y+Cs.Height},Cl,CB));Bc.push(A5({X:Ca.X,Y:Ca.Y+Ca.Height},Cl,CB));Bc.push(A5({X:Ca.X,Y:Ca.Y},Cl,CB));Bc.push(A5({X:Ca.X+Ca.Width,Y:Ca.Y},Cl,CB));Bc.push(A5({X:Cs.X+Cs.Width,Y:Cs.Y},Cl,CB));Bc.push(A5({X:Cs.X,Y:Cs.Y},Cl,CB));C(Cd,Bc,false,false);Cd.fillStyle="RGBA("+CV.R+", "+CV.G+", "+CV.B+", "+CT/255+");";Cd.fill();var BW=[];BW.push(A5({X:Cs.X,Y:Cs.Y+Cs.Height},Cl,CB));BW.push(A5({X:Ca.X,Y:Ca.Y+Ca.Height},Cl,CB));BW.push(A5({X:Ca.X+Ca.Width,Y:Ca.Y+Ca.Height},Cl,CB));BW.push(A5({X:Ca.X+Ca.Width,Y:Ca.Y},Cl,CB));BW.push(A5({X:Cs.X+Cs.Width,Y:Cs.Y},Cl,CB));BW.push(A5({X:Cs.X+Cs.Width,Y:Cs.Y+Cs.Height},Cl,CB));C(Cd,BW,false,false);Cd.fillStyle="RGBA("+Cm.R+", "+Cm.G+", "+Cm.B+", "+Cj/255+");";Cd.fill();Cd.strokeStyle="RGBA(230, 230, 230, "+CT*0.5/255+");";Cd.lineWidth=1;C(Cd,Bj,true,true);Cd.stroke();C(Cd,Ch,true,true);Cd.stroke();break;}}}function A2(BO,BP){return 1-(Math.sqrt((BP-256)*(BP-256)+(BO-256)*(BO-256))/(1.5*256));}function V(BS,BO,BT,BQ,BP){var BR=(BQ&&BP)?0.5:0;BS.moveTo(BO+BR,BT+BR);}function BM(BS,BO,BT,BQ,BP){var BR=(BQ&&BP)?0.5:0;BS.lineTo(BO+BR,BT+BR);}function j(BR,BO,BQ,BP){var BT=BO.length;if(BT<=0){return ;}BR.beginPath();V(BR,BO[0].X,BO[0].Y,BQ,BP);var BS=0;for(i=1;i<BT;++i){BM(BR,BO[i].X,BO[i].Y,BQ,BP);BS=i;}}function X(BQ){var BP=BB[BQ];var BO=BP.length/2;return{number:BO,points:BP};}function AR(BX,BS,BP){var BO=[];if(BX==AG){BO.push({X:BS.X-BP,Y:BS.Y-BP});BO.push({X:BS.X+BP,Y:BS.Y-BP});BO.push({X:BS.X+BP,Y:BS.Y+BP});BO.push({X:BS.X-BP,Y:BS.Y+BP});return BO;}var BU;var BW;var BT=X(BX);BU=BT.number;BW=BT.points;for(var BV=0;BV<BU;BV++){var BR=(BW[2*BV])*BP/A8+BS.X;var BQ=(BW[2*BV+1])*BP/A8+BS.Y;BO.push({X:BR,Y:BQ});}return BO;}function C(BT,BP,BR,BQ){var BV=BP.length;if(BV<3){return ;}BT.beginPath();if(BR&&BQ){var BO=[];for(var BS=0;BS<BV;++BS){BO.push(BP[BS]);}var BU=BV-1;for(var BS=0;BS<BV;++BS){lNextIndex=(BS+1==BV)?0:BS+1;if(BP[BS].X==BP[BU].X||BP[BS].X==BP[lNextIndex].X){BO[BS].X+=0.5;}if(BP[BS].Y==BP[BU].Y||BP[BS].Y==BP[lNextIndex].Y){BO[BS].Y+=0.5;}BU=BS;}j(BT,BO,false,BQ);}else{j(BT,BP,false,BQ);}BT.closePath();}function BC(BO,BR,BQ){var BS=BO.X-BR.X;var BP=BO.Y-BR.Y;BO.X=BR.X+Math.cos(BQ)*BS-Math.sin(BQ)*BP;BO.Y=BR.Y+Math.sin(BQ)*BS+Math.cos(BQ)*BP;return BO;}function A5(BO,BQ,BP){return BC(BO,BQ,BP);}function BH(BP,BQ,BO){if(BQ*2>BP.Width){BQ=BP.Width/2;}if(BO*2>BP.Height){BO=BP.Height/2;}return AJ(BP,-BQ,-BO);}function AJ(BP,BQ,BO){BP.X-=BQ;BP.Y-=BO;BP.Width+=(BQ*2);BP.Height+=(BO*2);return BP;}function w(BP,BO,BQ){return S(BP,BO)+S(BO,BQ)+S(BQ,BP);}function p(BP,BO){return Math.sqrt((BP.X-BO.X)*(BP.X-BO.X)+(BP.Y-BO.Y)*(BP.Y-BO.Y));}function P(BR,BV,Be){var Ba=Be;var BQ=BR.length;var BZ=BV;var Bb=BR[(BZ+BQ-1)%BQ];var BY=BR[(BZ+1)%BQ];var BT=0;var Bd={X:0,Y:0};var Bc={X:BR[BV].X-BR[(BV+BQ-1)%BQ].X,Y:BR[BV].Y-BR[(BV+BQ-1)%BQ].Y};for(var BW=(BZ+2)%BQ;BW!=BZ;BW=(BW+1)%BQ){var BX=BW-1;if(BX<0){BX+=BQ;}var Bg={X:BR[BX].X-BR[BZ].X,Y:BR[BX].Y-BR[BZ].Y};var Bf={X:BR[BW].X-BR[BZ].X,Y:BR[BW].Y-BR[BZ].Y};if(S(Bc,Bg)<0.01&&S(Bc,Bf)>0.01){var BP=b(Bb,BR[BZ],BR[BX],BR[BW],Bd,false);Bd=BP.interSection;BT=BW;break;}}var BO=0;var BU={X:0,Y:0};var BS={X:BR[BV].X-BR[(BV+1)%BQ].X,Y:BR[BV].Y-BR[(BV+1)%BQ].Y};for(var BW=(BZ+BQ-2)%BQ;BW!=BZ;BW=(BW-1+BQ)%BQ){var BX=BW+1;if(BX>=BQ){BX-=BQ;}var Bg={X:BR[BX].X-BR[BZ].X,Y:BR[BX].Y-BR[BZ].Y};var Bf={X:BR[BW].X-BR[BZ].X,Y:BR[BW].Y-BR[BZ].Y};if(S(BS,Bg)>-0.01&&S(BS,Bf)<-0.01){var BP=b(BY,BR[BZ],BR[BX],BR[BW],BU,false);BU=BP.interSection;BO=BW;break;}}Ba.push(BR[BZ]);Ba.push(Bd);for(m=BT;;m=(m+1)%BQ){Ba.push(BR[m]);if(m==BO){break;}}Ba.push(BU);return Ba;}function h(BZ,BW){var BX=BZ.length;if(BX==3){var BP=BN(BZ,BW);return BP;}else{var Bg=BZ[BX-1];var BO={X:BZ[1].X-BZ[0].X,Y:BZ[1].Y-BZ[0].Y};var Ba={X:-BO.X,Y:-BO.Y};var BR={X:Bg.X-BZ[0].X,Y:Bg.Y-BZ[0].Y};var Bh={X:-BR.X,Y:-BR.Y};var BT=false;var BY=10000000000;for(var Bf=2;Bf<BX;++Bf){var Bd=Bf-1;var Be={X:BZ[Bf].X-BZ[Bd].X,Y:BZ[Bf].Y-BZ[Bd].Y};if(S(Ba,Be)<-0.01){var BQ={X:0,Y:0};var BU=b(BZ[0],BZ[1],BZ[Bd],BZ[Bf],BQ,false);BQ=BU.interSection;if(BU.val>0){var BV={X:BQ.X-BZ[0].X,Y:BQ.Y-BZ[0].Y};if(AN(BO,BV)>0.01){var BS={X:BQ.X+Be.X,Y:BQ.Y+Be.Y};var Bb={X:0,Y:0};var Bc;var BP=T(Bg,BZ[0],BQ,BS,Bb,Bc);Bb=BP.point;Bc=BP.val;if(BP.mark){BT=true;if((Bc<BY)&&Aq(Bb,BZ[Bd-1],BZ[Bd],BZ[Bf],BZ[(Bf+1)%BX])){BY=Bc;}}}}}else{if(S(Bh,Be)<-0.01){var BQ={X:0,Y:0};var BU=b(BZ[0],Bg,BZ[Bd],BZ[Bf],BQ,false);BQ=BU.interSection;if(BU.val>0){var BV={X:BQ.X-BZ[0].X,Y:BQ.Y-BZ[0].Y};if(AN(BR,BV)>0.01){var BS={X:BQ.x-Be.x,Y:BQ.y-Be.y};var Bb={X:0,Y:0};var Bc;var BP=T(BS,BQ,BZ[0],BZ[1],Bb,Bc);Bb=BP.point;Bc=BP.val;if(BP.mark){BT=true;if((Bc<BY)&&Aq(Bb,BZ[Bd-1],BZ[Bd],BZ[Bf],BZ[(Bf+1)%BX])){BY=Bc;}}}}}}}return{mark:BT,depth:BY};}}function Av(BO){return BO.X*BO.X+BO.Y*BO.Y;}function Aw(Ba,BY,BX,BS){var BT={X:Ba.X-BY.X,Y:Ba.Y-BY.Y};var BR={X:BX.X-BY.X,Y:BX.Y-BY.Y};var BQ=Math.sqrt(Av(BT));var BP=Math.sqrt(Av(BR));var BW={X:BT.X/BQ,Y:BT.Y/BQ};var BV={X:BR.X/BP,Y:BR.Y/BP};var BZ=0;if(Math.abs(BW.X-BV.X)<0.01){BZ=BS*(BV.X+BW.X)/(BW.Y-BV.Y);}else{BZ=BS*(BV.Y+BW.Y)/(BV.X-BW.X);}var BU={X:0,Y:0};var BO={X:0,Y:0};BU.X=BY.X+BZ*BV.X;BU.Y=BY.Y+BZ*BV.Y;BO.X=BU.X+BS*(-BV.Y);BO.Y=BU.Y+BS*BV.X;return{start:BO,end:BU};}function An(BP,BO){var BQ=AN(BP,BO)/(Math.sqrt(Av(BP)*Av(BO)));BQ=(BQ>1)?1:BQ;BQ=(BQ<-1)?-1:BQ;return Math.acos(BQ);}function Aq(BU,Bc,Bb,BZ,BY){var BW={X:Bc.X-Bb.X,Y:Bc.Y-Bb.Y};var BT={X:BZ.X-Bb.X,Y:BZ.Y-Bb.Y};var Ba=t(An(BW,BT));if(S(BT,BW)<-0.01){Ba=360-Ba;}var BQ={X:BU.X-Bb.X,Y:BU.Y-Bb.Y};var BV=t(An(BQ,BT));if(S(BT,BQ)<-0.01){BV=360-BV;}if(2*BV>Ba){return false;}var BP={X:-BT.X,Y:-BT.Y};var BO={X:BY.X-BZ.X,Y:BY.Y-BZ.Y};var BX=t(An(BP,BO));if(S(BO,BP)<-0.01){BX=360-BX;}var BS={X:BU.X-BZ.X,Y:BU.Y-BZ.Y};var BR=t(An(BP,BS));if(S(BS,BP)<-0.01){BR=360-BR;}if(2*BR>BX){return false;}return true;}function AS(BO){return Math.sqrt(Av(BO));}function T(Bc,Bb,BZ,BX,BS,Bf){var Bn;var Be;var Bl={X:Bb.X-Bc.X,Y:Bb.Y-Bc.Y};var Bh={X:BX.X-BZ.X,Y:BX.Y-BZ.Y};var BV={X:BZ.X-Bb.X,Y:BZ.Y-Bb.Y};var Bk=Math.sqrt(Av(BV));var Bi=S(Bl,Bh);if(Bi>0.01||Bi<-0.01){var BW={X:0,Y:0};var BY=b(Bc,Bb,BZ,BX,BW,false);BW=BY.interSection;var Bj=p(Bb,BW);var BP=p(BZ,BW);if(Bi<-0.01){var BR=Bk+Bj+BP;BS.X=(BP*Bb.X+Bj*BZ.X+Bk*BW.X)/BR;BS.Y=(BP*Bb.Y+Bj*BZ.Y+Bk*BW.Y)/BR;Bn=w(Bb,BZ,BW)/BR;Be=true;}else{var BR=Bj+BP-Bk;if(BR<0.01){var Bg=0;if(Math.abs(S(Bl,BV))<0.01){var Bm={X:-BV.X/Bk,Y:-BV.Y/Bk};var BQ=Math.sqrt(Av(Bh));var BT={X:Bh.X/BQ,Y:Bh.Y/BQ};Bg=(Bm.Y-BT.Y)*Bk/(Bm.X+BT.X);BS.X=Bb.X+Bg*Bm.Y;BS.Y=Bb.Y+Bg*(-Bm.X);}else{var Ba={X:BV.X/Bk,Y:BV.Y/Bk};var Bd=AS(Bl);var BU={X:-Bl.X/Bd,Y:-Bl.Y/Bd};Bg=(BU.Y-Ba.Y)*Bk/(BU.X+Ba.X);BS.X=BZ.X+Bg*(-Ba.Y);BS.Y=BZ.Y+Bg*Ba.X;}Bn=Bg;Be=true;return{val:Bn,mark:Be,point:BS};}BS.X=(BP*Bb.X+Bj*BZ.X-Bk*BW.X)/BR;BS.Y=(BP*Bb.Y+Bj*BZ.Y-Bk*BW.Y)/BR;Bn=w(Bb,BW,BZ)/BR;Be=true;}}else{if(Math.abs(S(Bl,BV))<0.01){Be=false;return{val:Bn,mark:Be,point:BS};}var Bd=Math.sqrt(Av(Bl));var BO={X:-Bl.X/Bd,Y:-Bl.Y/Bd};BS.X=(Bb.X+BZ.X+Bk*BO.X)/2;BS.Y=(Bb.Y+BZ.Y+Bk*BO.Y)/2;Bn=S(BV,BO)/2;Be=true;}return{val:Bn,mark:Be,point:BS};}function BN(Bc,BZ){var Bl=false;var BP=Bc.length;if(BP==3){var BX=p(Bc[0],Bc[1]);var BW=p(Bc[1],Bc[2]);var BV=p(Bc[2],Bc[0]);var BO=BX+BW+BV;BZ=w(Bc[0],Bc[1],Bc[2])/BO;Bl=true;}else{var BU=false;var Bb=10000000000;for(var Bh=0;Bh<BP;++Bh){var Bi=Bc[Bh];var Bj=Bc[(Bh+BP-1)%BP];var Bg=Bc[(Bh+1)%BP];var Bf=Bc[(Bh+2)%BP];var BS={X:Bj.X-Bi.X,Y:Bj.Y-Bi.Y};var BQ={X:Bg.X-Bi.X,Y:Bg.Y-Bi.Y};var Bd={X:-BQ.X,Y:-BQ.Y};var Ba={X:Bf.X-Bg.X,Y:Bf.Y-Bg.Y};var BY=S(BS,BQ);if(BY<0.01){if(S(Bd,Ba)<0.01){var BT={X:0,Y:0};var Be=0;var BR=T(Bj,Bi,Bg,Bf,BT,Be);BT=BR.point;Be=BR.val;if(BR.mark){BU=true;Bb=(Bb>Be)?Be:Bb;}}}else{if(BY>0.01){var Bk=[];Bk=P(Bc,Bh,Bk);var BR=h(Bk,Be);var Be=BR.depth;if(BR.mark){BU=true;Bb=(Bb>Be)?Be:Bb;}}}}BZ=Bb;Bl=BU;}return{mark:Bl,depth:BZ};}function AY(BP,BO){return(Math.abs(BP.X-BO.X)<0.01&&Math.abs(BP.Y-BO.Y)<0.01);}function AH(BP){var BQ=[];BQ.push(BP[0]);pcount=BP.length;for(var BO=1;BO<pcount;BO++){if(BP[BO-1].X==BP[BO].X&&BP[BO-1].Y==BP[BO].Y){continue;}BQ.push(BP[BO]);}var BR=new Array();pcount=BQ.length;for(var BO=0;BO<pcount;BO++){if(BO===pcount-1){if(BQ[BO].X==BQ[0].X&&BQ[BO].Y==BQ[0].Y){continue;}}BR.push(BQ[BO]);}return BR;}function Aa(BP,BO,BS,BR){var BQ=0.01;if(BR===false){BQ=-0.01;}if(Math.abs(BO.X-BS.X)<0.01){if(BP.Y-BO.Y>BQ&&BS.Y-BP.Y>BQ){return true;}if(BP.Y-BS.Y>BQ&&BO.Y-BP.Y>BQ){return true;}}else{if(BP.X-BO.X>BQ&&BS.X-BP.X>BQ){return true;}if(BP.X-BS.X>BQ&&BO.X-BP.X>BQ){return true;}}return false;}function b(BY,BX,BV,BU,BT,BP){var BQ={X:BX.X-BY.X,Y:BX.Y-BY.Y};var BR={X:BU.X-BV.X,Y:BU.Y-BV.Y};if(Math.abs(S(BQ,BR))<0.01){var BO={X:BV.X-BY.X,Y:BV.Y-BY.Y};if(Math.abs(S(BQ,BO))<0.01){return{val:-1,interSection:BT};}else{return{val:0,interSection:BT};}}else{var BS={X:BY.X-BV.X,Y:BY.Y-BV.Y};var BW=S(BR,BS)/S(BQ,BR);BT.X=BY.X+BW*BQ.X;BT.Y=BY.Y+BW*BQ.Y;if(Aa(BT,BY,BX,BP)&&Aa(BT,BV,BU,BP)){return{val:1,interSection:BT};}else{return{val:2,interSection:BT};}}}function AD(BX,BQ,BS){var BP=BQ;while(BP<0){BP+=360;}while(BP>=360){BP-=360;}var Ba=BX.X+BX.Width-BS.x;var BV=BS.y-BX.Y;var Bc=BS.x-BX.X;var BT=BX.Y+BX.Height-BS.y;var BY=AB(BP);var BR={x:Math.cos(BY),y:-Math.sin(BY)};var BU;var BO;if(BP>=0&&BP<90){var Bd={x:Ba,y:-BV};var BZ={x:-Bc,y:BT};BU=O(Bd,BR);BO=O(BZ,BR);}else{if(BP>=90&&BP<180){var Be={x:-Bc,y:-BV};var Bb={x:Ba,y:BT};BU=O(Be,BR);BO=O(Bb,BR);}else{if(BP>=180&&BP<270){var Bd={x:Ba,y:-BV};var BZ={x:-Bc,y:BT};BU=O(BZ,BR);BO=O(Bd,BR);}else{var Be={x:-Bc,y:-BV};var Bb={x:Ba,y:BT};BU=O(Bb,BR);BO=O(Be,BR);}}}a.x=BS.x+BU*BR.x;a.y=BS.y+BU*BR.y;e.x=BS.x+BO*BR.x;e.y=BS.y+BO*BR.y;var BW=-BO/(BU-BO);if(BW<0){BW=0;}else{if(BW>1){BW=1;}}return BW;}function AB(BO){return BO*Ah/180;}function t(BO){return BO*180/Ah;}function O(BP,BO){return(BP.x*BO.x+BP.y*BO.y);}function AN(BP,BO){return(BP.X*BO.X+BP.Y*BO.Y);}function S(BP,BO){return(BP.X*BO.Y-BP.Y*BO.X);}function Ay(BQ,Bc,Ba,Bd){var Bb=Bc.Gradient;var BX="RGBA("+Math.round(Bd*Bb.StartGraphColor.R)+", "+Math.round(Bd*Bb.StartGraphColor.G)+", "+Math.round(Bd*Bb.StartGraphColor.B)+", "+Bc.Alpha/255+");";var BV="RGBA("+Math.round(Bd*Bb.EndGraphColor.R)+", "+Math.round(Bd*Bb.EndGraphColor.G)+", "+Math.round(Bd*Bb.EndGraphColor.B)+", "+Bb.EndAlpha/255+");";var BW;switch(Bb.GradientType){case Z:var BU=Bb.HorizontalOffset;if((Bb.Angle>90&&Bb.Angle<180)||Bb.Angle>270){BU=100-BU;}var BZ={x:Ba.X+Ba.Width*BU/100,y:Ba.Y+Ba.Height*Bb.VerticalOffset/100};e={x:0,y:0};a={x:0,y:0};var BY=AD(Ba,Bb.Angle,BZ);BW=BQ.createLinearGradient(e.x,e.y,a.x,a.y);BW.addColorStop(0,BV);BW.addColorStop(BY,BX);BW.addColorStop(1,BV);BQ.fillStyle=BW;BQ.fill();break;case I:var BZ={x:Ba.X+Ba.Width*Bb.HorizontalOffset/100,y:Ba.Y+Ba.Height*Bb.VerticalOffset/100};var BT=Ba.Width*1/Ba.Height;BZ.y*=BT;BW=BQ.createRadialGradient(BZ.x,BZ.y,0,BZ.x,BZ.y,Ba.Width*2);BW.addColorStop(0,BX);BW.addColorStop(0.5,BV);BW.addColorStop(1,BV);BQ.fillStyle=BW;BQ.save();BQ.scale(1,1/BT);BQ.fill();BQ.restore();break;case AK:var BZ={x:Ba.X+Ba.Width*Bb.HorizontalOffset/100,y:Ba.Y+Ba.Height*Bb.VerticalOffset/100};var BS=Bb.Angle%90;var BP=t(Math.atan(Ba.Height/Ba.Width));var BO=2*BS-BP*BS/45+90+BP;e={x:0,y:0};a={x:0,y:0};var BY=AD(Ba,BO,BZ);var BR=BQ.createLinearGradient(e.x,e.y,a.x,a.y);BX="RGBA("+Math.round(Bd*Bb.StartGraphColor.R)+", "+Math.round(Bd*Bb.StartGraphColor.G)+", "+Math.round(Bd*Bb.StartGraphColor.B)+", "+Bc.Alpha/(255*2-Bc.Alpha)+");";BV="RGBA("+Math.round(Bd*Bb.EndGraphColor.R)+", "+Math.round(Bd*Bb.EndGraphColor.G)+", "+Math.round(Bd*Bb.EndGraphColor.B)+", "+Bb.EndAlpha/(255*2-Bb.EndAlpha)+");";BR.addColorStop(0,BV);BR.addColorStop(BY,BX);BR.addColorStop(1,BV);BQ.fillStyle=BR;BQ.fill();BO=BP*BS/45+90-BP;BY=AD(Ba,BO,BZ);BW=BQ.createLinearGradient(e.x,e.y,a.x,a.y);BX="RGBA("+Math.round(Bd*Bb.StartGraphColor.R)+", "+Math.round(Bd*Bb.StartGraphColor.G)+", "+Math.round(Bd*Bb.StartGraphColor.B)+", "+Bc.Alpha/(255*2)+");";BV="RGBA("+Math.round(Bd*Bb.EndGraphColor.R)+", "+Math.round(Bd*Bb.EndGraphColor.G)+", "+Math.round(Bd*Bb.EndGraphColor.B)+", "+Bb.EndAlpha/(255*2)+");";BW.addColorStop(0,BV);BW.addColorStop(BY,BX);BW.addColorStop(1,BV);BQ.fillStyle=BW;BQ.fill();break;}}function Ap(BO,BQ){var BP=BQ.Alpha/255;BO.fillStyle="rgba(255,255,255,"+BQ.Alpha/255+")";BO.fill();}function AL(BP){var BO=BP.canvas;BP.clearRect(0,0,BO.width,BO.height);}function Am(BO){Au=(new Date()).getTime();L(BO);}function L(BX){var BW=BX.graphData,BY=BW.UnitList,BZ=BY.length,BR=BW.FormatList,Bc=BX.graphNode,BU=BX.highlightNode,BS=BU.getContext("2d"),Bb=BX.selectionNode,BT=Bb.getContext("2d"),BQ=Bc.getContext("2d");AL(BQ);AL(BS);AL(BT);var Bd=Math.min(((new Date()).getTime()-Au)/AF,1),Ba=(1-Bd),BV;var BO=0.3*Bd*Ba*Ba+2.7*Ba*Bd*Bd+Bd*Bd*Bd;var BP=0;for(BV=0;BV<BZ;BV++){As(BQ,BO,BY[BV],BR);if(BY[BV].IsAnimated!==0){BP=1;}}if(Bd<1&&BP===1){setTimeout(function(){L(BX);},20);}}mstrmojo.graph._CanvasGraph=mstrmojo.provide("mstrmojo.graph._CanvasGraph",{markupString:'<div class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><canvas id="{@id}" height="{@height}" width="{@width}">{@unsupportedError}</canvas>{@map}<canvas id="{@id}-highlight" class="mobile-graph-selection-canvas" height="{@height}" width="{@width}" style="position:absolute;top:0;left:0"></canvas><canvas id="{@id}-highlight" class="'+mstrmojo.GraphBase.canvasCLS+'" height="{@height}" width="{@width}" style="position:relative;top:0;left:0"></canvas></div>',unsupportedError:"This text is displayed if your browser does not support HTML5 Canvas element.",markupSlots:{graphNode:function(){return this.domNode.childNodes[1];},imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return null;},textNode:function(){return this.domNode.firstChild;},selectionNode:function(){return this.domNode.lastChild.previousSibling;},highlightNode:function(){return this.domNode.lastChild;}},graphData:null,retrieveGraphSrc:function BG(BR,BV){var BT=this.graphNode,BW=this.highlightNode,BS=this.selectionNode,BU=this.graphData,BQ=(BU&&BU.data);if(BQ&&BQ.eg){var BX=this.textNode,BP=this.imgNode;BP.style.display="none";BW.style.display="none";BS.style.display="none";BX.innerHTML=BQ.eg||"";BX.style.display="block";BX.className="mstrmojo-message";}else{var BY=BU.GH||parseInt(BR,10),BO=BU.GW||parseInt(BV,10);BT.setAttribute("height",BY);BT.setAttribute("width",BO);BW.style.display="block";BW.setAttribute("height",BY);BW.setAttribute("width",BO);BW.style.top=-BY+"px";BS.style.display="block";BS.setAttribute("height",BY);BS.setAttribute("width",BO);this.displayTooltips([],0,0);Am(this);if(BU.Selected){this.highlightAreaInInit(BS,BU.Selected);}}},unrender:function AT(BO){this._super(false);},invalidate:function K(){var BO=this.graphNode;if(BO){AL(BO.getContext("2d"));}},getCaptureDimensions:function Ad(){var BP=this.graphNode,BO=mstrmojo.dom.position(this.domNode,true);BO.w=BP.width;BO.h=BP.height;return BO;}});}());(function(){mstrmojo.requiresCls("mstrmojo.GraphBase","mstrmojo._TouchGestures","mstrmojo.graph._MobileGraphAreaHelper");mstrmojo.MobileGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._TouchGestures,mstrmojo.graph._MobileGraphAreaHelper],{scriptClass:"mstrmojo.MobileGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" {@extra}/>',cssImageClass:"mstrmojo-ReportGraph",setDimensions:function I(M,L){if(this.height===M&&this.width===L){return ;}this.height=M;this.width=L;if(this.hasRendered){this.controller.refresh(this);}},preBuildRendering:function J(){var L=this.graphData.gd.g;this.as=L&&L.as;return this._super?this._super():true;},refresh:function F(){this.graphData=this.model.data;this._super();},retrieveGraphSrc:function E(M,L){var O="data:image/png;base64,"+this.graphData.ib.eb,N=this.imgNode;if(N.src!==O){N.src=O;}},getFormats:function G(){return{height:this.height,width:this.width,top:0,left:0};},touchTap:function B(){this.displayTooltips([],0,0);var L=this.controller;if(L&&L.viewTap){L.viewTap();}},touchSelectBegin:function D(L){this.syncTooltips(L.pageX,L.pageY);},touchSelectMove:function H(L){this.syncTooltips(L.pageX,L.pageY);},setModel:function K(L){this._super(L);this.setGraphData(L.data);},syncTooltips:function C(L,O){var M=this,N=mstrmojo.dom.position(M.domNode,true);L-=N.x;O-=N.y;M.model.getDataService().handleUserSingleTap(-1,"",L,O,false,{success:function(P){M.displayTooltips(P.Areas,N.x,N.y);}});},setGraphData:function A(L){this.graphData=L;this.controller.getPageByTree(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricQualification","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var a=mstrmojo.dom,R=mstrmojo.hash,S=mstrmojo.MCSUtil,K=mstrmojo.desc,d=mstrmojo.css,e=mstrmojo.num,U=Math,E=U.max,C=U.min,B=U.floor,H=U.round;function M(l,z,AD,AA){var AG="px",q=l._length,AE=l.handleSize,p=l.orCfg,t=p.posCssP,o=p.lenCssP;AD=E(AD,-1);AA=C(AA,q);var s=C(AD,AA),x=E(AD,AA),AC=x-s,AF=E(parseInt(l[o],10)-(2*l.cssBkBW)-(x+AE),0);if(l.hasRendered){z.handle1Node.style[t]=AD+AG;z.handle2Node.style[t]=AA+AG;var w=z.lowerRange.style,AB=z.thumbNode.style,k=z.upperRange.style;w[t]=0;AB[t]=(s+AE)+AG;k[t]=(x+AE)+AG;w[o]=E(s,0)+AG;AB[o]=AC+AG;k[o]=AF+AG;}else{AG+=";";t+=":";o+=":";l.handle1CssText=t+AD+AG;l.handel2CssText=t+AA+AG;l.lowerRangeCssText=o+E(s,0)+AG;l.thumbCssText=t+(s+AE)+AG+o+AC+AG;l.upperRangeCssText=t+(x+AE)+AG+o+AF+AG;}return{handle1:AD,handle2:AA};}function Y(k){this.getUnit=function(){return k._length/E((k.items.length-1),1);};this.calcMinMax=function(p,o){var q=k.unit;return{min:B(p/q+0.5),max:B(o/q+0.5)};};this.calcPxIdx=function(o){return B(o/k.unit+0.5);};this.getStep=function(){var p=k.high-k.low,o=parseInt(k.numFmts.cat,10),q=(o===4)?2:(o===5)?4:0;p=(p===0)?1:p;if(p>1){return(p>(k._length-2))?Number(Number(p/(k._length-2)).toFixed(k.numFmts.dp+q)):1;}return p/(k._length-2);};this.getIdx=function(o){return C(E(H((o-k.low)/k.step),0),k.items.length-1);};this.initialMetricSlider=function l(){var t=function(AI){return AI!==undefined&&AI!==null;},q=function(AI){return(t(AI.da)&&t(AI.da.low)&&t(AI.da.high)&&t(AI.da.cnt)&&t(AI.f)&&t(AI.ft)&&t(AI.qua));},p=function(AI){var AK=true,AJ=true;if(AI.ft==S._GENERIC){AK=AI.f!=S.FN.ISNULL&&AI.f!=S.FN.ISNOTNULL&&AI.f!=S.FN.NOTIN&&AI.f!=S.FN.IN;}else{if(AI.ft==S._PERCENT||AI.ft==S._RANK){AJ=AI.f!=S.MRPFN.INASCENDING&&AI.f!=S.MRPFN.INDESCENDING&&AI.f!=S.MRPFN.NOTINDESCENDING&&AI.f!=S.MRPFN.NOTINASCENDING;}}return !AK||!AJ;},AF=0;k.include=k.parent.include;k.clsType="scm ";k.staticStatus=!(t(k.da)&&t(k.da.low)&&t(k.da.high)&&t(k.da.cnt)&&t(k.qua));if(k.staticStatus){k.da.low=1;k.da.high=7;k.ft=S._GENERIC;k.f=S.FN.BETWEEN;k.qua=S.Q._G;k.cs=[{n:"",v:1},{n:"",v:7}];k.numFmts={cat:9,dp:0,fm:""};}switch(k.qua){case 0:var AE=k.numFmts.cat;AF=AE==4?2:AE==5?4:0;k.low=Number(Number(k.da.low).toFixed(k.numFmts.dp+AF));k.high=Number(Number(k.da.high).toFixed(k.numFmts.dp+AF));break;case 1:case 2:k.low=1;k.high=k.da.cnt;break;case 3:case 4:k.low=0;k.high=100;break;}var AH=!k.staticStatus&&!k.da.nov&&k.dt!=30;k.set("lowText",AH?S.formatNumber(k.qua,k.low,k.numFmts):"");k.set("highText",AH?S.formatNumber(k.qua,k.high,k.numFmts):"");k.step=(k.qua==1||k.qua==2)?1:this.getStep();k.low-=k.step;k.high+=k.step;k.cs1Vl=k.low;k.cs2Vl=k.high;var s=k.low,AB=k.high,AG=[],AD=0;if(t(s)&&t(AB)&&k.dt!=30){for(var AA=0,x=s;x<=AB;AA++,x+=k.step){AG[AA]={n:S.formatNumber(k.qua,x,k.numFmts),v:Number(Number(x).toFixed(k.numFmts.dp+AF))};}AD=AG.length;if(AD>0&&AG[AD-1].v!=AB){AG[AD-1]={n:S.formatNumber(k.qua,AB,k.numFmts),v:AB};}}AD=AG.length;if(AD>=2){AG[0].n=AG[AD-1].n=K(7622);}k.items=AG;var o=S.OP,AC=k.cs,z=(AC&&AC.length>0)?e.parseNumeric(String(AC[0].v).replace("%","")):s,w=(AC&&AC.length>1)?e.parseNumeric(String(AC[1].v).replace("%","")):AB;if(z<k.low){k.frtUst=true;}if(w>k.high){k.ndUst=true;}k.opId=(k.f!=null&&k.ft!=null)?S.getOpIdxByfunc(k.f,k.ft):o._BETWEEN;switch(k.opId){case o._EQUALS:case o._NOT_EQUALS:k.cs1Vl=k.cs2Vl=z;break;case o._LESS_EQUAL:case o._GREATER:k.cs1Vl=s;k.cs2Vl=z;break;case o._GREATER_EQUAL:case o._LESS:k.cs1Vl=z;k.cs2Vl=AB;break;case o._IN:case o._NOT_IN:case o._IS_NULL:case o._IS_NOT_NULL:break;default:k.cs1Vl=z;k.cs2Vl=w;break;}k.cs1Idx=this.getIdx(k.cs1Vl);k.cs2Idx=this.getIdx(k.cs2Vl);if(k.dt!=30){k.cs1Nm=t(k.cs1Vl)?S.formatNumber(k.qua,k.cs1Vl,k.numFmts):k.items[k.cs1Idx].n;k.cs2Nm=t(k.cs2Vl)?S.formatNumber(k.qua,k.cs2Vl,k.numFmts):k.items[k.cs2Idx].n;}k.unit=this.getUnit();k.set("unSet",(k.dt==30||!q(k)||p(k)||(!k.cs||k.cs.length==0))&&!k.staticStatus);};this.updateOpCs=function(){var s=(k.cs1Vl>k.cs2Vl)?k.cs2Vl:k.cs1Vl,z=(k.cs1Vl>k.cs2Vl)?k.cs1Vl:k.cs2Vl,q=k.low,t=k.high,x=k.include,o=S.OP,p=(k.qua==S.Q._PT||k.qua==S.Q._PB),AA,w=[];if((s>=q&&z<=t)||s<q||z>t){k.opId=(x)?o._BETWEEN:o._NOT_BETWEEN;}if(s==z){k.opId=(x)?o._EQUALS:o._NOT_EQUALS;}if(s==q&&z<t){k.opId=(x)?o._LESS_EQUAL:o._GREATER;}if(s>q&&z==t){k.opId=(x)?o._GREATER_EQUAL:o._LESS;}AA=q==s&&z==t;if(!AA){switch(k.opId){case o._BETWEEN:case o._NOT_BETWEEN:w.push({dtp:5,v:e.toLocaleString(s)+(p?"%":"")});case o._EQUALS:case o._NOT_EQUALS:w.push({dtp:5,v:e.toLocaleString(z)+(p?"%":"")});break;default:if(s>q){w.push({dtp:5,v:e.toLocaleString(s)+(p?"%":"")});}if(z<t){w.push({dtp:5,v:e.toLocaleString(z)+(p?"%":"")});}}}k.cs=w;k.parent.node.data.cs=w;k.set("unSet",AA);};this.updateThumb=function(){var o=k.cs1Idx,s=k.cs2Idx;if(o!==undefined&&s!==undefined){var p=k.unit,q=k.gap;R.copy(M(k,k,H(o*p-q),H(s*p-q)),k);}};this.joinConst=function(){var q=k.cs;if(q){var o=[],p;for(p in q){o.push(q[p].v);}return o.join(",");}};}var g="<span {@ttpCssText}>{@content}</span>";function Z(){if(this.staticStatus){return null;}var p=this.ghost;if(!p){var t=this.containerNode.cloneNode(true),s=t.childNodes;d.addClass(t,["gh"]);p=this.ghost={containerNode:t,lowerRange:s[0],handle1Node:s[1],thumbNode:s[2],handle2Node:s[3],upperRange:s[4]};this.sdcNode.appendChild(t);}var l=this.orCfg,k=l.posCssP,o=l.lenCssP,q=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(AB,w){var AA=mstrmojo.all[q],z=AA[AB].style,x=p[AB].style;if(w){x[k]=z[k];}x[o]=z[o];});p.containerNode.style.display="block";return p;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style="position:absolute;"><div class="bk" style="margin-top: 2px;{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:5px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:5px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},bgNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[3];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);},onunSetChange:function(){d.toggleClass(this.domNode.childNodes[1],"invalid",this.unSet);}},init:function X(k){this._super(k);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new Y(this);this.useRichTooltip=false;},unSet:false,preBuildRendering:function D(){var p=this.orCfg,o=this.isHoriz;p.cPosCssP=(o)?"right":"bottom";p.cLenCssP=(o)?"height":"width";var t=p.lenCssP,s=this[t],q=parseInt(s,10),l=this.handleSize;var k=this._length=(isNaN(q))?0:(q-l);if(k<=0){k=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-l;}if(s){this.bkCssText=t+":"+E(q-(2*this.cssBkBW),0)+"px;";this.sdcCssText=p.posCssP+":0px;"+t+":"+k+"px;"+p.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function b(){this._super();if(!this.staticStatus&&!this.da.nov){var l=this.lowNode,k=parseInt(l.style.fontSize,10);l.style.fontSize=this.highNode.style.fontSize=H((isNaN(k)?8:k)*this.parent.model.zf)+"pt";this.updateSummary();}},onmouseover:function J(k){this.showTooltip(k.e,self);},onmouseout:function G(k){this.hideTooltip(k.e,self);},summaryLabels:{db:K(8153,"Between ## and ###"),dnb:K(8154,"Not between ## and ###"),din:K(587,"In"),dnin:K(2204,"Not in"),dnull:K(2202,"Is Null"),dnnull:K(2203,"Is not Null"),req:K(8155,"Rank ="),rneq:K(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:K(8157,"Rank exclude bottom"),rext:K(8158,"Rank exclude top"),rb:K(8159,"Rank bottom"),rt:K(8160,"Rank top"),rbt:K(8161,"Rank between ## and ###"),rnbt:K(8162,"Rank not between ## and ###"),rin:K(8163,"Rank in"),rnin:K(8164,"Rank not in"),peq:K(8165,"Percent ="),pneq:K(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:K(8167,"Exclude bottom"),pext:K(8168,"Exclude top"),pb:K(7576,"Bottom"),pt:K(7575,"Top"),pbt:K(8153,"Between ## and ###"),pnbt:K(8154,"Not between ## and ###"),pin:K(8169,"Percent in"),pnin:K(8170,"Percent not in")},updateSummary:function A(){if(this.summaryNode&&!this.staticStatus){var AB=this.f,AA=this.ft,x=S,p=S.FN,o=S.MRPFN,z="",AD=(this.cs1Vl<this.cs2Vl)?this.cs1Nm:this.cs2Nm,AC=(this.cs1Vl>this.cs2Vl)?this.cs1Nm:this.cs2Nm,l=this.typeHelper,AE=this.summaryLabels,w=(AA==x._GENERIC&&(AB==p.ISNULL||AB==p.ISNOTNULL||AB==p.NOTIN||AB==p.IN))||((AA==x._PERCENT||AA==x._RANK)&&(AB==o.INASCENDING||AB==o.INDESCENDING||AB==o.NOTINDESCENDING||AB==o.NOTINASCENDING));if(!this.unSet||w){switch(AA){case x._GENERIC:switch(AB){case p.EQUALS:z="= "+AD;break;case p.NOTEQUALS:z=String.fromCharCode(8800)+" "+AD;break;case p.GREATERTHAN:z="> "+AC;break;case p.GREATERTHANEQUALS:z=String.fromCharCode(8805)+" "+AD;break;case p.LESSTHAN:z="< "+AD;break;case p.LESSTHANEQUALS:z=String.fromCharCode(8804)+" "+AC;break;case p.BETWEEN:z=AE.db.replace("##",AD).replace("###",AC);break;case p.NOTBETWEEN:z=AE.dnb.replace("##",AD).replace("###",AC);break;case p.ISNULL:z=AE.dnull;break;case p.ISNOTNULL:z=AE.dnnull;break;case p.IN:z=AE.din+" "+l.joinConst();break;case p.NOTIN:z=AE.dnin+" "+l.joinConst();break;}break;case x._PERCENT:case x._RANK:var k="r";if(AA==x._PERCENT){k="p";}switch(AB){case o.EQUALSDESCENDING:case o.EQUALSASCENDING:z=AE[k+"eq"]+" "+AD;break;case o.NOTEQUALSDESCENDING:case o.NOTEQUALSASCENDING:z=AE[k+"neq"]+" "+AD;break;case o.GREATERTHANEQUALSASCENDING:z=AE[k+"exb"]+" "+AD;break;case o.GREATERTHANASCENDING:z=AE[k+"exb"]+" "+AC;break;case o.GREATERTHANEQUALSDESCENDING:z=AE[k+"ext"]+" "+AD;break;case o.GREATERTHANDESCENDING:z=AE[k+"ext"]+" "+AC;break;case o.LESSTHANASCENDING:z=AE[k+"b"]+" "+AD;break;case o.LESSTHANEQUALSASCENDING:z=AE[k+"b"]+" "+AC;break;case o.LESSTHANDESCENDING:z=AE[k+"t"]+" "+AD;break;case o.LESSTHANEQUALSDESCENDING:z=AE[k+"t"]+" "+AC;break;case o.BETWEENDESCENDING:case o.BETWEENASCENDING:z=AE[k+"bt"].replace("##",AD).replace("###",AC);break;case o.NOTBETWEENASCENDING:case o.NOTBETWEENDESCENDING:z=AE[k+"nbt"].replace("##",AD).replace("###",AC);break;case o.INASCENDING:case o.INDESCENDING:z=AE[k+"in"]+" "+l.joinConst();break;case o.NOTINDESCENDING:case o.NOTINASCENDING:z="";z=AE[k+"nin"]+" "+l.joinConst();break;}break;}}var q=this.summaryNode,t=(z!=="")?"":0;q.innerHTML=z;q.style.margin=t;if(this.hasRendered&&this.height==null){this.parent.updateHeight();}}},getClientHeight:function W(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function V(q,k){if(!this.staticStatus&&!this.da.nov){k=k||window;var s=a.eventTarget(k,this.dnd.startE);if(s===this.handle1Node||s===this.handle2Node){var p=Z.call(this),l=this.orCfg,o=this.dnd;o.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10),length:this._length,contL:p.containerNode[l.lenP],offset:a.getMousePosition(this.dnd.startE,k)[l.offsetP]};o.initD.td=s;d.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function I(w,t){if(!this.staticStatus){t=t||window;var z=this.dnd.initD;if(z){var AE=this.ghost,AF=z.handle1,p=z.handle2,s=this.cs1Idx,o=this.cs2Idx,AD=this.unit,AB=this.gap,l=z.length;var AC=a.getMousePosition(w,t)[this.orCfg.offsetP]-z.offset;switch(z.td){case this.handle1Node:AF=E(C(E(z.handle1+AC,0),l)-AB,-1);s=E(B(AF/AD+0.5),0);break;case this.handle2Node:p=E(C(E(z.handle2+AC,0),l)-AB,-1);o=E(U.ceil(p/AD+0.5),0);break;default:return ;}M(this,AE,AF,p);var x=this.items,k=(x&&x.length)||0;if(k&&s>=0&&s<k&&o>=0&&o<k){var q=false;if(s!==this.cs1Idx){this.cs1Idx=s;var AA=this.items[s];this.cs1Vl=AA.v;this.cs1Nm=AA.n;q=true;}if(o!==this.cs2Idx){this.cs2Idx=o;var AA=this.items[o];this.cs2Vl=AA.v;this.cs2Nm=AA.n;q=true;}if(q){this.typeHelper.updateThumb();this._updateTooltip(z.td);}}}}},ondrop:function f(l){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var k=this.ghost;if(k){k.containerNode.style.display="none";}this.hideTooltip(l,self);if(this.items&&this.items.length){this[(a.eventTarget(self,l)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function O(k,z,AA){var p=this.typeHelper,t=this.cs1Vl,s=this.cs2Vl,l=this.qua,o=this.numFmts;this.cs1Idx=p.getIdx(t);this.cs2Idx=p.getIdx(s);var x=function(q,AC){var AB=AC||[];return q==0||q==AB.length-1;},w=K(7622);this.cs1Nm=x(this.cs1Idx,this.items)&&!this.frtUst?w:S.formatNumber(l,t,o);this.cs2Nm=x(this.cs2Idx,this.items)&&!this.ndUst?w:S.formatNumber(l,s,o);p.updateOpCs();this.onlyInclude=!!k;this.changeQual=!!z;this.unSet=!!AA||this.unSet;this.updateSummary();this.onselectionChange();},onincludeChange:function N(){if(!this.staticStatus){this.selectRange(true);}},showTooltip:function F(l,k){var o=a.eventTarget(k,l);this._updateTooltip(o);mstrmojo.tooltip.open(this,l,k);},_updateTooltip:function T(q){var l=this.orCfg,p=l.posCssP,k,o={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};o[l.opPosCssP]=-parseInt(this.font)/2;o[p]=q.style[p];if(this.unSet){k=K(7622);}else{k=String((q===this.handle1Node)?this.cs1Nm:this.cs2Nm);}o.content=g.replace(/\{@content\}/g,k);this.set("richTooltip",o);},onclick:function j(k){if(!this.staticStatus&&!this.da.nov){var l=a.eventTarget(k.hWin||window,k.e);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((l===this.handle1Node)?this.handle1Node:((l===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(l===this.handle1Node),tgt:l});if(this._onThumb){this._onThumb(k);}}},onselectionChange:function Q(k){this._super(k);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function P(k){var o=mstrmojo.MCSUtil.getFuncInfo(this.opId,k.valueWas),p=mstrmojo.MCSUtil.getFuncInfo(this.opId,k.value),l;if(o.ft!=p.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();l=true;}}else{this.f=mstrmojo.MCSUtil.getFuncInfo(this.opId,k.value).f;l=false;}this.selectRange(false,true,l);},updateData:function h(k,l){this.da=k;this.updateExpr(l);},updateExpr:function L(k){if(k){this.cs=k.cs;this.f=k.f;this.ft=k.ft;this.qua=k.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",C(E(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var o=this.opener,l=this.children[0];if(o){var k=this.isfrt?o.cs1Vl:o.cs2Vl;if(this.isfrt){if((o.cs1Vl<=o.low||o.cs1Vl>=o.high)&&!o.frtUst){k="";}}else{if((o.cs2Vl<=o.low||o.cs2Vl>=o.high)&&!o.ndUst){k="";}}l.edt.set("value",e.toLocaleString(k));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!=0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(l){if(this.parent.apply.enabled){var k=l.hWin,o=l.e||k.event;if(o.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var l=this.parent.parent,o=l.opener,k=this.parent.edt.value;if(l&&o&&String(k).length>0){o[l.isfrt?"cs1Nm":"cs2Nm"]=k;k=e.parseNumeric(k);o[l.isfrt?"cs1Vl":"cs2Vl"]=k;}o[l.isfrt?"frtUst":"ndUst"]=true;o.selectRange();o.typeHelper.updateThumb();l.close();}}]}]},openEditValue:function(k){this.openPopup("editValueRef",k);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TextInput","mstrmojo.ValidationTextBox","mstrmojo.hash");mstrmojo.android.ui.ValidationTextInput=mstrmojo.declare(mstrmojo.android.ui.TextInput,null,{scriptClass:"mstrmojo.android.ui.ValidationTextInput",valProps:null,getTextCfg:function A(){return mstrmojo.hash.copy(this.valProps,{scriptClass:"mstrmojo.ValidationTextBox",onEnter:function(){var D=this.parent,E=D.onEnter;if(E){if(this.isValid()){E.call(D,this.value);}}},onvalidationStatusChange:function(){var D=this.validationStatus,E=D&&D.code,F=this.parent.lblErr,G=E?D.msg:"";F.set("text",G);F.set("visible",!!G);}});},validate:function C(){return this.txt.validate();},isValid:function B(){return this.txt.isValid();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.dom","mstrmojo.css");var C=mstrmojo.dom,O=mstrmojo.css,D=5,I=6,P=1,G=7,L=30;function A(T){if(T.style){var S=mstrmojo.css.getStyleValue(T,C.CSS3_TRANSFORM);if(S!=="none"){T.style[C.CSS3_TRANSFORM]=S;}}}function H(U){var T,S=U.childNodes.length;for(T=0;T<S;T++){var V=U.childNodes[T];H(V);A(V);}}mstrmojo.android.inputControls.TextAreaDIC=mstrmojo.declare(mstrmojo.TextArea,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.TextAreaDIC",cssDisplay:"block",init:function M(S){this._super(S);this.maxLength=this.dic.ml;if(!this.showByDefault){this.cssClass="mstrmojo-TextAreaDIC-Popup";this.rows=7;}},focus:function K(){C.setCaret(this.domNode,(this.value!=null&&String(this.value).length)||0);},onfocus:function R(){window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},onvalueChange:function J(){if(!this.showByDefault){this._super();}},onblur:function B(){if(this.showByDefault){this.applyChanges();}},applyChanges:function E(){this.domNode.blur();var S=parseInt(this.dic.dt,10);if((S>=P&&S<=G)||S===L){this.value=parseFloat(this.value);}this._super();},cancelChanges:function F(){this.domNode.blur();this._super();},postBuildRendering:function Q(){this._super();if(this.showByDefault){this.domNode.style.width="100%";this.domNode.style.height="100%";if(!mstrApp.isTablet()){C.attachEvent(this.domNode,"click",function(){H(document.body);},false);}var S=this;C.attachEvent(this.domNode,"blur",function(){var T=S.domNode;while(T!=null){if(T.scrollTop>0){T.scrollTop=0;break;}T=T.parentNode;}},false);}},renderPreview:function N(){var W=this.dic,S=this.value,U=(this.dv==null)?"":String(this.dv),V="",T=/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i;if(!U||!W.sp){this.dv=W.siwc?"&nbsp;":(U||"&nbsp;");}else{S=(S.length>W.pl)?(S.substring(0,W.pl)+"&hellip;"):S;switch(this.ts){case I:V="mailto:";case D:if(!U){U='<a href="mailto:"></a>';}U=U.replace(T,"$1"+V+this.value.replace(/\$/g,"$$$$")+"$3"+S.replace(/\$/g,"$$$$")+"$5");break;default:U=(U.length>W.pl)?(U.substring(0,W.pl)+"&hellip;"):U;}this.dv=U;}this.renderPreviewButton(this.openerNode,this.dv);O.toggleClass(this.openerNode.firstChild,"filled",!this.dicChanged&&this.value!=null&&String(this.value).length>0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo._IsInputControl","mstrmojo.dom","mstrmojo.num");var J=mstrmojo.validation,C=J.STATUSCODE,F=J.VALIDATOR,D=mstrmojo.expr.DTP,B=0,A=1,I=2,H=3,G=4,E=5;mstrmojo.TextFieldDIC=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",dtp:D.VARCHAR,validationDelay:0,getInputNode:function(){return this.inputNode;},focus:function(){this.validate();mstrmojo.dom.setCaret(this.domNode,(this.value&&this.value.length||0));},init:function(K){if(this._super){this._super(K);}this.constraints=mstrmojo.hash.copy();var M=K.dic,N=this.constraints={trigger:mstrmojo.validation.TRIGGER.ONKEYUP},L=M.dt;if(M.ml){this.maxLength=M.ml;}if(M.psw){this.type="password";this.value=this.lv="";this.owner.applyPasswordMask&&this.owner.applyPasswordMask();}if(J.isNumeric(L)||J.isInt(L)||J.isString(L)){this.dtp=L;}switch(M.vm){case A:N.validator=F.VALIDATE_PHONENO;break;case I:N.validator=F.VALIDATE_EMAIL;break;case H:N.validator=F.VALIDATE_ZIPCODE;break;case G:N.validator=F.VALIDATE_SSN;break;case E:N.regExp=new RegExp("^"+M.rgx+"$");break;}N.min=M.emin?M.min:null;N.max=M.emax?M.max:null;N.maxLen=(M.ml!==undefined)?M.ml:null;N.minLen=(M.mnl!==undefined)?M.mnl:null;if(M.req||M.emin){this.required=true;}},onInvalid:function(){if(this.popup){this.popup.set("hasInvalidData",true);}},onValid:function(){if(this.popup){this.popup.set("hasInvalidData",false);}},applyChanges:function(){this.validate();if(this.isValid()){this._super();}else{this.handleInvalid();return false;}return true;},handleInvalid:function(){if(mstrmojo.all.mojoConfirmx9){return ;}var K=this;mstrmojo.confirm(this.validationStatus.msg+"<br>("+mstrmojo.desc(9199)+")",[{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1442),onclick:function(){K.focus();}},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(221),onclick:function(){K.popup.onCancel();}}],mstrmojo.desc(7548));},cancelChanges:function(){this.inputNode.blur();this.value=this.lv;this.clearValidation();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.android.ui.Label","mstrmojo.android.ui.Menu","mstrmojo.android.ui.SearchBox","mstrmojo.android.ui.Image","mstrmojo.mstr.WebElements","mstrmojo.dom","mstrmojo.css");mstrmojo.requiresDescs(10,9462,9463);var D=mstrmojo.dom,F=mstrmojo.css,E=D.CSS3_TRANSITION_END;var B=[{n:mstrmojo.desc(9462,"View All"),idx:1,v:true},{n:mstrmojo.desc(9463,"View Selected"),idx:0,v:false}];function C(){if(this.searchRequired){if(!this.target.getSelectedItems().length){return false;}}return true;}function A(){var S=this.lbl,V=S.domNode,L=V.style,N=this.searchNode.style,M=this.search.box,K=M.inputNode,T=K.style,Q=this.target,R="visible";var P=this._isSearch=!!S.visible;if(P){Q.enterSearchMode();var O=F.getComputedStyle(M.inputNode),J=this.domNode.offsetWidth-(2*parseInt(O.marginRight,10))-parseInt(O.paddingLeft,10)-parseInt(O.paddingRight,10)-this.search.slot0.offsetWidth,U=this.browseElements;D.attachOneTimeEvent(V,E,function(){S.set(R,false);N.width="100%";M.set("hint",(U&&U.source.n)||mstrmojo.desc(10,"Search"));M.set(R,true);window.setTimeout(function(){T.width=J+"px";},0);});L.opacity=0;}else{if(!C.call(this)){return ;}Q.exitSearchMode(!this.searchRequired);D.attachOneTimeEvent(K,E,function(){M.set(R,false);M.set("value","");N.width="";S.set(R,true);window.setTimeout(function(){L.opacity=1;},0);});M.inputNode.style.width=0;}}mstrmojo.android.ui.ElementsSearchBar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.android.ui.ElementsSearchBar",markupString:'<div id="{@id}" class="mstrmojo-ElementSearchBar {@cssClass}" style="{@cssText}" ><div><div class="mstrmojo-ElementSearchBar-switch"></div><div class="mstrmojo-ElementSearchBar-search"></div></div></div>',markupSlots:{switchNode:function(){return this.domNode.firstChild.firstChild;},searchNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{oncanSearchChange:function(){this.search.btn.set("visible",!!this.canSearch);}},target:null,browseElements:null,searchRequired:false,children:[{scriptClass:"mstrmojo.android.ui.Menu",slot:"switchNode",alias:"menu",visible:false,items:[B[1]],postselectionChange:function(J){var L=J.added,M=L&&this.items[L[0]];if(M){var K=this.parent;K.lbl.set("text",M.n);this.set("visible",false);this.set("items",[B[M.idx]]);K.target.set("viewAll",M.v);}}},{scriptClass:"mstrmojo.HBox",alias:"search",slot:"searchNode",children:[{scriptClass:"mstrmojo.android.ui.Image",alias:"btn",touchTap:function(){A.call(this.parent.parent);}},{scriptClass:"mstrmojo.android.ui.SearchBox",alias:"box",hint:mstrmojo.desc(10,"Search"),cssDisplay:"block",cssText:"width:0;",visible:false,searchFunc:function(M){if(M){var O=this.parent.parent,L=O.browseElements,K=(L&&L.duplicate())||new mstrmojo.mstr.WebElements(),J=K.browseConfig||{},N=this.id;J.searchPattern=M;J.blockBegin=1;J.searchForms=this.searchForms;if(O.searchTarget){J.searchTarget=O.searchTarget;delete O.searchTarget;}K.browseConfig=J;K.getItems(0,{success:function(){mstrmojo.all[N].set("searchResult",K);}});}else{this.clearSearch();}},clearFunc:function(){this.parent.parent.target.clearSearch();},onsearchResultChange:function(){this.parent.parent.target.search(this.searchResult);}}]}],init:function H(J){this._super(J);var K={scriptClass:"mstrmojo.android.ui.Label",slot:"switchNode",alias:"lbl"};if(J.searchRequired){K.text=J.title;K.cssClass="mstrmojo-no-Image";}else{K.text=mstrmojo.desc(9462,"View All");K.touchTap=function(){var M=this.parent.menu,L=!M.visible;if(L){M.set("width",this.domNode.offsetWidth+"px");}M.set("visible",L);};}this.addChildren(K);},onRender:function I(){var J=this.initSearchValue,K=this.id;if(J||this.searchRequired){delete this.initSearchValue;window.setTimeout(function(){var M=mstrmojo.all[K];A.call(M);var L=M.search.box;L.set("value",J||"");if(J){L.onEnter();}},0);}return this._super();},goBack:function G(){if(this._isSearch){if(C.call(this)){A.call(this);return true;}}return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ServerProxy","mstrmojo.android.ui.Button","mstrmojo.Box","mstrmojo.TextBoxWithLabel","mstrmojo.Label","mstrmojo.hash","mstrmojo.mstr.EnumWebAPIErrorCodes");mstrmojo.requiresDescs(11,17,18,26,7904,5088,9935,10672);var D="mobileLogin",Z="changePassword",a=mstrmojo.android.ui.Button.newButton,N=mstrmojo.desc,W=mstrmojo.hash,h=mstrmojo.mstr.EnumWebAPIErrorCodes,C={},d={},A={ANDROID_PHONE:3,ANDROID_TAB:4},H={OLD_PASSWORD:0,NEW_PASSWORD:1,CONFIRM_NEW_PASSWORD:2},P={};function V(p){var o=this,j=p.pid,l=p.params.projectID,q=p.id,k=C[j],l=p.params.projectID,s={taskId:"getProjectSettings"};if(k){s.sessionState=k;}else{s.projectID=l;}mstrApp.serverRequest(s,{success:function(t){P[j]=true;o.transport.serverRequest(o.id,q,p);},failure:function(t){var w=p.callback;if(w.failure!==undefined){w.failure(t);}w.complete(q);}},{skipLogin:true,doNotHold:true});}function M(p){var l=String(mstrMobileApp.getLocaleInfo());if(l){var o=l.split(",");for(var k=0;k<o.length;k++){var j=o[k].split(":");p[j[0]]=j[1];}}return p;}function g(s,j){var p,l=[],o={id:"new_pwd_reqd",title:N(5088),cssClass:"mstrmojo-CredentialsDialog",loginInfo:s.loginInfo},k=s.loginInfo,q=function(t,w){return function(){w(t);};}(s,j);l.push({scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-PasswordDialog-Label",text:"You must supply a new password."});o.children=l;o.buttons=[a(N(221,"Cancel"),function(){p.manualClose=true;mstrApp.cancelPending();}),a(N(1442,"OK"),q,{enabled:true})];p=mstrApp.showDialog(o);}function e(t,j){var q,p,l=[],o={id:"password_prompt"+mstrmojo.now(),title:t.title,cssClass:"mstrmojo-CredentialsDialog",loginInfo:t.loginInfo},k=t.loginInfo,s=function(w,x){return function(){var AA=q.children,z=AA[0].children[0];switch(w.dlgType){case H.OLD_PASSWORD:k.pwd=z.value;break;case H.NEW_PASSWORD:k.npwd=z.value;break;}x(w);};}(t,j);p=mstrmojo.getInstance(a(N(1442,"OK"),s,{enabled:t.enableOK}));l.push({scriptClass:"mstrmojo.Box",cssDisplay:"table",children:[{scriptClass:"mstrmojo.TextBoxWithLabel",label:N(18)+":",value:"",type:"password",cssDisplay:"table-row",onvalueChange:function(){if(t.dlgType==H.CONFIRM_NEW_PASSWORD){p.set("enabled",this.value==k.npwd);}}}]});o.children=l;o.buttons=[a(N(221,"Cancel"),function(){mstrApp.cancelPending();}),p];q=mstrApp.showDialog(o);}function L(o){var j=this._mobileCfg,k=o.pid,q=j.getProject(k),p={cfg:j,projectId:k,project:q,transport:this.transport,loginInfo:j.getLoginInfo(k)},l=this;mstrApp.hideMessage();p.loginInfo.uid=o.params.userid;g(p,function(s){e(W.copy({title:"Enter your old password",dlgType:H.OLD_PASSWORD,enableOK:true},s),function(t){e(W.copy({title:"Enter your new password",dlgType:H.NEW_PASSWORD,enableOK:true},t),function(w){e(W.copy({title:"Confirm your new password",dlgType:H.CONFIRM_NEW_PASSWORD,enableOK:(w.loginInfo.npwd=="")},w),function(z){var x=function(AB){return function(AE){var AC=AB.loginInfo,AG=AC.npwd,AD=AC.uid;if(q.udc){var AF=j.getServerByProjectId(k);AF.pdc.ps=AG;AF.pdc.lo=AD;}else{q.pc.ps=AG;q.pc.lo=AD;}j.saveConfiguration();o.params.password=AG;R.call(l,o);};}(z),AA=function(AB){var AC=o.callback;if(AC.failure!==undefined){AC.failure(AB);}AC.complete(o.id);};l.request({success:x,failure:AA},{taskId:Z,server:z.project.sn,userid:z.loginInfo.uid,oldPassword:z.loginInfo.pwd,newPassword:z.loginInfo.npwd},false,{projectId:k,mobileConfig:j,doNotHold:true});});});});});}function G(t,s,q){var o,w,k=mstrmojo.getInstance,j=function(AB,x,AA,z){return k(W.copy(z,{scriptClass:"mstrmojo.TextBoxWithLabel",cssDisplay:"table-row",label:N(AB)+":",value:t[x],type:AA||"text",onEnter:function(){if(w.enabled){w.onclick({e:{stopPropagation:mstrmojo.emptyFn}});}}}));},l=j(17,"uid",null,{onRender:function(){this.focus();},onvalueChange:function(){w.set("enabled",!!this.value.length);}}),p=j(18,"pwd","password");w=k(a(N(9935,"Log In"),function(){var x=t.uid=l.value;t.pwd=p.value;if(x.length){window.setTimeout(function(){q();},100);}},{enabled:false}));o=mstrApp.showDialog({id:"user_creds_prompt",title:(s?N(7904):N(11))+" "+N(26),cssClass:"mstrmojo-CredentialsDialog",loginInfo:t,children:[{scriptClass:"mstrmojo.Box",cssDisplay:"table",children:[l,p]}],buttons:[a(N(221,"Cancel"),function(){o.manualClose=true;mstrApp.cancelPending();}),w]});}function K(j){return((j.wsam>1)&&!j.wsuid);}function J(j){return(!j.uid&&j.am!=2);}function T(j,s){var k=j,p=false;var o=function(t){var w={uid:k.wsuid,pwd:k.wspwd},x=function(){k.wsuid=w.uid;k.wspwd=w.pwd;k.updateCfgAfterLogin|=1;t();};G.call(this,w,true,x);};var q=function(t){var w={uid:k.uid,pwd:k.pwd},x=function(){k.uid=w.uid;k.pwd=w.pwd;k.updateCfgAfterLogin|=2;t();};G.call(this,w,false,x);};if(K(k)&&J(k)){var l=this;o.call(this,function(){q.call(l,s);});}else{if(K(k)){o.call(this,s);}else{if(J(k)){q.call(this,s);}else{s();}}}}function b(p){var k=this._mobileCfg,l=p.pid,q=k.getProject(l),o=q.realPid,j=k.getLoginInfo(l);if(mstrApp.useBinaryFormat&&o&&j.uid){p.params.projectID=o;return true;}return false;}function f(p){var t=this,s=t._mobileCfg,q=p.pid,w=p.params.projectID,l=t.transport,j=t.id,x={success:function(AA){var z=d[q]=mstrmojo.hash.obj2array(AA);mstrmojo.hash.copy(z,mstrmojo.locales);if(mstrApp.useBinaryFormat){V.call(t,p);}else{P[q]=true;l.serverRequest(j,p.id,p);}},failure:function(AA){var z=p.callback;if(z.failure!==undefined){z.failure(AA);}z.complete(p.id);}},o={taskId:"getLocaleInfo"},k={projectId:q,mobileConfig:s,skipLogin:true,doNotHold:true};if(w){o.projectID=w;}t.request(x,o,false,k);}function R(p){var t=this,s=t._mobileCfg,q=p.pid,z=s.getProject(q),o=t.transport,j=t.id,AA=s.getLoginInfo(q),l=false,k,x=function(AC){z.posLoginFlag=false;var AE={success:function(AH){clearInterval(k);z.es=AH.hasEmailScreenPriv;if(AA.updateCfgAfterLogin){s.updateLoginInfo(q,AA);}s.setRealPid(z,AH.projectID);var AG=C[q]=AH.sessionState;mstrMobileApp.putSession(q,AG);p.params.sessionState=AG;if(AH.isCompatible===false){mstrApp.handleCompatibilityError(p);}f.call(t,p);},failure:function(AK){var AN=p.callback,AP=b.call(t,p),AG=(AK.status==401),AO=(AK.code==h.AUTHEN_E_LOGIN_FAIL)||(AK.status==401),AJ=mstrmojo.emptyFn,AM=s.getLoginInfo(q),AH=AG||AO||(K(AM)||J(AM));if((AN.failure!==undefined)&&!AG){AK.noErrorMessage=AP||AH||AK.requireDeviceCertificate;AK.handledError=AH||AK.requireDeviceCertificate;AN.failure(AK);}if(!AH){AN.complete(p.id);}if(AP&&!mstrMobileApp.isOnline()){f.call(t,p);}else{AK.method="login";if(AH){if(AO){s.clearLoginInfoForProject(q);}if(AG){var AI=s.getServerByProjectId(q),AL;if(AI.udc){AL=s.getDefaultServerCreds();}else{AL=AI.wsc;}delete AL.lo;delete AL.ps;s.saveConfiguration();AK.message=N(10672,"The username or password you entered is incorrect.");}AK.handledError=false;AJ=function(){l=true;};}mstrApp.onerror(AK,AJ);}}},AF=A,AD=M({taskId:D,server:z.sn,project:z.pn,userid:AA.uid,password:AA.pwd,wsSize:10,authMode:AA.am,wsuid:AA.wsuid,wspwd:AA.wspwd,wsam:AA.wsam,clientVersion:mstrMobileApp.getAppVersion(),clientType:mstrMobileApp.isTablet()?AF.ANDROID_TAB:AF.ANDROID_PHONE}),AB={projectId:q,mobileConfig:s,doNotHold:true};t.request(AE,AD,false,AB);},w=x;T.call(this,AA,x);k=setInterval(function(){if(l){l=false;AA=s.getLoginInfo(q);T.call(t,AA,x);}},500);}mstrmojo.MobileServerProxy=mstrmojo.declare(mstrmojo.ServerProxy,null,{scriptClass:"mstrmojo.MobileServerProxy",getSessions:function(){return C;},request:function I(o,l,k,j){this._projectId=j.projectId;this._mobileCfg=j.mobileConfig;this._super(o,l,k,j);},createRequest:function Y(p,s,q,k){var o;try{o=this._super(p,s,q,k);var j=this._projectId;o.pid=j;if(!k.noTaskURL){o.taskURL=this._mobileCfg.getTaskUrlByProject(j);}o.isLogin=(q.taskId===D);o.isPwdChange=(q.taskId==Z);}catch(l){this.deleteRequest(p);throw l;}return o;},userInteractionRequired:function E(o){var j=false;if(o.pid&&!C[o.pid]){var l=o.config.mobileConfig.getLoginInfo(o.pid),p=((l.wsam>1)&&!l.wsuid),k=(!l.uid&&l.am!=2);return p||k;}return j;},submitRequest:function U(k){if(k.isLogin||k.isPwdChange){this._super(k);return ;}var l=C[k.pid],j=d[k.pid];if(l){k.params.sessionState=l;if(j){mstrmojo.hash.copy(j,mstrmojo.locales);}this._super(k);}else{if(k.config.skipLogin){this._super(k);return ;}if(mstrMobileApp.isOnline()){R.call(this,k);}else{if(b.call(this,k)){if(!P[k.pid]){f.call(this,k);}else{this._super(k);}}else{R.call(this,k);}}}},response:function B(o,j,k){var l=this.getRequest(o);if(!l){return ;}if(!j&&mstrMobileApp.isOnline()){switch(parseInt(k.code,10)){case h.AUTHEN_E_LOGIN_FAIL_EXPIRED_PWD:case h.AUTHEN_E_LOGIN_FAILED_NEW_PASSWORD_REQD:L.call(this,l);return ;break;case h.MSI_INBOX_MSG_NOT_FOUND:break;case h.E_MSI_USERMGR_USER_NOTFOUND:if(!l.isLogin){delete l.params.sessionState;R.call(this,l);return ;}break;}}this._super(o,j,k);},getSession:function X(j){return C[j];},closeSession:function Q(j){},closeAllSessions:function S(){C={};},getLocaleInfo:function F(j){return d[j];},hasEmailScreenPrivilege:function O(j){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var O=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],V=["width","height"],l="p_fmts";var j="px";var g={getContentHeight:function(q,t){var s=t.ttl&&t.ttl.height;if(q&&s&&!this.floatingToolbar){return Math.max(parseInt(q,10)-parseInt(s,10),0)+j;}return"";},getPortletMinHeight:function(q){return q.ttl.height;},adjustTitleCss:function(q){return ;}};var e={getContentHeight:function(q,s){return q;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(q){q.titlebarNodeClass+=" floating";return ;}};function A(w,s){var t=this.parent,q=w+"DirtyKey";if(t[q]){t[q](s);}}function N(){var q=this.title;if(this.count){q+=" "+this.count;}this.toolbarTitleTextNode.innerHTML=q;}function f(){var s=this.parent,w=s&&s.defn;if(w&&parseInt(w.t,10)===mstrmojo.EnumRWUnitType.PANEL){var q=s.parent,t=q.defn;if(t&&t.ifp){return q;}}return null;}var P=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;">{@title} {@count}</div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){N.call(this);},oncountChange:function(){N.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B"],shadowNode:["RW","B","fx","background-color"],titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]},buttonbarNode:{src:"ttl",props:["background-color"]}},fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:g,getCacheKey:function F(q){return this._super(q)+"-portlet";},getFormats:function L(){var s=this.content,q=s&&s.getFormats();return q&&q[l];},updateContentHeight:function b(x){var q=this.getFormats(),s=this.content,w=s.dimNode||s.domNode,t=((q.ttl&&parseInt(q.ttl.height,10))||0);if(w){if(!x){t+=((this.fc||this.isInFilterPanel())?w.offsetHeight:(q.height?parseInt(q.height,10):0));}this.containerNode.style.height=t+j;this.shadowNode.style.height=t+j;}},init:function o(q){this._super(q);var s=this.content;if(s&&s.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var s=this._ts=(this.floatingTitle)?e:g;this._super();s.adjustTitleCss(this);var q="display:none;";if(this.isInFilterPanel()){var t=P.clone(this.formatHandlers);t.portletContainerNode=["z-index","height","B","backgroud-color"];t.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=t;}if(!this.leftToolbar){this.leftToolbarNodeCssText+=q;}if(!this.toolbar){this.toolbarNodeCssText+=q;}var w=mstrmojo._Formattable.getBorderWidths(this);if(w.l||w.t||w.r){this.borderCss="has-border";}},postBuildRendering:function W(){var w=mstrmojo.dom,x=mstrmojo.css,AA=this.contentNode,AD=this.titleNode,AB=this;if(this.titleNode){if(this.floatingTitle){document.body.appendChild(this.titleNode);if(!this._onhover){this._onhovertt=function(){x.addClass(AB.titleNode,["visible"]);AB._onflt=true;return true;};this._onhoverofftt=function(){x.removeClass(AB.titleNode,["visible"]);AB._onflt=false;return true;};this._onhover=function(){var AE=AB.titleNode;x.addClass(AE,["visible"]);var AF=w.position(AB.contentNode,true);AE.style.top=(AF.y-AE.clientHeight+2)+j;AE.style.left=AF.x+j;return true;};this._onhoveroff=function(){x.removeClass(AB.titleNode,["visible"]);return true;};}w.attachEvent(AA,"mouseover",this._onhover);w.attachEvent(AA,"mouseout",this._onhoveroff);w.attachEvent(AD,"mouseover",this._onhovertt);w.attachEvent(AD,"mouseout",this._onhoverofftt);}if(this.attachContextMenuEvent){this._oncontextmenu=function(AF,t){var AE=AB.rightToolbar&&AB.rightToolbar.btnMenu;if(AE){AE.cmPos=w.getMousePosition(AF,t);AE.openPopupMenu();AE.cmPos=null;w.preventDefault(t,AF);}};w.attachEvent(AD,"contextmenu",this._oncontextmenu);}}if(this._super){this._super();}var z=this.getFormats();this.set("fc",z&&!z.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var q=this.portletContainerNode.style,s=this.shadowNode.style,AC=this.parent;q.width=s.width="99%";q.top=s.top=AC.topStart+j;q.left=s.left=G+j;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(z.left)+G*this.orgPos+j;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}},adjustFPHeight2Fit:function(){var t=mstrmojo.dom,q=t.position(this.titleNode),s=t.position(this.contentNode).y-q.y-q.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height)-s+"px";},unrender:function E(s){if(this.floatingTitle&&this.titleNode){var x=this.domNode,q=this.titleNode,w=mstrmojo.dom;if(x&&this._onhover){w.detachEvent(x,"mouseover",this._onhover);}if(x&&this._onhoveroff){w.detachEvent(x,"mouseout",this._onhoveroff);}if(q&&this._onhovertt){w.detachEvent(q,"mouseover",this._onhovertt);}if(q&&this._onhoverofftt){w.detachEvent(q,"mouseout",this._onhoverofftt);}if(q&&this._oncontextmenu){w.detachEvent(q,"contextmenu",this._oncontextmenu);}if(q){document.body.removeChild(q);}}if(this._super){this._super(s);}},updateStyle:function(s,q){var x=this.shadowNode.style,t=this.containerNode.style;x.height=t.height=s;x.width=t.width=q;},_createFormats:function T(){var w=this.content&&this.content.getFormats(),s;s=w.p_fmts={};var q,t;for(q in O){t=O[q];if(t in w){s[t]=w[t];delete w[t];}}for(q in V){t=V[q];if(t in w){s[t]=w[t];}}w.height=this._ts.getContentHeight(w.height,s);if(mstrmojo.dom.isIE&&s.fx&&s.fx.ds&&!s["background-color"]){s["background-color"]="#ffffff";}},refresh:function p(){if(!this.hasRendered){return ;}var s=this.children,q;for(q=s.length-1;q>=0;q--){s[q].refresh();}},isInFilterPanel:function K(){return(f.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var q=this.getFilterPanel();return q&&q.defn&&q.defn.fds==2;}else{return false;}},getFilterPanel:function H(){return f.call(this);},getContainerHeight:function a(){return this.containerNode.clientHeight;},relocate:function C(s,q){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=s+j;}},setInfoWindowDimensions:function k(x){var s=this.domNode.style,q=this.shadowNode.style,t=this.portletContainerNode.style,w=mstrmojo._Formattable.getBorderWidths(this);x.h-=w.h;x.w-=w.w;q.height=t.height=s.height=x.h+j;q.width=t.width=s.width=x.w+j;x.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function J(q){A.call(this,"add",q);},removeDirtyKey:function I(q){A.call(this,"remove",q);},setDirtyChildren:function X(){var q=this.content;if(q&&q.setDirtyChildren){q.setDirtyChildren.apply(q,arguments);}}});var U=0,M=1,h=2;function Y(AG,AE,q,AH){var AD=this.content,AF=AD.k,AC=mstrmojo.boxmodel.px2Inches,t=AD.model.docModel||AD.model,x=this.getFormats(),AI={},AB=this,z=function(){var w=AB.content&&AB.content.defn;if(w){w.set("ds",AG);}},s={ZIndex:x["z-index"],WindowState:AG},AA={};AA[AF]=s;if(AE!==undefined&&q!==undefined){P.copy({OldHeight:AC(t,AE),OldWidth:AC(t,q),Height:AC(t,parseInt(x.height,10)),Width:AC(t,parseInt(x.width,10))},s);AI.success=function(w){var AJ=w&&w.data;if(AJ){AD.model.loadPartialData(AJ,AF);}z();var AK=AB.parent;if("adjustSectionSize" in AK){AK.adjustSectionSize();}};t.saveRWProps(AF,AA,1,this.loadDataOnResize,AI,true);}else{z();if(!(AH&&AH.all)){t.saveRWProps(AF,AA,1,this.loadDataOnResize,AI,true);}}return AA;}function R(){var AA=this.content;if(!AA){return ;}var x=function(AE){mstrmojo.array.forEach(AE,function(AF){if("ds" in AF){AF.set("visible",(AF.ds!==AA.defn.ds));}});},AB;if(this.isInFilterPanel()){var t=(parseInt(this.defn.ds,10)===U);AA.set("visible",t);this.updateContentHeight(!t);AB=this.leftToolbar;x(AB&&AB.children);var w=this.parent;if(w.refreshFP){w.refreshFP();}}else{var q=AA.getFormats(),AC=this.getFormats(),s=this.portletContainerNode.style,AD=this.shadowNode.style,z=this.contentNode.firstChild.style;z.height=q.height;z.width=q.width;AD.height=s.height=AC.height;AD.width=s.width=AC.width;AD.top=s.top=AC.top;AD.left=s.left=AC.left;if("z-index" in AC){AD.zIndex=s.zIndex=AC["z-index"];}AB=this.rightToolbar;x(AB&&AB.children);if(AA.resize){AA.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function T(){this._super();var s=this.getFormats();var q=parseInt(this.defn.ds,10);if(q===U){s.normHeight=s.height;s.normWidth=s.width;if(s["z-index"]!==null&&s["z-index"]!==undefined){s.normZIndex=s["z-index"];}}if(q!==h){s.normTop=s.top;s.normLeft=s.left;}},onmaximize:function d(){var w=this.parent,AA=this.content,z=AA&&AA.getFormats(),t=this.getFormats(),s=t.height,q=t.width,x=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();AA.clearCache();t.height=(parseInt(w.height(),10)-x.h)+j;z.height=this._ts.getContentHeight(t.height,t);t.width=z.width=(w.width()-x.w)+j;t.top=t.left=0;t["z-index"]=w.getMaxZIndex()+1;Y.call(this,h,s,q);},onminimize:function Z(){var z=this.content,s=z.dimNode||z.domNode,x=z&&z.getFormats(),w=this.getFormats(),t=w.height||s.offsetHeight,q=w.width;this.clearCache();z.clearCache();w.width=x.width=w.normWidth;w.top=w.normTop;w.left=w.normLeft;if(w.normZIndex!==null&&w.normZIndex!==undefined){w["z-index"]=w.normZIndex;}x.height=0;w.height=this._ts.getPortletMinHeight(w);Y.call(this,M,t,q);},onrestore:function Q(){var x=this.content,w=x&&x.getFormats(),t=this.getFormats(),s=t.height,q=t.width;this.clearCache();x.clearCache();t.height=t.normHeight;w.height=this._ts.getContentHeight(t.height,t);t.width=w.width=t.normWidth;t.top=t.normTop;t.left=t.normLeft;if(t.normZIndex!==null&&t.normZIndex!==undefined){t["z-index"]=t.normZIndex;}Y.call(this,U,s,q);},oncollapse:function S(q){return Y.call(this,M,undefined,undefined,q);},onexpand:function D(q){return Y.call(this,U,undefined,undefined,q);},postBuildRendering:function W(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,R);}this._super();if(this.isInFilterPanel()){var q=(parseInt(this.defn.ds,10)===U);this.updateContentHeight(!q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.SliderBox","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.ui.MobileSlider","mstrmojo.num");var C=1,B=mstrmojo.num;mstrmojo.android.inputControls.SliderDIC=mstrmojo.declare(mstrmojo.SliderBox,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.SliderDIC",popupStyle:1,init:function F(H){var G,I,J,K;this._super(H);this.items=this.getItems();this.cssClass=this.showByDefault?"mstrmojo-SliderGroup":"mstrmojo-PopupSlider";if(this.dic.ipt!==C){this.isSequential=true;I=this.max=this.dic.max;G=this.min=this.dic.min;J=this.interval=this.dic.itv;}else{G=1;I=this.items.length;J=1;}K=this.sliderBar;if(K){K.min=G;K.max=I;K.interval=J;}},preBuildRendering:function E(){var I=this.dic,G=(I.ldw!=null)?I.ldw/100:0.4,H;this.valueText=this.dv;this._super();if(this.showByDefault){H=this.openerStyle;this.valueCssText="left:-"+H.iw*G+"px;width:"+H.iw*G+"px";this.cssText="width:"+H.iw*(1-G)+"px";this.alignSlider(this.openerNode,H.ih);}},onpopupResized:function D(){var G=this.sliderBar;if(G){G.refresh();}},sliderRef:{scriptClass:"mstrmojo.ui.MobileSlider",onslidingValueChange:function(){if(this.hasRendered){this.selectedIdx=parseInt((this.slidingValue-this.min)/this.interval,10)||0;this.parent.selectedIdxChanged(this.selectedIdx);}},selectedIdx:0,select:function(G){this.selectedIdx=G||0;this.slidingValue=this.value=this.min+G*this.interval;}},selectedIdxChanged:function A(H){var I=this.items[H],G=I&&I.n;this.set("value",B.toLocaleString(G));this.set("valueText",B.toLocaleString(G));}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo._IsAnchorable");var A=mstrmojo.dom,B=mstrmojo.array;mstrmojo.VisHeatMapPopupPanel=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VisHeatMapPopupPanel",title:"",markupString:'<div id="{@id}" class="heatmap-popup-panel" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},initialized:false,naviAction:null});mstrmojo.VisHeatMapAnimation=(function(){var C=[];return{animate:function(H,L,J,P,I,Q){var G;var M=C.length;for(var K=0,O=C.length;K<O;K++){if(!C[K]){M=K;continue;}if(C[K].node===H&&C[K].propName===L){(C[K].finalize(false));G=C[K];break;}}if(!G){G={};G.node=H;G.index=M;G.propName=L;C[M]=G;}var F=(new Date()).getTime();var I=I||500;var E=20;var D=null;G.finalize=function(R){clearInterval(D);D=null;if(P.r!==undefined){P.a=P.a||1;H.style[L]="";}else{if(P.px!==undefined){H.style[L]=P.px+"px";}}if(R){delete C[this.index];}if(Q){Q();}};function N(){var R={};var S=(new Date()).getTime();var U=S-F;if(U>=I){G.finalize(true);return ;}for(var T in J){R[T]=(P[T]-J[T])*U/I+J[T];if(T!=="a"){R[T]=Math.round(R[T]);}}if(R.r){R.a=R.a||1;H.style[L]="rgba("+R.r+","+R.g+","+R.b+","+R.a+")";}else{if(R.px){H.style[L]=R.px+"px";}}}D=setInterval(N,E);}};})();mstrmojo.VisHeatMapPopup=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VisHeatMapPopup",fadeOnClose:false,autoClose:true,markupString:'<div style="display: -webkit-box; -webkit-box-align: start; -webkit-box-pack: center;position:absolute; left:0px; top:0px; z-index:100000; width: 100%; height:100%;"  id={@id} mstrAttach:mouseup,touchend><div id={@id} style=" position:relative; left: 0px; top: 0px; width:{@width}; background-color:#F5F5F5;z-index:100001;border:2px solid rgba(0, 0, 0, 0.1);-webkit-box-shadow:rgba(0, 0, 0, 0.45) 2px 2px 8px;"><div  class="heatmap-popup-panel-title" style="display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: center;position:relative; -webkit-box-sizing: border-box; margin-bottom:6px; padding-right: 25%; height:65px; width:100%; line-height:65px;vertical-align:bottom;color:#33b5e5;"></div><div style="height: 2px;width:100%;background-color:#33b5e5"></div><div style="width:100%; height:auto; position:relative;overflow:hidden; display: -webkit-box; -webkit-box-orient: horizontal"></div></div><div style="position:absolute;z-index:100000;top:0px;left:0px;width:100%;height:100%;background: rgba(0, 0, 0, 0.5);"></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.lastChild;},curtainNode:function(){return this.domNode.lastChild;}},baseTipClass:"heatmap-editor-tip",anchorOffset:42,hasCloseButton:true,goBack:function(){return this.close();},close:function(){this.domNode.style.webkitTransform="translate(-100000px,0px)";this.destroy();return true;},destroy:function(){this.onClose();if(this._super){this._super();}},postBuildRendering:function(){this._super();for(var D=0,C=this.panels.length;D<C;D++){if(D!==0){var F=document.createElement("div");F.style.cssText="position:relative;width:1px;color:grey;height:35px;text-align:center;background-color:grey;";this.titleNode.appendChild(F);}var F=document.createElement("div");F.style.cssText="-webkit-box-flex:1; line-height:65px;text-align:center; display: -webkit-box; -webkit-box-align: center; -webkit-box-pack: center; height:100%;";if(D==0){F.style.cssText+="margin-left:16px;";}else{F.style.cssText+="margin-right:16px;";}F.setAttribute("panel",D);F.innerText=this.panels[D].title;this.titleNode.appendChild(F);}var E=this;document.body.appendChild(this.domNode);this.panelStack=0;this.navigateTo(0);this.contentNode.style.marginTop=parseInt((document.body.offsetHeight-this.contentMaxHeight-this.titleNode.offsetHeight)/2)+"px";},onmouseup:function(D){if(D.e.target===this.curtainNode){this.close();return ;}var E=mstrmojo.dom.findAncestorByAttr(D.e.target,"panel",true,this.domNode);if(!E){return ;}E.node.style.backgroundColor="rgba(51, 181, 229, 0.6)";var F=function(){mstrmojo.VisHeatMapAnimation.animate(E.node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};var C=this;setTimeout(function(){setTimeout(function(){C.navigateTo(E.value);F();},0);},0);},ontouchend:function(C){this.onmouseup(C);},highlightTitle:function(E){E=2*parseInt(E);if(isNaN(E)){return ;}var F=this.titleNode.childNodes,C=F.length;for(var D=0;D<C;D+=2){if(D!=E){F[D].style.borderBottom="";}else{F[D].style.borderBottom="solid 6px #33b5e5";}}},panelStack:0,navigateTo:function(I){this.highlightTitle(I);var E=this.panels[I];var J=this.panelStack;var C=this.panels[J];if(I!=J){if(C.hasRendered){C.domNode.style.display="none";}}if(!E.hasRendered){this.panels[I]=new mstrmojo.VisHeatMapPopupPanel(this.panels[I]);var E=this.panels[I];this.addChildren(E);this.renderChildren();}E.domNode.style.display="block";if(E.naviAction){E.naviAction();}if(J===I){delete E.domNode.style.webkitTransform;}else{var F=C.domNode.offsetWidth+"px";var H=E.domNode.offsetWidth+"px";var K=Math.max(parseInt(F),parseInt(H));delete E.domNode.style.webkitTransition;var G="";var D="";if(J<I){G="translate(-"+K+"px,0px)";D="translate(-"+K+"px,0px)";}else{G="translate("+K+"px,0px)";D="translate("+K+"px,0px)";}this.panelStack=I;}},animation:function(D,E,C){E.domNode.style.webkitTransform=C;D.domNode.style.webkitTransform=C;},dummy:true});})();(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo._IsAnchorable");var A=mstrmojo.dom,C=mstrmojo.array;mstrmojo.android.Popup=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsAnchorable],{scriptClass:"mstrmojo.android.Popup",fadeOnClose:false,autoClose:true,init:function E(J){this._super(J);if(this.anchor){mstrmojo.css.addWidgetCssClass(this,"anchor");}},addChildren:function I(L,J,K){this._super(L,J,K);C.forEach(this.children,function(M){if(M.isElastic){this._elasticChild=M;return false;}},this);},resizeDialog:function D(){var Q=this.editorNode,M=mstrApp,J=M.getScreenDimensions(),P=Math.round(J.h*0.9),T=J.w,R;T=T*0.85;if(M.isTablet()){var N=this.popDimensions||{},S=mstrApp.getScreenDimensions();P=N.h||Math.min(Math.round(S.h*0.6),P);T=N.w||Math.min(Math.round(S.w*(mstrApp.isLandscape()?0.43:0.65)),T);}T+="px";var K=this._elasticChild;if(K){var L=K.elasticHeight;if(L){R=L;}else{if(K.getItemsContainerHeight){R=K.getItemsContainerHeight();}}}if(R===undefined){R=this.getAvailableContentSpace();P=Math.max(P,R+(this.titleNode.offsetHeight+this.buttonNode.offsetHeight));}else{R=Math.min(R,P-(this.titleNode.offsetHeight+this.buttonNode.offsetHeight));}if(Q){Q.style.maxHeight=P+"px";this.set("width",T);}else{this.width=T;this.cssText=(this.cssText||"")+"max-height:"+P+"px;";}this.raiseEvent({name:"popupResized",maxheight:P,height:R,width:parseInt(T,10)});if(K){var O=K.height;if(O!==undefined&&O!=="auto"){K.set("height","auto");}K.set("height",R+"px");if(K.updateScroller){K.updateScroller();}}this._super();},getAvailableContentSpace:function B(){return Math.max(this.containerNode.offsetHeight,this.editorNode.clientHeight-this.titleNode.offsetHeight-this.buttonNode.offsetHeight);},close:function F(){if(this.onClose){this.onClose();}if(this.fadeOnClose){var J=this.domNode;if(J){var K=this.id;if(!A.isWinPhone){A.attachOneTimeEvent(J,A.CSS3_TRANSITION_END,function(){mstrmojo.all[K].destroy();});J.style.opacity=0;}else{(new mstrmojo.fx.FadeOut({onEnd:function(){mstrmojo.all[K].destroy();},target:J,duration:400})).play();}}}else{this.destroy();}},onclick:function G(J){if(this.autoClose&&J.e.target===this.curtainNode){this.close();}},ontouchend:function H(J){this.onclick(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Dialog","mstrmojo._IsAnchorable","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller");var B=mstrmojo.dom;function A(){mstrApp.closeDialog();}mstrmojo.Magnifier=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsAnchorable,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.Magnifier",cssClass:"mstrmojo-magnifier anchor",markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}"><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-InfoViewer-Title"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-InfoViewer-Content"></div><div class="mstrmojo-InfoViewer-Buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',anchorOrientation:"h",anchorOffset:0,baseTipClass:"",screenDim:null,width:"auto",close:function G(){if(this.onClose){this.onClose();}B.detachEvent(window,"resize",A);this.destroy();},touchBegin:function H(I){this.helper.glowOnTap(I.target);},touchTap:function D(J){var I=J.target;if(I===this.curtainNode){mstrApp.closeDialog();}else{this.helper.handleTouchTap(I);}},touchSwipeEnd:function C(I){this.helper.handleTouchSwipe(I);this._super(I);},preBuildRendering:function E(){this._super();var K=this.screenDim=mstrApp.getScreenDimensions(),I=K.w,J=K.h;if(mstrApp.isTablet()){this.width="auto";}else{this.width=(I>J?(I*0.4):(I*0.6))+"px";}},postBuildRendering:function(){this._super();B.attachEvent(window,"resize",A);},updateContent:function(){var I=this.helper;I.createTitle(this.titleNode);I.createContent(this.containerNode);},resizeAndPosition:function(I){var K=this.helper.getContentHeight(),M=this.helper.titleHeight,L=this.screenDim,J=L.h-30,N;this.height=Math.min(K,J-M);this.containerNode.style.height=this.height+"px";this.updateScroller();if(I){this.moveTo(I);}else{N=B.position(this.editorNode);if(!(N.x>0&&N.x+N.w<L.w&&N.y>0&&N.y+N.h<L.h)){this.positionDialog();}}window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},moveTo:function(I){this.anchorPosition=I;this.positionDialog();},updateScrollerConfig:function F(){var J=this._super(),I=this.helper.currentTabIndex,L=this.containerNode.children[I];J.bounces=false;if(L){J.scrollEl=L;J.origin=J.origin||{x:0,y:0};J.noVScroll=J.noHScroll=true;var M=Math.max(this.helper.getContentHeight()-this.height,0);var K=J.vScroll=(M!==0);if(K){J.offset={y:{start:0,end:M}};}}return J;}});})();(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ResultSetView","mstrmojo.dom");var F="100%";mstrmojo.android.medium.ui.ResultSetView=mstrmojo.declare(mstrmojo.android.ui.ResultSetView,null,{scriptClass:"mstrmojo.android.medium.ui.ResultSetView",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"><div class="mstrmojo-ResultSetView-content"></div><div class="mstrmojo-ResultSetView-toolbar"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},toolbarNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{containerNode:F,toolbarNode:"auto"},w:{containerNode:F,toolbarNode:F}},children:[{scriptClass:"mstrmojo.android.ui.ActionToolbar",slot:"toolbarNode",alias:"toolbar",fullscreenDirection:"down"}],rootOrientationChange:function H(){this.controller.generateActionToolbar();},delegateToolbar:function C(M){var O=mstrmojo.android.ui.ActionToolbar.newToolbarConfig(),L=1,K=Math.round(mstrMobileApp.getDeviceDPI()/63)+1,N=false,J=this.controller;if(!mstrApp.isLandscape()&&this.controller.canDelegateToolBar()){M.minBtnCount=L;M.maxBtnCount=K;O=M;J.toolBarDelegated=true;N=true;}else{J.toolBarDelegated=false;}this.toolbar.setActions(this.controller.id,O);this.doLayout();return N;},setActionToolbarStatus:function B(J){this.toolbar.set("active",J);},enterFullScreen:function A(){this.toolbar.enterFullScreen();this._super();},exitFullScreen:function E(J){if(this.domNode){this.toolbar.exitFullScreen(J);this._super(J);}},flashFullScreen:function G(){this.toolbar.flashFullScreen();},cancelFlashFullScreen:function D(){this.toolbar.cancelFlashFullScreen();},getPosition:function I(){var J;if(this.containerNode){J=mstrmojo.dom.position(this.containerNode);}return J;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DateTimePicker","mstrmojo.ui.MobileStepper","mstrmojo._TouchGestures");var A="mstrmojo.ui.MobileStepper";mstrmojo.ui.MobileDateTimePicker=mstrmojo.declare(mstrmojo.DateTimePicker,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.ui.MobileDateTimePicker",stepperClass:"mstrmojo.ui.MobileStepper",onclick:function(B){this.touchTap(B.e);},touchTap:function(B){if(B.target===this.meridiemNode){this.set("meridiem",!this.meridiem);this.updateTime();}},touchBegin:function(B){if(B.target==this.meridiemNode){mstrmojo.css.addClass(B.target,"glow");}},touchEnd:function(B){if(B.target==this.meridiemNode){mstrmojo.css.removeClass(B.target,"glow");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var A=mstrmojo.dom,B={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(B[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=A.eventTarget(D.hWin,D.e);if(F==this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd");function W(a){var e=document.createElement("div"),b=e.style,Z=a.domNode;e.className="mstrmojo-DataGrid-avatar";b.height=Z.clientHeight+"px";Z.appendChild(e);a.avatar=e;return e;}function N(Z){var a=mstrmojo.dom.position(Z.domNode,true);return a.x;}function L(Z){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+Z+'"></div>';}function X(b){var a=b.getAttribute("rh"),Z=a&&parseInt(a,10);return Z;}function U(a,f,Z){var e=Z.src,g=e&&e.data,b=g&&g.resizingIdx;if(!(b&&b>0)){return f&&f.apply(a,[Z]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function E(d,b){var Z=d.colSizeArray;var a=[-Z[b-1]+d.minColWidth,(b==Z.length-1)?Z[b]-d.resizeHandleWidth-d.minColWidth:Z[b]-d.minColWidth];return a;},updateSize:function D(d,b,a){var Z=d.colSizeArray;Z[b-1]=Z[b-1]+a;Z[b]=Z[b]-a;},updateColumnWidth:function Q(d,a,e,b){var Z=d.colSizeArray;a[b-1].style.width=Z[b-1]+"px";e[b-1].style.width=Z[b-1]+"px";a[b].style.width=Z[b]+"px";e[b].style.width=Z[b]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function E(f,e){var g=f.minColWidth+f.resizeHandleWidth,Z=f.colSizeArray,b=0;for(var d=e;d<Z.length;++d){b+=Z[d]-g;}var a=[-Z[e-1]+g,b];return a;},updateSize:function D(d,h,a){var g=d.minColWidth+d.resizeHandleWidth,e=d.colSizeArray;e[h-1]=e[h-1]+a;var Z=[];for(var b=0;b<e.length-h;++b){Z[b]=h+b;}Z.sort(function(k,l){return e[k]-e[l];});for(var b=0;b<Z.length;++b){var j=a/(Z.length-b);var f=e[Z[b]];a-=(f>=j+g)?j:f-g;e[Z[b]]=(f>=j+g)?f-j:g;}},updateColumnWidth:function Q(e,a,f,d){var Z=e.colSizeArray;for(var b=d-1;b<Z.length;++b){a[b].style.width=Z[b]+"px";f[b].style.width=Z[b]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,postBuildRendering:function S(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function C(Z){var b=Z.src,d=b.node,a=X(d);if(a&&a>0){return{resizingIdx:a,startingX:b.pos.x,baseX:N(this)};}else{if(this._super){return this.dropZone&&this._super(Z);}}return null;},allowDrop:function I(Z){var b=Z.src,e=b&&b.data,a=e&&e.resizingIdx;if(a&&a>0){return true;}else{return this.dropZone;}},ondragenter:function O(Z){U(this,this._super,Z);},ondragover:function P(Z){U(this,this._super,Z);},ondragleave:function A(Z){U(this,this._super,Z);},ondrop:function T(Z){U(this,this._super,Z);},ondragstart:function V(f){var p=f.src,g=p&&p.data,o=g&&g.resizingIdx;if(o&&o>0){var j=this.avatar||W(this);this.ownAvatar=true;j.style.left=(g.startingX-g.baseX)+"px";j.style.display="block";document.body.style.cursor="col-resize";var k=this.colSizeArray;if(!k){var b=this.headerContainerNode,h=b&&b.getElementsByTagName("table")[0],l=h.rows[0].cells;k=[];for(var Z=0,e=l.length;Z<e;Z++){k.push(l[Z].offsetWidth);}this.colSizeArray=k;this._firstTimeResize=true;}g.resizingRange=this.resizeColumnBehavior.getRange(this,o);return true;}else{if(this._super){return this._super(f);}}},ondragmove:function M(b){var l=b.src,e=l&&l.data,j=e&&e.resizingIdx;if(j&&j>0){var k=b.tgt,f=this.avatar,h=e.resizingRange,g=k.pos.x-e.startingX,Z=Math.min(h[1],Math.max(g,h[0]));e.deltaX=Z;if(f){f.style.left=(e.startingX-e.baseX+Z)+"px";}}else{if(this._super){this._super(b);}}},ondragend:function J(f){var p=f.src,g=p&&p.data,l=g&&g.resizingIdx;if(l&&l>0){var Z=this.titleColGroup,o=Z&&Z.childNodes,j=this.dataColGroup,k=j&&j.childNodes,e=o.length,h=this.colSizeArray,a=g.deltaX;this.resizeColumnBehavior.updateSize(this,l,a);if(this._firstTimeResize){for(var b=0;b<e;b++){o[b].style.width=h[b]+"px";k[b].style.width=h[b]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,o,k,l);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(f);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function H(b){var f=document.createElement("colgroup"),Z=b.length,a;for(var e=0;e<Z;e++){var d=document.createElement("col");a=b[e];if(a.colWidth){d.style.width=a.colWidth+"px";}d.className=a.colCss||("col"+e);f.appendChild(d);}return f;}function G(a){var b=a._headerWidgets_,Z=b&&b.length;if(Z>0){for(var d=0;d<Z;d++){b[d].destroy(true);}}}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},itemFunction:function(b,Z,a){var d=new mstrmojo.DataRow({columns:a.columns,data:b,idx:Z,dataGrid:a});return d;},preBuildRendering:function B(){var d=this.columns,Z=d.length,e=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],b,a;this._headerWidgets=[];for(var f=0;f<Z;f++){b=d[f];a=b.headerWidget;e.push("<td>");if(f>0&&this.resizableColumns){e.push(L(f));}e.push('<div class="mstrmojo-DataGrid-headerText');e.push(b.headerCss?" "+b.headerCss:"");if(a){this._headerWidgets.push(mstrmojo.hash.copy(a));e.push('" w="1">');}else{e.push('">');}e.push(b.headerText?b.headerText:"&nbsp");e.push("</div>");e.push("</td>");}e.push("</tr></table>");this.headerHtml=e.join("");if(this._super){this._super();}},postBuildRendering:function S(){if(this._super){this._super();}var d=this._headerWidgets,g=d.length;if(g>0){this._headerWidgets_=[];var h=this.headerContainerNode.getElementsByTagName("div"),b=mstrmojo.array.filter(h,function(p){return p.getAttribute("w")=="1";}),l;for(var e=0;e<g;e++){d[e].placeholder=b[e].firstChild;d[e].dataGrid=this;l=mstrmojo.registry.ref(d[e]);l.render();this._headerWidgets_.push(l);}}var Z=H(this.columns),k=Z.cloneNode(true),f=this.headerContainerNode,j=f&&f.getElementsByTagName("table")[0],o=this.itemsContainerNode,a=o&&o.getElementsByTagName("table")[0];this.titleColGroup=Z;this.dataColGroup=k;if(j&&a){j.insertBefore(Z,j.firstChild);a.insertBefore(k,a.firstChild);}},refresh:function F(Z){G(this);if(this._super){this._super(Z);}},destroy:function Y(Z){G(this);this._super();},unrender:function R(e){var b=this._headerWidgets_,a=b&&b.length,Z;if(a>0){for(var d=0;d<a;d++){Z=b[d];if(Z&&Z.hasRendered){Z.unrender(true);}}}this._super(e);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var g=document.createElement("tr"),l=this.data,q=this.idx,a=this.dataGrid,h=this.cssClass,t=this.columns,Z=this.children,b,o=-1,s,p;g.setAttribute("id",this.id);if(a.banding){h+=(q%2==1)?" odd":" even";}g.className=h+(mstrmojo.string.isEmpty(l[a.itemDisplayField||"n"])?" empty-row":"");for(var f=0,k=t.length;f<k;f++){s=t[f];p=(s.dataWidgetBuilder&&s.dataWidgetBuilder(l))||s.dataWidget;b=document.createElement("td");g.appendChild(b);if(p){b.setAttribute("w","1");o++;Z.push(mstrmojo.hash.copy(p,{slot:"slot"+o,data:l,idx:q,dataGrid:a}));}else{if(s.dataFunction){b.innerHTML=s.dataFunction(l,q,a);}else{var e=mstrmojo.string.htmlAngles(l[s.dataField||"n"])||"&nbsp",j=s.tooltip?' title="'+e+'"':"";b.innerHTML='<div class="mstrmojo-DataRow-text" '+j+">"+e+"</div>";}}}this.initChildren();return g;},buildRendering:function K(){this._super();var e=this.domNode.childNodes,Z=e.length,d={},b=0,f;for(var a=0;a<Z;a++){f=e[a];if(f.getAttribute("w")=="1"){d["slot"+b]=f;b++;}}this.addSlots(d);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.android.ui._CanBeFullScreen","mstrmojo.android.ui.ActionToolbar","mstrmojo.android.ui.TitleLabel","mstrmojo.android.ui.Image","mstrmojo.hash","mstrmojo.array","mstrmojo.css");var C=mstrmojo.hash,I=mstrmojo.array,K=mstrmojo.css;var E=mstrmojo.android.ui.ActionBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.android.ui._CanBeFullScreen],{scriptClass:"mstrmojo.android.ui.ActionBar",markupString:'<div id="{@id}" class="mstrmojo-ActionBar {@cssClass}" style="{@cssText}" ><div><div class="mstrmojo-ActionBar-logo"></div><div><div class="mstrmojo-ActionBar-contents"></div></div><div class="mstrmojo-ActionBar-toolbar"></div></div></div>',markupSlots:{logoNode:function(){return this.domNode.firstChild.firstChild;},containerNodeWrapper:function(){return this.domNode.firstChild.childNodes[1];},containerNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},toolbarNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{logoNode:"56px",containerNodeWrapper:"56px",containerNode:"56px",toolbarNode:"56px"},w:{logoNode:"66px",containerNodeWrapper:"100%",containerNode:"100%",toolbarNode:"auto"}},children:[{scriptClass:"mstrmojo.android.ui.Image",slot:"logoNode",alias:"logo",onactiveChange:function(){K.toggleClass(this.domNode,"active",this.active);},touchTap:function(){mstrApp.closeAllDialogs();if(this.active){var N=this.domNode,M="selected";K.addClass(N,M);this.parent.controller.goUp();window.setTimeout(function(){K.removeClass(N,M);},500);}}},{scriptClass:"mstrmojo.android.ui.TitleLabel",slot:"containerNode",alias:"title",onlistSelectionMade:function(M){this.parent.controller.jumpTo(M.item);}},{scriptClass:"mstrmojo.android.ui.ActionToolbar",slot:"toolbarNode",alias:"toolbar"}],reset:function G(){this.title.reset();this.toolbar.reset();},setUpStatus:function J(M){this.logo.set("active",M);},setNavigation:mstrmojo.emptyFn,clearNavigation:mstrmojo.emptyFn,restoreNavigation:mstrmojo.emptyFn,selectNavigationItem:function D(N){var O=this.getNavList(),M=false;I.forEach(O&&O.items,function(Q,P){if(N.act===Q.act){O.singleSelect(P);M=true;return false;}});return M;},getNavList:mstrmojo.emptyFn,setLastOpened:function B(M){this.title.setListItems(M);},updateTitle:function H(M){this.title.setText(M);},updateToolbar:function L(N,M){this.toolbar.setActions(N,M);this.title.checkTextFit();},setActionToolbarStatus:function A(M){this.toolbar.set("active",M);},onEnterFullScreen:function F(){this.reset();}});E.adjustLayoutConfig=function(O,M){var N=mstrmojo.DPIManager;C.forEach(E.prototype.layoutConfig.h,function(Q,R){N.registerClass(E,"h",R,O);});var P=C.copy(O);if(M){C.forEach(P,function(R,Q){P[Q]=Math.ceil(R*1.333);});}N.registerClass(E,"w","logoNode",P);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.array","mstrmojo.android.EnumMenuOptions","mstrmojo.android.ui.ActionToolbar");mstrmojo.requiresDescs(1,1143,7831);var X=mstrmojo.android.EnumMenuOptions,I=mstrmojo.hash,a=mstrmojo.array.forEach,h=X.SETTINGS,J=X.HELP,Y=X.LEARN,F=-1;var e={currentViewMedia:0,documentID:"objectID",elementsPromptAnswers:0,link:0,linkAnswers:0,objectID:0,objectsPromptAnswers:0,promptsAnswerXML:0,reportID:0,reportViewMode:0,valuePromptAnswers:0,visMode:0,desiredElements:0,desiredUnits:0,projectID:0,Project:"projectID",groupByElements:0,pageByElements:0,layoutIndex:0,originMessageID:"originMessageID",promptAnswerMode:0,selectorMode:"selectorMode"};mstrmojo.android.controllers.ViewController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.android.controllers.ViewController",supportsFullScreen:false,start:function P(p){this.set("orientation",mstrApp.isLandscape()?0:1);this.pid=mstrApp.getCurrentProjectId();},detach:function o(){var s=this,t=s.nextController,q=s.prevController;if(q){delete q.nextController;}if(t){t.destroy();}this.nextController=this.prevController=null;var p=this.view;if(p){p.destroy();}},destroy:function j(){this.detach();this._super();},canDetach:function O(p){return p.hsc||!this.hsc;},getUpStatus:function L(){return !this.hsc;},spawn:function G(q,p){var s=this.nextController;if(s){if(!s.canDetach(q)){s.spawn(q,p);return ;}s.destroy();}this.nextController=q;q.prevController=this;q.rootCtrl=this.rootCtrl||this;q.start(p||{});},spawnFailed:function T(p){this.makeCurrent();mstrApp.onerror(p);},viewFailed:function U(q){if(q){mstrmojo.dbg("details: "+JSON.stringify(q));}mstrApp.hideMessage();if(this.view){if(this.rootCtrl.getCurrent()!==this){this.makeCurrent(true);}}else{var p=this.prevController;if(p){p.spawnFailed(q);}}mstrApp.onerror(q);},makeCurrent:function W(AD){var p=this.nextController,AB=true;if(p){AB=!p.doNotRefresh;p.destroy();}if(!this.supportsFullScreen){this.rootCtrl.exitFullScreen();}var x=this.pid;if(x){mstrApp.setCurrentProjectId(x);}if(AD){if(mstrApp.useBinaryFormat&&mstrApp.getCurrentProjectId()){var AA=this.ctrlType;if(AA){var w=this.model,t=mstrmojo.emptyFn,AC=t,z=this;if(this.checkCache&&AB){AC=function(){setTimeout(function(){z.checkCache(null,null,null,1);},100);};}var q={taskId:"setCurrentView",st:AA,did:this.did||"",mid:(w&&w.dataService&&w.dataService.msgId)||""},s=w&&w.currlaykey;if(s){q.layoutKey=s;}mstrApp.serverRequest(q,{success:AC,failure:t},{silent:true});}}}},makeHome:function M(){this.makeCurrent(true);},jumpTo:function l(p){var q=this.nextController;if(q){q.jumpTo(p);return ;}this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(p.st),p),p);},getPath:function H(){var p=this.nextController;if(p){return p.getPath();}return[];},updateItemProperties:function A(w,q,p,t){var s=this.nextController;if(s){s.updateItemProperties(w,q,p,t);}},onorientationChange:function N(){var q=this.orientation,p=this.view;if(p&&p.hasRendered&&p.rootOrientationChange){p.rootOrientationChange({isLandscape:!q});}var s=this.nextController;if(s){s.set("orientation",q);}},getCurrent:function k(){var p=this.nextController;if(p){return p.getCurrent();}return this;},goBack:function E(){var p=this.nextController;if(p){if(!p.goBack()){if(!this.rootCtrl){return false;}this.makeCurrent(true);}return true;}return false;},goUp:function S(){var p=this.nextController;if(p){return p.goUp();}return false;},getController:function Q(s,t,q){var p=this[(q?"next":"prev")+"Controller"];if(p){if(p[s]===t){return p;}return p.getController(s,t,q);}return null;},newView:function d(p,q){return mstrApp.viewFactory.newView(p,mstrmojo.hash.copy(q,{controller:this}));},getViewKey:function C(p){return{1:"Projects",2:"Home",3:"Subscriptions",4:"Settings",5:"Projects",6:"Help",8:"Subscriptions",768:"Xtab",769:"Graph",774:"Xtab",2048:"Folder",14081:"Document"}[p];},getDefaultMenus:function g(){return F;},generateActionToolbar:function K(){var p=this.rootCtrl||this,q=p.getCurrent();p.setActionToolbar(q.id,q.updateActionToolbar(mstrmojo.android.ui.ActionToolbar.newToolbarConfig()));},updateActionToolbar:function f(q){var s=this.getDefaultMenus(),p=mstrApp.getConfiguration();if(p.isMenuAllowed(Y,s)){q.addMenuItem(Y,mstrmojo.desc(9849,"Learn More"),Y,true,6);}if(p.isMenuAllowed(h,s)){q.addMenuItem(h,mstrmojo.desc(7831,"Settings"),h,true,6);}if(p.isMenuAllowed(J,s)){q.addMenuItem(J,mstrmojo.desc(1143,"Help"),J,false,9);}if(!mstrApp.isTablet()){q.maxBtnCount=(mstrApp.isLandscape())?Math.round(mstrMobileApp.getDeviceDPI()/105)+1:2;}return q;},handleMenuItem:function b(q,p){switch(q){case h:this.spawn(mstrApp.controllerFactory.newController("Settings"));break;case Y:mstrMobileApp.displayLearnMore();break;case J:mstrApp.displayHelp();break;}return false;},beforeViewVisible:mstrmojo.emptyFn,afterViewVisible:function R(){var p=this;window.setTimeout(function(){p.generateActionToolbar();},100);},beforeViewHidden:mstrmojo.emptyFn,afterViewHidden:mstrmojo.emptyFn,handleSpecialLink:function V(s){var q=s.queryKey.evt,p;if(q==="3999"){this.spawn(mstrApp.controllerFactory.newController("Settings",{}),{});}else{if(q==="3124"){mstrApp.goBack();p=true;}else{if(q==="3994"){mstrApp.displayHelp();}else{if(q==="3997"){mstrApp.rootController.jumpTo({act:8});}else{if(q==="3995"){mstrApp.rootController.goHome();p=true;}else{if(q==="3996"){mstrApp.rootController.jumpTo({act:5});p=true;}}}}}}if(p){window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);}},getDepth:function B(){var p=this.prevController;return(p&&(p.getDepth()+1))||1;},onLink:function D(s,t){var w=this.buildLinkParams(t);w.action="linkToObject";var q=false,p=768;switch(parseInt(t.evt,10)){case 4001:if(parseInt(t.reportViewMode,10)===2){p=769;}w.styleName="AndroidMessageResultStyle";break;case 32001:q=true;break;case 2048001:p=14081;break;}w.st=p;this.spawn(mstrApp.controllerFactory.newController(q?"HTMLDoc":this.getViewKey(p),{st:p}),w);},buildLinkParams:function Z(q){var s={};I.forEach(q,function(w,AB){var z=e[AB];if(AB==="Project"){var x=mstrApp.getConfiguration(),AD=q.Server,t=q.port||q.Port,AC;if(AD===undefined){var AA=x.getServerByProjectId(mstrApp.getCurrentProjectId());if(AA!==undefined){a(AA.pl,function(AE){if(w===AE.pn){if((t===undefined)||(!!t&&parseInt(t,10)===AE.sp)){AC=AE;return false;}}});}}else{AC=x.getProjectByServerAndProjectName(AD,t,w);}if(AC!==undefined){s[z]=AC.pid;}}else{if(z!==undefined){s[z||AB]=w;}}});if(mstrApp.useBinaryFormat){s.srcMsgId=q.srcMsgId;}var p=q.linkInfo;if(p&&p.so>0){s.selectorMode=p.so;s.originMessageID=q.srcMsgId;if(!q.linkAnswers){s.promptAnswerMode="0";}}return s;},exitFullScreen:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.android.medium.ui.TxButtons","mstrmojo.css");mstrmojo.android.medium.ui.TxActionButtons=mstrmojo.declare(mstrmojo.android.medium.ui.TxButtons,null,{scriptClass:"mstrmojo.android.medium.ui.TxActionButtons",selectionPolicy:"reselect",enabled:false,items:[{n:mstrmojo.desc(9252,"Delete"),v:0},{n:mstrmojo.desc(9253,"Edit"),v:1}],postselectionChange:function(A){var B=A.added;if(B&&this.enabled){this.parent.parent[((B[0])?"edit":"delete")+"Record"]();}},onenabledChange:function(A){mstrmojo.css.toggleClass(this.domNode,"enabled",A.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.medium.ui.TxButtons","mstrmojo.css","mstrmojo.array");var A;mstrmojo.android.medium.ui.TxTypeList=mstrmojo.declare(mstrmojo.android.medium.ui.TxButtons,null,{scriptClass:"mstrmojo.android.medium.ui.TxTypeList",getItemMarkup:function(){if(!A){A='<div class="item {@cls}" idx="{@idx}" style="{@style}">{@n} ({@cnt})</div>';}return A;},getItemProps:function B(E,C){var D=this._super(E,C);D.cnt=E.v;return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TxEditDoc");mstrmojo.android.large.ui.TxEditDoc=mstrmojo.declare(mstrmojo.android.ui.TxEditDoc,null,{scriptClass:"mstrmojo.android.large.ui.TxEditDoc",layoutConfig:{h:{typeNode:"100%",txNode:"100%"},w:{typeNode:"42%",txNode:"58%"}},typeSelected:function A(B){if(this.hasRendered){var D=this.btmNode,C=D.style;C.left=(this.typeNode.offsetWidth-D.offsetWidth+1)+"px";C.top=this.typeList.getItemOffset(B)+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileCheckList","mstrmojo.android._IsIncFetchList","mstrmojo.mstr.WebElements","mstrmojo.array");var D=mstrmojo.array,G=new mstrmojo.mstr.WebElements();function H(M){this.supportsIncFetch=false;delete this.ifDataHelper;if(M){if(M.items.length<M.totalSize){this.ifDataHelper=M;this.supportsIncFetch=true;}}}function C(){var M=this.height;if(!this.elasticHeight&&M){this.elasticHeight=parseInt(M,10);}}mstrmojo.android.ui.ElementsPicker=mstrmojo.declare(mstrmojo.ui.MobileCheckList,[mstrmojo.android._IsIncFetchList],{scriptClass:"mstrmojo.android.ui.ElementsPicker",browseElements:null,viewAll:true,glow:true,onbrowseElementsChange:function A(){H.call(this);this._ignoreSelection=true;var M=this.browseElements;if(M){var O=M.items=(M.items||[]),N=this._searchConfig;if((!N||N.exit)&&!this.viewAll){O=this.getSelectedItems();}this.set("items",O);if(N){this.glow=false;this.selectItems(N.selected,true);this.glow=true;}H.call(this,M);}else{this.set("items",[]);}this.updateScroller();this._ignoreSelection=false;},syncSelection:function F(){var M=this._searchConfig;if(M){this.selectItems(M.selected,false);}},enterSearchMode:function E(){var M=this.getSelectedItems();this._searchConfig={elements:this.browseElements,selected:M,clone:[].concat(M)};C.call(this);this.set("browseElements",G);},search:function L(M){this.set("browseElements",M);},exitSearchMode:function K(N){var M=this._searchConfig;M.exit=true;this.set("browseElements",N?M.elements:{items:M.selected});delete this._searchConfig;},clearSearch:function J(){var M=this._searchConfig;M.selected=[].concat(M.clone);this.set("browseElements",G);},postselectionChange:function B(N){var M=this._searchConfig;if(!M||this._ignoreSelection){return ;}var Q=M.selected,O=this.items,P=N.added;if(this.multiSelect){D.forEach(P,function(R){Q.push(O[R]);});D.forEach(N.removed,function(R){D.removeItems(Q,"v",[O[R]]);});}else{if(P){Q.splice(0);Q.push(O[P[0]]);}}},onviewAllChange:function I(){var N=this.getSelectedItems(),M;if(this.viewAll){M=this.browseElements;N=M.items;}else{C.call(this);}this.glow=false;var O=this.getSelectedItems();this.set("items",N);this.selectItems(O,true);this.glow=true;H.call(this,M);this.updateScroller();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileCheckList","mstrmojo.css");var B=mstrmojo.css,C="selected";function E(){var G=this.getSelectedItems().length,I=this.items.length,H="btnCheckSemi";if(G===0){H="btnCheckNone";}else{if(G===I){H="btnCheckFull";}}this.parent.updateTitleBarButtonClass(H);}mstrmojo.ui.MobileReviewList=mstrmojo.declare(mstrmojo.ui.MobileCheckList,null,{scriptClass:"mstrmojo.ui.MobileReviewList",listHooks:{select:function(H,I,G){mstrmojo.ui.MobileCheckList.prototype.listHooks.select(H,I,G);if(this.parent.selectionHidden){this.selectedIndices={};return true;}E.call(this);},unselect:function(H,I,G){mstrmojo.ui.MobileCheckList.prototype.listHooks.unselect(H,I,G);E.call(this);return this.selectionHidden;}},init:function F(G){this._super(G);if(this.multiSelect){B.addWidgetCssClass(this,"hidden");}},selectAll:function D(){var G="addClass",J=this.domNode.childNodes[0],I=J.childElementCount,H=0,K=true;if(this.getSelectedItems().length>0){G=("removeClass");this.selectedIndices={};K=false;}for(H=0;H<I;H++){B[G](J.childNodes[H],C);if(K){this.selectedIndices[H]=true;}}E.call(this);},touchSelectBegin:function A(G){if(this.parent.selectionHidden){this.parent.setDeleteActions("delete");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.ui.MobileCheckList","mstrmojo.array");var A='<div class="mstrmojo-SelectBoxList-item" idx="{@idx}"><h2>{@n}</h2><h4>{@v}</h4></div>';mstrmojo.android.ui.SelectBoxList=mstrmojo.declare(mstrmojo.android.SimpleList,null,{scriptClass:"mstrmojo.android.ui.SelectBoxList",selectionPolicy:"reselect",getItemMarkup:function(){return A;},getItemProps:function B(F,D){var E=this._super(F,D);E.v=F.v;return E;},postselectionChange:function C(E){var G=E.added;if(!G){return ;}var D=G[0],H=this.items[D],F=H.items,I=this.id;mstrApp.showDialog({title:H.n,children:[{scriptClass:"mstrmojo.ui.MobileCheckList",items:F,multiSelect:false,isElastic:true,selectedIndex:mstrmojo.array.find(F,"on",true),postselectionChange:function(J){mstrApp.closeDialog();mstrmojo.all[I].selectListChange(D,F[J.added[0]]);}}]});},selectListChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileCheckList","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.android._IsIncFetchList","mstrmojo.array");var D=50;function F(){return{next:function(H){var I=Math.min(this.blockEnd+D,this.totalSize);H.success(null,this.items.slice(this.blockEnd,I));this.blockEnd=I;},init:function(J,H,I){this.blockBegin=J;this.blockEnd=H;this.totalSize=I.length;this.items=I;}};}mstrmojo.android.inputControls.PullDownDIC=mstrmojo.declare(mstrmojo.ui.MobileCheckList,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton,mstrmojo.android._IsIncFetchList],{scriptClass:"mstrmojo.android.inputControls.PullDownDIC",multiSelect:false,isElastic:true,supportsIncFetch:false,init:function G(H){this._super(H);this._items=this.getItems();if(this._items.length>D){this.ifDataHelper=F();this.supportsIncFetch=true;}},postselectionChange:function C(I){var H=I.added[0];if(H<this.items.length){this.set("value",this.items[H].v);}},preBuildRendering:function A(){this._super();var J=this.value,K=this.dic.ust||"",I=this._items,H=mstrmojo.array.find(I,"v",J);if(H===-1){I=[{n:K,v:J}].concat(I);H=0;}if(this.supportsIncFetch){this.ifDataHelper.init(0,D,I);I=I.slice(0,D);}this.items=I;this.set("selectedIndex",H);},postBuildRendering:function B(){this._super();this._scroller.scrollTo(0,0);},renderPreview:function E(){var H=mstrmojo.array.find(this._items,"v",this.value),I=(H>=0)?this._items[H].n:(this.dic.ust!==undefined?this.dic.ust:this.dv);this.renderPreviewButton(this.openerNode,this.dicChanged?I:this.dv);}});}());(function(){mstrmojo.requiresCls("mstrmojo.CheckBoxDIC","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.android._HasPreviewButton","mstrmojo.dom","mstrmojo.css");var K=24,T=36,D=48,A={160:K,213:K,240:T,320:D},U={160:48,213:48,240:73,320:98},B=300,R=mstrmojo.css,O=mstrmojo.dom;function I(V){this.btnNode.innerHTML=V?this.onText:this.offText;R.toggleClass(this.btnNode,"on",V);R.toggleClass(this.btnNode,"off",!V);}function E(){if(this._animHandle){window.clearTimeout(this._animHandle);delete this._animHandle;}}function J(Y,X){this._scroller.origin.x=X;if(!Y){return ;}var V=this.scrollNode.style,W=this;this._isAnimating=true;V[O.CSS3_TRANSITION_DURATION]=Y+"ms";V[O.CSS3_TRANSFORM]=O.createTranslateString(-X);this._animHandle=window.setTimeout(function(){if(W._isAnimating){W._isAnimating=false;}E.call(W);},Y*3);}mstrmojo.android.inputControls.CheckBoxDIC=mstrmojo.declare(mstrmojo.CheckBoxDIC,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.CheckBoxDIC",cssText:"cursor:pointer;",cssDisplay:"inline-block",onText:"ON",offText:"OFF",isSwitchStyle:false,markupString:'<div id="{@id}" class="mstrmojo-Label mstrmojo-CheckBoxDIC {@cssClass}" style="{@cssText}" mstrAttach:click,keydown><div class="checkBox-android-wrapper"><div class="checkBox-android-scrollable"><div class="checkBox-androidMobile-button off"></div><div class="checkBox-label-text"></div></div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.firstChild.lastChild;},btnNode:function(){return this.domNode.firstChild.firstChild.firstChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.textNode.innerHTML=(this.text!=null)?this.text:"";}},mstrmojo.hash.copy(mstrmojo.CheckBoxDIC.prototype.markupMethods)),init:function N(W){this._super&&this._super(W);if(this.dic.stl==0){this.isSwitchStyle=true;var V=mstrMobileApp.getDeviceDPI();this.maxOffsetX=U[V];this.scrollerConfig={showScrollbars:false,showIndicators:false,vScroll:false,hScroll:true,bounces:false,useTranslate3d:false,offset:{x:{end:this.maxOffsetX,start:0},scrollPast:false}};this.minHeight=A[V]||K;}},updateScrollerConfig:function S(){if(!this.isSwitchStyle){return ;}var V=this._super(),W=this.checked?0:(this.maxOffsetX||0);mstrmojo.hash.copy({scrollEl:this.scrollNode,origin:{x:W,y:0}},V);return V;},updateScroller:function G(V,W){if(!this.isSwitchStyle){return ;}this._super(V,W);},initScroller:function M(V){if(!this.isSwitchStyle){return ;}this._super(V);var W=this;V.attachEventListener("scrollMoved",this.id,function(X){this._translateX=X.x;I.call(W,(X.x<W.maxOffsetX/2));});},oncheckedChange:function H(V){if(this.isSwitchStyle){if(this.checked&&this._scroller.origin.x!==0){J.call(this,B,0);}else{if(!this.checked&&this._scroller.origin.x!==this.maxOffsetX){J.call(this,B,this.maxOffsetX);}}I.call(this,this.checked);}this._super&&this._super(V);},preBuildRendering:function C(){this.cssClass=this.isSwitchStyle?"Android-tristate-mobile":"Android-tristate";var V;switch(this.owner.getFormats()["text-align"]){case"center":V="50%";break;case"right":V="100%";break;}if(V){this.cssText+="background-position:"+V+" 50%;";}return this._super();},postBuildRendering:function Q(){this._super();if(this.isSwitchStyle){I.call(this,this.checked);this.domNode.style.height=(this.openerStyle.ih>this.minHeight?this.openerStyle.ih:this.minHeight)+"px";}},touchTap:function P(V){this.onclick();},touchBegin:function L(V){if(!this.isSwitchStyle){return ;}if(this._isAnimating){V.stop();return false;}return this._super(V);},touchSwipeEnd:function(Z){if(!this.isSwitchStyle){return ;}Z.evt.handle=true;var Y=this._translateX,X=(Y<this.maxOffsetX/2),V=X?Y:(this.maxOffsetX-Y),W=V*B/this.maxOffsetX;J.call(this,W,X?0:this.maxOffsetX);this.set("checked",X);},setDirtyFlag:function F(W,V){if(this.isSwitchStyle){mstrmojo.css.addClass(this.domNode.firstChild||V,"tx-active");}else{this._super(W,V);}}});}());(function(){var E=1;var B=2;var J=4;var F=8;function D(L,K){var M=L.rw;if(!M){return false;}return K?(M.row.bb+M.row.bc<M.row.tc):(M.wsr+M.wmr<M.tr);}mstrmojo._XtabSeamlessIncrementalFetch=mstrmojo.provide("mstrmojo._XtabSeamlessIncrementalFetch",{_mixinName:"mstrmojo._XtabSeamlessIncrementalFetch",useSeamlessIncFetch:true,preBuildRendering:function G(){var K=true;if(this._super){K=this._super();}if(this.useSeamlessIncFetch){this.currentPageNum=0;this.currentPageNum=this.loadingPageNum=0;this.endFetching=!D(this.gridData,this.isDocXtab);}},aggregateCP:function H(N,M,K){var O=(M===J)?this.rhsCP:this.valuesCP;if(O.scriptClass!=="mstrmojo.XtabVACP"){O=mstrmojo.hash.clone(O);var L=new mstrmojo.XtabVACP();L.cps=[O,N];mstrmojo.hash.copy(L,(M===J)?this.rhsCP:this.valuesCP);}else{O.cps.push(N);}if(K){K.cp.initContent();}},onScrolledToLastRow:function C(){if(this.useSeamlessIncFetch){var L=this.currentPageNum,K=this.loadingPageNum;if(K<=L&&!this.endFetching){this.loadingPageNum=L+1;this.download(1+L);}}},download:function A(N){var P=this.gridData.rw,M=P.row,O=P.col,L=M.bc;this._isDownloading=this.rhsCP.isDownloading=this.valuesCP.isDownloading=true;if(L){var K={blockNum:N};this.controller.onDownloadGridData(this,this.model.getDownloadAction(N*L+1,L,O.bb,O.bc,this.id,K));}},dataDownloaded:function I(N,T){if(this._isDecelerating){this._cachedDownload={node:N,memo:T};return ;}var P=this._cachedDownload;if(P){if(N){alert("Missed download");}N=P.node;T=P.memo;delete this._cachedDownload;}var U=N.data,S=this.zones;this._firstRowHeight=this._firstRowHeight||this.contentNode.rows[0].offsetHeight;var M=this.initCP(U,this.interactiveCellsArray,J,U.ghs.rhs,U.gts.row,E),O=this.initCP(U,this.interactiveCellsArray,F,U.gvs);this.aggregateCP(M,J,S._BL);this.aggregateCP(O,F,S._BR);var L=M.startIndexInContainer,Q=L+M.rc-1;var R=function(V){if(V){V.start=L;V.end=Q;V.renderGrid(true);}};var K=this.id;window.setTimeout(function(){var V=mstrmojo.all[K];R(S._BL);R(S._BR);if(!D(U,V.isDocXtab)){V.endFetching=true;}V.setOffsets();V.currentPageNum++;V._isDownloading=false;},0);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.XtabZone","mstrmojo.DICFactory","mstrmojo.DynamicClassFactory");var AI=102,Q=1,J=2,o=mstrmojo.css,l=mstrmojo.dom,h=mstrmojo.hash,d=mstrmojo.DynamicClassFactory.newComponent,K=1,AK=2,H=4,e=2,V=1,B=2,AG=1,G=2,x=1,t=2,b=2,j=1,I=function(AN){if(AN){return AN.tui>=0?("h_"+AN.tui+"_"+AN.fi+"_"+AN.axis):("m_"+AN.mix);}return"";};function w(AT,AP,AQ){var AS=this.nm[AP],AO=AQ.v,AR=AQ.dv;AT.rv=AO;AT.v=AR;AT.mdf=1;if(AT._src){AT._src.rv=AO;AT._src.v=AR;AT._src.mdf=1;}var AN=this.dicGroupMap[I(AT)].widgetsMap[AT._ei];if(!AN.showByDefault){if(AN.hasPreview){AN.renderPreview();}else{if(l.isIE7&&mstrmojo.string.isEmpty(AO)){AO=" ";}AS[AS.innerText!==undefined?"innerText":"textContent"]=AO;}}return AS;}function Y(AQ,AR,AN){if(AN[AR]===0){return true;}if(AQ&&AN[AR]===undefined){try{var AO=AQ.getRowCells(AR),AS=AO&&AO[0];if(AS&&AS.o===AR){if(AS.sst){AN[AR]=0;}return !!AS.stt;}if(AS&&AS.o){return Y(AQ,AR+AR-AS.o,AN);}return false;}catch(AP){return false;}}else{return false;}}function L(AO,AN){mstrmojo.array.forEach(AO,function(AP){AN[AP.o]=1;});}function AJ(AN){if(AN.mgh&&(AN.mgh&Q)){this.mghMarks={};}}function z(AP,AR){var AO=AR.bb-1,AN=Math.min(AO+AR.bc,AR.tc),AQ;h.forEach(AP,function(AT,AS){AQ=Number(AS);if(AQ!==NaN&&AQ>=AO&&AQ<AN){delete AP[AS];}});}function AD(AQ,AP){var AN=this.editing?1:(AQ.rs||1),AO;for(AO=0;AO<AN;AO++){this.dirtyRows[AP+AO]=1;}}function AM(AN){return AN&&parseInt(AN.ipt,10)===b;}function AH(AN){var AP=this.zones._BR,AO=this.zones._BL;if(!AO){return AP.getRowIdxByCell(AN);}else{if(AP.posMap&&AP.posMap[AN._ei]){return AP.getRowIdxByCell(AN);}else{return AO.getRowIdxByCell(AN);}}}mstrmojo._IsEditableGridCP={_mixinName:"mstrmojo._IsEditableGridCP",initContent:function AE(AQ){this._super(AQ);var AW=this.gridData,AO=AW&&AW.vp,AU,AT,AV,AY,AN,AX,AP,AS;if(((this.type===K)||(this.type===H))&&AO&&AO.cols&&!AO._adjusted){AN=AO.cols.cg;AP=AO.cols.cws;if(AN&&AN.cgc>0){for(AU=AN.cgc;AU>0;AU--){AN[AU]=h.copy(AN[AU-1],{});AX=AN[AU];var AR=AX.attForms;if(AR){for(AT=0,AY=AR.length;AT<AY;AT++){AV=AR[AT];AV.idx+=1;}}}AN[0]={tg:false,cc:0,cl:1,attForms:[{n:"",idx:0}]};AN.cgc+=1;}if(AP){AP.splice(0,0,{w:"60px",xc:true});}if(AO.dafIdx!==undefined){AO.dafIdx+=1;}AS=AW.gts.row;for(AU=0,AY=AS.length;AU<AY;AU++){AS[AU].ci=AU+1;}AO._adjusted=true;}this.colWidths=[{w:""}].concat(this.colWidths);this.unmergedCells=[];},getUnmergedCells:function Z(){return null;},getRowCells:function AB(AX){var AP=this._super(AX),AN=AP[0],Ab=(AN&&AN.o)||0,AY=(this.tp===K),AS=this.interactiveCellsArray,Aa={css:"",v:""},Ae=[],AO=[],Af,Ag;if(!AY){var AU=this.base.items,Ad=this.lookupBase,Ac=this.gridData.css,Aj=AN&&AN.pi,AZ=Aj&&Aj.ri,Ai=Aj&&Aj.ci,AV=AN.stt>0;while(Aj&&AZ>-1&&Ai>-1){AN=AN._p||AU[AZ].items[Ai];var AQ=h.copy(AN,{});AQ._src=AN;if(!AQ.css){AQ.css=Ac[AQ.cni].n;}var AW=Ad[AN.tui],Ah=AW&&AW.es[AN.idx];if(Ah){AQ.v=AN.v||Ah.n;AQ._e=Ah;}AQ.rs=1;if(AV){AQ.at&=~32;}if(Ab>-1){AQ.o=Ab;}if(!AQ.axis&&this.axis){AQ.axis=this.axis;}AQ._ei=AS.push(AQ)-1;Ae.splice(0,0,AQ);Aj=AN&&AN.pi;AZ=Aj&&Aj.ri;Ai=Aj&&Aj.ci;}for(Af=0,Ag=AP.length;Af<Ag;Af++){var AR=AP[Af];if(AR.rs>1){var AT=h.copy(AR,{});AT.rs=1;AR=AT;}AO.push(AR);}}else{AO=AP;if(AX>0){return AP;}}if(AO[0]){Aa=h.copy(AO[0],{});Aa.rv=Aa.v="";if(this.tp===K){Aa.n=Aa.v="";Aa.markAll=true;}else{Aa.n="";}Aa._ei=AS.push(Aa)-1;Aa.at=32;Aa.cs=1;Aa.mark=true;Aa.mix="x";Aa.css=(Ae[0]&&Ae[0].css)||Aa.css;delete Aa.ui;delete Aa.tui;delete Aa.fs;delete Aa.mdf;}return[Aa].concat(Ae.concat(AO));}};mstrmojo._IsEditableXtab={_mixinName:"mstrmojo._IsEditableXtab",update:function AA(AP){var AN,AO=AP.data;if(this._super){this._super(AP);}this.kc={};this.rs={};this.rsDelta={};AJ.call(this,AO);if(AO.eg!==undefined){return ;}AN=AP.data.marked;if(AN){L(AN,this.rs);}if(!AO.rw){var AQ=AO.gvs.items.length;AO.rw={row:{bb:1,bc:AQ,tc:AQ},col:{bb:-1,bc:-1,tc:0}};}},initCP:function E(AP,AO,AU,AR,AT,AQ,AS){var AN={gridData:AP,type:AU,interactiveCellsArray:AO};AN.base=AR||AN.base;AN.lookupBase=AT||AN.lookupBase;AN.axis=AQ||AN.axis;AN.dataSource=this;if(!AS){if(this.tca===J&&this.editing){if(AU===K){mstrmojo.EditableXtabTitlesCP=d(mstrmojo.XtabTitlesCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabTitlesCP",tp:K});AS=new mstrmojo.EditableXtabTitlesCP(AN);}else{if(AU===H){mstrmojo.EditableXtabCP=d(mstrmojo.XtabCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabCP"});AS=new mstrmojo.EditableXtabCP(AN);}else{AS=new mstrmojo.XtabCP(AN);}}}else{if(AU===K){AS=new mstrmojo.XtabTitlesCP(AN);}else{AS=new mstrmojo.XtabCP(AN);}}}else{h.copy(AN,AS);}return AS;},createOnDemandCP:function p(AO,AP,AN){var AQ;if(this.tca===J&&this.editing&&AN===H){mstrmojo.EditableXtabOnDemandCP=d(mstrmojo.XtabOnDemandCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabOnDemandCP"});AQ=new mstrmojo.EditableXtabOnDemandCP();}else{AQ=new mstrmojo.XtabOnDemandCP();}AQ.dataSource=this;AQ.blockNum=AO;AQ.rc=AP;return AQ;},preBuildRendering:function C(){var AN=this.defn.txi;if(this._super){this._super();}this.txar=AN.txar;this.sci=AN.sci;this.tca=AN.tca;if(this.tca!==J){this.editing=false;}else{if(mstrApp.isMobile){this.editing=this.alwaysEditing=true;}}this.nm={};this.ko={};this.dirtyRows={};this.requiredCellsMap={};this.dicGroupMap={};this.lastIndex=0;this.lastHeaderIndex=0;this.columnNames={};},postBuildRendering:function X(){if(this._super){this._super();}if(this.tca===J&&this.gridData.eg===undefined){var AP=Math.max(-16,-this.domNode.offsetTop),AQ=this;if(!this.alwaysEditing){var AN=mstrmojo.Button.newIconButton(mstrmojo.desc(8324,"Mark rows"),"mstrmojo-EditButton",function(){if(!AQ.recalculating){AQ.editing=!AQ.editing;AQ.refresh();}}),AO=new mstrmojo.Button(mstrmojo.hash.copy({cssText:"top:"+AP+"px;"},AN));AO.render();this.domNode.appendChild(AO.domNode);if(this.editing){this.domNode.style.zIndex=1000;o.addClass(AO.domNode,"close");}else{o.removeClass(AO.domNode,"close");}}}},dataDownloadErr:function M(){if(this.txar&&this.recalculating){var AN=this.zones;if(AN._BL){AN._BL.isDownloading=false;}AN._BR.isDownloading=false;this.rhsCP.initContent();this.valuesCP.initContent();o.removeClass(this.maskNode,"wait");this.recalculating=false;}},dataDownloaded:function T(AR,AP){var AQ=AR.data;if(this.txar){var AN=AP.blockNum,AO=this.zones,AS;if(this.recalculating){AP.recalculating=true;this.interactiveCellsArray=[];this.requiredCellsMap={};this.dirtyRows={};this.lastIndex=0;this.lastHeaderIndex=0;this.kc={};this.nm={};this.updatedCellsMap={};this.recalculating=false;this.destroyDICs();}else{AP.recalculating=false;}if(AN===0){this.gridData=AQ;}if(AQ.eg){this.refresh();return ;}AS=this.interactiveCellsArray;this.initCP(AQ,AS,K,null,null,null,this.titlesCP);this.initCP(AQ,AS,AK,AQ.ghs.chs,AQ.gts.col,e,this.chsCP);this.titlesCP.initContent();this.chsCP.initContent();if(AS&&AS.length===0){if(AO._TR){AO._TR.refresh();}if(AO._TL){AO._TL.refresh();}}}if(this._super){this._super(AR,AP);}AJ.call(this,AQ);z(this.rs,AQ.rw.row);if(AQ.marked){L(AQ.marked,this.rs);this.rsDelta={};}},closeDownloadStatus:function W(){if(this._super){this._super();}mstrmojo.css.removeClass(this._STATUS,"recalculate");},kc:null,ko:null,nm:null,rs:null,dicGroupMap:null,lastIndex:0,lastHeaderIndex:0,columnNames:null,getDataInputInfo:function g(Ab,AZ){var AQ=Ab._ei,AO,AT=this.node.defn,AR=this.gridData;if(Ab.mark){AO=Ab.o;if(Ab.stt){this.rs[AO]=0;return ;}this.ko[AO]=AQ;Ab.rv=Ab.v=this.rs[AO]||-1;this.kc[AQ]={rowop:true};return{key:AQ,t:AI,vls:[{v:-1},{v:1}],wm:1,w:22,hm:1,h:16,dm:1};}var AP=this.model.getCellTitleInfo(Ab,this.dataBlocks[Ab._gd]),AY=AP&&AP.title,Aa=AY&&AY.es,AX=(Ab.mti!==undefined)?Ab.mti:Ab.mix,AN=(Ab.mix!==undefined),Ac=AT.txi.dic,AU;AU=!AN?Ac.att&&AY&&Ac.att[AY.id]&&Ac.att[AY.id][AY.fs[Ab.fi].id]:Ac.mtx&&Ac.mtx[Aa[AX].oid];if(!AU){return null;}if(this.columnNames[AZ]===undefined){this.columnNames[AZ]=!AN?AY.n:Aa[AX].n;}if(AM(AU)){AU.vls=(AR.dcv&&AR.dcv[AU.k])||[];}if(AQ>=0&&!this.kc[AQ]){var AV=!Ab.axis,Ad={isMv:AV};if(AV){var AS=Ab.pi,AW=AS&&AS.top;Ad.co=(AW&&AW.ci)||0;Ad.metric_id=Aa[AX].oid;Ab.o=Ad.o=(Ab._lp&&Ab._lp.o)||0;Ad.tp=B;}else{Ad.ax=Ab.axis;Ad.atid=AY.id;Ad.form_id=AY.fs[Ab.fi].id;Ad.o=Ab.o;Ad.tp=V;Ad.fi=Ab.fi;Ad.ui=Ab.ui;Ad.tui=Ab.tui;Ad.rs=Ab.rs;}Ad.dt=AU.dt;if(AM(AU)){Ad.vls=AU.vls;Ad.k=AU.k;}this.kc[AQ]=Ad;}AU.key=AQ;if(AU.dm){AU.dm=parseInt(AU.dm,10);}return AU;},isEditableHeader:function F(AN){var AO=this.node.defn,AP=AO.txi.dic;if(AN.sst||!AP){return false;}if(AN.id!==undefined&&AP.att){return !!(AP.att[AN.id]&&(AN.fix?AP.att[AN.id][AN.fid]:AP.att[AN.id]));}if(AN.tui!==undefined&&AN.mix!==undefined&&AP.mtx){return !!(AP.mtx[AN._e.oid]);}return false;},dataChanged:function P(AO,AP,AN,AQ){if(!this.recalculating){if(AQ){this.nm[AO]=AQ;}if(this._super){this._super(AO,AP,AN,AQ);}}},updateValue:function f(AQ,AO){if(this._super){this._super(AQ,AO);}var AU=this.interactiveCellsArray[AQ],AY=AO.v,AZ,AN=AH.call(this,AU);this.lmr=null;AZ=w.call(this,AU,AQ,AO);if(AU.r!==AY){if(!AU.mark){AU.mdf=1;mstrmojo.css.removeClass(AZ,"required");AD.apply(this,[AU,AN]);this.flagDirtyUnit(AZ);}}else{this.clearDirtyUnit(AZ);}if(this.tca===J){if(AU.mark){var AS=AU.markAll?-1:AU.o,AW=this.rsDelta;this.rs[AS]=AY;this.lmr={r:AS,v:AY};if(AU.markAll){AW=this.rsDelta={};AW[AS]=AY;this.mghMarks={};}else{if(AW[AS]&&AW[AS]!==AY){delete AW[AS];}else{if(AW[-1]!==AY){AW[AS]=AY;}}}}else{if(this.rs[AU.o]!==0){this.rs[AU.o]=1;}if(!this.editing&&this.mghMarks&&(AU.mix===undefined)){if(!this.mghMarks[AU.o]||this.mghMarks[AU.o].rs<AU.rs){this.mghMarks[AU.o]={o:AU.o,rs:AU.rs,k:AQ};}var AR,AV,AT=this;h.forEach(this.rsDelta,function(Aa,Ab){AR=parseInt(Ab,10);AV=parseInt(AU.o,10);if(AR>=AV&&AR<=(AV+AU.rs)){delete AT.rsDelta[Ab];}});}else{this.rsDelta[AU.o]=1;}if(!this.editing&&AU.rs>1){var AP=AU.o+1;while(AP-AU.o<AU.rs){if(!Y(this.rhsCP,AP,this.rs)){this.rs[AP]=1;}AP+=1;}}if(this.editing){var AX=this.dicGroupMap.m_x.widgetsMap[this.ko[AU.o]];if(AX){AX.set("checked",true);}}}}if(this.txar&&!AU.mark){return true;}return false;},autoRefresh:function AC(){var AN=this.zones;if(AN._BL){AN._BL.invalidAllPages();}AN._BR.invalidAllPages();this.rhsCP.invalid();this.valuesCP.invalid();o.addClass(this._STATUS,"recalculate");AN._BR.onscroll(true);this.recalculating=true;},getKeyContext:function O(AN){return this.kc[AN];},getUpdateObject:function R(){var AR=[],AP,AS,AT,AN=this.lmr,AO,AQ={};if(AN){this.lmr=null;return{manipulation:AG,actionType:(AN.v===-1)?x:t,rowOrdinal:AN.r,nodeKey:this.k,sliceId:this.sid};}AS=this.getUpdatedValues();for(AP=0;AP<(AS&&AS.length);AP++){if(!AS[AP].rowop){AT=AS[AP];break;}}if(AT){AO=mstrmojo.string.encodeXMLAttribute(String(AT.v));if(AT.k!==undefined&&AT.vls){AQ={controlKey:AT.k,elementId:AT.vls[mstrmojo.array.find(AT.vls,"v",AT.v)].eid};}if(!!AT.isMv){AR.push(h.copy(AQ,{rowOrdinal:AT.o,colOrdinal:AT.co,newValue:AO,dataType:AT.dt}));}else{AR.push(h.copy(AQ,{rowOrdinal:AT.o,attId:AT.atid,formId:AT.form_id,unitIndex:AT.tui||AT.ui,newValue:AO,dataType:AT.dt}));}}return{manipulation:G,nodeKey:this.k,sliceId:this.sid,cells:AR,autoRefresh:this.txar};},getUpdates:function S(){var AX=this,AS,AT,AN=AX.getUpdatedValues(),AQ=this.rsDelta,AR=[],AW=[],AU=false,AP="";AR.push('<gr rw_tree_type="'+AX.treeType+'" rw_node_key="'+AX.k+'" slice_id="'+AX.sid+'">');for(AS in AN){if(AN.hasOwnProperty(AS)){AT=AN[AS];if(!AT.rowop){var AY=mstrmojo.string.encodeXMLAttribute(String(AT.v));if(AT.k&&AT.vls){var AO=mstrmojo.array.find(AT.vls,"v",AT.v);AP='rw_control_key="'+AT.k+'" element_id="'+AT.vls[AO].eid+'" ';}if(!!AT.isMv){AW.push('<cli cordinal="'+AT.co+'" metric_id="'+AT.metric_id+'"><updt types="'+AT.tp+'" rordinal="'+AT.o+'" '+AP+'value="'+AY+'" dt="'+AT.dt+'"/></cli>');}else{AW.push('<cli ax="'+AT.ax+'" attribute_id="'+AT.atid+'" form_id="'+AT.form_id+'"><updt types="'+AT.tp+'" ordinal="'+AT.o+'" '+AP+'value="'+AY+'" dt="'+AT.dt+'"'+(this.mghMarks?' flags="1"':"")+"/></cli>");}AU=true;}}}if(!h.isEmpty(this.mghMarks)){var AV=this;h.forEach(this.mghMarks,function(AZ,Aa){AP=AV.getKeyContext(AZ.k);AW.push('<mark rordinal="'+Aa+'" types="4" flags="1" attribute_id="'+AP.atid+'" form_id="'+AP.form_id+'"/>');});}if(AQ&&!h.isEmpty(AQ)){AU=true;h.forEach(AQ,function(AZ,Aa){if(AZ===1){AW.push('<mark rordinal="'+Aa+'" types="4"/>');}else{AW.push('<mark rordinal="'+Aa+'" types="5"/>');}});}AR.push(AW.join(""));AR.push("</gr>");if(!AU){AR=[];}return AR.join("");},flagDirtyUnit:function a(AO){if(AO&&this.sci){if(this._super){this._super(AO);return ;}var AN=document.createElement("div"),AS,AP=false,AR=o.getStyleValue(this.domNode,l.CSS3_TRANSFORM),AQ;AN.className="flag-container";AN.innerHTML='<div class="dirty-cell"/>';if(AO.insertBefore){AO.insertBefore(AN,AO.firstChild);AQ=(AN.offsetParent===AO);}AP=mstrmojo.string.isEmpty(AR)||AR==="none";AS=AN.firstChild;AS.style.top=((!AP||AQ)?(-AN.offsetTop):(AO.offsetTop-AN.offsetTop))+"px";AS.style.left=(AO.clientWidth+((!AP||AQ)?(-AN.offsetLeft):(AO.offsetLeft-AN.offsetLeft))-8)+"px";}},clearDirtyUnit:function AL(AN){if(this._super){this._super(AN);return ;}var AO=AN.firstChild;if(AN){if(AO&&AO.className&&AO.className==="flag-container"){AN.removeChild(AO);}}},onvisibleChange:function q(){if(this.visible===true){var AN=this;setTimeout(function(){AN.configureActions();},10);}},configureActions:function U(){if(this.visible===false){return ;}var Ah="_BR",AN=this.zones[Ah],AW=!!this.zones._BL,AZ=AN.posMap,AS=AN.thPosMap,AV=this.interactiveCellsArray,Ab=this.dicGroupMap,Aa=[],AQ,Ag,Af,Ae,AO,AU,Ac,AT,AP,Al,Aj,Ai,Ak=this,AX=function(Am){var Ao=Am.length,An;for(An=0;An<Ao;An++){Ak.flagDirtyUnit(Am[An]);}};for(AQ=this.lastIndex,Ag=AV.length;AV[AQ]&&AQ<Ag;AQ++){AO=AV[AQ];AU=AZ&&AZ[AQ];if(!AU&&AW){Ah=(Ah==="_BR")?"_BL":"_BR";AN=this.zones[Ah];AZ=AN&&AN.posMap;AS=AN&&AN.thPosMap;AU=AZ&&AZ[AQ];}if(AU&&((AO.at&32)>0)){Ac=AN.getNodeByPosition(AU);AO.at=32;if(AO.rv==null){AO.rv=isNaN(AO.mix)?AO._e.n:AO.v;}AT=I(AO);Aj=this.getDataInputInfo(AO,AT);Ai=this.dicGroupMap[AT];if(Aj){if(!Ai){Ai=Ab[AT]=mstrmojo.DICFactory.createDICGroup({gk:AT,dic:Aj,owner:this,openerType:j});}var Ad={value:(AO.rv===undefined)?(AO.v||AO.n):(typeof AO.rv==="string"?mstrmojo.string.decodeHtmlString(AO.rv):AO.rv),dv:AO.v||AO.n,ts:AO.ts,markAll:AO.markAll,openerNode:Ac,k:AO._ei,ownerCell:AO,popupTitle:this.columnNames[AT]},AR=AN.cp.stackedRh;if(AR&&AO.singleStack&&(mstrmojo.DICConfig.showDICByDefault(Aj,1)||mstrmojo.DICConfig.hasDICPreview(Aj,1))){var AY=Ac.offsetHeight;Ac.className+=" igDIC";Ac.style.cssText="height:"+AY+"px;";mstrmojo.hash.copy({inlineExtraCssText:"position:absolute;top:"+parseInt(AR/2-AY/2+1,10)+"px;"},Ad);}Ai.addDIC(AO._ei,Ad);AP=AU.page*AN.rowsPerPage+AU.row;if(Aj.req){for(Ae=0;Ae<(this.editing?1:(AO.rs||1));Ae++){Al=this.requiredCellsMap[AP+Ae];if(!Al){this.requiredCellsMap[AP+Ae]=Al=[];}Al.push(AO);}}if(AO.mdf){Aa.push(Ac);AD.apply(this,[AO,AP]);}}}}this.lastIndex=AQ;for(AT in Ab){Ab[AT].render();}setTimeout(function(){AX(Aa);},25);for(Af=this.lastHeaderIndex,Ag=AS.length;Af<Ag;Af++){AU=AS[Af];Ac=AN.getNodeByPosition(AU);AO=AU.obj;if(this.isEditableHeader(AO)){Ac.innerHTML='<div class="editable-column">'+Ac.innerHTML+"</div>";}}this.lastHeaderIndex=Af;this.registerTxWidget();if(this._super){this._super();}},showPopupDIC:function A(AQ){var AO=AQ&&l.findAncestorByAttr(AQ,"ei",true,this.viewport);if(AO){var AR=AO.node,AN=this.getCellForNode(AR),AP=this.dicGroupMap[I(AN)];if(AP){AP.showPopupDIC(AN._ei);return true;}}return false;},onclick:function AF(AO){var AN=mstrmojo.dom.eventTarget(window,AO.e);if(!this.showPopupDIC(AN)&&this._super){this._super(AO);}},unrender:function D(){if(this._super){this._super();}this.destroyDICs();},destroyDICs:function s(){var AN=this.dicGroupMap;this.dicGroupMap={};setTimeout(function(){var AO;for(AO in AN){AN[AO].destroy();}},10);},checkRequiredObjects:function N(){if(this.hasRendered&&!(this.isInteractiveGrid&&this.isInteractiveGrid())&&!this.gridData.eg){var AP=this.zones._BR,AR=AP.posMap,AT,AQ=this,AO=this.rs,AN=true,AS=function(AZ,AV){var AY=true,AW=AQ.requiredCellsMap[AZ],AU=(AW&&AW.length)||0,AX;for(AX=0;AX<AU;AX++){if(!AW[AX].mdf){o.toggleClass(AP.getNodeByPosition(AR[AW[AX]._ei]),"required",AV);AY=!AV;}}return AY;};if(this.tca===J){for(AT in AO){AN=AS(parseInt(AT,10)+1,AO[AT]>0)&&AN;}}else{for(AT in this.dirtyRows){AN=AS(AT,true)&&AN;}}return AN;}return true;},editNext:function k(AP){if(this.recalculating){return false;}var AQ=this.interactiveCellsArray,AN=AQ.length,AR=AP+1,AS,AO;do{if(AR>=AN){AR%=AN;}if(AR===AP){return false;}AS=AQ[AR];var AT=this.dicGroupMap[I(AS)];if(AT){if(mstrmojo.DICConfig.isKeyNavigable(AT.dic)){if(!AT.showByDefault){AT.showPopupDIC(AR);}else{AO=AT.widgetsMap[AR];AO.focus();}return true;}}AR++;}while(true);}};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo.dom");var Q=1;var W=2;var X=0;var A=1;var AC=2;var M=3;var L=1;var AE=2;var G=4;var f=8;var b=mstrmojo.dom,t;function AI(AJ){var AK=null;if(AJ&&AJ.length>1){AK=new mstrmojo.XtabVACP();AK.cps=AJ;}return AK;}function P(AK){var AJ=document.createElement("img");AK.appendChild(AJ);AK.removeChild(AJ);}function I(AK,AJ){if(b.isIE){return mstrmojo.boxmodel.convert2px(AK,AJ);}return AJ;}function H(AK){if(!AK||this._onDemandCP){return ;}var AR=AK.bc,AP=AK.tc,AL=AP-AR,AQ=Math.ceil(AL/AR),AM=[],AO=[],AN;for(AN=0;AN<AQ;++AN){var AJ=Math.min(AL,AR);AM.push(this.createOnDemandCP(AN+1,AJ,G));AO.push(this.createOnDemandCP(AN+1,AJ,f));AL-=AR;}this._onDemandCP={rhs:AM,vls:AO};return this._onDemandCP;}mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasScrollbox,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",handleClicks:function F(){return true;},markupString:'<div id="{@id}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div>&nbsp;</div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart><table cellspacing="0" cellpadding="0"><tr trType="title"><td style="vertical-align:top;padding:0px"></td><td class="xtab-tr" style="vertical-align:top;padding:0px;"></td></tr><tr trType="content"><td class="xtab-bl" style="vertical-align:top;padding:0px;"></td><td class="xtab-br" style="vertical-align:top;padding:0px"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_TL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];},_TR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[1];},_BL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[0];},_BR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].lastChild;},_T_ROW:function(){return this.domNode.lastChild.firstChild.rows[0];},_B_ROW:function(){return this.domNode.lastChild.firstChild.rows[1];},_BR_CELL:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1];},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[1].cells[1].firstChild.firstChild.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zones:null,lockHeadersCase:M,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function p(AJ){return(AJ.o!==undefined)?AJ.o:AJ._ei;},getCellTitleId:function d(AJ){var AK="";if(AJ.axis&&AJ.ui!==undefined){AK=AJ.axis+"A"+(AJ.ui+1);}else{if(AJ.mix!==undefined){AK="0A"+AJ.mix;}}return AK;},update:function k(AK){if(this._super){this._super(AK);}this.set("gridData",AK.data[0]||AK.data);var AJ=this.defn||AK.defn;this.sid=this.gridData.sid;this.treeType=(AJ&&AJ.tt)||1;this.interactiveCellsArray=[];},initCP:function D(AL,AK,AQ,AN,AP,AM,AO){var AJ={gridData:AL,type:AQ,interactiveCellsArray:AK};AJ.base=AN||AJ.base;AJ.lookupBase=AP||AJ.lookupBase;AJ.axis=AM||AJ.axis;if(!AO){if(AQ===L){AO=new mstrmojo.XtabTitlesCP(AJ);}else{AO=new mstrmojo.XtabCP(AJ);}}else{mstrmojo.hash.copy(AJ,AO);}return AO;},preBuildRendering:function B(){var AJ=this.gridData;this.lockHeadersCase=parseInt(AJ.lhv,10);this.selections={};this.cssDefault=(this.lockHeadersCase===X||!this.k)?"":"r-cssDefault"+(this.k?"_"+this.k:"");this.numRowFixed=!!(!this.height&&AJ.rw&&AJ.rw.row&&(AJ.rw.row.bc<AJ.rw.row.tc));this.rw=AJ.rw;this._onDemandCP=null;if(this.width){this.widthLimit=parseInt(this.width,10);}if(this.height){this.heightLimit=parseInt(this.height,10);}return(this._super)?this._super():true;},renderEmptyGrid:function w(){var AL=this.gridData,AK=this.msgNode,AJ=this.viewport;AK.firstChild.innerHTML=AL.eg;AK.style.display="block";AK.style.overflow="hidden";AK.className="mstrmojo-message";AJ.style.display="none";return(this._super)?this._super():true;},postBuildRendering:function q(){var AR=this.gridData,AN=!!this._BR&&AR,AJ=this.msgNode,AO=this.viewport,AP;if(AR.eg===undefined){if(AJ.style.display==="block"){AJ.style.display="none";AO.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AN){this._setupZones(AR);this._setupCPs(AR);var AM=this.zones,AK;for(AK in AM){var AQ=AM[AK];if(AQ.parent!==this){this.addChildren(this.zones[AK]);}}if(this.scrollboxNode){var AL=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AL)&&(AL>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AL;}this.scrollboxLeft=this.scrollboxTop=0;if(this.lockHeadersCase){this.connectScrollbox(this);}}}this.renderChildren();AP=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zones._BR.getPageHeight(0)+(this._TR?this._TR.offsetHeight:0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if((this.lockHeadersCase&&AN&&this.scrollboxNode)||this.numRowFixed){this.resizeScrollBox(b.isIE);}this.onGridWidthChanged(true);if(b.isIE7&&!this.scrollboxHeightFixed&&this.scrollboxNode&&this.scrollboxNode.scrollWidth>this.scrollboxNode.offsetWidth){this.scrollboxNode.style.height=this.scrollboxNode.offsetHeight+17+"px";}return AP;},onclick:function s(AN,AK){if(!this.interactiveCellsArray.length){this.isSelectingText=false;return ;}AN=AN.e||AN;var AL=mstrmojo.dom,AO=AL.eventTarget(AK,AN),AM=AO&&AL.findAncestorByName(AO,"td",true,this.viewport);if(AO.nodeName.toLowerCase()==="a"&&AM.getAttribute("ei")){try{var AP=this.interactiveCellsArray[parseInt(AM.getAttribute("ei"),10)];var AJ=7;if(AP&&AP.ts===AJ){AO.href=mstrmojo.addCSRFTokenToURL(AO.href);}}catch(AR){}}if(AM){var AQ=AL.findAncestorByName(AO,"span",true,AM);if(AQ&&!AL.shiftKey(AK,AN)&&!AL.ctrlKey(AK,AN)){this.defaultAction(AM);}else{this.doSelection(AN,AK,AM);if(!this.isSelectingText){AL.clearBrowserHighlights();}}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function g(AK,AJ){this.onclick(AK,AJ);},onselectstart:function x(){this.isSelectingText=true;return false;},onscroll:function z(){this._alignHeaders();},resizeScrollBox:function J(AL){var AJ=this.scrollboxNode,AU=AJ&&AJ.style,Aa=this._B_ROW,AZ=this._BR_CELL;if(!AU||!Aa||!AZ){return ;}var AT=this.widthLimit,AS=this.heightLimit;if(!AT||!AS){if(!AT){AU.width="auto";}if(!AS){AU.height="auto";this.scrollboxHeightFixed=false;}}if(AS){var AR=(this.zones._TR&&this.zones._TR.cp.rc)?Aa.offsetTop:0,AW=AS-AR;if(AW>0){AU.height=AW+"px";this.scrollboxHeight=AW;this.scrollboxHeightFixed=true;if((this.lockHeadersCase!==X)&&this.numRowFixed){this.viewport.style.height=this.overlayNode.style.height=(AW+AR)+"px";}}}if(!this.useTouchScrolling){var AK=(this.zones._BL&&this.zones._BL.cp.rc)?AZ.offsetLeft:0;var AY=0;if(this.lockHeadersCase!==X){var AX=this.viewport,AM=mstrmojo.css.getComputedStyle(AX),AV=["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"];if(AM){mstrmojo.array.forEach(AV,function(Ab){AY+=parseFloat(I(AX,AM[Ab]));});}if(this.width){this.viewport.style.width=(parseFloat(this.width)-(AY||0))+"px";}}var AN=(this.widthLimit&&(this.widthLimit-AK))||(mstrmojo.dom.isIE7?AZ.scrollWidth+1:(AZ.scrollWidth+(AJ.offsetWidth-AJ.clientWidth)));if(AN&&(AN>0)){AN-=AY;AU.width=AN+"px";}this._alignHeaders(AL);}var AQ=AU.height,AP=AU.width;if(AQ||AP){var AO=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection);if(AO){AO.fixedSizeCanGrowShrink(this,AQ,AP);}}},_resizeScrollBoxWidth:function U(){var AO=this.scrollboxNode,AL=AO&&AO.style,AK=this._B_ROW,AJ=this._BR_CELL;if(this.useTouchScrolling||!AL||!AK||!AJ){return ;}var AM=this.widthLimit;if(!AM){AL.width="auto";}var AN=function(){var AP=(mstrmojo.dom.isIE7?AJ.scrollWidth+1:(AJ.scrollWidth+(AO.offsetWidth-AO.clientWidth)));if((AP&&(AP>0))&&(!AM||(AM&&(AP<AM)))&&(AO.firstChild.firstChild.offsetWidth>=AO.clientWidth)){AL.width=AP+"px";}};if(mstrmojo.dom.isIE7){window.setTimeout(function(){AN();},1);}else{AN();}},onGridWidthChanged:function Z(AL){if(this.lockHeadersCase===X&&!AL){this._resizeScrollBoxWidth();}var AK=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AJ=this.widthLimit;if(!AJ){this.width=t;if(AK){AK.performCanGrowCanShrink([this],true);}}else{if(AK){AK.fixedSizeCanGrowShrink(this,null,AJ);}}},getGridDimension:function R(AM){var AK=1,AL=AM===AK?"Height":"Width",AN=AL.toLowerCase(),AJ=this[AN+"Limit"];if(!AJ&&(this[AN]===t||this[AN]===0)){AJ=this.viewport["offset"+AL];this[AN]=AJ+"px";return AJ;}return AJ||parseInt(this[AN],10);},_alignHeaders:function o(AK){if(this.lockHeadersCase===X||this.useTouchScrolling){return ;}var AN=this.scrollboxLeft,AM=this.scrollboxTop,AL=this.zones,AJ=AL._TR,AO=AL._BL;function AP(AQ,AU,AR){var AT=AQ&&AQ.domNode,AS=AT&&AT.style;if(!AS){return ;}AS[AU]=-AR+"px";}if(AJ&&AJ.rc){AP(AJ,"left",AN);}if(AO&&AO.rc){AP(AO,"top",AM);}if(AK){P(this._BL);}},defaultAction:function S(AO,AK){var AJ=AK||this.getCellForNode(AO),AN=AO&&AO.className.indexOf("sc_")>0,AM=this.model.getAction(this.getActionCells(AJ),AO,AN),AL=AM&&AM.h;this._currentSelectedTD=AO;if(AL&&this.controller[AL]){this.controller[AL](this,AM.a);return true;}return false;},createZone:function l(AJ){return new mstrmojo.XtabZone(AJ||{});},_setupZones:function j(AM){var AK=this.zones;this.zones={};var AO=this.zones,AJ=this.lockHeadersCase,AQ="z-index:";var AL=this;function AP(AU,AT,AV,AS){var AR=(AS&&AS[AV])||AL.createZone({renderMode:AU,cssText:AT,slot:AV});AO[AV]=AR;AR.rh=AM.rh;}AP(this.dataRenderMode,AQ+"1;","_BR",AK);if(AJ&A){AP(this.dataRenderMode,AQ+"3;","_BL",AK);}if(AJ&AC){AP(null,AQ+"3;","_TR",AK);}if(AJ===M){AP(null,AQ+"4;","_TL",AK);}if(AJ===X){this.zones._BR.autoFitWindow=!!AM.afw;this.zones._BR.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}if(mstrmojo.dom.isIE7){if(AJ&A||AJ&AC||AJ===M){this._T_ROW.style.display="block";}else{if(AJ===X){this._T_ROW.style.display="none";}}}var AN=AO._BL||AO._BR;if(AN){AN.numColumnCanMerge=AM.gts.cws.length-1;}},getHACP:function AH(){return(this._super&&this._super())||new mstrmojo.XtabHACP();},_setupCPs:function V(AR){var AM=this.titlesCP=this.getTitleCP(AR),AO=this.chsCP=this.getColumnHeadersCP(AR),AK=this.rhsCP=this.getRowHeadersCP(AR),AL=this.valuesCP=this.getValuesCP(AR);AM.forceAutoRowHeight=AO.forceAutoRowHeight=AR.rh;var AP=this.zones;switch(this.lockHeadersCase){case X:var AV=new mstrmojo.XtabVACP();var AJ=this.getHACP();AJ.cps=[AM,AO];AV.cps=[AJ];var AT=this.getHACP();AT.cps=[AK,AL];AV.cps.push(AT);AP._BR.cp=AV;break;case A:var AS=new mstrmojo.XtabVACP();var AN=new mstrmojo.XtabVACP();AS.cps=[AM,AK];AN.cps=[AO,AL];AP._BL.cp=AS;AP._BR.cp=AN;break;case AC:var AQ=this.getHACP();var AU=this.getHACP();AQ.cps=[AM,AO];AU.cps=[AK,AL];AP._TR.cp=AQ;AP._BR.cp=AU;break;case M:AP._TL.cp=AM;AP._TR.cp=AO;AP._BL.cp=AK;AP._BR.cp=AL;break;}},ongridDataChange:function Y(){var AJ=this.model;if(AJ){AJ.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:mstrmojo.emptyFn,getTitleCP:function E(AJ){return this.initCP(AJ,this.interactiveCellsArray,L);},getColumnHeadersCP:function AD(AJ){return this.initCP(AJ,this.interactiveCellsArray,AE,AJ.ghs.chs,AJ.gts.col,W);},getRowHeadersCP:function AF(AJ){var AK=this.initCP(AJ,this.interactiveCellsArray,G,AJ.ghs.rhs,AJ.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AK].concat(this._onDemandCP.rhs);return AI(this.rhsCPList)||AK;}return AK;},getValuesCP:function a(AK){var AJ=this.initCP(AK,this.interactiveCellsArray,f,AK.gvs);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){H.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AJ].concat(this._onDemandCP.vls);return AI(this.valuesCPList)||AJ;}return AJ;},createOnDemandCP:function e(AK,AL,AJ){var AM=new mstrmojo.XtabOnDemandCP();AM.dataSource=this;AM.blockNum=AK;AM.rc=AL;return AM;},dataDownloaded:function T(AL,AO){var AQ=AO.blockNum,AJ=this.rhsCPList[AQ],AM=this.valuesCPList[AQ],AP=AL.data;AP._bidx=AQ;this.dataBlocks[AQ]=AP;if(!AJ||!AM){return ;}this.initCP(AP,this.interactiveCellsArray,G,AP.ghs.rhs,AP.gts.row,Q,AJ);this.initCP(AP,this.interactiveCellsArray,f,AP.gvs,null,null,AM);AJ.initContent();AM.initContent();this.numRowsDownloaded+=parseInt(AJ.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AN=this.zones,AK=AN&&AN._BL,AR=AN&&AN._BR;if(AK){AK.dataDownloaded();}if(AR){AR.dataDownloaded();}},showDownloadStatus:function O(AJ){if(!AJ){return ;}if(this.showingStatus){this.numRowsToDownload+=AJ;}else{this.numRowsToDownload=AJ;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function h(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function K(AL){var AN=this.gridData.rw,AK=AN.row,AM=AN.col,AJ=AK.bc;this.rhsCPList[AL].isDownloading=this.valuesCPList[AL].isDownloading=true;if(AJ){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AL*AJ+1,AJ,AM.bb,AM.bc,this.id,{blockNum:AL}));}},unrender:function C(AJ){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AJ);},getCellForNode:function AB(AL){var AJ=AL&&AL.getAttribute("ei");if(isNaN(AJ)){return null;}var AK=this.interactiveCellsArray[parseInt(AJ,10)];return AK;},getActionCells:function N(AJ){var AK=[],AM=this.selections;var AN=AJ.axis+"A"+(AJ.ui+1),AO=AM[AN],AL;if(AO&&AO[AJ.o]){for(AL in AO){var AP=this.getCellForNode(AO[AL][0]);AK.push(AP);}}else{AK.push(AJ);}return AK;},setModel:function AG(AJ){this.model=AJ;if(AJ.data){this.set("gridData",AJ.data);}},destroy:function AA(){var AJ=this.model;if(AJ&&AJ.destroy){AJ.destroy();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StickySections","mstrmojo.VisTextTooltip");var X=mstrmojo.dom,T=mstrmojo.hash,a=mstrmojo.array,I=["white","black","transparent","gray"],M="ig-selected-row";function G(){return(this.isFullScreenWidget||!this.isDocXtab);}function Z(){var AA=this.gridData,o=AA.ghs.chs;if(o.items&&o.items.length){var AB=AA.ghs.chs.items[0].items,g=AA.vp,z=g.cols,f=z.cg,h=z.cws,q=f.cgc,t,p,x=false,s=[];for(t=0;t<q;t++){var k=f[t],l=-1;T.forEach(k,function(AC,j){if(/[mMiIxX]([0-9])+$/.test(j)){for(p=0;p<AB.length;p++){if(AB[p].mix==AC){k[j]=p;l++;break;}}if(AB[k[j]]===undefined||p===AB.length){delete k[j];return ;}x=true;}});if(x){var w=[];for(p=0;p<k.cl;p++){if(k["mix"+p]===undefined){w.push(p);}else{if(w.length>0){k["mix"+w.splice(0,1)]=k["mix"+p];delete k["mix"+p];}}}k.cl=++l;if(k.cl===0){s.push(t);}}else{if(!k.attForms){s.push(t);}}x=false;}for(t=s.length-1;t>=0;t--){delete f[s[t]];for(p=s[t];p<q;p++){f[p]=f[p+1];}delete f[p-1];h.splice(s[t],1);f.cgc--;}}}function C(){var x=":",w=this.gridData,f=w.gts,l=w.ghs.chs,z=f.row,k=z[0],o=f.col&&f.col.length>0,g={bn:"0",gr:"0",ar:"1",ct:"1",daf:k.id+x+k.fid,cols:{cws:[{w:"100"}],cg:{cgc:1}}},q=["row"],j=[f.row],t,s;if(o){q=["row","col"];j=[f.row,l.items[0].items];g.cols={cws:[{w:"50"},{w:"50"}],cg:{cgc:2}};}cg=g.cols.cg;for(t=0,s=cg.cgc;t<s;t++){var h=q[t],p;cg[t]={tg:true,cl:j[t].length,cc:0,sh:true};if(h==="col"){for(p=0;p<j[t].length;p++){cg[t]["mix"+p]=j[t][p].mix;}}else{cg[t].attForms=[];for(p=0;p<j[t].length;p++){cg[t].attForms[p]={idx:p,n:""};}}}this.gridData.vp=g;}function E(k,g){var o,h,f,l,j=function(w,z,x){var q,t,s=z[w+"Sibling"],p;if(s){for(q=0,t=s.cells.length;q<t;q++){p=s.cells[q];if((w==="next"&&/stack-bottom/.test(p.className))||(w==="previous"&&/stack-top/.test(p.className))){x.push(s);return ;}}x.push(s);j(w,s,x);}};g.push(k);for(h=0,f=k.cells.length;h<f;h++){o=k.cells[h];l=o.className;if(/stack/.test(l)){if(/stack-top/.test(l)){j("next",k,g);break;}else{if(/stack-bottom/.test(l)){j("previous",k,g);break;}else{if(/stack-middle/.test(l)){j("next",k,g);j("previous",k,g);break;}}}}}return g;}function e(f){a.forEach(f,function(g){mstrmojo.css.addClass(g,M);});}function F(){var f=T.copy(document.getElementsByClassName(M));a.forEach(f,function(g){mstrmojo.css.removeClass(g,M);});}function W(h){var k=X.findAncestorByAttr(h,"ei",true,this.domNode),g=k&&k.node,f=this.getCellForNode(g);if(g&&g.className.indexOf("iggroup")>0){return true;}if(this.isInteractiveGrid()&&this.igToggle(f)){return true;}if(!f){return true;}if(X.contains(this._BR,h)){F();var j=X.findAncestorByName(h,"tr",true);if(X.contains(this._BR,j)){e(E(j,[]));}}return false;}mstrmojo._IsInteractiveGrid=mstrmojo.provide("mstrmojo._IsInteractiveGrid",{_mixinName:"mstrmojo._IsInteractiveGrid",cssClass:"mstrmojo-InteractiveGrid",enableMagnifier:false,scrollerConfig:{scrollPast:false},isInteractiveGrid:function(){return(this.gridData.vp&&this.gridData.vp.cols)?true:false;},preBuildRendering:function D(){if(this.gridData.eg){return this._super();}if(!this.isInteractiveGrid()){C.call(this);}Z.call(this);var j=this,h=this.parent,f=function(l){j[l]=j[l]||((h&&h[l])?h[l]:480);};f("height");f("width");var k=isNaN(this.gridData.vp.ct)?1:parseInt(this.gridData.vp.ct,10);this.cssClass="mstrmojo-InteractiveGrid "+I[k];this.scrollboxNodeOverflow="overflow:hidden;";var g=(this._super?this._super():true);this.cssDefault=(this.cssDefault==="")?"r-cssDefault":"";return g;},getKey:function O(){return this.gridData.k;},renderChildren:function S(){this.prepareCWSCalculation();if(this._super){this._super();}this.createStickySections();var h=this.zones._BR,g=h.hiliteCellsMap,j={},f=[];T.forEach(g,function(k,l){a.forEach(k.pos,function(o){h.clearHilites(l);j[o.row]=o.row;});});if(!T.isEmpty(j)){T.forEach(j,function(k){f.push(h.domNode.firstChild.rows[k]);});e(E(f[0],[]));}},useDomToCalculateOffsets:function Q(){var f=this.zones._BR.cp;if(f&&(f.groupEnabled||f.stackLevels>1)){return true;}else{return(this._super||this._super())||false;}},prepareCWSCalculation:function U(){var f=this.getFormats&&this.getFormats(),g=(!G.call(this))?parseInt(f.width,10):parseInt(this.width,10);this.zones._BR.cp.gridWidth=g;this.zones._TR.cp.gridWidth=g;},createStickySections:function J(){var p=this.gridData,o=this.getFormats&&this.getFormats();if(this.isInteractiveGrid()&&(p.vp.gr==="1"&&p.gts.cws.length>1)){mstrmojo.requiresCls("mstrmojo.StickySections");var h=this._TR,j="stickySections";this.addSlots({stickySections:h});if(!this.ss){var q=this.zones._BR.cp.getResolvedGroupHeader(0,0),s="iggroup xtab-td",l={320:-52},k=l[mstrMobileApp.getDeviceDPI()]||-33,f=(!G.call(this))?(parseInt(o.width,10)+"px"):"100%",g="width: "+f+";z-index: 2; position: relative;margin-bottom:"+k+"px;";this.ss=new mstrmojo.StickySections({currentSectionTitle:q.n||q.v,cssClass:s,slot:j,cssText:g});this.addChildren(this.ss);}}},performAction:function V(f){return W.call(this,f&&f.target)||(this._super&&this._super(f));},igToggle:function L(z){if(!this.isInteractiveGrid()||!z){return false;}var q=z&&z._e,AA=(z&&z.otp)||(q&&q.otp);if(AA){var o,h,w=this.gridData.vp.cols,g=w.cg,AB=z.mix,x=4,l=12,t=function(j,AE){var AH=false;if(j.tg&&j.cl>1){var AD=j.cc,AJ=j.cc,AC=0,AF=j.cl,AI=j.cc=(++AJ>=(AF+AC))?AC:AJ,AG=[this._TR.getElementsByTagName("COLGROUP")[0],this._BR.getElementsByTagName("COLGROUP")[0]];a.forEach(AG,function(AL){var AK=AL.childNodes[AE+AD].style.width;AL.childNodes[AE+AD].style.width="0";AL.childNodes[AE+AI].style.width=AK;});AH=true;}return AH;},f,k,p=0,s=false;if(z&&z.otp===l){for(o=0;o<g.cgc;o++){f=g[o];k=f.attForms;if(k){for(h=0;h<f.cl;h++){if(k[h]&&(k[h].idx===(z.ci||z.ui))){s=t.call(this,f,p);}}}p+=f.tg?f.cl:1;}}else{if(q&&q.otp===x){for(o=0;o<g.cgc;o++){f=g[o];if(f["mix"+f.cc]===AB){s=t.call(this,f,p);}p+=f.tg?f.cl:1;}}}return s;}return false;},getHACP:function B(){var f=(this.isInteractiveGrid())?new mstrmojo.InteractiveGridHACP():this._super();f.onDemandIF=!!(this.onDemandIF&&this.gridData.rw);return f;},onheightChange:function K(){if(G.call(this)&&this.scrollboxNode){this.scrollboxNode.style.height=(parseInt(this.height,10)-this._TR.clientHeight)+"px";}if(this._super){this._super();}},onwidthChange:function N(){if(G.call(this)){var f=this.width;if(this.hasRendered){this.unrender();this.width=f;this.render();}}else{if(this._super){this._super();}}},defaultAction:function H(h,f){var g=false;if(this._super){g=this._super(h,f);}this.model.sti=null;return g;},onclick:function d(f){if(!mstrApp.isTouchApp()){var g=f.e;return W.call(this,X.findAncestorByName(g.target,"td",true))||(this._super&&this._super(f));}},touchSelectBegin:function A(o){var j=o;var f=mstrmojo.dom.findAncestorByName(o.target,"td",true,this.domNode);var g=this.hasImgTag(f);var h=mstrmojo.dom.findAncestorByAttr(o.target,"trType",true,this.domNode);if(f&&h&&!g){var l=this.getTextWidth(f,f.className);if(l>f.offsetWidth-30){if(!this.visTextTooltip){var k=document.createElement("div");this.domNode.appendChild(k);this.visTextTooltip=new mstrmojo.VisTextTooltip({placeholder:k,targetDiv:f,boundary:this.domNode,touchAreaType:h.value});this.visTextTooltip.render();this.visTextTooltip.updateContent(f,h.value,f.innerText);}else{this.visTextTooltip.targetDiv=f;this.visTextTooltip.touchAreaType=h.value;this.visTextTooltip.updateContent(f,h.value,f.innerText);}}}},touchSelectEnd:function R(g){var f=g;if(this.visTextTooltip&&this.visTextTooltip.domNode){this.visTextTooltip.toggle(false);}},hasImgTag:function P(f){var j=f&&f.childNodes.length>0&&f.childNodes[0];if(j&&j.nodeName.toLowerCase()==="div"){var g=j.childNodes.length>0&&j.childNodes[0];if(g&&g.nodeName.toLowerCase()==="div"){var h=g.childNodes.length>1&&g.childNodes[1];if(h&&h.nodeName.toLowerCase()==="img"){return true;}}}return false;},getTextWidth:function b(h,o,g,t,j,p){var q=h.childNodes;var s=null,f=null;if(q.length>0&&q[0].nodeName.toLowerCase()==="#text"){s=document.createElement("table");f=document.createElement("td");s.appendChild(f);}else{if(q.length>0&&q[0].nodeName.toLowerCase()==="span"){f=document.createElement("span");f.style="z-index:-10;visibility:hidden;-webkit-text-size-adjust: none;";}else{return -1;}}if(f.className!==o||""){f.className=o||"";}if(f.style.fontFamily!==g||""){f.style.fontFamily=g||"";}var k=j||"pt";if(t){f.style.fontSize=t+k;}else{f.style.fontSize="";}if(p){if(f.style.fontWeight!=="bold"){f.style.fontWeight="bold";}}else{if(f.style.fontWeight!==""){f.style.fontWeight="";}}f.innerHTML=h.innerText;var l=-1;if(s){this.domNode.appendChild(s);l=f.offsetWidth-30;this.domNode.removeChild(s);}else{this.domNode.appendChild(f);l=f.offsetWidth;this.domNode.removeChild(f);}return l;},unrender:function Y(f){if(this.visTextTooltip&&this.visTextTooltip.destroy){this.visTextTooltip.destroy();delete this.visTextTooltip;}var g=this.ss;if(g){this.removeChildren(g,true);g.destroy();delete this.ss;}this._super(f);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.inputControls.CheckBoxDIC");mstrmojo.android.inputControls.MarkRowDIC=mstrmojo.declare(mstrmojo.android.inputControls.CheckBoxDIC,null,{scriptClass:"mstrmojo.android.inputControls.MarkRowDIC",isSwitchStyle:false,oncheckedChange:function(){if(this.markAll){var B=this.group&&this.group.widgetsMap,A;for(A in B){if(B.hasOwnProperty(A)){if(B[A].checked!==this.checked){B[A].set("checked",this.checked);}}}}else{this._super();}},postBuildRendering:function(){this._super();this.domNode.style.height="30px";}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.SelectBoxList","mstrmojo.array");mstrmojo.android.controllers._HasSelectBoxDialog=mstrmojo.provide("mstrmojo.android.controllers._HasSelectBoxDialog",{_mixinName:"mstrmojo.android.controllers._HasSelectBoxDialog",showSelectBoxDialog:function A(C,F,D){var B=D.children=[{scriptClass:"mstrmojo.android.ui.SelectBoxList",isElastic:true,items:C,selectListChange:function(G,H){if(!F.call(this,G,H)){mstrApp.closeDialog();}}}][0];if(C.length===1){var E=C[0];C=E.items;D.title=E.n;B.scriptClass="mstrmojo.ui.MobileCheckList";B.items=C;B.multiSelect=false;B.selectedIndex=mstrmojo.array.find(C,"on",true);B.postselectionChange=function(G){this.selectListChange(0,C[G.added[0]]);};}mstrApp.showDialog(D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo._HasLayout","mstrmojo._SupportsEllipsisText","mstrmojo.date","mstrmojo.string","mstrmojo.num","mstrmojo.hash","mstrmojo.expr","mstrmojo.StringBuffer","mstrmojo.android.ui.ElementsSearchBar","mstrmojo.GeoLocation","mstrmojo.android.ui.Button","mstrmojo.android.ui.TextInput","mstrmojo.ui.MobileSlider","mstrmojo.MobileCalendar","mstrmojo.android.ui.Calendar","mstrmojo.android.ui.ElementsPicker","mstrmojo.android._HasLingeringListSelections","mstrmojo.locales.datetime","mstrmojo.prompt.WebPrompt","mstrmojo.ui.MobileDateTimePicker","mstrmojo.ui.MobileReviewList","mstrmojo.array","mstrmojo.BarcodeReader","mstrmojo.string");mstrmojo.requiresDescs(189,221,1442,6149,8382,8383,8384,8397,8761);var d=mstrmojo.date,O=mstrmojo.desc,P=mstrmojo.prompt.WebPrompt.STYLES,Y=mstrmojo.prompt.WebPrompt.TYPES,H=mstrmojo.num,AA=mstrmojo.android.ui.Button.newButton,R=mstrmojo.hash,h=mstrmojo.array,B=mstrmojo.dom.CSS3_TRANSITION_DURATION,Q=mstrmojo.expr,U={160:10,213:10,240:15,320:20};var a="<em>*</em>",L="item-icon",N="main-btn",p="item-btn",AE="Barcode",T="GeoLocation";var G={};var V=' onclick="mstrmojo.all.{@wid}.clickStepper({@idx}, false);"',x=V.replace("false","true");function AC(AG,AF,AH){try{AG.setAnswerValue.apply(AG,AH);}catch(AI){mstrmojo.alert(AI.message||AI);return false;}this.updateItem(AF);return true;}function Z(AH,AG){var AF=[],AI=[];h.forEach(AH,function(AJ){AF[AJ.v]=AJ;AI.push(AJ);});h.forEach(AG,function(AJ){if(AF[AJ.v]){return ;}AI.push(AJ);});return AI;}function S(AH,AL){var AG=[],AF=AL.length,AK=0,AJ=0,AM=0,AI=AH.length;for(AK=0;AK<AI;AK++){for(AJ=AM;AJ<AF;AJ++){if(AH[AK].v===AL[AJ].dssid){AG.push(AL[AJ]);AM=AJ+1;break;}}}return AG;}function AD(AK,AN,AS,AQ,AL,AP,AT,AG){var AR=this,AO={title:O(9755,"Prompt Values")},AI=[],AH,AJ,AM,AU,AF=function(){AO.children=AI;AH=function(){if(AM.deleteAction){var AZ,AX=0,AW;var AY=[].concat(AN);for(AW in AU.selectedIndices){AZ=parseInt(AW,10)-AX++;AS.splice(AZ,1);AY.splice(AZ,1);}AU.set("items",AY);AN=AY;AU.set("height","auto");AM.resizeDialog();AM.setDeleteActions("done");return false;}AC.call(AL,AT,AP,[Z.call(this,AT.answer.items||[],AU.items)]);AM.close();};AJ=function(){AM.close();mstrmojo.BarcodeReader.readBarcodes({attributeID:AK.browseElements.source.did,searchForms:AT.prs.LookupForm,multiSelect:AG},AR,null,S(AU.items,AS),AQ);};var AV=AA(O(8473,"Done"),AH);AV.alias="deleteBtn";AO.buttons=[AA(O(221,"Cancel"),AJ),AV];AM=mstrApp.showDialog(AO);AM.setDeleteActions=function(AW){if(AW==="delete"){this.selectionHidden=false;this.deleteAction=true;this.titleNode.lastChild.style.display="block";this.btnHbox.deleteBtn.set("text",O(629,"Delete"));mstrmojo.css.removeClass(AU.domNode,"hidden");}else{this.selectionHidden=true;this.deleteAction=false;this.titleNode.lastChild.style.display="none";this.btnHbox.deleteBtn.set("text",O(8473,"Done"));}};AM.updateTitleBarButtonClass=function(AW){AM.titleNode.lastChild.className="mstrmojo-Editor-titlebar-button "+AW;};AM.createTitleBarButton("mstrmojo-Editor-titlebar-button btnCheckSemi",function(){AU.selectAll();});AM.setDeleteActions("done");return AM;};AU=new mstrmojo.ui.MobileReviewList({controller:this.controller,isElastic:true,multiSelect:true,itemIdField:"v"});AO.useMenu=false;AI.push(AU);AU.set("items",AN);AF();}function D(){return(this._clkTarget.className===L);}function I(AI,AH,AF){var AG=AI.prs;return(AI.getStyle()===AH||(AG&&AG.DisplayStyle===AF));}function g(AF){if(I(AF,P.BARCODE,AE)||I(AF,P.GEO,T)){return(D.call(this))?p:N;}return"";}function f(AF){if(parseInt(AF.promptType,10)===Y.ELEMENTS_PROMPT&&AF.answer){return" ("+AF.getAnswersCount()+")";}return"";}function k(AH,AO){var AQ=this.items[AO];if(AQ.isTtl){return ;}var AP=AH.firstChild.childNodes,AG=AP[0],AF=AP[1],AI=!!AQ.req,AN=f(AQ),AM=this.ellipsisText,AL;if(AI){AG.innerHTML=a+AG.innerHTML.replace(a,"");}var AK=this.ellipsize("h3",AG,false);if(AI){AL=AG.innerHTML.replace(a,"");AG.innerHTML=AK?AL.replace(AL.slice(-1),a+AM):AL+a;}var AJ=this.ellipsize("h4",AF,true);if(AJ&&AN){AF.innerHTML=mstrmojo.string.trim(AF.innerHTML.slice(0,-(AN.length+3)))+AM+AN;}}function l(AF){var AG=["prompts-dialog"];if(mstrApp.isTablet()&&mstrApp.isLandscape()){AG.push("prompts-landscape");}if(AF){AG.push(AF);}return AG.join(" ");}function z(AF){var AG=this.id;return R.copy(AF,{cssClass:l(),onClose:function(){var AH=mstrmojo.all[AG];AH.parent.closePrompt();AH.clearSelect();}});}function e(AH,AI,AG,AK,AF,AL){AH.children=AI;var AJ=[];if(!AF){AJ.push(AA(O(221,"Cancel")));}if(AK){AJ.push(AA(O(1442,"OK"),AK));}AH.buttons=AJ;if(mstrApp.isTablet()){AH.anchor=this._getItemNode(AG);AH.anchorOrientation="h";AH.autoClose=true;AH.anchorOffset=U[mstrMobileApp.getDeviceDPI()];}this.parent.openPrompt(function(){mstrApp.showDialog(AH,AL);});}function w(AG,AF){var AH=this.id;mstrmojo.BarcodeReader.readBarcodes(null,{success:function(AJ){if(AG.promptType===Y.CONSTANT_PROMPT&&AG.dataType===mstrmojo.mstr.EnumDataType.DataTypeBigDecimal){var AI=mstrApp.getLocaleInfo();AJ=AJ.substr(0,1)+((AI&&AI.number.DECIMALSEPARATOR)||".")+AJ.substr(1);}if(!AC.call(mstrmojo.all[AH],AG,AF,[AJ])){return false;}},failure:function(AI){AG.setError(AI);mstrmojo.all[AH].updateItem(AF);}});}function M(AH,AF){var AI=this.id,AG="plTxtInputxz";e.call(this,z.call(this,{title:AH.title}),[{scriptClass:"mstrmojo.android.ui.TextInput",id:AG,alias:"textInput",textValue:AH.getDisplayValue(false,false)||"",onEnter:function(AJ){if(!AC.call(mstrmojo.all[AI],AH,AF,[AJ])){return ;}mstrApp.closeDialog();}}],AF,function(){if(!AC.call(mstrmojo.all[AI],AH,AF,[mstrmojo.all[AG].getValue()])){return false;}});}function X(AQ,AN){var AI=this.id,AJ=AQ.answer.items||[],AK=AQ.getAvailable(),AO=I(AQ,P.BARCODE,AE),AH=D.call(this),AL=AQ.prs,AG=(AQ.max===""||parseInt(AQ.max,10)>1)&&AL.DisplayStyle!=="Option button",AF=AL.SearchRequired,AM=AF&&AF!=="0";AK.concat=true;var AP=function(){var AT=mstrmojo.all[AI];if(AO&&AH){mstrmojo.BarcodeReader.readBarcodes({attributeID:AK.source.did,searchForms:AQ.prs.LookupForm,multiSelect:AG},{success:function(AY){var AX=JSON.parse(AY),AV=AK.convertElems(AX.items);if(AX.review){var AW=new mstrmojo.android.ui.ElementsPicker({isElastic:true,itemIdField:"v",multiSelect:true});AW.set("browseElements",AK);AW.addSelectedItems(AV);AD.call(this,AW,AV,AX.items,AX.displayKeypadView,AT,AN,AQ,AG);}else{AC.call(AT,AQ,AN,[Z.call(this,AJ,AK.convertElems(JSON.parse(AY).items))]);}}});}else{var AS=new mstrmojo.android.ui.ElementsPicker({isElastic:true,itemIdField:"v",multiSelect:AG});AS.set("browseElements",AK);AS.addSelectedItems(AJ);var AU=new mstrmojo.android.ui.ElementsSearchBar({slot:"titleNode",target:AS,browseElements:AK,searchForms:AO?AQ.prs.LookupForm:undefined,searchRequired:AM,canSearch:AQ.canSearch(),title:AQ.title});var AR=function(){var AW;if(AG){AW=function(){AS.syncSelection();return AC.call(AT,AQ,AN,[AS.getSelectedItems()]);};}else{var AV=AS.singleSelect;AS.singleSelect=function(AX,AY){AV.call(this,AX,AY);if(AX!=-1&&!AY){AC.call(AT,AQ,AN,[AS.getSelectedItems()]);this.parent.close();return true;}};}e.call(AT,z.call(AT,{title:O(6149,"Select Elements"),cssClass:l("edtElementPicker"),goBack:function(){return AU.goBack();}}),[AU,AS],AN,AW,false);};if(I(AQ,P.GEO,T)&&AH){AQ.getGeoTargetValue({success:function(AV){var AW=AQ.searchTarget,AX=AU.search.box;AU.initSearchValue=AV;AU.canSearch=true;if(AW){AU.initSearchValue='in "'+AV+'"';AU.searchTarget=AW;AX.searchValue=AV;}AR();}});}else{AR();}}};if(AK.browseConfig){AK.getItems(1,{success:AP});}else{AP();}}function t(AL,AF){var AJ=z.call(this,{title:AL.title,cssClass:l("edtSlider")}),AG=AL.getDisplayValue(true,false),AI=new mstrmojo.Label({text:AG,cssClass:"value"}),AH=new mstrmojo.Label({text:AL.mn,cssClass:"title"}),AM=this.id;var AK=new mstrmojo.ui.MobileSlider({value:H.parseNumeric(AG),max:AL.max,min:AL.min,interval:AL.interval,onvalueChange:function(){AI.set("text",H.toLocaleString(this.value));},onslidingValueChange:function(){AI.set("text",H.toLocaleString(this.slidingValue));},onRender:function(){this.parent.attachEventListener("resizeCurtain",this.id,this.resize);}});e.call(this,AJ,[AI,AH,AK],AF,function(){if(!AC.call(mstrmojo.all[AM],AL,AF,[String(AK.value)])){return false;}});}function AB(AO,AN,AK){var AH=z.call(this,{title:AO.title}),AI=mstrmojo.date,AM=mstrmojo.locales.datetime,AP=AO.answer,AJ=AO.min,AL=AO.max,AF=new mstrmojo.ui.MobileDateTimePicker({value:AI.parseDateAndOrTime(AP||""),min:AI.parseDateAndOrTime(AJ||""),max:AI.parseDateAndOrTime(AL||""),minuteInterval:AO.interval,hideSwitchers:AK==Q.DTP.DATE,dtp:AK||Q.DTP.TIMESTAMP}),AG=this.id;e.call(this,AH,[AF],AN,function(){var AQ=AF.getDateTime(),AT=AQ&&AQ.date,AV=AQ&&AQ.time,AR=(AT&&AI.formatDateInfo(AT,AM.DATEOUTPUTFORMAT))||"",AU=(AV&&AI.formatTimeInfo(AV,AM.TIMEOUTPUTFORMAT))||"",AS=[AR+" "+AU];if(AO.promptType===Y.ELEMENTS_PROMPT){AS=[AS];}if(!AC.call(mstrmojo.all[AG],AO,AN,AS)){return false;}});}function b(AO,AN){var AL={alias:"calendar"},AM=AO.max,AF=this.id,AH,AG,AK=false,AJ=this.parent.domNode,AI=R.copy(z.call(this,{cssClass:l()}),{targetListHeight:AJ.clientHeight,targetListWidth:AJ.clientWidth});switch(AO.promptType){case Y.CONSTANT_PROMPT:AK=true;break;case Y.ELEMENTS_PROMPT:if(1===parseInt(AM,10)){AK=true;break;}AI.title=O(8383,"Select Dates");AL.min=d.parseDate(AO.prs.LocalizedMinDate||"");AL.max=d.parseDate(AO.prs.LocalizedMaxDate||"");AL.selectedDates=AO.getAnswerAsDateArray();AL.isMultiSelect=true;AH=function(){try{AO.setAnswerValue(AG.getSelectedDates());}catch(AP){mstrmojo.alert(AP.message||AP);return false;}AO.syncDateAnswer({success:function(){mstrApp.closeDialog();var AQ=mstrmojo.all[AF];AQ.updateItem(AN);AC.call(AQ,AO,AN,[AG.getSelectedDates()]);},failure:function(AQ){window.setTimeout(function(){mstrmojo.alert(AQ);},0);}});return false;};break;default:throw new Error(O(8397,"Error: Unknown prompt type."));}if(AK){AB.call(this,AO,AN,Q.DTP.DATE);}else{AG=new mstrmojo.android.ui.Calendar(AL);e.call(this,AI,[AG],AN,AH,false,"CalendarDialog");}}function F(AG,AF){var AH=this.id;mstrmojo.confirm(O(8384,'"MicroStrategy" Would Like to use Your Current Location.'),[AA(O(221,"Cancel")),AA(O(1442,"OK"),function(){mstrmojo.GeoLocation.getCurrentLocation({success:function(AK,AI,AJ){AC.call(mstrmojo.all[AH],AG,AF,[AK,AI]);},failure:function(AI){AG.setError(AI);mstrmojo.all[AH].updateItem(AF);}});})]);}function J(AG,AF){AG.toggleSwitch();this.updateItem(AF);}var s={};s[P.BARCODE]=w;s[P.TEXT]=M;s[P.LIST]=X;s[P.SLIDER]=t;s[P.CALENDAR]=b;s[P.TIME]=AB;s[P.GEO]=F;s[P.SWITCH]=J;mstrmojo.android.ui.PromptsList=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo._SupportsEllipsisText,mstrmojo.android._HasLingeringListSelections],{scriptClass:"mstrmojo.android.ui.PromptsList",listHooks:{select:function(AH,AI,AF){var AG=g.call(this,AI);if(AG){mstrmojo.css.addClass(AH,AG);}AH.style[B]=0;this.setClearHandler(200);},unselect:function(AH,AI,AF){var AG=g.call(this,AI);if(AG){mstrmojo.css.removeClass(AH,AG);}AH.style[B]="300ms";}},getItemMarkup:function(AH){if(AH.isTtl){return'<div class="item {@cls}" idx="{@idx}">{@ttl}</div>';}var AG=AH.getStyle(),AK=I(AH,P.GEO,T)||I(AH,P.BARCODE,AE),AI=AG+String(AH.req)+(AK?"ic":""),AF=G[AI];if(!AF){var AJ=new mstrmojo.StringBuffer();AJ.append('<div class="item {@cls}" idx="{@idx}"><div><h3>{@ttl}'+a+"</h3><h4>{@val}</h4>");if(AG===P.STEPPER){AJ.append('<div class="step"><div'+V+"></div><div>{@v}</div><div"+x+"></div></div>");}else{if(AK||AG===P.SWITCH){AJ.append('<div class="'+L+'"><div></div></div>');}}AF=G[AI]=AJ.toString()+"</div></div>";}return AF;},getItemProps:function j(AJ,AF){var AI=this._super(AJ,AF);AI.ttl=AJ.title;if(AJ.isTtl){AI.addCls("ttl");return AI;}var AH=AJ.getStyle(),AK=(AH===P.STEPPER||AH===P.SWITCH),AG=AJ.getDisplayValue(AK,AK);if(I(AJ,P.BARCODE,AE)){AI.addCls("bar");}else{if(I(AJ,P.GEO,T)){AI.addCls("geo");}}AI.wid=this.id;AI.val=AG||"";AI.addCls("st"+AH);if(AJ.req){AI.addCls("req");}switch(AH){case P.STEPPER:if(!AJ.canStepUp()){AI.addCls("max");}if(!AJ.canStepDown()){AI.addCls("min");}AI.v=AG;AI.val=AJ.mn||"";break;case P.SWITCH:AI.val=AJ.mn||"";if(AG){AI.addCls("on");}break;case P.GEO:if(!AJ.displayLoc){AJ.getDisplayLocation(this,AG);}break;}if(AI.val){AI.addCls("has-ans");}return AI;},updateItem:function o(AF){k.call(this,this._super(AF),AF);},allowTouchBubble:false,onRender:function C(){if(this._super){this._super();}var AF=this.itemsContainerNode.childNodes,AH=AF.length,AG;for(AG=0;AG<AH;AG++){k.call(this,AF[AG],AG);}},clickStepper:function E(AF,AG){this.items[AF]["step"+(AG?"Up":"Down")]();this.updateItem(AF);},postselectionChange:function A(AG){var AI=AG.added;if(!AI){return ;}var AF=AI[0],AJ=this.items[AF],AH=AJ.getStyle();if(AH===P.BARCODE&&!D.call(this)){AH=P.TEXT;}var AK=s[AH];if(AK){AK.call(this,AJ,AF);}},rootOrientationChange:function K(){this.refresh();},touchSelectBegin:function W(AL){var AF=this.getItemIdxTouch(AL);if(AF>-1){var AI=this.items[AF],AG=AI.getStyle(),AK=[];var AH=AI.mn||"";if(AH){AK.push(AH);}if(!(AG===P.SWITCH)&&!(AG===P.STEPPER)){var AJ=AI.getDisplayValue(false,false);if(AJ){AK.push(AJ);}}if(AI.req){AK.push(O(475,"This prompt is required and must be answered."));}if(AK.length){mstrmojo.alert(AK.join("<br /><br />"),null,O(189,"Details"));}return false;}return true;},touchTap:function q(AF){var AG=this.items[this.getItemIdxTouch(AF)];if(AG&&AG.isTtl){return ;}this._clkTarget=AF.target;this._super(AF);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ViewSwitcher","mstrmojo.android.ui.TxDocList","mstrmojo.android.large.ui.TxEditDoc","mstrmojo.OfflineTransactionModel","mstrmojo.hash","mstrmojo.css");mstrmojo.requiresDescs(9249,9753);var C=mstrmojo.hash,H=mstrmojo.css;var E=mstrmojo.OfflineTransactionModel,K=E.PENDING,B=E.FAILED;var F=mstrmojo.desc(9753,"Transactions");function A(O){var Q=this._editDocView;if(!Q){Q=this._editDocView=mstrApp.viewFactory.newView("TransactionsEditDoc",{model:this.model});}else{Q.set("docID",null);}this.switchView(Q);this.disposables.push(Q);Q.set("docID",O.v);var P=O.n;if(this.controller.isAllTransactionLevel()){P="<em>"+F+"</em>"+P;}this.setTitle(P);}function G(){this.enableButtons(false);var R=this.model,P=(R&&R.docsTx)||{},Q=[],T=this.id;if(C.isEmpty(P)){N.call(this);return ;}C.forEach(P,function(W,V){var U=W[K]||[],X=W[B]||[];Q.push({n:W.name,v:V,c:U.length+X.length,desc:W.p.pn});});this.dirty=false;var O=this._docList;if(!O){O=this._docList=new mstrmojo.android.ui.TxDocList({cssClass:"docList",items:Q,postselectionChange:function(U){var V=U.added;if(V){A.call(mstrmojo.all[T],this.items[V[0]]);}}});this.disposables.push(O);}else{O.set("items",Q);}this.switchView(O);this.setTitle(F);var S=this._editDocView;if(S){S.set("docID",null);}}function N(){var O=this._docList=new mstrmojo.Label({cssClass:"txtEmpty",text:mstrmojo.desc(9249,"No pending or failed transactions")});this.disposables.push(O);this.switchView(O);this.enableButtons(false);}mstrmojo.android.ui.TransactionView=mstrmojo.declare(mstrmojo.android.ui.ViewSwitcher,null,{scriptClass:"mstrmojo.android.ui.TransactionView",context:null,model:null,controller:null,dirty:true,init:function L(O){this._super(O);H.addWidgetCssClass(this,"mstrmojo-TxView");},onRender:function M(){var P=function(){var R=this.model,Q=(R&&R.docsTx)||{},S=this.context;if(C.isEmpty(Q)){N.call(this);return ;}if(S){A.call(this,{v:S.id,n:S.n});}else{G.call(this);}};if(!this._txListener){var O=this._txListener=this.model.attachEventListener("recordChanged",this.id,function(){this.dirty=true;P.call(this);});this.disposables.push(O);}P.call(this);},deleteRecord:function J(){var Q=this._editDocView,P=(Q.getType()===0),O=Q.getSelectedTx(),R=this.id;this.controller.deleteTransactionRecord(Q.docID,P,O.v,{success:function(T){var S=mstrmojo.all[R];S.dirty=true;Q.generateTypeList();Q.setType((P||!T.length)?0:1);}});},editRecord:function D(){var P=this._editDocView,O=P.getSelectedTx();this.controller.editTransactionRecord(P.docID,(P.getType()===0),O.v);},enableButtons:mstrmojo.emptyFn,setTitle:mstrmojo.emptyFn,goBack:function I(){if(!this.controller.isAllTransactionLevel()){return false;}var O=this.getCurrentView();if(!O||O===this._docList){return false;}G.call(this);return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TxEditDoc","mstrmojo.android.medium.ui.TxActionButtons","mstrmojo.css","mstrmojo.array");mstrmojo.android.medium.ui.TxEditDoc=mstrmojo.declare(mstrmojo.android.ui.TxEditDoc,null,{scriptClass:"mstrmojo.android.medium.ui.TxEditDoc",layoutConfig:{h:{typeNode:"auto",txNode:"100%",btmNode:"auto"},w:{typeNode:"100%",txNode:"100%",btmNode:"100%"}},addChildren:function A(E,C,D){E=E.concat([{scriptClass:"mstrmojo.android.medium.ui.TxActionButtons",alias:"btns",cssClass:"btns",slot:"btmNode"}]);this._super(E,C,D);},enableButtons:function B(C){this.btns.set("enabled",C);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.SimpleList","mstrmojo.android.EnumMenuOptions","mstrmojo.android.ui.Button","mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo.num");mstrmojo.requiresDescs(11,16,17,18,37,187,295,629,702,784,844,845,874,1088,1142,1563,1900,1905,2411,2461,2822,3157,4253,5191,6560,7227,7559,7561,7778,7779,7831,7840,8027,8360,8361,8362,8363,8364,8365,8366,8367,8368,8369,8370,8371,8372,8373,8374,8375,8376,8377,8378,8379,8390,8441,8447,8455,8456,8457,8458,8459,8489,8633,8634,8635,8760,9446,9447,9448,9449,9450,9451,9452,9456,9457,9458,9459,9460,9464,9465,9466,9467,9468,9469,9470,9471,9481,9790,9791,9792,9793,9794,9795,9796,9797,9807);var $ARR=mstrmojo.array,$HASH=mstrmojo.hash,$BTN=mstrmojo.android.ui.Button.newButton,$DESC=mstrmojo.desc,MENUS=mstrmojo.android.EnumMenuOptions,MENU_DELETE=MENUS.DELETE,MENU_ADD_SERVER=MENUS.ADD_SERVER,MENU_ADD_PROJECT=MENUS.ADD_PROJECT,MENU_ABOUT=MENUS.ABOUT,legalText;var STYLE_HEADER=1,STYLE_BUTTON=2,STYLE_VIEW_BUTTON=3,STYLE_TEXT=4,STYLE_LIST=5,STYLE_CHECK=6,STYLE_IMAGE=7,STYLE_TEXT_AREA=8,STYLE_NUMBER=9,STYLE_TIME=10;var TYPE_HOME=1,TYPE_SERVERS=2,TYPE_EDIT_SERVER=3,TYPE_SERVER_CREDS=4,TYPE_EDIT_PROJECT=5,TYPE_PROJECT_CREDS=6,TYPE_GENERAL=7,TYPE_ABOUT=8,TYPE_LEGAL=10,TYPE_CERT=12,TYPE_CERT_AUTH=12,TYPE_TRUSTED_CERTS=13;var DELETE_TXT={};DELETE_TXT[TYPE_EDIT_SERVER]=5191;DELETE_TXT[TYPE_EDIT_PROJECT]=11;var ADD_TXT={};ADD_TXT[TYPE_SERVERS]=5191;ADD_TXT[TYPE_EDIT_SERVER]=11;var MEMORY_LIMIT_LIST=[{v:25,n:"25MB"},{v:50,n:"50MB"},{v:100,n:"100MB"},{v:250,n:"250MB"},{v:500,n:"500MB"},{v:1024,n:"1GB"},{v:2048,n:"2GB"},{v:3072,n:"3GB"},{v:4096,n:"4GB"}];function getHourString(v){return $DESC(9797,"Every ## hours").replace("##",v);}var UPDATE_INTERVAL=[{v:1,n:$DESC(9796,"Every hour")},{v:2,n:getHourString(2)},{v:4,n:getHourString(4)},{v:10,n:getHourString(10)},{v:24,n:getHourString(24)}];var MODIFIED_ITEMS={};function getNewServerNode(){return{nm:"",po:80,pt:"MicroStrategyMobile",ty:1,rt:0,udc:true,wsc:{am:1,lo:"",ps:""},pdc:{am:1,lo:"",ps:""},pl:[],isNew:true};}function getNewProjectNode(){return{pc:{am:0,lo:"",ps:""},pn:"",sn:"",sp:0,udc:false,isNew:true};}function updateView(viewInfo,items){if(items){viewInfo.items=items;}else{items=viewInfo.items;}var view=this.view.getList(viewInfo.cfg.isHome),rootCtrl=this.rootCtrl;view.restoreListState(viewInfo.idx,viewInfo.origin);view.items=items;view.refresh();if(mstrApp.isTablet()&&viewInfo.cfg.isHome){if(!viewInfo.idx){view.singleSelect(0);}}rootCtrl.updateContent(null,(mstrApp.isTablet())?$DESC(7831,"Settings"):viewInfo.title);rootCtrl.contentUpdated("Settings");this.generateActionToolbar();}function generateView(fnView,item){var viewInfo=fnView.call(this,item);this.view.getList(viewInfo.cfg.isHome).resetListState();viewInfo.cfg.fnRedraw=fnView;this._viewInfos.push(viewInfo);updateView.call(this,viewInfo);}function getLastViewInfo(){var views=this._viewInfos;return views[views.length-1];}function getCurrentConfig(){var viewInfo=getLastViewInfo.call(this);return viewInfo&&viewInfo.cfg;}function cacheViewState(idx){var lastViewInfo=getLastViewInfo.call(this);lastViewInfo.idx=idx;lastViewInfo.origin=this.view.getList(lastViewInfo.cfg.isHome).getScrollPos();}function showCurrentView(){var current=getLastViewInfo.call(this),cfg=current.cfg;updateView.call(this,current,cfg.fnRedraw.call(this,cfg.item).items);this.view.getList(cfg.isHome).restoreListState(current.idx,current.origin);}function confirmDelete(itemName,fnOk){mstrmojo.confirm($DESC(8390,"Are you sure you want to delete #?").replace("#",itemName),[$BTN($DESC(1442,"OK"),fnOk),$BTN($DESC(221,"Cancel"))]);}function deleteItem(item){var me=this;confirmDelete(item.nm,function(){var mobileConfig=me.mobileConfigObj,cfg=getCurrentConfig.call(me),servers=mobileConfig.getWebServersList(),collection=(cfg.type===TYPE_SERVERS)?servers:servers[cfg.idx].pl;collection.splice(item.idx,1);me.view.getList(cfg.isHome).set("items",cfg.fnRedraw.call(me,cfg.item).items);me.mobileConfigObj.reconcileHomescreen();me.mobileConfigObj.saveConfiguration();me.connectivityChanged=true;});}function showPopup(item){var controller=this,dialog;dialog=mstrApp.showDialog({title:item.nm,cssClass:"mstrmojo-SimpleOptions",children:[{scriptClass:"mstrmojo.android.SimpleList",isElastic:true,items:[{n:$DESC(1088,"Edit"),v:1},{n:$DESC(629,"Delete"),v:2}],postselectionChange:function(evt){dialog.close();if(this.items[evt.added[0]].v===1){item.fn();}else{deleteItem.call(controller,item);}}}]});}function convertListToItems(list){var rtn=[],x=-1;$ARR.forEach(list,function(n,idx){if(n){rtn[++x]={n:n,v:idx};}});return rtn;}function editItem(item,value,node){var cfg=getCurrentConfig.call(this),type=cfg.type,path=item.pt.split("."),prop=path.pop(),mobileConfig=this.mobileConfigObj,servers=mobileConfig.getWebServersList();switch(type){case TYPE_EDIT_SERVER:node=servers[cfg.idx];if(!node){node=getNewServerNode();servers.push(node);this.connectivityChanged=true;}break;case TYPE_EDIT_PROJECT:var serverNode=servers[cfg.parent.idx],projects=serverNode.pl||[];node=projects[cfg.idx];if(!node){node=getNewProjectNode();this.mobileConfigObj.setPid(node);projects.push(node);this.connectivityChanged=true;}break;case TYPE_GENERAL:node=mobileConfig.getGeneralSettings();if(prop==="am"||prop==="lo"||prop==="ps"){node=mobileConfig.getDefaultServerCreds();}else{if(prop==="ebs"||prop==="tod"||prop==="ui"||prop==="wo"||prop==="co"){node=mobileConfig.getBackgroundSyncSettings();}}break;case TYPE_CERT:case TYPE_CERT_AUTH:case TYPE_TRUSTED_CERTS:break;default:throw new Error("AndroidSettingsController::editItem -- Unhandled edit action.");}if(path.length){node=$HASH.walk(path.join("."),node);}var oldValue=node[prop];if(oldValue!==value){node[prop]=value;item.v=value;var mods=MODIFIED_ITEMS[type]||{};mods[item.pt.replace(".","@")]=item;MODIFIED_ITEMS[type]=mods;$ARR.forEach(item.dependents,function(dependentItem){$ARR.forEach(["Hidden","Disabled"],function(prop){var fnDependent=dependentItem["fn"+prop];if(fnDependent){dependentItem[prop.toLowerCase()]=fnDependent(value);}});});if(prop==="lo"||prop==="ps"){node.um=true;}}}function newImage(props){return $HASH.copy(props,{nm:"",style:STYLE_IMAGE});}function newHeader(text,props){return $HASH.copy(props,{nm:text,style:STYLE_HEADER});}function newItem(title,value,style,props){return $HASH.copy(props,{nm:title,v:value,style:style});}function newBtnItem(title,value,fnClick,props){var controller=this;return newItem(title,value,STYLE_BUTTON,$HASH.copy({fn:function(){fnClick.call(controller);}},props));}function newViewItem(title,value,fnView,props){var controller=this;return newItem(title,value,STYLE_VIEW_BUTTON,$HASH.copy({fn:function(){cacheViewState.call(controller,this._renderIdx);generateView.call(controller,fnView,this);}},props));}function newEditItem(title,style,node,path,props){var controller=this;return newItem(title,$HASH.walk(path,node),style,$HASH.copy({pt:path,fn:function(value){editItem.call(controller,this,value,node);}},props));}function newListItem(title,node,path,items,props){return newEditItem.call(this,title,STYLE_LIST,node,path,$HASH.copy({items:items},props));}function newCheckItem(title,description,node,path,on,off,props){return newEditItem.call(this,title,STYLE_CHECK,node,path,$HASH.copy({desc:description,on:on,off:off},props));}function ellipsizeHeaderText(text,ellipsize){return ellipsize?mstrmojo.string.ellipsize(text,20):text;}function addTabletHeader(items,title,ellipsize){if(mstrApp.isTablet()){var headerTitle=[];$ARR.forEach(this._viewInfos,function(info,idx){if(idx&&info.title!==title){headerTitle.push('<div hidx="'+idx+'">'+ellipsizeHeaderText(info.title,(idx>1&&ellipsize))+"</div>");}});headerTitle.push("<em>"+ellipsizeHeaderText(title,ellipsize)+"</em>");items=[newHeader(headerTitle.join(""),{cls:"tablet-header"})].concat(items);}return items;}function validateServerChanges(cfg,mods){var servers=this.mobileConfigObj.getWebServersList(),server=servers[cfg.idx],serverCreds=server.wsc,serverAuth=serverCreds.am,projects=server.pl,isNewServer=server.isNew;if(isNewServer&&!mods.nm){servers.splice(cfg.idx,1);return false;}delete server.isNew;if(mods.nm||mods.po||mods.pt||mods.ty){$ARR.forEach(projects,function(project){mstrApp.removeProjectCaches(project);});}else{if(mods["wsc@lo"]&&(mods["wsc@am"]||(serverAuth===2||serverAuth===3))){var projectDefaultAuth=server.pdc.am;$ARR.forEach(projects,function(project){var projectAuth=(project.udc)?projectDefaultAuth:project.pc.am;if(projectAuth===2||projectAuth===64){mstrApp.removeProjectCaches(project);}});}}server.udc=(!serverAuth);if(!serverAuth){serverCreds.lo="";serverCreds.ps="";}this.mobileConfigObj.setWebServerList(servers);return(isNewServer||!!mods.nm);}function validateProjectChanges(cfg,mods){var servers=this.mobileConfigObj.getWebServersList(),projects=servers[cfg.parent.idx].pl,project=projects[cfg.idx],projectCreds=project.pc,projectAuth=projectCreds.am,isNewProject=project.isNew;if(isNewProject&&(!mods.pn||!mods.sn)){projects.splice(cfg.idx,1);return false;}delete project.isNew;if(!isNewProject&&(mods.pn||mods.sn||mods["pc@am"]||(projectAuth>0&&mods.lo))){mstrApp.removeProjectCaches(project.pid);this.mobileConfigObj.setPid(project);this.connectivityChanged=true;}project.udc=(!projectAuth);if(!projectAuth){projectCreds.lo="";projectCreds.ps="";}return(isNewProject||!!mods.pn||!!mods.sn);}function validateGeneralSettingsChanges(cfg,mods){var mobileConfig=this.mobileConfigObj,creds=mobileConfig.getDefaultServerCreds(),isAnonymousMode=(creds.am===1);if(mods.am||(mods.lo&&!isAnonymousMode)){$ARR.forEach(mobileConfig.getWebServersList(),function(server){if(server.udc){var defaultProjAuth=server.pdc.am;$ARR.forEach(server.pl,function(project){var projAuthMode=(project.udc)?defaultProjAuth:project.pc.am;if(projAuthMode===2||projAuthMode===64){mstrApp.removeProjectCaches(project.pid);}});}});}if(isAnonymousMode){creds.lo="";creds.ps="";}return false;}function newAuthenticationItems(type,node){var path="",fnDisabled=mstrmojo.emptyFn,items;if(type===TYPE_EDIT_SERVER||type===TYPE_SERVER_CREDS){items=convertListToItems([$DESC(8441,"Default"),$DESC(7778,"Anonymous"),$DESC(7227,"Basic"),$DESC(7779,"Windows"),$DESC(8027,"Trusted")]);if(type===TYPE_EDIT_SERVER){path="wsc";}fnDisabled=function(v){return(v<2||v===64);};if((type!==TYPE_SERVER_CREDS)&&node.udc){node[path].am=0;}}else{items=[{n:$DESC(8441,"Default"),v:0},{n:$DESC(3157,"Standard"),v:1},{n:$DESC(7779,"Windows"),v:2},{n:"LDAP",v:16},{n:$DESC(1563,"Database"),v:32},{n:mstrmojo.desc(8027,"Trusted"),v:64}];path=(type===TYPE_PROJECT_CREDS)?"pdc":"pc";fnDisabled=function(v){return(!v||parseInt(v,10)===2||parseInt(v,10)===64);};if((type!==TYPE_PROJECT_CREDS)&&node.udc){node[path].am=0;}}if(type===TYPE_SERVER_CREDS||type===TYPE_PROJECT_CREDS){items.shift();}path=(path&&path+".")||"";var cfgLogin={disabled:fnDisabled($HASH.walk(path+"am",node)),fnDisabled:fnDisabled},userName=newEditItem.call(this,$DESC(17,"User Name"),STYLE_TEXT,node,path+"lo",cfgLogin),pwd=newEditItem.call(this,$DESC(18,"Password"),STYLE_TEXT,node,path+"ps",$HASH.copy(cfgLogin,{pwd:true})),rtn=[];rtn.push(newListItem.call(this,$DESC(2822,"Authentication"),node,path+"am",items,{dependents:[userName,pwd]}));rtn.push(userName);rtn.push(pwd);return rtn;}function getEditProjectView(item){var idx=item.idx,settingsCfg=getCurrentConfig.call(this),server=this.mobileConfigObj.getWebServersList()[settingsCfg.idx]||getNewServerNode(),project=server.pl[idx]||getNewProjectNode(),items=[];items.push(newEditItem.call(this,$DESC(11,"Project"),STYLE_TEXT,project,"pn",{showHint:true}));items.push(newEditItem.call(this,$DESC(5191,"Server"),STYLE_TEXT,project,"sn",{showHint:true}));items=items.concat(newAuthenticationItems.call(this,TYPE_EDIT_PROJECT,project));return{title:item.nm,items:addTabletHeader.call(this,items,item.nm,true),cfg:{type:TYPE_EDIT_PROJECT,item:item,idx:idx,parent:settingsCfg,fnVal:validateProjectChanges}};}function getEditServerView(item){var controller=this,serverIndex=item.idx,server=this.mobileConfigObj.getWebServersList()[serverIndex]||getNewServerNode(),projects=server.pl||[],items=[];server.pl=projects;items.push(newEditItem.call(this,$DESC(7559,"Name"),STYLE_TEXT,server,"nm",{showHint:true}));items.push(newEditItem.call(this,$DESC(16,"Port"),STYLE_NUMBER,server,"po",{limits:{min:0,max:65535}}));items.push(newEditItem.call(this,$DESC(8489,"Path"),STYLE_TEXT,server,"pt"));items.push(newListItem.call(this,$DESC(8362,"Web server type"),server,"ty",convertListToItems(["J2EE","ASP.Net"])));items.push(newCheckItem.call(this,$DESC(8363,"Secure HTTP"),$DESC(9449,"Use HTTPS to access the mobile server"),server,"rt",1,0));items=items.concat(newAuthenticationItems.call(this,TYPE_EDIT_SERVER,server));items.push(newHeader($DESC(8364,"Default Project Credentials")));items=items.concat(newAuthenticationItems.call(this,TYPE_PROJECT_CREDS,server));items.push(newHeader($DESC(37,"Projects")));$ARR.forEach(projects,function(project,idx){items.push(newViewItem.call(controller,project.pn,project.sn,getEditProjectView,{idx:idx,fnPress:showPopup}));});return{title:item.nm,items:addTabletHeader.call(this,items,item.nm,true),cfg:{type:TYPE_EDIT_SERVER,item:item,idx:serverIndex,parent:getCurrentConfig.call(this),fnVal:validateServerChanges}};}function getLegalView(){var items=[],title=$DESC(8365,"Legal");if(!legalText){legalText="<p>"+$DESC(8633)+"</p><p>"+$DESC(8634)+"</p><p>"+$DESC(8635)+"</p>";}items.push(newItem(legalText,"",STYLE_TEXT_AREA,{noclick:true}));return{title:title,items:addTabletHeader.call(this,items,title),cfg:{type:TYPE_LEGAL}};}function getAboutView(){var items=[],title=mstrApp.isTablet()?$DESC(1142,"About"):$DESC(9457,"About #").replace("#","MicroStrategy");items.push(newImage.call(this,{noclick:true,cls:"mstr-logo"}));items.push(newItem.call(this,"MicroStrategy Mobile 9.4.0",$DESC(8366,"Build Number #").replace("#",mstrMobileApp.getAppVersion()),STYLE_BUTTON,{cls:"build-info",noclick:true}));items.push(newHeader($DESC(9456,"More Information"),{cls:"more-info"}));items.push(newViewItem.call(this,$DESC(8365,"Legal"),$DESC(9460,"Copyright disclosure"),getLegalView));items.push(newBtnItem.call(this,$DESC(9458,"Get in touch"),$DESC(9459,"Send us an email with your feedback, suggestions and appreciation!"),function(){var bodyMsg=[$DESC(9465,"I was looking through the MicroStrategy Mobile Android App. Please contact me with details on how I can:")];bodyMsg.push($DESC(9466," - Find out how I can use MicroStrategy Apps to drive my business."));bodyMsg.push($DESC(9467," - Have apps, based on my workflow, specifications and design, in two weeks."));bodyMsg.push($DESC(9468," - How I can partner with MicroStrategy for all my Mobile solutions."));bodyMsg.push($DESC(9469," - Attend a free, hands-on, class to teach developers how to build and maintain Mobile Business Apps."));bodyMsg.push("");bodyMsg.push($DESC(9470,"Thank you."));mstrMobileApp.sendEmail("info@microstrategy.com",$DESC(9464,"Request information about MicroStrategy Mobile"),bodyMsg.join("\r\n"),"");}));return{title:title,items:addTabletHeader.call(this,items,title),cfg:{type:TYPE_ABOUT}};}function getBackgroundSyncingItems(){var settings=this.mobileConfigObj.getBackgroundSyncSettings(),fnDisabled=function(v){return(!v||v===false);},depProps={disabled:fnDisabled($HASH.walk("ebs",settings)),fnDisabled:fnDisabled},timeOfDay=newEditItem.call(this,$DESC(9807,"Time of day"),STYLE_TIME,settings,"tod"),updateInterval=newListItem.call(this,$DESC(9792,"Update interval"),settings,"ui",UPDATE_INTERVAL,$HASH.copy(depProps,{dependents:[timeOfDay]})),wifi=newCheckItem.call(this,$DESC(9793,"Only over Wi-Fi"),null,settings,"wo",true,false,depProps),charge=newCheckItem.call(this,$DESC(9794,"Only if charging"),null,settings,"co",true,false,depProps),enable=newCheckItem.call(this,$DESC(9795,"Enable background syncing"),null,settings,"ebs",true,false,{dependents:[updateInterval,timeOfDay,wifi,charge,timeOfDay]}),items=[];items.push(enable);items.push(updateInterval);items.push(timeOfDay);items.push(wifi);items.push(charge);timeOfDay.disabled=updateInterval.disabled||(updateInterval.v!==24);timeOfDay.fnDisabled=function(){return(enable.v!==true)||(updateInterval.v!==24);};return items;}function deleteCertificate(item){var controller=this;confirmDelete(item.nm,function(){mstrApp.showMessage("Deleting...");window.setTimeout(function(){var cfg=getCurrentConfig.call(controller);mstrMobileApp.deleteCertificate();item.hidden=!mstrMobileApp.hasCertificate();$ARR.forEach(item.dependents,function(d){d.hidden=!item.hidden;});controller.view.getList(cfg.isHome).set("items",cfg.fnRedraw.call(controller,cfg.item).items);mstrApp.hideMessage();},100);});}function showPopupDeleteCertificate(item){var controller=this,dialog;dialog=mstrApp.showDialog({title:item.nm,cssClass:"mstrmojo-SimpleOptions",children:[{scriptClass:"mstrmojo.android.SimpleList",isElastic:true,items:[{n:$DESC(1900,"View"),v:1},{n:$DESC(629,"Delete"),v:2}],postselectionChange:function(evt){dialog.close();if(this.items[evt.added[0]].v===1){item.fn();}else{if(this.items[evt.added[0]].v===2){deleteCertificate.call(controller,item);}}}}]});}function getCertificateDetailsView(item){var detailsStr=mstrMobileApp.getCertificateDetails(),details=eval("("+detailsStr+")"),items=[],result="",i;if(details.prs){for(i=0;i<details.prs.pr.length;++i){var pr=details.prs.pr[i];var name;if(pr.n==="edat"){name=$DESC(8457,"Expiration");}else{if(pr.n==="issr_n"){name=$DESC(8458,"Issuer");}else{name=pr.n;}}result+=name+": "+pr.v+"<br/>";}items.push(newItem.call(this,result,"",STYLE_TEXT_AREA,{disabled:true}));return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_CERT,item:item}};}throw details.message||"No certificate details available";}function getTrustedCertificatesView(item){var result=mstrMobileApp.getTrustedCertificates(),jsonResult=eval("("+result+")"),items=[],i;if(jsonResult&&jsonResult.certs){for(i=0;i<jsonResult.certs.length;++i){var cert=jsonResult.certs[i].dsc;items.push(newItem(cert,"",STYLE_TEXT_AREA,{disabled:true}));}}return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_TRUSTED_CERTS,item:item}};}function getCertificateAuthenticationFieldsView(item){var result=mstrMobileApp.getCertificateAuthenticationFields(),jsonResult=eval("("+result+")"),items=[],controller=this,i=0;if(jsonResult.login_info){var settings={},loginInfoField=jsonResult.login_info.field;for(i=0;i<loginInfoField.length;++i){var field=loginInfoField[i],cfgAuth={};settings[field.n]="";if(!!field.pass){cfgAuth=$HASH.copy(cfgAuth,{pwd:true});}items.push(newEditItem.call(this,field.dn,((field.tp==="numeric")?STYLE_NUMBER:STYLE_TEXT),settings,field.n,cfgAuth));}items.push(newItem.call(this,"Submit","",STYLE_BUTTON,{fn:function(){mstrApp.showMessage();window.setTimeout(function(){var responseStr=mstrMobileApp.getNewCertificate(JSON.stringify(settings));mstrApp.hideMessage();var response=eval("("+responseStr+")"),message=response.message;if(message){window.alert(response.message);}else{window.alert("Certificate obtained");if(item&&item.nm==="Get Certificate"){item.hidden=mstrMobileApp.hasCertificate();$ARR.forEach(item.dependents,function(d){d.hidden=!d.hidden;});}mstrApp.goBack();}},100);}}));var title=jsonResult.login_info.msg;return{title:title,items:addTabletHeader.call(this,items,title),cfg:{type:TYPE_CERT_AUTH,item:item}};}throw new Error(jsonResult.message);}function getGeneralSettingsView(item){var mobileConfig=this.mobileConfigObj,generalSettings=mobileConfig.getGeneralSettings(),items=[];items.push(newEditItem.call(this,$DESC(8367,"Network Timeout (seconds)"),STYLE_NUMBER,generalSettings,"nt",{limits:{min:0,max:9999}}));items.push(newEditItem.call(this,$DESC(7840,"Maximum Columns in Grid"),STYLE_NUMBER,generalSettings,"mgc",{limits:{min:0,max:9999}}));if(generalSettings.usd){var diagnosticMode=newCheckItem.call(this,$DESC(8760,"Diagnostic Mode"),$DESC(9450,"Store a log file in the device"),{b:mobileConfig.getDiagnosticMode()},"b",true,false);diagnosticMode.fn=function(value){mobileConfig.setDiagnosticMode(value);this.v=value;};items.push(diagnosticMode);}var monitor=newCheckItem.call(this,$DESC(9471,"Monitor Network Status"),$DESC(9790,"Notify the user when connection quality is below optimal"),generalSettings,"mns",true,false);var fn=function(value){mstrMobileApp.setNetworkMonitoringEnabled(value);};monitor.fn=mstrmojo.func.composite([fn,monitor.fn]);if(generalSettings.mns===undefined){monitor.v=true;}items.push(monitor);items.push(newHeader($DESC(8361,"Mobile Server Default")));items=items.concat(newAuthenticationItems.call(this,TYPE_SERVER_CREDS,this.mobileConfigObj.getDefaultServerCreds()));if(generalSettings.usc){items.push(newHeader($DESC(8368,"Caching")));items.push(newListItem.call(this,$DESC(8369,"Memory limit"),generalSettings,"ml",MEMORY_LIMIT_LIST));items.push(newCheckItem.call(this,$DESC(8370,"Folder caching"),$DESC(9451,"Store folders information for offline analysis"),generalSettings,"fc",true,false));items.push(newCheckItem.call(this,$DESC(8371,"Clear cache when closed"),$DESC(9452,"Delete reports and documents information after exiting the app"),generalSettings,"cc",2,1));}items.push(newHeader($DESC(8459,"Certificates")));if(generalSettings.ucs!==undefined&&generalSettings.ucs!==""&&generalSettings.ucs){var hasCert=mstrMobileApp.hasCertificate(),certItem,getCertItem;certItem=newViewItem.call(this,"Device Certificate","",getCertificateDetailsView,{fnPress:showPopupDeleteCertificate,hidden:!hasCert});getCertItem=newViewItem.call(this,"Get Certificate","",getCertificateAuthenticationFieldsView,{hidden:hasCert,dependents:[certItem]});certItem.dependents=[getCertItem];items.push(certItem);items.push(getCertItem);}items.push(newViewItem.call(this,$DESC(8447,"Trusted Certificates"),"",getTrustedCertificatesView,{hidden:false}));if(mstrMobileApp.isDPCEnabled()){items.push(newHeader($DESC(9481,"Device Passcode")));items.push(newItem.call(this,$DESC(1905,"Reset"),"",STYLE_BUTTON,{fn:function(){mstrMobileApp.resetDPC();}}));}items.push(newHeader($DESC(9791,"Background Syncing")));items=items.concat(getBackgroundSyncingItems.call(this));return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_GENERAL,fnVal:validateGeneralSettingsChanges,item:item}};}function getMobileServersView(item){var config=this.mobileConfigObj,servers=config.getWebServersList(),items=[];$ARR.forEach(servers,function(server,idx){items.push(newViewItem.call(this,server.nm,"",getEditServerView,{idx:idx,fnPress:showPopup}));},this);return{title:item.nm,items:addTabletHeader.call(this,items,item.nm),cfg:{type:TYPE_SERVERS,item:item}};}function getHomeSettingsView(){var items=[newViewItem.call(this,$DESC(6560,"General Settings"),"",getGeneralSettingsView),newViewItem.call(this,$DESC(8375,"Mobile Servers"),"",getMobileServersView)];if(mstrApp.isTablet()){items.push(newViewItem.call(this,$DESC(1142,"About"),"",getAboutView));}return{title:$DESC(7831,"Settings"),items:items,cfg:{type:TYPE_HOME,isHome:true}};}function saveChanges(cfg,doSave){var type=cfg.type,modifications=MODIFIED_ITEMS[cfg.type];if(modifications){var fnValidate=cfg.fnVal;if(fnValidate){fnValidate.call(this,cfg,modifications);}if(doSave){this.mobileConfigObj.saveConfiguration();}delete MODIFIED_ITEMS[type];}}var $CTRL=mstrmojo.android.controllers.SettingsController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.SettingsController",connectivityChanged:false,init:function(props){this._super(props);this.mobileConfigObj=this.mobileConfigObj||mstrApp.getConfiguration();},start:function(params){var viewFn=params.viewFn;this._super(params);mstrApp.cancelPending();this._viewInfos=[];var view=this.view=this.newView("Settings");this.rootCtrl.updateContent(view,$DESC(7831,"Settings"));generateView.call(this,(viewFn&&eval("("+viewFn+")"))||getHomeSettingsView);},getDefaultMenus:function getDefaultMenus(){return MENUS.HELP;},updateActionToolbar:function updateActionToolbar(tbCfg){var cfg=getCurrentConfig.call(this),cfgType=cfg&&cfg.type,deleteDescId=DELETE_TXT[cfgType],addDescId=ADD_TXT[cfgType];if(addDescId){var menuId=MENU_ADD_SERVER,iconId=19;if(cfgType===TYPE_EDIT_SERVER){menuId=MENU_ADD_PROJECT;iconId=20;}tbCfg.addToolbarBtn(menuId,$DESC(9446,"Add #").replace("#",$DESC(addDescId,"Item")),menuId,true,iconId);}if(deleteDescId){tbCfg.addMenuItem(MENU_DELETE,$DESC(8379,"Delete #").replace("#",$DESC(deleteDescId,"Item")),MENU_DELETE,true,16);}if(!mstrApp.isTablet()&&cfgType!==TYPE_ABOUT&&cfgType!==TYPE_LEGAL){tbCfg.addMenuItem(MENU_ABOUT,$DESC(1142,"About"),MENU_ABOUT,true,21);}return this._super(tbCfg);},handleMenuItem:function handleMenuItem(group,cmdId){var cfg=getCurrentConfig.call(this),type=cfg.type,servers=this.mobileConfigObj.getWebServersList(),isServer=(type===TYPE_EDIT_SERVER);switch(group){case MENU_ABOUT:cacheViewState.call(this,-1);generateView.call(this,getAboutView);break;case MENU_ADD_SERVER:case MENU_ADD_PROJECT:cacheViewState.call(this,-1);if(group===MENU_ADD_SERVER){generateView.call(this,getEditServerView,{nm:$DESC(9447,"New Server"),idx:servers.length});}else{var server=servers[cfg.item.idx];generateView.call(this,getEditProjectView,{nm:$DESC(9448,"New Project"),idx:(server&&server.pl.length)||0});}break;case MENU_DELETE:var collection;if(isServer){collection=servers;}else{if(type===TYPE_EDIT_PROJECT){var idx=cfg.parent.idx;collection=servers[idx]&&servers[idx].pl;}}if(collection){var me=this,item=collection[cfg.idx];var okFn=function(){collection.splice(cfg.idx,1);me.mobileConfigObj.reconcileHomescreen();me.mobileConfigObj.saveConfiguration();me.view.getList(cfg.isHome).set("items",cfg.parent.fnRedraw.call(me,cfg.parent.item).items);me.goBack();me.connectivityChanged=true;};if(item){confirmDelete(item.nm||item.pn,okFn);}else{okFn();}}else{this.goBack();}return false;}return this._super(group,cmdId);},goBack:function goBack(){if(this._super()){return true;}var currentConfig=getCurrentConfig.call(this);saveChanges.call(this,currentConfig,true);var viewInfos=this._viewInfos;viewInfos.pop();if(currentConfig.type===TYPE_EDIT_SERVER&&mstrApp.deviceType===3&&this.mobileConfigObj.getWebServersList().length===0){viewInfos.pop();}var current=getLastViewInfo.call(this);if(!current||(mstrApp.isTablet()&&viewInfos.length===1)){if(this.connectivityChanged){this.rootCtrl.restart();return true;}return false;}showCurrentView.call(this);return true;},goUp:function goUp(){if(!this._super()){$ARR.forEach(this._viewInfos,function(view){saveChanges.call(this,view.cfg);},this);this.mobileConfigObj.saveConfiguration();this.rootCtrl[(this.connectivityChanged)?"restart":"goHome"]();}return true;},jumpTo:function jumpTo(idx,showView){var viewInfos=this._viewInfos,targetIdx=idx+1;$ARR.forEach(viewInfos,function(view,vIdx){if(vIdx>targetIdx){saveChanges.call(this,view.cfg);}},this);viewInfos.splice(targetIdx);if(showView){showCurrentView.call(this);}}});$CTRL.STYLES={HEADER:STYLE_HEADER,BUTTON:STYLE_BUTTON,VIEW_BUTTON:STYLE_VIEW_BUTTON,TEXT:STYLE_TEXT,LIST:STYLE_LIST,CHECK:STYLE_CHECK,IMAGE:STYLE_IMAGE,TEXT_AREA:STYLE_TEXT_AREA,NUMBER:STYLE_NUMBER,TIME:STYLE_TIME};}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.ui.ActionToolbar","mstrmojo.android.EnumMenuOptions","mstrmojo.android.ui.PropertiesView","mstrmojo.hash","mstrmojo.array","mstrmojo.string");mstrmojo.requiresDescs(1142,8623,8429,8430,8624,8625,9099,11191);var L=mstrmojo.hash,g=mstrmojo.array.forEach,K=mstrmojo.dom,O=768,d=mstrmojo.android.EnumMenuOptions,AB=d.FULL_SCREEN,AE=d.SHARE,C=d.ANNOTATION,f=d.ABOUT_RESULTSET,F=3,I=50;function t(){var AG=this._oldPID;if(AG){mstrApp.setCurrentProjectId(AG);}}function D(AK,AL,AI,AJ){var AH=this.model,AG=AH.prompts;if(AG){AK.promptsAnswerXML=AG.getAnswerXML();}AK.useRefreshProgress=AJ;mstrApp.closeAllDialogs();AH.execute(AK,AL,AI);}function R(AJ){var AH=this.model,AG=AH.prompts,AI={fresh:false,useRefreshProgress:mstrApp.isTablet()};if(AG){AI.promptsAnswerXML=AG.getAnswerXML();}mstrApp.closeAllDialogs();this.refresh(AI,AJ);}function U(){var AG=this._startParams,AI=AG.action,AH;if(!AI||(AI!=="drillGrid"&&AI!=="drill2Grid")){AH=AG;}this.rootCtrl.updateLastOpened(AH);}function AC(AH,AL){AL=AL||{};var AG=this.view=this.createView(AH,L.copy(AL)),AK=AH.n||AL.ttl||"",AI=this;AG.slot="containerNode";var AJ=this.frame=this.newView("ResultSet",{controller:this});AJ.addChildren([AG]);this.rootCtrl.updateContent(AJ,AK);this.ttl=this._startParams.n=AK;this.desc=AH.dsc;U.call(this);window.setTimeout(function(){AI.checkCache(AH,AL);},100);}function M(){if(this.isFullScreen){this.cancelFlashFullScreen();}var AG=this.frame.getPosition(),AH=K.windowDim();AG.ww=AH.w;AG.wh=AH.h;return JSON.stringify(AG);}mstrmojo.android.controllers.ResultSetController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,null,{scriptClass:"mstrmojo.android.controllers.ResultSetController",supportsFullScreen:true,start:function T(AI){this._super(AI);this._startParams=L.copy(AI);var AO=this,AK=AI.projectID,AQ=AO.prevController,AG=function(AR){t.call(AO);AO.viewFailed(AR);},AL=function(AR){$MAPF(AR,"ResultSetController","start");},AP=function(){if(AQ&&AQ.docRequestComplete){AQ.docRequestComplete();}};var AM=this.ctrlType=AI.st;AL(true);if(AK){this._oldPID=mstrApp.getCurrentProjectId();mstrApp.setCurrentProjectId(AK);this.pid=AK;}try{var AH=AI.action||"execute";delete AI.action;var AJ=this.model=this.initModel();if(AM){AJ.st=AM;AJ.n=AI.n;}this.did=this.did||AI.documentID||AI.reportID||AI.objectID;AJ[AH](AI,{success:function(AR){try{AC.call(AO,AR,AI);}catch(AS){AG(AS);}},prompts:function(){AO.openPrompts(AI);},failure:function(AR){AG(AR);},complete:function(){AL(false);AP();},canceled:function(){AG();}});}catch(AN){AG(AN);AP();}},initModel:mstrmojo.emptyFn,canDelegateToolBar:function J(){return true;},createView:mstrmojo.emptyFn,getDefaultMenus:function x(){return 0;},onorientationChange:function Q(){var AG=this.frame;if(AG&&AG.hasRendered){AG.rootOrientationChange({isLandscape:!this.orientation});}this._super();},refresh:function AF(AH,AI){var AG=this.view;this.model.refresh(AH,mstrmojo.func.wrapMethods({success:function(AJ){if(AJ){AG.refresh();}}},AI));},reExecute:function A(AG){if(mstrApp.useBinaryFormat){mstrMobileApp.removeLiveCache(mstrApp.getCurrentProjectId(),this.model.ci.cid);var AH=this;D.call(this,{},{success:function(AI){AH.setData(AI);}},{refresh:true},false);}else{AG.model.raiseEvent({name:"refresh"});}},reprompt:function AD(){this.repromptFlag=true;this.openPrompts();},openPrompts:function q(AK){var AN=this,AM=this.model.prompts,AO=AM.size(),AG=[],AP=false,AL;for(AL=0;AL<AO;AL++){var AI=AM.get(AL);if(AI.supported()){AG.push(AI);}else{if(!AI.hasAnswer){if(AI.req){this.viewFailed({message:mstrmojo.desc(8623,"Report cannot be executed because it contains unanswered, required prompts.")});return ;}AP=true;}}}var AJ=function(){if(AP){mstrmojo.alert(mstrmojo.desc(8624,"Warning: Report contains unasnwered, unsupported prompts."),function(){AN.answerPrompts();});}else{AN.answerPrompts();}};if(AG.length>0){var AH=this.frame;this.spawn(mstrApp.controllerFactory.newController("Prompts"),{maskNode:AH&&AH.getMaskNode(),prompts:AM,supportedPrompts:AG,n:(AK&&(AK.n||AK.ttl))||this.ttl,callback:function(){AJ();}});}else{AJ();}},answerPrompts:function W(){var AG=this;this.model.answerPrompts({success:function(AH){var AI=AG.nextController;if(AI){AI.destroy();}if(AG.repromptFlag){AG.afterReprompt(AH);delete AG.repromptFlag;AG.rootCtrl.updateContent(AG.frame,AH.n);U.call(AG);AG.checkCache(AH);}else{AC.call(AG,AH);}},prompts:function(){AG.viewFailed({message:mstrmojo.desc(8625,"Prompts in prompts are not supported.")});},failure:function(AH){mstrApp.onerror(AH);}});},afterReprompt:function b(AG){this.getPageByTree(true);},hasPageBy:mstrmojo.emptyFn,getPageByTree:function p(AJ){var AH=!!this.pageByData;if((!AJ&&AH)||!this.hasPageBy()){return ;}var AK=this,AG=this.view,AI=(AG.isVis&&AG.isVis())?AG.xtabModel:this.model;if(AI.getPageByTree){if(AH){this.set("pageByData",null);}AI.getPageByTree({success:function(AL){AK.set("pageByData",AL);},failure:function(AL){mstrApp.onerror(AL);}});}},destroy:function z(){this.model.destroy();var AG=this.frame;if(AG){AG.destroy();}this._super();},checkCache:function H(AL,AJ,AR,AK,AH){var AN=this,AP=this.model.getDataService(),AG=AL&&AL.ifc;AR=AR||mstrmojo.emptyFn;if(!mstrApp.useBinaryFormat||!AG){AR();return ;}AJ=AJ||{did:this.did,n:this.n,st:this.st,t:this.t,sub_id:this.sub_id};var AI=function(AT){var AS=(AT!==true);AN.rootCtrl.setActionToolbarStatus(AS);AN.frame.setActionToolbarStatus(AS);};var AQ=true,AO=1,AM={success:function(AS){if(AQ&&AK!==2){mstrmojo.toast(mstrmojo.desc(8617,"Your view has been updated with the latest version of the document."),3000);}if(AO===1){AN.setData(AS,true);}AN.getPageByTree(true);AN.generateActionToolbar();AR();AI();},prompts:function(){mstrmojo.alert(mstrmojo.desc(8619,"New prompts were added to the document."),function(){AI();AN.reprompt();});},failure:function(){AI();},canceled:AI};AI(true);if(AK===1&&AL.ci.cid==="00000000000000000000000000000000"){AQ=false;}AP.checkCache(L.copy(AL.ci||{}),{success:function(AS){if(AS.needUpdate){if(AS.refresh&&AK===2){AO=2;R.call(AN,AM);}else{D.call(AN,AJ,AM,{},mstrApp.isTablet());}}else{AR();AI();}},failure:function(){if(!mstrApp.onMobileDevice()){if(AK===2){AO=2;R.call(AN,AM);}else{D.call(AN,AJ,AM,{},mstrApp.isTablet());}}else{AI();}},canceled:AI},AH);},goBack:function E(){var AG=this._super();if(!AG){t.call(this);}return AG;},makeCurrent:function a(AG){var AH=this.frame;if(AH){this._super(AG);this.rootCtrl.updateContent(AH,this._startParams.n,AG);U.call(this);}else{this.doNotRefresh=true;this.prevController.makeCurrent(AG);}},onExecuteNewObject:function P(AH){var AG=(AH.objType===F)?768:14081;this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(AG),{st:AG}),AH);},onDrill:function h(AG){this.spawn(mstrApp.controllerFactory.newController(this.getViewKey(O)),L.copy(AG,{action:(this.ctrlType===O)?"drillGrid":"drill2Grid",st:O}));},goUp:function X(){if(!this._super()){var AG=this.getController("ctrlType",2048);if(AG){AG.makeCurrent(true);}else{this.rootCtrl.goHome();}}return true;},updateActionToolbar:function s(AG){if(mstrApp.getConfiguration().isMenuAllowed(AE,AE)){if(mstrMobileApp.getSDKVersion()>=11){AG.addToolbarBtn(C,mstrmojo.desc(11191,"Annotation"),C,false,24);}AG.addToolbarBtn(AE,mstrmojo.desc(9099,"Share"),AE,false,22);}AG.addMenuItem(f,mstrmojo.desc(1142,"About"),f,false,23);AG=this._super(AG);if(this.frame&&this.frame.delegateToolbar(AG)){AG=mstrmojo.android.ui.ActionToolbar.newToolbarConfig();}return AG;},handleMenuItem:function l(AH,AG){switch(AH){case f:this.rootCtrl.updateItemProperties("",{ttl:this.ttl,st:this.st,did:this.did||this.getDepth(),pid:this.pid,desc:this.desc,propsPopup:true},this.id,false);return ;case AE:this.share("",false);return ;case AB:this[((AG===11)?"enter":"exit")+"FullScreen"]();return ;case C:this.startAnnotate();return ;}return this._super(AH,AG);},beforeViewHidden:function G(AH){this._super(AH);var AG=this.view;if(AG&&AG.beforeViewHidden){AG.beforeViewHidden(AH);}if(this.isFullScreen){this.exitFullScreen(true,AH);}},afterViewVisible:function V(AG){this._super(AG);if(this.isFullScreen||!!this.model.fs||!!this.model.data.fs){this.enterFullScreen();}else{if(mstrMobileApp.getSDKVersion()>=16){window.setTimeout(function(){mstrMobileApp.clearWebViewCache(false);},100);}}mstrMobileApp.hideProgress();if(!AG){var AH=this.id;window.setTimeout(function(){var AI=mstrmojo.all[AH];if(AI&&AI.rootCtrl.getCurrent()===AI){AI.takeScreenShot();}},300);}},takeScreenShot:function Y(){var AH=this.view,AG=(AH.getCaptureDimensions&&AH.getCaptureDimensions())||K.position(AH.domNode),AJ=K.windowDim(),AK=this.did||this.getDepth(),AI=mstrApp.getCurrentProjectId();g(mstrmojo.android.ui.PropertiesView.getPreviewSizes(),function(AL){mstrMobileApp.takeScreenShot(JSON.stringify({pid:AI,dssId:AK,x:AG.x,y:AG.y,w:Math.max(AG.w,AL.w),h:Math.max(AG.h,AL.h),pw:AL.w,ph:AL.h,ww:AJ.w,wh:AJ.h}));});},addFullScreenButton:function Z(AG){var AI=mstrmojo.desc(8430,"Enter Fullscreen"),AH=11;if(this.isFullScreen){AI=mstrmojo.desc(8429,"Exit Fullscreen");AH=10;}AG.addToolbarBtn(AB,AI,AH,false,AH);},enterFullScreen:function N(){this.frame.enterFullScreen();this.rootCtrl.enterFullScreen();this.isFullScreen=true;this.generateActionToolbar();mstrmojo.touchManager.raiseEvent({name:"fullScreenStateChange"});},exitFullScreen:function AA(AG,AH){this.isFullScreen=false;this.frame.exitFullScreen(!AG);this.rootCtrl.exitFullScreen(!AG,AH);this.generateActionToolbar();mstrmojo.touchManager.raiseEvent({name:"fullScreenStateChange"});},viewTap:function B(){if(this.isFullScreen){this.frame.flashFullScreen();this.rootCtrl.flashFullScreen();}},cancelFlashFullScreen:function k(){this.frame.cancelFlashFullScreen();this.rootCtrl.cancelFlashFullScreen();},getMagnifierConfig:function e(){var AG=this.frame.getPosition();return{curtainPosition:AG};},share:function o(AI,AH){var AJ=M.call(this),AG=this.ttl;window.setTimeout(function(){mstrMobileApp.takeScreenShotAndSend(AJ,JSON.stringify({attachmentName:mstrmojo.string.decodeHtmlString(AG),subject:AI,useDefault:AH}));},100);},getBottomToolBarHeight:function S(){return(!mstrApp.isTablet()&&!this.isFullScreen&&!mstrApp.isLandscape())?(Math.round(I*mstrMobileApp.getDeviceDPI()/160)):0;},startAnnotate:function w(){if(!!this.ignoreAnnotationMenuItem){return ;}this.ignoreAnnotationMenuItem=true;mstrMobileApp.showProgress([mstrmojo.desc(8445,"Loading")],false);var AH=M.call(this),AG=this;window.setTimeout(function(){mstrMobileApp.startAnnotate(AH,mstrmojo.string.decodeHtmlString(AG.ttl),"javascript:mstrmojo.all."+AG.id+".onAnnotationFinished()");},100);},onAnnotationFinished:function j(){this.ignoreAnnotationMenuItem=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.ActionBar","mstrmojo.hash");mstrmojo.android.medium.ui.ActionBar=mstrmojo.declare(mstrmojo.android.ui.ActionBar,null,{scriptClass:"mstrmojo.android.medium.ui.ActionBar",setNavigation:function A(H,I){this.title.setListItems(H,I);},restoreNavigation:function F(){var H=this._lastNav;if(H){this.title.setListItems(H.items,H.idx);}},clearNavigation:function B(){var H=this.title.clearListItems();if(H){this._lastNav=H;}},getNavList:function C(){return this.title.list;},onExitFullScreen:function G(){this.propogateMenuVisibleChange(true);},onEnterFullScreenEnd:function E(){this.propogateMenuVisibleChange(false);},propogateMenuVisibleChange:function D(H){this.toolbar.propogateMenuVisibleChange(H);}});mstrmojo.android.ui.ActionBar.adjustLayoutConfig({160:48,213:64,240:72,320:96});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.TreeNode");var I=mstrmojo.dom;mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:mstrmojo.hash.copy({checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,onstateChange:function H(){if(!this.contentRetrieved&&(this.state==1)){this.set("items",[this.tree.loadingItemCreaterFunc()]);this.tree.getContent(this,this.blockBegin);}},toggleState:function F(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function G(J){I.clearBrowserHighlights(J.hWin);return false;},predblclick:function D(J){I.clearBrowserHighlights(J.hWin);return false;},premousedown:function B(K){var P=mstrmojo.dom,M=mstrmojo.dom.eventTarget(K.hWin,K.e),J=this.tree,L=(this.state==2),O=P.contains(this.itemsContainerNode,P.eventTarget(K.hWin,K.e),true,this.domNode),N=(J.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if(this.isSpecialNode()||!(M==this.checkBoxNode||(M==this.textNode&&(L||!N)))){P.stopPropogation(K.hWin,K.e);}if((M==this.stateNode)||(M==this.textNode&&!L&&N)){if(!L){this.toggleState();}}else{if(M==this.checkBoxNode||O){if(this._super){this._super(K);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var J=this.data&&this.data.st;return(J<0);},handleNodeClicked:function E(){var J=this.tree,K=this.parent,L=this.data;switch(L&&L.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin-J.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin+J.blockCount);break;case"-1":case"-2":break;default:if(J.handleNodeClicked){J.handleNodeClicked(L);}}},init:function(J){this._super(J);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var J=function(K){I.preventDefault(window,K||window.event);return false;};I.attachEvent(this.domNode,"mousedown",J);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileDateTimePicker","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.date","mstrmojo.expr","mstrmojo.locales");mstrmojo.requiresDescs(2052,2170,7656);var C=mstrmojo.date,H=mstrmojo.desc,D=5,G=6,A=mstrmojo.expr.DTP;mstrmojo.android.inputControls.DateTimePickerDIC=mstrmojo.declare(mstrmojo.ui.MobileDateTimePicker,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.DateTimePickerDIC",cssText:"",valueField:"dtValue",popupTitle:"",init:function F(I){var J=I.dic;if(J.min!==undefined){I.min=C.parseDateAndOrTime(J.min);}if(J.max!==undefined){I.max=C.parseDateAndOrTime(J.max);}I[this.valueField]=C.parseDateAndOrTime(I.value);if(J.t===D){I.dtp=J.ict?A.TIMESTAMP:A.DATE;I.popupTitle=J.ict?H(7656,"Date and Time"):H(2052,"Date");}else{if(J.t===G){I.dtp=A.TIME;I.minuteInterval=I.dic.itv;I.popupTitle=H(2170,"Time");}}this._super(I);},getCurValue:function B(Q){var N=this[this.valueField]||{},M=this.getDate()||N.date||{year:1970,month:1,day:1},L=this.getTime()||N.time||{hour:0,min:0,sec:0},K=this.dic,J=parseInt(K.dt,10),P=mstrmojo.locales.datetime,O=P.TIMEOUTPUTFORMAT,I=P.DATEOUTPUTFORMAT,S=C.formatDateInfo(M,I),R=C.formatTimeInfo(L,O);if(Q){if(K.t===D){return K.ict?(S+" "+R):S;}return R;}if(J===A.TIMESTAMP){return S+" "+R;}if(J===A.TIME){return R;}return S;},renderPreview:function E(){this.renderPreviewButton(this.openerNode,this.getCurValue(true));}});}());(function(){mstrmojo.requiresCls("mstrmojo.Magnifier","mstrmojo.hash");var A="xtab-selected-cell";mstrmojo._HasMagnifier={scriptClass:"mstrmojo._HasMagnifier",magnifiedNode:null,magnifier:null,magnifierHelper:null,onmagnifiedNodeChange:function(C){var E=C.valueWas,D=C.value;if(E){mstrmojo.css.removeClass(E,A);}if(D){mstrmojo.css.addClass(D,A);}},displayMagnifier:function B(J,F){var H=this.magnifierHelper,C=H.resolveTouchEvent(J),I,E,D;if(C){E=C.cell;D=C.pos;if(E!=this.magnifiedNode){I=H.resolveInfoToDisplay(C);if(I){this.set("magnifiedNode",E);if(!this.magnifier){var G=this;this.magnifier=mstrApp.showPopup(mstrmojo.hash.copy({scriptClass:"mstrmojo.Magnifier",onClose:function(){G.magnifier=null;G.set("magnifiedNode",null);},helper:H},F),E);}this.magnifier.updateContent();this.magnifier.resizeAndPosition(D);}else{if(this.magnifier){this.magnifier.close();}}}else{if(this.magnifier){this.magnifier.moveTo(D);}}}}};})();(function(){mstrmojo.requiresCls("mstrmojo.android.Popup","mstrmojo.array","mstrmojo.android.TextArea","mstrmojo._TouchGestures","mstrmojo.android.ui.Button","mstrmojo.dom","mstrmojo.css","mstrmojo.hash");mstrmojo.requiresDescs(1442);var Q=mstrmojo.css,D=mstrmojo.dom,K=mstrmojo.array,M=mstrmojo.hash;var T=mstrmojo.android.Dialog=mstrmojo.declare(mstrmojo.android.Popup,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.Dialog",autoClose:false,btnVisible:true,init:function N(V){this._super(V);var U=["dialog"];if(this.title){U.push("has-ttl");}if(V.anchor){this.curtainPosition=mstrApp.getContentPosition();}Q.addWidgetCssClass(this,U);},preBuildRendering:function A(){var W=this.buttons;if(W&&!this.btnHbox){var U=this,X=this.id,V=function(){if(!U.manualClose){window.setTimeout(function(){var Y=mstrmojo.all[X];if(Y){Y.close();}},50);}};K.forEach(W,function(Y){Y.origFn=Y.onclick;Y.onclick=function(Z){if(this.origFn){if(this.origFn()===false){return ;}}V();Z.e.stopPropagation();Z.e.cancelBubble=true;};});}this._super();},postBuildRendering:function O(){if(this.onTitleClick){var U=this.id;D.attachEvent(this.titleNode,"click",function(V){mstrmojo.all[U].onTitleClick(V);});}return this._super();},getResizeHandler:function F(){var V=this.id,U=function(){var W=mstrmojo.all[V];if(W.dialogRefresh){W.dialogRefresh();}else{W.resizeDialog();W.positionDialog();}};return U;},resizeDialog:function C(){this._super();var f=this.buttons&&this.buttons.length;if(f){var V=this.buttonNode,X=this.btnVisible;if(!X){this.set("btnVisible",true);}var W=this.btnHbox.children,e=Q.getComputedStyle,U=e(V),b=e(W[0].domNode);var Y=V.clientWidth-parseInt(U.paddingLeft,10)-parseInt(U.paddingRight,10),d=parseInt(b.paddingLeft,10)+parseInt(b.paddingRight,10)+parseInt(b.borderLeftWidth,10)+parseInt(b.borderRightWidth,10),a=Y-(f*d);var Z=Math.floor(a/f);K.forEach(W,function(g){g.set("width",Z+"px");});this.set("btnVisible",X);}},resizeCurtain:function R(){var X=this.curtainNode,U=document.body,W=X.style,V=this.curtainPosition;W.width=U.scrollWidth+"px";if(V&&V.h){W.height=V.h+"px";}else{W.height=U.scrollHeight+"px";}if(V&&V.y){W.top=V.y+"px";}this.raiseEvent({name:"resizeCurtain"});},setButtonVisibility:function B(U){this.buttonNode.style.display=U?"block":"none";},createTitleBarButton:function S(V,U,W){var X=document.createElement("div");X.className=V;X.setAttribute("title",W||"");X[(mstrApp.isTouchApp())?"ontouchend":"onclick"]=U;this.titleNode.appendChild(X);}});var G=M.copy(T.prototype.markupMethods);G.onbtnVisibleChange=function(){this.buttonNode.style.display=(this.btnVisible)?"block":"none";};T.prototype.markupMethods=G;if(window.mstrConfig&&!window.mstrConfig.simpleDialog){var E=function(U){return[{scriptClass:"mstrmojo.android.TextArea",text:U,cssClass:"mstrmojo-androidAlert",isElastic:true}];};mstrmojo.alert=function L(W,U,V){mstrApp.showDialog({title:V||"MicroStrategy Mobile",buttons:[mstrmojo.android.ui.Button.newButton(mstrmojo.desc(1442,"OK"),function(){if(U){U();}})],children:E(W)});};mstrmojo.confirm=function H(W,U,V){mstrApp.showDialog({title:V||"MicroStrategy Mobile",buttons:U,children:E(W)});};mstrmojo.toast=function I(V,U){mstrApp.showToastNotification(V,U||3500);};mstrmojo.mask={show:function P(U){mstrMobileApp.showProgress([U||""],false);},hide:function J(){mstrMobileApp.hideProgress();}};}}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=(Y)?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=(Y)?0:U-1;}else{V+=(Y)?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(h){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,g=this._last_hit;if(!this.noCache&&(d||g)){var f=this.filterCandidates(a,h,this.REQUEST_THRESHOLD),b=f.length,e=this.suggestCount,U=false;if(!X&&b<e){var V=g&&g.pattern;if(g&&V&&(h.indexOf(V)>-1)){U=true;var k=this.filterCandidates(g.items,h,this.REQUEST_THRESHOLD),Y=k&&k.length,W=mstrmojo.array,j=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(f,j,k[Z][j])===-1){f.push(k[Z]);}}b=f.length;}}if(!X&&((h.length>2&&b<this.REQUEST_THRESHOLD)||(b<e))){this.requestCandidates(h);return -1;}return(b<e)?f:f.slice(0,e);}this.requestCandidates(h);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(e){if(!e){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var j=d.getSearchPattern(),a=e.items;X._last_hit={items:a,pattern:U};X.sz=e.sz;if(!X.noCache&&a){var f=X.candidates&&X.candidates.items||[],g=[].concat(a);for(var Z=0,b=a.length;Z<b;Z++){var Y=g[Z];if(mstrmojo.array.indexOf(f,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=f.concat(a);}}if(j&&j.indexOf(U)>-1){var h=X.filterCandidates(a,j);X.updateSuggestion(h);}},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:((V)?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var V=this.zIndex;this.openPopup("ob",{zIndex:(V&&(V+10))||110});this.ob.browser.browse({folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes});this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopup:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInputBox-suggest",showTitle:false,modal:false,autoClose:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U&&U.autoSelect){this.list.singleSelect(0);}},onClose:function F(){this.list.clearSelect();if(this.opener){this.opener.suggestionShown=false;}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){var N,J;mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DocPortlet");var Q={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};mstrmojo.Vis=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.Vis",offsetTop:0,offsetLeft:0,isAndroid:window.navigator.userAgent.indexOf("Android")!=-1,updated:false,reRenderOnDimensionChg:true,getFormats:function(){return this.fmts;},isVis:function(){return true;},setModel:function L(V){this.set("model",V);if(V.data){this.set("model",V.data);}this.xtabModel=V;if(typeof (this.controller.getPageByTree)!="undefined"){this.controller.getPageByTree(false);}},destroy:function S(){this._super();var V=this.xtabModel;if(V&&V.destroy){V.destroy();delete this.xtabModel;}},setDimensions:function O(X,W){var V=this._super(X,W);if(V&&this.hasRendered&&this.reRenderOnDimensionChg){this.reRender();}return V;},reRender:function F(){this.unrender();this.render();},getWidth:function B(){return parseInt(this.width,10);},getHeight:function I(){return parseInt(this.height,10);},buildRendering:function H(){if(!this.updated){this.update();}if(this.parent instanceof mstrmojo.DocPortlet){delete this.left;delete this.top;this.height=this.fmts&&this.fmts.height;}this._super();},postBuildRendering:function E(){N=this.width;J=this.height;this.adjustWidgetOffsets();this._super();},adjustWidgetOffsets:function A(){var V=this.domNode,W={top:0,left:0};if(typeof (mstr)!="undefined"){W.top=mstr.utils.BoxModel.getElementSumOffsetTop(V);W.left=mstr.utils.BoxModel.getElementSumOffsetLeft(V);}else{if(typeof (mstrmojo)!="undefined"){W=mstrmojo.boxmodel.offset(V);}}this.offsetTop=W.top;this.offsetLeft=W.left;},initFromVisProps:function R(V){},update:function G(X){X=X||this.node;if(X){if(X.data){this.set("model",X.data);if(this.xtabModel&&this.xtabModel.set){this.xtabModel.set("data",X.data);}this.model=X.data;if(this.model.layoutModel){this.layoutModel=this.model.layoutModel;}if(this.model.layoutNode){this.layoutNode=this.model.layoutNode;}mstrmojo.hash.copy(X.data.extProps,this);}this.fmts=X.defn.fmts||X.defn.units[this.model.k].fmts;var V=this.fmts;if(V){for(var W in Q){v=Q[W];if(W in V){this[v]=V[W];}}}}if(this.model){this.initFromVisProps(this.model.vp);}this.updated=true;},getModel:function M(W){if(W){var V=mstrmojo.Vis.getVisGrid(this.layoutModel,this.layoutNode,W);if(V){return V.data;}else{alert(mstrmojo.desc(8427,"Incorrect visualization properties encountered.  Data may be inconsistent.  Please reset your properties."));}}else{return this.model;}},getDataParser:function K(V){return new mstrmojo.Vis.DataParser(this.getModel(V));},renderErrorMessage:function T(V){this.domNode.innerHTML='<div class="mstrmojo-message">'+V+"</div>";},getMessageID:function D(){return this.model.mid&&this.model.mid||this.xtabModel&&this.xtabModel.docModel&&this.xtabModel.docModel.mid;},hasNoninfowindowTarget:function U(Y){var g=this.xtabModel,f=(g&&g.docModel);var h=false;if(f){var e=f.defn&&f.defn.layouts,X=null;var W;if(e){for(W in e){if(e[W].loaded){X=e[W];break;}}}var Z=X&&X.units;this.selectorTargets={};if(Z&&Y.scObjList){for(var W=0;W<Y.scObjList.length;W++){var a=Y.scObjList[W];var b=a.sc.tks.split("\x1E");for(var V=0;V<b.length;V++){var d=Z[b[V]];if(d){this.selectorTargets[b[V]]=d;if(!this.isChildOfIfw(Z,d)){h=true;}}}}}}return h;},isChildOfIfw:function C(V,W){while(W){if(W.ifw){return true;}W=V[W.pnk];}return false;},performAction:function P(V){var X=this.xtabModel.getAction(V),W=X&&X.h;if(W&&this.controller[W]){this.controller[W](this,X.a);return true;}return false;}});mstrmojo.Vis.getVisGrid=function(V,d,W){var a=d;var Y=V.getChildren(d,false);for(var X=0;X<Y.length;X++){var b=Y[X];if(b.k==W){return b;}else{var Z=mstrmojo.Vis.getVisGrid(V,b,W);if(Z){d=a;return Z;}}}};mstrmojo.Vis.DataParser=function(X){var f=mstrmojo.Vis;return{getRowTitles:function(){return new f.Titles(X,true);},getColTitles:function(){return new f.Titles(X,false);},findMetricValue:function(j,p){var o=X.ghs.rhs.items;for(var k in o){var l=o[k].items;var h=true;for(var g in j){if(j[g]!=l[g].idx){h=false;break;}}if(h){return new mstrmojo.Vis.MetricValue(X.gvs.items[k].items[p]);}}},getTotalRows:function a(){return X.eg?0:X.ghs.rhs.items.length;},getTotalColHeaderRows:function Y(){return(!X.ghs.chs.items?0:X.ghs.chs.items.length);},getTotalCols:function V(){return this.getColHeaders(0).size();},getRowHeaders:function e(g){return new f.Headers(X,g,true);},getColHeaders:function d(g){return new f.Headers(X,g,false);},getMetricValue:function b(h,g){return new f.MetricValue(X,X.gvs.items[h].items[g]);},getColumnHeaderCount:function Z(){return X.gvs.items[0].items.length;},getCSSString:function W(){return X.cssString;}};};mstrmojo.Vis.Titles=function(V,a){var Z=(a)?V.gts.row:V.gts.col;return{size:function Y(){return Z.length;},getTitle:function X(b){return new mstrmojo.Vis.Title(Z[b]);},getCSS:function W(b){return V.css[Z[b].cni].n;}};};mstrmojo.Vis.Headers=function(W,X,b){var d=(b)?W.gts.row:W.gts.col;var a=(b)?W.ghs.rhs:W.ghs.chs;var Y=a.items&&a.items[X].items;return{size:function e(){return(!Y?0:Y.length);},getHeader:function V(f){return Y&&Y[f]&&new mstrmojo.Vis.Header(Y[f],b?d[f]:d[X]);},getCSS:function Z(f){return Y&&W.css[Y[f].cni].n;},getHeaderCell:function(f){return Y&&Y[f];}};};mstrmojo.Vis.Title=function(W){return{getActionType:function(){return W.at;},getDrillPath:function(){return W.dp;},getHeaderValues:function V(){return W.es;},getHeaderName:function X(Z){return W.es[Z].n;},getHeaderId:function X(Z){return W.es[Z].id;},getForms:function Y(){return W.fs;},getFormId:function(){return W.fid;},getFormType:function(){return W.ftp;},getUnitId:function(){return W.id;},getLinkMap:function(){return W.lm;},getName:function(){return W.n;},getUnitDssType:function(){return W.otp;},getSelectorControl:function(){return W.sc;}};};mstrmojo.Vis.Header=function(X,V){return{getName:function Z(){return(X.idx===-1)?"":V.es[X.idx].n;},getElementId:function d(){return(X.idx===-1)?"":V.es[X.idx].id;},getObjectId:function Y(){return(X.idx===-1)?"":V.es[X.idx].oid;},getElementIndex:function W(){return X.idx;},getActionType:function b(){return X.at;},isTotal:function a(){return X.otr===1;}};};mstrmojo.Vis.MetricValue=function(V,d){var b=d;return{getValue:function W(){return b.v;},getThresholdType:function X(){return b.ty;},getRawValue:function a(){return b.rv;},getCSS:function Y(){return V.css[b.cni].n;},getThresholdValue:function e(f){if(b.ti==undefined){return f;}return V.th[b.ti].n;},getFillColor:function Z(f){if(b.ci==undefined){return f;}return V.fc[b.ci].n;}};};})();(function(){mstrmojo.requiresCls("mstrmojo.TextFieldDIC","mstrmojo.android._HasPreviewButton");mstrmojo.android.inputControls.TextFieldDIC=mstrmojo.declare(mstrmojo.TextFieldDIC,[mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",cssDisplay:"block",onfontChange:mstrmojo.emptyFn,applyChanges:function F(){this.domNode.blur();return this._super();},handleInvalid:function A(){mstrmojo.alert(this.validationStatus.msg);},cancelChanges:function D(){this.domNode.blur();this._super();},focus:function B(){this.validate();},onfocus:function E(){if(this.value!=undefined&&this.maxLength!=undefined&&String(this.value).length>this.maxLength){this.set("value","");}window.setTimeout(function(){mstrMobileApp.forceRepaint();},0);},renderPreview:function C(){var I=this.openerNode,J=this.group||this,H=(J.openerType===2)||!!this.dic.dm||this.dicChanged;var G=this.type==="password"?"********":this.dv;this.renderPreviewButton(I,H?G:I.innerHTML);}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileGraph","mstrmojo.graph._CanvasGraph");mstrmojo.graph.MobileXtabCanvasGraph=mstrmojo.declare(mstrmojo.MobileGraph,[mstrmojo.graph._CanvasGraph],{scriptClass:"mstrmojo.graph.MobileXtabCanvasGraph"});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabGraph","mstrmojo.TouchScroller","mstrmojo.graph._MobileGraphAreaHelper","mstrmojo._TouchGestures");var F=mstrmojo.dom;function C(O,L,R){var N=mstrmojo.dom.position(O.domNode,false),Q=0,P=0,M=O.node;if(N){Q=N.x;P=N.y;}O.model.getDataService().handleUserSingleTap(M.data.sid,M.k,L-Q,R-P,false,{success:function(S){O.displayTooltips(S.Areas,Q,P);}});}function J(P){var O="",L=[],S,R,M,N,Q,T;if(!P){return O;}S=P.currlaykey;O=S+"_";R=P.data&&P.data.layouts;for(Q=0;Q<(R.length||0);Q++){N=R[Q];if(N.k===S){M=N;break;}}if(M){if(M.gbys){L=M.gbys.groupbys;for(Q=0;Q<(L.length||0);Q++){T=L[Q];O=O+T.k+":"+T.lvl;if(T.unit){O=O+":"+T.unit.idx;}O=O+"_";}}}return O;}function K(S){this.displayTooltips([],0,0);var N=this,O=this.model.getDataService(),R=mstrmojo.dom.position(this.domNode,true),L=S.pageX-R.x,Q=S.pageY-R.y,M={getBoundingClientRect:function(){var U=S.pageX,T=S.pageY;return{left:U,top:T,right:U+1,bottom:T+1};}},P={success:function(V){var U=V.Areas,W=N.defn,T=N.k,X=V.tks;if(U&&U.length>0){if(U[0].Selectable===1){N.highlightArea(N.selectionNode,U);}else{if(U[0].Selectable===-1){N.highlightedAreas=[];N.clearHighlightArea(N.selectionNode);}}if(X){N.showInfoWin(X,M);}}else{N.highlightedAreas=[];N.clearHighlightArea(N.selectionNode);}window.setTimeout(function(){mstrMobileApp.forceRepaint();N.model.slice({type:parseInt(W.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:T,ck:W.ck,gk:T,sid:N.node.data.sid,x:L,y:Q,tks:X,anchor:M});},0);}};O.handleUserSingleTap(N.node.data.sid,N.k,L,Q,true,P);}function A(M){var L=this.imgNode;if(L.src!==M){L.src=M;F.translate(L,0,0,0);}}mstrmojo.MobileDocXtabGraph=mstrmojo.declare(mstrmojo.DocXtabGraph,[mstrmojo._TouchGestures,mstrmojo.graph._MobileGraphAreaHelper],{scriptClass:"mstrmojo.MobileDocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" {@extra}/>',retrieveGraphSrc:function G(N,L){var O=this.id,M=this.model;if(parseInt(N,10)>0&&parseInt(L,10)>0){M.getDataService().getRWGraphImage({w:L,h:N,k:this.k,sid:this.node.data.sid,gbk:J(M)},M.newCallback({success:function(P){A.call(mstrmojo.all[O],P);}}));}},invalidate:function E(){A.call(this,"");},showTooltip:function I(){},touchSelectBegin:function D(L){this.restoreDefaultTouches(false);C(this,L.pageX,L.pageY);},touchSelectMove:function H(L){this.restoreDefaultTouches(false);C(this,L.pageX,L.pageY);},touchTap:function B(L){this.restoreDefaultTouches(false);K.call(this,L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl");function A(E){var D=[];mstrmojo.array.forEach(E,function(F){D.push(F.n);});return D;}mstrmojo.LikertScaleDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.LikertScaleDIC",styleCssClass:"scale",init:function(D){this._super(D);this.items=this.getItems();this.titleItems=A(this.items);},getDisplayValue:function B(){return(this.selectedIndex>=0)?this.items[this.selectedIndex].n:this.dv;},getLeftEndTitle:function C(D){return D>=0?(this.dic.mint||""):"";},getRightEndTitle:function(D){return D>=0?(this.dic.maxt||""):"";},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,C={0:"default",1:"stars_dots"};mstrmojo.RatingDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RatingDIC",styleCssClass:"rate",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover,mouseout><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',lastIdx:null,init:function(D){this._super(D);this.items=this.getItems();this.starCount=this.items&&this.items.length;B.addWidgetCssClass(this,C[this.dic.stl||0]);},setRating:function(D){var F=0,G=this.starCount,E="less_equal";if(this.lastIdx==undefined||this.lastIdx!=D){for(;F<G;F++){if(F<=D){B.addClass(this._getItemNode(F),E);}else{B.removeClass(this._getItemNode(F),E);}}this.lastIdx=D;}},onvalueChange:function(){this._super&&this._super();var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},onmouseover:function(E){this._super&&this._super(E);var F=E.target||A.eventTarget(E.hWin,E.e),D=F&&F.getAttribute("idx");if(D!=undefined){this.setRating(D);}},onmouseout:function(E){this._super&&this._super(E);var D=mstrmojo.array.find(this.items,"v",this.value);this.setRating(D);},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}var D=mstrmojo.array.find(this.items,"v",this.value);if(D>-1){this.setRating(D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl","mstrmojo.css");mstrmojo.android.inputControls.RadioListDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.android.inputControls.RadioListDIC",styleCssClass:"radio",init:function(B){this._super(B);this.items=this.getItems();this.itemsPerRow=this.dic.ipr||0;},ontouchend:function(B){this.onclick(B);},setDirtyFlag:function A(C,B){mstrmojo.css.addClass(this.itemsNode||B,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.RatingDIC","mstrmojo._TouchGestures");var C=mstrmojo.dom;mstrmojo.android.inputControls.RatingDIC=mstrmojo.declare(mstrmojo.RatingDIC,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.inputControls.RatingDIC",touchTap:function E(F){F.e=F.e||F.evt;this.onclick(F);},touchSwipeMove:function A(H){var G=document.elementFromPoint(H.pageX,H.pageY),F;if(C.contains(this.domNode,G)){F=G&&G.getAttribute("idx");if(F!=undefined){this.setRating(F);this.ratingSelectedValue=this.items[F].v;}}},touchSwipeEnd:function D(F){if(this.ratingSelectedValue!=undefined&&this.ratingSelectedValue!=this.value){this.set("value",this.ratingSelectedValue);}},setDirtyFlag:function B(G,F){mstrmojo.css.addClass(this.itemsNode||F,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo.LikertScaleDIC","mstrmojo.css");mstrmojo.android.inputControls.LikertScaleDIC=mstrmojo.declare(mstrmojo.LikertScaleDIC,null,{scriptClass:"mstrmojo.android.inputControls.LikertScaleDIC",lowestLabel:null,hightestLabel:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}<div class="label {@lowestClass}">{@lowestLabel}</div><div class="label {@hightestClass}">{@hightestLabel}</div></div></div>',init:function A(C){this._super(C);var B=this.titleItems&&this.titleItems.length,E=this.dic.mint&&B,D=this.dic.maxt&&B;this.lowestLabel=E?(this.titleItems[0]+": "+this.dic.mint):"";this.lowestClass=E?"":"hidden";this.hightestLabel=D?(this.titleItems[B-1]+": "+this.dic.maxt):"";this.hightestClass=D?"":"hidden";},getLeftEndTitle:function(B){return"";},getRightEndTitle:function(B){return"";},ontouchend:function(B){this.onclick(B);},setDirtyFlag:function(C,B){mstrmojo.css.addClass(this.itemsNode||B,"tx-active");}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileDocXtabGraph","mstrmojo.graph._CanvasGraph");mstrmojo.graph.MobileDocXtabCanvasGraph=mstrmojo.declare(mstrmojo.MobileDocXtabGraph,[mstrmojo.graph._CanvasGraph],{scriptClass:"mstrmojo.graph.MobileDocXtabCanvasGraph",update:function C(D){delete this.graphData;this._super(D);},setModel:function B(D){this.graphData=D.data;},retrieveGraphSrc:function A(F,D){if(!this.graphData){var H=this.id,E=this._super,G=this.model;if(parseInt(F,10)>0&&parseInt(D,10)>0){this.model.getDataService().getRWGraphImage({w:D,h:F,k:this.k,sid:this.node.data.sid},G.newCallback({success:function(I){var K=mstrmojo.all[H];if(!K){return ;}K.setModel({data:I});E.call(K,F,D);var J=K.parent;if(J&&J.updateScroller){J.updateScroller();}}}));}}else{this._super(F,D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.VisChartUtils","mstrmojo.VisChartData","mstrmojo.boxmodel");function N(S,R){var O="",P=S.length;if(P!==R.hi.length){return S[0].items[R.hi[0]].n;}for(var Q=0;Q<P;Q++){O+=(Q>0?" ":"")+S[Q].items[R.hi[Q]].n;}return O;}mstrmojo.VisChart=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.VisChart",utils:mstrmojo.VisChartUtils,data:mstrmojo.VisChartData,model:null,prevYLabel:{x:0,y:0,h:0},prevXLabel:{x:0,y:0,w:0},context:null,themeColor:"#000000",highlightColor:"#ff8833",margin:{t:50,r:2,b:30,l:2},offsetLeft:null,xLabelPadding:10,yLabelPadding:10,isDrawAxis:true,drawXAxisLabels:true,drawYAxisLabels:true,isHighlightOnTouch:true,isLinearChart:true,showHighlightLine:true,browserSupportsHtml5:true,multiLine:true,drawGridLines:3,drawHorizontalGridLines:1,drawVerticalGridLines:2,switchSeriesOnTouch:true,seriesIndex:-1,displayMode:0,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};position:relative;"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><div id="{@id}-tooltip" class="mstrmojo-Chart-tooltip"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},animationCanvas:function(){return this.domNode.childNodes[1];},highlightCanvas:function(){return this.domNode.childNodes[2];},tooltip:function(){return this.domNode.childNodes[3];}},postBuildRendering:function G(){if(this._super){this._super();}this.browserSupportsHtml5=this.canvas.getContext;if(!this.browserSupportsHtml5){this.renderErrorMessage(mstrmojo.desc(8126,"Your browser does not support HTML5"));return ;}if(!this.model){this.renderErrorMessage(mstrmojo.desc(8426,"No model provided"));return ;}if(this.model.err||this.model.eg){this.renderErrorMessage(this.model.err||this.model.eg);return ;}if(this.isLinearChart){this.data.processLinearData(this);}else{this.data.process(this);}this.windowSize=this.model.series[0].rv.length;this.context=this.canvas.getContext("2d");this.highlightContext=this.highlightCanvas.getContext("2d");this.animationContext=this.animationCanvas.getContext("2d");this.utils.fillBackground(this);if(this.windowSize<=1){return ;}this.plot();},getMaxValue:function C(){var O=this.model.mvalues;return O&&O[O.length-1];},getMinValue:function F(){var O=this.model.mvalues;return O&&O[0];},plot:function J(){this.drawChart();if(this.model.err||this.model.eg){return ;}if(this.isDrawAxis){if(this.isTimeSeries||!(this.isAnimateLines&&(!this.multiLine||this.model.series.length===1))){this.drawLabels();}else{this.drawAxis();}}},drawChart:function M(){},drawAxis:function B(){var P=this.utils,S=this.margin,R=this.getWidth(),O=this.canvas.height,Q=this.context;Q.save();Q.strokeStyle=P.getColor(this);Q.lineWidth=2;Q.globalAlpha=0.3;P.drawRectangle(this,S.l,S.t,R-S.l-S.r,O-S.t-S.b);Q.restore();},drawLabels:function E(){if(!this.isDrawAxis||!this.drawYAxisLabels){return ;}var U=this.model,X=this.utils,S=this.margin,Y=U.mvalues,O=U.ylbls,R=Y.length,Q=this.drawGridLines;this.prevYLabel.x=0;this.prevYLabel.y=0;this.prevYLabel.h=0;for(var T=0;T<R;T++){var W=X.getYValue(this,Y[T]);var V=X.addDataLabel(this,O[T],W,this.prevYLabel);var P=Math.floor(W)+0.5;if(V&&(Q&this.drawHorizontalGridLines)&&T>0&&T<R-1){X.drawHighlightLine(this,P);}if(T==R-1&&this.isTimeSeries&&V&&(Q&this.drawHorizontalGridLines)){X.drawHighlightLine(this,P);}}},renderTooltip:function A(d,b,a){if(d<0){this.tooltip.style.display="none";return ;}var R=this.model,f=R.series,Z=this.utils,T=f.length,W=this.seriesIndex,O=R.colHeaders,e=this.tooltip;var Q="";if(!this.multiLine){Q=N(O,f[0])+": "+f[0].v[d];}else{if(this.showHighlightLine){for(var V=0;V<T;V++){Q+=(V===0?"":"<br/>")+N(O,f[V])+": "+f[V].v[d];}}else{Q=N(O,f[W])+": "+f[W].v[d];}}var Y=this.model.categories.items[d];e.innerHTML=Y+"<br/>"+Q;e.style.display="block";var X=e.offsetWidth;var S=b-X/2;var U=this.margin;if(S<U.l){S=U.l;}else{if(S>this.getWidth()-U.r-X){S=this.getWidth()-U.r-X;}}if(this.showHighlightLine){Z.translateCSS(S,0,false,e);}else{var P=Z.getYValue(this,f[W].rv[d])-e.offsetHeight-20;if(P<0){P=Z.getYValue(this,f[W].rv[d]);}Z.translateCSS(S,P,false,e);}},getTouchValue:function L(P,T){var R=this.model,O=this.margin;var S=R.rne-R.rns>0?R.rne-R.rns>1?R.rne-R.rns:2:this.windowSize;var Q=Math.round(((P-O.l)*(S-1))/(this.getWidth()-O.l-O.r-1));return(Q<S)?Q:null;},highlightPoint:function I(P,O){},handleTouchBegin:function H(P,O){if(!this.isHighlightOnTouch||!this.browserSupportsHtml5){return ;}this.tooltipOn=true;this.adjustWidgetOffsets();this.handleTouchMove(P,O);},handleTouchMove:function D(R,Q){var U=this,P=U.model;if(!U.tooltipOn||!U.isHighlightOnTouch||!this.browserSupportsHtml5||this.windowSize<=1){return ;}var T=U.utils.getTouchXYOnWidget(R,Q,U);R=T.touchX;Q=T.touchY;var V=U.margin;if(R<V.l||Q<V.t||Q>U.canvas.height-V.b){return ;}var S=U.getTouchValue(R,Q);if(S!==null){var O=(P.rne-P.rns>1)?P.rns:P.rns-1;if(U.seriesIndex===-1||U.switchSeriesOnTouch){U.seriesIndex=U.utils.getSeriesIndexAndYValue(U,O+S,Q).si;}if(P.series[U.seriesIndex].rv[O+S]===""){return ;}U.prevHighlight=U.currentHighlight;U.currentHighlight=S;U.renderTooltip(S,R,Q);if(this.isTimeSeries){U.highlightPoint(S,R,Q);}else{U.highlightPoint(S,Q);}}},handleTouchEnd:function K(){if(!this.browserSupportsHtml5){return ;}var O=this;if(O.model.err||this.model.eg){return ;}O.tooltipOn=false;O.seriesIndex=-1;O.currentHighlight=null;O.highlightCanvas.height=O.highlightCanvas.height;O.tooltip.style.display="none";},onmousedown:function(O){if(!this.isAndroid){this.handleTouchBegin(O.e.pageX,O.e.pageY);}},onmouseup:function(O){if(!this.isAndroid){this.handleTouchEnd();}},onmousemove:function(O){if(!this.isAndroid){this.handleTouchMove(O.e.pageX,O.e.pageY);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.url","mstrmojo.Vis","mstrmojo._CanSupportTransaction");mstrmojo.PhotoUploader=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._CanSupportTransaction,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.PhotoUploader",photoNum:0,markupString:'<div id="{@id}" class="mstrmojo-PhotoUploader" style="left:{@left};top:{@top};width:{@width};height:{@height}" mstrAttach:click><div class="actionButton" style="line-height:{@height}">{@n}</div><img class="preview"></img><div class="numberBadge"><div class="badgeText"></div></div></div>',markupSlots:{buttonNode:function(){return this.domNode.firstChild;},previewNode:function(){return this.domNode.childNodes[1];},badgeNode:function(){return this.domNode.lastChild;},badgeTextNode:function(){return this.domNode.lastChild.firstChild;}},markupMethods:{onphotoNumChange:function(){mstrmojo.css.toggleClass(this.domNode,"empty",this.photoNum==0);if(this.photoNum>0){this.badgeTextNode.innerHTML=this.photoNum;}}},preBuildRendering:function(){this._super();var E=this.getDataParser(),J=E.getRowTitles(),C=E.getColTitles(),F,I,H,G,D,B;if(J.size()<3&&C.size()<1){mstrmojo.alert("Incorrect grid template structure!");return false;}else{if(E.getTotalRows()<10){mstrmojo.alert("At least 10 rows required!");return false;}}F=E.getRowHeaders(0);I=J.getTitle(0);H=J.getTitle(1);D=I.getUnitId();B=H.getUnitId();G=C.getTitle(0).getHeaderValues()[0];this.cellInfo=[{atid:D,form_id:I.getFormId(),ui:0},{atid:B,form_id:H.getFormId(),ui:(D==B)?0:1},{metric_id:G.oid}];this.photoNum=0;this.n=mstrmojo.desc(8470);},setModel:function(B){this.model=this.txModel=B&&B.docModel;},getKeyContext:function(B){return{o:parseInt(B,10)};},getUpdateObject:function(D){var B=this.getUpdatedValues(),H=2,I=[],J=this.cellInfo;for(var D in B){var E=B[D],C=mstrmojo.string.encodeXMLAttribute(String(E.v[0])),G=mstrmojo.string.encodeXMLAttribute(String(E.v[1])),F="1";I.push({rowOrdinal:E.o,attId:J[0].atid,formId:J[0].form_id,unitIndex:J[0].ui,newValue:C},{rowOrdinal:E.o,attId:J[1].atid,formId:J[1].form_id,unitIndex:J[1].ui,newValue:G},{rowOrdinal:E.o,colOrdinal:0,newValue:F});}return{manipulation:H,nodeKey:this.k,sliceId:this.sid,cells:I,autoRefresh:false};},getUpdates:function A(){var D=[],L=this,E,K=false,C=this.getUpdatedValues(),I,J=1,G=2,B=9,H=1,M=this.cellInfo;D.push('<gr rw_tree_type="'+this.defn.tt+'" rw_node_key="'+L.k+'" slice_id="'+(L.sid||0)+'">');for(E in C){if(C.hasOwnProperty(E)){I=C[E];for(var F=0;F<2;F++){D.push('<cli ax="1" attribute_id="'+M[F].atid+'" form_id="'+M[F].form_id+'"><updt types="'+J+'" ordinal="'+I.o+'" value="'+I.v[F]+'" dt="'+B+'"/></cli>');}D.push('<cli cordinal="0" metric_id="'+M[2].metric_id+'"><updt types="'+G+'" rordinal="'+I.o+'" value="1" dt="'+H+'"/></cli>');K=true;}}D.push("</gr>");if(!K){D=[];}return D.join("");},photoUploaded:function(B,E){mstrMobileApp.setWaitScreenVisibility(false);var C=mstrmojo.url.getAbsoluteURL(B,mstrApp.getConfiguration().getCurrentProjectWebServerUrl()),F=E,D=this.photoNum;this.previewNode.src=C;this.dataChanged(D,{},{v:[C,F]});this.set("photoNum",D+1);},touchTap:function(){this.onclick();},onclick:function(){if(this.photoNum==10){mstrmojo.alert("can upload at most 10 photos");}else{var B={serverUrl:mstrApp.getConfiguration().getTaskUrlByProject(mstrApp.getCurrentProjectId()),sessionState:mstrApp.getSessionState(),descs:{ADD_PHOTO:mstrmojo.desc(8470),TAKE_NEW_PHOTO:mstrmojo.desc(8471),CHOOSE_FROM_GALLERY:mstrmojo.desc(8472),DONE:mstrmojo.desc(8473),CANCEL:mstrmojo.desc(221)}};mstrMobileApp.uploadPhotos(JSON.stringify(B),'mstrmojo.all["'+this.id+'"].photoUploaded');}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.dom","mstrmojo.VisHeatMapColorTheme","mstrmojo.VisHeatMapPopup","mstrmojo.VisHeatMapTree","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.num","mstrmojo._HasWaitIcon","mstrmojo.EnumReadystate","mstrmojo.css","mstrmojo.VisHeatMapCanvas");var $READYSTATE=mstrmojo.EnumReadystate;var DRILLING_ACTION=1,SELECTOR_ACTION=2,HYPERLINK_ACTION=4,INFOWINDOW_ACTION=4;var $CSS=mstrmojo.css,cssShow="heatmap-show";var LabelSize={On:0,Off:1,Proportional:2};var AggregationType={Sum:0,Avg:1,Cnt:2,Max:3,Min:4,GeoAvg:5};var BandDirection={LeftToRight:0,RightToLeft:1,Center:2,None:3};var LayoutAlgorithm={Squarified:0,PivotByMiddle:1,SliceAndDice:2};var LayoutProperties={Padding:6,MaxLegendHeight:60,LegendMenuEditorWidth:70,LegendTickCount:5,LegendMinWidth:15,LegendTickLength:4,LegendMaxBandWidth:400,LegendWidthPercent:0.9,LegendMinPadding:15,LegendBottomPadding:3,LegendGutter:5,LegendBandAspect:10,MinShowLabelDimension:6,DeletedListHeight:500,EditorDialogWidth:565,EditorDialogHeight:574,EditButtonWidth:60,EditButtonHeight:40,EditButtonRight:10,WaitIconWidth:205,WaitIconHeight:105,WaitIconMargin:10,WaitIconFontSize:20};var Spec={heatmap_popup_panel_title:{font_size:{value:18,unit:"pt"}},heatmap_gray_label:{padding_bottom:{value:7,unit:"px"},font_size:{value:10,unit:"pt"},height:{value:32,unit:"px"},padding_left:{value:22,unit:"px"}},heatmap_tree_button:{font_size:{value:12,unit:"pt"}},heatmap_one_level_1:{font_size:{value:14,unit:"pt"}},heatmap_multi_level_1:{font_size:{value:24,unit:"pt"}},heatmap_two_level_2:{font_size:{value:14,unit:"pt"}},heatmap_multi_level_2:{font_size:{value:20,unit:"pt"}},heatmap_multi_level_3:{font_size:{value:10,unit:"pt"}},heatmap_size_legend:{font_size:{value:12,unit:"pt"}},heatmap_color_legend:{font_size:{value:12,unit:"pt"}},heatmap_color_legend_label:{font_size:{value:12,unit:"pt"}},heatmap_color_legend_tooltip:{font_size:{value:12,unit:"pt"}},heatmap_color_legend:{font_size:{value:12,unit:"pt"}},heatmap_editor_button:{font_size:{value:12,unit:"pt"}},heatmap_tooltip_gray_bold:{font_size:{value:14,unit:"pt"}},heatmap_tooltip_gray:{font_size:{value:14,unit:"pt"}},heatmap_tooltip_black_bold:{font_size:{value:14,unit:"pt"}},heatmap_tooltip_black:{font_size:{value:14,unit:"pt"}},heatmap_tree_div:{font_size:{value:18,unit:"pt"}},heatmap_tree_root__heatmap_tree_div:{font_size:{value:14,unit:"pt"}}};var Fake_Metric_ID="--";var Background_Color=16119287;var EID_SELECTALL="OA:(All)";function adjustPixel(px,forceFix){var DPIX=149,base=160;if(forceFix){base=149;}if(this.enableMultiDPI||forceFix){DPIX=this.DPIX;}return parseInt(px*(DPIX/base));}function getCSSColor(rgb){var c=16777216+rgb;var str="#"+c.toString(16).substring(1).toUpperCase();return str;}function roundNumber(n,l){return Math.round(n*Math.pow(10,l))/Math.pow(10,l);}function createPath(x,y,w,h,r,ctx){ctx.beginPath();ctx.moveTo(x+r,y);ctx.lineTo(x+w-r-1,y);ctx.quadraticCurveTo(x+w-1,y,x+w-1,y+r);ctx.lineTo(x+w-1,y+h-r-1);ctx.quadraticCurveTo(x+w-1,y+h-1,x+w-r-1,y+h-1);ctx.lineTo(x+r,y+h-1);ctx.quadraticCurveTo(x,y+h-1,x,y+h-r-1);ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);ctx.closePath();}function updateEntityAggValue(ev,rawValue,needsCopy){if(needsCopy&&ev.total===undefined){ev.avgTotal=ev.total=ev.geomProduct=ev.max=ev.min=ev.value;ev.count=isNaN(ev.value)?0:1;ev.positiveCount=ev.value>0?1:0;}ev.value=rawValue;ev.allChildrenCount++;if(!isNaN(rawValue)){if(isNaN(ev.total)){ev.total=rawValue;}else{ev.total+=rawValue;}if(isNaN(ev.avgTotal)){ev.avgTotal=rawValue;}else{ev.avgTotal+=rawValue;}if(isNaN(ev.max)){ev.max=rawValue;}else{ev.max=Math.max(ev.max,rawValue);}if(isNaN(ev.min)){ev.min=rawValue;}else{ev.min=Math.min(ev.min,rawValue);}if(isNaN(ev.geomProduct)){if(rawValue>0){ev.geomProduct=rawValue;ev.positiveCount++;}}else{if(rawValue>0){ev.geomProduct*=rawValue;ev.positiveCount++;}}ev.count++;}}function updateEntityContainerAggValue(ev,oldev){var rawValue=oldev.total;if(!isNaN(rawValue)){if(isNaN(ev.total)){ev.total=rawValue;}else{ev.total+=rawValue;}ev.count++;}rawValue=oldev.avg;if(!isNaN(rawValue)){if(isNaN(ev.avgTotal)){ev.avgTotal=rawValue;}else{ev.avgTotal+=rawValue;}}rawValue=oldev.max;if(!isNaN(rawValue)){if(isNaN(ev.max)){ev.max=rawValue;}else{ev.max=Math.max(ev.max,rawValue);}}rawValue=oldev.min;if(!isNaN(rawValue)){if(isNaN(ev.min)){ev.min=rawValue;}else{ev.min=Math.min(ev.min,rawValue);}}rawValue=oldev.geomAvg;if(!isNaN(rawValue)){if(isNaN(ev.geomProduct)){if(rawValue>0){ev.geomProduct=rawValue;ev.positiveCount++;}}else{if(rawValue>0){ev.geomProduct*=rawValue;ev.positiveCount++;}}}}function decodeXML(s){return s.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"');}var delStatus={dftUnDel:0,dftDel:1,usrDel:2};function parseDeletedList(s){var oParser=new DOMParser(),oDOM=oParser.parseFromString(decodeXML(s),"text/xml"),i=0,ce=oDOM.childNodes[0],l=oDOM.childNodes[0].childElementCount;if(l==0){return{};}var cr=ce.firstElementChild,at=cr.attributes,al=at.length,ret=this.props.deletedList||{},dict=ret,key;while(i<l){dict=ret;at=cr.attributes;for(var j=0;j<al;j++){key=at[j].value;if(j===(al-1)){dict[key]=delStatus.dftDel;}else{if(!dict[key]){dict[key]={};}dict=dict[key];}}i++;cr=cr.nextElementSibling;}return ret;}function loadSession(){var props=this.props,session=this.controller.view.model.session;if(session){if(session.db!==undefined){props.delButtonEnabled=session.db;}if(session.dl!==undefined){props.deletedList=mergeDeletedList(props.deletedList,session.dl);}if(session.ps!=undefined){this.previousSelected=lookUpSelectionDic.call(this,session.ps);}this.isUsingSavedColorTheme=session.isUsingSavedColorTheme;this.isUsingDefaultColorTheme=session.isUsingDefaultColorTheme;}function lookUpSelectionDic(sd){var root=this.root;for(var i=0,len=sd.length;i<len;i++){var children=root.entityChildren;for(var j=0,l=children.length;j<l;j++){var ret=null;if(this.getEntityDisplayName(children[j])===sd[i]){ret=children[j];root=ret;break;}}}return ret;}function mergeDeletedList(d1,d2){function merge(a,b){var keys=Object.keys(b),len=keys.length;for(var i=0;i<len;i++){var key=keys[i];if(typeof b[key]!=="object"){a[key]=b[key];}else{if(a[key]===undefined){a[key]={};}merge(a[key],b[key]);}}}var ret={};merge(ret,d1);merge(ret,d2);return ret;}}function storeSession(){var cvm=this.controller.view.model,session={},props=this.props;cvm.session=session;if(props.delButtonEnabled!==undefined){session.db=props.delButtonEnabled;}if(props.deletedList!==undefined){session.dl=props.deletedList;}if(this.previousSelected){session.ps=generateSelectionDic.call(this,this.previousSelected);}session.isUsingSavedColorTheme=this.isUsingSavedColorTheme;session.isUsingDefaultColorTheme=this.isUsingDefaultColorTheme;function generateSelectionDic(entity){var sd=[];while(entity.parent){sd.push(this.getEntityDisplayName(entity));entity=entity.parent;}return sd;}}function loadProps(){this.props={};var props=this.props,m=this.model,propValue=m.vp?m.vp:{},temp;props.deletedList={};props.delButtonEnabled=false;props.showMetricValues=false;props.refreshType=0;props.labelSize=LabelSize.On;props.showLegend=true;props.sizeMetricEnabled=true;props.colorMetricEnabled=true;props.layout=LayoutAlgorithm.Squarified;props.legendAsc=true;var w=mstrmojo.VisHeatMapColorTheme.newInstance();w.initialize();this.colorTheme=w;if(propValue.dl){props.deletedList=parseDeletedList.call(this,propValue.dl);}if(propValue.ed){props.delButtonEnabled=(propValue.ed=="true"?true:false);}if(propValue.mv){props.showMetricValues=(propValue.mv=="true"?true:false);}if(propValue.rt!=""){props.refreshType=parseInt(propValue.rt);}if(propValue.ml){temp=propValue.ml.split(",");if(temp.length>=2){props.sizeMetricID=temp[0];props.colorMetricID=temp[1];}}if(propValue.lb){temp=propValue.lb;if(temp=="Off"){props.labelSize=LabelSize.Off;}else{if(temp=="Proportional"){props.labelSize=LabelSize.Proportional;}}}if(propValue.lg){props.showLegend=(propValue.lg=="true"?true:false);}if(propValue.rlp=="false"&&propValue.abs){w.convertAbsoluteToBlend(this,propValue);}if(propValue.blc){w.isBlend=(propValue.blc=="true"?true:false);}if(propValue.gradientColors&&propValue.bandColors){w.createDataProviderFromString(propValue.gradientColors,propValue.bandColors);}if(propValue.la){props.layout=parseInt(propValue.la,10);}if(propValue.rlp=="false"&&propValue.abs){this.colorTheme.convertAbsoluteToBlend(this,propValue);this.colorTheme.createDataProviderFromString(propValue.gradientColors,propValue.bandColors);}}function setLayout(){var widgetWidth=parseInt(this.width,10),widgetHeight=parseInt(this.height,10),heatMapWidth=widgetWidth-2*this.LayoutProperties.Padding,legendHeight=0,heatMapHeight;if(this.model.gvs.items.length<=0){this.props.showLegend=false;}if(this.props.showLegend){legendHeight=Math.min(Math.floor(0.2*(widgetHeight-2*this.LayoutProperties.Padding)),this.LayoutProperties.MaxLegendHeight);heatMapHeight=widgetHeight-legendHeight-3*this.LayoutProperties.Padding;}else{heatMapHeight=widgetHeight-2*this.LayoutProperties.Padding;}this.heatMapSize={x:0,y:0,w:heatMapWidth,h:heatMapHeight};this.legendSize={x:0,y:widgetHeight-2*this.LayoutProperties.Padding-legendHeight,w:widgetWidth,h:legendHeight};this.infoWindowSize={maxWidth:parseInt(this.width)-60,maxHeight:parseInt(this.height)-60};this.maxScale=10;}function resetMetricIndices(){var m=this.model,l=m.ghs.chs.items[0]?m.ghs.chs.items[0].items.length:0,sid=this.props.sizeMetricID,cid=this.props.colorMetricID,a=[];this.metricArray=a;for(var i=0;i<l;i++){a.push(getMetricID.call(this,i));}a.push(Fake_Metric_ID);l++;this.sizeMetricIndex=0;this.colorMetricIndex=l>2?1:0;for(var i=0;i<l;i++){if(sid==a[i]){this.sizeMetricIndex=i;}if(cid==a[i]){this.colorMetricIndex=i;}}if(sid===undefined){sid=a[this.sizeMetricIndex];this.props.sizeMetricID=sid;}if(cid===undefined){cid=a[this.colorMetricIndex];this.props.colorMetricID=cid;}var gvs=m.gvs&&m.gvs.items,lgvs=gvs&&gvs.length,i,sidx=this.sizeMetricIndex,cidx=this.colorMetricIndex;this.sizeByMetricMissing=true;this.colorByMetricMissing=true;for(i=0;i<lgvs;i++){var values=gvs[i]&&gvs[i].items;if(values[sidx]===undefined||values[sidx].rv!==""){this.sizeByMetricMissing=false;break;}}for(i=0;i<lgvs;i++){var values=gvs[i]&&gvs[i].items;if(values[cidx]===undefined||values[cidx].rv!==""){this.colorByMetricMissing=false;break;}}if(this.sizeByMetricMissing){this.props.sizeMetricEnabled=false;this.sizeMetricIndex=a.length-1;this.props.sizeMetricID=a[this.sizeMetricIndex];}if(this.colorByMetricMissing){this.props.colorMetricEnabled=false;}if(this.props.sizeMetricID===Fake_Metric_ID){this.props.sizeMetricEnabled=false;}if(this.props.colorMetricID===Fake_Metric_ID){this.props.colorMetricEnabled=false;this.colorTheme.hasNoColorMetric=true;}if(this.props.sizeMetricEnabled==false&&this.props.colorMetricEnabled==false){this.props.showLegend=false;}}function loadMetricsInfo(){this.aggFunctions=[];var props=this.props,cid=props.colorMetricID,af=this.aggFunctions,m=this.model,propValue=m.vp?m.vp:{},ar=this.metricArray,l=ar.length-1;if(cid!=Fake_Metric_ID){var mlEnabled=(propValue["mle"+cid]=="true")?true:false;if(mlEnabled){var val=parseFloat(propValue["mlma"+cid]);if(!isNaN(val)){this.mlmax=val;}val=parseFloat(propValue["mlmi"+cid]);if(!isNaN(val)){this.mlmin=val;}}}for(var i=0;i<l;i++){var id="agf"+ar[i];if(propValue[id]!==undefined){af.push(parseInt(propValue[id]));}else{af.push(AggregationType.Sum);}}}function totalRow(row){for(var i=0;i<row.length;i++){var obj=row[i].etk;if(obj==-1||obj=="-1"){return true;}}return false;}function convertDataToModels(){resetMetricIndices.call(this);loadMetricsInfo.call(this);var m=this.model,deletedList=this.props.deletedList,att=m.gts.row,atl=att.length,mv=m.gvs.items,rl=m.ghs.rhs?m.ghs.rhs.items.length:0;ml=mv[0]?mv[0].items.length:0,rhs=m.ghs.rhs.items;if(atl<=0){var errmsg="The Heat Map requires at least one attribute on row axis to render properly; it is recommended that two metrics be placed on the column axis as well.";m.err=mstrmojo.desc(11147,errmsg);return ;}this.singleSelection=false;this.hasNegativeSizeValue=false;this.levelAttributes=[];this.root={aggValues:[],entityChildren:[],level:0};for(var i=0;i<atl;i++){this.levelAttributes[i]={index:i,order:i+1,isInLOA:i+1>0?true:false};}var hashDict={},attSpan=[];for(var i=0;i<atl;i++){var o=att[i].fs;attSpan[i]=Math.max(1,o?o.length:1);}this.attSpan=attSpan;var isAllSelectable=true,lastSerialRowIndex,serialEntity,highestLevelEntity,highestLevelIndex;for(var i=0;i<rl;i++){var attributeArray=[],rowHeaderData=rhs[i].items,k;if(totalRow(rowHeaderData)){continue;}var levelID="",delDict=deletedList,parent=this.root,cur=0,entity,str,serialEndIndex=-1;for(var j=0;j<atl;j++){var index,newEntity;str="";for(var k=0;k<attSpan[j];k++,cur++){index=rowHeaderData[cur].idx;if(index==-1){continue;}str+=att[j].es[index].n+" ";if(k==0){levelID+=index;}}str=str.substring(0,str.length-1);if(delDict){delDict=delDict[decodeXML(str)];}if(j!=atl-1){if(hashDict[levelID]!==undefined){parent=hashDict[levelID];}else{var entityContainer={aggValues:[],entityChildren:[],parentEntity:parent};var childrenArray=parent.entityChildren;childrenArray.push(entityContainer);hashDict[levelID]=entityContainer;parent=entityContainer;entityContainer.deleted=false;entityContainer.text=str;entityContainer.label=str;entityContainer.level=j;entityContainer.index=i;}levelID+=":";newEntity=entityContainer;}else{if(hashDict[levelID]!==undefined){entity=hashDict[levelID];var indice=entity.indices;indice.push(i);for(var k=0;k<ml+1;k++){var ev=entity.aggValues[k];var rawValue;if(k==ml){rawValue=1;}else{rawValue=mv[i].items[k].rv;}updateEntityAggValue(ev,parseFloat(rawValue),true);if(!isNaN(rawValue)){this.aggregated=true;}}}else{entity={indices:[],aggValues:[],parentEntity:parent};var indice=entity.indices;indice.push(i);var aggValues=entity.aggValues;for(var k=0;k<ml+1;k++){var ev={};aggValues[k]=ev;var rawValue;if(k==ml){rawValue=1;}else{rawValue=mv[i].items[k].rv;}ev.value=parseFloat(rawValue);ev.allChildrenCount=1;}this.aggregated=false;if(delDict){entity.deleted=true;this.colorTheme.useDefault=false;}var childrenArray=parent.entityChildren;childrenArray.push(entity);entity.level=atl-1;entity.text=str;entity.label=str;hashDict[levelID]=entity;}newEntity=entity;}if(rowHeaderData[j].cet!=undefined){if(j-serialEndIndex!=1||(!isNaN(lastSerialRowIndex)&&lastSerialRowIndex!=i)){isAllSelectable=false;}if(isAllSelectable){serialEntity=newEntity;serialEndIndex=j;lastSerialRowIndex=i;}if(isNaN(highestLevelIndex)||highestLevelIndex<j){highestLevelIndex=j;highestLevelEntity=newEntity;}}}}if(isAllSelectable){this.previousSelected=serialEntity;}else{this.previousSelected=highestLevelEntity;}checkSelector.call(this);checkLinkDrill.call(this);}function clearMaxMinValues(){this.cmax=NaN;this.cmin=NaN;this.smax=NaN;this.smin=NaN;}function checkLinkDrill(){this.hasLinkDrill=false;var rowHeader=this.model.gts.row,rl=rowHeader.length;for(var i=0;i<rl;i++){var attr=rowHeader[i];if(attr.lm){for(var j=0;j<attr.lm.length;j++){if(attr.lm[j].links){break;}}if(j!=attr.lm.length){this.hasLinkDrill=true;this.firstRowLinkDrillIndex=i;break;}}}var metricH=this.model.gts.col[0];if(!metricH){return ;}var metricHL=metricH.es.length;for(var i=0;i<metricHL;i++){var metric=metricH.es[i],lm=metricH.lm[i];if(lm&&lm.links){this.hasLinkDrill=true;this.firstColLinkDrillIndex=i;break;}}}function checkSelector(){this.hasSelector=false;var m=this.model,rown=m.gts.row,rl=rown.length;var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel),layouts=(docModel&&docModel.defn&&docModel.defn.layouts),currentLayout;for(var i=0;layouts&&i<layouts.length;i++){if(layouts[i].loaded==true){currentLayout=layouts[i];break;}}var units=(currentLayout&&currentLayout.units);for(var i=0;i<rl;i++){var att=rown[i];if(att.otp!=-1&&att.sc!==undefined){this.hasSelector=true;var targets=att.sc.tks;if(typeof targets!="string"){continue;}targets=targets.split("\x1E");var len=targets.length;this.hasGridTarget=false;for(var j=0;j<len;j++){if(targets[j]==""){continue;}targetName=targets[j];if(units&&units[targetName]&&!units[targetName]["ifw"]){this.hasGridTarget=true;return ;}}}}}function layoutEntities(){var width=this.width-2*this.LayoutProperties.Padding;var legendHeight=0;if(this.props.showLegend){legendHeight=Math.min(Math.floor(0.2*(parseInt(this.height)-2*this.LayoutProperties.Padding)),this.LayoutProperties.MaxLegendHeight);}var hm=this,area=copyRect(this.heatMapSize);area.w*=this.scaleFactor;area.h*=this.scaleFactor;var min=Math.min(area.w,area.h);var ch=this.root.entityChildren;switch(this.props.layout){case LayoutAlgorithm.Squarified:var arr=ch.slice(0);arr.sort(function sortEntity(s,t){var vs=getSizeValue(s,hm);var vt=getSizeValue(t,hm);if(isNaN(vs)){if(isNaN(vt)){return 0;}return 1;}else{if(isNaN(vt)){return -1;}return vs<vt?1:-1;}return 0;});squarify.call(this,arr,{r:[]},min,area);break;case LayoutAlgorithm.SliceAndDice:sliceAndDice.call(this,ch,area);break;case LayoutAlgorithm.PivotByMiddle:var arr=getVisibleEntities.call(this,ch),l=arr.length;if(l>0){pivotByMiddle.call(this,arr,0,l-1,area);}break;}}function squarify(t,r,m,c,a){var newRow=false;if(t.length==0){setLayoutOrder.call(this,r,c);}else{var area=c.w*c.h;var cwa;if(a!==undefined){cwa=a;}else{cwa=worstAspect.call(this,r,m,area);}var data=t[0],arr=r.r;arr.push(data);var fwa=worstAspect.call(this,r,m,area);if(cwa>=fwa||cwa==-1){t.shift();squarify.call(this,t,r,m,c,fwa);}else{r.r.pop();setLayoutOrder.call(this,r,c);m=Math.min(c.w,c.h);if(r.t===undefined){squarify.call(this,t,{r:[]},m,c);}else{squarify.call(this,t,{r:[],t:r.t},m,c);}}}}function getTextStyle(l,w){var fs,css,len=w.levelAttributes.length;if(len==1){if(l==0){css="heatmap-one-level-1";fs=this.Spec.heatmap_one_level_1.font_size.value;}}else{if(len==2){if(l==0){css="heatmap-multi-level-1";fs=this.Spec.heatmap_multi_level_1.font_size.value;}else{if(l==1){css="heatmap-two-level-2";fs=this.Spec.heatmap_two_level_2.font_size.value;}}}else{if(len>=3){if(l==0){css="heatmap-multi-level-1";fs=this.Spec.heatmap_multi_level_1.font_size.value;}else{if(l==1){css="heatmap-multi-level-2";fs=this.Spec.heatmap_multi_level_2.font_size.value;}else{css="heatmap-multi-level-3";fs=this.Spec.heatmap_multi_level_3.font_size.value;}}}}}return{css:css,size:fs};}function getRectangleGap(e){var getGapPixel=function(){var te=e,level=e.level,l=this.levelAttributes.length;if(l==1){return 1;}if(l==2){if(level==0){return 3;}return 1;}if(l==3){if(level==0){return 6;}if(level==1){return 3;}return 1;}else{if(level==0){return 8;}if(level==1){return 4;}if(level==2){return 2;}return 1;}};var ret,gap=getGapPixel.call(this);if(this.DPI>160){ret=adjustPixel.call(this,gap);}else{ret=gap;}if(ret<=0){ret=1;}return ret;}function rectIsValid(a){return a.w>0&&a.h>0;}function rectIntersection(a,b){var x=Math.max(a.x,b.x);var y=Math.max(a.y,b.y);var w=Math.min(a.x+a.w,b.x+b.w)-x;var h=Math.min(a.y+a.h,b.y+b.h)-y;if(w<0||h<0){return{x:NaN,y:NaN,w:NaN,h:NaN};}return{x:x,y:y,w:w,h:h};}function rectIsEqual(a,b){if(a.x==b.x&&a.y==b.y&&a.w==b.w&&a.h==b.h){return true;}else{return false;}}function rectCanEncircle(a,b){var c=rectIntersection(a,b);return rectIsEqual(c,b);}function rectPutAside(a,b,c){var p=[{x:b.x-a.w,y:b.y+b.h/2-a.h/2,w:a.w,h:a.h},{x:b.x+b.w,y:b.y+b.h/2-a.h/2,w:a.w,h:a.h},{x:b.x+b.w/2-a.w/2,y:b.y-a.h,w:a.w,h:a.h},{x:b.x+b.w/2-a.w/2,y:b.y+b.h,w:a.w,h:a.h}];for(var i=0;i<4;i++){if(rectCanEncircle(c,p[i])){return{rect:p[i],index:i};}}}function swapRect(a){var temp=a.x;a.x=a.y;a.y=temp;temp=a.w;a.w=a.h;a.h=temp;return a;}function copyRect(a){var b={};b.x=a.x;b.y=a.y;b.w=a.w;b.h=a.h;return b;}function worstAspect(r,m,a){var worst,arr=r.r,l=arr.length;if(l>0&&a>0){var e=arr[0];var pval=getSizeValue(e.parentEntity,this);if(isNaN(pval)||pval<=0){return -1;}var min,max,sum=0,val,e,inited=false;for(var i=0;i<l;i++){e=arr[i];if(!e.deleted){val=getSizeValue(e,this);if(!isNaN(val)){if(inited==false){max=min=val;inited=true;}else{max=Math.max(val,max);min=Math.min(val,min);}sum+=val;}}}var suba=a*sum/pval,otherMin=suba/m,newMin=(m<otherMin)?m:otherMin;max=a*max/pval;min=a*min/pval;var e1=max/(newMin*newMin);var e2=min/(newMin*newMin);e1=(e1>1)?e1:(1/e1);e2=(e2>1)?e2:(1/e2);worst=Math.max(e1,e2);}else{worst=-1;}return worst;}function layoutRow(r,c,n,sum,swapped){var width,height,ch=r.r,l=ch.length,w,h,tmpc,localSwapped=false;if(l==0){return ;}if(n<c.h){w=n;h=c.h;tmpc=c;}else{w=c.h;h=n;var tmpc=copyRect(c);swapRect(tmpc);localSwapped=true;}var x=tmpc.x,y=tmpc.y,bound={x:x,y:y,w:w,h:h};var gap=getRectangleGap.call(this,ch[0]);for(var i=0;i<l;i++){var e,rect,minDim;e=ch[i];if(e.deleted){if((swapped==true&&localSwapped!=true)||(swapped==false&&localSwapped==true)){e.size={x:y,y:x,w:0,h:0};}else{e.size={x:x,y:y,w:0,h:0};}continue;}var value=getSizeValue(e,this);height=(sum<=0||e.deleted)?0:Math.ceil(h*value/sum);width=w;if(e.entityChildren!==undefined){if(value<sum){if(i==0){if(gap>1){height-=(gap>>1);}else{height--;}}else{if(i<l-1){if(gap>1){height-=gap;}else{height--;}}else{height=h+tmpc.y-y;}}}var nc={x:x,y:y,w:width,h:height};rect=rectIntersection(nc,bound);if((swapped==true&&localSwapped!=true)||(swapped==false&&localSwapped==true)){swapRect(nc);swapRect(rect);}if(rectIsValid(rect)){e.size=rect;}else{e.size={x:rect.x,y:rect.y,w:0,h:0};}minDim=Math.min(rect.w,rect.h);var hm=this;var arr=e.entityChildren.slice(0);arr.sort(function sortEntity(s,t){var vs=getSizeValue(s,hm);var vt=getSizeValue(t,hm);if(isNaN(vs)){if(isNaN(vt)){return 0;}return 1;}else{if(isNaN(vt)){return -1;}return vs<vt?1:-1;}return 0;});squarify.call(this,arr,{r:[]},minDim,nc);y+=height+gap;}else{if(value<sum){if(i==0||i==l-1){if(gap>1){if(height>(gap>>1)){height-=(gap>>1);}}else{if(height>1){height--;}}}else{if(height>gap){height-=gap;}}}width=Math.max(0,width);height=Math.max(0,height);var rect=rectIntersection({x:x,y:y,w:width,h:height},bound);rect.x=x;rect.y=y;y+=height+gap;if(y>=tmpc.y+h){rect.h=tmpc.y+h-rect.y;}if((swapped==true&&localSwapped!=true)||(swapped==false&&localSwapped==true)){rect=swapRect(rect);}if(rectIsValid(rect)){e.size=rect;}else{e.size={x:rect.x,y:rect.y,w:0,h:0};}}}}function setLayoutOrder(r,c){var sum=0,arr=r.r,l=arr.length;if(l==0){return ;}var ra,p=arr[0].parentEntity,ch=p.entityChildren,ll=ch.length;for(var i=0;i<l;i++){var e=arr[i],v=getSizeValue(e,this);if(!e.deleted&&v>0){sum+=v;}}if(r.t===undefined){var t=0;for(var i=0;i<ll;i++){var e=ch[i],v=getSizeValue(e,this);if(!e.deleted&&v>0){t+=v;}}r.t=t;}var e=arr[0],gap=getRectangleGap.call(this,e),bound={x:0,y:0,w:0,h:0};if(e==this.root){ra=this.heatMapSize.w*this.scaleFactor*this.heatMapSize.h*this.scaleFactor;bound.w=this.heatMapSize.w*this.scaleFactor;bound.h=this.heatMapSize.h*this.scaleFactor;}else{if(p==this.root){ra=this.heatMapSize.w*this.scaleFactor*this.heatMapSize.h*this.scaleFactor;bound.w=this.heatMapSize.w*this.scaleFactor;bound.h=this.heatMapSize.h*this.scaleFactor;}else{var pSize=p.size;ra=pSize.w*pSize.h;bound=copyRect(pSize);}if(r.t==0){ra=0;}else{ra*=sum/r.t;}}var aw=c.w,ah=c.h,swapped=false;if(c.h<c.w){}else{swapped=true;swapRect(c);swapRect(bound);var temp=aw;aw=ah;ah=temp;}if((bound.x<c.x)||(bound.x+bound.w>c.x+c.w)){if(gap>1){aw+=(gap>>1);}}if((bound.y<c.y)||(bound.y+bound.h>c.y+c.h)){if(gap>1){ah+=(gap>>1);}}var width=ah==0?0:Math.min(c.w,Math.ceil(ra/ah));if(sum<r.t&&sum>0){if(c.x+width<bound.x+bound.w){if(gap>1){width-=(gap>>1);}else{width--;}}}layoutRow.call(this,r,c,width,sum,swapped);var newX=c.x+width,newWidth=c.w-width;if(sum<r.t&&sum>0){if(c.x+width<bound.x+bound.w){if(gap>1){newX+=gap;newWidth-=gap;}else{newX++;newWidth--;}}}c.x=newX;c.w=Math.max(0,newWidth);if(swapped){swapRect(c);}}function getVisibleEntities(a){if(a==null){return[];}var arr=a.slice(0),total=0,l=arr.length;arr.t=[];for(var i=0;i<l;i++){var e=arr[i],val=getSizeValue(e,this);if(e.deleted||isNaN(val)||val<=0){arr.splice(i,1);i--;l--;continue;}total+=val;arr.t[i]=total;}return arr;}function pivotByMiddle(t,l,r,c){var e=t[0],gap=getRectangleGap.call(this,e),lc,rc,lv,rv,lp,swapped=false,n=r-l+1,pivot=(n>2?((n-1)>>1):(n>>1))+l,cc;cc=copyRect(c);if(cc.w>cc.h){}else{swapRect(cc);swapped=true;}lc=copyRect(cc);rc=copyRect(cc);if(l==r){e=t[l];layoutEntityByMiddle.call(this,e,cc,swapped);return ;}if(l+1==r){e=t[l];lv=getSizeValue(e,this);e=t[r];rv=getSizeValue(e,this);}else{if(l==0){lv=t.t[pivot-1];}else{lv=t.t[pivot-1]-t.t[l-1];}if(pivot==0){rv=t.t[r];}else{rv=t.t[r]-t.t[pivot-1];}}lp=lv/(lv+rv);lc.w=Math.ceil(lc.w*lp);if(lc.w<c.w){if(gap>1){if(lc.w>(gap>>1)){lc.w-=(gap>>1);}}else{if(lc.w>1){lc.w--;}}}if(l+1==r){rc.w-=lc.w+gap;rc.x+=lc.w+gap;e=t[l];layoutEntityByMiddle.call(this,e,lc,swapped);e=t[r];layoutEntityByMiddle.call(this,e,rc,swapped);return ;}var mc=copyRect(cc),as,pap,cv=0,pi=-1,la=1,pv;if(pivot>l){var llc=copyRect(lc);if(swapped){swapRect(llc);}pivotByMiddle.call(this,t,l,pivot-1,llc);}mc.w-=lc.w+gap;mc.x+=lc.w+gap;rc.w=mc.w;rc.x=mc.x;as=mc.w/mc.h;e=t[pivot];pv=getSizeValue(e,this);pap=pv/rv;for(var i=pivot;i<=r;i++){e=t[i];cv+=getSizeValue(e,this);if(i==r-1){continue;}var pwp=cv/rv,php=pv/cv,a=pwp/php*as;if(a>=1){if(la<1&&la*a>1){pi=(i==r)?i-2:i-1;}else{pi=i;}break;}la=a;}pi=pi<0?r:pi;var mv,pw,ph;if(pivot==0){mv=t.t[pi];}else{mv=t.t[pi]-t.t[pivot-1];}pw=Math.ceil(mc.w*(mv/rv));ph=Math.ceil(mc.h*(pv/mv));if(pw<mc.w){if(gap>1){if(pw>(gap>>1)){pw-=(gap>>1);}}else{if(pw>1){pw--;}}}if(ph<mc.h){if(gap>1){if(ph>(gap>>1)){ph-=(gap>>1);}}else{if(ph>1){ph--;}}}var pc={x:mc.x,y:mc.y,w:pw,h:ph};e=t[pivot];layoutEntityByMiddle.call(this,e,pc,swapped);if(pivot<pi){mc.y+=ph+gap;mc.w=pw;mc.h-=ph+gap;if(swapped){swapRect(mc);}pivotByMiddle.call(this,t,pivot+1,pi,mc);}if(pi<r){rc.x+=pw+gap;rc.w-=pw+gap;if(swapped){swapRect(rc);}pivotByMiddle.call(this,t,pi+1,r,rc);}}function layoutEntityByMiddle(e,c,swapped){var size=copyRect(c);if(swapped==true){swapRect(size);}if(rectIsValid(size)){e.size=size;}else{e.size={x:size.x,y:size.y,w:0,h:0};}var ch=e.entityChildren;if(ch!==undefined){var arr=getVisibleEntities.call(this,ch),l=arr.length;if(l>0){pivotByMiddle.call(this,arr,0,l-1,size);}}}function sliceAndDice(r,c){if(r==null||r.length==0){return ;}var t=0,e=r[0],val,gap=getRectangleGap.call(this,e),swapped=false,l=r.length,x,y,w,h;for(var i=0;i<l;i++){e=r[i],val=getSizeValue(e,this);if(!e.deleted&&val>0){t+=val;}}if(c.w<c.h){}else{swapped=true;swapRect(c);}w=c.w;h=c.h;x=c.x;y=c.y;for(var i=0;i<l;i++){e=r[i],val=getSizeValue(e,this);if(!e.deleted&&val>0){var width,height;height=t<=0?0:Math.ceil(val/t*h);width=w;if(val<t){if(i==0||i==l-1){if(gap>1){if(height>(gap>>1)){height-=(gap>>1);}}else{if(height>1){height--;}}}else{if(height>gap){height-=gap;}}}width=Math.max(0,width);height=Math.max(0,height);var nc={x:x,y:y,w:width,h:height},rect=rectIntersection(nc,c);y+=height+gap;if(y>=c.y+h){rect.h=c.y+h-rect.y;}if(swapped){swapRect(rect);}if(rectIsValid(rect)){e.size=rect;}else{e.size={x:rect.x,y:rect.y,w:0,h:0};}if(e.entityChildren!==undefined){sliceAndDice.call(this,e.entityChildren,rect);}}else{e.size={};if(swapped){e.size={x:y,y:x,w:0,h:0};}else{e.size={x:x,y:y,w:0,h:0};}continue;}}if(swapped){swapRect(c);}}function setShow(mf,s,fm,sfm,ec,w,ml){if(ec.entityChildren!==undefined){var parent=ec.parentEntity,del=true,cd=false,teAggValues=[],eChildren=ec.entityChildren,l=eChildren.length;for(var i=0;i<ml;i++){teAggValues[i]={count:0,allChildrenCount:0,positiveCount:0};}for(var i=0;i<l;i++){var child=eChildren[i];setShow(mf,s,fm,sfm,child,w,ml);if(!child.deleted){del=false;}if(child.entityChildren===undefined){if(child.deleted){cd=true;}}else{if(child.hasChildDeleted){cd=true;}}if(!child.deleted){aggregateTotals(ec,child,teAggValues,w,ml);}}ec.deleted=del;ec.hasChildDeleted=cd;for(var i=0;i<ml;i++){var ev=ec.aggValues[i];if(ev==null){ev={};ec.aggValues[i]=ev;}var temp=teAggValues[i];ev.total=temp.total;ev.avg=temp.count==0?0:temp.avgTotal/temp.count;ev.geomAvg=temp.positiveCount==0?NaN:Math.pow(temp.geomProduct,1/temp.positiveCount);ev.min=temp.min;ev.max=temp.max;ev.count=temp.count;ev.positiveCount=temp.positiveCount;}}else{if(ec.deleted){return ;}var sv=getSizeValue(ec,w);if(!isNaN(sv)){if(isNaN(w.smax)){w.smax=w.smin=sv;}else{if(sv>w.smax){w.smax=sv;}if(sv<w.smin){w.smin=sv;}}}var cv=getColorValue(ec,w);if(!isNaN(cv)){if(isNaN(w.cmax)){w.cmax=w.cmin=cv;}else{if(cv>w.cmax){w.cmax=cv;}if(cv<w.cmin){w.cmin=cv;}}}}}function aggregateTotals(ec,child,teAggValues,w,ml){var ev,agg=child.aggValues;if(child.entityChildren!==undefined){ev=getEntityValue(child,w.sizeMetricIndex);if(ev!==null){var cnt=ev.count;if(cnt>0){for(var i=0;i<ml;i++){ev=teAggValues[i];updateEntityContainerAggValue(ev,agg[i]);}}}}else{if(getSizeValue(child,w)>0&&!child.deleted){for(var i=0;i<ml;i++){ev=teAggValues[i];updateEntityAggValue(ev,getAggValue(child,i,w));}}}}function getEntityValue(e,index){var agg=e.aggValues;if(index>=agg.length){return NaN;}return agg[index];}function getColorValue(e,w){var idx=w.colorMetricIndex;return getAggValue(e,idx,w);}function getSizeValue(e,w){var idx=w.sizeMetricIndex,val=getAggValue(e,idx,w);if(val<0){w.hasNegativeSizeValue=true;return Math.abs(val);}return val;}function getSizeRawValue(e,w){var idx=w.sizeMetricIndex;return getAggValue(e,idx,w);}function getAggValue(e,i,w){var agg=e.aggValues;if(i>=agg.length){return NaN;}var ev=agg[i],t=w.aggFunctions[i];if(e.entityChildren!==undefined){switch(t){case AggregationType.Sum:return ev.total;case AggregationType.Avg:return ev.avg;case AggregationType.Cnt:return ev.count;case AggregationType.Max:return ev.max;case AggregationType.Min:return ev.min;case AggregationType.GeoAvg:return(ev.positiveCount>0)?ev.geomAvg:0;default:return ev.total;}}else{if(ev.allChildrenCount==1){return ev.value;}switch(t){case AggregationType.Sum:return ev.total;case AggregationType.Avg:return ev.count==0?0:ev.avgTotal/ev.count;case AggregationType.Cnt:return ev.count;case AggregationType.Max:return ev.max;case AggregationType.Min:return ev.min;case AggregationType.GeoAvg:return ev.positiveCount>0?NaN:Math.pow(ev.geomProduct,1/ev.positiveCount);default:return ev.total;}}}function getLegendMaxMin(){if(!isNaN(this.mlmax)||!isNaN(this.mlmin)){if(!isNaN(this.mlmax)){this.cmax=this.mlmax;if(isNaN(this.mlmin)&&(this.mlmax<this.cmin)){this.cmin=this.mlmax;}}if(!isNaN(this.mlmin)){this.cmin=this.mlmin;if(isNaN(this.mlmax)&&(this.mlmin>this.cmax)){this.cmax=this.mlmin;}}}if(!isNaN(this.mlmax)&&this.cmax>this.mlmax){this.cmax=this.mlmax;}if(!isNaN(this.mlmin)&&this.cmin<this.mlmin){this.cmin=this.mlmin;}this.colorTheme.min=this.cmin;this.colorTheme.max=this.cmax;this.colorTheme.checkMinMax();}function getMetricID(idx){var str="",m=this.model,col=m.ghs.chs.items,cnt=col.length,ml=col[0].items.length,coln=m.gts.col;if(idx<0||idx>=ml){return"";}for(var i=0;i<cnt;i++){var index=col[i].items[idx].idx;var temp=coln[i].es[index];var id=(temp.oid!==undefined)?temp.oid:temp.id;str+=id+" ";}return str.slice(0,str.length-1);}function getNumberForTick(i){var v;if(this.props.legendAsc){v=this.cmin+(this.cmax-this.cmin)*i/this.legendTickCount;}else{v=this.cmax+(this.cmin-this.cmax)*i/this.legendTickCount;}if(this.props.legendRounded){v=Math.floor(v);}return v;}function getTooltip(e,w){var level=e.level,index=(e.index===undefined)?e.indices[0]:e.index,st=0,str="",ret="",ar=w.attSpan,rhs=w.model.ghs.rhs.items,rowHeaderData=rhs[index].items,attr=w.model.gts.row,mv=w.model.gvs.items,ml=mv[0]?mv[0].items.length:0,att,fs;for(var i=0;i<level;i++){att=attr[i];ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-gray-bold">'+att.n+'</div><div class="heatmap-tooltip-gray-bold"><p>:&nbsp;</p></div>';str="";for(var j=st;j<st+ar[i];j++){var idx=rowHeaderData[j].idx;if(idx==-1){continue;}str+=att.es[idx].n+" ";}str=str.substring(0,str.length-1);ret+='<div class = "heatmap-tooltip-gray">'+str+"</div></div>";st+=ar[i];}att=attr[level];ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-black-bold">'+att.n+'</div><div class="heatmap-tooltip-black-bold"><p>:&nbsp;</p></div>';str="";for(var i=st;i<st+ar[level];i++){var idx=rowHeaderData[i].idx;if(idx==-1){continue;}str+=att.es[idx].n+" ";}str=str.substring(0,str.length-1);ret+='<div class = "heatmap-tooltip-black">'+str+"</div></div>";var si=w.sizeMetricIndex,ci=w.colorMetricIndex,n,v;if(si!=ml){n=w.getMetricName(si);if(e.entityChildren!==undefined||w.aggregated){var tmp=w.aggFunctions[si];n=tooltipMacro(n,tmp);v=getSizeRawValue(e,w);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=w.getFormatString(si);v=w.nf.formatByMask(fs,v);}}}else{v=mv[index].items[si].v;}ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-black-bold">'+n+'</div><div class="heatmap-tooltip-black-bold"><p>:&nbsp;</p></div>';ret+='<div class = "heatmap-tooltip-black">'+v+"</div></div>";}if(e.entityChildren===undefined&&ci!=ml&&si!=ci){n=w.getMetricName(ci);if(e.entityChildren!==undefined||w.aggregated){var tmp=w.aggFunctions[ci];n=tooltipMacro(n,tmp);v=getColorValue(e,w);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=w.getFormatString(ci);v=w.nf.formatByMask(fs,v);}}}else{v=mv[index].items[ci].v;}ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-black-bold">'+n+'</div><div class="heatmap-tooltip-black-bold"><p>:&nbsp;</p></div>';ret+='<div class = "heatmap-tooltip-black">'+v+"</div></div>";}for(var i=0;i<ml;i++){if(i==si){continue;}if(i==ci&&e.entityChildren===undefined&&si!=ci){continue;}n=w.getMetricName(i);if(e.entityChildren!==undefined||w.aggregated){var tmp=w.aggFunctions[i];n=tooltipMacro(n,tmp);v=getAggValue(e,i,w);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=w.getFormatString(i);v=w.nf.formatByMask(fs,v);}}}else{v=mv[index].items[i].v;}ret+='<div class="heatmap-inline"><div class = "heatmap-tooltip-gray-bold">'+n+'</div><div class="heatmap-tooltip-gray-bold"><p>:&nbsp;</p></div>';ret+='<div class = "heatmap-tooltip-gray">'+v+"</div></div>";}return ret;}function tooltipMacro(n,t){var macro;switch(t){case AggregationType.Sum:macro="Sum of {0}";break;case AggregationType.Avg:macro="Average of {0}";break;case AggregationType.Cnt:macro="Count of {0}";break;case AggregationType.Max:macro="Maximum of {0}";break;case AggregationType.Min:macro="Minimum of {0}";break;case AggregationType.GeoAvg:macro="Geometry Average of {0}";break;default:macro="Sum of {0}";}return macro.replace("{0}",n);}function bindTouchEvents(d,owner){if(d.eventOwner==owner){return ;}var $D=mstrmojo.dom,eventList=[$D.TOUCHSTART,$D.TOUCHMOVE,$D.TOUCHEND,$D.TOUCHCANCEL];for(var i=0;i<eventList.length;i++){if(eventList[i]==""){continue;}if(document.createTouch){d["on"+eventList[i]]=function(e){var evt=document.createEvent("TouchEvent"),t=e.touches[0];if(!t){t={};}evt.initTouchEvent(e.touches,e.targetTouches,e.changedTouches,e.type,e.view,t.screenX,t.screenY,t.clientX,t.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey);owner.dispatchEvent(evt);};}else{d["on"+eventList[i]]=function(e){var evt=document.createEvent("MouseEvent");evt.initMouseEvent(e.type,e.bubbles,e.cancelable,e.view,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget);owner.dispatchEvent(evt);};}}d.eventOwner=owner;}mstrmojo.VisHeatMap=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisHeatMap",scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:true,vScroll:true,hScroll:true,offset:{y:{start:0,end:0},x:{start:0,end:0}},origin:{x:0,y:0}},selectedStyle:"background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0, #058CF5), color-stop(1, #015DE6));color:#FFFFFF;",selectedClass:"",insertedStyles:[],LayoutProperties:{},highlightBoxWidth:3,waitIconString:mstrmojo.desc("8445","Loading"),markupString:'<div id="{@id}" class="mstrmojo-{@cssClass}" style="background-color:#333333;width:{@width};height:{@height}; left:{@left}; top:{@top}; z-index: {@zIndex}; position:absolute;" mstrAttach:mousedown,mouseup,mousemove,click><div class="heatmap-canvas-outer-container" style="padding: {@LayoutProperties.Padding}px; height:{@heatMapSize.h}px; width:{@heatMapSize.w}px"><div id ="{@id}-heatmap-canvas-container" class="heatmap-canvas-container" style="left: {@LayoutProperties.Padding}px; top: {@LayoutProperties.Padding}px; height:{@heatMapSize.h}px; width:{@heatMapSize.w}px"><div><div></div><div class="heatmap-selection-highlight-box heatmap-round-corner" style="border: {@highlightBoxWidth}px solid white;"></div></div></div></div><div class="heatmap-legend" style="left:{@legendSize.x}px; top:{@legendSize.y}px; height:{@legendSize.h}px; width:{@legendSize.w}px"><div  class="heatmap-size-legend"><div class="heatmap-size-legend-title">Rectangle Size:</div><div id="{@id}-color-legend-ticker" class="heatmap-size-legend-label" ></div></div><div  class="heatmap-color-legend"><div class="heatmap-color-legend-title">Rectangle Color:</div><table cellpadding="4" class="heatmap-color-legend-label"><tbody><tr><td class="heatmap-color-legend-label-td"></td></tr></tbody></table><div style="position:relative;"><canvas id="{@id}-color-legend-band" class="heatmap-color-legend-band"></canvas><div id="{@id}-legend-tooltip" class="heatmap-color-legend-tooltip"></div></div></div><div id="{@id}-editor-div" class="heatmap-editor-button" style="width: {@LayoutProperties.EditButtonWidth}px; height:{@LayoutProperties.EditButtonHeight}px; right:{@LayoutProperties.EditButtonRight}px"></div></div><span id="textSpan" class="heatmap-measure-text"></span><div class="mojo-overlay-wait" style="display: -webkit-box; -webkit-box-align:center; -webkit-box-pack:center; position: absolute; left: -100000px; top: -100000px"><div class="overlay"></div><div style="width:{@LayoutProperties.WaitIconWidth}px; height:{@LayoutProperties.WaitIconHeight}px; background-color: black; opacity: 0.8; display: -webkit-box"><div style="display: -webkit-box; -webkit-box-align: center; -webkit-box-pack: center; -webkit-box-flex:1;  margin: {@LayoutProperties.WaitIconMargin}px; border: 1px solid white; color: white; font-family: Helvetica; font-weight: bold; font-size:{@LayoutProperties.WaitIconFontSize}pt">{@waitIconString}</div></div></div><div></div></div>',markupSlots:{canvas:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0].childNodes[0];},canvasContainer:function(){return this.domNode.childNodes[0].childNodes[0];},canvasOuterContainer:function(){return this.domNode.childNodes[0];},scrollNode:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0];},selectionHighlightBox:function(){return this.domNode.childNodes[0].childNodes[0].childNodes[0].childNodes[1];},legend:function(){return this.domNode.childNodes[1];},sizeLegend:function(){return this.domNode.childNodes[1].childNodes[0];},sizeLegendTitle:function(){return this.domNode.childNodes[1].childNodes[0].firstChild;},sizeLegendLabel:function(){return this.domNode.childNodes[1].childNodes[0].lastChild;},colorLegend:function(){return this.domNode.childNodes[1].childNodes[1];},colorLegendTitle:function(){return this.domNode.childNodes[1].childNodes[1].firstChild;},colorLegendLabel:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[1];},colorLegendBand:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2].firstChild;},legendTooltip:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2].childNodes[1];},editorButton:function(){return this.domNode.childNodes[1].lastChild;},textSpan:function(){return this.domNode.childNodes[2];},waitIcon:function(){return this.domNode.childNodes[3];},infoBoxPuppet:function(){return this.domNode.childNodes[4];}},addCSSToHead:function(){var cssString={text:".heatmap-popup-panel-title {  font-size: "+adjustPixel.call(this,22,true)+"pt !important;  height: "+adjustPixel.call(this,65,true)+"px !important;}.heatmap-gray-label {        padding-bottom: "+adjustPixel.call(this,7,true)+"px !important;        font-size: "+adjustPixel.call(this,14,true)+"pt !important;  height: "+adjustPixel.call(this,32,true)+"px !important;  padding-left: "+adjustPixel.call(this,22,true)+"px !important;  line-height: "+adjustPixel.call(this,40,true)+"px !important;}.heatmap-tree-text {  font-size: "+adjustPixel.call(this,18,true)+"pt !important;  line-height: "+adjustPixel.call(this,65,true)+"px !important;}.heatmap-tree-div {  font-size: "+adjustPixel.call(this,18,true)+"pt !important;  line-height: "+adjustPixel.call(this,40,true)+"px !important;}.heatmap-tree-button {  font-size: "+adjustPixel.call(this,16,true)+"pt !important;}.heatmap-apply-button > .mstrmojo-Button-text {  font-size: "+adjustPixel.call(this,14,true)+"pt !important;  line-height: "+adjustPixel.call(this,24,true)+"px !important;   height: "+adjustPixel.call(this,24,true)+"px !important; }.heatmap-tree.root > .heatmap-tree-div > div {  font-size: "+adjustPixel.call(this,14,true)+"pt !important;  line-height: "+adjustPixel.call(this,40,true)+"px !important;  height: "+adjustPixel.call(this,40,true)+"px !important;}.heatmap-one-level-1 {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-multi-level-1 {  font-size: "+adjustPixel.call(this,24)+"pt !important;}.heatmap-two-level-2 {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-multi-level-2 {  font-size: "+adjustPixel.call(this,20)+"pt !important;}.heatmap-multi-level-3 {  font-size: "+adjustPixel.call(this,10)+"pt !important;}.heatmap-size-legend {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-color-legend {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-color-legend-label {  font-size: "+adjustPixel.call(this,10)+"pt !important;}.heatmap-color-legend-tooltip {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-legend {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-editor-button {  font-size: "+adjustPixel.call(this,12)+"pt !important;}.heatmap-tooltip-gray-bold {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-tooltip-gray {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-tooltip-black-bold {  font-size: "+adjustPixel.call(this,14)+"pt !important;}.heatmap-tooltip-black {  font-size: "+adjustPixel.call(this,14)+"pt !important;}"};this.addAdjustedClassToDocument(cssString.text);},addAdjustedClassToDocument:function(classString){var beginIndex=classString.indexOf(".");if(beginIndex==-1){return ;}var p=document.getElementsByTagName("head")[0];this.CSSParent=p;for(var i=beginIndex;i<classString.length;){var endIndex=i+classString.substring(i).indexOf("}");if(endIndex==-1){break;}var style=document.createElement("style");style.type="text/css";style.innerHTML=classString.substring(i,endIndex+1);this.insertedStyles.push(style);p.appendChild(style);i=endIndex+1;}},isMultipleDPIEnabled:function(){var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel),fitToPage=false,microApp=false;if(docModel){fitToPage=docModel.zt&&(docModel.zt==2);var layouts=(docModel&&docModel.defn&&docModel.defn.layouts),layout;var i;for(i in layouts){if(layouts[i].loaded){layout=layouts[i];break;}}if(layout&&layout.hasOwnProperty("fch")){microApp=layout.fch;}}if(fitToPage&&microApp){return true;}else{return false;}},init:function(e){if(this._super){this._super(e);}var canvas=document.createElement("canvas");browserSupportsHtml5=canvas.getContext;if(!browserSupportsHtml5){this.error=mstrmojo.desc(8126,"Your browser does not support HTML5");return ;}},preBuildRendering:function(){delete this.error;if(this._super){this._super();}this.dpiAdjusted=true;this.DPI=mstrMobileApp.getDeviceDPI();if(mstrMobileApp.getDeviceDPIX){this.DPIX=mstrMobileApp.getDeviceDPIX();}else{this.DPIX=149;}if(this.isMultipleDPIEnabled()){this.enableMultiDPI=true;}else{this.enableMultiDPI=false;}this.adjustLocalDPI();this.addCSSToHead();this.zIndex=null;this.loadDefinedFormat();loadProps.call(this);loadSession.call(this);if(!this.model){this.error=mstrmojo.desc(8426,"No model provided");return ;}var err=this.model.err||this.model.eg;if(err){this.error=err;return ;}convertDataToModels.call(this);var err=this.model.err||this.model.eg;if(err){this.error=err;return ;}setLayout.call(this);this.calculateValuesInTree();layoutEntities.call(this);getLegendMaxMin.call(this);this.nf=mstrmojo.num;if(this.editorDialog){this.editorDialog.destroy();this.editorDialog=null;}},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res;try{res=eval(s);}catch(e){res=undefined;}finally{}return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},createInfoBox:function(){var html='<div id="'+this.id+'-infobox" class="heatmap-infobox" style="position:absolute; left:0px; top:0px;"><div class="heatmap-highlight-box heatmap-round-corner" style="border: '+this.highlightBoxWidth+'px solid white;"></div><div class="heatmap-shadow-box heatmap-round-corner"></div><div class="heatmap-triangle"></div><div class="heatmap-tooltip-box heatmap-round-corner" style="max-width: '+document.body.offsetWidth+"px; max-height: "+document.body.offsetHeight+'px; "></div><div class="heatmap-delete-button"></div><div class="heatmap-tooltip-shelter heatmap-round-corner"></div></div>';var div=document.createElement("div");div.innerHTML=html;this.infoBox=div.childNodes[0];this.highlightBox=this.infoBox.childNodes[0];this.shadowBox=this.infoBox.childNodes[1];this.triBox=this.infoBox.childNodes[2];this.tooltipBox=this.infoBox.childNodes[3];this.deleteButton=this.infoBox.childNodes[4];this.shelter=this.infoBox.childNodes[5];div.style.cssText="position: absolute; left: 0px; top: 0px";bindTouchEvents(div,this.infoBoxPuppet);document.body.appendChild(div);},postBuildRendering:function postBR(){if(this.error){this.renderErrorMessage(this.error);return ;}var heatMap=this;var tmpFunction=this.controller.onorientationChange;this.controller.onorientationChange=function(){tmpFunction.call(heatMap.controller);heatMap.onorientationChange();};this.enableGlobalDismiss();this.setupScroller();if(this._super){this._super();}var backup=this._tsCallback;this._tsCallback=function(e){if(heatMap.isInfoWindowDisplayed()){heatMap.infoWindowMode=true;}else{heatMap.infoWindowMode=false;}backup.call(heatMap,e);};var $DAE=mstrmojo.dom.attachEvent,$DDE=mstrmojo.dom.detachEvent,TOUCHSTART=mstrmojo.dom.TOUCHSTART;$DDE(this._tn,TOUCHSTART,backup);$DAE(this._tn,TOUCHSTART,this._tsCallback);if(this.isUsingSavedColorTheme){this.useSavedColorTheme();}if(this.isUsingDefaultColorTheme){this.useDefaultColorTheme();}this.initCanvas();this.renderLegend();if(!this.infoBox){this.createInfoBox();}if(this.props.delButtonEnabled){this.deleteButton.style.display="block";}if(this.previousSelected&&this.previousSelected.parentEntity){this.highlightEntity(this.selectionHighlightBox,this.previousSelected);}},unrender:function(){storeSession.call(this);this.disableGlobalDismiss();var $DAE=mstrmojo.dom.attachEvent,$DDE=mstrmojo.dom.detachEvent,TOUCHSTART=mstrmojo.dom.TOUCHSTART;$DDE(this._tn,TOUCHSTART,this._tsCallback);if(this.infoBox&&this.infoBox.parentNode&&this.infoBox.parentNode.parentNode){this.infoBox.parentNode.parentNode.removeChild(this.infoBox.parentNode);}delete this.infoBox;if(this._super){this._super();}},getFirstInfowindow:function getFirstInfowindow(){var me=this,model=me.model,xtabModel=me.xtabModel,docModel=(xtabModel&&xtabModel.docModel),row=model&&model.gts&&model.gts.row,tks;if(row&&row.length>0){tks=row[0]&&row[0].sc&&row[0].sc.tks;}if(docModel&&tks){ifws=docModel.getTargetInfoWin(tks);if(ifws&&ifws.length){var ifwunit=docModel.infoWinByKey[ifws[0]];var id=ifwunit&&(ifwunit.id+"_ifw");return mstrmojo.all[id];}}},isInfoWindowDisplayed:function(){var ifw=this.getFirstInfowindow();if(ifw){ifw=ifw.domNode;}if(!ifw){return false;}if(ifw.style.display=="block"){return true;}else{return false;}},globalListener:function(){var that=window.heatMap;if(!that){return ;}that.hideInfoBox();if(!that.selectAll){that.doSelection(that.previousSelected);}},addGlobalListener:function(){window.heatMap=this;var p=document.getElementsByClassName("mstrmojo-DocLayoutViewer-layout")[0];if(p){p.addEventListener(mstrmojo.dom.TOUCHSTART,window.heatMap.globalListener,false);}},removeGlobalListener:function(){var p=document.getElementsByClassName("mstrmojo-DocumentView")[0];if(p){p.removeEventListener("click",this.globalListener,false);}delete window.heatMap;},addCurtain:function(){var p=document.getElementsByClassName("mstrmojo-DocLayoutViewer-layout")[0];var div=document.createElement("div"),that=this;div.style.width=p.offsetWidth+"px";div.style.height=p.offsetHeight+"px";div.style.position="absolute";div.style.zIndex=-1;div.id=this.id+"curtain";div.onclick=this.globalListener;p.appendChild(div);},removeCurtain:function(){var div=document.getElementById(this.id+"curtain");if(div){div.parentNode.removeChild(div);}},renderErrorMessage:function renderErrorMessage(msg){var d=this.domNode,p=d.parentNode,div=document.createElement("div"),textDiv=document.createElement("div");if(d){div.style.width=d.offsetWidth-2+"px";div.style.height=d.offsetHeight-2+"px";div.style.left=d.offsetLeft+"px";div.style.top=d.offsetTop+"px";div.style.zIndex=this.zIndex;}else{div.style.width=parseInt(this.width)-2+"px";div.style.height=parseInt(this.height)-2+"px";div.style.left=this.left;div.style.top=this.top;div.style.zIndex=this.zIndex;}div.style.cssText+="background-color:#F5F5F2; position:absolute; display:-webkit-box; -webkit-box-pack:center; -webkit-box-align:center; -webkit-box-orient:vertical; border-style:solid; border-color:#A7A7A7; border-width:1px; ";textDiv.className="mstrmojo-message";textDiv.innerText=msg;div.appendChild(textDiv);if(d){p.replaceChild(div,d);}else{p.appendChild(div);}},convertDPI:function(props){if(typeof props!="object"){if(typeof props=="number"&&props%1==0){return adjustPixel.call(this,props);}else{return props;}}else{var ret={};for(var key in props){ret[key]=this.convertDPI(props[key]);}return ret;}},adjustLocalDPI:function(){this.LayoutProperties=this.convertDPI(LayoutProperties);this.LayoutProperties.LegendTickCount=5;this.LayoutProperties.LegendWidthPercent=0.9;this.LayoutProperties.LegendBandAspect=10;this.LayoutProperties.EditorDialogWidth=adjustPixel.call(this,565,true);this.LayoutProperties.EditorDialogHeight=adjustPixel.call(this,574,true);var h=document.body.offsetHeight,eh=this.LayoutProperties.EditorDialogHeight,sfh=h/eh,sf=1;if(sfh<1){sf=sfh;sf*=0.9;this.LayoutProperties.EditorDialogHeight=parseInt(eh*sf);}this.LayoutProperties.DeletedListHeight=adjustPixel.call(this,500*sf,true);this.LayoutProperties.EditButtonWidth=adjustPixel.call(this,60);this.LayoutProperties.EditButtonHeight=adjustPixel.call(this,40);this.LayoutProperties.EditButtonRight=adjustPixel.call(this,10);},onorientationChange:function(){if(this.editorDialog){var domNode=this.editorDialog.domNode;if(domNode&&domNode.firstChild){var d=domNode.firstChild,t=d.firstChild.firstChild;d.style.marginTop=parseInt((document.body.offsetHeight-this.LayoutProperties.DeletedListHeight-t.offsetHeight)/2)+"px";}}},loadDefinedFormat:function(){if(this.defn&&this.defn.fmts){var fmts=this.defn.fmts,pWidgetHeight=fmts&&fmts.p_fmts&&fmts.p_fmts.height;if(fmts.height){this.height=fmts.height;}if(!this.isFullScreenWidget){if(fmts.width){this.width=fmts.width;}}if(fmts["z-index"]){this.zIndex=fmts["z-index"];}}},checkErrors:function(){var err=this.error;if(err){this.renderErrorMessage(err);return true;}if(!this.model){this.renderErrorMessage(mstrmojo.desc(8426,"No model provided"));return true;}var err=this.model.err||this.model.eg;if(err){this.renderErrorMessage(err);return true;}return false;},setupScroller:function(){var sclConfig=this.scrollerConfig;sclConfig.scrollEl=this.scrollNode;sclConfig.offset.x.start=0;sclConfig.offset.x.end=this.heatMapSize.w*(this.scaleFactor-1);sclConfig.offset.y.start=0;sclConfig.offset.y.end=this.heatMapSize.h*(this.scaleFactor-1);if(sclConfig.origin.x>sclConfig.offset.x.end){sclConfig.origin.x=sclConfig.offset.x.end;}if(sclConfig.origin.y>sclConfig.offset.y.end){sclConfig.origin.y=sclConfig.offset.y.end;}},refreshLabelInTree:function(){var getLabel=function(e,idx){if(e==this.root){return ;}var text=this.getLabelForEntity(e);e.text=text;e.idx=idx;};this.dfs(this.root,getLabel,"");},refreshColorInTree:function(){var paintColor=function(e){if(e.EntityChildren||e==this.root){return ;}var color=getCSSColor(this.colorTheme.getColor(getColorValue(e,this)));e.color=color;};this.dfs(this.root,paintColor,"");},dfs:function(root,f,indexString){if(root.deleted){return ;}if(indexString===undefined){f.call(this,root);}else{f.call(this,root,indexString);}if(root.entityChildren===undefined){return ;}var arr=root.entityChildren,l=arr.length;for(var i=0;i<l;i++){var e=arr[i];if(indexString===undefined){this.dfs(e,f);}else{var param=indexString;if(!param){param=i.toString();}else{param=param+":"+i;}this.dfs(e,f,param);}}},traverseBFS:function traverse(){var heatMap=this,canvas=this.textCanvas,renderText=function(e,indexString){},terminate=function(level){var lv=level-heatMap.levelToShowText;if(lv>=3){return false;}return true;};},initCanvas:function(){this.refreshColorInTree();this.refreshLabelInTree();var props={colorTheme:this.colorTheme,placeholder:this.canvas,root:this.root,width:this.heatMapSize.w,height:this.heatMapSize.h,scale:this.scaleFactor,attributes:this.levelAttributes,showMetric:this.props.showMetricValues,labelSetting:this.props.labelSize};this.canvasObject=new mstrmojo.VisHeatMapCanvas(props);this.canvasObject.render();this.canvasObject.updateOffsets(this._scroller.origin.x,this._scroller.origin.y);this.canvas=this.canvasObject.domNode;},renderRectangles:function(){this.refreshColorInTree();this.refreshLabelInTree();this.canvasObject.scale=this.scaleFactor;this.canvasObject.offsetX=this._scroller.origin.x;this.canvasObject.offsetY=this._scroller.origin.y;this.canvasObject.draw();},renderLegend:function renderLegend(){if(this.props.showLegend==false){this.editorButton.style.height="";this.editorButton.style.width="";this.editorButton.style.right="";this.editorButton.style.bottom="";this.editorButton.className="heatmap-editor-legend-unshown";this.editorButton.innerHTML="";this.editorButton.style.top="";this.sizeLegend.style.display="none";this.colorLegend.style.display="none";this.legend.style.left="";this.legend.style.top="";this.legend.style.right="0px";this.legend.style.bottom="0px";this.legend.style.zIndex="100";return ;}var el=mstrmojo.desc(11158,"EDIT"),rsl=mstrmojo.desc(10079,"Rectangle Size"),rcl=mstrmojo.desc(10080,"Rectangle Color");this.editorButton.className="heatmap-editor-button";this.editorButton.innerHTML=el;var w=parseInt(this.width),h=parseInt(this.height),canvasHeight=this.heatMapSize.h,computedStyle=window.getComputedStyle(this.editorButton,null),editorButtonHeight=parseInt(computedStyle.height),editorButtonWidth=parseInt(computedStyle.width),legendHeight=this.legendSize.h,legendWidth=this.legendSize.w-editorButtonWidth-parseInt(computedStyle.right),sfs=this.getFormatString(this.sizeMetricIndex);this.legend.style.top=this.heatMapSize.h+2*this.LayoutProperties.Padding+"px";this.editorButton.style.top=((legendHeight-editorButtonHeight)>>1)+"px";this.editorButton.style.bottom="";if(this.props.showEditor){legendWidth-=this.LayoutProperties.LegendMenuEditorWidth;}var sizeT={w:0,h:0},sizeL={w:0,h:0},sizeSize={w:0,h:0},tickCount,padding,bandWidth,bandHeight;if(this.props.sizeMetricEnabled){var sizeTitle="<span style='font-weight: bold'>"+rsl+":</span>";var vld=this.checkMetricValid(this.sizeMetricIndex),mn=this.getMetricName(this.sizeMetricIndex);if(this.hasNegativeSizeValue){mn="Absolute value of "+mn;}if(isNaN(this.smin)){this.smin=0;}if(isNaN(this.smax)){this.smax=0;}var sizeLabel="<div>"+(vld?this.nf.formatByMask(sfs,this.smin):"0")+" < </div><div class='heatmap-flex'>"+mn+"</div><div> < "+(vld?this.nf.formatByMask(sfs,this.smax):"0")+"</div>";this.sizeLegendTitle.innerHTML=sizeTitle;this.sizeLegendLabel.innerHTML=sizeLabel;sizeSize={w:Math.max(this.sizeLegendTitle.offsetWidth,this.sizeLegendLabel.offsetWidth),h:this.sizeLegendTitle.offsetHeight};}else{this.sizeLegend.style.display="none";}if(this.props.colorMetricEnabled){var colorTitle;if(this.props.sizeMetricEnabled){colorTitle=rcl+": <span style='font-weight:normal;'>"+this.getMetricName(this.colorMetricIndex)+"</span>";}else{colorTitle="<span style='font-weight:bold'>"+this.getMetricName(this.colorMetricIndex)+"</span>";}tickCount=this.LayoutProperties.LegendTickCount;if(isNaN(this.cmin)||this.cmin>=this.cmax){tickCount=1;}this.legendTickCount=tickCount;bandWidth=Math.min(this.LayoutProperties.LegendMaxBandWidth,this.LayoutProperties.LegendWidthPercent*(legendWidth-sizeSize.w));padding=Math.floor((legendWidth-sizeSize.w-bandWidth)/3);var pd=this.renderTickLabels(bandWidth,tableHeight,tickCount);if(padding>=this.LayoutProperties.LegendMinPadding+pd.l+pd.r){bandWidth+=pd.l+pd.r;padding-=((pd.l+pd.r)>>1);}else{if(padding<this.LayoutProperties.LegendMinPadding){padding=this.LayoutProperties.LegendMinPadding;var temp=((legendWidth-3*padding)>>1);if(temp>sizeSize.w){bandWidth=legendWidth-3*padding-sizeSize.w;}else{sizeSize.w=temp;bandWidth=sizeSize.w;}}}bandHeight=Math.min(Math.floor(bandWidth/this.LayoutProperties.LegendBandAspect),Math.floor(legendHeight/3))-this.LayoutProperties.LegendBottomPadding;this.colorLegend.style.display="";this.colorLegendTitle.innerHTML=colorTitle;}else{padding=((legendWidth-sizeSize.w)>>1);this.colorLegend.style.display="none";}if(this.props.sizeMetricEnabled){this.sizeLegend.style.left=padding+"px";this.sizeLegend.style.width=sizeSize.w+this.LayoutProperties.LegendGutter+2*this.LayoutProperties.Padding+"px";this.sizeLegend.style.height=legendHeight+"px";}else{this.sizeLegend.style.left="0px";this.sizeLegend.style.width="0px";this.sizeLegend.top="0px";this.sizeLegend.style.height="0px";this.sizeLegendLabel.style.marginTop="0px";padding=((legendWidth-bandWidth)>>1);}if(this.props.colorMetricEnabled){if(this.props.sizeMetricEnabled){this.colorLegend.style.left=sizeSize.w+2*padding+"px";}else{this.colorLegend.style.left=sizeSize.w+padding+"px";}this.colorLegend.style.width=bandWidth+"px";this.colorLegend.style.height=legendHeight+"px";sizeT={w:this.colorLegendTitle.offsetWidth,h:this.colorLegendTitle.offsetHeight};var tableHeight=legendHeight-bandHeight-sizeT.h-2*this.LayoutProperties.LegendBottomPadding;this.colorLegendLabel.style.width=bandWidth+"px";this.colorLegendLabel.style.height=tableHeight+"px";this.colorLegendBand.width=bandWidth;this.colorLegendBand.height=bandHeight+10;var pd=this.renderTickLabels(bandWidth,tableHeight,tickCount);this.colorTheme.tooltipInfo=null;this.legendBand={x:pd.l,y:0,w:bandWidth-pd.r-pd.l,h:bandHeight};this.colorLegendBand.parentNode.style.width=bandWidth+"px";this.colorLegendBand.parentNode.style.height=bandHeight+"px";this.renderGradientBand(this.legendBand);}},renderTickLabels:function renderLabel(w,h,t){var count=t+1;var p=this.colorLegendLabel.firstChild.firstChild,nodes=p.childNodes,curCount=nodes.length,lastNode=p.lastChild,diff=curCount-count,cfs=this.getFormatString(this.colorMetricIndex);lastNode.style.display="";lastNode.style.width="";lastNode.style.textAlign="center";if(diff<0){for(var i=0;i<Math.abs(diff);i++){var node=lastNode.cloneNode(true);p.insertBefore(node,lastNode.nextSibling);lastNode=node;}}else{for(var i=0;i<diff;i++){if(t==0&&i==diff-1){lastNode.style.display="none";break;}p.removeChild(p.lastChild);}}p.firstChild.style.textAlign="left";p.lastChild.style.textAlign="right";var valid=true;if(isNaN(this.cmax)||isNaN(this.cmin)){valid=false;}for(var i=0;i<count;i++){node=nodes[i];var v="Null";if(valid){v=getNumberForTick.call(this,i);}node.innerHTML='<div style="display: inline-block; overflow: hidden; text-overflow: ellipsis; max-width: 100%; white-space: nowrap;">'+this.nf.formatByMask(cfs,v)+"</div>";if(this.props.legendRounded){}}var firstV=p.firstChild.innerHTML,lastV=p.lastChild.innerHTML,fSize={w:p.firstChild.firstChild.offsetWidth,h:p.firstChild.firstChild.offsetHeight};lSize={w:p.lastChild.firstChild.offsetWidth,h:p.lastChild.firstChild.offsetHeight};left=Math.min(w/count,fSize.w)>>1,right=Math.min(w/count,lSize.w)>>1;return{l:left,r:right};},renderGradientBand:function renderBand(frame){var x=frame.x,y=frame.y,w=frame.w,h=frame.h,ctx=this.colorLegendBand.getContext("2d");ctx.clearRect(x,y,w+2,h);var lingrad=ctx.createLinearGradient(x,y,w+x,y);lingrad.addColorStop(0,"#333333");var gradientInfo=this.colorTheme.getGradientFillInfo(this.cmin,this.cmax);var c=gradientInfo.c,r=gradientInfo.r,l=c.length;for(var i=0;i<l;i++){lingrad.addColorStop(roundNumber(r[i],2),getCSSColor(c[i]));}ctx.fillStyle=lingrad;createPath(x,y,w,h,0,ctx);ctx.fill();},renderHilightedBand:function renderHighlightedBand(i){var frame=this.legendBand,info=this.colorTheme.tooltipInfo[i],x=frame.x,y=frame.y,w=frame.w,h=frame.h,ctx=this.colorLegendBand.getContext("2d");this.renderGradientBand(frame);this.selectedBandIndex=i;ctx.strokeStyle="#FFFFFF";ctx.lineWidth=2;ctx.strokeRect(info.r.x+x+1,y+1,info.r.w-1,h-3);},getTextSize:function gts(str,fontName,fontSize,isBold,isItalic){this.textSpan.style="";this.textSpan.style.fontFamily=fontName;this.textSpan.style.fontSize=isNaN(fontSize)?fontSize:fontSize+"px";this.textSpan.style.fontWeight=isBold?"bold":"normal";this.textSpan.style.fontStyle=isItalic?"italic":"normal";this.textSpan.innerHTML=str;var w=this.textSpan.offsetWidth,h=this.textSpan.offsetHeight;return{w:w,h:h};},reRender:function reRender(){if(this.model.err||this.model.eg){return ;}if(this._super){this._super();}},useDefaultColorTheme:function(callback){var colorTheme=this.colorTheme,needsRefresh=false;if(colorTheme.useDefault==false){needsRefresh=true;colorTheme.isBlend=true;colorTheme.setDefaultDataProvider();}if(this.scaleFactor!=1){needsRefresh=true;this.scaleFactor=1;}function markUndelete(delDict){for(var key in delDict){var childDict=delDict[key];if(typeof childDict==="object"){if(Object.keys(childDict).length===0){delete delDict[key];}else{markUndelete(childDict);}}else{if(childDict===delStatus.dftDel){needsRefresh=true;delDict[key]=delStatus.dftUnDel;}else{if(childDict===delStatus.usrDel){needsRefresh=true;delete delDict[key];}}}}}markUndelete(this.props.deletedList);this.loadDeleteStatus(this.root,this.props.deletedList);if(needsRefresh){colorTheme.tooltipInfo=null;this.refreshWidget();}if(callback){callback();}},loadDeleteStatus:function(node,delDict){if(!node.entityChildren){if(delDict===delStatus.dftDel||delDict===delStatus.usrDel){node.deleted=true;}else{delete node.deleted;}return ;}if((!delDict||Object.keys(delDict).length===0)&&!node.hasChildDeleted){return ;}var children=node.entityChildren;for(var i=0;i<children.length;i++){var child=children[i];var name=this.getEntityDisplayName(child);var thisDict=delDict&&delDict[name];this.loadDeleteStatus(child,thisDict);}},useSavedColorTheme:function(callback){var colorTheme=this.colorTheme,needsRefresh=false;if(colorTheme.useDefault==true){needsRefresh=true;var propValue=this.model.vp;if(propValue){colorTheme.isBlend=((propValue.blc===undefined||propValue.blc=="true")?true:false);}if(propValue.gradientColors&&propValue.bandColors){colorTheme.createDataProviderFromString(propValue.gradientColors,propValue.bandColors);}colorTheme.useDefault=false;}if(this.scaleFactor!=1){needsRefresh=true;this.scaleFactor=1;}function markDelete(delDict){for(var key in delDict){var childDict=delDict[key];if(typeof childDict==="object"){if(Object.keys(childDict).length===0){delete delDict[key];}else{markDelete(childDict);}}else{if(childDict===delStatus.dftUnDel){needsRefresh=true;delDict[key]=delStatus.dftDel;}else{if(childDict===delStatus.usrDel){needsRefresh=true;delete delDict[key];}}}}}markDelete(this.props.deletedList);this.loadDeleteStatus(this.root,this.props.deletedList);if(needsRefresh){colorTheme.tooltipInfo=null;this.refreshWidget();}if(callback){callback();}},getFormatString:function getFormatString(idx){var m=this.model,col=m.gvs.items[0]?m.gvs.items[0].items:[],cnt=col.length;if(idx>=0&&idx<cnt){var obj=col[idx];if(obj.formatstring!==undefined){return obj.formatstring.replace(/\'/g,'"');}return"";}return"";},checkMetricValid:function checkMetric(idx){var str="",m=this.model,col=m.ghs.chs.items,cnt=col.length,ml=col[0]?col[0].items.length:0,coln=m.gts.col;if(idx<0||idx>=ml){return false;}return true;},getMetricName:function getMetricName(idx){var str="",m=this.model,col=m.ghs.chs.items,cnt=col.length,coln=m.gts.col;if(!this.checkMetricValid(idx)){return Fake_Metric_ID;}for(var i=0;i<cnt;i++){var index=col[i].items[idx].idx;var name=coln[i].es[index].n;str+=name+" ";}return str.slice(0,str.length-1);},getEntityDisplayName:function getEntityDisplayName(e){var level=e.level,index=(e.index===undefined)?e.indices[0]:e.index,st=0,str="",ar=this.attSpan,rhs=this.model.ghs.rhs.items,rowHeaderData=rhs[index].items,att=this.model.gts.row[level];for(var i=0;i<level;i++){st+=ar[i];}str="";for(var i=st;i<st+ar[level];i++){var idx=rowHeaderData[i].idx;if(idx==-1){continue;}str+=att.es[idx].n+" ";}str=str.substring(0,str.length-1);return str;},previousTooltip:null,previousSelected:null,highlightEntity:function(box,entity){if(!entity||!box){return ;}var w=this.canvasContainer.offsetWidth,h=this.canvasContainer.offsetHeight,size=entity.size,origin=this._scroller.origin,border=this.highlightBoxWidth,widgetRect=mstrmojo.dom.position(this.canvasContainer,true);var container={x:origin.x,y:origin.y,w:w,h:h};var canvasRect={x:0,y:0,w:Math.ceil(this.heatMapSize.w*this.scaleFactor),h:Math.ceil(this.heatMapSize.h*this.scaleFactor)};var rect={x:size.x-border,y:size.y-border,w:size.w+2*border,h:size.h+2*border};var inters=rectIntersection(rect,canvasRect);if(box==this.highlightBox){inters=rectIntersection(inters,container);this.previousHighlighted=entity;}if(isNaN(inters.x)){return null;}inters.x+=(border-origin.x);inters.y+=(border-origin.y);inters.w-=2*border;inters.h-=2*border;if(box==this.highlightBox){box.style.left=inters.x-border+widgetRect.x+"px";box.style.top=inters.y-border+widgetRect.y+"px";inters.x+=widgetRect.x;inters.y+=widgetRect.y;}else{box.style.left=inters.x-border+"px";box.style.top=inters.y-border+"px";}box.style.width=inters.w+"px";box.style.height=inters.h+"px";box.style.display="block";return inters;},getLowestLevelRectangle:function(touch){target=document.elementFromPoint(touch.pageX,touch.pageY);var hiddenStack=[];while(!this.isLowestLevelRectangle(target)){target.style.display="none";hiddenStack.push(target);target=document.elementFromPoint(touch.pageX,touch.pageY);}while(hiddenStack.length){hiddenStack.pop().style.display="block";}return target;},getEntityByTouch:function(touch,getLowest){var entity=null;var pageX=touch.pageX,pageY=touch.pageY;console.log("#getEntityByTouch#pageX:"+pageX+" pageY:"+pageY);var target=document.elementFromPoint(pageX,pageY),backUps=[];if(!target){console.log("target is null! at elementFromPoint.");return null;}var lastLevel=target;while(!this.isRectangle(target)&&target!=this.domNode){backUps.push(target);target.style.visibility="hidden";target=document.elementFromPoint(pageX,pageY);if(!target||target==lastLevel){break;}lastLevel=target;}if(getLowest){lastLevel=target;while(target!=this.domNode&&target.tagName.toLowerCase()!="img"){backUps.push(target);target.style.visibility="hidden";target=document.elementFromPoint(pageX,pageY);if(!target||target==lastLevel){break;}lastLevel=target;}}var backLen=backUps.length;while(backUps.length>0){var node=backUps.pop();node.style.visibility="visible";}if(!target){console.log("target is null. At backups.");return null;}if(target!=this.domNode){if(target.getAttribute("idx")&&!getLowest){var entity=this.getIdxObjectByTarget(target);}else{var rectPosition=mstrmojo.dom.position(this.canvas,true),offsetX=pageX-rectPosition.x,offsetY=pageY-rectPosition.y;var position={x:offsetX,y:offsetY},entity=this.canvasObject.getEntity(position);}}else{}return entity;},getLabelForEntity:function(e){if(!this.props.showMetricValues||e.entityChildren!==undefined){return this.getEntityDisplayName(e);}var index=(e.index===undefined)?e.indices[0]:e.index,st="",si=this.sizeMetricIndex,ci=this.colorMetricIndex,mv=this.model.gvs.items,ml=mv[0].items.length,n,v,dn=this.getEntityDisplayName(e);st='<span style="font-weight:bold;">';if(dn!==""){st+=dn+"<br>";}if(si!=ml){if(e.entityChildren!==undefined||this.aggregated){var tmp=this.aggFunctions[si];v=getSizeValue(e,this);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=this.getFormatString(si);v=this.nf.formatByMask(fs,v);}}}else{v=mv[index].items[si].v;}if(v!==""){st+=v+"<br>";}}if(e.entityChildren===undefined&&ci!=ml&&si!=ci){if(e.entityChildren!==undefined||this.aggregated){var tmp=this.aggFunctions[ci];v=getColorValue(e,this);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=this.getFormatString(ci);v=this.nf.formatByMask(fs,v);}}}else{v=mv[index].items[ci].v;}if(v!==""){st+=v+"<br>";}}st+='</span><span style="font-weight:normal;">';for(var i=0;i<ml;i++){if(i==si){continue;}if(i==ci&&e.entityChildren===undefined&&si!=ci){continue;}if(e.entityChildren!==undefined||this.aggregated){var tmp=this.aggFunctions[i];n=tooltipMacro(n,tmp);v=getAggValue(e,i,this);if(isNaN(v)){v="-";}else{if(AggregationType.Cnt!=tmp){fs=this.getFormatString(i);v=this.nf.formatByMask(fs,v);}}}else{v=mv[index].items[i].v;}if(v!==""){st+=v;if(i!==ml-1){st+="<br>";}}}st+="</span>";return st;},multiTap:true,touchBegin:function(touch){},touchTap:function(touch){if(touch.count>=2){if(this.scaleFactor>1){this.scaleFactor=1;this._scroller.offset.x.start=0;this._scroller.offset.x.end=0;this._scroller.offset.y.start=0;this._scroller.offset.y.end=0;this._scroller.scrollTo(0,0,0);this.refreshWidget();}return ;}var target=touch.target;if(target==this.infoBoxPuppet){target=document.elementFromPoint(touch.pageX,touch.pageY);}if(this.touchLegendTooltipValid(touch)){this.showLegendTooltip(touch);}else{this.hideLegendTooltip();}switch(target){case this.editorButton:target.style.backgroundColor="rgba(51, 181, 229, 0.6)";var callback=function(){mstrmojo.VisHeatMapAnimation.animate(target,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};var that=this;setTimeout(function(){setTimeout(function(){try{that.popupEditor(target);}catch(e){}finally{callback();}},0);},0);return ;case this.deleteButton:if(this.previousTooltip){var delDict=this.props.deletedList;var delNode=this.previousTooltip;var keyStack=[];var tempNode=delNode;do{keyStack.push(this.getEntityDisplayName(tempNode));tempNode=tempNode.parentEntity;}while(tempNode.parentEntity);var parentDict,key;for(var i=keyStack.length-1;i>=0;i--){parentDict=delDict;key=keyStack.pop();var tempDict=delDict[key];if(!tempDict){delDict[key]={};tempDict=delDict[key];}delDict=tempDict;}this.deleteNode(delNode,delDict,parentDict,key);this.hideInfoBox();this.refreshWidget();var deleteTreeId=this.id+"-deleteTree";var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}}this.previousTooltip=null;break;case this.selectionHighlightBox:this.doSelection(this.previousSelected);break;case this.highlightBox:this.hideInfoBox();var entity=this.previousHighlighted;if(this.hasSelector){if(!this.previousHighlighted.entityChildren){this.doSelection(entity);}}else{if(this.hasLinkDrill){this.doLinkDrill(entity);}}break;default:if(this.isRectangle(target)){if(this.hasSelector){this.hideInfoBox();var entity=this.getEntityByTouch(touch,true);this.doSelection(entity);}else{if(this.hasLinkDrill){var entity=this.getEntityByTouch(touch);this.doLinkDrill(entity);}else{var entity=this.getEntityByTouch(touch);this.showInfoBox(entity);}}break;}else{if(target.parentNode==this.infoBox){this.hideInfoBox();}else{this.hideInfoBox();if(!this.selectAll){this.doSelection(this.previousSelected);}}}}},isRectangle:function(target){if(this.canvasObject.domNode==target.parentNode||(target.parentNode&&this.canvasObject.domNode==target.parentNode.parentNode)||target.tagName.toLowerCase()=="img"){return true;}else{return false;}},isLowestLevelRectangle:function(target){if(target.getAttribute&&target.getAttribute("idx")&&!(target.innerHTML)){return true;}else{return false;}},doLinkDrill:function(entity){if(!entity){return ;}var actionObj=this.getActionObj({entity:entity,type:HYPERLINK_ACTION});if(actionObj){this.highlightEntity(this.selectionHighlightBox,entity);this.performAction([actionObj]);}},getActionObj:function(actionInfo){if(!actionInfo){return null;}var actionType=actionInfo.type,entity=actionInfo.entity,actionObj=null;switch(actionType){case HYPERLINK_ACTION:var rowHeader=this.model.gts.row,rl=rowHeader.length,level=entity.level,attrIndex;for(var i=0;i<=level;i++){var attr=rowHeader[i];if(attr.lm){for(var j=0;j<attr.lm.length;j++){if(attr.lm[j].links){break;}}if(j!=attr.lm.length){attrIndex=i;break;}}}var rowIndex=(entity.index===undefined)?entity.indices[0]:entity.index,ghs=this.model.ghs;if(!isNaN(attrIndex)){var attr=this.model.gts.row[attrIndex];linkDrillNode={};linkDrillNode.titleInfo=attr;linkDrillNode._e=attr.es[ghs.rhs.items[rowIndex].items[attrIndex].idx];actionObj={at:actionType,k:this.getModelKey(),node:linkDrillNode};break;}index=this.firstColLinkDrillIndex;if(!isNaN(index)){var metricH=this.model.gts.col[0],metric=metricH.es[index],lm=metricH.lm[index];if(lm&&lm.links){linkDrillNode={};linkDrillNode.titleInfo=metricH;linkDrillNode.mix=index;actionObj={at:actionType,k:this.getModelKey(),node:linkDrillNode};}break;}break;case SELECTOR_ACTION:var entity=actionInfo.entity,anchor=actionInfo.anchor;if(!entity||!anchor){break;}if(entity){var m=this.model,rown=m.gts.row,rl=rown.length,rhs=m.ghs.rhs.items,index=(entity.index===undefined)?entity.indices[0]:entity.index,row=rhs[index].items,selectorObjects=[];for(var i=0;i<rl;i++){var att=rown[i],sc=att.sc;if(att.otp!=-1&&sc!==undefined){var ix=row[i].idx,elementId=att.es[ix].id,es=att.es[ix].n,eid;if(!elementId||elementId.substring(0,1)==="D"){continue;}if(sc.all!="false"&&sc.all!=false&&actionInfo.needSelectAll){eid=EID_SELECTALL;}else{eid=att.es[ix].id;}selectorObjects.push({sc:sc,es:es,eid:eid});}}actionObj={at:actionType,k:this.getModelKey(),scObjList:selectorObjects,anchor:anchor};}break;case INFOWINDOW_ACTION:var entity=actionInfo.entity,anchor=actionInfo.anchor;if(!entity||!anchor){break;}if(entity){var m=this.model,rown=m.gts.row,rl=rown.length,rhs=m.ghs.rhs.items,index=(entity.index===undefined)?entity.indices[0]:entity.index,row=rhs[index].items,selectorObjects=[];for(var i=0;i<rl;i++){var att=rown[i],sc=att.sc;if(att.otp!=-1&&sc!==undefined){var ix=row[i].idx,elementId=att.es[ix].id,es=att.es[ix].n,eid;if(!elementId||elementId.substring(0,1)==="D"){continue;}if(sc.all!="false"&&sc.all!=false&&actionInfo.needSelectAll){eid=EID_SELECTALL;}else{eid=att.es[ix].id;}selectorObjects.push({sc:sc,es:es,eid:eid});}}actionObj={at:actionType,k:this.getModelKey(),scObjList:selectorObjects,anchor:anchor};}break;default:break;}return actionObj;},getModelKey:function(){return this.model&&this.model.k;},deleteNode:function(node,delDict,parentDict,key){if(!(node.size&&node.size.w&&node.size.h)){return ;}if(!node.entityChildren){node.deleted=true;if(parentDict&&key){if(delDict===delStatus.dftUnDel||delDict===delStatus.dftDel){parentDict[key]=delStatus.dftDel;}else{parentDict[key]=delStatus.usrDel;}}return ;}else{parentDict=delDict;for(var index in node.entityChildren){var thisChild=node.entityChildren[index];key=this.getEntityDisplayName(thisChild);var thisDict=parentDict[key];if(!thisDict){parentDict[key]={};thisDict=parentDict[key];}this.deleteNode(thisChild,thisDict,parentDict,key);}}},toggleSelectAll:function(entity){var sc=this.model.gts.row[entity.level].sc;if((sc&&sc.all!="false"&&sc.all!=false)||!this.hasGridTarget){if(this.selectAll){this.selectAll=false;}else{this.selectAll=true;}return true;}return false;},doSelection:function(entity){if(!entity){return ;}if(entity==this.previousSelected){if(!this.toggleSelectAll(entity)){return ;}var anchor=this.selectionHighlightBox,actionInfo={entity:entity,type:SELECTOR_ACTION,needSelectAll:this.selectAll,anchor:anchor};actionObject=this.getActionObj(actionInfo);if(this.selectAll){this.selectionHighlightBox.style.display="none";delete actionObject.anchor;}else{this.highlightEntity(this.selectionHighlightBox,entity);}this.performAction([actionObject]);}else{this.selectAll=false;var anchor=this.selectionHighlightBox,actionInfo={entity:entity,type:SELECTOR_ACTION,needSelectAll:this.selectAll,anchor:anchor};this.previousSelected=entity;this.highlightEntity(this.selectionHighlightBox,entity);var actionObject=this.getActionObj(actionInfo);this.performAction([actionObject]);}},getObjectByIdx:function(idx){if(idx){var indexArray=idx.split(":");var obj=this.root;for(var i=0;i<indexArray.length;i++){obj=obj.entityChildren[indexArray[i]];}return obj;}return null;},toggleDeleteButton:function(){if(!this.infoBox){return ;}if(this.props.delButtonEnabled){this.deleteButton.style.display="none";this.props.delButtonEnabled=false;}else{this.deleteButton.style.display="block";this.props.delButtonEnabled=true;}},editorDialog:null,popupEditor:function(anchor){this.hideInfoBox();var heatmapId=this.id;var deleteTreeId=heatmapId+"-deleteTree";var editorId=heatmapId+"-editor";var that=this;var defaultSelectionStatus=0;if(this.props.delButtonEnabled){defaultSelectionStatus=1;}var strSettings=mstrmojo.desc(7831,"Settings"),strDeletedItems=mstrmojo.desc(10081,"Deleted Items"),strRefresh=mstrmojo.desc(10378,"REFRESH"),strRTSC=mstrmojo.desc(10082,"Refresh to saved configuration"),strRTDC=mstrmojo.desc(10083,"Refresh to default configuration"),strApply=mstrmojo.desc(10379,"APPLY"),strDelete=mstrmojo.desc(10380,"DELETE"),strEnableDelete=mstrmojo.desc(10085,"Enable Delete"),strRestore=mstrmojo.desc(10084,"Please select elements that you want to restore"),strButtonCancel=mstrmojo.desc(221,"Cancel"),strButtonApply=mstrmojo.desc(134,"Apply");var prop={anchor:this.editorButton,title:"Heat Map",id:editorId,anchorOrientation:"h",width:this.LayoutProperties.EditorDialogWidth+"px",contentMaxHeight:this.LayoutProperties.DeletedListHeight,panels:[{title:strSettings,scriptClass:"mstrmojo.VisHeatMapPopupPanel",width:"100%",height:"100%",children:[{scriptClass:"mstrmojo.Label",text:strRefresh,cssDisplay:"-webkit-box",cssClass:"heatmap-gray-label"},{scriptClass:"mstrmojo.VisHeatMapTree",showIndicators:false,isSelectable:false,cssClass:"simple-tree",cssText:"padding-left:15px;padding-right:15px;",buttonNodeCss:"",items:[{n:strRTSC,buttonNodeWidget:{scriptClass:"mstrmojo.Button",text:strApply,cssClass:"heatmap-apply-button",onclick:function(){that.isUsingSavedColorTheme=true;that.isUsingDefaultColorTheme=false;var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();that.hideLegendTooltip();that._scroller.offset.x.start=0;that._scroller.offset.x.end=0;that._scroller.offset.y.start=0;that._scroller.offset.y.end=0;that._scroller.scrollTo(0,0,0);var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){that.useSavedColorTheme(callback);var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}},0);},0);}}},{n:strRTDC,buttonNodeWidget:{scriptClass:"mstrmojo.Button",text:strApply,cssClass:"heatmap-apply-button",onclick:function(){that.isUsingSavedColorTheme=false;that.isUsingDefaultColorTheme=true;var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();that.hideLegendTooltip();that._scroller.offset.x.start=0;that._scroller.offset.x.end=0;that._scroller.offset.y.start=0;that._scroller.offset.y.end=0;that._scroller.scrollTo(0,0,0);var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){that.useDefaultColorTheme(callback);var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}},0);},0);}}}]},{scriptClass:"mstrmojo.Label",text:strDelete,cssDisplay:"-webkit-box",cssClass:"heatmap-gray-label"},{scriptClass:"mstrmojo.VisHeatMapTree",isSelectable:true,cssClass:"simple-tree",cssText:"margin-left:15px;margin-right:15px;",showIndicators:false,defaultSelectionStatus:defaultSelectionStatus,items:[{n:strEnableDelete,itemFunction:function(){that.toggleDeleteButton();}}]},]},{title:strDeletedItems,scriptClass:"mstrmojo.VisHeatMapPopupPanel",cssText:"position: relative",width:"100%",naviAction:function(){var object=mstrmojo.all[deleteTreeId];if(object){object.refresh();}},children:[{scriptClass:"mstrmojo.Box",cssText:"padding-left:16px;padding-right:16px; maxHeight:"+parseInt(this.LayoutProperties.DeletedListHeight*0.89)+"px",children:[{scriptClass:"mstrmojo.VisHeatMapTree",height:"100%",heightLimit:parseInt(this.LayoutProperties.DeletedListHeight*0.89),showIndicators:true,showScrollbars:true,id:deleteTreeId,itemDisplayField:"label",itemChildrenField:"entityChildren",draggable:true,showRoot:true,rootText:strRestore,itemIncludeFunction:function(item){if(item&&(item.deleted||item.hasChildDeleted)){return true;}else{return false;}},apply:function(callback){var itemFunction=function(){if(this.selectionStatus===1&&this.dataProvider&&this.dataProvider.deleted){this.dataProvider.deleted=false;var tempNode=this.dataProvider;if(!tempNode.entityChildren){var keyStack=[];while(tempNode.parentEntity){keyStack.push(that.getEntityDisplayName(tempNode));tempNode=tempNode.parentEntity;}var delDict=that.props.deletedList;while(keyStack.length>1){delDict=delDict[keyStack.pop()];}var key=keyStack.pop();if(delDict[key]===delStatus.dftDel){delDict[key]=delStatus.dftUnDel;}else{delete delDict[key];}}}};var iterator=function(item,itemFunction){itemFunction.apply(item);if(!item.childTree){return ;}for(var i=0;i<item.childTree.length;i++){var subItem=item.childTree[i];iterator(subItem,itemFunction);}};iterator(this,itemFunction);that.refreshWidget();var tree=this;window.setTimeout(function(){tree.needRefresh=true;tree.refresh();if(callback){callback();}},50);},dataProvider:that.root,owner:that}]},{scriptClass:"mstrmojo.Box",cssText:"background-color:whiteSmoke; position:relative; bottom:0px;font:12pt Roboto,Regular;text-align:center;vertical-align:middle;line-height:55px;border-top: 1px solid rgba(34, 34, 34, 0.18);",height:parseInt(this.LayoutProperties.DeletedListHeight*0.11)+"px",width:"100%",children:[{scriptClass:"mstrmojo.Button",text:strButtonCancel,cssClass:"heatmap-tree-button",cssDisplay:"inline-block",cssText:"border-right: 1px solid rgba(34, 34, 34, 0.18); position: absolute; left:0px; top: 0px; height:100%;",width:"49.5%",onclick:function(){var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});setTimeout(function(){mstrmojo.all[editorId].close();},100);}},{scriptClass:"mstrmojo.Button",text:strButtonApply,cssClass:"heatmap-tree-button",cssDisplay:"inline-block",cssText:"position: absolute; right:0px; top:0px; height: 100%",width:"50.5%",postBuildRendering:function(){mstrmojo.all[deleteTreeId].register(this);},notify:function(enabled){this.set("enabled",enabled);},onclick:function(){var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){mstrmojo.all[deleteTreeId].apply(callback);},0);},0);}}]}]}]};this.editorDialog=mstrApp.showDialog(prop,"HeatMapEditor");},showWaitIcon:function(delay){var w=this.waitIcon;w.style.display="-webkit-box";w.style.left="0px";w.style.top="0px";},hideWaitIcon:function(){var w=this.waitIcon;w.style.left="-100000px";w.style.top="-100000px";},clearChildren:function(node){var firstChild;if(!node){return ;}while(firstChild=node.firstChild){node.removeChild(firstChild);}},calculateValuesInTree:function(){var ml=this.model.gvs.items[0]?this.model.gvs.items[0].items.length:0;clearMaxMinValues.call(this);setShow(false,false,true,true,this.root,this,ml+1);},refreshWidget:function(){this.showWaitIcon();var that=this;var refresh=function(){that.calculateValuesInTree();getLegendMaxMin.call(that);layoutEntities.call(that);that.renderRectangles();that.renderLegend();var ps=that.previousSelected;if(ps){if(ps.deleted){that.selectionHighlightBox.style.display="none";}else{if(!that.selectAll){that.highlightEntity(that.selectionHighlightBox,that.previousSelected);}}}that.hideWaitIcon();};window.setTimeout(refresh,10);},hideInfoBox:function(){if(!this.infoBox){return ;}this.infoBox.style.zIndex="-50";this.infoBox.style.opacity=0;this.previousTooltip=null;},getIdxObjectByTarget:function(target){var ancestor=mstrmojo.dom.findAncestorByAttr(target,"idx",true,this.domNode);var idx=ancestor&&ancestor.value;if(!idx){return null;}var idxObject=this.getObjectByIdx(idx);return idxObject;},showInfoBox:function(entity){if(!entity){return ;}if(!this.infoBox){this.createInfoBox();}var idxObject=entity;if(idxObject===this.previousTooltip){return ;}this.previousTooltip=idxObject;if(this.infoBox.style.display!="block"){this.infoBox.style.display="block";}this.infoBox.style.zIndex="75";this.infoBox.style.opacity=1;var hBoxWidth=this.highlightBoxWidth,domRect=mstrmojo.dom.position(document.body,true),interRect=this.highlightEntity(this.highlightBox,idxObject);if(!interRect||isNaN(interRect.x)){return ;}this.deleteButton.style.left=interRect.x+"px";this.deleteButton.style.top=interRect.y+"px";this.tooltipBox.style.width="";this.tooltipBox.innerHTML=getTooltip(idxObject,this);var anchorBox={x:interRect.x-hBoxWidth,y:interRect.y-hBoxWidth,w:interRect.w+hBoxWidth*2,h:interRect.h+hBoxWidth*2};this.triBox.style.display="block";var anchorCenterX=anchorBox.x+(anchorBox.w>>1);var anchorCenterY=anchorBox.y+(anchorBox.h>>1);var triSize=this.triBox.offsetWidth*0.717;var cNodes=this.tooltipBox.childNodes,len=cNodes.length;for(var i=0;i<len;i++){var cInline=cNodes[i].childNodes;if(cInline[0].offsetWidth+cInline[1].offsetWidth+cInline[2].offsetWidth>cNodes[i].offsetWidth){cInline[0].className+=" heatmap-half-width";}}var tHeight=this.tooltipBox.offsetHeight;var tWidth=this.tooltipBox.offsetWidth;var matched=false;var xFit=((anchorCenterX-(tWidth>>1))>0)&&(anchorCenterX+(tWidth>>1))<(domRect.w);var yFit=((anchorCenterY-(tHeight>>1))>0)&&(anchorCenterY+(tHeight>>1))<(domRect.h);var canShiftPadding=10;function calcPosition(triBox,tooltipBox,deleteButton,canShift){if(canShift===undefined){canShift=false;}if(!matched&&(canShift||yFit)){if(anchorBox.x-triSize-tWidth>=0){matched=true;triBox.style.left=anchorBox.x-triSize+"px";tooltipBox.style.left=anchorBox.x-triSize-tWidth+"px";deleteButton.style.left=interRect.x+interRect.w+"px";}else{if(anchorBox.x+anchorBox.w+triSize+tWidth<=domRect.w){matched=true;triBox.style.left=anchorBox.x+anchorBox.w+triSize+"px";tooltipBox.style.left=anchorBox.x+anchorBox.w+triSize+"px";}}if(matched){var triTop=anchorCenterY;var tooltipTop=anchorCenterY-tHeight/2;if(canShift){if(tHeight+canShiftPadding*2>domRect.h){matched=false;}else{var upLimit=canShiftPadding;var downLimit=domRect.h-canShiftPadding-tHeight;if(tooltipTop<upLimit){tooltipTop=upLimit;}else{if(tooltipTop>downLimit){tooltipTop=downLimit;}}}}triBox.style.top=triTop+"px";tooltipBox.style.top=tooltipTop+"px";}}if(!matched&&(canShift||xFit)){if(anchorBox.y-triSize-tHeight>=0){matched=true;triBox.style.top=anchorBox.y-triSize+"px";tooltipBox.style.top=anchorBox.y-triSize-tHeight+"px";deleteButton.style.top=interRect.y+interRect.h+"px";}else{if(anchorBox.y+anchorBox.h+triSize+tHeight<=domRect.h){matched=true;triBox.style.top=anchorBox.y+anchorBox.h+triSize+"px";tooltipBox.style.top=anchorBox.y+anchorBox.h+triSize+"px";}}if(matched){var triLeft=anchorCenterX;var tooltipLeft=anchorCenterX-tWidth/2;if(canShift){if(tWidth+canShiftPadding*2>domRect.w){matched=false;}else{var leftLimit=canShiftPadding;var rightLimit=domRect.w-canShiftPadding-tWidth;if(tooltipLeft<leftLimit){tooltipLeft=leftLimit;}else{if(tooltipLeft>rightLimit){tooltipLeft=rightLimit;}}}}triBox.style.left=triLeft+"px";tooltipBox.style.left=tooltipLeft+"px";}}}calcPosition(this.triBox,this.tooltipBox,this.deleteButton,false);this.infoBox.style.display="block";if(!matched){anchorBox={x:anchorCenterX,y:anchorCenterY,w:0,h:0};this.triBox.style.display="none";triSize=0;calcPosition(this.triBox,this.tooltipBox,this.deleteButton,true);}if(!matched){this.triBox.style.display="none";this.tooltipBox.style.left=anchorCenterX-tWidth/2+"px";this.tooltipBox.style.top=anchorCenterY-tHeight/2+"px";}this.shadowBox.style.left=this.tooltipBox.style.left;this.shadowBox.style.top=this.tooltipBox.style.top;this.shadowBox.style.width=this.tooltipBox.offsetWidth+"px";this.shadowBox.style.height=this.tooltipBox.offsetHeight+"px";this.shelter.style.left=this.tooltipBox.style.left;this.shelter.style.top=this.tooltipBox.style.top;this.shelter.style.width=this.tooltipBox.offsetWidth+"px";this.shelter.style.height=this.tooltipBox.offsetHeight+"px";var span=this.tooltipBox.childNodes[0].childNodes[0];var style=window.getComputedStyle(span,null);},enableGlobalDismiss:function(){var touchManager=mstrmojo.touchManager;var heatMap=this;this._globalTouchListener=touchManager.attachEventListener("touchesBegin",this.id,function(evt){if(!evt||!evt.touch||!evt.touch.target){return ;}var target=evt.touch.target,backgroundDiv1=document.getElementsByClassName("mstrmojo-DocLayoutViewer-layout")[0],backgroundDiv2=document.getElementsByClassName("mstrmojo-DocSubsection")[0];if(heatMap.infoBoxPuppet!=target&&!mstrmojo.dom.contains(heatMap.infoBox,target,true)){heatMap.hideInfoBox();}if(target!=backgroundDiv1&&target!=backgroundDiv2){return ;}if(!this.selectAll){heatMap.doSelection(heatMap.previousSelected);}});},disableGlobalDismiss:function(){var touchManager=mstrmojo.touchManager;if(this._globalTouchListener){touchManager.detachEventListener(this._globalTouchListener);delete this._globalTouchListener;}},touchInfoBoxValid:function(touch){var taget=touch.target;if(target.id==this.id+"-infobox"){return true;}},touchLegendTooltipValid:function touchValid(touch){var target=touch.target;if(target.id!=this.id+"-color-legend-band"){return false;}var frame=mstrmojo.dom.position(target,true),x=touch.clientX-frame.x,y=touch.clientY-frame.y,p=this.legendBand;if(x<p.x||x>=p.x+p.w-1){return false;}return true;},showLegendTooltip:function(touch){var target=touch.target,frame=mstrmojo.dom.position(target,true),x=touch.clientX-frame.x,y=touch.clientY-frame.y,p=this.legendBand,idx;var ct=this.colorTheme;if(ct.tooltipInfo===undefined||ct.tooltipInfo===null){ct.createTooltipInfo(this.legendTickCount,p.w,this);this.selectedBandIndex=-1;}var i=ct.getTooltipInfo(x-p.x);if(i!=this.selectedBandIndex){this.renderHilightedBand(i);}var t=this.colorTheme.tooltipInfo[i],cfs=this.getFormatString(this.colorMetricIndex),mn=this.getMetricName(this.colorMetricIndex),sign=(t.sign===undefined)?" < ":" > ",str="<div>"+this.nf.formatByMask(cfs,t.sv)+sign+"</div><div class='heatmap-flex'>"+mn+"</div><div>"+sign+this.nf.formatByMask(cfs,t.ev)+"</div>";this.legendTooltip.innerHTML=str;this.legendTooltip.style.borderColor=getCSSColor(t.c);this.legendTooltip.style.lineHeight=this.legendTooltip.style.height;this.legendTooltip.style.display="-webkit-box";var size={w:this.legendTooltip.offsetWidth,h:this.legendTooltip.offsetHeight};var lc=mstrmojo.dom.position(this.colorLegend,true),cv=mstrmojo.dom.position(this.canvas,true),tx=t.r.x+((t.r.w-size.w)>>1);if(tx<0){tx=0;}else{if(tx>frame.w-size.w){tx=frame.w-size.w;}}this.legendTooltip.style.left=tx+"px";this.legendTooltip.style.top=-35+"px";},hideLegendTooltip:function(){if(this.selectedBandIndex===undefined||this.selectedBandIndex==-1){return ;}this.renderGradientBand(this.legendBand);this.selectedBandIndex=-1;this.legendTooltip.style.left="-100000px";},touchSelectBegin:function(touch){if(touch.evt.ctrlKey){this.touchMultiBegin(touch);return ;}var target=touch.target;if(!target){return ;}this.lastTouchSelectTarget=target;if(this.touchLegendTooltipValid(touch)){this.showLegendTooltip(touch);this.hideInfoBox();}else{this.hideLegendTooltip();var entity;if(this.infoWindowMode){entity=this.getEntityByTouch(touch,true);}else{entity=this.getEntityByTouch(touch);}if(!entity){return ;}if(this.timer){cleatTimeout(this.timer);this.timer=null;}if(this.infoWindowMode){this.doSelection(entity);}else{this.showInfoBox(entity);}}},touchSelectMove:function(touch){if(touch.evt.ctrlKey){this.touchMultiMove(touch);return ;}var target=touch.target;if(!target){return ;}if(this.touchLegendTooltipValid(touch)){this.showLegendTooltip(touch);this.hideInfoBox();}else{this.hideLegendTooltip();var entity;if(this.infoWindowMode){entity=this.getEntityByTouch(touch,true);}else{entity=this.getEntityByTouch(touch);}if(!entity){return ;}var that=this;if(this.timer){clearTimeout(this.timer);this.timer=null;}if(this.infoWindowMode){if(this.previousSelected!=entity){this.doSelection(entity);}}else{this.showInfoBox(entity);}}},touchSelectEnd:function(touch){if(touch.evt.ctrlKey){this.touchMultiEnd(touch);}return ;},initScroller:function(scroller){scroller.attachEventListener("scrollMoved",this.id,function(evt){this.hideInfoBox();});scroller.attachEventListener("scrollDone",this.id,function(evt){this.canvasObject.updateOffsets(scroller.origin.x,scroller.origin.y);});},multiTouch:true,touchMultiBegin:function(touch){this.hideLegendTooltip();this.hideInfoBox();var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:300,pageY:300};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;this.initDiffDiff=xDiff*xDiff+yDiff*yDiff;this.initCenterX=((touch1.pageX+touch2.pageX)>>1);this.initCenterY=((touch1.pageY+touch2.pageY)>>1);this.initScrollX=this._scroller.origin.x;this.initScrollY=this._scroller.origin.y;this.relScaleFactor=1;},touchMultiMove:function(touch){var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:300,pageY:300};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;var curDiffDiff=xDiff*xDiff+yDiff*yDiff;var curCenterX=((touch1.pageX+touch2.pageX)>>1);var curCenterY=((touch1.pageY+touch2.pageY)>>1);var scale=Math.sqrt(curDiffDiff/this.initDiffDiff);var offset={x:scale*(this.initCenterX+this.initScrollX)-curCenterX,y:scale*(this.initCenterY+this.initScrollY)-curCenterY};var transform={scale:scale,offset:offset};this.relScaleFactor=scale;if(this.relScaleFactor*this.scaleFactor>=this.maxScale&&!this.oldTransform){this.oldTransform=transform;}this.applyTransform(transform);},touchMultiEnd:function(touch){var finalScale=this.relScaleFactor*this.scaleFactor;if(finalScale<1){var initTransform={offset:{x:0,y:0},scale:1/this.scaleFactor};this.relScaleFactor=initTransform.scale;this.applyTransform(initTransform,500,this.postScale);}else{if(finalScale>this.maxScale){this.relScaleFactor=this.maxScale/this.scaleFactor;this.applyTransform(this.oldTransform,500,this.postScale);delete this.oldTransform;}else{this.postScale();}}},relScaleFactor:1,scaleFactor:1,applyTransform:function(transform,duration,callback){var scl=this._scroller;if(duration===undefined){duration=0;}scl.scrollEl.style.webkitTransformOrigin="left top";scl.transform="scale("+transform.scale+","+transform.scale+")";var scrollX=transform.offset.x,scrollY=transform.offset.y,scrollerOffsetScale=this.scaleFactor*this.relScaleFactor-1,vOffsetEnd=this.heatMapSize.h*scrollerOffsetScale,hOffsetEnd=this.heatMapSize.w*scrollerOffsetScale;scl.offset={y:{start:0,end:vOffsetEnd},x:{start:0,end:hOffsetEnd}};this._scroller.scrollTo(scrollX,scrollY,duration);if(callback){var that=this;setTimeout(function(){callback.apply(that);that=null;},duration);}},postScale:function(){delete this._scroller.transform;this._scroller.scrollTo(this._scroller.origin.x,this._scroller.origin.y,0);this.scaleFactor*=this.relScaleFactor;if(this.scaleFactor>this.maxScale){this.scaleFactor=this.maxScale;}this.refreshWidget();},destroy:function(skipCleanup){this._super(skipCleanup);if(this.editorDialog){this.editorDialog.destroy();delete this.editorDialog;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.hash","mstrmojo.GeoLocation","mstrmojo._TouchGestures");var R="\u001F",J="\u001E",F="\u001D",W="\u001C",X="\u001B";function O(Z,Y){if(!!Z&&!!Z.imgNode){var a=Z.imgNode.style;a.opacity=Y;}}var D=mstrmojo.Image.baseCssClass+"-prv";mstrmojo.maps.androidmap.AndroidMap=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.maps.androidmap.AndroidMap",cssClass:"mstr-googleMapView",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@domNodeCssText}" mstrAttach:touchstart></div>',reRenderOnDimensionChg:false,mapRendered:false,firstScreen:true,children:[{scriptClass:"mstrmojo.Image",alias:"imgPreview",cssClass:"prv",cssText:"position:absolute;left:0;top:0;",firstLoad:false,onload:function(){O(this,1);var Y=this;window.setTimeout(function(){Y.parent.postImageProcessing(Y.firstLoad);Y.firstLoad=false;},300);}}],markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onheightChange:function(){this.domNode.style.height=this.getHeight()+"px";},onwidthChange:function(){this.domNode.style.width=this.getWidth()+"px";}},setModel:function K(Y){this.set("model",Y);this.xtabModel=Y;if(Y.data){this.set("gridData",Y.data);}},postImageProcessing:function V(Y){if(Y&&this.controller&&this.controller.takeScreenShot){this.controller.takeScreenShot();}if(this.imgPreview.src!=""&&mstrMobileApp&&mstrMobileApp.hideMapView){window.setTimeout(function(){mstrMobileApp.hideMapView(0);},100);}},ongridDataChange:function(){this.parser=new mstrmojo.Vis.DataParser(this.gridData);delete this.dataMap;},update:function G(a){a=a||this.node;if(a){if(a.data){this.set("gridData",a.data);var Z=this.gridData;if(Z.layoutModel){this.layoutModel=Z.layoutModel;}if(Z.layoutNode){this.layoutNode=Z.layoutNode;}delete Z.layoutModel;delete Z.layoutNode;}var Y=a.defn.fmts||a.defn.units[this.xtabModel.k].fmts;this.width=parseInt(Y.width,10);this.height=parseInt(Y.height,10);this.top=parseInt(Y.top,10);this.left=parseInt(Y.left,10);this.fmts=Y;}if(this.xtabModel){this.initFromVisProps(this.gridData.vp);}this.updated=true;},getMapModel:function(){var Y=mstrApp.getCurrentProjectId(),Z=mstrApp.serverProxy.getSessions();return{pid:Y,sessions:Z,mapId:this.id,hasTarget:false,hostUrl:mstrApp.getConfiguration().getHostUrlByProject(Y)};},getGridModel:function(){var Y=mstrmojo.hash.copy(this.gridData,{});return Y;},initFromVisProps:function S(Y){this.vp=Y;},dispatchMapData:function C(){var Y=this.getMapModel(),Z=this.simplifyGridData();mstrMobileApp.loadMap(JSON.stringify(mstrmojo.hash.copy(Y,{gdProp:Z.prop,infoWindow:{dft:true}})),Z.es,Z.data,"");this.mapRendered=true;},simplifyGridData:function H(){if(this.dataMap){return this.dataMap;}var x=this.gridData,z=[],l=[],Y={row:[],col:[]},f,b,a,w=[],AA=[],k=[],g=[],d=[],Z,e,h,s,p,q,t;if(typeof (x.ghs)=="undefined"||(x.gts.row.length==0)){x.eg="no data returned";}if(x.eg){this.dataMap={prop:{},data:"",es:""};}else{for(s=0,e=x.ghs.rhs.items,p=e.length;s<p;s++){for(q=0,h=e[s].items,t=h.length;q<t;q++){g.push(h[q].idx);}z.push(g.join(F));g=[];}for(s=0,e=x.gvs.items,p=e.length;s<p;s++){for(q=0,h=e[s].items,t=h.length;q<t;q++){d.push(h[q].v);d.push(h[q].rv||0);if(h[q].ti!==undefined||h[q].ts!==undefined){v="";if(h[q].ti!==undefined){x.th[h[q].ti].ty=h[q].ty;v=h[q].ti;}v+=X;if(h[q].ts!==undefined){v+=h[q].ts;}d.push(v);}g.push(d.join(W));d=[];}l.push(g.join(F));g=[];}b=x.gts.row;mstrmojo.array.forEach(b,function(j){f={};mstrmojo.hash.copyProps(["n","id","fid","fs","sc"],j,f);Y.row.push(f);g=[];mstrmojo.array.forEach(j.es,function(o){g.push(o.n);});AA.push(g.join(W));});w.push(AA.join(J));a=x.gts.col;mstrmojo.array.forEach(a,function(j){f={};mstrmojo.hash.copyProps(["n","id","fid"],j,f);Y.col.push(f);g=[];mstrmojo.array.forEach(j.es,function(o){g.push(o.n);});k.push(g.join(W));});w.push(k.join(J));this.dataMap={prop:{vp:x.vp,th:x.th,gts:Y},es:w.join(R),data:z.join(J)+R+l.join(J)};}return this.dataMap;},getModel:function L(){return this.gridData;},handleMarkerSelection:mstrmojo.emptyFn,postBuildRendering:function Q(){this.dispatchMapData();this._super();},rebuildLayout:mstrmojo.emptyFn,resetLayout:mstrmojo.emptyFn,setDimensions:function N(b,a){var d=this.googleMap,Y=d?d.getCenter():null,Z=this._super(b,a);if(d){this.map.style.height=this.getHeight()+"px";this.map.style.width=(this.getWidth()-1)+"px";d.setCenter(Y);}return Z;},unrender:function P(){this.imgPreview.src="";if(this.mapRendered){this.removeMap();this.mapRendered=false;}this._super();},removeMap:function U(){mstrMobileApp.hideMapView("1");},switchToImage:function B(b,a,Z){var Y=this.imgPreview;Y.firstLoad=this.firstScreen;this.firstScreen=false;if(b&&Y.hasRendered){if(Y.src!==b){O(Y,0);Y.domNode.className=D;Y.set("src",b);Y.set("width",a);Y.set("heihgt",Z);}else{if(mstrMobileApp&&mstrMobileApp.hideMapView){O(this.imgPreview,1);this.postImageProcessing(false);}}}else{mstrMobileApp.hideMapView(0);}},hidePreview:function M(){O(this.imgPreview,0);},showPreview:function A(){O(this.imgPreview,1);},closeInfoWindow:function E(){do{mstrApp.closeDialog();}while(mstrmojo.all.mstrMapInfoWindow);},ontouchstart:function I(){if(this.mapRendered){mstrMobileApp.showMapView(0);}},destroy:function T(){var Y=this.parent;while(Y){if(Y._scroller&&Y.scrollMoveListener){}Y=Y.parent;}this._super();if(this.mapRendered){mstrMobileApp.navigateAway();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.array","mstrmojo.hash","mstrmojo.android.EnumMenuOptions","mstrmojo.GeoLocation","mstrmojo._TouchGestures","mstrmojo.android.DropDownList","mstrmojo.Label");mstrmojo.requiresDescs(7736,8068,8069,8102,8395,8954);var T=mstrmojo.array,O=mstrmojo.android.EnumMenuOptions,C=O.REPROMPT,E=1000;function L(a,b,X,Z,Y){this.title=a;this._latlng=b;this._rad=X;this._ix=Z;this._color=Y;}function I(){L.prototype=new google.maps.OverlayView();L.prototype.draw=function(){var f=this.div_;if(!f){f=this.div_=document.createElement("DIV");var b=f.style,Z=this._rad,a=Z/2,Y=a+"px "+a+"px",d=this.getPanes(),e=this;b.position="absolute";b.paddingLeft="0px";b.cursor="pointer";b.backgroundColor=this._color;b.opacity=".65";b.borderRadius=Y;b.height=b.width=Z+"px";b.border="2px solid black";google.maps.event.addDomListener(f,"click",function(g){google.maps.event.trigger(e,"click");});d.overlayMouseTarget.appendChild(f);}var X=this.getProjection().fromLatLngToDivPixel(this._latlng);if(X){f.style.left=(X.x-this._rad/2)+"px";f.style.top=(X.y-this._rad/2)+"px";}};L.prototype.remove=function(){var X=this.div_;if(X){X.parentNode.removeChild(X);this.div_=null;}};L.prototype.getPosition=function(){return this._latlng;};}var D=function D(a){var b;if(a.length>0){b=new google.maps.LatLngBounds();for(var Y in a){var X=a[Y],Z=X.getPosition();b.extend(Z);}}return b;};function S(Y,X){return X.replace(/POINT[ ]?\(|\)/g,"").split(" ")[Y=="lat"?1:0];}function G(){return this._mapTypeToGoogleMapTypeId[this.mapType];}mstrmojo.maps.jsmap.AndroidMap=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.maps.jsmap.AndroidMap",cssClass:"mstr-googleMapView",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@domNodeCssText}"><div></div><div class="androidMap-metricSelector"><span class="androidMap-toggleHeader"></span></div><div class="mstr-googleMap" id="map_canvas_{@id}"></div></div>',reRenderOnDimensionChg:false,noMapsMsg:mstrmojo.desc(8954,"Google Maps have not been configured for this device. Please check with your mobile administrator to enable Google Maps in the mobile configuration."),selMetricIx:0,markerArr:[],googleMap:null,bubblesMaxInfo:[],maxBubbleSize:50,minBubbleSize:20,markupSlots:{msg:function(){return this.domNode.childNodes[0];},metricSelector:function(){return this.domNode.childNodes[1];},map:function(){return this.domNode.childNodes[2];}},markupMethods:{onheightChange:function(){this.domNode.style.height=this.getHeight()+"px";},onwidthChange:function(){this.domNode.style.width=this.getWidth()+"px";}},layoutConfig:{h:{metricSelector:"32px",map:"100%"},w:{metricSelector:"200px",map:"100%"}},children:[{scriptClass:"mstrmojo.android.DropDownList",slot:"metricSelector",options:null,onidxChange:function(X){this._super(X);this.parent.onselMetricIxChange(X);this.set("value",this.options[X.value].v);},visible:false,alias:"metricSel"},{scriptClass:"mstrmojo.Box",slot:"map"},{scriptClass:"mstrmojo.Label",cssClass:"androidMap-errorMsg",visible:true,alias:"errorMsg",slot:"msg"}],setModel:function N(X){this.set("model",X);this.xtabModel=X;if(X.data){this.set("gridData",X.data);}},ongridDataChange:function(){this.parser=new mstrmojo.Vis.DataParser(this.gridData);},update:function F(Z){Z=Z||this.node;if(Z){if(Z.data){this.set("gridData",Z.data);var Y=this.gridData;if(Y.layoutModel){this.layoutModel=Y.layoutModel;}if(Y.layoutNode){this.layoutNode=Y.layoutNode;}}var X=Z.defn.fmts||Z.defn.units[this.xtabModel.k].fmts;this.width=parseInt(X.width,10);this.height=parseInt(X.height,10);this.top=parseInt(X.top,10);this.left=parseInt(X.left,10);this.fmts=X;}if(this.xtabModel){this.initFromVisProps(this.gridData.vp);}this.updated=true;},getMapModel:function(){return this.xtabModel;},initFromVisProps:function U(X){if(!X){return ;}if(X.dv){this.mapType=parseInt(X.dv,10);}this.usePt=(X.gr=="1");this.useAttributes=(X.af==="0");this.geoAttr=X.ga;this.markerType=X.mtp;this.attrThresholds=X.at;this.flong=X.flong;this.flat=X.flat;this.fpt=X.fpt;this.mstyl=X.mstyl;this.maxBubbleSize=X.mbs||50;},showErrorMsg:function K(X,Y){this.errorMsg.set("text",Y);this.metricSelector.style.display=X?"none":"block";this.map.style.display=X?"none":"block";this.msg.style.display=X?"block":"none";},postBuildRendering:function R(){console.log("JSMAP:androiMap:postBuildRendering");this._super();if(typeof this.gridData.eg!=="undefined"){this.showErrorMsg(true,this.gridData.eg);}else{if(typeof google==="undefined"||(google&&typeof google.maps==="undefined")){this.showErrorMsg(true,this.noMapsMsg);}else{this.showErrorMsg(false);var Y=this.children[0];Y.idx=0;Y.unset=true;Y.options=[{v:"-1",n:""}];if((typeof google!=="undefined"&&google.maps)){if(!mstrApp.isInfoWindow){this.markerArr=[];this.bubblesMaxInfo=[];}this._mapTypeToGoogleMapTypeId=[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.TERRAIN];I();if(this.gridData){var Z=this.buildMetricSelector(),X=Z?parseInt(this.layoutConfig.h.metricSelector,10):0;this.metricSel.set("visible",Z);this.map.style.height=this.getHeight()+"px";this.map.style.width=(this.getWidth()-1)+"px";this.metricSelector.style.height=X+"px";this.metricSelector.style.display=Z?"block":"none";this.initMap();if(this.map.firstChild){this.map.firstChild.style.zIndex=1;}}}}}},gup:function H(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var Z="[\\?&]"+a+"=([^&#]*)",Y=new RegExp(Z),X=Y.exec(window.location.href);return X==null?"":X[1];},onselMetricIxChange:function(X){var a=function(e,b){for(var d in b){if(b[d].setMap){b[d].setMap(e);}}};if(this.openedInfoWindow){this.openedInfoWindow.close();}var Y=this.getMarkers(X.value),Z=this.getMarkers(X.valueWas);this.selMetricIx=X.value;a(null,Z);a(this.googleMap,Y);},buildMetricSelector:function J(){var a=this.gridData.gts.col,d=false;if(a.length>0){var b=a[0].es;if(b.length>1){var Z=[],Y=-1;T.forEach(b,function(f,e){Z[++Y]={n:f.n,v:Y,id:f.id};});var X=this.children[0];X.set("options",Z);X.set("value",0);d=true;}}return d;},initMap:function(){var Y,g=google.maps,Z=g.event,a=G.call(this)||g.MapTypeId.ROADMAP,b={mapTypeControl:true,mapTypeControlOptions:{position:g.ControlPosition.TOP_LEFT,style:g.MapTypeControlStyle.HORIZONTAL_BAR},streetViewControl:false,mapTypeId:a,navigationControlOptions:{position:g.ControlPosition.RIGHT_BOTTOM,style:g.NavigationControlStyle.ANDROID},zoomControlOptions:{style:g.ZoomControlStyle.LARGE},tilt:0};this.googleMap=Y=new g.Map(this.map,b);this.selMetricIx=this.selMetricIx;var e=this.getMarkers(this.selMetricIx);if(e.length>0){var h=this.mapBounds;if(h){Y.fitBounds(h);Y.setCenter(h.getCenter());}}else{var f=new g.LatLng(38.893444,77.221648);Y.setCenter(f);}var d=30,k=0,j=Y.getZoom(),X=setInterval(function(){j=Y.getZoom();k+=d;if(j!==undefined){if(j>20){Y.setZoom(15);}else{if(j<2){Y.setZoom(2);}}clearTimeout(X);}else{if(k>10*d){clearTimeout(X);Y.setZoom(2);}}},d);},getMarkers:function B(AY){if(!!this.markerArr[AY]){return this.markerArr[AY];}var AD=this.googleMap,AU=this.gridData,l=AU.vp,X=AU.gts,p=X.row,g=this.usePt,AX=(g?1:2),e=this.useAttributes,h=this.geoAttr,x,Y,k,w=-1,z=-1,AH=-1,j=[],s=null;for(var AN=0,AF=p.length,AO=0;AN<AF;++AN){var AS=p[AN],AA=AS.id;if(g){if(AA==this.fpt){x=Y=AS;w=z=AO;}}else{if(AA==this.flong){x=AS;w=AO;}else{if(AA==this.flat){Y=AS;z=AO;}}}for(var AT=0,AE=AS.fs.length;AT<AE;++AT){var AW=AS.fs[AT],AQ=AW.id;if(g){if(AQ==this.fpt){x=Y=AS;w=z=AO+AT;}}else{if(AQ==this.flong){x=AS;w=AO+AT;}else{if(AQ==this.flat){Y=AS;z=AO+AT;}}}if(AH<0){k=AS;AH=AO+AT;}}AO+=AE;}if(Math.min(w,z,AH)<0){throw new Error(mstrmojo.desc(8395,"Not enough data to display map."));}var AI=AU.ghs.rhs.items,Z=Math.min(AI.length,E),AM=-90,t=90,AP=-180,AB=180;for(var AR=0;AR<Z;AR++){var AL=AI[AR].items;if(AL.length<AX){continue;}var AK=x.es[AL[w].idx].n,a=parseFloat(g?S("long",AK):AK),AG=parseFloat(g?S("lat",AK):Y.es[AL[z].idx].n),q=k.es[AL[AH].idx].n,AV,AC=AU.gvs.items[AR];if(isNaN(AG)||isNaN(a)){continue;}t=(AG<t)?AG:t;AM=(AG>AM)?AG:AM;AB=(a<AB)?a:AB;AP=(a>AP)?a:AP;latLng=new google.maps.LatLng(AG,a);if(this.markerType=="2"){AV=this.getMetricBubble(AU.gvs.items[AR],q,latLng,AR,AY);}else{s="../"+this.mstyl;var b=AU.gvs.items[AR];if(b){var AJ=b.items;if(AJ){var o=AJ[AY];if(o&&(o.ts==4)&&(this.attrThresholds=="1")){s=this.getImage(o.v);}}}AV=new google.maps.Marker({position:latLng,title:q,_ix:AR,icon:s,zIndex:AR});}AV.eid=k.es[AL[AH].idx].id;AV.attrid=k.id;AV.setMap(AD);google.maps.event.addListener(AV,"click",function(f,d){return function(){f.handleMarkerClick(AD,d);};}(this,AV));j[j.length]=AV;}this.mapBounds=new google.maps.LatLngBounds(new google.maps.LatLng(t,AB),new google.maps.LatLng(AM,AP));this.markerArr[AY]=j;return j;},handleMarkerClick:function(Y,X){if(this.openedInfoWindow){this.openedInfoWindow.close();this.openedInfoWindow=null;}this.openInfoWindow(Y,X);this.postHandleMarkerClick(Y,X);},postHandleMarkerClick:mstrmojo.emptyFn,getImage:function A(Y){var Z=mstrApp,X=Z.getConfiguration();if(X&&Y&&Y.indexOf("://")===-1){Y=X.getHostUrlByProject(Z.getCurrentProjectId())+Y;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(Y)):Y;},getMetricBubble:function W(e,k,Y,h,b){var j=this.gridData,Z=j.gvs.items,q=this.bubblesMaxInfo[b],p=parseFloat(e.items[b].rv),a="red",X=Math.abs(this.maxBubbleSize-this.minBubbleSize);if(!q){for(var g in Z){var o=Z[g].items[b],l=parseFloat(o.rv)||0;if(!q){q=l;}q=Math.max(q,l);}this.bubblesMaxInfo[b]=q;}if(this.attrThresholds=="1"&&(typeof e.items[b].ty!=="undefined")){var f=e.items[b].ty;if(f==2){a=j.th[e.items[b].ti].n;}else{a="#FFF";}}return new L(k,Y,this.minBubbleSize+Math.round((p/q)*X),h,a);},openInfoWindow:function(a,Z){var Y=Z._ix,X=this.getInfoWindow(a,Z);if(X){this.openedInfoWindow=X;X.open(a,Z);}},getInfoWindow:function(Y,X){return this.getDefaultInfoWindow(this.gridData,X);},getDefaultInfoWindow:function M(f,e){var Y=e._ix,j=[],Z=f.gvs.items,g=document.createElement("div"),h='<table><tbody><tr><td colspan="2" class="androidMap-infoWindowTitle" style="padding-right: 20px">'+e.title+"</td></tr>";if(f.gts.col.length!=0){j=f.gts.col[0].es;}for(var b in j){var k=Z[Y].items[b];if(k.ts==4){var l=k.v;if(l.indexOf("http")!==0){l="../"+l;}h+='<tr><td class="androidMap-infoWindowText">'+j[b].n+'</td><td><img src="'+l+'"></td></tr>';}else{var a="black",X="white";if(f.th&&this.attrThresholds=="1"&&(typeof k.ti!=="undefined")){a=f.th[k.ti].n;}h+='<tr><td class="androidMap-infoWindowText">'+j[b].n+'</td><td style="background-color:'+X+";color:"+a+';">'+k.v+"</td></tr>";}}h+="</tbody></table>";g.innerHTML=h;return new google.maps.InfoWindow({content:g});},touchBegin:function(X){X.stop();return false;},rebuildLayout:mstrmojo.emptyFn,setDimensions:function P(a,Z){var b=this.googleMap,X=b?b.getCenter():null,Y=this._super(a,Z);if(b){this.map.style.height=this.getHeight()+"px";this.map.style.width=(this.getWidth()-1)+"px";b.setCenter(X);}return Y;},unrender:function Q(X){if(this.googleMap){delete this.googleMap;}this._super(X);},destroy:function V(){if(this.googleMap){delete this.googleMap;}this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo._HasTouchScroller","mstrmojo.css");var L=mstrmojo.css;var N=15;function K(R){var Q=mstrmojo.dom.findAncestorByAttr(R.target,"clk",true,this.domNode);return Q||null;}function J(){var R=this._scroller;var T=this.timeSelectorListContainer.width;var Q=this.timeSelectorList.offsetWidth;if(Q>T){this.scrollPast=true;}var U=Q>T?Q-T:0;R.origin={x:0,y:0};R.showScrollbars=true;R.noHScroll=false;R.hScroll=(U!==0&&R.noHScroll!==true)||this.scrollPast;if(R.hScroll){R.offset={x:{start:0,end:U},scrollPast:this.scrollPast};}var S=this.timeSelectorList;this.widget.utils.translateCSS(0,0,false,S);}mstrmojo.VisTimeSeriesTimeSelector=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisTimeSeriesTimeSelector",scrollerConfig:{bounces:false,showScrollbars:true,useTranslate3d:true},scrollPast:false,isAndroidTab:false,offsetx:0,widget:null,markupString:'<div id="{@id}-TimeSelector-Container" class="mstrmojo-timeseries-timeselector-div" style="position:absolute; left:{@offsetx}px; overflow:hidden;"><div id="{@id}-TimeSelector-List" style="position:absolute;left:0;top:0"></div></div>',markupSlots:{timeSelectorListContainer:function(){return this.domNode;},timeSelectorList:function(){return this.domNode.firstChild;}},toggleSelected:function C(U,T){if(!U){return ;}var S=U.style;var V=this.widget;var R=V.utils.rgb2rgbStr(V.formatProp.textClr);var Q=V.utils.rgb2rgbStr(V.formatProp.backgroundClr);if(T){S.backgroundColor=R;S.color=Q;}else{S.backgroundColor="";S.color=R;}},toggleGlowEffect:function B(Q,R){if(!Q){return ;}if(R){L.applyShadow(Q,0,0,20,this.widget.glowColor);}else{L.removeShadow(Q);}},drawTimeSelectorLabels:function H(){var V=this.widget.baseModel.vp.rl;var b=this.chartStatus;if(V){var Y=this.widget,W=Y.margin,e=Y.utils,R=Y.getWidth(),U=0;this.timeSelectorListContainer.width=R-W.l-W.r;this.timeSelectorListContainer.style.width=(R-W.l-W.r)+"px";this.timeSelectorListContainer.style.height=W.t+"px";var X=V.length;var a=(R-W.l-W.r)/(X+1);var Q=Y.id,S=this.timeSelectorList;if(S.childNodes.length==0){Y.currSelection=null;for(var T=0;T<X;T++){var Z=document.createElement("div");Z.id="timeseries-intervals";Z.className="timeseries-intervals";Z.style.fontWeight="bold";Z.style.fontFamily="Arial";Z.style.fontSize=N+"px";Z.innerHTML=V[T].n;Z.setAttribute("clk","S");Z.setAttribute("value",T);Z.style.position="relative";Z.style.whiteSpace="nowrap";Z.style.cssFloat="left";if(T===0&&b.currSelectionIdx==-1&&!b.usingCustomInterval){this.toggleSelected(Z,true);Y.currSelection=Z;}else{if(!b.usingCustomInterval&&b.currSelectionIdx==T){this.toggleSelected(Z,true);Y.currSelection=Z;}else{this.toggleSelected(Z,false);}}S.appendChild(Z);offsetWidth=Z.offsetWidth;U+=offsetWidth;spaceWidth=offsetWidth<a?a-offsetWidth:20;U+=spaceWidth;if(T==0){S.insertBefore(this.createWhiteSpace(spaceWidth),S.firstChild);U+=spaceWidth;}S.appendChild(this.createWhiteSpace(spaceWidth));}}else{var g=S.childNodes;var f=g.length;for(var T=0;T<f;T++){var Z=g[T];offsetWidth=Z.offsetWidth;U+=offsetWidth;if(T==0){continue;}spaceWidth=offsetWidth<a?a-offsetWidth:20;U+=spaceWidth;if(T==1){g[0].style.paddingLeft=spaceWidth+"px";}T++;g[T].style.paddingLeft=spaceWidth+"px";}}this.timeSelectorList.style.width=U+"px";}},postBuildRendering:function E(){N=Math.round(15*this.widget.utils.getScreenZoomFactor());this.scrollerConfig.scrollEl=this.timeSelectorList;if(this._super){this._super();}this.drawTimeSelectorLabels();J.call(this);},reRender:function I(){this.drawTimeSelectorLabels();J.call(this);},createWhiteSpace:function F(R){var Q=document.createElement("div");Q.style.height="30px";Q.style.position="relative";Q.style.whiteSpace="nowrap";Q.style.cssFloat="left";Q.style.paddingLeft=R+"px";return Q;},initScroller:function M(Q){Q.hScroll=true;this._super(Q);},touchBegin:function D(Q){this.widget.hiddenTooltipAndShowTimeSelector();},touchSelectEnd:function P(R){var Q=this.widget.currSelection;if(Q){this.toggleGlowEffect(Q,false);}},touchSelectBegin:function G(S){var Q=K.call(this,S);if(Q){var R=Q.value;if(R==="S"){this.widget.timeSelectorOnClick(Q);}}},touchTap:function A(S){var Q=K.call(this,S);if(Q){var R=Q.value;if(R==="S"){this.widget.timeSelectorOnClick(Q);}}this.toggleGlowEffect(this.widget.currSelection,false);},destroy:function O(){if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis");var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;mstrmojo.VisMicroChartBullet=mstrmojo.declare(mstrmojo.Vis,null,{scriptClass:"mstrmojo.VisMicroChartBullet",isDrawAxis:false,margin:{t:0,r:5,b:0,l:5},showHighlightLine:false,themeColor:"#FFFFFF",noBackground:true,isAnimateLines:false,toolTipMain:null,mainWidth:0,mainLeftPos:0,showMinLabel:false,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};position:relative;"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@height}"></canvas><div style="position:absolute;left:0px;bottom:0px;display:none;font:7px Arial;text-align:left;line-height:7px;"></div><div style="width:100%;height:{@height};top:0px;left:0px;position:absolute;display:none;font:10pt Arial;overflow: hidden; text-overflow: ellipsis; white-space:nowrap"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},minLabel:function(){return this.domNode.childNodes[1];},errorMsg:function(){return this.domNode.childNodes[2];}},postBuildRendering:function postBR(){if(this._super){this._super();}this.browserSupportsHtml5=this.canvas.getContext;if(!this.browserSupportsHtml5){this.renderErrorMessage(mstrmojo.desc(8126,"Your browser does not support HTML5"));return ;}if(!this.model){this.renderErrorMessage(mstrmojo.desc(8426,"No model provided"));return ;}if(this.model.err||this.model.eg){this.renderErrorMessage(this.model.err||this.model.eg);return ;}this.context=this.canvas.getContext("2d");this.setColorByTheme();this.drawChart();},setColorByTheme:function setColorByTheme(){var bulletProps=this.config;var dpi=mstrMobileApp&&mstrMobileApp.getDeviceDPI()||160;if(this.theme==DEFAULT_DARK_THEME){this.bandColor1="#494949";this.bandColor2="#595959";this.bandColor3="#727272";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=dpi>=160?2:1;this.blueBarPosColor="#00BDFF";this.blueBarNegColor=bulletProps.mwNegCol;}else{if(this.theme==DEFAULT_LIGHT_THEME){this.bandColor1="#A5A5A5";this.bandColor2="#B3B3B3";this.bandColor3="#C4C4C4";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=dpi>=160?2:1;this.blueBarPosColor="#00BDFF";this.blueBarNegColor=bulletProps.mwNegCol;}else{this.bandColor1=bulletProps.mwBand1||"#999999";this.bandColor2=bulletProps.mwBand2||"#BBBBBB";this.bandColor3=bulletProps.mwBand3||"#DEDEDE";this.refLinePosColor=bulletProps.mwRefLineCol;this.refLineNegColor=bulletProps.mwRefLineCol;this.blueBarPosColor=bulletProps.mwPosCol;this.blueBarNegColor=bulletProps.mwNegCol;}}},showTooltip:function shwttp(touchX,touchY){if(!this.config.mbShowTooltip){return false;}var minValue=this.config.mfMinValue;var refV=this.refv;var mc3=refV[2].rv-minValue;var mc4=refV[3].rv-minValue;var ttp=this.toolTipMain;var model=this.model;var metrics=model.mtrcs.items;var bulletProps=this.config;var ofht=17;var line1;if(
/*this.widget.isKPI &&*/
this.widget.bulletProps.mstrAssMetric){line1=this.widget.bulletProps.mstrAssMetric+": "+refV[2].v;}else{line1=metrics[2]+": "+refV[2].v;}var maxWidth=this.widget.getTextWidthByCanvas(line1,ttp);if(bulletProps.mbRefLine){line1='<div style="margin-left:5px;margin-top:5px;"><div style="float:left;margin-right:5px;margin-top:2px;width:12px;height:10px;background-color:'+this.targetColor+';"></div><div style="float:left;text-align:top;">'+line1+"</div></div>";}else{line1='<div style="margin-left:5px;margin-top:5px;margin-bottom:5px;"><div style="float:left;margin-right:5px;margin-top:2px;width:12px;height:10px;background-color:'+this.targetColor+';"></div><div style="float:left;text-align:top;">'+line1+"</div></div>";}if(bulletProps.mbRefLine){ofht+=17;var line2=metrics[6]+": "+refV[6].v;var line2Width=this.widget.getTextWidthByCanvas(line2,ttp);if(line2Width>maxWidth){maxWidth=line2Width;}line2='<div style="margin-left:5px;margin-bottom:5px;"><div style="float:left;margin-left:5px;margin-top:2px;margin-right:10px;width:2px;height:10px;background-color:'+this.refLineColor+';"></div><div style="float:left;">'+line2+"</div></div>";line1+="<br/>"+line2;}ofht+=10;if(this.tooltipErrMsg){ttp.innerHTML=this.tooltipErrMsg;}else{ttp.innerHTML=line1;}var pos=mstrmojo.dom.position(this.domNode,true);var posWdt=mstrmojo.dom.position(this.widget._leftChart.domNode,true);maxWidth+=28;ttp.style.display="block";ttp.style.borderColor=this.targetColor;ttp.style.width=maxWidth+"px";var tpof=0;if((this.getHeight()-ofht)%2==0){tpof=(pos.y-posWdt.y+(this.getHeight()-ofht)/2);}else{tpof=(pos.y-posWdt.y+(this.getHeight()-ofht-1)/2);}if(tpof<0){tpof=0;}if(tpof+ofht>this.widget.getHeight()){tpof=this.widget.getHeight()-ofht-5;}ttp.style.top=tpof+"px";var ttpLeft=0;if(pos.x+pos.w/2>(posWdt.x+posWdt.w/2)){ttpLeft=pos.x-posWdt.x-maxWidth-10;}else{ttpLeft=pos.x-posWdt.x+pos.w+10;}if(ttpLeft<0){ttpLeft=0;}ttp.style.left=ttpLeft+"px";return true;},drawChart:function drwchrt(){var bulletProps=this.config;var minValue=bulletProps.mfMinValue;var refV=this.refv;var mc3,mc4,mc5,mc6,mc7;var mMc3,mMc4,mMc5,mMc6,mMc7;mMc3=parseFloat(refV[2].rv);mMc4=parseFloat(refV[3].rv);mMc5=parseFloat(refV[4].rv);mMc6=parseFloat(refV[5].rv);mMc7=parseFloat(refV[6].rv);mc3=mMc3-minValue;mc4=mMc4-minValue;mc5=mMc5-minValue;mc6=mMc6-minValue;mc7=mMc7-minValue;var isInverted=bulletProps.mbInvertAxis;var hasRefLine=bulletProps.mbRefLine;var hasRefBands=bulletProps.mbRefBands;var mShowTooltip=bulletProps.mbShowTooltip;var ctx=this.context;var ratioBetweenMetricViewWidth;var bulletHeight;var minLabelHeight=7,minLabelWidth;var xPadding=0,yPadding=5;if(isNaN(mc3)||isNaN(mc4)||isNaN(mc5)||isNaN(mc6)){var err=mstrmojo.desc(10860,"Insufficient data to plot the graph");this.errorMsg.innerHTML=err;this.errorMsg.style.display="block";this.minLabel.style.display="none";this.tooltipErrMsg=err;return ;}else{if(mc3*mc4>0&&Math.abs(mc3)>Math.abs(mc4)){var err=mstrmojo.desc(10381,"Metric of Butllet is out of the max graph range");this.errorMsg.innerHTML=err;this.errorMsg.style.display="block";this.minLabel.style.display="none";this.tooltipErrMsg=err;return ;}else{this.errorMsg.style.display="none";this.tooltipErrMsg=null;}}var xOri;var redComp,greenComp,blueComp;var mcOriX,mcOriY;var mcHeight,mcWidth;if(mc3<0&&mc4>0){ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/(mc4-mc3);xOri=xPadding-mc3*ratioBetweenMetricViewWidth;bulletHeight=this.getHeight()-minLabelHeight-2*yPadding-2;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6>mc3&&mc6<mc4){mcWidth=(mc6-mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor2;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5>mc3&&mc5<mc4){mcWidth=(mc5-mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor1;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=Math.abs(mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7>mc3&&mc7<mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+mc7*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}else{if(mc3<0&&mc4<0){ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/(Math.abs(mc4));xOri=xPadding;bulletHeight=this.getHeight()-minLabelHeight-2*yPadding-2;isInverted=!isInverted;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6<0&&mc6>mc4){mcWidth=Math.abs(mc6)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor2;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5<0&&mc5>mc4){mcWidth=Math.abs(mc5)*ratioBetweenMetricViewWidth;mcOriX=xPadding;ctx.fillStyle=this.bandColor1;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=Math.abs(mc3)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7<0&&mc7>mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+Math.abs(mc7)*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;mcOriX=this.getWidth()-mcOriX-mcWidth;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}else{if(mc3>0&&mc4>0){if(this.showMinLabel){yPadding=9.5;}else{yPadding=5;}ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/mc4;xOri=xPadding;bulletHeight=this.getHeight()-2*yPadding;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6>0&&mc6<mc4){mcWidth=mc6*ratioBetweenMetricViewWidth;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle=this.bandColor2;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5>0&&mc5<mc4){mcWidth=mc5*ratioBetweenMetricViewWidth;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle=this.bandColor1;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=mc3*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7>0&&mc7<mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+mc7*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}else{ratioBetweenMetricViewWidth=(this.getWidth()-2*xPadding)/(mc3-mc4);bulletHeight=this.getHeight()-minLabelHeight-2*yPadding-2;xOri=xPadding-mc4*ratioBetweenMetricViewWidth;isInverted=!isInverted;if(hasRefBands){mcHeight=bulletHeight;mcWidth=this.getWidth()-2*xPadding;mcOriX=xPadding;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.bandColor3;this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(mc6<mc3&&mc6>mc4){mcWidth=(mc3-mc6)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriX=this.getWidth()-mcOriX-mcWidth;ctx.fillStyle=this.bandColor2;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}if(mc5<mc3&&mc5>mc4){mcWidth=(mc3-mc5)*ratioBetweenMetricViewWidth;mcOriX=xPadding;mcOriX=this.getWidth()-mcOriX-mcWidth;ctx.fillStyle=this.bandColor1;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}mcHeight=bulletHeight/2;mcWidth=Math.abs(mc3)*ratioBetweenMetricViewWidth;mcOriX=xOri;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.targetColor=mMc3>=0?this.blueBarPosColor:this.blueBarNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);if(hasRefLine&&mc7<mc3&&mc7>mc4){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri+mc7*ratioBetweenMetricViewWidth;mcOriY=(bulletHeight)/2-mcHeight/2+yPadding;ctx.fillStyle=this.refLineColor=mMc3>=0?this.refLinePosColor:this.refLineNegColor;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);}}}}if(mc3<0){mcHeight=bulletHeight;mcWidth=2;mcOriX=xOri;mcOriY=yPadding;redComp=0;greenComp=0;blueComp=0;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}ctx.fillStyle="#000000";this.drawRect(ctx,mcOriX,mcOriY,mcWidth,mcHeight);minValue=minValue+"";var disPlayValue=(minValue=="0")?"":"$";var mlen=0;for(var i=0;i<minValue.length;i++){if(minValue[i]=="."){break;}mlen++;}for(var i=0;i<minValue.length;i++){disPlayValue+=minValue[i];mlen--;if(mlen%3==0&&mlen>0){disPlayValue+=",";}}minValue=disPlayValue;var textWidth=this.widget.getTextWidthByCanvas(minValue,this.minLabel);minLabelWidth=textWidth-1;mcOriX=xOri;if(isInverted){mcOriX=this.getWidth()-mcOriX-mcWidth;}if(mcOriX-minLabelWidth/2<=xPadding){this.minLabel.style.paddingLeft=xPadding;}else{if(mcOriX+minLabelWidth/2<=this.getWidth()-xPadding){this.minLabel.style.paddingLeft=Math.round(mcOriX-minLabelWidth/2)+"px";}else{this.minLabel.style.paddingLeft=Math.round((this.getWidth()-xPadding-minLabelWidth))+"px";}}this.minLabel.style.bottom=yPadding+"px";this.minLabel.style.fontSize="7pt";if(this.labelColorRGB){this.minLabel.style.color="rgb("+this.labelColorRGB[0]+","+this.labelColorRGB[1]+","+this.labelColorRGB[2]+")";}else{this.minLabel.style.color="";}this.minLabel.innerHTML=minValue;this.minLabel.style.display="block";}else{this.minLabel.style.display="none";}},convertColor:function convrtClr(ngv){var ret="#";var base=parseInt("0xff");var blueComp=ngv&base;base=parseInt("0xff00");var greenComp=((ngv&base)>>8);base=parseInt("0xff0000");var redComp=((ngv&base)>>16);var redP=redComp.toString(16);if(redP.length<2){redP="0"+redP;}var greenP=greenComp.toString(16);if(greenP.length<2){greenP="0"+greenP;}var blueP=blueComp.toString(16);if(blueP.length<2){blueP="0"+blueP;}ret+=redP;ret+=greenP;ret+=blueP;return ret;},drawRect:function(ctx,x,y,width,height){x=Math.round(x);y=Math.round(y);width=Math.round(width);height=Math.round(height);ctx.fillRect(x,y,width,height);},reDrawChart:function reDrwchart(){var context=this.context,canvas=this.canvas,wd=canvas.width,ht=canvas.height;context.clearRect(0,0,wd,ht);this.postBuildRendering();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.url","mstrmojo._TouchGestures","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Image","mstrmojo._HasTouchScroller");var B=Math,K=mstrmojo.css,H=mstrmojo.dom,Q=30,D=50,E=32;function P(T){var U="container"+T;if(!this[U]){var S=this.domNode,R=parseInt(this[T.toLowerCase()],10);this[U]=(isNaN(R))?S["client"+T]:R;}return this[U];}function J(R){var S,T="";if(R>0){for(S=0;S<R;S++){T+='<col style="width:'+(100/R)+'%" />';}}return"<colgroup>"+T+"</colgroup>";}function C(R){return mstrmojo.url.getAbsoluteURL(R,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());}function O(S,R){S.style[H.CSS3_TRANSITION_DURATION]="500ms";H.translate(S,R,0,0,"",true);}function L(Y,R,V){if(!Y){return ;}var U=Y.clientWidth,W=Y.clientHeight,X,T,S=false;if(R<U||V<W){S=true;X=R/U;T=V/W;if(X<T){Y.width=R;}else{Y.height=V;}}return S;}function I(V){var Y=[],S,X,T,W,Z,R=V.getTotalRows(),U=R>0?V.getRowTitles().size():0;for(S=0;S<R;S++){W=V.getRowHeaders(S);for(X=0;X<U;X++){if(!Y[X]){Y[X]=[];}Z=W.getHeader(X);Y[X].push({n:Z.getName()});}}return Y;}mstrmojo.ImageCarousel=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.ImageCarousel",markupString:'<div class="mstrmojo-ImageCarousel {@cssClass}" style="overflow:hidden;{@cssText}"><div class="imageViewer" mstrAttach:click>{@noImageMsg}</div><div class="imageTitle"></div><div class="statusBar" style="overflow:hidden"></div></div>',markupSlots:{viewerNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.childNodes[1];},statusBarNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW"]},scrollerConfig:{friction:0.0087,bounces:false,vScroll:false,hScroll:true},selected:-1,children:[{scriptClass:"mstrmojo.HBox",slot:"viewerNode",alias:"viewer",onitemsChange:function(){var Y,V,W,X=[],S=this.parent.vp,Z;Y=this.items;if(!this.hasRendered){var T=this.parent,U=P.call(T,"Width"),R=P.call(T,"Height");if(this.children){this.removeChildren();}W=Y.length;this.colHTML=J(W);this.cssText="width:"+(U*W)+"px;height:"+(R-D)+"px";Z=(S&&S.bw)?("border:"+S.bw+"px solid #"+(S.bc||"FFF")):"";for(V=0;V<W;V++){X.push({scriptClass:"mstrmojo.Image",cssText:Z,cssDisplay:"inline-block",src:C(Y[V].n||Y[V].v),onload:function(){L(this.imgNode,U-Q,R-D);}});}this.addChildren(X);}}},{scriptClass:"mstrmojo.Label",slot:"textNode",alias:"description"},{scriptClass:"mstrmojo.HBox",slot:"statusBarNode",alias:"sb",onitemsChange:function(){var S=this.items,U=[],T,R;if(this.children){this.removeChildren();delete this.numVisibleDots;this.lastSelected=-1;}for(T=0,R=S.length;T<R;T++){U.push({scriptClass:"mstrmojo.Label"});}this.addChildren(U);},lastSelected:0,select:function(R){var U,V,S=this.domNode,T=this.numVisibleDots;if(this.selectedNode){K.removeClass(this.selectedNode.domNode,"selected");}if(this.items.length>0){this.selectedNode=this.children[R];K.addClass(this.selectedNode.domNode,"selected");if(!T){T=this.numVisibleDots=B.floor(P.call(this.parent,"Width")/E);if(this.items.length<T){K.addClass(S,"center");}else{K.removeClass(S,"center");}}U=B.floor(this.lastSelected/this.numVisibleDots);V=B.floor(R/this.numVisibleDots);if(U!==V){O(S,-V*T*E);}this.lastSelected=R;}}}],updateScrollerConfig:function G(){var R=this.viewer.items.length;mstrmojo.hash.copy({scrollEl:this.viewerNode,origin:{x:0,y:0},offset:{x:{start:0,end:((R>0)?(R-1):0)*P.call(this,"Width")}}},this.scrollerConfig);return this._super();},touchSwipeEnd:function N(T){var S=T.delta,R=this.viewer.items.length;if(S&&S.x>0){this.set("selected",Math.max(0,this.selected-1));}else{if(S&&S.x<0){this.set("selected",Math.min(this.selected+1,R));}}},onclick:function(S){var R;if(mstrApp.getScreenDimensions&&this.selectedImage){R={cssClass:"image-FullScreen",onclick:function(){this.close();},resizeDialog:function(){var V=mstrApp.getScreenDimensions(),T=this.domNode,U=T&&T.style;if(V&&U){U.width=V.w+"px";U.height=V.h+"px";}},children:[{scriptClass:"mstrmojo.Image",src:this.selectedImage,onload:function(){var T=mstrApp.getScreenDimensions();if(T){L(this.imgNode,T.w,T.h);this.parent.positionDialog();}}}]};mstrApp.showDialog(R);}},touchTap:function(R){this.onclick(R);},preBuildRendering:function M(){var U=this.getDataParser(),S=I(U),T,R;if(!this.vp){this.vp=this.model.vp;}T=S[0]||[];R=S[1]||[];this.viewer.set("items",T);this.sb.set("items",R);this.selected=-1;if(T.length>0){this.cssClass=this.cssClass?"":this.cssClass.replace(/noImage/,"");this.noImageMsg="";}else{this.cssClass+=this.cssClass?"":" noImage";this.noImageMsg="No Photo Found";}if(this.vp&&this.vp.bgc){this.cssText="background-color:#"+this.vp.bgc+";";}this._super();},postBuildRendering:function A(){this._super();this.set("selected",0);},onselectedChange:function F(){var R=this.selected,T=this.sb,S=this.viewer.items[R],U=T.items[R];if(S){this._scroller.scrollTo(R*P.call(this,"Width"),0,500);this.selectedImage=C((S&&S.n)||"");T.select(R);this.description.set("text",(U&&U.n)||"");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.VisChartUtils","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.color","mstrmojo.array","mstrmojo.css");var Ax=true;var Bh="0",T="1",A7="2";var Aj=0,AH=1,AF=2;var l=0,An=1,AQ=2;var b=0,AO=1,BZ=2;var AA=0,t=1;var o=1,W=0.01;var V=0.3,G=0.3,D=0.3;var h=0,A2=1,AS=2;var Ah=0,s=1;var j=1,AY=2,BP=4;var AU=1,BC=2;var Ac="#FFFFFF";var Ao="RGBA(139,139,139,0.8)",Aq="RGBA(33,195,255,0.8)",A3="RGBA(195,195,195,0.8)",A5="RGBA(112,168,207,0.8)",Av="#4C4C4C",AR="#FFFFFF",Bd=0.8,AK=0.7,w=1,p=0.5,H=0.5,BQ=1,BD=0.7,Ap=0.5,AD=0.7,BM=1,BH="#FFFFFF",J="#000000",AB="#FFFFFF",Am="#000000",U="#FFFFFF",BA="#000000",As="RGBA(0,0,0,0)",Aa="RGBA(0,0,0,0)",At="RGBA(33,195,255,0.8)",e="RGBA(31,119,180,0.8)",X="RGBA(129,129,129,0.8)",Be="RGBA(129,129,129,0.8)",Aw=0.8,AG=0.5,g=1,A4=0.8,AL="RGBA(129,129,129,0.8)",BL="RGBA(129,129,129,0.8)",AW="RGBA(129,129,129,0.8)",S="RGBA(129,129,129,0.8)",BN="RGBA(255,255,255,0.8)",BW="RGBA(0,0,0,0.8)",Bc="#FFFFFF",Ak="#000000";var Y="#FFF",C="#000";var BK=300;function N(Bj){var Bi;for(Bi in Bj){if(Bj.hasOwnProperty(Bi)){return false;}}return true;}function BF(Bj){var Bi=mstrmojo.color.hex2rgb(Bj);mstrmojo.array.forEach(Bi,function(Bl,Bk){Bi[Bk]=Math.floor(Bl*0.75);});return"rgb("+Bi.join(",")+")";}function BT(Bm,Bj,Bi){var Bl=Bm.style,Bn="translate("+Bj+"px, "+Bi+"px)",Bk=Bn.replace("late(","late3d(").replace("px)","px, 0)");Bl.MozTransform=Bn;Bl.msTransform=Bn;Bl.webkitTransform=Bk;Bl.transform=Bk;}function P(Bk,Bu,Bt){var Bq=Bk.length,Bn=false,Bm,Bi,Bv,Bp,Bl,Bs,Bj,Br,Bo;if(Bq/2<3){return false;}Bv=Bk[Bq-2];Bp=Bk[Bq-1];for(Bo=0;Bo<Bq;Bo=Bo+2){Bm=Bk[Bo];Bi=Bk[Bo+1];if(Bm>Bv){Bl=Bv;Bj=Bm;Bs=Bp;Br=Bi;}else{Bl=Bm;Bj=Bv;Bs=Bi;Br=Bp;}if((Bm<Bu)===(Bu<=Bv)&&((Bt-Bs)*(Bj-Bl)<(Br-Bs)*(Bu-Bl))){Bn=!Bn;}Bv=Bm;Bp=Bi;}return Bn;}function AT(Bu,Bs,Bk,Bt,Bq,Bj){try{var Bz=Bk?Bk.x:0,Bx=Bk?Bk.y:0;var Bi=function(B0){var B1=B0%2?Bx:Bz;return Bp[B0]+B1;};var Bw,Bv;for(Bw=0;Bw<Bs.length;Bw++){var Bp=Bs[Bw];Bu.beginPath();Bu.moveTo(Bi(0),Bi(1));for(Bv=2;Bv<Bp.length-1;Bv=Bv+2){var Bm=Bi(Bv),Br=Bi(Bv+1);Bu.lineTo(Bm,Br);}var Bo=Bi(0),Bn=Bi(1),Bl=Bj;Bu.lineTo(Bo,Bn);Bu.fillStyle=Bl;Bu.fill();Bu.strokeStyle=Bt;Bu.lineWidth=Bq;Bu.stroke();}}catch(By){}}function L(Bk,Bl,Bm,Bj,Bi){Bk.fillStyle=Bj;Bk.beginPath();Bk.arc(Bl[0]+Bm.x,Bl[1]+Bm.y,Bi,0,Math.PI*2,true);Bk.closePath();Bk.fill();}function R(Bk,Bl,Bm,Bj,Bi,Bn){Bk.strokeStyle=Bj;Bk.lineWidth=Bn;Bk.beginPath();Bk.arc(Bl[0]+Bm.x,Bl[1]+Bm.y,Bi,0,Math.PI*2,true);Bk.closePath();Bk.stroke();}function AJ(Bj){if(Bj){var Bi;for(Bi in Bj){if(Bj.hasOwnProperty(Bi)){if(Bi==="bgImage"){continue;}if(Bj[Bi][0]){if(Bj[Bi][0].length===2){return AQ;}else{if(Bj[Bi][0].length>2){return An;}else{return l;}}}else{return l;}}}}else{return l;}}function z(Bn){var Bm=0,Bl=0;i;for(i=0;i<Bn.length;i++){Bm=Bm+Bn[i];i++;Bl=Bl+Bn[i];}var Bk=Bm/(Bn.length/2),Bj=Bl/(Bn.length/2),Bi=[Bk,Bj];center2=[];center2.push(Bi);return center2;}function BG(Br){if(Br==null||Br.length<4){return null;}var Bi=0,Bl=Br.length,Bk,Bq,Bp,Bo,Bn;for(Bk=0;Bk<Bl-2;Bk+=2){Bq=Br[Bk];Bp=Br[Bk+1];Bo=Br[Bk+2];Bn=Br[Bk+3];Bi+=(Bq*Bn-Bo*Bp);}Bq=Br[Bl-2];Bp=Br[Bl-1];Bo=Br[0];Bn=Br[1];Bi+=(Bq*Bn-Bo*Bp);Bi=Math.abs(Bi/2);if(Bi<=0){return null;}var Bj=[0,0];for(Bk=0;Bk<Bl-2;Bk+=2){Bq=Br[Bk];Bp=Br[Bk+1];Bo=Br[Bk+2];Bn=Br[Bk+3];Bj[0]+=((Bq+Bo)*(Bq*Bn-Bo*Bp));Bj[1]+=((Bp+Bn)*(Bq*Bn-Bo*Bp));}Bq=Br[Bl-2];Bp=Br[Bl-1];Bo=Br[0];Bn=Br[1];Bj[0]+=((Bq+Bo)*(Bq*Bn-Bo*Bp));Bj[1]+=((Bp+Bn)*(Bq*Bn-Bo*Bp));Bj=[Math.abs(Bj[0]/(Bi*6)),Math.abs(Bj[1]/(Bi*6))];var Bm=[];Bm.push(Bj);return Bm;}function BY(Bk,Bl){var Bo,Bm;var Bn=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(Bk){var Bj;if(/^(rgba|RGBA)/.test(Bk)){var Bi=Bk.replace(/rgba\(|RGBA\(/,"");Bi=Bi.replace(")","");Bj=Bi.split(",");Bo="RGBA("+Bj[0]+","+Bj[1]+","+Bj[2]+","+Bl+")";return Bo;}else{if(/^(rgb|RGB)/.test(Bk)){Bj=Bk.replace(/rgb\(|RGB\(/,"");Bj=Bj.replace(")","");Bo="RGBA("+Bj+","+Bl+")";return Bo;}else{if(Bn.test(Bk)){if(Bk.length===4){Bj="#";for(Bm=1;Bm<4;Bm++){Bj+=Bk.slice(Bm,Bm+1).concat(Bk.slice(Bm,Bm+1));}Bk=Bj;}var Bp=[];for(Bm=1;Bm<7;Bm+=2){Bp.push(parseInt("0x"+Bk.slice(Bm,Bm+2)));}Bp.push(Bl);Bo="RGBA("+Bp.join(",")+")";return Bo;}else{return Bk;}}}}else{return null;}}function AP(Bl){var Bj=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,Bm,Bi,Bn,Bq,Bp;if(Bl){var Br,Bo;if(/^(rgba|RGBA)/.test(Bl)){Bo=Bl.replace(/rgba\(|RGBA\(/,"");Bo=Bo.replace(")","");Br=Bo.split(",");Bi=Br[0];Bn=Br[1];Bq=Br[2];}else{if(/^(rgb|RGB)/.test(Bl)){Bo=Bl.replace(/rgb\(|RGB\(/,"");Bo=Bo.replace(")","");Br=Bo.split(",");Bi=Br[0];Bn=Br[1];Bq=Br[2];}else{if(Bj.test(Bl)){if(Bl.length===4){Br="#";for(Bm=1;Bm<4;Bm++){Br+=Bl.slice(Bm,Bm+1).concat(Bl.slice(Bm,Bm+1));}Bl=Br;}var Bk=[];for(Bm=1;Bm<7;Bm+=2){Bk.push(parseInt("0x"+Bl.slice(Bm,Bm+2)));}Bi=Bk[0];Bn=Bk[1];Bq=Bk[2];}else{return Ah;}}}Bp=(Bi*299+Bn*587+Bq*114)/1000;if(Bp>150){return s;}else{return Ah;}}else{return Ah;}}function Ba(Bj,Bl,Bm,Bk,Bi){Bj.strokeStyle="#FFF";Bj.lineWidth=2;Bj.beginPath();Bj.moveTo(Bl+Bk*0.25,Bm);Bj.lineTo(Bl,Bm);Bj.lineTo(Bl,Bm+Bi*0.25);Bj.moveTo(Bl,Bm+Bi*0.75);Bj.lineTo(Bl,Bm+Bi);Bj.lineTo(Bl+Bk*0.25,Bm+Bi);Bj.moveTo(Bl+Bk*0.75,Bm+Bi);Bj.lineTo(Bl+Bk,Bm+Bi);Bj.lineTo(Bl+Bk,Bm+Bi*0.75);Bj.moveTo(Bl+Bk,Bm+Bi*0.25);Bj.lineTo(Bl+Bk,Bm);Bj.lineTo(Bl+Bk*0.75,Bm);Bj.stroke();Bj.closePath();}mstrmojo.AndroidVisMap=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.AndroidVisMap",model:null,utils:mstrmojo.VisChartUtils,scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:true,vScroll:true,hScroll:true,offset:{y:{start:0,end:0},x:{start:0,end:0}},origin:{x:0,y:0}},relScaleFactor:1,scaleFactor:1,currSelectedObj:null,defaultSelectedObjs:{},currHoverObj:null,currLinkObj:null,tooltipOn:false,context:null,multiTap:true,multiTouch:true,browserSupportsHtml5:true,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};z-index:{@zIndex};position:absolute;{@cssText};overflow:hidden;"  mstrAttach:mouseover,mousemove ><div id="{@id}"-scroll-element style="position:absolute;left:0;top:0;width:{@width};height={@height}"><canvas id="{@id}-highlightCanvas" style="position:absolute;left:0;top:0;z-index:100" width="{@width}" height="{@height}"></canvas><canvas id="{@id}-animationCanvas" style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas></div><div id="{@id}-tooltip" style="z-index:200" class="mstrmojo-ImageLayout-tooltip" clk="clk"><table style="margin:5px 7px"></table></div><div id="{@id}-infowindow-anchor" style="position:absolute;width:18px;height:18px;display:block"></div><div id="{@id}-css" style="display:none"></div><div id="{@id}-errMsg" align="center" style="position:absolute; z-index:300; top:35%; word-wrap:break-word;"></div></div>',markupSlots:{scrollableCanvasDiv:function(){return this.domNode.childNodes[0];},highlightCanvas:function(){return this.domNode.childNodes[0].firstChild;},animationCanvas:function(){return this.domNode.childNodes[0].lastChild;},tooltip:function(){return this.domNode.childNodes[1];},infowindowAnchor:function(){return this.domNode.childNodes[2];},cssDiv:function(){return this.domNode.childNodes[3];},errorMessage:function(){return this.domNode.childNodes[4];}},postBuildRendering:function Bg(){var Bm=this;Bm.setFontByDPI();Ax=Bm.highlightCanvas.getContext;if(!Ax){Bm.renderErrorMessage(mstrmojo.desc(8126,"Your browser does not support HTML5"));return ;}if(Bm.model.hasOwnProperty("eg")){var Bk=Bm.model.eg,Bp="The Image Layout requires:";if(Bk.match(Bp)){Bm.renderErrorMessage(mstrmojo.desc(9853,Bk));}else{Bm.renderErrorMessage(Bk);}return ;}Bm.newRenderFlag=true;Bm.attrIndices=Bm.getAttrIndices();Bm.createTooltipTable();Bm.getDefaultSelectedObjs();Bm.highlightContext=Bm.highlightCanvas.getContext("2d");Bm.animationContext=Bm.animationCanvas.getContext("2d");var Bq=Bm.scrollerConfig;Bq.scrollEl=Bm.scrollableCanvasDiv;Bq.offset.x.start=0;Bq.offset.x.end=Bm.getWidth()*(Bm.scaleFactor-1);Bq.offset.y.start=0;Bq.offset.y.end=Bm.getHeight()*(Bm.scaleFactor-1);if(Bq.origin.x>Bq.offset.x.end){Bq.origin.x=Bq.offset.x.end;}if(Bq.origin.y>Bq.offset.y.end){Bq.origin.y=Bq.offset.y.end;}Bm.animationCanvas.width=Bm.highlightCanvas.width=Bm.getWidth()*2;Bm.animationCanvas.height=Bm.highlightCanvas.height=Bm.getHeight()*2;if(!Bm.model.coords){if(typeof (mstrApp)!="undefined"&&mstrApp.serverRequest){var Bl={success:function(Br){if(!Br){return ;}Bm.model.coords=Br.coords;Bm.drawMap();if(Bm.markerType!==AH){Bm.highlightPoint();}Bm.adjustWidgetOffsets();if(!Bm.mapDataScreenshotTaken){Bm.mapDataScreenshotTaken=true;Bm.localTakeScreenshot(BK);}},failure:function(Br){}};params={taskId:"getMapCoordinates"};var Bi=Bm.model.vp;if(Bi&&Bi.mf){params.coordinatesFile=Bi.mf;}mstrApp.serverRequest(params,Bl,{src:"postBuildRendering"});}}else{Bm.drawMap();Bm.highlightPoint();this.adjustWidgetOffsets();}if(this._super){this._super();}if(this._tn){var Bj=this._tsCallback;this._tsCallback=function(Br){Bm.infowindowOn=Bm.model.infowindowOn;Bm.currSelectedObjBackup=Bm.currSelectedObj;Bj.call(this,Br);};mstrmojo.dom.detachEvent(this._tn,mstrmojo.dom.TOUCHSTART,Bj);mstrmojo.dom.attachEvent(this._tn,mstrmojo.dom.TOUCHSTART,this._tsCallback);}var Bo=Bm.xtabModel,Bn=(Bo&&Bo.docModel);if(Bn){Bm.docModelListener=Bm.xtabModel.docModel.attachEventListener("infoWindowClosed",this.id,function(Br){Bm.model.infowindowOn=false;if(!Bm.hasNonifwTarget&&Bm.currSelectedObj){window.setTimeout(function(){Bm.currSelectedObj=null;Bm.highlightPoint();},10);}});}Bm.fullScreenListener=mstrmojo.touchManager.attachEventListener("fullScreenStateChange",this.id,function(Br){Bm.adjustWidgetOffsets();});},getFullPath:function AN(Bn){var Bj="";var Bm=/^[A-z]:\/\//;if(Bm.test(Bn)){Bj=Bn;}else{var Bl=/^(..\/|..\\)/;var Bk=/^(.\/|.\\)/;var Bi=/^(\/|\\)/;Bn=Bn.replace(Bl,"");Bn=Bn.replace(Bk,"");Bn=Bn.replace(Bi,"");if(typeof (mstrApp)!="undefined"&&mstrApp.getConfiguration){Bj=mstrmojo.url.getAbsoluteURL(Bn,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());}}return Bj;},touchMultiBegin:function(Bm){this.hideTooltip();var Bk,Bj;if(Bm.evt.touches&&Bm.evt.touches.length==2){Bk=Bm.evt.touches[0];Bj=Bm.evt.touches[1];}else{Bk=Bm;Bj={pageX:100,pageY:100};}var Bl=Bk.pageX-Bj.pageX,Bi=Bk.pageY-Bj.pageY;this.initDiffDiff=Bl*Bl+Bi*Bi;this.initCenterX=(Bk.pageX+Bj.pageX)>>1;this.initCenterY=(Bk.pageY+Bj.pageY)>>1;this.initScrollX=this._scroller.origin.x;this.initScrollY=this._scroller.origin.y;this.relScaleFactor=1;},touchMultiMove:function(Bl){var Bn,Bm;if(Bl.evt.touches&&Bl.evt.touches.length==2){Bn=Bl.evt.touches[0];Bm=Bl.evt.touches[1];}else{Bn=Bl;Bm={pageX:100,pageY:100};}var Bp=Bn.pageX-Bm.pageX,Bo=Bn.pageY-Bm.pageY,Bq=Bp*Bp+Bo*Bo,Bs=(Bn.pageX+Bm.pageX)>>1,Br=(Bn.pageY+Bm.pageY)>>1;var Bj=Math.sqrt(Bq/this.initDiffDiff);var Bk={x:Bj*(this.initCenterX+this.initScrollX)-Bs,y:Bj*(this.initCenterY+this.initScrollY)-Br};var Bi={scale:Bj,offset:Bk};this.relScaleFactor=Bj;this.applyTransform(Bi);},touchMultiEnd:function(Bj){if(this.relScaleFactor*this.scaleFactor<1){this.relScaleFactor=1/this.scaleFactor;this.applyTransform({scale:this.relScaleFactor},500,this.postScale);}else{if(this.relScaleFactor*this.scaleFactor>2){var Bi=this.relScaleFactor*this.scaleFactor/2;this.relScaleFactor=2/this.scaleFactor;this.applyTransform({scale:this.relScaleFactor,scaleBack:Bi},500,this.postScale);}else{this.postScale();}}},handleTouchSelectWithIfw:function BI(Bj,Bi){var Bl=this,Bk=Bl.getAreaOrNearestBubble(false,Bj,Bi);if(!Bk){Bl.closeInfowindow();}else{if(Bk.hdrIndex<0){Bl.closeInfowindow();}else{if(!Bl.currSelectedObj||Bk.touchVal!==Bl.currSelectedObj.touchVal){Bl.showInfowindow(Bk);Bl.currSelectedObj=Bk;Bl.highlightPoint();}else{}}}},handleTouchSelectNoIfw:function a(Bj,Bi){var Bl=this,Bk=Bl.getAreaOrNearestBubble(false,Bj,Bi);if(!Bk){Bl.hideTooltip();}else{if(!Bl.currHoverObj||Bk.touchVal!==Bl.currHoverObj.touchVal){Bl.currHoverObj=Bk;Bl.highlightPoint();}else{Bl.renderTooltip(Bk.touchVal,Bk.point.x,Bk.point.y,Bk.hdrIndex);}}},touchSelectBegin:function(Bi){if(Bi.evt.ctrlKey){this.touchMultiBegin(Bi);return ;}if(this.infowindowOn){this.touchSelectWithIfw=true;this.handleTouchSelectWithIfw(Bi.pageX,Bi.pageY);}else{this.handleTouchSelectNoIfw(Bi.pageX,Bi.pageY);}},touchSelectMove:function(Bi){if(Bi.evt.ctrlKey){this.touchMultiMove(Bi);return ;}if(this.touchSelectWithIfw){this.handleTouchSelectWithIfw(Bi.pageX,Bi.pageY);}else{this.handleTouchSelectNoIfw(Bi.pageX,Bi.pageY);}},touchSelectEnd:function(Bi){if(Bi.evt.ctrlKey){this.touchMultiEnd(Bi);}this.touchSelectWithIfw=false;return ;},touchSwipeBegin:function AX(Bi){this.hideTooltip();if(this._super){this._super(Bi);}},applyTransform:function(Bj,Bk,Bs){var Br=this._scroller;if(Bk===undefined){Bk=0;}Br.scrollEl.style.webkitTransformOrigin="left top";Br.transform="scale("+Bj.scale+","+Bj.scale+")";var Bq,Bp;if(Bj.offset){Bq=Bj.offset.x;Bp=Bj.offset.y;}else{var Bo=Bj.scaleBack||1;Bq=this._scroller.origin.x/Bo;Bp=this._scroller.origin.y/Bo;}var Bi=this.scaleFactor*this.relScaleFactor-1,Bl=this.getHeight()*Bi,Bn=this.getWidth()*Bi;if(Bi<0){Br.offset={y:{start:Bl,end:0},x:{start:Bn,end:0}};}else{Br.offset={y:{start:0,end:Bl},x:{start:0,end:Bn}};}this._scroller.scrollTo(Bq,Bp,Bk);if(Bs){var Bm=this;setTimeout(function(){Bs.apply(Bm);Bm=null;},Bk);}},pointCanBeSelected:function E(Br){var Bp=this,Bl=Bp.model,Bi=Bl.gts,Bj=Bi.col,Bn=Bj.length,Bk=Bi.row,Bo=Bk.length,Bm;for(Bm=0;Bm<Bo;Bm++){var Bq=Bk[Bm];if(Bq.sc&&Bq.sc.tks){return true;}if(Bq.lm&&Bq.lm[0]&&Bq.lm[0].links&&Bq.lm[0].hasOwnProperty("di")){return true;}}return false;},getModelK:function AC(){var Bi=this.model&&this.model.k;return Bi;},getActionObj:function f(Bv,By,Bt){var Bj=[],Br=0,Bk=[],Bn=null;var B1=this,Bm=B1.model,Bi=Bm.gts,Bp=Bi.row[0];if(Bp.sc&&Bp.sc.tks&&(!Bv||Bv.hdrIndex>=0)){if(By&&(Bp.sc.all==="false"||Bp.sc.all===false)){return null;}var Bu={};Bu.sc=Bp.sc;if(Bv&&Bv>=0){Bu.es=Bp.es[Bv.hdrIndex].n;}else{Bu.es=null;}Bu.eid=By?"OA:(All)":Bp.es[Bv.hdrIndex].id;Bj.push(Bu);Br=Bp.at||0;}if(Bp.lm&&Bp.lm[0]&&Bp.lm[0].links&&!Bn&&Bv&&Bv.hdrIndex>=0){Bn={};Bn.titleInfo=Bp;Bn._e=Bp.es[Bv.hdrIndex];}var Bq=Bi.col&&Bi.col.length>0&&Bi.col[0];if(Bj.length>0){Br=Br|AY;if(Bv&&Bv.hdrIndex>=0){if(!Bt){if(this.hasIfwTarget){this.getAnchorStyle(Bv);this.model.infowindowOn=true;return{at:Br,k:this.getModelK(),scObjList:Bj,anchor:this.infowindowAnchor};}else{return{at:Br,k:this.getModelK(),scObjList:Bj};}}else{return{at:Br,k:this.getModelK(),scObjList:Bj};}}else{if(Bv&&Bv.hdrIndex<0){return{at:Br,k:this.getModelK(),scObjList:Bj};}else{if(!Bv){return{at:Br,k:this.getModelK(),scObjList:Bj};}}}}if(!Bn&&Bv&&Bv.hdrIndex>=0){var Bw=Bq,Bo=Bw&&Bw.es&&Bw.es.length,Bz;if(Bw&&Bo>0){for(Bz=Bo-1;Bz>=0;Bz--){var Bx=Bw.es[Bz],Bs=Bw.lm[Bz];if(Bs&&Bs.links){Bn={};Bn.titleInfo=Bw;Bn.mix=Bz;var Bl=Bn,B0={};B0.titleInfo=Bp;B0._e=Bp.es[Bv.hdrIndex];Bl._lp=B0;Bl.axis=AU;}}}}if(Bn){Br=Br|BP;return{at:Br,k:this.getModelK(),node:Bn};}return null;},getAnchorStyle:function Al(Bn){if(!Bn){return ;}var Bi=Bn.touchVal,Bz=this,Bk=Bz.model,Br=Bk.coords,Bs,Bq,Bp;Bz.infowindowAnchor.style.left=(Bn.point.x-9)+"px";Bz.infowindowAnchor.style.top=(Bn.point.y-9)+"px";if(Bz.displayMode===T){var By=Number.POSITIVE_INFINITY,Bw=0,Bv=Number.POSITIVE_INFINITY,Bu=0;if(Br.hasOwnProperty(Bi)){var Bt=Br[Bi];for(Bs in Bt){if(!Bt.hasOwnProperty(Bs)){continue;}var Bx=Bt[Bs];for(Bq=0;Bq<Bx.length;Bq++){if(By>Bx[Bq]){By=Bx[Bq];}if(Bw<Bx[Bq]){Bw=Bx[Bq];}Bq++;if(Bv>Bx[Bq]){Bv=Bx[Bq];}if(Bu<Bx[Bq]){Bu=Bx[Bq];}}}Bz.infowindowAnchor.style.left=(By+Bz.leftOffset-Bz._scroller.origin.x)+"px";Bz.infowindowAnchor.style.top=(Bv+Bz.topOffset-Bz._scroller.origin.y)+"px";Bz.infowindowAnchor.style.width=(Bw-By)+"px";Bz.infowindowAnchor.style.height=(Bu-Bv)+"px";}}else{if(Bz.displayMode===A7){if(Bz.shapeFileType===An){Br=Bk.polygonCenters;}if(Br.hasOwnProperty(Bi)){if(Bz.markerType===AF){var Bm=Br[Bi][0],Bo=Bz.getRadiusFromName(Bi);Bz.infowindowAnchor.style.left=(Bm[0]+Bz.leftOffset-Bo-Bz._scroller.origin.x)+"px";Bz.infowindowAnchor.style.top=(Bm[1]+Bz.topOffset-Bo-Bz._scroller.origin.y)+"px";Bz.infowindowAnchor.style.width=(2*Bo)+"px";Bz.infowindowAnchor.style.height=(2*Bo)+"px";}else{if(Bz.markerType===AH){var Bm=Br[Bi][0],Bj=Bk["imageIcon_"+Bi],Bl=0,B0=0;if(Bj){Bl=Bj.width;B0=Bj.height;}Bz.infowindowAnchor.style.left=(Bm[0]+Bz.leftOffset-Bl/2-Bz._scroller.origin.x)+"px";Bz.infowindowAnchor.style.top=(Bm[1]+Bz.topOffset-B0/2-Bz._scroller.origin.y)+"px";Bz.infowindowAnchor.style.width=Bl+"px";Bz.infowindowAnchor.style.height=B0+"px";}}}}}},getLastHighlightPoint:function Z(){return this.currHoverObj||null;},getTouchedObj:function BE(Bm,Br,Bq){var Bp=this;if(Bp.displayMode==T){return this.getAreaOrNearestBubble(Bm,Br,Bq);}else{if(Bp.displayMode==A7){var Bs=this.getLastHighlightPoint(),Bk=Bp.utils.getTouchXYOnWidget(Br,Bq,Bp);var Bi=false,Bl=0,Bj=0,Bo=0,Bn=0;if(Bs&&Bk){Bl=Bs.point.x;Bj=Bs.point.y;Bo=Bk.touchX;Bn=Bk.touchY;touchPointInHighLightArea=this.tooltipOn&&(Bl-Bo)*(Bl-Bo)+(Bj-Bn)*(Bj-Bn)<=this.bias*this.bias;}if(Bi){Bp.hideTooltip();Bs=this.getLastHighlightPoint();}else{Bs=this.getAreaOrNearestBubble(Bm,Br,Bq);}return Bs;}}return null;},closeInfowindow:function Ae(){var Bi=this;Bi.getFirstInfowindow();if(Bi.model.infowindowOn&&Bi.infowindow){Bi.model.infowindowOn=false;Bi.infowindow.close();if(Bi.infowindow._tchHandler){mstrmojo.touchManager.detachEventListener(Bi.infowindow._tchHandler);delete Bi.infowindow._tchHandler;}}},getFirstInfowindow:function d(){var Bm=this,Bk=Bm.model,Bq=Bm.xtabModel,Bn=(Bq&&Bq.docModel),Bo=Bk&&Bk.gts&&Bk.gts.row,Bp=null;if(Bo&&Bo.length>0){Bp=Bo[0]&&Bo[0].sc&&Bo[0].sc.tks;}if(Bn&&Bp){var Bj=Bn.getTargetInfoWin(Bp);if(Bj&&Bj.length>0){var Bl=Bn.infoWinByKey[Bj[0]],Bi=Bl&&(Bl.id+"_ifw");Bm.infowindow=mstrmojo.all[Bi];}}},hasNoninfowindowTarget:function Au(Bl){var Bs=this.xtabModel,Br=(Bs&&Bs.docModel);if(Br){var Bq=Br.defn&&Br.defn.layouts,Bk=null,Bj;if(Bq){for(Bj in Bq){if(Bq.hasOwnProperty(Bj)){if(Bq[Bj].loaded){Bk=Bq[Bj];break;}}}}var Bm=Bk&&Bk.units;if(Bm){for(Bj=0;Bj<Bl.scObjList.length;Bj++){var Bn=Bl.scObjList[Bj];var Bo=Bn.sc.tks.split("\x1E"),Bi;for(Bi=0;Bi<Bo.length;Bi++){var Bp=Bm[Bo[Bi]];if(Bp){if(!Bp.ifw){return true;}}}}}}return false;},hasInfowindowTarget:function B(Bl){var Bs=this.xtabModel,Br=(Bs&&Bs.docModel);if(Br){var Bq=Br.defn&&Br.defn.layouts,Bk=null,Bj;if(Bq){for(Bj in Bq){if(Bq.hasOwnProperty(Bj)&&Bq[Bj].loaded){Bk=Bq[Bj];break;}}}var Bm=Bk&&Bk.units;if(Bm){for(Bj=0;Bj<Bl.scObjList.length;Bj++){var Bn=Bl.scObjList[Bj];var Bo=Bn.sc.tks.split("\x1E"),Bi;for(Bi=0;Bi<Bo.length;Bi++){var Bp=Bm[Bo[Bi]];if(Bp){if(Bp.ifw){return true;}}}}}}return false;},touchTap:function A1(Bj){var Bm=this;if(Bj.count==2){Bm.hideTooltip();Bm.relScaleFactor=1/Bm.scaleFactor;Bm.applyTransform({scale:Bm.relScaleFactor},500,Bm.postScale);}else{if(Bj.count==1){var Bk;if(Bm.tooltipOn){var Bp=mstrmojo.dom.findAncestorByAttr(Bj.target,"clk",true,this.domNode)||null;if(Bp){var Bo=Bp.value;if(Bo==="clk"){Bm.hideTooltip();return ;}}}var Bq=this.getTouchedObj(true,Bj.pageX,Bj.pageY);if(Bq&&Bq.hdrIndex>=0){var Bn=Bm.pointCanBeSelected(Bq),Bi=Bm.currSelectedObjBackup&&(Bq.touchVal==Bm.currSelectedObjBackup.touchVal),Bl;if(Bn){if(!Bi){Bm.defaultSelectedObjs={};Bm.hideTooltip();Bk=this.getActionObj(Bq);if(Bk&&Bk.scObjList){Bm.currSelectedObj=Bq;if(!Bm.hasOwnProperty("hasNonifwTarget")||!Bm.hasOwnProperty("hasIfwTarget")){Bm.hasNonifwTarget=Bm.hasNoninfowindowTarget(Bk);Bm.hasIfwTarget=Bm.hasInfowindowTarget(Bk);Bk=this.getActionObj(Bq);}Bm.highlightPoint();Bm.performAction([Bk]);}else{if(Bk&&Bk.node){Bm.currLinkObj=Bq;Bm.highlightPoint();Bm.performAction([Bk]);Bm.currLinkObj=null;}}}else{if(this.currHoverObj&&this.currSelectedObj&&this.currHoverObj.touchVal===this.currSelectedObj.touchVal){}else{if(Bm.hasNonifwTarget){Bk=Bm.getActionObj(Bq,true,true);if(Bk){Bm.performAction([Bk]);Bm.currSelectedObj=null;Bm.highlightPoint();}else{Bm.getFirstInfowindow();if(!Bm.infowindowOn&&Bm.infowindow){Bm.model.infowindowOn=true;Bm.infowindow.open();}}}}Bm.hideTooltip();}}else{Bl=Bm.currHoverObj&&(Bq.touchVal==Bm.currHoverObj.touchVal);if(!Bl){Bm.currHoverObj=Bq;Bm.highlightPoint();}else{Bm.hideTooltip();}}}else{if(Bq&&Bq.hdrIndex<0){Bl=Bm.currHoverObj&&(Bq.touchVal==Bm.currHoverObj.touchVal);if(!Bl){Bm.currHoverObj=Bq;Bm.highlightPoint();}else{Bm.hideTooltip();}}else{if(!Bq){Bm.hideTooltip();if(Bm.currSelectedObjBackup&&Bm.hasNonifwTarget){Bk=this.getActionObj(Bq,true);if(Bk){Bm.performAction([Bk]);Bm.currSelectedObj=null;Bm.highlightPoint();}}}}}}}},showInfowindow:function F(Bj){var Bl=this,Bi;if(Bj&&Bj.hdrIndex>=0){var Bk=Bl.pointCanBeSelected(Bj),Bm=Bl.currSelectedObj&&(Bj.touchVal==Bl.currSelectedObj.touchVal);if(Bk){if(!Bm){Bl.hideTooltip();Bi=Bl.getActionObj(Bj);if(Bi&&Bi.scObjList){Bl.currSelectedObj=Bj;}Bl.highlightPoint();Bl.performAction([Bi]);}else{if(this.currHoverObj&&this.currSelectedObj&&this.currHoverObj.touchVal===this.currSelectedObj.touchVal){Bl.hideTooltip();}else{Bl.hideTooltip();Bi=this.getActionObj(Bj,true,true);if(Bi){Bl.performAction([Bi]);Bl.currSelectedObj=null;Bl.highlightPoint();}}}}else{}}else{if((Bj&&Bj.hdrIndex<0)||!Bj){Bl.hideTooltip();if(Bl.currSelectedObj){Bi=Bl.getActionObj(Bj,true);if(Bi){Bl.performAction([Bi]);Bl.currSelectedObj=null;Bl.highlightPoint();}}}}},postScale:function(){delete this._scroller.transform;this._scroller.scrollTo(this._scroller.origin.x,this._scroller.origin.y,0);this.scaleFactor*=this.relScaleFactor;this.refreshWidget();},refreshWidget:function(){this.drawMap();this.highlightPoint();},getAttrIndices:function BJ(){var Bo=this,Bl=Bo.model,Bp=Bl&&Bl.gts&&Bl.gts.row,Bm,Bk;if(Bp){var Bn=[],Bj=0;for(Bm=0;Bm<Bp.length;Bm++){var Bi=Bp[Bm]&&Bp[Bm].fs;Bn.push(new Array());if(Bi){for(Bk=0;Bk<Bi.length;Bk++){Bn[Bm].push(Bj++);}}}return Bn;}else{return null;}},createTooltipTable:function BU(){var Bn=this,Bl=Bn.model,Bq=Bn.tooltip.childNodes[0],Br=Bl&&Bl.gts&&Bl.gts.row,Bp=Bl&&Bl.gts&&Bl.gts.col&&Bl.gts.col[0]&&Bl.gts.col[0].es,Bj;if(Bq.childNodes.length===0&&Br&&Br.length>0){var Bo=Br.length+(Bp?Bp.length:0);for(Bj=0;Bj<Bo;Bj++){var Bm=document.createElement("tr");var Bk=document.createElement("td");Bk.align="right";Bk.style.color="#545462";Bm.appendChild(Bk);var Bi=document.createElement("td");Bi.align="left";Bi.style.color="#000000";Bm.appendChild(Bi);Bq.appendChild(Bm);}}},localTakeScreenshot:function Bf(Bj){var Bi=this;window.setTimeout(function(){var Bk=Bi.controller.id;var Bl=mstrmojo.all[Bk];if(Bl&&Bl.rootCtrl.getCurrent()===Bl){Bl.takeScreenShot();}},Bj);},getDefaultSelectedObjs:function AV(){var Bp=this,Bl=Bp.model,Bk=Bl&&Bl.ghs&&Bl.ghs.rhs&&Bl.ghs.rhs.items,Bo=Bl&&Bl.gts&&Bl.gts.row,Bm,Bj,Bi,Bn;if(Bp.haveGotDftSltObjs){return ;}else{Bp.haveGotDftSltObjs=true;}Bp.defaultSelectedObjs={};if(Bk&&Bo&&Bo.length>0){for(Bm in Bk){if(Bk.hasOwnProperty(Bm)){Bn=Bk[Bm].items[0];if(Bn&&Bn.hasOwnProperty("cet")){Bi=Bn.idx;Bj=Bo[0].es[Bi].n;if(!(Bp.defaultSelectedObjs.hasOwnProperty(Bj))){Bp.defaultSelectedObjs[Bj]=Bi;}}}}}},renderErrorMessage:function BB(Bi){var Bk=this,Bj=Bk.errorMessage,Bm=Bi.replace(/-/g,"<br />-");Bj.innerHTML=Bm;Bj.style.width=Bk.getWidth()+"px";Bj.style.fontSize=Bk.errMsgFontSize+"px";Bj.style.fontFamily="Tahoma";Bj.style.color=Y;Bj.style.backgroundColor="RGBA(0,0,0,0)";var Bl=Ac;if(Bk.model.hasOwnProperty("vp")&&Bk.model.vp.hasOwnProperty("bc")&&Bk.model.vp.bc!==""){Bl="#"+Bk.model.vp.bc;}else{Bl=Bk.utils.getAncestorBgColor(Bk)||Ac;}Bk.domNode.style.backgroundColor=Bl;Bk.model.themeMode=AP(Bl);if(Bk.model.themeMode===s){Bj.style.color=C;}},setFontByDPI:function O(){if(this.setFontByDPIFlag){return ;}var Bn=this;Bn.setFontByDPIFlag=true;Bn.hoverBubbleRadiusLarger=5;Bn.bubbleStrokeWidth=2;Bn.baseMaxBubbleSizeAuto=12;Bn.baseMaxBubbleSizeManual=24;Bn.polygonStrokeWidth=1;Bn.highlightPolygonStrokeWidth=2;Bn.borderSpace=5;Bn.tooltipFontSize=12;Bn.tooltipBorderWidth=1;Bn.tooltipBorderRadius=5;Bn.errMsgFontSize=16;Bn.bias=30;Bn.tooltipRightShadowWidth=4;var Bu=Bn.xtabModel,Br=(Bu&&Bu.docModel),Bj=false,Bi=false;if(Br){Bj=Br.zt&&(Br.zt==2);var Bq=Br.defn&&Br.defn.layouts,Bl,Bk;for(Bk in Bq){if(Bq.hasOwnProperty(Bk)&&Bq[Bk]&&Bq[Bk].loaded){Bl=Bq[Bk];break;}}if(Bl&&Bl.hasOwnProperty("fch")){Bi=Bl.fch;}}if(Bj&&Bi){var Bp=mstrMobileApp.getDeviceDPIX();var Bo=149;var Bm=1;if(Bp>0){Bm=Bp/Bo;}if(Bm>1){Bn.hoverBubbleRadiusLarger*=Bm;Bn.bubbleStrokeWidth*=Bm;Bn.baseMaxBubbleSizeAuto*=Bm;Bn.baseMaxBubbleSizeManual*=Bm;Bn.polygonStrokeWidth*=Bm;Bn.highlightPolygonStrokeWidth*=Bm;Bn.borderSpace*=Bm;Bn.tooltipFontSize*=Bm;Bn.tooltipBorderWidth*=Bm;Bn.tooltipBorderRadius*=Bm;Bn.errMsgFontSize*=Bm;Bn.bias*=Bm;Bn.tooltipRightShadowWidth*=Bm;var Bt=Bn.tooltip,Bs=Bt.childNodes[0];Bt.style.fontSize=Bn.tooltipFontSize+"px";Bt.style.borderWidth=Bn.tooltipBorderWidth+"px";Bt.style.borderRadius=Bn.tooltipBorderRadius+"px";Bt.style.boxShadow=3*Bm+"px "+3*Bm+"px "+4*Bm+"px RGBA(0,0,0,0.45)";Bs.style.margin=5*Bm+"px "+7*Bm+"px";}}},initScroller:function BO(Bi){Bi.vScroll=true;Bi.hScroll=true;this._super(Bi);},getIndexFromHdrindex:function BS(Bn){var Bm=this,Bi=Bm.model.ghs.rhs.items;if(Bi){var Bk,Bj,Bl;for(Bk=0;Bk<Bi.length;Bk++){Bj=Bi[Bk].items;if(Bj.length>0&&Bj[0].idx==Bn){if(Bk===Bi.length-1){return Bk;}else{Bl=Bi[Bk+1].items;if(Bl.length>0&&Bl[0].idx!=Bn){return Bk;}else{continue;}}}else{continue;}}}return 0;},drawMap:function I(){var Bj=this,Bi=Bj.model;Bj.animationCanvas.width=Bj.animationCanvas.width;Bj.highlightCanvas.width=Bj.highlightCanvas.width;if(!Bj.hasOwnProperty("displayMode")){Bj.displayMode=Bh;}if(!Bj.hasOwnProperty("markerType")){Bj.markerType=Aj;}if(!Bj.hasOwnProperty("shapeFileType")){Bj.shapeFileType=l;}if(!Bj.hasOwnProperty("colorByIndex")){Bj.colorByIndex=-1;}if(!Bj.hasOwnProperty("sizeByIndex")){Bj.sizeByIndex=-1;}if(!Bj.hasOwnProperty("drawBgImageFlag")){Bj.drawBgImageFlag=false;}if(!Bj.hasOwnProperty("thresholdType")){Bj.thresholdType=b;}if(!Bj.hasOwnProperty("curPolygonOpacity")){Bj.curPolygonOpacity=Bd;}if(!Bi.hasOwnProperty("infowindowOn")){Bi.infowindowOn=false;}if(!Bj.hasOwnProperty("touchSelectWithIfw")){Bj.touchSelectWithIfw=false;}if(Bj.model.hasOwnProperty("vp")){var Bk=Ac;if(Bj.model.vp.hasOwnProperty("bc")&&Bj.model.vp.bc!==""){Bk="#"+Bj.model.vp.bc;}else{Bk=Bj.utils.getAncestorBgColor(Bj)||Ac;}Bj.domNode.style.backgroundColor=Bk;Bj.model.themeMode=AP(Bk);Bj.model.bgColor=Bk;Bj.tooltip.style.top="0px";Bj.setDisplayParas();if(Bj.displayMode===T){Bj.drawAreaMap();}else{if(Bj.displayMode===A7){Bj.drawBubbleMap();}}}},getIndexById:function x(Bn){var Bl=this,Bi=Bl.model,Bm=Bi.gts&&Bi.gts.col,Bk=null,Bj;if(Bm&&Bm.length>0&&Bm[0].hasOwnProperty("es")){Bk=Bm[0].es;for(Bj=0;Bj<Bk.length;Bj++){if(Bk[Bj].oid===Bn){return Bj;}}}return -1;},setDisplayParas:function AM(){var Bk=this,Bi=Bk.model;if(!Bk.hasOwnProperty("setDisplayParasFlag")){Bk.setDisplayParasFlag=true;}else{return ;}Bk.shapeFileType=AJ(Bi.coords);var Bj=0;if(Bi.hasOwnProperty("gvs")&&Bi.gvs.hasOwnProperty("items")&&Bi.gvs.items.length>0&&Bi.gvs.items[0].hasOwnProperty("items")&&Bi.gvs.items[0].items.length>0){Bj=Bi.gvs.items[0].items.length;}Bk.displayMode=Bi.vp.mt;if(Bk.displayMode===T){if(Bj>0){if(Bi.vp.hasOwnProperty("ColorBy")){Bk.colorByIndex=Bk.getIndexById(Bi.vp.ColorBy);if(Bk.colorByIndex<0){Bk.colorByIndex=0;}}else{Bk.colorByIndex=0;}Bk.thresholdType=Bk.getThresholdType(Bk.colorByIndex);}else{}}else{if(Bk.displayMode===A7){if(Bj>0){this.setBubbleModeParasWithData(Bj);}else{Bk.markerType=AF;}}else{if(Bk.displayMode===Bh){if(Bj>0){Bk.displayMode=A7;this.setBubbleModeParasWithData(Bj);}else{if(Bk.shapeFileType===An){Bk.displayMode=T;}else{if(Bk.shapeFileType===AQ){Bk.displayMode=A7;Bk.markerType=AF;}}}}else{if(!Bk.displayMode){if(Bj>0){Bk.displayMode=A7;this.setBubbleModeParasWithData(Bj);}else{if(Bk.shapeFileType===An){Bk.displayMode=T;}else{if(Bk.shapeFileType===AQ){Bk.displayMode=A7;Bk.markerType=AF;}}}}}}}},setBubbleModeParasWithData:function AZ(Bk){var Bj=this,Bi=Bj.model;if(Bi.vp.hasOwnProperty("SizeBy")){Bj.sizeByIndex=this.getIndexById(Bi.vp.SizeBy);if(Bj.sizeByIndex<0){Bj.sizeByIndex=0;}}else{Bj.sizeByIndex=0;}if(Bi.vp.hasOwnProperty("ColorBy")){Bj.colorByIndex=this.getIndexById(Bi.vp.ColorBy);if(Bj.colorByIndex<0){Bj.colorByIndex=0;}Bj.thresholdType=Bj.getThresholdType(Bj.colorByIndex);if(Bj.thresholdType===BZ){Bj.markerType=AH;}else{Bj.markerType=AF;}}else{if(Bk===1){Bj.colorByIndex=0;Bj.thresholdType=this.getThresholdType(0);if(Bj.thresholdType===BZ){Bj.markerType=AH;}else{Bj.markerType=AF;}}else{if(Bk>1){var Bl=this.getThresholdType(0);if(Bl===BZ){Bj.colorByIndex=0;Bj.thresholdType=Bl;Bj.markerType=AH;}else{Bj.colorByIndex=1;Bj.thresholdType=this.getThresholdType(1);if(Bj.thresholdType===BZ){Bj.markerType=AH;}else{Bj.markerType=AF;}}}}}},getThresholdType:function q(Br){var Bq=this,Bk=Bq.model&&Bq.model.th,Bi=Bk&&Bk[Br],Bm=Bq.model&&Bq.model.gvs,Bj=Bq.model.gts.row[0].es,Bl,Bn,Bo;if(Bi&&Bm.items.length>0){if(Br>=Bm.items[0].items.length||Br<0||Bi.length===0){return b;}for(Bn in Bj){if(Bj.hasOwnProperty(Bn)){Bo=Bm.items[Bq.getIndexFromHdrindex(Bn)].items[Br];if(Bo.hasOwnProperty("ty")&&parseInt(Bo.ty,10)===4){return BZ;}}}var Bp=/(jpg|jpeg|png|gif|tiff|bmp)$/i;for(Bl in Bi){if(Bi.hasOwnProperty(Bl)&&Bp.test(Bi[Bl].n)){return BZ;}}for(Bn in Bj){if(Bj.hasOwnProperty(Bn)){Bo=Bm.items[Bq.getIndexFromHdrindex(Bn)].items[Br];if(Bo.hasOwnProperty("ty")&&parseInt(Bo.ty,10)===2){return AO;}}}return b;}else{return b;}},scalePolygonCoords:function Bb(){var Bt=this,Bp=Bt.model,Bu=Bp.coords;var Bj=0,Bi=0,Bk,Bs,Bo,Bn,Bm;for(Bo in Bu){if(Bu.hasOwnProperty(Bo)){if(Bo==="bgImage"){continue;}Bk=Bu[Bo];for(Bn in Bk){if(Bk.hasOwnProperty(Bn)){Bs=Bk[Bn];for(Bm=0;Bm<Bs.length;Bm++){if(Bs[Bm]>Bj){Bj=Bs[Bm];}Bm++;if(Bs[Bm]>Bi){Bi=Bs[Bm];}}}}}}var Bl=Bj/((this.getWidth()-10)*this.scaleFactor),Bq=Bi/((this.getHeight()-10)*this.scaleFactor),Br=Math.max(Bq,Bl);this.topOffset=(this.getHeight()*this.scaleFactor-Bi/Br)/2;this.leftOffset=(this.getWidth()*this.scaleFactor-Bj/Br)/2;for(Bo in Bu){if(Bu.hasOwnProperty(Bo)){if(Bo==="bgImage"){continue;}Bk=Bu[Bo];for(Bn in Bk){if(Bk.hasOwnProperty(Bn)){Bs=Bk[Bn];for(Bm=0;Bm<Bs.length;Bm++){Bs[Bm]=parseInt(Bs[Bm]/Br,10);}}}}}},getBubbleColorFromName:function A6(Bi){if(this.allBubblesColor&&this.allBubblesColor.hasOwnProperty(Bi)){return this.allBubblesColor[Bi];}else{return null;}},getBgColorFromCSS:function Ay(Bj){var Bi=this.cssDiv,Bm=null,Bl=null,Bk,Bn;if(this.model.hasOwnProperty("css")){Bm=this.model.css;}if(this.model.hasOwnProperty("th")){Bl=this.model.th&&this.model.th[this.colorByIndex];}if(Bm&&Bl&&Bj&&Bj.hasOwnProperty("ty")){if((parseInt(Bj.ty,10)===2||parseInt(Bj.ty,10)===4)&&Bj.hasOwnProperty("ti")&&Bl.length>Bj.ti&&Bl[Bj.ti].udbg===1){Bk=Bl[Bj.ti].cni;Bi.className=Bk&&Bm[Bk]&&Bm[Bk].n;Bn=mstrmojo.css.getComputedStyle(Bi);if(Bn.hasOwnProperty("backgroundColor")){return Bn.backgroundColor;}}}return null;},drawPolygonInMap:function k(Bn){var Bp=this,Bl=Bp.model,Br=Bl.coords,Bi=this.animationContext,Bk;Bp.animationCanvas.width=Bp.animationCanvas.width;if(Bp.drawBgImageFlag&&Bl.bgImg){var Bj=Bp.oriBgImageWidth/((Bp.getWidth()-Bp.borderSpace*2)*Bp.scaleFactor),Bm=Bp.oriBgImageHeight/((Bp.getHeight()-Bp.borderSpace*2)*Bp.scaleFactor),Bo=Math.max(Bm,Bj);Bp.topOffset=(Bp.getHeight()*Bp.scaleFactor-Bp.oriBgImageHeight/Bo)/2;Bp.leftOffset=(Bp.getWidth()*Bp.scaleFactor-Bp.oriBgImageWidth/Bo)/2;Bi.drawImage(Bl.bgImg,Bp.leftOffset,Bp.topOffset,Bp.oriBgImageWidth/Bo,Bp.oriBgImageHeight/Bo);}Bp.curPolygonOpacity=Bn;var Bs=Ao,Bq=Aq,Bw=Av;if(Bl.themeMode===s){Bs=A3;Bq=A5;Bw=AR;}if(Bl.vp&&Bl.vp.npc){Bs=BY("#"+Bl.vp.npc,Bd);}for(Bk in Br){if(!Br.hasOwnProperty(Bk)){continue;}if(Br.hasOwnProperty(Bk)){if(Bk==="bgImage"){continue;}var Bv=Bs;if(Bp.displayMode===T){var Bu=this.getHeaderIndex(Bk);if(Bu>=0){if(Bp.colorByIndex>=0){var Bt=Bl.gvs.items[Bp.getIndexFromHdrindex(Bu)].items[Bp.colorByIndex];Bv=Bp.getBgColorFromCSS(Bt);if(!Bv){Bv=Bq;}if(Bp.drawBgImageFlag){Bv=BY(Bv,AK);}else{Bv=BY(Bv,Bd);}}else{Bv=Bq;}}else{Bv=Bs;}}else{if(Bp.displayMode===A7){Bv=Bs;}}}Bv=BY(Bv,Bn);AT(Bi,Br[Bk],{x:this.leftOffset,y:this.topOffset},Bw,Bp.polygonStrokeWidth,Bv);}},getRadiusFromName:function A(Bj){var Bk=this,Bi=Bk.model;if(Bi.coords.hasOwnProperty(Bj)){if(Bk.model.hasOwnProperty("oriBubbleSize")){return Bk.model.oriBubbleSize[Bj]*Bk.scaleFactor;}else{if(Bk.model.hasOwnProperty("maxBubbleRadius")){return Bk.model.maxBubbleRadius*Bk.scaleFactor;}else{return 2;}}}else{return -1;}},drawBubblesInMap:function Q(){var B0=this,Bl=B0.model,Bw=Bl.coords,Bx;if(Bl.hasOwnProperty("polygonCenters")){Bw=Bl.polygonCenters;}B0.highlightCanvas.width=B0.highlightCanvas.width;var Br=At,Bu=X;if(Bl.themeMode===s){Br=e;Bu=Be;}var Bt=Math.max(2,Math.min(12,V*0.15*Math.min(B0.getWidth(),B0.getHeight())));Bt=Bt*B0.scaleFactor;var Bn=Bl.th&&Bl.th[B0.colorByIndex];if(B0.markerType===AH){var Bs=B0.getFullPath("images/image_not_found.jpg");defaultImageIconPath=B0.getFullPath("images/roundedpp.png");for(Bx in Bw){if(Bw.hasOwnProperty(Bx)){if(Bx==="bgImage"){continue;}var Bq="imageIcon_"+Bx;if(Bl.hasOwnProperty(Bq)){var Bk=Bl[Bq];if(Bk&&Bk.width&&Bk.height&&Bk.width<B0.getWidth()*B0.scaleFactor&&Bk.height<B0.getHeight()*B0.scaleFactor){var B1=Bw[Bx][0][0]-Bk.width/2+B0.leftOffset,Bo=Bw[Bx][0][1]-Bk.height/2+B0.topOffset;B0.animationContext.drawImage(Bk,B1,Bo);}continue;}var Bj=B0.getHeaderIndex(Bx);if(Bn&&Bj>=0&&B0.colorByIndex>=0&&B0.thresholdType===BZ){var Bp=Bl.gvs.items[B0.getIndexFromHdrindex(Bj)].items[B0.colorByIndex];if(Bp.hasOwnProperty("ty")&&parseInt(Bp.ty,10)===4){var By=Bn.length>Bp.ti&&Bn[Bp.ti].n;if(By){var Bz=B0.getFullPath(By);Bl[Bq]=new Image();Bl[Bq].src=Bz;Bl[Bq].id=Bx;Bl[Bq].onload=function(){if(this.width<B0.getWidth()*B0.scaleFactor&&this.height<B0.getHeight()*B0.scaleFactor){var B3=Bw[this.id][0][0]-this.width/2+B0.leftOffset,B4=Bw[this.id][0][1]-this.height/2+B0.topOffset;B0.animationContext.drawImage(this,B3,B4);if(B0.defaultSelectedObjs.hasOwnProperty(this.id)){B0.highlightCanvas.width=B0.highlightCanvas.width;for(var B2 in B0.defaultSelectedObjs){if(B0.defaultSelectedObjs.hasOwnProperty(B2)){B0.highlightImageIcon(B0.highlightContext,Bw,B2,0);}}}}};Bl[Bq].onerror=function(){Bl["imageIcon_"+this.id].src=Bs;};}}else{Bl[Bq]=new Image();Bl[Bq].src=defaultImageIconPath;Bl[Bq].id=Bx;Bl[Bq].onload=function(){if(this.width<B0.getWidth()*B0.scaleFactor&&this.height<B0.getHeight()*B0.scaleFactor){var B2=Bw[this.id][0][0]-this.width/2+B0.leftOffset,B3=Bw[this.id][0][1]-this.height/2+B0.topOffset;B0.animationContext.drawImage(this,B2,B3);if(B0.defaultSelectedObjs.hasOwnProperty(this.id)){B0.highlightImageIcon(B0.highlightContext,Bw,this.id,0);}}};Bl[Bq].onerror=function(){Bl["imageIcon_"+this.id].src=Bs;};}}else{delete Bw[Bx];}}}if(!B0.imageIconScreenshotTaken){B0.imageIconScreenshotTaken=true;}}else{if(B0.markerType===AF){for(Bx in Bw){if(!Bw.hasOwnProperty(Bx)){continue;}if(Bx==="bgImage"||Bx===(B0.currHoverObj&&B0.currHoverObj.touchVal)||Bx===(B0.currSelectedObj&&B0.currSelectedObj.touchVal)||Bx===(B0.currLinkObj&&B0.currLinkObj.touchVal)||(!N(B0.defaultSelectedObjs)&&B0.defaultSelectedObjs.hasOwnProperty(Bx))){continue;}var Bv=Br,Bi=Bt,Bj=B0.getHeaderIndex(Bx);if(Bj>=0){if(B0.sizeByIndex>=0){Bi=B0.getRadiusFromName(Bx);}if(B0.colorByIndex>=0&&B0.thresholdType===AO){Bv=B0.getBubbleColorFromName(Bx);if(!Bv){Bv=Br;}else{Bv=BY(Bv,Aw);}}var Bm={x:B0.leftOffset,y:B0.topOffset};L(B0.highlightContext,Bw[Bx][0],Bm,Bv,Bi);R(B0.highlightContext,Bw[Bx][0],Bm,Bu,Bi,B0.bubbleStrokeWidth);}else{delete Bw[Bx];}}}}},getOriPolygonCoords:function BV(){var Bq=this,Bm=Bq.model,Br=Bm.coords,Bl,Bk,Bj,Bi,Bp;if(!Bm.hasOwnProperty("oriPolyCoords")){Bm.oriPolyCoords={};for(Bl in Br){if(Br.hasOwnProperty(Bl)){if(Bl==="bgImage"){continue;}var Bn=[];Bi=Br[Bl];for(Bk in Bi){if(Bi.hasOwnProperty(Bk)){Bp=Bi[Bk];var Bo=[];for(Bj=0;Bj<Bp.length;Bj++){Bo.push(Bp[Bj]);}Bn.push(Bo);}}Bm.oriPolyCoords[Bl]=Bn;}}}},getAllBubblesColor:function A8(){var Bm=this,Bj=Bm.model,Bo=Bj.coords,Bl;if(Bm.haveAllBubblesColor){return ;}else{Bm.allBubblesColor={};}var Bi=At;if(Bj.themeMode===s){Bi=e;}if(Bm.markerType===AF&&Bm.colorByIndex>=0&&Bm.thresholdType===AO){for(Bl in Bo){if(Bo.hasOwnProperty(Bl)){if(Bl==="bgImage"){continue;}var Bp=Bm.getHeaderIndex(Bl);if(Bp>=0){var Bn=Bj.gvs.items[Bm.getIndexFromHdrindex(Bp)].items[Bm.colorByIndex],Bk=Bm.getBgColorFromCSS(Bn);if(!Bk){Bk=Bi;}Bm.allBubblesColor[Bl]=Bk;}else{}}}}},getOriBubbleSize:function Ar(){var B4=this,Bk=B4.model,Bu=Bk.gvs,Bp=Bk.ghs.rhs.items,Bz=Bk.gts.row[0].es,B1,By,Bx,Bw,Bt,Bm=0;var Bo=1;if(Bk.vp.ty==="0"){if(B4.sizeByIndex<0){Bo=V;}else{if(B4.sizeByIndex>=0){Bo=G;}}}else{if(Bk.vp.ty==="1"){if(Bk.vp.hasOwnProperty("val")&&Bk.vp.val!==null&&Bk.vp.val!==""){Bo=parseFloat(Bk.vp.val);if(Bo>o){Bo=o;}if(Bo<W){Bo=W;}}else{if(B4.sizeByIndex<0){Bo=V;}else{if(B4.sizeByIndex>=0){Bo=D;}}}}else{if(B4.sizeByIndex<0){Bo=V*2;}else{if(B4.sizeByIndex>=0){Bo=D*2;}}}}var B3=B4.baseMaxBubbleSizeAuto;if(B4.sizeByIndex>=0){B3=B4.baseMaxBubbleSizeManual;}var B2=0.15*Math.min(B4.getWidth(),B4.getHeight());if(Bk.vp.ty==="0"){Bm=Math.min(Bo*B2,B3);}else{if(Bk.vp.ty==="1"){Bm=Bo*B2;}else{Bm=Bo*B2;}}if(Bm<=2){Bm=3;}B4.model.maxBubbleRadius=Bm;if(B4.sizeByIndex>=0){var Br=B4.sizeByIndex,B0=Math.abs(parseFloat(Bu.items[0].items[Br].rv)),Bs=Math.abs(parseFloat(Bu.items[0].items[Br].rv));for(By in Bz){if(Bz.hasOwnProperty(By)){var Bi=B4.getIndexFromHdrindex(By),Bj=Math.abs(parseFloat(Bu.items[Bi].items[Br].rv));if(B0<Bj){B0=Bj;}if(Bs>Bj){Bs=Bj;}}}var Bv={};if(B0>Bs){var Bq=Bm*Bs/B0;if(Bq<2){Bq=2;}var Bn=(Bm-Bq)/(B0-Bs),Bl;for(By in Bz){if(Bz.hasOwnProperty(By)){Bl=(Math.abs(parseFloat(Bu.items[B4.getIndexFromHdrindex(By)].items[Br].rv))-Bs)*Bn+Bq;Bv[Bz[By].n]=Bl;}}}else{for(By=0;By<Bz.length;By++){Bv[Bz[By].n]=Bm;}}B4.model.oriBubbleSize=Bv;}},storeOriPoints:function Ad(){var Bm=this.model.coords,Bl={},Bi,Bj,Bk;for(Bk in Bm){if(Bm.hasOwnProperty(Bk)){Bi=Bm[Bk][0];Bj=[Bi[0],Bi[1]];Bl[Bk]=Bj;}}return Bl;},drawBubbleMap:function A9(){var Bv=this,Bs=Bv.model,Bj=this.animationContext,Bw=Bs.coords,Bm,Br,Bp,Bo,Bx;Bv.getAllBubblesColor();Bv.getOriBubbleSize();if(Bs.hasOwnProperty("bgImg")&&Bs.bgImg.hasOwnProperty("src")&&Bs.bgImg.src!=""&&Bs.bgImg.src!=null){Bv.drawBgImageFlag=true;if(!Bv.hasOwnProperty("oriBgImageWidth")){Bv.oriBgImageWidth=Bs.bgImg.width;}if(!Bv.hasOwnProperty("oriBgImageHeight")){Bv.oriBgImageHeight=Bs.bgImg.height;}if(!Bv.hasOwnProperty("oriCoords")){Bv.oriCoords=Bv.storeOriPoints();}var Bk=Bs.bgImg.width/((Bv.getWidth()-Bv.borderSpace*2)*Bv.scaleFactor),Bt=Bs.bgImg.height/((Bv.getHeight()-Bv.borderSpace*2)*Bv.scaleFactor),Bu=Math.max(Bt,Bk);Bv.topOffset=(Bv.getHeight()*Bv.scaleFactor-Bv.oriBgImageHeight/Bu)/2;Bv.leftOffset=(Bv.getWidth()*Bv.scaleFactor-Bv.oriBgImageWidth/Bu)/2;Bj.drawImage(Bs.bgImg,Bv.leftOffset,Bv.topOffset,Bv.oriBgImageWidth/Bu,Bv.oriBgImageHeight/Bu);if(Bv.shapeFileType===An){var Bn={};for(Br in Bw){if(Bw.hasOwnProperty(Br)){if(Br==="bgImage"){continue;}var Bi=BG(Bw[Br][0]);Bn[Br]=Bi;Bn[Br][0][0]/=Bu;Bn[Br][0][1]/=Bu;}}Bs.polygonCenters=Bn;}else{var Bq=Bv.oriCoords;for(Br in Bw){if(Bw.hasOwnProperty(Br)){if(Br==="bgImage"){continue;}Bx=Bw[Br][0];Bx[0]=parseInt(Bq[Br][0]/Bu,10);Bx[1]=parseInt(Bq[Br][1]/Bu,10);}}}Bv.drawBubblesInMap();}else{Bs.bgImg=new Image();Bs.bgImg.onerror=function(){var By="The backgrond Image cannot be found.";Bv.renderErrorMessage(mstrmojo.desc(9856,By));return ;};Bs.bgImg.onload=function(){Bv.drawBgImageFlag=true;if(!Bv.hasOwnProperty("oriBgImageWidth")){Bv.oriBgImageWidth=this.width;}if(!Bv.hasOwnProperty("oriBgImageHeight")){Bv.oriBgImageHeight=this.height;}if(!Bv.hasOwnProperty("oriCoords")){Bv.oriCoords=Bv.storeOriPoints();}var B1=this.width/((Bv.getWidth()-Bv.borderSpace*2)*Bv.scaleFactor),B0=this.height/((Bv.getHeight()-Bv.borderSpace*2)*Bv.scaleFactor),B2=Math.max(B0,B1);Bv.topOffset=(Bv.getHeight()*Bv.scaleFactor-Bv.oriBgImageHeight/B2)/2;Bv.leftOffset=(Bv.getWidth()*Bv.scaleFactor-Bv.oriBgImageWidth/B2)/2;Bv.animationCanvas.width=Bv.animationCanvas.width;Bj.drawImage(this,Bv.leftOffset,Bv.topOffset,Bv.oriBgImageWidth/B2,Bv.oriBgImageHeight/B2);if(Bv.shapeFileType===An){var Bz={};for(Br in Bw){if(Bw.hasOwnProperty(Br)){if(Br==="bgImage"){continue;}var By=BG(Bw[Br][0]);Bz[Br]=By;Bz[Br][0][0]/=B2;Bz[Br][0][1]/=B2;}}Bs.polygonCenters=Bz;}else{var B3=Bv.oriCoords;for(Br in Bw){if(Bw.hasOwnProperty(Br)){if(Br==="bgImage"){continue;}Bx=Bw[Br][0];Bx[0]=parseInt(B3[Br][0]/B2,10);Bx[1]=parseInt(B3[Br][1]/B2,10);}}}Bv.drawBubblesInMap();if(!Bv.bgImageScreenshotTaken){Bv.bgImageScreenshotTaken=true;Bv.localTakeScreenshot(BK);}};}if(Bw.hasOwnProperty("bgImage")&&Bw.bgImage!==""){if(!Bs.hasOwnProperty("bgImg")||!Bs.bgImg.hasOwnProperty("src")||Bs.bgImg.src==""||Bs.bgImg.src==null){var Bl=Bw.bgImage;Bs.bgImg.src=Bv.getFullPath(Bl);}}else{if(Bv.shapeFileType===An){Bv.drawBgImageFlag=false;Bv.scalePolygonCoords();Bv.drawPolygonInMap(w);var Bn={};for(Br in Bw){if(Bw.hasOwnProperty(Br)){if(Br==="bgImage"){continue;}var Bi=BG(Bw[Br][0]);Bn[Br]=Bi;}}Bs.polygonCenters=Bn;Bv.drawBubblesInMap();}}},drawAreaMap:function A0(){var B0=this,Bj=B0.model,Bi=this.animationContext,Bs=Bj.coords,Bv,Bt,Br,Bp,Bu,Bk,Bw,Bz,Bo;if(!Bj.hasOwnProperty("oriPolyCoords")){B0.getOriPolygonCoords();}var Bq=Bj.oriPolyCoords;Bi.save();Bi.lineWidth=2;Bi.strokeStyle="#AAAAAA";if(Bj.hasOwnProperty("bgImg")&&Bj.bgImg.hasOwnProperty("src")&&Bj.bgImg.src!=""&&Bj.bgImg.src!=null){if(B0.shapeFileType===AQ){B0.drawBgImageFlag=false;}else{if(B0.shapeFileType===An){B0.drawBgImageFlag=true;if(!B0.hasOwnProperty("oriBgImageWidth")){B0.oriBgImageWidth=Bj.bgImg.width;}if(!B0.hasOwnProperty("oriBgImageHeight")){B0.oriBgImageHeight=Bj.bgImg.height;}var Bm=Bj.bgImg.width/((B0.getWidth()-B0.borderSpace*2)*B0.scaleFactor),Bn=Bj.bgImg.height/((B0.getHeight()-B0.borderSpace*2)*B0.scaleFactor),Bl=Math.max(Bn,Bm);B0.topOffset=(B0.getHeight()*B0.scaleFactor-B0.oriBgImageHeight/Bl)/2;B0.leftOffset=(B0.getWidth()*B0.scaleFactor-B0.oriBgImageWidth/Bl)/2;Bi.drawImage(Bj.bgImg,B0.leftOffset,B0.topOffset,B0.oriBgImageWidth/Bl,B0.oriBgImageHeight/Bl);for(Bt in Bs){if(Bs.hasOwnProperty(Bt)){if(Bt==="bgImage"){continue;}Bu=Bs[Bt];oriRgn=Bq[Bt];for(Br in Bu){if(Bu.hasOwnProperty(Br)){Bw=Bu[Br];Bz=oriRgn[Br];for(Bp=0;Bp<Bw.length;Bp++){Bw[Bp]=parseInt(Bz[Bp]/Bl,10);}}}}}var By={};for(Bt in Bs){if(Bs.hasOwnProperty(Bt)){if(Bt==="bgImage"){continue;}var Bx=BG(Bs[Bt][0]);By[Bt]=Bx;}}Bj.polygonCenters=By;B0.drawPolygonInMap(AK);}}}else{Bj.bgImg=new Image();Bj.bgImg.onerror=function(){var B1="The backgrond Image cannot be found.";B0.renderErrorMessage(mstrmojo.desc(9856,B1));return ;};Bj.bgImg.onload=function(){if(B0.shapeFileType===AQ){B0.drawBgImageFlag=false;}else{if(B0.shapeFileType===An){B0.drawBgImageFlag=true;if(!B0.hasOwnProperty("oriBgImageWidth")){B0.oriBgImageWidth=this.width;}if(!B0.hasOwnProperty("oriBgImageHeight")){B0.oriBgImageHeight=this.height;}var B4=this.width/((B0.getWidth()-B0.borderSpace*2)*B0.scaleFactor),B3=this.height/((B0.getHeight()-B0.borderSpace*2)*B0.scaleFactor),B5=Math.max(B3,B4);B0.topOffset=(B0.getHeight()*B0.scaleFactor-B0.oriBgImageHeight/B5)/2;B0.leftOffset=(B0.getWidth()*B0.scaleFactor-B0.oriBgImageWidth/B5)/2;Bi.drawImage(this,B0.leftOffset,B0.topOffset,B0.oriBgImageWidth/B5,B0.oriBgImageHeight/B5);for(Bt in Bs){if(Bs.hasOwnProperty(Bt)){if(Bt==="bgImage"){continue;}Bu=Bs[Bt];oriRgn=Bq[Bt];for(Br in Bu){if(Bu.hasOwnProperty(Br)){Bw=Bu[Br];Bz=oriRgn[Br];for(Bp=0;Bp<Bw.length;Bp++){Bw[Bp]=parseInt(Bz[Bp]/B5,10);}}}}}var B2={};for(Bt in Bs){if(Bs.hasOwnProperty(Bt)){if(Bt==="bgImage"){continue;}var B1=BG(Bs[Bt][0]);B2[Bt]=B1;}}Bj.polygonCenters=B2;B0.drawPolygonInMap(AK);}}if(!B0.bgImageScreenshotTaken){B0.bgImageScreenshotTaken=true;B0.localTakeScreenshot(BK);}};}if(Bs.hasOwnProperty("bgImage")&&Bs.bgImage!==""){if(!Bj.bgImg.hasOwnProperty("src")||Bj.bgImg.src==""||Bj.bgImg.src==null){Bj.bgImg.src=B0.getFullPath(Bs.bgImage);}}else{if(B0.shapeFileType===An){B0.drawBgImageFlag=false;this.scalePolygonCoords();var By={};for(Bt in Bs){if(Bs.hasOwnProperty(Bt)){if(Bt==="bgImage"){continue;}var Bx=BG(Bs[Bt][0]);By[Bt]=Bx;}}Bj.polygonCenters=By;this.drawPolygonInMap(Bd);}}Bi.restore();},getHeaderIndex:function BX(Bm){var Bl=-1,Bk=this.model.gts.row[0].es,Bj;if(Bm){Bm=Bm.toLowerCase();for(Bj=0;Bj<Bk.length;Bj++){var Bi=Bk[Bj].n;if(Bi&&Bi.toLowerCase()===Bm){Bl=Bj;break;}}}return Bl;},getNewColorForOpacityChange:function AI(Bn,Bo,Bk,Bj,Bm){if(Bj>1||Bj<0||Bm>1||Bm<0){return Bk;}var Bi=0.0001,Bl=Bn;if(!Bn||Bo){Bl="#FFFFFF";}if(Bm>=Bj){if(Bj+Bi>1){return Bk;}else{return BY(Bk,(Bm-Bj)/(1-Bj));}}else{if(Bm<Bj){if(Bj-Bi<0){return BY(Bk,0);}else{return BY(Bl,(Bj-Bm)/Bj);}}}},drawPartOpacityBG:function AE(Bs,Br,Bk){Bs.save();var B0=this,Bj=B0.model,Bw=B0.leftOffset?B0.leftOffset:0,Bv=B0.topOffset?B0.topOffset:0;var Bi=function(B1){var B2=B1%2?Bv:Bw;return Bq[B1]+B2;};Bs.beginPath();var Bu,Bt;for(Bu=0;Bu<Br.length;Bu++){var Bq=Br[Bu],Bz=Bi(0),By=Bi(1),Bx=Bi(1),Bo,Bn;Bs.moveTo(Bi(0),Bi(1));for(Bt=2;Bt<Bq.length-1;Bt=Bt+2){Bo=Bi(Bt);Bn=Bi(Bt+1);Bs.lineTo(Bo,Bn);Bx=Math.max(Bn,Bx);By=Math.min(Bn,By);Bz=Math.min(Bo,Bz);}Bo=Bi(0);Bn=Bi(1);Bs.lineTo(Bo,Bn);}Bs.clip();Bs.globalAlpha=Bk;var Bm=B0.oriBgImageWidth/((B0.getWidth()-B0.borderSpace*2)*B0.scaleFactor),Bp=B0.oriBgImageHeight/((B0.getHeight()-B0.borderSpace*2)*B0.scaleFactor),Bl=Math.max(Bp,Bm);B0.topOffset=(B0.getHeight()*B0.scaleFactor-B0.oriBgImageHeight/Bl)/2;B0.leftOffset=(B0.getWidth()*B0.scaleFactor-B0.oriBgImageWidth/Bl)/2;Bs.drawImage(Bj.bgImg,B0.leftOffset,B0.topOffset,B0.oriBgImageWidth/Bl,B0.oriBgImageHeight/Bl);Bs.restore();},highlightImageIcon:function BR(Bl,Bs,Bt,Bp){var Bq=this,Bn=Bq.model,Bj="RGBA(255,255,255,0.5)",Br="imageIcon_"+Bt;if(Bn.hasOwnProperty(Br)){var Bm=Bn[Br],Bi=Bm.width+Bp*2,Bu=Bm.height+Bp*2,Bo=Bs[Bt][0][0]-Bi/2+Bq.leftOffset,Bk=Bs[Bt][0][1]-Bu/2+Bq.topOffset;Bl.fillStyle=Bj;Bl.fillRect(Bo,Bk,Bi,Bu);Ba(Bl,Bo,Bk,Bi,Bu);}},highlightPoint:function Az(){var Bw=this,Bm=Bw.model,B6=Bw.highlightContext,B4;Bw.highlightCanvas.width=Bw.highlightCanvas.width;if(Bw.currSelectedObj===null&&N(Bw.defaultSelectedObjs)&&Bw.displayMode===T){if(Bw.drawBgImageFlag){if(Bw.curPolygonOpacity!==AK){Bw.drawPolygonInMap(AK);}}else{if(Bw.curPolygonOpacity!==Bd){Bw.drawPolygonInMap(Bd);}}}if(Bw.displayMode===T){var B9=Bm.bgColor,CG=U,Bx=BH,CB=As,B7=Ao,Br=Aq;if(Bm.themeMode===s){CG=BA;Bx=J;CB=Aa;B7=A3;Br=A5;}if(Bm.vp&&Bm.vp.npc){B7=BY("#"+Bm.vp.npc,Bd);}var CM=B7;var CC=Bw.defaultSelectedObjs;if(!N(CC)){if(Bw.curPolygonOpacity!==Ap){Bw.drawPolygonInMap(Ap);}var CH;for(CH in CC){if(CC.hasOwnProperty(CH)){if(Bw.currHoverObj!==null&&Bw.currHoverObj.hasOwnProperty("touchVal")&&Bw.currHoverObj.touchVal!==""&&Bw.currHoverObj.touchVal!==null&&Bw.currHoverObj.touchVal===CH){continue;}else{var Bk=Bw.defaultSelectedObjs[CH];if(Bk>=0){if(Bw.colorByIndex>=0){if(Bw.thresholdType===AO){var B2=Bm.gvs.items[Bw.getIndexFromHdrindex(Bk)].items[Bw.colorByIndex];CM=Bw.getBgColorFromCSS(B2);if(!CM){CM=Br;}}else{CM=Br;}}else{CM=Br;}}else{CM=B7;}if(Bw.drawBgImageFlag){CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Ap,BD);}else{CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Ap,BQ);}AT(B6,Bm.coords[CH],{x:Bw.leftOffset,y:Bw.topOffset},CG,Bw.highlightPolygonStrokeWidth,CM);}}}CM=B7;}else{if(Bw.currSelectedObj!==null&&Bw.currSelectedObj.hasOwnProperty("touchVal")&&Bw.currSelectedObj.touchVal!==""&&Bw.currSelectedObj.touchVal!==null){if(Bw.curPolygonOpacity!==Ap){Bw.drawPolygonInMap(Ap);}if(Bw.currHoverObj!==null&&Bw.currHoverObj.hasOwnProperty("touchVal")&&Bw.currHoverObj.touchVal!==""&&Bw.currHoverObj.touchVal!==null&&Bw.currHoverObj.touchVal===Bw.currSelectedObj.touchVal){}else{if(Bw.currSelectedObj.hasOwnProperty("hdrIndex")){B4=Bw.currSelectedObj.hdrIndex;}else{B4=Bw.getHeaderIndex(Bw.currSelectedObj.touchVal);}if(B4>=0){if(Bw.colorByIndex>=0){if(Bw.thresholdType===AO){var B2=Bm.gvs.items[Bw.getIndexFromHdrindex(B4)].items[Bw.colorByIndex];CM=Bw.getBgColorFromCSS(B2);if(!CM){CM=Br;}}else{CM=Br;}}else{CM=Br;}}else{CM=B7;}if(Bw.drawBgImageFlag){CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Ap,BD);}else{CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Ap,BQ);}AT(B6,Bm.coords[Bw.currSelectedObj.touchVal],{x:Bw.leftOffset,y:Bw.topOffset},CG,Bw.highlightPolygonStrokeWidth,CM);}}else{if(Bw.currLinkObj!==null&&Bw.currLinkObj.hasOwnProperty("touchVal")&&Bw.currLinkObj.touchVal!==""&&Bw.currLinkObj.touchVal!==null){if(Bw.currLinkObj.hasOwnProperty("hdrIndex")){B4=Bw.currLinkObj.hdrIndex;}else{B4=Bw.getHeaderIndex(Bw.currLinkObj.touchVal);}if(B4>=0){if(Bw.colorByIndex>=0){if(Bw.thresholdType===AO){var B2=Bm.gvs.items[Bw.getIndexFromHdrindex(B4)].items[Bw.colorByIndex];CM=Bw.getBgColorFromCSS(B2);if(!CM){CM=Br;}}else{CM=Br;}}else{CM=Br;}}else{CM=B7;}if(Bw.drawBgImageFlag){CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,AK,H);}else{CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Bd,H);}AT(B6,Bm.coords[Bw.currLinkObj.touchVal],{x:Bw.leftOffset,y:Bw.topOffset},Bx,Bw.highlightPolygonStrokeWidth,CM);}}}if(Bw.currHoverObj!==null&&Bw.currHoverObj.hasOwnProperty("touchVal")&&Bw.currHoverObj.touchVal!==""&&Bw.currHoverObj.touchVal!==null){var CA=Bw.currHoverObj;if(CA.hasOwnProperty("hdrIndex")){B4=CA.hdrIndex;}else{B4=Bw.getHeaderIndex(CA.touchVal);}if(B4>=0){if(Bw.colorByIndex>=0){if(Bw.thresholdType===AO){var B2=Bm.gvs.items[Bw.getIndexFromHdrindex(B4)].items[Bw.colorByIndex];CM=Bw.getBgColorFromCSS(B2);if(!CM){CM=Br;}}else{CM=Br;}}else{CM=Br;}}else{CM=B7;}if(Bw.currSelectedObj!==null||!N(Bw.defaultSelectedObjs)){if(Bw.drawBgImageFlag){CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Ap,AD);}else{CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Ap,BM);}AT(B6,Bm.coords[Bw.currHoverObj.touchVal],{x:Bw.leftOffset,y:Bw.topOffset},CB,Bw.highlightPolygonStrokeWidth,CM);}else{if(Bw.drawBgImageFlag){var B5=(AK-p)/AK;this.drawPartOpacityBG(B6,Bm.coords[Bw.currHoverObj.touchVal],B5);CM="RGBA(0,0,0,0)";AT(B6,Bm.coords[Bw.currHoverObj.touchVal],{x:Bw.leftOffset,y:Bw.topOffset},Bx,Bw.highlightPolygonStrokeWidth,CM);}else{CM=this.getNewColorForOpacityChange(B9,Bw.drawBgImageFlag,CM,Bd,p);AT(B6,Bm.coords[Bw.currHoverObj.touchVal],{x:Bw.leftOffset,y:Bw.topOffset},Bx,Bw.highlightPolygonStrokeWidth,CM);}}if(Bw.newRenderFlag){Bw.newRenderFlag=false;var CJ=Bw.model.polygonCenters&&Bw.model.polygonCenters[Bw.currHoverObj.touchVal]&&Bw.model.polygonCenters[Bw.currHoverObj.touchVal][0];if(CJ){var B8=CJ[0]+Bw.leftOffset-Bw._scroller.origin.x;var Bn=CJ[1]+Bw.topOffset-Bw._scroller.origin.y;Bw.renderTooltip(this.currHoverObj.touchVal,B8,Bn,this.currHoverObj.hdrIndex);}}else{Bw.renderTooltip(this.currHoverObj.touchVal,this.currHoverObj.point.x,this.currHoverObj.point.y,this.currHoverObj.hdrIndex);}}}else{if(Bw.displayMode===A7){var CG=BN,Bx=AL,Bz=AW,CI=Bc,Br=At;if(Bm.themeMode===s){CG=BW;Bx=BL;Bz=S;CI=Ak;Br=e;}if(Bw.markerType===AF){Bw.drawBubblesInMap();var CC=Bw.defaultSelectedObjs;if(!N(CC)){var CH;for(CH in CC){if(CC.hasOwnProperty(CH)){var Bp=Bw.getRadiusFromName(CH);CM=Bw.getBubbleColorFromName(CH);if(!CM){continue;}CM=BY(CM,g);if(Bw.shapeFileType===An){if(Bm.hasOwnProperty("polygonCenters")){Bu=Bm.polygonCenters[CH][0];}}else{if(Bw.shapeFileType===AQ){Bu=Bm.coords[CH][0];}}L(B6,Bu,{x:Bw.leftOffset,y:Bw.topOffset},CM,Bp);R(B6,Bu,{x:Bw.leftOffset,y:Bw.topOffset},CG,Bp,Bw.bubbleStrokeWidth);}}CM=B7;}else{if(Bw.currSelectedObj!==null&&Bw.currSelectedObj.hasOwnProperty("touchVal")&&Bw.currSelectedObj.touchVal!==""&&Bw.currSelectedObj.touchVal!==null){var CM=Br,Bu,Bp;Bp=Bw.getRadiusFromName(Bw.currSelectedObj.touchVal);CM=Bw.getBubbleColorFromName(Bw.currSelectedObj.touchVal);if(!CM){CM=Br;}CM=BY(CM,g);if(Bw.shapeFileType===An){if(Bm.hasOwnProperty("polygonCenters")){Bu=Bm.polygonCenters[Bw.currSelectedObj.touchVal][0];}}else{if(Bw.shapeFileType===AQ){Bu=Bm.coords[Bw.currSelectedObj.touchVal][0];}}L(B6,Bu,{x:Bw.leftOffset,y:Bw.topOffset},CM,Bp);R(B6,Bu,{x:Bw.leftOffset,y:Bw.topOffset},CG,Bp,Bw.bubbleStrokeWidth);}else{if(Bw.currLinkObj!==null&&Bw.currLinkObj.hasOwnProperty("touchVal")&&Bw.currLinkObj.touchVal!==""&&Bw.currLinkObj.touchVal!==null){var CE,CL;CL=Bw.getRadiusFromName(Bw.currLinkObj.touchVal);CM=Bw.getBubbleColorFromName(Bw.currLinkObj.touchVal);if(!CM){CM=Br;}CM=BY(CM,A4);if(Bw.shapeFileType===An){if(Bm.hasOwnProperty("polygonCenters")){CE=Bm.polygonCenters[Bw.currLinkObj.touchVal][0];}}else{if(Bw.shapeFileType===AQ){CE=Bm.coords[Bw.currLinkObj.touchVal][0];}}L(B6,CE,{x:Bw.leftOffset,y:Bw.topOffset},CM,CL);R(B6,CE,{x:Bw.leftOffset,y:Bw.topOffset},Bz,CL,Bw.bubbleStrokeWidth);R(B6,CE,{x:Bw.leftOffset,y:Bw.topOffset},CI,CL+Bw.hoverBubbleRadiusLarger,Bw.bubbleStrokeWidth);}}}if(Bw.currHoverObj!==null&&Bw.currHoverObj.hasOwnProperty("touchVal")&&Bw.currHoverObj.touchVal!==""&&Bw.currHoverObj.touchVal!==null){var Bv,Bo,CF=Bw.currHoverObj.touchVal;Bo=Bw.getRadiusFromName(CF);CM=Bw.getBubbleColorFromName(CF);if(!CM){CM=Br;}var Bl=Bx;if((Bw.currSelectedObj&&Bw.currSelectedObj.touchVal===CF)||(!N(Bw.defaultSelectedObjs)&&Bw.defaultSelectedObjs.hasOwnProperty(CF))){CM=BY(CM,g);Bl=CG;}else{CM=BY(CM,AG);}if(Bw.shapeFileType===An){if(Bm.hasOwnProperty("polygonCenters")){Bv=Bm.polygonCenters[Bw.currHoverObj.touchVal][0];}}else{if(Bw.shapeFileType===AQ){Bv=Bm.coords[Bw.currHoverObj.touchVal][0];}}L(B6,Bv,{x:Bw.leftOffset,y:Bw.topOffset},CM,Bo);R(B6,Bv,{x:Bw.leftOffset,y:Bw.topOffset},Bl,Bo,Bw.bubbleStrokeWidth);R(B6,Bv,{x:Bw.leftOffset,y:Bw.topOffset},CI,Bo+Bw.hoverBubbleRadiusLarger,Bw.bubbleStrokeWidth);if(Bw.newRenderFlag){Bw.newRenderFlag=false;var Bt;if(Bw.shapeFileType===An){Bt=Bw.model.polygonCenters&&Bw.model.polygonCenters[Bw.currHoverObj.touchVal]&&Bw.model.polygonCenters[Bw.currHoverObj.touchVal][0];}else{if(Bw.shapeFileType===AQ){Bt=Bw.model.coords&&Bw.model.coords[Bw.currHoverObj.touchVal]&&Bw.model.coords[Bw.currHoverObj.touchVal][0];}}if(Bt){var B8=Bt[0]+Bw.leftOffset-Bw._scroller.origin.x;var Bn=Bt[1]+Bw.topOffset-Bw._scroller.origin.y;Bw.renderTooltip(this.currHoverObj.touchVal,B8,Bn,this.currHoverObj.hdrIndex);}}else{Bw.renderTooltip(this.currHoverObj.touchVal,this.currHoverObj.point.x,this.currHoverObj.point.y,this.currHoverObj.hdrIndex);}}}else{if(Bw.markerType===AH){var Bs=Bm.coords;if(Bm.hasOwnProperty("polygonCenters")){Bs=Bm.polygonCenters;}var CC=Bw.defaultSelectedObjs;if(!N(CC)){var CH;for(CH in CC){if(CC.hasOwnProperty(CH)){Bw.highlightImageIcon(B6,Bs,CH,0);}}}else{if(Bw.currSelectedObj!==null&&Bw.currSelectedObj.hasOwnProperty("touchVal")&&Bw.currSelectedObj.touchVal!==""&&Bw.currSelectedObj.touchVal!==null){var B3=Bw.currSelectedObj.touchVal;Bw.highlightImageIcon(B6,Bs,B3,0);}else{if(Bw.currLinkObj!==null&&Bw.currLinkObj.hasOwnProperty("touchVal")&&Bw.currLinkObj.touchVal!==""&&Bw.currLinkObj.touchVal!==null){var B3=Bw.currLinkObj.touchVal;Bw.highlightImageIcon(B6,Bs,B3,Bw.hoverBubbleRadiusLarger);}}}if(Bw.currHoverObj!==null&&Bw.currHoverObj.hasOwnProperty("touchVal")&&Bw.currHoverObj.touchVal!==""&&Bw.currHoverObj.touchVal!==null){var B3=Bw.currHoverObj.touchVal,CM="RGBA(255,255,255,0.5)";var CD="imageIcon_"+B3;if(Bm.hasOwnProperty(CD)){var By=Bm[CD],Bi=By.width+Bw.hoverBubbleRadiusLarger*2,Bj=By.height+Bw.hoverBubbleRadiusLarger*2,B0=Bs[B3][0][0]-Bi/2+Bw.leftOffset,B1=Bs[B3][0][1]-Bj/2+Bw.topOffset;B6.fillStyle=CM;B6.fillRect(B0,B1,Bi,Bj);var Bq=Bw.currSelectedObj,CK=Bw.currHoverObj.touchVal;if((Bq!==null&&Bq.hasOwnProperty("hdrIndex")&&Bq.hdrIndex>=0&&Bq.touchVal===CK)||(!N(Bw.defaultSelectedObjs)&&Bw.defaultSelectedObjs.hasOwnProperty(CK))){}else{Ba(B6,B0,B1,Bi,Bj);}}if(Bw.newRenderFlag){Bw.newRenderFlag=false;var Bt;if(Bw.shapeFileType===An){Bt=Bw.model.polygonCenters&&Bw.model.polygonCenters[Bw.currHoverObj.touchVal]&&Bw.model.polygonCenters[Bw.currHoverObj.touchVal][0];}else{if(Bw.shapeFileType===AQ){Bt=Bw.model.coords&&Bw.model.coords[Bw.currHoverObj.touchVal]&&Bw.model.coords[Bw.currHoverObj.touchVal][0];}}if(Bt){var B8=Bt[0]+Bw.leftOffset-Bw._scroller.origin.x;var Bn=Bt[1]+Bw.topOffset-Bw._scroller.origin.y;Bw.renderTooltip(this.currHoverObj.touchVal,B8,Bn,this.currHoverObj.hdrIndex);}}else{Bw.renderTooltip(this.currHoverObj.touchVal,this.currHoverObj.point.x,this.currHoverObj.point.y,this.currHoverObj.hdrIndex);}}}}}}},getTouchValue:function Ag(Bt,Br){var Bq=this,Bn=this.model,Bs=Bn.coords,Bk,Bm;if(Bq.displayMode===T){if(Bq.shapeFileType===An){for(Bk in Bs){if(Bs.hasOwnProperty(Bk)){if(Bk==="bgImage"){continue;}var Bi=Bs[Bk],Bl=Bi.length;for(Bm=0;Bm<Bl;Bm++){if(P(Bi[Bm],Bt,Br)){return Bk;}}}}}}else{if(Bq.displayMode===A7){if(Bq.shapeFileType===An&&Bn.hasOwnProperty("polygonCenters")){Bs=Bn.polygonCenters;}var Bu=Number.MAX_VALUE,Bp="";for(Bk in Bs){if(Bs.hasOwnProperty(Bk)){if(Bk==="bgImage"){continue;}var Bo=Bs[Bk][0],Bj=Math.sqrt((Bt-Bo[0])*(Bt-Bo[0])+(Br-Bo[1])*(Br-Bo[1]));if(Bj<Bu){Bu=Bj;Bp=Bk;}}}if(Bu<this.bias){return Bp;}}}return null;},getAreaOrNearestBubble:function(Bm,Bt,Bs){var Bn=this,Bl=Bn.model,Bq=Bl.coords;var Bj=Bn.utils.getTouchXYOnWidget(Bt,Bs,Bn);Bt=Bj.touchX;Bs=Bj.touchY;var Br=Bt+Bn._scroller.origin.x-Bn.leftOffset,Bo=Bs+Bn._scroller.origin.y-Bn.topOffset,Bp;if(Bm&&Bn.tooltipOn&&Bn.currHoverObj!==null){var Bk=null;if(Bn.shapeFileType===An){Bk=Bl.polygonCenters&&Bl.polygonCenters[Bn.currHoverObj.touchVal]&&Bl.polygonCenters[Bn.currHoverObj.touchVal][0];}else{if(Bn.shapeFileType===AQ){Bk=Bq[Bn.currHoverObj.touchVal]&&Bq[Bn.currHoverObj.touchVal][0];}}if(Bk){var Bi=Math.sqrt((Br-Bk[0])*(Br-Bk[0])+(Bo-Bk[1])*(Bo-Bk[1]));if(Bi<Bn.bias){Bp=Bn.currHoverObj.touchVal;}else{Bp=Bn.getTouchValue(Br,Bo);}}}else{Bp=Bn.getTouchValue(Br,Bo);}if(!Bp){return null;}var Bu=Bn.getHeaderIndex(Bp);return{touchVal:Bp,hdrIndex:Bu,point:{x:Bt,y:Bs}};},renderTooltip:function M(Bi,B0,Bz,Bk){var CE=this,Bt=this.tooltip,Br=this.model,CC=this.tooltip.childNodes[0],B1=0,B9,B7,Bl,Bx,CD;if(CC){for(B9=0;B9<CC.childNodes.length;B9++){Bl=CC.childNodes[B9];if(Bl){Bl.childNodes[0].innerHTML="";Bl.childNodes[1].innerHTML="";}}}this.tooltip.style.visibility="visible";if(!CE.tooltipOn){CE.tooltipOn=true;var Bs=mstrmojo.touchManager;CE.tooltipListener=Bs.attachEventListener("touchesBegin",CE.id,function(CF){if(!CE.isTouchedOnWidget(CF.touch)){CE.hideTooltip();}});}var Bj=Br.gts,B5,Bn;if(Bk>=0){var By=Bj.row,Bv=Br.ghs.rhs.items,B3;Bl=B1<CC.childNodes.length&&CC.childNodes[B1++];if(Bl){Bl.childNodes[0].style.display="table-cell";Bl.childNodes[1].style.align="left";Bl.childNodes[0].style.paddingRight="5px";B5=By[0].n+":";Bl.childNodes[0].innerHTML=B5;Bn=By[0].es[Bk].n;Bl.childNodes[1].innerHTML=Bn;}var Bw=CE.getIndexFromHdrindex(Bk);for(B9=1;B9<By.length;B9++){Bl=B1<CC.childNodes.length&&CC.childNodes[B1++];if(Bl){Bl.childNodes[0].style.paddingRight="5px";B5=By[B9].n+":";Bl.childNodes[0].innerHTML=B5;Bn="";var Bp=CE.attrIndices[B9];if(Bp){for(B7=0;B7<Bp.length;B7++){B3=Bv[Bw].items[Bp[B7]].idx;Bn+=By[B9].es[B3].n;if(B7!==Bp.length-1){Bn+=" ";}}}Bl.childNodes[1].innerHTML=Bn;}}var CB=Bj.col;if(CB&&CB.length>0){var B6=CB[0].es,Bm=Br.gvs.items[Bw].items;for(B9=0;B9<B6.length;B9++){Bl=B1<CC.childNodes.length&&CC.childNodes[B1++];if(Bl){Bl.childNodes[0].style.paddingRight="5px";var B4=Bm[B9],B2=B4.v;if(B4&&B4.hasOwnProperty("ty")&&B4.ty!=4&&B4.ty!=10&&B4.ty!=3&&B4.hasOwnProperty("ti")){var Bu=Br.th&&Br.th[B9];B2=(Bu&&Bu[B4.ti]&&Bu[B4.ti].n)?Bu[B4.ti].n:B4.v;}B5=B6[B9].n+":";Bl.childNodes[0].innerHTML=B5;Bn=""+B2;Bl.childNodes[1].innerHTML=Bn;}}}else{}}else{if(Bk<0){Bn=Bi;Bl=B1<CC.childNodes.length&&CC.childNodes[B1++];if(Bl){Bl.childNodes[1].innerHTML=Bn;Bl.childNodes[0].style.display="none";Bl.childNodes[1].style.align="center";}}}var CA=B0+this.bias,B8=Bz-this.bias-Bt.offsetHeight,Bq=this.getWidth()-Bt.offsetWidth-this.tooltipRightShadowWidth,Bo=this.getHeight()-Bt.offsetHeight;if(CA>Bq){if(B8<0){B8=0;CA=Math.max(B0-this.bias-Bt.offsetWidth,0);}else{if(B8>=0){CA=Bq;}}}else{if(CA<=Bq){if(B8<0){B8=0;}else{if(B8>=0){}}}}BT(Bt,CA,B8);},hideTooltip:function Af(){if(this.tooltipOn){this.tooltipOn=false;this.currHoverObj=null;this.highlightPoint();this.tooltip.style.visibility="hidden";if(this.tooltipListener){mstrmojo.touchManager.detachEventListener(this.tooltipListener);delete this.tooltipListener;}}},isTouchedOnWidget:function Ai(Bm){if(!Bm){return false;}var Bk=this,Bj=Bk.utils.getTouchXYOnWidget(Bm.pageX,Bm.pageY,Bk),Bi=Bj.touchX,Bl=Bj.touchY;if((Bi>0&&Bi<Bk.getWidth())&&(Bl>0&&Bl<Bk.getHeight())){return true;}return false;},unrender:function Ab(Bj){var Bk=this,Bi=Bk.model;if(this._super){this._super(Bj);}if(Bk.docModelListener){if(Bk.xtabModel&&Bk.xtabModel.docModel){Bk.xtabModel.docModel.detachEventListener(Bk.docModelListener);}delete Bk.docModelListener;}if(Bk.fullScreenListener){mstrmojo.touchManager.detachEventListener(Bk.fullScreenListener);delete Bk.fullScreenListener;}if(Bk.tooltipListener){mstrmojo.touchManager.detachEventListener(Bk.tooltipListener);delete Bk.tooltipListener;}if(Bk.highlightContext){delete Bk.highlightContext;}if(Bk.animationContext){delete Bk.animationContext;}if(Bk._tn){delete Bk._tn;}},destroy:function K(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo._HasTouchScroller");var P="Helvetica",d="bold 14px Helvetica",X="bold 20px Helvetica",O=30,N=1;function E(f){N=f;d="bold "+Math.round(14*N)+"px Helvetica";X="bold "+Math.round(20*N)+"px Helvetica";O=Math.round(30*N);}function a(g){var f=mstrmojo.dom.findAncestorByAttr(g.target,"clk",true,this.domNode);return f||null;}function C(){var f=this._scroller;var g=this.height-this.legendBarSwitcher.height-15*N;var h=this.legendListDiv.offsetHeight;if(h>g){this.scrollPast=true;}var k=h>g?h-g:0;f.origin={x:0,y:0};f.showScrollbars=true;f.noVScroll=false;f.vScroll=(k!==0&&f.noVScroll!==true)||this.scrollPast;if(f.vScroll){f.offset={y:{start:0,end:k},scrollPast:this.scrollPast};}var j=this.legendListDiv;this.utils.translateCSS(0,0,false,j);}mstrmojo.VisTimeSeriesLegend=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisTimeSeriesLegend",scrollerConfig:{bounces:false,showScrollbars:true,useTranslate3d:true},multiTouch:true,scrollPast:false,isAndroidTab:false,legendBarWidth:30,isLegendBarOpen:false,isLegendSelected:false,legendSelectedIndex:-1,maxLegendAttrLength:0,widget:null,y_axis_interval:25,markupString:'<div id="{@id}-legend-bar" style="position:absolute;top:{@top};right:{@right};z-index:{@zIndex};" ><div id="{@id}-legend-switcher" class="mstrmojo-timeseries-legend-switcher" clk="S"><canvas id="{@id}-legend-triangle" width="15px" height="17px" style="position:absolute;" ></canvas><div id="{@id}-legend-shadow" class="timeseries-legend-switcher-shadow" style="height:0px; width:0px;position:absolute"></div></div><div class="mstrmojo-timeseries-legend-List-Div" style="overflow:hidden;"><div id="{@id}-legend-List" ></div></div><canvas style="z-index:-1;" clk="C"></canvas></div>',markupSlots:{legendBarDiv:function(){return this.domNode;},legendBarSwitcher:function(){return this.domNode.firstChild;},triangle:function(){return this.domNode.firstChild.firstChild;},legendListDivContainer:function(){return this.domNode.childNodes[1];},legendListDiv:function(){return this.domNode.childNodes[1].firstChild;},legendCanvas:function(){return this.domNode.childNodes[2];}},switchLegendBar:function T(){this.isLegendBarOpen=!this.isLegendBarOpen;this.calculateAndSetLegendWidth();this.widget.reDrawSlaveChartImpl();this.renderLegend(true);C.call(this);},enableLegendGlowEffect:function Q(h,g){var j=this.legendListDiv.childNodes[h];var f=g||j.style.color;j.style.textShadow=f+"0px 0px 8px";j.style.font=X;},hiddenLegendGlowEffect:function A(f){var g=this.legendListDiv.childNodes[f];g.style.textShadow="none";g.style.font=d;},toggleTriangle:function e(j){var h=this.triangle,o=h.style,g=h.getContext("2d"),l=this.widget;var k=Math.round(17*N),f=Math.round(15*N);h.height=k;h.width=f;o.top=Math.round(7*N)+"px";o.left=Math.round(8*N)+"px";g.save();g.fillStyle=l.utils.rgb2rgbStr(l.formatProp.textClr,0.75);g.beginPath();if(j){g.moveTo(0,0);g.lineTo(f,k/2);g.lineTo(0,k);g.lineTo(0,0);}else{g.moveTo(0,k/2);g.lineTo(f,0);g.lineTo(f,k);g.lineTo(0,k/2);}g.closePath();g.fill();g.restore();},renderLegend:function G(w){var t=this.model,AE=t.series,o=AE&&AE.length||0,q=this.height,AD=this.utils,g=t.colHeaders,j=this.legendCanvas.getContext("2d"),AB=this.legendListDiv,k=this.legendBarSwitcher;this.legendBarDiv.style.width=this.legendBarWidth+"px";this.legendBarDiv.style.height=q+"px";AB.style.width=this.legendBarWidth+"px";k.width=this.legendBarWidth;k.height=O;k.style.width=this.legendBarWidth+"px";this.legendCanvas.width=this.legendBarWidth;this.legendCanvas.height=q;if(this.isLegendSelected&&this.legendSelectedIndex>=o){this.legendSelectedIndex=0;this.widget.setLegendSelected(this.isLegendSelected,this.legendSelectedIndex);}if(AB.childNodes.length==0){for(var p=0;p<o;p++){var l=document.createElement("div");l.id="legendAttr"+p;l.style.font=d;l.className="timeseries-legendAttr";l.innerHTML=this.widget.getLegendName(g,AE,p);l.setAttribute("clk","LA");l.setAttribute("vIndex",p);l.style.color=this.widget.getSerieColor(p);AB.appendChild(l);AD.changeElementSize(l,"height",AD.getScreenZoomFactor());}this.y_axis_interval=Math.max(l.offsetHeight,25);}if(this.isLegendBarOpen){this.toggleTriangle(true);AB.style.display="block";this.legendListDivContainer.style.height=(q-k.height-15*N)+"px";this.legendListDivContainer.style.weight=this.legendBarWidth+"px";this._scroller.updateScrollBars();this.utils.translateCSS(0,k.height,false,this.legendListDivContainer);if(this.isLegendSelected){this.enableLegendGlowEffect(this.legendSelectedIndex);}this.legendCanvas.height=q;this.legendCanvas.style.position="absolute";this.legendCanvas.style.top="0px";this.legendCanvas.style.left="0px";this.drawLegendOutline(q,k.height,j);}else{this.toggleTriangle(false);AB.style.display="none";this.legendCanvas.height=q;this.legendCanvas.style.position="absolute";this.legendCanvas.style.top="0px";this.legendCanvas.style.left="0px";this.drawLegendOutline(q,k.height,j);j.save();var AC=this.legendBarWidth/2;var AA=this.y_axis_interval/2;var f=Math.round(5*N);for(var p=0;p<o&&AA+this.y_axis_interval<q-15*N;p++){j.fillStyle=this.widget.getSerieColor(p);AA+=this.y_axis_interval;AD.drawArc(this,AC,AA,f,0,Math.PI*2,true,true,j);}j.restore();}var z=this.legendBarSwitcher.lastChild;if(w){z.className="timeseries-legend-switcher-shadow";z.style.left=Math.round(15*N)+"px";z.style.top=Math.round(15*N)+"px";z.style.display="";z.style.visibility="visible";}else{z.className="";z.style.visibility="hidden";}},reRender:function K(){this.calculateAndSetLegendWidth();this.height=this.calculateHeight();this.renderLegend(false);this.legendBarDiv.style.top=this.widget.margin.t+"px";C.call(this);},hiddenSwitcherArrowGlowEffect:function I(){var f=this.legendBarSwitcher.lastChild;f.innerHTML="";f.style.visibility="hidden";},drawLegendOutline:function D(f,l,h){var q=this.utils,p=this.widget.formatProp;h.save();h.globalAlpha=1;h.strokeStyle=q.rgb2rgbStr(p.textClr,0.5)||"#58595B";h.lineWidth=2;q.drawHalfRoundedRectangle(this,1,1,this.legendBarWidth,f-2,Math.round(15*N),false,h);var o=h.createLinearGradient(0,0,this.legendBarWidth-2,0);var g=q.rgb2rgbStr(p.textClr,0.5)||"#58595B";var k=q.rgb2rgbStr(p.textClr,0.13)||"#222222";o.addColorStop(0,g);o.addColorStop(1,k);h.strokeStyle=o;h.lineWidth=1;var j=l-0.5;q.drawLineSet(this,[{x:2,y:j},{x:this.legendBarWidth,y:j}],false,h);h.restore();},calculateMaxLegendAttrLength:function M(p){var l=this.model,q=l.series,h=q.length,f=l.colHeaders;for(var k=0;k<h;k++){var g=0;var o=this.widget.getLegendName(f,q,k);var j=p?X:d;g=this.widget.getTextWidth(o,j);this.maxLegendAttrLength=Math.max(this.maxLegendAttrLength,g);}this.maxLegendAttrLength=this.maxLegendAttrLength+10;},calculateAndSetLegendWidth:function W(){if(this.isLegendBarOpen){var f=(this.widget.getWidth()-50)*0.3+20;this.legendBarWidth=Math.min(f,this.maxLegendAttrLength);}else{this.legendBarWidth=Math.round(40*N);}this.widget.setlegendStatus(this.isLegendBarOpen,this.legendBarWidth);},calculateHeight:function F(){var f=this.widget.margin;return this.widget.getHeight()-this.widget.masterChartHeight-f.t-f.b;},postBuildRendering:function J(){E(this.utils.getScreenZoomFactor());this.height=this.calculateHeight();var f=this.model.series&&this.model.series.length;if(f==1){this.isLegendSelected=true;this.legendSelectedIndex=0;this.widget.setLegendSelected(this.isLegendSelected,this.legendSelectedIndex);}this.calculateMaxLegendAttrLength(f==1);this.calculateAndSetLegendWidth();this.scrollerConfig.scrollEl=this.legendListDiv;if(this._super){this._super();}this.renderLegend(false);C.call(this);},initScroller:function V(f){f.vScroll=true;this._super(f);},touchBegin:function U(h){this.widget.hiddenTooltipAndShowTimeSelector();var f=a.call(this,h);if(f){var g=f.value;if(g==="S"){this.switchLegendBar();}else{if(!this.isLegendBarOpen&&g==="C"){this.switchLegendBar();}}}},touchTap:function Z(j){var g=a.call(this,j);if(g){var h=g.value;if(h==="LA"){var f=mstrmojo.dom.findAncestorByAttr(j.target,"vIndex",true,this.domNode);if(f){this.handleLegendItemTap(parseInt(f.value,10));}}}},touchEnd:function H(g){var f=this;f.hiddenSwitcherArrowGlowEffect();},touchSelectBegin:function B(o){var g=a.call(this,o);if(g){var h=g.value;if(h==="LA"){var f=mstrmojo.dom.findAncestorByAttr(o.target,"vIndex",true,this.domNode);if(f){var k=(f.value==this.legendSelectedIndex)?X:d;var j=this.widget.getTextWidth(g.node.innerHTML,k);if(j>this.legendBarWidth-12){var l=g.node.offsetTop-this._scroller.origin.y+this.widget.margin.t+this.legendBarSwitcher.height-5;this.widget.showLegendTooltip(g.node);}}}}},touchSelectEnd:function S(f){this.widget.hiddenLegendTooltip();},touchMultiBegin:function R(f){this.touchSelectEnd(f);},onCrossWidgetMultitouch:function Y(){this.widget.hiddenLegendTooltip();this.hiddenSwitcherArrowGlowEffect();},handleLegendItemTap:function L(f){if(this.model.series.length==1){return ;}if(this.isLegendSelected){if(this.legendSelectedIndex===f){this.isLegendSelected=false;this.hiddenLegendGlowEffect(f);this.legendSelectedIndex=-1;}else{this.hiddenLegendGlowEffect(this.legendSelectedIndex);this.legendSelectedIndex=f;this.enableLegendGlowEffect(f);}}else{this.isLegendSelected=true;this.legendSelectedIndex=f;this.enableLegendGlowEffect(f);}this.widget.setLegendSelected(this.isLegendSelected,this.legendSelectedIndex);this.widget.reDrawSlaveChart();},destroy:function b(){if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.Enum_Keys","mstrmojo.hash","mstrmojo.dom");var E=mstrmojo.dom,B=mstrmojo.Enum_Keys,H=200,M;var L={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var N="mstrmojo-SimpleObjectInputBox-del";function I(){var V=this.inputBox,W=V.value;if(W!==this._lastPattern){this.showSuggestion(W);}this._lastPattern=W;delete this._timerHandle;}function U(){var V=this._timerHandle;if(V){window.clearTimeout(V);delete this._timerHandle;}}function P(){var X=this.maxObjectCount,V=(this.items&&this.items.length)||0,W=(X!=null&&V>=X);this.set("state",!V?L.EMPTY:(W?L.FULL:L.DEFAULT));}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur style="display: none;" /></div><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@emptyText}</div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;},emptyTextNode:function(){return this.domNode.childNodes[1];},inputBox:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function Q(){var V=this.maxItemWidth;if(!isNaN(V)){V+="px";}this.emptyTextNode.style.maxWidth=V;}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,maxObjectCount:null,getItemMarkup:function(V){if(!M){var W=this.itemField;M=this._super(V).replace(">{@n}<",' title="{@'+W+'}"><div class="elem">{@'+W+'}<div class="'+N+'"></div></div><');}return M;},getItemProps:function R(Y,V){var W=this._super(Y,V),Z=this.itemField;W[Z]=Y[Z];var X=this.maxItemWidth;if(!isNaN(X)){X=(X-24)+"px";}W.addStyle("max-width:"+X);return W;},getSuggestionPos:function K(){var V=this._inputPos;return{target:this.inputBox,left:V.x,top:V.y+V.h,zIndex:100};},getSearchPattern:function T(){return this.inputBox.value;},onSuggestionItemSelect:function F(V){U.call(this);this.set("items",this.items.concat(V));this._super();var W=this.id;window.setTimeout(function(){var X=mstrmojo.all[W];if(X.state!=L.FULL){X.set("state",L.ADDING);}},0);},onstateChange:function A(W){var X=W.value;this.emptyTextNode.style.display=(X===L.EMPTY)?"block":"none";var V=this.inputBox,Y=V.style,Z=this.itemsContainerNode;if(X===L.ADDING){Y.display="";V.focus();this._inputPos=E.position(V,true);}else{U.call(this);Y.display="none";V.value="";this._lastPattern="";}},postBuildRendering:function O(){P.call(this);return this._super();},preitemsChange:function J(){P.call(this);},onclick:function S(W){var Z=E.eventTarget(W.hWin,W.e);if(Z&&Z.className===N){var Y=E.findAncestorByAttr(Z,"idx",true,this.domNode),V=Y&&parseInt(Y.value,10);if(V!==null&&!isNaN(V)){var X=this.items.concat();X.splice(V,1);this.set("items",X);}return ;}if(this.state!=L.FULL){this.set("state",L.ADDING);}},onblur:function D(){U.call(this);if(!this.suggestionShown){P.call(this);}},prekeydown:function C(V){var Y=V.e;switch(parseInt(Y.keyCode||Y.charCode,10)){case B.DOWN_ARROW:this.nextHighlight();break;case B.UP_ARROW:this.preHighlight();break;case B.TAB:case B.ENTER:E.preventDefault(V.hWin,Y);var X=this.getSelected();if(X){this.handleSuggestionItemSelect(X);}else{this.hideSuggestion();P.call(this);}break;case B.ESCAPE:U.call(this);this.hideSuggestion();P.call(this);break;case B.BACKSPACE:if(!this.getSearchPattern()){E.preventDefault(V.hWin,Y);var W=this.items&&this.items.concat();if(W&&W.length){W.splice(W.length-1,1);this.set("items",W);var Z=this.id;window.setTimeout(function(){mstrmojo.all[Z].set("state",L.ADDING);},0);}}break;}},prekeyup:function G(){if(this.useKeyDelay){var V=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){I.call(mstrmojo.all[V]);},H);}}else{I.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});},ENUM_STATES:{UNDETERMINED:F,VALID:E,INVALID:D}}));}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.android.ui.CalendarMarkupBuilder","mstrmojo.ui.MobileCheckList","mstrmojo._TouchGestures","mstrmojo.android.Dialog");var B=mstrmojo.css,C="mstrmojo-CalDialog";mstrmojo.android.ui.CalendarDialog=mstrmojo.declare(mstrmojo.android.Dialog,null,{scriptClass:"mstrmojo.android.ui.CalendarDialog",markupBuilder:undefined,requiredOrientation:0,init:function(H){this._super(H);var I=this.calendar,F=this.popDimensions=this.getPopupDimensions(),G=this.requiredOrientation,J=mstrMobileApp.getLockedOrientation();if(G!==0&&G!==J){mstrMobileApp.lockOrientation(G);this._prevOr=J;}I.markupBuilder=this.markupBuilder;I.width=F.w+"px";I.height=F.h+"px";I.layoutConfig={h:{yearNode:"100px"},w:{yearNode:"100%"}};I.defaultCSS=this.cssClass;I.target=new mstrmojo.ui.MobileCheckList({alias:"contentList",cssDisplay:""});B.addWidgetCssClass(this,[C]);},getPopupDimensions:function E(){var F=mstrApp.getScreenDimensions();return{h:F.h*0.9,w:Math.min(F.w*0.85,720)};},getCancelBtnFn:function A(){var F=this.calendar.target,H=F.parent,G=F.getSelectedItems(),I=true;if(G&&G.length>0){F.set("items",[]);H.resizeDialog();I=false;}else{H.close();}return I;},close:function D(){this._super();var F=this._prevOr;if(F!==undefined){if(F===0){mstrMobileApp.releaseOrientation();}else{mstrMobileApp.lockOrientation(F);}delete this._prevOr;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.Dialog","mstrmojo.Button");mstrmojo.android.AndroidDICPopup=mstrmojo.declare(mstrmojo.android.Dialog,null,{scriptClass:"mstrmojo.AndroidDICPopup",cssClass:"mstrmojo-AndroidDICPopup",autoClose:false,fadeOnClose:false,init:function D(E){this._super(E);this.addChildren([this.widget]);},close:function C(){this.set("visible",false);if(this.widget.hasRendered){this.widget.unrender();}this.removeChildren(this.widget);this._super();},onpopupResized:function A(E){if(this.widget.onpopupResized){this.widget.onpopupResized(E);}},onkeyup:function B(F){var E=F.hWin,G=F.e||E.event;if(this.widget.applyOnEnter&&G.keyCode===13){this.onApply();}else{if(G.keyCode===27){this.onCancel();}}},onApply:function(){return this.widget.applyChanges();},onCancel:function(){this.widget.cancelChanges();},enableApply:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo.XtabZone","mstrmojo._TouchGestures","mstrmojo._HasXtabTouchScroll","mstrmojo._XtabSelections","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo._HasMagnifier","mstrmojo.XtabMagnifierHelper");var e=mstrmojo.css,F=mstrmojo.dom;var I=0;var V=1;var Q=2;var f=3;function R(h,j){e.toggleClass(h.firstChild,"tx-active",j);}function C(h){if(h){h.domNode.style.pointerEvents="auto";}}function N(){if(mstrMobileApp.isOnline()){return ;}var p=this.controller,x,w,h,j,AC,l,o,t,q=[],k=[],AA;if(!p.getLinkRequest){return ;}for(x in this.zones){if(x==="_BL"||x==="_BR"){w=this.zones[x];h=w.getNodesByPositions(w.posMap);for(o=0;o<h.length;o++){j=h[o];AC=this.getCellForNode(j);if(AC&&AC.at&&(AC.at&4)){l=this.model.getAction(this.getActionCells(AC),null);if(l){t=l.a;AA=p.getLinkRequest(t);if(AA){q.push(AA);k.push(j);}}}}}}var s=q.length;if(s){var AB=function(AD){var z,AE;for(z=0;z<s;z++){AE=k[z];if(!AD[z]){AE.setAttribute("hl_d",true);e.addClass(AE,"hl_d");}}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(q,{success:AB,failure:mstrmojo.emptyFn});}}}function a(){if(mstrMobileApp.isOnline()){var o,h,j,l,k;for(o in this.zones){if(o==="_BL"||o==="_BR"){h=this.zones[o];j=h.getNodesByPositions(h.posMap);for(k=0;k<j.length;k++){l=j[k];l.removeAttribute("hl_d");e.removeClass(l,"hl_d");}}}}else{N.call(this);}}mstrmojo.MobileXtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._TouchGestures,mstrmojo._HasXtabTouchScroll,mstrmojo._XtabSelections,mstrmojo._HasMagnifier],{scriptClass:"mstrmojo.MobileXtab",frameRate:30,enableMagnifier:true,useSeamlessIncFetch:false,allowToggleSelections:true,markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";}},init:function X(h){this._super(h);this.magnifierHelper=new mstrmojo.XtabMagnifierHelper({xtab:this});this.disposables.push(this.magnifierHelper);},gridPagesRendered:function B(){this._super();N.call(this);},onRender:function G(){this._super();var h=this.interactiveCellsArray;if(h&&h.length>0&&this.controller.getLinkRequest){if(!this.subscr){var k=mstrmojo.publisher;this.subscr=k.subscribe(k.NO_SRC,k.CONNECTIVITY_CHANGED_EVENT,a,this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var j=this;window.setTimeout(function(){try{N.call(j);}catch(l){}},100);}}},unrender:function Z(){if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}this._super();},getDataService:function J(h){return this.model.getDataService();},setData:function E(h){this.set("gridData",h);},createZone:function D(h){h=h||{};var j=this.getDataService();h.imgCacheMap=(j&&j.imgCache)||this.imgCacheMap;h.unCachedMap={};return new mstrmojo.XtabZone(h);},showDownloadStatus:function b(){},onclick:mstrmojo.emptyFn,setupTNs:function O(){var j=this.contentNode,h=j.rows[1].cells[1].lastChild,k=0;switch(this.lockHeadersCase){case I:this._TSN.x=[h.lastChild.lastChild];this._TSN.y=[h.firstChild];break;case Q:this._TSN.x=[j];this._TSN.y=[h.firstChild];break;case V:this._TSN.x=[h];this._TSN.y=[j];k=-1;break;case f:this._TSN.x=[j.rows[0].cells[1].lastChild,h.firstChild];this._TSN.y=[j.rows[1]];k=2;break;}if(k){this._TSN.x[0].style.zIndex=k;}this.setOffsets();this.attachEventListener("scrolledOut",this.id,this.scrolledOut);},useDomToCalculateOffsets:function P(){return(this.lockHeadersCase===I||(this._super&&this._super()));},setOffsets:function d(){var AD=0,q=0;var s=this.lockHeadersCase;if(this.useDomToCalculateOffsets()){var j=this._TSN,AC=j.x[0],t=j.y[0];AD=AC.offsetLeft+AC.offsetWidth+(!!(s&V)?this._BL.offsetWidth:0);q=t.offsetTop+t.offsetHeight+(!!(s&Q)?this._TR.offsetHeight:0);}else{var k=this.zones,z=(this.gridData.rh&&parseInt(this.gridData.rh,10))||0,w=k._TR?k._TR.cp.rc:0,AA=k._BR.cp.rc,l=k._BL?k._BL.totalColWidth:0,h=k._BR.totalColWidth;q=((s===V)?AA:w+AA)*z;AD=(s===Q)?h:l+h;}var p=1,x=2,o=this.getGridDimension(x)||0,AB=this.getGridDimension(p)||0;this._TMAX={x:Math.min(o-AD,0),y:Math.min(AB-q,0)};if(this._super){this._super();}},touchTap:function Y(j){if(!this.magnifier){if(this._super){this._super();}if(this.performAction(j)===false){var h=this.controller;if(h&&h.viewTap){h.viewTap();}}}},performAction:function W(q){this.deselectCell();var p=F.findAncestorByAttr(q.target,"ei",true,this.domNode);if(!p||!p.value){return false;}var o=p.node,h=this.getCellForNode(o),l=h.at;if(this._super&&this._super(q)){return ;}if(!l){return false;}if((l&4)&&!o.getAttribute("hl_d")){var j=document.createElement("div"),k=j.style;id=this.id;j.className="activeLink on";k.left=o.offsetLeft+"px";k.top=o.offsetTop+"px";k.width=o.offsetWidth+"px";k.height=o.offsetHeight+"px";o.appendChild(j);window.setTimeout(function(){var s=mstrmojo.all[id];if(s&&s.hasRendered){F.attachOneTimeEvent(j,"webkitTransitionEnd",function(){o.removeChild(j);});e.removeClass(j,"on");}},200);}this.defaultAction(o);},selectCell:function L(h){var k=document.createElement("div"),j=k.style;k.className="overlay";j.top=h.offsetTop+"px";j.left=(h.offsetLeft+1)+"px";j.height=(h.clientHeight-2)+"px";j.width=(h.clientWidth-1)+"px";h.appendChild(k);},flagDirtyUnit:function g(h){R(h,true);},clearDirtyUnit:function M(h){R(h,false);},deselectCell:function U(){var h=this._selectedCell;if(h){h.removeChild(h.lastChild);delete this._selectedCell;}},touchSelectBegin:function A(k){if(this.enableMagnifier){var j=this.controller,h;if(j.getMagnifierConfig){h=j.getMagnifierConfig();}this.displayMagnifier(k,h);}},touchSelectMove:function H(j){if(this.enableMagnifier){var h=this;this.latestTouch=j;if(!this._moveMagnifierTimer){this._moveMagnifierTimer=setTimeout(function(){h.displayMagnifier(h.latestTouch);h._moveMagnifierTimer=null;},50);}}},touchSelectCancel:function T(h){C(this.magnifier);},touchSelectEnd:function S(h){C(this.magnifier);},getCaptureDimensions:function K(){var j=this.viewport,h=F.position(this.domNode,true);h.w=Math.min(j.offsetWidth,h.w);h.h=Math.min(j.offsetHeight,h.h);return h;}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st];},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc());}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){this.getContent(this);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new mstrmojo.TreeBrowserNode({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}else{var J=this.selectionParentNode;return J&&J.getSelectedItems();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.SimpleList","mstrmojo.android.controllers.SettingsController","mstrmojo.android._HasLingeringListSelections","mstrmojo.android.ui.Button","mstrmojo.ui.MobileCheckList","mstrmojo.android.ui.TextInput","mstrmojo.android.ui.ValidationTextInput","mstrmojo.expr","mstrmojo.array","mstrmojo.css");mstrmojo.requiresDescs(221,1442,7883,9454);var I=mstrmojo.android.controllers.SettingsController.STYLES,D=mstrmojo.android.ui.Button.newButton,M=mstrmojo.array,F=mstrmojo.validation,B=F.TRIGGER,A=F.STATUSCODE,E={},K=mstrmojo.dom,G=K.CSS3_TRANSITION_DURATION;mstrmojo.android.ui.SettingsView=mstrmojo.declare(mstrmojo.android.SimpleList,[mstrmojo.android._HasLingeringListSelections],{scriptClass:"mstrmojo.android.ui.SettingsView",init:function O(P){this._super(P);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-AndroidSettings");},allowTouchBubble:false,getList:function L(){return this;},listHooks:{select:function(Q,R,P){Q.style[G]=0;if(R.disabled){return true;}if(R.style!==I.VIEW_BUTTON){this.setClearHandler(200);}},unselect:function(Q,R,P){Q.style[G]="300ms";}},getItemMarkup:function(R){var Q=R.style;if(!E[Q]){var P="<div><h3>{@ttl}</h3><h4>{@value}</h4></div>";if(Q===I.TEXT_AREA){P='<div readonly="readonly">{@ttl}</div>';}else{if(Q===I.IMAGE){P="<h3></h3>";}}E[Q]=this._super(R).replace("{@n}",P);}return E[Q];},getItemProps:function N(U,Q){var V=U.v,T=this._super(U,Q);T.ttl=U.nm;T.value=V||"";var R=U.cls;if(R){T.addCls(R);}var P=function(){T.addCls("drop-down");if(U.pwd){T.value="********";}else{if(U.showHint&&V===""){T.value=mstrmojo.desc(9454,"&lt;not set&gt;");}}};switch(U.style){case I.TEXT_AREA:T.addCls("textarea");break;case I.HEADER:T.addCls("header");break;case I.TIME:T.value=new Date((U.v<60000)?U.v*60000:U.v).toJSON().replace(/.*T/,"").replace(/\.[0-9]{3}Z/,"");P();break;case I.NUMBER:case I.TEXT:P();break;case I.LIST:T.addCls("drop-down");var S=U.items;T.value=S[M.find(S,"v",V)].n;break;case I.CHECK:T.addCls("check");if(V===U.on){T.addCls("on");}T.value=U.desc;break;}if(U.hidden){T.addCls("hidden");}else{if(U.disabled){T.addCls("disabled");T.value="";}}if(T.value){T.addCls("with-desc");}return T;},touchSelectBegin:function J(S){var P=this.getItemIdxTouch(S);if(P>-1){var R=this.items[P],Q=R.fnPress;if(Q){Q.call(this.controller,R);return false;}}return true;},preselectionChange:function C(Q){var R=Q.added;if(!R){return true;}var P=R[0],S=this.items[P];if(S.disabled||S.noclick){return false;}if(S.style===I.HEADER){if(!this._listTarget.getAttribute("hidx")){return false;}}return true;},postselectionChange:function H(W){var S=W.added;if(!S){return ;}var X=S[0],e=this.items[X];var g=this,R={title:e.nm},h=[],a,d,Q=function(j,k){j.fn(k);g.updateItem(X);};switch(e.style){case I.HEADER:var P=this._listTarget.getAttribute("hidx");if(P){this.controller.jumpTo(parseInt(P,10),true);}break;case I.BUTTON:case I.VIEW_BUTTON:if(e.fn){e.fn();}break;case I.NUMBER:case I.TEXT:var Y=(e.style===I.NUMBER),T={scriptClass:"mstrmojo.android.ui."+(Y?"Validation":"")+"TextInput",alias:"textInput",textValue:e.v,textType:Y?"number":(e.pwd?"password":"text"),onEnter:function(j){Q(e,j);d.close();}};if(Y){T.valProps={dtp:mstrmojo.expr.DTP.UNSIGNED,min:e.limits.min,max:e.limits.max,constraints:{trigger:B.ONKEYUP,validator:function(k){k=parseInt(k,10);var l=this.min,j=this.max,o=(k>=l&&k<=j)?"":mstrmojo.desc(7883).replace("##",l).replace("###",j);return{code:o?A.INVALID:A.VALID,msg:o};}}};}h.push(T);a=function(){var j=d.textInput;if(j.validate){j.validate();if(j.isValid()){Q(e,j.getValue());return true;}return false;}Q(e,j.getValue());return true;};break;case I.LIST:var Z=e.items;var V=new mstrmojo.ui.MobileCheckList({items:Z,multiSelect:false,isElastic:true,selectedIndex:M.find(Z,"v",e.v)});h.push(V);a=function(){Q(e,Z[V.selectedIndex].v);};break;case I.CHECK:Q(e,(e.v===e.on)?e.off:e.on);break;case I.TIME:var U=(e.v<60000)?e.v*60000:e.v,f=new Date(U),b=new mstrmojo.ui.MobileDateTimePicker({value:{time:{hour:f.getUTCHours(),min:f.getUTCMinutes(),sec:0}},is24HourMode:false,dtp:mstrmojo.expr.DTP.TIME});h.push(b);a=function(){var j=b.getTime();Q(e,j.hour*60+j.min);};break;}if(h.length){R.children=h;if(a){R.buttons=[D(mstrmojo.desc(221,"Cancel")),D(mstrmojo.desc(1442,"OK"),a)];}d=mstrApp.showDialog(R);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.ui.TransactionView");var C=/<\/em>(.*)$/;mstrmojo.android.medium.ui.TransactionView=mstrmojo.declare(mstrmojo.android.ui.TransactionView,null,{scriptClass:"mstrmojo.android.medium.ui.TransactionView",enableButtons:function B(D){var E=this._editDocView;if(E){E.enableButtons(D);}},setTitle:function A(E){var D=E.match(C);this.controller.rootCtrl.updateContent(null,(D&&D[1])||E);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.android.ui.PromptsList","mstrmojo.android.ui.Button");mstrmojo.requiresDescs(2550,3649,3650);var D=mstrmojo.desc,E="100%";function G(J,K){var L=this.parent;if(L[J]){L[J].apply(L,K);return true;}return false;}var C=mstrmojo.android.ui.PromptsView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.android.ui.PromptsView",markupString:'<div id="{@id}" class="mstrmojo-Prompts {@cssClass}" style="{@cssText}"><div class="summary"></div><div class="command"></div></div>',markupSlots:{summaryNode:function(){return this.domNode.firstChild;},cmdNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{summaryNode:E,cmdNode:"90px"},w:{summaryNode:E,cmdNode:E}},init:function I(M){this._super(M);var L=this.prompts,K=this.supportedPrompts;if(L&&K){var J=mstrmojo.android.ui.Button.newButton((L.host.st===14081)?D(3650,"Run Document"):D(3649,"Run Report"),function(){this.parent.controller.answerPrompts();},{slot:"cmdNode",alias:"cmdButton",cssClass:"mstrmojo-GlowButton",ignoreLayout:true,enabled:mstrMobileApp.isOnline(),glowClass:"glow"});var N=mstrmojo.publisher;N.subscribe(N.NO_SRC,N.CONNECTIVITY_CHANGED_EVENT,function(O){this.cmdButton.set("enabled",O);},this.id);this.addChildren([J]);if(mstrApp.isTablet()){K=[{title:D(2550,"FILTERS"),isTtl:true}].concat(K);}this.promptList.set("items",K);}},rootOrientationChange:function F(){if(!this.ignoreRotation){mstrApp.closeDialog();}},children:[{scriptClass:"mstrmojo.android.ui.PromptsList",slot:"summaryNode",alias:"promptList",canItemLinger:function H(J){return !mstrApp.isTablet()||J.getStyle()===mstrmojo.prompt.WebPrompt.STYLES.SWITCH;}}],openPrompt:function A(L){var J=this.controller;if(!J.prevController&&!J.nextController){return ;}this.ignoreRotation=true;if(!G.call(this,"openPrompt",[L])){L();}var K=this;window.setTimeout(function(){delete K.ignoreRotation;},300);},closePrompt:function B(){G.call(this,"closePrompt");}});mstrmojo.DPIManager.registerClass(C,"h","cmdNode",{160:60,213:60,240:90,320:120});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.desc","mstrmojo.android.ui.Button","mstrmojo.android.controllers._HasSelectBoxDialog");mstrmojo.requiresDescs(221,1442,5136,2941);var D=mstrmojo.hash,G=mstrmojo.array,F=mstrmojo.desc,B=mstrmojo.android.ui.Button.newButton;function A(U,T){var W=D.clone(this.pageByData),V=W.es,M={title:U,dialogRefresh:function(){this.refresh();}},I=this,S=0,R,Q,J,L,P,O,N,H,K;P=function(Z){var X=L.shift(),Y=Z.ph.h[X];delete Y.cet;if(Y.ph){P(Y);}};O=function(Z){var b=Z.ph;if(!b){return ;}var X=[],a;G.forEach(b.h,function(f,d){var e=f.ix,h=f.cet||0;var g=V[e];X[d]={n:g.en,v:e,on:h};if(h){J[R]=X[d];L[R]=d;a=f.ph;}});var Y=J[R];Q.push({n:b.n,items:X,v:Y.n});R++;O(D.copy(Y,{ph:a}));};N=function(){R=0;Q=[];J=[];L=[];O(W);S=Q.length;};H=function(Y){var X=W.ph;G.forEach(J,function(Z){var b=X.h,a=G.find(b,"ix",Z.v),d;if(a<0){a=(T&&b.length>1)?1:0;}d=b[a];Y(d,X);X=d.ph;});};K=function(){var X=[];H(function(Z,Y){X.push({id:Y.id||"m",tp:Y.tp,v:V[Z.ix].ei});});I.pageByData=W;I.onPageBy(X);};N();if(S>1){M.buttons=[B(F(221,"Cancel")),B(F(1442,"OK"),function(){K();})];}this.showSelectBoxDialog(Q,function(X,Y){P(W);J[X]=Y;H(function(Z){Z.cet=1;});N();if(S>1){this.set("items",Q);}else{K();}return(S>1);},M);}mstrmojo.android.controllers._HasPageBy=mstrmojo.provide("mstrmojo.android.controllers._HasPageBy",D.copy(mstrmojo.android.controllers._HasSelectBoxDialog,{_mixinName:"mstrmojo.android.controllers._HasPageBy",showGroupByDialog:function E(){A.call(this,mstrmojo.desc(2941,"Grouping"),true);},showPageByDialog:function C(){A.call(this,mstrmojo.desc(5136,"Page By"),false);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ResultSetController","mstrmojo._IsDocController","mstrmojo.android.controllers._SupportsQueuedTransactions","mstrmojo.android.controllers._HasPageBy","mstrmojo.ui.MobileCheckList","mstrmojo.android.EnumMenuOptions","mstrmojo.string","mstrmojo.array","mstrmojo.hash");mstrmojo.requiresDescs(1089,1917,2941,6189,9233,9254,9255,9256,9257);var K=mstrmojo.hash,d=mstrmojo.array,a=mstrmojo.android.EnumMenuOptions,C=a.DOC_LAYOUTS,T=a.GROUP_BY,b=a.REPROMPT,AH=a.SHARE,B=a.ANNOTATION,t="\u001F",x=1;function p(AN){var AL=AN.model,AK=AL.data.layouts,AM=d.find(AK,"k",AL.currlaykey);return AM>=0?AK[AM]:null;}function l(AN,AL){var AO=AN.getGroupByElements(AL),AM=[],AK=p(AN),AR=AK&&AK.gbys&&AK.gbys.groupbys,AQ=AO&&AO.length;if(AQ&&AR){for(i=0;i<AQ;i++){var AP=AR[i].unit.target;AM.push(AP.did);AM.push(AP.t);AM.push(AO[i]);}}return AM.join(t);}function w(AQ,AK){var AP=AQ.desiredUnits||{},AO=p(AQ),AL=AK&&AK.length;if(AO&&AO.gbys){var AN=AO.gbys.groupbys,AS=AN.length;for(i=0;i<AS;i++){var AR=AN[i].unit,AM;if(AK){if(i<AL){AM=AK[i];}else{break;}}else{AM=AR.elms[AR.idx].v;}AP[AR.target.did]=AM;}}return AP;}function V(AK){var AN="",AM=0,AL;for(AL in AK){if(AM>0){AN+=t;}AN+=AL+t+AK[AL];AM++;}return AN;}function S(){if(this.refreshTimer){clearInterval(this.refreshTimer);delete this.refreshTimer;}}function D(){var AL=this.model.rf;if(AL&&AL>0){var AK=this;this.refreshTimer=self.setInterval(function(){AK.checkCache(null,null,null,2);},AL*1000);}}function q(){var AK=this._previousOr;if(AK===-1){return ;}if(AK===0){window.setTimeout(function(){mstrMobileApp.releaseOrientation();});}else{if(AK>0){mstrMobileApp.lockOrientation(AK);}}this._previousOr=-1;}function AD(){return mstrApp.getTransactionNotificationController();}function A(AK,AL){var AM={srcMsgId:this.model.mid,desiredUnits:w(this,this.getGroupByElements(AL))};K.forEach(AK,function(AO,AN){AO=AO.replace(/\+/g," ");AM[AN]=decodeURIComponent(AO);});return AM;}function AF(AR){var AQ=AR.txData.split(";"),AP,AO=AQ.length;for(AP=0;AP<AO;AP++){var AN=AQ[AP],AM=AN.split(","),AL=decodeURIComponent(AM[1]),AK=this.model.getFirstUnitInstanceByName(AM[0]);if(AK){AK.dataChanged(0,AK.v,{dv:AL,v:AL},AK.valueNode);}}}mstrmojo.android.controllers.DocumentController=mstrmojo.declare(mstrmojo.android.controllers.ResultSetController,[mstrmojo.android.controllers._SupportsQueuedTransactions,mstrmojo._IsDocController,mstrmojo.android.controllers._HasPageBy],{scriptClass:"mstrmojo.android.controllers.DocumentController",initModel:function I(AK){return mstrApp.modelFactory.newModel("Document",K.copy(AK,{controller:this}));},hasTxChanges:false,start:function R(AM,AN){var AL=this.desiredUnits=AM.desiredUnits;if(AL){var AK=V(AL);if(AK){AM.desiredElements=AK;}delete AM.desiredUnits;}this.sub_id=AM.sub_id;this.hasTxChanges=!!AM.hasTxChanges;this._super(AM,AN);},createView:function N(AQ,AL){var AT=AQ.defn.layouts,AO=mstrMobileApp.getLockedOrientation(),AM=-1,AU=-1,AN=true,AK=AT.length,AP;for(AP=0;AP<AK;AP++){if(AT[AP].iw){continue;}var AR=AT[AP].or;if(AM===-1){AM=AR;}if(AR!==AM||AR===3){AN=false;break;}}if(AO>0){if(AN){if(AM!==AO){AU=AM;}}else{AU=0;}}else{if(AN){AU=AM;}}if(AU>-1){if(AU===0){mstrMobileApp.releaseOrientation();}else{mstrMobileApp.lockOrientation(AU);}this._previousOr=AO;}var AS=this.view=this.newView("Document",AL);AS.set("model",this.model);AS.buildChildren();return AS;},afterReprompt:function Z(AL){var AK=this.view;AK.unloadLayouts(null,false);AK.model.loadLayout(AL,true);this._super(AL);},onPageBy:function Q(AK){var AL="";d.forEach(AK,function(AN,AM){if(AM){AL+=t;}AL+=AN.id+t+AN.v;});this.onGroupBy({gbUnits:AL});},hasPageBy:function g(){var AK=this.view,AL=AK&&AK.getLayouts()&&AK.getCurrentLayout();return !!(AL&&AL.gb&&AL.defn.dpb);},onGroupBy:function s(AN,AO,AM){var AK=this.view,AL=this.model;AM=AM||{};AM.showWait=true;AM.hideWait=true;AM.delay=true;AO=mstrmojo.func.wrapMethods(AO,{success:function(AP){AK.unloadLayouts(null,true);AL.loadLayout(AP);}});AL.getDataService().changeDocGroupBy(AN,AO,AM);},setData:function P(AL,AM){var AK=this.view;if(AM&&AK){AK.unloadLayouts(null,false);}this.model.loadLayout(AL);if(AL.rf!=this.old_rf){S.call(this);D.call(this);}this.rootCtrl.updateContent(null,this.model.n,false);},onDrill:function h(AK,AL){if(!this.isInRequest()){if(AL.isWithin){AK.model.drillGrid(this._addNodeKeyToAction(AK,AL),this._getXtabCallback(AK));}else{AL.rwGroupByElements=l(this,AK);this._super(this._addNodeKeyToAction(AK,AL));}}},onDownloadGridData:function M(AK,AL){this.model.downloadGridData(this._addNodeKeyToAction(AK,AL));},onExecuteNewObject:function O(AK,AL){this._super(AL);},onReExecute:function AB(AK){this.reExecute(AK);},refresh:function AI(AK,AM){var AL=this.id;this.model.getDataService().refresh(AK,mstrmojo.func.wrapMethods({success:function(AN){mstrmojo.all[AL].setData(AN,true);}},AM));},invalidClientCache:function(){if(mstrApp.useBinaryFormat){mstrMobileApp.removeLiveCache(mstrApp.getCurrentProjectId(),this.model.ci.cid);}},onTransactionUpdates:function k(AK,AM,AL){var AN=this.model,AP;if(mstrApp.useBinaryFormat){AP=AN.newCallback({success:function(){AK.clear();AN.clearTxDeltaUpdate();if(AL){setTimeout(function(){AK.autoRefresh();},250);}}});var AO=AN.getDataService();if(AM.manipulation===x){AO.txMarkRows(AM,AP);}else{AO.txChangeData(AM,AP);}}else{if(AL){AK.autoRefresh();}}this.hasTxChanges=true;},onLink:function F(AK,AN){if(!AN.url){return this._super(AK,AN);}var AM=mstrmojo.string.parseUri(AN.url),AP=AM.authority,AO=AM.path;if(AM.protocol==="mstr"){this.handleSpecialLink(AM,AN);}else{if(AP==="mstrWeb"||AP==="Main.aspx"||(/mstrWeb$/.test(AO))||(/Main\.aspx$/.test(AO))){this._super(AK,A.call(this,AM.queryKey,AN.src));}else{var AL=mstrMobileApp.openLink(AM.source,AN.target);if(AL){mstrApp.onerror({message:AL});}}}},getLinkRequest:function f(AP){var AK;if(!AP.url){AK=this.buildLinkParams(AP);}else{var AO=mstrmojo.string.parseUri(AP.url),AN=AO.queryKey,AR=AO.authority,AQ=AO.path;if(AO.protocol!=="mstr"&&(AR==="mstrWeb"||AR==="Main.aspx"||(/mstrWeb$/.test(AQ))||(/Main.aspx$/.test(AQ)))){AK=this.buildLinkParams(A.call(this,AN,AP.src));if(AK){switch(parseInt(AN.evt,10)){case 4001:AK.taskID="reportExecute";AK.styleName="AndroidMessageResultStyle";break;case 2048001:AK.taskID="RWExecute";AK.objType=55;var AM=AK.desiredUnits;if(AM){var AL=V(AM);if(AL){AK.desiredElements=AL;}delete AK.desiredUnits;}break;}}}}if(AK&&AK.link){AK.linkAnswers=AK.link.toXml();delete AK.link;}return AK;},getDesiredElements:function e(AO){var AN=this.model.gbElements,AM="";if(AN){var AP=AN.split(";"),AL=AP.length,AK;for(AK=0;AK<AL;AK+=3){if(AK>0){AM+=t;}AM+=AP[AK]+t+AP[AK+2];}}else{AM=V(w(this,AO));}return AM;},confirmMsgBeforeSubmit:function E(){var AL=this.model,AK=AD(),AM;if(this.hasTxChanges&&AK&&AK.hasPendingTransactions(this.did)){if(AL.txrcd){AM=mstrmojo.desc(9254,"Pending transaction exists")+". "+mstrmojo.desc(9255,"You are about to replace a pending transaction.");}else{AM=mstrmojo.desc(9256,"There are one or more pending submissions in the transaction queue for this document.")+" "+mstrmojo.desc(9257,"Continuing will submit a new transaction.");}}return AM;},offlineTransactionsSubmitted:function AE(AL){var AK=AD();if(AK){AK.setOfflineRecords(this.did);}this.hasTxChanges=false;},openOfflineTransactions:function AG(){var AK=AD();if(AK){AK.showNotificationBoard(this,this.did,this.ttl);}},transactionDiscarded:function W(AK){this.hasTxChanges=false;},destroy:function AC(){q.call(this);this._super();},nudgeWidget:function L(AL,AK){if(mstrMobileApp!==undefined&&mstrMobileApp.nudgeWidget){mstrMobileApp.nudgeWidget(AL,JSON.stringify(AK));}},resetOrientation:function AJ(){q.call(this);},checkCache:function H(AM,AO,AK,AN,AL){this.old_rf=this.model.rf;this._super(AM||{ifc:true,ci:this.model.ci},AO,AK,AN,AL);},beforeViewHidden:function G(AK){this._super(AK);if(AK){mstrmojo.GraphBase.hideTooltips();this.resetOrientation();}S.call(this);},afterViewVisible:function U(){this._super();var AK=this.view;if(AK&&AK.afterViewVisible){AK.afterViewVisible();}if(!this.isSubscription){D.call(this);}},hasFullScreenInfoWindow:function AA(){var AK=this.view;return AK&&AK.fullScreenInfoWindow;},updateActionToolbar:function o(AN){if(!this.hasFullScreenInfoWindow()){this.getTxnToolbarButton(AN);this.addFullScreenButton(AN);if(mstrMobileApp.isOnline()){var AM=this.model,AK=AM.docModel||AM,AL=AK.prompts,AO=AK.getCurrentLayoutDef&&AK.getCurrentLayoutDef(),AQ=(AO&&AO.dri);if(AL&&AL.hasSupported()&&(AQ===undefined||AQ)){AN.addToolbarBtn(b,mstrmojo.desc(6189,"Filter"),b,true,3);}}if(this.hasPageBy()){AN.addToolbarBtn(T,mstrmojo.desc(2941,"Grouping"),T,true,2);}var AP=this.view&&this.view.getSupportedLayouts();if(AP&&(AP.length>1)){AN.addToolbarBtn(C,mstrmojo.desc(4174,"Layouts"),C,false,8);}}return this._super(AN);},handleMenuItem:function j(AO,AK){if(AO!==AH&&AO!==B){mstrmojo.GraphBase.hideTooltips();if(mstrApp.isTablet()){this.view.closeInfoWindowsOnTablet();}}switch(AO){case C:var AL=this.view,AM=function(){var AP=AL.getSupportedLayouts();return{l:AP,idx:d.indexOf(AP,AL.getCurrentLayout())};},AN=AM();mstrApp.showDialog({title:mstrmojo.desc(4174,"Layouts"),children:[{scriptClass:"mstrmojo.ui.MobileCheckList",isElastic:true,multiSelect:false,items:AN.l,selectedIndex:AN.idx,postselectionChange:function(AP){var AQ=AP.added;if(AQ){if(AL.showLayout(this.items[AQ[0]])){mstrApp.closeDialog();}}},postCreate:function(){mstrApp.rootController.attachEventListener("rootOrientationChange",this.id,function(){var AP=AM();this.set("items",AP.l);this.select(AP.idx);this.parent.resizeDialog();});}}]});return ;case T:this.showGroupByDialog();return ;case b:this.reprompt();return ;}return this._super(AO,AK);},makeCurrent:function Y(AK){this.isBack=true;this._super(AK);delete this.isBack;},handleSpecialLink:function X(AQ,AT){var AS=AQ.queryKey,AW=this.view,AL=AS.evt;if(AL==="2048500"){var AM=AS.panelName,AU=AW.model,AZ=AU.getInfoWindow(AM);if(AZ){AW.showInfoWindow(AZ.id,AZ.k,AT.src.domNode);}}else{if(AL==="2048030"){var AY=!!AS.useCache&&AS.useCache==="0",AO={fresh:AY,useRefreshProgress:mstrApp.isTablet()};this.refresh(AO);}else{if(AL==="2048258"){AF.call(this,AS);}else{if(AL==="3037"){this.share(AS.emailSubject,true);}else{if(AL==="3175"){this.startAnnotate();}else{if(AQ.authority==="gb"){var AV=this,AR=AW.getSelectedLayoutWidget(),AN=AR.gb,AX=AS.a,AP=AS.e,AK=d.forEach;AK(AN.groupbys,function(Ad){var Ab=Ad.unit,Ac=Ab.target;if(Ac.did===AX){var Aa=function(){var Af=Ab.elms,Ae=[];AK(Af,function(Ah,Ag){Ae.push(K.copy(Ah,{k:Ad.k,on:(Ag===Ab.idx)}));});mstrApp.showDialog({title:Ac.n,children:[{scriptClass:"mstrmojo.ui.MobileCheckList",selectionPolicy:"reselect",items:Ae,multiSelect:false,isElastic:true,selectedIndex:Ab.idx,preselectionChange:function(Ag){if(Ag.added[0]===Ag.removed[0]){mstrApp.closeDialog();return false;}if(this._super){return this._super(Ag);}},postselectionChange:function(Ag){mstrApp.closeDialog();var Ah=Ae[Ag.added[0]];AV.onGroupBy({groupbyKey:Ah.k,elementId:Ah.v});}}]});};if(AP&&parseInt(AP,10)!==0){this.onGroupBy({groupbyKey:Ad.k,elementId:AP},{failure:Aa},{noErrorMessage:true});}else{Aa();}return false;}});}else{this._super(AQ,AT);}}}}}}},getContentDimensions:function z(){var AK=mstrApp.getContentDimensions();return{w:AK.w,h:AK.h};},canDelegateToolBar:function J(){if(this.hasFullScreenInfoWindow()){return false;}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getContentThroughTaskCall:function C(F,D){var E=mstrmojo.ACL.UserDataService;if(F.isRoot){E.getTopLevelGroups(F,D);}else{E.getMembers(F,D);}},isBranch:function B(D){return D.isGroup;},item2textCss:function A(D){return(this._super&&this._super(D))||{8704:"u",8705:"ug"}[D.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.MobileXtab","mstrmojo.array","mstrmojo.hash");function B(){var K=this.xtabStyleSheet,J=K&&K.parentNode;if(J){J.removeChild(K);delete this.xtabStyleSheet;}}mstrmojo.AndroidXtab=mstrmojo.declare(mstrmojo.MobileXtab,null,{scriptClass:"mstrmojo.AndroidXtab",scrollerFriction:0.0015,preBuildRendering:function G(){B.call(this);this.updateXtabStyles(this.model.data.cssString);this._super();},onwidthChange:function D(){if(this.gridData.afw){var K=this.scrollboxNode,J=this.width;if(K){K.style.width=J;}else{this.scrollboxNodeCssText="width: "+J;}}if(this._super){this._super();}},updateXtabStyles:function E(J){if(!this.xtabStyleSheet){this.xtabStyleSheet=document.getElementsByTagName("head")[0].appendChild(document.createElement("style"));}this.xtabStyleSheet.appendChild(document.createTextNode(J));},unrender:function F(J){this._super(J);B.call(this);},getMaskNode:function C(){var J=document.createElement("div");J.appendChild(this.xtabStyleSheet.cloneNode(true));J.appendChild(this.domNode.cloneNode(true));return J;},updateActionMenu:function A(J,K){this._selectionActions=K;return true;},setModel:function I(J){this._super(J);this.controller.getPageByTree(false);},deselectCell:function H(){this._super();delete this._selectionActions;}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.AndroidDICPopup","mstrmojo.DefaultDIC","mstrmojo.android.inputControls.SliderDIC","mstrmojo.android.inputControls.TextFieldDIC","mstrmojo.android.inputControls.CheckBoxDIC","mstrmojo.android.inputControls.PullDownDIC","mstrmojo.android.inputControls.RadioListDIC","mstrmojo.android.inputControls.LikertScaleDIC","mstrmojo.android.inputControls.CalendarDIC","mstrmojo.android.inputControls.DateTimePickerDIC","mstrmojo.android.inputControls.TextAreaDIC","mstrmojo.android.inputControls.MarkRowDIC","mstrmojo.android.inputControls.ToggleDIC","mstrmojo.android.inputControls.SignatureDIC","mstrmojo.android.inputControls.StepperDIC","mstrmojo.android.inputControls.RatingDIC","mstrmojo.android.inputControls.BarcodeDIC","mstrmojo.android.ui.Button");mstrmojo.requiresDescs(221,1442);var Q=mstrmojo.android.ui.Button.newButton,A=1,I=2,C=3,E=4,L=5,R=6,D=7,F=8,H=9,T=10,G=12,S=13,P=14,K=102;var B=mstrmojo.android.AndroidDICConfig=mstrmojo.provide("mstrmojo.android.AndroidDICConfig",{DICList:{1:mstrmojo.android.inputControls.TextFieldDIC,2:mstrmojo.android.inputControls.CheckBoxDIC,3:{0:mstrmojo.android.inputControls.PullDownDIC,1:mstrmojo.android.inputControls.RadioListDIC},4:mstrmojo.android.inputControls.SliderDIC,5:mstrmojo.android.inputControls.DateTimePickerDIC,6:mstrmojo.android.inputControls.DateTimePickerDIC,7:mstrmojo.android.inputControls.ToggleDIC,8:mstrmojo.android.inputControls.TextAreaDIC,9:mstrmojo.android.inputControls.SignatureDIC,10:mstrmojo.android.inputControls.RatingDIC,11:mstrmojo.DefaultDIC,12:mstrmojo.android.inputControls.StepperDIC,13:mstrmojo.android.inputControls.BarcodeDIC,14:mstrmojo.android.inputControls.LikertScaleDIC,102:mstrmojo.android.inputControls.MarkRowDIC},DICPopup:{getInstance:function(U,V){return mstrApp.showPopup({scriptClass:"mstrmojo.android.AndroidDICPopup",widget:V,buttons:[Q(mstrmojo.desc(221,"Cancel"),function(){this.parent.parent.onCancel();}),Q(mstrmojo.desc(1442,"OK"),function(){return this.parent.parent.onApply();})],title:V.popupTitle||U.parent.title});}},getDICClass:function J(U){if(U.t===C){return this.DICList[U.t][U.st||0];}return this.DICList[U.t];},showDICByDefault:function O(V,U){if(V.sbd===undefined){switch(V.t){case C:V.sbd=(!!V.st)?true:false;break;case L:case R:case A:case S:V.sbd=false;break;case D:case I:case K:case T:case G:case P:V.sbd=true;break;default:V.sbd=(V.dm===1);}}return V.sbd;},hasDICPreview:function N(V,U){return true;},isKeyNavigable:function M(U){if(U.ikn===undefined){U.ikn=false;}return U.ikn;}});B.TYPES={TEXTFIELD:A,SWITCH:I,LIST:C,SLIDER:E,CALENDAR:L,TIMEPICKER:R,TOGGLE:D,TEXTAREA:F,SIGNATURE:H,RATING:T,STEPPER:G,LIKERTSCALE:P};mstrmojo.DICConfig=B;mstrmojo.DICList=B.DICList;mstrmojo.DICPopup=B.DICPopup;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Button","mstrmojo.android.medium.ui.CalendarMarkupBuilder","mstrmojo.android.ui.CalendarDialog","mstrmojo.android.EnumOrientationTypes");var E=true,A={160:{YEAR:80,CELL:40},240:{YEAR:100,CELL:60},320:{YEAR:120,CELL:80}},B=mstrmojo.desc(2827,"Clear");function D(){if(!this.elasticHeight){this.contentList.elasticHeight=parseInt(this.calendar.domNode.offsetHeight,10);}}mstrmojo.android.medium.ui.CalendarDialog=mstrmojo.declare(mstrmojo.android.ui.CalendarDialog,null,{scriptClass:"mstrmojo.android.medium.ui.CalendarDialog",markupBuilder:mstrmojo.android.medium.ui.CalendarMarkupBuilder,currentViewMode:E,requiredOrientation:mstrmojo.android.EnumOrientationTypes.PORTRAIT,init:function(H){this._super(H);var K=this,J=this.calendar,I=J.target,F=mstrMobileApp.getDeviceDPI();J.layoutConfig.h={monthNode:(8*A[F].CELL)+"px",yearNode:A[F].YEAR+"px"};I.visible=this.currentViewMode!==E;this.addChildren([I]);this._elasticChild=I;var L=this.buttons[0],G=J.selectedDates;L.onclick=function(){return K.getCancelBtnFn();};if(G&&G.length>0){L.text=B;}},touchTap:function C(J){if(this._super){this._super(J);}var G=!this.currentViewMode,I=G===E,F=this.contentList,H=this.calendar;this.currentViewMode=G;if(mstrmojo.dom.contains(this.titleNode,J.target,true,this.domNode)===true){D.call(this);H.set("visible",I);F.set("visible",!I);F.rowHeight=F.rowHeight||-1;H.syncListItemsWithSelections(F.getSelectedItems());}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AE=mstrmojo.Enum_OIB_States,AD={},AF;for(AF in AE){if(AE.hasOwnProperty(AF)){AD[String(AE[AF])]=AF;}}return AD;}());var P=mstrmojo.dom,R=mstrmojo.hash,X=mstrmojo.Enum_OIB_States,I=0,Z="_did_",AA=mstrmojo.Enum_Keys,AC=80,T=200;function O(){return I++;}function f(AD){return(AD&&AD.state===X.ADDING);}function p(AD){var AE={n:AD||"",state:X.EMPTY};AE[Z]=-2;return AE;}function N(AD){return(AD&&AD.state===X.EMPTY);}function w(AE){var AF=AE.items,AD=AF&&AF.length;if(!AD){return true;}return(AD===1&&f(AF[0]))||(AD===2&&N(AF[0])&&f(AF[1]));}function j(){var AE=this.ctxtBuilder.itemWidgets,AD=AE[AE.length-1];if(AD&&AD.isAdding){return AD;}return null;}function K(){var AD=this.editingIdx;if(AD!==null){return this.ctxtBuilder.itemWidgets[AD];}return j.call(this);}function D(){this.isActive=false;var AE=this.emptyText||"",AF=this.items;if(w(this)&&!N(AF[0])&&(AE.length>0)){this.add([p(AE)],0);var AG=this.ctxtBuilder.itemWidgets[0];AG.set("shouldEllipsize",true);AG.doEllipsize();}var AD=K.call(this);if(AD){if(f(AD)){AD.domNode.style.display="none";}this.scrollTo(this.items[0]);AD.blur();}P.detachEvent(document.body,"mousedown",this._mousedownHandler);}function M(){this.isActive=true;if(N(this.items[0])){this.remove(0);}var AD=K.call(this);if(AD){if(f(AD)&&!this.isFull){AD.domNode.style.display="block";}this.scrollTo(AD.data);AD.focus();}P.attachEvent(document.body,"mousedown",this._mousedownHandler);}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,getSearchPattern:function(){var AD=K.call(this);if(AD){return AD.getSearchPattern();}return"";},getSuggestionTarget:function k(){return this.suggestTarget;},onsuggestTargetChanged:function o(AD){this._request_pattern=null;},getSuggestionPos:function a(){return this._pop_cfg;},onSuggestionItemSelect:function x(AD){this.suggestTarget.setItem(AD[this.itemField],AD,false);this.hideSuggestion();},hideEditButton:function(AD){return !!this.noEditButton;},_set_items:function h(AI,AF){AF=AF||[];var AH=this.maxObjectCount;this.set("isFull",(AH&&AF.length>=AH));if(AF.length===0){var AE=this.emptyText||"";if(AE.length>0){AF.push(p(AE));}}var AG={n:"",state:X.ADDING};AG[Z]=-1;AF.push(AG);var AD=AF[AF.length-1];if(AD&&f(AD)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=Z;return this._super(AI,AF);},add:function E(AE,AD){var AF=j.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AE,AD);}if(!w(this)&&N(this.items[0])){this.remove(0);}if(AF){AF.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);}}AF.domNode.style.display="none";},remove:function Y(AD){this._super(AD);var AE=j.call(this);if(AE){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AE.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function W(){this._super();var AE=this,AD=j.call(AE);if(AD){AD.domNode.style.display="none";}this._clickHandler=function(){M.call(AE);};this._mousedownHandler=function(AF){if(!AE.isActive||AE.browserShown){return ;}var AG=P.eventTarget(self,AF);if(AG&&AG.parentNode&&!P.contains(AE.domNode,AG,false,document.body)&&!P.contains(AE.suggestionPopup.domNode,AG,false,document.body)){D.call(AE);}};P.attachEvent(this.domNode,"click",this._clickHandler);},nextId:O,item2textCss:function L(AD){return AD.cssClass||"";},itemFunction:function G(AI,AE,AG){AI[AG.itemIdField]=O();var AJ=new mstrmojo.ObjectItem({parent:AG,itemField:AG.itemField,cssClass:AG.item2textCss(AI),data:AI});var AF=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AD=AF.length,AH;for(AH=0;AH<AD;AH++){AJ.attachEventListener(AF[AH],AG.id,"_itemChangeHandler");}return AJ;},getSelectedObjects:function g(){if(w(this)){return[];}var AD=this.items,AE=AD.length-1;if((AE>-1)&&f(AD[AE])){return AD.slice(0,AE);}return AD.concat();},isValid:function C(){var AE=this.ctxtBuilder.itemWidgets,AD=AE&&AE.length,AF;for(AF=0;AF<AD;AF++){if(!AE[AF].isValid()){return false;}}return true;},_itemChangeHandler:function(AG){var AI=AG.name,AJ=AG.d,AE,AD=this.items.length,AF;switch(AI){case"ItemEditBegin":if(this.editingIdx!==null){AF=K.call(this);if(AF){AF.blur();}}AE=this.itemIndex(AJ);this.editingIdx=AE;M.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AG.deactivate){D.call(this);}else{M.call(this);}AF=j.call(this);if(AF){AF.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AF=K.call(this);if(AF){AF.blur();}this.editingIdx=null;}AE=this.itemIndex(AJ);this.remove(AE);if(!AG.deactivate){this.editingIdx=null;M.call(this);}else{if(!this.isActive){D.call(this);}else{M.call(this);}}break;case"ItemDeletePrev":if(AD>1){this.remove(AD-2);}break;case"ItemAdd":var AH=R.copy(AG.d);this.add([AH],AD-1);if(AG.deactivate){D.call(this);}else{M.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AG.target);this._pop_cfg={target:AG.target,left:AG.l,top:AG.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AG.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AI==="ItemEditEnd"||AI==="ItemAdd"||AI==="ItemDelete"||AI==="ItemDeletePrev"||AI==="ItemEditing")){this.onitemchange();}},unrender:function B(AE){var AD=this.suggestionPopup;if(AD.hasRendered){AD.unrender(false);}if(this._super){this._super(AE);}},destroy:function t(AE){var AD=this.suggestionPopup;if(AD&&AD.hasRendered){AD.destroy(false);}if(this._super){this._super(AE);}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var q="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span class="'+q+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=q+" "+this.cssClass;},onstateChange:function(){var AG=this.state,AF=mstrmojo.Enum_OIB_States_CSS[AG],AE=this.domNode;if(AG===X.EMPTY){AE.innerHTML='<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>";}else{if(AG===X.EDITING){var AD=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AD-4+"px";this.inputNode.style.width=AD-9+"px";}}AE.className="mstrmojo-ObjectItem "+AF;if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},state:X.VALID,onstateChange:function d(AD){this.data.state=this.state;},ontextChange:function H(AD){this.data[this.itemField]=this.text;},updateData:function F(AD){R.copy(AD,this.data);this.set("state",X.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function z(AE){this._super(AE);var AG=this.data,AD=AG.state,AF=this.parent;if(typeof AD==="undefined"){AD=AF.dynamicVerify?AF.verifyObject(AG[this.itemField],this):X.UNDETERMINED;AG.state=AD;}this.cssClass=AF.item2textCss(AG);this.text=AG[this.itemField];this.state=AD;this.isAdding=f(AG);this.useRichTooltip=true;},isValid:function C(){var AD=parseInt(this.state,10);return(AD!==X.INVALID&&AD!==X.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AG=this.inputNode.style;AG.width=AC+"px";var AF=this.domNode.parentNode,AD=AF.parentNode.offsetWidth,AE=Math.max(AD-AF.offsetLeft-20,AC);if(!isNaN(AE)){AG.width=AE+"px";}}},blur:function S(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AF=this.inputNode,AD=AF.value,AE=this.parent;window.setTimeout(function(){try{AF.blur();}catch(AG){}},0);if(!AD){return ;}if(AE.acptSugItemOnly){this.set("text",AD);this.set("text","");this._tWas_=null;return ;}this.setItem(AD,null,true);},focus:function s(){var AE=this.inputNode,AD=this.isActive;window.setTimeout(function(){try{AE.focus();if(AE.createTextRange&&!AD){var AG=AE.createTextRange(),AF=AE.value.length;AG.move("character",AF);AG.select();}}catch(AH){}},0);this.isActive=true;},prekeydown:function J(AD){var AF=this.inputNode.value,AE=parseInt(AD.e.keyCode||AD.e.charCode,10),AH=this.parent;if(!AF){return ;}if(AE===AA.TAB||AE===AA.ENTER){P.preventDefault(AD.hWin,AD.e);var AG=AH.getSelected();if(AG){AH.handleSuggestionItemSelect(AG);}else{this.hideSuggestion();if(!AH.acptSugItemOnly){this.setItem(AF,null,false);}else{this.set("text",AF);this.set("text","");}}}else{if(AE===AA.DOWN_ARROW){if(!AH.noCache){this.showSuggestion(AF);}AH.nextHighlight();}else{if(AE===AA.UP_ARROW){AH.preHighlight();}}}},prekeyup:function AB(AD){var AF=this.inputNode.value,AE=parseInt(AD.e.keyCode||AD.e.charCode,10),AI=this.isAdding,AH=this.parent;if(!AF){if(AI){if(AE===AA.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});P.preventDefault(AD.hWin,AD.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AE===AA.ESCAPE){this.hideSuggestion();if(AH.acptSugItemOnly){this.set("text",AF);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AF){this.raiseEvent({name:"ItemEditing",d:this.data});if(AH.useKeyDelay){if(!this._timerID){var AG=this;this._timerID=window.setTimeout(function(){var AJ=AG.inputNode.value;if(AJ){AG.showSuggestion(AJ);}AG._timerID=null;},T);}}else{this.showSuggestion(AF);}}}this._tWas_=AF;},setItem:function(AD,AF,AE){var AH=this.isAdding,AG=this.parent;AE=AE||false;this.set("text",AD);this._tWas_=null;if(AH){this.set("text","");if(!AF){AF={};AF[this.itemField]=AD;}else{AF.state=X.VALID;}this.raiseEvent({name:"ItemAdd",d:AF,deactivate:AE});}else{this.set("text",AD);if(AF){this.updateData(AF);}else{this.set("state",AG.verifyObject(AD,this));this.set("cssClass",AG.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AF,deactivate:AE});}},getSearchPattern:function U(){return this.inputNode.value;},showSuggestion:function l(AD){var AE=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AE.x)+"px",t:Math.round(AE.y+AE.h)+"px",pattern:AD,target:this});},hideSuggestion:function e(){this.raiseEvent({name:"SuggestionOff"});},del:function Q(AD){AD=AD||self.event;P.stopPropogation(self,AD);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function V(){this.showSuggestion(this.text);this.set("state",X.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});},doEllipsize:function b(){if(!this.shouldEllipsize){return ;}var AE=this.maxItemWidth,AD;if(AE){this.domNode.style.maxWidth=AE;switch(parseInt(this.state,10)){case X.VALID:case X.UNDETERMINED:case X.INVALID:AD=this.textNode;break;case X.EMPTY:AD=this.domNode.firstChild;break;}if(AD){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AD,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox");var I=mstrmojo.array,G=mstrmojo.dom,C=mstrConfig.thousandsSep;if(C===undefined){C=",";}var B=2147762227,D=2147762262,J=2147762269,E=140;var N;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{getItemMarkup:function(Q,P){if(!N){N=this._super(Q,P).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return N;},getItemProps:function K(R,P){var Q=this._super(R,P),S=R.wt;Q.weight=(S)?"<em>("+mstrmojo.num.addSeparators(S,C)+" likes)</em>":"";return Q;}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-SearchBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",suggestionListClass:"mstrmojo.SearchBoxSelectorList",postCreate:function M(){var P=this.suggestionPopup;P.cssClass="mstrmojo-SearchBoxSelector-suggest";P.nudge=function(){var R=this.editorNode;if(!R){return ;}var Q=Math.min(R.offsetHeight,E),T=R.offsetWidth,W=G.windowDim(),V=this.left,U=this.top;if(U+Q>=W.h){U-=Q;}if(V+T>=W.w){V-=T;}var S=R.style;S.top=U+"px";S.left=V+"px";};},preBuildRendering:function L(){this.set("maxItemWidth",this.parent.contentNode.offsetWidth);this._super();},postBuildRendering:function A(){var P=this.parent.defn.fmts;if(!P.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function H(Q,T,P){var U=Q,R=this.suggestCount;if(!this.noCache){P=P||R;T=mstrmojo.string.regEscape(T);var V=this.itemField,S=new RegExp("^"+T,"i");U=I.filter(Q,function(W){return S.test(W[V]);},{max:P});}if(U.length){I.forEach(this.items,function(X){var W=I.find(U,"v",X.v);if(W>-1){U.splice(W,1);}});}if(U.length>=R){U=U.slice(0,R);}return U;},getCandidatesThroughTaskCall:function O(S,V){var P=this.id,R=this.getSuggestionTarget(),Q=S.pattern||"",X=this.parent,W=this.srcid;Q=Q.replace(/"/,"");if(W){var T={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:W,dataSourcesXML:this.dsrc||"",blockCount:this.REQUEST_THRESHOLD,searchPattern:Q,browseFlags:1};var U=X.defn;if(U.dsid){T.datasetID=U.dsid;T.messageID=X.model.mid;T.ctlKey=X.ckey;}if(U.sfid){T.searchForms=U.sfid;if(parseInt(U.sfdt,10)===8){T.searchPattern+="*";}}V.success=function(b){if(b&&b.es){var e=mstrmojo.all[P],f=e.getSuggestionTarget(),Y=b.es.length;if(!b||!f||(R!==f)){return ;}if(Y&&(Y>e.suggestCount)){return ;}var a=f.getSearchPattern(),Z=b.es;if(W){Z=mstrmojo.elementHelper.buildElemsTerseID(Z,W,true);}var d=S.pattern;e._last_hit={items:Z,pattern:d};if(a&&a.indexOf(d)>-1){e.updateSuggestion(e.filterCandidates(Z,a));}}};V.failure=function(Z){var Y=parseInt(Z.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296;if(Y!==B&&Y!==D&&Y!==J){mstrmojo.alert(Z.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,T,false,null,true);}},onsuggestionItemsChange:function F(){var U=this.suggestionItems,R=this.suggestionPopup,Q=R.editorNode,S=U&&(U.length>8),P="",T="";if(S){P=E;T="px";}if(Q){Q.style.height=P+T;}else{if(S){T+=";";R.cssText=(R.cssText||"")+"height:"+P+T;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidMap","mstrmojo.maps.jsmap.AndroidDocMapInfoWindow","mstrmojo.Overlay","mstrmojo.hash","mstrmojo.array","mstrmojo.dom");var F=mstrmojo.dom;mstrmojo.maps.jsmap.AndroidDocMap=mstrmojo.declare(mstrmojo.maps.jsmap.AndroidMap,[mstrmojo._Formattable],{scriptClass:"mstrmojo.maps.jsmap.AndroidDocMap",cssClass:"mstr-googleMapView",formatHandlers:{domNode:["left","top","z-index","height","width","border","border-color","border-style","border-width"]},sc:null,getMapModel:function C(){var O=this.doc,M=O.model,N=mstrApp.getCurrentProjectId(),P=mstrApp.serverProxy.getSessions();return{pid:N,sessions:P,model:this.model,docData:{did:O.did,ttl:O.ttl,st:O.st,mid:M.mid,bs:M.bs,data:M.data,defn:M.defn},cfg:mstrApp.getConfiguration().getConfiguration()};},postBuildRendering:function A(){this._touchListener=mstrmojo.touchManager.attachEventListener("touchesBegin",this.id,function(M){var N=this.openedInfoWindow;if(N){if(!F.contains(this.domNode,M.touch.target,true,document.body)&&!mstrApp.isDialogUp()){N.close();}}});return this._super();},destroy:function J(M){var N=this._touchListener;if(N){mstrmojo.touchManager.detachEventListener(N);delete this._touchListener;}this._super(M);},setModel:function L(M){this.doc=M.controller.view;this._super(M);},initFromVisProps:function I(M){this._super(M);if(!M){return ;}this.iwDocLayout=(parseInt(M.dl,10)===1);if(M.lyt){this.iwLayoutKey=M.lyt;}},findSelectorTarget:function G(R){if(R&&R.tks){var O=this.model.docModel,N=R.tks.split("\u001E"),P=0,M=N.length;for(P=0;P<M;++P){var Q=O.getTargetDefn(N[P]);if(Q[N[P]].ifw){return N[P];}}}},showInfoWindow:function D(O,N,M){this.openedInfoWindow=M;M.open(O,N);},getInfoWindow:function K(P,N){var O=this.gridData;if(this.iwDocLayout){this.getInfoWindowFromLayout(O,P,N,this.showInfoWindow);}else{var Q=this.getInfoWindowSelectorControl(O),M=this.findSelectorTarget(Q);if(!(!!Q&&M)){return this.getDefaultInfoWindow(O,N);}}},getInfoWindowFromLayout:function B(T,N,P,X){var M=this,V=this.doc,W=V.getLayouts(),O=this.iwLayoutKey,Q=W[mstrmojo.array.find(W,"k",O)],Y="\x1F",S="12",U=P.attrid+Y+S+Y+P.eid;var R={layoutKey:O,groupByIDs:U};V.selectLayout(Q,(O!==V.model.currlaykey),{complete:function(){Q.defn.loaded=false;V.getNewLayout(R,W,false,{complete:function(){mstrApp.hideMessage();},submisson:function(){mstrApp.showMessage();},success:function(j){var a=j.node,d,g=document.createElement("div"),p=g.style,l=a.defn.fmts.width,e=a.defn.fmts.height||a.data.mh;d=new mstrmojo.Overlay({children:[j]});d.set("width",l);d.set("height",e);var k=document.createElement("div");d.placeholder=k;d.render();p.overflow="hidden";g.appendChild(d.domNode);var f=new google.maps.InfoWindow({content:g});M.openedInfoWindow=f;f.open(N,P);var b=300,o=0,Z=window.setInterval(function(){var s=g.parentNode;if(s){var h=s.offsetWidth,q=s.offsetHeight;if(h!==parseInt(l,10)||q!==parseInt(e,10)){d.setDimensions(q+"px",h+"px");window.clearTimeout(Z);}}o+=b;if(o>10*b){window.clearTimeout(Z);}},b);}},true);}});},getInfoWindowSelectorControl:function E(M){if(!this.sc){this.sc=M.gts.row[0].sc;}return this.sc;},postHandleMarkerClick:function H(P,M){var R=this.gridData,Q=this.getInfoWindowSelectorControl(R);if(Q&&Q.tks){var O=this,S=null,N=O.model.docModel;N.getDataService().setDocSelectorElements(Q.ck,M.eid,Q.ckey,Q.include,{success:function(s){var q=N.getTargetDefn(Q.tks);if(s.pukeys){q=N.getTargetDefn(s.pukeys);}S=N.updateDataCache(s.data,q);var p=O.findSelectorTarget(Q);if(p){var Z=N.getTargetDefn(p),T="*l"+s.currlaykey+"*k"+p+"*x1*t"+N.buildTime,f=T+"_ifw",U=mstrmojo.all[f];if(U){U.destroy();}var X=new mstrmojo.maps.jsmap.AndroidDocMapInfoWindow({id:f,parent:O,builder:O.builder,model:N,psKey:p,psId:T});var e=Z[p].fmts,j=document.createElement("div"),k=j.style,a=e.width,o=e.height;X.set("width",a);X.set("height",o);var Y=document.createElement("div");X.placeholder=Y;X.render();k.height=o;k.width=a;k.overflow="hidden";j.appendChild(X.domNode);var V=new google.maps.InfoWindow({content:j});var l=V.close;V.close=function(){l.call(V);X.destroy();delete O.openedInfoWindow;};O.openedInfoWindow=V;V.open(P,M);var b=300,d=0,W=window.setInterval(function(){var w=j.parentNode;if(w){var h=w.offsetWidth,t=w.offsetHeight;if(h!==parseInt(a,10)||t!==parseInt(o,10)){X.setDimensions(t+"px",h+"px");window.clearTimeout(W);}}d+=b;if(d>10*b){window.clearTimeout(W);}},b);}var g={name:"partialUpdate",tree:s.data,ids:S};if(!mstrmojo.hash.isEmpty(g.ids.ifws)){delete g.ids.ifws[p];}N.raiseEvent(g);}},N.zf,true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidMap");mstrmojo.maps.jsmap.AndroidRptMap=mstrmojo.declare(mstrmojo.maps.jsmap.AndroidMap,null,{scriptClass:"mstrmojo.maps.jsmap.AndroidRptMap",setModel:function A(B){this._super(B);this.controller.getPageByTree(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.androidmap.AndroidMap","mstrmojo.maps.androidmap.AndroidDocMapInfoWindow","mstrmojo.Image","mstrmojo.DynamicClassFactory","mstrmojo.Box","mstrmojo._HasLayout","mstrmojo.DocPanel","mstrmojo.hash","mstrmojo.array","mstrmojo.dom");var F=mstrmojo.dom;var a=0,K=1,R=mstrmojo.hash;function G(e){if(!e||!e.p_fmts){return e;}var d=e.p_fmts;var f=parseInt(d.top)||0;var g=parseInt(d.height)||0;var b=parseInt(e.height)||0;return{top:(f+g-b)+"px",left:d.left,width:e.width,height:e.height,"z-index":d["z-index"]};}function Y(h,g){if(h&&g){if(h["z-index"]>g["z-index"]){return false;}var d=parseInt(h.left),o=parseInt(h.top),f=parseInt(h.width),k=parseInt(h.height),b=parseInt(g.left),l=parseInt(g.top),e=parseInt(g.width)||0,j=parseInt(g.height)||0;return((((d<=b)&&(b<d+f))||((b<d)&&(d<b+e)))&&(((o<=l)&&(l<o+k))||((l<o)&&(o<l+j))));}return false;}function L(){if(!mstrApp.renderingMap||(mstrApp.renderingMap===this.id)){mstrApp.renderingMap=this.id;return true;}else{return false;}}function P(){if(mstrApp.renderingMap===this.id){delete mstrApp.renderingMap;return true;}return false;}mstrmojo.maps.androidmap.AndroidDocMap=mstrmojo.declare(mstrmojo.maps.androidmap.AndroidMap,[mstrmojo._Formattable],{scriptClass:"mstrmojo.maps.androidmap.AndroidDocMap",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@domNodeCssText}" mstrAttach:touchstart></div>',formatHandlers:{domNode:["left","top","z-index","height","width","border","border-color","border-style","border-width"]},sc:null,domNodeCssText:"position:relative;",lastSelectedRow:null,hasTarget:function J(){var b=this.getInfoWindowSelectorControl(this.gridData);return !!(b&&b.tks);},postBuildRendering:function U(){this._touchListener=mstrmojo.touchManager.attachEventListener("touchesBegin",this.id,function(b){var d=this.openedInfoWindow;if(d){if(!F.contains(this.domNode,b.touch.target,true,document.body)){d.close();}}});return this._super();},destroy:function X(b){var d=this._touchListener;if(d){mstrmojo.touchManager.detachEventListener(d);delete this._touchListener;}if(this.mapRendered){this.removeMap();}this._super(b);},setModel:function M(b){this.doc=b.controller.view;this._super(b);},initFromVisProps:function W(b){this._super(b);if(!b){return ;}this.iwDocLayout=(parseInt(b.dl,10)===1);if(b.lyt){this.iwLayoutKey=b.lyt;}},findSelectorTarget:function O(j){if(j&&j.tks){var f=this.xtabModel.docModel,e=j.tks.split("\u001E"),g=0,b=e.length;for(g=0;g<b;++g){var h=f.getTargetDefn(e[g]);if(h[e[g]].ifw){return e[g];}}}return null;},findIntersectingComponents:function C(){var f=this,j,e=this.getFormats();while(f.scriptClass!="mstrmojo.DocSubsection"||f.scriptClass!="mstrmojo.DocInfoWindow"){j=f;f=f.parent;if(!f){break;}var h=f.children,d=(h&&h.length)||0,g=null,b;for(b=0;b<d;b++){g=h[b];if(g!=j&&g.getFormats&&Y(G(e),G(g.getFormats()))){return true;}}}return false;},getGridModel:function(){var b=this._super();delete b.layoutModel;delete b.layoutNode;return b;},dispatchMapData:function B(){if(!L.call(this)){this.domNode.innerHTML=mstrmojo.desc(9480,"Only one map visualization is supported at a time");mstrmojo.css.addClass(this.domNode,"noMapVis");return ;}var g=this.doc,b=g.model,e=this.getViewHierarchy(),f=this.getMapModel(),o=this.simplifyGridData(),h=(g.getSupportedLayouts&&g.getSupportedLayouts())||g.getLayouts(),j=!!this.isFullScreenWidget?K:a,l=false,k=g.getCurrentLayout(),d;d=JSON.stringify({did:g.did,ttl:g.ttl,st:g.st,mid:b.mid,ci:b.ci,bs:b.bs,zt:b.zt,defn:b.defn,currlaykey:b.currlaykey});delete f.model;if(k.setMapID){k.setMapID(this.id);}if(!j){l=this.findIntersectingComponents();}mstrMobileApp.loadMap(JSON.stringify(R.copy({fullScreen:j,infoWindow:this.getInfoWindowConfig(),viewTree:e,mapPath:this.mapPath,active:l,docModelId:this.xtabModel.docModel.id,hasTarget:this.hasTarget(),zt:b.zt,gdProp:o.prop},f)),o.es,o.data,d);this.mapRendered=true;},getViewHierarchy:function(){var j=[];var g=this.parent,b=[],h=R.copy(this.fmts,{}),d=this;b.push(h);while(g){h=R.copy(g.fmts,{});h.id=g.id;j.push(h.id);if(g.scriptClass==="mstrmojo.MobileDocLayoutViewer"){delete h.width;delete h.height;}else{if(g instanceof mstrmojo.DocPanel){var f=parseInt(g.domNode.style.left,10);if(f>0){g.parent._scrollOffsetLeft=f;}}else{if(g.scriptClass==="mstrmojo.DocSection"){if(g.domNode.offsetTop){h.top=g.domNode.offsetTop+"px";}}else{if(g.scriptClass==="mstrmojo.DocInfoWindow"){if(g.containerNode){h.top=g.containerNode.offsetTop+"px";h.left=g.containerNode.offsetLeft+"px";}g.onClose=function(){mstrMobileApp.hideMapView(1);};}}}}if(g._scroller){if(!g._scroller.scrollMoveListener){var e=function(k){mstrMobileApp.scrollerUpdated(JSON.stringify({id:this.id,x:k.x-(this._scrollOffsetLeft||0),y:k.y}));};g._scroller.attachEventListener("scrollMoved",g.id,e);g._scroller.attachEventListener("scrollDone",g.id,e);g._scroller.attachEventListener("transformAnim",g.id,e);g._scroller.scrollMoveListener=true;}h.scroller=true;}b.splice(0,0,h);g=g.parent;}this.mapPath=j.join("")+":"+JSON.stringify(b);return b;},getInfoWindowConfig:function T(){if(!this.iwConfig){if(this.iwDocLayout){this.iwConfig={dft:false};}else{var h=this.gridData,g=this.getInfoWindowSelectorControl(h);if(g){var e=this.xtabModel.docModel,f=e.getTargetDefn(g.tks);if(this.findSelectorTarget(g)){this.iwConfig={dft:false};if(f&&f[g.tks]){var b=f[g.tks].fmts;this.iwConfig.size={w:parseInt(b.width,10),h:parseInt(b.height,10)};return this.iwConfig;}}}this.iwConfig={dft:true};}}return this.iwConfig;},resetLayout:function E(){if(this.iwDocLayout&&this.preIWLayout){this.doc.selectLayout(this.preIWLayout,true,null,true);this.preIWLayout=null;}},closeInfoWindow:function D(){do{mstrApp.closeDialog();}while(mstrmojo.all.mstrMapInfoWindow);},removeMarkerAnchor:function Q(){var b=mstrmojo.all.mstrMapMarkerAnchor;if(b){b.destroy();}},beforeViewHidden:function I(b){this.unrender();},handleMarkerSelection:function H(b,f,e){this.removeMarkerAnchor();var d=mstrmojo.insert({id:"mstrMapMarkerAnchor",scriptClass:"mstrmojo.Box",cssText:"left:"+f+"px;top:"+e+"px;position:absolute;z-index:100",width:"1px",height:"1px"});d.render();document.body.appendChild(d.domNode);this.handleMarkerTargetSelection(b,d);this.handleMarkerInfoWindowLayoutSelection(b,d);},handleMarkerInfoWindowLayoutSelection:function A(w,j){var p=this.gridData,t=p.gts.row[0],h=t.id,b=p.ghs.rhs.items[w],s=b&&b.items[0].idx,e=this,f=(s>=0)?t.es[s].id:-1;if(this.iwDocLayout){var z=this.doc,x=z.getLayouts(),g=this.iwLayoutKey,k=x[mstrmojo.array.find(x,"k",g)],AA="\x1F",o="12",q=h+AA+o+AA+f;var l={layoutKey:g,groupByIDs:q,reload:true};if(!this.preIWLayout){this.preIWLayout=x[mstrmojo.array.find(x,"k",this.defn._lkz)];}(function(AG,AE){var AD=z,d=AD.model,AF=d.getDataService(),AB=AG.layoutKey,AC=AE[mstrmojo.array.find(AE,"k",AB)];if(AC.defn&&(AG.reload||AC.defn.loaded===false)){AF.loadDocLayout(AG,{success:function(AR){var AO=e.xtabModel.docModel,AU=g,AQ;AR.key=AU;AR.isSelected=false;AO.replaceLayout(AU,AR);AQ=z.rebuildLayout(AU,AE);e.lastSelectedRow=w;var AK=AQ.node,AM,AI=mstrApp.getScreenDimensions(),AV=AI.w*0.85,AP=AI.h*0.9,AH=AI.w*0.6,AS=AI.h*0.5,AT=AK.defn.fmts.width||(AH+"px"),AN=AK.defn.fmts.height||AK.data.mh||(AS+"px");e.closeInfoWindow();AM=new mstrmojo.Overlay({cssClass:"iwOverlay",children:[AQ]});AM.set("width",AT);AM.set("height",AN);mstrApp.showPopup({id:"mstrMapInfoWindow",cssClass:"mapInfoWindow",scriptClass:"mstrmojo.android.Popup",anchorOffset:1,onClose:function(){window.setTimeout(function(){e.resetLayout();},0);},resizeDialog:function(){var AY=this.editorNode;if(mstrApp.isTablet()){var AX=this.popDimensions;if(AX){AP=AX.h;AV=AX.w;}else{AP=Math.min(488,AP);AV=Math.min(550,parseInt(AT,10));}}this.set("width",Math.min(parseInt(AT,10),AV)+"px");if(AY){AY.style.height=Math.min(parseInt(AN,10),AP)+"px";}mstrmojo.Dialog.prototype.resizeDialog.call(this);},children:[AM]},j.domNode);var AL=300,AW=0,AJ=window.setInterval(function(){var AZ=AM.parent.editorNode;if(AZ){var AX=AZ.clientWidth,AY=AZ.clientHeight;if(AX!==parseInt(AT,10)||AY!==parseInt(AN,10)){AM.setDimensions(AY+"px",AX+"px");window.clearTimeout(AJ);}}AW+=AL;if(AW>10*AL){window.clearTimeout(AJ);}},AL);z.selectLayout(AC,true);}});}else{AD.selectLayout(AC,true);}})(l,x);}},handleMarkerTargetSelection:function V(t,j){var l=this.gridData,q=l.gts.row[0],h=q.id,b=l.ghs.rhs.items[t],p=b&&b.items[0].idx,e=this,f=(p>=0)?q.es[p].id:-1;var o=this.getInfoWindowSelectorControl(l),g=this.findSelectorTarget(o);if(o&&o.tks){var s=null,k=e.xtabModel.docModel;k.getDataService().setDocSelectorElements(o.ck,f,o.ckey,o.include,{success:function(AE){var AA=k.getTargetDefn(o.tks);if(AE.pukeys){AA=k.getTargetDefn(AE.pukeys);}s=k.updateDataCache(AE.data,AA);var AB=e.findSelectorTarget(o);if(AB){var AD=k.getTargetDefn(AB),x=AB+"_ifw",AG=mstrmojo.all[x],d="*l"+AE.currlaykey+"*k"+AB+"*x1*t"+k.buildTime;if(AG){AG.destroy();}var z=new mstrmojo.maps.androidmap.AndroidDocMapInfoWindow({id:x,builder:e.doc.builder,model:k,psKey:AB,psId:d});var AF=AD[AB].fmts,AC=parseInt(AF.width,10)||width,AI=parseInt((AF.p_fmts&&AF.p_fmts.height)||AF.height,10)||height;z.set("width",AC+"px");z.set("height",AI+"px");mstrApp.showPopup({id:"mstrMapInfoWindow",scriptClass:"mstrmojo.android.Popup",cssClass:"mapInfoWindow",anchorOffset:1,children:[z],resizeDialog:function(){var w=this.editorNode;this.set("width",AC+"px");if(w){w.style.height=AI+"px";}mstrmojo.Dialog.prototype.resizeDialog.call(this);}},j.domNode);}var AH={name:"partialUpdate",tree:AE.data,ids:s,anchor:j.domNode};if(!mstrmojo.hash.isEmpty(AH.ids.ifws)){delete AH.ids.ifws[AB];}k.raiseEvent(AH);}},k.zf,true);}},getInfoWindowSelectorControl:function S(b){if(!this.sc&&!b.eg){this.sc=b.gts.row[0].sc;}return this.sc;},afterViewVisible:function N(){window.setTimeout(function(){mstrMobileApp.showMapView(1);},300);},removeMap:function Z(){this.closeInfoWindow();this.removeMarkerAnchor();this.resetLayout();if(P.call(this)){mstrMobileApp.hideMapView(1);}},unrender:function(){this.lastSelectedRow=null;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.androidmap.AndroidMap");mstrmojo.maps.androidmap.AndroidRptMap=mstrmojo.declare(mstrmojo.maps.androidmap.AndroidMap,null,{scriptClass:"mstrmojo.maps.androidmap.AndroidRptMap",setModel:function A(B){this._super(B);this.controller.getPageByTree(false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.VisChart");var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;mstrmojo.VisMicroChartLine=mstrmojo.declare(mstrmojo.VisChart,null,{scriptClass:"mstrmojo.VisMicroChartLine",isDrawAxis:false,margin:{t:5,r:2,b:1,l:2},showHighlightLine:false,themeColor:"#FFFFFF",isDrawRefArea:true,noBackground:true,isAnimateLines:false,toolTipMain:null,mainWidth:0,mainLeftPos:0,reDrawChart:function reDrwchart(){var context=this.context,canvas=this.canvas,wd=canvas.width,ht=canvas.height;context.clearRect(0,0,wd,ht);this.data.processLinearData(this);this.windowSize=this.model.series[0].rv.length;this.utils.fillBackground(this);if(this.windowSize<=1){return ;}this.drawChart();},setColorByTheme:function setColorByTheme(){var lineProps=this.config;if(this.theme===DEFAULT_DARK_THEME||this.theme===DEFAULT_LIGHT_THEME){this.startPointColor="#50B5D8";this.endPointColor="#50B5D8";this.otherPointColor="#50B5D8";this.isDrawRefArea=false;this.sparkLineColor="#50B5D8";this.refLineColor="#FF781D";}else{this.startPointColor="#000000";this.endPointColor="#FF0000";this.otherPointColor="#663300";this.isDrawRefArea=lineProps.mbRefArea;this.sparkLineColor=lineProps.mwSeriesLineCol;this.refLineColor=lineProps.mwRefLineCol;}var dpi=mstrMobileApp.getDeviceDPI();this.sparkLineWidth=dpi>160?2:1;this.refLineWidth=1;this.startEndPointRadius=dpi>=320?4:dpi>=240?3:2;},drawChart:function drwchrt(){this.setColorByTheme();var lineProps=this.config;var context=this.context;var model=this.model;var values=model.series;var mvalues=model.mvalues;var margin=this.margin;var height=this.getHeight();var width=this.getWidth();var utils=this.utils;var maxVR=mvalues[mvalues.length-1];var minVR=mvalues[0];var maxYValue=mvalues[mvalues.length-1];var minYValue=mvalues[0];if(this.refv&&this.refv.length>1&&lineProps.mbRefLine){var refValue=parseFloat(this.refv[1].rv);if(isNaN(refValue)){}else{if(refValue>maxVR){maxVR=refValue;if(mvalues.length===1){mvalues[1]=maxVR;}else{mvalues[mvalues.length-1]=maxVR;}}if(refValue<minVR){minVR=refValue;if(mvalues.length===1){mvalues[1]=mvalues[0];mvalues[0]=maxVR;}else{mvalues[0]=minVR;}}}}this.themeColor=lineProps.mwRefAreaCol;this.isDrawStartEndPoints=lineProps.mbAllPoints?7:(lineProps.mbEndPoints?3:0);if(this.isDrawStartEndPoints&1&&margin.l<this.startEndPointRadius){margin.l=this.startEndPointRadius;}if(this.isDrawStartEndPoints&2&&margin.r<this.startEndPointRadius){margin.r=this.startEndPointRadius-1;}if(model.err){return ;}if(!values){return ;}if(maxVR!==minVR){this.RTY=(height-margin.t-margin.b-4)/(maxVR-minVR);}else{this.RTY=0;}if(this.windowSize!==1){this.RTX=(width-margin.l-margin.r-1)/(this.windowSize-1);}else{this.RTX=0;}var lines=[];var k=0;for(var i=0;i<this.windowSize;i++){var val=values[0].rv[i];if(val.length===0){continue;}var x=(i*this.RTX)+margin.l;var y=utils.getYValue(this,val);lines[k]={x:x,y:y};k++;}if(lines.length===0){return ;}maxYValue=utils.getYValue(this,maxYValue);minYValue=utils.getYValue(this,minYValue);if(maxYValue===undefined||minYValue===undefined){maxYValue=height-4-margin.b;minYValue=margin.t;}if(this.isDrawRefArea){context.fillStyle=this.themeColor;context.fillRect(margin.l,minYValue,width-margin.r-margin.l,(maxYValue-minYValue));}context.lineCap="round";context.lineWidth=this.sparkLineWidth;context.lineJoin="round";context.strokeStyle=this.sparkLineColor;utils.drawLineSet(this,lines,false,context);if(this.isDrawStartEndPoints){utils.drawStartEndPoints(this,lines,context,this.isDrawStartEndPoints);}if(this.refv&&this.refv.length>1&&lineProps.mbRefLine){var refValue=this.refv[1].rv*1;var y=this.utils.getYValue(this,refValue);if(isNaN(y)){y=height-5;}if(context.lineWidth%2===1){y=Math.round(y+0.5)-0.5;}context.beginPath();context.moveTo(margin.l,y);context.lineTo(width-margin.r,y);context.lineWidth=this.refLineWidth;context.strokeStyle=this.refLineColor;context.stroke();}},highlightPoint:function hghlghtpnt(x,touchY){var me=this,ctx=me.highlightContext,height=me.getHeight(),width=me.getWidth(),margin=me.margin,model=me.model,utils=me.utils;ctx.clearRect(0,0,width,height);if(x<0){return ;}var xcoord=(x*me.RTX)+margin.l;ctx.globalAlpha=1;ctx.strokeStyle=this.sparkLineColor;ctx.fillStyle=ctx.strokeStyle;var y=utils.getYValue(me,model.series[0].rv[x]);if(xcoord<5){xcoord=5;}if(xcoord>width-5){xcoord=width-5;}if(y<5){y=5;}if(y>height-5){y=height-5;}ctx.strokeStyle="FFFFFF";ctx.fillStyle=ctx.strokeStyle;ctx.globalAlpha=0.8;utils.drawArc(this,xcoord,y,5,0,Math.PI*2,true,true,ctx);ctx.strokeStyle=this.sparkLineColor;ctx.fillStyle=ctx.strokeStyle;ctx.globalAlpha=1;utils.drawArc(me,xcoord,y,5,0,Math.PI*2,true,false,ctx);utils.drawArc(me,xcoord,y,2.5,0,Math.PI*2,true,true,ctx);this.highlightCanvas.id="highLightCav"+this.widget.domNode.id;},renderTooltip:function rndrttp(valIndex,touchX,touchY){if(valIndex<0){this.toolTipMain.style.display="none";return ;}var highLightCav=document.getElementById("highLightCav"+this.widget.domNode.id);if(highLightCav){var highlightCt=highLightCav.getContext("2d");highLightCav.id="";highlightCt.clearRect(0,0,1000,1000);}var m=this.model,s=m.series,utils=this.utils,l=s.length,si=this.seriesIndex,ch=m.colHeaders,rh=this.baseModel.rowHeaders,ttp=this.toolTipMain;var me=this,ctx=me.highlightContext,height=me.getHeight(),width=me.getWidth(),margin=me.margin,utils=me.utils;var metrics=m.mtrcs;metrics=metrics.items;if(isNaN(this.kpiOffset)){this.kpiOffset=0;}var sn="";var line1=m.categories.tn+": "+m.categories.items[valIndex];var line2;if(
/*this.widget.isKPI &&*/
this.widget.sparklineProps.mstrAssMetric){line2=this.widget.sparklineProps.mstrAssMetric+": "+s[0].v[valIndex];}else{line2=metrics[this.kpiOffset]+": "+s[0].v[valIndex];}var relx=(valIndex*me.RTX)+margin.l;var rely=utils.getYValue(me,s[0].rv[valIndex]);var leng1=this.widget.getTextWidthByCanvas(line1,ttp);var leng2=this.widget.getTextWidthByCanvas(line2,ttp);var domHtml=line1+"<br/>"+line2;var leng3=0;if(this.refv&&this.refv.length>1&&this.config.mbRefLine){domHtml+="<br/>";var line3=metrics[this.kpiOffset+1]+": "+this.refv[1].v;leng3=this.widget.getTextWidthByCanvas(line3,ttp);domHtml+=line3;}ttp.innerHTML='<div style="margin-left:5px;margin-bottom:4px;margin-top:5px;">'+domHtml+"</div>";var maxLength=Math.max(leng1,leng2,leng3);var oft=mstrmojo.boxmodel.offset(this.domNode,this.widget.domNode);var pos=mstrmojo.dom.position(this.domNode,true);var posWdt=mstrmojo.dom.position(this.widget.domNode,true);var maxWidth=maxLength+10;ttp.style.display="block";ttp.style.borderColor=this.sparkLineColor;ttp.style.width=maxWidth+"px";var topOff=(rely+pos.y-posWdt.y-ttp.offsetHeight-29);if(topOff<0){topOff=0;}var leftOff=(oft.left+relx+maxWidth+20);if(leftOff>this.widget.getWidth()){leftOff=(relx+oft.left-maxWidth-20);if(leftOff<0){leftOff=0;}}else{leftOff-=maxWidth;}ttp.style.top=topOff+"px";ttp.style.left=leftOff+"px";var yadjust=this.mainOffsetTop===0?ttp.offsetHeight+20:(2*ttp.offsetHeight)+30;var yPos=utils.getYValue(this,s[si].rv[valIndex])-yadjust+this.offsetTop;if(yPos<0){yPos=0;}if(this.mainWidth>0){var xposr=touchX+ttp.offsetWidth+this.offsetLeft-this.mainLeftPos;if(xposr>this.mainWidth){touchX-=(xposr-this.mainWidth);}}},isTouchPointInGraphRange:function tpInGR(touchX,touchY){var margin=this.margin;if(touchX<margin.l||touchY<margin.t||touchY>this.canvas.height-margin.b){return false;}return true;},showTooltip:function handleTouchMove(touchX,touchY){if(!this.config.mbShowTooltip){return false;}var me=this,m=me.model;if(m.series[0].rv.length<=1){return false;}var pos=mstrmojo.dom.position(this.domNode,true);touchX=touchX-pos.x;touchY=touchY-pos.y;if(!this.isTouchPointInGraphRange(touchX,touchY)){return false;}var touchVal=me.getTouchValue(touchX,touchY);var margin=this.margin;if(touchVal!==null){var x=(touchVal*me.RTX)+margin.l;if(me.widget.enableSmoothScroll){if(this.domNode.offsetLeft+x<this.widget._scroller.origin.x){return false;}}var rns=(m.rne-m.rns>1)?m.rns:m.rns-1;if(me.seriesIndex===-1||me.switchSeriesOnTouch){me.seriesIndex=me.utils.getSeriesIndexAndYValue(me,rns+touchVal,touchY).si;}if(m.series[me.seriesIndex].rv[rns+touchVal]===""){return false;}me.prevHighlight=me.currentHighlight;me.currentHighlight=touchVal;if(!me.widget.tooltipShow||me.prevHighlight!=me.currentHighlight){me.renderTooltip(touchVal,x,touchY);me.highlightPoint(touchVal,touchY);}return true;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisChart");var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;mstrmojo.VisMicroChartBar=mstrmojo.declare(mstrmojo.VisChart,null,{scriptClass:"mstrmojo.VisMicroChartBar",isDrawAxis:false,margin:{t:0,r:1,b:0,l:1},showHighlightLine:false,themeColor:"#FFFFFF",noBackground:true,isAnimateLines:false,toolTipMain:null,labelLen:0,mainWidth:0,mainLeftPos:0,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};top:{@top};left:{@left};position:relative;"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><canvas style="position:absolute;left:0;top:0" width="{@width}" height="{@height}"></canvas><div style="position:absolute;left:0px;top:0px;padding-left:1px;padding-top:1px;text-align:left;-webkit-text-size-adjust: none"></div><div style="position:absolute;left:0px;bottom:0px;padding-left:1px;padding-bottom:1px;text-align:left;-webkit-text-size-adjust: none"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},animationCanvas:function(){return this.domNode.childNodes[1];},highlightCanvas:function(){return this.domNode.childNodes[2];},minLabel:function(){return this.domNode.childNodes[3];},maxLabel:function(){return this.domNode.childNodes[4];}},postBuildRendering:function postBR(){if(this._super){this._super();}this.windowSize=this.model.series[0].rv.length;if(this.windowSize===1){this.plot();}},getTouchValue:function gtvlindx(touchX){var series=this.model.series[0];var ind=0;for(var i=0;i<series.v.length;i++){if(touchX<this.hightLightPos[i].x){if(i===0){ind=i;}else{ind=(this.hightLightPos[i].x+this.hightLightPos[i-1].x)/2>touchX?(i-1):i;}break;}}if(i!==series.v.length){}else{ind=i-1;}return ind;},isTouchPointInGraphRange:function tpInGR(touchX,touchY){if(touchX<=this.labelLen+1||touchX>=this.getWidth()-1){return false;}return true;},showTooltip:function rndrttp(pageX,pageY){if(!this.config.mbShowTooltip||this.noDataToShowTtp){return false;}var m=this.model,series=m.series[0];if(series.rv.length<=1){return false;}var pos=mstrmojo.dom.position(this.domNode,true);var touchX=pageX-pos.x;var touchY=pageY-pos.y;if(!this.isTouchPointInGraphRange(touchX,touchY)){return false;}var touchVal=this.getTouchValue(touchX,touchY);var x=this.hightLightPos[touchVal].x;if(this.widget.enableSmoothScroll){if(this.domNode.offsetLeft+x<this.widget._scroller.origin.x){return false;}}this.prevHighlight=this.currentHighlight;this.currentHighlight=touchVal;if(!this.widget.tooltipShow||this.prevHighlight!=this.currentHighlight){touchX=Math.round(this.hightLightPos[touchVal].x);touchY=Math.round(this.hightLightPos[touchVal].y);var vl=series.rv[touchVal]*1;var tColor=this.posBarColor;if(vl<0){tColor=this.negBarColor;}if(series.thClr&&series.thClr[touchVal]){tColor=series.thClr[touchVal];}this.renderTooltip(touchVal,x,touchY,tColor);this.highlightPoint(touchX,touchY,tColor);}return true;},renderTooltip:function rndrttp(valIndex,touchX,touchY,tColor){var model=this.model;var barProps=this.config;var series=model.series[0],categories=model.categories.items,width=this.getWidth();var metrics=model.mtrcs;metrics=metrics.items;var ttp=this.toolTipMain;var line1=model.categories.tn+": "+categories[valIndex];if(isNaN(this.kpiOffset)){this.kpiOffset=0;}if(
/*this.widget.isKPI && */
this.widget.sparklineProps.mstrAssMetric){line2=this.widget.sparklineProps.mstrAssMetric+": "+series.v[valIndex];}else{line2=metrics[this.kpiOffset]+": "+series.v[valIndex];}var maxLength=this.widget.getTextWidthByCanvas(line1,ttp);var leng2=this.widget.getTextWidthByCanvas(line2,ttp);if(leng2>maxLength){maxLength=leng2;}var domHtml=line1+"<br/>"+line2;if(this.refv&&this.refv.length>1&&this.config.mbRefLine){domHtml+="<br/>";var line3=metrics[this.kpiOffset+1]+": "+this.refv[1].v;var leng3=this.widget.getTextWidthByCanvas(line3,ttp);if(leng3>maxLength){maxLength=leng3;}domHtml+=line3;}ttp.innerHTML='<div style="margin-left:5px;margin-bottom:4px;margin-top:5px;">'+domHtml+"</div>";var pos=mstrmojo.dom.position(this.domNode,true);var posWdt=mstrmojo.dom.position(this.widget.domNode,true);var oft={left:pos.x-posWdt.x,top:pos.y-posWdt.y};var maxWidth=maxLength+10;ttp.style.display="block";ttp.style.borderColor=tColor;ttp.style.width=maxWidth+"px";var topOff=(touchY+pos.y-posWdt.y-ttp.offsetHeight-29);if(topOff<0){topOff=0;}var leftOff=(oft.left+touchX+maxWidth+20);if(leftOff>this.widget.getWidth()){leftOff=(touchX+oft.left-maxWidth-20);if(leftOff<0){leftOff=0;}}else{leftOff-=maxWidth;}ttp.style.display="none";ttp.style.top=(topOff)+"px";ttp.style.left=(leftOff)+"px";ttp.style.display="block";},highlightPoint:function highlightPoint(touchX,touchY,tColor){var ctx=this.highlightContext,width=this.getWidth(),height=this.getHeight(),utils=this.utils;ctx.clearRect(0,0,width,height);ctx.globalAlpha=1;touchX=touchX>5?touchX:5;if(touchX>width-5){touchX=width-5;}touchY=touchY>5?touchY:5;if(touchY>height-5){touchY=height-5;}ctx.globalAlpha=0.8;ctx.strokeStyle="FFFFFF";ctx.fillStyle=ctx.strokeStyle;utils.drawArc(this,touchX,touchY,5,0,Math.PI*2,true,true,ctx);ctx.strokeStyle=tColor;ctx.fillStyle=ctx.strokeStyle;ctx.globalAlpha=1;utils.drawArc(this,touchX,touchY,5,0,Math.PI*2,true,false,ctx);utils.drawArc(this,touchX,touchY,2.5,0,Math.PI*2,true,true,ctx);this.highlightCanvas.id="highLightCav"+this.widget.domNode.id;},textLen:function txtLn(str){var len=0;for(var i=0;i<str.length;i++){if(str.charCodeAt(i)>255||str.charCodeAt(i<0)){len+=2;}else{len++;}}return len;},handleTouchMove:function(){},reDrawChart:function reDrwchart(){var context=this.context,canvas=this.canvas,wd=canvas.width,ht=canvas.height;context.clearRect(0,0,wd,ht);this.data.processLinearData(this);this.windowSize=this.model.series[0].rv.length;this.utils.fillBackground(this);if(this.windowSize<1){return ;}this.drawChart();},setColorByTheme:function setColorByTheme(){var barProps=this.config;if(this.theme==DEFAULT_DARK_THEME||this.theme==DEFAULT_LIGHT_THEME){this.posBarColor="#598200";this.negBarColor="#CC3A06";this.xAxisLineWidth=1;this.xAxisLineColor="#7F7F7F";this.refLineWidth=1;this.refLineColor="#00A6EF";}else{this.posBarColor=barProps.mwPosCol;this.negBarColor=barProps.mwNegCol;this.xAxisLineWidth=1;this.xAxisLineColor="#000000";this.refLineWidth=1;this.refLineColor=barProps.mwRefLineCol;}},drawChart:function drwchrt(){var model=this.model;var barProps=this.config;if(model.err){this.noDataToShowTtp=true;return ;}this.setColorByTheme();var context=this.context,values=model.series,height=this.getHeight(),width=this.getWidth(),me=this,utils=this.utils;var barOffset=0;var barPadLeft=this.margin.l;var barPadRight=this.margin.r;var min=0,max=0,minLabel=maxLabel="",series=model.series[0];for(var i=0;i<series.v.length;i++){var vl=parseFloat(series.rv[i]);if(i===0){max=min=vl;minLabel=maxLabel=series.v[i];}else{if(vl>max){max=vl;maxLabel=series.v[i];}else{if(vl<min){min=vl;minLabel=series.v[i];}}}}if(isNaN(min)&&isNaN(max)){this.minLabel.innerHTML="";this.maxLabel.innerHTML="";this.noDataToShowTtp=true;return ;}this.noDataToShowTtp=false;if(barProps.mbShowLegend){var fontSize=Math.ceil(Math.min(12,(height/2)*0.7));var mintxt="Min:"+minLabel.replace(/[ ]/g,"");var maxtxt="Max:"+maxLabel.replace(/[ ]/g,"");this.minLabel.innerHTML=mintxt;this.maxLabel.innerHTML=maxtxt;var maxBarOffset=width-10;if(maxBarOffset>width*0.5){maxBarOffset=Math.floor(width*0.5);}do{this.minLabel.style.fontSize=fontSize+"px";this.maxLabel.style.fontSize=fontSize+"px";var fontFamily="Arial";var minTxtLen=this.widget.getTextWidth(mintxt,"",fontFamily,fontSize,"px",this.isTextBold);var maxTxtLen=this.widget.getTextWidth(maxtxt,"",fontFamily,fontSize,"px",this.isTextBold);var txtLen=minTxtLen>maxTxtLen?minTxtLen:maxTxtLen;barOffset=txtLen+barPadLeft;fontSize-=1;}while(barOffset>maxBarOffset&&fontSize>5);fontSize+=1;}else{barOffset=barPadLeft;}this.labelLen=barOffset;if(this.refv&&this.refv.length>1&&barProps.mbRefLine){var refValue=this.refv[1].rv*1;if(refValue<min){min=refValue;}if(refValue>max){max=refValue;}}var ts=max-min;var baseY=0;var barPadTop=5;var barPadBottom=5;var rangeRatio=height-barPadTop-barPadBottom;if(ts==0){if(min==0){baseY=height/2;rangeRatio=0;}else{rangeRatio/=Math.abs(max);if(max<0){baseY=barPadTop;}else{baseY=height-barPadBottom;}}}else{if(max<0){baseY=barPadTop;rangeRatio/=Math.abs(min);}else{if(min<0){baseY=max/ts*rangeRatio+barPadTop;rangeRatio/=ts;}else{baseY=height-barPadBottom;rangeRatio/=max;}}}var barTotalWidth=width-barOffset-barPadRight;var barCount=series.v.length;var barSpaceWidth=barTotalWidth*0.4/barCount;barSpaceWidth=barSpaceWidth>=1?barSpaceWidth:1;var barWidth=barTotalWidth/barCount-barSpaceWidth;this.hightLightPos=[];for(var i=0;i<barCount;i++){this.hightLightPos[i]={};var vl=series.rv[i]*1;var direct=true;if(vl<0){vl=0-vl;direct=false;}var hgt=vl*rangeRatio;var cw=(width-barOffset)/series.v.length;this.drawBar(barOffset+(barWidth+barSpaceWidth)*i+barSpaceWidth/2,baseY,barWidth,hgt,context,series.thClr&&series.thClr[i],direct,this.hightLightPos[i]);}context.strokeStyle=this.xAxisLineColor;context.lineWidth=this.xAxisLineWidth;if(context.lineWidth%2===1){baseY=Math.round(baseY+0.5)-0.5;}context.beginPath();context.moveTo(barOffset,baseY);context.lineTo(width-barPadRight,baseY);context.stroke();if(this.refv&&this.refv.length>1&&barProps.mbRefLine){var refValue=this.refv[1].rv*1;var refH=baseY-refValue*rangeRatio;if(context.lineWidth%2===1){refH=Math.round(refH+0.5)-0.5;}context.beginPath();context.moveTo(barOffset,refH);context.lineTo(width-barPadRight,refH);context.strokeStyle=this.refLineColor;context.stroke();}},drawBar:function drwBr(x,y,width,height,context,color,direct,posStore){if(width>=3){x=Math.round(x);y=Math.round(y);width=Math.round(width);}if(height!=0){height=Math.round(height);if(height<1){height=1;}}if(direct){context.fillStyle=color?color:this.posBarColor;context.fillRect(x,y-height,width,height);posStore.x=x+Math.round(width/2);posStore.y=y-height;}else{context.fillStyle=color?color:this.negBarColor;context.fillRect(x,y,width,height);posStore.x=x+Math.round(width/2);posStore.y=y+height;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisChart","mstrmojo.locales");var K=20;var I=-20;var O=25;var E=mstrmojo.hash;var A=null;mstrmojo.VisChartLine=mstrmojo.declare(mstrmojo.VisChart,null,{scriptClass:"mstrmojo.VisChartLine",fillinColor:null,rotateXLabels:false,isFillLinesArea:null,isAnimateLines:true,isDrawStartEndPoints:0,startEndPointRadius:5,startPointColor:null,endPointColor:null,prevLines:null,chartLineColors:["#0099FF","#FFB03C","#F26AE1","#888BF4","#93CA20","#FE2F68"],maxXLabels:6,DSS_XML_BASE_FORM_DATE:"8",drawChart:function L(){var T=this.model;if(T.err){return ;}var S=this.animationContext,U=T.mvalues,R=T.series,V=this.margin,Q=[],P=[],W=this.getHeight(),X=this.getWidth(),g=this,e=this.utils;if(!R){return ;}var f=R.length;if(this.isDrawAxis&&this.drawYAxisLabels){V.l=e.getLabelWidthForMargin(this,T.mls);}g.RTY=(W-V.t-V.b-5)/(U[U.length-1]-U[0]);g.RTX=(X-V.l-V.r-1)/(g.windowSize-1);var b=(U[0]+U[U.length-1])/2;var d=e.getYValue(g,b);for(var Z=0;Z<f;Z++){Q=[];var Y=0;for(var a=0;a<g.windowSize;a++){var h=R[Z].rv[a];if(h.length===0){continue;}Q[Y]={x:(a*g.RTX)+V.l,y:e.getYValue(g,h)};if(!this.prevLines){P[Y]={x:Q[Y].x,y:d};}Y++;}this.drawChartLine(Q,P,f,Z,S);if(!this.multiLine){break;}}this.prevLines=Q;},drawChartLine:function C(Z,W,R,T,P,Q){var V=this,Y=V.getHeight(),X=V.utils;var U={rate:6};P.strokeStyle=X.getColor(V);P.lineCap="round";P.lineWidth=Q||2;P.lineJoin="round";if(V.isAnimateLines&&(!V.multiLine||R===1)){if(V.prevLines){W=V.prevLines;if(W.length<Z.length){for(var S=W.length;S<Z.length;S++){W.push(Z[W.length-1]);}}}X.animateLineSet(V,V.prevLines||W,Z,U);}else{if(V.multiLine&&R>1){P.strokeStyle=V.chartLineColors[T%6];}X.drawLineSet(V,Z,false,P);if(V.isFillLinesArea){X.fillLinesArea(V,Z.slice(0));}if(V.isDrawStartEndPoints){X.drawStartEndPoints(V,Z,P,V.isDrawStartEndPoints);}}},setMicroChartProperties:function F(){this.isDrawAxis=false;this.margin={t:0,r:5,b:0,l:5};this.showHighlightLine=false;this.isDrawStartEndPoints=3;},initFromVisProps:function J(P){if(!P){return ;}if(P.thc){this.themeColor="#"+P.thc;}if(P.shl==="0"){this.showHighlightLine=false;}if(P.mc==="1"){this.setMicroChartProperties();}},postCreate:function N(){if(this._super){this._super();}if(this.rotateXLabels){this.margin.b=75;}if(typeof (this.isFillLinesArea)==="undefined"&&!this.multiLine){this.isFillLinesArea=true;}},drawLabels:function D(e){if(!this.isDrawAxis){return ;}if(this._super){this._super();}if(!this.drawXAxisLabels){return ;}var w=this,V=w.model.categories,q=V.items,R=V.tp,p=w.utils,s=w.margin,g=q.length,d=null,Y=null,X=0,k=null,P=w.isTimeSeries,f=w.animationContext,Q=w.drawGridLines;var b=w.prevXLabel;b.x=0;b.y=0;b.w=0;f.save();f.globalAlpha=1;f.strokeStyle=p.rgb2rgbStr(w.formatProp.textClr,0.35);f.lineWidth=1;f.lineCap="round";var T=g>w.maxXLabels?w.maxXLabels:g;var o=null;if(P){o=document.createElement("div");w.xdiv=o;T*=(w.totalChartWidth/(w.chartWidth));}if(w.rotateXLabels){X=w.canvas.height+I;}else{if(P){X=w.canvas.height-this.margin.b+5;}else{X=w.canvas.height-O;}}var a=Math.round(g/T);if(a===0){a=1;}var U=Math.round(a*w.RTX)-w.xLabelPadding;A=null;var S={mn:0,dt:0,yr:0};if(P){var t=-1;this.needRedrawVerticalLine=false;for(var h=w.ACrns;h<w.ACrne;h+=a){Y=((h-w.ACrns)*w.RTX);var j=q[h];if(t<0&&h>=w.model.rns){t=0;}if(P&&(R.toString()===w.DSS_XML_BASE_FORM_DATE)){if(t==0){A=null;t=1;}j=w.getFormattedDateLabel(j,S);}if(w.rotatXLabels){k=p.addLabel(w,j,Y-K,X,null,true,b);}else{k=p.addLabel(w,j,Y,X,null,false,b);}if(k){if(Q&w.drawVerticalGridLines){A=E.clone(S);if(!e){var Z=Math.floor(Y)+0.5;p.drawLineSet(w,[{x:Z,y:w.canvas.height-s.b},{x:Z,y:s.t}],false,f);}}}}}else{for(var h=0;h<g;h+=a){Y=(h*w.RTX)+s.l;var j=q[h];if(P&&(R.toString()===w.DSS_XML_BASE_FORM_DATE)){j=w.getFormattedDateLabel(j,S);}if(w.rotateXLabels){k=p.addLabel(w,j,Y-K,X,null,true,b);}else{k=p.addLabel(w,j,Y,X,U,false,b);}if(k){if(Q&w.drawVerticalGridLines){A=E.clone(S);p.drawLineSet(w,[{x:Y,y:w.canvas.height-s.b},{x:Y,y:s.t}],false,f);}}}}if(o){if(this.isTimeSeries){w.xLabelsDiv.innerHTML=o.innerHTML;w.xdiv=null;}else{var W=w.animationCanvas;w.itemsContainerNode.innerHTML=o.innerHTML;w.itemsContainerNode.insertBefore(W,w.itemsContainerNode.firstChild);w.xdiv=null;}}f.restore();},getFormattedDateLabel:function M(V,R){if(isNaN(V)){return V;}var S=V;try{V=this.utils.convertRawValueToMilliseconds(V);var Q=new Date(Number(V));var U=R.mn=mstrmojo.locales.datetime.MONTHNAME_SHORT[Q.getMonth()];var P=R.yr=Q.getFullYear().toString().substring(2);R.dt=Q.getDate();if(!A||(U!==A.mn&&P!==A.yr)){S=U+" "+R.dt+" "+P;}else{if(U!==A.mn){S=U+" "+R.dt;}else{S=R.dt;}}}catch(T){}return S;},removeLabels:function G(){var P=this.domNode.getElementsByClassName("mstrmojo-Chart-lbl");for(var Q=P.length-1;P&&Q>=0;Q--){P[Q].parentElement.removeChild(P[Q]);}},highlightPoint:function H(a,d){var Y=this,f=Y.highlightContext,e=Y.getHeight(),S=Y.margin,X=Y.model,b=Y.utils,V=Y.seriesIndex;var R=(a*Y.RTX)+S.l;if(this.prevHighlight>=0){var W=(this.prevHighlight*Y.RTX)+S.l;var P=10;var T=8;var Z=S.t-T>0?S.t-T:0;f.clearRect(W-P,Z,W+P,e-S.b);}if(a<0){return ;}var R=(a*Y.RTX)+S.l;f.shadowBlur=5;f.shadowColor="#000";f.globalAlpha=1;if(Y.showHighlightLine){f.strokeStyle=this.highlightColor;f.fillStyle=this.highlightColor;f.lineWidth=2;f.lineCap="round";b.drawLineSet(Y,[{x:R,y:S.t},{x:R,y:e-S.b}],false,f);}else{f.strokeStyle=b.getColor(Y);f.fillStyle=f.strokeStyle;}var g=X.series,Q=g.length,Z=b.getYValue(Y,g[V].rv[a]);if(!Y.multiLine){b.drawArc(Y,R,Z,5,0,Math.PI*2,true,true,f);}else{if(Y.showHighlightLine){if(Q>1){f.strokeStyle=this.chartLineColors[0];f.fillStyle=f.strokeStyle;}for(var U=0;U<Q;U++){f.strokeStyle=this.chartLineColors[U%6];if(U>0){f.fillStyle=f.strokeStyle;}Z=b.getYValue(Y,g[U].rv[a]);b.drawArc(Y,R,Z,5,0,Math.PI*2,true,true,f);}}else{if(Q>1){f.strokeStyle=this.chartLineColors[V];f.fillStyle=f.strokeStyle;}b.drawArc(Y,R,b.getYValue(Y,g[V].rv[a]),5,0,Math.PI*2,true,true,f);}}},refreshChart:function B(){var P=this.getHeight(),Q=this.getWidth();this.highlightContext.clearRect(0,0,Q,P);this.animationContext.clearRect(0,0,Q,P);this.removeLabels();this.drawChart();this.drawLabels();}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisChartLine","mstrmojo.EnumRWUnitType","mstrmojo.VisTooltip","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.TouchScroller","mstrmojo._HasTouchScroller","mstrmojo.css","mstrmojo.color","mstrmojo.VisTimeSeriesLegend","mstrmojo.VisTimeSeriesTimeSelector");mstrmojo.requiresDescs(5674,8475,8626);var $CSS=mstrmojo.css,$CLR=mstrmojo.color;var DRILLING_ACTION=1,SELECTOR_ACTION=2,HYPERLINK_ACTION=4;var ROW_AXIS=1,COL_AXIS=2;var chartStatus={},widgetCount=0,tooltipShown=false,itemClicked=false,isDataSetChanged=false,chartSizeChanged=false,originalTouchPosition=0,masterSliderClicked=null,rangeToSeriesMaxRatio=5;var MCHW=20;var MCHH=20;var MAXPOINTS_PER_DRAW=80;var SWidthChanged=false;var masterMargin={t:5,r:MCHW/2,b:5,l:MCHW/2};var PADDING=10,TOP_PADDING=8;var canvasReseted=false;var $_DT=mstrmojo.locales.datetime;function resetLocalVars(){tooltipShown=false;itemClicked=false;isDataSetChanged=false;chartSizeChanged=false;originalTouchPosition=0;masterSliderClicked=null;}function getParentBkgColor(){var parentNode=this.domNode.parentNode;while(parentNode){var compStyle=mstrmojo.css.getComputedStyle(parentNode);var bkgColor=compStyle.backgroundColor;if(bkgColor){if(bkgColor.indexOf("rgba")>=0){var rgba=this.utils.rgbaStr2rgba(bkgColor);if(rgba&&rgba[4]){return rgba;}}else{if(bkgColor.indexOf("rgb")>=0){var rgb=$CLR.rgbStr2rgb(bkgColor);return rgb;}}}parentNode=parentNode.parentNode;}return[255,255,255];}var LIGHT_THEME=0;var DARK_THEME=1;function getUITheme(){var utils=this.utils;var rgb=getParentBkgColor.call(this);var opacity=this.formatProp.backgroundAlpha;rgb=utils.getRGBWithOpacity(rgb,opacity,this.formatProp.backgroundClr);var brightness=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1000;if(brightness>150){this.theme=LIGHT_THEME;}else{this.theme=DARK_THEME;}}function addChartStatus(id){chartStatus[id]={isLegendBarOpen:false,legendBarWidth:30,isLegendSelected:false,legendSelectedIndex:-1,timeSelectedIntervalPosition:{},currSelectionIdx:-1,usingCustomInterval:false};}function isScrollableElementTouched(touch){var me=this,m=me.margin,chartWidth=me.getChartWidthOnScreen();var touchPointOnWidget=me.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,me);var x=touchPointOnWidget.touchX,y=touchPointOnWidget.touchY;if(x<m.l||x>(chartWidth+m.l)||y<m.t||y>this.canvas.height-m.b){return false;}return true;}function isTouchedOnWidget(touch){if(!touch){return false;}var me=this;var touchPointOnWidget=me.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,me);var x=touchPointOnWidget.touchX,y=touchPointOnWidget.touchY;if((x>0&&x<me.getWidth())&&(y>0&&y<me.getHeight())){return true;}return false;}function getTouchedElement(touch){var item=mstrmojo.dom.findAncestorByAttr(touch.target,"clk",true,this.domNode);return item||null;}function getMinYPosition(lines){var l=lines.length;var i=0,min;while(i<l){if(lines[i]){min=lines[i].y;break;}i++;}for(i=0;i<l;i++){if(lines[i]){min=Math.min(min,lines[i].y);}}return min;}function resetBaseAndDerivedData(tsl){var obm=this.baseModel;var currStatus=chartStatus[this.chartID];this.baseModel=this.getModel(tsl.ds)||this.baseModel;var bm=this.baseModel;this.checkData(bm);var err=bm.err||bm.eg;if(err){this.renderErrorMessage(err);return false;}var bms=bm.series,m=this.model,cs=m.series,sl=bms.length,s=[],j=0;for(j=0;j<sl;j++){s[j]=bms[j];}this.model.categories=bm.categories;this.model.series=s;this.model.colHeaders=bm.colHeaders;var currWindowSize=this.model.series[0].rv.length;if(this.windowSize!==currWindowSize){currStatus.rns=0;currStatus.rne=currWindowSize;}this.windowSize=currWindowSize;if(!bm.vp||!bm.vp.rl||bm.vp.rl.length<obm.vp.rl.length){bm.vp=obm.vp;}isDataSetChanged=true;return true;}function localUpdateScrollerConfig(){var scl=this._scroller,m=this.model,margin=this.margin,currStatus=chartStatus[this.chartID],animationCanvas=this.animationCanvas,chartWidth=this.getChartWidthOnScreen(),offsetEnd=Math.max(this.acContentWidth-chartWidth,0);var rns=(currStatus.rns!==0&&currStatus.rns+1===currStatus.rne)?currStatus.rns-1:currStatus.rns;scl.origin={x:parseInt(((rns-this.ACrns)*this.RTX),10),y:0};scl.hScroll=(offsetEnd!==0&&scl.noHScroll!==true)||this.scrollPast;if(scl.hScroll){scl.offset={x:{start:0,end:offsetEnd},scrollPast:this.scrollPast};}this.utils.translateCSS(-(scl.origin.x),scl.origin.y,false,this.animationCanvasDiv);this.utils.translateCSS(-(scl.origin.x)+this.maxYLblWidth,scl.origin.y,false,this.xLabelsDiv);}function getCurrencySymbolForMetric(m){var s=m.series,ch=m.colHeaders,chl=ch[0].items.length;var hi0=s[0].hi,fInfo=ch[ch.length-1].items[hi0[hi0.length-1]],f=fInfo.f;var cs=(fInfo&&f&&f.indexOf(fInfo.cs)>=0)?","+fInfo.cs:"";if(cs===""&&f){cs=f.indexOf("%")>=0?",%":"";}if(cs===""&&f){var q=null;if(f.indexOf("'")>=0){q="'";}else{if(f.indexOf('"')>=0){q='"';}}if(q){var temp=f.substring(f.indexOf(q)+1);cs=","+temp.substring(0,temp.indexOf(q));}}return cs;}function hideMasterSliderTooltip(){var ms=this.masterSlider,stt=this.sliderTooltip,sttF=stt.firstChild,sttP=stt.lastChild,fc=ms.firstChild,lc=ms.lastChild;$CSS.removeClass(fc,"mstrmojo-timeseries-span-shadow");$CSS.removeClass(lc,"mstrmojo-timeseries-span-shadow");sttF.innerHTML="";sttF.style.display="none";sttP.style.display="none";}function resizeMasterSliderDone(){var me=this,currStatus=chartStatus[this.chartID];if(currStatus.usingCustomInterval&&me.currSelection){me._timeSelector.toggleSelected(me.currSelection,false);me._timeSelector.toggleGlowEffect(me.currSelection,false);this.updateIntervalPosition();me.currSelection=null;currStatus.currSelectionIdx=-1;}if(chartSizeChanged&&masterSliderClicked!=="MS"){me.showMessage();this.makeSureMasterSliderNotBeyondTheMargin();this.makeSureSliderOnPoint();this.makeSureSelectedIntervalMoreThanTwo();this.makeSureMasterSliderNoOverlap();this.setMasterSliderLayout();window.setTimeout(function(){me.reDrawSlaveChart();},10);}else{masterSliderClicked=null;}hideMasterSliderTooltip.call(this);}function getFormattedDateForSliderTooltip(sliderTooltipXPosition){var me=this,cat=me.model.categories,tp=cat.tp;var pos=Math.round((sliderTooltipXPosition-masterMargin.l)/me.MRTX),rVal=cat.items[pos];if(tp.toString()===me.DSS_XML_BASE_FORM_DATE){rVal=me.getFormattedDateForTooltip(rVal,true);}return rVal;}function getPointDistanceSquare(p1,p2){return(p1.x-p2.x)*(p1.x-p2.x)+(p1.y-p2.y)*(p1.y-p2.y);}function getACRnsRne(rns,rne){var me=this,currStatus=chartStatus[me.chartID],model=me.model,windowSize=me.windowSize,needRedraw=true,ACrns,ACrne;if((!rns&&rns!==0)||!rne){rns=currStatus.rns;rne=currStatus.rne;}var diff=rne-rns;model.currentRatio=Math.round(windowSize/((diff-1)||1));if(model.currentRatio>rangeToSeriesMaxRatio){var ACRation=(rangeToSeriesMaxRatio-1)/2;ACrns=Math.max(0,rns-ACRation*(diff-1));ACrne=Math.min(windowSize,rne+ACRation*(diff-1));if(ACrns===0){ACrne=rangeToSeriesMaxRatio*(diff-1)+1;}else{if(ACrne===windowSize){ACrns=ACrne-rangeToSeriesMaxRatio*(diff-1)-1;}}}else{ACrns=0;ACrne=windowSize;var ACdiff=ACrne-ACrns;}if(me.ACrns===ACrns&&me.ACrne===ACrne){needRedraw=false;}else{me.ACrns=ACrns;me.ACrne=ACrne;}return needRedraw;}function removeChildren(container){var count=container&&container.childNodes&&container.childNodes.length,i;for(i=0;i<count;++i){container.removeChild(container.firstChild);}}function removeLegendAndTimeSelectorChildren(){if(this._legend){this._legend.destroy();}if(this._timeSelector){this._timeSelector.destroy();}}mstrmojo.VisTimeSeries=mstrmojo.declare(mstrmojo.VisChartLine,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisTimeSeries",isLinearChart:true,highlightColor:"#ffffff",chartLineColors:["#16b0ff","#ff3729","#04ba22","#ff960e","#ae79de","#cccd25","#19cee0","#a9a9a9","#b3cdef","#ffa796","#98df8a","#ffbf80","#dac3ec","#dac3ec","#a1dfea","#d6d6d6"],switchSeriesOnTouch:false,multiTouch:true,margin:{t:70,r:1,b:50,l:5},SLXP:0,SRXP:0,isTimeSeries:true,maxXLabels:4,scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:true},scrollPast:true,isAndroidTab:false,masterContext:null,selectionOrLinkdrillOnRow:false,lastSelectedPoint:null,markupString:'<div id="{@id}" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};left:{@left};top:{@top};z-index:{@zIndex};position:absolute;-webkit-transition: 0ms; transition: 0ms; -webkit-transform: translate3d(0px, 0px, 0px);"  mstrAttach:mousedown,mouseup,mousemove,click ><canvas width="{@width}" height="{@slaveChartHeight}"></canvas><div style="overflow:hidden;position:absolute;left:0px;top:0px;"><div id="{@id}-animation-canvas-div" class="mstrmojo-timeseries-animation-canvas" style="position:absolute;left:0px;top:0px;width:{@width};height:{@slaveChartHeight+"px"};"><canvas style="position:absolute;left:0px;top:0px;" width="{@width}" height="{@slaveChartHeight}"></canvas></div></div><div style="overflow:hidden;position:absolute;left:0px;top:0px;"><div id="{@id}-x-labels-div" class="mstrmojo-timeseries-animation-canvas" style="position:absolute;left:0px;top:0px;width:{@width};height={@slaveChartHeight+"px"}"></div></div><canvas id="{@id}-highlight-canvas" style="position:absolute;left:0px;top:0px;" width="{@width}" height="{@slaveChartHeight}"></canvas><div id="{@id}-tooltip"></div><div id="{@id}-time-selector-div"></div><div id="{@id}-legend-bar-div" ></div><div id="{@id}-loading-msg" class="mstrmojo-loading-msg" style="display:none"></div><canvas id="{@id}-master-canvas" style=" position:absolute;left:0px;bottom:0px;" width="{@width}" height="{@masterChartHeight}"></canvas><div id="{@id}-master-div" class="mstrmojo-master-parent-div" width="{@width}" style="position:absolute;bottom:5px" ><div id="{@id}-master-cover-span" style="position:absolute;left:0px;" class="mstrmojo-master-cover-span"></div><div id="{@id}-master-slider" class="mstrmojo-master-slider-div" clk="MS"><canvas id="{@id}-master-img-L" width="20" height="20" style="position:absolute;left:0px" class="mstrmojo-timeseries-master-span" clk="L" ></canvas><canvas id="{@id}-master-slider" width="{@width}" height="{@masterChartHeight}" style="top:0px;left:0px" class="mstrmojo-master-slider-div-top"></canvas><canvas id="{@id}-master-img-R" width="20" height="20" style="position:absolute;right:0px" class="mstrmojo-timeseries-master-span" clk="R" ></canvas></div><div id="{@id}-master-cover-span" style="position:absolute;right:0px;" class="mstrmojo-master-cover-span"></div></div><div id="{@id}-slider-tooltip" style="position:absolute;left:0;top:0;z-index:150;width:{@width};"><div class="timeseries-slider-tooltip"></div><canvas style="position:absolute;left:0px;top:20px;display: none;" width="6px" height="5px"></canvas></div><div id="{@id}-legend-tooltip" class="mstrmojo-Chart-tooltip timeseries-legend-tooltip"></div><span id="textSpan" style="z-index:-10;visibility:hidden;"></span><div id="{@id}-infowindow-anchor" style="position:absolute;width:18px;height:18px;display:block"></div><div id="{@id}-errMsg" class="mstrmojo-message" style="width:{@width};height:{@height};top:0px;left:0px;position:absolute;display:none; z-index:20;"></div></div>',markupSlots:{canvas:function(){return this.domNode.firstChild;},animationCanvasDiv:function(){return this.domNode.childNodes[1].firstChild;},animationCanvas:function(){return this.domNode.childNodes[1].firstChild.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},xLabelsDiv:function(){return this.domNode.childNodes[2].firstChild;},xLabelsDivContainer:function(){return this.domNode.childNodes[2];},highlightCanvas:function(){return this.domNode.childNodes[3];},tooltip:function(){return this.domNode.childNodes[4];},timeSelectorDiv:function(){return this.domNode.childNodes[5];},legendBarDiv:function(){return this.domNode.childNodes[6];},loadingMsg:function(){return this.domNode.childNodes[7];},masterCanvas:function(){return this.domNode.childNodes[8];},masterSlider:function(){return this.domNode.childNodes[9].childNodes[1];},sliderTooltip:function(){return this.domNode.childNodes[10];},legendTooltip:function(){return this.domNode.childNodes[11];},textSpan:function(){return this.domNode.childNodes[12];},infoWindowAnchor:function(){return this.domNode.childNodes[13];},errorMsg:function(){return this.domNode.childNodes[14];}},getTextWidth:function gtw(str,fontStyle,zf){this.textSpan.style.font=fontStyle;this.textSpan.innerHTML=str;if(zf){this.utils.changeElementSize(this.textSpan,"font",zf);}var ret=this.textSpan.offsetWidth;return ret;},getTextWidthByElem:function gtwCvs(text,elem){var computedStyle=mstrmojo.css.getComputedStyle(elem);var fontStyle=computedStyle.fontStyle+" "+computedStyle.fontWeight+" "+computedStyle.fontSize+"/"+computedStyle.fontVariant+" "+computedStyle.fontFamily;return this.getTextWidth(text,fontStyle);},getTextHeight:function gtw(str,fontStyle,zf){this.textSpan.style.font=fontStyle;this.textSpan.innerHTML=str;if(zf){this.utils.changeElementSize(this.textSpan,"font",zf);}var ret=this.textSpan.offsetHeight;return ret;},getMaxTextWidth:function(textArray,fontStyle){var me=this,l=textArray.length,maxWidth=0,currWidth=0,i;for(i=1;i<l;i++){currWidth=me.getTextWidth(textArray[i],fontStyle);maxWidth=currWidth>maxWidth?currWidth:maxWidth;}return maxWidth;},getChartWidthOnScreen:function getChartWidthOnScreen(){var m=this.margin;return this.getWidth()-m.r-m.l-chartStatus[this.chartID].legendBarWidth;},drawChartXYAxis:function drawChartXYAxis(){var utils=this.utils,m=this.margin,w=this.getWidth()-chartStatus[this.chartID].legendBarWidth,h=this.canvas.height,c=this.context;c.save();c.strokeStyle=utils.rgb2rgbStr(this.formatProp.textClr);c.lineWidth=1;c.globalAlpha=0.8;var xPos=Math.floor(m.l)-0.5;utils.drawLineSet(this,[{x:xPos,y:m.t},{x:xPos,y:h-m.b}],false,c);var yPos=Math.floor(h-m.b)+0.5;utils.drawLineSet(this,[{x:m.l-this.maxYLblWidth,y:yPos},{x:w-m.r,y:yPos}],false,c);c.restore();},setMasterSlider:function setMasterSlider(){var width=this.getWidth(),h=this.masterCanvas.height-masterMargin.t-masterMargin.b,utils=this.utils,msl=this.masterSlider,msStyle=msl.style,mslp=msl.parentNode,lcStyle=mslp.firstChild.style,rcStyle=mslp.childNodes[2].style,m=this.model,mrtx=this.MRTX,currStatus=chartStatus[this.chartID];mslp.style.display="block";mslp.style.height=h+"px";mslp.style.width=width+"px";msStyle.height=h+"px";lcStyle.height=h-2+"px";rcStyle.height=h-2+"px";lcStyle.backgroundColor=rcStyle.backgroundColor=utils.rgb2rgbStr(this.formatProp.backgroundClr,this.formatProp.backgroundAlpha*0.5);this.drawMasterChartHandler(msl.firstChild,MCHW,MCHH,true);this.drawMasterChartHandler(msl.lastChild,MCHW,MCHH,false);msl.firstChild.style.marginTop=msl.lastChild.style.marginTop=Math.round((h-MCHH)/2)+"px";this.calculateSXP(currStatus.rns,currStatus.rne,true);this.makeSureMasterSliderNotBeyondTheMargin();this.makeSureMasterSliderNoOverlap();this.setMasterSliderLayout();},drawMasterChartHandler:function drwMCH(canvas,w,h,isLeft){var utils=this.utils,ctx=canvas.getContext("2d");canvas.width=w;canvas.height=h;ctx.save();ctx.fillStyle=utils.rgb2rgbStr(this.formatProp.backgroundClr,0.76);utils.drawRoundRect(ctx,0.5,0.5,w-1,h-1,1,true);ctx.strokeStyle=utils.rgb2rgbStr(this.formatProp.textClr);ctx.lineWidth=1;utils.drawRoundRect(ctx,0.5,0.5,w-1,h-1,1);ctx.beginPath();ctx.lineWidth=2;if(isLeft){ctx.moveTo(11,6);ctx.lineTo(7,10);ctx.lineTo(11,14);}else{ctx.moveTo(9,6);ctx.lineTo(13,10);ctx.lineTo(9,14);}ctx.stroke();ctx.restore();},drawMasterChartDiv:function drwMCD(x,w){var canvas=this.masterSlider.childNodes[1],width=this.SRXP-this.SLXP+MCHW;if(canvas.width==width){}else{var margin=masterMargin,mcHeight=this.masterChartHeight,divHeight=mcHeight-margin.t-margin.b,h=(divHeight-MCHH)/2;canvas.height=divHeight;canvas.width=width;var ctx=canvas.getContext("2d");ctx.save();ctx.strokeStyle=this.utils.rgb2rgbStr(this.formatProp.textClr);ctx.lineWidth=1;ctx.beginPath();var leftX=0.5+MCHW/2;var rightX=width-0.5-MCHW/2;ctx.moveTo(leftX,h);ctx.lineTo(leftX,0);ctx.lineTo(rightX,0);ctx.lineTo(rightX,h);ctx.moveTo(leftX,h+MCHH);ctx.lineTo(leftX,divHeight);ctx.lineTo(rightX,divHeight);ctx.lineTo(rightX,h+MCHH);ctx.stroke();ctx.restore();}},setMasterSliderLayout:function setMasterSliderLayout(){var width=this.getWidth(),utils=this.utils,msl=this.masterSlider,msStyle=msl.style,mslp=msl.parentNode,lcStyle=mslp.firstChild.style,rcStyle=mslp.childNodes[2].style;lcStyle.width=(this.SLXP)+"px";rcStyle.width=(width-this.SRXP)+"px";var slWidth=(this.SRXP-this.SLXP);msStyle.width=(slWidth+MCHW)+"px";utils.translateCSS(this.SLXP-MCHW/2,0,false,msl);this.drawMasterChartDiv();},makeSureMasterSliderNoOverlap:function makeSureMasterSliderNoOverlap(fixWhich){var slWidth=this.SRXP-this.SLXP;if(slWidth<MCHW){slWidth=MCHW;var width=this.getWidth();if(!fixWhich){fixWhich=this.SRXP+MCHW/2===width-1?"R":"L";}if(fixWhich=="L"){this.SRXP=this.SLXP+MCHW;}else{this.SLXP=this.SRXP-MCHW;}}},calculateSXP:function calculateSXP(rns,rne,intervalChanged){if(intervalChanged){this.SLXP=Math.round((this.MRTX*rns)+masterMargin.l);this.SRXP=Math.round((this.MRTX*(rne-1))+masterMargin.l);}else{var width=this.SRXP-this.SLXP;this.SLXP=Math.round((this.MRTX*rns)+masterMargin.l);this.SRXP=this.SLXP+width;}},makeSureMasterSliderNotBeyondTheMargin:function makeSureMasterSliderNotBeyondTheMargin(keepWidth){var SWidth=this.SRXP-this.SLXP;var width=this.getWidth();if(this.SLXP<masterMargin.l){this.SLXP=masterMargin.l;if(keepWidth){this.SRXP=this.SLXP+SWidth;}}if(this.SRXP>width-masterMargin.r-1){this.SRXP=width-masterMargin.r-1;if(keepWidth){this.SLXP=this.SRXP-SWidth;}}},makeSureSelectedIntervalMoreThanTwo:function makeSureSelectedIntervalMoreThanTwo(){var mrtx=this.MRTX,width=this.getWidth();if(this.SRXP-this.SLXP<mrtx){if(masterSliderClicked){if(masterSliderClicked==="L"){this.SLXP=this.SRXP-mrtx;}else{this.SRXP=this.SLXP+mrtx;}}else{if(this.SLXP+mrtx<=width-masterMargin.r){this.SRXP=this.SLXP+mrtx;}else{this.SLXP=this.SRXP-mrtx;}}}},makeSureSXPNotEqual:function makeSureSXPNotEqual(){var mrtx=this.MRTX,width=this.getWidth();if(this.SLXP===this.SRXP){if(masterSliderClicked){if(masterSliderClicked==="L"){this.SLXP-=mrtx;}else{this.SRXP+=mrtx;}}else{if(this.SRXP+mrtx<=width-masterMargin.r){this.SRXP+=mrtx;}else{this.SLXP-=mrtx;}}}},makeSureSliderOnPoint:function makeSureSliderOnPoint(){var mrtx=this.MRTX,diff=0,currStatus=chartStatus[this.chartID];if(masterSliderClicked){diff=Math.round((this.SRXP-this.SLXP)/mrtx);if(masterSliderClicked==="L"){this.SLXP=this.SRXP-diff*mrtx;}else{if(masterSliderClicked==="R"){this.SRXP=this.SLXP+diff*mrtx;}else{this.calculateSXP(currStatus.rns,currStatus.rne,true);}}}},initScroller:function initScroller(scroller){if(!scroller.offset&&this.scrollPast){scroller.offset={scrollPast:this.scrollPast};}this._super(scroller);var me=this;this._scrollDoneListener=this._scroller.attachEventListener("scrollDone",me.id,function(evt){var m=me.model,currStatus=chartStatus[me.chartID],r=currStatus.rne-currStatus.rns,rns=me.ACrns+parseInt(Math.round(me._scroller.origin.x/me.RTX),10);if(r===1){rns++;}var rne=rns+r;if(rns<0){currStatus.rns=0;currStatus.rne=currStatus.rns+r;}else{if(rne>m.series[0].rv.length){currStatus.rne=m.series[0].rv.length;currStatus.rns=currStatus.rne-r;}else{currStatus.rns=rns;currStatus.rne=rne;}}me.updateRnsRne();SWidthChanged=false;me.incFetchChart();});this._scrollMovedListener=this._scroller.attachEventListener("scrollMoved",me.id,function(evt){if(tooltipShown){me.hiddenTooltipAndShowTimeSelector();}var m=me.model,currStatus=chartStatus[me.chartID],sl=m.series[0].rv.length,r=currStatus.rne-currStatus.rns,rns=me.ACrns+Math.round(evt.x/me.RTX),rne=Math.min(rns+r,sl);if(rns<0){rns=0;}if(rne-rns!=r){SWidthChanged=true;}me.utils.translateCSS(-evt.x+me.maxYLblWidth,-evt.y,false,me.xLabelsDiv);me.calculateSXP(rns,rne,SWidthChanged);me.makeSureSXPNotEqual();me.makeSureMasterSliderNoOverlap();me.setMasterSliderLayout();});},initFromVisProps:function(vp){var propValue=vp?vp:{};this.formatProp={};this.formatProp.backgroundClr=propValue.fbg?$CLR.hex2rgb(propValue.fbg):[0,0,0];this.formatProp.textClr=propValue.flt?$CLR.hex2rgb(propValue.flt):[255,255,255];this.formatProp.tooltipClr=propValue.ftt?$CLR.hex2rgb(propValue.ftt):[255,255,255];this.formatProp.backgroundAlpha=propValue.fbt!=undefined?(1-parseInt(propValue.fbt)/100):1;var getBool=function(v){if(v==true||v=="1"||v==1||v=="true"){return true;}return false;};this.formatProp.useCustomAxisScale=propValue.fcas?getBool(propValue.fcas):false;var numCheck=function(num){if(num>Number.MAX_VALUE){num=Number.MAX_VALUE;}if(num<-1*Number.MAX_VALUE){num=-1*Number.MAX_VALUE;}return num;};this.formatProp.minValue=propValue.fmiav?numCheck(parseFloat(propValue.fmiav)):"";this.formatProp.maxValue=propValue.fmaav?numCheck(parseFloat(propValue.fmaav)):"";this.formatProp.condenseLabels=propValue.fcl?getBool(propValue.fcl):true;this.chartLineColors=["#16b0ff","#ff3729","#04ba22","#ff960e","#ae79de","#cccd25","#19cee0","#a9a9a9","#b3cdef","#ffa796","#98df8a","#ffbf80","#dac3ec","#dac3ec","#a1dfea","#d6d6d6"];for(var i=0;i<this.chartLineColors.length;i++){var propName=""+Math.floor(i/4)+i%4;propName="fs"+propName;var color=propValue[propName];if(color){this.chartLineColors[i]="#"+color;}}this.glowColor=this.utils.rgb2rgbStr(this.formatProp.tooltipClr);},getMaxValue:function getMaxV(){if(typeof this.formatProp.maxValue=="number"){return this.formatProp.maxValue;}else{return this._super();}},getMinValue:function getMinV(){if(typeof this.formatProp.minValue=="number"){return this.formatProp.minValue;}else{return this._super();}},preBuildRendering:function preBR(){if(this._super){this._super();}this.masterChartHeight=90;this.slaveChartHeight=this.getHeight()-this.masterChartHeight;},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res=eval(s);return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},postBuildRendering:function postBR(){var model=this.model;this.checkData(model);var err=model.err||model.eg;var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel);if(err){if(docModel&&docModel.prompts){this.model.docModel=docModel;}this.renderErrorMessage(err);return ;}else{this.errorMsg.style.display="none";}resetLocalVars();getUITheme.call(this);this.updateSelectionLinkdrillInfo(model);if(this.baseModel&&!model.vp){this.model=this.baseModel;}this.chartID=this.getChartID(docModel);if(!chartStatus[this.chartID]){addChartStatus(this.chartID);}this.scrollerConfig.scrollEl=this.animationCanvasDiv;this.isAndroidTab=!!mstrApp.isTablet();this.masterContext=this.masterCanvas.getContext("2d");this.renderVisTooltip();this.setMarginTopByTooltipHeight();this.renderLegend();if(this._super){this._super();}this.renderTimeSelector();this.setAnimationCanvasContainer();localUpdateScrollerConfig.call(this);if(docModel&&docModel.prompts){this.model.docModel=docModel;}this.drawSliderTooltipPointer();var me=this;if(docModel){this._infoWClosedListener=this.xtabModel.docModel.attachEventListener("infoWindowClosed",this.id,function(evt){var infoWindowK=evt.psKey;if(!me.hasNonifwTarget&&me.selectorTargets&&me.selectorTargets[infoWindowK]){me.lastSelectedPoint=null;me.incFetchChart(true);return ;}});}this.fullScreenListener=mstrmojo.touchManager.attachEventListener("fullScreenStateChange",this.id,function(evt){this.adjustWidgetOffsets();});this.renderLegendTooltip();},ongridDataChange:function onGridDataChange(evt){this.model=this.gridData;},getChartID:function getChartID(docModel){var chartID="";var layoutModel=docModel?docModel:(this.layoutModel?this.layoutModel:(this.model.layoutModel?this.model.layoutModel:null));if(layoutModel){chartID=layoutModel.oid+"_"+layoutModel.currlayKey+"_"+this.model.k;}else{if(this.model.mid){chartID=this.model.mid;}else{chartID=widgetCount++;}}return chartID;},checkData:function checkData(model){var colHeaders=model.colHeaders,categories=model.categories;if(!colHeaders||(colHeaders&&colHeaders.length<1)){this.model.err=mstrmojo.desc(8626,"The Time Series widget requires at least one attribute on the row axis and at least one metric on the column axis; optionally, one attribute can be placed above the metrics.");}if(colHeaders&&colHeaders.length>=1&&!this.isMetric(colHeaders[colHeaders.length-1].items)){this.model.err=mstrmojo.desc(8626,"The Time Series widget requires at least one attribute on the row axis and at least one metric on the column axis; optionally, one attribute can be placed above the metrics.");}if((categories&&(!categories.items||categories.items.length<2))){this.model.err=mstrmojo.desc(8475,"There is not enough data to plot the graph.");}},renderErrorMessage:function renderErrorMessage(msg){this.errorMsg.innerHTML=msg;this.errorMsg.style.display="block";},isMetric:function isMetric(items){if(items&&items.length>0&&items[0].cs!=null){return true;}return false;},updateSelectionLinkdrillInfo:function uscld(model){var rowHeaders=model.rowHeaders,rowHL=rowHeaders.length;for(var i=0;i<rowHL;i++){var rowH=rowHeaders[i];if(rowH.sc&&rowH.sc.tks){this.selectionOrLinkdrillOnRow=true;return ;}if(rowH.lm&&rowH.lm[0]&&rowH.lm[0].links){this.selectionOrLinkdrillOnRow=true;return ;}}},hasPageBy:function hasPageBy(){if(this.baseModel&&this.baseModel.phs&&this.baseModel.phs.show){return true;}return false;},setlegendStatus:function setlegendStatus(ilo,lbw){chartStatus[this.chartID].legendBarWidth=lbw;chartStatus[this.chartID].isLegendBarOpen=ilo;},setLegendSelected:function setLegendSelected(ils,lsi){chartStatus[this.chartID].isLegendSelected=ils;chartStatus[this.chartID].legendSelectedIndex=lsi;},getLegendBarDiv:function getLegendBarDiv(){return this.domNode.childNodes[6];},getTimeSelectorDiv:function getTimeSelectorDiv(){return this.domNode.childNodes[5];},renderLegend:function renderLegend(){var placeholder=this.legendBarDiv;var m=this.margin;var chartID=this.chartID;var props={placeholder:placeholder,model:this.model,utils:this.utils,widget:this,isLegendBarOpen:chartStatus[chartID].isLegendBarOpen,isAndroidTab:this.isAndroidTab,isLegendSelected:chartStatus[chartID].isLegendSelected,legendSelectedIndex:chartStatus[chartID].legendSelectedIndex,top:m.t+"px",right:"0px",zIndex:1};var w=new mstrmojo.VisTimeSeriesLegend(props);w.render();this._legend=w;},renderTimeSelector:function renderTimeSelector(){var placeholder=this.timeSelectorDiv;var m=this.margin;var chartID=this.chartID;var props={placeholder:placeholder,offsetx:this.margin.l,widget:this,chartStatus:chartStatus[this.chartID]};var w=new mstrmojo.VisTimeSeriesTimeSelector(props);w.render();this._timeSelector=w;},renderVisTooltip:function renderVisTooltip(){var props={placeholder:this.tooltip,cssClass:"timeseries-tooltip"};this._tooltip=new mstrmojo.VisTooltip(props);this._tooltip.render();this._tooltip.toggle(false);},renderLegendTooltip:function renderLegendTooltip(){var props={placeholder:this.legendTooltip,boundary:this.domNode};this._legendTooltip=new mstrmojo.VisTextTooltip(props);this._legendTooltip.render();this._legendTooltip.toggle(false);},setAnimationCanvasContainer:function setAnimationCanvasContainer(){var currStatus=chartStatus[this.chartID],m=this.margin;this.itemsContainerNode.style.left=m.l+"px";this.xLabelsDivContainer.style.left=(m.l-this.maxYLblWidth)+"px";},updateRnsRne:function updateRnsRne(rns,rne){var currStatus=chartStatus[this.chartID],m=this.model;if((rns==0||rns)&&rne){currStatus.rns=rns;currStatus.rne=rne;}m.rns=currStatus.rns;m.rne=currStatus.rne;},drawPreparation:function drawPreparation(windowSize,rns,rne){var me=this,margin=this.margin,model=me.model,diff=rne-rns,height=me.getHeight()-me.masterChartHeight,ctx=me.animationContext;var chartWidth=me.getChartWidthOnScreen();this.chartWidth=chartWidth;getACRnsRne.call(this,rns,rne);var ACdiff=me.ACrne-me.ACrns;if(diff<windowSize){if(diff>1){diff--;}if(ACdiff>1){ACdiff--;}windowSize--;}this.itemsContainerNode.style.width=chartWidth+"px";this.itemsContainerNode.style.height=height+"px";this.xLabelsDivContainer.style.width=me.maxYLblWidth+chartWidth+"px";this.xLabelsDivContainer.style.height=height+"px";totalChartWidth=(windowSize/diff)*chartWidth;me.totalChartWidth=totalChartWidth;var acContentWidth=0;if(model.currentRatio>rangeToSeriesMaxRatio){acContentWidth=(ACdiff/diff)*chartWidth;}else{acContentWidth=totalChartWidth;}this.acContentWidth=acContentWidth;var acWidth=rangeToSeriesMaxRatio*this.getWidth();if(me.animationCanvas.width!==acWidth){canvasReseted=true;}me.animationCanvas.width=acWidth;me.RTX=(totalChartWidth-1)/(this.windowSize-1);},drawChart:function drwchrt(){var model=this.model;if(model.err){return ;}var me=this,mvalues=model.mvalues,width=me.getWidth(),margin=me.margin,utils=me.utils,values=model.series,ylbls=model.ylbls,windowSize=me.windowSize,currStatus=chartStatus[this.chartID];if((!currStatus.rns&&currStatus.rns!=0)||!currStatus.rne||currStatus.rns<0||currStatus.rne>windowSize){currStatus.rns=model.rns;currStatus.rne=model.rne;if((currStatus.rne-currStatus.rns)<2){if(currStatus.rns>0){currStatus.rns=currStatus.rne-2;}else{currStatus.rne=currStatus.rns+2;}}}this.updateRnsRne();var mch=me.masterChartHeight;var height=me.slaveChartHeight;if(!values){return ;}if(me.isDrawAxis&&me.drawYAxisLabels){margin.l=utils.getLabelWidthForMargin(me,model.mls);}me.masterCanvas.height=mch;me.masterCanvas.width=width;utils.fillMasterChartBackground(me,0,masterMargin.t,width,mch-masterMargin.t-masterMargin.b,masterMargin.b,me.masterContext);me.MRTY=(mch-masterMargin.t-masterMargin.b-1-3)/(mvalues[mvalues.length-1]-mvalues[0]);me.MRTX=(width-masterMargin.l-masterMargin.r-1)/(windowSize-1);me.drawSeries(0,windowSize,currStatus.rns,currStatus.rne,values,me.masterContext,true);me.setMasterSlider();this.calculateRnsRneFromSXP();if(me.canvas.height!=height||me.animationCanvas.height!=height||me.highlightCanvas.height!=height||me.canvas.width!=width){me.canvas.height=me.animationCanvas.height=me.highlightCanvas.height=height;me.canvas.width=me.highlightCanvas.width=width;canvasReseted=true;utils.fillBackground(me);}this.maxYLblWidth=this.getMaxTextWidth(ylbls,this.mstrmojo_Chart_lbl_font)+5;this.drawPreparation(windowSize,currStatus.rns,currStatus.rne);me.RTY=(height-margin.t-margin.b-1-4)/(mvalues[mvalues.length-1]-mvalues[0]);me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,me.animationContext,false);},calculateRnsRneFromSXP:function calrns(){var me=this;var rne=Math.round((me.SRXP-masterMargin.l)/me.MRTX)+1;rne=Math.min(rne,me.windowSize);var rns=Math.round((me.SLXP-masterMargin.l)/me.MRTX);this.updateRnsRne(rns,rne);},reDrawSlaveChartImpl:function reDrawSlaveChartImpl(){var me=this,model=me.model,currStatus=chartStatus[this.chartID],values=model.series,context=me.animationContext;this.drawPreparation(me.windowSize,currStatus.rns,currStatus.rne);me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,context,false);localUpdateScrollerConfig.call(me);this.removeLabels();itemClicked=true;this.drawLabels();itemClicked=false;},redrawSeries:function redrawSeries(){var me=this,model=me.model,values=model.series,context=me.animationContext,windowSize=me.windowSize,ht=me.getHeight(),currStatus=chartStatus[this.chartID];me.animationCanvas.width=me.animationCanvas.width;me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,context,false);localUpdateScrollerConfig.call(me);this.removeLabels();itemClicked=true;this.drawLabels();itemClicked=false;},incFetchChart:function incFetchChart(mustRedraw){var me=this,model=me.model,currStatus=chartStatus[this.chartID],values=model.series,context=me.animationContext,m=me.margin,utils=me.utils,lines=[],width=me.getWidth(),chartWidth=me.getChartWidthOnScreen(),h=me.canvas.height,windowSize=me.windowSize;var v0l=values[0].rv.length;var diff=currStatus.rne-currStatus.rns;var needRedraw=getACRnsRne.call(this);var redrawChart=mustRedraw||needRedraw||currStatus.isLegendSelected||me.needRedrawVerticalLine;if(redrawChart){var ACdiff=me.ACrne-me.ACrns;if(diff<v0l){if(diff>1){diff--;}if(ACdiff>1){ACdiff--;}v0l--;}totalChartWidth=(v0l/diff)*chartWidth;me.totalChartWidth=totalChartWidth;var acContentWidth=0;if(model.currentRatio>rangeToSeriesMaxRatio){acContentWidth=(ACdiff/diff)*chartWidth;}else{acContentWidth=totalChartWidth;}this.acContentWidth=acContentWidth;me.animationCanvas.width=me.animationCanvas.width;me.drawSeries(me.ACrns,me.ACrne,currStatus.rns,currStatus.rne,values,context,false);localUpdateScrollerConfig.call(me);}this.removeLabels();itemClicked=true;this.drawLabels(!redrawChart);itemClicked=false;},reDrawSlaveChart:function reDrawSlaveChart(){var me=this;this.calculateRnsRneFromSXP();this.reDrawSlaveChartImpl();chartSizeChanged=false;masterSliderClicked=null;this.hideMessage();},drawSeries:function drawSeries(start,end,rns,rne,values,context,isMasterChart){var me=this,utils=me.utils,lines=[],k=0,vl=values.length;var lineWidth=isMasterChart?1:(rne-rns>180?1:2);for(var j=vl-1;j>=0;j--){lines=[];k=0;for(var i=start;i<end;i++){var val=values[j].rv[i];if(val.length===0){lines[k++]=null;continue;}lines[k]={x:isMasterChart?((i*me.MRTX)+masterMargin.l+1):((i-start)*me.RTX),y:isMasterChart?utils.getMasterYValue(me,val,masterMargin):utils.getYValue(me,val)};k++;}me.drawChartLine(lines,rns-start,rne-start,j,context,isMasterChart,lineWidth);}if(!isMasterChart&&me.lastSelectedPoint){me.highlightSelectedPoint();}},getSerieColor:function getSerieColor(serieIndex){var clrLength=this.chartLineColors.length;return this.chartLineColors[serieIndex%clrLength];},drawChartLine:function drwcl(lines,rns,rne,si,context,isMasterChart,lw){var me=this,m=me.model,s=m.series[si],utils=this.utils,currStatus=chartStatus[this.chartID];context.save();context.lineCap="round";context.lineWidth=lw||2;context.lineJoin="round";context.beginPath();if(this.formatProp&&this.formatProp.useCustomAxisScale){var margin;if(!isMasterChart){margin=me.margin;context.rect(0,margin.t,me.animationCanvas.width,me.slaveChartHeight-margin.b-margin.t);}else{margin=masterMargin;context.rect(0,margin.t,me.getWidth(),me.masterChartHeight-margin.b-margin.t);}context.clip();}var clr=this.getSerieColor(si),rgbClr=$CLR.hex2rgb(clr),l=lines.length,dataPointPerScreen=rne-rns;context.strokeStyle=clr;if(currStatus.isLegendSelected&&!isMasterChart){if(currStatus.legendSelectedIndex===si){var MaxY=this.canvas.height-this.margin.b;var start=rns,end=rne-1;for(var i=0;i<Math.ceil((l-1-rns)/(dataPointPerScreen-1));i++){if(mstrmojo.dom.isIE10){utils.drawLineAreaWithSplit(me,lines,start,end,MaxY,rgbClr,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineArea(me,lines,start,end,MaxY,rgbClr,context);}start=end;end=Math.min(start+dataPointPerScreen-1,l-1);}start=Math.max(rns-dataPointPerScreen+1,0),end=rns;for(var i=Math.ceil((rns)/(dataPointPerScreen-1));i>0;i--){if(mstrmojo.dom.isIE10){utils.drawLineAreaWithSplit(me,lines,start,end,MaxY,rgbClr,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineArea(me,lines,start,end,MaxY,rgbClr,context);}end=start;start=Math.max(start-dataPointPerScreen+1,0);}if(mstrmojo.dom.isIE10){utils.drawLineAreaWithSplit(me,lines,start,end,MaxY,rgbClr,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineArea(me,lines,start,end,MaxY,rgbClr,context);}context.strokeStyle=this.highlightColor;context.globalAlpha=1;context.lineWidth=2;}else{context.globalAlpha=0.3;context.lineWidth=1;}}if(mstrmojo.dom.isIE10){utils.drawLineSetWithSplit(me,lines,false,context,MAXPOINTS_PER_DRAW);}else{utils.drawLineSet(me,lines,false,context);}context.restore();},drawLabels:function drwlbls(needNotDrawVerticalGridLine){this.drawChartXYAxis();if(this._super){this._super(needNotDrawVerticalGridLine);}},drawSelector:function drwsl(lbl,rl,intervalChanged){var m=this.model,sl=m.series[0].rv.length,rng=sl,bm=this.baseModel,row=bm.rowHeaders,currStatus=chartStatus[this.chartID],rns=currStatus.rns,rne=currStatus.rne;if(intervalChanged){var rs=parseInt(rl.rs,10);var sr=rl.sr;for(var i=0;i<row.length;i++){if(row[i].id===sr){rng=row[i].l*rs;break;}}if(rng<2){rng=2;}var index=mstrmojo.dom.findAncestorByAttr(lbl,"value",true,this.domNode);var right=rne;if(right-rng>=0){currStatus.rns=right-rng;currStatus.rne=right;}else{currStatus.rns=0;currStatus.rne=rng<sl?rng:sl;}this.updateIntervalPosition();this.updateRnsRne();}this.refreshChart(true,isDataSetChanged);itemClicked=false;this.hideMessage();},getTouchValue:function gtvlindx(x,y){var md=this.model,m=this.margin,currStatus=chartStatus[this.chartID];var sz=currStatus.rne-currStatus.rns>0?currStatus.rne-currStatus.rns>1?currStatus.rne-currStatus.rns:2:this.windowSize;var touchVal=Math.round(((x-m.l)*(sz-1))/(this.getChartWidthOnScreen()));return(touchVal<sz)?touchVal:null;},getNearestPoint:function getNP(touchX,touchY){var me=this,currStatus=chartStatus[this.chartID],margin=me.margin;var touchPointOnWidget=me.utils.getTouchXYOnWidget(touchX,touchY,me);touchX=touchPointOnWidget.touchX;touchY=touchPointOnWidget.touchY;if(touchX<margin.l||touchY<margin.t||touchY>me.canvas.height-margin.b){return ;}var xIndexOnScreen=this.getTouchValue(touchX,touchY);var rowIdx=xIndexOnScreen+currStatus.rns;var pointX=(xIndexOnScreen*me.RTX)+me.margin.l;var pointY,serieIdx;if(currStatus.isLegendSelected){serieIdx=currStatus.legendSelectedIndex;pointY=me.utils.getYValue(me,me.model.series[serieIdx].rv[rowIdx]);}else{var nearestPoint=me.utils.getSeriesIndexAndYValue(me,rowIdx,touchY);serieIdx=nearestPoint.si;pointY=nearestPoint.y;}return{rowIdx:rowIdx,serieIdx:serieIdx,point:{x:pointX,y:pointY}};},highlightPoint:function hghlghtpnt(x,touchX,touchY){var me=this,ctx=me.highlightContext,height=me.highlightCanvas.height,mg=me.margin,m=me.model,utils=me.utils,currStatus=chartStatus[this.chartID],si=currStatus.isLegendSelected?currStatus.legendSelectedIndex:me.seriesIndex;this.highlightCanvas.width=this.highlightCanvas.width;if(x<0){return ;}var xcoord=(x*me.RTX)+mg.l;ctx.strokeStyle=this.utils.rgb2rgbStr(this.formatProp.textClr);ctx.lineCap="round";ctx.lineWidth=2;ctx.globalAlpha=1;utils.drawLineSet(me,[{x:touchX,y:this._tooltip.domNode.offsetHeight},{x:touchX,y:height-mg.b}],false,ctx);ctx.strokeStyle=me.highlightColor;ctx.fillStyle=ctx.strokeStyle;var s=m.series,l=s.length,rns=(currStatus.rns===0||currStatus.rne-currStatus.rns>1)?currStatus.rns:currStatus.rns-1,rowIdx=rns+x,y=utils.getYValue(me,s[si].rv[rowIdx]);if(!chartStatus[this.chartID].isLegendSelected){ctx.strokeStyle=me.getSerieColor(si);}ctx.fillStyle=ctx.strokeStyle;if(y>=mg.t&&y<=this.canvas.height-mg.b){utils.drawArc(me,xcoord,y,5,0,Math.PI*2,true,true,ctx);}this.lastHighlightPoint={rowIdx:rowIdx,serieIdx:si,point:{x:xcoord,y:y}};},hideTimeSelectorLabels:function htsl(){var lbls=this.domNode.getElementsByClassName("timeseries-intervals");for(var i=0;i<lbls.length;i++){lbls[i].style.display="none";}},showTimeSelectorLabels:function stsl(){var lbls=this.domNode.getElementsByClassName("timeseries-intervals");for(var i=0;i<lbls.length;i++){lbls[i].style.display="block";}},getFormattedDateForTooltip:function getFormattedDateForTooltip(val,isLongFormat){if(isNaN(val)){return val;}var fVal=val;try{val=this.utils.convertRawValueToMilliseconds(val);var dt=new Date(Number(val)),$_DT=mstrmojo.locales.datetime;var mn=isLongFormat?$_DT.MONTHNAME_FULL[dt.getMonth()]:$_DT.MONTHNAME_SHORT[dt.getMonth()];var yr=dt.getFullYear().toString();if(isLongFormat){fVal=mn+" "+dt.getDate()+", "+yr;}else{fVal=mn+"-"+dt.getDate()+"-"+yr.substring(2);}}catch(e){}return fVal;},showLegendTooltip:function showLegendTooltip(e){this._legendTooltip.updateContent(e);},hiddenLegendTooltip:function hiddenLegendTooltip(){this._legendTooltip&&this._legendTooltip.toggle(false);},getLegendName:function getLegendName(colHeaders,series,i){var colHLength=colHeaders.length;var hiLength=series[i].hi.length;if(colHLength<1){return"null";}if(hiLength==colHLength){var legendName="";for(var j=0;j<hiLength;j++){var colHeader=colHeaders[j];var colName="";if(colHeader.es){colName=colHeader.es[series[i].hi[j]];}else{colName=colHeader.items[series[i].hi[j]].n;}if(j>0){legendName+=" ";}if(colName!=""){legendName+=colName;}}return legendName;}else{var items=colHeaders[0].items;legendName=items[i%items.length].n;return legendName;}return"null";},getRowHeader:function getrh(idx){var me=this,m=me.model,riArray=m.ri,s=m.series,cat=m.categories,tp=cat.tp,currStatus=chartStatus[this.chartID],rowHs=m.rowHeaders,rowHLength=rowHs.length,rowHeader=[];var rVal=cat.items[idx];var ri=riArray&&riArray[idx];if(!ri){return rowHeader;}if(tp.toString()===me.DSS_XML_BASE_FORM_DATE){rVal=me.getFormattedDateForTooltip(rVal,true);var rowHeaderObj={};rowHeaderObj.n=rowHs[rowHLength-1].n;rowHeaderObj.v=rVal;rowHeader.push(rowHeaderObj);}else{for(var i=0;i<rowHLength;i++){var rowHeaderObj={};var rowH=rowHs[i];rowHeaderObj.n=rowH.n;rowHeaderObj.v=rowH.es[ri[i]]||"";rowHeader.push(rowHeaderObj);}}return rowHeader;},setMarginTopByTooltipHeight:function setMarginTopByTooltipHeight(){var me=this,m=me.model,mg=me.margin,s=m.series,colH=m.colHeaders;if(this._tooltip){this._tooltip.displayInfo([{n:"legendName",v:"val"},{n:"rowHeaderName",v:"rowHeaderValue"}]);this._tooltip.toggle(true);var height=this._tooltip.domNode.offsetHeight+10;this._tooltip.toggle(false);if(me.margin.t<height){me.margin.t=height;}}var stt=me.sliderTooltip,sttF=stt.firstChild,sttP=stt.lastChild;sttF.innerHTML="name: value";sttF.style.display="block";var sliderTooltipHeight=sttF.offsetHeight;me.sliderTooltipYPosition=me.getHeight()-me.masterChartHeight-sliderTooltipHeight-7+masterMargin.t;sttP.style.top=sliderTooltipHeight+"px";sttF.style.display="none";},renderTooltip:function rndrttp(valIndex,touchX,touchY){if(valIndex<0){this._tooltip.toggle(false);return ;}var me=this,m=me.model,mg=me.margin,s=m.series,currStatus=chartStatus[this.chartID],si=currStatus.isLegendSelected?currStatus.legendSelectedIndex:me.seriesIndex,rns=(currStatus.rns===0||currStatus.rne-currStatus.rns>1)?currStatus.rns:currStatus.rns-1,colH=m.colHeaders;var width=me.getWidth();if(!tooltipShown){me.hideTimeSelectorLabels();tooltipShown=true;var touchManager=mstrmojo.touchManager;this._touchListener=touchManager.attachEventListener("touchesBegin",this.id,function(evt){if(!isTouchedOnWidget.call(me,evt.touch)){me.hiddenTooltipAndShowTimeSelector();}});}var vIdx=rns+valIndex;var val=s[si].v[vIdx]?s[si].v[vIdx]:"null";var legendName=this.getLegendName(colH,s,si);var rowHeaders=this.getRowHeader(vIdx),rowHeaderName="",rowHeaderValue="";for(var i=0;i<rowHeaders.length;i++){rowHeaderName+=rowHeaders[i].n;rowHeaderValue+=rowHeaders[i].v;if(i<rowHeaders.length-1){rowHeaderName+=" ";rowHeaderValue+=" ";}}this._tooltip.displayInfo([{n:legendName,v:val},{n:rowHeaderName,v:rowHeaderValue}]);this._tooltip.toggle(true);this._tooltip.doLayout(width-10);var ttw=this._tooltip.domNode.offsetWidth,x=touchX-ttw/2;if(x<5){x=5;}else{if(x>width-5-ttw){x=width-5-ttw;}}this._tooltip.posTo({x:x,y:5});},handleTouchEnd:function handleTouchEnd(){this._super();this._tooltip&&this._tooltip.toggle(false);},showMessage:function shmsg(text){var msg=this.loadingMsg,mns=msg.style;msg.innerHTML=text||mstrmojo.desc(5674,"Loading...");mns.display="block";mns.opacity=1;var x=Math.round(this.getWidth()/2-msg.offsetWidth/2);var y=Math.round(this.getHeight()/2-msg.offsetHeight/2);this.utils.translateCSS(x,y,false,msg);},hideMessage:function hmsg(){this.loadingMsg.style.opacity=0;},showMasterSliderTooltip:function showMasterSliderTooltip(item){$CSS.addClass(item.node,"mstrmojo-timeseries-span-shadow");var stt=this.sliderTooltip;stt.firstChild.style.display="block";stt.lastChild.style.display="block";this.renderSliderTooltip(item.value==="L"?this.SLXP:this.SRXP);},unrender:function unrender(ignoreDom){if(this._tooltip){this._tooltip.destroy();delete this._tooltip;}if(this._legend){this._legend.destroy();delete this._legend;}if(this._timeSelector){this._timeSelector.destroy();delete this._timeSelector;}if(this._legendTooltip){this._legendTooltip.destroy();delete this._legendTooltip;}if(this._super){this._super(ignoreDom);}},refresh:function refresh(){var me=this;removeLegendAndTimeSelectorChildren.call(this);me.removeLabels();me.lastSelectedPoint=null;me.render();},removeLabels:function rmvlbls(){var me=this;me.canvas.width=me.canvas.width;me.utils.fillBackground(me);me.xLabelsDiv.innerHTML="";var lbls=me.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(lbls){lbls.innerHTML="";}},refreshChart:function refcht(isMetric,pld){var me=this,wd=me.getWidth(),ht=me.getHeight();if(me.model.err){return ;}me.highlightCanvas.width=wd;me.animationCanvas.width=me.animationCanvas.width;if(isMetric){me.context.clearRect(0,0,wd,ht);me.removeLabels();if(pld){me.data.processLinearData(me);}}me.drawChart();this.setAnimationCanvasContainer();me.drawLabels();localUpdateScrollerConfig.call(me);},timeSelectorOnClick:function hoc(item){var currStatus=chartStatus[this.chartID];if(!itemClicked){itemClicked=true;var me=this,v=item.value,node=item.node,intervalChanged=true;if(node===me.currSelection&&!currStatus.usingCustomInterval){itemClicked=false;return ;}if(v==="S"){if(currStatus.usingCustomInterval){currStatus.usingCustomInterval=false;}else{me.updateIntervalPosition();}if(me.currSelection){me._timeSelector.toggleSelected(me.currSelection,false);me._timeSelector.toggleGlowEffect(me.currSelection,false);}me._timeSelector.toggleSelected(node,true);me._timeSelector.toggleGlowEffect(node,true);var bm=me.baseModel,tslIndex=parseInt(node.getAttribute("value"));var tsl=bm.vp.rl[tslIndex];if((bm.k&&bm.k!==tsl.ds)&&me.layoutModel){var getData=resetBaseAndDerivedData.call(this,tsl);if(!getData){return ;}}else{isDataSetChanged=false;}intervalChanged=node!==me.currSelection;me.currSelection=node;currStatus.currSelectionIdx=me.currSelection.getAttribute("value");me.showMessage();window.setTimeout(function(){me.drawSelector(node,tsl,intervalChanged);},10);}}},moveMasterSlider:function moveMasterSlider(x){var me=this,m=me.model,width=me.getWidth(),delta=Math.round(x-originalTouchPosition),currStatus=chartStatus[this.chartID];this.SLXP+=delta;this.SRXP+=delta;this.SLXP=Math.round(this.SLXP);this.SRXP=Math.round(this.SRXP);this.makeSureMasterSliderNotBeyondTheMargin(true);this.setMasterSliderLayout();this.calculateRnsRneFromSXP();localUpdateScrollerConfig.call(me);if(!currStatus.usingCustomInterval&&this.currSelection){this.updateIntervalPosition();}},updateIntervalPosition:function updateIntervalPosition(){var me=this,m=me.model,currStatus=chartStatus[this.chartID];if(me.currSelection){var index=me.currSelection.getAttribute("value");currStatus.timeSelectedIntervalPosition[index]={rns:currStatus.rns,rne:currStatus.rne};}},drawSliderTooltipPointer:function drawSliderTooltipPointer(){var canvas=this.sliderTooltip.lastChild,cntx=canvas.getContext("2d"),width=canvas.width,height=canvas.height;cntx.fillStyle="#ffffff";cntx.beginPath();cntx.moveTo(0,0);cntx.lineTo(width,0);cntx.lineTo(width/2,height);cntx.lineTo(0,0);cntx.closePath();cntx.fill();},renderSliderTooltip:function renderSliderTooltip(sliderTooltipXPosition){var me=this,stt=me.sliderTooltip,sttF=stt.firstChild,sttP=stt.lastChild,width=me.getWidth();var pointerPos=sliderTooltipXPosition;var content=getFormattedDateForSliderTooltip.call(this,sliderTooltipXPosition);if(content==""){content="--";}sttF.innerHTML=content;var stWidth=sttF.offsetWidth,stHalfWidth=stWidth/2;if(sliderTooltipXPosition!==this.SLXP){sliderTooltipXPosition=this.SRXP-stHalfWidth;}else{sliderTooltipXPosition-=stHalfWidth;}if(sliderTooltipXPosition<0){sliderTooltipXPosition=0;}else{if(sliderTooltipXPosition+stWidth>width){sliderTooltipXPosition=width-stWidth;}}sttP.style.left=(pointerPos-sliderTooltipXPosition-3)+"px";me.utils.translateCSS(sliderTooltipXPosition,me.sliderTooltipYPosition,false,stt);},resizeMasterSlider:function resizeMasterSlider(x){var me=this,width=me.getWidth(),msl=me.masterSlider,msls=msl.style,lcs=msl.parentNode.firstChild.style,rcs=msl.parentNode.childNodes[2].style;var touchPoint=me.utils.getTouchXYOnWidget(x,0,me);x=touchPoint.touchX;var fixWhich;if(masterSliderClicked==="L"){this.SLXP=x;fixWhich="R";}else{this.SRXP=x;fixWhich="L";}me.makeSureMasterSliderNotBeyondTheMargin();me.makeSureMasterSliderNoOverlap(fixWhich);this.setMasterSliderLayout();if(masterSliderClicked==="L"){me.renderSliderTooltip(this.SLXP);}else{me.renderSliderTooltip(this.SRXP);}chartStatus[this.chartID].usingCustomInterval=true;chartSizeChanged=true;},shouldTouchBubble:function shouldTouchBubble(touch){return false;},hiddenTooltipAndShowTimeSelector:function hsctooltip(){if(tooltipShown){this.handleTouchEnd();tooltipShown=false;this.showTimeSelectorLabels();var touchManager=mstrmojo.touchManager;touchManager.detachEventListener(this._touchListener);delete this._touchListener;}},onCrossWidgetMultitouch:function onCrossWidgetMultitouch(){this.hiddenTooltipAndShowTimeSelector();},touchBegin:function touchBegin(touch){this.adjustWidgetOffsets();var item=this.isMasterSliderTouched(touch);if(item){this.hiddenTooltipAndShowTimeSelector();var value=item.value;if(value==="L"||value==="R"||value==="MS"){masterSliderClicked=item.value;originalTouchPosition=touch.pageX;if(item.value!=="MS"){this.showMasterSliderTooltip(item);}}else{return false;}}else{if(!isScrollableElementTouched.call(this,touch)){this.hiddenTooltipAndShowTimeSelector();if(this.shouldTouchBubble(touch)){return this.bubbleTouchEvent(touch);}return false;}}},isMasterSliderTouched:function isMasterSliderTouched(touch){var item=getTouchedElement.call(this,touch);if(item&&(item.value==="L"||item.value==="R")){return item;}var touchRadius=45*this.utils.getScreenZoomFactor();var position=this.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,this);var touchX=position.touchX,touchY=position.touchY;var height=this.getHeight();if(touchY>height||touchY<height-this.masterChartHeight){return null;}if(touchX<this.SRXP&&touchX>this.SLXP){return{node:this.masterSlider.childNodes[1],value:"MS"};}var LDistance=Math.abs(touchX-this.SLXP);var RDistance=Math.abs(this.SRXP-touchX);var minDistance=Math.min(LDistance,RDistance);if(minDistance<touchRadius){if(LDistance==minDistance){return{node:this.masterSlider.firstChild,value:"L"};}else{if(RDistance==minDistance){return{node:this.masterSlider.lastChild,value:"R"};}}}else{return null;}return null;},touchSelectBegin:function touchSelectBegin(touch){this.hiddenTooltipAndShowTimeSelector();var item=this.isMasterSliderTouched(touch);if(item){if(item.value==="L"||item.value==="R"||item.value==="MS"){masterSliderClicked=item.value;originalTouchPosition=touch.pageX;}}else{this.handleTouchBegin(touch.pageX,touch.pageY);}},touchSelectMove:function touchSelectMove(touch){if(masterSliderClicked){if(masterSliderClicked==="MS"){this.moveMasterSlider(touch.pageX);}else{this.resizeMasterSlider(touch.pageX);}originalTouchPosition=touch.pageX;return false;}this.handleTouchMove(touch.pageX,touch.pageY);},handleTouchSelectEnd:function handleTouchSelectEnd(touch){if(masterSliderClicked){if(masterSliderClicked==="MS"){this.makeSureSliderOnPoint();this.setMasterSliderLayout();this.incFetchChart();}else{resizeMasterSliderDone.call(this);}return false;}var canBeSelected=false;if(touch){var nearestPoint=this.getLastHighlightPoint();canBeSelected=nearestPoint&&this.pointCanBeSelected(nearestPoint.rowIdx,nearestPoint.serieIdx);}if(!canBeSelected){this.handleTouchEnd();if(tooltipShown){tooltipShown=false;this.showTimeSelectorLabels();}}else{this.seriesIndex=-1;}this.hiddenLegendTooltip();},touchSelectEnd:function touchSelectEnd(touch){this.handleTouchSelectEnd(touch);},touchMultiBegin:function touchMultiBegin(touch){this.handleTouchSelectEnd();},touchSwipeMove:function touchSwipeMove(touch){if(isScrollableElementTouched.call(this,touch)&&this._super){this._super(touch);}else{if(masterSliderClicked){if(masterSliderClicked==="MS"){this.moveMasterSlider(touch.pageX);}else{this.resizeMasterSlider(touch.pageX);}originalTouchPosition=touch.pageX;}}},touchSwipeEnd:function touchSwipeEnd(touch){if(masterSliderClicked){if(masterSliderClicked==="MS"){this.makeSureSliderOnPoint();this.setMasterSliderLayout();this.incFetchChart();}else{resizeMasterSliderDone.call(this);}return false;}else{if(this._super){this._super(touch);}}},touchSelectCancel:function touchSelectCancel(touch){this.touchCancel(touch);},touchCancel:function touchCancel(touch){this.touchSelectEnd(touch);},touchEnd:function touchEnd(touch){if(masterSliderClicked&&!chartSizeChanged){hideMasterSliderTooltip.call(this);masterSliderClicked=null;}this._legend.hiddenSwitcherArrowGlowEffect();return false;},pointCanBeSelected:function pcbs(rowIdx,serieIdx){if(this.selectionOrLinkdrillOnRow){return true;}var me=this,m=me.model,colHeaders=m.colHeaders,colHL=colHeaders.length,hi=m.series[serieIdx].hi,hiLength=hi.length;for(var i=0;i<colHL;i++){var colH=colHeaders[i];if(colH.es){if(colH.sc&&colH.sc.tks){return true;}if(colH.lm&&colH.lm[0]&&colH.lm[0].links){return true;}}else{if(colH.sc&&colH.sc.tks){return true;}var lmArray=colH.lm,lm=lmArray&&lmArray[hi[i]];if(lm&&lm.links){return true;}}}return false;},getModelK:function getModelK(){var k=this.baseModel&&this.baseModel.k;return k;},getActionObjList:function getActionObjList(nearestPoint,selectedAll){var actionObjList=[];var scObjList=[];var actionType=0;var actionObjList=[];var linkDrillNode=null;var metricColHIdx=-1;var me=this,model=me.model,riArray=model.ri,ri=riArray[nearestPoint.rowIdx],rowHeaders=model.rowHeaders,rowHL=rowHeaders.length;for(var i=0;i<rowHL;i++){var rowH=rowHeaders[i];if(rowH.sc&&rowH.sc.tks){if(selectedAll&&(rowH.sc.all==="false"||rowH.sc.all===false)){return null;}var scObj={};scObj.sc=rowH.sc;scObj.es=rowH.es[ri[i]];scObj.eid=selectedAll?"OA:(All)":rowH.eid[ri[i]];scObjList.push(scObj);actionType=rowH.at||0;}if(rowH.lm&&rowH.lm[0]&&rowH.lm[0].links&&!linkDrillNode){linkDrillNode={};linkDrillNode.titleInfo=rowH;linkDrillNode._e={id:rowH.eid[ri[i]],n:rowH.es[ri[i]]};}}var colHeaders=model.colHeaders,colHL=colHeaders.length,hi=model.series[nearestPoint.serieIdx].hi,hiLength=hi.length;for(var i=colHL-1;i>=0;i--){var colH=colHeaders[i];if(colH.es){if(colH.sc&&colH.sc.tks){if(selectedAll&&(colH.sc.all==="false"||colH.sc.all===false)){return null;}var scObj={};scObj.sc=colH.sc;scObj.es=colH.es[hi[i]];scObj.eid=selectedAll?"OA:(All)":colH.eid[hi[i]];scObjList.push(scObj);actionType=colH.at||0;}if(colH.lm&&colH.lm[0]&&colH.lm[0].links&&!linkDrillNode){linkDrillNode={};linkDrillNode.titleInfo=colH;linkDrillNode._e={id:colH.eid[hi[i]],n:colH.es[hi[i]]};}}else{if(colH.sc&&colH.sc.tks){if(selectedAll&&(colH.sc.all==="false"||colH.sc.all===false)){return null;}var scObj={};scObj.sc=colH.sc;scObj.es=colH.items[hi[i]].n;scObj.eid=selectedAll?"OA:(All)":colH.items[hi[i]].id;scObjList.push(scObj);actionType=colH.at||0;}metricColHIdx=i;}}if(scObjList.length>0){actionType=actionType|SELECTOR_ACTION;this.infoWindowAnchor.style.left=(nearestPoint.point.x-9)+"px";this.infoWindowAnchor.style.top=(nearestPoint.point.y-9)+"px";actionObjList.push({at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:this.infoWindowAnchor});return actionObjList;}if(!linkDrillNode){var metricH=colHeaders[metricColHIdx],metric=metricH.items[hi[metricColHIdx]],lm=metricH.lm[hi[metricColHIdx]];if(lm&&lm.links){linkDrillNode={};linkDrillNode.titleInfo=metricH;linkDrillNode.mix=hi[metricColHIdx];var currNode=linkDrillNode;for(var i=0;i<rowHL;i++){var rowH=rowHeaders[i];var nodeLP={};nodeLP.titleInfo=rowH;nodeLP._e={id:rowH.eid[ri[i]],n:rowH.es[ri[i]]};currNode._lp=nodeLP;currNode.axis=ROW_AXIS;currNode=nodeLP;}currNode=linkDrillNode;for(var i=colHL-1;i>=0;i--){var colH=colHeaders[i];if(colH.es){var nodeTP={};nodeTP.titleInfo=colH;nodeTP._e={id:colH.eid[hi[i]],n:colH.es[hi[i]]};currNode._tp=nodeTP;currNode.axis=COL_AXIS;currNode=nodeTP;}}}}if(linkDrillNode){actionType=actionType|HYPERLINK_ACTION;actionObjList.push({at:actionType,k:this.getModelK(),node:linkDrillNode});return actionObjList;}return null;},getLastHighlightPoint:function gtLstHighlightPnt(){return this.lastHighlightPoint||null;},performAction:function performAction(actionObjList){this.hasNonifwTarget=this.hasNoninfowindowTarget(actionObjList[0]);if(this._super){this._super(actionObjList);}},touchTap:function touchTap(touch){var me=this,nearestPoint=this.getLastHighlightPoint(),touchPointOnWidget=me.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,me);var touchPointInHighlightArea=tooltipShown&&getPointDistanceSquare({x:nearestPoint.point.x,y:nearestPoint.point.y},{x:touchPointOnWidget.touchX,y:touchPointOnWidget.touchY})<=45*45;if(touchPointInHighlightArea){me.hiddenTooltipAndShowTimeSelector();nearestPoint=this.getLastHighlightPoint();}else{nearestPoint=this.getNearestPoint(touch.pageX,touch.pageY);}if(isScrollableElementTouched.call(this,touch)){var fallInPointArea=getPointDistanceSquare({x:nearestPoint.point.x,y:nearestPoint.point.y},{x:touchPointOnWidget.touchX,y:touchPointOnWidget.touchY})<=45*45,canBeSelected=me.pointCanBeSelected(nearestPoint.rowIdx,nearestPoint.serieIdx),sameAsLastSelectedPoint=me.lastSelectedPoint&&(nearestPoint.rowIdx==me.lastSelectedPoint.rowIdx&&nearestPoint.serieIdx==me.lastSelectedPoint.serieIdx);if(fallInPointArea&&canBeSelected&&!sameAsLastSelectedPoint){if(tooltipShown){me.hiddenTooltipAndShowTimeSelector();}me.lastSelectedPoint=nearestPoint;me.incFetchChart(true);var actionObjList=this.getActionObjList(nearestPoint);me.performAction(actionObjList);}else{if(fallInPointArea&&!canBeSelected){if(touchPointInHighlightArea){}else{this.handleTouchBegin(touch.pageX,touch.pageY);}}else{if(tooltipShown){me.hiddenTooltipAndShowTimeSelector();}else{if(me.lastSelectedPoint){var actionObjList=this.getActionObjList(nearestPoint,true);if(actionObjList){me.performAction(actionObjList);me.lastSelectedPoint=null;me.incFetchChart(true);}}}}}}},highlightSelectedPoint:function highlightSelectedPoint(){var me=this,ctx=me.animationContext,utils=me.utils,pointInfo=me.lastSelectedPoint,point=pointInfo.point,currStatus=chartStatus[this.chartID];ctx.save();if(currStatus.isLegendSelected&&currStatus.legendSelectedIndex!=pointInfo.serieIdx){ctx.globalAlpha=0.3;}else{ctx.globalAlpha=1;}var pointX=(pointInfo.rowIdx-me.ACrns)*me.RTX;ctx.fillStyle=me.getSerieColor(pointInfo.serieIdx);ctx.lineWidth=1;utils.drawArc(me,pointX,point.y,4,0,Math.PI*2,true,true,ctx);if(this.theme==LIGHT_THEME){ctx.strokeStyle="#ffffff";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,5,0,Math.PI*2,true,false,ctx);ctx.strokeStyle="#000000";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,7,0,Math.PI*2,true,false,ctx);}else{ctx.strokeStyle="#333333";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,5,0,Math.PI*2,true,false,ctx);ctx.strokeStyle="#ffffff";ctx.lineWidth=2;utils.drawArc(me,pointX,point.y,7,0,Math.PI*2,true,false,ctx);}ctx.restore();},destroy:function destroy(){if(this.currSelection){delete this.currSelection;}if(this._touchListener){mstrmojo.touchManager.detachEventListener(this._touchListener);delete this._touchListener;}if(this._scrollDoneListener){this._scroller.detachEventListener(this._scrollDoneListener);delete this._scrollDoneListener;}if(this._scrollMovedListener){this._scroller.detachEventListener(this._scrollMovedListener);delete this._scrollMovedListener;}if(this._infoWClosedListener){this.xtabModel.docModel.detachEventListener(this._infoWClosedListener);delete this._infoWClosedListener;}if(this.fullScreenListener){mstrmojo.touchManager.detachEventListener(this.fullScreenListener);delete this.fullScreenListener;}if(this.selectorTargets){delete this.selectorTargets;}this._super();if(this._tn){delete this._tn;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.VisChartUtils","mstrmojo._HasTouchScroller","mstrmojo.color","mstrmojo.css","mstrmojo.VisMicroChartLine","mstrmojo.VisMicroChartBar","mstrmojo.VisMicroChartBullet","mstrmojo._NeedSyncScroller");var S=1;var t=2;var A=3;var W=4;var V=0,d=1,s=2,C=3,AF=4,F=5;var o=0;var AA=1;var AG=2;var AD="width:0px;height:0px;border-left:10px solid black;border-top:5px solid transparent;border-bottom:5px solid transparent;margin-left:auto;margin-right:auto;-webkit-transform:scale(0.8,0.9)";var AC="width:0px;height:0px;border-left:5px solid transparent;border-top:10px solid black;border-right:5px solid transparent;margin-left:auto;margin-right:auto;-webkit-transform:scale(0.9,0.8)";var l=0,T=1;var E=1;var Q=mstrmojo.color,D=mstrmojo.css;var a="microchart-table-text";var R=0;var P=0;function f(AI){AI.innerHTML="";}function e(){var AI=this.backgroundColor;if(!AI){return ;}this.dockedHeaderTable.style.backgroundColor=AI;this.dockedHeaderTable.style.opacity="1";this.dockedHeaderReplaceDiv.firstChild.style.backgroundColor=AI;this.dockedHeaderReplaceDiv.firstChild.style.opacity="1";}function M(AK,AL){var AP=AK.style.height;var AI=AK.style.width;var AQ=AK.style.textDecoration;var AO=AK.style.display;var AR=AK.style.fontSize;var AM=AK.style.paddingLeft;var AJ=AK.style.paddingRight;var AN=AK.style.boxShadow;AK.style.cssText=AL;AK.style.height=AP;AK.style.width=AI;AK.style.textDecoration=AQ;if(AO){AK.style.display=AO;}if(AR){AK.style.fontSize=AR;}if(AM){AK.style.paddingLeft=AM;}if(AJ){AK.style.paddingRight=AJ;}if(AN){AK.style.boxShadow=AN;}}function x(AQ,AP,AL){var AJ=AP.level;var AK="";if(AP.isLeaf){AK=o;}else{if(AP.needExpand){AK=AA;}else{AK=AG;}}var AM=null;var AN=this.bodyFontColorRGB;var AO=this.theme;if(AK==AG){AQ.className="microchart-tree-arrow-close";AM="border-left-color";}else{if(AK==AA){AQ.className="microchart-tree-arrow-open";AM="border-top-color";}else{AQ.className="";AQ.setAttribute("style","");return ;}}var AI="";if(AL){AI=AM+":"+AL;}else{if(AO==t){if(AJ==0){AI=AM+":#4c4c4c";}else{if(AJ==1){AI=AM+":rgba(76,76,76,0.8)";}else{if(AJ>1){AI=AM+":rgba(76,76,76,0.6)";}}}}else{if(AO==S){if(AJ==0){AI=AM+":white";}else{if(AJ==1){AI=AM+":rgba(255,255,255,0.8)";}else{if(AJ>1){AI=AM+":rgba(255,255,255,0.6)";}}}}else{if(AN&&AN.length>2&&(AO==W||AO==A)){if(AJ==0){AI=AM+":rgba("+AN[0]+","+AN[1]+","+AN[2]+",0.8)";}else{if(AJ>0){AI=AM+":rgba("+AN[0]+","+AN[1]+","+AN[2]+",0.7)";}}}}}}AQ.setAttribute("style",AI);}function O(Ax,Ac){var Af=this.widget,An=Af.rows[Ax],AM=An.model,AP=AM.elms,AO=this.rowTemplate,AR=An.treeNode,Ag=this.colInfos,Ax=An.rowIdx,Am=null,AS=Ag.length;var Ae=this.bodyFontColorRGB;var AW=this.headerTable.firstChild.firstChild.childNodes;Am=Ac?Ac.rowRef:An.rowRef;var Aw=null;var Aj=null;if(Am[this.domRefName]){Aw=Am[this.domRefName];}else{Aw=AO.cloneNode(true);Am[this.domRefName]=Aw;}Aw.style.display="";j.call(this,Ac?Ac:An);if(!this.isAndroidTab){Aw.style.fontSize=14*E+"px";}Aw.setAttribute("rowType",Ac?l:T);var Aj=Aw.childNodes;var AT=null;for(var As=0,AU=0;As<AS;As++,AU++){var Al=Ag[As];var Ah=Al.colIdx;Aj[As].setAttribute("mrow",An.rowIdx);if(Ah==this.treeColumnIdx&&AR){var Ap=Aj[As].firstChild;x.call(this,Ap,AR);if(!AR.isLeaf){Ap.parentNode.setAttribute("CLK","T");}continue;}if(Al.type==V||Al.type==d){if(this.isTreeMode){var Ai="";for(var Aq=0;Aq<AR.es.length;Aq++){Ai+=AR.es[Aq].n;}if(Ai.indexOf("&lt;")>=0){Ai=Ai.replace(/&lt;/g,"<");Ai=Ai.replace(/&gt;/g,">");}Aj[As].innerHTML=Ai;if(AR.level==0){Aj[As].style.fontWeight="bold";}else{Aj[As].style.fontWeight="";}if(AR.level>0&&(this.theme==A||this.theme==W)){if(Ae&&Ae.length>2){Aj[As].style.color="rgba("+Ae[0]+","+Ae[1]+","+Ae[2]+",0.8)";}}else{}}else{AT=AP[Al.order];var Ai=AT?AT.n:"";if(Ai.indexOf("&lt;")>=0){Ai=Ai.replace(/&lt;/g,"<");Ai=Ai.replace(/&gt;/g,">");}Aj[As].innerHTML=Ai;}continue;}if(Al.order=="LineChart"){if(Am[Ah]){var Ak=Am[Ah];if(AM.isTotal&&!this.isTreeMode){Ak.domNode.style.display="none";}else{Ak.domNode.style.display="";Ak.model=AM.model;Ak.refv=AM.refv;Ak.kpiOffset=this.kpiOff*Ax;Ak.reDrawChart();}}else{if(AM.isTotal&&!this.isTreeMode){continue;}var Ad=document.createElement("div");var Aa={placeholder:Ad,model:AM.model,refv:AM.refv,config:Af.sparklineProps,widget:Af,kpiOffset:this.kpiOff*Ax,width:Al.contentWidth,height:P,toolTipMain:Af.tooltip,mainOffsetTop:this.offsetTop,mainLeftPos:parseInt(this.domNode.style.left,0)||0,mainWidth:this.getWidth(),isTreeMode:this.isTreeMode,theme:this.theme};Aj[As].appendChild(Ad);var Ak=new mstrmojo.VisMicroChartLine(Aa);Ak.render();Aj[As].removeAttribute("class");Am[Ah]=Ak;}}else{if(Al.order=="BarChart"){if(Am[Ah]){var Ak=Am[Ah];if(AM.isTotal&&!this.isTreeMode){Ak.domNode.style.display="none";}else{Ak.model=AM.model;Ak.refv=AM.refv;Ak.kpiOffset=this.kpiOff*Ax;Ak.isTextBold=this.isTreeMode?AR.level==0:false;Ak.reDrawChart();}}else{if(AM.isTotal&&!this.isTreeMode){continue;}var Ad=document.createElement("div");var Aa={placeholder:Ad,model:AM.model,refv:AM.refv,widget:Af,kpiOffset:this.kpiOff*Ax,config:Af.barProps,width:Al.contentWidth,height:P,toolTipMain:Af.tooltip,mainOffsetTop:this.offsetTop,mainLeftPos:parseInt(this.domNode.style.left,0)||0,mainWidth:this.getWidth(),isTreeMode:this.isTreeMode,theme:this.theme,isTextBold:this.isTreeMode?AR.level==0:false};Aj[As].appendChild(Ad);var Ak=new mstrmojo.VisMicroChartBar(Aa);Ak.render();Aj[As].className=this.valueCssClass;Am[Ah]=Ak;}}else{if(Al.order=="GaugeChart"){if(Am[Ah]){var Ak=Am[Ah];Ak.model=AM.model;Ak.refv=AM.refv;Ak.kpiOffset=this.kpiOff*Ax;Ak.labelColorRGB=this.bodyFontColorRGB;Ak.reDrawChart();}else{var Ad=document.createElement("div");var Aa={placeholder:Ad,model:AM.model,refv:AM.refv,widget:Af,config:Af.bulletProps,width:Al.contentWidth,height:P,toolTipMain:Af.tooltip,mainOffsetTop:this.offsetTop,mainLeftPos:parseInt(this.domNode.style.left,0)||0,mainWidth:this.getWidth(),labelColorRGB:this.bodyFontColorRGB,showMinLabel:this.showMinLabel,isTreeMode:this.isTreeMode,theme:this.theme};Aj[As].appendChild(Ad);var Ak=new mstrmojo.VisMicroChartBullet(Aa);Ak.render();Aj[As].removeAttribute("class");Am[Ah]=Ak;}}else{var AI=-1;var Av=-1;if(this.widget.isKPI){Av=parseInt(Al.order)%this.kpiOff;var AI=An.model.metricIdx+Av;}else{if(Al.type==s){AI=parseInt(Al.order);Av=AI;}}var AY="";var AV="";if(!AM.refv[Av]){continue;}if(AM.refv[Av].ti===undefined){if(AM.refv[Av].ts===4){AY="<img src='"+AM.refv[Av].v+"'/>";}else{AY=AM.refv[Av].v;}}else{try{var AL=this.widget.model;var AK=AL.th[""+AI];var AJ=AM.refv[Av].ti;if(AM.refv[Av].ty===4){var Ao;if(AK[AJ]&&AK[AJ].n){Ao=AK[AJ].n;}else{Ao=AM.refv[Av].v;}if(Ao.indexOf(":")>=0){}else{var Ar;try{Ar=mstrApp.getConfiguration().getHostUrlByProject(mstrApp.getCurrentProjectId());}catch(Au){Ar="";}Ao=Ar+Ao;}AY="<img src='"+Ao+"'/>";}else{if(AK[AJ]&&AK[AJ].n&&AK[AJ].cni!==undefined){AY=AK[AJ].n;}else{AY=AM.refv[Av].v;}Aj[As].style.fontSize=this.widget.fontSize;}AV=AL.css[AK[AJ].cni].n;}catch(Au){if(!AY){AY=AM.refv[Av].v;}}}if(AV){Aj[As].className=Al.valueCssClass+" "+AV;}else{if(this.valueCssClass){Aj[As].className=Al.valueCssClass+" "+this.valueCssClass;}else{Aj[As].className=Al.valueCssClass;}}Aj[As].innerHTML=AY;}}}if(this.isTreeMode){if(AR.level==0){Aj[As].style.fontWeight="bold";}else{Aj[As].style.fontWeight="";}}}if(this.isTreeMode){var AX=Af.rows[Ax-1];var AN=AX&&AX.treeNode.level<An.treeNode.level;var AQ=Ac!=undefined;var Ab=Ax==0;if(AN||(AQ&&AR.level>0)){var AZ=Aj.length;for(var At=0;At<AZ;At++){if(this.theme==t||this.theme==W){Aj[At].style.boxShadow="0px 5px 3px -3px rgba(0,0,0,0.2) inset";}else{if(this.theme==S||this.theme==A){Aj[At].style.boxShadow="0px 6px 3px -3px rgba(0,0,0,0.5) inset";}}}Aw.style.borderTop="solid 1px rgba(0, 0, 0, 0)";}else{if((AQ&&AR.level==0||Ab)&&(this.theme==t||this.theme==S)){Aw.style.borderTop="solid 1px rgba(0, 0, 0, 0)";}else{var AZ=Aj.length;for(var At=0;At<AZ;At++){Aj[At].style.boxShadow="";}}}}var Ay=Ac?Ac:An;if(this.isTreeMode){if(AR.selected){this.widget.highlightRowByRowInfo(Ay);}else{this.widget.unHighlightRowByRowInfo(Ay);}}else{if(this.widget.isAllAttrSelectable){if(An.selected[-1]){this.widget.highlightRowByRowInfo(An);}else{this.widget.unHighlightRowByRowInfo(An);}}else{this.widget.highlightCellsByRowInfo(An);}}return Aw;}function j(AK){var AJ=AK.rowRef[this.domRefName];if(this.isTreeMode){var AI=AK.treeNode;var AM=AI.level;if(AM==0){if(this.theme==t){AJ.style.backgroundColor="#f9f9f9";AJ.style.color="#191919";AJ.style.borderTop="solid 1px rgba(0, 0, 0, 0.3)";}else{if(this.theme==S){AJ.style.backgroundColor="#333333";AJ.style.color="white";AJ.style.borderTop="solid 1px rgba(255, 255, 255, 0.3)";}else{if(this.theme==A){AJ.style.backgroundColor="";AJ.style.borderTop="solid 1px rgba(255, 255, 255, 0.3)";}else{if(this.theme==W){AJ.style.backgroundColor="";AJ.style.borderTop="solid 1px rgba(0, 0, 0, 0.3)";}}}}AJ.style.font="bold 12pt Helvetica";}else{if(AM==1){if(this.theme==t){AJ.style.backgroundColor="#e5e5e5";AJ.style.color="#4c4c4c";AJ.style.borderTop="solid 1px rgba(0, 0, 0, 0.2)";}else{if(this.theme==S){AJ.style.backgroundColor="#232323";AJ.style.color="#cccccc";AJ.style.borderTop="solid 1px rgba(255, 255, 255, 0.2)";}else{if(this.theme==A){AJ.style.backgroundColor="rgba(255, 255, 255, 0.1)";AJ.style.borderTop="solid 1px rgba(255, 255, 255, 0.2)";}else{if(this.theme==W){AJ.style.backgroundColor="rgba(0, 0, 0, 0.1)";AJ.style.borderTop="solid 1px rgba(0, 0, 0, 0.2)";}}}}AJ.style.font="12pt Helvetica";}else{if(AM==2){if(this.theme==t){AJ.style.backgroundColor="#d1d1d1";AJ.style.color="#333333";AJ.style.borderTop="solid 1px rgba(0, 0, 0, 0.1)";}else{if(this.theme==S){AJ.style.backgroundColor="#0F0F0F";AJ.style.color="#cccccc";AJ.style.borderTop="solid 1px rgba(255, 255, 255, 0.1)";}else{if(this.theme==A){AJ.style.backgroundColor="rgba(255, 255, 255, 0.2)";AJ.style.borderTop="solid 1px rgba(255, 255, 255, 0.1)";}else{if(this.theme==W){AJ.style.backgroundColor="rgba(0, 0, 0, 0.2)";AJ.style.borderTop="solid 1px rgba(0, 0, 0, 0.1)";}}}}AJ.style.font="12pt Helvetica";}else{if(AM>2){var AL=AM>9?1:AM/10;if(this.theme==t){AJ.style.backgroundColor="#BDBDBD";AJ.style.color="#333333";}else{if(this.theme==S){AJ.style.backgroundColor="#000000";AJ.style.color="#cccccc";}else{if(this.theme==A){AJ.style.backgroundColor="rgba(255, 255, 255, "+AL+")";}else{if(this.theme==W){AJ.style.backgroundColor="rgba(0, 0, 0, "+AL+")";}}}}AJ.style.font="12pt Helvetica";AJ.style.borderTop="solid 1px rgba(255, 255, 255, 0.1)";}}}}}else{if(this.theme==t){AJ.style.backgroundColor="#f9f9f9";AJ.style.font="12pt Helvetica";AJ.style.color="#191919";}else{if(this.theme==S){AJ.style.backgroundColor="#333333";AJ.style.font="12pt Helvetica";AJ.style.color="white";}}}}function X(AI){var AJ=this._scroller,AK=this.chartTable,AL=Math.max(this.chartTableOffsetHeight+this.headerTableOffsetHeight-this.getHeight(),0);AJ.origin={x:AI&&AI.x||0,y:AI&&AI.y||0};AJ.showScrollbars=this.showScrollbars;AJ.vScroll=(AL!==0&&AJ.noVScroll!==true)||this.scrollPast;if(AJ.vScroll){AJ.offset={y:{start:0,end:AL},scrollPast:this.scrollPast};}this.utils.translateCSS(-AJ.origin.x,-AJ.origin.y,false,AK);}mstrmojo.VisMicroChartTable=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller,mstrmojo._NeedSyncScroller],{scriptClass:"mstrmojo.VisMicroChartTable",utils:mstrmojo.VisChartUtils,scrollerConfig:{bounces:false,showScrollbars:false,useTranslate3d:false,hScroll:false,vScroll:true},scrollPast:false,colInfos:null,rowTemplate:null,theme:-1,isTreeMode:false,showMinLabel:false,bodyFontColorRGB:null,markupString:'<div id="{@id}-microchart-table" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};z-index:{@zIndex};position:absolute;background-color:{@backgroundColor}"><div id="{@id}-header-bar" class="microchart-header-div" style="width:{@width};"><table id="{@id}-header-table" style="width:{@width};table-layout:fixed;"><tr class="microchart-table-row" ><th style="border:none;text-decoration:none;"></th></tr></table></div><div id="{@id}-chart-table-container" class="microchart-canvas-div" style="position:absolute;overflow:hidden;width:{@width};"><table id="{@id}-charts-body" style="width:{@width};table-layout:fixed"><tr class="microchart-table-row"><td style="border:none;background:transparent;text-decoration:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0px;padding-bottom:0px"></td></tr></table></div><div style="position:absolute;z-index:2;"><table id="{@id}-docked-header" style="width:{@width};table-layout:fixed;position:relative;background-color:white;"><tbody></tody></table><div id="{@id}-docked-header-replace-div" style="width:{@width};position:relative;overflow:hidden"><table id="{@id}-docked-header-replace" style="width:{@width};table-layout:fixed;background-color:white;"><tbody></tody></table></div></div></div>',markupSlots:{headerTable:function(){return this.domNode.childNodes[0].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},chartTable:function(){return this.domNode.childNodes[1].firstChild;},dockedHeaderTable:function(){return this.domNode.childNodes[2].firstChild;},dockedHeaderReplaceDiv:function(){return this.domNode.childNodes[2].lastChild;}},postBuildRendering:function w(){R=(this.widget.otherProps.mRowHeight-1)+"px";P=(this.widget.otherProps.mRowHeight-2)+"px";E=this.utils.getScreenZoomFactor();this.scrollerConfig.scrollEl=this.chartTable;this.scrollerConfig.indicatorEl=this.widget.indicatorEl;this.scrollerConfig.showScrollbars=this.showScrollbars;this._super();this.renderMicroChart();this.updateRowOffsetHeight();this.updateHeaderTableOffsetH();this.updateChartTableOffsetH();X.call(this,this.widget.mcStatus&&this.widget.mcStatus.scrollTo);e.call(this);var AJ=this.widget;if(this._tn){var AI=this._tsCallback;this._tsCallback=function(AK){AJ.closedIfwAttr=null;AI.call(this,AK);};mstrmojo.dom.detachEvent(this._tn,mstrmojo.dom.TOUCHSTART,AI);mstrmojo.dom.attachEvent(this._tn,mstrmojo.dom.TOUCHSTART,this._tsCallback);}},renderMicroChart:function L(){var AK=this.colInfos.length;var AU=this.headerTable;AU.style.font="bold 13pt Helvetica";if(this.theme==t){AU.style.backgroundColor="#B5BDC4";AU.style.color="black";}else{if(this.theme==S){AU.style.backgroundColor="#1C273A";AU.style.color="white";}}if(!this.isAndroidTab){AU.style.height=E*32+"px";AU.style.fontSize=14*E+"px";}var AM=AU.firstChild.firstChild;var AQ=this.chartTable.firstChild;var AT=AQ.firstChild;var AY=AM.firstChild;var AN=AT.firstChild;for(var AP=AU.childNodes.length;AP<AK;AP++){AM.appendChild(AY.cloneNode(true));AT.appendChild(AN.cloneNode(true));}this.rowTemplate=AT;var AR=function(Ad,Ac,Ab){var AZ=0;var Aa=mstrmojo.css.getComputedStyle(Ad);if(Aa.paddingLeft){AZ+=parseFloat(Aa.paddingLeft);}if(Aa.paddingRight){AZ+=parseFloat(Aa.paddingRight);}Ad.style.width=(Ac-AZ)+"px";if(!Ab){Ad.style.height=R;}};var AI=AM.childNodes;var AO=AT.childNodes;if(this.isTreeMode){D.removeClass(AT,"microchart-table-row");D.removeClass(AM,"microchart-table-row");}for(var AP=0;AP<AK;AP++){var AX=this.colInfos[AP];AI[AP].innerHTML=AX.title?AX.title:"";if(AX.padding.l!=undefined){AO[AP].style.paddingLeft=AX.padding.l+"px";}if(AX.padding.r!=undefined){AO[AP].style.paddingRight=AX.padding.r+"px";}AI[AP].className=AX.headerCssClass;if(this.treeColumnIdx==AX.colIdx){var AW=document.createElement("div");AO[AP].appendChild(AW);AW.style.display="";}else{AO[AP].className=AX.valueCssClass+" "+this.valueCssClass;}if(AX.type==V||AX.type==d){this.bodyFontColorRGB=this.valueCssClass&&Q.rgbStr2rgb(mstrmojo.css.getStyleValue(AO[AP],"color"));}AR(AI[AP],AX.colWidth);AR(AO[AP],AX.colWidth);AI[AP].style.wordBreak="break-word";AI[AP].style.whiteSpace="normal";AO[AP].setAttribute("mcol",AX.colIdx);AI[AP].setAttribute("mcol",AX.colIdx);AI[AP].setAttribute("mrow",-1);}for(var AP=0;AP<AK;AP++){var AX=this.colInfos[AP];AX.titleOverflow=this.utils.truncateTextToLineWithWordWrap2(AI[AP],this.textCanvas,2);if(AX.type==C){AX.contentWidth=AO[AP].offsetWidth-AX.padding.l-AX.padding.r;}}var AL=this.widget.otherProps;this.kpiOff=AL.mnMetricsPerKPI;if(!this.widget.isKPI){this.kpiOff=0;}var AV=this.widget;var AS=document.createDocumentFragment();for(var AP=AV.startCnt;AP<AV.endCnt;AP++){var AJ=O.call(this,AP);AS.appendChild(AJ);}AQ.appendChild(AS);AT.style.display="none";if(AL.mbHideColHeaders){this.headerTable.style.display="none";}this.itemsContainerNode.style.top=this.headerTableOffsetHeight+"px";},reRenderRows:function G(AO,AM,AS,AL,AJ){var AN=this.chartTable.firstChild;AN.innerHTML="";var AQ=this.widget;var AP=document.createDocumentFragment();if(AM==undefined){AM=0;AS=0;AL=AQ.startCnt;AJ=AQ.endCnt;}var AR=AQ.rows;if(AM<AL){for(var AK=AM;AK<AS;AK++){var AI=AR[AK].rowRef[this.domRefName];AP.appendChild(AI);}for(var AK=AL;AK<AJ;AK++){var AI=O.call(this,AK);AP.appendChild(AI);}}else{for(var AK=AL;AK<AJ;AK++){var AI=O.call(this,AK);AP.appendChild(AI);}for(var AK=AM;AK<AS;AK++){var AI=AR[AK].rowRef[this.domRefName];AP.appendChild(AI);}}AN.appendChild(AP);this.updateChartTableOffsetH();X.call(this,AO);},updateHeaderTableOffsetH:function I(){if(this.widget.otherProps.mbHideColHeaders){this.headerTableOffsetHeight=0;}else{this.headerTableOffsetHeight=this.headerTable.offsetHeight;}},updateRowOffsetHeight:function J(){this.rowOffsetHeight=this.chartTable.firstChild.lastChild.offsetHeight;},updateChartTableOffsetH:function AB(){this.chartTableOffsetHeight=this.chartTable.firstChild.offsetHeight;},onScrollDone:function p(AI){if(this._super){this._super(AI);}this.widget.onScrollDone(AI);},onScrollMoved:function AH(AI){if(this._super){this._super(AI);}this.widget.onScrollMoved(AI);},initScroller:function h(AI){if(!AI.offset&&this.scrollPast){AI.offset={scrollPast:this.scrollPast};}AI.vScroll=true;if(this._super){this._super(AI);}var AJ=this;},initDHs:function N(){var AI=this.dockedHeaderTable;AI.parentNode.style.top=this.headerTableOffsetHeight+"px";},addRowsToDH:function B(AJ,AM){var AI=this.widget;var AN=null;if(AM){AN=AI.dockedHeaderReplaceRows;}else{AN=AI.dockedHeaderRows;}var AK=document.createDocumentFragment();for(var AL=AN.length-AJ;AL<AN.length;AL++){var AO=O.call(this,AN[AL].rowIdx,AN[AL]);AN[AL].rowRef[this.domRefName]=AO;AK.appendChild(AO);}if(AM){this.dockedHeaderReplaceDiv.firstChild.firstChild.appendChild(AK);}else{this.dockedHeaderTable.firstChild.appendChild(AK);}},removeRowsFromDH:function H(AK,AJ){var AL=this.dockedHeaderTable,AI=AL.firstChild;var AO=this.dockedHeaderReplaceDiv.firstChild.firstChild;if(AK>AI.childNodes.length){AK=AI.childNodes.length;}if(AK>1){AL.removeChild(AI);for(var AN=0;AN<AK;AN++){AI.removeChild(AI.lastChild);}AL.appendChild(AI);}else{if(AK==1){var AM=AI.lastChild;AI.removeChild(AM);if(AJ){AO.appendChild(AM);}}}},moveRowFromDHRplcTableToDH:function q(){var AK=this.dockedHeaderTable,AJ=AK.firstChild;var AL=this.dockedHeaderReplaceDiv.firstChild.firstChild;var AI=AL.firstChild;if(AI){f(AL);AJ.appendChild(AI);}},removeChildrenForDHReplaceTable:function k(){var AI=this.dockedHeaderReplaceDiv.firstChild.firstChild;f(AI);},showDockedHeader:function Y(){this.dockedHeaderTable.parentNode.style.display="block";},hideDockedHeader:function AE(){this.dockedHeaderTable.parentNode.style.display="none";},setTreeArrow:function b(AM,AI){var AL=AM.rowRef[this.domRefName];var AK=AL.childNodes;var AJ=AK[this.treeColumnIdx].firstChild;x.call(this,AJ,AM.treeNode,AI);},scrollTo:function(AI){var AJ=this.chartTable;this.utils.translateCSS(-AI.x,-AI.y,false,AJ);},shouldTouchBubble:function g(AL){var AI=this._scroller,AJ=AL.isVertical;var AK=!!AI.offset&&AI.offset.y.end!==0;return AJ?!AK:this._super(AL);},multiTap:true,touchTap:function(AI){this.widget.touchTap(AI);},touchSelectBegin:function U(AI){this.bubbleTouchEvent(AI);},touchSelectEnd:function Z(AI){this.bubbleTouchEvent(AI);},touchSelectMove:function K(AI){this.bubbleTouchEvent(AI);},multiTouch:true,touchMultiBegin:function(AI){this.bubbleTouchEvent(AI);},touchMultiMove:function(AI){this.bubbleTouchEvent(AI);},touchMultiEnd:function(AI){this.bubbleTouchEvent(AI);},destroy:function z(){delete this.widget;delete this.parent;delete this.rowTemplate;this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidRptMap","mstrmojo.maps.androidmap.AndroidRptMap","mstrmojo.Obj");mstrmojo.maps.AndroidRptMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.AndroidRptMap"});if((typeof (mstrMobileApp)!="undefined")&&(typeof (mstrMobileApp.useNativeMap)!="undefined")&&mstrMobileApp.useNativeMap()){mstrmojo.maps.AndroidRptMap=mstrmojo.maps.androidmap.AndroidRptMap;}else{mstrmojo.maps.AndroidRptMap=mstrmojo.maps.jsmap.AndroidRptMap;}})();(function(){mstrmojo.requiresCls("mstrmojo.maps.jsmap.AndroidDocMap","mstrmojo.maps.androidmap.AndroidDocMap");mstrmojo.maps.AndroidDocMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.AndroidDocMap"});if((typeof (mstrMobileApp)!="undefined")&&(typeof (mstrMobileApp.useNativeMap)!="undefined")&&mstrMobileApp.useNativeMap()){mstrmojo.maps.AndroidDocMap=mstrmojo.maps.androidmap.AndroidDocMap;}else{mstrmojo.maps.AndroidDocMap=mstrmojo.maps.jsmap.AndroidDocMap;}}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.Label","mstrmojo.hash","mstrmojo.array");var O=mstrmojo.hash,L=mstrmojo.array,C=mstrmojo.emptyFn;var B=0,R=1,Q=2,W=3,I=4,S=5,F=6,M=7,Y=8,U=9;var E=2;var V=1,X=3;var K="u;";var P={};P[M]="MetricSlider";P[Y]="MetricQualification";P[U]="SearchBoxSelector";function A(b,a,j,k,l,Z){switch(a){case B:b.idx=O.any(l,true);var e=(typeof (b.idx)==="undefined"||b.idx<0);if(e){if(L.find(Z,"v","-1")<0){Z=[{v:"-1",n:""}].concat(Z);}b.idx="0";}b.unset=!!e;b.options=Z;break;case Y:case M:if(b.updateData){b.updateData({low:j.min,high:j.max,cnt:j.cnt,nov:j.nov},{cs:j.cs,f:j.f,ft:j.ft,qua:j.qt});}b.items=Z;b.selectedIndices=l;break;case U:if(Z&&!k.sos){b.candidates={isComplete:true,items:k.srcid?Z:[]};}if(k.srcid){var f=[],g=j.ces;if(g&&g.constructor===Array){if(k.dfm==V){for(var h=0;h<g.length;h++){if(g[h]["t"]!=X){f.push(g[h]);}}}else{f=g.concat();}}if(!k.sos){var d=mstrmojo.array,o=[];d.forEach(f,function(p){if(d.find(b.candidates.items,"v",p.v)>-1){o.push(p);}});f=o;}b.items=f;}break;default:b.items=Z;b.selectedIndices=l;break;}}mstrmojo.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocSelectorViewFactory",newPulldown:C,attachTargetListeners:C,getSelectorClass:function J(b,a){var Z=P[b];if(Z.constructor===Array){Z=Z[(a)?0:1];}return Z;},isSelectorSupported:function T(){return true;},newSelector:function H(s){var d=s.children,b=d&&d[0],l=s.style,j=s.selIdx,e=s.node,p=e.defn,k=e.data,Z=k.elms,a;if(!this.isSelectorSupported(s)){return null;}if(!b){if(!b){var g=s._cekEvtListener,t=s.id,q;if(g){p.detachEventListener(g);delete s._cekEvtListener;}if(l===B){b=this.newPulldown(s);q=function(w){a=this.options;if(L.find(a,"v",w.value)<0){if(L.find(a,"v","-1")<0){a.unshift({v:"-1",n:""});}b.idx="0";b.options=a;b.unset=true;s._inSyncPhase=true;b.refresh();s._inSyncPhase=false;}else{b.set("value",w.value);}};t=b.id;}else{var o=this.getSelectorCtrlConfig(s,l,p,Z),h=o.scriptClass;if(!h){b=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{delete o.scriptClass;var f=O.walk(h,mstrmojo);b=new f(o);if(l===M){s.attachEventListener("includeChange",b.id,function(w){this.set("include",w.value);this.selectRange();});}if(l===M||l===Y){s.attachEventListener("quaChange",b.id,function(w){this.set("qua",w.value);});q=function(w){if(s.id!==w.value.id){s._inSyncPhase=true;b.updateExpr(w.value);if(s.style===M){s.set("include",w.value.include);}s._inSyncPhase=false;}};}else{q=function(w){var x=[];a=this.node.data.elms;L.forEach(w.value,function(AA){var z=L.find(a,"v",AA);if(z>-1){x.push(z);}});this._inSyncPhase=true;b.select(x);this._inSyncPhase=false;};}}}if(q){s._cekEvtListener=p.attachEventListener("cekChange",t,q);}}s.addChildren(b);}A(b,s.style,k,p,j,Z);return b;},getSelectorCtrlConfig:function N(h,d,f,Z){var j=f.horiz,g=h.getFormats(),k=g&&g.height,a=O.copyProps,b=h.node.data,e={scriptClass:this.getSelectorClass(d,j),multiSelect:f.multi,isHoriz:j,include:f.include,itemWidthMode:f.iwm,allIdx:L.find(Z,"v",K),noneIdx:f.include?-1:L.find(Z,"v",K),renderAllItems:!k,onchange:function(){if(!h._inSyncPhase){h.selectorControlChange(this);}},makeSelection:function(l){if(!h._inSyncPhase){h.showInfoWin(l&&l.selItem);}}};if(e.noneIdx!==-1){e.allIdx=-1;}if(d===R||d===M){h.extCls="extSlider";if(f.cek){f.include=f.cek.include;b.cs=f.cek.cs;b.f=f.cek.f;b.ft=f.cek.ft;h.qua=f.cek.qua;}}if(d===R){a(["height","width"],g,e);}else{if(d===Y||d===M){if(d===M){e.isHoriz=true;e.include=f.include;}a(["height","width","font"],g,e);a(["cs","ft"],f,e);e.fmts=f.f;e.qua=h.qua;e.numFmts=f.numFmts;}else{if(d===U){e={scriptClass:e.scriptClass,cssText:g.height?"height: "+g.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(f.ttl||""),items:f.srcid?(b.ces?b.ces.concat():[]):[],REQUEST_THRESHOLD:55,suggestCount:50,srcid:f.srcid||"",dsrc:f.dsrc||"",onitemsChange:function(){if(!h._inSyncPhase){h.showInfoWin();h.selectorControlChange(this);}}};if(Z&&!f.sos){e.candidates={isComplete:true,items:f.srcid?Z:[]};}else{e.useKeyDelay=true;e.noCache=true;}if(!f.multi){e.maxObjectCount=1;}}}}return e;},updateControlStyles:function D(a){if(a.isInFilterPanel()&&!a.isHorizFP()){var Z=a.style;if(Z===R||Z===Y||M){a.children[0].width=a.parent.parent.contentWidth;}}}});var G=mstrmojo.DocSelectorViewFactory;G.STYLES={PULLDOWN:B,SCROLLER:R,LIST:Q,RADIO:W,CHECKBOX:I,BUTTON:S,LINK:F,METRIC_SLIDER:M,METRIC_QUAL:Y,SEARCH_BOX:U};G.ELEM_ALL=K;G.UC_ON_DS=E;}());(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{item2textCss:function A(C){return(this._super&&this._super(C))||{8704:"u",8705:"ug"}[C.st]||"";},getCandidatesThroughTaskCall:function B(D,C){mstrmojo.ACL.UserDataService.searchUserCandidates(D.pattern,!D.isVerify,D.blockCount,C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndroidXtab");mstrmojo.AndroidXtabStandalone=mstrmojo.declare(mstrmojo.AndroidXtab,null,{scriptClass:"mstrmojo.AndroidXtabStandalone"});}());(function(){mstrmojo.requiresCls("mstrmojo.AndroidXtab","mstrmojo._IsInteractiveGrid","mstrmojo._Formattable","mstrmojo._IsDocXtab");mstrmojo.DocInteractiveGridXtab=mstrmojo.declare(mstrmojo.AndroidXtab,[mstrmojo._IsInteractiveGrid,mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocInteractiveGridXtab",formatHandlers:{domNode:["RW","T","font"],msgNode:["D"],viewport:["D","B","fx"]}});}());(function(){mstrmojo.requiresCls("mstrmojo.AndroidXtab","mstrmojo._IsInteractiveGrid");mstrmojo.AndroidInteractiveGridXtab=mstrmojo.declare(mstrmojo.AndroidXtab,[mstrmojo._IsInteractiveGrid],{scriptClass:"mstrmojo.AndroidInteractiveGridXtab"});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.StackContainer","mstrmojo.CheckList");var Y=mstrmojo.css,K=mstrmojo.array,L=[],H="sharingEditor",A=199,C="294DEDC011D2F1D56000D98E67019608",h="C82C6B1011D2894CC0009D9F29718E4F",E=[1,4,8,16,32,64,128],b=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],f=["B","R","W","D","C","U","E"],T=false,O=true,M=257,g=1024,S=772,P=776,B=777;function d(j){return(j&&j.t===8);}function Z(j){return j&&j.st!=M&&j.st!=g&&j.st!=S&&j.st!=P&&j.st!=B;}function R(j){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[j]||j;}function J(j){return{"253000":255000,"253":255,"32221":223,"56197":199}[j]||j;}function W(s){var q=s.acls,j=s.inhs,p=[],w,l,t,k,o;if(d(s)){q=q.concat(mstrmojo.hash.valarray(j));}for(k=0,o=q.length;k<o;k++){w=q[k];t=w.rgt;if(t>1000){l=mstrmojo.hash.copy(w);l.den=true;l.rgt=Math.floor(t/1000);p.push(l);}if((t%1000)>0){l=mstrmojo.hash.copy(w);l.den=false;l.rgt=t%1000;p.push(l);}}s.acls=p;return s;}function Q(k){var j={isSerializable:function(p,o,l){switch(p){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(p,l,o){if(p==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",k,j);}function F(o,l){var k=o&&o.oi,j;if(k){k=W(k);j=Q(k);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(p){if(l){o.close();}},failure:function(p){mstrmojo.alert(p.getResponseHeader("X-MSTR-TaskFailureMsg"));if(l){o.close();}}},{taskId:"saveObjectACL",objectXML:j,sessionState:mstrApp.sessionState,objectType:k.t,objectID:k.did,propagateToChildren:o.childrenAccessPulldown.value});}}function a(w){var AC=w.aclList,AD=w.objectInputer,x=w.rightPulldown,o=AD.getSelectedObjects(),q=o.length,z=[],l,AB=x.value,k,AA,j;if(!AD.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,w.alertTitle);return false;}for(k=0;k<q;k++){l=o[k];if(l.did===C||l.did===h){var p=mstrmojo.all[H];if(AB===p.currentPublicRight){if(O){Y.removeClass(p.userMessage.domNode,"hideMsg");}}}AA=K.find(AC.items,"did",l.did);if(AA!==-1){j=AC.items[AA];if(w.uneditableRights[j.rgt]){continue;}}z.push(new mstrmojo.Obj({n:l.n,did:l.did,st:l.st,rgt:AB,newItem:true}));}if(z.length>0){var t=K.findMulti(AC.items,"did",z);if(t.count){var s=t.indices.concat().sort(K.numSorter).slice(0,t.count);for(k=s.length-1;k>-1;k--){AC.remove(s[k]);}}AC.add(z);w.set("hasChanged",true);}AD.set("items",[]);return true;}function e(j){var l=[],q=Math.floor(j/1000),o=j%1000,t=E,w=b,p=t.length,x,k;for(k=0;k<p;k++){l.push(w[k]);l.push(" ");if((o&t[k])>0){l.push(mstrmojo.desc(8083,"Granted"));}else{if((q&t[k])>0){l.push(mstrmojo.desc(8084,"Denied"));}else{l.push(mstrmojo.desc(959,"Default"));}}l.push(",");}x=l.join("");return x.substring(x,x.length-1);}function D(w){var p=[],t=w%1000,l=E,q=f,j=l.length,o,k;for(k=0;k<j;k++){if((t&l[k])>0){p.push(q[k]);p.push(",");}}o=p.join("");return o.substring(o,o.length-1);}function X(l,o){var p=l.items,k=K.find(p,l.itemIdField,o),s=l.customItem,j=p.length-2;if(k===-1){var q={n:D(o),rgt:o};if(s){p.splice(j,1);}j=p.length-1;p.splice(j,0,q);l.customItem=q;}else{if(s&&k!==j){p.splice(j,1);l.customItem=null;}}l.set("title",e(o));l.value=o;}function I(j){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[j]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function V(s,q){var p="";if(q){var k=this.widthInput.value,t=this.heightInput.value,j=' src="'+s,w="",l=this.checkBoxList.items,o;for(o=0;o<l.length;o++){if(!this.checkBoxList.selectedIndices.hasOwnProperty(o)){if(w==""){w="&hiddensections="+l[o].alias;}else{w+=","+l[o].alias;}}}p='<iframe width="'+k+'" ';p+='height="'+t+'" ';p+=j;p+=w;p+='"></iframe>';}else{p='<iframe width="640" height="480" src="';p+=s;p+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return p;}function G(k){var o=mstrmojo.string.parseUri(k).queryKey,p=k.indexOf("?"),j=p>0?k.substring(0,p):k;if(o.hasOwnProperty("iframe")){delete o.iframe;}if(o.hasOwnProperty("validateRandNum")){delete o.validateRandNum;}if(!o.hasOwnProperty("server")){o.server=encodeURIComponent(mstrApp.serverName);}if(!o.hasOwnProperty("Project")){o.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!o.hasOwnProperty("port")){o.port=mstrApp.serverPort;}if(T){o.connmode=8;o.ru=1;}o.share=1;j+="?";for(var l in o){j+=l+"="+o[l]+"&";}j=j.substring(0,j.length-1);return j;}function U(o){var j=new Date(),l=this.objectName+" "+j.toLocaleDateString()+" "+j.toLocaleTimeString(),k=this,p={success:function(t){var s=G(t.url);k.linkBox.set("value",s);k.url=s;k.htmlPanel.htmlBox.set("value",V(s));var q=k.tabDock.emailLink;q.set("url",window.escape(s));q.set("name",k.objectName);},failure:function(q){mstrmojo.alert(q.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){k.hideWait();if(o){window.open("mailto:?body="+window.escape(k.url)+"&subject="+k.objectName,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,p,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:l,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function N(o){var k=I(this.oi.st),j=k.length,l;for(l=0;l<j;l++){if(k[l].rgt===o){return k[l].n;}}return mstrmojo.desc(2056,"Custom");}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",hasChanged:false,help:"sharing_dialog_box.htm",zIndex:1000,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),onShowLink:function(k){var j={htmlCode:"showLink",showLink:"htmlCode"};this.tabDock[j[k]].set("selected",false);},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var t=this.oi.acls,l,z=K.find(t,"did",h),q=this.aclList.itemsContainerNode,s=this.publicAccessSection.publicLabel,p,x=false,j=K.find(t,"did",C),w;if(z!==-1&&T&&j!==-1){var k=t[z].rgt,o=t[j].rgt;if(k===o){x=true;w=o;}}if(z!==-1&&!T){x=true;w=t[z].rgt;}p=q.children[0].tBodies;if(T&&p[j]){Y.toggleClass(p[j].rows[0],"hide",x);}if(p[z]){Y.toggleClass(p[z].rows[0],"hide",x);}s.set("checked",x);if(w){this.set("currentPublicRight",w);}},oncurrentPublicRightChange:function(){var j=this.publicAccessSection.publicMouseOver;j.publicRight.set("value",this.currentPublicRight);j.publicRightLabel.set("text",N.call(this,this.currentPublicRight));},onOpen:function(){var k=this.oi.n,t=this.oi.acls;this.objectName=k;this.set("showACL",!!t);T=this.guestModeEnabled;if(this.href&&!this.isLinkDirty){var l=G(this.href),q=this.tabDock.emailLink;this.url=l;q.set("url",window.escape(l));q.set("name",k);this.htmlPanel.htmlBox.set("value",V(l));this.linkBox.set("value",l);}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(k)));var p=this.tabDock;p.showLink.set("selected",false);p.htmlCode.set("selected",false);if(t){this.checkPublicAccess();var s=this.rightPulldown;s.set("items",this.getAvailableRightsForSelection());s.set("value",A);var w=this.objectInputer,o=this.userSelector,j=o&&o.userBrowser;w.zIndex=this.zIndex;if(j&&j.hasRendered){j.set("items",[]);j.getContent(j);}this.set("hasChanged",false);}},_set_hasChanged:function(l,j){var k=(j!==this.hasChanged);this.hasChanged=j;if(j===true){this.checkPublicAccess();}return k;},_set_oi:function(k,j){this.oi=this.preProcessACLs(j);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return I(this.oi.st);},preProcessACLs:function(t){if(t&&t.acls){var q=t.acls,p=q&&q.length,s=d(t),k={},w,j,l,o;if(s){l={};t.inhs=l;}for(o=0;o<p;o++){w=new mstrmojo.Obj(q[o]);if(s&&w.inh){l[w.n]=mstrmojo.hash.copy(w);continue;}j=k[w.n];if(!j){j=mstrmojo.hash.copy(w);j.rgt=0;delete j.den;k[w.n]=j;}j.rgt+=w.den?w.rgt*1000:w.rgt;}q=mstrmojo.hash.valarray(k);t.acls=q;}return t;},onClose:function(){var j=this.objectInputer;j.set("items",[]);this.aclList.clearSelect();},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",updateTreeContent:function(k,o){k.contentRetrieved=true;var l=o[k.itemChildrenField],j=k.tree||k,q=o.bc,p=o.sz,s=o.bb;if(q!==-1){if(s+q<=p){l.push(j.nextItemCreaterFunc());}if((s-q)>-1){l.unshift(j.prevItemCreaterFunc());}}k.blockBegin=s;j.initializing=true;k.clearSelect(false);k.set("items",l);k.setSelectedItems(j.getTotalSelections(),true);j.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(k){var j=this.parent.parent,q=j.opener,p=q.objectInputer,o=j.userBrowser,l=o.getTotalSelections();if(l&&l.length>0){p.add(l,p.items.length-1);}j.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(j){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var s=this.rgt,t=Math.floor(s/1000),q=s%1000,l=this.children,o,p,k,j;for(k=0,j=l.length;k<j;k++){o=l[k];p=o.right;if(this.twoStates){o.set("grayed",false);o.set("checked",false);}else{o.set("grayed",true);o.set("checked",true);}if((t&p)>0){o.set("checked",false);o.set("grayed",false);}if((q&p)>0){o.set("checked",true);o.set("grayed",false);}}},getACLValue:function(){var p=0,q=0,l=this.children,o,k,j;for(k=0,j=l.length;k<j;k++){o=l[k];if(o.grayed||!o.right){continue;}if(o.checked){p+=o.right;}else{q+=o.right;}}return q*1000+p;},children:[{scriptClass:"mstrmojo.TristateCheckBox",alias:"browse",right:1,text:mstrmojo.desc(1825,"Browse")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"read",right:4,text:mstrmojo.desc(8078,"Read")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"write",right:8,text:mstrmojo.desc(8079,"Write")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"delete",right:16,text:mstrmojo.desc(629,"Delete")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"control",right:32,text:mstrmojo.desc(8080,"Control")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"use",right:64,text:mstrmojo.desc(8081,"Use")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"execute",right:128,text:mstrmojo.desc(8082,"Execute")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(j){var k=this.parent.parent;if(k.onOK){k.onOK();}k.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(j){var k=this.parent.parent;if(k.onCancel){k.onCancel();}k.close();}}]}]},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9811,"Sharing Options"),bindings:{visible:function(){return Z(this.parent.oi);}},cssClass:"SharingEditor-title"},{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return Z(this.parent.oi);}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink style="{@cssText} mstrAttach:click>'+mstrmojo.desc(9772,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var j=this.parent.parent;if(!this.url||j.isLinkDirty){U.call(j,true);j.set("isLinkDirty",false);}else{window.open("mailto:?body="+window.escape(j.url)+"&subject="+j.objectName,"mailtoIframe");}}},{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Show Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(j){var k=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!k.url||k.isLinkDirty){U.call(k);k.set("isLinkDirty",false);}k.onShowLink(this.alias);this.set("selected",true);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(j){var k=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!k.url||k.isLinkDirty){U.call(k);k.set("isLinkDirty",false);}k.onShowLink(this.alias);this.set("selected",true);}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(2985,"Width"),value:640,onvalueChange:function(j){var k=this.parent,l=mstrmojo.all[H];k.htmlBox.set("value",V.call(k,l.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(2983,"Height"),alias:"heightInput",value:480,onvalueChange:function(){var j=this.parent,k=mstrmojo.all[H];j.htmlBox.set("value",V.call(j,k.url,true));}},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation Bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools Panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(j){var k=this.parent,l=mstrmojo.all[H];k.htmlBox.set("value",V.call(k,l.url,true));}}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.TextBox",alias:"linkBox",cssClass:"SharingEditor-Link",bindings:{visible:"this.parent.tabDock.showLink.selected"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"[Who has access]"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");}},oncheckedChange:function(){Y.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(T){this.getUserGroupFromTaskCall(C);}this.getUserGroupFromTaskCall(h);},getUserGroupFromTaskCall:function(s){var l=mstrmojo.all[H],o=l.aclList,p=mstrmojo.ACL.UserDataService,q=function(w){var t=new mstrmojo.Obj({n:w.n,did:w.did,st:w.st,rgt:A,newItem:true});L.push(t);},k=function(t){},j=function(){if(!T||(T&&L.length==2)){o.add(L);l.set("hasChanged",true);}};p.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:s}},{success:q,failure:k,complete:j});},onclick:function(){var k=mstrmojo.all[H];var l=k.aclList.items;var o=K.find(l,"did",h);if(o!==-1){l.remove(o);}var j=K.find(l,"did",C);if(T&&j!==-1){l.remove(j);}if(this.checked===true){if(L.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(L,function(p){p.rgt=A;});l.add(L);k.set("hasChanged",true);}}else{k.set("currentPublicRight",A);k.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",bindings:{visible:"this.parent.publicLabel.checked"},children:[{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var j=this.parent.parent.parent;return N.call(j,j.currentPublicRight);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight"},selectionPolicy:"reselect",onvalueChange:function(){var j=this.parent;var k=j.parent.parent;j.publicRightLabel.set("text",N.call(k,this.value));},_set_value:function(q,k){var l=this.value,j=(l!==k);if(j){if(k===-1){var p=this.parent.parent.parent,o=this;p.openPopup("customACL",{zIndex:p.zIndex+10,rgt:l,twoStates:true,onOK:function(){o.set("value",this.getACLValue());},onCancel:function(){o.set("value",l);}});return false;}k=J(k);X(this,k);this.updatePublicRight(k);return true;}return true;},updatePublicRight:function(k){var l=this.parent.parent.parent;if(l.aclList){var o=l.aclList.items;var j=K.find(o,"did",C);var p=K.find(o,"did",h);if(T&&j!==-1){o[j].rgt=k;}if(p!==-1){o[p].rgt=k;}l.set("hasChanged",true);l.set("currentPublicRight",k);}}}]}]},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){Y.addClass(this.domNode,"hideMsg");O=false;}},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(k){var p=this.parent.oi;if(!d(p)){return ;}var q=p.inhs,o=k.value,j=o&&o.length,s,l;for(l=0;l<j;l++){s=o[l].n;delete q[s];}},onadd:function(k){var p=this.parent.oi;if(!d(p)){return ;}var q=p.inhs,o=k.value,j=o&&o.length,s,l;for(l=0;l<j;l++){s=o[l].n;q[s]=mstrmojo.hash.copy(o[l]);q[s].inh=true;}},onACLChanged:function(k){var j=this.parent.oi;this.parent.set("hasChanged",true);if(!d(j)){return ;}j.inhs[k.n]=mstrmojo.hash.copy(k);j.inhs[k.n].inh=true;},columns:[{dataFunction:function(l,j,k){return'<div class="mstrmojo-ACLEditor-user '+(l.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(l.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",children:[{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){return N.call(mstrmojo.all[H],this.parent.parent.data.rgt);}}},{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var j=this.parent.parent.data;this.set("value",j[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(q,k){var l=this.value,j=(l!==k);if(j){if(k===-1){var p=this.parent.parent.dataGrid.parent,o=this;p.openPopup("customACL",{zIndex:p.zIndex+10,rgt:l,twoStates:!!this.parent.parent.data.newItem,onOK:function(){o.set("value",this.getACLValue());},onCancel:function(){o.set("value",l);}});return false;}k=R(k);X(this,k);this.parent.parent.data.set(this.itemIdField,k);if(l!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(j){var k=this.parent.parent.dataGrid;k.remove(this.parent.parent.data);k.parent.set("hasChanged",true);}}]}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.UserInputBox",emptyText:mstrmojo.desc(9151,"Type users or groups here."),noCache:true,onRender:function(){var j=this.parent.parent.parent;if(j){j.objectInputer=this;}}},{scriptClass:"mstrmojo.Pulldown",itemIdField:"rgt",value:199,defaultSelection:0,selectionPolicy:"reselect",onRender:function(){var j=this.parent.parent.parent;if(j){j.rightPulldown=this;}},postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},_set_value:function(q,k){var l=this.value,j=(l!==k);if(j){if(k===-1){var p=this.parent.parent.parent,o=this;p.openPopup("customACL",{zIndex:p.zIndex+10,rgt:l,twoStates:true,onOK:function(){o.set("value",this.getACLValue());},onCancel:function(){o.set("value",l);}});return false;}k=J(k);X(this,k);return true;}return true;}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",onclick:function(j){var k=this.parent.parent.parent;a(k);},text:mstrmojo.desc(2156,"Add")},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-ACLEditor-chooseLabel",onclick:function(j){var k=this.parent.parent.parent;k.openPopup("userSelector",{zIndex:k.zIndex+10});},text:mstrmojo.desc(1825,"Browse")}]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&d(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&d(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),bindings:{enabled:function(){var j=this.parent.parent.oi;return(j.acg&32)>0&&this.parent.parent.hasChanged;}},onclick:function(j){var k=this.parent.parent;if(a(k)){F(k,true);}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Close",onclick:function(j){var k=this.parent.parent;k.close();k.set("hasChanged",false);},bindings:{iconClass:function(){var j=this.parent.parent;if(j.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){var j=this.parent.parent;if(!j.showButtonText){return"";}if(j.hasChanged){return mstrmojo.desc(2140,"Cancel");}return mstrmojo.desc(2102,"Close");}}}]}]});mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch){this.set("selected",this.children[1]);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.children[0]);}},preBuildRendering:function(){this.set("selected",this.children[0]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelectorViewFactory","mstrmojo.android.DropDownList","mstrmojo.android.selectors.CheckList","mstrmojo.android.selectors.ListBox","mstrmojo.android.selectors.LinkBar","mstrmojo.android.selectors.ButtonBar","mstrmojo.android.selectors.Slider","mstrmojo.array");var F=mstrmojo.DocSelectorViewFactory.STYLES;var B={};B[F.RADIO]="CheckList";B[F.CHECKBOX]="CheckList";B[F.LIST]="ListBox";B[F.LINK]="LinkBar";B[F.BUTTON]="ButtonBar";B[F.SCROLLER]="Slider";B["9"]="LinkBar";mstrmojo.android.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.DocSelectorViewFactory,null,{scriptClass:"mstrmojo.android.DocSelectorViewFactory",isSelectorSupported:function A(K){var J=K.node.defn;if(J.ct==="3"){var I=K.tks;if(I&&K.defn.dk){K.model.getLayoutUnitDefn(I,J._lkz).dk=true;return false;}}return true;},newPulldown:function H(I){return new mstrmojo.android.DropDownList({name:I.node.defn.n,postvalueChange:function(){if(!I._inSyncPhase){I.showInfoWin();I.selectorControlChange(this);}}});},updateControlStyles:function G(N){var J=N.getFormats(),L=N.style,M=N.children&&N.children[0];if(!M){return ;}if(J){var I=J.height,K=J.width;if(I!==undefined){M.height=I;}if(K!==undefined){M.width=K;}if(L===F.LINK){var O=N.defn.ssc;if(O){M.selColor=O;}}}this._super(N);},attachTargetListeners:function E(J){this._super(J);if(J.defn.ct==="3"&&this.isSelectorSupported(J)){if(!J._panelEvtListener){var I=J.model.getUnitInstance(J.tks,1);if(I){J._panelEvtListener=I.attachEventListener("panelSelected",J.id,function(K){this._inSyncPhase=true;this.content.singleSelectByField(K.key,"v");this._inSyncPhase=false;});}}}},getSelectorClass:function C(K,J){var I=B[K];return(I&&"android.selectors."+I)||this._super(K,J);},getSelectorCtrlConfig:function D(L,J,I,K){if(J===9){if(K&&K.length===0){K.push({n:"(All)",t:14,v:"u;"});}L.style=J=F.LINK;}return this._super(L,J,I,K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.DocSelectorViewFactory","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper");var L=mstrmojo.array,P=mstrmojo.hash,V=mstrmojo.dom,Y=mstrmojo.DocSelectorViewFactory.STYLES,S=mstrmojo.DocSelectorViewFactory.ELEM_ALL,M=mstrmojo.elementHelper;var F=mstrmojo.DocSelectorViewFactory.UC_ON_DS;function H(){return{type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,disablePU:(parseInt(this.defn.subTp,10)===F)};}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" class="mstrmojo-DocSelector {@extCls}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100; position:absolute; top:0px; left:0px; width:100%; height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onincludeChange:function(){mstrmojo.css.toggleClass(this.domNode,"strikeout",!this.include);},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwaitChange:function(){this.wIconNode.style.display=((this.wait)?"block":"none");}},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",bGetElems:false,init:function U(b){this._super(b);var a=this.node.defn.style;this.spm=(a===Y.METRIC_QUAL||a===Y.METRIC_SLIDER);},initControlInfo:function I(){var e=this.node,f=e.data,j=e.defn,a=f.elms,g=f.ces,b=j.style;var k=["include","ckey","ck","tks","style","multi","showall"];if(!this.bGetElems&&parseInt(j.subTp,10)===F&&b!==Y.SEARCH_BOX){this._fetchAllElems();a=f.elms;}if(b===Y.METRIC_QUAL||b===Y.METRIC_SLIDER){k=k.concat(["srcid","srct"]);this.qua=f.qt;this.dt=f.dt;}this.type=j.ct;var l=j.fmts;if(l){var o=l.width;if(!o||parseInt(o,10)<=0){l.width="95px";}}P.copyProps(k,j,this);var d=this.selIdx={},h=j.multi;if(this.include&&h&&L.find(g,"v",S)>-1){g=a;}if(g){L.forEach(a,function(q,p){if(L.find(g,"v",q.v)>=0){d[p]=true;}});}},resetFormatHandlers:function A(){this.formatHandlers={contentNode:["RW"]};},selectorControlChange:function O(b){var AC=H.call(this),AD="\u001E",d=[],AA=this.style,w=this.defn.sec,x;switch(AA){case Y.PULLDOWN:var s=b.value,q=null;if(b.selectNode){var AB=b.selectNode;q=AB.options[AB.selectedIndex].text;}AC.eid=s;if(parseInt(AC.type,10)===1&&q!==null){AC.eid=AC.eid+";"+q;}this.defn.set("cek",s);this.currSelValue=s;if(w){this.parent.set("count",M.buildElemsCountStr([s],this.node.data.elms));}break;case Y.SEARCH_BOX:L.forEach(b.items,function(AF){d.push(AF.v+";"+AF.n);});if(!d.length&&this.showall){d.push("u;");}AC.eid=d.join(AD);if(w){this.parent.set("count",M.buildElemsCountStr(d,this.node.data.elms));}break;case Y.METRIC_QUAL:case Y.METRIC_SLIDER:if(this.srcid===undefined){return ;}var e=[];L.forEach(b.cs,function(AF){e.push(AF.v);if(AC.dtp===undefined){AC.dtp=AF.dtp;}});if(e.length){AC.cs=e.join(AD);}var a=mstrmojo.MCSUtil.getFuncInfo(b.opId,b.qua);AC.f=b.f=a.f;AC.ft=b.ft=a.ft;AC.include=b.include=this.include;AC.ckey=this.ckey;AC.srcid=this.srcid;AC.srct=this.srct;AC.unset=b.unSet;AC.onlyInclude=b.onlyInclude;AC.changeQual=b.changeQual;AC.qt=b.qua;this.node.defn.set("cek",{id:this.id,f:b.f,ft:b.ft,cs:b.cs,qua:b.qua,include:b.include});break;default:var t=this.node,o=t.data.elms,f=b.selectedIndices,l=b.allIdx,j=!!f[l],h=[],k=this.include;if(j){d=[o[l].v];h=[o[l].v];}else{if(f[l]){f[l]=false;}var z=P.keyarray(f,true).sort(L.numSorter),p={};for(x in z){p[z[x]]=f[z[x]];}f=p;P.forEach(f,function(AG,AF){if(AG){d.push(o[AF].v);h.push(o[AF].v+";"+o[AF].n);}});}AC.eid=((parseInt(AC.type,10)===1)?h:d).join(AD);var g=mstrmojo.dom.position(b.domNode,true);if(g){AC.left=g.x;AC.top=g.y;}if(j&&this.multi&&k){L.forEach(o,function(AG){var AF=AG.v;if(d[0]!==AF){d.push(AF);}});}t.defn.set("cek",d);if(w&&AA!==Y.SCROLLER){this.parent.set("count",M.buildElemsCountStr(d,o));}break;}var AE=this;window.setTimeout(function(){AE.slice(AC);},0);},showInfoWin:function Q(f){var b=this.model,d=b.getTargetInfoWin(this.tks);if(d&&d.length){var k=this.defn.horiz,a=f||this.contentNode,g=V.position(a),j=V.position(this.contentNode),h=(k||this.defn.style==Y.SCROLLER)?null:{x:j.x,y:g.y,w:j.w,h:g.h};for(var e=0;e<d.length;e++){b.showInfoWin(d[e],a,k?"v":"h",false,P.copy(h));}}},preBuildRendering:function G(){var e=true,f=this.node.defn.style,d=P.clone(this.formatHandlers),b=d.contentNode;if(b){if((f===Y.RADIO||f===Y.CHECKBOX)&&d.filterNode){b.push("fx");b.push("background-color");delete d.filterNode;}if(f===Y.LIST){delete b.height;}if(f===Y.SEARCH_BOX){var g=d.domNode;L.removeItem(g,"color");var a=L.indexOf(g,"F");if(a>-1){L.removeIndices(g,a,1);g.push("font");}}}this.formatHandlers=d;e=this._super();this.builder.selectorFactory.updateControlStyles(this);return e;},postBuildRendering:function X(){var d=this.node.defn.style,g=this.filterNode.style,a=this.contentNode,b=this.node.defn;this._super();if(this.formatHandlers.filterNode){var e=this.getFormats();if(!e.width){g.width=a.clientWidth+"px";}if(!e.height){g.height=a.clientHeight+"px";if(d===Y.METRIC_QUAL||d===Y.METRIC_SLIDER){this.updateHeight();}}else{if(d===Y.METRIC_QUAL){a.style.height=e.height;}}}else{g.display="none";}if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(b.ds,10)===0);}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");this.builder.selectorFactory.attachTargetListeners(this);if(V.isAndroid&&d===Y.SCROLLER){a.style.overflow="visible";}return true;},_fetchAllElems:function J(){var a=this.node.defn,e=this.node.data;var f={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:a.srcid||"",dataSourcesXML:a.dsrc||"",browseFlags:1};var d=this,b={success:function(g){d.bGetElems=true;d.set("wait",false);if(g&&g.es){e.elms=(a.srcid)?M.buildElemsTerseID(g.es,a.srcid,true):g.es;var h=d.parent,j=h&&h.parent;if(e.ces&&e.elms&&e.elms.length>0&&h){h.set("count",M.buildElemsCountStr(e.ces,e.elms));}if(d.hasRendered){d.refresh();if(d.isInFilterPanel()){if(h&&h.defn.ttl){h.updateContentHeight();}if(j&&j.refreshFP){j.refreshFP();}}}}},failure:function(g){mstrmojo.alert(g.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.set("wait",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,b,f,false,null,true);},updateHeight:function B(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var a=this.parent;if(a&&(a.defn.ttl!==undefined)&&a.updateContentHeight){a.updateContentHeight();}},onCGBMapChange:function D(b){var a=b.cgbMap;if(!a){return ;}var d=this.tks;P.forEach(this.defn.cgb,function(f){var e=a[f];if(e&&d.indexOf(e)<0){d+="\u001E"+e;}});this.tks=d;},update:function K(f){this.node=f;var j=this.node.defn,b=j.style,a=this.node.data.elms,k=this.parent,e=(b===Y.SCROLLER);if(e&&j.multi){var d=L.find(a,"v",S);if(d>-1){L.removeIndices(a,d,1);}}if(j.sec&&!e&&!j.sos){var g=f.data.ces;if(k&&k.count){if(g&&a&&a.length){k.set("count",M.buildElemsCountStr(g,a));}}}this.initControlInfo();var h=this.content=this.builder.selectorFactory.newSelector(this);if(!h){this.set("visible",false);}},onincludeChange:function E(a){this.node.defn.include=this.include=a.value;if(this.style!==Y.METRIC_SLIDER){this.include=a.value;var b=H.call(this);b.ckey=this.ckey;this.slice(b);}},slice:function R(d){var a=this.model;if(this.isInFilterPanel()){var b=this.getFilterPanel();if(b&&!b.defn.cas){b.bufferSlice(d);return ;}}a.slice(d);},onquaChange:function T(a){this.node.data.qt=a.value;},isInFilterPanel:function N(){var a=this.parent;return(a&&a.isInFilterPanel&&a.isInFilterPanel())||false;},isHorizFP:function Z(){var a=this.parent;return(a&&a.isHorizFP&&a.isHorizFP())||false;},getFilterPanel:function W(){var a=this.parent;return(a&&a.getFilterPanel&&a.getFilterPanel())||null;}});if(!mstrmojo.dom.isIE){var C=mstrmojo.DocSelector.prototype.formatHandlers;C.contentNode=C.filterNode;delete C.filterNode;}}());(function(){mstrmojo.requiresCls("mstrmojo.Vis","mstrmojo.VisMicroChartTable","mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.VisTextTooltip","mstrmojo.hash","mstrmojo.color","mstrmojo.css");var $CLR=mstrmojo.color,$CSS=mstrmojo.css,$HASH=mstrmojo.hash,$forEachHash=$HASH.forEach,$M=Math,$D=mstrmojo.dom;var zf=1;var PAGE_COUNT=5;var TRIANGLE_WIDTH=30;var COMPACT=0;var NORMAL=1;var LARGE=2;var DEFAULT_TH_CSS="border:none;word-break:break-word;white-space:normal;";var DEFAULT_TD_CSS="border:none;background:transparent;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0px;padding-bottom:0px;";var TD_SELECTED_CSS="border:none;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-top:0px;padding-bottom:0px;";var TH_SELECTED_CSS="border:none;word-break:break-word;white-sapce:normal;";var NO_REPLACE=2;var IN_REPLACE=3;var TOP_Z_INDEX=200;var DOCKED_HEADER=0,OTHER_ROW=1;var ROW_AXIS=1,COL_AXIS=2;var DRILLING_ACTION=1,SELECTOR_ACTION=2,HYPERLINK_ACTION=4;var linkCount=0;var attrCount=0;var order=[];var ID_NAME={};var METRIC_INDEX={};var METRICS=[];var models=[];var LEFT_CHART_ROW="leftRow";var RIGHT_CHART_ROW="rightRow";var GFL=1;var CGL=0;var textAlign={left:"microchart-table-text-L",center:"microchart-table-text-M",right:"microchart-table-text-R"};function getParentBkgColor(){var parentNode=this.domNode.parentNode;while(parentNode){var compStyle=mstrmojo.css.getComputedStyle(parentNode);var bkgColor=compStyle.backgroundColor;if(bkgColor){if(bkgColor.indexOf("rgba")>=0){var rgba=this.utils.rgbaStr2rgba(bkgColor);if(rgba&&rgba[4]){return rgba;}}else{if(bkgColor.indexOf("rgb")>=0){var rgb=$CLR.rgbStr2rgb(bkgColor);return rgb;}}}parentNode=parentNode.parentNode;}bkgColor=this.model["background-color"];if(bkgColor){return $CLR.hex2rgb(bkgColor);}return[255,255,255];}var DEFAULT_DARK_THEME=1;var DEFAULT_LIGHT_THEME=2;var CUSTOM_DARK_THEME=3;var CUSTOM_LIGHT_THEME=4;function getUITheme(){var ct=this.model.vp.ct;if(!ct||ct==""){ct="0";}this.theme=parseInt(ct);if(this.theme==0){var rgb=getParentBkgColor.call(this);var opacity=this.otherProps.mfBkgOpacity;rgb=this.utils.getRGBWithOpacity(rgb,opacity);this.backgroundColor=this.utils.rgb2rgbStr(rgb);var brightness=(rgb[0]*299+rgb[1]*587+rgb[2]*114)/1000;if(brightness>150){this.theme=CUSTOM_LIGHT_THEME;}else{this.theme=CUSTOM_DARK_THEME;}}else{if(this.theme==1){this.backgroundColor="#333333";}else{if(this.theme==2){this.backgroundColor="#f9f9f9";}}}this.domNode.style.backgroundColor=this.backgroundColor;}function setDimensionWithDPI(){zf=this.utils.getScreenZoomFactor();var otherProps=this.otherProps;otherProps.mRowHeight=Math.round(zf*otherProps.mRowHeight);TRIANGLE_WIDTH=Math.round(zf*36);this.dropShadowWidth=Math.round(zf*7);paddingForSS=[Math.round(5*zf),Math.round(8*zf),Math.round(10*zf)];colWidthForChart=[Math.round(100*zf),Math.round(150*zf),Math.round(200*zf)];maxColWidthForAttr=[Math.round(120*zf),Math.round(150*zf),Math.round(180*zf)];maxColWidthForMetric=[Math.round(100*zf),Math.round(150*zf),Math.round(200*zf)];adjustWidthForColumnValue=[Math.round(20*zf),Math.round(40*zf),Math.round(80*zf)];}function isScrollableElementTouched(touch){if(this.enableSmoothScroll){var touchPointOnWidget=this.utils.getTouchXYOnWidget(touch.pageX,touch.pageY,this);var x=touchPointOnWidget.touchX,y=touchPointOnWidget.touchY;if(x<this.leftWidth){return false;}return true;}else{return true;}}function setNodeCssText(node,cssText){var height=node.style.height;var width=node.style.width;var textDecoration=node.style.textDecoration;var display=node.style.display;var fontSize=node.style.fontSize;var fontWeight=node.style.fontWeight;var paddingLeft=node.style.paddingLeft;var paddingRight=node.style.paddingRight;var boxShadow=node.style.boxShadow;node.style.cssText=cssText;node.style.height=height;node.style.width=width;node.style.textDecoration=textDecoration;if(display){node.style.display=display;}if(fontSize){node.style.fontSize=fontSize;}if(fontWeight){node.style.fontWeight=fontWeight;}if(paddingLeft){node.style.paddingLeft=paddingLeft;}if(paddingRight){node.style.paddingRight=paddingRight;}if(boxShadow){node.style.boxShadow=boxShadow;}}function init(w){METRICS=[];METRIC_INDEX={};ID_NAME={};order=[];models=[];GFL=1;CGL=0;linkCount=0;attrCount=0;}function initProp(){var sparklineProps=this.sparklineProps={};sparklineProps.mbShow=true;sparklineProps.mbAllPoints=false;sparklineProps.mbEndPoints=true;sparklineProps.mbRefLine=true;sparklineProps.mbRefArea=true;sparklineProps.mbAssMetric=true;sparklineProps.mbShowTooltip=true;sparklineProps.mwSeriesLineCol="#333333";sparklineProps.mwRefLineCol="#0066FF";sparklineProps.mwRefAreaCol="#DEDEDE";sparklineProps.mstrHeader="[Sparkline]";sparklineProps.mstrAssMetric="";var barProps=this.barProps={};barProps.mbShow=false;barProps.mbShowLegend=true;barProps.mbRefLine=true;barProps.mbShowTooltip=true;barProps.mwPosCol="#66CC00";barProps.mwNegCol="#FF0000";barProps.mwRefLineCol="#0066FF";barProps.mstrHeader="[Bar]";var bulletProps=this.bulletProps={};bulletProps.mbShow=true;bulletProps.mbRefLine=true;bulletProps.mbRefBands=true;bulletProps.mbShowLegend=true;bulletProps.mbAssMetric=true;bulletProps.mbInvertAxis=false;bulletProps.mbShowTooltip=true;bulletProps.mfMinValue=0;bulletProps.mwPosCol="#000066";bulletProps.mwNegCol="#FF0000";bulletProps.mwRefLineCol="#0066FF";bulletProps.mwBand1="#999999";bulletProps.mwBand2="#BBBBBB";bulletProps.mwBand3="#DEDEDE";bulletProps.mstrHeader="[Bullet]";bulletProps.mstrAssMetric="";bulletProps.mstrBand1="Low";bulletProps.mstrBand2="Medium";bulletProps.mstrBand3="High";var otherProps=this.otherProps={};otherProps.mfBkgOpacity=1;otherProps.mnMetricsPerKPI=1;otherProps.mbHideColHeaders=false;otherProps.mbHideTextColumns=false;otherProps.mbLockLayout=false;otherProps.mbShowForHiddenGraphs=true;otherProps.mbInheritFromGridGraph=false;otherProps.mbInSingleColumnMode=false;otherProps.mpColumnIDs=[];otherProps.mpColumnIDsInTreeMode=[];otherProps.mpColumnPositions=null;otherProps.mpColumnWidths=null;otherProps.mpSortKey=null;otherProps.mbSortDescend=true;otherProps.mRowHeight=36;}function isTouchedOnWidget(touch){if(!touch){return false;}var me=this;var pos=mstrmojo.dom.position(this.domNode);var x=touch.pageX-pos.x,y=touch.pageY-pos.y;if((x>0&&x<me.getWidth())&&(y>0&&y<me.getHeight())){return true;}return false;}function convertToColor(intString){var colorString=parseInt(intString).toString(16);var len=colorString.length;for(var i=len;i<6;i++){colorString="0"+colorString;}colorString="#"+colorString;return colorString;}function buildNonTreeRows(){this.rows=[];for(var i=0;i<models.length;i++){this.rows[i]={model:models[i],rowIdx:i,selected:{},rowRef:{}};}}function isSubTotal(row,rowTitles){for(var i=0;i<row.length;i++){if(row[i].etk!=undefined&&row[i].etk<0){return true;}}return false;}function getAttrIdxArray(w){var attrIDArray=w.attrIDArray;var m=w.model,gts=m.gts,rows=gts.row;var id=rows[0].id;attrIDArray[0]=id;for(var i=1;i<rows.length;i++){if(id==rows[i].id||id==rows[i].id+":CG"){}else{id=rows[i].id;attrIDArray[i]=id;}}}function getTreeNode(tree,treePath){var treePathArray=treePath.split("_");var treeNode=tree;for(var i=0;i<treePathArray.length;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];}return treeNode;}function getPreSiblingTreeNode(tree,treePath){var treePathArray=treePath.split("_");var lowestLevelIdx=treePathArray[treePathArray.length-1];if(lowestLevelIdx>0){treePathArray[treePathArray.length-1]=lowestLevelIdx-1;var treeNode=tree;for(var i=0;i<treePathArray.length;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];}return treeNode;}else{return null;}return null;}function getParentTreeNodeAtLevel(tree,treePath,level){var treePathArray=treePath.split("_");var treeNode=tree;for(var i=0;i<=level;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];}return treeNode;}function getBoolValue(value){if(value===true||value==="true"){return true;}return false;}function setNeedExpandToLevel(tree,level){if(!tree){return ;}if(tree.level<=level){tree.needExpand=true;}else{tree.needExpand=false;}var treeNodeList=tree.childrenTreeNodeList;for(var j=0;j<treeNodeList.length;j++){setNeedExpandToLevel(treeNodeList[j],level);}}function initTree(){this.tree={};this.tree.childrenTreeNodeList=[];this.tree.needExpand=true;this.tree.treePath="";this.tree.level=-1;this.attrIDArray=[];this.currSelectedObj=[];this.lastSelectedObj=[];this.initDockedHeadersDone=false;}function compareTreePath(src,des){var count=src.length;if(des.length!=count){return false;}for(var i=0;i<count-1;i++){if(src[i]!=des[i].idx){return false;}}return true;}function convertDataToTreeModels(AttrIndexes){var treeNodeList=this.tree.childrenTreeNodeList,model=this.model,rhs=model.ghs.rhs,rowTitles=model.gts.row,gvs=model.gvs,expsTree=model.vp.exps&&model.vp.exps.tree;var allExpanded=expsTree&&getBoolValue(expsTree.allExpanded);var mcStatus=this.mcStatus;var expandToLevel=-1;var expandedEntryArray=mcStatus?mcStatus.expandedEntryArray:expsTree&&expsTree.expandedEntry;this.attrIDArray=[];var attrIdxArray=this.attrMapIdx;getAttrIdxArray(this);var rowAttrCount=rhs.items&&rhs.items[0]&&rhs.items[0].items&&rhs.items[0].items.length;var levelCount=attrIdxArray.length-1;this.maxTreeLevel=levelCount-2;expandToLevel=mcStatus?mcStatus.expandToLevel:allExpanded?this.maxTreeLevel-1:-1;var lastTreePath=[];for(var i=0;i<rowAttrCount;i++){lastTreePath.push(-1);}var modelIdx=-1;var gridRowCount=rhs.items.length;if(this.mcStatus&&this.mcStatus.currSelectedObj){this.currSelectedObj=this.mcStatus.currSelectedObj;}for(var i=0;i<gridRowCount;i++){var currRow=rhs.items[i].items;var sameAsLastRow=compareTreePath(lastTreePath,currRow);if(!sameAsLastRow){modelIdx++;}else{continue;}for(var j=0;j<levelCount-1;j++){var attrIdx=attrIdxArray[j];var currSelectedNodeID=this.currSelectedObj[j];if(lastTreePath[attrIdx]!=currRow[attrIdx].idx){var isSubtotal=isSubTotal(currRow);var addToNodeList=treeNodeList;var lastSameNode=null;var treePath="";for(var k=1;k<=j;k++){var treeNodeIdx=addToNodeList.length-1;if(k==j){lastSameNode=addToNodeList[treeNodeIdx];}addToNodeList=addToNodeList[treeNodeIdx].childrenTreeNodeList;treePath+=treeNodeIdx;treePath+="_";}if(isSubtotal&&lastSameNode){lastSameNode.model=models[modelIdx];break;}else{var newTreeNode={};newTreeNode.es=[];newTreeNode.es.push(rowTitles[j].es[currRow[attrIdx].idx]);var elem=rowTitles[j].es[currRow[attrIdx].idx];newTreeNode.id=elem.id;newTreeNode.n=elem.n;newTreeNode.model=models[modelIdx];newTreeNode.selected=false;newTreeNode.childrenTreeNodeList=[];newTreeNode.attrElemIdx=currRow[attrIdx].idx;newTreeNode.isLeaf=(j==this.maxTreeLevel);newTreeNode.level=j;var preSiblingCount=addToNodeList.length;newTreeNode.preSiblingCount=preSiblingCount;newTreeNode.preSibling=preSiblingCount>0?addToNodeList[preSiblingCount-1]:null;treePath+=addToNodeList.length;newTreeNode.treePath=treePath;addToNodeList.push(newTreeNode);newTreeNode.needExpand=j<=expandToLevel?true:false;if(currSelectedNodeID==newTreeNode.id){this.currSelectedObj[j]=newTreeNode;}}}}for(var j=0;j<rowAttrCount;j++){lastTreePath[j]=currRow[j].idx;}}if(expandToLevel<0&&expandedEntryArray){for(var i=0;i<expandedEntryArray.length;i++){var expandedEntry=expandedEntryArray[i];var treeNode=this.tree;for(var j=0;j<expandedEntry.length;j++){var eid=expandedEntry[j].element;var idx=mstrmojo.array.find(treeNode.childrenTreeNodeList,"id",eid);if(idx<0){break;}treeNode=treeNode.childrenTreeNodeList[idx];}treeNode.needExpand=true;}}var preOrderTreeNodeQueue=[];preOrderTreeNodeQueue.push(this.tree);var treeNode=null;while(preOrderTreeNodeQueue.length>0){treeNode=preOrderTreeNodeQueue.pop();var treeNodeList=treeNode.childrenTreeNodeList;var childrenCount=treeNodeList.length;for(var i=childrenCount-1;i>=0;i--){treeNode=treeNodeList[i];preOrderTreeNodeQueue.push(treeNode);treeNode.postSiblingCount=childrenCount-treeNode.preSiblingCount;}}}var ATTR_NAME=0,METRIC_NAME=1,METRIC_VALUE=2,CHART=3,TREE_TRIANGLE=4;DROP_SHADOW=5;function scaleColumnWidthToFitWidget(colInfos,fitToWidth){var colLen=colInfos.length;var totalWidth=0;for(var i=0;i<colLen;i++){if(colInfos[i].type==TREE_TRIANGLE){fitToWidth-=TRIANGLE_WIDTH;}else{totalWidth+=colInfos[i].colWidth;}}var scaleRatio=fitToWidth/totalWidth;for(var i=0;i<colLen;i++){if(colInfos[i].type==TREE_TRIANGLE){colInfos[i].colWidth=TRIANGLE_WIDTH;}else{colInfos[i].colWidth=Math.round(colInfos[i].colWidth*scaleRatio);}}return scaleRatio;}function getContentOffsetWidth(rows,rowIdx,colIdx){var rowInfo=rows[rowIdx],curM=rowInfo.model,elms=curM.elms,treeNode=rowInfo.treeNode,colInfos=this.colInfos,rowIdx=rowInfo.rowIdx,colCount=colInfos.length,colInfo=colInfos[colIdx],colIdx=colInfo.colIdx;if(colInfo.type==ATTR_NAME||colInfo.type==METRIC_NAME){if(this.isTreeMode){var attrName="";for(var k=0;k<treeNode.es.length;k++){attrName+=treeNode.es[k].n;}if(attrName.indexOf("&lt;")>=0){attrName=attrName.replace(/&lt;/g,"<");attrName=attrName.replace(/&gt;/g,">");}return this.getTextWidth(attrName,colInfo.valueCssClass,null,null,null,treeNode.level==0?true:false);}else{attr=elms[colInfo.order];var attrName=attr?attr.n:"";if(attrName.indexOf("&lt;")>=0){attrName=attrName.replace(/&lt;/g,"<");attrName=attrName.replace(/&gt;/g,">");}return this.getTextWidth(attrName,colInfo.valueCssClass,null,null,null,false);}}if(colInfo.type==METRIC_VALUE){var metricIdx=-1;var idx=-1;if(this.isKPI){idx=parseInt(colInfo.order)%this.otherProps.mnMetricsPerKPI;var metricIdx=rowInfo.model.metricIdx+idx;}else{if(colInfo.type==METRIC_VALUE){metricIdx=parseInt(colInfo.order);idx=metricIdx;}}var innerHTML="";var cssClass="";if(curM.refv[idx].ti===undefined){if(curM.refv[idx].ts===4){innerHTML="<img src='"+curM.refv[idx].v+"'/>";}else{innerHTML=curM.refv[idx].v;}}else{try{var model=this.model;var th=model.th[""+metricIdx];var ti=curM.refv[idx].ti;if(curM.refv[idx].ty===4){var path;if(th[ti]&&th[ti].n){path=th[ti].n;}else{path=curM.refv[idx].v;}if(path.indexOf(":")>=0){}else{var baseURL;try{baseURL=mstrApp.getConfiguration().getHostUrlByProject(mstrApp.getCurrentProjectId());}catch(err){baseURL="";}path=baseURL+path;}innerHTML="<img src='"+path+"'/>";}else{if(th[ti]&&th[ti].n&&th[ti].cni!==undefined){innerHTML=th[ti].n;}else{innerHTML=curM.refv[idx].v;}}cssClass=model.css[th[ti].cni].n;}catch(err){if(!innerHTML){innerHTML=curM.refv[idx].v;}}}var className="";if(cssClass){className=colInfo.valueCssClass+" "+cssClass;}else{if(this.valueCssClass){className=colInfo.valueCssClass+" "+this.valueCssClass;}else{className=colInfo.valueCssClass;}}return this.getTextWidth(innerHTML,className,null,null,null,this.isTreeMode&&treeNode.level==0?true:false);}return 0;}var paddingForSS=[5,8,10];var colWidthForChart=[100,150,200];var maxColWidthForAttr=[120,150,180];var maxColWidthForMetric=[100,150,200];var adjustWidthForColumnValue=[20,40,80];function updateColumnWidth(){var colInfos=this.colInfos,width=this.getWidth();if(this.enableSmoothScroll){var rows=this.isTreeMode?getTreeNodeRows.call(this,true,50):this.rows;var rowCount=Math.min(rows.length,50);var mcs=this.metricColumnsSpacing;var paddingWidth=paddingForSS[mcs];for(var j=0;j<this.colInfos.length;j++){var colInfo=this.colInfos[j];if(colInfo.type==ATTR_NAME||colInfo.type==METRIC_NAME||colInfo.type==METRIC_VALUE){var maxColumnValueW=0;for(var i=0;i<rowCount;i++){var columnW=getContentOffsetWidth.call(this,rows,i,j);if(columnW>maxColumnValueW){maxColumnValueW=columnW;}}var headerStr=colInfo.title;var midPos=Math.round(headerStr.length/2);var leftHalf=headerStr.slice(0,midPos);var rightHalf=headerStr.slice(midPos);var leftW=this.getTextWidth(leftHalf,colInfo.headerCssClass,null,null,null,true,false);var rightW=this.getTextWidth(rightHalf,colInfo.headerCssClass,null,null,null,true,false);var maxColumnHeaderW=Math.max(leftW,rightW);var finalColumnW=0;if(maxColumnValueW>maxColumnHeaderW){finalColumnW=Math.min(maxColumnValueW,maxColWidthForMetric[mcs]);}else{finalColumnW=Math.min(maxColumnValueW+adjustWidthForColumnValue[mcs],maxColumnHeaderW,100);}colInfo.colWidth=Math.round(finalColumnW+paddingWidth);colInfo.padding.l=Math.floor(paddingWidth/2);colInfo.padding.r=Math.ceil(paddingWidth/2);}else{if(colInfo.type==TREE_TRIANGLE){colInfo.colWidth=Math.round(TRIANGLE_WIDTH);}else{if(colInfo.type==DROP_SHADOW){colInfo.colWidth=Math.round(this.dropShadowWidth);}else{colInfo.colWidth=Math.round(colWidthForChart[mcs]+paddingWidth);colInfo.padding.l=Math.floor(paddingWidth/2);colInfo.padding.r=Math.ceil(paddingWidth/2);}}}}this.leftWidth=0;for(var i=0;i<this.attrColumnCount;i++){this.leftWidth+=colInfos[i].colWidth;}this.rightWidth=0;var maxMetricWidth=0;for(var i=this.attrColumnCount;i<colInfos.length;i++){console.log(i+": "+colInfos[i].colWidth);this.rightWidth+=colInfos[i].colWidth;if(colInfos[i].colWidth>maxMetricWidth){maxMetricWidth=colInfos[i].colWidth;}}if(this.leftWidth+this.rightWidth<this.getWidth()){var scaleRatio=scaleColumnWidthToFitWidget(this.colInfos,this.getWidth());this.dropShadowDiv.style.display="none";this.enableSmoothScroll=false;this.scrollerConfig.hScroll=false;this.leftWidth=this.getWidth();this.rightWidth=0;this.leftChart.style.width=this.getWidth()+"px";}else{if(this.attrColumnCount>=0){var spaceCol={order:"",type:DROP_SHADOW,title:"",titleAlign:textAlign.center,colWidth:this.dropShadowWidth,padding:{},headerCssClass:this.headerCssClass,valueCssClass:"",colIdx:this.colInfos.length};this.colInfos.splice(this.attrColumnCount,0,spaceCol);this.rightWidth+=this.dropShadowWidth;}var requiredSpace=this.leftWidth+maxMetricWidth+this.dropShadowWidth;if(this.getWidth()<requiredSpace){var rightContainWidth=Math.min(maxMetricWidth+this.dropShadowWidth,0.75*this.getWidth());this.leftWidth=this.getWidth()-rightContainWidth;var attrWidth=this.treeColumnIdx>-1?(this.leftWidth-TRIANGLE_WIDTH)/(this.attrColumnCount-1):this.leftWidth/this.attrColumnCount;for(var i=0;i<this.attrColumnCount;i++){colInfos[i].colWidth=colInfos[i].type==TREE_TRIANGLE?TRIANGLE_WIDTH:attrWidth;}}this.dropShadowDiv.style.display="block";this.scrollerConfig.hScroll=true;this.leftChart.style.width=this.leftWidth+"px";this.rightChart.style.width=this.rightWidth+"px";this.itemsContainerNode.style.width=(this.getWidth()-this.leftWidth)+"px";this.itemsContainerNode.style.left=this.leftWidth+"px";}for(var i=0;i<this.colInfos.length;i++){this.colInfos[i].colIdx=i;if(this.colInfos[i].type==TREE_TRIANGLE){this.treeColumnIdx=i;}}}else{var colLen=colInfos.length;if(this.otherProps.mpColumnWidths.length>0){scaleColumnWidthToFitWidget(this.colInfos,width);}else{if(this.treeColumnIdx>-1){colLen--;width-=TRIANGLE_WIDTH;}var chWidth=Math.round(width/colLen);for(var i=0;i<colInfos.length;i++){if(colInfos[i].type==TREE_TRIANGLE){colInfos[i].colWidth=TRIANGLE_WIDTH;}else{colInfos[i].colWidth=chWidth;}}}}}function buildColInfos(metricColIdx){var m=this.model,rows=m.gts.row,cols=m.gts.col,mes=cols[metricColIdx].es,propValue=m.vp?m.vp:{},width=this.getWidth(),otherProps=this.otherProps;otherProps.mpColumnWidths=propValue.cw?propValue.cw.split(","):(propValue.tcw?propValue.tcw.split(","):[]);var columnWidths=otherProps.mpColumnWidths;if(columnWidths.length!=order.length){columnWidths=[];otherProps.mpColumnWidths=[];}this.colInfos=[];this.showGauge=false;for(var i=0;i<order.length;i++){if(order[i]=="GaugeChart"){this.showGauge=true;}}for(var i=0,colInfoIdx=0;i<order.length;i++){var orderID=order[i];var colInfo={order:orderID,colWidth:0,padding:{},headerCssClass:" ",valueCssClass:" "};if(orderID=="LineChart"){colInfo.type=CHART;colInfo.title=this.sparklineProps.mstrHeader;colInfo.titleAlign=textAlign.center;colInfo.padding.l=Math.round(3*zf);colInfo.padding.r=Math.round(3*zf);}else{if(orderID=="BarChart"){colInfo.type=CHART;colInfo.title=this.barProps.mstrHeader;colInfo.titleAlign=textAlign.center;colInfo.padding.l=Math.round(3*zf);colInfo.padding.r=Math.round(3*zf);}else{if(orderID=="GaugeChart"){colInfo.type=CHART;colInfo.title=this.bulletProps.mstrHeader;colInfo.titleAlign=textAlign.center;colInfo.padding.l=Math.round(3*zf);colInfo.padding.r=Math.round(3*zf);}else{if(orderID=="Metric"){if(otherProps.mbHideTextColumns){this.treeColumnIdx=-1;continue;}colInfo.type=METRIC_NAME;colInfo.title=mstrmojo.desc(1158,"Metrics");colInfo.titleAlign=textAlign.left;colInfo.valueCssClass+=" "+this.valueCssClass;if(cols[metricColIdx].lm&&cols[metricColIdx].lm.length>0){colInfo.lm=cols[metricColIdx];linkCount++;}}else{if(orderID!=parseInt(orderID)){if(otherProps.mbHideTextColumns){this.treeColumnIdx=-1;continue;}colInfo.associateAttr=[];if(this.isTreeMode){this.treeColumnIdx=colInfoIdx;this.colInfos[colInfoIdx]={order:orderID,type:TREE_TRIANGLE,title:"",titleAlign:textAlign.center,colWidth:0,padding:{},headerCssClass:this.headerCssClass,valueCssClass:"",colIdx:this.treeColumnIdx};colInfo.associateAttr.push(colInfoIdx);colInfoIdx++;}colInfo.type=ATTR_NAME;colInfo.title=ID_NAME[orderID];colInfo.titleAlign=textAlign.left;colInfo.valueCssClass+=" "+this.valueCssClass;for(var j=0;j<rows.length;j++){if(orderID.split(":")[0]==rows[j].id){if(otherProps.mbInheritFromGridGraph&&rows[j].cni!==undefined&&m.css.length>rows[j].cni){colInfo.titleAlign=m.css[rows[j].cni].n;}var isFirstAttrForm=(orderID==rows[j].id+":"+rows[j].fid);if(isFirstAttrForm){attrCount++;}if(rows[j].lm&&rows[j].lm.length>0&&rows[j].lm[0].links){colInfo.lm=rows[j];if(isFirstAttrForm){linkCount++;}}var fs=rows[j].fs;for(var q=0;q<fs.length;q++){var attrID=rows[j].id+":"+fs[q].id;if(attrID==orderID){continue;}else{for(var n=0;n<order.length;n++){if(order[n]==attrID){colInfo.associateAttr.push(n);break;}}}}break;}}}else{colInfo.type=METRIC_VALUE;var index=parseInt(orderID);if(index>=mes.length){continue;}if(otherProps.mbInheritFromGridGraph&&mes[index].cni!==undefined&&m.css.length>mes[index].cni){colInfo.titleAlign=m.css[mes[index].cni].n;}else{colInfo.titleAlign=textAlign.right;}if(orderID=="0"){if(this.sparklineProps.mstrAssMetric){colInfo.title=this.sparklineProps.mstrAssMetric;}else{if(this.isKPI){colInfo.title="";}else{colInfo.title=mes[index].n;}}}else{if(orderID=="2"){if(this.bulletProps.mstrAssMetric){colInfo.title=this.bulletProps.mstrAssMetric;}else{if(this.isKPI&&this.showGauge){colInfo.title="";}else{colInfo.title=mes[index].n;}}}else{colInfo.title=mes[index].n;}}if(cols[metricColIdx].lm[index].links){colInfo.lm=cols[metricColIdx];linkCount++;}}}}}}colInfo.valueCssClass+=" microchart-table-text "+colInfo.titleAlign;colInfo.headerCssClass+=" microchart-table-text "+colInfo.titleAlign+" "+this.headerCssClass;if(columnWidths.length>0){colInfo.colWidth=parseFloat(columnWidths[i]);}colInfo.colIdx=colInfoIdx;this.colInfos[colInfoIdx++]=colInfo;}if(order.length==0){colInfos[0].title=rows[0].n;for(var i=1;i<rows.length-GFL;i++){colInfos[i].title=rows[i].n;}}if(this.enableSmoothScroll){var belongToLeft=function(type){switch(type){case ATTR_NAME:return -1;case TREE_TRIANGLE:return -1;case METRIC_NAME:return -1;default:return 1;}};var sortFunc=function(colInfo1,colInfo2){if(belongToLeft(colInfo1.type)*belongToLeft(colInfo2.type)>0){return colInfo1.colIdx<colInfo2.colIdx?-1:1;}else{return belongToLeft(colInfo1.type);}};this.colInfos.sort(sortFunc);for(var i=0;i<this.colInfos.length;i++){if(belongToLeft(this.colInfos[i].type)>0){this.attrColumnCount=i;break;}}}}function convertDataToModels(){init(this);var m=this.model,cols=m.gts.col,metricL=m.gts.col[0].es.length,rows=m.gts.row,rowL=rows.length,rl=m.gvs.items.length,propValue=m.vp?m.vp:{};if(rowL===0||metricL===0||cols.length>1){var errmsg="The widget requires at least two attributes on row axis and one metrics in column axis OR exactly one attribute on row axis and at least one metric on column axis for KPI List mode.";m.err=mstrmojo.desc(8424,errmsg);return ;}if(this.isTreeMode){var row=this.model.gts.row;if(row.length<3){this.isTreeMode=false;}}var len=rows.length;var gfid=rows[len-1].id;len=len-2;while(len>=0){if(gfid==rows[len].id){GFL++;len--;}else{break;}}if(rowL<=GFL){this.isKPI=true;}for(var i=0;i<rows.length;i++){if(rows[i].otp==1){rows[i].otp=-1;while(++i<rows.length&&rows[i].otp==1){rows[i].id+=":CG";rows[i].n=" ";rows[i].otp=-1;}}}for(var i=0;i<rows.length;i++){if(rows[i].fs&&rows[i].fs.length>0){for(var q=0;q<rows[i].fs.length;q++){if(q==0){ID_NAME[rows[i].id+":"+rows[i].fs[q].id]=rows[i].n;}else{ID_NAME[rows[i].id+":"+rows[i].fs[q].id]=" ";}}}if(rows[i].fid&&rows[i].fid.length>0){var headerTitle;headerTitle=rows[i].n;ID_NAME[rows[i].id]=headerTitle;ID_NAME[rows[i].id+":"+rows[i].fid]=headerTitle;}else{ID_NAME[rows[i].id]=rows[i].n;}}var metricIdx=-1;for(var i=0;i<cols.length;i++){if(cols[i].n="Metrics"){metricIdx=i;var mes=cols[i].es;for(var j=0;j<mes.length;j++){ID_NAME[mes[j].oid]=mes[j].n;METRIC_INDEX[mes[j].n]=j;METRIC_INDEX[mes[j].oid]=j;METRICS[j]=mes[j].n;}}}var orderValid=true;if(!propValue.co&&!propValue.tco){orderValid=false;}else{order=propValue.tco?propValue.tco.split(","):propValue.co.split(",");orderValid=processAndCheckOrderValid.call(this);if(!orderValid){propValue.cw=null;propValue.tcw=null;}}if(!orderValid){order=[];if(!this.isKPI){createNonKPIDefaultCol.call(this);}else{createKPIDefaultCol.call(this);}}var otherProps=this.otherProps;if(otherProps.mpSortKey&&otherProps.mpSortKey.length>0){var tempSortKey="";for(var i=0;i<otherProps.mpSortKey.length;i++){if(otherProps.mpSortKey[i]=="_"){break;}tempSortKey+=otherProps.mpSortKey[i];}var mIdx=METRIC_INDEX[tempSortKey];if(mIdx>=0){otherProps.mpSortKey=mIdx;}else{for(var id in ID_NAME){if(ID_NAME[id]==tempSortKey){otherProps.mpSortKey=id;break;}}if(!ID_NAME[otherProps.mpSortKey]){otherProps.mpSortKey=null;}}}else{otherProps.mpSortKey=null;}if(otherProps.mbInheritFromGridGraph&&(this.theme==CUSTOM_DARK_THEME||this.theme==CUSTOM_LIGHT_THEME)){try{var headerIndex=m.headercni?m.headercni:0;var valueIndex=m.valuecni?m.valuecni:(m.css.length-1);var getCssClass=function(name){if(name){return name;}return"";};this.headerCssClass=getCssClass(m.css[headerIndex].n);this.valueCssClass=getCssClass(m.css[valueIndex].n);if(this.valueCssClass&&this.valueCssClass.length>0){var textSpan=this.textSpan;textSpan.className=this.valueCssClass;textSpan.style.font="";this.fontSize=mstrmojo.css.getStyleValue(textSpan,"fontSize");}var fontHeight=this.getTextHeight("a",this.valueCssClass,true);if(fontHeight>otherProps.mRowHeight){otherProps.mRowHeight=fontHeight;}}catch(err){}}var applyLocale=function(proOwner,proName,dftStr,hasBracket,descID){var compareStr=dftStr;var returnStr;if(hasBracket){compareStr="["+dftStr+"]";}if(proOwner[proName]===compareStr){returnStr=mstrmojo.desc(descID,dftStr);if(hasBracket){returnStr="["+returnStr+"]";}proOwner[proName]=returnStr;}};buildColInfos.call(this,metricIdx);if(!this.isKPI){convertAttributeDrivenData(this);}else{convert(this);}var kpi=otherProps.mnMetricsPerKPI;var m=this.model;if(this.isKPI&&metricL<kpi){var errmsg="Metric per KPI should be at least 1 or less than or equal to the total number of Metrics in the widget";m.err=errmsg;return ;}if(models.length==0){var errmsg="No data returned for this view, this might be because the applied filter excludes all data";m.err=errmsg;return ;}this.buildRows();updateColumnWidth.call(this);this.showMinLabel=bulletShowMinLabel.call(this);}function processAndCheckOrderValid(){for(var i=0;i<order.length;i++){if(order[i]=="LineChart"||order[i]=="BarChart"||order[i]=="GaugeChart"||order[i]=="Metric"){continue;}if(order[i].length<3){return false;}var tstStr=order[i];var len=tstStr.length;if(tstStr[len-2]=="|"){order[i]=tstStr=tstStr.substring(0,len-2);}if(!ID_NAME[tstStr]){return false;}else{if(METRIC_INDEX[tstStr]!==undefined){order[i]=METRIC_INDEX[tstStr]+"";}else{if(this.isKPI){order[i]="0";}}}}if(this.enableSmoothScroll){return false;}var m=this.model,metricES=m.gts.col[0].es;var columnIDs=[],cIDs=[];if(this.isTreeMode){columnIDs=this.otherProps.mpColumnIDsInTreeMode;if(columnIDs.length==1){return false;}for(var i=0;i<metricES.length;i++){var metricID=metricES[i].oid;cIDs.push(metricID);}}else{columnIDs=this.otherProps.mpColumnIDs;if(this.isKPI){if(columnIDs.length<=1){return false;}cIDs.push("Metric");var metricPerKPI=this.otherProps.mnMetricsPerKPI;if(metricPerKPI>2){for(var i=0;i<metricPerKPI;i++){if(i%metricPerKPI<=1){continue;}var metricID=metricES[i].oid;cIDs.push(metricID);}}}else{if(columnIDs.length==1){return false;}var rows=m.gts.row,attrCnt=rows.length-1,rowHeaderCnt=0;for(var i=0;i<attrCnt;i++){var attr=rows[i],attrFormCnt=attr.fs&&attr.fs.length;cIDs.push(attr.id);for(var j=1;j<attrFormCnt;j++){cIDs.push(attr.fs[j].id);}rowHeaderCnt+=attrFormCnt;}for(var i=0;i<metricES.length;i++){var metricID=metricES[i].oid;cIDs.push(metricID);}}}if(cIDs.length!=columnIDs.length){return false;}for(var i=0;i<cIDs.length;i++){var metricID=cIDs[i];if(mstrmojo.array.indexOf(columnIDs,metricID)==-1){return false;}}return true;}function createKPIDefaultCol(){var ind=0;var otherProps=this.otherProps,sparklineProps=this.sparklineProps,barProps=this.barProps,bulletProps=this.bulletProps;order[ind++]="Metric";var kpi=otherProps.mnMetricsPerKPI;if(isNaN(kpi)){kpi=1;}var firstChartShow=false;if(sparklineProps.mbShow){firstChartShow=true;order[ind++]="LineChart";}if(barProps.mbShow){firstChartShow=true;order[ind++]="BarChart";}if((!firstChartShow&&otherProps.mbShowForHiddenGraphs)||(firstChartShow&&sparklineProps.mbAssMetric)){order[ind++]="0";}if(kpi>=7){if(bulletProps.mbShow){if(bulletProps.mbAssMetric){order[ind++]="2";}order[ind++]="GaugeChart";}else{if(otherProps.mbShowForHiddenGraphs){for(var i=3;i<=kpi&&i<=7;i++){order[ind++]=""+(i-1);}}}for(var i=8;i<=kpi;i++){order[ind++]=""+(i-1);}}else{for(var i=3;i<=kpi;i++){order[ind++]=""+(i-1);}}}function createNonKPIDefaultCol(){var ind=0;var m=this.model,rows=m.gts.row,cols=m.gts.col;var mtrcNum=0;if(this.isTreeMode){order[ind++]=rows[0].id;}else{for(var i=0;i<rows.length-GFL;i++){if(rows[i].fs&&rows[i].fs.length>0){for(var q=0;q<rows[i].fs.length;q++){order[ind++]=rows[i].id+":"+rows[i].fs[q].id;}}else{if(rows[i].fid&&rows[i].fid.length>0){order[ind++]=rows[i].id+":"+rows[i].fid;}else{order[ind++]=rows[i].id;}}}}for(var i=0;i<cols.length;i++){if(cols[i].n="Metrics"){mtrcNum=cols[i].es.length;}}var firstChartShow=false;if(this.sparklineProps.mbShow){firstChartShow=true;order[ind++]="LineChart";}if(this.barProps.mbShow){firstChartShow=true;order[ind++]="BarChart";}if((!firstChartShow&&this.otherProps.mbShowForHiddenGraphs)||(firstChartShow&&this.sparklineProps.mbAssMetric)){order[ind++]="0";}if(mtrcNum>=7){if(this.bulletProps.mbShow){if(this.bulletProps.mbAssMetric){order[ind++]="2";}order[ind++]="GaugeChart";}else{if(this.otherProps.mbShowForHiddenGraphs){for(var i=3;i<=7&&i<=mtrcNum;i++){order[ind++]=""+(i-1);}}}for(var i=8;i<=mtrcNum;i++){order[ind++]=""+(i-1);}}else{for(var i=3;i<=mtrcNum;i++){order[ind++]=""+(i-1);}}}function convertAttributeDrivenData(w){var m=w.model,metricES=m.gts.col[0].es,rows=m.gts.row,gvsRows=m.gvs.items,rl=m.gvs.items.length,rhs=m.ghs.rhs.items;var rowsLen=rows.length;var lai=rows.length-GFL;var slai=lai-1;var idxPos=0;w.attrMapIdx=[];var attrMapIdx=w.attrMapIdx;for(var q=0;q<rowsLen;q++){attrMapIdx[q]=idxPos;if(!rows[q].fs||rows[q].fs.length==0){idxPos++;}else{idxPos+=rows[q].fs.length;}}attrMapIdx[rowsLen]=idxPos;var attrName=rows[lai].dn||rows[lai].n;var fnCopyArray=function(src,isIdx){var dest=[];for(var i=0;i<src.length;i++){dest[i]=src[i];}return dest;};w.ctlMatrix={};w.isAllAttrSelectable=true;for(var i=0;i<lai;i++){var attribute=rows[i];if(!attribute.sc||!attribute.sc.tks||attribute.sc.tks==""){w.isAllAttrSelectable=false;continue;}w.ctlMatrix[attribute.id]={es:attribute.es,sc:attribute.sc,map:[],selectedIdx:{},colIdx:w.getColIdx(attribute.id)};if(attribute.sc.all&&attribute.sc.allSelected){w.ctlMatrix[attribute.id].selectedIdx["-1"]=true;}}var AttrIndexes=[];var i=0,j=0;var template=[];var tempLen=0;for(i=0;i<rhs.length;i++){if(i===0){AttrIndexes[0]=[];for(j=0;j<rhs[i].items.length;j++){AttrIndexes[0][j]=rhs[0].items[j].idx;if(AttrIndexes[0][j]<0&&rows[j].otp==-1){AttrIndexes[0][j]=rows[j].es.length+AttrIndexes[0][j-1];}if(rhs[0].items[j].cet){var id=rhs[0].items[j].cet;if(order[j]==id+":CG"){id+=":CG";}var controlMatrix=w.ctlMatrix[id];if(controlMatrix&&!controlMatrix.selectedIdx[-1]){controlMatrix.selectedIdx[AttrIndexes[0][j]]=true;}}}template=fnCopyArray(AttrIndexes[0]);tempLen=template.length;continue;}var rhsRow=rhs[i].items;var rhsRowLen=rhsRow.length;for(j=1;j<=rhsRowLen;j++){template[tempLen-j]=rhsRow[rhsRowLen-j].idx;if(template[tempLen-j]<0){var k=0;for(;k<attrMapIdx.length;k++){if(tempLen-j<attrMapIdx[k]){break;}}template[tempLen-j]=rows[k-1].es.length+rhsRow[rhsRowLen-j-1].idx;}if(rhsRow[rhsRowLen-j].cet){var id=rhsRow[rhsRowLen-j].cet;if(order[rhsRowLen-j]==id+":CG"){id+=":CG";}var controlMatrix=w.ctlMatrix[id];if(controlMatrix){delete controlMatrix.selectedIdx[-1];controlMatrix.selectedIdx[template[tempLen-j]]=true;}}}AttrIndexes[i]=fnCopyArray(template);}var fnBEL=function(index){var elms={};var ind=0;for(var i=0;i<rows.length-GFL;i++){var fL=rows[i].fs.length;if(fL<1){fL=1;}var attId=rows[i].id;if(AttrIndexes[index][ind]<0){elms[attId]="";}else{elms[attId]=rows[i].es[AttrIndexes[index][ind]];}if(elms[attId]==undefined){elms[attId]={n:""};}var fidId=rows[i].fid;if(fidId&&fidId.length>0){elms[attId+":"+fidId]=rows[i].es[AttrIndexes[index][ind]];}for(var j=0;j<fL;j++){var formId="";if(rows[i].fs&&rows[i].fs[j]){formId=rows[i].fs[j].id;}if(formId&&formId.length>0){var afID=attId+":"+formId;elms[afID]=rows[i].es[AttrIndexes[index][ind]];}ind++;}}return elms;};var s={v:[],rv:[],thClr:[],hi:[0]};var referValue=[];var sortValue=0;var attrElems=null;var ch=[{items:[{n:metricES[0].n}]}];var c=[],baseRow=[],j=0,si=0,isTotal=false,compareResult=false;function indexChanged(baseRow,newRow){if(baseRow.length!=newRow.length){return true;}var endIndex=attrMapIdx[lai]-1;if(endIndex>=baseRow.length){endIndex=baseRow.length-1;}for(var i=endIndex;i>=0;i--){if(baseRow[i]!=newRow[i]){return true;}}return false;}for(var i=0;i<=rl;i++){if(i===0){baseRow=AttrIndexes[i];}else{if((compareResult=(i===rl||indexChanged(baseRow,AttrIndexes[i])))||isTotal){if(isTotal&&!compareResult){}else{for(var x=0;x<lai;x++){var controlMatrix=w.ctlMatrix[rows[x].id];if(controlMatrix){controlMatrix.map[si]=AttrIndexes[i-1][x];}}models[si]={sortV:sortValue,isTotal:isTotal,refv:referValue,elms:attrElems,tr:s.v[s.v.length-1],model:{categories:{items:c,tn:attrName},mtrcs:{items:METRICS},colHeaders:ch,series:[s],rowHeaders:[{n:rows[lai].n}]}};si++;if(i===rl){break;}}s={v:[],rv:[],thClr:[],hi:[0]};referValue=[];c=[];baseRow=AttrIndexes[i];j=0;isTotal=false;}}var otherProps=w.otherProps;for(var p=0;p<gvsRows[i].items.length;p++){if(!referValue[p]){referValue[p]={};}referValue[p]=gvsRows[i].items[p];}attrElems=fnBEL(i);if(otherProps.mpSortKey!=null){var sortByAttr=(otherProps.mpSortKey!=parseInt(otherProps.mpSortKey));if(sortByAttr){sortValue=attrElems[otherProps.mpSortKey].n;}else{sortValue=parseFloat(referValue[otherProps.mpSortKey].rv);}}if(!w.isTreeMode){var isSubTotal=function(attr){return(attr.id&&attr.id.substring(0,1)==="D")||(attr.id===undefined&&attr.n==="Total");};var attrSlai=rows[slai].es[AttrIndexes[i][attrMapIdx[slai]]];if(attrSlai&&isSubTotal(attrSlai)){isTotal=true;continue;}var attr=rows[lai].es[AttrIndexes[i][attrMapIdx[lai]]];if(attr&&isSubTotal(attr)){continue;}}var attrElement="";var attIdxPos=attrMapIdx[lai];var thisAtt=null;var thisAttFormLen=1;try{for(var p=0;p<GFL;p++){thisAtt=rows[lai+p];if(thisAtt.fs&&thisAtt.fs.length>0){thisAttFormLen=thisAtt.fs.length;}else{thisAttFormLen=1;}for(var pp=0;pp<thisAttFormLen;pp++){attrElement+=" "+thisAtt.es[AttrIndexes[i][attIdxPos]].n;attIdxPos++;}}}catch(err){}c[j]=attrElement;var item=gvsRows[i].items[0];s.v[j]=item.v;s.rv[j]=item.rv;var th=m.th&&m.th["0"];var ti=item.ti;if(ti!=undefined&&item.ty==2&&th[ti].cni!=undefined&&otherProps.mbInheritFromGridGraph){this.textSpan.className=m.css[th[ti].cni].n;var compStyle=mstrmojo.css.getComputedStyle(this.textSpan);s.thClr[j]=compStyle.backgroundColor;if(s.thClr[j]=="rgba(0, 0, 0, 0)"){s.thClr[j]=null;}}else{s.thClr[j]=null;}j++;}if(!w.isTreeMode&&otherProps.mpSortKey!=null){var rowCount=models.length;for(var i=0;i<rowCount;i++){for(var j=0;j<rowCount-1;j++){if((otherProps.mbSortDescend&&models[j].sortV<models[j+1].sortV)||(!otherProps.mbSortDescend&&models[j].sortV>models[j+1].sortV)){var temp=models[j];models[j]=models[j+1];models[j+1]=temp;}}}}if(w.isTreeMode){convertDataToTreeModels.call(w,AttrIndexes);}}function convert(w){var m=w.model,rows=m.gts.row,cols=m.gts.col,cs=rows[rows.length-1].es,sn=cols[0].es,idxItems=m.ghs.rhs.items,csl=idxItems.length,v=m.gvs.items,ch=[];for(var i=0;i<sn.length;i++){if(!ch[0]){ch[0]={items:[]};}ch[0].items[i]=[{n:sn[i].n}];}var vl=v[0].items.length;var series=[];var c=[];var attrName=m.gts.row[0].dn||m.gts.row[0].n;var referValue=[];var kpi=w.otherProps.mnMetricsPerKPI;if(isNaN(kpi)){kpi=1;}var sNum=0;var metrixIdxArray=[];for(var i=0;i+kpi<=vl;i=i+kpi){var fv=[];var rv=[];series[sNum]={v:fv,rv:rv,hi:[0]};var refV=[];referValue[sNum]={refv:refV};for(var j=0;j<kpi;j++){referValue[sNum].refv[j]=v[csl-1].items[i+j];}metrixIdxArray[sNum]=i;sNum++;}for(var i=0;i<csl;i++){var idxItemsItems=idxItems[i].items;var idx=idxItemsItems[idxItemsItems.length-1].idx;if(isNaN(idx)){console.log("idx is not a number!"+idx);c[i]=cs[i].n;}else{if(idx<0){c[i]="";}else{c[i]=cs[idx].n;}for(var k=2;k<=idxItemsItems.length&&k<=rows.length;k++){var anotherIdx=idxItemsItems[idxItemsItems.length-k].idx;if(!isNaN(anotherIdx)){c[i]=rows[rows.length-k].es[anotherIdx].n+" "+c[i];}}}var ind=0;for(var j=0;j+kpi<=vl;j=j+kpi){series[ind].v[i]=v[i].items[j].v;series[ind].rv[i]=v[i].items[j].rv;ind++;}}var sl=series.length;for(var i=0;i<sl;i++){var elmsValue={};elmsValue[m.gts.row[0].id]=ch[0].items[i*kpi][0];if(m.gts.row[0].fid){elmsValue[m.gts.row[0].id+":"+m.gts.row[0].fid]=ch[0].items[i*kpi][0];}elmsValue.Metric=ch[0].items[i*kpi][0];models[i]={refv:referValue[i].refv,elms:elmsValue,tr:series[i].v[series[i].v.length-1],model:{categories:{items:c,tn:attrName},mtrcs:{items:METRICS},series:[series[i]],colHeaders:[{items:ch[0].items[i]}],rowHeaders:[{n:rows[0].n}]},metricIdx:metrixIdxArray[i]};}}function bulletShowMinLabel(){var showMinLabel=false;var otherProps=this.otherProps;if(this.showGauge){var minValue=this.bulletProps.mfMinValue;var count=models.length;for(var i=0;i<count;i++){var v=models[i].refv[2];if(v&&v.rv<minValue){showMinLabel=true;otherProps.mRowHeight=otherProps.mRowHeight>36?otherProps.mRowHeight:36;break;}}}return showMinLabel;}function getFirstRowUnderDockedHeader(yPos){var scl=this.getChartWithScrollBar()._scroller;var y=yPos||scl&&scl.origin&&scl.origin.y;var rowOffsetHeight=this.rowOffsetHeight;var rowIdx=this.startCnt+parseInt(y/rowOffsetHeight)+this.dockedHeaderRows.length;var rowPast=y%rowOffsetHeight;var rowInfo=getRowAtIdx.call(this,rowIdx);return{rowInfo:rowInfo,treeNode:rowInfo.treeNode,pastOffset:rowPast,rowIdx:rowIdx};}function getRowAtIdx(rowIdx){if(rowIdx<0){rowIdx=0;}var maxRowIdx=this.rows.length-1;if(rowIdx>maxRowIdx){rowIdx=maxRowIdx;}return this.rows[rowIdx];}function getTreeNodeRows(allExpand,rowCnt){var preOrderTreeNodeQueue=[];var treeNode=null;var rows=[];var treeNodeList=this.tree.childrenTreeNodeList;var childrenCount=treeNodeList.length;for(var i=childrenCount-1;i>=0;i--){preOrderTreeNodeQueue.push(treeNodeList[i]);}var rowCount=0;while(preOrderTreeNodeQueue.length>0){treeNode=preOrderTreeNodeQueue.pop();var row={treeNode:treeNode,model:treeNode.model,rowIdx:rowCount,selected:treeNode.selected,rowRef:{}};rows.push(row);if(!allExpand){treeNode.rowIdx=rowCount++;}if(rowCnt&&rowCount>=rowCnt){break;}if(treeNode.needExpand||allExpand){treeNodeList=treeNode.childrenTreeNodeList;childrenCount=treeNodeList.length;for(var i=childrenCount-1;i>=0;i--){preOrderTreeNodeQueue.push(treeNodeList[i]);}}}return rows;}function getLowestLevelOnScreen(){var scl=this.getChartWithScrollBar()._scroller;var y=scl&&scl.origin&&scl.origin.y;var rowOffsetHeight=this.rowOffsetHeight;var firstRowIdx=this.startCnt+parseInt(y/rowOffsetHeight);var chartHeight=Math.min(this.chartTableMaxHeight,parseInt(this._leftChart.itemsContainerNode.style.height));var lastRowIdx=this.startCnt+parseInt((y+chartHeight)/rowOffsetHeight);if(firstRowIdx<0){firstRowIdx=0;}if(lastRowIdx>=this.rows.length){lastRowIdx=this.rows.length-1;}var lowestLevel=-1;for(var i=firstRowIdx;i<=lastRowIdx;i++){var currLevel=this.rows[i].treeNode.level;if(currLevel>lowestLevel){lowestLevel=currLevel;}}return lowestLevel;}function removeChildren(container){var count=container&&container.childNodes&&container.childNodes.length;for(var i=0;i<count;++i){container.removeChild(container.firstChild);}}function hasScrollDownPast(yPos){return yPos<0;}function expandOrCollapseTreeAndSetScrlPos(levelToExpand,anchorRowTreeNode,anchorRowIdxOnScrn){if(this.expandToLevel==levelToExpand){return ;}setNeedExpandToLevel(this.tree,levelToExpand);this.expandToLevel=levelToExpand;this.rowsNeedRebuild=true;this.reRenderChartWithAnchor(anchorRowTreeNode,anchorRowIdxOnScrn);setChartTableHeight.call(this);this.reBuildDH(levelToExpand);}function expandTreeNodeAndSetScrlPos(rowInfo,rowType){var treeNode=rowInfo.treeNode;treeNode.needExpand=true;this.expandToLevel=-1;var scl=this.getChartWithScrollBar()._scroller;var currRowIdx=rowInfo.rowIdx;this.reRenderChart(scl.origin);setChartTableHeight.call(this);if(currRowIdx==this.startCnt+parseInt(scl.origin.y/this.rowOffsetHeight)+this.dockedHeaderRows.length){var rowIdxList=[];var currRowTreeNode=rowInfo.treeNode;while(currRowTreeNode.needExpand){rowIdxList.push(currRowIdx);currRowTreeNode=getRowAtIdx.call(this,++currRowIdx).treeNode;}this.addRowsToDH(rowIdxList);}var rowOffsetHeight=this.rowOffsetHeight;var lastRowOnScrnIdx=this.startCnt+Math.round((scl.origin.y+this.chartTableHeight)/rowOffsetHeight)-1;if(currRowIdx==lastRowOnScrnIdx){var scroller=scl;var maxYPos=Math.min(scl.origin.y+2*rowOffsetHeight,scl.offset.y.end);scl.origin.y=maxYPos;$D.translate(scroller.scrollEl,-scroller.origin.x,-scroller.origin.y,0,scroller.transform,scroller.useTranslate3d);this.onScrollMoved({y:maxYPos});}}function getIdxByRowIdx(rows,targetIdx){var rowCount=rows.length;for(var i=0;i<rowCount;i++){var rowInfoDH=rows[i];if(rowInfoDH.rowIdx==targetIdx){return i;}}return -1;}function collapseTreeNodeAndSetScrlPos(rowInfo,rowType){var treeNode=rowInfo.treeNode;treeNode.needExpand=false;this.expandToLevel=-1;var scl=this.getChartWithScrollBar()._scroller;if(rowType==DOCKED_HEADER){var adjustOffset=0;var rowCount=this.dockedHeaderRows.length;var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,rowInfo.rowIdx);if(dockedHeaderIdx>=0){this.removeRowsFromDH(rowCount-dockedHeaderIdx);this.removeChildrenForDHReplaceTable();this.dockedHeaderStatus=NO_REPLACE;}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,rowInfo.rowIdx);if(dockedHeaderIdx<0){return ;}dockedHeaderIdx+=rowCount;adjustOffset=scl.origin.y%this.rowOffsetHeight;this.removeChildrenForDHReplaceTable();this.dockedHeaderStatus=NO_REPLACE;}var rowCount=this.startCnt+parseInt(scl.origin.y/this.rowOffsetHeight)+dockedHeaderIdx-rowInfo.rowIdx;this.reRenderChart(scl.origin,rowCount,adjustOffset);}else{if(rowType==OTHER_ROW){this.reRenderChart(scl.origin);}}setChartTableHeight.call(this);}var hideTooltipGlobal=function(){if(this.tooltip.style.display==="block"){var highLightCav=document.getElementById("highLightCav"+this.domNode.id);if(highLightCav){highLightCav.id="";var context=highLightCav.getContext("2d");context.clearRect(0,0,highLightCav.width,highLightCav.height);}this.tooltip.style.display="none";this.tooltipShow=false;if(this._touchListener){var touchManager=mstrmojo.touchManager;touchManager.detachEventListener(this._touchListener);delete this._touchListener;}}};function setChartTableHeight(){if(!this._leftChart){return ;}var chartTableOffsetHeight=(this.otherProps.mbHideTextColumns&&this.enableSmoothScroll)?this._rightChart.chartTableOffsetHeight:this._leftChart.chartTableOffsetHeight;var headerTableOffsetHeight=(this.otherProps.mbHideTextColumns&&this.enableSmoothScroll)?this._rightChart.headerTableOffsetHeight:this._leftChart.headerTableOffsetHeight;var chartTableHeight=0;if(chartTableOffsetHeight>=this.chartTableMaxHeight){chartTableHeight=this.chartTableMaxHeight;}else{chartTableHeight=chartTableOffsetHeight;}this._leftChart.itemsContainerNode.style.height=chartTableHeight+"px";if(this._rightChart){this._rightChart.itemsContainerNode.style.height=chartTableHeight+"px";}this.legend.style.top=(headerTableOffsetHeight+chartTableHeight)+"px";this.dropShadowDiv.style.height=(headerTableOffsetHeight+chartTableHeight)+"px";this.indicatorEl.parentNode.style.top=headerTableOffsetHeight+"px";this.indicatorEl.parentNode.style.height=chartTableHeight+"px";this.chartTableHeight=chartTableHeight;var scl=this.getChartWithScrollBar()._scroller;var yPos=scl.origin.y;var maxYPos=chartTableOffsetHeight-chartTableHeight+2;if(yPos>maxYPos){if(scl.vScroll){scl.origin.y=maxYPos;this._leftChart.scrollTo(scl.origin);if(this._rightChart){this._rightChart.scrollTo(scl.origin);}var rowOffsetHeight=this.rowOffsetHeight;while((yPos=yPos-rowOffsetHeight)>maxYPos){this.updateDockedHeadersByOneRow(yPos,true);}this.updateDockedHeadersByOneRow(maxYPos);this.firstRowIdxOnScrn=parseInt(this.startCnt+scl.origin.y/rowOffsetHeight);}else{scl.origin.y=0;this._leftChart.scrollTo(scl.origin);if(this._rightChart){this._rightChart.scrollTo(scl.origin);}this.firstRowIdxOnScrn=parseInt(this.startCnt+scl.origin.y/rowOffsetHeight);}}this.updateWindowRatio();this.updateScrollBarPosition();}function setScrollerPosition(scrollTo){var scl=this._scroller,icn=this.rightChart,offsetEnd=this.rightChart.offsetWidth-(this.getWidth()-this.leftWidth);scl.origin={x:scrollTo&&scrollTo.x||0,y:scrollTo&&scrollTo.y||0};scl.showScrollbars=true;scl.hScroll=(offsetEnd!==0&&scl.noHScroll!==true)||this.scrollPast;if(scl.hScroll){scl.offset={x:{start:0,end:offsetEnd},scrollPast:this.scrollPast};}this.utils.translateCSS(-scl.origin.x,-scl.origin.y,false,icn);}mstrmojo.VisMicroChart=mstrmojo.declare(mstrmojo.Vis,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.VisMicroChart",utils:mstrmojo.VisChartUtils,scrollerConfig:{bounces:false,showScrollbars:true,vScroll:false,hScroll:true,useTranslate3d:false},scrollPast:false,legendHeight:30,selectedStyle:"background-color:#015DE6;color:#FFFFFF;",selectedClass:"",isAllAttrSelectable:false,prevSelected:{mrow:-2,mcol:-1},rows:[],dockedHeaderRows:[],dockedHeaderReplaceRows:[],rowsReusePool:[],unselectedRemainCells:[],isTreeMode:false,isKPI:false,showMinLabel:false,rowsNeedRebuild:true,lastScrollPosition:{y:0},startCnt:-1,endCnt:-1,firstRowIdxOnScrn:0,pageSize:10,mcStatus:null,fontSize:"10pt",headerCssClass:"",valueCssClass:"",enableSmoothScroll:false,metricColumnsSpacing:NORMAL,attrColumnCount:0,dropShadowWidth:7,markupString:'<div id="{@id}-microchart" class="mstrmojo-Chart {@cssClass}" style="width:{@width};height:{@height};left:{@left};top:{@top};z-index:{@zIndex};position:absolute"  mstrAttach:mousedown,mouseup,mousemove,click ><div id="{@id}-microchart-left" style="width:{@leftWidth+"px"};height:{@height};left:0px;right:0px;position:absolute;z-index:1;" > </div><div id="{@id}-microchart-smoothscroll-container" class="mstrmojo-Chart {@cssClass}" style="width:{@rightWidth+"px"};height:{@height};left:{@leftWidth+"px"};top:0;position:absolute;overflow:hidden;"><div id="{@id}-microchart-right" style="width:{@rightWidth};position:absolute;" > </div><div id="{@id}-drop-shadow-ss" style="position:absolute;left:0px;width:{@dropShadowWidth+"px"}" > </div></div><div style="display:none;position:absolute;right:0;z-index:5;height:{@legendHeight + "px"};width:{@width};border:none;background:transparent;text-decoration:none;" class="microchart-lengend-text"><div style="position:absolute;right:0;top:0;padding-bottom:7px"><div style="float:left;padding-top:7px;"><div class="microchart-legend-band" ></div><div style="float:right;margin-right:10px;margin-left:10px;">Low</div></div><div style="float:left;padding-top:7px;"><div class="microchart-legend-band"></div><div style="float:right;margin-right:10px;margin-left:10px;">Mid</div></div><div style="float:left;padding-top:7px;"><div class="microchart-legend-band"></div><div style="float:right;margin-right:10px;margin-left:10px;">High</div></div></div></div><span id="textSpan" style="z-index:-10;visibility:hidden;-webkit-text-size-adjust: none;"></span><div id="{@id}-loading-msg" class="mstrmojo-loading-msg" style="display:none;z-index:10"></div><canvas id="textCanvas" width="900" height="500" style="z-index:-11;visibility:hidden;-webkit-text-size-adjust: none;"></canvas><div id="{@id}-tooltip" class="mstrmojo-MicroChart-tooltip" style="z-index:10;opacity: 0.9;"></div><div id="{@id}-text-tooltip" class="mstrmojo-Chart-tooltip timeseries-legend-tooltip" style="z-index:10"></div><div id="{@id}-errMsg" class="mstrmojo-message" style="width:{@width};height:{@height};top:0px;left:0px;position:absolute; display:none; z-index:30;"><div style="width:{@width};position:absolute;top:50%;text-align:center"></div></div><div id="{@id}-indicatorEl-container"  style="width:{@width};height:{@height};top:0px;left:0px;position:absolute;z-index:-5"><div></div></div></div>',markupSlots:{leftChart:function(){return this.domNode.childNodes[0];},rightChart:function(){return this.domNode.childNodes[1].firstChild;},dropShadowDiv:function(){return this.domNode.childNodes[1].childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[1];},textSpan:function(){return this.domNode.childNodes[3];},loadingMsg:function(){return this.domNode.childNodes[4];},textCanvas:function(){return this.domNode.childNodes[5];},tooltip:function(){return this.domNode.childNodes[6];},textTooltip:function(){return this.domNode.childNodes[7];},errorMsg:function(){return this.domNode.childNodes[8];},indicatorEl:function(){return this.domNode.childNodes[9].firstChild;},legend:function(){return this.domNode.childNodes[2];},legendLow:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0];},legendLowFont:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0].childNodes[1];},legendLowBand:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[0].childNodes[0];},legendMid:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1];},legendMidFont:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1].childNodes[1];},legendMidBand:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[1].childNodes[0];},legendHigh:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[2];},legendHighFont:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[2].childNodes[1];},legendHighBand:function(){return this.domNode.childNodes[2].childNodes[0].childNodes[2].childNodes[0];}},renderErrorMessage:function renderErrorMessage(msg){var contentDiv=this.errorMsg.firstChild;contentDiv.innerHTML=msg;this.errorMsg.style.display="block";var contentHeight=contentDiv.offsetHeight;contentDiv.style.marginTop=-0.5*contentHeight;},getTextWidthByCanvas:function gtwCvs(text,elem,withPadding){var canvas=this.textCanvas;var context=canvas.getContext("2d");var computedStyle=mstrmojo.css.getComputedStyle(elem);var fontStyle=computedStyle.fontStyle+" "+computedStyle.fontWeight+" "+computedStyle.fontSize+"/"+computedStyle.fontVariant+" "+computedStyle.fontFamily;context.font=fontStyle;context.textAlign="center";context.fillStyle="blue";var metrics=context.measureText(text);var result=metrics.width;if(withPadding){var addPadding=function(padding){if(computedStyle[padding]){result+=parseInt(computedStyle[padding]);}};addPadding("paddingLeft");addPadding("paddingRight");}return result;},getTextWidth:function gtw(str,className,fontName,fontSize,fontSizeUnit,bold,withoutPadding){var selfTextSpan=this.textSpan;if(selfTextSpan.className!==className||""){selfTextSpan.className=className||"";}if(selfTextSpan.style.fontFamily!==fontName||""){selfTextSpan.style.fontFamily=fontName||"";}var fsUnit=fontSizeUnit||"pt";if(fontSize){selfTextSpan.style.fontSize=fontSize+fsUnit;}else{selfTextSpan.style.fontSize="";}if(bold){if(selfTextSpan.style.fontWeight!=="bold"){selfTextSpan.style.fontWeight="bold";}}else{if(selfTextSpan.style.fontWeight!==""){selfTextSpan.style.fontWeight="";}}if(withoutPadding){selfTextSpan.style.padding="0px 0px";}else{selfTextSpan.style.padding="";}selfTextSpan.innerHTML=str;var ret=selfTextSpan.offsetWidth;return ret;},getTextHeight:function gth(str,className,bold,fontFamily,fontSize){this.textSpan.style.fontFamily=fontFamily||"";this.textSpan.style.fontSize=fontSize||"";if(bold){this.textSpan.style.fontWeight="bold";}else{this.textSpan.style.fontWeight="";}this.textSpan.className=className;this.textSpan.innerHTML=str;return this.textSpan.offsetHeight;},removeMCStatus:function removeMCStatus(){this.mcStatus=null;if(this.controller&&this.controller.view&&this.controller.view.model){this.controller.view.model.mcStatus=null;}},restoreMCStatus:function restoreMCStatus(){if(this.isTreeMode&&this.mcStatus&&this.mcStatus.currSelectedObj&&this.mcStatus.currSelectedObj.length>0){this.lastSelectedObj=$HASH.clone(this.currSelectedObj);}if(this.mcStatus&&this.mcStatus.startCnt!=undefined&&this.mcStatus.endCnt!=undefined){this.startCnt=this.mcStatus.startCnt;this.firstRowIdxOnScrn=this.mcStatus.firstRowIdxOnScrn;var minRowCntToCoverScreen=Math.max(this.mcStatus.endCnt-this.mcStatus.firstRowIdxOnScrn,this.minPageSize);this.endCnt=Math.min(this.mcStatus.firstRowIdxOnScrn+minRowCntToCoverScreen,this.rows.length);}if(this.isTreeMode&&this.mcStatus){this.replacingStartRowIdx=this.mcStatus.replacingStartRowIdx;this.needReplaceCount=this.mcStatus.needReplaceCount;this.lastFirstRowIdxOnScrn=this.mcStatus.lastFirstRowIdxOnScrn;this.dockedHeaderStatus=this.mcStatus.dockedHeaderStatus;this.lastScrollPosition=this.mcStatus.lastScrollPosition;}},storeMCStatus:function storeMCStatus(noNeedToStoreScrollInfo){this.mcStatus={};if(this.isTreeMode){this.mcStatus.expandToLevel=this.expandToLevel||-1;this.mcStatus.expandedEntryArray=[];if(this.mcStatus.expandToLevel<0){this.addTreeNodeToExpanedEntry(this.tree.childrenTreeNodeList,[]);}this.mcStatus.currSelectedObj=[];for(var i=0;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];this.mcStatus.currSelectedObj[i]=treeNode&&treeNode.id;}if(!noNeedToStoreScrollInfo){this.mcStatus.dHRowIdxList=[];var dHRows=this.dockedHeaderRows;for(var i=0;i<dHRows.length;i++){this.mcStatus.dHRowIdxList.push(dHRows[i].rowIdx);}this.mcStatus.dHReplaceRowIdxList=[];var dHRows=this.dockedHeaderReplaceRows;for(var i=0;i<dHRows.length;i++){this.mcStatus.dHReplaceRowIdxList.push(dHRows[i].rowIdx);}this.mcStatus.replacingStartRowIdx=this.replacingStartRowIdx;this.mcStatus.needReplaceCount=this.needReplaceCount;this.mcStatus.lastFirstRowIdxOnScrn=this.lastFirstRowIdxOnScrn;this.mcStatus.dockedHeaderStatus=this.dockedHeaderStatus;this.mcStatus.lastScrollPosition=this.lastScrollPosition;}}if(!noNeedToStoreScrollInfo){this.mcStatus.startCnt=this.startCnt;this.mcStatus.endCnt=this.endCnt;this.mcStatus.firstRowIdxOnScrn=this.firstRowIdxOnScrn;var chart=this.getChartWithScrollBar();this.mcStatus.scrollTo=chart&&chart._scroller.origin||{x:0,y:0};}if(this.enableSmoothScroll&&this._scroller&&this._scroller.origin){this.mcStatus.hScrollPos=this._scroller.origin.x/this.rightWidth;}if(this.controller&&this.controller.view&&this.controller.view.model){this.controller.view.model.mcStatus=this.mcStatus;}},addTreeNodeToExpanedEntry:function addExpanedEntry(treeNodeList,parentEntry){var expEntryArray=this.mcStatus.expandedEntryArray;var treeNodeCount=treeNodeList.length;for(var i=0;i<treeNodeCount;i++){var treeNode=treeNodeList[i];if(treeNode.needExpand){var expandedEntry=$HASH.clone(parentEntry);expandedEntry.push({element:treeNode.id});expEntryArray.push(expandedEntry);this.addTreeNodeToExpanedEntry(treeNode.childrenTreeNodeList,expandedEntry);}}},unrender:function unrender(ignoreDom,noNeedToStoreScrollInfo){console.log("in unrender");if(!this.mcStatus){this.storeMCStatus(noNeedToStoreScrollInfo);}this.destroyChartWidget();if(this._super){this._super(ignoreDom);}},refresh:function refresh(){this.unrender(null,true);this.render();},initScroller:function initScroller(scroller){if(this._super){this._super(scroller);}if(this.enableSmoothScroll){this._scrollDoneListener=this._scroller.attachEventListener("scrollDone",this.id,function(){this.updateScrollBarPosition();var scrl=this._scroller;if(scrl){scrl.toggleScrollBars(false);}});}},updateScrollBarPosition:function updateScrollBarPosition(){var scroller=this._rightChart&&this._rightChart._scroller;var scrollBar=scroller&&scroller._scrollBarEls&&scroller._scrollBarEls.y;if(scrollBar){scrollBar.style.left=(this._scroller.origin.x+this.getWidth()-this.leftWidth-9)+"px";}scroller=this._scroller;scrollBar=scroller&&scroller._scrollBarEls&&scroller._scrollBarEls.x;if(scrollBar){scrollBar.style.top=(this.chartTableHeight+this._leftChart.headerTableOffsetHeight-9)+"px";}},onScrollDone:function onScrollDone(evt){var scrl=this.getChartWithScrollBar()._scroller;scrl.toggleScrollBars(false);if(this.partialRender){this.firstRowIdxOnScrn=parseInt(this.startCnt+evt.y/this.rowOffsetHeight);if((this.firstRowIdxOnScrn-this.startCnt<=this.pageSize&&this.firstRowIdxOnScrn>=this.pageSize)||this.endCnt-1-this.firstRowIdxOnScrn<=this.pageSize&&this.endCnt!=this.rows.length){this.reRenderChartWhenScrollDone(scrl.origin);setChartTableHeight.call(this);}}},onScrollMoved:function onScrollMoved(evt){hideTooltipGlobal.call(this);if(this.isTreeMode){if(hasScrollDownPast(evt.y)){this._leftChart.hideDockedHeader();if(this._rightChart){this._rightChart.hideDockedHeader();}}else{this._leftChart.showDockedHeader();if(this._rightChart){this._rightChart.showDockedHeader();}}var rowOffsetHeight=this.rowOffsetHeight;this.firstRowIdxOnScrn=this.startCnt+parseInt(evt.y/rowOffsetHeight);var currPos=evt.y;var lastPos=this.lastScrollPosition.y;if(lastPos>currPos){while((lastPos-=rowOffsetHeight)>currPos){this.updateDockedHeadersByOneRow(lastPos,true);}this.updateDockedHeadersByOneRow(currPos);}else{while((lastPos+=rowOffsetHeight)<currPos){this.updateDockedHeadersByOneRow(lastPos,true);}this.updateDockedHeadersByOneRow(currPos);}}},initDockedHeaders:function initDockedHeaders(){this._leftChart.initDHs();if(this._rightChart){this._rightChart.initDHs();}this.clearDockedHeader();var rowIdx=0;var rowIdxList=[];var currRow=getRowAtIdx.call(this,rowIdx);while(currRow&&currRow.treeNode.needExpand){rowIdxList.push(rowIdx);currRow=getRowAtIdx.call(this,++rowIdx);}this.addRowsToDH(rowIdxList);this.lastFirstRowIdxOnScrn=rowIdx;this.lastScrollPosition={x:0,y:0};this.dockedHeaderStatus=NO_REPLACE;},clearDockedHeader:function clearDockedHeader(){this.removeRowsFromDH(this.dockedHeaderRows.length);this.removeChildrenForDHReplaceTable();},reBuildDH:function reBuildDH(level){this.clearDockedHeader();var rows=this.rows;var rowIdxToCheck=this.firstRowIdxOnScrn+level;if(rowIdxToCheck<0||rowIdxToCheck>=rows.length){return ;}var treeNodeToCheck=rows[rowIdxToCheck].treeNode;if(treeNodeToCheck.level>level){var rowIdxList=[];for(var i=0;i<=level;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}this.addRowsToDH(rowIdxList);}else{if(treeNodeToCheck.level==level){var rowIdxList=[];for(var i=0;i<level;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}rowIdxList.push(treeNodeToCheck.rowIdx);this.addRowsToDH(rowIdxList);}else{if(treeNodeToCheck.level<level){var preSiblingTreeNode=getPreSiblingTreeNode(this.tree,treeNodeToCheck.treePath);while(!preSiblingTreeNode){rowIdxToCheck--;var treeNodeToCheck=rows[rowIdxToCheck].treeNode;preSiblingTreeNode=getPreSiblingTreeNode(this.tree,treeNodeToCheck.treePath);}var rowIdxList=[];for(var i=0;i<treeNodeToCheck.level;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}rowIdxList.push(preSiblingTreeNode.rowIdx);var dHCount=treeNodeToCheck.rowIdx-this.firstRowIdxOnScrn;rowIdxToCheck--;var treeNodeToCheck=rows[rowIdxToCheck].treeNode;for(var i=rowIdxList.length;i<dHCount;i++){var treeNode=getParentTreeNodeAtLevel(this.tree,treeNodeToCheck.treePath,i);rowIdxList.push(treeNode.rowIdx);}this.addRowsToDH(rowIdxList);}}}this.dockedHeaderStatus=NO_REPLACE;},updateDockedHeadersByOneRow:function updateDHBOR(yPos,onlyUpdateStatus){var scroller=this.getChartWithScrollBar()._scroller;if(!scroller.vScroll||yPos>scroller.offset.y.end||yPos<0){return ;}var lastDockedHeaderRow;var currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);this.firstRowIdxOnScrn=currFirstRow.rowIdx-this.dockedHeaderRows.length;if(this.dockedHeaderStatus==IN_REPLACE){var hasReplacedRowCount=this.firstRowIdxOnScrn-this.replacingStartRowIdx;if(hasReplacedRowCount>=0){if(hasReplacedRowCount<this.needReplaceCount){lastDockedHeaderRow=this.dockedHeaderRows[this.dockedHeaderRows.length-1];if(this.firstRowIdxOnScrn>this.lastFirstRowIdxOnScrn){this.removeChildrenForDHReplaceTable();this.shiftDockedHeaderWithRow(0,onlyUpdateStatus);if(lastDockedHeaderRow){this.removeRowsFromDH(1,true);}}else{if(this.firstRowIdxOnScrn<this.lastFirstRowIdxOnScrn){this.dockedHeaderStatus=NO_REPLACE;this.moveRowFromDHRplcTableToDH();currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);}}this.shiftDockedHeaderWithRow(-currFirstRow.pastOffset,onlyUpdateStatus);}else{this.dockedHeaderStatus=NO_REPLACE;this.removeChildrenForDHReplaceTable();this.shiftDockedHeaderWithRow(0,onlyUpdateStatus);currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);}}else{this.dockedHeaderStatus=NO_REPLACE;this.moveRowFromDHRplcTableToDH();currFirstRow=getFirstRowUnderDockedHeader.call(this,yPos);}}if(this.dockedHeaderStatus==NO_REPLACE&&currFirstRow.treeNode){var currLevel=currFirstRow.treeNode.level;lastDockedHeaderRow=this.dockedHeaderRows[this.dockedHeaderRows.length-1];var lastLevel=lastDockedHeaderRow?lastDockedHeaderRow.treeNode.level:-1;if(yPos>this.lastScrollPosition.y){if(currLevel<=lastLevel){if(lastDockedHeaderRow){this.removeRowsFromDH(1,true);}this.replacingRowTreeNode=currFirstRow.treeNode;this.replacingStartRowIdx=this.firstRowIdxOnScrn;this.needReplaceCount=lastLevel-currLevel+1;this.dockedHeaderStatus=IN_REPLACE;this.shiftDockedHeaderWithRow(-currFirstRow.pastOffset,onlyUpdateStatus);}else{if(currLevel>lastLevel){var currRowIdx=currFirstRow.rowIdx;var rowIdxList=[];var currRowTreeNode=currFirstRow.treeNode;while(currRowTreeNode.needExpand){rowIdxList.push(currRowIdx);currRowTreeNode=getRowAtIdx.call(this,++currRowIdx).treeNode;}this.addRowsToDH(rowIdxList);}}}else{if(yPos<this.lastScrollPosition.y){if(currLevel==lastLevel){var addedTreeNode=currFirstRow.treeNode.preSibling;var currRowIdx=currFirstRow.rowIdx;var rowCount=0;while(!addedTreeNode){rowCount++;currFirstRow=getRowAtIdx.call(this,--currRowIdx);addedTreeNode=currFirstRow&&currFirstRow.treeNode.preSibling;}this.removeRowsFromDH(rowCount);lastDockedHeaderRow=this.dockedHeaderRows[this.dockedHeaderRows.length-1];if(lastDockedHeaderRow){this.removeRowsFromDH(1);}if(addedTreeNode.needExpand){var rowIdxList=[addedTreeNode.rowIdx];this.addRowsToDH(rowIdxList,true);}else{}this.replacingStartRowIdx=this.firstRowIdxOnScrn;this.replacingRowTreeNode=addedTreeNode;this.needReplaceCount=1;this.dockedHeaderStatus=IN_REPLACE;var pastOffset=yPos%this.rowOffsetHeight;this.shiftDockedHeaderWithRow(-pastOffset,onlyUpdateStatus);}else{if(currLevel>lastLevel+1){var addedTreeNode=getParentTreeNodeAtLevel(this.tree,currFirstRow.treeNode.treePath,lastLevel+1);var rowIdxList=[addedTreeNode.rowIdx];this.addRowsToDH(rowIdxList,true);this.replacingStartRowIdx=this.firstRowIdxOnScrn;this.replacingRowTreeNode=addedTreeNode;this.needReplaceCount=currLevel-lastLevel-1;this.dockedHeaderStatus=IN_REPLACE;this.shiftDockedHeaderWithRow(-currFirstRow.pastOffset,onlyUpdateStatus);}}}}}this.lastScrollPosition.y=yPos;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;},checkParentBeforeAddToDH:function checkParentBeforeAddToDH(addedRowIdx){var rowInfo=this.rows[addedRowIdx];var treeNode=rowInfo&&rowInfo.treeNode;var rowCount=this.dockedHeaderRows.length;if(rowCount!=treeNode.level){}},addRowsToDH:function addRowsToDH(rowIdxList,toDHReplacingTable){var rows=this.rows;var rowCount=rowIdxList.length;if(rowCount<=0){return ;}var addTo=null;if(toDHReplacingTable){addTo=this.dockedHeaderReplaceRows;}else{addTo=this.dockedHeaderRows;}for(var i=0;i<rowCount;i++){var rowIdx=rowIdxList[i];var rowInfo=rows[rowIdx];addTo.push({rowIdx:rowIdx,treeNode:rowInfo.treeNode,rowRef:this.popFromReusePool()});}this._leftChart.addRowsToDH(rowCount,toDHReplacingTable);if(this._rightChart){this._rightChart.addRowsToDH(rowCount,toDHReplacingTable);}},removeRowsFromDH:function removeRowsFromDH(rowCount,moveToReplacingTable){if(this._leftChart){this._leftChart.removeRowsFromDH(rowCount,moveToReplacingTable);}if(this._rightChart){this._rightChart.removeRowsFromDH(rowCount,moveToReplacingTable);}if(rowCount>this.dockedHeaderRows.length){rowCount=this.dockedHeaderRows.length;}for(;rowCount>0;rowCount--){var row=this.dockedHeaderRows.pop();if(!moveToReplacingTable){this.pushRowRefToReusePool(row);}else{this.dockedHeaderReplaceRows.push(row);}}},moveRowFromDHRplcTableToDH:function moveRowFromDHRplcTableToDH(){this._leftChart.moveRowFromDHRplcTableToDH();if(this._rightChart){this._rightChart.moveRowFromDHRplcTableToDH();}this.shiftDockedHeaderWithRow(0);var row=this.dockedHeaderReplaceRows.pop();if(row){this.dockedHeaderRows.push(row);}},removeChildrenForDHReplaceTable:function removeChildrenForDHReplaceTable(){if(this._leftChart){this._leftChart.removeChildrenForDHReplaceTable();}if(this._rightChart){this._rightChart.removeChildrenForDHReplaceTable();}var rowCount=this.dockedHeaderReplaceRows.length;for(;rowCount>0;rowCount--){var row=this.dockedHeaderReplaceRows.pop();this.pushRowRefToReusePool(row);}},pushRowRefToReusePool:function pushRowRefToReusePool(row){if(!row){return ;}var rowRef=row.rowRef;this.rowsReusePool.push(rowRef);row.rowRef={};},shiftDockedHeaderWithRow:function shiftDockedHeaderWithRow(pastOffset,onlyUpdateStatus){if(onlyUpdateStatus){return ;}if(this._leftChart){this.utils.translateCSS(0,pastOffset,0,this._leftChart.dockedHeaderReplaceDiv.firstChild);}if(this._rightChart){this.utils.translateCSS(0,pastOffset,0,this._rightChart.dockedHeaderReplaceDiv.firstChild);}},init:function init(props){this._super(props);},initFromVisProps:function(vp){initProp.call(this);var propValue=vp?vp:{},sparklineProps=this.sparklineProps,barProps=this.barProps,bulletProps=this.bulletProps,otherProps=this.otherProps;this.isTreeMode=getBoolValue(propValue.itd);if(propValue.lsh){sparklineProps.mbShow=(propValue.lsh==="true");}if(propValue.lap){sparklineProps.mbAllPoints=(propValue.lap==="true");}if(propValue.lep){sparklineProps.mbEndPoints=(propValue.lep==="true");}if(propValue.lrl){sparklineProps.mbRefLine=(propValue.lrl==="true");}if(propValue.lra){sparklineProps.mbRefArea=(propValue.lra==="true");}if(propValue.lmsh){sparklineProps.mbAssMetric=(propValue.lmsh==="true");}if(propValue.let){sparklineProps.mbShowTooltip=(propValue.let==="true");}if(propValue.llsc){sparklineProps.mwSeriesLineCol=convertToColor(propValue.llsc);}if(propValue.lrlc){sparklineProps.mwRefLineCol=convertToColor(propValue.lrlc);}if(propValue.lrac){sparklineProps.mwRefAreaCol=convertToColor(propValue.lrac);}if(propValue.lh){sparklineProps.mstrHeader=propValue.lh;}if(propValue.lam){sparklineProps.mstrAssMetric=propValue.lam;}if(propValue.bsg){barProps.mbShow=(propValue.bsg==="true");}if(propValue.bl){barProps.mbShowLegend=(propValue.bl==="true");}if(propValue.brl){barProps.mbRefLine=(propValue.brl==="true");}if(propValue.bet){barProps.mbShowTooltip=(propValue.bet==="true");}if(propValue.bpv){barProps.mwPosCol=convertToColor(propValue.bpv);}if(propValue.bnv){barProps.mwNegCol=convertToColor(propValue.bnv);}if(propValue.brlc){barProps.mwRefLineCol=convertToColor(propValue.brlc);}if(propValue.bh){barProps.mstrHeader=propValue.bh;}if(propValue.gsh){bulletProps.mbShow=(propValue.gsh==="true");}if(propValue.grl){bulletProps.mbRefLine=(propValue.grl==="true");}if(propValue.gra){bulletProps.mbRefBands=(propValue.gra==="true");}if(propValue.gl){bulletProps.mbShowLegend=(propValue.gl==="true");}if(propValue.gmsh){bulletProps.mbAssMetric=(propValue.gmsh==="true");}if(propValue.gia){bulletProps.mbInvertAxis=(propValue.gia==="true");}if(propValue.get){bulletProps.mbShowTooltip=(propValue.get==="true");}if(propValue.gmm){bulletProps.mfMinValue=parseFloat(propValue.gmm);}if(propValue.ggc){bulletProps.mwPosCol=convertToColor(propValue.ggc);}if(propValue.gnv){bulletProps.mwNegCol=convertToColor(propValue.gnv);}if(propValue.grlc){bulletProps.mwRefLineCol=convertToColor(propValue.grlc);}if(propValue.gpc){bulletProps.mwBand1=convertToColor(propValue.gpc);}if(propValue.grc){bulletProps.mwBand2=convertToColor(propValue.grc);}if(propValue.gsc){bulletProps.mwBand3=convertToColor(propValue.gsc);}if(propValue.gh){bulletProps.mstrHeader=propValue.gh;}if(propValue.gtam){bulletProps.mstrAssMetric=propValue.gtam;}if(propValue.glt){bulletProps.mstrBand1=propValue.glt;}if(propValue.gmt){bulletProps.mstrBand2=propValue.gmt;}if(propValue.ght){bulletProps.mstrBand3=propValue.ght;}if(propValue.wa){var value=parseFloat(propValue.wa);if(propValue.wa.indexOf("%")){value/=100;}otherProps.mfBkgOpacity=value;}if(propValue.metkpi){otherProps.mnMetricsPerKPI=parseInt(propValue.metkpi);}if(propValue.hch){otherProps.mbHideColHeaders=(propValue.hch==="true");}if(propValue.htc){otherProps.mbHideTextColumns=(propValue.htc==="true");}if(propValue.ll){otherProps.mbLockLayout=(propValue.ll==="true");}if(propValue.gam){otherProps.mbShowForHiddenGraphs=(propValue.gam==="true");}if(propValue.igf){otherProps.mbInheritFromGridGraph=(propValue.igf==="true");}if(propValue.scm){otherProps.mbInSingleColumnMode=(propValue.scm==="true");}if(propValue.cid){otherProps.mpColumnIDs=propValue.cid.split(",");}if(propValue.tcid){otherProps.mpColumnIDsInTreeMode=propValue.tcid.split(",");}if(propValue.co){otherProps.mpColumnPositions=propValue.co.split(",");}if(propValue.sc){otherProps.mpSortKey=propValue.sc;}if(propValue.so){otherProps.mbSortDescend=(propValue.so!=="false");}if(propValue.rh){otherProps.mRowHeight=parseFloat(propValue.rh);}otherProps.mRowHeight=otherProps.mRowHeight>27?otherProps.mRowHeight:27;setDimensionWithDPI.call(this);},preBuildRendering:function preBR(){console.log("in preb in MC");if(this._super){this._super();}var m=this.model;if(!m){m.err=mstrmojo.desc(8426,"No model provided");return ;}this.isAndroidTab=$D.isAndroid?!!mstrApp.isTablet():false;this.isAndroidPhone=$D.isAndroid&&!this.isAndroidTab;var propValue=m.vp||{};var isReport=this.controller&&(this.controller instanceof mstrmojo.android.controllers.XtabController);var fullScreen=this.isFullScreenWidget||isReport;this.enableSmoothScroll=(this.isAndroidPhone&&fullScreen)?true:getBoolValue(propValue.ss);if(propValue.mcs){this.metricColumnsSpacing=parseInt(propValue.mcs);}else{this.metricColumnsSpacing=this.isAndroidPhone?(mstrApp.isLandscape()?NORMAL:COMPACT):-1;}if(this.enableSmoothScroll){this.leftWidth=this.getWidth()/3;this.rightWidth=this.getWidth()/3*2;}else{this.leftWidth=this.getWidth();this.rightWidth=0;this.scrollerConfig.hScroll=false;}},buildRendering:function(){var that=this;var backup=mstrmojo.string.apply;mstrmojo.string.apply=function(tmpl,obj){if(!tmpl){return"";}return tmpl.replace(/\{([^\}]+)\}/gm,function tokenRepl(token,prop){var s=token.replace(/@/g,"that.");var res=eval(s);return res===undefined?"":res;});};if(this._super){this._super();}mstrmojo.string.apply=backup;},buildRows:function buildRows(){if(this.rowsNeedRebuild){if(this.isTreeMode){this.rows=getTreeNodeRows.call(this);}else{buildNonTreeRows.call(this);}this.rowsNeedRebuild=false;}},pushToReusePool:function pushToReusePool(beginCnt,endCnt){var bCnt=beginCnt!=undefined?beginCnt:this.startCnt;var eCnt=endCnt!=undefined?endCnt:this.endCnt;var rowInfo=null;for(var i=bCnt;i<eCnt;i++){rowInfo=this.rows[i];this.rowsReusePool.push(rowInfo.rowRef);rowInfo.rowRef={};}},popFromReusePool:function popFromReusePool(){var rowRef=this.rowsReusePool.pop();return rowRef||{};},reRenderChart:function reRenderChart(scrollTo,rowCount,adjustOffsetY){this.pushToReusePool();this.buildRows();var rowOffsetHeight=this.rowOffsetHeight;if(!rowCount){rowCount=0;}this.firstRowIdxOnScrn=parseInt(this.startCnt+scrollTo.y/rowOffsetHeight)-rowCount;this.getCurrRenderRowCount();if(adjustOffsetY==undefined){adjustOffsetY=scrollTo.y%rowOffsetHeight;}scrollTo.y=(this.firstRowIdxOnScrn-this.startCnt)*rowOffsetHeight+adjustOffsetY;this.lastScrollPosition.y=scrollTo.y;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;var rows=this.rows;for(var i=this.startCnt;i<this.endCnt;i++){rows[i].rowRef=this.popFromReusePool();}if(!this.enableSmoothScroll){this._leftChart.reRenderRows(scrollTo);}else{this._leftChart.reRenderRows(scrollTo);this._rightChart.reRenderRows(scrollTo);}},reRenderChartWhenScrollDone:function reRenderChartwsd(scrollTo){var oldStartCnt=this.startCnt;var oldEndCnt=this.endCnt;var rowOffsetHeight=this.rowOffsetHeight;this.firstRowIdxOnScrn=parseInt(this.startCnt+scrollTo.y/rowOffsetHeight);this.getCurrRenderRowCount();var firstRowToRemove,lastRowToRemove,firstRowToRender,lastRowToRender;if(this.startCnt<oldEndCnt&&this.startCnt>oldStartCnt){firstRowToRemove=oldStartCnt;lastRowToRemove=this.startCnt;firstRowRemain=this.startCnt;lastRowRemain=oldEndCnt;firstRowToRender=oldEndCnt;lastRowToRender=this.endCnt;}else{if(oldStartCnt<this.endCnt&&oldStartCnt>this.startCnt){firstRowToRemove=this.endCnt;lastRowToRemove=oldEndCnt;firstRowRemain=oldStartCnt;lastRowRemain=this.endCnt;firstRowToRender=this.startCnt;lastRowToRender=oldStartCnt;}else{firstRowToRemove=oldStartCnt;lastRowToRemove=oldEndCnt;firstRowRemain=0;lastRowRemain=0;firstRowToRender=this.startCnt;lastRowToRender=this.endCnt;}}this.pushToReusePool(firstRowToRemove,lastRowToRemove);scrollTo.y=(this.firstRowIdxOnScrn-this.startCnt)*rowOffsetHeight+scrollTo.y%rowOffsetHeight;this.lastScrollPosition.y=scrollTo.y;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;var rows=this.rows;for(var i=firstRowToRender;i<lastRowToRender;i++){rows[i].rowRef=this.popFromReusePool();}if(!this.enableSmoothScroll){this._leftChart.reRenderRows(scrollTo,firstRowRemain,lastRowRemain,firstRowToRender,lastRowToRender);}else{this._leftChart.reRenderRows(scrollTo,firstRowRemain,lastRowRemain,firstRowToRender,lastRowToRender);this._rightChart.reRenderRows(scrollTo,firstRowRemain,lastRowRemain,firstRowToRender,lastRowToRender);}},reRenderChartWithAnchor:function reRenderChartWithAnchor(anchorRowTreeNode,anchorRowIdxOnScrn){this.pushToReusePool();this.buildRows();var rowOffsetHeight=this.rowOffsetHeight;var anchorRowIdx=-1;for(var i=0;i<this.rows.length;i++){if(this.rows[i].treeNode.treePath==anchorRowTreeNode.treePath){anchorRowIdx=i;break;}}this.firstRowIdxOnScrn=anchorRowIdx-anchorRowIdxOnScrn;if(this.firstRowIdxOnScrn<0){this.firstRowIdxOnScrn=0;}this.getCurrRenderRowCount();scrollTo.y=(this.firstRowIdxOnScrn-this.startCnt)*rowOffsetHeight;this.lastScrollPosition.y=scrollTo.y;this.lastFirstRowIdxOnScrn=this.firstRowIdxOnScrn;var rows=this.rows;for(var i=this.startCnt;i<this.endCnt;i++){rows[i].rowRef=this.popFromReusePool();}if(!this.enableSmoothScroll){this._leftChart.reRenderRows(scrollTo);}else{this._leftChart.reRenderRows(scrollTo);this._rightChart.reRenderRows(scrollTo);}},supportsIncFetch:false,pageSize:0,getCurrRenderRowCount:function getCRRC(){var maxRenderRowCount=this.pageSize*PAGE_COUNT;if(this.rows.length<=maxRenderRowCount){this.partialRender=false;this.startCnt=0;this.endCnt=this.rows.length;}else{this.partialRender=true;this.startCnt=Math.round(this.firstRowIdxOnScrn-this.pageSize*(PAGE_COUNT-1)/2);if(this.startCnt<0){this.startCnt=0;}this.endCnt=this.startCnt+maxRenderRowCount;if(this.endCnt>this.rows.length){this.endCnt=this.rows.length;}}},getChartWithScrollBar:function(){if(this.enableSmoothScroll){return this._rightChart;}else{return this._leftChart;}},updateWindowRatio:function updateWindowRatio(){var chart=this.getChartWithScrollBar(),scroller=chart._scroller;scroller.chartTableRenderRatio=(this.endCnt-this.startCnt)/this.rows.length;scroller.topUnRenderedRatio=this.startCnt/this.rows.length;chart.updateScroller();},initValues:function initValues(){this.prevSelected={mrow:-2,mcol:-1};if(this.isTreeMode){initTree.call(this);}this.treeColumnIdx=-1;this.minPageSize=Math.ceil((this.getHeight()/this.otherProps.mRowHeight)*3/PAGE_COUNT);this.pageSize=this.minPageSize;this.rowsNeedRebuild=true;this.rows=[];this.dockedHeaderRows=[];this.dockedHeaderReplaceRows=[];this.rowsReusePool=[];this.unselectedRemainCells=[];this.errorMsg.style.display="none";},postBuildRendering:function postBR(){var me=this,model=me.model;var err=model.err||model.eg;if(err){me.renderErrorMessage(err);return ;}if(me.controller&&me.controller.view&&me.controller.view.model){if(!me.mcStatus&&me.controller.view.model.mcStatus){me.mcStatus=me.controller.view.model.mcStatus;}}me.initValues();me.highlightEntireRow=me.isTreeMode||me.isAllAttrSelectable;getUITheme.call(me);convertDataToModels.call(me);if(me.otherProps.mbInheritFromGridGraph){me.selectedClass="sc_"+me.model.k;}else{me.selectedClass="";}err=model.err||model.eg;if(err){me.renderErrorMessage(err);return ;}if(this._super){this._super();}me.renderLegend();me.getCurrRenderRowCount();me.restoreMCStatus();if(!me.enableSmoothScroll){me.itemsContainerNode.style.display="none";var props={placeholder:me.leftChart,colInfos:me.colInfos,theme:me.theme,isTreeMode:me.isTreeMode,showMinLabel:me.showMinLabel,width:me.leftWidth+"px",height:(me.getHeight()-me.legendHeight)+"px",textSpan:me.textSpan,textCanvas:me.textCanvas,headerCssClass:me.headerCssClass,valueCssClass:me.valueCssClass,isAndroidTab:me.isAndroidTab,widget:me,treeColumnIdx:me.treeColumnIdx,backgroundColor:me.backgroundColor,domRefName:LEFT_CHART_ROW,showScrollbars:true};var w=new mstrmojo.VisMicroChartTable(props);w.render();me._leftChart=w;w.parent=me;me.replaceScrollerUpdate(w);}else{var props={placeholder:me.leftChart,colInfos:me.colInfos.slice(0,this.attrColumnCount),theme:me.theme,isTreeMode:me.isTreeMode,showMinLabel:me.showMinLabel,width:me.leftWidth+"px",height:(me.getHeight()-me.legendHeight)+"px",textSpan:me.textSpan,textCanvas:me.textCanvas,headerCssClass:me.headerCssClass,valueCssClass:me.valueCssClass,isAndroidTab:me.isAndroidTab,widget:me,treeColumnIdx:me.treeColumnIdx,backgroundColor:me.backgroundColor,domRefName:LEFT_CHART_ROW,showScrollbars:false,zIndex:1};var w=new mstrmojo.VisMicroChartTable(props);w.render();me._leftChart=w;w.parent=me;me.leftChart=w.domNode;var props={placeholder:me.rightChart,colInfos:me.colInfos.slice(this.attrColumnCount),theme:me.theme,isTreeMode:me.isTreeMode,showMinLabel:me.showMinLabel,width:me.rightWidth+"px",height:(me.getHeight()-me.legendHeight)+"px",textSpan:me.textSpan,textCanvas:me.textCanvas,headerCssClass:me.headerCssClass,valueCssClass:me.valueCssClass,isAndroidTab:me.isAndroidTab,widget:me,treeColumnIdx:me.treeColumnIdx,backgroundColor:me.backgroundColor,domRefName:RIGHT_CHART_ROW,showScrollbars:true};var w2=new mstrmojo.VisMicroChartTable(props);w2.render();me._rightChart=w2;w2.parent=me;me.rightChart=w2.domNode;me.replaceScrollerUpdate(w2);if(this.theme==DEFAULT_LIGHT_THEME||this.theme==CUSTOM_LIGHT_THEME){me.dropShadowDiv.style.backgroundImage="-webkit-gradient(linear, left top, right top, color-stop(0, rgba(0,0,0,0.25)), color-stop(1, rgba(0,0,0,0)))";}else{me.dropShadowDiv.style.backgroundImage="-webkit-gradient(linear, left top, right top, color-stop(0, rgba(0,0,0,0.5)), color-stop(1, rgba(0,0,0,0)))";}w2.addSyncScroller(w);w.addSyncScroller(w2);me.scrollerConfig.scrollEl=me.rightChart;me.updateScroller();var scrollTo=null;if(this.mcStatus&&this.mcStatus.hScrollPos!=undefined){var xPos=Math.min(this.mcStatus.hScrollPos*this.rightWidth,this.rightWidth+this.leftWidth-this.getWidth());scrollTo=this._scroller.origin={x:xPos,y:0};}setScrollerPosition.call(me,scrollTo);var headerHeight=Math.max(me._leftChart.headerTableOffsetHeight,me._rightChart.headerTableOffsetHeight);me._leftChart.headerTable.style.height=headerHeight+"px";me._rightChart.headerTable.style.height=headerHeight+"px";me._leftChart.updateHeaderTableOffsetH();me._rightChart.updateHeaderTableOffsetH();}me.rowOffsetHeight=(me.otherProps.mbHideTextColumns&&this.enableSmoothScroll)?w2.rowOffsetHeight:w.rowOffsetHeight;if(me.isTreeMode){if(me.mcStatus&&me.mcStatus.dHRowIdxList){me._leftChart.initDHs();if(me._rightChart){me._rightChart.initDHs();}me.addRowsToDH(me.mcStatus.dHRowIdxList);if(me.mcStatus.dHReplaceRowIdxList.length>0){me.addRowsToDH(me.mcStatus.dHReplaceRowIdxList,true);var pastOffset=me.mcStatus.scrollTo.y%me.rowOffsetHeight;me.shiftDockedHeaderWithRow(-pastOffset);}}else{me.initDockedHeaders();}}me.removeMCStatus();me.getDefaultHighlightRow();me.updateSelectedStatus(me.tree);me.updateHighlightForCurrRenderRows();me.chartTableMaxHeight=me.getHeight()-me._leftChart.headerTableOffsetHeight;if(me.legendDis){me.chartTableMaxHeight-=me.legendHeight;}me.pageSize=Math.max(Math.min(parseInt(me.chartTableMaxHeight/me.rowOffsetHeight)+1,20),me.minPageSize);setChartTableHeight.call(me);var xtabModel=me.xtabModel,docModel=(xtabModel&&xtabModel.docModel);if(docModel){me._infoWClosedListener=me.xtabModel.docModel.attachEventListener("infoWindowClosed",this.id,function(evt){var infoWindowK=evt.psKey;if(!me.hasNonifwTarget&&me.selectorTargets&&me.selectorTargets[infoWindowK]){window.setTimeout(function(){if(me.isTreeMode){var treeNode=me.lastSelectedObj[me.lastSelectedObj.length-1];if(treeNode&&treeNode.treePath){me.closedIfwAttr=treeNode.treePath;me.currSelectedObj=[];me.updateSelectedStatus(me.tree);me.updateHighlightForCurrRenderRows();me.lastSelectedObj=[];}}else{if(me.isAllAttrSelectable){me.closedIfwAttr=me.prevSelected.mrow;me.clearPreHighlightRowStatus();me.updateUnselectedRemainCells();me.updateSelectedStatus(me.tree);me.updateHighlightForCurrRenderRows();}else{var mcol=me.prevSelected&&me.prevSelected.mcol;var id=me.colInfos[mcol]&&me.colInfos[mcol].order;id=id.split(":")[0];me.closedIfwAttr=id;var ctlMatrix=me.ctlMatrix[id];var ctlMatrixCG=me.ctlMatrix[id+":CG"];var selectedIdxBackup=ctlMatrix.selectedIdx;var selectedIdxCGBackup=ctlMatrixCG&&ctlMatrixCG.selectedIdx;ctlMatrix.selectedIdx={};if(ctlMatrixCG){ctlMatrixCG.selectedIdx={};}me.updateSelectedStatus();me.updateHighlightForCurrRenderRows();ctlMatrix.selectedIdx=selectedIdxBackup;if(ctlMatrixCG){ctlMatrixCG.selectedIdx=selectedIdxCGBackup;}}}},10);}});}this.renderTextTooltip();},renderTextTooltip:function renderTextTooltip(){var props={placeholder:this.textTooltip,boundary:this.domNode};this._textTooltip=new mstrmojo.VisTextTooltip(props);this._textTooltip.render();this._textTooltip.toggle(false);},replaceScrollerUpdate:function replaceScrollerUpdate(chartTable){chartTable._scroller.updateScrollBars=function updateScrollBars(viewportCoords,scrollBarContainerElement){var scrollEl=this.scrollEl;if(!this.showScrollbars||!scrollEl){return ;}var bars=this._scrollBarEls;var chartTableRenderRatio=this.chartTableRenderRatio||1;var topUnRenderedRatio=this.topUnRenderedRatio||0;if(!bars){var me=this;bars=this._scrollBarEls={x:"hScroll",y:"vScroll"};$forEachHash(bars,function(scroll,axis){if(me[scroll]){var bar=document.createElement("div");bar.className="mstrmojo-touch-scrollBar "+axis+"Axis";(scrollBarContainerElement||scrollEl.parentNode).appendChild(bar);bars[axis]=bar;}else{delete bars[axis];}});}if(!viewportCoords){var parentNode=this.scrollEl.parentNode;viewportCoords={top:0,right:parentNode.clientWidth,bottom:parentNode.clientHeight,left:0};}var offset=9,scrollBarCoords={x:{left:viewportCoords.left,top:viewportCoords.bottom-offset,x:viewportCoords.right-viewportCoords.left,d:"Width"},y:{left:viewportCoords.right-offset,top:viewportCoords.top,x:viewportCoords.bottom-viewportCoords.top,d:"Height"}};var me=this;$forEachHash(bars,function(bar,axis){var barStyle=bar.style,coords=scrollBarCoords[axis],dimension=coords.d,parentNode=bar.parentNode,x=coords.x;var left=coords.left,top=coords.top+x*topUnRenderedRatio,ratio=x/scrollEl["offset"+dimension]*chartTableRenderRatio,length=Math.min(Math.round(x*ratio),x);bar.baseLeft=left;bar.baseTop=top;bar.ratio=ratio;bar.viewportSize=$M.round(x*chartTableRenderRatio);bar.length=length;barStyle.left=left+"px";barStyle.top=top+"px";barStyle[dimension.toLowerCase()]=length+"px";var isX=(axis==="x"),direction=isX?"hScroll":"vScroll";if(me[direction]){var origin=me.origin,position=origin&&origin[axis]||0,viewportSize=bar.viewportSize,minScale=6/length,minPosition=bar["base"+((isX)?"Left":"Top")],maxPosition=minPosition+viewportSize-length,newPosition=$M.round(minPosition+(ratio*position));if(newPosition<minPosition){newPosition=minPosition-position;length+=position;}else{if(newPosition>maxPosition){var delta=(position-me.offset[axis].end)*ratio;newPosition=$M.min(maxPosition+delta,viewportSize+minPosition-6)-1;length-=delta;}}var v=0,translate=[v,v,v],scale=[1,1,1],idx=(isX)?0:1;translate[idx]=(newPosition-minPosition);scale[idx]=$M.min($M.max(length/bar.length,minScale),1);$D.translate(bar,translate[0],translate[1],translate[2]," scale3d("+scale.join(",")+")");}});};},setElementDimension:function setElementDimension(e,width){var paddingWidth=0;var compStyle=mstrmojo.css.getComputedStyle(e);if(compStyle.paddingLeft){paddingWidth+=parseFloat(compStyle.paddingLeft);}if(compStyle.paddingRight){paddingWidth+=parseFloat(compStyle.paddingRight);}e.style.width=(width-paddingWidth)+"px";},setColorByTheme:function setColorByTheme(){var bulletProps=this.bulletProps;if(this.theme==DEFAULT_DARK_THEME){this.bandColor1="#494949";this.bandColor2="#595959";this.bandColor3="#727272";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=2;this.blueBarPosColor="#00BDFF";this.blueBarNegColor="#00BDFF";}else{if(this.theme==DEFAULT_LIGHT_THEME){this.bandColor1="#A5A5A5";this.bandColor2="#B3B3B3";this.bandColor3="#C4C4C4";this.refLinePosColor="#FF781D";this.refLineNegColor="#FF781D";this.refLineWidth=2;this.blueBarPosColor="#00BDFF";this.blueBarNegColor="#00BDFF";}else{this.bandColor1=bulletProps.mwBand1||"#999999";this.bandColor2=bulletProps.mwBand2||"#BBBBBB";this.bandColor3=bulletProps.mwBand3||"#DEDEDE";this.refLinePosColor=bulletProps.mwRefLineCol;this.refLineNegColor=bulletProps.mwRefLineCol;this.blueBarPosColor=bulletProps.mwPosCol;this.blueBarNegColor=bulletProps.mwNegCol;}}},renderLegend:function renderLgd(){var bulletProps=this.bulletProps;this.setColorByTheme();this.legendDis=this.showGauge&&this.bulletProps.mbShowLegend;if(this.legendDis){this.legend.className+=" "+this.valueCssClass;this.legend.style.display="block";this.legend.style.fontSize=Math.round(11*zf)+"pt";this.setElementDimension(this.legend,this.getWidth());if(bulletProps.mstrBand1){this.legendLowFont.innerHTML=bulletProps.mstrBand1;}this.legendLowBand.style.backgroundColor=this.bandColor1;if(bulletProps.mstrBand2){this.legendMidFont.innerHTML=bulletProps.mstrBand2;}this.legendMidBand.style.backgroundColor=this.bandColor2;if(bulletProps.mstrBand3){this.legendHighFont.innerHTML=bulletProps.mstrBand3;}this.legendHighBand.style.backgroundColor=this.bandColor3;var lowWidth=this.legendLow.offsetWidth,midWidth=this.legendMid.offsetWidth,highWidth=this.legendHigh.offsetWidth;if(lowWidth+midWidth+highWidth>this.getWidth()){if(lowWidth+midWidth>this.getWidth()){this.legendLow.style.width=this.width;if(midWidth+highWidth>this.getWidth()){this.legendMid.style.width=this.width;this.legendHigh.style.width=this.width;}else{this.legendMid.style.width=(this.getWidth()-highWidth)+"px";}}else{this.legendLow.style.width=(this.getWidth()-midWidth)+"px";this.legendHigh.style.width=this.width;}}this.legendHeight=this.legend.firstChild.offsetHeight;this.legend.style.height=this.legendHeight+"px";}else{this.legend.style.display="none";this.legendHeight=0;}},showChartTooltip:function showChartTooltip(touchedChart,touch){var me=this;var wasNoTooltip=this.tooltip.style.display==="none"||!(this.tooltip.style.display);touchedChart.showTooltip(touch.pageX,touch.pageY);var nowHasTooltip=this.tooltip.style.display==="block";this.tooltipShow=nowHasTooltip;if(wasNoTooltip&&nowHasTooltip){var touchManager=mstrmojo.touchManager;this._touchListener=touchManager.attachEventListener("touchesBegin",this.id,function(evt){if(!isTouchedOnWidget.call(me,evt.touch)){hideTooltipGlobal.call(me,evt.touch);}});}},touchSelectBegin:function touchSelectBegin(touch){if(touch.evt.ctrlKey){this.touchMultiBegin(touch);return ;}var me=this;hideTooltipGlobal.call(me);var td=mstrmojo.dom.findAncestorByAttr(touch.target,"mcol",true,this.domNode);if(td&&td.node){var mrow=td.node.getAttribute("mrow");var mcol=td.node.getAttribute("mcol");if(mrow==-1){this.showTextTooltip(td.node,mcol,true);}else{var tr=td.node.parentNode;var rowInfo=null;if(tr.getAttribute("rowType")==DOCKED_HEADER){var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,mrow);if(dockedHeaderIdx>=0){rowInfo=this.dockedHeaderRows[dockedHeaderIdx];}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,mrow);rowInfo=this.dockedHeaderReplaceRows[dockedHeaderIdx];}}else{rowInfo=this.rows[mrow];}var colInfo=this.colInfos[mcol];if(colInfo.type==CHART){var touchedChart=rowInfo&&rowInfo.rowRef&&rowInfo.rowRef[mcol];if(touchedChart){this.showChartTooltip(touchedChart,touch);this.currSelectedWidget={mrow:mrow,mcol:mcol};}}else{if(colInfo.type==ATTR_NAME||colInfo.type==METRIC_VALUE||colInfo.type==METRIC_NAME){this.showTextTooltip(td.node,mcol);}}}}},showTextTooltip:function showTextTooltip(e,mcol,onHeader){if(onHeader){var colInfo=this.colInfos[mcol],text=colInfo.title;if(colInfo.titleOverflow&&this._textTooltip){this._textTooltip.updateContent(e,onHeader?"title":"content",text);}}else{var text=e.innerText;var tmpLength=this.getTextWidthByCanvas(text,e,true);if(tmpLength>e.offsetWidth&&this._textTooltip){this._textTooltip.updateContent(e,onHeader?"title":"content",text);}}},hideTextTooltip:function hideTextTooltip(){if(this._textTooltip){this._textTooltip.toggle(false);}},touchSelectEnd:function touchSelectEnd(touch){if(touch.evt.ctrlKey){this.touchMultiEnd(touch);return ;}this.currSelectedWidget=null;this.hideTextTooltip();},touchSelectMove:function touchSelectMove(touch){if(touch.evt.ctrlKey){this.touchMultiMove(touch);return ;}if(!this.currSelectedWidget){return ;}this.tooltip.style.display="none";var target=touch.target;var mcol=-1,colInfo=null;var targetFound=true;var td=mstrmojo.dom.findAncestorByAttr(target,"mcol",true,this.domNode);td=td&&td.node;if(td){mcol=td.getAttribute("mcol");colInfo=this.colInfos[mcol];if(colInfo.order=="GaugeChart"){targetFound=false;}}else{targetFound=false;}if(targetFound===false){target=document.elementFromPoint(touch.pageX,touch.pageY);td=mstrmojo.dom.findAncestorByAttr(target,"mcol",true,this.domNode);td=td&&td.node;if(!td){return ;}mcol=td.getAttribute("mcol");colInfo=this.colInfos[mcol];}var mrow=td.getAttribute("mrow");var tr=td.parentNode;var rowInfo=null;if(tr.getAttribute("rowType")==DOCKED_HEADER){var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,mrow);if(dockedHeaderIdx>=0){rowInfo=this.dockedHeaderRows[dockedHeaderIdx];}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,mrow);rowInfo=this.dockedHeaderReplaceRows[dockedHeaderIdx];}}else{rowInfo=this.rows[mrow];}var touchedChart=rowInfo&&rowInfo.rowRef&&rowInfo.rowRef[mcol];var tooltipShown;if(touchedChart){if(colInfo.order=="LineChart"||colInfo.order=="BarChart"){if(mrow==this.currSelectedWidget.mrow&&mcol==this.currSelectedWidget.mcol){tooltipShown=touchedChart.showTooltip(touch.pageX,touch.pageY);this.currSelectedWidget={mrow:mrow,mcol:mcol};}}else{if(mcol==this.currSelectedWidget.mcol&&mrow!=this.currSelectedWidget.mrow){tooltipShown=touchedChart.showTooltip(touch.pageX,touch.pageY);this.currSelectedWidget={mrow:mrow,mcol:mcol};}}}if(tooltipShown){this.tooltipShow=true;}console.log("tooltip show:"+this.tooltipShow);if(this.tooltipShow){this.tooltip.style.display="block";}},touchSwipeBegin:function touchSwipeBegin(touch){hideTooltipGlobal.call(this);if(isScrollableElementTouched.call(this,touch)&&this._super){this._super(touch);}else{this._touchCanceled=true;}},touchSwipeMove:function touchSwipeMove(touch){if(!this._touchCanceled&&this._super){this._super(touch);}},touchSwipeEnd:function touchSwipeEnd(touch){if(!this._touchCanceled&&this._super){this._super(touch);}},getColIdx:function getColIdx(order){var colInfos=this.colInfos,colCount=colInfos.length;for(var i=0;i<colCount;i++){var target=colInfos[i].order.split(":")[0];if(target+":CG"==colInfos[i].order){target=target+":CG";}if(order==target){return colInfos[i].colIdx||i;}}return -1;},buildLeftParent:function buildLeftParent(node,mrow,mcol){var colInfos=this.colInfos,colCount=colInfos.length;if(!this.isKPI){if(mrow==-1){var gts=this.model.gts;var metricIndex=mstrmojo.array.find(gts.col,"n","Metrics");node._e=gts.col[metricIndex].es[colInfos[mcol].order]||{id:"",n:""};node.v=node._e.n;}else{var rows=this.model.gts.row;var currNode=node;for(var i=colCount-1;i>=0;i--){var colInfo=colInfos[i];if(colInfo.type==CHART){continue;}if(colInfo.type==ATTR_NAME){var nodeLP={};var index=mstrmojo.array.find(rows,"id",colInfo.order.split(":")[0]);nodeLP.titleInfo=rows[index];nodeLP._e=this.rows[mrow].model.elms[colInfo.order]||{id:"",n:""};nodeLP.v=nodeLP._e.n;nodeLP.axis=ROW_AXIS;currNode._lp=nodeLP;currNode=nodeLP;}}}}else{if(mcol==0){var gts=this.model.gts;var metricIndex=mstrmojo.array.find(gts.col,"n","Metrics");node._e=gts.col[metricIndex].es[mrow]||{id:"",n:""};node.v=node._e.n;}else{var rows=this.model.gts.row;var currNode=node;for(var i=0;i<rows.length;i++){var nodeLP={};nodeLP.titleInfo=rows[i];var idx=rows[i].es.length;nodeLP._e=rows[i].es[idx-1]||{id:"",n:""};nodeLP.v=nodeLP._e.n;nodeLP.axis=ROW_AXIS;currNode._lp=nodeLP;currNode=nodeLP;}}}},getModelK:function getModelK(){var k=this.model&&this.model.k;return k;},addSCObjToList:function addSCObjToList(scObjList,rowH,n,id){var scObj={};scObj.sc=rowH.sc;scObj.es=n;scObj.eid=id;scObjList.push(scObj);},getSelectionObjForTreeMode:function getSelectionObjForTreeMode(touchedObj){var attrIdxArray=this.attrMapIdx;var me=this,model=me.model,gts=model.gts,rows=gts.row;var scObjList=[];var actionType=0;var selectedAll=false;var treeNode=touchedObj.treeNode;var treePath=treeNode.treePath;var treePathArray=treePath.split("_");var treeLevel=treePathArray.length-1;var isAttrSelectable=this.isAttrSelectable(treeLevel);if(this.closedIfwAttr==treePath){return null;}if(isAttrSelectable){var isTappedNodeSelected=this.lastSelectedObj&&this.lastSelectedObj[treeLevel]&&(this.lastSelectedObj[treeLevel].treePath==treePath);if(!isTappedNodeSelected){this.currSelectedObj=this.getSelectedTreeNodeListFromTreePath(treePathArray);var useFirstAttr=false;var parentTreeNode=this.currSelectedObj[treeLevel];for(var i=treeLevel+1;i<this.lastSelectedObj.length;i++){var thisLevelSelectable=this.isAttrSelectable(i);var thisLevelSelected=!!this.lastSelectedObj[i];if(!thisLevelSelectable||!thisLevelSelected){useFirstAttr=true;this.currSelectedObj[i]=null;parentTreeNode=parentTreeNode.childrenTreeNodeList[0];continue;}if(!useFirstAttr){var attrID=this.lastSelectedObj[i].id;var treeNodeList=parentTreeNode.childrenTreeNodeList;for(var j=0;j<treeNodeList.length;j++){if(attrID==treeNodeList[j].id){this.currSelectedObj[i]=treeNodeList[j];break;}}if(j==treeNodeList.length){useFirstAttr=true;}}if(useFirstAttr){this.currSelectedObj[i]=parentTreeNode.childrenTreeNodeList[0];}parentTreeNode=this.currSelectedObj[i];}selectedAll=false;for(var i=0;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(treeNode){var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];this.addSCObjToList(scObjList,rowH,treeNode.n,treeNode.id);}else{continue;}}}else{for(var i=treeLevel;i<this.lastSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(!treeNode){continue;}var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];var unselectable=rowH.sc&&!(rowH.sc.all==="false"||rowH.sc.all===false);if(treeNode&&!unselectable){break;}else{this.addSCObjToList(scObjList,rowH,treeNode.n,"OA:(All)");this.currSelectedObj[i]=null;}}if(i==treeLevel){return{at:0};}while(this.currSelectedObj.length>0&&!this.currSelectedObj[this.currSelectedObj.length-1]){this.currSelectedObj.pop();}for(;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(treeNode){var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];this.addSCObjToList(scObjList,rowH,treeNode.n,treeNode.id);}else{continue;}}selectedAll=true;}}if(scObjList.length>0){actionType=actionType|SELECTOR_ACTION;var hasInfoWOnNode=this.hasInfoWOnNode(rows[attrIdxArray[treeLevel]]);var anchorNode=selectedAll?null:hasInfoWOnNode?touchedObj.node:null;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}return null;},hasInfoWOnNode:function hasInfoWOnNode(rowH,onlyIfW){var xtabModel=this.xtabModel,docModel=(xtabModel&&xtabModel.docModel);if(docModel){var layouts=docModel.defn&&docModel.defn.layouts,layout=null;var i;if(layouts){for(i in layouts){if(layouts[i].loaded){layout=layouts[i];break;}}}var units=layout&&layout.units;if(units&&rowH){var tksList=rowH.sc.tks.split("\x1E");for(var j=0;j<tksList.length;j++){var unit=units[tksList[j]];if(unit){if(this.isChildOfIfw(units,unit)){if(!onlyIfW){return true;}}else{if(onlyIfW){return false;}}}}}}return onlyIfW?true:false;},getSelectionObjForNonTreeMode:function getSelectionObjForNonTreeMode(touchedObj){var mcol=touchedObj.mcol,mrow=touchedObj.mrow,colInfos=this.colInfos;var attrIdxArray=this.attrMapIdx;var me=this,model=me.model,gts=model.gts,rows=gts.row;var scObjList=[];var actionType=0;var selectedAll=false;var id=colInfos[mcol].order;if(this.isAllAttrSelectable){id=id.split(":")[0];var hasTapRemainCell=this.updateUnselectedRemainCells({mrow:mrow,mcol:mcol});if(hasTapRemainCell){return null;}if(mrow==this.prevSelected.mrow){if(mrow>=0){for(var key in this.ctlMatrix){var obj=this.ctlMatrix[key];if(!obj.sc||!obj.sc.tks){continue;}if(obj.sc.all==="false"||obj.sc.all===false){var i=0;var colInfos=this.colInfos;var colCount=colInfos.length;for(;i<colCount;i++){if(key==colInfos[i].order.split(":")[0]){break;}}this.unselectedRemainCells.push({mrow:mrow,mcol:i});continue;}var selectedIdx=obj.map[mrow];var elementId=obj.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){continue;}selectedAll=true;this.addSCObjToList(scObjList,obj,"","OA:(All)");}if(scObjList.length>0){this.clearPreHighlightRowStatus();this.prevSelected={mrow:-2,mcol:-1};this.updateUnselectedRemainCells();actionType=actionType|SELECTOR_ACTION;var anchorNode=selectedAll?null:touchedObj.node;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}else{this.unselectedRemainCells=[];}return{at:actionType};}}else{this.updateUnselectedRemainCells();this.unselectedRemainCells=[];}if(touchedObj.mrow==-1){}else{if(this.ctlMatrix){this.clearPreHighlightRowStatus();for(var key in this.ctlMatrix){var obj=this.ctlMatrix[key];if(!obj.sc){continue;}if(!obj.sc.tks||(obj.sc.tks=="")){continue;}var selectedIdx=obj.map[mrow];if(obj.es[selectedIdx]){var elementId=obj.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){continue;}this.addSCObjToList(scObjList,obj,"",elementId);}}if(scObjList.length>0){this.rows[mrow].selected[-1]=true;this.prevSelected={mrow:mrow,mcol:-1};actionType=actionType|SELECTOR_ACTION;var anchorNode=selectedAll?null:touchedObj.node;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}}}}else{var isCG=false;if(id.indexOf(":CG")===id.length-3&&id.length>=3){isCG=true;}id=id.split(":")[0];if(this.ctlMatrix&&this.ctlMatrix[id]){var ctlMatrix=this.ctlMatrix[id];var ctlMatrixCG=this.ctlMatrix[id+":CG"];if(ctlMatrix.sc&&ctlMatrix.sc.tks!=""){var elementId="";var isAll=false;if(mrow==-1){}else{var selectedIdx=ctlMatrix.map[mrow];if(ctlMatrix.es[selectedIdx]){elementId=ctlMatrix.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){return ;}}var sameAsLastSelected=function(){var result=ctlMatrix.selectedIdx[selectedIdx];if(ctlMatrixCG){if(ctlMatrixCG.selectedIdx[-1]){return result;}else{return result&&ctlMatrixCG.selectedIdx[ctlMatrixCG.map[mrow]];}}return result;};if(sameAsLastSelected()){var canSelectAll=!(ctlMatrix.sc.all==="false"||ctlMatrix.sc.all===false);if(canSelectAll){elementId="OA:(All)";selectedAll=true;ctlMatrix.selectedIdx={};if(ctlMatrixCG){ctlMatrixCG.selectedIdx={};}this.prevSelected={mrow:-2,mcol:-1};}else{return null;}}else{ctlMatrix.selectedIdx={};ctlMatrix.selectedIdx[selectedIdx]=true;if(ctlMatrixCG){ctlMatrixCG.selectedIdx={};if(isCG){ctlMatrixCG.selectedIdx[ctlMatrixCG.map[mrow]]=true;if(ctlMatrixCG.map[mrow]<ctlMatrixCG.es.length){elementId=ctlMatrixCG.es[ctlMatrixCG.map[mrow]].id;}}else{ctlMatrixCG.selectedIdx[-1]=true;}}this.prevSelected={mrow:mrow,mcol:mcol};}}var scObj={};scObj.sc=ctlMatrix.sc;scObj.eid=elementId;scObjList.push(scObj);}}if(scObjList.length>0){actionType=actionType|SELECTOR_ACTION;var anchorNode=selectedAll?null:touchedObj.node;return{at:actionType,k:this.getModelK(),scObjList:scObjList,anchor:anchorNode};}}return null;},getLinkDrillObjForTreeMode:function getLinkDrillObjForTreeMode(touchedObj){var actionType=0;var linkDrillNode=null;var model=this.model,gts=model.gts,rowHs=gts.row;var mcol=touchedObj.mcol,mrow=touchedObj.mrow,colInfos=this.colInfos;var treeNode=touchedObj.treeNode;var treePath=treeNode.treePath;var treePathArray=treePath.split("_");var treeLevel=treePathArray.length-1;var attrIdxArray=this.attrMapIdx;var id=null;var colInfo=colInfos[mcol];var colType=colInfo&&colInfo.type;if(colType==ATTR_NAME){if(mrow==-1){}else{var rowH=rowHs[attrIdxArray[treeLevel]];if(rowH.lm&&rowH.lm[0]&&rowH.lm[0].links){linkDrillNode={};linkDrillNode.titleInfo=rowH;var treeNode=getTreeNode(this.tree,treePath);linkDrillNode._e=treeNode.es[0]||{n:"",id:""};linkDrillNode.v=linkDrillNode._e.n;}}}else{if(colType==METRIC_VALUE){if(colInfo.lm){id=colInfo.order;var mix=parseInt(id);var metricH=gts.col[0];if(metricH){linkDrillNode={};linkDrillNode.mix=mix;linkDrillNode.titleInfo=metricH;if(mrow==-1){linkDrillNode._e=metricH.es[mix]||{n:"",id:""};linkDrillNode.v=linkDrillNode._e.n;}else{var currNode=linkDrillNode;var treeNode=this.tree;for(var i=0;i<treePathArray.length;i++){var idx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[idx];var attrIdx=attrIdxArray[i];rowH=rowHs[attrIdx];var nodeLP={};nodeLP.titleInfo=rowH;nodeLP._e=treeNode.es[0]||{n:"",id:""};nodeLP.v=nodeLP._e.n;currNode._lp=nodeLP;currNode.axis=ROW_AXIS;currNode=nodeLP;}}}}}}if(linkDrillNode){this.highlightEntireRow=false;actionType=actionType|HYPERLINK_ACTION;return{at:actionType,k:this.getModelK(),node:linkDrillNode};}},getLinkDrillObjForNonTreeMode:function getLinkDrillObjForNonTreeMode(touchedObj){var actionType=0;var model=this.model,gts=model.gts,rowHs=gts.row;var mcol=touchedObj.mcol,mrow=touchedObj.mrow,colInfos=this.colInfos;var node=touchedObj.node,titleInfo;this.highlightEntireRow=false;var attrIdxArray=this.attrMapIdx;var colInfo=colInfos[mcol];if(!this.isKPI){if(linkCount===1&&attrCount===1&&mrow!=-1){for(var key in colInfos){var colInf=colInfos[key];if(colInf.lm&&colInf.type==ATTR_NAME){this.highlightEntireRow=true;var titleInfo=colInf.lm;actionType=titleInfo&&titleInfo.at||HYPERLINK_ACTION;node._e=this.rows[mrow].model.elms[colInf.order]||{id:"",n:""};node.v=node._e.n;break;}}}if(!this.highlightEntireRow){if(colInfo.type==CHART){return null;}var titleInfo=colInfo.lm;if(titleInfo){actionType=titleInfo&&titleInfo.at;if(colInfo.type==ATTR_NAME){if(mrow===-1){node._e={};node._e.onTitle=true;node._e.id=titleInfo.id;node._e.n=titleInfo.n;node.v=titleInfo.n;}else{node._e=this.rows[mrow].model.elms[colInfo.order]||{id:"",n:""};node.v=node._e.n;}}else{if(colInfo.type==METRIC_VALUE){node.mix=colInfo.order;node.axis=ROW_AXIS;this.buildLeftParent(node,mrow,mcol);actionType=this.rows[mrow==-1?0:mrow].model.refv[colInfo.order].at||HYPERLINK_ACTION;}}}}}else{if(colInfo.type==CHART){return null;}var titleInfo=colInfo.lm;var metricIdx=this.rows[mrow].model.metricIdx;if(titleInfo&&titleInfo.lm&&titleInfo.lm[metricIdx]&&titleInfo.lm[metricIdx].links){node.mix=""+metricIdx;node.axis=ROW_AXIS;this.buildLeftParent(node,metricIdx,mcol);actionType=this.rows[mrow].model.refv[0].at||HYPERLINK_ACTION;}else{titleInfo=null;}}if(titleInfo){node.titleInfo=titleInfo;actionType=actionType|HYPERLINK_ACTION;return{at:actionType,mcol:mcol,mrow:mrow,k:this.getModelK(),node:node};}return null;},getActionObj:function getActionObj(touchedObj){var actionObjList=[];if(touchedObj.mrow==-1){return null;}var actionObj=null;if(this.isTreeMode){actionObj=this.getSelectionObjForTreeMode(touchedObj);}else{actionObj=this.getSelectionObjForNonTreeMode(touchedObj);}if(actionObj){actionObjList.push(actionObj);return actionObjList;}else{if(this.isTreeMode){actionObj=this.getLinkDrillObjForTreeMode(touchedObj);}else{actionObj=this.getLinkDrillObjForNonTreeMode(touchedObj);}actionObjList.push(actionObj);}return actionObjList;},getDefaultHighlightRow:function getDHR(){var attrIdxArray=this.attrMapIdx;var rows=this.model.gts.row;if(!this.isTreeMode){if(this.isAllAttrSelectable){var isAllSelected=false;var resultSet=null,controlMatrix=null;var hasOnlyIfwTarget=true;var colInfos=this.colInfos,colCount=colInfos.length;for(var i=0;i<colCount;i++){var colInfo=colInfos[i],id=colInfo.order;var trueId=id.split(":")[0];if(id!=trueId+":CG"){id=trueId;}controlMatrix=this.ctlMatrix[id];if(controlMatrix){if(!this.hasInfoWOnNode(controlMatrix,true)){hasOnlyIfwTarget=false;}if(controlMatrix.selectedIdx[-1]){isAllSelected=true;this.prevSelected={mrow:-1,mcol:i};}else{colInfo.selected=false;}if(!isAllSelected){if(!resultSet){resultSet={};for(var j=0;j<controlMatrix.map.length;j++){if(controlMatrix.selectedIdx[controlMatrix.map[j]]){resultSet[j]=true;}}}else{for(var j in resultSet){if(!controlMatrix.selectedIdx[controlMatrix.map[j]]){delete resultSet[j];}}}}}}if(hasOnlyIfwTarget){for(key in this.ctlMatrix){var obj=this.ctlMatrix[key];obj.selectedIdx={};}}if(hasOnlyIfwTarget||isAllSelected||!resultSet||Object.keys(resultSet).length!==1){}else{console.log("xiawang: The selected row is:"+JSON.stringify(resultSet));var selectedRow=parseInt(Object.keys(resultSet)[0]);this.prevSelected={mrow:selectedRow,mcol:-1};if(this.rows[selectedRow]){this.rows[selectedRow].selected[-1]=true;}for(key in this.ctlMatrix){var obj=this.ctlMatrix[key];obj.selectedIdx={};}}}else{var hasOnlyIfwTarget=true;for(key in this.ctlMatrix){var controlMatrix=this.ctlMatrix[key];var checkThisAttr=false;for(var sIdx in controlMatrix.selectedIdx){checkThisAttr=true;}if(checkThisAttr&&!this.hasInfoWOnNode(controlMatrix,true)){hasOnlyIfwTarget=false;break;}}if(hasOnlyIfwTarget){for(key in this.ctlMatrix){var obj=this.ctlMatrix[key];obj.selectedIdx={};}}}}else{if(this.currSelectedObj&&this.currSelectedObj.length<=0){var resultSet=null,controlMatrix=null;this.currSelectedObj=[];var findTreeNodeByAttrElemIdx=function(treeNodeList,attrElemIdx){var treeNodeCount=treeNodeList.length;for(var i=0;i<treeNodeCount;i++){var treeNode=treeNodeList[i];if(treeNode.attrElemIdx==attrElemIdx){return treeNode;}}return null;};var me=this;var findCurrSelectedObjByAttrElemIdx=function(tree,level){var id=me.attrIDArray[level];controlMatrix=me.ctlMatrix[id];var treeNodeList=tree.childrenTreeNodeList;var treeNodeCount=treeNodeList.length;if(treeNodeCount<=0){return ;}var treeNode=null;if(controlMatrix){for(var key in controlMatrix.selectedIdx){treeNode=findTreeNodeByAttrElemIdx(treeNodeList,key);}if(treeNode){me.currSelectedObj[level]=treeNode;findCurrSelectedObjByAttrElemIdx(treeNode,level+1);return true;}}else{me.currSelectedObj[level]=null;for(var i=0;i<treeNodeCount;i++){var find=findCurrSelectedObjByAttrElemIdx(treeNodeList[i],level+1);if(find){return true;}}}return false;};findCurrSelectedObjByAttrElemIdx(this.tree,0);while(this.currSelectedObj.length>0&&!this.currSelectedObj[this.currSelectedObj.length-1]){this.currSelectedObj.pop();}var hasOnlyIfwTarget=true;for(var i=0;i<this.currSelectedObj.length;i++){var treeNode=this.currSelectedObj[i];if(treeNode){var attrIdx=attrIdxArray[i];rowH=rows[attrIdx];if(!this.hasInfoWOnNode(rowH,true)){hasOnlyIfwTarget=false;break;}}else{continue;}}if(hasOnlyIfwTarget){this.currSelectedObj=[];}this.lastSelectedObj=$HASH.clone(this.currSelectedObj);return ;}}},updateSelectedStatus:function updateSS(tree){if(this.isTreeMode){this.updateTreeSelection(tree);}else{if(!this.isAllAttrSelectable||this.unselectedRemainCells.length>0){if(!this.ctlMatrix){return ;}var update=function(key){var pureId=key.split(":")[0],ctlMatrix=this.ctlMatrix[pureId],ctlMatrixCG=this.ctlMatrix[pureId+":CG"];var colInfos=this.colInfos,selectedIdx=ctlMatrix.selectedIdx,colIdx=ctlMatrix.colIdx;if(ctlMatrixCG&&!ctlMatrixCG.selectedIdx[-1]){ctlMatrix=ctlMatrixCG;}var map=ctlMatrix.map,rows=this.rows,rowCount=rows.length,selectedIdx=ctlMatrix.selectedIdx,colIdx=this.ctlMatrix[key].colIdx,assAttr=colInfos[colIdx].associateAttr;for(var i=0;i<rowCount;i++){var rowInfo=rows[i];if(selectedIdx[map[i]]){rowInfo.selected[colIdx]=true;for(var idx in assAttr){rowInfo.selected[assAttr[idx]]=true;}}else{rowInfo.selected[colIdx]=false;for(var idx in assAttr){rowInfo.selected[assAttr[idx]]=false;}}}};for(var key in this.ctlMatrix){update.call(this,key);}}}},hasOnlyInfoWindowTarget:function hasOnlyInfoWindowTarget(){},performAction:function performAction(actionObjList){this.hasNonifwTarget=this.hasNoninfowindowTarget(actionObjList[0]);if(this._super){this._super(actionObjList);}},clearPreHighlightRowStatus:function clearPreHighlightRowStatus(pass){var mrow=this.prevSelected.mrow,mcol=this.prevSelected.mcol;if(mrow==-2){return ;}if(mcol==-1){this.rows[mrow].selected[-1]=false;}else{if(mrow==-1){for(var i=0;i<this.colInfos.length;i++){var colInfo=this.colInfos[i];if(colInfo.selected){colInfo.selected=false;}}}else{this.rows[mrow].selected[mcol]=false;}}},updateUnselectedRemainCells:function uurc(tappedCell){var hasTapRemainCell=false;for(var i=this.unselectedRemainCells.length-1;i>=0;i--){cell=this.unselectedRemainCells[i];var id=order[cell.mcol];var isCG=false;if(id.indexOf(":CG")===id.length-3&&id.length>=3){isCG=true;}else{id=id.split(":")[0];}var obj=this.ctlMatrix[id];var anotherObj=undefined;if(isCG){anotherObj=this.ctlMatrix[id.split(":")[0]];}else{anotherObj=this.ctlMatrix[id+":CG"];}if(obj.sc&&obj.sc.tks!=""){if(anotherObj&&!anotherObj.sc){anotherObj=undefined;}var selectedIdx=obj.map[cell.mrow];elementId=obj.es[selectedIdx].id;if(!elementId||elementId.substring(0,1)==="D"){continue;}else{if(obj.selectedIdx[selectedIdx]){if(tappedCell){if(cell.mcol==tappedCell.mcol){var tappedID=order[cell.mcol].split(":")[0];var tappedCtlMatrix=this.ctlMatrix[tappedID];var tappedIdx=tappedCtlMatrix.sc&&tappedCtlMatrix.map[tappedCell.mrow];if(tappedIdx==selectedIdx){hasTapRemainCell=true;}}continue;}obj.selectedIdx={};}else{obj.selectedIdx={};obj.selectedIdx[selectedIdx]=true;if(anotherObj){if(elementId.indexOf("BE")===0||elementId.indexOf("Z")===0){}else{anotherObj.selectedIdx={};anotherObj.selectedIdx[selectedIdx]=true;}}}}}}return hasTapRemainCell;},highlightCellsByRowInfo:function highlightCellsByRowInfo(rowInfo){var rowRef=rowInfo.rowRef;if(!rowRef){return ;}var trL=rowRef[LEFT_CHART_ROW];var trR=rowRef[RIGHT_CHART_ROW];var tdsL=trL&&trL.childNodes;var tdsR=trR&&trR.childNodes;var tdsLLen=tdsL&&tdsL.length||0,tdsRLen=tdsR&&tdsR.length||0;var colCount=tdsLLen+tdsRLen;for(var i=0;i<colCount;i++){var td=i<tdsLLen?tdsL[i]:tdsR[i-tdsLLen];if(rowInfo.selected[i]){this.highlightCell(td);}else{this.unHighlightCell(td);}}},setSelectedStyle:function setSelectedStyle(level){if(level==0){this.selectedStyle="background-color:#015DE6;color:#FFFFFF;";}else{if(level==1){this.selectedStyle="background-color:rgba(1,93,230, 0.7);color:#FFFFFF;";}else{this.selectedStyle="background-color:rgba(1,93,230, 0.5);color:#FFFFFF;";}}},highlightTreeArrow:function highlightTreeArrow(rowInfo){if(this.treeColumnIdx>-1&&this._leftChart){this._leftChart.setTreeArrow(rowInfo,"white");}},unHighlightTreeArrow:function unHighlightTreeArrow(rowInfo){if(this.treeColumnIdx>-1&&this._leftChart){this._leftChart.setTreeArrow(rowInfo);}},highlightCell:function highlightCell(td,isHeaderTable){if(isHeaderTable){setNodeCssText(td,TH_SELECTED_CSS+this.selectedStyle);}else{setNodeCssText(td,TD_SELECTED_CSS+this.selectedStyle);}if(this.selectedClass&&this.selectedClass.length>0){$CSS.addClass(td,this.selectedClass);}},unHighlightCell:function unHighlightCell(td,isHeaderTable){if(isHeaderTable){setNodeCssText(td,DEFAULT_TH_CSS);}else{setNodeCssText(td,DEFAULT_TD_CSS);}if(this.selectedClass&&this.selectedClass.length>0){$CSS.removeClass(td,this.selectedClass);}},highlightForLD:function highlightForLD(mrow,mcol,node){if(this.highlightEntireRow&&!this.isTreeMode){this.highlightRowByRowInfo(this.rows[mrow]);}else{if(node){this.highlightCell(node);}var colInfo=this.colInfos[mcol],aAttr=colInfo.associateAttr;var siblings=node.parentNode.childNodes;for(var idx in aAttr){this.highlightCell(siblings[aAttr[idx]]);if(this.treeColumnIdx==idx){this.highlightTreeArrow(this.rows[mrow]);}}}},highlightRowByRowInfo:function highlightRowByRowInfo(rowInfo){var rowRef=rowInfo.rowRef;if(!rowRef){return ;}var level=rowInfo.treeNode?rowInfo.treeNode.level:0;this.setSelectedStyle(level);if(rowRef[LEFT_CHART_ROW]){this.highlightRow(rowRef[LEFT_CHART_ROW]);}if(rowRef[RIGHT_CHART_ROW]){this.highlightRow(rowRef[RIGHT_CHART_ROW]);}this.highlightTreeArrow(rowInfo);},highlightRow:function highlightRow(tr){var tds=tr.childNodes;for(var i=0;i<tds.length;i++){setNodeCssText(tds[i],TD_SELECTED_CSS+this.selectedStyle);if(this.selectedClass&&this.selectedClass.length>0){$CSS.addClass(tds[i],this.selectedClass);}}},unHighlightRowByRowInfo:function unHighlightRowByRowInfo(rowInfo){var rowRef=rowInfo.rowRef;if(!rowRef){return ;}if(rowRef[LEFT_CHART_ROW]){this.unHighlightRow(rowRef[LEFT_CHART_ROW]);}if(rowRef[RIGHT_CHART_ROW]){this.unHighlightRow(rowRef[RIGHT_CHART_ROW]);}this.unHighlightTreeArrow(rowInfo);},unHighlightRow:function unHighlightRow(tr){var tds=tr.childNodes;for(var i=0;i<tds.length;i++){setNodeCssText(tds[i],DEFAULT_TD_CSS);if(this.selectedClass&&this.selectedClass.length>0){$CSS.removeClass(tds[i],this.selectedClass);}}},isAttrSelectable:function isAttrSelectable(treeLevel){var attrID=this.attrIDArray[treeLevel];var ctlMatrix=this.ctlMatrix[attrID];if(ctlMatrix){return true;}return false;},updateTreeSelection:function updateTreeSelection(tree){this.selectOrClearTreeNodes(tree,true,0);this.selectOrClearTreeNodes(tree,false,0);},findTheTreeNodeWithSameID:function findTheTreeNodeWithSameID(treeNodeList,id){var treeNodeCount=treeNodeList.length;for(var i=0;i<treeNodeCount;i++){var treeNode=treeNodeList[i];if(treeNode.id==id){return treeNode;}}return null;},selectOrClearTreeNodes:function selectOrClearTreeNodes(treeNode,clear,treeLevel){if(!treeNode){return ;}if(clear&&this.lastSelectedObj.length<=treeLevel){return ;}if(!clear&&this.currSelectedObj.length<=treeLevel){return ;}var tappedTreeNode=null;if(clear){tappedTreeNode=this.lastSelectedObj[treeLevel];}else{tappedTreeNode=this.currSelectedObj[treeLevel];}var treeNodeList=treeNode.childrenTreeNodeList,treeNodeCount=treeNodeList.length;if(tappedTreeNode){treeNode=this.findTheTreeNodeWithSameID(treeNodeList,tappedTreeNode.id);if(treeNode){treeNode.selected=clear?false:true;this.selectOrClearTreeNodes(treeNode,clear,treeLevel+1);}}else{for(var i=0;i<treeNodeCount;i++){this.selectOrClearTreeNodes(treeNodeList[i],clear,treeLevel+1);}}},updateHighlightForCurrRenderRows:function updateHighlightForCurrRenderRows(){var rows=this.rows;var rowCount=rows.length,rowInfo=null;for(var i=this.startCnt;i<this.endCnt;i++){rowInfo=rows[i];if(this.isTreeMode){if(rowInfo.treeNode.selected){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}else{if(this.isAllAttrSelectable){if(rowInfo.selected[-1]){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}else{this.highlightCellsByRowInfo(rowInfo);}if(this.unselectedRemainCells.length>0){this.highlightCellsByRowInfo(rowInfo);}}}if(this.isTreeMode){rows=this.dockedHeaderRows;rowCount=rows.length;for(var i=0;i<rowCount;i++){rowInfo=rows[i];if(rowInfo.treeNode.selected){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}rows=this.dockedHeaderReplaceRows;rowCount=rows.length;for(var i=0;i<rowCount;i++){rowInfo=rows[i];if(rowInfo.treeNode.selected){this.highlightRowByRowInfo(rowInfo);}else{this.unHighlightRowByRowInfo(rowInfo);}}}},getSelectedTreeNodeListFromTreePath:function getSelectedTreeNodeListFromTreePath(treePathArray){if(!treePathArray){return[];}var treeNodeList=[];var treeNode=this.tree;for(var i=0;i<treePathArray.length;i++){var treeNodeIdx=treePathArray[i];treeNode=treeNode.childrenTreeNodeList[treeNodeIdx];if(!treeNode){break;}if(this.isAttrSelectable(i)){treeNodeList[i]=treeNode;}else{treeNodeList[i]=null;}}return treeNodeList;},multiTap:true,touchTap:function(touch){var widget=this;if(widget.tooltip.style.display==="block"){hideTooltipGlobal.call(this);return ;}var td=mstrmojo.dom.findAncestorByAttr(touch.target,"mcol",true,this.domNode);if(!td){this._leftChart.dockedHeaderReplaceDiv.style.display="none";touch.target=document.elementFromPoint(touch.pageX,touch.pageY);td=mstrmojo.dom.findAncestorByAttr(touch.target,"mcol",true,this.domNode);this._leftChart.dockedHeaderReplaceDiv.style.display="";}if(td&&td.node){var mrow=parseInt(td.node.getAttribute("mrow"));var mcol=parseInt(td.node.getAttribute("mcol"));if(mrow==-1){return ;}if(this.isTreeMode){if(mrow>=0){var rowInfo=this.rows[mrow];var treeNode=rowInfo&&rowInfo.treeNode;if(touch.count==2||(touch.count==1&&mcol==this.treeColumnIdx)){if(!treeNode.isLeaf){this.rowsNeedRebuild=true;var rowType=td.node.parentNode.getAttribute("rowType");if(treeNode.needExpand){collapseTreeNodeAndSetScrlPos.call(this,rowInfo,rowType);}else{expandTreeNodeAndSetScrlPos.call(this,rowInfo,rowType);}}return ;}}var touchedObj={node:td.node,treeNode:treeNode,mcol:mcol,mrow:mrow};var actionObjList=this.getActionObj(touchedObj);var actionObj=actionObjList&&actionObjList[0];if(actionObj){if(actionObj.at&SELECTOR_ACTION){var doHighlight=!(this.isAndroidPhone&&actionObj.anchor);if(doHighlight){this.updateSelectedStatus(this.tree);this.updateHighlightForCurrRenderRows();this.lastSelectedObj=$HASH.clone(this.currSelectedObj);}}else{if(actionObj.at&HYPERLINK_ACTION){this.highlightForLD(mrow,mcol,td.node);}}this.performAction(actionObjList);return ;}}else{var actionObjList=this.getActionObj({mcol:mcol,mrow:mrow,node:td.node});var actionObj=actionObjList&&actionObjList[0];if(actionObj){if(actionObj.at&SELECTOR_ACTION){var doHighlight=!(this.isAndroidPhone&&actionObj.anchor);if(doHighlight){this.updateSelectedStatus();this.updateHighlightForCurrRenderRows();}}else{if(actionObj.at&HYPERLINK_ACTION){this.highlightForLD(mrow,mcol,td.node);}}this.performAction(actionObjList);return ;}}var me=this;var tr=td.node.parentNode;var rowInfo=null;if(tr.getAttribute("rowType")==DOCKED_HEADER){var dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderRows,mrow);if(dockedHeaderIdx>=0){rowInfo=this.dockedHeaderRows[dockedHeaderIdx];}else{dockedHeaderIdx=getIdxByRowIdx(this.dockedHeaderReplaceRows,mrow);rowInfo=this.dockedHeaderReplaceRows[dockedHeaderIdx];}}else{rowInfo=this.rows[mrow];}var touchedChart=rowInfo&&rowInfo.rowRef&&rowInfo.rowRef[mcol];if(touchedChart){this.showChartTooltip(touchedChart,touch);}}},shouldTouchBubble:function shouldTouchBubble(touch){var isVertical=touch.isVertical;return isVertical?this._super(touch):this.enableSmoothScroll&&isScrollableElementTouched.call(this,touch)?false:true;},multiTouch:true,touchMultiBegin:function(touch){hideTooltipGlobal.call(this);this.initTouchObj=touch;var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:100,pageY:100,target:touch.target};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;this.initDiffDiff=xDiff*xDiff+yDiff*yDiff;this.relScaleFactor=1;var td1=mstrmojo.dom.findAncestorByAttr(touch1.target,"mrow",true,this.domNode);var td2=mstrmojo.dom.findAncestorByAttr(touch2.target,"mrow",true,this.domNode);if(td1&&td1.value&&td2&&td2.value){this.centerRowIdx=Math.round((parseInt(td1.value)+parseInt(td2.value))/2);}else{this.centerRowIdx=this.firstRowIdxOnScrn;}},touchMultiMove:function(touch){var touch1;var touch2;if(touch.evt.touches&&touch.evt.touches.length==2){touch1=touch.evt.touches[0];touch2=touch.evt.touches[1];}else{touch1=touch;touch2={pageX:100,pageY:100};}var xDiff=touch1.pageX-touch2.pageX;var yDiff=touch1.pageY-touch2.pageY;this.curDiffDiff=xDiff*xDiff+yDiff*yDiff;},touchMultiEnd:function(touch){if(this.isTreeMode){if(this.curDiffDiff>this.initDiffDiff){this.onPinchOpen();}else{if(this.curDiffDiff<this.initDiffDiff){this.onPinchClose();}}}},onPinchOpen:function onPinchOpen(){var currLowestLevel=getLowestLevelOnScreen.call(this);var levelToExpand=currLowestLevel;if(levelToExpand>=this.maxTreeLevel){levelToExpand=this.maxTreeLevel-1;}var anchorRowTreeNode=this.rows[this.centerRowIdx].treeNode;var anchorRowIdxOnScrn=this.centerRowIdx-this.firstRowIdxOnScrn;expandOrCollapseTreeAndSetScrlPos.call(this,levelToExpand,anchorRowTreeNode,anchorRowIdxOnScrn);},onPinchClose:function onPinchClose(){var currLowestLevel=getLowestLevelOnScreen.call(this);var levelToExpand=currLowestLevel-2;if(levelToExpand<-1){levelToExpand=-1;}var anchorRowTreeNode=this.rows[this.centerRowIdx].treeNode;if(anchorRowTreeNode.level>levelToExpand+1){anchorRowTreeNode=getParentTreeNodeAtLevel(this.tree,anchorRowTreeNode.treePath,levelToExpand+1);}var anchorRowIdxOnScrn=this.centerRowIdx-this.firstRowIdxOnScrn;expandOrCollapseTreeAndSetScrlPos.call(this,levelToExpand,anchorRowTreeNode,anchorRowIdxOnScrn);},destroyChartWidget:function destroyChartWidget(){if(this.rows&&this.rows.length>0&&this.rowsReusePool){this.pushToReusePool();}if(this.dockedHeaderRows&&this.dockedHeaderReplaceRows){this.clearDockedHeader();}if(this.rowsReusePool&&this.rowsReusePool.length>0){var rows=this.rowsReusePool,rowCount=rows.length,colInfos=this.colInfos,colCount=colInfos.length;for(var i=0;i<rowCount;i++){var rowRef=rows[i];if(rowRef[LEFT_CHART_ROW]){delete rowRef[LEFT_CHART_ROW];}if(rowRef[RIGHT_CHART_ROW]){delete rowRef[RIGHT_CHART_ROW];}for(var j=0;j<colCount;j++){var w=rowRef[colInfos[j].colIdx];if(w&&w.destroy){w.destroy();delete rowRef[colInfos[j].colIdx];}}}this.rowsReusePool=[];}},destroy:function destroy(){console.log("in destroy");var listener=this._touchListener;if(listener){mstrmojo.touchManager.detachEventListener(listener);delete this._touchListener;}if(this._infoWClosedListener){mstrmojo.touchManager.detachEventListener(this._infoWClosedListener);delete this._infoWClosedListener;}this.destroyChartWidget();if(this._leftChart){this._leftChart.destroy();delete this._leftChart;}if(this._rightChart){this._rightChart.destroy();delete this._rightChart;}if(this.rows){delete this.rows;}if(this.rowsReusePool){delete this.rowsReusePool;}if(this.selectorTargets){delete this.selectorTargets;}this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.VisTimeSeries");mstrmojo.DocVisTimeSeries=mstrmojo.declare(mstrmojo.VisTimeSeries,null,{scriptClass:"mstrmojo.DocVisTimeSeries"});}());(function(){mstrmojo.requiresCls("mstrmojo.VisTimeSeries");mstrmojo.AndroidVisTimeSeries=mstrmojo.declare(mstrmojo.VisTimeSeries,null,{scriptClass:"mstrmojo.AndroidVisTimeSeries"});}());(function(){mstrmojo.requiresCls("mstrmojo.DynamicClassFactory","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo.AndroidInteractiveGridXtab","mstrmojo.DocXtabModel","mstrmojo.DocInteractiveGridXtab","mstrmojo.AndroidVisTimeSeries","mstrmojo.DocVisTimeSeries","mstrmojo.VisMicroChart","mstrmojo.maps.AndroidRptMap","mstrmojo.maps.AndroidMapModel","mstrmojo.maps.AndroidDocMap","mstrmojo.ImageCarousel","mstrmojo.PhotoUploader","mstrmojo.AndroidVisMap","mstrmojo.VisHeatMap");var B={AndroidImageMapStyle:{s:"ImageMapVisualizationDataStyle",c:"AndroidVisMap"},MicroChartsVisualizationStyle:{s:"MicroChartVisualizationDataStyle",c:"VisMicroChart"},TimeSeriesAjaxVisualizationStyle:{dc:"DocVisTimeSeries",s:"TimeSeriesVisualizationDataStyle",c:"AndroidVisTimeSeries"},ImageViewerVisualizationStyle:{s:"VisualizationDataStyle",c:"ImageCarousel"},AndroidPhotoUploaderStyle:{s:"VisualizationDataStyle",c:"PhotoUploader"},HeatMapVisualizationStyle:{s:"HeatMapVisualizationDataStyle",c:"VisHeatMap"},AndroidMapStyle:{dc:"maps.AndroidDocMap",s:"MapVisualizationDataStyle",c:"maps.AndroidRptMap",m:"maps.AndroidMapModel"},InteractiveGridAjaxVisualizationStyle:{dc:"DocInteractiveGridXtab",s:"InteractiveGridDataStyle",c:"AndroidInteractiveGridXtab",m:"DocXtabModel"}};mstrmojo.AndroidVisList=mstrmojo.provide("mstrmojo.AndroidVisList",{getVis:function C(D){return B[D]||null;},getVisClass:function A(D,E){if(E.txi&&E.t===115){D=mstrmojo.DynamicClassFactory.newComponent(D,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.base64","mstrmojo.Dialog");mstrmojo.requiresDescs(1442,2140,5369,8233,8232,8313,8322);var V=8,P=16,W=4,T=1,R=8,B=16,O=268435456,I=536870912,A=1073741824,F=window.mstrConfig&&!window.mstrConfig.simpleDialog,L=2147755235,J=2147755236;var S=mstrmojo.Button.newInteractiveButton;function C(e,b,a,Y,Z){if(F){var d=[S(Y||mstrmojo.desc(1442),b||null,null),S(Z||mstrmojo.desc(2140),a||null,null)];mstrmojo.confirm(e,mstrApp.useBinaryFormat?d.reverse():d);}else{if(mstrmojo.confirm(e)){if(b){b();}}else{if(a){a();}}}}function X(Z,Y){if(F){mstrmojo.alert(Z,Y);}else{mstrmojo.alert(Z);if(Y){Y();}}}mstrmojo.DocActionSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.DocActionSelector",extCls:"mstrmojo-ActionSelector",type:V,targets:null,initControlInfo:function E(){var Y=this.node.defn;this.aa=parseInt(Y.aa,10);this.dpTxt=Y.dpTxt||{8:mstrmojo.desc(5369),4:mstrmojo.desc(8233),16:mstrmojo.desc(8232)}[this.aa]||"";this.dpCfm=Y.dpCfm;this.sac=parseInt(Y.sac,10);this.msg=Y.msg;this.rsid=Y.rsid;this.rst=Y.rst;this.node.data.elms=[{n:this.dpTxt,v:this.dpTxt}];this._super();},selectorControlChange:function K(Y){if(Y.selectedIndex!==0){return ;}this.executeAction();Y.select([]);},executeAction:function N(){var Z=this.aa,Y=this;if(Z===V){if(this.dpCfm){C(mstrmojo.desc(8313),function(){Y.onControllerCheck();});}else{Y.onControllerCheck();}}else{if(Z===W){if(this.dpCfm){C(mstrmojo.desc(8322),function(){Y.onDiscard();});}else{Y.onDiscard();}}else{this.onRecalculate();}}},onControllerCheck:function H(){this.onCommit();},onCommit:function M(){var b=this,d=this.model,Z=b.controller,Y=mstrApp.useBinaryFormat;if(!Y&&!this.validateRequiredObjects()){X(mstrmojo.desc(9200));return ;}var a=function(e){if((b.sac&I)>0){Z.invalidClientCache();}if((b.sac&B)>0){var f={did:b.rsid,objType:b.rst,forceExec:(b.sac&O)>0};if((b.sac&A)>0){f.linkAnswers='<hl mid="'+d.mid+'" srct="2" aopam="1"><prms></prms></hl>';}Z.onExecuteNewObject(b,f);}else{if((b.sac&R)>0){Z.onReExecute(b);}else{if(mstrApp.isMobile){Z.generateActionToolbar();}d.transactionUpdate(e);}}};mstrmojo.mask.show("Running");d.sendTransactionActions(this.ck,V,d.newCallback({success:function(e){mstrmojo.mask.hide();if(d.txrcd||e.offln){Z.offlineTransactionsSubmitted(b.ck);}if(e.offln){if(Y&&!b.networkToastShowed){b.networkToastShowed=true;mstrmojo.toast(mstrmojo.desc(9258,"No Network Connectivity")+". "+mstrmojo.desc(9259,"Transaction will be submitted when connectivity is resumed."));}d.transactionUpdate(e);}else{if((b.sac&T)>0&&b.msg){if(Y){mstrmojo.toast(b.msg);window.setTimeout(function(){a(e);},100);}else{X(b.msg,function(){a(e);});}}else{a(e);}}},failure:function(g){var e=mstrmojo.all.mojoAlertx9;if(e){e.destroy();}mstrmojo.mask.hide();if(d.txrcd){Z.offlineTransactionsSubmitted(b.ck);}var f=4294967296+parseInt(g.code,10);if(f===L){if(Y){b.validateRequiredObjects();}X(mstrmojo.desc(9200,"You have some required inputs that are not modified."));}else{if(f===J){var h=mstrmojo.desc(9201,"You haven't made any changes to submit.");if(Y){mstrmojo.toast(h);}else{X(h);}}else{X(mstrmojo.base64.decodeHttpHeader(g.message),function(){if(!Y){b.controller.onReExecute(b,true);}});}}}}));},onDiscard:function D(){var Z=this,a=this.model,Y=Z.controller;a.txDiscardTargets=this.getTxTargets();a.sendTransactionActions(this.ck,W,{success:function(b){a.transactionUpdate(b);Y.transactionDiscarded(Z.ck);},complete:function(){delete a.txDiscardTargets;if(mstrApp.isMobile){Y.generateActionToolbar();}}});},onRecalculate:function G(){this.model.sendTransactionActions(this.ck,P);},getTxTargets:function U(){var f=this.tks.split("\u001E"),e,Y,d,g,Z,a,b={};for(e=0,Y=f.length;e<Y;e++){d=f[e];g=1;do{Z=this.model.getUnitInstance(d,g++);if(Z&&Z.checkRequiredObjects){if(Z.isPanelStack){for(a in Z.txWidgets){b[Z.txWidgets[a].id]=1;}}else{b[Z.id]=1;}}else{break;}}while(true);}return b;},validateRequiredObjects:function Q(){var Y=true,Z;for(Z in this.getTxTargets()){Y=mstrmojo.all[Z].checkRequiredObjects()&&Y;}return Y;}});}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.NumberFormat","mstrmojo.Button");var O=mstrmojo.desc,K=mstrmojo.Button.newInteractiveButton,b=mstrmojo.date,AC=function(){return mstrmojo.locales.datetime;};function W(AE,AF){mstrmojo.form.send(AF,null,"post");}function AB(AG,AF){var AE=AG.model;W(AG,{evt:3124,src:mstrApp.name+"."+mstrApp.pageName+".3124",relativePageNumber:AF,messageID:AE.mid,rwb:AE.bs});}function e(AG,AH){var AE=AG.model;var AF={evt:2048001,messageID:AE.mid,rwb:AE.bs};if(AH<50||AH===2048){AF.visMode=0;AF.currentViewMedia=AH;}else{AF.visMode=AH;AF.currentViewMedia=1;}W(AG,AF);}function J(AF){var AE=mstrApp.prevViewMedia;if((!AE&&AE!==0)||AE===-1){AB(AF,-1);}else{if(AE===0){AF.designViewMode();}else{e(AF,AE);}}}function AD(AI,AF,AH,AG){var AE=AI.model;W(AI,{evt:2048030,src:AE.bp+".2048030",rePrompt:AF,fresh:AH,regenerate:AG,rwb:AE.bs});}function Q(AM,AF){var AI=AM.model,AJ=(AI&&AI.ztp)||0,AG=(AI&&AI.zf)||1,AE=AJ+":"+AG,AH=AM.zoomOptions,AK;if(AH){var AL=mstrmojo.array.find(AH,"dssid",AE);if(AL>-1){AK=AH[AL];}}if(!AK){AK={n:parseInt(AG*100,10)+"%",dssid:AE,f:AG,tp:AJ};}if(AF===true){AM.zoomValue=AK;}else{AM.set("zoomValue",AK);}}function M(AK,AM,AG,AL,AI,AJ){var AH=AK.model,AE=AH&&AH.dty;if(!AE){AL(AK,AI);return ;}var AF="#666";mstrmojo.confirm(AG,[K(O(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");AK.save(AJ);},AF),K(O(2140),null,AF)],AM);}function q(AF){var AE=AF.model;AE.showDialogBeforeSave=false;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){},failure:function(AG){mstrmojo.alert(AG.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"askBeforeSaveChanges\u001E2"});}var x=-1,Z=3,l=4,G=7;mstrmojo._DocOIVMMethods={staticViewMode:function B(){e(this,1);},interactiveViewMode:function H(){e(this,2);},editableMode:function k(){e(this,4);},flashViewMode:function d(){e(this,8);},IVEMode:function N(){e(this,2048);},IVEHelp:function N(){var AE=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/MicroStrategy_Web_Help.htm#";window.open(AE+"about_interactive_visual_data_exploration.htm","_blank");return true;},remainExpressViewMode:function L(){},designViewMode:function s(){W(this,{evt:3104,rwDesignMode:1,messageID:this.model.mid,rwb:this.model.bs});},convertToDoc:function j(){var AE=this;mstrmojo.confirm(O(8127),[K(O(1442),function(){AE.designViewMode();},null),K(O(2140),null,null)]);},saveAs:function(AE){this.save();},save:function U(AF){var AE=this.model;W(this,mstrmojo.hash.copy(AF,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:AE.sfid||AE.pfid,saveFromDesignMode:false,rwb:AE.bs}));},dSave:function AA(){var AK=this,AG=AK.model,AI=AG&&AG.isnew,AF=AG&&AG.isRWReadonly;maxLen=60;truncateName=AG.n;if(truncateName.length>maxLen){truncateName=truncateName.substr(0,maxLen-1)+"...";}if(AI||AF){this.save();}else{var AH=mstrApp.features["ask-before-save-changes"],AJ="#666";if(AH){var AL="dialogBeforeSave",AE=function(){mstrmojo.all.dialogBeforeSave.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:AL,title:O(5728),cssText:"min-width:475px;max-width:600px;",btnAlignment:"right",buttons:[K(O(1442),function(){var AM=mstrmojo.all[AL];if(AM.t.ctrlChk.checked){AK.setDontAskAgain();mstrApp.features["ask-before-save-changes"]=false;}AK.directSave();AE();},AJ),K(O(218),function(){var AM=mstrmojo.all[AL];if(AM.t.ctrlChk.checked){q(AK);}AK.save();AE();},AJ),K(O(2140),AE,AJ)],children:[{scriptClass:"mstrmojo.Table",alias:"t",rows:2,cols:1,children:[{scriptClass:"mstrmojo.Label",text:O(11165).replace(/##/,"<b>"+truncateName+"</b>"),visible:true,cssText:"height:60px;",slot:"0,0"},{scriptClass:"mstrmojo.CheckBox",label:O(211),alias:"ctrlChk",visible:true,checked:false,slot:"1,0"}]}]}).render();}else{AK.directSave();}}},setDontAskAgain:function F(){var AF=this,AE=AF.model;AE.showDialogBeforeSave=false;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){},failure:function(AG){mstrmojo.alert(AG.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"askBeforeSaveChanges\u001E0"});},directSave:function P(){var AG=this,AE=AG.model;var AF=mstrmojo.string.decodeHtmlString(AE.n);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){mstrmojo.alert(O(3336).replace("##",AE.n));},failure:function(){mstrmojo.alert(O(4107));}},{taskId:"saveRW",msgID:AE.mid,folderID:AE.sfid||AE.pfid,objName:AF,objDesc:AE.desc,saveAsFlags:1,taskEnv:"xhr",taskContentType:"json"});},browseParent:function p(){var AE=this.model,AF={evt:3010};if(!AE.pfh){AF.evt=2001;AF.folderID=AE.pfid;if(AE.sysFolder){AF.systemFolder=AE.sysFolder;}}W(this,AF);},close:function f(){J(this);},openPage:function V(AE){AB(this,AE);},saveToInbox:function g(){var AE=this;mstrApp.serverRequest({taskId:"addDocToHistoryList",rwb:AE.model.bs},{success:function(){var AF=AE.model.features;if(AF){if(AF.set){AF.set("enable-add-history-list",false);}else{AF["enable-add-history-list"]=false;}}mstrmojo.alert(O(8047));}});},ShowSharingEditor:function T(){var AI="sharingEditor",AJ=mstrmojo.all[AI],AK=this,AG=AK.model,AM=11,AL=AG.isBlankDocument,AE=function(AN){if(AJ){AJ.set("oi",AN);AJ.objectName=AG.n;AJ.href=null;AJ.mid=AG.n;}else{AJ=new mstrmojo.SharingEditor({guestModeEnabled:mstrApp.guestModeEnabled,mid:AG.mid,id:AI,oi:AN,href:null,isLinkDirty:true,viewMode:1,lastState:0});}AJ.open();},AH={success:function(AN){AE(AN.objects[0]);},failure:function(AN){mstrmojo.alert(AN.getResponseHeader("X-MSTR-TaskFailureMsg"));}};if(AL){var AF="#666";mstrmojo.confirm(mstrmojo.desc(9932),[K(O(1442),function(){AK.save({saveAsOrigin:AM});},AF),K(O(2140),null,AF)],mstrmojo.desc(8101));}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,AH,{taskId:"getObjectInfo",objectIDs:AG.oid,objectTypes:55,includeACL:!!mstrApp.features["web-use-sharing-editor"],sessionState:mstrApp.sessionState});}},createPersonalView:function I(){var AM=this,AG=AM.model,AJ=AG&&AG.isnew;if(AJ){var AF="#666";mstrmojo.confirm(mstrmojo.desc(2510),[K(O(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");AM.save({saveAsOrigin:10});},AF),K(O(2140),null,AF)],mstrmojo.desc(9173));}else{var AE=AG.n,AI="mstrPVD",AH={scriptClass:"mstrmojo.PersonalViewSaveAs",id:AI,objectType:55,objectSubType:14081},AL=mstrmojo.all[AI]||mstrmojo.insert(AH);if(AE){var AK=b.getDateJson(new Date());AE+=" "+b.formatDateInfo(AK,AC().DATEOUTPUTFORMAT)+" "+b.formatTimeInfo(AK,AC().TIMEOUTPUTFORMAT);AL.set("name",AE);}AL.msgID=this.model.mid;AL.open();}},reprompt:function S(){AD(this,true,false,false);},refresh:function R(){AD(this,false,false,false);},rerun:function o(){AD(this,false,true,false);},toggleAutoRefresh:function(AH){var AG=AH.src,AE=this.model.controller,AF=AE.isAutoRefreshEnabled();AE[(AF?"stop":"start")+"AutoRefresh"]();AG.set("iconClass",(AF?"tbStart":"tbStop")+"AutoRefresh");AG.domNode.setAttribute("title",AF?"*Resume Auto Refresh*":"*Pause Auto Refresh*");},docVisualizationModeAJAX:function h(){e(this,51);},docVisualizationModeFlash:function t(){e(this,50);},sendNow:function w(){M(this,mstrmojo.desc(2331,"Send Now"),mstrmojo.desc(2513,"You must save the report/document before you can send it."),W,{evt:3037,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:2});},scheduleHL:function Y(){M(this,O(5017,"Subscribe to History List"),O(2510,"You must save the report/document before you can subscribe to it."),W,{evt:3128,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3});},zoomValue:null,zoom:function z(AO){var AK=mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep);var AN=(AO!==null)?String(AO).split(":"):[],AL=parseInt(AN[0],10),AQ=AN[1],AG=AK.parse(AQ);if(isNaN(AL)||(!AL&&isNaN(AG))){return ;}var AP=this.model;if(AL===1||AL===2){var AJ=this.selected,AI=(AJ&&AJ.docLayout)||null,AR=AI&&(AI.containerNode||AI.domNode),AH=AR&&AR.ownerDocument.documentElement,AM=(AP&&AP.zf)||1;var AE=function(AV){var AT=AR&&AR["offset"+AV];if(!AT){return 1;}var AU=Math.max(1,AH["client"+AV]);return Math.min(4,Math.max(0.1,Number(AM*AU/AT).toFixed(2)));};AG=AE("Width");if(AL===2){AG=Math.min(AG,AE("Height"));}AQ=AK.format(AG);}var AF=AL+":"+AQ;if(AF!==(this.zoomValue&&this.zoomValue.dssid)){var AS=this;AP.getDataService().setDocZoom({zoomType:AL,zoomFactor:AQ},{success:function(AT){AP.zf=AT.zf;AP.ztp=AT.ztp;AP.replaceLayout(AT.currlaykey,AT);AP.raiseEvent({name:"rebuildLayout"});Q(AS,false);AS=null;},failureName:"zoom.set"});}},exportCmd:function C(AL,AN){var AH=this.model,AR=(parseInt(AL,10)===x)?3130:3132,AP=AH.exopt,AQ=AH.huc&&AL===G,AM=AP.s&&(AL===l||AL===Z)&&!AN,AG=false,AK=false;if(AM){if(!!(AH.defn&&AH.defn.layouts&&AH.defn.layouts.length>1)){AK=true;}else{var AJ=this.selected,AS=AJ&&AJ.gb&&AJ.children[1];AG=(!AS||AS.areUnitsSetToAll());if(AG){AM=false;}}}var AI=function(){var AW={evt:AR,src:mstrApp.name+"."+AR};if(AR===3132){AW.executionMode=AL;if(AN!=null){AW.gridKey=AN;}}if(!AM){AW.rwb=AH.bs;}else{var AV=mstrmojo.Serializer;var AT=[[2048062,AH.bp+".2048062","mode",AP.m,"range",AP.r],[]];mstrmojo.hash.forEach(AW,function(AY,AX){if(AX==="executionMode"){AT[1]=AT[1].concat([AX,AY]);}else{AT[1].push(AY);}});AW.evt=1024001;AW.src=AH.bp+".1024001";AW.events=AV.serializeValueGroup(AT);AW["1024001"]=1;AW.messageId=AH.mid;}AW.name=Date.parse(new Date());var AU=function(){mstrmojo.form.send(AW,null,null,(AP.n)?"_blank":"mstrExportWindow");};if(!mstrmojo.dom.isIE||AL!==G){AU();}else{mstrmojo.alert(AP.ds[5873],AU);}};var AF=AP.ds,AE="#666",AO;if(AM||AQ){AO=function(){var AU="mojoExOpx9",AT=function(){mstrmojo.all.mojoExOpx9.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Dialog",id:AU,title:AF[971],cssText:"min-width:225px;max-width:325px;",btnAlignment:"right",buttons:[K(AF[1442],function(){mstrmojo.requiresCls("mstrmojo.Serializer");var AV=mstrmojo.all[AU];if(AK){AP.r=AV.ctrlLyt.selected;}if(!AG){AP.m=(AV.ctrlChk.checked)?0:1;}AT();AI();},AE),K(AF[2140],AT,AE)],children:[{scriptClass:"mstrmojo.Label",text:AF[7482],visible:AQ},{scriptClass:"mstrmojo.DropDownList",title:AF[246],cssClass:"field",cssDisplay:"block",alias:"ctrlLyt",visible:!!AK,idx:AP.r,options:[{n:AF[5137],v:0},{n:AF[5138],v:1}]},{scriptClass:"mstrmojo.CheckBox",label:AF[5165],cssClass:"field",cssDisplay:"block",alias:"ctrlChk",visible:!!!AG&&AM,checked:(AP.m===0)}]}).render();};}if(AL===l&&AF["3809"]!==undefined&&!AN){mstrmojo.confirm(AF["3809"],[K(AF[1442],AO||AI,AE),K(AF[2140],null,AE)]);}else{if(AO){AO();}else{AI();}}},printPDF:function X(){this.exportCmd(Z);},openHome:function D(AE){W(AE,{evt:3010,src:mstrApp.name});},updateZoom:function A(){Q(this,false);},__onmixin__:function E(){Q(this,true);},resetSelections:function a(){var AF=this,AE=AF.model;AE.getDataService().resetSelections(null,false,{success:function(AJ){if(AJ.disablePU){AE.loadLayout(AJ);return ;}if(AJ.pukeys){var AL=AE.partialUpdate(AJ.data,AE.getUnitDefinitions(AJ.pukeys)),AH=AE.getLayoutDataCache(AE.getCurrentLayoutKey());mstrmojo.hash.forEach(AL.upd,function(AQ,AS){var AP=mstrmojo.all[AS];if(AP&&AP.defn&&AP.defn.t==mstrmojo.EnumRWUnitType.PANELSTACK){var AO=AH&&AH[AS]&&AH[AS].data,AR=AO&&AO.selKey;if(AR&&AP.selectedKey!=AR){AP.defn.set("selKey",AR);}AP.setDirtyChildren();}});}var AM=AF.getLayouts(),AG=(AM&&AM.length)||0,AN=AE.getCurrentLayoutKey();for(var AI=0;AI<AG;AI++){var AK=AM[AI];if(AK.defn&&AK.defn.loaded&&AN!=AK.k){AK.defn.loaded=false;}}}});}};}());(function(){mstrmojo.requiresCls("mstrmojo.StackContainer","mstrmojo._IsRwDocument","mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo._DocOIVMMethods","mstrmojo.array","mstrmojo.css");mstrmojo.Doc=mstrmojo.declare(mstrmojo.StackContainer,[mstrmojo._HasBuilder,mstrmojo._IsRwDocument,mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.Doc",cssClass:"mstrmojo-Doc",methods:{"*":"mstrmojo._DocOIVMMethods"},markupSlots:{containerNode:function(){return this.domNode;},popupNode:function(){return this.domNode;},drillLinkMenuNode:function(){return this.domNode;}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},getLayouts:function(){return this.children;},buildChildren:function A(M){if(this._super(false)){var L=this.model.getSelectedKey(this.node),N=(L!==null)?mstrmojo.array.find(this.children,"k",L):-1,O=(N>-1)?this.children[N]:null;if(O){this.set("selected",O);}return true;}return false;},restoreLayoutState:function K(M){this._super(M);var L=M.zf;if((this.zf!==L||this.model.zf!==L)&&this.updateZoom){this.zf=this.model.zf=L;this.updateZoom();}},_set_selected:function F(P,N){if(!this.selected){return this._super(P,N);}if(N){var M=this,L=this._super,O=N.k;this.getNewLayout({layoutKey:O},this.children,(O!==this.model.currlaykey),{success:function(R){var Q=M.selected;L.call(M,P,R);M.raiseEvent({name:"selectedChange",prop:"selected",value:R,valueWas:Q});}});}return true;},onLayoutRebuilt:function J(L){this._set_selected("selected",L,true);},replaceLayout:function G(N,M){var L=this.removeChildren(N);N.destroy();var O=this.builder.build([M],this.model);this.addChildren(O,L);return O[0];},getSelectedLayoutWidget:function C(){return this.selected;},xtabCellMenuRef:"mstrmojo.XtabCellMenu",openXtabCellMenu:function(L){if(L){L.opener=this;if(this._lockInfoWinContainer){this._lockInfoWinContainer(L);}}this.openPopup("xtabCellMenuRef",L);},closeXtabCellMenu:function E(){this.closePopup();},drillLinkMenuRef:"mstrmojo.DrillLinkMenu",openDrillLinkMenu:function D(L){if(L){L.opener=this;}this.openPopup("drillLinkMenuRef",L);},closeDrillLinkMenu:function H(){this.closePopup();},goToLink:function I(L){if(L){window.open(L.url,(L.target||"_self"));}},selectorMenuRef:"mstrmojo.SelectorMenu",fpMenuRef:"mstrmojo.FilterPanelMenu",openPopupMenu:function B(M,L){if(L){L.opener=this;}this.openPopup(M,L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.DocLayout","mstrmojo.DocLayoutHoriz","mstrmojo.DocSection","mstrmojo.DocSubsection","mstrmojo.DocTextfield","mstrmojo.DocXtabModel","mstrmojo.DocVisModel","mstrmojo.XtabBase","mstrmojo.DocPortlet","mstrmojo.DocResizablePortlet","mstrmojo.DocXtabGraph","mstrmojo.DocGridGraph","mstrmojo.DocLine","mstrmojo.DocImage","mstrmojo.DocHTMLContainer","mstrmojo.DocRectangle","mstrmojo.DocRoundRectangle","mstrmojo.DocPanel","mstrmojo.DocSelector","mstrmojo.DocActionSelector","mstrmojo._HasDocLink","mstrmojo.DocVisualization","mstrmojo.DynamicClassFactory","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo._IsSelectorTarget","mstrmojo.DocInfoWindow","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableXtab","mstrmojo._IsEditableTextfield","mstrmojo.DocSelectorViewFactory","mstrmojo._HasHoverButton","mstrmojo.hash");var N=mstrmojo.hash;var A=mstrmojo.EnumRWUnitType,C={};C[A.LAYOUT]={n:"Layout"};C[A.HEADER]=C[A.FOOTER]=C[A.PAGEHEADER]=C[A.PAGEFOOTER]=C[A.DETAILS]={n:"Section",scriptClass:"mstrmojo.DocSection"};C[A.SUBSECTION]={n:"SubSection",scriptClass:"mstrmojo.DocSubsection"};C[A.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.DocTextfield"};C[A.GRID]={n:"Xtab",scriptClass:"mstrmojo.DocXtab"};C[A.GRAPH]={n:"XtabGraph",scriptClass:"mstrmojo.DocXtabGraph"};C[A.GRIDGRAPH]={n:"GridGraph",scriptClass:"mstrmojo.DocGridGraph"};C[A.SELECTOR]={n:"Selector",scriptClass:"mstrmojo.DocSelector"};C[A.LINE]={n:"Line",scriptClass:"mstrmojo.DocLine"};C[A.IMAGE]={n:"Image",scriptClass:"mstrmojo.DocImage"};C[A.HTMLCONTAINER]={n:"HTMLContainer",scriptClass:"mstrmojo.HTMLContainer"};C[A.RECTANGLE]={n:"Rectangle",scriptClass:"mstrmojo.DocRectangle"};C[A.ROUNDEDRECTANGLE]={n:"RoundedRectangle",scriptClass:"mstrmojo.DocRoundRectangle"};C[A.PANEL]={n:"Panel",scriptClass:"mstrmojo.DocPanel"};C[A.VISUALIZATION]={n:"Visualization",scriptClass:"mstrmojo.DocVisualization"};C[A.MOJOVISUALIZATION]={n:"MojoVisualization"};var R={};var S=mstrmojo.DynamicClassFactory.newComponent;var K=mstrmojo.elementHelper;function Q(a){return function(){return this.parent.parent["on"+a]();};}var B=Q("maximize"),V=Q("restore"),F=Q("minimize"),U=Q("collapse"),G=Q("expand");mstrmojo.DocXtab=S(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab"});var H=function(d,b){var a=d&&d.parent;while(a){if(a[b]){return a;}a=a.parent;}return null;};function Z(b,f,d,a,e){return mstrmojo.Button.newIconButton(b,f,d,null,{ds:a,visible:(e!==a)});}function O(a,e,d){var b=C[e].n+(d?"Hover":""),f=R[b];if(!f){f=R[b]=S(a,[mstrmojo._HasDocLink].concat(this.getLinkDrillMixins(d)));}return f;}mstrmojo.DocBuilder=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocBuilder",visList:null,destroy:function W(){var a=this.selectorFactory;if(a){a.destroy();}this._super();},classMap:C,build:function M(s,e){var d=[],q=this.classMap,AA=((s&&s.length)||0),z;for(z=0;z<AA;z++){var x=s[z],f=x&&x.defn,b=x&&x.data,l=(f&&f.t)||mstrmojo.EnumRWUnitType.LAYOUT,AB=q[l];var k=(l===A.TEXTFIELD&&((f&&f.dpst)));if(k){AB=q[l+"B"];}var h=(AB&&AB.n)?"new"+AB.n:"",j;if(this[h]){j=this[h](e,x);}else{if(AB&&AB.scriptClass){var g=AB.cls;if(!g){g=N.walk(AB.scriptClass,window);}if(l===A.TEXTFIELD||l===A.IMAGE){var a=b.dl,o=f.dl,p=(a&&a.items&&a.items.length)||(o&&o.items&&o.items.length>0);if(p||b.url||f.url||f.ifw){g=O.call(this,g,l+(k?"B":""),p);}else{if((l===A.TEXTFIELD)&&f.txi){g=S(g,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableTextfield]);}}}if(g){j=new g({id:x.id,node:x,controller:this.parent.controller,model:e});}}}if(j){j.k=x.k;j.formatResolver=e.formatResolver;j.builder=this;j.tooltip=b.tooltip||f.tooltip||"";if(!j.defn){j.defn=f;}j.disposables.push(j.defn);if(j.update){j.update(x);}if((f.ttl!==undefined&&l!==A.PANEL)||f.qsm){j=this.createPortlet(l,x,j);}d.push(j);}}return d;},createPortlet:function E(AC,AJ,AA){var f=AJ.defn,AG=f.ds,q=(f.iifp||!(AC===A.PANELSTACK||(f.ttl===undefined&&f.qsm)||AC===A.SELECTOR)),AH=(AC===A.GRAPH||AC===A.GRIDGRAPH),l=[],AR=mstrmojo.Button.newIconButton,AI="",AK="",d="",AF=(AC===A.GRID||AH||AC===A.VISUALIZATION)&&parseInt(f.eo,10)!==2,AM=[],AD="mstrmojo-oivmSprite ",e=false;if(f.qsm){AI="qks";var AB=function(AT,t,w){return AR(AT,AD+t,function(){return this.parent.parent.content.quickSwitch();},{visible:"this.parent.parent.defn.qsm !== this.qsm"},{qsm:w});};l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",cssClass:(!q)?"grouped":"",children:[AB(mstrmojo.desc(3547,"View: Grid"),"tbGrid",1),AB(mstrmojo.desc(3548,"View: Graph"),"tbGraph",2)]});}if(AF){var x=this.getPortletExportGridToolbar(AA.k);if(x){AK=x.css;AM=x.node;l.push(AM);}}if(q){if(f.iifp){AI="wrap";l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:[Z(mstrmojo.desc(8973,"Collapse"),"co",U,1,AG),Z(mstrmojo.desc(8972,"Expand"),"ex",G,0,AG)]});}else{var AO=[Z(mstrmojo.desc(4539,"Minimize"),"mn",F,1,AG),Z(mstrmojo.desc(4540,"Restore"),"rs",V,0,AG),Z(mstrmojo.desc(4541,"Maximize"),"mx",B,2,AG)];if(AF){AM.children=(AM.children||[]).concat(AO);}else{AK="resize";l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AO});}}}AA.slot="contentNode";AA.alias="content";AA.title=f.ttl||"";if(f.sec){if(f.style!==mstrmojo.DocSelectorViewFactory.STYLES.SCROLLER&&!f.sos){var a=AJ.data,AQ=a.elms,AL=a.ces;if(AL&&AQ&&AQ.length){AA.count=K.buildElemsCountStr(AL,AQ);}}}l.push(AA);if(AC===A.PANELSTACK){var h=function(AU,w,AT,t){return AR(AU,AD+w,function(){return this.parent.parent.content.switchToPanel(t);},{enabled:"this.parent.parent."+AT});},AE=[],o=[],AN=!!AJ.sw,z=!!f.ifw,j=!!f.ifp;if(AN){o.push(h(mstrmojo.desc(1058,"Previous"),"tbPrev","prevEnabled",-1));AE.push(h(mstrmojo.desc(2917,"Next"),"tbNext","nextEnabled",1));}if(z){AE.push(AR(mstrmojo.desc(2102,"Close"),AD+"mstrmojo-DocInfoWindow-close",function(){this.parent.parent.parent.close();}));}if(j){d="ifp";l.push({scriptClass:"mstrmojo.HBox",slot:"buttonbarNode",alias:"buttonbar",cssClass:"buttonBox",children:[{scriptClass:"mstrmojo.Button",alias:"applyNow",title:mstrmojo.desc(2164,"Apply"),text:mstrmojo.desc(2164,"Apply"),cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !f.cas;},enabled:function(){return this.parent.parent.applyEnabled;}},onclick:function AS(){if(AA&&AA.applyBufferedSlices){AA.applyBufferedSlices();}}}]});AE.push({scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AS(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.FilterPanelMenu",{openerButton:this,fps:AA,cmPos:this.cmPos});}}});e=true;}if(z||j){var b=[];if(AN){b[0]="pst-l";}if(j){b.push("ifp");}o.push({scriptClass:"mstrmojo.Box",cssClass:b.join(" ")});}if(z||AN||j){var p=z?"ifw ":"",k=j?"ifp ":"",AP=!f.cas?"cas ":"";AK=(AN?"pst-r ":"")+p+k+AP;AI=(AN?"pst-l ":"")+p+k+AP;l.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:o});l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:AE});}}if(AC===A.SELECTOR&&AA.spm){AK="spm";l.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AS(){this.openPopupMenu();},openPopupMenu:function(){var t=H(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.SelectorMenu",{openerButton:this,selector:AA,cmPos:this.cmPos});}}}]});e=true;}var s="Doc"+(q?"Resizable":"")+"Portlet",g={defn:AA.defn,model:AA.model,children:l,title:AA.title,count:AA.count,floatingTitle:(f.ttl===undefined&&f.qsm),leftToolbarNodeClass:AI,loadDataOnResize:AH,toolbarNodeClass:AK,buttonbarNodeClass:d,attachContextMenuEvent:e};if(AC===A.PANELSTACK){g.bindings={title:"this.children[0].title"};if(AJ.sw){g.bindings.prevEnabled=function(){return this.children[0].hasPreviousPanel;};g.bindings.nextEnabled=function(){return this.children[0].hasNextPanel;};}if(f.ifp){g.bindings.applyEnabled=function(){return this.children[0].applyEnabled;};}}return new mstrmojo[s](g);},getPortletExportGridToolbar:mstrmojo.emptyFn,getLayoutViewerClass:function D(a){return mstrmojo.DocLayoutViewer;},newLayout:function Y(j,f){var h=[],d=f.data,g=f.defn,b=this.getLayoutViewerClass(f),a=new b({n:g.title,model:j,node:f,controller:this.parent.controller,tbc:g.tbc,slot:"containerNode",visible:false,ifs:d.ifs,gb:d.gbys});var k=a.defn=N.copy(g);k.fmts=N.copy(g.fmts);var e=function(s,t){var o=s.length;if(o){var p,q;for(p=0;p<o;p++){q=this.build([s[p]],j)[0];q.slot=t;h.push(q);}}};e.call(this,j.getFixedHeaders(f),"fixedHeaderNode");var l=mstrmojo["DocLayout"+((g.horiz)?"Horiz":"")];h.push(new l({slot:"layout",id:f.id,k:f.k,minHeight:d.mh,formatResolver:j.formatResolver,rules:g.rules,builder:this,node:f,defn:g,model:j}));e.call(this,j.getFixedFooters(f),"fixedFooterNode");a.addChildren(h);return a;},newSection:function(b,d){var a=(d.defn.horiz&&d.data.subsections.length>1)?"DocSectionHoriz":"DocSection";return new mstrmojo[a]({id:d.id,node:d,model:b});},newHTMLContainer:function(b,d){var a=(d.defn.ht===0)?"DocHTMLContainer":"DocTextfield";return new mstrmojo[a]({id:d.id,node:d,model:b});},adjustMojoVisualizationClass:function L(a){return a;},newMojoVisualization:function(h,e){var f=this.visList,b=e.data,p=f.getVis(b.visName);if(!p){var l=b.className;if(!l){return this.newXtab(h,e);}p={dc:l};}var j=(p.dc!==undefined)?p.dc:p.c;j=this.adjustMojoVisualizationClass(j);mstrmojo.requiresCls("mstrmojo."+j);var o=N.walk(j,mstrmojo),k=N.walk(p.m||"DocVisModel",mstrmojo);if(!o||!k){throw new Error("Missing visualization class.");}o=f.getVisClass(o,e.defn);var a=new o(N.copy(b.extProps,{id:e.id,node:e,n:e.defn.title,controller:this.parent.controller,gb:b.gbys}));a.setModel(new k({xtab:a,controller:this.parent.controller,docModel:h}));a.model.set("data",b);if(!!e.data.sdp){var d;for(d in e.data.sdp){e.data.sdp[d].defn={};var g=this.newXtab(h,e.data.sdp[d]);g.setModel(new k({xtab:g,controller:this.parent.controller,docModel:h,data:e.data.sdp[d]}));g.k=d;}}return a;},newInfoWindow:function X(a){return new mstrmojo.DocInfoWindow(a);},newRoundedRectangle:function P(d,e){var b=mstrmojo.dom,a=(b.supports(b.cssFeatures.ROUND_CORNERS))?"DocRectangle":"DocRoundRectangle";return new mstrmojo[a]({id:e.id,node:e,model:d});},newSelector:function J(b,d){var a=(d.defn.ct==="4"?"DocActionSelector":"DocSelector");return new mstrmojo[a]({id:d.id,node:d,controller:this.parent.controller,model:b});},newXtab:function I(b,d){var a=d.defn.txi,f,e=mstrmojo.DocXtab;if(a){e=S(mstrmojo.DocXtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.DocXtab"});}f=new e({id:d.id,node:d,controller:this.parent.controller});f.model=new mstrmojo.DocXtabModel({xtab:f,docModel:b});return f;},getLinkDrillMixins:function T(a){return a?[mstrmojo._HasHoverButton]:[];}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.DocBuilder","mstrmojo.MobileDocLayoutViewer","mstrmojo.MobileDocXtabGraph","mstrmojo._XtabSeamlessIncrementalFetch","mstrmojo._HasScrollbox","mstrmojo.MobileXtab","mstrmojo.graph.MobileDocXtabCanvasGraph","mstrmojo.DynamicClassFactory","mstrmojo.android.DocSelectorViewFactory","mstrmojo.android.DocPanelStack","mstrmojo.android.AndroidDocPanel","mstrmojo.android.ui.DocButton","mstrmojo.android.HTMLContainer","mstrmojo._HasRelativeUrls","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo._IsSelectorTarget","mstrmojo._IsInteractiveGrid","mstrmojo.android.AndroidDICConfig","mstrmojo.AndroidVisList","mstrmojo.array","mstrmojo.hash","mstrmojo.maps.AndroidDocMap","mstrmojo.maps.MapInfoWindowLayoutViewer","mstrmojo.android.ui._IsTouchLink","mstrmojo._HasDrillLinks");var L=mstrmojo.DynamicClassFactory.newComponent,A=mstrmojo._HasRelativeUrls,C=mstrmojo.Obj.free,D=mstrmojo.EnumRWUnitType,F=mstrmojo.array,B=mstrmojo.hash;mstrmojo.DocXtab=L(mstrmojo.MobileXtab,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab],{scriptClass:"mstrmojo.DocXtab",scrollerConfig:{scrollPast:false}});var J=(!!mstrMobileApp&&!!mstrMobileApp.useNativeMap&&mstrMobileApp.useNativeMap())?"androidmap":"jsmap";mstrmojo.maps.AndroidDocLayoutMap=L(mstrmojo.maps[J].AndroidDocMap,null,{scriptClass:"mstrmojo.maps.AndroidDocLayoutMap"});mstrmojo.MobileDocImage=L(mstrmojo.DocImage,[A],{scriptClass:"mstrmojo.MobileDocImage",relativeUrls:["v"]});mstrmojo.MobileDocHTMLContainer=L(mstrmojo.DocHTMLContainer,[A],{scriptClass:"mstrmojo.MobileDocHTMLContainer",relativeUrls:["v"]});var N=mstrmojo.DocLayout.prototype.formatHandlers.domNode;F.removeItem(N,"border");F.removeItem(N,"background-color");mstrmojo.MobileDocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,null,{scriptClass:"mstrmojo.MobileDocBuilder",init:function M(P){this._super(P);if(!this.destroyObjects){this.destroyObjects=[];}this.selectorFactory=new mstrmojo.android.DocSelectorViewFactory();var O=this.classMap;O[D.GRAPH]=(mstrApp.onMobileDevice()&&mstrApp.useBinaryFormat)?{n:"graph.MobileDocXtabCanvasGraph",scriptClass:"mstrmojo.graph.MobileDocXtabCanvasGraph"}:{n:"MobileDocXtabGraph",scriptClass:"mstrmojo.MobileDocXtabGraph"};O[D.IMAGE]={n:"MobileDocImage",scriptClass:"mstrmojo.MobileDocImage"};O[D.PANELSTACK]={n:"PanelStack",scriptClass:"mstrmojo.android.DocPanelStack"};O[D.PANEL]={n:"Panel",scriptClass:"mstrmojo.android.AndroidDocPanel"};O[D.TEXTFIELD+"B"]={n:"Button",scriptClass:"mstrmojo.android.ui.DocButton"};},visList:mstrmojo.AndroidVisList,getLayoutViewerClass:function H(P){if(P.defn.iw){var O="MapInfoWindowLayoutViewer";if(mstrApp.onMobileDevice()){O="Mobile"+O;}return mstrmojo.maps[O];}return mstrmojo.MobileDocLayoutViewer;},newLayout:function E(T,Q){var O=Q.defn.visName;if(O){var d=Q.data.gbys;var P=T,R=B.clone(Q);var Y=mstrmojo.Vis.getVisGrid(T,Q,Q.defn.visGK);if(Y){Q.data=Y.data;if(Q.defn.vp&&Object.keys(Q.defn.vp).length>0){Y.data.vp=Q.defn.vp;}Q.data.layoutModel=P;Q.data.layoutNode=R;Q.data.gbys=d;}Q.defn=T.makeObservable(Q.defn);this.destroyObjects.push(Q.defn);var V=this.visList.getVis(O),U=(V.dc!==undefined)?V.dc:V.c,a,b;try{if(/AndroidDocMap/.test(U)){U="maps.AndroidDocLayoutMap";}var Z=B.walk(U,mstrmojo),X=B.walk(V.m||"DocVisModel",mstrmojo),S=this.parent.controller;a=new Z({id:(Y&&Y.id)||Q.id,node:Q,n:Q.defn.title,controller:S,gb:Q.data.gbys,isFullScreenWidget:true});b=new X({xtab:a,controller:S,docModel:T});a.setModel(b);}catch(W){a=C(a);b=C(b);throw W;}return a;}return this._super(T,Q);},newHTMLContainer:function(O,Q){var P=(Q.defn.ht===0)?"MobileDocHTMLContainer":"android.HTMLContainer",R=mstrmojo.hash.walk(P,mstrmojo);return new R({id:Q.id,node:Q,model:O});},getLinkDrillMixins:function I(O){return[mstrmojo.android.ui._IsTouchLink,mstrmojo._HasDrillLinks];},createPortlet:function G(P,Q,O){if(Q.defn.ifw){var S=O.selectedKey,T=(O.model.getUnitDefinitions(S)||{})[S],R=T&&T.ttl;O.defn.ttl=((O.titleSrc===O.TTL_SRC_PANEL)?R:O.defn.ttl)||"";if(!mstrApp.isTablet()){O.title=O.defn.ttl;return O;}}return this._super(P,Q,O);},destroy:function K(){var P=this.destroyObjects,O;if(P){for(O=0;O<P.length;O++){if(P[O].destroy){P[O].destroy();}}}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Doc","mstrmojo._HasBuilder","mstrmojo._IsRwDocument","mstrmojo.hash","mstrmojo.array","mstrmojo.DocModel");var G=mstrmojo.array,E=G.forEach;function H(K){return(typeof K.defn.iw!=="undefined"&&K.defn.iw);}mstrmojo.maps.jsmap.AndroidMapDoc=mstrmojo.declare(mstrmojo.Doc,null,{scriptClass:"mstrmojo.maps.jsmap.AndroidMapDoc",cssClass:"mstrmojo-Doc",addChild:function(K){K.height=this.height;K.width=this.width;K.visible=true;this.addChildren([K]);},buildChildren:function A(K){this._layouts=this._super(true);},getLoadingPlaceholder:function(K){var L=K.n||"";return new mstrmojo.Label({cssClass:"pre-loader",n:L,k:K.k,isPreloader:true,t:"foo"});},cleanUpLastWidget:function D(K){this._super(false);},selectLayout:function C(K,L,M){this._super(K,L,M);return K;},replaceView:function B(K,L){K.slot=L.slot;this.removeChildren(L,true);L.unrender();L.destroy();this.addChild(K);return K;},replaceLayout:function F(M,L){var N=this._layouts||[],K=G.find(N,"k",M.k);if(K>=0){M.unrender();M.destroy();}var O=this.builder.build([L],this.model)[0];if(K>=0){N[K]=O;}else{N.push(O);}this._layouts=N;return O;},onLayoutRebuilt:function J(K){this.replaceView(K,this.currentView);this.currentView=K;K.set("visible",true);},destroy:function I(K){E(this._layouts,function(L){L.destroy(K);});this._super(K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Doc","mstrmojo._HasBuilder","mstrmojo._IsRwDocument","mstrmojo.hash","mstrmojo.array","mstrmojo.DocModel");var G=mstrmojo.array,E=G.forEach;function H(K){return(typeof K.defn.iw!=="undefined"&&K.defn.iw);}mstrmojo.maps.androidmap.InfoWindowDoc=mstrmojo.declare(mstrmojo.Doc,null,{scriptClass:"mstrmojo.maps.androidmap.InfoWindowDoc",cssClass:"mstrmojo-Doc",addChild:function(K){K.height=this.height;K.width=this.width;K.visible=true;this.addChildren([K]);},buildChildren:function A(K){this._super(true);this._layouts=this.getLayouts();},getLoadingPlaceholder:function(K){var L=K.n||"";return new mstrmojo.Label({cssClass:"pre-loader",n:L,k:K.k,isPreloader:true,t:"foo"});},cleanUpLastWidget:function D(K){this._super(false);},selectLayout:function C(K,L,M){this._super(K,L,M);return K;},replaceView:function B(K,L){K.slot=L.slot;this.removeChildren(L,true);L.unrender();L.destroy();this.addChild(K);return K;},replaceLayout:function F(M,L){var N=this._layouts||[],K=G.find(N,"k",M.k);if(K>=0){M.unrender();M.destroy();}var O=this.builder.build([L],this.model)[0];if(K>=0){N[K]=O;}else{N.push(O);}this._layouts=N;return O;},onLayoutRebuilt:function J(K){this.replaceView(K,this.currentView);this.currentView=K;K.set("visible",true);},destroy:function I(K){E(this._layouts,function(L){L.destroy(K);});this._super(K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.DocumentController","mstrmojo.maps.jsmap.InfoWindow","mstrmojo.maps.jsmap.AndroidMapDoc","mstrmojo.hash","mstrmojo.array","mstrmojo.MobileDocBuilder");var D=mstrmojo.hash;mstrmojo.maps.jsmap.DocInfoWindowController=mstrmojo.declare(mstrmojo.android.controllers.DocumentController,null,{scriptClass:"mstrmojo.maps.jsmap.DocInfoWindowController",initModel:function A(){var J=this._startParams,I=this._super(J);var H=J.docParams;if(H){I.st=H.st;I.n=H.ttl;}return I;},restart:function G(K){var I=mstrApp.rootView.rootContainer;I.render();var H=this.model=this.initModel(),J=this.doc;D.copy(D.copy(K.docParams,{controller:this,model:H,renderMode:"normal",placeholder:I.domNode}),J);if(J.hasRendered){J.unrender();}J.removeChildren();J.render();this.loadLayout(K,true);},start:function G(H){this.model=this.initModel();this.view=this.doc=this.createView(null,H);if(H.model.vp.lyt!==""){this.loadLayout(H);}else{this.loadPanelStack(H);}},createView:function B(H,J){var I=new mstrmojo.maps.jsmap.AndroidMapDoc(D.copy(J.docParams,{controller:this,model:this.model,renderMode:"normal",placeholder:mstrApp.rootView.rootContainer.domNode}));I.builder=new mstrmojo.MobileDocBuilder({parent:I});I.render();return I;},loadPanelStack:function F(){var I=this,H=this.model,J=H.gts.row[0].id,K=this.sc;H.getDataService().setDocSelectorElements(K.ck,J,K.ckey,K.include,{success:function(M){var O=J+"_ifw",L=mstrmojo.all[O],N="*l"+M.currlaykey+"*k"+K.tks+"*t"+H.buildTime;if(L){L.destroy();}I.doc.builder.newInfoWindow({id:O,parent:I,builder:I.builder,model:H,psKey:I.sc.tks,psId:N}).render();},submission:mstrmojo.emptyFn,complete:mstrmojo.emptyFn});},loadLayout:function C(N,J){var M=this.model=N.model,L=this.doc,O=N.rowIndex,K=L.getLayouts(),H=M.vp.lyt,I=K[mstrmojo.array.find(K,"k",H)];if(J){I.defn.loaded=false;}L.selectLayout(I,true,{success:function(){var P="\x1F",Q="12",S=M.gts.row[0],R=S.id,U=S.es[O].id,T=R+P+Q+P+U,V={layoutKey:H,groupByIDs:T};L.getNewLayout(V,L.getLayouts(),false,{complete:function(){mstrApp.hideMessage();var W=window.mapInfoJSInterface;if(W!==undefined){W.setWaitScreenVisibility(false);}},submisson:function(){mstrApp.showMessage();},success:function(W){L.gb=W.gb;L.currentView=L.replaceView(W,mstrApp.rootView.rootContainer);W.set("visible",true);}},true);}});},update:function E(H){var L=this.doc,K=L.gb.groupbys[0],I=K.k,J=K.unit.elms[parseInt(H,10)+1].v;L.controller.onGroupBy(this,{groupbyKey:I,elementId:J},{complete:function(){var M=window.mapInfoJSInterface;if(M!==undefined){M.setWaitScreenVisibility(false);}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileDocBuilder");mstrmojo.InfoWindowDocBuilder=mstrmojo.declare(mstrmojo.MobileDocBuilder,null,{scriptClass:"mstrmojo.InfoWindowDocBuilder",createPortlet:function A(C,D,B){return mstrmojo.DocBuilder.prototype.createPortlet.call(this,C,D,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.android.ui.RootView","mstrmojo.android.ui.ViewSwitcher","mstrmojo.android.ui.ActionBar","mstrmojo.android.ui.FolderView","mstrmojo.android.ui.ResultSetView","mstrmojo.android.ui.DocumentView","mstrmojo.graph.MobileXtabCanvasGraph","mstrmojo.android.ui.PromptsView","mstrmojo.android.ui.PropertiesView","mstrmojo.android.ui.SettingsView","mstrmojo.AndroidXtabStandalone","mstrmojo.MobileDocBuilder","mstrmojo.MobileGraph","mstrmojo.hash","mstrmojo.android.ui.NoProjectsView");mstrmojo.android.factories.ViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.android.factories.ViewFactory",newRootView:function J(N){return new mstrmojo.android.ui.RootView(N);},newActionBarView:function G(N){return new mstrmojo.android.ui.ActionBar(N);},newSwitcherView:function F(N){return new mstrmojo.android.ui.ViewSwitcher(N);},newFolderView:function K(N){return new mstrmojo.android.ui.FolderView(N);},newResultSetView:function M(N){return new mstrmojo.android.ui.ResultSetView(N);},newXtabView:function I(P){var N=P.viz,O=mstrmojo.hash.walk((N)?N.c:"AndroidXtabStandalone",mstrmojo);return new O(P);},newDocumentView:function C(O){var N=new mstrmojo.android.ui.DocumentView(mstrmojo.hash.copy(O,{cssClass:"mstrmojo-DocumentView"}));N.builder=new mstrmojo.MobileDocBuilder({parent:N});return N;},newGraphView:function A(O){var N=(mstrApp.onMobileDevice()&&mstrApp.useBinaryFormat)?mstrmojo.graph.MobileXtabCanvasGraph:mstrmojo.MobileGraph;return new N(O);},newPromptsView:function E(N){return new mstrmojo.android.ui.PromptsView(N);},newPropertiesView:function L(N){return new mstrmojo.android.ui.PropertiesView(N);},newSettingsView:function B(N){return new mstrmojo.android.ui.SettingsView(N);},newCalendarDialogView:mstrmojo.emptyFn,newNoProjectsView:function H(N){return new mstrmojo.android.ui.NoProjectsView(N);},newHeatMapEditorView:function(N){return new mstrmojo.VisHeatMapPopup(N);},newView:function D(N,O){return this["new"+N+"View"](O);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.factories.ViewFactory","mstrmojo.android.medium.ui.ActionBar","mstrmojo.android.medium.ui.ResultSetView","mstrmojo.android.medium.ui.HomeScreenView","mstrmojo.android.medium.ui.TransactionView","mstrmojo.android.medium.ui.TxEditDoc","mstrmojo.android.medium.ui.TxTypeList","mstrmojo.android.medium.ui.CalendarDialog");mstrmojo.android.medium.factories.ViewFactory=mstrmojo.declare(mstrmojo.android.factories.ViewFactory,null,{scriptClass:"mstrmojo.android.medium.factories.ViewFactory",newActionBarView:function D(H){return new mstrmojo.android.medium.ui.ActionBar(H);},newResultSetView:function C(H){return new mstrmojo.android.medium.ui.ResultSetView(H);},newHomeScreenView:function B(H){return new mstrmojo.android.medium.ui.HomeScreenView(H);},newTransactionsView:function G(H){return new mstrmojo.android.medium.ui.TransactionView(H);},newTransactionsEditDocView:function F(H){return new mstrmojo.android.medium.ui.TxEditDoc(H);},newTransactionsTypeListView:function E(H){return new mstrmojo.android.medium.ui.TxTypeList(H);},newCalendarDialogView:function A(H){return new mstrmojo.android.medium.ui.CalendarDialog(H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.DocumentController","mstrmojo.maps.androidmap.InfoWindowDoc","mstrmojo.maps.androidmap.AndroidDocMapInfoWindow","mstrmojo.InfoWindowDocBuilder","mstrmojo.Overlay","mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,J=mstrmojo.array;function A(N){var L=this.model,M=N.key,P=this.doc,O={};L.replaceLayout(M,N);L.currlaykey=M;if(N.isSelected){O.zf=N.zf;P.selectLayout(O,false);}return(P.rebuildLayout(M,P.getLayouts()));}mstrmojo.maps.androidmap.DocInfoWindowController=mstrmojo.declare(mstrmojo.android.controllers.DocumentController,null,{scriptClass:"mstrmojo.maps.androidmap.DocInfoWindowController",initModel:function F(){var N=this._startParams,M=this._super(N);var L=N.docParams;if(L){M.st=L.st;M.n=L.ttl;}return M;},destroy:function K(){var L=this.widget;if(L){L.destroy();}this.doc.destroy();this._super();},renderLayout:function E(Q,L,T){var N=A.call(this,Q),M=N.node,S=M.defn.fmts.width,P=M.defn.fmts.height||M.data.mh,O=new mstrmojo.Overlay({parent:this,children:[N]});O.set("width",S);O.set("height",P);var R=document.getElementById("mainInfoWindow");R.style.visibility="visible";if(!R.firstChild){R.appendChild(document.createElement("div"));}O.placeholder=R.firstChild;O.render();window.setTimeout(function(){O.setDimensions(T||"300px",L||"400px");},500);this.widget=O;},start:function B(L){this.model=this.initModel();this.view=this.doc=this.createView(null,L);if(mapProxy&&mapProxy.registerInfoWindow){mapProxy.registerInfoWindow(this.id);}},createView:function D(L,N){var M=new mstrmojo.maps.androidmap.InfoWindowDoc(C.copy(N.docParams,{controller:this,model:this.model,renderMode:"normal",placeholder:mstrApp.rootView.rootContainer.domNode}));M.builder=new mstrmojo.InfoWindowDocBuilder({parent:M});M.render();return M;},findSelectorTarget:function I(N){var M=N&&N.tks;if(M){var L=this.model;J.forEach(M.split("\u001E"),function(P){var O=L.getTargetDefn(P);if(O[P].ifw){return P;}});}},renderPanelStack:function H(T,N,X){var S=this.gridProps,R=this.model,U=this.getInfoWindowSelectorControl(S);var P=R.getTargetDefn(T.pukeys||U.tks);R.updateDataCache(T.data,P);var Q=this.findSelectorTarget(U);if(Q){var M=Q+"_ifw",W=mstrmojo.all[M],L="*l"+T.currlaykey+"*k"+Q+"*x1*t"+R.buildTime;if(W){W.destroy();}var O=new mstrmojo.maps.androidmap.AndroidDocMapInfoWindow({id:M,parent:this,builder:this.doc.builder,model:R,psKey:Q,psId:L});var V=document.getElementById("mainInfoWindow");V.style.visibility="visible";if(!V.firstChild){V.appendChild(document.createElement("div"));}O.placeholder=V.firstChild;O.render();this.widget=O;}},getInfoWindowSelectorControl:function G(M){var L=this.sc=this.sc||M.gts.row[0].sc;return L;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.maps.jsmap.InfoWindowController","mstrmojo.maps.jsmap.DocInfoWindowController");function A(D){}mstrmojo.maps.jsmap.InfoWindowRootController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.jsmap.InfoWindowRootController",start:function C(E){var D=(E.isDoc)?mstrmojo.maps.jsmap.DocInfoWindowController:mstrmojo.maps.jsmap.InfoWindowController;this.spawn(new D(E),E);},spawn:function B(E,D){this.nextController=E;E.prevController=this;E.start(D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.Container","mstrmojo.Label","mstrmojo.hash","mstrmojo.func","mstrmojo.dom","mstrmojo.maps.jsmap.InfoWindow","mstrmojo.maps.jsmap.InfoWindowController","mstrmojo.MobileDoc","mstrmojo.MobileDocBuilder","mstrmojo.DocModel","mstrmojo.android.ViewFactory","mstrmojo.MobileConfiguration","mstrmojo._CanMakeServerProxyRequests");var $DOM=mstrmojo.dom;function handleError(res,app){var msg=[],map={name:"Exception",message:"Error",sourceURL:"Source URL",fileName:"File",lineNumber:"Line",line:"Line",method:"Method"};res=res||{};mstrmojo.hash.forEach(map,function(v,n){if(n in res){msg.push(v+": "+res[n]);}});if(res.getResponseHeader){msg.push("XHR: "+res.getResponseHeader("X-MSTR-TaskFailureMsg"));}msg=msg.join("\n");if(app&&app.rootView){app.rootView.hideMessage();}if(!res.handledError&&msg.length>0){mstrmojo.alert(msg);res.handledError=true;}mstrmojo.dbg(res.stack||msg);}function onWindowError(errMsg,fName,lineNum){handleError({message:errMsg,fileName:fName,lineNumber:lineNum});}function _getDocParams(dd){return{ab:dd.ab,did:dd.did,st:dd.st,ttl:dd.ttl};}function _getDocModel(dd){return{mid:dd.mid,bs:dd.bs,defn:dd.defn,data:dd.data};}mstrmojo.maps.jsmap.InfoWindowApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._CanMakeServerProxyRequests],{scriptClass:"mstrmojo.maps.jsmap.InfoWindowApp",init:function init(props){this._super(props);var fn=window.onerror;window.onerror=(fn)?mstrmojo.func.composite([onWindowError,fn]):onWindowError;this.handleError=handleError;},start:function start(){if(!this.onMobileDevice()){mstrMobileApp.saveConfiguration(mstrMobileApp.getConfiguration());}mstrMobileApp.setBinaryFormat(this.getConfiguration().getBinaryMode());this.useBinaryFormat=mstrMobileApp.useBinaryFormat();var vw=this.rootView=new mstrmojo.Container({id:"rootView",placeholder:this.placeholder,markupString:'<div id="{@id}" style="{@cssText}"><div></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},msgNode:function(){return this.domNode.lastChild;}},children:[{scriptClass:"mstrmojo.Container",slot:"containerNode",alias:"rootContainer",markupString:"<div></div>"},{scriptClass:"mstrmojo.Label",alias:"msg",slot:"msgNode",text:"Loading...",visible:true}],showMessage:function(text){var msg=text||this.msg.text,msgNode=msg.domNode,msgNodeStyle=msgNode.style;msgNode.innerText=msg;msgNodeStyle.display="block";msgNodeStyle.opacity=1;},hideMessage:function hideMessage(){this.msg.domNode.style.opacity=0;}});vw.render();var ctlr=this.rootController=new mstrmojo.maps.jsmap.InfoWindowRootController({id:"rootController",firstView:vw}),docParams,docModel;if(this.isDoc){var dd=this.getDocData();docParams=_getDocParams(dd);docModel=_getDocModel(dd);}ctlr.start({placeholder:this.placeholder,rowIndex:this.rowIndex,isDoc:this.isDoc,docParams:docParams,docModel:docModel,model:this.getModel(),sc:this.sc});},loadNewDoc:function(rowIndex){var dd=this.getDocData(),docParams=_getDocParams(dd),docModel=_getDocModel(dd);this.rootController.nextController.restart({placeholder:this.placeholder,rowIndex:rowIndex,isDoc:true,docParams:docParams,docModel:docModel,model:this.getModel()});},getDocData:function(){return eval("("+mapDataObj.getDocData()+")");},getModel:function(){return eval("("+mapDataObj.getGridData()+")");},getConfiguration:function getConfiguration(){if(!this._cfg){this._cfg=new mstrmojo.MobileConfiguration();}return this._cfg;},showMessage:function showMessage(msg){this.rootView.showMessage(msg);},hideMessage:function hideMessage(){this.rootView.hideMessage();},update:function(rowIndex){this.rootController.nextController.update(rowIndex);},onMobileDevice:function onMobileDevice(){return !mstrApp.isHosted();},isTouchApp:function isTouchApp(){return($DOM.isIPad||$DOM.isAndroid||mstrApp.onMobileDevice());},onerror:function onerror(res){handleError(res,this);},isHosted:function isHosted(){return mstrMobileApp.isProxy;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.maps.androidmap.DocInfoWindowController");function A(E){}mstrmojo.maps.androidmap.InfoWindowRootController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.maps.androidmap.InfoWindowRootController",start:function D(E){this.spawn(new mstrmojo.maps.androidmap.DocInfoWindowController(E),E);},spawn:function C(F,E){this.nextController=F;F.prevController=this;F.start(E);},destroy:function B(){this.nextController.destroy();this._super();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.Container","mstrmojo.Label","mstrmojo.hash","mstrmojo.func","mstrmojo.dom","mstrmojo.android.Dialog","mstrmojo.MobileDoc","mstrmojo.MobileDocBuilder","mstrmojo.DocModel","mstrmojo.MobileConfiguration","mstrmojo._CanSupportOfflineTransactions","mstrmojo._CanMakeServerProxyRequests");var $DOM=mstrmojo.dom,dialogs=[];function handleError(res,app){var msg=[],map={name:"Exception",message:"Error",sourceURL:"Source URL",fileName:"File",lineNumber:"Line",line:"Line",method:"Method"};res=res||{};mstrmojo.hash.forEach(map,function(v,n){if(n in res){msg.push(v+": "+res[n]);}});if(res.getResponseHeader){msg.push("XHR: "+res.getResponseHeader("X-MSTR-TaskFailureMsg"));}msg=msg.join("\n");if(app&&app.rootView){app.rootView.hideMessage();}if(!res.handledError&&msg.length>0){mstrmojo.alert(msg);res.handledError=true;}mstrmojo.dbg(res.stack||msg);}function onWindowError(errMsg,fName,lineNum){handleError({message:errMsg,fileName:fName,lineNumber:lineNum});}function _getDocParams(dd){return{ab:dd.ab,did:dd.did,st:dd.st,ttl:dd.ttl};}function _getDocModel(dd){return{mid:dd.mid,bs:dd.bs,ci:dd.ci,defn:dd.defn,currlaykey:dd.currlaykey,data:dd.data};}mstrmojo.maps.androidmap.InfoWindowApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._CanSupportOfflineTransactions],{scriptClass:"mstrmojo.maps.androidmap.InfoWindowApp",init:function init(props){this._super(props);var fn=window.onerror;window.onerror=(fn)?mstrmojo.func.composite([onWindowError,fn]):onWindowError;this.handleError=handleError;},start:function start(){var descriptors=eval(String(mstrMobileApp.getResourceBundleJson()));if(descriptors&&descriptors!==""){mstrmojo.populateDescriptors(descriptors);}if(!this.onMobileDevice()){mstrMobileApp.saveConfiguration(mstrMobileApp.getConfiguration());}mstrMobileApp.setBinaryFormat(this.getConfiguration().getBinaryMode());this.useBinaryFormat=mstrMobileApp.useBinaryFormat();mstrApp.oflnTxModel=new mstrmojo.OfflineTransactionModel();var vw=this.rootView=new mstrmojo.Container({id:"rootView",placeholder:this.placeholder,markupString:'<div id="{@id}" style="{@cssText}"><div></div><div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},markupSlots:{containerNode:function(){return this.domNode.firstChild;},msgNode:function(){return this.domNode.lastChild;}},children:[{scriptClass:"mstrmojo.Container",slot:"containerNode",alias:"rootContainer",markupString:"<div></div>"},{scriptClass:"mstrmojo.Label",alias:"msg",slot:"msgNode",text:"Loading...",visible:true}],getContentDimensions:function getContentDimensions(){var contentChild=this.containerNode;return{h:parseInt(contentChild.height,10),w:parseInt(contentChild.width,10)};},showMessage:function(text){var msg=text||this.msg.text,msgNode=this.msg.domNode,msgNodeStyle=msgNode.style;msgNode.innerText=msg;msgNodeStyle.display="block";msgNodeStyle.opacity=1;},hideMessage:function hideMessage(){this.msg.domNode.style.opacity=0;}});vw.render();var ctlr=this.rootController=new mstrmojo.maps.androidmap.InfoWindowRootController({id:"rootController",firstView:vw}),dd=this.getDocData(),docParams=_getDocParams(dd),docModel=_getDocModel(dd);ctlr.start({placeholder:vw.id,parent:this,docParams:docParams,docModel:docModel,gridProps:this.getGridProp(),sc:this.sc});vw.set("visible",false);},onLink:function onLink(params){if(mapProxy&&mapProxy.sendControllerAction){mapProxy.sendControllerAction("onLink",JSON.stringify(params));}},onDrill:function(params){if(mapProxy&&mapProxy.sendControllerAction){mapProxy.sendControllerAction("onDrill",JSON.stringify(params));}},clearContent:function clearContent(){var iw=document.getElementById("mainInfoWindow");iw.style.visibility="hidden";},loadNewDoc:function(){mstrmojo.hash.forEach(mstrmojo.all,function(item){item.destroy();});this.start();},getDocData:function(){return eval("("+mapDataObj.getDocData()+")");},getGridProp:function(){return eval("("+mapDataObj.getGridProp()+")");},getConfiguration:function getConfiguration(){if(!this._cfg){this._cfg=new mstrmojo.MobileConfiguration();}return this._cfg;},showMessage:function showMessage(msg){this.rootView.showMessage(msg);},hideMessage:function hideMessage(){this.rootView.hideMessage();},onMobileDevice:function onMobileDevice(){return !mstrApp.isHosted();},isTouchApp:function isTouchApp(){return($DOM.isIPad||$DOM.isAndroid||mstrApp.onMobileDevice());},onerror:function onerror(res){handleError(res,this);},getScreenDimensions:function getScreenDimensions(){var deviceDimensions=String(mstrMobileApp.getScreenDimensions()).split("|");return{h:parseInt(deviceDimensions[0],10),w:parseInt(deviceDimensions[1],10)};},showDialog:function showDialog(dialogConfig){if(mapProxy&&mapProxy.fullScreenInfoWindow){mapProxy.fullScreenInfoWindow();}dialogConfig.scriptClass=dialogConfig.scriptClass||"mstrmojo.android.Dialog";var me=this,cfg=mstrmojo.func.wrapMethods(dialogConfig,{onClose:function(){if(mapProxy&&mapProxy.restoreInfoWindow){mapProxy.restoreInfoWindow();}dialogs.pop();}});var d=dialogs[dialogs.push(mstrmojo.insert(cfg))-1];d.render();return d;},showPopup:function showPopup(popupConfig,anchor){popupConfig.scriptClass=popupConfig.scriptClass||"mstrmojo.android.Popup";if(anchor){popupConfig.anchor=anchor;}return this.showDialog(popupConfig);},closeDialog:function closeDialog(noForwarding){if(dialogs.length){dialogs[dialogs.length-1].close();return true;}return false;},doAfterAnimation:function doAfterAnimation(foo){foo();},serverRequest:function serverRequest(params,callback,config){if(callback&&callback.proxy){var arr=[params,{},config,callback.proxy];mapProxy.sendDocModelCommand(JSON.stringify({method:"anonymous",params:arr}));}},isHosted:function isHosted(){return mstrMobileApp.isProxy;},closeAllDialogs:mstrmojo.emptyFn,isHosted:function isHosted(){return mstrMobileApp.isProxy;}});}());