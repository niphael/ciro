(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}else{if(D.visible){return this._super(D);}else{var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;}}},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var T=mstrmojo.dom,S,G=mstrmojo.global.document;function P(V){S.startDragCheck(self,V);}var A,O,J="mstrmojo-dnd-avatar",I;function K(X,V,W){if(W!=null){O.innerHTML=W;}I.left=X.x+"px";I.top=X.y+"px";}function H(V,W){if(!A){A=G.createElement("div");I=A.style;A.className=J;A.innerHTML='<div class="'+J+'-inner"></div>';O=A.firstChild;G.body.appendChild(A);}K(W,true,V);I.display="block";}function D(){if(A){I.display="none";}}function B(V){var W=++S.ctxt.moveCount;if(W>=S.minMoves){S.stopDragCheck(self,V);S.startDrag(self,V);}}function E(V){S.stopDragCheck(self,V);}function M(V){S.onDragMove(self,V);}function Q(V){S.stopDrag(self,V);}function N(V){if(!V){return ;}if(!V.hWin){V.hWin=window;}if(!V.e){V.e=V.hWin.event;}V.node=T.eventTarget(V.hWin,V.e);V.pos=T.getMousePosition(V.e,V.hWin);return V;}function F(W){var V=T.findWidget(W);while(V){if(V.draggable){return V;}V=V.parent;}return null;}function U(W,X){var V=T.findWidget(W);while(V){if(V.dropZone){if(V.allowDrop&&V.allowDrop(X)){return V;}}V=V.parent;}return null;}function L(V){if(this.set){this.set("allowingDrop",true);}}function C(V){if(this.set){this.set("allowingDrop",false);}}var R=C;mstrmojo.dnd=mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){T.attachEvent(G,"mousedown",P);mstrmojo.dndEnabled=true;}},disable:function(){T.detachEvent(G,"mousedown",P);},startDragCheck:function(V,W){delete this.ctxt;var X=N({hWin:V,e:W});this.ctxt={src:X,moveCount:0};if(this.minMoves){T.attachEvent(G,"mousemove",B);T.attachEvent(G,"mouseup",E);}else{this.startDrag(V,W);}},stopDragCheck:function(V,W){T.detachEvent(G,"mousemove",B);T.detachEvent(G,"mouseup",E);},startDrag:function(V,X){var Z=this.ctxt;Z.id=new Date();var Y=Z.src,W=F(Y.node);if(!W){return ;}Y.widget=W;Y.data=W.getDragData&&W.getDragData(Z);if(W.ondragstart){if(W.ondragstart(Z)===false){return ;}}T.clearBrowserHighlights();T.preventDefault(self,X);T.attachEvent(G,"mousemove",M);T.attachEvent(G,"mouseup",Q);if(W&&!W.ownAvatar){H(Y.data&&Y.data.html,Y.pos);}},stopDrag:function(V,Z){T.detachEvent(G,"mousemove",M);T.detachEvent(G,"mouseup",Q);var a=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,a);X.widget=W;a.tgt=X;if(W){if(W.ondrop){W.ondrop(a);}else{R.apply(W,[a]);}}var Y=a.src.widget;if(Y&&Y.ondragend){Y.ondragend(a);}if(Y&&!Y.ownAvatar){D();}},onDragMove:function(V,Z){if(T.isSafari){T.clearBrowserHighlights();}var b=this.ctxt,X=N({hWin:V,e:Z}),W=U(X.node,b);X.widget=W;var a=b&&b.tgt&&b.tgt.widget;b.tgt=X;if(a!==W){if(a){if(a.ondragleave){a.ondragleave(b);}else{C.apply(a,[b]);}}if(W){if(W.ondragenter){W.ondragenter(b);}else{L.apply(W,[b]);}}}else{if(W){if(W.ondragover){W.ondragover(b);}}}var Y=b.src.widget;if(Y&&Y.ondragmove){Y.ondragmove(b);}if(Y&&!Y.ownAvatar){K(X.pos,!!W);}}});S=mstrmojo.dnd;S.enable();})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var R=mstrmojo.dom,P=mstrmojo.hash;var M=100;var E=R.supportsTouches?0.5:1;var F=1;var Q=100;var N={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var K=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[R.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[R.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[R.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[R.CSS3_TRANSITION]=this.decelerating?(R.CSS3_PREFIX+"transform 0.2s linear"):"";}},P.copy(N));var G=P.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},P.copy(N));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function L(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=P.copy(R.isSafari?K:G,P.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}R.attachEvent(U,R.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){R.detachEvent(T,R.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function I(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}R.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=R.getMousePosition(R.firstTouch(T,V),T);this.dragging=false;R.attachEvent(window,R.TOUCHMOVE,this._tmCallback);R.attachEvent(window,R.TOUCHEND,this._teCallback);},touchesMoved:function D(b,d){var Z=R.getMousePosition(R.firstTouch(b,d),b);R.preventDefault(b,d);if(!this.dragging){var T=5,h=Math.abs;if((this.scrollsHoriz&&h(Z.x-this.pos.x)>T)||(this.scrollsVert&&h(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},f={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=f;this.maxPos={x:Math.max(f.x-Y.x,0),y:Math.max(f.y-Y.y,0)};this.showScroll();}}if(this.dragging){R.stopPropogation(b,d);var c=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(c.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(c.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),g=this.lastDragTime;this.nextLastDragTime=g;this.lastDragTime=U;if((U-g)>Q){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function H(T,U){R.preventDefault(T,U);R.detachEvent(window,R.TOUCHMOVE,this._tmCallback);R.detachEvent(window,R.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;R.stopPropogation(T,U);if((new Date())-this.lastDragTime<=Q){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=R.getMousePosition(R.firstChangedTouch(Y,Z),Y),c=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-c.x,y:W.y-c.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),d=T?(new Date())-T:0,V={x:d?Number(b.x*M*E/d).toFixed(2):0,y:d?Number(b.y*M*E/d).toFixed(2):0};var a=this,U=function(e){return(a.scrollsHoriz&&Math.abs(e.x)>=F)||(a.scrollsVert&&Math.abs(e.y)>=F);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,M);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=(b)?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=(b)?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function J(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function O(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=mstrmojo.dom;function E(J,I){var G=[];if(J){for(var F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function D(L,F,N){var I=N.hWin,J=N.e,G=A.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=A.ctrlKey(I,J),O=A.shiftKey(I,J);if(K||O){A.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}},premouseup:function C(H,K,G){var F=G.hWin,J=G.e,L=A.ctrlKey(F,J),I=A.shiftKey(F,J);if(L||I){A.clearBrowserHighlights(F);}},onadd:function B(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=E(K,G);for(var J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function B(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){for(var H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);for(var J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3,sessionState:mstrApp.sessionState};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}else{F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);}this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?1:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}else{var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(J.bc==-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};}var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices",sessionState:mstrApp.sessionState};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,L=mstrmojo.hash;function F(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(C.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function B(R){var Q=[],S=R.selectedIndices;for(var P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function N(V,U){var S=[],Q=V.selectedIndices,X=C.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return B(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}for(var R=0,T=U.length;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex==W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V;for(var Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U==V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function H(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function O(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=B(this),S=F(this,[P]);if(Q!==true){H(this,S,R);}}},toggleSelect:function J(P,Q){var S,R;if(this.selectedIndices[P]){R=N(this,[P]);}else{S=F(this,[P]);}if(Q!==true){H(this,S,R);}},rangeSelect:function G(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=B(this);if(P!==true){H(this,null,Q);}},select:function E(R,P){var Q=A(this,C.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){H(this,Q.add,Q.rmv);}},addSelect:function M(R,P){if(R==null){return ;}if(R.constructor!==Array){R=[R];}var Q=F(this,R);if(P!==true){H(this,Q,null);}return Q;},removeSelect:function K(R,P){if(R==null){return ;}if(R.constructor!=Array){R=[R];}var Q=N(this,R);if(P!==true){H(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){H(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof (T)=="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=C.find(U,V,T[V]);}else{if(T!=null){Q=C.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function D(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!=null){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return L.keyarray(this.selectedIndices,true).sort(C.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return C.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],s=this.itemIdField!=null?C.findMulti(S,this.itemIdField,Q):C.indexOfMulti(S,Q),V=Q.length,T=V-s.count,q=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(q&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],f=s.map;if(T&&q){var p=0;for(var e=0;e<V;e++){if(f[e]==null){R.push(Q[e]);U.push(b+p++);}}this.add(R,b);}var W=[];for(var h in f){var o=f[h];if(o>=b){o+=X;}W.push(o);}var r=W.concat(U),Y=this.addSelect(r,!d);if(!d){var Z=C.hash(Y),g=this.selectedIndices,a=[];for(var l in g){if(!Z[l]){a.push(parseInt(l,10));}}var P=this.removeSelect(a,true);H(this,Y,P);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.shouldEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){if(this.shouldEllipsize){A(this);mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered&&this.shouldEllipsize){this.doEllipsize();}}},this.markupMethods);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var E=mstrmojo.hash,H=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=E.clone(I);O.data=M;O.parent=N;return H.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length);for(var N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L;for(var O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}for(var M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},mstrmojo.hash.copy(mstrmojo.ListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,J="mstrmojo-itemwrap",I="&nbsp;",S=mstrmojo.array;function F(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}else{if(X===V){break;}}Y=X;X=Y.parentNode;}}return null;}function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=S.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;}function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function L(k,Z,j,n,W,c,o,m){if(!Z){return{start:0,end:0};}var e=this.wrapperNodes(k),g=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,f=j+n,d=e[0].offsetTop,b;for(var l=1;l<=Y;l++){b=e[g].offsetTop-d+m;if(b<j){X=g;}else{if(b>f){V=g;}}var a=Math.round(Z/Math.pow(2,l+1));g+=(b>j)?-a:a;g=Math.min(Math.max(0,g),Z-1);}return{start:X,end:V};},findWrapper:function K(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function E(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function R(c,V,X,b,W){var Y=this._nd2iw(c,V,X),d,a,e;if(Y){a=this._iw2idx(c,V,Y);d=a;e=this.itemOffsetTop(c,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+e+Z/2){d++;e+=Z;}}else{return c.dropCuePos;}return{left:0,top:e,idx:d,idxActual:a};},getWrapperCss:function(V){return J;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function O(e,b,h,d,a,i){var l=this.itemWrapperPrefix(h),g=this.itemWrapperSuffix,Z=l+this.itemWrapperPrefill+g,Y=[this.markupPrefix],W=1,V=h.selectedIndices||{},n=function m(k,j){for(var o=k;o<j;o++){Y[W++]=l;var p=b.build(h,d,e[o],o);if(V[o]){p=p.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=p;Y[W++]=g;}};var c=(e&&e.length)||0;a=a&&b?Math.min(a,c):0;if(a){n(0,a);}i=i&&b?Math.min(i,c-a):0;var f=c-i;for(var X=a;X<f;X++){Y[W++]=Z;}if(i){n(f,c);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,g,d,m,f,W,b,l){var e=(g&&g.length)||0,j=this.wrapperNodes(X),n=f.itemStatus,V=mstrmojo.css,Z=m.selectedIndices||{};for(var c=W,h=Math.min(b+1,e),a=0;c<h;c++){if(n[c]!==A){j[c].innerHTML=d.build(m,f,g[c],c);if(Z[c]){var Y=j[c].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===l){break;}}}return a;},onadd:function N(e,V,Z,f){if(V&&f){var a=f.value.length,b=this.wrapperNodes(V),d=b[f.index],Y=this.getWrapperCss(e);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=I;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(e,this);}},onremove:function P(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function Q(g,X,c,k){if(X&&k){var d=this.wrapperNodes(X);if(d){var W=mstrmojo.css,l=c.itemStatus,h;for(var b=0,V=k.removed,f=V&&V.length;b<f;b++){h=V[b];if(l[h]){W.removeClass(d[h].firstChild,["selected"]);}}for(var Z=0,e=k.added,Y=e&&e.length;Z<Y;Z++){h=e[Z];if(l[h]){W.addClass(d[h].firstChild,["selected"]);}}}}},_nd2iw:F,_iw2idx:M,toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,e=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=e.clientHeight,d=e.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}e.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css");var F=mstrmojo.dom,B=mstrmojo.css,D="selected";function G(I,J,K,H,M){var L=M.listHooks[I];if(L&&L.call(M,J,K,H)){return ;}B[((I==="select")?"add":"remove")+"Class"](J,D);}function E(K,J,I){var L=this[K],H=(L)?L.split(J):[];H=H.concat(I.split(J));this[K]=H.join(J);return H.length-1;}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},getItemMarkup:function(I,H){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}">{@n}</{@tag}>';},getItemProps:function C(J,H){var I=!!this.selectedIndices[H];return{tag:"div",sel:I,cls:(I)?D:"",n:J.n||"",style:"",idx:H,addCls:function(K){E.call(this,"cls"," ",K);},addStyle:function(K){E.call(this,"style",";",K);}};},itemRenderer:{render:function(I,H,J){I._renderIdx=H;return mstrmojo.string.apply(J.getItemMarkup(I,H),J.getItemProps(I,H));},select:function(I,J,H,K){G("select",I,J,H,K);},unselect:function(I,J,H,K){G("unselect",I,J,H,K);}},onclick:function A(J){try{var M=J.target||F.eventTarget(J.hWin,J.e),L=F.findAncestorByAttr(M,"idx",true,this.domNode),I=L&&parseInt(L.value,10);if(I!==null&&!isNaN(I)){if(!this.multiSelect){this.singleSelect(I);}else{var H=(this.selectedIndices[I])?"remove":"add";this[H+"Select"](I);}}}catch(K){mstrApp.onerror(K);}}});mstrmojo._IsList.SELECTED_CLS=D;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function A(E,H,D){var C=D.hWin,G=D.e,F=mstrmojo.dom.eventTarget(C,G),B=E.listMapper.findIndex(E,H,F);if(B>-1){E.toggleSelect(B);}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom,B=A.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function C(E,I,D){var G=E&&E.tree||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var B=mstrmojo.dom;function C(H){if(B.isWK){document.onselectstart=function(I){if(!H){I.preventDefault();}return H;};}}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function F(){return this.domNode;},getMovingTarget:function G(){return this.domNode;},ondragstart:function A(K){var J=this.getMovingHandle(),H=this.getMovingTarget().style;var I=B.contains(J,K.src.node,true,document.body);if(I){C(false);J.style.cursor="move";this._leftPos=parseInt(H.left,10);this._topPos=parseInt(H.top,10);this._hWidth=J.clientWidth;this._hHeight=J.clientHeight;}return I;},ondragmove:function E(K){var J=K.tgt.pos,H=K.src.pos,I=this.getMovingTarget().style;I.left=this.left=Math.max(this._leftPos+J.x-H.x,-this._hWidth+40)+"px";I.top=this.top=Math.max(this._topPos+J.y-H.y,-this._hHeight+10)+"px";},ondragend:function D(H){C(true);this.getMovingHandle().style.cursor="default";delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var Z=mstrmojo.hash,e=mstrmojo.array,d=mstrmojo.boxmodel,b=mstrmojo.dom;function A(h,j,g){var i=h.listSelector;if(i){i[j](h,h.itemsContainerNode,g);}}function K(h,g){var i=h.lastPagePos;if(!i||i.dragId!==g){i=d.offset(h.itemsContainerNode);i.dragId=g;h.lastPagePos=i;var j=h.scrollboxNode;h.lastScrollPos={left:j.scrollLeft,top:j.scrollTop,width:j.clientWidth,height:j.clientHeight};}}function N(j,m,h){var i=m&&m.node;if(i===j.dropCueNode||i===j.dropCueNode.firstChild){return j.dropCuePos;}var k=j.listMapper;var g=k&&k.whereDrop(j,j.itemsContainerNode,i,m.pos,{left:j.lastPagePos.left-j.lastScrollPos.left,top:j.lastPagePos.top-j.lastScrollPos.top,width:j.lastScrollPos.width,height:j.lastScrollPos.height});var l=j.dropCuePos;return((h!==false)&&l&&g&&(l.idx===g.idx)&&(l.left===g.left)&&(l.top===g.top))?l:g;}var f="attachEventListener";function C(h,g){if(h.makeObservable){g=g||[];if(!g[f]){mstrmojo.hash.make(g,h.itemsScriptClass||mstrmojo.Arr);}}return g;}function G(h,g){if(g&&g[f]){h._sub_its=g;h._sub_add=g[f]("add",h.id,"preadd");h._sub_rmv=g[f]("remove",h.id,"preremove");}}function F(g){if(g._sub_its){var h=mstrmojo.publisher;h.unsubscribe(g._sub_add);h.unsubscribe(g._sub_rmv);delete g._sub_add;delete g._sub_rmv;delete g._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var h=this.dropCueNode,g=h&&h.style;if(!g){return ;}var j=this.dropCuePos,i=!!j;if(i){g.left=j.left+"px";g.top=j.top+"px";}g.display=i?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Y(l){this._super(l);this.items=this.initItems(this.items);var k=this.selectedIndices,g=this.selectedIndicesList,j=this.selectedIndex,m=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(k||g||(j>-1)||m){this.initSelections(k,g,j,m);}if(this.postInitItems){this.postInitItems();}},initItems:function H(g){return C(this,g);},preBuildRendering:function V(){var k=this.listBuilder,n=k.newContext(this);this.ctxtBuilder=n;var h=this.markupSlots,j=!!(this.renderOnScroll&&this.renderBlockSize&&h&&h.scrollboxNode),i=this.items,g=(i&&i.length)||0,l=j?this.firstRenderBlockSize:g,m=j?this.firstRenderBlockSize:0;this._eros=j;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(i,k,this,n,l,m).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function D(){delete this.itemsHtml;var l=this.listMapper;if(l&&l.postBuildRendering){l.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}G(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var o=this.id;this._cb_scroll=function(){var i=mstrmojo.all[o];i.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var j=0,h=["itemsEffect","scrollEffect"],g=h.length;j<g;j++){var m=h[j],k=this[m];if(k&&k.constructor===Object){k=mstrmojo.insert(mstrmojo.hash.clone(k));k.widget=this;this[m]=k;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function W(k){F(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var h=0,j=["itemsEffect","scrollEffect"],g=j.length;h<g;h++){var l=this[j[h]];if(l&&l.isPlaying){l.cancel();}}this._super(k);},pauseScrollRendering:function O(i,g,h){if(i!==false){i=true;}if(this.paused===!!i){return ;}this.paused=!!i;if(i){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(g,h);}},onscroll:function J(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var g=this;this._fillTmr=self.setTimeout(function(){g.fill();g=null;},50);}}if(this._super){this._super();}},fill:function a(g,k){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var l=(this.items&&this.items.length)||0;if(!l){if(k){k();}}else{var i=this.scrollboxNode,m=this.itemsContainerNode,j=mstrmojo.boxmodel.offset(m,i),o=this.listMapper,n=o.findScrollRange(m,l,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||i.scrollTop,i.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||i.scrollLeft,i.clientWidth,j.left,j.top);if(this.fillAt(n.start,n.end)){if(g){g();}var h=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[h].fill(g,k);},100);}else{if(k){k();}}}},fillAt:function L(i,h){var g=this.listMapper;if(g){return g.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,i,h,this.renderBlockSize);}else{return false;}},add:function Q(h,g){if(!h||!h.length){return -1;}var i=this.items;if(g==null){g=Z.min(this.selectedIndices,false,true);if(g!==null&&g!==undefined){g++;}}if(g==null||g===-1){g=(i&&i.length)||0;}if(i&&i.add){i.add(h,g);}else{this.set("items",i?e.insert(i.concat(),g,h):h);}return g;},preadd:function B(j){if(this.hasRendered){var m=this.listMapper;if(m){m.onadd(this,this.itemsContainerNode,this.ctxtBuilder,j);}var l=this.listBuilder;if(l){l.onadd(this,this.ctxtBuilder,j);}var h=this.listSelector;if(h){h.onadd(this,j);}if(this._eros){this.onscroll();}else{var k=j.index,g=j.value.length;this.fillAt(k,k+g-1);}}if(this.onadd){this.onadd(j);}if(this._super){this._super(j);}},remove:function T(g){if(g==null){return -1;}if(g.constructor!==Array){return this._remove(g);}var j=this.items;if(j){var h;if(j.remove){for(h=g.length-1;h>-1;h--){j.remove(g[h],1);}}else{j=j.concat();for(h=g.length-1;h>-1;h--){j.splice(g[h],1);}this.set("items",j);}return g[0];}return -1;},_remove:function T(i){var h=this.items;if(!h||(i==null)){return -1;}var g;if(!isNaN(i)){g=i;}else{g=this.itemIndex(i);}if(g>-1){if(h.remove){h.remove(g,1);}else{h=h.concat();h.splice(g,1);this.set("items",h);}}return g;},duplicate:function X(l,h,i){var j=this.items,g=-1;if(!j||(l==null)){return -1;}if(!isNaN(l)){if(h===null||h===undefined){h=l+1;}l=j[l];}else{if(h===null||h===undefined){h=this.itemIndex(l)+1;}}if(l){var k;k=Z.copy(i,Z.clone(l));g=this.add([k],h);}return g;},preremove:function M(h){if(this.hasRendered){var j=this.listMapper;if(j){j.onremove(this,this.itemsContainerNode,this.ctxtBuilder,h);}var i=this.listBuilder;if(i){i.onremove(this,this.ctxtBuilder,h);}var g=this.listSelector;if(g){g.onremove(this,h);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(h);}if(this._super){this._super(h);}},move:function R(k,p){function n(q,i){return(p>=q)&&(p<=q+i);}var o=(this.items&&this.items.length)||0;if(p===-1||p==null||isNaN(p)){p=o;}else{p=Math.min(p,o);}var j,g,m,l;if(k.constructor===Array){g=k;m=k;l=(g&&g.length)||0;if(n(k[0],k.length)){return false;}j=e.get(this.items,k);}else{if(typeof (k)==="object"){j=[k];l=1;g=this.itemIndex(j[0]);m=[g];if(n(g,1)){return false;}}else{g=k;m=[k];l=1;if(n(g,1)){return false;}j=[this.items[g]];}}for(var h=0;h<l;h++){if(m[h]<=p){p--;}}if(j[0]!=null){this.remove(g);this.add(j,p);}return true;},itemIndex:function E(g){if(g==null){return -1;}var h=this.itemIdField;return h?e.find(this.items,h,g[h]):e.indexOf(this.items,g);},prechange:function S(j){if(this.hasRendered){var h=[this.listBuilder,this.listMapper];for(var k=0,g=h.length;k<g;k++){var l=h[k];if(l&&l.onchange){l.onchange(this,this.itemsContainerNode,this.ctxtBuilder,j);}}}},makeObservable:false,_set_items:function I(l,g){var k=this.items;g=this.initItems(g);this.items=g;if(k!==g){var j=this,i=function(){if(j.autoHide){j.set("visible",!!(g&&g.length));}j=null;},h=this.hasRendered;if(h){this.refresh(i);}else{i();}}return k!==g;},premousedown:function c(g){A(this,"premousedown",g);},premouseup:function P(g){A(this,"premouseup",g);},scrollTo:function U(h){var g,i=this.listMapper;if(i&&i.toItem){if(!isNaN(h)){g=h;}else{g=this.itemIndex(h);}if(g>=0){i.toItem(this,g);}}},draggable:false,getDragData:function(k){K(this,k.id);var i=N(this,k.src),h=i&&i.idxActual;if((h>-1)&&this.selectedIndices[h]){var j=this.sortSelectedIndices(),g=e.get(this.items,j)||[];switch(g.length){case 1:return Z.copy(g[0],{html:g[0][this.itemDisplayField],index:j[0]});case 0:return null;default:return Z.copy({html:g.length+" selections",indices:j},g);}}},dropZone:false,ondragenter:function(g){K(this,g.id);this.set("dropCuePos",N(this,g.tgt));},ondragover:function(g){this.set("dropCuePos",N(this,g.tgt));},ondragleave:function(g){this.set("dropCuePos",null);},ondragstart:function(g){if(!(g&&g.src&&g.src.data)){return false;}},allowCopy:false,ondragend:function(j){var h=j&&j.tgt,g=h&&h.widget;if(g===this){}else{if(this.tree&&g&&g.tree===this.tree){if(!this.allowCopy||!b.ctrlKey(h.hWin,h.e)){var i=j.src&&j.src.data;if(i&&(i.indices||(i.index!==null))){this.remove(i.indices||i.index);}}}}},ondrop:function(o){var r=o&&o.src,n=r&&r.data;if(n){var h=N(this,o.tgt,false),p=h&&h.idx,j=(n&&n.constructor===Array);var l=this.items;p=Math.min(p,(l&&l.length)||0);var q=true;if(r.widget===this){q=this.move(this.sortSelectedIndices(),p);}else{this.add(j?n:[n],p);}if(q){var m=j?n.length:1,g={};for(var k=0;k<m;k++){g[p+k]=true;}this.set("selectedIndices",g);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(E,D){if(!A){var F=this.itemField;A=this._super(E).replace(">{@n}<",' title="{@'+F+'}">{@'+F+"}<");}return A;},getItemProps:function C(F,D){var E=this._super(F,D),G=this.itemField;E[G]=F[G];return E;},onclick:function B(D){this._super(D);var E=this.parent,G=E.opener;G.suggestionShown=false;var F=this.selectedItem;if(F){G.handleSuggestionItemSelect(F);}E.close();},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems"}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(F,D){var E=this.items;this.items=D||[];return E!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var E=this.value,D=this.selectedIndex,G=this.items||[],H,F;if(D===undefined||(E!==null&&(D===-1||(D!==-1&&G[D]&&G[D][this.itemIdField]!==E)))){D=mstrmojo.array.find(G,this.itemIdField,E);D=(D>-1)?D:this.defaultSelection;this.selectedIndex=D;}else{if(E===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=H=G[this.selectedIndex];if(H){F=H[this.itemField];}else{F=this.defaultText||"";}this.set("text",F);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function(E){var F=this.value,D=-1;if(F!==null){D=mstrmojo.array.find(this.items,this.itemIdField,F);}if(D>-1){this.selectedItem=this.items[D];this.selectedIndex=D;}},togglePopup:function C(){if(this.popupToBody){var G=mstrmojo.dom.position(this.popupNode,true),F=this.popupRef,D={left:Math.round(G.x)+"px",top:Math.round(G.y)+"px"};if(!F.hasRendered){delete F.slot;D.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(D,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var E=this.popupRef.domNode;if(E){if(this.fixWidth){E.style.width=(this.domNode.offsetWidth-2)+"px";}else{E.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(D){this.togglePopup();},unrender:function B(D){var E=this.popupRef;if(this.popupToBody&&E.hasRendered){E.unrender(false);}if(this._super){this._super(D);}},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var F=this.opener,E=F&&F.popupZIndex,G=F&&F.popupCssClass||"",D=this.domNode;if(E){D.style.zIndex=E;}if(G){mstrmojo.css.addClass(D,[G]);}if(F&&F.fixWidth){mstrmojo.css.addClass(D,["fix-width"]);}if(F&&F.fixHeight){mstrmojo.css.addClass(D,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(F,D,E){return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+(F[E.itemCSS]||"")+'" title="'+F[E.itemField]+'">'+(F[E.itemField]||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var F=this.parent,G=F.visible,D=F.opener,E=this.selectedItem;if(!D||!E||!G){return ;}D.set("value",E[this.itemIdField]);}}]}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList");var A=function(O,P){var N=O.parent.opener,F=N&&N.showDesc,M=N&&N.showPath,E=P[O.itemField];var L=mstrmojo.string.escape4HTMLText,Q="";if(M){var I=P.anc&&P.anc.items,K=I&&I.length;if(K>0){for(var H=0;H<K-1;H++){Q+=I[H].n+" > ";}Q+=L(I[K-1].n);}else{if(P.path){Q+=P.path;}}}Q+=(Q.length==0?"":" > ")+L(E);if(F){var J=P[O.itemDescField],G=120;if(J){Q+="\r\n\r\n"+L(J.substring(0,G)+(J.length>G?"...":""));}}return Q;};var C=function(E,F,G){if(!F||!G){return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var H=F.path||F.getAttribute("path");if(H){return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(I){var J=D(I.toString())||"";G.path=J;F.path=1;F.title=A(E,G);}},{taskId:"getObjectDetails",objectID:G.did,objectType:G.t,sessionState:mstrApp.sessionState},undefined);},200);};var D=function(G){if(window.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(G,"text/xml");}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(G);}var K=xmlDoc.getElementsByTagName("path")[0],H=K.childNodes,J="";if(H){for(var F=0,E=H.length;F<E;F++){var I=H[F].childNodes&&H[F].childNodes[0];if(I){J+=mstrmojo.string.escape4HTMLText(I.nodeValue)+(F<E-2?"> ":"");}}}return J;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",itemDescField:"desc",getItemMarkup:function(G,E){var F=this.parent.opener,H=A(this,G);return'<div class="mstrmojo-suggest-text '+((F&&F.item2textCss(G))||"")+'" idx="'+E+'" title="'+H+'">'+F.getHighlightedText(F.getSearchPattern(),mstrmojo.string.escape4HTMLText(G[this.itemField]))+"</div>";},getItemProps:function B(F,E){return{};},onmouseover:function(F){var I=this.parent.opener;if(I&&I.showPath){var G=mstrmojo.dom.eventTarget(F.hWin,F.e),E=G.getAttribute("idx"),H=E!=null?this.items[E]:null;if(H&&H.t>-1){C(this,G,H);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var G=this.zIndex;this.editorNode.style.zIndex=G;this.curtainNode.style.zIndex=G-1;},onvisibleChange:function(J){if(J){return ;}var G=this.visible,H="closeEffect",I="none";if(G){H="openEffect";I="block";}if(this[H]){this.playEffect(H);}else{this.editorNode.style.display=I;if(this.modal){this.curtainNode.style.display=I;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function C(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function E(){return this.titlebarNode;},getMovingTarget:function F(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function B(G){var H=D.eventTarget(G.hWin,G.e);if(H===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function A(L,I){var H=(this[L]!==I);if(H){this[L]=I;var K=this._close_handler;if(I){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var J=this;K=this._close_handler=K||function(M){var N=D.eventTarget(self,M);if(N&&N.parentNode&&!D.contains(J.editorNode,N,true,document.body)){J.close();}};D.attachEvent(document.body,"mousedown",K);}}else{var G=this._curtain_handler;if(G){D.detachEvent(window,"resize",G);}if(K){D.detachEvent(document.body,"mousedown",K);}}}return H;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(G){G=Math.round(G);return["rgb(",G,",",G,",",G,")"].join("");}}},preStart:function(){var H=this.target,G=this.widget;G.editorNode.style.display="block";if(!G.modal){return false;}H.style.display="block";mstrmojo.css.setOpacity(H,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var G=this.widget;G.editorNode.style.display="none";return !!G.modal;}};}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var A=mstrmojo.dom,B={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(B[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=A.eventTarget(D.hWin,D.e);if(F==this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.dnd");function W(a){var c=document.createElement("div"),b=c.style,Z=a.domNode;c.className="mstrmojo-DataGrid-avatar";b.height=Z.clientHeight+"px";Z.appendChild(c);a.avatar=c;return c;}function N(Z){var a=mstrmojo.dom.position(Z.domNode,true);return a.x;}function L(Z){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+Z+'"></div>';}function X(b){var a=b.getAttribute("rh"),Z=a&&parseInt(a,10);return Z;}function U(a,e,Z){var c=Z.src,f=c&&c.data,b=f&&f.resizingIdx;if(!(b&&b>0)){return e&&e.apply(a,[Z]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function E(c,b){var Z=c.colSizeArray;var a=[-Z[b-1]+c.minColWidth,(b==Z.length-1)?Z[b]-c.resizeHandleWidth-c.minColWidth:Z[b]-c.minColWidth];return a;},updateSize:function D(c,b,a){var Z=c.colSizeArray;Z[b-1]=Z[b-1]+a;Z[b]=Z[b]-a;},updateColumnWidth:function Q(c,a,d,b){var Z=c.colSizeArray;a[b-1].style.width=Z[b-1]+"px";d[b-1].style.width=Z[b-1]+"px";a[b].style.width=Z[b]+"px";d[b].style.width=Z[b]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function E(e,d){var f=e.minColWidth+e.resizeHandleWidth,Z=e.colSizeArray,b=0;for(var c=d;c<Z.length;++c){b+=Z[c]-f;}var a=[-Z[d-1]+f,b];return a;},updateSize:function D(c,g,a){var f=c.minColWidth+c.resizeHandleWidth,d=c.colSizeArray;d[g-1]=d[g-1]+a;var Z=[];for(var b=0;b<d.length-g;++b){Z[b]=g+b;}Z.sort(function(i,j){return d[i]-d[j];});for(var b=0;b<Z.length;++b){var h=a/(Z.length-b);var e=d[Z[b]];a-=(e>=h+f)?h:e-f;d[Z[b]]=(e>=h+f)?e-h:f;}},updateColumnWidth:function Q(d,a,e,c){var Z=d.colSizeArray;for(var b=c-1;b<Z.length;++b){a[b].style.width=Z[b]+"px";e[b].style.width=Z[b]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,postBuildRendering:function S(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function C(Z){var b=Z.src,c=b.node,a=X(c);if(a&&a>0){return{resizingIdx:a,startingX:b.pos.x,baseX:N(this)};}else{if(this._super){return this.dropZone&&this._super(Z);}}return null;},allowDrop:function I(Z){var b=Z.src,c=b&&b.data,a=c&&c.resizingIdx;if(a&&a>0){return true;}else{return this.dropZone;}},ondragenter:function O(Z){U(this,this._super,Z);},ondragover:function P(Z){U(this,this._super,Z);},ondragleave:function A(Z){U(this,this._super,Z);},ondrop:function T(Z){U(this,this._super,Z);},ondragstart:function V(e){var m=e.src,f=m&&m.data,l=f&&f.resizingIdx;if(l&&l>0){var h=this.avatar||W(this);this.ownAvatar=true;h.style.left=(f.startingX-f.baseX)+"px";h.style.display="block";document.body.style.cursor="col-resize";var j=this.colSizeArray;if(!j){var b=this.headerContainerNode,g=b&&b.getElementsByTagName("table")[0],k=g.rows[0].cells;j=[];for(var Z=0,c=k.length;Z<c;Z++){j.push(k[Z].offsetWidth);}this.colSizeArray=j;this._firstTimeResize=true;}f.resizingRange=this.resizeColumnBehavior.getRange(this,l);return true;}else{if(this._super){return this._super(e);}}},ondragmove:function M(b){var j=b.src,c=j&&j.data,h=c&&c.resizingIdx;if(h&&h>0){var i=b.tgt,e=this.avatar,g=c.resizingRange,f=i.pos.x-c.startingX,Z=Math.min(g[1],Math.max(f,g[0]));c.deltaX=Z;if(e){e.style.left=(c.startingX-c.baseX+Z)+"px";}}else{if(this._super){this._super(b);}}},ondragend:function J(e){var m=e.src,f=m&&m.data,k=f&&f.resizingIdx;if(k&&k>0){var Z=this.titleColGroup,l=Z&&Z.childNodes,h=this.dataColGroup,j=h&&h.childNodes,c=l.length,g=this.colSizeArray,a=f.deltaX;this.resizeColumnBehavior.updateSize(this,k,a);if(this._firstTimeResize){for(var b=0;b<c;b++){l[b].style.width=g[b]+"px";j[b].style.width=g[b]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,l,j,k);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(e);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function H(b){var e=document.createElement("colgroup"),Z=b.length,a;for(var d=0;d<Z;d++){var c=document.createElement("col");a=b[d];if(a.colWidth){c.style.width=a.colWidth+"px";}c.className=a.colCss||("col"+d);e.appendChild(c);}return e;}function G(a){var b=a._headerWidgets_,Z=b&&b.length;if(Z>0){for(var c=0;c<Z;c++){b[c].destroy(true);}}}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},itemFunction:function(b,Z,a){var d=new mstrmojo.DataRow({columns:a.columns,data:b,idx:Z,dataGrid:a});return d;},preBuildRendering:function B(){var c=this.columns,Z=c.length,d=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],b,a;this._headerWidgets=[];for(var e=0;e<Z;e++){b=c[e];a=b.headerWidget;d.push("<td>");if(e>0&&this.resizableColumns){d.push(L(e));}d.push('<div class="mstrmojo-DataGrid-headerText');d.push(b.headerCss?" "+b.headerCss:"");if(a){this._headerWidgets.push(mstrmojo.hash.copy(a));d.push('" w="1">');}else{d.push('">');}d.push(b.headerText?b.headerText:"&nbsp");d.push("</div>");d.push("</td>");}d.push("</tr></table>");this.headerHtml=d.join("");if(this._super){this._super();}},postBuildRendering:function S(){if(this._super){this._super();}var c=this._headerWidgets,f=c.length;if(f>0){this._headerWidgets_=[];var g=this.headerContainerNode.getElementsByTagName("div"),b=mstrmojo.array.filter(g,function(i){return i.getAttribute("w")=="1";}),k;for(var d=0;d<f;d++){c[d].placeholder=b[d].firstChild;c[d].dataGrid=this;k=mstrmojo.registry.ref(c[d]);k.render();this._headerWidgets_.push(k);}}var Z=H(this.columns),j=Z.cloneNode(true),e=this.headerContainerNode,h=e&&e.getElementsByTagName("table")[0],l=this.itemsContainerNode,a=l&&l.getElementsByTagName("table")[0];this.titleColGroup=Z;this.dataColGroup=j;if(h&&a){h.insertBefore(Z,h.firstChild);a.insertBefore(j,a.firstChild);}},refresh:function F(Z){G(this);if(this._super){this._super(Z);}},destroy:function Y(Z){G(this);this._super();},unrender:function R(d){var b=this._headerWidgets_,a=b&&b.length,Z;if(a>0){for(var c=0;c<a;c++){Z=b[c];if(Z&&Z.hasRendered){Z.unrender(true);}}}this._super(d);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var f=document.createElement("tr"),k=this.data,n=this.idx,a=this.dataGrid,g=this.cssClass,p=this.columns,Z=this.children,b,l=-1,o,m;f.setAttribute("id",this.id);if(a.banding){g+=(n%2==1)?" odd":" even";}f.className=g+(mstrmojo.string.isEmpty(k[a.itemDisplayField||"n"])?" empty-row":"");for(var e=0,j=p.length;e<j;e++){o=p[e];m=(o.dataWidgetBuilder&&o.dataWidgetBuilder(k))||o.dataWidget;b=document.createElement("td");f.appendChild(b);if(m){b.setAttribute("w","1");l++;Z.push(mstrmojo.hash.copy(m,{slot:"slot"+l,data:k,idx:n,dataGrid:a}));}else{if(o.dataFunction){b.innerHTML=o.dataFunction(k,n,a);}else{var c=mstrmojo.string.htmlAngles(k[o.dataField||"n"])||"&nbsp",h=o.tooltip?' title="'+c+'"':"";b.innerHTML='<div class="mstrmojo-DataRow-text" '+h+">"+c+"</div>";}}}this.initChildren();return f;},buildRendering:function K(){this._super();var d=this.domNode.childNodes,Z=d.length,c={},b=0,e;for(var a=0;a<Z;a++){e=d[a];if(e.getAttribute("w")=="1"){c["slot"+b]=e;b++;}}this.addSlots(c);}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.TreeNode");var I=mstrmojo.dom;mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:mstrmojo.hash.copy({checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,onstateChange:function H(){if(!this.contentRetrieved&&(this.state==1)){this.set("items",[this.tree.loadingItemCreaterFunc()]);this.tree.getContent(this,this.blockBegin);}},toggleState:function F(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function G(J){I.clearBrowserHighlights(J.hWin);return false;},predblclick:function D(J){I.clearBrowserHighlights(J.hWin);return false;},premousedown:function B(K){var P=mstrmojo.dom,M=mstrmojo.dom.eventTarget(K.hWin,K.e),J=this.tree,L=(this.state==2),O=P.contains(this.itemsContainerNode,P.eventTarget(K.hWin,K.e),true,this.domNode),N=(J.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if(this.isSpecialNode()||!(M==this.checkBoxNode||(M==this.textNode&&(L||!N)))){P.stopPropogation(K.hWin,K.e);}if((M==this.stateNode)||(M==this.textNode&&!L&&N)){if(!L){this.toggleState();}}else{if(M==this.checkBoxNode||O){if(this._super){this._super(K);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var J=this.data&&this.data.st;return(J<0);},handleNodeClicked:function E(){var J=this.tree,K=this.parent,L=this.data;switch(L&&L.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin-J.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);J.getContent(K,K.blockBegin+J.blockCount);break;case"-1":case"-2":break;default:if(J.handleNodeClicked){J.handleNodeClicked(L);}}},init:function(J){this._super(J);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var J=function(K){I.preventDefault(window,K||window.event);return false;};I.attachEvent(this.domNode,"mousedown",J);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=(Y)?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=(Y)?0:U-1;}else{V+=(Y)?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(h){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,g=this._last_hit;if(!this.noCache&&(d||g)){var f=this.filterCandidates(a,h,this.REQUEST_THRESHOLD),b=f.length,e=this.suggestCount,U=false;if(!X&&b<e){var V=g&&g.pattern;if(g&&V&&(h.indexOf(V)>-1)){U=true;var k=this.filterCandidates(g.items,h,this.REQUEST_THRESHOLD),Y=k&&k.length,W=mstrmojo.array,j=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(f,j,k[Z][j])===-1){f.push(k[Z]);}}b=f.length;}}if(!X&&((h.length>2&&b<this.REQUEST_THRESHOLD)||(b<e))){this.requestCandidates(h);return -1;}return(b<e)?f:f.slice(0,e);}this.requestCandidates(h);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(e){if(!e){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var j=d.getSearchPattern(),a=e.items;X._last_hit={items:a,pattern:U};X.sz=e.sz;if(!X.noCache&&a){var f=X.candidates&&X.candidates.items||[],g=[].concat(a);for(var Z=0,b=a.length;Z<b;Z++){var Y=g[Z];if(mstrmojo.array.indexOf(f,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=f.concat(a);}}if(j&&j.indexOf(U)>-1){var h=X.filterCandidates(a,j);X.updateSuggestion(h);}},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:((V)?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var V=this.zIndex;this.openPopup("ob",{zIndex:(V&&(V+10))||110});this.ob.browser.browse({folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes});this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopup:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ObjectInputBox-suggest",showTitle:false,modal:false,autoClose:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U&&U.autoSelect){this.list.singleSelect(0);}},onClose:function F(){this.list.clearSelect();if(this.opener){this.opener.suggestionShown=false;}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});},ENUM_STATES:{UNDETERMINED:F,VALID:E,INVALID:D}}));}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st];},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc());}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){this.getContent(this);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new mstrmojo.TreeBrowserNode({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}else{var J=this.selectionParentNode;return J&&J.getSelectedItems();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getContentThroughTaskCall:function C(F,D){var E=mstrmojo.ACL.UserDataService;if(F.isRoot){E.getTopLevelGroups(F,D);}else{E.getMembers(F,D);}},isBranch:function B(D){return D.isGroup;},item2textCss:function A(D){return(this._super&&this._super(D))||{8704:"u",8705:"ug"}[D.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var w=mstrmojo.Enum_OIB_States,v={},x;for(x in w){if(w.hasOwnProperty(x)){v[String(w[x])]=x;}}return v;}());var P=mstrmojo.dom,R=mstrmojo.hash,X=mstrmojo.Enum_OIB_States,I=0,Z="_did_",s=mstrmojo.Enum_Keys,u=80,T=200;function O(){return I++;}function e(v){return(v&&v.state===X.ADDING);}function l(v){var w={n:v||"",state:X.EMPTY};w[Z]=-2;return w;}function N(v){return(v&&v.state===X.EMPTY);}function p(x){var y=x.items,v=y&&y.length;if(!v){return true;}return(v===1&&e(y[0]))||(v===2&&N(y[0])&&e(y[1]));}function h(){var x=this.ctxtBuilder.itemWidgets,v=x[x.length-1];if(v&&v.isAdding){return v;}return null;}function K(){var v=this.editingIdx;if(v!==null){return this.ctxtBuilder.itemWidgets[v];}return h.call(this);}function D(){this.isActive=false;var x=this.emptyText||"",y=this.items;if(p(this)&&!N(y[0])&&(x.length>0)){this.add([l(x)],0);var z=this.ctxtBuilder.itemWidgets[0];z.set("shouldEllipsize",true);z.doEllipsize();}var v=K.call(this);if(v){if(e(v)){v.domNode.style.display="none";}this.scrollTo(this.items[0]);v.blur();}P.detachEvent(document.body,"mousedown",this._mousedownHandler);}function M(){this.isActive=true;if(N(this.items[0])){this.remove(0);}var v=K.call(this);if(v){if(e(v)&&!this.isFull){v.domNode.style.display="block";}this.scrollTo(v.data);v.focus();}P.attachEvent(document.body,"mousedown",this._mousedownHandler);}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,getSearchPattern:function(){var v=K.call(this);if(v){return v.getSearchPattern();}return"";},getSuggestionTarget:function i(){return this.suggestTarget;},onsuggestTargetChanged:function k(v){this._request_pattern=null;},getSuggestionPos:function a(){return this._pop_cfg;},onSuggestionItemSelect:function q(v){this.suggestTarget.setItem(v[this.itemField],v,false);this.hideSuggestion();},hideEditButton:function(v){return !!this.noEditButton;},_set_items:function g(AB,y){y=y||[];var AA=this.maxObjectCount;this.set("isFull",(AA&&y.length>=AA));if(y.length===0){var x=this.emptyText||"";if(x.length>0){y.push(l(x));}}var z={n:"",state:X.ADDING};z[Z]=-1;y.push(z);var v=y[y.length-1];if(v&&e(v)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=Z;return this._super(AB,y);},add:function E(x,v){var y=h.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(x,v);}if(!p(this)&&N(this.items[0])){this.remove(0);}if(y){y.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);}}y.domNode.style.display="none";},remove:function Y(v){this._super(v);var x=h.call(this);if(x){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}x.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function W(){this._super();var x=this,v=h.call(x);if(v){v.domNode.style.display="none";}this._clickHandler=function(){M.call(x);};this._mousedownHandler=function(w){if(!x.isActive||x.browserShown){return ;}var y=P.eventTarget(self,w);if(y&&y.parentNode&&!P.contains(x.domNode,y,false,document.body)&&!P.contains(x.suggestionPopup.domNode,y,false,document.body)){D.call(x);}};P.attachEvent(this.domNode,"click",this._clickHandler);},nextId:O,item2textCss:function L(v){return v.cssClass||"";},itemFunction:function G(AB,x,z){AB[z.itemIdField]=O();var AC=new mstrmojo.ObjectItem({parent:z,itemField:z.itemField,cssClass:z.item2textCss(AB),data:AB});var y=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],v=y.length,AA;for(AA=0;AA<v;AA++){AC.attachEventListener(y[AA],z.id,"_itemChangeHandler");}return AC;},getSelectedObjects:function f(){if(p(this)){return[];}var v=this.items,w=v.length-1;if((w>-1)&&e(v[w])){return v.slice(0,w);}return v.concat();},isValid:function C(){var w=this.ctxtBuilder.itemWidgets,v=w&&w.length,x;for(x=0;x<v;x++){if(!w[x].isValid()){return false;}}return true;},_itemChangeHandler:function(z){var AB=z.name,AC=z.d,x,v=this.items.length,y;switch(AB){case"ItemEditBegin":if(this.editingIdx!==null){y=K.call(this);if(y){y.blur();}}x=this.itemIndex(AC);this.editingIdx=x;M.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(z.deactivate){D.call(this);}else{M.call(this);}y=h.call(this);if(y){y.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){y=K.call(this);if(y){y.blur();}this.editingIdx=null;}x=this.itemIndex(AC);this.remove(x);if(!z.deactivate){this.editingIdx=null;M.call(this);}else{if(!this.isActive){D.call(this);}else{M.call(this);}}break;case"ItemDeletePrev":if(v>1){this.remove(v-2);}break;case"ItemAdd":var AA=R.copy(z.d);this.add([AA],v-1);if(z.deactivate){D.call(this);}else{M.call(this);}break;case"SuggestionOn":this.set("suggestTarget",z.target);this._pop_cfg={target:z.target,left:z.l,top:z.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(z.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AB==="ItemEditEnd"||AB==="ItemAdd"||AB==="ItemDelete"||AB==="ItemDeletePrev"||AB==="ItemEditing")){this.onitemchange();}},unrender:function B(w){var v=this.suggestionPopup;if(v.hasRendered){v.unrender(false);}if(this._super){this._super(w);}},destroy:function o(w){var v=this.suggestionPopup;if(v&&v.hasRendered){v.destroy(false);}if(this._super){this._super(w);}}});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var m="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span class="'+m+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=m+" "+this.cssClass;},onstateChange:function(){var z=this.state,y=mstrmojo.Enum_OIB_States_CSS[z],x=this.domNode;if(z===X.EMPTY){x.innerHTML='<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>";}else{if(z===X.EDITING){var v=Math.round(this.displayNode.clientWidth);this.editNode.style.width=v-4+"px";this.inputNode.style.width=v-9+"px";}}x.className="mstrmojo-ObjectItem "+y;if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},state:X.VALID,onstateChange:function c(v){this.data.state=this.state;},ontextChange:function H(v){this.data[this.itemField]=this.text;},updateData:function F(v){R.copy(v,this.data);this.set("state",X.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function r(w){this._super(w);var y=this.data,v=y.state,x=this.parent;if(typeof v==="undefined"){v=x.dynamicVerify?x.verifyObject(y[this.itemField],this):X.UNDETERMINED;y.state=v;}this.cssClass=x.item2textCss(y);this.text=y[this.itemField];this.state=v;this.isAdding=e(y);this.useRichTooltip=true;},isValid:function C(){var v=parseInt(this.state,10);return(v!==X.INVALID&&v!==X.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var y=this.inputNode.style;y.width=u+"px";var x=this.domNode.parentNode,v=x.parentNode.offsetWidth,w=Math.max(v-x.offsetLeft-20,u);if(!isNaN(w)){y.width=w+"px";}}},blur:function S(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var x=this.inputNode,v=x.value,w=this.parent;window.setTimeout(function(){try{x.blur();}catch(y){}},0);if(!v){return ;}if(w.acptSugItemOnly){this.set("text",v);this.set("text","");this._tWas_=null;return ;}this.setItem(v,null,true);},focus:function n(){var w=this.inputNode,v=this.isActive;window.setTimeout(function(){try{w.focus();if(w.createTextRange&&!v){var y=w.createTextRange(),x=w.value.length;y.move("character",x);y.select();}}catch(z){}},0);this.isActive=true;},prekeydown:function J(v){var x=this.inputNode.value,w=parseInt(v.e.keyCode||v.e.charCode,10),z=this.parent;if(!x){return ;}if(w===s.TAB||w===s.ENTER){P.preventDefault(v.hWin,v.e);var y=z.getSelected();if(y){z.handleSuggestionItemSelect(y);}else{this.hideSuggestion();if(!z.acptSugItemOnly){this.setItem(x,null,false);}else{this.set("text",x);this.set("text","");}}}else{if(w===s.DOWN_ARROW){if(!z.noCache){this.showSuggestion(x);}z.nextHighlight();}else{if(w===s.UP_ARROW){z.preHighlight();}}}},prekeyup:function t(v){var x=this.inputNode.value,w=parseInt(v.e.keyCode||v.e.charCode,10),AA=this.isAdding,z=this.parent;if(!x){if(AA){if(w===s.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});P.preventDefault(v.hWin,v.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(w===s.ESCAPE){this.hideSuggestion();if(z.acptSugItemOnly){this.set("text",x);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==x){this.raiseEvent({name:"ItemEditing",d:this.data});if(z.useKeyDelay){if(!this._timerID){var y=this;this._timerID=window.setTimeout(function(){var AB=y.inputNode.value;if(AB){y.showSuggestion(AB);}y._timerID=null;},T);}}else{this.showSuggestion(x);}}}this._tWas_=x;},setItem:function(v,x,w){var z=this.isAdding,y=this.parent;w=w||false;this.set("text",v);this._tWas_=null;if(z){this.set("text","");if(!x){x={};x[this.itemField]=v;}else{x.state=X.VALID;}this.raiseEvent({name:"ItemAdd",d:x,deactivate:w});}else{this.set("text",v);if(x){this.updateData(x);}else{this.set("state",y.verifyObject(v,this));this.set("cssClass",y.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:x,deactivate:w});}},getSearchPattern:function U(){return this.inputNode.value;},showSuggestion:function j(v){var w=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(w.x)+"px",t:Math.round(w.y+w.h)+"px",pattern:v,target:this});},hideSuggestion:function d(){this.raiseEvent({name:"SuggestionOff"});},del:function Q(v){v=v||self.event;P.stopPropogation(self,v);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function V(){this.showSuggestion(this.text);this.set("state",X.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});},doEllipsize:function b(){if(!this.shouldEllipsize){return ;}var w=this.maxItemWidth,v;if(w){this.domNode.style.maxWidth=w;switch(parseInt(this.state,10)){case X.VALID:case X.UNDETERMINED:case X.INVALID:v=this.textNode;break;case X.EMPTY:v=this.domNode.firstChild;break;}if(v){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(v,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{item2textCss:function A(C){return(this._super&&this._super(C))||{8704:"u",8705:"ug"}[C.st]||"";},getCandidatesThroughTaskCall:function B(D,C){mstrmojo.ACL.UserDataService.searchUserCandidates(D.pattern,!D.isVerify,D.blockCount,C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.StackContainer","mstrmojo.CheckList");var Y=mstrmojo.css,K=mstrmojo.array,L=[],H="sharingEditor",A=199,C="294DEDC011D2F1D56000D98E67019608",g="C82C6B1011D2894CC0009D9F29718E4F",E=[1,4,8,16,32,64,128],b=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],e=["B","R","W","D","C","U","E"],T=false,O=true,M=257,f=1024,S=772,P=776,B=777;function c(h){return(h&&h.t===8);}function Z(h){return h&&h.st!=M&&h.st!=f&&h.st!=S&&h.st!=P&&h.st!=B;}function R(h){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[h]||h;}function J(h){return{"253000":255000,"253":255,"32221":223,"56197":199}[h]||h;}function W(o){var n=o.acls,h=o.inhs,m=[],q,k,p,j,l;if(c(o)){n=n.concat(mstrmojo.hash.valarray(h));}for(j=0,l=n.length;j<l;j++){q=n[j];p=q.rgt;if(p>1000){k=mstrmojo.hash.copy(q);k.den=true;k.rgt=Math.floor(p/1000);m.push(k);}if((p%1000)>0){k=mstrmojo.hash.copy(q);k.den=false;k.rgt=p%1000;m.push(k);}}o.acls=m;return o;}function Q(i){var h={isSerializable:function(l,k,j){switch(l){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(l,j,k){if(l==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",i,h);}function F(k,j){var i=k&&k.oi,h;if(i){i=W(i);h=Q(i);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(l){if(j){k.close();}},failure:function(l){mstrmojo.alert(l.getResponseHeader("X-MSTR-TaskFailureMsg"));if(j){k.close();}}},{taskId:"saveObjectACL",objectXML:h,sessionState:mstrApp.sessionState,objectType:i.t,objectID:i.did,propagateToChildren:k.childrenAccessPulldown.value});}}function a(q){var v=q.aclList,w=q.objectInputer,r=q.rightPulldown,l=w.getSelectedObjects(),n=l.length,s=[],k,u=r.value,j,t,h;if(!w.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,q.alertTitle);return false;}for(j=0;j<n;j++){k=l[j];if(k.did===C||k.did===g){var m=mstrmojo.all[H];if(u===m.currentPublicRight){if(O){Y.removeClass(m.userMessage.domNode,"hideMsg");}}}t=K.find(v.items,"did",k.did);if(t!==-1){h=v.items[t];if(q.uneditableRights[h.rgt]){continue;}}s.push(new mstrmojo.Obj({n:k.n,did:k.did,st:k.st,rgt:u,newItem:true}));}if(s.length>0){var p=K.findMulti(v.items,"did",s);if(p.count){var o=p.indices.concat().sort(K.numSorter).slice(0,p.count);for(j=o.length-1;j>-1;j--){v.remove(o[j]);}}v.add(s);q.set("hasChanged",true);}w.set("items",[]);return true;}function d(j){var l=[],o=Math.floor(j/1000),m=j%1000,p=E,q=b,n=p.length,t,k;for(k=0;k<n;k++){l.push(q[k]);l.push(" ");if((m&p[k])>0){l.push(mstrmojo.desc(8083,"Granted"));}else{if((o&p[k])>0){l.push(mstrmojo.desc(8084,"Denied"));}else{l.push(mstrmojo.desc(959,"Default"));}}l.push(",");}t=l.join("");return t.substring(t,t.length-1);}function D(q){var n=[],p=q%1000,l=E,o=e,j=l.length,m,k;for(k=0;k<j;k++){if((p&l[k])>0){n.push(o[k]);n.push(",");}}m=n.join("");return m.substring(m,m.length-1);}function X(j,k){var l=j.items,i=K.find(l,j.itemIdField,k),n=j.customItem,h=l.length-2;if(i===-1){var m={n:D(k),rgt:k};if(n){l.splice(h,1);}h=l.length-1;l.splice(h,0,m);j.customItem=m;}else{if(n&&i!==h){l.splice(h,1);j.customItem=null;}}j.set("title",d(k));j.value=k;}function I(h){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[h]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full Control"),rgt:255},{n:mstrmojo.desc(8088,"Denied All"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function V(o,n){var m="";if(n){var j=this.widthInput.value,p=this.heightInput.value,h=' src="'+o,q="",k=this.checkBoxList.items,l;for(l=0;l<k.length;l++){if(!this.checkBoxList.selectedIndices.hasOwnProperty(l)){if(q==""){q="&hiddensections="+k[l].alias;}else{q+=","+k[l].alias;}}}m='<iframe width="'+j+'" ';m+='height="'+p+'" ';m+=h;m+=q;m+='"></iframe>';}else{m='<iframe width="640" height="480" src="';m+=o;m+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return m;}function G(i){var k=mstrmojo.string.parseUri(i).queryKey,l=i.indexOf("?"),h=l>0?i.substring(0,l):i;if(k.hasOwnProperty("iframe")){delete k.iframe;}if(k.hasOwnProperty("validateRandNum")){delete k.validateRandNum;}if(!k.hasOwnProperty("server")){k.server=encodeURIComponent(mstrApp.serverName);}if(!k.hasOwnProperty("Project")){k.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!k.hasOwnProperty("port")){k.port=mstrApp.serverPort;}if(T){k.connmode=8;k.ru=1;}k.share=1;h+="?";for(var j in k){h+=j+"="+k[j]+"&";}h=h.substring(0,h.length-1);return h;}function U(k){var h=new Date(),j=this.objectName+" "+h.toLocaleDateString()+" "+h.toLocaleTimeString(),i=this,l={success:function(o){var n=G(o.url);i.linkBox.set("value",n);i.url=n;i.htmlPanel.htmlBox.set("value",V(n));var m=i.tabDock.emailLink;m.set("url",window.escape(n));m.set("name",i.objectName);},failure:function(m){mstrmojo.alert(m.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){i.hideWait();if(k){window.open("mailto:?body="+window.escape(i.url)+"&subject="+i.objectName,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,l,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:j,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function N(l){var j=I(this.oi.st),h=j.length,k;for(k=0;k<h;k++){if(j[k].rgt===l){return j[k].n;}}return mstrmojo.desc(2056,"Custom");}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",hasChanged:false,help:"sharing_dialog_box.htm",zIndex:1000,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),onShowLink:function(i){var h={htmlCode:"showLink",showLink:"htmlCode"};this.tabDock[h[i]].set("selected",false);},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var p=this.oi.acls,k,s=K.find(p,"did",g),n=this.aclList.itemsContainerNode,o=this.publicAccessSection.publicLabel,m,r=false,h=K.find(p,"did",C),q;if(s!==-1&&T&&h!==-1){var j=p[s].rgt,l=p[h].rgt;if(j===l){r=true;q=l;}}if(s!==-1&&!T){r=true;q=p[s].rgt;}m=n.children[0].tBodies;if(T&&m[h]){Y.toggleClass(m[h].rows[0],"hide",r);}if(m[s]){Y.toggleClass(m[s].rows[0],"hide",r);}o.set("checked",r);if(q){this.set("currentPublicRight",q);}},oncurrentPublicRightChange:function(){var h=this.publicAccessSection.publicMouseOver;h.publicRight.set("value",this.currentPublicRight);h.publicRightLabel.set("text",N.call(this,this.currentPublicRight));},onOpen:function(){var i=this.oi.n,o=this.oi.acls;this.objectName=i;this.set("showACL",!!o);T=this.guestModeEnabled;if(this.href&&!this.isLinkDirty){var j=G(this.href),m=this.tabDock.emailLink;this.url=j;m.set("url",window.escape(j));m.set("name",i);this.htmlPanel.htmlBox.set("value",V(j));this.linkBox.set("value",j);}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(i)));var l=this.tabDock;l.showLink.set("selected",false);l.htmlCode.set("selected",false);if(o){this.checkPublicAccess();var n=this.rightPulldown;n.set("items",this.getAvailableRightsForSelection());n.set("value",A);var p=this.objectInputer,k=this.userSelector,h=k&&k.userBrowser;p.zIndex=this.zIndex;if(h&&h.hasRendered){h.set("items",[]);h.getContent(h);}this.set("hasChanged",false);}},_set_hasChanged:function(j,h){var i=(h!==this.hasChanged);this.hasChanged=h;if(h===true){this.checkPublicAccess();}return i;},_set_oi:function(i,h){this.oi=this.preProcessACLs(h);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return I(this.oi.st);},preProcessACLs:function(p){if(p&&p.acls){var n=p.acls,m=n&&n.length,o=c(p),j={},q,h,k,l;if(o){k={};p.inhs=k;}for(l=0;l<m;l++){q=new mstrmojo.Obj(n[l]);if(o&&q.inh){k[q.n]=mstrmojo.hash.copy(q);continue;}h=j[q.n];if(!h){h=mstrmojo.hash.copy(q);h.rgt=0;delete h.den;j[q.n]=h;}h.rgt+=q.den?q.rgt*1000:q.rgt;}n=mstrmojo.hash.valarray(j);p.acls=n;}return p;},onClose:function(){var h=this.objectInputer;h.set("items",[]);this.aclList.clearSelect();},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",updateTreeContent:function(i,k){i.contentRetrieved=true;var j=k[i.itemChildrenField],h=i.tree||i,m=k.bc,l=k.sz,n=k.bb;if(m!==-1){if(n+m<=l){j.push(h.nextItemCreaterFunc());}if((n-m)>-1){j.unshift(h.prevItemCreaterFunc());}}i.blockBegin=n;h.initializing=true;i.clearSelect(false);i.set("items",j);i.setSelectedItems(h.getTotalSelections(),true);h.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(i){var h=this.parent.parent,m=h.opener,l=m.objectInputer,k=h.userBrowser,j=k.getTotalSelections();if(j&&j.length>0){l.add(j,l.items.length-1);}h.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(h){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var o=this.rgt,p=Math.floor(o/1000),n=o%1000,k=this.children,l,m,j,h;for(j=0,h=k.length;j<h;j++){l=k[j];m=l.right;if(this.twoStates){l.set("grayed",false);l.set("checked",false);}else{l.set("grayed",true);l.set("checked",true);}if((p&m)>0){l.set("checked",false);l.set("grayed",false);}if((n&m)>0){l.set("checked",true);l.set("grayed",false);}}},getACLValue:function(){var m=0,n=0,k=this.children,l,j,h;for(j=0,h=k.length;j<h;j++){l=k[j];if(l.grayed||!l.right){continue;}if(l.checked){m+=l.right;}else{n+=l.right;}}return n*1000+m;},children:[{scriptClass:"mstrmojo.TristateCheckBox",alias:"browse",right:1,text:mstrmojo.desc(1825,"Browse")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"read",right:4,text:mstrmojo.desc(8078,"Read")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"write",right:8,text:mstrmojo.desc(8079,"Write")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"delete",right:16,text:mstrmojo.desc(629,"Delete")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"control",right:32,text:mstrmojo.desc(8080,"Control")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"use",right:64,text:mstrmojo.desc(8081,"Use")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"execute",right:128,text:mstrmojo.desc(8082,"Execute")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(h){var i=this.parent.parent;if(i.onOK){i.onOK();}i.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(h){var i=this.parent.parent;if(i.onCancel){i.onCancel();}i.close();}}]}]},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9811,"Sharing Options"),bindings:{visible:function(){return Z(this.parent.oi);}},cssClass:"SharingEditor-title"},{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return Z(this.parent.oi);}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink style="{@cssText} mstrAttach:click>'+mstrmojo.desc(9772,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var h=this.parent.parent;if(!this.url||h.isLinkDirty){U.call(h,true);h.set("isLinkDirty",false);}else{window.open("mailto:?body="+window.escape(h.url)+"&subject="+h.objectName,"mailtoIframe");}}},{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Show Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(h){var i=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!i.url||i.isLinkDirty){U.call(i);i.set("isLinkDirty",false);}i.onShowLink(this.alias);this.set("selected",true);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(h){var i=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!i.url||i.isLinkDirty){U.call(i);i.set("isLinkDirty",false);}i.onShowLink(this.alias);this.set("selected",true);}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(2985,"Width"),value:640,onvalueChange:function(h){var i=this.parent,j=mstrmojo.all[H];i.htmlBox.set("value",V.call(i,j.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(2983,"Height"),alias:"heightInput",value:480,onvalueChange:function(){var h=this.parent,i=mstrmojo.all[H];h.htmlBox.set("value",V.call(h,i.url,true));}},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation Bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools Panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(h){var i=this.parent,j=mstrmojo.all[H];i.htmlBox.set("value",V.call(i,j.url,true));}}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.TextBox",alias:"linkBox",cssClass:"SharingEditor-Link",bindings:{visible:"this.parent.tabDock.showLink.selected"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"[Who has access]"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");}},oncheckedChange:function(){Y.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(T){this.getUserGroupFromTaskCall(C);}this.getUserGroupFromTaskCall(g);},getUserGroupFromTaskCall:function(n){var j=mstrmojo.all[H],k=j.aclList,l=mstrmojo.ACL.UserDataService,m=function(p){var o=new mstrmojo.Obj({n:p.n,did:p.did,st:p.st,rgt:A,newItem:true});L.push(o);},i=function(o){},h=function(){if(!T||(T&&L.length==2)){k.add(L);j.set("hasChanged",true);}};l.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:n}},{success:m,failure:i,complete:h});},onclick:function(){var i=mstrmojo.all[H];var j=i.aclList.items;var k=K.find(j,"did",g);if(k!==-1){j.remove(k);}var h=K.find(j,"did",C);if(T&&h!==-1){j.remove(h);}if(this.checked===true){if(L.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(L,function(l){l.rgt=A;});j.add(L);i.set("hasChanged",true);}}else{i.set("currentPublicRight",A);i.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",bindings:{visible:"this.parent.publicLabel.checked"},children:[{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var h=this.parent.parent.parent;return N.call(h,h.currentPublicRight);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight"},selectionPolicy:"reselect",onvalueChange:function(){var h=this.parent;var i=h.parent.parent;h.publicRightLabel.set("text",N.call(i,this.value));},_set_value:function(m,i){var j=this.value,h=(j!==i);if(h){if(i===-1){var l=this.parent.parent.parent,k=this;l.openPopup("customACL",{zIndex:l.zIndex+10,rgt:j,twoStates:true,onOK:function(){k.set("value",this.getACLValue());},onCancel:function(){k.set("value",j);}});return false;}i=J(i);X(this,i);this.updatePublicRight(i);return true;}return true;},updatePublicRight:function(i){var j=this.parent.parent.parent;if(j.aclList){var k=j.aclList.items;var h=K.find(k,"did",C);var l=K.find(k,"did",g);if(T&&h!==-1){k[h].rgt=i;}if(l!==-1){k[l].rgt=i;}j.set("hasChanged",true);j.set("currentPublicRight",i);}}}]}]},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){Y.addClass(this.domNode,"hideMsg");O=false;}},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(j){var m=this.parent.oi;if(!c(m)){return ;}var o=m.inhs,l=j.value,h=l&&l.length,p,k;for(k=0;k<h;k++){p=l[k].n;delete o[p];}},onadd:function(j){var m=this.parent.oi;if(!c(m)){return ;}var o=m.inhs,l=j.value,h=l&&l.length,p,k;for(k=0;k<h;k++){p=l[k].n;o[p]=mstrmojo.hash.copy(l[k]);o[p].inh=true;}},onACLChanged:function(i){var h=this.parent.oi;this.parent.set("hasChanged",true);if(!c(h)){return ;}h.inhs[i.n]=mstrmojo.hash.copy(i);h.inhs[i.n].inh=true;},columns:[{dataFunction:function(j,h,i){return'<div class="mstrmojo-ACLEditor-user '+(j.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(j.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",children:[{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){return N.call(mstrmojo.all[H],this.parent.parent.data.rgt);}}},{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var h=this.parent.parent.data;this.set("value",h[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(m,i){var j=this.value,h=(j!==i);if(h){if(i===-1){var l=this.parent.parent.dataGrid.parent,k=this;l.openPopup("customACL",{zIndex:l.zIndex+10,rgt:j,twoStates:!!this.parent.parent.data.newItem,onOK:function(){k.set("value",this.getACLValue());},onCancel:function(){k.set("value",j);}});return false;}i=R(i);X(this,i);this.parent.parent.data.set(this.itemIdField,i);if(j!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(h){var i=this.parent.parent.dataGrid;i.remove(this.parent.parent.data);i.parent.set("hasChanged",true);}}]}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.UserInputBox",emptyText:mstrmojo.desc(9151,"Type users or groups here."),noCache:true,onRender:function(){var h=this.parent.parent.parent;if(h){h.objectInputer=this;}}},{scriptClass:"mstrmojo.Pulldown",itemIdField:"rgt",value:199,defaultSelection:0,selectionPolicy:"reselect",onRender:function(){var h=this.parent.parent.parent;if(h){h.rightPulldown=this;}},postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},_set_value:function(m,i){var j=this.value,h=(j!==i);if(h){if(i===-1){var l=this.parent.parent.parent,k=this;l.openPopup("customACL",{zIndex:l.zIndex+10,rgt:j,twoStates:true,onOK:function(){k.set("value",this.getACLValue());},onCancel:function(){k.set("value",j);}});return false;}i=J(i);X(this,i);return true;}return true;}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",onclick:function(h){var i=this.parent.parent.parent;a(i);},text:mstrmojo.desc(2156,"Add")},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-ACLEditor-chooseLabel",onclick:function(h){var i=this.parent.parent.parent;i.openPopup("userSelector",{zIndex:i.zIndex+10});},text:mstrmojo.desc(1825,"Browse")}]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&c(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&c(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),bindings:{enabled:function(){var h=this.parent.parent.oi;return(h.acg&32)>0&&this.parent.parent.hasChanged;}},onclick:function(h){var i=this.parent.parent;if(a(i)){F(i,true);}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Close",onclick:function(h){var i=this.parent.parent;i.close();i.set("hasChanged",false);},bindings:{iconClass:function(){var h=this.parent.parent;if(h.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){var h=this.parent.parent;if(!h.showButtonText){return"";}if(h.hasChanged){return mstrmojo.desc(2140,"Cancel");}return mstrmojo.desc(2102,"Close");}}}]}]});mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch){this.set("selected",this.children[1]);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.children[0]);}},preBuildRendering:function(){this.set("selected",this.children[0]);}});}());