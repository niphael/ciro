(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._ListSelections");mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onheightChange:function(){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width;}}},buildRendering:function bldRnd(){this.itemsHtml="";var len=this.items&&this.items.length;if(len){this.itemsHtml=this._buildItemsMarkup(0,len-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,_buildItemsMarkup:function(start,end,markupPrefix,markupSuffix,itemPrefix,itemSuffix){var markup=[],count=0;markup[count++]=markupPrefix||"";var ir=this.itemRenderer,fn=ir&&ir.render;if(fn&&typeof (fn)=="function"){var PRE=itemPrefix||"",POST=itemSuffix||"",its=this.items,len=(its&&its.length)||0,me=this;for(var i=start,stop=Math.min(end+1,len);i<stop;i++){markup[count++]=PRE;markup[count++]=fn(its[i],i,me);markup[count++]=POST;}}markup[count++]=markupSuffix||"";return markup;},onselectionChange:function onselChg(evt){if(!evt){return ;}var ir=this.itemRenderer;if(!ir){return ;}var unsel=ir.unselect,its=this.items||[],rem=evt.removed,ix,el;if(unsel&&rem){for(var j=0,jLen=rem.length;j<jLen;j++){ix=rem[j];el=this._getItemNode(ix);if(el){unsel(el,its[ix],ix,this);}}}var sel=ir.select,added=evt.added;if(sel&&added){for(var i=0,len=added.length;i<len;i++){ix=added[i];el=this._getItemNode(ix);if(el){sel(el,its[ix],ix,this);}}}if(this.onchange){this.onchange();}},onselect:function onsel(evt){if(this.makeSelection&&evt.idxs&&evt.idxs.length){var selItem=this._getItemNode(evt.idxs[0]);this.makeSelection({selIdx:evt.idxs[0],selItem:selItem});}},autoHide:false,init:function init(props){this._super(props);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},_getItemNode:function(idx){var itemsNode=this.itemsContainerNode;return(itemsNode&&itemsNode.childNodes[idx])||null;},_set_items:function stitems(n,v){if(this.autoHide){this.set("visible",!!(v&&v.length));}var was=this.items;this.items=v;if(was!=v){var hr=this.hasRendered;if(hr){this.unrender();}this.clearSelect();if(hr){this.render();}return true;}else{return false;}return was!=v;}});})();