(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom");var $DOM=mstrmojo.dom,$POS=$DOM.position,$MTH=Math;function getCloneInfo(key,srcNode,isMultiLine){var ellCollection=this._ellTestNodes||{},info=ellCollection[key],compStyle=mstrmojo.css.getComputedStyle(srcNode),dimensions=["width","height"];if(isMultiLine){dimensions.reverse();}var testDimension=dimensions[0],oppositeDimension=dimensions[1];if(!info||!$DOM.contains(this.domNode,info.n,true,document.body)){var node=srcNode.cloneNode(true);node.removeAttribute("id");node.removeAttribute("onclick");var nodeStyle=node.style;nodeStyle.position="absolute";nodeStyle.top="-10000px";nodeStyle.maxHeight=nodeStyle.maxWidth="none";nodeStyle[testDimension]="auto";srcNode.parentNode.appendChild(node);var max=parseInt(compStyle["max-"+testDimension],10);if(isNaN(max)){max=parseInt(compStyle[testDimension],10);}info=ellCollection[key]={n:node,m:max,d:testDimension.substr(0,1)};this._ellTestNodes=ellCollection;}else{info.n.innerHTML=srcNode.innerHTML;}info.n.style[oppositeDimension]=compStyle[oppositeDimension];return info;}function addEllipsis(textArray,length){var ellipsisText=this.ellipsisText;switch(this.ellipsisPosition){case"middle":var mid=$MTH.floor(length/2);return textArray.slice(0,mid).join("")+ellipsisText+textArray.slice(-mid).join("");case"end":return textArray.slice(0,length).join("")+ellipsisText;default:return textArray.join("");}}var COMPARE_THRESHOLD=4;mstrmojo._SupportsEllipsisText=mstrmojo.provide("mstrmojo._SupportsEllipsisText",{_mixinName:"mstrmojo._SupportsEllipsisText",ellipsisText:"&hellip;",ellipsisPosition:"end",ellipsize:function ellipsize(key,element,isMultiLine){var text=element.innerHTML;if(!text){return false;}var info=getCloneInfo.call(this,key,element,isMultiLine),fnTestFit=function(){var cloneDimension=$POS(info.n)[info.d];return(cloneDimension<=info.m);};if(fnTestFit()){return false;}var node=info.n,textArray=text.split(""),low=0,high=textArray.length,ellipsizedText,x;while(low<high){var mid=$MTH.floor((low+high)/2);text=node.innerHTML=addEllipsis.call(this,textArray,mid);if(fnTestFit()){low=mid+1;}else{high=mid-1;}if(high-low<COMPARE_THRESHOLD){for(x=low-1;x<high+1;x++){text=node.innerHTML=addEllipsis.call(this,textArray,x);if(!fnTestFit()){break;}ellipsizedText=text;}}if(ellipsizedText){element.innerHTML=ellipsizedText;break;}}return true;},unrender:function unrender(ignoreDom){delete this._ellTestNodes;this._super(ignoreDom);}});}());