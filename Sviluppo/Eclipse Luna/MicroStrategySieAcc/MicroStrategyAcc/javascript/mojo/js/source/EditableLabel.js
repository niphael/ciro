(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.EditableLabel",text:null,editable:false,title:"",markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@editable}" style="{@cssText}" mstrAttach:click,blur,keyup></div>',markupMethods:{ontextChange:function(){this.domNode.innerHTML=(this.text!=null)?this.text:"";},oncssTextChange:function(){this.domNode.style.cssText=(this.cssText!=null)?this.cssText:"";},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},oneditableChange:function(){this.domNode.contentEditable=this.editable;this.domNode.spellcheck=false;mstrmojo.css[this.editable?"addClass":"removeClass"](this.domNode,["editable"]);if(this.editable){this.domNode.focus();document.execCommand("selectAll",false,null);}else{this.domNode.blur();}}},autoHide:false,_set_text:function sttxt(n,v){if(this.autoHide){this.set("visible",(v!=null)&&(v!==""));}var was=this.text;this.text=v;return was!=v;},onclick:function(){this.set("editable",true);},onblur:function(){this.set("text",this.domNode.innerHTML);this.set("editable",false);},onkeyup:function(event){var evt=window.event?window.event:event.e;var key=evt.keyCode;if(key==27){this.set("text",this.data.name);this.set("title",this.data.name);this.render();}if(key==13){var newText=this.domNode.innerHTML.replace(/<div><br><\/div>/,"");newText=newText.replace(/<br>/,"");newText=newText.replace(/<br><br>/,"");if(newText.length>0){this.set("text",newText);this.set("title",newText);}else{this.set("text",this.data.name);this.set("title",this.data.name);this.render();}this.set("editable",false);}}});})();