(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable");var $D=mstrmojo.dom;mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title"></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},titlebarNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild:null;},helpNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[1].firstChild:null;},closeNode:function(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[2].firstChild:null;},containerNode:function(){return this.domNode.firstChild.childNodes[2];},buttonNode:function(){return this.domNode.firstChild.childNodes[3];},curtainNode:function(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var zIndex=this.zIndex;this.editorNode.style.zIndex=zIndex;this.curtainNode.style.zIndex=zIndex-1;},onvisibleChange:function(init){if(init){return ;}var v=this.visible,fx="closeEffect",d="none";if(v){fx="openEffect";d="block";}if(this[fx]){this.playEffect(fx);}else{this.editorNode.style.display=d;if(this.modal){this.curtainNode.style.display=d;}}},onhelpChange:function(){if(this.showTitle){if(this.help===null){this.helpNode.style.display="none";}this.helpNode.href=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId?mstrApp.helpLocaleId:mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm")+"#"+(this.help||"");}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";}},preBuildRendering:function preBuildRendering(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function getMovingHandle(){return this.titlebarNode;},getMovingTarget:function getMovingTarget(){return this.editorNode;},onPreClose:function(){return true;},premousedown:function premousedown(evt){var target=$D.eventTarget(evt.hWin,evt.e);if(target===this.closeNode){if(this.onPreClose()){this.close();}}},_set_visible:function _set_visible(n,v){var bChanged=(this[n]!==v);if(bChanged){this[n]=v;var closeHandler=this._close_handler;if(v){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var me=this;closeHandler=this._close_handler=closeHandler||function(evt){var t=$D.eventTarget(self,evt);if(t&&t.parentNode&&!$D.contains(me.editorNode,t,true,document.body)){me.close();}};$D.attachEvent(document.body,"mousedown",closeHandler);}}else{var curtainHandler=this._curtain_handler;if(curtainHandler){$D.detachEvent(window,"resize",curtainHandler);}if(closeHandler){$D.detachEvent(document.body,"mousedown",closeHandler);}}}return bChanged;}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(v){v=Math.round(v);return["rgb(",v,",",v,",",v,")"].join("");}}},preStart:function(){var target=this.target,widget=this.widget;widget.editorNode.style.display="block";if(!widget.modal){return false;}target.style.display="block";mstrmojo.css.setOpacity(target,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var widget=this.widget;widget.editorNode.style.display="none";return !!widget.modal;}};}());