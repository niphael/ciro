(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Table","mstrmojo.CheckBox","mstrmojo.ME.TokenInputBox","mstrmojo.ME.LevelInputBox","mstrmojo.ME.ConditionInputBox","mstrmojo.ME.TransformInputBox","mstrmojo.ME.MetricDataService","mstrmojo.DataGrid","mstrmojo.Button","mstrmojo.ToolBar","mstrmojo.ObjectBrowser","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper");var _setupFunctionProps=function(fctProps,fct){dftsFctProps=[{n:"Distinct",dtp:11,dfv:"0",desc:""},{n:"Null",dtp:11,dfv:"0",desc:""},{n:"UseLookupForAttributes",dtp:11,dfv:"-1",desc:""},{n:"FactID",dtp:-1,desc:"",items:[]}];for(var i=0,len=dftsFctProps.length;i<len;i++){var dft=dftsFctProps[i],idx=mstrmojo.array.find(fctProps,"n",dft.n);if(idx>-1){mstrmojo.hash.copy(dft,fctProps[idx]);}else{fctProps.push(dft);}}return fctProps;};var EnumEditorComponents={level:-4,condition:-5,transformation:-6,simple:-7},hasAllComponents=function(t){return !(t==-4||t==-5||t==-6);},hasComponent=function(t,w){return hasAllComponents(t)||t==EnumEditorComponents[w];};var FillerItem={n:"",did:"-1"};var simpleMetricContent1=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9574,"Aggregation Function:"),slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"did",itemField:"n",cssText:"width:250px;margin:0px;",alias:"fctPulldown",onvalueChange:function(evt){var syntax="",desc="",item=this.selectedItem;if(item){desc=item.n+": "+item.desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(item.h);var pars=item.pars,sa=[],i,len;sa.push(item.n);sa.push("(");for(i=0,len=pars.length;i<len;i++){sa.push(pars[i].n);if(i!==(len-1)){sa.push(", ");}}sa.push(")");syntax=sa.join("");}this.parent.parent.set("fctSyntax",syntax);this.parent.parent.set("fctDesc",desc);if(evt.valueWas){this.parent.parent.onmetricModify();}},slot:"0,1"},{scriptClass:"mstrmojo.ToolBar",cssClass:"mstrmojo-oivmSprite grouped",cssText:"margin-right: 42px;",children:[{scriptClass:"mstrmojo.Button",iconClass:"tbOptions",title:mstrmojo.desc(-1,"Function Parameters"),onclick:function(){var me=this.parent.parent.parent;me.openPopup("functionPropsRef",{zIndex:me.zIndex+10});}}],slot:"0,2"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9575,"Expression:"),slot:"1,0"},{scriptClass:"mstrmojo.ME.MetricEditBox",alias:"metricEditBox",cssText:"width: 250px;",showStatus:false,ontokensModify:function(evt){this.parent.parent.onmetricModify();},continueValidataion:function(){var editor=this.parent.parent;editor.oi.tks.items=editor.getMetricDefAsTokens();editor.validateSyntax(editor.tbValidate);},updateInputBoxItems:function(r){var start=2;this.inputBox.set("items",r.items.slice(start,start+this.inputBox.items.length));},preBuildRendering:function(){var editor=this.parent.parent,ei=this.inputBox;mstrmojo.css.addWidgetCssClass(ei,"expr");ei.useKeyDelay=true;ei.noCache=editor.noCache;if(this._super){this._super();}},slot:"1,1"},{scriptClass:"mstrmojo.ToolBar",slot:"1,2",cssClass:"mstrmojo-oivmSprite grouped",cssText:"margin-right: 42px;",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var me=this.parent.parent.parent;browseObject(me,"expression");}}]}],simpleMetricContent2=[{scriptClass:"mstrmojo.Button",cssClass:"toggle level",alias:"toggleLevel",text:mstrmojo.desc(4788,"Level"),bindings:{selected:function(){return hasComponent(this.parent.parent.did,"level");}},onclick:function(evt){var ex=!!!this.selected;this.set("selected",ex);},slot:"0,0"},{scriptClass:"mstrmojo.ME.LevelInputBox",emptyText:mstrmojo.desc(9576,"Type the attribute name here..."),alias:"levelInput",bindings:{expanded:function(){var hidden=!this.parent.toggleLevel.selected;this.cssClass=this.cssClass.replace(/ hidden/g,"")+(hidden?" hidden":"");if(this.domNode){this.domNode.className=this.domNode.className.replace(/ hidden/g,"")+(hidden?" hidden":"");}},noCache:function(){return this.parent.parent.noCache;}},reportLevelAdded:true,onadd:function(evt){var sos=this.getSelectedObjects();this.set("reportLevelAdded",ARR.find(sos,"did",-1)>-1);},onremove:function(evt){var sos=this.getSelectedObjects();this.set("reportLevelAdded",ARR.find(sos,"did",-1)>-1);},onitemchange:function(){this.parent.parent.onmetricModify();},onSaveOnClose:function(){this.parent.parent.onmetricModify();},slot:"1,1"},{scriptClass:"mstrmojo.ToolBar",slot:"1,2",cssClass:"mstrmojo-oivmSprite grouped",bindings:{visible:function(){return this.parent.toggleLevel.selected;return hasComponent(this.parent.parent.did,"level");}},children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var me=this.parent.parent.parent;browseObject(me,"level");}},{scriptClass:"mstrmojo.Button",iconClass:"tbOptions",title:mstrmojo.desc(9577,"Level Advanced Options"),onclick:function(){var me=this.parent.parent.parent;me.openPopup("levelAdvRef",{saveLevelOptions:function(cc,fr){me.levelCanContinue=cc;me.levelFilterRest=fr;},zIndex:me.zIndex+10});}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(9578,"Add Report Level"),iconClass:"tbReport",bindings:{enabled:"!this.parent.parent.levelInput.reportLevelAdded"},onclick:function(){var li=this.parent.parent.levelInput;li.add([{n:"Report Level",did:-1,t:-1,state:0}],li.items.length-1);}}]},{scriptClass:"mstrmojo.Button",cssClass:"toggle condition",alias:"toggleCondition",text:mstrmojo.desc(9579,"Condition"),bindings:{selected:function(){return hasComponent(this.parent.parent.did,"condition");}},onclick:function(evt){var ex=!!!this.selected;this.set("selected",ex);},slot:"2,0"},{scriptClass:"mstrmojo.ME.ConditionInputBox",cssClass:"mstrmojo-ObjectInputBox singleObject condition",cssText:"width:252px;",emptyText:mstrmojo.desc(9580,"Type the filter name here..."),alias:"conditionInput",bindings:{expanded:function(){var hidden=!this.parent.toggleCondition.selected;this.cssClass=this.cssClass.replace(/ hidden/g,"")+(hidden?" hidden":"");if(this.domNode){this.domNode.className=this.domNode.className.replace(/ hidden/g,"")+(hidden?" hidden":"");}},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();},slot:"3,1"},{scriptClass:"mstrmojo.ToolBar",slot:"3,2",cssClass:"mstrmojo-oivmSprite grouped",bindings:{visible:function(){return this.parent.toggleCondition.selected;return hasComponent(this.parent.parent.did,"condition");}},children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",bindings:{enabled:"!this.parent.parent.conditionInput.isFull"},onclick:function(){var me=this.parent.parent.parent;browseObject(me,"condition");}},{scriptClass:"mstrmojo.Button",iconClass:"tbOptions",title:mstrmojo.desc(9581,"Condition Advanced Options"),onclick:function(){var me=this.parent.parent.parent;me.openPopup("conditionAdvRef",{saveConditionOptions:function(em,ife){me.conditionEmbedMethod=em;me.conditionIgnoreFilterElem=ife;},zIndex:me.zIndex+10});}}]},{scriptClass:"mstrmojo.Button",cssClass:"toggle transformation",alias:"toggleTransformation",text:mstrmojo.desc(3324,"Transformation"),bindings:{selected:function(){return hasComponent(this.parent.parent.did,"transformation");}},onclick:function(evt){var ex=!!!this.selected;this.set("selected",ex);},slot:"4,0"},{scriptClass:"mstrmojo.DataGrid",cssClass:"transformGrid",cssText:"width:100%",alias:"transformationGrid",bindings:{expanded:function(){var hidden=!this.parent.toggleTransformation.selected;this.cssClass=this.cssClass.replace(/ hidden/g,"")+(hidden?" hidden":"");if(this.domNode){this.domNode.className=this.domNode.className.replace(/ hidden/g,"")+(hidden?" hidden":"");}}},makeObservable:true,renderOnScroll:false,resizableColumns:true,itemDisplayField:"n",slot:"5,1",columns:[{headerText:"Name",dataField:"n",colCss:"nmCol",tooltip:true},{headerText:"Description",dataField:"desc",colCss:"descCol",tooltip:true},{dataWidget:{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(evt){var dg=this.dataGrid;dg.remove(this.data);if(dg.items.length<3){dg.add([FillerItem]);}dg.refresh();dg.parent.parent.onmetricModify();}},headerText:"&nbsp",colCss:"actionsCol"}]},{scriptClass:"mstrmojo.ToolBar",slot:"5,2",cssClass:"mstrmojo-oivmSprite grouped",bindings:{visible:function(){return this.parent.toggleTransformation.selected;return hasComponent(this.parent.parent.did,"transformation");}},children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(1825,"Browse"),iconClass:"tbBrowse",onclick:function(){var me=this.parent.parent.parent;browseObject(me,"transform");}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(7978,"Move Up"),iconClass:"tbMoveUp",onclick:function(){var grid=this.parent.parent.transformationGrid,si=grid&&grid.selectedIndex,len=grid&&grid.items.length,insert,select;if(si>-1){insert=(si===0)?len:si-1;grid.move(si,insert);select=(si===0)?len-1:si-1;grid.singleSelect(select);}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(7979,"Move Down"),iconClass:"tbMoveDown",onclick:function(){var grid=this.parent.parent.transformationGrid,si=grid&&grid.selectedIndex,len=grid&&grid.items.length,insert,select;if(si>-1){insert=(si===(len-1))?0:si+2;grid.move(si,insert);select=(si===(len-1))?0:si+1;grid.singleSelect(select);}}}]}],E=mstrmojo.expr,ARR=mstrmojo.array,browseObject=function(me,t){var tps,cb;switch(t){case"level":tps=[E.TP.ATTR,E.TP.DIM];cb="onLevelAdded";fctxt=16;break;case"transform":tps=[E.TP.ROLE];cb="onTransformAdded";fctxt=26;break;case"condition":tps=[E.TP.FILTER,E.STP.PROMPT_OBJECTS];cb="onConditionAdded";fctxt=10;break;case"expression":tps=[E.TP.FACT,E.TP.ATTR,E.TP.FUNCTION,E.TP.METRIC];cb="onExpressionAdded";fctxt=25;break;default:}tps[tps.length]=E.TP.FOLDER;me.openPopup("ob",{zIndex:me.zIndex+10});var ob=me.ob.browser;ob.browse({folderLinksContextId:fctxt,onSelectCB:[me,cb],browsableTypes:tps.join(","),includeObjectDesc:true});},FILTERINGS={1:"+",2:"*",3:"%",4:""},GROUPINGS={1:"",2:"!",3:"<",4:">",5:"<|",6:">|"},_brackets=mstrmojo.ME.MetricToken.brackets;mstrmojo.ME.SimpleMetricEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper],{scriptClass:"mstrmojo.ME.SimpleMetricEditor",cssClass:"mstrmojo-Editor-me mstrmojo-SimpleMetricEditor",title:"",help:"Simple_metric_editor.htm",fctSyntax:"",fctDesc:"",did:EnumEditorComponents.simple,bindings:{candidates:"this.opener.candidates"},getMetricDefAsTokens:function getMetricDefAsTokens(){var fct=this.metricContent1.fctPulldown.selectedItem,expr=this.metricContent1.metricEditBox.inputBox.items,levels=this.metricContent2.levelInput.getSelectedObjects(),fltr=this.metricContent2.conditionInput.getSelectedObjects(),trfms=this.metricContent2.transformationGrid.items,tokens=[],i,len;tokens.push({v:fct.n,oi:fct});tokens=tokens.concat(this.functionPropsRef.getTokens());tokens.push({v:"(",isDelimiter:true});for(i=0,len=expr.length;i<len;i++){tokens.push(expr[i]);}tokens.push({v:")",isDelimiter:true});tokens.push({v:"{",isDelimiter:true});var lvl=null;for(i=0,len=levels.length;i<len;i++){lvl=levels[i];tokens.push({v:GROUPINGS[lvl.grouping],isDelimiter:true});tokens.push((lvl.did===-1)?{v:"~",isDelimiter:true}:{v:_brackets(lvl.n),oi:lvl});tokens.push({v:FILTERINGS[lvl.filtering],isDelimiter:true});if(i<(len-1)){tokens.push({v:",",isDelimiter:true});}}if(!this.levelFilterRest){tokens.push({v:";",isDelimiter:true});tokens.push({v:"-",isDelimiter:true});}if(!this.levelCanContinue){tokens.push({v:";",isDelimiter:true});tokens.push({v:"/",isDelimiter:true});}tokens.push({v:"}",isDelimiter:true});if(fltr.length>0){tokens.push({v:"<",isDelimiter:true});tokens.push({v:_brackets(fltr[0].n),oi:fltr[0]});tokens.push({v:";",isDelimiter:true});tokens.push({v:"@",isDelimiter:true});tokens.push({v:this.conditionEmbedMethod});tokens.push({v:";",isDelimiter:true});tokens.push({v:this.conditionIgnoreFilterElem?"-":"+",isDelimiter:true});tokens.push({v:">",isDelimiter:true});}var idx=ARR.indexOf(trfms,FillerItem);len=idx<0?trfms.length:idx;if(len>0){tokens.push({v:"|",isDelimiter:true});var tr=null;for(i=0;i<len;i++){tr=trfms[i];tokens.push({v:_brackets(tr.n),oi:tr});if(i<(len-1)){tokens.push({v:",",isDelimiter:true});}}tokens.push({v:"|",isDelimiter:true});}for(i=0,len=tokens.length;i<len;i++){tokens[i].isNew=true;}return tokens;},getMetricDefFromTokens:function getMetricDefFromTokens(){var fct=[],fctProps=[],expr=[],level=[],fltr=[],trfms=[],tokens=(this.insertMode||this.opener&&this.opener.oi)?this.opener.oi.tks.items:this.oi.tks.items,len=tokens.length;if(this.insertMode||len===0){level.push({n:"Report Level",did:-1,t:-1,state:0});}else{for(var i=0;i<len;i++){var token=tokens[i],tp=token.tp,sctt=token.sctt;switch(sctt){case 65536:switch(tp){case 280:fct=token.oi;break;}break;case 131072:if(tp==259||tp==303){fctProps.push({n:tokens[i].v,v:tokens[i+2].v,oi:tokens[i+2].oi});}break;case 262144:switch(tp){case 126:case 264:case 265:var oi=tp==126?{n:"Report Level",did:-1,t:-1,state:0}:token.oi;oi.grouping=1,oi.filtering=4;switch(tokens[i-1].tp){case 33:oi.grouping=2;break;case 60:oi.grouping=3;break;case 62:oi.grouping=4;break;case 297:oi.grouping=5;break;case 298:oi.grouping=6;break;}switch(tokens[i+1].tp){case 37:oi.filtering=3;break;case 42:oi.filtering=2;break;case 43:oi.filtering=1;break;}level.push(oi);break;case 45:this.levelFilterRest=false;break;case 47:this.levelCanContinue=false;break;}break;case 327680:switch(tp){case 270:case 273:fltr.push(token.oi);break;case 262:this.conditionEmbedMethod=token.v;break;case 43:this.conditionIgnoreFilterElem=false;break;case 45:this.conditionIgnoreFilterElem=true;break;}break;case 393216:switch(tp){case 271:trfms.push(token.oi);break;}break;case -1:case 196608:switch(tp){case 40:case 41:default:expr.push(token);break;}break;}}}if(expr.length>2){if(expr[0].v=="("){expr.shift();}if(expr[expr.length-1].v==")"){expr.pop();}}return{fct:fct,fctProps:fctProps,level:level,filter:fltr,tranformation:trfms,expr:expr};},levelCanContinue:true,levelFilterRest:true,conditionEmbedMethod:2,conditionIgnoreFilterElem:true,insertMode:false,_set_candidates:function(n,v){this.candidates=v;if(this.hasRendered&&this.visible){var ei=this.metricContent1.metricEditBox.inputBox,li=this.metricContent2.levelInput;ei.candidates=this.candidates;li.candidates=this.getCandidates(12);}return true;},getCandidates:function getCandidates(t){var cs=this.candidates,its;if(cs){its=ARR.filter(cs.items,function(it){return it.t===t;});return{items:its,isComplete:cs.isComplete};}return null;},onOpen:function onOpen(){var sb=this.buttonBar.saveokButton,ei=this.metricContent1.metricEditBox.inputBox,li=this.metricContent2.levelInput;if(this.insertMode){sb.set("text",mstrmojo.desc(2919,"Insert"));}else{sb.set("text",mstrmojo.desc(5891,"Save"));this._setupCandidatesCache(ei);}var meDef=this.getMetricDefFromTokens();var fcts=mstrmojo.ME.MetricDataService.getAggFunctions(),fp=this.metricContent1.fctPulldown,did=meDef.fct&&meDef.fct.did||this.did;if(fcts&&fp){fp.set("items",fcts);if(did&&mstrmojo.ME.MetricDataService.isBasicAggMap(did)){fp.set("value",did);}else{fp.set("value","8107C31BDD9911D3B98100C04F2233EA");}}this.set("fctProps",meDef.fctProps);ei.candidates=this.candidates;ei.set("items",meDef.expr);li.candidates=this.getCandidates(12);li.set("items",meDef.level);var fb=this.metricContent2.conditionInput;if(!this.noCache&&!fb.candidates){var success=function(res){if(res){var cds={items:res.items,isComplete:(res.bc===-1||(res.bb+res.bc>res.sz))};fb.set("candidates",cds);}},failure=function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getFilters({pattern:"*",blockBegin:1,blockCount:-1},{success:success,failure:failure});}fb.set("items",meDef.filter);var tg=this.metricContent2.transformationGrid;for(var i=meDef.tranformation.length;i<3;i++){meDef.tranformation.push(FillerItem);}tg.set("items",meDef.tranformation);this.set("title",this.insertMode?this.metricContent1.fctPulldown.selectedItem.n:mstrmojo.desc(9582,"Function Editor:")+" "+this.oi.n);},functionPropsRef:{scriptClass:"mstrmojo.Editor",cssText:"width: 415px;",onOpen:function(){var o=this.opener;this.set("title",o.metricContent1.fctPulldown.selectedItem.n+" "+mstrmojo.desc(-2,"Parameters"));this.set("fctProps",_setupFunctionProps(o.fctProps,o.metricContent1.fctPulldown.selectedItem.pros));},children:[{scriptClass:"mstrmojo.DataGrid",alias:"fctPropsGrid",cssClass:"functionPropsGrid",cssText:"margin: 5px auto; 0",makeObservable:true,banding:false,columns:[{headerText:"Name",dataFunction:function(d,idx,dataGrid){return'<div class="mstrmojo-DataRow-text"title="'+(d.desc||"")+'">'+d.n+":</div>";},colCss:"name"},{headerText:"Value",dataWidgetBuilder:function(d,idx,dataGrid){var w;switch(d.dtp){case 11:w={scriptClass:"mstrmojo.Pulldown",itemIdField:"did",items:[{n:"False",did:"0"},{n:"True",did:"-1"}],popupToBody:true,popupZIndex:100,postCreate:function(props){var d=this.data;this.value=!!d.v?(d.v=="False"?0:-1):(d.dfv||0);},getTokens:function(){var d=this.data;if(this.value!==d.dfv){return[{v:d.n},{v:"=",isDelimiter:true},{v:this.value=="-1"?"True":"False"}];}else{return[];}}};break;default:w={scriptClass:"mstrmojo.Pulldown",itemIdField:"did",items:d.items,popupToBody:true,popupZIndex:100,getTokens:function(){var d=this.data;return this.selectedIndex>0?[{v:d.n},{v:"=",isDelimiter:true},{v:this.selectedItem.n,oi:this.selectedItem,isNew:true}]:[];},postCreate:function(){var me=this;switch(d.dtp){case -1:var success=function(res){if(res){me.set("items",[{n:"(Nothing)",did:-1}].concat(res.items));me.set("value",d.oi&&d.oi.did);}},failure=function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getFacts({pattern:"*",blockBegin:1,blockCount:-1,rootFolderType:39},{success:success,failure:failure});break;case -2:break;}}};break;}w.alias="inputWidget";return w;},colCss:"dtp"}],bindings:{items:function(){return this.parent.fctProps;}}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var e=this.parent.parent;e.opener.onmetricModify();e.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var e=this.parent.parent;e.close();}}]}],getTokens:function(){var g=this.fctPropsGrid;if(!g){return[];}var rs=g&&g.ctxtBuilder.itemWidgets,props=[],tks=[],anyProp,a,i,j,len;for(i=0,len=rs.length;i<len;i++){props.push(rs[i].inputWidget.getTokens());}len=props.length;if(len>0){anyProp=false;tks.push({v:"<",isDelimiter:true});for(i=0;i<len;i++){a=props[i];l=a.length;if(l===0){continue;}anyProp=true;for(j=0;j<l;j++){tks.push(a[j]);}tks.push({v:",",isDelimiter:true});}tks.pop();if(anyProp){tks.push({v:">",isDelimiter:true});}}return tks;}},levelAdvRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9577,"Level Advanced Options"),help:"Level_Advanced_Options_dialog_box.htm",cssText:"width: 386px;",onOpen:function(){var o=this.opener;this.contentTable.ccCheckBox.set("checked",o.levelCanContinue);this.contentTable.frCheckBox.set("checked",o.levelFilterRest);},children:[{scriptClass:"mstrmojo.Table",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.CheckBox",alias:"ccCheckBox",slot:"0,0",label:mstrmojo.desc(9583,"Allow other users to add extra units to this definition")},{scriptClass:"mstrmojo.CheckBox",alias:"frCheckBox",slot:"1,0",label:mstrmojo.desc(9584,"Include filter attributes which are not in report or level in metric calculation")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var e=this.parent.parent;e.saveLevelOptions(e.contentTable.ccCheckBox.checked,e.contentTable.frCheckBox.checked);e.opener.onmetricModify();e.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var e=this.parent.parent;e.close();}}]}]},conditionAdvRef:{scriptClass:"mstrmojo.Editor",title:"Condition Advanced Options",help:"Condition_Advanced_Options_dialog_box.htm",cssText:"width: 286px;",onOpen:function(){var o=this.opener;this.contentTable.emPulldown.set("value",o.conditionEmbedMethod);this.contentTable.irfeCheckBox.set("checked",o.conditionIgnoreFilterElem);},children:[{scriptClass:"mstrmojo.Table",cssText:"margin-top:5px;",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(9585,"Interaction between metric filter and report filter:")},{scriptClass:"mstrmojo.Pulldown",alias:"emPulldown",itemField:"n",itemIdField:"did",slot:"1,0",value:2,items:[{n:mstrmojo.desc(9586,"Merge into new"),did:1},{n:mstrmojo.desc(9587,"Merge report filter into metric"),did:2},{n:mstrmojo.desc(9588,"Merge metric condition into report"),did:3}]},{scriptClass:"mstrmojo.CheckBox",alias:"irfeCheckBox",slot:"2,0",label:mstrmojo.desc(9589,"Ignore related report filter elements")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var e=this.parent.parent;e.saveConditionOptions(e.contentTable.emPulldown.value,e.contentTable.irfeCheckBox.checked);e.opener.onmetricModify();e.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var e=this.parent.parent;e.close();}}]}]},onLevelAdded:function(oi){var lib=this.metricContent2.levelInput;oi.state=0;lib.add([oi],lib.items.length-1);this.closePopup();this.onmetricModify();},onConditionAdded:function(oi){var fb=this.metricContent2.conditionInput;oi.state=0;fb.add([oi],fb.items.length-1);this.closePopup();this.onmetricModify();},onExpressionAdded:function(oi){var eib=this.metricContent1.metricEditBox.inputBox;eib.add([{v:oi.n,oi:oi,isNew:true}]);this.closePopup();this.onmetricModify();},onTransformAdded:function(oi){oi.state=0;var tib=this.metricContent2.transformationGrid;var firstFillerIdx=ARR.indexOf(tib.items,FillerItem);if(firstFillerIdx>-1){tib.items.pop();tib.items.add([oi],firstFillerIdx);tib.refresh();}else{tib.add([oi],tib.items.length);}this.closePopup();this.onmetricModify();},handleValidation:function(tks){this.metricContent1.metricEditBox.handleValidation(tks);},children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-SME-content1",alias:"metricContent1",layout:[{cells:[{cssClass:"mstrmojo-SME-label"},{},{}]},{cells:[{cssClass:"mstrmojo-SME-label"},{cssText:"width:252px;padding-right:6px;"},{cssClass:"mstrmojo-ME-toolbar"}]}],cellPadding:3,children:simpleMetricContent1},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-SME-content2",alias:"metricContent2",layout:[{cells:[{colSpan:3}]},{cells:[{cssClass:"mstrmojo-SME-label"},{},{cssClass:"mstrmojo-ME-toolbar"}]},{cells:[{colSpan:3}]},{cells:[{cssClass:"mstrmojo-SME-label"},{},{cssClass:"mstrmojo-ME-toolbar"}]},{cells:[{colSpan:3}]},{cells:[{cssClass:"mstrmojo-SME-label"},{cssText:"width:252px;padding-right:6px;"},{cssClass:"mstrmojo-ME-toolbar"}]}],cellPadding:3,children:simpleMetricContent2},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FE-functionDesc",bindings:{text:"this.parent.fctDesc"},slot:"editorNode"},mstrmojo.ME._MetricEditorHelper.switchRef,mstrmojo.ME._MetricEditorHelper.buttonBarRef]});mstrmojo.ME.SimpleMetricEditor.EnumEditorComponents=EnumEditorComponents;})();