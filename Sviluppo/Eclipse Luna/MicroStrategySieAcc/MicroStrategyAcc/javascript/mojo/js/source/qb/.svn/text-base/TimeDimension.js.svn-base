(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.Label","mstrmojo.Box","mstrmojo.array","mstrmojo.TreeBrowser","mstrmojo.fx");var _H=mstrmojo.hash;var _t0=[{n:mstrmojo.desc(2461,"All"),did:"all"}],_t1=[{n:mstrmojo.desc(873,"Year"),did:1},{n:mstrmojo.desc(10050,"Quarter"),did:2},{n:mstrmojo.desc(10051,"Quarter of Year"),did:4},{n:mstrmojo.desc(871,"Month"),did:8},{n:mstrmojo.desc(10049,"Month of Year"),did:16},{n:mstrmojo.desc(10048,"Week"),did:32},{n:mstrmojo.desc(10047,"Week of Year"),did:64},{n:mstrmojo.desc(2052,"Date"),did:128},{n:mstrmojo.desc(10046,"Day of Month"),did:256},{n:mstrmojo.desc(10045,"Day of Week"),did:512}],_t2=[{n:mstrmojo.desc(10042,"Hour"),did:1024},{n:mstrmojo.desc(10043,"Minute"),did:2048},{n:mstrmojo.desc(10044,"Second"),did:4096}];var _skip=false;mstrmojo.qb.TimeDimension=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.qb.TimeDimension",markupString:'<div id="{@id}"  class="{@cssClass}" style="top:{@top};left:{@left};width:155px;height:{@height};"><div style="z-index:{@zIndex};{@cssText}" mstrAttach:mousedown,click><div class="mstrmojo-qb-mapping-title">{@title}</div><div class="mstrmojo-qb-mapping-time"></div><div class="mstrmojo-qb-mapping-buttons"></div></div></div>',markupSlots:{contentNode:function(){return this.domNode.firstChild.childNodes[1];},titleNode:function(){return this.domNode.firstChild.childNodes[0];},buttonNode:function(){return this.domNode.firstChild.childNodes[2];}},top:"0px",left:"0px",height:"320px",title:"Please select additional time attributes that you want to create.",mode:3,_close:function(){var p=this.parent;if(p&&p._cmSource){p._cmSource.closeMenuTree();}},onOK:function(){var sls=this.timebrowser.getTotalSelections();var p=this.parent,cms=p._cmSource;if(cms.executeCommand){this.data.geo=false;var t=sls.slice(),drv=0;for(var i=0,len=t.length;i<len;i++){(t[i].did!=="all")&&(drv=drv|t[i].did);}this.data.der=drv;cms.executeCommand(this.data);}this._close();},onCancel:function(){this._close();},children:[{scriptClass:"mstrmojo.TreeBrowser",slot:"contentNode",alias:"timebrowser",noCheckBox:false,itemIdField:"did",itemDisplayField:"n",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,multiSelect:true,cssClass:"mstrmojo-qb-time-tree",isBranch:function isBranch(data){return false;},bindings:{items:function(){var md=this.parent.mode,its=[];switch(md){case 1:its=_t0.concat(_t1);break;case 2:its=_t0.concat(_t2);break;case 3:its=_t0.concat(_t1).concat(_t2);break;default:break;}return its;}},onchange:function(e){var added=e.added,removed=e.removed;if(_skip){_skip=false;return ;}if(added){var items=this.items,length=items.length,idx,selectedIndices=this.selectedIndices;if(added[0]===0){for(idx=0;idx<length;idx++){if(!selectedIndices[idx]){_skip=true;this.setSelectedItems(items,true);break;}}}else{for(idx=1;idx<length;idx++){if(!selectedIndices[idx]){return ;}}if(!selectedIndices[0]){_skip=true;this.toggleSelect(0,false);}}}if(removed){if(removed[0]===0){this.clearTreeSelect();}else{if(this.selectedIndices[0]){_skip=true;this.toggleSelect(0,false);}}}},onRender:function(){var drv=this.parent.der,its=this.items,sls=[];for(var i=0,len=its.length;i<len;i++){(drv&its[i].did)&&(sls.push({did:its[i].did}));}(len==sls.length+1)&&(sls.push({did:"all"}));sls.length&&this.setSelectedItems(sls,true);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox cf",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(1442,"OK"),onclick:function(evt){var e=this.parent.parent;if(e.onOK){e.onOK();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-qb-georole-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(evt){var e=this.parent.parent;if(e.onCancel){e.onCancel();}}}]}]});})();