mstrFolderImplScript=true;mstrFolderImpl.prototype=new mstrBoneImpl();mstrFolderImpl.prototype.currentContextMenuNode=null;mstrFolderImpl.prototype.inlineRenameObject=null;mstrFolderImpl.prototype.folderId=null;mstrFolderImpl.prototype.serverName=null;mstrFolderImpl.prototype.projectName=null;mstrFolderImpl.prototype.portNum=null;mstrFolderImpl.prototype.minColWidth=[32,100,100,100,100,130];mstrFolderImpl.prototype.colCount=6;mstrFolderImpl.prototype.onload=function(){try{this.initBone();this.initFolderBone();this.updateQuickSearchBone();scroll(0,0);}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.initFolderBone=function(){try{this.elem.oncontextmenu=new Function("e","microstrategy.bone('"+this.id+"').onContextMenu(e); return true;");this.commands=new mstrFolderCommands(this);if(mstr.utils.ISIE7){return ;}this.table=microstrategy.findChildWithAtt(this.elem,"table","id","FolderList");if(this.table){this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e); return true;");this.colGroups=[this.table.children[0]];this.headersNode=this.table.tHead;this._buildColGroup();}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype._buildColWidths=function(){this.colWidths=this.colWidths||[];var cws=this.colWidths;if(cws.length===0){for(var i=this.colCount-1;i>-1;i--){cws[i]=this.headersNode.rows[0].cells[i].offsetWidth;}}var w=0;for(var j=cws.length-1;j>-1;j--){w+=cws[j];}this.table.style.width=this.headersNode.style.width=w+"px";},mstrFolderImpl.prototype._buildColGroup=function _buildColGroup(){this._buildColWidths();var ci=this.resizingIndex,cws=this.colWidths,cgs=this.colGroups;if(cgs&&cgs[0].childNodes.length==this.colCount){if((ci!==null&&ci>=0)){for(var j=cgs.length-1;j>-1;j--){cgs[j].childNodes[ci].style.width=cws[ci]+"px";}}}else{var cg=document.createElement("colgroup");for(var i=0,cnt=this.colCount;i<cnt;i++){var col=document.createElement("col");col.style.width=cws[i]+"px";cg.appendChild(col);}var fnCG=function(w,cg){w[(w.firstChild.tagName.toLowerCase()!="colgroup")?"insertBefore":"replaceChild"](cg,w.firstChild);};fnCG(this.headersNode,cg);var cg2=cg.cloneNode(true);fnCG(this.itemsNode,cg2);this.colGroups=[cg,cg2];}};mstrFolderImpl.prototype.onmousedown=function(e){this.onselectstartFn=document.onselectstart;var hWin=window,e=e||window.event;var tgt=mstr.$E.target(e,hWin);if(tgt&&tgt.tagName.toLowerCase()=="td"&&tgt.parentNode.parentNode.tagName.toLowerCase()=="thead"){document.onselectstart=function(){return false;};var pos=tgt.offsetLeft+tgt.offsetWidth-getDocumentScrollLeft();this.resizingIndex=tgt.cellIndex;this.startx=mstr.$E.getMousePosition(e,hWin).x;var buildRszHandle=function(x){var h=document.createElement("div");h.className="mstrListView-rzHandle";h.style.left=x+"px";return h;};var rh=this.resizeHandle||buildRszHandle(pos);if(!this.resizeHandle||!mstr.$D.containsElement(this.elem,rh)){this.resizeHandle=rh;this.elem.appendChild(rh);}else{rh.style.left=pos+"px";}rh.style.display="block";this.elem.className+=" resizing";var me=this;var mousemove=function(e){rh.style.left=Math.max(0,pos+mstr.$E.getMousePosition(e,hWin).x-me.startx)+"px";};var mouseup=function(e){if(rh){rh.style.display="none";mstr.$D.detachEvent(document,"mousemove",mousemove);mstr.$D.detachEvent(document,"mouseup",mouseup);}me.elem.className=me.elem.className.replace(/ resizing/,"");document.onselectstart=me.onselectstartFn;var ri=me.resizingIndex;if(ri>=0){me.colWidths[ri]=Math.max(me.minColWidth[ri],me.colWidths[ri]+mstr.$E.getMousePosition(e,hWin).x-me.startx);me._buildColGroup();me.resizingIndex=null;}};mstr.$D.attachEvent(document,"mousemove",mousemove);mstr.$D.attachEvent(document,"mouseup",mouseup);}};mstrFolderImpl.prototype.onContextMenu=function(e){try{if(!e){e=window.event;}var oTarget=getEventTarget(e);if(oTarget.tagName.toLowerCase()!="tr"){oTarget=findTargetTag(oTarget,"tr");}if(oTarget.tagName.toLowerCase()=="tr"){this.currentContextMenuNode=oTarget;}else{this.currentContextMenuNode=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.processRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.processRename(this.beanPath);this.inlineRenameObject=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.cancelRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.cancelRename();this.inlineRenameObject=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.getNameTag=function(){try{return microstrategy.findChildWithAtt(this.currentContextMenuNode,"span","sty","nm");}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.getCurrentContextId=function(){return microstrategy.findChildWithAtt(this.currentContextMenuNode,"td","oty","1").getAttribute("oid");};mstrFolderImpl.prototype.getObjInfo=function(){var tr=this.currentContextMenuNode;if(tr){var tds=tr.getElementsByTagName("td"),td;for(var i=0,len=tds.length;i<len;i++){td=tds[i];if(td.getAttribute("oid")){return{id:td.getAttribute("oid"),ty:td.getAttribute("oty")};}}}return null;};mstrFolderImpl.prototype.enableRenameField=function(objectType,objectId){try{if(this.currentContextMenuNode){this.inlineRenameObject=new mstrInlineRenameImpl();this.inlineRenameObject.parentBone=this;this.inlineRenameObject.enableRenameField(objectType,objectId);}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.openCustomGroupEditor=function(customGroupId){microstrategy.openCustomGroupEditor(customGroupId);};mstrFolderImpl.prototype.openMetricEditor=function(metricId,type){microstrategy.openMetricEditor(metricId,type);};mstrFolderImpl.prototype.updateQuickSearchBone=function(){var qsBone=microstrategy.bone("mstrSearchSuggest");if(qsBone&&qsBone.isMiniSearchBox){if(this.folderName){qsBone.rootFolderName=mstr.utils.String.escape4HTMLText(this.folderName);}if(this.sysFolder!=undefined){qsBone.rootFolderType=this.sysFolder;}if(this.folderId){qsBone.rootFolderID=this.folderId;}qsBone.updateTipText();}};mstrFolderImpl.prototype.showExportLink=function(url,showIframe,name){mstrFolderActions.exportLink(url,this.serverName,this.projectName,this.portNum,showIframe,name);};function mstrFolderImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);delete this.inherits;return this;}mstrFolderCommands.prototype={};mstrFolderCommands.prototype.exec=function(cmdId,cmdArgs){switch(cmdId){case"edit":this.parentBone.openCustomGroupEditor(this.parentBone.getCurrentContextId());break;case"newCGE":this.parentBone.openCustomGroupEditor();break;case"newIVE":microstrategy.createIVE.call(this.parentBone);break;case"shareEditor":var oi=this.parentBone.getObjInfo();microstrategy.showSharingEditor(cmdArgs.url,{objectName:cmdArgs.name,objId:oi.id,objType:oi.ty,mid:-1});break;case"newME":this.parentBone.openMetricEditor(null,"mstrME");break;case"newSME":this.parentBone.openMetricEditor(null,"mstrSME");break;case"newFSE":this.parentBone.openMetricEditor(null,"mstrFSE");break;case"openME":var oi=this.parentBone.getObjInfo();if(oi){this.parentBone.openMetricEditor(oi.id);}break;}};function mstrFolderCommands(parentBone){this.parentBone=parentBone;return this;}